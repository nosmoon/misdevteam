<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session>
							<uid/>
							<cmpy_cd/>
							<emp_no/>
							<emp_nm/>
							<dept_cd/>
							<dept_nm/>
						</session>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<comboSet>
							<medi_cd>
								<item>
									<label/>
									<value/>
								</item>
							</medi_cd>
							<rcpm_shet_kind>
								<item>
									<label/>
									<value/>
								</item>
							</rcpm_shet_kind>
							<acct_mang_no>
								<item>
									<label/>
									<value/>
								</item>
							</acct_mang_no>
							<note_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</note_clsf>
							<note_issu_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</note_issu_clsf>
							<slip_clsf_cd>
								<item>
									<label/>
									<value/>
								</item>
							</slip_clsf_cd>
							<dlco_clsf_cd>
								<item>
									<label/>
									<value/>
								</item>
							</dlco_clsf_cd>
							<payo_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</payo_clsf>
							<evnt_seq>
								<item>
									<label/>
									<value/>
								</item>
							</evnt_seq>
							<evnt_yy>
								<item>
									<label/>
									<value/>
								</item>
							</evnt_yy>
							<budg_cd>
								<item>
									<label/>
									<value/>
								</item>
							</budg_cd>
							<trufnd_budg_cd>
								<item>
									<label/>
									<value/>
								</item>
							</trufnd_budg_cd>
						</comboSet>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						<pageInfo>
						</pageInfo>
					</initData>
					<!-- 전달하고자 하는 데이터를 담당 (submit 함수에서 처리) -->
					<reqData>
						<!-- 검색조건 처리 -->
						<searchData>
							<occr_dt_fr/>
							<occr_dt_to/>
							<srch_dlco_no/>
							<srch_dlco_nm/>
							<srch_titl/>
							<search/>
							<clsf_cd/>
							<searchDetail>
								<occr_dt/>
								<slip_clsf_cd/>
								<occr_seq/>
								<bal_occr_slip_no/>
								<clos_dt/>
								<evnt_yy/>
								<evnt_cd/>
								<evnt_seq/>
							</searchDetail>
							<budg_cd/>
							<dept_cd/>
							<bank_cd/>
							<dlco_no/>
						</searchData>
						<!-- 등록/수정/삭제 요청 Form Data -->
						<reqForm>
							<chk_select/>
						</reqForm>
						<!-- MultiUpDate유형 사용시 처리 -->
						<multiUpDate>
							<mst_mode/>
							<multiUpdateData/>
							<multiUpdateData2/>
							<chk_note_no/>
							<chk_bank_cd/>
						</multiUpDate>
						<!-- POPUP 페이지 Forward Data -->
						<fwdData>
							<func_nm/>
							<rtn_ref/>
							<evnt_yy/>
							<evnt_cd/>
							<G_Tag/>
							<G_Caption/>
							<G_Codenu/>
							<G_BRCode/>
						</fwdData>
					</reqData>
					<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
					<resData>
						<!-- 전달 받은 리스트 데이터를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<gridData1>
								<record>
									<reven_no/>
									<evnt_nm/>
									<titl/>
									<dlco_nm/>
									<reven_dt/>
									<reven_amt/>
									<vat_amt/>
									<rcpm_amt/>
									<stmt_no/>
									<actu_slip_no/>
									<chrg_pers_nm/>
									<chrg_dept_nm/>
									<incmg_pers_nm/>
									<incmg_dt/>
									<occr_dt/>
									<slip_clsf_cd/>
									<occr_seq/>
									<evnt_yy/>
									<evnt_cd/>
									<evnt_seq/>
								</record>
							</gridData1>
							<gridData2>
								<record>
									<budg_cd/>
									<budg_nm/>
									<amt/>
									<acct_mang_no/>
									<rmtt_dt/>
									<rmtt_plac/>
									<note_no/>
									<note_clsf_cd/>
									<bank_cd/>
									<bank_nm/>
									<issu_pers_nm/>
									<issu_cmpy_clsf_cd/>
									<comp_dt/>
									<mtry_dt/>
									<rcpm_acct/>
									<sale_aprv_no/>
									<bal_occr_slip_no/>
									<extnc_obj_slip_clsf/>
									<extnc_dlco_no/>
									<medi_cd/>
									<acct_mang_nm/>
									<biz_reg_no/>
									<bank_id/>
									<acct_num/>
									<tran_date/>
									<tran_date_seq/>
									<slip_no/>
								</record>
							</gridData2>
							<gridData3>
								<record>
									<budg_cd/>
									<budg_nm/>
									<amt/>
									<acct_mang_no/>
									<rmtt_dt/>
									<rmtt_plac/>
									<note_no/>
									<note_clsf_cd/>
									<bank_cd/>
									<bank_nm/>
									<issu_pers_nm/>
									<issu_cmpy_clsf_cd/>
									<comp_dt/>
									<mtry_dt/>
									<rcpm_acct/>
									<sale_aprv_no/>
									<bal_occr_slip_no/>
									<extnc_obj_slip_clsf/>
									<extnc_dlco_no/>
									<medi_cd/>
									<acct_mang_nm/>
									<biz_reg_no/>
									<bank_id/>
									<acct_num/>
									<tran_date/>
									<tran_date_seq/>
									<slip_no/>
								</record>
							</gridData3>
							<grid4>
								<record>
									<drcr_clsf/>
									<budg_cd/>
									<amt/>
									<acct_mang_no/>
									<rmtt_dt/>
									<rmtt_plac/>
									<note_no/>
									<note_clsf_cd/>
									<bank_cd/>
									<issu_pers_nm/>
									<issu_cmpy_clsf_cd/>
									<comp_dt/>
									<mtry_dt/>
									<rcpm_acct/>
									<sale_aprv_no/>
									<bal_occr_slip_no/>
									<extnc_obj_slip_clsf/>
									<extnc_dlco_no/>
									<medi_cd/>
									<biz_reg_no/>
									<bank_id/>
									<acct_num/>
									<tran_date/>
									<tran_date_seq/>
									<slip_no/>
								</record>
							</grid4>
							<grid5>
								<record>
									<evnt_code/>
									<evnt_nm/>
									<dlco_clsf_cd_nm/>
									<dlco_no/>
									<dlco_nm/>
									<chrg_pers_emp_no/>
									<chrg_pers_emp_nm/>
									<misu_amt/>
									<evnt_yy/>
									<evnt_cd/>
									<evnt_seq/>
									<budg_cd/>
									<dlco_clsf_cd/>
								</record>
							</grid5>
							<grid6>
								<record>
									<biz_reg_no/>
									<bank_id/>
									<acct_num/>
									<tran_date/>
									<tran_date_seq/>
									<slip_no/>
									<extnc_amt/>
									<rmtt_plac/>
								</record>
							</grid6>
						</gridData>
						<!-- 전달 받은 Msg를 담당 ( submit의 결과가 담김) -->
						<msg>
							<errCode/>
							<errMsg/>
						</msg>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<occr_dt/>
							<slip_clsf_cd/>
							<occr_seq/>
							<reven_dt/>
							<dlco_clsf_cd/>
							<dlco_no/>
							<dlco_nm/>
							<boks_dlco_nm/>
							<titl/>
							<reven_amt/>
							<vat_amt/>
							<rcpm_amt/>
							<rcpm_shet_kind/>
							<rcpm_shet_no/>
							<prof_type_cd/>
							<stmt_occr_dt/>
							<stmt_occr_seq/>
							<stmt_make_dt/>
							<chrg_dept_cd/>
							<chrg_dept_nm/>
							<chrg_pers_emp_no/>
							<chrg_pers_emp_nm/>
							<evnt_yy/>
							<evnt_cd/>
							<evnt_nm/>
							<evnt_seq/>
							<evnt_proc_clsf_cd/>
							<payo_clsf/>
							<remk/>
							<rcpm_occr_dt/>
							<rcpm_occr_seq/>
							<p_upd_occr_dt/>
							<p_upd_occr_seq/>
							<trufnd_clsf/>
							<bal_occr_slip_no/>
							<occr_amt/>
							<extnc_amt/>
							<occr_dlco_no/>
							<extnc_dlco_no/>
							<extnc_obj_slip_clsf/>
							<medi_cd/>
							<bal_budg_cd/>
						</resForm>
						<resDetailForm>
							<cash_amt/>
							<cash_payo_clsf_cd/>
							<cash_rcpm_occr_dt/>
							<cash_rcpm_occr_seq/>
							<deps_amt/>
							<deps_acct_mang_no/>
							<deps_acct_mang_nm/>
							<deps_rmtt_dt/>
							<deps_rmtt_plac/>
							<deps_payo_clsf_cd/>
							<deps_rcpm_occr_dt/>
							<deps_rcpm_occr_seq/>
							<deps_biz_reg_no/>
							<deps_bank_id/>
							<deps_acct_num/>
							<deps_tran_date/>
							<deps_tran_date_seq/>
							<deps_slip_no/>
							<note_rcpm_amt/>
							<note_note_no/>
							<note_note_clsf_cd/>
							<note_bank_cd/>
							<note_bank_nm/>
							<note_issu_pers_nm/>
							<note_issu_cmpy_clsf_cd/>
							<note_comp_dt/>
							<note_mtry_dt/>
							<note_rcpm_acct/>
							<note_sale_aprv_no/>
							<swit_budg_cd/>
							<swit_budg_nm/>
							<swit_amt/>
							<swit_extnc_obj_slip_clsf/>
							<swit_bal_occr_slip_no/>
							<swit_medi_cd/>
							<swit_extnc_dlco_no/>
							<swit_extnc_dlco_nm/>
							<etc_budg_cd/>
							<etc_budg_nm/>
							<etc_amt/>
							<etc_acct_mang_no/>
							<tmp_misu_amt/>
						</resDetailForm>
						<resTemp>
							<reven_budg_amt/>
							<expn_budg_amt/>
							<bal_budg_amt/>
							<tot_reven_amt/>
							<tot_expn_amt/>
							<tot_bal_amt/>
						</resTemp>
					</resData>
					<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
					<tempData>
					</tempData>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					function setEvntSeq() {
						makeComboSet("N", "/root/tempData/dataSet/CURLIST1/record", "/root/initData/comboSet/evnt_seq", "evnt_seq", "evnt_seq")
						model1.refresh();
						//model1.setValue("/root/resData/resForm/evnt_seq", model1.getValue("/root/tempData/dataSet/CURLIST2/record/evnt_seq"));
						model1.setValue("/root/resData/resForm/evnt_nm", model1.getValue("/root/tempData/dataSet/CURLIST3/record/evnt_nm"));
						model1.setValue("/root/resData/resForm/chrg_pers_emp_no", model1.getValue("/root/tempData/dataSet/CURLIST3/record/chrg_pers_emp_no"));
						model1.setValue("/root/resData/resForm/chrg_pers_emp_nm", model1.getValue("/root/tempData/dataSet/CURLIST3/record/chrg_pers_emp_nm"));
						model1.setValue("/root/resData/resForm/chrg_dept_cd", model1.getValue("/root/tempData/dataSet/CURLIST3/record/chrg_dept_cd"));
						model1.setValue("/root/resData/resForm/chrg_dept_nm", model1.getValue("/root/tempData/dataSet/CURLIST3/record/chrg_dept_nm"));

						//행사코드에 따른 예산계획 출력
						if (model1.getValue("/root/tempData/dataSet/CURLIST4/totalcnt") != "0") {
							model1.setValue("/root/resData/resTemp/reven_budg_amt", model1.getValue("/root/tempData/dataSet/CURLIST4/record/reven_amt"));
							model1.setValue("/root/resData/resTemp/expn_budg_amt", model1.getValue("/root/tempData/dataSet/CURLIST4/record/expn_amt"));
							model1.setValue("/root/resData/resTemp/bal_budg_amt", model1.getValue("/root/tempData/dataSet/CURLIST4/record/bal_amt"));
						}
						
						//행사코드에 따른 수입/지출 내역 출력
						if (model1.getValue("/root/tempData/dataSet/CURLIST5/totalcnt") != "0") {
							model1.setValue("/root/resData/resTemp/tot_reven_amt", model1.getValue("/root/tempData/dataSet/CURLIST5/record/reven_stot"));
							model1.setValue("/root/resData/resTemp/tot_expn_amt", model1.getValue("/root/tempData/dataSet/CURLIST5/record/expn_stot"));
							model1.setValue("/root/resData/resTemp/tot_bal_amt", model1.getValue("/root/tempData/dataSet/CURLIST5/record/bal_stot"));
						}
						model1.refresh();
					}

					function setEmpInfo(emp_no) {
						model1.setValue("/root/reqData/searchData/search", emp_no);
						model1.setValue("/root/reqData/searchData/clsf_cd", "HDIN");

						model1.send("en_comm_1001");
						
						var emp_no = model1.getValue("/root/tempData/record/value1");
						var emp_nm = model1.getValue("/root/tempData/record/value2");
						var dept_cd = model1.getValue("/root/tempData/record/value3");
						var dept_nm = model1.getValue("/root/tempData/record/value4");
						
						model1.setValue("/root/resData/resForm/chrg_pers_emp_no", emp_no);
						model1.setValue("/root/resData/resForm/chrg_pers_emp_nm", emp_nm);
						model1.setValue("/root/resData/resForm/chrg_dept_cd", dept_cd);
						model1.setValue("/root/resData/resForm/chrg_dept_nm", dept_nm);
						model1.removeNodeset("/root/tempData/record");
						
						model1.refresh();
					}
					
					function setDlco_no(iv_dlco_no, iv_dlco_nm){
						model1.setValue("/root/resData/resForm/dlco_no", iv_dlco_no);
						model1.setValue("/root/resData/resForm/dlco_nm", iv_dlco_nm);
						model1.refresh();
					}
					
					function setSrch_dlco_no(iv_dlco_no, iv_dlco_nm){
						model1.setValue("/root/reqData/searchData/srch_dlco_no", iv_dlco_no);
						model1.setValue("/root/reqData/searchData/srch_dlco_nm", iv_dlco_nm);
						model1.refresh();
					}
					
					function setSwit_dlco_no(iv_dlco_no, iv_dlco_nm){
						model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_no", iv_dlco_no);
						model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_nm", iv_dlco_nm);
						model1.refresh();
					}
					
					function setCash_Occr_No(iv_occr_dt, iv_occr_seq){
						model1.setValue("/root/resData/resDetailForm/cash_rcpm_occr_dt", iv_occr_dt);
						model1.setValue("/root/resData/resDetailForm/cash_rcpm_occr_seq", iv_occr_seq);
						model1.refresh();
					}
					
					function setDeps_Occr_No(iv_occr_dt, iv_occr_seq){
						model1.setValue("/root/resData/resDetailForm/deps_rcpm_occr_dt", iv_occr_dt);
						model1.setValue("/root/resData/resDetailForm/deps_rcpm_occr_seq", iv_occr_seq);
						model1.refresh();
					}
					
					function setUpd_Occr_No(iv_occr_dt, iv_occr_seq){
						model1.setValue("/root/resData/resForm/p_upd_occr_dt", iv_occr_dt);
						model1.setValue("/root/resData/resForm/p_upd_occr_seq", iv_occr_seq);
						model1.refresh();
					}
					
					function setEvntInfo(budg_cd, budg_nm){
						//전환금 - 예산코드
						if (gstr_popupid == "budg_cd1") {
							model1.setValue("/root/resData/resDetailForm/swit_budg_cd", budg_cd);
							model1.setValue("/root/resData/resDetailForm/swit_budg_nm", budg_nm);
							model1.refresh();
						}
						//기타 - 예산코드
						if (gstr_popupid == "budg_cd2") {
							model1.setValue("/root/resData/resDetailForm/etc_budg_cd", budg_cd);
							model1.setValue("/root/resData/resDetailForm/etc_budg_nm", budg_nm);
							model1.refresh();
						}
					}
					
					function setEvnt_cd(iv_evnt_yy, iv_evnt_cd, iv_evnt_seq, iv_evnt_nm) {
						//model1.setValue("/root/resData/resForm/evnt_yy", iv_evnt_yy);
						model1.setValue("/root/resData/resForm/evnt_cd", iv_evnt_cd);
						model1.setValue("/root/resData/resForm/evnt_seq", iv_evnt_seq);
						model1.setValue("/root/resData/resForm/evnt_nm", iv_evnt_nm);
						model1.refresh();
					}
					
					function setPreAmt(iv_evnt_yy, iv_evnt_cd, iv_evnt_seq, iv_pre_amt) {
						if (model1.getValue("/root/resData/resForm/evnt_yy") != iv_evnt_yy ||
						    model1.getValue("/root/resData/resForm/evnt_cd") != iv_evnt_cd ||
						    model1.getValue("/root/resData/resForm/evnt_seq") != iv_evnt_seq) {
						    alert("선택하신 행사코드와 일치하지 않는 행사입니다.");
						    return;
						}
						model1.setValue("/root/resData/resDetailForm/etc_amt", iv_pre_amt);
						model1.refresh();
					}
					
					function getBudgPlan() {
						model1.makeNode("/root/reqData/reqForm/reven_dt");
						model1.makeNode("/root/reqData/reqForm/dept_cd");
						model1.makeNode("/root/reqData/reqForm/evnt_cd");
						model1.setValue("/root/reqData/reqForm/reven_dt", model1.getValue("/root/resData/resForm/reven_dt"));
						model1.setValue("/root/reqData/reqForm/dept_cd", model1.getValue("/root/resData/resForm/chrg_dept_cd"));
						var evnt_cd = model1.getValue("/root/resData/resForm/evnt_yy") + model1.getValue("/root/resData/resForm/evnt_cd") + model1.getValue("/root/resData/resForm/evnt_seq")
						model1.setValue("/root/reqData/reqForm/evnt_cd", evnt_cd);
						model1.send("en_innexp_1008");
						//opt_budg_reven_amt.value = model1.getValue("/root/tempData/dataSet/CURLIST/record/reven_amt");
						//opt_budg_expn_amt.value = model1.getValue("/root/tempData/dataSet/CURLIST/record/expn_amt");
						//opt_budg_bal_amt.value = model1.getValue("/root/tempData/dataSet/CURLIST/record/bal_amt");
						model1.setValue("/root/resData/resTemp/reven_budg_amt", model1.getValue("/root/tempData/dataSet/CURLIST/record/reven_amt"));
						model1.setValue("/root/resData/resTemp/expn_budg_amt", model1.getValue("/root/tempData/dataSet/CURLIST/record/expn_amt"));
						model1.setValue("/root/resData/resTemp/bal_budg_amt", model1.getValue("/root/tempData/dataSet/CURLIST/record/bal_amt"));
						model1.removeNodeset("/root/tempData/dataSet");
						model1.removenode("/root/reqData/reqForm/reven_dt");
						model1.removenode("/root/reqData/reqForm/dept_cd");
						model1.removenode("/root/reqData/reqForm/evnt_cd");
					}
					
					function getRevenExpnAmt() {
						model1.send("en_innexp_1016");
						if (model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt") != "0") {
							model1.setValue("/root/resData/resTemp/tot_reven_amt", model1.getValue("/root/tempData/dataSet/CURLIST/record/reven_stot"));
							model1.setValue("/root/resData/resTemp/tot_expn_amt", model1.getValue("/root/tempData/dataSet/CURLIST/record/expn_stot"));
							model1.setValue("/root/resData/resTemp/tot_bal_amt", model1.getValue("/root/tempData/dataSet/CURLIST/record/bal_stot"));
						}
						model1.removeNodeset("/root/tempData/dataSet");
					}
					
					function getSubTotal() {
						getDrSubTotal(); //차변 합계 계산
						getCrSubTotal(); //대변 합계 계산
					}
					
					function getDrSubTotal() {
						//차변 SUBTOTAL 수행에 따른 합계금액이 계산된 Row를 삭제
						if (grd_dr.valueMatrix(grd_dr.rows-1, 2) == "합계") {
							grd_dr.removeRow(grd_dr.rows-1);
							model1.refresh();
						}
						
						grd_dr.subtotal("sum", -1, 3, "(-)#,###", "background-color:#ffff99; font-weight:bold; color:#0000ff;", 2, "합계");
						grd_dr.cellStyle("text-align", grd_dr.rows-1, 2, grd_dr.rows-1, 2) = "center";
						grd_dr.multiTotals = true;
					}
					
					function getCrSubTotal() {
						//대변 SUBTOTAL 수행에 따른 합계금액이 계산된 Row를 삭제
						if (grd_cr.valueMatrix(grd_cr.rows-1, 2) == "합계") {
							grd_cr.removeRow(grd_cr.rows-1);
							model1.refresh();
						}
						grd_cr.subtotal("sum", -1, 3, "(-)#,###", "background-color:#ffff99; font-weight:bold; color:#0000ff;", 2, "합계");
						grd_cr.cellStyle("text-align", grd_cr.rows-1, 2, grd_cr.rows-1, 2) = "center";
						grd_cr.multiTotals = true;
					}
					
					function initDrSubTotal() {
						//차변 SUBTOTAL 수행에 따른 합계금액이 계산된 Row를 삭제
						grd_dr.subtotal("clear", 0, 0);
						
						/*
						if (grd_dr.valueMatrix(grd_dr.rows-1, 2) == "합계") {
							grd_dr.removeRow(grd_dr.rows-1);
							grd_dr.refresh();
						}
						*/
					}
					
					function initCrSubTotal() {
						//대변 SUBTOTAL 수행에 따른 합계금액이 계산된 Row를 삭제
						grd_cr.subtotal("clear", 0, 0);
						/*
						if (grd_cr.valueMatrix(grd_cr.rows-1, 2) == "합계") {
							grd_cr.removeRow(grd_cr.rows-1);
							grd_cr.refresh();
						}
						*/
					}
					
					//차변, 대변의 예산코드 중복여부 체크
					function chkDrCrBudgCD() {
						var budg_cd = "";
						for (i = 1; i < grd_dr.rows-1; i++) {
							for (j = 1; j < grd_cr.rows-1; j++)
								if (grd_dr.valueMatrix(i, 1) == grd_cr.valueMatrix(j, 1))
									return true;
						}
						return false;
					}
					
					//차변, 대변 합계금액 체크
					function chkDrCrAmt() {
						var dr_amt = 0;
						var cr_amt = 0;
						
						for (i = 1; i < grd_dr.rows-1; i++)
							dr_amt = dr_amt + parseInt(grd_dr.valueMatrix(i, 3));

						for (i = 1; i < grd_cr.rows-1; i++)
							cr_amt = cr_amt + parseInt(grd_cr.valueMatrix(i, 3));
						
						if (dr_amt != 0) {
							if (dr_amt == cr_amt)
								return true;
							else
								return false;
						} else {
							return true;
						}
					}
					
					//발생번호별 전사잔액정보를 조회하여 설정
					function setBalOccrSlip(bal_occr_slip_no) {
						model1.setValue("/root/reqData/searchData/searchDetail/bal_occr_slip_no", bal_occr_slip_no);
						model1.send("en_innexp_1012");
						model1.setValue("/root/resData/resDetailForm/swit_budg_cd", model1.getValue("/root/tempData/dataSet/CURLIST/record/budg_cd"));
						model1.setValue("/root/resData/resDetailForm/swit_budg_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/budg_nm"));
						model1.setValue("/root/resData/resDetailForm/swit_amt", model1.getValue("/root/tempData/dataSet/CURLIST/record/occr_amt"));
						model1.setValue("/root/resData/resDetailForm/swit_extnc_obj_slip_clsf", model1.getValue("/root/tempData/dataSet/CURLIST/record/extnc_obj_slip_clsf"));
						model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_no", model1.getValue("/root/tempData/dataSet/CURLIST/record/extnc_dlco_no"));
						model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/extnc_dlco_nm"));
						model1.setValue("/root/resData/resDetailForm/swit_medi_cd", model1.getValue("/root/tempData/dataSet/CURLIST/record/medi_cd"));
						model1.removeNodeset("/root/tempData/dataSet");
						model1.refresh();
					}
					
					function setVisibleCtrl(value) {
						img1.visible = value;
						input5.visible = value;     //은행구분
						input7.visible = value;     //송금일자
						input10.visible = value;    //은행구분명
						input14.visible = value;    //금액
						input28.visible = value;    //송금처
						caption40.visible = value;
						combo5.visible = !value;    //은행구분
						input22.visible = !value;   //금액
						input30.visible = !value;   //송금일자
						input33.visible = !value;   //송금처
					}
					
					//수입 입력/수정/삭제 처리
					function procReven() {
						//임시 그리드 초기화
						model1.removeNodeset("/root/resData/gridData/grid4");
						model1.makeNode("/root/resData/gridData/grid4");
						grd_detail.refresh();
						grd_detail.addRow();
						
						//필수입력항목 체크
						if (!commReqCheck(grp_main))
							return;
						
						//initDrSubTotal();
						//initCrSubTotal();
						
						
						//미수금대체인 경우 행사종료월 체크하지 않음
						//
						//
						
						
						//행사결산마감에 따른 수입입력가능 여부 체크
						//model1.send("en_innexp_1014");
						//if (model1.getValue("/root/tempData/dataSet/CURLIST/record/stlm_yn") == "Y") {
						//	alert("당 행사는 이미 결산마감 되었으므로 수입입력이 불가능합니다.");
						//	return;
						//}
						
						//사업 수입 일마감 여부 체크
						//model1.send("en_innexp_1015");
						//if (model1.getValue("/root/tempData/dataSet/CURLIST/record/clos_yn") == "Y") {
						//	alert("사업수입 일마감처리 되었으므로 수입입력이 불가능합니다.");
						//	return;
						//}
						
						var dr_amt = 0;
						var cr_amt = 0;
						
						for (i = 1; i < grd_dr.rows-1; i++)
							dr_amt = dr_amt + parseInt(grd_dr.valueMatrix(i, 3));

						for (i = 1; i < grd_cr.rows-1; i++)
							cr_amt = cr_amt + parseInt(grd_cr.valueMatrix(i, 3));

						//if (dr_amt == 0  && cr_amt == 0) {
						if (grd_dr.valueMatrix(1, 1) == "" && grd_cr.valueMatrix(1, 1) == "") {
							alert("차변 또는 대변에 저장할 데이터가 존재하지 않습니다.");
							return;
						}
						
						//if (!chkDrCrAmt()) {
						
						if (dr_amt != 0) {
							if (dr_amt != cr_amt) {	
								alert("차변, 대변 합계 금액이 일치하지 않습니다.");
								return;
							}
						}
						
						if (dr_amt == 0 && cr_amt != 0) {
							if (model1.getValue("/root/resData/resForm/p_upd_occr_dt") == "" || model1.getValue("/root/resData/resForm/p_upd_occr_seq") == "") {
								alert("피수정번호를 입력하십시오.");
								return;
							}
						}				  		
						/*
						if (chkDrCrBudgCD()) {
							alert("차변, 대변에 중복되는 예산코드가 존재합니다.");
							return;
						}
						*/
						//거래처 번호에 해당하는 거래처코드(사업자등록번호 또는 주민등록번호)를 조회
						/*
						model1.makeNode("/root/reqData/searchData/dlco_no");
						model1.setValue("/root/reqData/searchData/dlco_no", model1.getValue("/root/resData/resForm/dlco_no"));
						model1.send("en_innexp_1007");
						var dlco_ern = model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_ern");
						model1.removeNodeset("/root/tempData/dataSet");

						//거래처번호와 거래처구분코드의 유효성 체크
						if (dlco_ern.length == 14) {
							if (model1.getValue("/root/resData/resForm/dlco_clsf_cd") != "94") {
								alert("해당 거래처는 거래처구분 설정이 올바르지 않습니다. [" + dlco_ern + "]");
								return;
							}
						} else if (dlco_ern.length == 12) {
							if (model1.getValue("/root/resData/resForm/dlco_clsf_cd") != "93") {
								alert("해당 거래처는 거래처구분 설정이 올바르지 않습니다. [" + dlco_ern + "]");
								return;
							}
						}
						*/
						//거래처구분코드가 '부서'인 경우
						//if (model1.getValue("/root/resData/resForm/dlco_clsf_cd") == "92") {
						//	
						//}
						
						//차변에 현금 또는 어음계정이 있을 경우 입금표번호 유무체크
						for (i = 1; i < grd_dr.rows; i++) {
							if (grd_dr.valueMatrix(i, 1) == "001100" || grd_dr.valueMatrix(i, 1) == "050100") {
								if (model1.getValue("/root/resData/resForm/rcpm_shet_no") == "") {
									alert("차변에 현금 또는 어음 계정이 존재하는 경우 입금표번호를 입력하십시오.");
									return;
								}
							}
						}
						
						//차변 항목을 임시 그리드에 추가
						for (i = 1; i < grd_dr.rows-1; i++) {
							if (grd_dr.valueMatrix(i, 1) == "")
								break;
						
							if (grd_detail.valueMatrix(grd_detail.rows-1, 1) != "") 
								grd_detail.addRow();
								
							grd_detail.valueMatrix(grd_detail.rows-1, 1) = "1";                        //차대구분
							grd_detail.valueMatrix(grd_detail.rows-1, 2) = grd_dr.valueMatrix(i, 1);   //예산코드
							grd_detail.valueMatrix(grd_detail.rows-1, 3) = grd_dr.valueMatrix(i, 3);   //금액
							grd_detail.valueMatrix(grd_detail.rows-1, 4) = grd_dr.valueMatrix(i, 4);   //계좌관리번호
							grd_detail.valueMatrix(grd_detail.rows-1, 5) = grd_dr.valueMatrix(i, 5);   //송금일자
							grd_detail.valueMatrix(grd_detail.rows-1, 6) = grd_dr.valueMatrix(i, 6);   //송금처(인)
							grd_detail.valueMatrix(grd_detail.rows-1, 7) = grd_dr.valueMatrix(i, 7);   //어음번호
							grd_detail.valueMatrix(grd_detail.rows-1, 8) = grd_dr.valueMatrix(i, 8);   //어음구분
							grd_detail.valueMatrix(grd_detail.rows-1, 9) = grd_dr.valueMatrix(i, 9);   //은행코드
							grd_detail.valueMatrix(grd_detail.rows-1, 10) = grd_dr.valueMatrix(i, 11); //발행자
							grd_detail.valueMatrix(grd_detail.rows-1, 11) = grd_dr.valueMatrix(i, 12); //발행구분
							grd_detail.valueMatrix(grd_detail.rows-1, 12) = grd_dr.valueMatrix(i, 13); //발행일자
							grd_detail.valueMatrix(grd_detail.rows-1, 13) = grd_dr.valueMatrix(i, 14); //만기일자
							grd_detail.valueMatrix(grd_detail.rows-1, 14) = grd_dr.valueMatrix(i, 15); //입금계좌
							grd_detail.valueMatrix(grd_detail.rows-1, 15) = grd_dr.valueMatrix(i, 16); //매출승인번호
							grd_detail.valueMatrix(grd_detail.rows-1, 16) = grd_dr.valueMatrix(i, 17); //잔액발생전표번호
							grd_detail.valueMatrix(grd_detail.rows-1, 17) = grd_dr.valueMatrix(i, 18); //소멸대상전표구분
							grd_detail.valueMatrix(grd_detail.rows-1, 18) = grd_dr.valueMatrix(i, 19); //소멸거래처
							grd_detail.valueMatrix(grd_detail.rows-1, 19) = grd_dr.valueMatrix(i, 20); //매체코드
							grd_detail.valueMatrix(grd_detail.rows-1, 20) = grd_dr.valueMatrix(i, 22); //계좌주 사업자번호
							grd_detail.valueMatrix(grd_detail.rows-1, 21) = grd_dr.valueMatrix(i, 23); //은행ID
							grd_detail.valueMatrix(grd_detail.rows-1, 22) = grd_dr.valueMatrix(i, 24); //계좌번호
							grd_detail.valueMatrix(grd_detail.rows-1, 23) = grd_dr.valueMatrix(i, 25); //거래일자
						
							grd_detail.valueMatrix(grd_detail.rows-1, 24) = grd_dr.valueMatrix(i, 26); //거래일자일련번호
							grd_detail.valueMatrix(grd_detail.rows-1, 25) = grd_dr.valueMatrix(i, 27); //전표번호
							
							//어음계정인 경우 어음삭제시 사용할 임시 변수에 어음번호, 은행코드를 저장
							if (grd_dr.valueMatrix(i, 1) == "050100") {
								model1.setValue("/root/reqData/multiUpDate/chk_note_no", grd_dr.valueMatrix(i, 7));
								model1.setValue("/root/reqData/multiUpDate/chk_bank_cd", grd_dr.valueMatrix(i, 9));
							}
							
							//예수금(대체), 예수금(광고) 필수입력항목 체크
							if (grd_dr.valueMatrix(i, 1) == "463100" || grd_dr.valueMatrix(i, 1) == "456100") {
								if (model1.getValue("/root/resData/resForm/boks_dlco_nm") == "") {
									alert("부거래처명을 입력하십시오.");
									return;
								}
							}
							
							//전사잔액 수정
							if (grd_dr.valueMatrix(i, 1)  == "463100" || grd_dr.valueMatrix(i, 1) == "456100" || grd_dr.valueMatrix(i, 1) == "466800" ||
							    grd_dr.valueMatrix(i, 1)  == "466400" || grd_dr.valueMatrix(i, 1).substring(0, 2) == "41") {
								
							
							}
						}
						
						
						//대변 항목을 임시 그리드에 추가
						for (i = 1; i < grd_cr.rows-1; i++) {
							if (grd_cr.valueMatrix(i, 1) == "")
								break;

							if (grd_detail.valueMatrix(grd_detail.rows-1, 1) != "") 
								grd_detail.addRow();
							
							grd_detail.valueMatrix(grd_detail.rows-1, 1) = "9";                        //차대구분
							grd_detail.valueMatrix(grd_detail.rows-1, 2) = grd_cr.valueMatrix(i, 1);   //예산코드
							grd_detail.valueMatrix(grd_detail.rows-1, 3) = grd_cr.valueMatrix(i, 3);   //금액
							grd_detail.valueMatrix(grd_detail.rows-1, 4) = grd_cr.valueMatrix(i, 4);   //계좌관리번호
							grd_detail.valueMatrix(grd_detail.rows-1, 5) = grd_cr.valueMatrix(i, 5);   //송금일자
							grd_detail.valueMatrix(grd_detail.rows-1, 6) = grd_cr.valueMatrix(i, 6);   //송금처(인)
							grd_detail.valueMatrix(grd_detail.rows-1, 7) = grd_cr.valueMatrix(i, 7);   //어음번호
							grd_detail.valueMatrix(grd_detail.rows-1, 8) = grd_cr.valueMatrix(i, 8);   //어음구분
							grd_detail.valueMatrix(grd_detail.rows-1, 9) = grd_cr.valueMatrix(i, 9);   //은행코드
							grd_detail.valueMatrix(grd_detail.rows-1, 10) = grd_cr.valueMatrix(i, 11); //발행자
							grd_detail.valueMatrix(grd_detail.rows-1, 11) = grd_cr.valueMatrix(i, 12); //발행구분
							grd_detail.valueMatrix(grd_detail.rows-1, 12) = grd_cr.valueMatrix(i, 13); //발행일자
							grd_detail.valueMatrix(grd_detail.rows-1, 13) = grd_cr.valueMatrix(i, 14); //만기일자
							grd_detail.valueMatrix(grd_detail.rows-1, 14) = grd_cr.valueMatrix(i, 15); //입금계좌
							grd_detail.valueMatrix(grd_detail.rows-1, 15) = grd_cr.valueMatrix(i, 16); //매출승인번호
							grd_detail.valueMatrix(grd_detail.rows-1, 16) = grd_cr.valueMatrix(i, 17); //잔액발생전표번호
							grd_detail.valueMatrix(grd_detail.rows-1, 17) = grd_cr.valueMatrix(i, 18); //소멸대상전표구분
							grd_detail.valueMatrix(grd_detail.rows-1, 18) = grd_cr.valueMatrix(i, 19); //소멸거래처
							grd_detail.valueMatrix(grd_detail.rows-1, 19) = grd_cr.valueMatrix(i, 20); //매체코드

							//예수금(대체), 예수금(광고) 체크
							if (grd_dr.valueMatrix(i, 1) == "463100" || grd_dr.valueMatrix(i, 1) == "456100") {
								if (model1.getValue("/root/resData/resForm/boks_dlco_nm") == "") {
									alert("부거래처명을 입력하십시오.");
									return;
								}
							}

							//잡이익
							if (grd_cr.valueMatrix(i, 1).substring(0, 4) == "8035") {
								grd_detail.valueMatrix(grd_detail.rows-1, 8) = grd_cr.valueMatrix(i, 8);
							}
							
							//전사잔액 체크
							//
							//
							//
							
							//미수금잔액 체크
							//
							//
							//
							
						}
						
						var reven_amt = 0;
						var vat_amt = 0;
						var dr_misu_amt = 0;
						var cr_misu_amt = 0;
						var dr_pre_amt = 0;   //차변의 예수금, 선수금, 선수수익 금액
						var rcpm_amt = 0;
						
						for (i = 1; i < grd_cr.rows-1; i++) {
							//대변에 수입계정('60'으로 시작하는 계정)이 있으면 수입금액 처리
							if (grd_cr.valueMatrix(i, 1).substring(0, 2) == "60" || grd_cr.valueMatrix(i, 1) == "803599")
								reven_amt = reven_amt + parseInt(grd_cr.valueMatrix(i, 3));
								
							//대변에 선수수익계정('478300')이 있으면 수입금액 처리
							//if (grd_cr.valueMatrix(i, 1) == "478300")
							//	reven_amt = reven_amt + parseInt(grd_cr.valueMatrix(i, 3));
								
							//대변에 부가세계정('462000')이 있으면 부가세금액 처리
							if (grd_cr.valueMatrix(i, 1) == "462000")
								vat_amt = grd_cr.valueMatrix(i, 3);
								
							//대변에 미수금계정('071300', '072200')이 있으면 미수금액 처리
							if (grd_cr.valueMatrix(i, 1) == "071300" || grd_cr.valueMatrix(i, 1) == "072200" || grd_cr.valueMatrix(i, 1) == "038000" || grd_cr.valueMatrix(i, 1) == "039001")
								cr_misu_amt = grd_cr.valueMatrix(i, 3);
						}
						
						//차변에 미수금계정('071300', '072200')이 있으면 미수금액 처리
						for (i = 1; i < grd_dr.rows-1; i++) {
							if (grd_dr.valueMatrix(i, 1) =="071300" || grd_dr.valueMatrix(i, 1) == "072200" || grd_dr.valueMatrix(i, 1) == "038000" || grd_dr.valueMatrix(i, 1) == "039001")
								dr_misu_amt = grd_dr.valueMatrix(i, 3);

							//if (grd_dr.valueMatrix(i, 1) =="466400" || grd_dr.valueMatrix(i, 1) == "414100" ||
							//    grd_dr.valueMatrix(i, 1) == "478300")
							//	dr_pre_amt = grd_dr.valueMatrix(i, 3); 
						}
						
						//입금금액 계산
						rcpm_amt = (parseInt(reven_amt) + parseInt(vat_amt)) - (parseInt(dr_misu_amt) - parseInt(cr_misu_amt)) - parseInt(dr_pre_amt)

						//대변에 예수금('466400'), 선수금('414100'), 선수수익('478300')이 있으면 입금금액 처리
						for (i = 1; i < grd_cr.rows-1; i++) {
							if (grd_cr.valueMatrix(i, 1) =="466400" || grd_cr.valueMatrix(i, 1) == "414100" || grd_cr.valueMatrix(i, 1) == "466800" ||
							    grd_cr.valueMatrix(i, 1) == "478300")
								rcpm_amt = grd_cr.valueMatrix(i, 3);
						}
						
						//차변은 값이 없고 대변에만 있는 경우는 입금액은 0으로 처리
						var tmp_dr_amt = 0;
						
						for (i = 1; i < grd_dr.rows-1; i++)
							tmp_dr_amt = dr_amt + parseInt(grd_dr.valueMatrix(i, 3));
							
						//차변금액이 '0'이면서 출금구분이 없으면(즉 취소처리이면) 입금액은 '0'으로 처리
						if (tmp_dr_amt == 0 && model1.getValue("/root/resData/resForm/payo_clsf") == "")
							rcpm_amt = "0";
						
						//alert(reven_amt);
						//alert(vat_amt);
						//alert(rcpm_amt);
						
						model1.setValue("/root/resData/resForm/reven_amt", reven_amt);
						model1.setValue("/root/resData/resForm/vat_amt", vat_amt);
						model1.setValue("/root/resData/resForm/rcpm_amt", rcpm_amt);

						//피수정일자와 일련번호가 입력된 경우 체크 수행
						if (model1.getValue("/root/resData/resForm/p_upd_occr_dt") != "") {
							//피수정할 수입금액과 수정전표의 합산금액이 '0'인지 체크
							model1.setValue("/root/reqData/searchData/searchDetail/occr_dt", model1.getValue("/root/resData/resForm/p_upd_occr_dt"));
							model1.setValue("/root/reqData/searchData/searchDetail/slip_clsf_cd", "35");
							model1.setValue("/root/reqData/searchData/searchDetail/occr_seq", model1.getValue("/root/resData/resForm/p_upd_occr_seq"));
							model1.send("en_innexp_1009");
							var tmp_reven_amt = parseInt(model1.getValue("/root/tempData/dataSet/CURLIST/record/reven_amt"));
							var tmp_vat_amt = parseInt(model1.getValue("/root/tempData/dataSet/CURLIST/record/vat_amt"));
							var total_cnt = model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt")
							model1.removeNodeset("/root/tempData/dataSet");
							if (total_cnt == "0") {
								alert("수정대상 수입결의내역이 없습니다. 해당 수입결의내역을 확인하십시오.");
								return;
							}
							if ((parseInt(reven_amt) + parseInt(vat_amt)) + (parseInt(tmp_reven_amt) + parseInt(tmp_vat_amt)) != 0) {
								if (window.alert("수정대상 수입결의 금액과의 합계가 '0' 이 아닙니다. 계속하시겠습니까?", "확인", 1) != 1)
									return;
							}
						}
						
						var mst_mode = model1.getValue("/root/reqData/multiUpDate/mst_mode");
						var node_length = root.reqData.multiUpDate.childNodes.length;
						for (i = 0; i < node_length; i++) {
							model1.removenode(root.reqData.multiUpDate.childNodes(0));
						}

						model1.makeNode("/root/reqData/multiUpDate/mst_mode");
						model1.setValue("/root/reqData/multiUpDate/mst_mode", mst_mode);

						var node_nm = "";
						var node_val = "";
						//수입마스터 등록을 위해 입력값을 multiUpDate 노드에 복사
						for (i = 0; i < root.resData.resForm.childNodes.length; i++) {
							node_nm = root.resData.resForm.childNodes(i).nodeName;
							node_val = root.resData.resForm.childNodes(i).nodeValue;
							model1.makeNode("/root/reqData/multiUpDate/" + node_nm);
							model1.setValue("/root/reqData/multiUpDate/" + node_nm, node_val);
						}
						
						//수입상세 내역 멀티업데이트 처리
						model1.makeNode("/root/reqData/multiUpDate/multiUpdateData");
						for (i = 1; i < grd_detail.rows; i++)
							grd_detail.rowStatus(i) = 1;
						model1.setValue("/root/reqData/multiUpDate/multiUpdateData", grd_detail.getUpdateData());

						//가상계좌입금 내역 멀티업데이트 처리
						model1.makeNode("/root/reqData/multiUpDate/multiUpdateData2");
						for (i = 1; i < datagrid1.rows; i++)
							datagrid1.rowStatus(i) = 1;
						model1.setValue("/root/reqData/multiUpDate/multiUpdateData2", datagrid1.getUpdateData());
						// return; //20100809

						//저장 프로시져 호출
						model1.send("en_innexp_1010");
						
						if (submit_completed()) {
							var occr_dt_fr = model1.getValue("/root/reqData/searchData/occr_dt_fr");
							var occr_dt_to = model1.getValue("/root/reqData/searchData/occr_dt_to");
							var dlco_no = model1.getValue("/root/reqData/searchData/srch_dlco_no");
							var dlco_nm = model1.getValue("/root/reqData/searchData/srch_dlco_nm");
							var titl = model1.getValue("/root/reqData/searchData/srch_titl");
							
							model1.reset();
							initDrSubTotal();
							initCrSubTotal();
							
							model1.setValue("/root/reqData/searchData/occr_dt_fr", occr_dt_fr);
							model1.setValue("/root/reqData/searchData/occr_dt_to", occr_dt_to);
							model1.setValue("/root/reqData/searchData/srch_dlco_no", dlco_no);
							model1.setValue("/root/reqData/searchData/srch_dlco_nm", dlco_nm);
							model1.setValue("/root/reqData/searchData/srch_titl", titl);
							
							btn_srch.dispatch("onclick");
							
							//수입내역 상세 조회시 차변, 대변의 '추가' 버튼을 비활성화 시킴
							button3.disabled = false;
							button5.disabled = false;
							
							//수입내역 상세 조회시 차변, 대변의 '삭제' 버튼을 비활성화 시킴
							button4.disabled = false;
							button6.disabled = false;
							
							//수입내역 상세 조회시 차변의 '가상추가' 버튼을 비활성화 시킴
							button7.disabled = false;

							button2.visible = false;
						}
					}
			           //수입 입력/수정/삭제 처리
					function procReven_GsgJ() {
						//임시 그리드 초기화
						model1.removeNodeset("/root/resData/gridData/grid4");
						model1.makeNode("/root/resData/gridData/grid4");
						grd_detail.refresh();
						grd_detail.addRow();
						
						//필수입력항목 체크
						if (!commReqCheck(grp_main))
							return;
						
						//initDrSubTotal();
						//initCrSubTotal();
						
						
						//미수금대체인 경우 행사종료월 체크하지 않음
						//
						//
						
						
						//행사결산마감에 따른 수입입력가능 여부 체크
						//model1.send("en_innexp_1014");
						//if (model1.getValue("/root/tempData/dataSet/CURLIST/record/stlm_yn") == "Y") {
						//	alert("당 행사는 이미 결산마감 되었으므로 수입입력이 불가능합니다.");
						//	return;
						//}
						
						//사업 수입 일마감 여부 체크
						//model1.send("en_innexp_1015");
						//if (model1.getValue("/root/tempData/dataSet/CURLIST/record/clos_yn") == "Y") {
						//	alert("사업수입 일마감처리 되었으므로 수입입력이 불가능합니다.");
						//	return;
						//}
						
						var dr_amt = 0;
						var cr_amt = 0;
						
						for (i = 1; i < grd_dr.rows-1; i++)
							dr_amt = dr_amt + parseInt(grd_dr.valueMatrix(i, 3));

						for (i = 1; i < grd_cr.rows-1; i++)
							cr_amt = cr_amt + parseInt(grd_cr.valueMatrix(i, 3));

						//if (dr_amt == 0  && cr_amt == 0) {
						if (grd_dr.valueMatrix(1, 1) == "" && grd_cr.valueMatrix(1, 1) == "") {
							alert("차변 또는 대변에 저장할 데이터가 존재하지 않습니다.");
							return;
						}
						
						//if (!chkDrCrAmt()) {
						
						if (dr_amt != 0) {
							if (dr_amt != cr_amt) {	
								alert("차변, 대변 합계 금액이 일치하지 않습니다.");
								return;
							}
						}
						
						if (dr_amt == 0 && cr_amt != 0) {
							if (model1.getValue("/root/resData/resForm/p_upd_occr_dt") == "" || model1.getValue("/root/resData/resForm/p_upd_occr_seq") == "") {
								alert("피수정번호를 입력하십시오.");
								return;
							}
						}
						
						//차변계정 합계가 '0'이면 환불 또는 취소
						if (dr_amt == 0) {
							//출금구분 값이 없으면 취소처리임
							if (model1.getValue("/root/resData/resForm/payo_clsf") == "") {
								//취소처리시 수입결의일자와 피수정일자가 같아야 함
								if (model1.getValue("/root/resData/resForm/reven_dt") != model1.getValue("/root/resData/resForm/p_upd_occr_dt")) {
									alert("수입결의일자와 피수정일자가 다릅니다.");
									return;
								}
							}
						}
					    /*	
						if (chkDrCrBudgCD()) {
							alert("차변, 대변에 중복되는 예산코드가 존재합니다.");
							return;
						}
						*/
						//거래처 번호에 해당하는 거래처코드(사업자등록번호 또는 주민등록번호)를 조회
						/*
						model1.makeNode("/root/reqData/searchData/dlco_no");
						model1.setValue("/root/reqData/searchData/dlco_no", model1.getValue("/root/resData/resForm/dlco_no"));
						model1.send("en_innexp_1007");
						var dlco_ern = model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_ern");
						model1.removeNodeset("/root/tempData/dataSet");

						//거래처번호와 거래처구분코드의 유효성 체크
						if (dlco_ern.length == 14) {
							if (model1.getValue("/root/resData/resForm/dlco_clsf_cd") != "94") {
								alert("해당 거래처는 거래처구분 설정이 올바르지 않습니다. [" + dlco_ern + "]");
								return;
							}
						} else if (dlco_ern.length == 12) {
							if (model1.getValue("/root/resData/resForm/dlco_clsf_cd") != "93") {
								alert("해당 거래처는 거래처구분 설정이 올바르지 않습니다. [" + dlco_ern + "]");
								return;
							}
						}
						*/
						//거래처구분코드가 '부서'인 경우
						//if (model1.getValue("/root/resData/resForm/dlco_clsf_cd") == "92") {
						//	
						//}
						
					     //차변에 현금 또는 어음계정이 있을 경우 입금표번호 유무체크
						for (i = 1; i < grd_dr.rows; i++) {
							if (grd_dr.valueMatrix(i, 1) == "001100" || grd_dr.valueMatrix(i, 1) == "050100") {
								if (model1.getValue("/root/resData/resForm/rcpm_shet_no") == "") {
									alert("차변에 현금 또는 어음 계정이 존재하는 경우 입금표번호를 입력하십시오.");
									return;
								}
							}
						}
						
						
					        /* 가상계좌 입금액 체크  Start @@@ */		
											
						 var  wk_output1_amt =  parseInt(output1.value);
				
				                if  (dr_amt != wk_output1_amt)  {	
						     alert("가상계좌 입금액 합이 일치하지 않습니다.");
						     alert(dr_amt );
						     alert(wk_output1_amt);
						     return;
						  }
							
						 /* 가상계좌 입금액 체크  End @@@ */   
						
					
						//차변 항목을 임시 그리드에 추가
						for (i = 1; i < grd_dr.rows-1; i++) {
							if (grd_dr.valueMatrix(i, 1) == "")
								break;
								
							if (grd_detail.valueMatrix(grd_detail.rows-1, 1) != "") 
								grd_detail.addRow();
							
							grd_detail.valueMatrix(grd_detail.rows-1, 1) = "1";                        //차대구분
							grd_detail.valueMatrix(grd_detail.rows-1, 2) = grd_dr.valueMatrix(i, 1);   //예산코드
							grd_detail.valueMatrix(grd_detail.rows-1, 3) = grd_dr.valueMatrix(i, 3);   //금액
							grd_detail.valueMatrix(grd_detail.rows-1, 4) = grd_dr.valueMatrix(i, 4);   //계좌관리번호
							grd_detail.valueMatrix(grd_detail.rows-1, 5) = grd_dr.valueMatrix(i, 5);   //송금일자
							grd_detail.valueMatrix(grd_detail.rows-1, 6) = grd_dr.valueMatrix(i, 6);   //송금처(인)
							grd_detail.valueMatrix(grd_detail.rows-1, 7) = grd_dr.valueMatrix(i, 7);   //어음번호
							grd_detail.valueMatrix(grd_detail.rows-1, 8) = grd_dr.valueMatrix(i, 8);   //어음구분
							grd_detail.valueMatrix(grd_detail.rows-1, 9) = grd_dr.valueMatrix(i, 9);   //은행코드
							grd_detail.valueMatrix(grd_detail.rows-1, 10) = grd_dr.valueMatrix(i, 11); //발행자
							grd_detail.valueMatrix(grd_detail.rows-1, 11) = grd_dr.valueMatrix(i, 12); //발행구분
							grd_detail.valueMatrix(grd_detail.rows-1, 12) = grd_dr.valueMatrix(i, 13); //발행일자
							grd_detail.valueMatrix(grd_detail.rows-1, 13) = grd_dr.valueMatrix(i, 14); //만기일자
							grd_detail.valueMatrix(grd_detail.rows-1, 14) = grd_dr.valueMatrix(i, 15); //입금계좌
							grd_detail.valueMatrix(grd_detail.rows-1, 15) = grd_dr.valueMatrix(i, 16); //매출승인번호
							grd_detail.valueMatrix(grd_detail.rows-1, 16) = grd_dr.valueMatrix(i, 17); //잔액발생전표번호
							grd_detail.valueMatrix(grd_detail.rows-1, 17) = grd_dr.valueMatrix(i, 18); //소멸대상전표구분
							grd_detail.valueMatrix(grd_detail.rows-1, 18) = grd_dr.valueMatrix(i, 19); //소멸거래처
							grd_detail.valueMatrix(grd_detail.rows-1, 19) = grd_dr.valueMatrix(i, 20); //매체코드
							grd_detail.valueMatrix(grd_detail.rows-1, 20) = grd_dr.valueMatrix(i, 22); //계좌주 사업자번호
							grd_detail.valueMatrix(grd_detail.rows-1, 21) = grd_dr.valueMatrix(i, 23); //은행ID
							grd_detail.valueMatrix(grd_detail.rows-1, 22) = grd_dr.valueMatrix(i, 24); //계좌번호
							grd_detail.valueMatrix(grd_detail.rows-1, 23) = grd_dr.valueMatrix(i, 25); //거래일자
						
							grd_detail.valueMatrix(grd_detail.rows-1, 24) = grd_dr.valueMatrix(i, 26); //거래일자일련번호
							grd_detail.valueMatrix(grd_detail.rows-1, 25) = grd_dr.valueMatrix(i, 27); //전표번호
							
							//어음계정인 경우 어음삭제시 사용할 임시 변수에 어음번호, 은행코드를 저장
							if (grd_dr.valueMatrix(i, 1) == "050100") {
								model1.setValue("/root/reqData/multiUpDate/chk_note_no", grd_dr.valueMatrix(i, 7));
								model1.setValue("/root/reqData/multiUpDate/chk_bank_cd", grd_dr.valueMatrix(i, 9));
							}
							
							//예수금(대체), 예수금(광고) 필수입력항목 체크
							if (grd_dr.valueMatrix(i, 1) == "463100" || grd_dr.valueMatrix(i, 1) == "456100") {
								if (model1.getValue("/root/resData/resForm/boks_dlco_nm") == "") {
									alert("부거래처명을 입력하십시오.");
									return;
								}
							}
							
							//전사잔액 수정
							if (grd_dr.valueMatrix(i, 1) == "463100" || grd_dr.valueMatrix(i, 1) == "456100" || grd_dr.valueMatrix(i, 1) == "466800" ||
							    grd_dr.valueMatrix(i, 1) == "466400" || grd_dr.valueMatrix(i, 1).substring(0, 2) == "41") {
								
							
							}
						}
						
						
						//대변 항목을 임시 그리드에 추가
						for (i = 1; i < grd_cr.rows-1; i++) {
							if (grd_cr.valueMatrix(i, 1) == "")
								break;

							if (grd_detail.valueMatrix(grd_detail.rows-1, 1) != "") 
								grd_detail.addRow();
							
							grd_detail.valueMatrix(grd_detail.rows-1, 1) = "9";                        //차대구분
							grd_detail.valueMatrix(grd_detail.rows-1, 2) = grd_cr.valueMatrix(i, 1);   //예산코드
							grd_detail.valueMatrix(grd_detail.rows-1, 3) = grd_cr.valueMatrix(i, 3);   //금액
							grd_detail.valueMatrix(grd_detail.rows-1, 4) = grd_cr.valueMatrix(i, 4);   //계좌관리번호
							grd_detail.valueMatrix(grd_detail.rows-1, 5) = grd_cr.valueMatrix(i, 5);   //송금일자
							grd_detail.valueMatrix(grd_detail.rows-1, 6) = grd_cr.valueMatrix(i, 6);   //송금처(인)
							grd_detail.valueMatrix(grd_detail.rows-1, 7) = grd_cr.valueMatrix(i, 7);   //어음번호
							grd_detail.valueMatrix(grd_detail.rows-1, 8) = grd_cr.valueMatrix(i, 8);   //어음구분
							grd_detail.valueMatrix(grd_detail.rows-1, 9) = grd_cr.valueMatrix(i, 9);   //은행코드
							grd_detail.valueMatrix(grd_detail.rows-1, 10) = grd_cr.valueMatrix(i, 11); //발행자
							grd_detail.valueMatrix(grd_detail.rows-1, 11) = grd_cr.valueMatrix(i, 12); //발행구분
							grd_detail.valueMatrix(grd_detail.rows-1, 12) = grd_cr.valueMatrix(i, 13); //발행일자
							grd_detail.valueMatrix(grd_detail.rows-1, 13) = grd_cr.valueMatrix(i, 14); //만기일자
							grd_detail.valueMatrix(grd_detail.rows-1, 14) = grd_cr.valueMatrix(i, 15); //입금계좌
							grd_detail.valueMatrix(grd_detail.rows-1, 15) = grd_cr.valueMatrix(i, 16); //매출승인번호
							grd_detail.valueMatrix(grd_detail.rows-1, 16) = grd_cr.valueMatrix(i, 17); //잔액발생전표번호
							grd_detail.valueMatrix(grd_detail.rows-1, 17) = grd_cr.valueMatrix(i, 18); //소멸대상전표구분
							grd_detail.valueMatrix(grd_detail.rows-1, 18) = grd_cr.valueMatrix(i, 19); //소멸거래처
							grd_detail.valueMatrix(grd_detail.rows-1, 19) = grd_cr.valueMatrix(i, 20); //매체코드

							//예수금(대체), 예수금(광고) 체크
							if (grd_dr.valueMatrix(i, 1) == "463100" || grd_dr.valueMatrix(i, 1) == "456100") {
								if (model1.getValue("/root/resData/resForm/boks_dlco_nm") == "") {
									alert("부거래처명을 입력하십시오.");
									return;
								}
							}

							//잡이익
							if (grd_cr.valueMatrix(i, 1).substring(0, 4) == "8035") {
								grd_detail.valueMatrix(grd_detail.rows-1, 8) = grd_cr.valueMatrix(i, 8);
							}
							
							//전사잔액 체크
							//
							//
							//
							
							//미수금잔액 체크
							//
							//
							//
							
						}
						
						var reven_amt = 0;
						var vat_amt = 0;
						var dr_misu_amt = 0;
						var cr_misu_amt = 0;
						var dr_pre_amt = 0;   //차변의 예수금, 선수금, 선수수익 금액
						var rcpm_amt = 0;
						
						for (i = 1; i < grd_cr.rows-1; i++) {
							//대변에 수입계정('60'으로 시작하는 계정)이 있으면 수입금액 처리
							if (grd_cr.valueMatrix(i, 1).substring(0, 2) == "60" || grd_cr.valueMatrix(i, 1) == "803599")
								reven_amt = reven_amt + parseInt(grd_cr.valueMatrix(i, 3));
								
							//대변에 선수수익계정('478300')이 있으면 수입금액 처리
							//if (grd_cr.valueMatrix(i, 1) == "478300")
							//	reven_amt = reven_amt + parseInt(grd_cr.valueMatrix(i, 3));
								
							//대변에 부가세계정('462000')이 있으면 부가세금액 처리
							if (grd_cr.valueMatrix(i, 1) == "462000")
								vat_amt = grd_cr.valueMatrix(i, 3);
								
							//대변에 미수금계정('071300', '072200')이 있으면 미수금액 처리
							if (grd_cr.valueMatrix(i, 1) == "071300" || grd_cr.valueMatrix(i, 1) == "072200" || grd_cr.valueMatrix(i, 1) == "038000" || grd_cr.valueMatrix(i, 1) == "039001")
								cr_misu_amt = grd_cr.valueMatrix(i, 3);
						}
						
						//차변에 미수금계정('071300', '072200')이 있으면 미수금액 처리
						for (i = 1; i < grd_dr.rows-1; i++) {
							if (grd_dr.valueMatrix(i, 1) =="071300" || grd_dr.valueMatrix(i, 1) == "072200" || grd_dr.valueMatrix(i, 1) == "038000" || grd_dr.valueMatrix(i, 1) == "039001")
								dr_misu_amt = grd_dr.valueMatrix(i, 3);

							//if (grd_dr.valueMatrix(i, 1) =="466400" || grd_dr.valueMatrix(i, 1) == "414100" ||
							//    grd_dr.valueMatrix(i, 1) == "478300")
							//	dr_pre_amt = grd_dr.valueMatrix(i, 3); 
						}
						
						//입금금액 계산
						rcpm_amt = (parseInt(reven_amt) + parseInt(vat_amt)) - (parseInt(dr_misu_amt) - parseInt(cr_misu_amt)) - parseInt(dr_pre_amt)

						//대변에 예수금('466400'), 선수금('414100'), 선수수익('478300')이 있으면 입금금액 처리
						for (i = 1; i < grd_cr.rows-1; i++) {
							if (grd_cr.valueMatrix(i, 1) =="466400" || grd_cr.valueMatrix(i, 1) == "414100" || grd_cr.valueMatrix(i, 1) == "466800" ||
							    grd_cr.valueMatrix(i, 1) == "478300")
								rcpm_amt = grd_cr.valueMatrix(i, 3);
						}
						
						//차변은 값이 없고 대변에만 있는 경우는 입금액은 0으로 처리
						var tmp_dr_amt = 0;
						
						for (i = 1; i < grd_dr.rows-1; i++)
							tmp_dr_amt = dr_amt + parseInt(grd_dr.valueMatrix(i, 3));
							
						//차변금액이 '0'이면서 출금구분이 없으면(즉 취소처리이면) 입금액은 '0'으로 처리
						if (tmp_dr_amt == 0 && model1.getValue("/root/resData/resForm/payo_clsf") == "")
							rcpm_amt = "0";
						
						//alert(reven_amt);
						//alert(vat_amt);
						//alert(rcpm_amt);
						
						model1.setValue("/root/resData/resForm/reven_amt", reven_amt);
						model1.setValue("/root/resData/resForm/vat_amt", vat_amt);
						model1.setValue("/root/resData/resForm/rcpm_amt", rcpm_amt);

						//피수정일자와 일련번호가 입력된 경우 체크 수행
						if (model1.getValue("/root/resData/resForm/p_upd_occr_dt") != "") {
							//피수정할 수입금액과 수정전표의 합산금액이 '0'인지 체크
							model1.setValue("/root/reqData/searchData/searchDetail/occr_dt", model1.getValue("/root/resData/resForm/p_upd_occr_dt"));
							model1.setValue("/root/reqData/searchData/searchDetail/slip_clsf_cd", "35");
							model1.setValue("/root/reqData/searchData/searchDetail/occr_seq", model1.getValue("/root/resData/resForm/p_upd_occr_seq"));
							model1.send("en_innexp_1009");
							var tmp_reven_amt = parseInt(model1.getValue("/root/tempData/dataSet/CURLIST/record/reven_amt"));
							var tmp_vat_amt = parseInt(model1.getValue("/root/tempData/dataSet/CURLIST/record/vat_amt"));
							var total_cnt = model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt")
							model1.removeNodeset("/root/tempData/dataSet");
							if (total_cnt == "0") {
								alert("수정대상 수입결의내역이 없습니다. 해당 수입결의내역을 확인하십시오.");
								return;
							}
							if ((parseInt(reven_amt) + parseInt(vat_amt)) + (parseInt(tmp_reven_amt) + parseInt(tmp_vat_amt)) != 0) {
								if (window.alert("수정대상 수입결의 금액과의 합계가 '0' 이 아닙니다. 계속하시겠습니까?", "확인", 1) != 1)
									return;
							}
						}
						
						var mst_mode = model1.getValue("/root/reqData/multiUpDate/mst_mode");
						var node_length = root.reqData.multiUpDate.childNodes.length;
						for (i = 0; i < node_length; i++) {
							model1.removenode(root.reqData.multiUpDate.childNodes(0));
						}

						model1.makeNode("/root/reqData/multiUpDate/mst_mode");
						model1.setValue("/root/reqData/multiUpDate/mst_mode", mst_mode);

						var node_nm = "";
						var node_val = "";
						//수입마스터 등록을 위해 입력값을 multiUpDate 노드에 복사
						for (i = 0; i < root.resData.resForm.childNodes.length; i++) {
							node_nm = root.resData.resForm.childNodes(i).nodeName;
							node_val = root.resData.resForm.childNodes(i).nodeValue;
							model1.makeNode("/root/reqData/multiUpDate/" + node_nm);
							model1.setValue("/root/reqData/multiUpDate/" + node_nm, node_val);
						}
						
						//수입상세 내역 멀티업데이트 처리
						model1.makeNode("/root/reqData/multiUpDate/multiUpdateData");
						for (i = 1; i < grd_detail.rows; i++)
							grd_detail.rowStatus(i) = 1;
						model1.setValue("/root/reqData/multiUpDate/multiUpdateData", grd_detail.getUpdateData());

						//가상계좌입금 내역 멀티업데이트 처리
						model1.makeNode("/root/reqData/multiUpDate/multiUpdateData2");
						for (i = 1; i < datagrid1.rows; i++)
							datagrid1.rowStatus(i) = 1;
						model1.setValue("/root/reqData/multiUpDate/multiUpdateData2", datagrid1.getUpdateData());
						// return; //20100809

						//저장 프로시져 호출
						model1.send("en_innexp_1020");
						
						if (submit_completed()) {
							var occr_dt_fr = model1.getValue("/root/reqData/searchData/occr_dt_fr");
							var occr_dt_to = model1.getValue("/root/reqData/searchData/occr_dt_to");
							var dlco_no = model1.getValue("/root/reqData/searchData/srch_dlco_no");
							var dlco_nm = model1.getValue("/root/reqData/searchData/srch_dlco_nm");
							var titl = model1.getValue("/root/reqData/searchData/srch_titl");
							
							model1.reset();
							initDrSubTotal();
							initCrSubTotal();
							
							model1.setValue("/root/reqData/searchData/occr_dt_fr", occr_dt_fr);
							model1.setValue("/root/reqData/searchData/occr_dt_to", occr_dt_to);
							model1.setValue("/root/reqData/searchData/srch_dlco_no", dlco_no);
							model1.setValue("/root/reqData/searchData/srch_dlco_nm", dlco_nm);
							model1.setValue("/root/reqData/searchData/srch_titl", titl);
							
							btn_srch.dispatch("onclick");
							
							//수입내역 상세 조회시 차변, 대변의 '추가' 버튼을 비활성화 시킴
							button3.disabled = false;
							button5.disabled = false;
							
							//수입내역 상세 조회시 차변, 대변의 '삭제' 버튼을 비활성화 시킴
							button4.disabled = false;
							button6.disabled = false;
							
							//수입내역 상세 조회시 차변의 '가상추가' 버튼을 비활성화 시킴
                                                     button7.disabled = false;

							button2.visible = false;
						}
					}		
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					// session 정보 셋팅
					model.setValue("/root/initData/session/uid", getProperty("ss_uid")); 		     	// 아이디
					model.setValue("/root/initData/session/cmpy_cd", getProperty("ss_cmpycd"));		// 회사
					model.setValue("/root/initData/session/emp_no", getProperty("ss_emp_no"));      	// 사번
					model.setValue("/root/initData/session/emp_nm", getProperty("ss_emp_nm"));     	// 성명
					model.setValue("/root/initData/session/dept_cd", getProperty("ss_deptcd"));      	// 부서
					model.setValue("/root/initData/session/dept_nm", getProperty("ss_deptnm"));      	// 부서명

					var addDate = addDay(commCurDate("y"), commCurDate("m"), commCurDate("d"), -7);
					year = addDate.getYear();
					month = addDate.getMonth()+1;
					date = addDate.getDate();
					if(month < 10)
						month = "0" + month;
					if(date < 10)
						date = "0" + date;
						
					var from_date = year + "" + month + "" + date;
					model1.setValue("/root/reqData/searchData/occr_dt_fr", from_date);
					
					//현재날짜 설정
					model1.setValue("/root/reqData/searchData/occr_dt_to", commCurDate("ymd"));
					model1.setValue("/root/reqData/searchData/searchDetail/clos_dt", commCurDate("ymd"));
					model1.setValue("/root/resData/resForm/reven_dt", commCurDate("ymd"));

					btn_reven.dispatch("onclick");
					btn_deps.dispatch("onclick");

					//콤보데이터 설정
					model1.send("en_innexp_1000");
					makeComboSet("", "/root/tempData/dataSet/CURLIST1/record", "/root/initData/comboSet/medi_cd", "cdabrvnm_cd", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST2/record", "/root/initData/comboSet/rcpm_shet_kind", "cdabrvnm_cd", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST3/record", "/root/initData/comboSet/acct_mang_no", "cdabrvnm_cd", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST4/record", "/root/initData/comboSet/note_clsf", "cdabrvnm_cd", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST5/record", "/root/initData/comboSet/note_issu_clsf", "cdabrvnm_cd", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST6/record", "/root/initData/comboSet/slip_clsf_cd", "cdabrvnm_cd", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST7/record", "/root/initData/comboSet/dlco_clsf_cd", "cdabrvnm_cd", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST8/record", "/root/initData/comboSet/payo_clsf", "cdabrvnm_cd", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST9/record", "/root/initData/comboSet/budg_cd", "cdnm_cd", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST10/record", "/root/initData/comboSet/trufnd_budg_cd", "cdnm_cd", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST11/record", "/root/initData/comboSet/evnt_yy", "evnt_yy", "evnt_yy")
					model1.removeNodeset("/root/tempData/dataSet");
					
					//현재년도 조회
					//model1.send("en_evnt_1001");
					//makeComboSet("", "/root/tempData/dataSet/CURLIST/record", "/root/initData/comboSet/evnt_yy", "evnt_yy", "evnt_yy")
					//model1.removeNodeset("/root/tempData/dataSet");
					
					//현재년도 설정
					model1.setValue("/root/resData/resForm/evnt_yy", commCurDate("y"));

					//입금표종류 초기값 설정
					model1.setValue("/root/resData/resForm/rcpm_shet_kind", "2");
					
					//통장예금 탭의 컨트롤 설정
					setVisibleCtrl(true);
					
					model1.refresh();
				]]>
			</script>
			<submission id="en_comm_1001" action="/en/comm/1001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="en_comm_1003" action="/en/comm/1003" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="en_comm_1004" action="/en/comm/1004" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="en_comm_1005" action="/en/comm/1005" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="en_evnt_1001" action="/en/evnt/1001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1000" action="/en/innexp/1000" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1001" action="/en/innexp/1001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1002" action="/en/innexp/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchDetail" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1003" action="/en/innexp/1003" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1004" action="/en/innexp/1004" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1005" action="/en/innexp/1005" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1006" action="/en/innexp/1006" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1007" action="/en/innexp/1007" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1008" action="/en/innexp/1008" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1009" action="/en/innexp/1009" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchDetail" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1010" action="/en/innexp/1010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1011" action="/en/innexp/1011" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1012" action="/en/innexp/1012" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchDetail" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1013" action="/en/innexp/1013" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchDetail" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1014" action="/en/innexp/1014" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1015" action="/en/innexp/1015" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchDetail" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1016" action="/en/innexp/1016" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1019" action="/en/innexp/1019" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1020" action="/en/innexp/1020" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/tempData/dataSet"/>
		</model>
		<script type="javascript" src="/js/en_common.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/TFCommon.js"/>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="2,720;1,937;" style="font-family:굴림; ">
		<group id="grp_main" class="gro_sel" style="left:10px; top:345px; width:927px; height:376px; ">
			<caption id="caption2" class="list_cap02" style="left:836px; top:179px; width:91px; height:26px; font-family:굴림; font-size:9pt; font-weight:bold; text-align:center; background-color:#fefeee; "/>
			<caption id="caption10" class="list_cap02" style="left:836px; top:204px; width:91px; height:26px; font-family:굴림; font-size:9pt; font-weight:bold; text-align:center; background-color:#fefeee; "/>
			<caption id="caption64" class="list_cap02" style="left:746px; top:154px; width:91px; height:26px; font-family:굴림; font-size:9pt; font-weight:bold; text-align:center; background-color:#fefeee; "/>
			<caption id="caption5" class="list_cap02" style="left:79px; top:25px; width:848px; height:26px; text-align:center; border-style:solid; "/>
			<caption id="caption89" class="list_cap02" style="left:79px; top:50px; width:848px; height:26px; text-align:center; border-style:solid; "/>
			<caption id="caption86" class="list_cap02" style="left:79px; top:0px; width:848px; height:26px; text-align:center; border-style:solid; "/>
			<caption id="caption92" class="list_cap03" style="left:0px; top:50px; width:80px; height:26px; ">제     목</caption>
			<datagrid id="grd_dr" nodeset="/root/resData/gridData/gridData2/record" caption="계정코드^계정과목^금액^caption1^caption2^caption3^caption4^caption5^caption6^caption7^caption8^caption9^caption10^caption11^caption12^caption13^caption14^caption15^caption16^caption17^caption18^caption19^caption20^caption21^caption22^caption23^caption24^caption25" colsep="#" colwidth="70, 158, 90, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" frozenbottomrows="1" mergecellsfixedrows="bycolrec" rowheader="seq" rowheight="20" rowsep="|" subtotalposition="below" style="left:0px; top:98px; width:335px; height:132px; ">
				<col ref="budg_cd" type="output" style="left:0px; top:20px; width:100px; height:20px; text-align:center; "/>
				<col ref="budg_nm" type="output" style="left:100px; top:20px; width:233px; height:20px; text-align:left; "/>
				<col ref="amt" type="output" format="(-)#,###" style="text-align:right; ">
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
							getDrSubTotal();
						]]>
					</script>
				</col>
				<col ref="acct_mang_no" visibility="hidden"/>
				<col ref="rmtt_dt" visibility="hidden"/>
				<col ref="rmtt_plac" visibility="hidden"/>
				<col ref="note_no" visibility="hidden"/>
				<col ref="note_clsf_cd" visibility="hidden"/>
				<col ref="bank_cd" visibility="hidden"/>
				<col ref="bank_nm" visibility="hidden"/>
				<col ref="issu_pers_nm" visibility="hidden"/>
				<col ref="issu_cmpy_clsf_cd" visibility="hidden"/>
				<col ref="comp_dt" visibility="hidden"/>
				<col ref="mtry_dt" visibility="hidden"/>
				<col ref="rcpm_acct" visibility="hidden"/>
				<col ref="sale_aprv_no" visibility="hidden"/>
				<col ref="bal_occr_slip_no" visibility="hidden"/>
				<col ref="extnc_obj_slip_clsf" visibility="hidden"/>
				<col ref="extnc_dlco_no" visibility="hidden"/>
				<col ref="medi_cd" visibility="hidden"/>
				<col ref="acct_mang_nm" visibility="hidden"/>
				<col ref="biz_reg_no" visibility="hidden"/>
				<col ref="bank_id" visibility="hidden"/>
				<col ref="acct_num" visibility="hidden"/>
				<col ref="tran_date" visibility="hidden"/>
				<col ref="tran_date_seq" visibility="hidden"/>
				<col ref="slip_no" visibility="hidden"/>
				<script type="javascript" ev:event="ondblclick">
					<![CDATA[
						if(grd_dr.row == 0) return;	
						
						if (grd_dr.valueMatrix(grd_dr.row, 1) == "") return;
						
						var selectedIdx = grd_dr.row;
						var budg_cd = grd_dr.valueMatrix(selectedIdx, 1);
						
						//예산코드 '현금'일 경우
						if (budg_cd == "001100") {
							btn_cash.dispatch("onclick");
							model1.setValue("/root/resData/resDetailForm/cash_amt", grd_dr.valueMatrix(selectedIdx, 3));
							
							//출금구분 값이 있으면 입금발생일자와 입금발생일련번호 세팅
							if (model1.getValue("/root/resData/resForm/payo_clsf") != "") {
								model1.setValue("/root/resData/resDetailForm/cash_payo_clsf_cd", model1.getValue("/root/resData/resForm/payo_clsf"));
								model1.setValue("/root/resData/resDetailForm/cash_rcpm_occr_dt", model1.getValue("/root/resData/resForm/rcpm_occr_dt"));
								model1.setValue("/root/resData/resDetailForm/cash_rcpm_occr_seq", model1.getValue("/root/resData/resForm/rcpm_occr_seq"));
							}
						}
						
						//예산코드 '보통예금'일 경우
						if (budg_cd == "011400" || budg_cd == "017500" || budg_cd == "017300") {
							btn_deps.dispatch("onclick");
							model1.setValue("/root/resData/resDetailForm/deps_amt", grd_dr.valueMatrix(selectedIdx, 3));
							model1.setValue("/root/resData/resDetailForm/deps_acct_mang_no", grd_dr.valueMatrix(selectedIdx, 4));
							model1.setValue("/root/resData/resDetailForm/deps_acct_mang_nm", grd_dr.valueMatrix(selectedIdx, 21));
							model1.setValue("/root/resData/resDetailForm/deps_rmtt_dt", grd_dr.valueMatrix(selectedIdx, 5));
							model1.setValue("/root/resData/resDetailForm/deps_rmtt_plac", grd_dr.valueMatrix(selectedIdx, 6));

							model1.setValue("/root/resData/resDetailForm/deps_biz_reg_no", grd_dr.valueMatrix(selectedIdx, 22));
							model1.setValue("/root/resData/resDetailForm/deps_bank_id", grd_dr.valueMatrix(selectedIdx, 23));
							model1.setValue("/root/resData/resDetailForm/deps_acct_num", grd_dr.valueMatrix(selectedIdx, 24));
							model1.setValue("/root/resData/resDetailForm/deps_tran_date", grd_dr.valueMatrix(selectedIdx, 25));
							model1.setValue("/root/resData/resDetailForm/deps_tran_date_seq", grd_dr.valueMatrix(selectedIdx, 26));
							model1.setValue("/root/resData/resDetailForm/deps_slip_no", grd_dr.valueMatrix(selectedIdx, 27));


							//출금구분 값이 있으면 입금발생일자와 입금발생일련번호 세팅
							if (model1.getValue("/root/resData/resForm/payo_clsf") != "") {
								model1.setValue("/root/resData/resDetailForm/deps_payo_clsf_cd", model1.getValue("/root/resData/resForm/payo_clsf"));
								model1.setValue("/root/resData/resDetailForm/deps_rcpm_occr_dt", model1.getValue("/root/resData/resForm/rcpm_occr_dt"));
								model1.setValue("/root/resData/resDetailForm/deps_rcpm_occr_seq", model1.getValue("/root/resData/resForm/rcpm_occr_seq"));
							}
						}
						
						//예산코드 '받을어음(기업구매카드)'일 경우
						if (budg_cd == "050100") {
							btn_note.dispatch("onclick");
							model1.setValue("/root/resData/resDetailForm/note_rcpm_amt", grd_dr.valueMatrix(selectedIdx, 3));
							model1.setValue("/root/resData/resDetailForm/note_note_no", grd_dr.valueMatrix(selectedIdx, 7));
							model1.setValue("/root/resData/resDetailForm/note_note_clsf_cd", grd_dr.valueMatrix(selectedIdx, 8));
							model1.setValue("/root/resData/resDetailForm/note_bank_cd", grd_dr.valueMatrix(selectedIdx, 9));
							model1.setValue("/root/resData/resDetailForm/note_bank_nm", grd_dr.valueMatrix(selectedIdx, 10));
							model1.setValue("/root/resData/resDetailForm/note_issu_pers_nm", grd_dr.valueMatrix(selectedIdx, 11));
							model1.setValue("/root/resData/resDetailForm/note_issu_cmpy_clsf_cd", grd_dr.valueMatrix(selectedIdx, 12));
							model1.setValue("/root/resData/resDetailForm/note_comp_dt", grd_dr.valueMatrix(selectedIdx, 13));
							model1.setValue("/root/resData/resDetailForm/note_mtry_dt", grd_dr.valueMatrix(selectedIdx, 14));
							model1.setValue("/root/resData/resDetailForm/note_rcpm_acct", grd_dr.valueMatrix(selectedIdx, 15));
							model1.setValue("/root/resData/resDetailForm/note_sale_aprv_no", grd_dr.valueMatrix(selectedIdx, 16));
						}
						
						//예산코드 '예수금, 선수금'일 경우
						//예수금)대체(463100), 예수금)기타(466400), 선수금~(41~), 예수금(광고):456100
						if (budg_cd == "463100" || budg_cd == "466400" || budg_cd == "466800" || budg_cd == "456100" || budg_cd.substring(0, 2) == "41") {
							btn_swit.dispatch("onclick");
							model1.setValue("/root/resData/resDetailForm/swit_budg_cd", grd_dr.valueMatrix(selectedIdx, 1));
							model1.setValue("/root/resData/resDetailForm/swit_budg_nm", grd_dr.valueMatrix(selectedIdx, 2));
							model1.setValue("/root/resData/resDetailForm/swit_amt", grd_dr.valueMatrix(selectedIdx, 3));
							model1.setValue("/root/resData/resDetailForm/swit_amt", grd_dr.valueMatrix(selectedIdx, 3));
							model1.setValue("/root/resData/resDetailForm/swit_bal_occr_slip_no", grd_dr.valueMatrix(selectedIdx, 17));
							//model1.setValue("/root/resData/resDetailForm/swit_extnc_obj_slip_clsf", grd_dr.valueMatrix(selectedIdx, 18));
							//model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_no", grd_dr.valueMatrix(selectedIdx, 19));
							//model1.setValue("/root/resData/resDetailForm/swit_medi_cd", grd_dr.valueMatrix(selectedIdx, 20));
							//model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_nm", model1.getValue("/root/resData/resForm/dlco_nm"));
							
							setBalOccrSlip(grd_dr.valueMatrix(selectedIdx, 17));
							/*
							model1.send("en_innexp_1012");
							if (model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt") == "0") {
								alert("해당 전환금에 관한 정보가 없습니다. 전사잔액 조회화면을 확인하십시오.");
								return;
							}
							model1.setValue("/root/resData/resDetailForm/swit_extnc_obj_slip_clsf", model1.getValue("/root/tempData/dataSet/CURLIST/record/extnc_obj_slip_clsf"));
							model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_no", model1.getValue("/root/tempData/dataSet/CURLIST/record/extnc_dlco_cd"));
							model1.setValue("/root/resData/resDetailForm/swit_medi_cd", model1.getValue("/root/tempData/dataSet/CURLIST/record/medi_cd"));
							model1.removeNodeset("/root/tempData/dataSet");
							*/
						}
						
						//예산코드 '기타'일 경우
						if (!(budg_cd == "001100" || budg_cd == "011400"   || budg_cd == "017500" ||
						    budg_cd   == "017300" || budg_cd == "050100"   || budg_cd == "463100" ||
						    budg_cd   == "466400" || budg_cd == "466800"   || budg_cd == "456100" || budg_cd.substring(0, 2) == "41")) {
							btn_etc.dispatch("onclick");
							model1.setValue("/root/resData/resDetailForm/etc_budg_cd", grd_dr.valueMatrix(selectedIdx, 1));
							model1.setValue("/root/resData/resDetailForm/etc_budg_nm", grd_dr.valueMatrix(selectedIdx, 2));
							model1.setValue("/root/resData/resDetailForm/etc_amt", grd_dr.valueMatrix(selectedIdx, 3));
						}
						model1.refresh();
					]]>
				</script>
			</datagrid>
			<output id="input50" ref="/root/resData/resForm/chrg_pers_emp_nm" inputtype="button" appearance="output" style="left:835px; top:29px; width:85px; height:18px; "/>
			<input id="input51" ref="/root/resData/resForm/titl" class="req" navindex="12" caption="제목" style="left:84px; top:54px; width:331px; height:18px; "/>
			<caption id="caption94" class="list_cap03" style="left:681px; top:25px; width:80px; height:26px; ">담 당 자</caption>
			<caption id="caption106" style="left:0px; top:80px; width:335px; height:20px; font-family:굴림체; font-size:9pt; font-weight:bold; color:#303e9f; text-align:center; background-color:#ddeeff; border-color:#c0c0c0; border-style:solid; ">차       변</caption>
			<caption id="caption85" class="list_cap03" style="left:0px; top:0px; width:80px; height:26px; ">수입결의일자</caption>
			<caption id="caption107" style="left:340px; top:80px; width:335px; height:20px; font-family:굴림체; font-size:9pt; font-weight:bold; color:#303e9f; text-align:center; background-color:#ddeeff; border-color:#c0c0c0; border-style:solid; ">대       변</caption>
			<input id="ipt_dlco_no" ref="/root/resData/resForm/dlco_no" class="req" navindex="9" inputtype="button" maxlength="8" caption="거래처번호" style="left:184px; top:29px; width:76px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="onmaxlength">
					<![CDATA[
						model1.setValue("/root/resData/resForm/dlco_no", ipt_dlco_no.currentText);
						model1.setValue("/root/reqData/searchData/dlco_no", ipt_dlco_no.currentText);
						model1.send("en_comm_1003");
						model1.setValue("/root/resData/resForm/dlco_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_nm"));
						model1.removeNodeset("/root/tempData/dataSet");
						model1.refresh();		
					]]>
				</script>
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						if (model1.getValue("/root/resData/resForm/dlco_clsf_cd") == "92") {
							model1.setValue("/root/reqData/fwdData/func_nm", "setDlco_no");
							window.load("../../hd/com/HD_COM_1100.xrw","modal", "HD_COM_1100", "align:center; width:455; height:300; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
						} else {
							if (model1.getValue("/root/resData/resForm/dlco_clsf_cd") == "96") {
								
						    var cd   =  "";		 
						    var cdnm =  "";		
							
							model1.setValue("/root/resData/resForm/dlco_no", cd);
						    model1.setValue("/root/resData/resForm/dlco_nm", cdnm);							
							
							var resultRef1 = "/root/resData/resForm/dlco_no";
						    var resultRef2 = "/root/resData/resForm/dlco_nm";
						
						    showCommonCodePopup1("02", "96", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");		
							}
						    else
							{
							model1.setValue("/root/reqData/fwdData/func_nm","setDlco_no");
							window.load("/xrw/co/dlco/CO_DLCO_1100.xrw","modal","CO_DLCO_1100","align:center; width:645; height:480; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
						    }
						}
					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
						model1.setValue("/root/resData/resForm/dlco_no", ipt_dlco_no.currentText);
						if (model1.getValue("/root/resData/resForm/dlco_clsf_cd") == "92") {
							if (ipt_dlco_no.currentText.length == 6) {
								model1.setValue("/root/reqData/searchData/dept_cd", model1.getValue("/root/resData/resForm/dlco_no"));
								model1.send("en_comm_1005");
								model1.setValue("/root/resData/resForm/dlco_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/dept_nm"));
								model1.removeNodeset("/root/tempData/dataSet");
							}
						} else {
							if (ipt_dlco_no.currentText.length == 10) {
								model1.send("en_comm_1003");
								model1.setValue("/root/resData/resForm/dlco_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_nm"));
								model1.removeNodeset("/root/tempData/dataSet");
							}
						}
						model1.refresh();		
					]]>
				</script>
			</input>
			<caption id="caption1" class="list_cap03" style="left:191px; top:0px; width:80px; height:26px; ">행사년도</caption>
			<output id="input45" ref="/root/resData/resForm/dlco_nm" navindex="10" inputtype="button" appearance="output" style="left:265px; top:29px; width:150px; height:18px; "/>
			<caption id="caption88" class="list_cap03" style="left:0px; top:25px; width:80px; height:26px; ">거 래 처</caption>
			<input id="input46" ref="/root/resData/resForm/boks_dlco_nm" class="req" navindex="11" caption="부거래처명" style="left:505px; top:29px; width:160px; height:18px; "/>
			<caption id="caption24" class="list_cap03" style="left:681px; top:50px; width:80px; height:26px; ">담당부서</caption>
			<caption id="caption6" class="list_cap03" style="left:342px; top:0px; width:80px; height:26px; border-style:solid; ">행사코드</caption>
			<output id="input15" ref="/root/resData/resForm/chrg_dept_nm" appearance="output" style="left:815px; top:54px; width:105px; height:18px; "/>
			<output id="input16" ref="/root/resData/resForm/chrg_dept_cd" appearance="output" maxlength="10" style="left:765px; top:54px; width:46px; height:18px; "/>
			<input id="ipt_chrg_pers_emp_no" ref="/root/resData/resForm/chrg_pers_emp_no" class="req" navindex="14" inputtype="button" maxlength="6" caption="담당자사번" style="left:765px; top:29px; width:66px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="onmaxlength">
					<![CDATA[
						setEmpInfo(ipt_chrg_pers_emp_no.currentText);
					]]>
				</script>
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model1.setValue("/root/reqData/fwdData/func_nm", "setEmpInfo");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","modal", "HD_COM_1000", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
			</input>
			<caption id="caption26" class="list_cap03" style="left:421px; top:50px; width:80px; height:26px; ">비    고</caption>
			<select1 id="cbo_dlco_clsf_cd" ref="/root/resData/resForm/dlco_clsf_cd" class="req" navindex="8" appearance="minimal" caption="거래처구분코드" style="left:84px; top:29px; width:91px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dlco_clsf_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<input id="input6" ref="/root/resData/resForm/remk" navindex="13" style="left:505px; top:54px; width:160px; height:18px; "/>
			<caption id="caption91" class="list_cap03" style="left:421px; top:25px; width:80px; height:26px; ">부거래처명</caption>
			<caption id="caption8" style="left:683px; top:5px; width:13px; height:20px; font-family:굴림체; font-size:9pt; font-weight:bold; ">-</caption>
			<button id="btn_swit" class="tab08" group="tab" style="left:390px; top:259px; width:130px; height:23px; ">
				<caption>전 환 금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model.toggle("case4");
					]]>
				</script>
			</button>
			<button id="btn_etc" class="tab08" group="tab" style="left:520px; top:259px; width:130px; height:23px; ">
				<caption>기  타</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model.toggle("case5");
					]]>
				</script>
			</button>
			<button id="btn_cash" class="tab08" group="tab" selected="true" style="left:0px; top:259px; width:130px; height:23px; ">
				<caption>현  금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model.toggle("case1");
					]]>
				</script>
			</button>
			<button id="btn_deps" class="tab08" group="tab" style="left:130px; top:259px; width:130px; height:23px; ">
				<caption>통장예금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model.toggle("case2");
					input14.disabled = false;
					]]>
				</script>
			</button>
			<switch id="switch1" style="left:0px; top:282px; width:927px; height:93px; border-color:#dddddd; border-style:solid; ">
				<case id="case1">
					<group id="grp_cash" class="gro_sel" style="left:5px; top:5px; width:916px; height:30px; ">
						<caption id="caption11" class="list_cap02" style="left:80px; top:1px; width:835px; height:26px; background-color:#fefeee; border-style:solid; "/>
						<input id="cash_amt" ref="/root/resData/resDetailForm/cash_amt" navindex="15" maxlength="10" format="(-)#,###" style="left:85px; top:5px; width:90px; height:18px; text-align:right; "/>
						<input id="input11" ref="/root/resData/resDetailForm/cash_rcpm_occr_seq" navindex="18" imemode="disabled" inputtype="button" maxlength="3" style="left:790px; top:5px; width:45px; height:18px; text-align:center; ">
							<script type="javascript" ev:event="onbuttonclick">
								<![CDATA[
									model1.setValue("/root/reqData/fwdData/func_nm", "setCash_Occr_No");
									window.load("../../en/innexp/EN_INNEXP_1010.xrw","modal", "EN_INNEXP_1010", "align:center; width:950px; height:756px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
								]]>
							</script>
						</input>
						<input id="input12" ref="/root/resData/resDetailForm/cash_rcpm_occr_dt" navindex="17" inputtype="date" maxlength="10" format="yyyy-mm-dd" style="left:679px; top:5px; width:90px; height:18px; text-align:center; "/>
						<caption id="caption22" class="list_cap03" style="left:284px; top:1px; width:80px; height:26px; ">출금구분</caption>
						<select1 id="combo2" ref="/root/resData/resDetailForm/cash_payo_clsf_cd" navindex="16" appearance="minimal" style="left:368px; top:5px; width:147px; height:18px; ">
							<choices>
								<itemset nodeset="/root/initData/comboSet/payo_clsf/item">
									<label ref="label"/>
									<value ref="value"/>
								</itemset>
							</choices>
						</select1>
						<caption id="caption12" class="list_cap03" style="left:1px; top:1px; width:80px; height:26px; ">금  액</caption>
						<caption id="caption7" style="left:775px; top:5px; width:13px; height:20px; font-family:굴림체; font-size:9pt; font-weight:bold; ">-</caption>
						<caption id="caption28" class="list_cap03" style="left:595px; top:1px; width:80px; height:26px; ">입금발생번호</caption>
					</group>
				</case>
				<case id="case2">
					<group id="grp_deps" class="gro_sel" style="left:5px; top:5px; width:916px; height:55px; ">
						<caption id="caption33" class="list_cap02" style="left:79px; top:26px; width:836px; height:26px; border-style:solid; "/>
						<input id="input22" ref="/root/resData/resDetailForm/deps_amt" navindex="21" format="(-)#,###" appearance="input" style="left:84px; top:30px; width:116px; height:18px; text-align:right; "/>
						<caption id="caption31" class="list_cap02" style="left:79px; top:1px; width:836px; height:26px; border-style:solid; "/>
						<caption id="caption30" class="list_cap03" style="left:610px; top:1px; width:80px; height:26px; ">출금구분</caption>
						<caption id="caption21" style="left:792px; top:30px; width:13px; height:20px; font-family:굴림체; font-size:9pt; font-weight:bold; ">-</caption>
						<caption id="caption32" class="list_cap03" style="left:0px; top:1px; width:80px; height:26px; ">은행구분</caption>
						<caption id="caption23" class="list_cap03" style="left:360px; top:26px; width:80px; height:26px; ">송금처(인)</caption>
						<caption id="caption34" class="list_cap03" style="left:0px; top:26px; width:80px; height:26px; ">금  액</caption>
						<input id="input14" ref="/root/resData/resDetailForm/deps_amt" navindex="21" format="(-)#,###" appearance="input" style="left:84px; top:30px; width:116px; height:18px; text-align:right; "/>
						<select1 id="combo3" ref="/root/resData/resDetailForm/deps_payo_clsf_cd" navindex="20" appearance="minimal" style="left:694px; top:5px; width:160px; height:18px; ">
							<choices>
								<itemset nodeset="/root/initData/comboSet/payo_clsf/item">
									<label ref="label"/>
									<value ref="value"/>
								</itemset>
							</choices>
							<script type="javascript" ev:event="xforms-value-changed">
								<![CDATA[
									if (model1.getValue("/root/resData/resDetailForm/deps_payo_clsf_cd") == "")
										setVisibleCtrl(true);
									else
										setVisibleCtrl(false);
								]]>
							</script>
						</select1>
						<caption id="caption36" class="list_cap03" style="left:610px; top:26px; width:80px; height:26px; ">입금발생번호</caption>
						<caption id="caption14" class="list_cap03" style="left:360px; top:1px; width:80px; height:26px; ">송금일자</caption>
						<select1 id="combo5" ref="/root/resData/resDetailForm/deps_acct_mang_no" navindex="19" visibility="hidden" appearance="minimal" style="left:85px; top:5px; width:250px; height:18px; ">
							<choices>
								<itemset nodeset="/root/initData/comboSet/acct_mang_no/item">
									<label ref="label"/>
									<value ref="value"/>
								</itemset>
							</choices>
						</select1>
						<input id="input18" ref="/root/resData/resDetailForm/deps_rcpm_occr_seq" navindex="23" inputtype="button" style="left:809px; top:30px; width:45px; height:18px; text-align:center; ">
							<script type="javascript" ev:event="onbuttonclick">
								<![CDATA[
									model1.setValue("/root/reqData/fwdData/func_nm", "setDeps_Occr_No");
									window.load("../../en/innexp/EN_INNEXP_1010.xrw","modal", "EN_INNEXP_1010", "align:center; width:950px; height:756px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
								]]>
							</script>
						</input>
						<input id="input19" ref="/root/resData/resDetailForm/deps_rcpm_occr_dt" navindex="22" inputtype="date" maxlength="10" format="yyyy-mm-dd" style="left:694px; top:30px; width:90px; height:18px; text-align:center; "/>
						<input id="input5" ref="/root/resData/resDetailForm/deps_acct_mang_no" navindex="25" appearance="input" style="left:85px; top:5px; width:45px; height:18px; "/>
						<output id="input10" ref="/root/resData/resDetailForm/deps_acct_mang_nm" navindex="25" appearance="output" style="left:155px; top:5px; width:195px; height:18px; "/>
						<caption id="caption40" style="left:130px; top:5px; width:18px; height:18px; border-color:#ccccff; border-style:solid; "/>
						<img id="img1" src="../../../images/btn_search.gif" style="left:130px; top:6px; width:17px; height:17px; background-stretch:stretch; cursor:hand; ">
							<script type="javascript" ev:event="onclick">
								<![CDATA[
				  					model.makeNode("/root/reqData/fwdData/acct_mang_no_ref");	
				  					model.setValue("/root/reqData/fwdData/acct_mang_no_ref", "/root/resData/resDetailForm/deps_acct_mang_no");		
				  					model.makeNode("/root/reqData/fwdData/acct_mang_nm_ref");	
				  					model.setValue("/root/reqData/fwdData/acct_mang_nm_ref", "/root/resData/resDetailForm/deps_acct_mang_nm");	  					
				  					model.makeNode("/root/reqData/fwdData/tran_amt_ref");	
				  					model.setValue("/root/reqData/fwdData/tran_amt_ref", "/root/resData/resDetailForm/deps_amt");
				  					model.makeNode("/root/reqData/fwdData/tran_content_ref");	
				  					model.setValue("/root/reqData/fwdData/tran_content_ref", "/root/resData/resDetailForm/deps_rmtt_plac");			
				  							
									loadRcpmDtlsPop("B1",
									                "",
									                "/root/resData/resDetailForm/deps_biz_reg_no",
									                "/root/resData/resDetailForm/deps_bank_id",
									                "/root/resData/resDetailForm/deps_acct_num",
									                "/root/resData/resDetailForm/deps_tran_date",
									                "/root/resData/resDetailForm/deps_tran_date_seq",
												     "/root/reqData/fwdData");
												     
									model1.setValue("/root/resData/resDetailForm/deps_rmtt_dt", model1.getValue("/root/resData/resDetailForm/deps_tran_date"))
								    model1.refresh();
								]]>
							</script>
						</img>
						<input id="input30" ref="/root/resData/resDetailForm/deps_rmtt_dt" navindex="24" inputtype="date" maxlength="10" format="yyyy-mm-dd" appearance="input" style="left:444px; top:5px; width:70px; height:18px; text-align:center; "/>
						<input id="input33" ref="/root/resData/resDetailForm/deps_rmtt_plac" navindex="25" appearance="input" style="left:444px; top:30px; width:156px; height:18px; "/>
						<input id="input7" ref="/root/resData/resDetailForm/deps_rmtt_dt" navindex="24" inputtype="date" maxlength="10" format="yyyy-mm-dd" appearance="input" style="left:444px; top:5px; width:85px; height:18px; text-align:center; "/>
						<input id="input28" ref="/root/resData/resDetailForm/deps_rmtt_plac" navindex="25" appearance="input" style="left:444px; top:30px; width:156px; height:18px; "/>
						<button id="button1" class="btn_grid05" style="left:275px; top:30px; width:79px; height:17px; ">
							<caption>가상계좌입금</caption>
							<script type="javascript" ev:event="onclick">
								<![CDATA[
									model1.setValue("/root/reqData/fwdData/rtn_ref", "/root/resData/gridData/grid6");
									window.load("../../en/comm/EN_COMM_1200.xrw","modal", "EN_COMM_1200", "align:center; width:770; height:490; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
									model1.refresh();
									
									var  wk_input14_amt =  input14.value;
									
									input14.disabled = true;
								//20130912	button3.disabled = true;
									output1.value =  wk_input14_amt;
								]]>
							</script>
						</button>
					</group>
					<input id="output1" visibility="hidden" format="(-)#,###" style="left:90px; top:65px; width:115px; height:15px; text-align:right; "/>
				</case>
				<case id="case3">
					<group id="grp_note" class="gro_sel" style="left:5px; top:5px; width:916px; height:85px; ">
						<caption id="caption45" class="list_cap02" style="left:79px; top:1px; width:836px; height:28px; border-style:solid; "/>
						<caption id="caption51" class="list_cap02" style="left:79px; top:28px; width:836px; height:28px; border-style:solid; "/>
						<caption id="caption41" class="list_cap02" style="left:79px; top:55px; width:836px; height:28px; border-style:solid; "/>
						<input id="input8" ref="/root/resData/resDetailForm/note_comp_dt" navindex="33" inputtype="date" maxlength="10" format="yyyy-mm-dd" style="left:84px; top:33px; width:86px; height:18px; text-align:center; "/>
						<caption id="caption50" class="list_cap03" style="left:595px; top:1px; width:80px; height:28px; border-style:solid; ">은행코드</caption>
						<caption id="caption52" class="list_cap03" style="left:455px; top:55px; width:80px; height:28px; border-style:solid; ">입금계좌</caption>
						<input id="input20" ref="/root/resData/resDetailForm/note_issu_pers_nm" navindex="36" style="left:84px; top:60px; width:145px; height:18px; "/>
						<input id="input21" ref="/root/resData/resDetailForm/note_note_no" navindex="26" imemode="disabled" maxlength="8" style="left:84px; top:6px; width:66px; height:18px; "/>
						<caption id="caption42" class="list_cap03" style="left:0px; top:55px; width:80px; height:28px; border-style:solid; ">발 행 자</caption>
						<caption id="caption54" class="list_cap03" style="left:295px; top:28px; width:80px; height:28px; border-style:solid; ">만기일자</caption>
						<caption id="caption43" class="list_cap03" style="left:0px; top:28px; width:80px; height:28px; border-style:solid; ">발행일자</caption>
						<input id="input23" ref="/root/resData/resDetailForm/note_rcpm_amt" navindex="28" format="(-)#,###" style="left:379px; top:6px; width:86px; height:18px; text-align:right; "/>
						<input id="input24" ref="/root/resData/resDetailForm/note_bank_cd" navindex="29" inputtype="button" style="left:679px; top:6px; width:66px; height:18px; text-align:center; ">
							<script type="javascript" ev:event="onbuttonclick">
								<![CDATA[
								var cd   =  "";
								var cdnm =  "";
															
								var resultRef1 = "/root/resData/resDetailForm/note_bank_cd";
								var resultRef2 = "/root/resData/resDetailForm/note_bank_nm";							
	
								showCommonCodePopup1("02", "71", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");

								model1.setValue("/root/resData/resDetailForm/note_bank_cd", model1.getValue(resultRef1));
								model1.setValue("/root/resData/resDetailForm/note_bank_nm", model1.getValue(resultRef2));
							]]>
							</script>
						</input>
						<input id="input13" ref="/root/resData/resDetailForm/note_sale_aprv_no" navindex="31" style="left:779px; top:60px; width:106px; height:18px; "/>
						<output id="input25" ref="/root/resData/resDetailForm/note_bank_nm" navindex="48" inputtype="button" appearance="output" style="left:750px; top:6px; width:145px; height:18px; "/>
						<caption id="caption46" class="list_cap03" style="left:0px; top:1px; width:80px; height:28px; border-style:solid; ">어음번호</caption>
						<input id="input26" ref="/root/resData/resDetailForm/note_mtry_dt" navindex="34" inputtype="date" maxlength="10" format="yyyy-mm-dd" style="left:379px; top:33px; width:86px; height:18px; text-align:center; "/>
						<caption id="caption15" class="list_cap03" style="left:595px; top:28px; width:80px; height:28px; border-style:solid; ">어음구분</caption>
						<caption id="caption37" class="list_cap03" style="left:235px; top:55px; width:80px; height:28px; border-style:solid; ">발행구분</caption>
						<caption id="caption48" class="list_cap03" style="left:295px; top:1px; width:80px; height:28px; border-style:solid; ">금  액</caption>
						<select1 id="combo6" ref="/root/resData/resDetailForm/note_note_clsf_cd" navindex="32" appearance="minimal" style="left:679px; top:33px; width:156px; height:18px; ">
							<choices>
								<itemset nodeset="/root/initData/comboSet/note_clsf/item">
									<label ref="label"/>
									<value ref="value"/>
								</itemset>
							</choices>
						</select1>
						<select1 id="combo7" ref="/root/resData/resDetailForm/note_issu_cmpy_clsf_cd" navindex="35" appearance="minimal" style="left:319px; top:60px; width:76px; height:18px; ">
							<choices>
								<itemset nodeset="/root/initData/comboSet/note_issu_clsf/item">
									<label ref="label"/>
									<value ref="value"/>
								</itemset>
							</choices>
						</select1>
						<caption id="caption39" class="list_cap03" style="left:695px; top:55px; width:80px; height:28px; border-style:solid; ">승인번호</caption>
						<select1 id="combo8" ref="/root/resData/resDetailForm/note_rcpm_acct" navindex="30" appearance="minimal" style="left:539px; top:60px; width:145px; height:18px; ">
							<choices>
								<itemset nodeset="/root/initData/comboSet/acct_mang_no/item">
									<label ref="label"/>
									<value ref="value"/>
								</itemset>
							</choices>
						</select1>
					</group>
				</case>
				<case id="case4" selected="true">
					<group id="grp_swit" class="gro_sel" style="left:5px; top:5px; width:916px; height:75px; ">
						<caption id="caption68" class="list_cap02" style="left:79px; top:26px; width:836px; height:26px; border-style:solid; "/>
						<caption id="caption56" class="list_cap02" style="left:79px; top:1px; width:836px; height:26px; border-style:solid; "/>
						<caption id="caption81" class="list_cap03" style="left:651px; top:1px; width:80px; height:26px; ">매체코드</caption>
						<output id="input40" ref="/root/resData/resDetailForm/swit_budg_nm" navindex="47" visibility="hidden" appearance="output" style="left:486px; top:55px; width:159px; height:18px; "/>
						<caption id="caption84" class="list_cap03" style="left:321px; top:26px; width:80px; height:26px; ">예산코드</caption>
						<caption id="caption76" class="list_cap03" style="left:0px; top:26px; width:80px; height:26px; ">소멸입금처</caption>
						<caption id="caption55" class="list_cap03" style="left:321px; top:1px; width:80px; height:26px; ">발생전표번호</caption>
						<caption id="caption57" class="list_cap03" style="left:0px; top:1px; width:80px; height:26px; ">소멸전표구분</caption>
						<input id="ipt_swit_extnc_dlco_no" ref="/root/resData/resDetailForm/swit_extnc_dlco_no" navindex="38" inputtype="button" maxlength="8" style="left:84px; top:30px; width:76px; height:18px; ">
							<script type="javascript" ev:event="onmaxlength">
								<![CDATA[
									model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_no", ipt_swit_extnc_dlco_no.currentText);
									model1.setValue("/root/reqData/searchData/dlco_no", ipt_swit_extnc_dlco_no.currentText);
									model1.send("en_comm_1003");
									model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_nm"));
									model1.removeNodeset("/root/tempData/dataSet");
									model1.refresh();		
								]]>
							</script>
							<script type="javascript" ev:event="onbuttonclick">
								<![CDATA[
									if (model1.getValue("/root/resData/resForm/dlco_clsf_cd") == "92") {
										model1.setValue("/root/reqData/fwdData/func_nm", "setSwit_dlco_no");
										window.load("../../hd/com/HD_COM_1100.xrw","modal", "HD_COM_1100", "align:center; width:455; height:300; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
									} else {
										model1.setValue("/root/reqData/fwdData/func_nm","setSwit_dlco_no");
										window.load("/xrw/co/dlco/CO_DLCO_1100.xrw","modal","CO_DLCO_1100","align:center; width:645; height:480; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
									}
								]]>
							</script>
							<script type="javascript" ev:event="DOMFocusOut">
								<![CDATA[
									model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_no", ipt_swit_extnc_dlco_no.currentText);
									if (model1.getValue("/root/resData/resForm/dlco_clsf_cd") == "92") {
										if (ipt_swit_extnc_dlco_no.currentText.length == 6) {
											model1.setValue("/root/reqData/searchData/dept_cd", model1.getValue("/root/resData/resDetailForm/swit_extnc_dlco_no"));
											model1.send("en_comm_1005");
											model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/dept_nm"));
											model1.removeNodeset("/root/tempData/dataSet");
										}
									} else {
										if (ipt_swit_extnc_dlco_no.currentText.length == 8) {
											model1.setValue("/root/reqData/searchData/dlco_no", model1.getValue("/root/resData/resDetailForm/swit_extnc_dlco_no"));
											model1.send("en_comm_1003");
											model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_nm"));
											model1.removeNodeset("/root/tempData/dataSet");
										}
									}
									model1.refresh();		
								]]>
							</script>
						</input>
						<output id="input37" ref="/root/resData/resDetailForm/swit_extnc_dlco_nm" navindex="46" inputtype="button" appearance="output" style="left:165px; top:30px; width:150px; height:18px; "/>
						<input id="swit_budg_cd" ref="/root/resData/resDetailForm/swit_budg_cd" navindex="40" visibility="hidden" inputtype="button" maxlength="6" style="left:405px; top:55px; width:76px; height:18px; text-align:center; ">
							<script type="javascript" ev:event="onbuttonclick">
								<![CDATA[
								model1.setValue("/root/reqData/fwdData/G_Tag", "1");
								model1.setValue("/root/reqData/fwdData/G_Caption", "예산코드조회");
								model1.setValue("/root/reqData/fwdData/G_Codenu", "");					
								model1.setValue("/root/reqData/fwdData/G_BRCode", "");
		
								gstr_popupid = "budg_cd1";
								window.load("/xrw/mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
							]]>
							</script>
							<script type="javascript" ev:event="onmaxlength">
								<![CDATA[
								model1.setValue("/root/resData/resDetailForm/swit_budg_cd", swit_budg_cd.currentText);
								model1.setValue("/root/reqData/searchData/budg_cd", swit_budg_cd.currentText);
								model1.send("en_comm_1004");						
								model1.setValue("/root/resData/resDetailForm/swit_budg_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/budg_nm"));
								model1.removeNodeset("/root/tempData/dataSet");
								input40.refresh();		
							]]>
							</script>
						</input>
						<select1 id="combo10" ref="/root/resData/resDetailForm/swit_extnc_obj_slip_clsf" navindex="37" appearance="minimal" style="left:84px; top:5px; width:139px; height:18px; ">
							<choices>
								<itemset nodeset="/root/initData/comboSet/slip_clsf_cd/item">
									<label ref="label"/>
									<value ref="value"/>
								</itemset>
							</choices>
						</select1>
						<input id="input27" ref="/root/resData/resDetailForm/swit_amt" navindex="41" format="(-)#,###" style="left:735px; top:30px; width:90px; height:18px; text-align:right; "/>
						<caption id="caption59" class="list_cap03" style="left:651px; top:26px; width:80px; height:26px; ">금  액</caption>
						<input id="input39" ref="/root/resData/resDetailForm/swit_bal_occr_slip_no" inputtype="button" appearance="input" style="left:405px; top:5px; width:139px; height:18px; ">
							<script type="javascript" ev:event="onbuttonclick">
								<![CDATA[
									var budg_cd = combo11.value;
									
									if ( budg_cd == "404500") {
										//model.property("FC_ACCT_2500_popup_clsf")  = "Y";
										//model.property("FC_ACCT_2500_srch_occr_slip_clsf")  = combo10.value;
									
										//viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2500");										
										
										//combo10.value = model.property("FC_ACCT_2500_srch_occr_slip_clsf");
										//input39.value = model.property("FC_ACCT_2500_occr_slip");
										
										//model.property("FC_ACCT_2500_occr_slip") = "";
										//model.property("FC_ACCT_2500_srch_occr_slip_clsf") = "";
										
										model.property("FC_ACCT_2040_popup_clsf")  = "Y";
										//model.property("FC_ACCT_2040_srchdept_cd")  = "";
										//model.property("FC_ACCT_2040_srchdept_nm") = "";
										model.property("FC_ACCT_2040_srchoccr_acct_cd") = "4045";
										model.property("FC_ACCT_2040_srchcombo1") = "1";
										model.property("FC_ACCT_2040_srchoccr_acct_cd") = combo11.value.substring(0, 4);
					
										viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2040");
					
										input39.value = (model.property("FC_ACCT_2040_slip_no")).ReplaceWord("-", "");
										input27.value = model.property("FC_ACCT_2040_actu_adpay_bal");
										model.property("FC_ACCT_2040_actu_adpay_bal") = "";
										model.property("FC_ACCT_2040_slip_no") = "";	
										
									} else {
									model1.makeNode("/root/reqData/fwdData/occr_slip_clsf");
									model1.makeNode("/root/reqData/fwdData/bal_occr_slip_no");
									model1.setValue("/root/reqData/fwdData/occr_slip_clsf", "35");
									
									window.load("../comm/EN_COMM_1300.xrw","modal", "EN_COMM_1300", "align:center; width:805; height:605; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
									
									//var bal_occr_slip_no = model1.getValue("/root/reqData/fwdData/occr_slip_clsf") +
									//                      (model1.getValue("/root/reqData/fwdData/bal_occr_slip_no")).ReplaceWord("-", "");
									//input39.value = bal_occr_slip_no.substring(8, 10)+bal_occr_slip_no;
									//if (bal_occr_slip_no != "")
									//	setBalOccrSlip(bal_occr_slip_no.substring(8, 10) + bal_occr_slip_no);

									var bal_occr_slip_no = (model1.getValue("/root/reqData/fwdData/bal_occr_slip_no")).ReplaceWord("-", "");
									//alert(model1.getValue("/root/reqData/fwdData/occr_slip_clsf"));
									var occr_slip_clsf = model1.getValue("/root/reqData/fwdData/occr_slip_clsf");
									input39.value = occr_slip_clsf + "" + bal_occr_slip_no;
									//alert(occr_slip_clsf + bal_occr_slip_no);
									if (bal_occr_slip_no != "")
										setBalOccrSlip(occr_slip_clsf + bal_occr_slip_no);
										
									model1.removenode("/root/reqData/fwdData/occr_slip_clsf");
									model1.removenode("/root/reqData/fwdData/bal_occr_slip_no");
									
									/*
									//window.load("en_innexp_1010.xrw", "modal", "", "width:1200px;height:800px;align:center;caption:visible;resize:false;","","");
									model1.property("FC_ACCT_2500_popup_clsf")  = "Y";
									//model1.property("FC_ACCT_2500_srch_occr_slip_clsf")  = "35";
									//viewer("mainFrame").window.javaScript.onLoadPopupPage("FC_ACCT_2500");
									viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2500");
									var bal_occr_slip_no = model1.property("FC_ACCT_2500_srch_occr_slip_clsf") +
									                       (model1.property("FC_ACCT_2500_occr_slip")).ReplaceWord("-", "");
									input39.value = bal_occr_slip_no.substring(8, 10)+bal_occr_slip_no;
									
									model1.property("FC_ACCT_2500_occr_slip") = "";
									model1.property("FC_ACCT_2500_srch_occr_slip_clsf") = "";
									setBalOccrSlip(bal_occr_slip_no.substring(8, 10) + bal_occr_slip_no)
									*/
									/*
									model1.setValue("/root/reqData/searchData/searchDetail/bal_occr_slip_no", bal_occr_slip_no.substring(8, 10)+bal_occr_slip_no);
									model1.send("en_innexp_1012");
									model1.setValue("/root/resData/resDetailForm/swit_budg_cd", model1.getValue("/root/tempData/dataSet/CURLIST/record/budg_cd"));
									model1.setValue("/root/resData/resDetailForm/swit_budg_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/budg_nm"));
									model1.setValue("/root/resData/resDetailForm/swit_amt", model1.getValue("/root/tempData/dataSet/CURLIST/record/occr_amt"));
									model1.setValue("/root/resData/resDetailForm/swit_extnc_obj_slip_clsf", model1.getValue("/root/tempData/dataSet/CURLIST/record/extnc_obj_slip_clsf"));
									model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_no", model1.getValue("/root/tempData/dataSet/CURLIST/record/extnc_dlco_no"));
									model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/extnc_dlco_nm"));
									model1.setValue("/root/resData/resDetailForm/swit_medi_cd", model1.getValue("/root/tempData/dataSet/CURLIST/record/medi_cd"));
									model1.removeNodeset("/root/tempData/dataSet");
									*/
									}
									model1.refresh();
								]]>
							</script>
						</input>
						<select1 id="combo9" ref="/root/resData/resDetailForm/swit_medi_cd" navindex="39" appearance="minimal" style="left:735px; top:5px; width:139px; height:18px; ">
							<choices>
								<itemset nodeset="/root/initData/comboSet/medi_cd/item">
									<label ref="label"/>
									<value ref="value"/>
								</itemset>
							</choices>
						</select1>
						<select1 id="combo11" ref="/root/resData/resDetailForm/swit_budg_cd" navindex="39" appearance="minimal" style="left:405px; top:30px; width:139px; height:18px; ">
							<choices>
								<itemset nodeset="/root/initData/comboSet/trufnd_budg_cd/item">
									<label ref="label"/>
									<value ref="value"/>
								</itemset>
							</choices>
							<script type="javascript" ev:event="xforms-value-changed">
								<![CDATA[
									swit_budg_cd.dispatch("onmaxlength");
								]]>
							</script>
						</select1>
					</group>
				</case>
				<case id="case5">
					<group id="grp_etc" class="gro_sel" style="left:5px; top:5px; width:916px; height:50px; ">
						<caption id="caption3" class="list_cap02" style="left:80px; top:1px; width:835px; height:26px; border-style:solid; "/>
						<output id="input9" ref="/root/resData/resDetailForm/etc_budg_nm" navindex="45" visibility="hidden" appearance="output" style="left:160px; top:30px; width:170px; height:18px; "/>
						<caption id="caption20" class="list_cap03" style="left:354px; top:1px; width:80px; height:26px; border-style:solid; ">금  액</caption>
						<input id="etc_budg_cd" ref="/root/resData/resDetailForm/etc_budg_cd" navindex="42" visibility="hidden" inputtype="button" maxlength="6" style="left:85px; top:30px; width:70px; height:18px; text-align:center; ">
							<script type="javascript" ev:event="onbuttonclick">
								<![CDATA[
								model1.setValue("/root/reqData/fwdData/G_Tag", "1");
								model1.setValue("/root/reqData/fwdData/G_Caption", "예산코드조회");
								model1.setValue("/root/reqData/fwdData/G_Codenu", "");					
								model1.setValue("/root/reqData/fwdData/G_BRCode", "");
		
								gstr_popupid = "budg_cd2";
								window.load("/xrw/mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
							]]>
							</script>
							<script type="javascript" ev:event="onmaxlength">
								<![CDATA[
								model1.setValue("/root/resData/resDetailForm/etc_budg_cd", etc_budg_cd.currentText);
								model1.setValue("/root/reqData/searchData/budg_cd", etc_budg_cd.currentText);
								model1.send("en_comm_1004");						
								model1.setValue("/root/resData/resDetailForm/etc_budg_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/budg_nm"));
								model1.removeNodeset("/root/tempData/dataSet");
								model1.refresh();		
							]]>
							</script>
						</input>
						<input id="input17" ref="/root/resData/resDetailForm/etc_amt" navindex="43" format="(-)#,###" style="left:438px; top:5px; width:108px; height:18px; text-align:right; "/>
						<caption id="caption18" class="list_cap03" style="left:1px; top:1px; width:80px; height:26px; border-style:solid; ">예산코드</caption>
						<select1 id="combo12" ref="/root/resData/resDetailForm/etc_budg_cd" navindex="19" appearance="minimal" style="left:85px; top:5px; width:230px; height:18px; ">
							<choices>
								<itemset nodeset="/root/initData/comboSet/budg_cd/item">
									<label ref="label"/>
									<value ref="value"/>
								</itemset>
							</choices>
							<script type="javascript" ev:event="xforms-value-changed">
								<![CDATA[
									etc_budg_cd.dispatch("onmaxlength");
									if (model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "478300")
										button2.visible = true;
									else
										button2.visible = false;
								]]>
							</script>
						</select1>
						<button id="button2" class="btn_grid05" visibility="hidden" style="left:560px; top:5px; width:87px; height:17px; ">
							<caption>선수수익조회</caption>
							<script type="javascript" ev:event="onclick">
								<![CDATA[
									if (model1.getValue("/root/resData/resForm/evnt_yy") == "" || model1.getValue("/root/resData/resForm/evnt_cd") == "" || model1.getValue("/root/resData/resForm/evnt_seq") == "") {
										alert("대관료 계약금 조회를 위해 먼저 행사년도, 행사코드, 일련번호를 입력하십시오.");
										return;
									}
									model1.setValue("/root/reqData/fwdData/func_nm", "setPreAmt");
									window.load("../../en/innexp/EN_INNEXP_1010.xrw","modal", "EN_INNEXP_1010", "align:center; width:950px; height:756px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
								]]>
							</script>
						</button>
					</group>
					<select1 id="combo4" ref="/root/resData/resDetailForm/etc_acct_mang_no" navindex="19" visibility="hidden" appearance="minimal" style="left:715px; top:35px; width:181px; height:18px; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/acct_mang_no/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</select1>
					<caption id="caption19" class="list_cap03" visibility="hidden" style="left:630px; top:30px; width:80px; height:26px; border-style:solid; ">관리구분</caption>
				</case>
			</switch>
			<button id="btn_note" class="tab08" group="tab" style="left:260px; top:259px; width:130px; height:23px; ">
				<caption>어음(기업구매카드)</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model.toggle("case3");
					]]>
				</script>
			</button>
			<datagrid id="grd_cr" nodeset="/root/resData/gridData/gridData3/record" caption="계정코드^계정과목^금액^caption1^caption2^caption3^caption4^caption5^caption6^caption7^caption8^caption9^caption10^caption11^caption12^caption13^caption14^caption15^caption16^caption17^caption18^caption20" colsep="#" colwidth="70, 158, 90, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" frozenbottomrows="1" mergecellsfixedrows="bycolrec" rowheader="seq" rowheight="20" rowsep="|" subtotalposition="below" style="left:340px; top:98px; width:335px; height:132px; ">
				<col ref="budg_cd" type="output" style="left:0px; top:20px; width:100px; height:20px; text-align:center; "/>
				<col ref="budg_nm" type="output" style="left:100px; top:20px; width:233px; height:20px; text-align:left; "/>
				<col ref="amt" type="output" format="(-)#,###" style="text-align:right; ">
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
							getCrSubTotal();
						]]>
					</script>
				</col>
				<col ref="acct_mang_no" visibility="hidden"/>
				<col ref="rmtt_dt" visibility="hidden"/>
				<col ref="rmtt_plac" visibility="hidden"/>
				<col ref="note_no" visibility="hidden"/>
				<col ref="note_clsf_cd" visibility="hidden"/>
				<col ref="bank_cd" visibility="hidden"/>
				<col ref="bank_nm" visibility="hidden"/>
				<col ref="issu_pers_nm" visibility="hidden"/>
				<col ref="issu_cmpy_clsf_cd" visibility="hidden"/>
				<col ref="comp_dt" visibility="hidden"/>
				<col ref="mtry_dt" visibility="hidden"/>
				<col ref="rcpm_acct" visibility="hidden"/>
				<col ref="sale_aprv_no" visibility="hidden"/>
				<col ref="bal_occr_slip_no" visibility="hidden"/>
				<col ref="extnc_obj_slip_clsf" visibility="hidden"/>
				<col ref="extnc_dlco_no" visibility="hidden"/>
				<col ref="medi_cd" visibility="hidden"/>
				<col ref="acct_mang_nm" visibility="hidden"/>
				<col ref="biz_reg_no" visibility="hidden"/>
				<col ref="bank_id" visibility="hidden"/>
				<col ref="acct_num" visibility="hidden"/>
				<col ref="tran_date" visibility="hidden"/>
				<col ref="tran_date_seq" visibility="hidden"/>
				<col ref="slip_no" visibility="hidden"/>
				<script type="javascript" ev:event="ondblclick">
					<![CDATA[
						if(grd_cr.row == 0) return;	
						
						if (grd_cr.valueMatrix(grd_cr.row, 1) == "") return;
						
						var selectedIdx = grd_cr.row;
						var budg_cd = grd_cr.valueMatrix(selectedIdx, 1);
						
						//예산코드 '현금'일 경우
						if (budg_cd == "001100") {
							btn_cash.dispatch("onclick");
							model1.setValue("/root/resData/resDetailForm/cash_amt", grd_cr.valueMatrix(selectedIdx, 3));
							
							//출금구분 값이 있으면 입금발생일자와 입금발생일련번호 세팅
							if (model1.getValue("/root/resData/resForm/payo_clsf") != "") {
								model1.setValue("/root/resData/resDetailForm/cash_payo_clsf_cd", model1.getValue("/root/resData/resForm/payo_clsf"));
								model1.setValue("/root/resData/resDetailForm/cash_rcpm_occr_dt", model1.getValue("/root/resData/resForm/rcpm_occr_dt"));
								model1.setValue("/root/resData/resDetailForm/cash_rcpm_occr_seq", model1.getValue("/root/resData/resForm/rcpm_occr_seq"));
							}
						}
						
						//예산코드 '보통예금'일 경우
						if (budg_cd == "011400" || budg_cd == "017500" || budg_cd == "017300") {
							btn_deps.dispatch("onclick");
							model1.setValue("/root/resData/resDetailForm/deps_amt", grd_cr.valueMatrix(selectedIdx, 3));
							model1.setValue("/root/resData/resDetailForm/deps_acct_mang_no", grd_cr.valueMatrix(selectedIdx, 4));
							model1.setValue("/root/resData/resDetailForm/deps_acct_mang_nm", grd_cr.valueMatrix(selectedIdx, 21));
							model1.setValue("/root/resData/resDetailForm/deps_rmtt_dt", grd_cr.valueMatrix(selectedIdx, 5));
							model1.setValue("/root/resData/resDetailForm/deps_rmtt_plac", grd_cr.valueMatrix(selectedIdx, 6));

							//출금구분 값이 있으면 입금발생일자와 입금발생일련번호 세팅
							if (model1.getValue("/root/resData/resForm/payo_clsf") != "") {
								model1.setValue("/root/resData/resDetailForm/deps_payo_clsf_cd", model1.getValue("/root/resData/resForm/payo_clsf"));
								model1.setValue("/root/resData/resDetailForm/deps_rcpm_occr_dt", model1.getValue("/root/resData/resForm/rcpm_occr_dt"));
								model1.setValue("/root/resData/resDetailForm/deps_rcpm_occr_seq", model1.getValue("/root/resData/resForm/rcpm_occr_seq"));
							}
							combo3.dispatch("xforms-value-changed");
						}
						
						//예산코드 '받을어음(기업구매카드)'일 경우
						if (budg_cd == "050100") {
							btn_note.dispatch("onclick");
							model1.setValue("/root/resData/resDetailForm/note_rcpm_amt", grd_cr.valueMatrix(selectedIdx, 3));
							model1.setValue("/root/resData/resDetailForm/note_note_no", grd_cr.valueMatrix(selectedIdx, 7));
							model1.setValue("/root/resData/resDetailForm/note_note_clsf_cd", grd_cr.valueMatrix(selectedIdx, 8));
							model1.setValue("/root/resData/resDetailForm/note_bank_cd", grd_cr.valueMatrix(selectedIdx, 9));
							model1.setValue("/root/resData/resDetailForm/note_bank_nm", grd_cr.valueMatrix(selectedIdx, 10));
							model1.setValue("/root/resData/resDetailForm/note_issu_pers_nm", grd_cr.valueMatrix(selectedIdx, 11));
							model1.setValue("/root/resData/resDetailForm/note_issu_cmpy_clsf_cd", grd_cr.valueMatrix(selectedIdx, 12));
							model1.setValue("/root/resData/resDetailForm/note_comp_dt", grd_cr.valueMatrix(selectedIdx, 13));
							model1.setValue("/root/resData/resDetailForm/note_mtry_dt", grd_cr.valueMatrix(selectedIdx, 14));
							model1.setValue("/root/resData/resDetailForm/note_rcpm_acct", grd_cr.valueMatrix(selectedIdx, 15));
							model1.setValue("/root/resData/resDetailForm/note_sale_aprv_no", grd_cr.valueMatrix(selectedIdx, 16));
						}
						
						//예산코드 '예수금, 선수금'일 경우
						//예수금>대체(463100), 예수금>기타(466400), 선수금(41~), 예수금>광고(456100)
						if (budg_cd == "463100" || budg_cd == "466400" || budg_cd == "466800" || budg_cd == "456100" || budg_cd.substring(0, 2) == "41") {
							btn_swit.dispatch("onclick");
							model1.setValue("/root/resData/resDetailForm/swit_budg_cd", grd_cr.valueMatrix(selectedIdx, 1));
							model1.setValue("/root/resData/resDetailForm/swit_budg_nm", grd_cr.valueMatrix(selectedIdx, 2));
							model1.setValue("/root/resData/resDetailForm/swit_amt", grd_cr.valueMatrix(selectedIdx, 3));
							model1.setValue("/root/resData/resDetailForm/swit_bal_occr_slip_no", grd_cr.valueMatrix(selectedIdx, 17));
							//model1.setValue("/root/resData/resDetailForm/swit_extnc_obj_slip_clsf", grd_cr.valueMatrix(selectedIdx, 18));
							//model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_no", model1.getValue("/root/resData/resForm/dlco_no"));
							//model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_nm", model1.getValue("/root/resData/resForm/dlco_nm"));
							//model1.setValue("/root/resData/resDetailForm/swit_medi_cd", grd_cr.valueMatrix(selectedIdx, 20));
							
							setBalOccrSlip(grd_cr.valueMatrix(selectedIdx, 17));
							
							/*
							if (grd_cr.valueMatrix(selectedIdx, 17) != "") {
								model1.setValue("/root/reqData/searchData/searchDetail/bal_occr_slip_no", grd_cr.valueMatrix(selectedIdx, 17));
								model1.send("en_innexp_1012");
								if (model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt") == "0") {
									alert("해당 전환금에 관한 정보가 없습니다. 전사잔액 조회화면을 확인하십시오.");
									return;
								}
								model1.setValue("/root/resData/resDetailForm/swit_extnc_obj_slip_clsf", model1.getValue("/root/tempData/dataSet/CURLIST/record/extnc_obj_slip_clsf"));
								model1.setValue("/root/resData/resDetailForm/swit_extnc_dlco_no", model1.getValue("/root/tempData/dataSet/CURLIST/record/extnc_dlco_cd"));
								model1.setValue("/root/resData/resDetailForm/swit_medi_cd", model1.getValue("/root/tempData/dataSet/CURLIST/record/medi_cd"));
								model1.removeNodeset("/root/tempData/dataSet");
							}
							*/
						}
						
						//예산코드 '기타'일 경우
						if (!(budg_cd == "001100"   || budg_cd == "011400" || budg_cd == "017500" ||
						    budg_cd   == "017300"   || budg_cd == "050100" || budg_cd == "463100" ||
						    budg_cd   == "466400"   || budg_cd == "466800" || budg_cd == "456100" || budg_cd.substring(0, 2) == "41")) {
							btn_etc.dispatch("onclick");
							model1.setValue("/root/resData/resDetailForm/etc_budg_cd", grd_cr.valueMatrix(selectedIdx, 1));
							model1.setValue("/root/resData/resDetailForm/etc_budg_nm", grd_cr.valueMatrix(selectedIdx, 2));
							model1.setValue("/root/resData/resDetailForm/etc_amt", grd_cr.valueMatrix(selectedIdx, 3));
						}
						model1.refresh();
					]]>
				</script>
			</datagrid>
			<button id="button3" class="btn_grid04" style="left:205px; top:232px; width:65px; height:17px; ">
				<caption>차변추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var budg_cd = "";
						
						button8.visible= false;
                                             btn_ins.visible = true;
                                            btn_upd.visible = true;
						
						if (switch1.selectedIndex == 0) {
							budg_cd = "001100";
						} else if (switch1.selectedIndex == 1) {
							if (model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3602") {
								budg_cd = "017500";
							} else if (model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3511" ||
							           model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3512") {
								budg_cd = "017300";
							} else {
								budg_cd = "011400";
							}
						} else if (switch1.selectedIndex == 2) {
							budg_cd = "050100";
						} else if (switch1.selectedIndex == 3) {
							budg_cd = model1.getValue("/root/resData/resDetailForm/swit_budg_cd");
						} else if (switch1.selectedIndex == 4) {
							budg_cd = model1.getValue("/root/resData/resDetailForm/etc_budg_cd");
						}
						
					  //  	for (i = 1; i < grd_dr.rows; i++) {
					  //		if (budg_cd != "" && budg_cd == grd_dr.valueMatrix(i, 1)) {
					  //			alert("이미 추가된 항목입니다.");
					  //			return;
					  //		}
					  //	}
					  
					     /*	
                                             if  (budg_cd = "017500")  {
                                                   alert("가상계좌추가버튼을 누르세요!");
						      return; 	
                                             }
                                           */    	   
						//현금계정 차변 추가
						if (switch1.selectedIndex == 0) {
							if (model1.getValue("/root/resData/resDetailForm/cash_amt") == "") {
								alert("금액을 입력하십시오.");
								return;
							}
						      /*		
							if (parseInt(model1.getValue("/root/resData/resDetailForm/cash_amt")) < 0) {
								alert("현금계정은 (-)금액 입력이 불가능 합니다.");
								return;
							}
						     */	
							initDrSubTotal();
							
							if (grd_dr.valueMatrix(grd_dr.rows-1, 1) != "")
								grd_dr.addRow();

							grd_dr.valueMatrix(grd_dr.rows-1, 1) = "001100";
							grd_dr.valueMatrix(grd_dr.rows-1, 2) = "현금";
							grd_dr.valueMatrix(grd_dr.rows-1, 3) = model1.getValue("/root/resData/resDetailForm/cash_amt");
							
							//현금 입력 컨트롤 초기화
							commGroupInit(grp_cash);

						//예금계정 차변 추가
						} else if (switch1.selectedIndex == 1) {
							if (model1.getValue("/root/resData/resDetailForm/deps_amt") == "") {
								alert("금액을 입력하십시오.");
								return;
							}
							
							if (model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "") {
								alert("은행구분을 입력하십시오.");
								return;
							}
							
							if (model1.getValue("/root/resData/resDetailForm/deps_rmtt_dt") == "") {
								alert("송금일자를 입력하십시오.");
								return;
							}
							initDrSubTotal();
							
							if (grd_dr.valueMatrix(grd_dr.rows-1, 1) != "")
								grd_dr.addRow();

							if (model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3602") {
								grd_dr.valueMatrix(grd_dr.rows-1, 1) = "017500";
								grd_dr.valueMatrix(grd_dr.rows-1, 2) = "기업자유예금";
							} else if (model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3511" ||
							           model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3512") {
								grd_dr.valueMatrix(grd_dr.rows-1, 1) = "017300";
								grd_dr.valueMatrix(grd_dr.rows-1, 2) = "외화예금";
							} else {
								grd_dr.valueMatrix(grd_dr.rows-1, 1) = "011400";
								grd_dr.valueMatrix(grd_dr.rows-1, 2) = "보통예금";
							}
							grd_dr.valueMatrix(grd_dr.rows-1, 3) = model1.getValue("/root/resData/resDetailForm/deps_amt");
							grd_dr.valueMatrix(grd_dr.rows-1, 4) = model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no");
							grd_dr.valueMatrix(grd_dr.rows-1, 5) = model1.getValue("/root/resData/resDetailForm/deps_rmtt_dt");
							grd_dr.valueMatrix(grd_dr.rows-1, 6) = model1.getValue("/root/resData/resDetailForm/deps_rmtt_plac");
							grd_dr.valueMatrix(grd_dr.rows-1, 21) = model1.getValue("/root/resData/resDetailForm/deps_acct_mang_nm");
							grd_dr.valueMatrix(grd_dr.rows-1, 22) = model1.getValue("/root/resData/resDetailForm/deps_biz_reg_no");
							grd_dr.valueMatrix(grd_dr.rows-1, 23) = model1.getValue("/root/resData/resDetailForm/deps_bank_id");
							grd_dr.valueMatrix(grd_dr.rows-1, 24) = model1.getValue("/root/resData/resDetailForm/deps_acct_num");
							grd_dr.valueMatrix(grd_dr.rows-1, 25) = model1.getValue("/root/resData/resDetailForm/deps_tran_date");
							grd_dr.valueMatrix(grd_dr.rows-1, 26) = model1.getValue("/root/resData/resDetailForm/deps_tran_date_seq");
							grd_dr.valueMatrix(grd_dr.rows-1, 27) = model1.getValue("/root/resData/resDetailForm/deps_slip_no");
							
							//예금 입력 컨트롤 초기화
							commGroupInit(grp_deps);
						
						//어음계정 차변 추가
						} else if (switch1.selectedIndex == 2) {
							if (model1.getValue("/root/resData/resDetailForm/note_rcpm_amt") == "") {
								alert("금액을 입력하십시오.");
								return;
							}
							if (parseInt(model1.getValue("/root/resData/resDetailForm/note_rcpm_amt")) < 0) {
								alert("어음계정은 (-)금액 입력이 불가능 합니다.");
								return;
							}

							if (model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd") == "") {
								alert("어음구분을 입력하십시오.");
								return;
							}
							if (model1.getValue("/root/resData/resDetailForm/note_issu_cmpy_clsf_cd") == "") {
								alert("발행구분을 입력하십시오.");
								return;
							}
							if (model1.getValue("/root/resData/resDetailForm/note_comp_dt") == "") {
								alert("발행일자를 입력하십시오.");
								return;
							}
							if (model1.getValue("/root/resData/resDetailForm/note_issu_pers_nm") == "") {
								alert("발행자를 입력하십시오.");
								return;
							}
								
							if (model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd") != "1061" &&
							    model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd") != "1071") {
							    if (model1.getValue("/root/resData/resDetailForm/note_note_no") == "" ||
							        model1.getValue("/root/resData/resDetailForm/note_note_no").length < 8) {
							    	alert("어음번호를 8자리로 입력하십시오.");
							    	return;
							    }
							}
							
							if (model1.getValue("/root/resData/resDetailForm/note_mtry_dt") == "") {
								if (window.alert("만기일자가 입력되지 않았습니다. 시스템일자로 등록하시겠습니까?", "확인", 1) == 1)
									model1.setValue("/root/resData/resDetailForm/note_mtry_dt", commCurDate("ymd"));
								else
									return;
							}
							
							if (model1.getValue("/root/resData/resDetailForm/note_bank_cd") == "") {
								alert("은행코드를 입력하십시오.");
								return;
							}
							if (model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd") == "1061" ||
							    model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd") == "1071") {
							    model1.setValue("/root/reqData/searchData/bank_cd", model1.getValue("/root/resData/resDetailForm/note_bank_cd"));
							    model1.send("en_innexp_1006");
							    if (model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt") == 0) {
							    	alert("기업구매카드용 은행코드를 입력하십시오.");
							    	return;
							    }
							    model1.removeNodeset("/root/tempData/dataSet");

							    if (model1.getValue("/root/resData/resDetailForm/note_rcpm_acct") == "") {
							    	alert("입금계좌를 입력하십시오.");
							    	return;
							    }

							    if (model1.getValue("/root/resData/resDetailForm/note_sale_aprv_no") == "") {
							    	alert("매출승인번호를 15자리 이내로 입력하십시오.");
							    	return;
							    }
							}
							initDrSubTotal();
							
							if (grd_dr.valueMatrix(grd_dr.rows-1, 1) != "")
								grd_dr.addRow();

							grd_dr.valueMatrix(grd_dr.rows-1, 1) = "050100";
							grd_dr.valueMatrix(grd_dr.rows-1, 2) = "받을어음";
							grd_dr.valueMatrix(grd_dr.rows-1, 3) = model1.getValue("/root/resData/resDetailForm/note_rcpm_amt");
							grd_dr.valueMatrix(grd_dr.rows-1, 7) = model1.getValue("/root/resData/resDetailForm/note_note_no");
							grd_dr.valueMatrix(grd_dr.rows-1, 8) = model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd");
							grd_dr.valueMatrix(grd_dr.rows-1, 9) = model1.getValue("/root/resData/resDetailForm/note_bank_cd");
							grd_dr.valueMatrix(grd_dr.rows-1, 10) = model1.getValue("/root/resData/resDetailForm/note_bank_nm");
							grd_dr.valueMatrix(grd_dr.rows-1, 11) = model1.getValue("/root/resData/resDetailForm/note_issu_pers_nm");
							grd_dr.valueMatrix(grd_dr.rows-1, 12) = model1.getValue("/root/resData/resDetailForm/note_issu_cmpy_clsf_cd");
							grd_dr.valueMatrix(grd_dr.rows-1, 13) = model1.getValue("/root/resData/resDetailForm/note_comp_dt");
							grd_dr.valueMatrix(grd_dr.rows-1, 14) = model1.getValue("/root/resData/resDetailForm/note_mtry_dt");
							grd_dr.valueMatrix(grd_dr.rows-1, 15) = model1.getValue("/root/resData/resDetailForm/note_rcpm_acct");
							grd_dr.valueMatrix(grd_dr.rows-1, 16) = model1.getValue("/root/resData/resDetailForm/note_sale_aprv_no");
													    							
						   if (model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd") != "1081") {	
							if (model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd") != "1061" &&
							    model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd") != "1071") {
								grd_dr.valueMatrix(grd_dr.rows-1, 15) = "";
								grd_dr.valueMatrix(grd_dr.rows-1, 16) = "";
							}
						   }		
							//어음 입력 컨트롤 초기화
							commGroupInit(grp_note);
							
						//전환금 관련 계정 차변 추가
						} else if (switch1.selectedIndex == 3) {
							if (model1.getValue("/root/resData/resDetailForm/swit_budg_cd") == "") {
								alert("예산코드를 입력하십시오");
								return;
							}
								
							if (model1.getValue("/root/resData/resDetailForm/swit_amt") == "") {
								alert("금액을 입력하십시오.");
								return;
							}
								
							if (parseInt(model1.getValue("/root/resData/resDetailForm/swit_amt")) >= 0) {
								if (model1.getValue("/root/resData/resDetailForm/swit_bal_occr_slip_no") == "") {
									alert("전사잔액 조회화면에서 해당 발생전표번호를 선택하십시오.");
									return;
								}
							}
							
							if (model1.getValue("/root/resData/resDetailForm/swit_bal_occr_slip_no") != "" && combo11.value != "404500" ) {
								if (model1.getValue("/root/resData/resDetailForm/swit_extnc_obj_slip_clsf") == "") {
									alert("소멸전표구분을 선택하십시오.");
									return;
								}
								if (model1.getValue("/root/resData/resDetailForm/swit_extnc_dlco_no") == "") {
									alert("소멸입금처를 입력하십시오.");
									return;
								}
							}
							initDrSubTotal();
							
							if (grd_dr.valueMatrix(grd_dr.rows-1, 1) != "")
								grd_dr.addRow();

							grd_dr.valueMatrix(grd_dr.rows-1, 1) = model1.getValue("/root/resData/resDetailForm/swit_budg_cd");
							grd_dr.valueMatrix(grd_dr.rows-1, 2) = model1.getValue("/root/resData/resDetailForm/swit_budg_nm");
							grd_dr.valueMatrix(grd_dr.rows-1, 3) = model1.getValue("/root/resData/resDetailForm/swit_amt");
							grd_dr.valueMatrix(grd_dr.rows-1, 17) = model1.getValue("/root/resData/resDetailForm/swit_bal_occr_slip_no");
							grd_dr.valueMatrix(grd_dr.rows-1, 18) = model1.getValue("/root/resData/resDetailForm/swit_extnc_obj_slip_clsf");
							grd_dr.valueMatrix(grd_dr.rows-1, 19) = model1.getValue("/root/resData/resDetailForm/swit_extnc_dlco_no");
							grd_dr.valueMatrix(grd_dr.rows-1, 20) = model1.getValue("/root/resData/resDetailForm/swit_medi_cd");
							
							//전환금 입력 컨트롤 초기화
							commGroupInit(grp_swit);
						
						//기타 계정 차변 추가	
						} else if (switch1.selectedIndex == 4) {
							if (model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "") {
								alert("예산코드를 입력하십시오.");
								return;
							}
								
							if (model1.getValue("/root/resData/resDetailForm/etc_amt") == "") {
								alert("금액을 입력하십시오.");
								return;
							}

							if (model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "001100" ||
							    model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "011400" ||
							    model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "017300" ||
							    model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "017500" ||
							    model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "050100" ||
							  //model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "463100" || //@@@
							    model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "456100") {
								alert("입력하신 예산코드는 기타항목이 아닙니다. 다른 예산코드를 입력하십시오.");
								return;
							}
							
							if (model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "464200"){
								alert("성금계정은 입력이 불가능 합니다.");
								return;
							}
							initDrSubTotal();

							if (grd_dr.valueMatrix(grd_dr.rows-1, 1) != "")
								grd_dr.addRow();

							grd_dr.valueMatrix(grd_dr.rows-1, 1) = model1.getValue("/root/resData/resDetailForm/etc_budg_cd");
							grd_dr.valueMatrix(grd_dr.rows-1, 2) = model1.getValue("/root/resData/resDetailForm/etc_budg_nm");
							grd_dr.valueMatrix(grd_dr.rows-1, 3) = model1.getValue("/root/resData/resDetailForm/etc_amt");
							
							//기타 입력 컨트롤 초기화
							commGroupInit(grp_etc);
						}
						
						getDrSubTotal();
					]]>
				</script>
			</button>
			<button id="button4" class="btn_grid04" style="left:271px; top:232px; width:65px; height:17px; ">
				<caption>차변삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var selectedIdx = grd_dr.row;
						grd_dr.deleteRow(selectedIdx, true);

						//차변 합계 계산
						getDrSubTotal();
						
						if (grd_dr.rows == 1)
							grd_dr.addRow();
					]]>
				</script>
			</button>
			<button id="button5" class="btn_grid04" style="left:547px; top:232px; width:65px; height:17px; ">
				<caption>대변추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var budg_cd = "";
						if (switch1.selectedIndex == 0) {
							budg_cd = "001100";
						} else if (switch1.selectedIndex == 1) {
							if (model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3602") {
								budg_cd = "017500";
							} else if (model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3511" ||
							           model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3512") {
								budg_cd = "017300";
							} else {
								budg_cd = "011400";
							}
						} else if (switch1.selectedIndex == 2) {
							budg_cd = "050100";
						} else if (switch1.selectedIndex == 3) {
							budg_cd = model1.getValue("/root/resData/resDetailForm/swit_budg_cd");
						} else if (switch1.selectedIndex == 4) {
							budg_cd = model1.getValue("/root/resData/resDetailForm/etc_budg_cd");
						}
						
						for (i = 1; i < grd_cr.rows; i++) {
							if (budg_cd != "" && budg_cd == grd_cr.valueMatrix(i, 1)) {
								alert("이미 추가된 항목입니다.");
								return;
							}
						}

						//현금계정 대변 추가
						if (switch1.selectedIndex == 0) {
							if (model1.getValue("/root/resData/resDetailForm/cash_amt") == "") {
								alert("금액을 입력하십시오.");
								return;
							}
							
							if (parseInt(model1.getValue("/root/resData/resDetailForm/cash_amt")) < 0) {
								alert("현금계정은 (-)금액 입력이 불가능 합니다.");
								return;
							}
							
							if (model1.getValue("/root/resData/resDetailForm/cash_payo_clsf_cd") == "") {
								alert("출금구분을 입력하십시오.");
								return;
							}
							
							if (model1.getValue("/root/resData/resDetailForm/cash_rcpm_occr_dt") == "") {
								alert("입금발생일자를 입력하십시오.");
								return;
							}
							
							if (model1.getValue("/root/resData/resDetailForm/cash_rcpm_occr_seq") == "") {
								alert("입금발생일련번호를 입력하십시오.");
								return;
							}
							model1.setValue("/root/resData/resForm/payo_clsf", model1.getValue("/root/resData/resDetailForm/cash_payo_clsf_cd"));
							model1.setValue("/root/resData/resForm/rcpm_occr_dt", model1.getValue("/root/resData/resDetailForm/cash_rcpm_occr_dt"));
							model1.setValue("/root/resData/resForm/rcpm_occr_seq", model1.getValue("/root/resData/resDetailForm/cash_rcpm_occr_seq"));
							
							//입금발생일자 및 일련번호를 피수정번호에 설정
							model1.setValue("/root/resData/resForm/p_upd_occr_dt", model1.getValue("/root/resData/resDetailForm/cash_rcpm_occr_dt"));
							model1.setValue("/root/resData/resForm/p_upd_occr_seq", model1.getValue("/root/resData/resDetailForm/cash_rcpm_occr_seq"));
							
							//출금대상입금일련번호의 총금액과 출금금액의 체크 로직 추가
							model1.setValue("/root/reqData/searchData/searchDetail/occr_dt", model1.getValue("/root/resData/resDetailForm/cash_rcpm_occr_dt"));
							model1.setValue("/root/reqData/searchData/searchDetail/slip_clsf_cd", "35");
							model1.setValue("/root/reqData/searchData/searchDetail/occr_seq", model1.getValue("/root/resData/resDetailForm/cash_rcpm_occr_seq"));
							model1.send("en_innexp_1009");
							var rcpm_amt1 = parseInt(model1.getValue("/root/tempData/dataSet/CURLIST/record/rcpm_amt"));
							var rcpm_amt2 = parseInt(model1.getValue("/root/resData/resDetailForm/cash_amt"));
							var total_cnt = model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt")
							model1.removeNodeset("/root/tempData/dataSet");
							if (total_cnt == "0") {
								alert("출금대상 입금발생일자 및 입금발생일련번호를 확인하십시오.");
								return;
							}
							if (rcpm_amt1 < rcpm_amt2) {
								alert("출금할 금액이 입금 총액을 초과하였습니다.");
								return;
							}
							
							//기존의 SUB TOTAL 삭제
							initCrSubTotal();

							if (grd_cr.valueMatrix(grd_cr.rows-1, 1) != "")
								grd_cr.addRow();

							grd_cr.valueMatrix(grd_cr.rows-1, 1) = "001100";
							grd_cr.valueMatrix(grd_cr.rows-1, 2) = "현금";
							grd_cr.valueMatrix(grd_cr.rows-1, 3) = model1.getValue("/root/resData/resDetailForm/cash_amt");

							//출금구분
							model1.setValue("/root/resData/resForm/payo_clsf", model1.getValue("/root/resData/resDetailForm/cash_payo_clsf_cd"));
							//입금발생일자
							model1.setValue("/root/resData/resForm/rcpm_occr_dt", model1.getValue("/root/resData/resDetailForm/cash_rcpm_occr_dt"));
							//입금발생일련번호
							model1.setValue("/root/resData/resForm/rcpm_occr_seq", model1.getValue("/root/resData/resDetailForm/cash_rcpm_occr_seq"));

							//현금 입력 컨트롤 초기화
							commGroupInit(grp_cash);
							
						//예금계정 대변 추가
						} else if (switch1.selectedIndex == 1) {
							if (model1.getValue("/root/resData/resDetailForm/deps_amt") == "") {
								alert("금액을 입력하십시오.");
								return;
							}
							if (parseInt(model1.getValue("/root/resData/resDetailForm/deps_amt")) < 0) {
								alert("보통예금계정은 (-)금액 입력이 불가능 합니다.");
								return;
							}
							
							if (model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "") {
								alert("은행구분을 입력하십시오.");
								return;
							}
							
							if (model1.getValue("/root/resData/resDetailForm/deps_rmtt_dt") == "") {
								alert("송금일자를 입력하십시오.");
								return;
							}
							
							if (model1.getValue("/root/resData/resDetailForm/deps_payo_clsf_cd") == "") {
								alert("출금구분을 입력하십시오.");
								return;
							}
							
							if (model1.getValue("/root/resData/resDetailForm/deps_rcpm_occr_dt") == "") {
								alert("입금발생일자를 입력하십시오.");
								return;
							}
							
							if (model1.getValue("/root/resData/resDetailForm/deps_rcpm_occr_seq") == "") {
								alert("입금발생일련번호를 입력하십시오.");
								return;
							}
							model1.setValue("/root/resData/resForm/payo_clsf", model1.getValue("/root/resData/resDetailForm/deps_payo_clsf_cd"));
							model1.setValue("/root/resData/resForm/rcpm_occr_dt", model1.getValue("/root/resData/resDetailForm/deps_rcpm_occr_dt"));
							model1.setValue("/root/resData/resForm/rcpm_occr_seq", model1.getValue("/root/resData/resDetailForm/deps_rcpm_occr_seq"));
							
							//입금발생일자 및 일련번호를 피수정번호에 설정
							model1.setValue("/root/resData/resForm/p_upd_occr_dt", model1.getValue("/root/resData/resDetailForm/deps_rcpm_occr_dt"));
							model1.setValue("/root/resData/resForm/p_upd_occr_seq", model1.getValue("/root/resData/resDetailForm/deps_rcpm_occr_seq"));

							//출금대상입금일련번호의 총금액과 출금금액의 체크 로직 추가
							model1.setValue("/root/reqData/searchData/searchDetail/occr_dt", model1.getValue("/root/resData/resDetailForm/deps_rcpm_occr_dt"));
							model1.setValue("/root/reqData/searchData/searchDetail/slip_clsf_cd", "35");
							model1.setValue("/root/reqData/searchData/searchDetail/occr_seq", model1.getValue("/root/resData/resDetailForm/deps_rcpm_occr_seq"));
							model1.send("en_innexp_1009");
							var rcpm_amt1 = parseInt(model1.getValue("/root/tempData/dataSet/CURLIST/record/rcpm_amt"));
							var rcpm_amt2 = parseInt(model1.getValue("/root/resData/resDetailForm/deps_amt"));
							var total_cnt = model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt")
							model1.removeNodeset("/root/tempData/dataSet");
							if (total_cnt == "0") {
								alert("출금대상 입금발생일자 및 입금발생일련번호를 확인하십시오.");
								return;
							}
							if (rcpm_amt1 < rcpm_amt2) {
								alert("출금할 금액이 입금 총액을 초과하였습니다.");
								return;
							}

							initCrSubTotal();

							if (grd_cr.valueMatrix(grd_cr.rows-1, 1) != "")
								grd_cr.addRow();

							if (model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3602") {
								grd_cr.valueMatrix(grd_dr.rows-1, 1) = "017500";
								grd_cr.valueMatrix(grd_dr.rows-1, 2) = "기업자유예금";
							} else if (model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3511" ||
							           model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3512") {
								grd_cr.valueMatrix(grd_dr.rows-1, 1) = "017300";
								grd_cr.valueMatrix(grd_dr.rows-1, 2) = "외화예금";
							} else {
								grd_cr.valueMatrix(grd_dr.rows-1, 1) = "011400";
								grd_cr.valueMatrix(grd_dr.rows-1, 2) = "보통예금";
							}
							
							grd_cr.valueMatrix(grd_cr.rows-1, 3) = model1.getValue("/root/resData/resDetailForm/deps_amt");
							grd_cr.valueMatrix(grd_cr.rows-1, 4) = model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no");
							grd_cr.valueMatrix(grd_cr.rows-1, 5) = model1.getValue("/root/resData/resDetailForm/deps_rmtt_dt");
							grd_cr.valueMatrix(grd_cr.rows-1, 6) = model1.getValue("/root/resData/resDetailForm/deps_rmtt_plac");
							grd_cr.valueMatrix(grd_dr.rows-1, 21) = model1.getValue("/root/resData/resDetailForm/deps_acct_mang_nm");

							//출금구분
							model1.setValue("/root/resData/resForm/payo_clsf", model1.getValue("/root/resData/resDetailForm/cash_payo_clsf_cd"));
							//입금발생일자
							model1.setValue("/root/resData/resForm/rcpm_occr_dt", model1.getValue("/root/resData/resDetailForm/cash_rcpm_occr_dt"));
							//입금발생일련번호
							model1.setValue("/root/resData/resForm/rcpm_occr_seq", model1.getValue("/root/resData/resDetailForm/cash_rcpm_occr_seq"));

							//예금 입력 컨트롤 초기화
							commGroupInit(grp_deps);
						
						//어음계정 대변 추가
						} else if (switch1.selectedIndex == 2) {
							if (model1.getValue("/root/resData/resDetailForm/note_rcpm_amt") == "") {
								alert("금액을 입력하십시오.");
								return;
							}
							if (parseInt(model1.getValue("/root/resData/resDetailForm/note_rcpm_amt")) < 0) {
								alert("어음계정은 (-)금액 입력이 불가능 합니다.");
								return;
							}

							if (model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd") != "1061" &&
							    model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd") != "1071") {
							    if (model1.getValue("/root/resData/resDetailForm/note_note_no") == "" ||
							        model1.getValue("/root/resData/resDetailForm/note_note_no").length < 8) {
							    	alert("어음번호를 8자리로 입력하십시오.");
							    	return;
							    }
							}
							
							if (model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd") == "") {
								alert("어음구분을 입력하십시오.");
								return;
							}
							if (model1.getValue("/root/resData/resDetailForm/note_issu_cmpy_clsf_cd") == "") {
								alert("발행구분을 입력하십시오.");
								return;
							}
							if (model1.getValue("/root/resData/resDetailForm/note_comp_dt") == "") {
								alert("발행일자를 입력하십시오.");
								return;
							}
							if (model1.getValue("/root/resData/resDetailForm/note_issu_pers_nm") == "") {
								alert("발행자를 입력하십시오.");
								return;
							}
								
							if (model1.getValue("/root/resData/resDetailForm/note_mtry_dt") == "") {
								if (window.alert("만기일자가 입력되지 않았습니다. 시스템일자로 등록하시겠습니까?", "확인", 1) == 1)
									model1.setValue("/root/resData/resDetailForm/note_mtry_dt", commCurDate("ymd"));
								else
									return;
							}
							
							if (model1.getValue("/root/resData/resDetailForm/note_bank_cd") == "") {
								alert("은행코드를 입력하십시오.");
								return;
							}
							if (model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd") == "1061" ||
							    model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd") == "1071") {
							    model1.setValue("/root/reqData/searchData/bank_cd", model1.getValue("/root/resData/resDetailForm/note_bank_cd"));
							    model1.send("en_innexp_1006");
							    if (model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt") == 0) {
							    	alert("기업구매카드용 은행코드를 입력하십시오.");
							    	return;
							    }
							    model1.removeNodeset("/root/tempData/dataSet");

							    if (model1.getValue("/root/resData/resDetailForm/note_rcpm_acct") == "") {
							    	alert("입금계좌를 입력하십시오.");
							    	return;
							    }

							    if (model1.getValue("/root/resData/resDetailForm/note_sale_aprv_no") == "") {
							    	alert("매출승인번호를 15자리 이내로 입력하십시오.");
							    	return;
							    }
							}
							
							initCrSubTotal();

							if (grd_cr.valueMatrix(grd_cr.rows-1, 1) != "")
								grd_cr.addRow();

							grd_cr.valueMatrix(grd_cr.rows-1, 1) = "050100";
							grd_cr.valueMatrix(grd_cr.rows-1, 2) = "받을어음";
							grd_cr.valueMatrix(grd_cr.rows-1, 3) = model1.getValue("/root/resData/resDetailForm/note_rcpm_amt");
							grd_cr.valueMatrix(grd_cr.rows-1, 7) = model1.getValue("/root/resData/resDetailForm/note_note_no");
							grd_cr.valueMatrix(grd_cr.rows-1, 8) = model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd");
							grd_cr.valueMatrix(grd_cr.rows-1, 9) = model1.getValue("/root/resData/resDetailForm/note_bank_cd");
							grd_cr.valueMatrix(grd_cr.rows-1, 10) = model1.getValue("/root/resData/resDetailForm/note_bank_nm");
							grd_cr.valueMatrix(grd_cr.rows-1, 11) = model1.getValue("/root/resData/resDetailForm/note_issu_pers_nm");
							grd_cr.valueMatrix(grd_cr.rows-1, 12) = model1.getValue("/root/resData/resDetailForm/note_issu_cmpy_clsf_cd");
							grd_cr.valueMatrix(grd_cr.rows-1, 13) = model1.getValue("/root/resData/resDetailForm/note_comp_dt");
							grd_cr.valueMatrix(grd_cr.rows-1, 14) = model1.getValue("/root/resData/resDetailForm/note_mtry_dt");
							grd_cr.valueMatrix(grd_cr.rows-1, 15) = model1.getValue("/root/resData/resDetailForm/note_rcpm_acct");
							grd_cr.valueMatrix(grd_cr.rows-1, 16) = model1.getValue("/root/resData/resDetailForm/note_sale_aprv_no");
							
							//어음인 경우는 입금계좌 및 매출승인번호 값을 Empty String 처리
							if (model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd") != "1061" &&
							    model1.getValue("/root/resData/resDetailForm/note_note_clsf_cd") != "1071") {
								grd_cr.valueMatrix(grd_dr.rows-1, 15) = "";
								grd_cr.valueMatrix(grd_dr.rows-1, 16) = "";
							}

							//어음 입력 컨트롤 초기화
							commGroupInit(grp_note);
							
						//전환금 관련 계정 대변 추가
						} else if (switch1.selectedIndex == 3) {
							if (model1.getValue("/root/resData/resDetailForm/swit_budg_cd") == "") {
								alert("예산코드를 입력하십시오");
								return;
							}
								
							if (model1.getValue("/root/resData/resDetailForm/swit_amt") == "") {
								alert("금액을 입력하십시오.");
								return;
							}
								
							if (model1.getValue("/root/resData/resDetailForm/swit_bal_occr_slip_no") == "") {
								alert("전사잔액화면에서 해당 발생전표번호를 선택하십시오.");
								return;
							}
							
							if (model1.getValue("/root/resData/resDetailForm/swit_extnc_obj_slip_clsf") == "") {
								alert("대상전표구분을 선택하십시오.");
								return;
							}

							if (model1.getValue("/root/resData/resDetailForm/swit_medi_cd") == "") {
								alert("매체코드를 입력하십시오.");
								return;
							}
								
							initCrSubTotal();

							if (grd_cr.valueMatrix(grd_cr.rows-1, 1) != "")
								grd_cr.addRow();

							grd_cr.valueMatrix(grd_cr.rows-1, 1) = model1.getValue("/root/resData/resDetailForm/swit_budg_cd");
							grd_cr.valueMatrix(grd_cr.rows-1, 2) = model1.getValue("/root/resData/resDetailForm/swit_budg_nm");
							grd_cr.valueMatrix(grd_cr.rows-1, 3) = model1.getValue("/root/resData/resDetailForm/swit_amt");
							grd_cr.valueMatrix(grd_cr.rows-1, 17) = model1.getValue("/root/resData/resDetailForm/swit_bal_occr_slip_no");
							grd_cr.valueMatrix(grd_cr.rows-1, 18) = model1.getValue("/root/resData/resDetailForm/swit_extnc_obj_slip_clsf");
							grd_cr.valueMatrix(grd_cr.rows-1, 19) = model1.getValue("/root/resData/resDetailForm/swit_extnc_dlco_no");
							grd_cr.valueMatrix(grd_cr.rows-1, 20) = model1.getValue("/root/resData/resDetailForm/swit_medi_cd");
						
							//전환금 입력 컨트롤 초기화
							commGroupInit(grp_swit);

						//기타 계정 대변 추가	
						} else if (switch1.selectedIndex == 4) {
							if (model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "") {
								alert("예산코드를 입력하십시오.");
								return;
							}
								
							if (model1.getValue("/root/resData/resDetailForm/etc_amt") == "") {
								alert("금액을 입력하십시오.");
								return;
							}
								
							if (model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "001100" ||
							    model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "011400" ||
							    model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "017300" ||
							    model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "017500" ||
							    model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "050100" ||
							  //model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "463100" || @@@
							    model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "456100") {
								alert("입력하신 예산코드는 기타항목이 아닙니다. 다른 예산코드를 입력하십시오.");
								return;
							}
							
							if (model1.getValue("/root/resData/resDetailForm/etc_budg_cd") == "464200"){
								alert("성금계정은 입력이 불가능 합니다.");
								return;
							}
							
							//잡이익구분 체크 로직 추가
							//if (model1.getValue("/root/resData/resDetailForm/etc_budg_cd").substring(0, 4) == "8035") {
							//	if (model1.getValue("/root/resData/resDetailForm/etc_acct_mang_no") == "") {
							//		alert("관리구분을 입력하십시오.");
							//		return;
							//	}
							//}
							
							//미수금 계정에 대한 처리 추가
							if (parseInt(model1.getValue("/root/resData/resDetailForm/etc_amt")) > parseInt(model1.getValue("/root/resData/resDetailForm/tmp_misu_amt"))) {
								alert("미수금 발생금액보다 대체금액이 큽니다.");
								return;
							}
							
							//전사잔액 변경에 대한 처리 추가
							//if (model1.getValue("463100") == "") {  //예수금(대체)
							//	model1.setValue("/root/resData/resDetailForm/swit_bal_occr_slip_no", "");
							//	model1.setValue("/root/resData/resDetailForm/swit_amt", "");
							//}
							//if (model1.getValue("456100") == "") {  //예수금(광고)
							//	model1.setValue("/root/resData/resDetailForm/swit_bal_occr_slip_no", "");
							//	model1.setValue("/root/resData/resDetailForm/swit_amt", "");
							//}
							

							initCrSubTotal();

							if (grd_cr.valueMatrix(grd_cr.rows-1, 1) != "")
								grd_cr.addRow();

							grd_cr.valueMatrix(grd_cr.rows-1, 1) = model1.getValue("/root/resData/resDetailForm/etc_budg_cd");
							grd_cr.valueMatrix(grd_cr.rows-1, 2) = model1.getValue("/root/resData/resDetailForm/etc_budg_nm");
							grd_cr.valueMatrix(grd_cr.rows-1, 3) = model1.getValue("/root/resData/resDetailForm/etc_amt");

							//기타 입력 컨트롤 초기화
							commGroupInit(grp_etc);
						}
						
						getCrSubTotal();
					]]>
				</script>
			</button>
			<button id="button6" class="btn_grid04" style="left:611px; top:232px; width:65px; height:17px; ">
				<caption>대변삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var selectedIdx = grd_cr.row;
						grd_cr.deleteRow(selectedIdx, true);

						//대변 합계 계산
						getCrSubTotal();

						if (grd_cr.rows == 1)
							grd_cr.addRow();
					]]>
				</script>
			</button>
			<caption id="caption17" class="list_cap03" style="left:760px; top:0px; width:81px; height:26px; ">입금표번호</caption>
			<input id="reven_dt" ref="/root/resData/resForm/reven_dt" class="req" navindex="2" inputtype="date" maxlength="10" format="yyyy-mm-dd" caption="수입결의일자" style="left:84px; top:4px; width:90px; height:18px; text-align:center; "/>
			<input id="evnt_cd" ref="/root/resData/resForm/evnt_cd" class="req" navindex="4" imemode="disabled" inputtype="button" maxlength="4" caption="행사코드" style="left:426px; top:4px; width:57px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model1.setValue("/root/reqData/fwdData/func_nm","setEvnt_cd");
						model1.setValue("/root/reqData/fwdData/evnt_yy", model1.getValue("/root/resData/resForm/evnt_yy"));
						window.load("/xrw/en/comm/EN_COMM_1100.xrw","modal", "EN_COMM_1100", "align:center; width:455; height:405; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");

						//model1.setValue("/root/reqData/fwdData/rtn_ref", "/root/resData/resForm");
						//model1.setValue("/root/reqData/fwdData/evnt_yy", model1.getValue("/root/resData/resForm/evnt_yy"));
						//window.load("/xrw/en/comm/EN_COMM_1100.xrw","modal", "EN_COMM_1100", "align:center; width:455; height:405; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/resData/resForm");

						//model1.send("en_innexp_1003");
						//makeComboSet("", "/root/tempData/dataSet/CURLIST/record", "/root/initData/comboSet/evnt_seq", "evnt_seq", "evnt_seq")
						//model1.removeNodeset("/root/tempData/dataSet");
						
						//evnt_seq.dispatch("xforms-value-changed");

						if (model1.getValue("/root/resData/resForm/evnt_cd") == "")
							return;
							
						model1.send("en_innexp_1019");
						setEvntSeq();
					]]>
				</script>
				<script type="javascript" ev:event="onmaxlength">
					<![CDATA[
						model1.setValue("/root/resData/resForm/evnt_seq", "");
						model1.setValue("/root/resData/resForm/evnt_nm", "");	
						model1.setValue("/root/resData/resForm/chrg_pers_emp_no", "");
						model1.setValue("/root/resData/resForm/chrg_pers_emp_nm", "");
						model1.setValue("/root/resData/resForm/chrg_dept_cd", "");
						model1.setValue("/root/resData/resForm/chrg_dept_nm", "");

						model1.setValue("/root/resData/resForm/evnt_cd", evnt_cd.currentText);
						model1.send("en_innexp_1019");

						if (model1.getValue("/root/tempData/dataSet/CURLIST2/totalcnt") == "1") {
							setEvntSeq();
							model1.setValue("/root/resData/resForm/evnt_seq", model1.getValue("/root/tempData/dataSet/CURLIST2/record/evnt_seq"));
							//model1.setValue("/root/resData/resForm/evnt_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/evnt_nm"));
						} else if (parseInt(model1.getValue("/root/tempData/dataSet/CURLIST2/totalcnt")) > 1) {
							model1.setValue("/root/reqData/fwdData/func_nm","setEvnt_cd");
							model1.setValue("/root/reqData/fwdData/evnt_yy", model1.getValue("/root/resData/resForm/evnt_yy"));
							model1.setValue("/root/reqData/fwdData/evnt_cd", model1.getValue("/root/resData/resForm/evnt_cd"));
							window.load("/xrw/en/comm/EN_COMM_1100.xrw","modal", "EN_COMM_1100", "align:center; width:455; height:405; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
							
							//model1.setValue("/root/reqData/fwdData/rtn_ref", "/root/resData/resForm");
							//model1.setValue("/root/reqData/fwdData/evnt_yy", model1.getValue("/root/resData/resForm/evnt_yy"));
							//model1.setValue("/root/reqData/fwdData/evnt_cd", model1.getValue("/root/resData/resForm/evnt_cd"));
							//window.load("/xrw/en/comm/EN_COMM_1100.xrw","modal", "EN_COMM_1100", "align:center; width:455; height:405; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/resData/resForm");
							
							model1.send("en_innexp_1019");
							setEvntSeq();
						}

						//model1.send("en_innexp_1003");
						//makeComboSet("", "/root/tempData/dataSet/CURLIST/record", "/root/initData/comboSet/evnt_seq", "evnt_seq", "evnt_seq")
						//model1.removeNodeset("/root/tempData/dataSet");

						//evnt_seq.dispatch("xforms-value-changed");

						model1.removeNodeset("/root/tempData/dataSet");
						model1.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						model1.setValue("/root/resData/resForm/evnt_seq", "");
						model1.setValue("/root/resData/resForm/evnt_nm", "");	
						model1.setValue("/root/resData/resForm/chrg_pers_emp_no", "");
						model1.setValue("/root/resData/resForm/chrg_pers_emp_nm", "");
						model1.setValue("/root/resData/resForm/chrg_dept_cd", "");
						model1.setValue("/root/resData/resForm/chrg_dept_nm", "");
						model1.refresh();	
					]]>
				</script>
			</input>
			<output id="evnt_nm" ref="/root/resData/resForm/evnt_nm" navindex="49" inputtype="button" appearance="output" style="left:488px; top:4px; width:192px; height:18px; background-color:#fefae2; "/>
			<select1 id="evnt_seq" ref="/root/resData/resForm/evnt_seq" class="req" navindex="5" appearance="minimal" caption="행사일련번호" style="left:695px; top:4px; width:42px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/evnt_seq/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						//행사코드에 따른 담당자와 부서정보 조회
						model1.send("en_innexp_1019");
						setEvntSeq();
						/*
						model1.setValue("/root/resData/resForm/evnt_nm", model1.getValue("/root/tempData/dataSet/CURLIST2/record/evnt_nm"));
						model1.setValue("/root/resData/resForm/chrg_dept_cd", model1.getValue("/root/tempData/dataSet/CURLIST3/record/chrg_dept_cd"));
						model1.setValue("/root/resData/resForm/chrg_dept_nm", model1.getValue("/root/tempData/dataSet/CURLIST3/record/chrg_dept_nm"));
						model1.setValue("/root/resData/resForm/chrg_pers_emp_no", model1.getValue("/root/tempData/dataSet/CURLIST3/record/chrg_pers_emp_no"));
						model1.setValue("/root/resData/resForm/chrg_pers_emp_nm", model1.getValue("/root/tempData/dataSet/CURLIST3/record/chrg_pers_emp_nm"));
						*/
						model1.removeNodeset("/root/tempData/dataSet");
						model1.refresh();		
					]]>
				</script>
			</select1>
			<input id="rcpm_shet_no" ref="/root/resData/resForm/rcpm_shet_no" navindex="7" inputtype="button" style="left:845px; top:4px; width:75px; height:18px; font-size:6pt; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model1.makeNode("/root/reqData/fwdData/rcpm_clsf");
						model1.makeNode("/root/reqData/fwdData/rcpm_shet_kind");
						model1.makeNode("/root/reqData/fwdData/rcpm_shet_no");
						model1.setValue("/root/reqData/fwdData/rcpm_clsf", "35");
						
						window.load("../comm/EN_COMM_1400.xrw","modal", "EN_COMM_1400", "align:center; width:805; height:605; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
						
						model1.setValue("/root/resData/resForm/rcpm_shet_kind", model.getValue("/root/reqData/fwdData/rcpm_shet_kind"));
						model1.setValue("/root/resData/resForm/rcpm_shet_no", model.getValue("/root/reqData/fwdData/rcpm_shet_no"));
						
						model1.removenode("/root/reqData/fwdData/rcpm_clsf");
						model1.removenode("/root/reqData/fwdData/rcpm_shet_kind");
						model1.removenode("/root/reqData/fwdData/rcpm_shet_no");
						model1.refresh();
						/*
						model.property("FC_ACCT_2040_popup_flag") = "Y";
						//입금표종류 '2' 노랑입금표만 사용
						model.property("FC_ACCT_2040_rcpm_shet_kind") = "2";

						viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2860");

						model1.setValue("/root/resData/resForm/rcpm_shet_kind", model.property("FC_ACCT_2040_rcpm_shet_kind"));
						model1.setValue("/root/resData/resForm/rcpm_shet_no", model.property("FC_ACCT_2040_widr_resn"));
						model1.refresh();
						model.property("FC_ACCT_2040_rcpm_shet_kind")  = "";
						model.property("FC_ACCT_2040_widr_resn") = "";
						*/
					]]>
				</script>
			</input>
			<caption id="caption70" class="list_cap02" style="left:746px; top:179px; width:91px; height:26px; font-family:굴림; font-size:9pt; font-weight:bold; text-align:center; background-color:#fefeee; "/>
			<caption id="caption71" class="list_cap01" style="left:836px; top:129px; width:91px; height:26px; font-family:굴림; font-size:9pt; text-align:center; ">계 (전일기준)</caption>
			<caption id="caption60" class="list_cap02" style="left:746px; top:204px; width:91px; height:26px; font-family:굴림; font-size:9pt; font-weight:bold; text-align:center; background-color:#fefeee; "/>
			<caption id="caption61" class="list_cap01" style="left:697px; top:154px; width:50px; height:26px; font-family:굴림; font-size:9pt; text-align:center; ">수 입</caption>
			<output id="opt_budg_bal_amt" ref="/root/resData/resTemp/bal_budg_amt" format="#,###" appearance="output" maxlength="10" style="left:751px; top:208px; width:81px; height:18px; text-align:right; "/>
			<caption id="caption73" class="list_cap01" style="left:697px; top:204px; width:50px; height:26px; font-family:굴림; font-size:9pt; text-align:center; ">잔 액</caption>
			<output id="input31" ref="/root/resData/resTemp/tot_bal_amt" format="#,###" appearance="output" maxlength="10" style="left:841px; top:208px; width:81px; height:18px; text-align:right; "/>
			<output id="opt_budg_reven_amt" ref="/root/resData/resTemp/reven_budg_amt" format="#,###" appearance="output" style="left:751px; top:158px; width:81px; height:18px; text-align:right; "/>
			<output id="input32" ref="/root/resData/resTemp/tot_expn_amt" format="#,###" appearance="output" maxlength="10" style="left:841px; top:183px; width:81px; height:18px; text-align:right; "/>
			<output id="opt_budg_expn_amt" ref="/root/resData/resTemp/expn_budg_amt" format="#,###" appearance="output" maxlength="10" style="left:751px; top:183px; width:81px; height:18px; text-align:right; "/>
			<caption id="caption65" class="list_cap01" style="left:747px; top:129px; width:90px; height:26px; font-family:굴림; font-size:9pt; text-align:center; ">예산기준</caption>
			<caption id="caption67" class="list_cap01" style="left:697px; top:179px; width:50px; height:26px; font-family:굴림; font-size:9pt; text-align:center; ">지 출</caption>
			<caption id="caption25" class="list_cap02" style="left:836px; top:154px; width:91px; height:26px; font-family:굴림; font-size:9pt; font-weight:bold; text-align:center; background-color:#fefeee; "/>
			<output id="input29" ref="/root/resData/resTemp/tot_reven_amt" format="#,###" appearance="output" maxlength="10" style="left:841px; top:158px; width:81px; height:18px; text-align:right; "/>
			<datagrid id="grd_detail" nodeset="/root/resData/gridData/grid4/record" visibility="hidden" caption="차대구분^예산코드^금액^계좌관리번호^송금일자^송금처(인)^어음번호^은행코드^어음구분^발행일자^만기일자^발행구분^발행자^매출승인번호^입금계좌" colsep="#" colwidth="100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowheight="20" rowsep="|" style="left:698px; top:235px; width:227px; height:40px; ">
				<col ref="drcr_clsf"/>
				<col ref="budg_cd"/>
				<col ref="amt"/>
				<col ref="acct_mang_no"/>
				<col ref="rmtt_dt"/>
				<col ref="rmtt_plac"/>
				<col ref="note_no"/>
				<col ref="note_clsf_cd"/>
				<col ref="bank_cd"/>
				<col ref="issu_pers_nm"/>
				<col ref="issu_cmpy_clsf_cd"/>
				<col ref="comp_dt"/>
				<col ref="mtry_dt"/>
				<col ref="rcpm_acct"/>
				<col ref="sale_aprv_no"/>
				<col ref="bal_occr_slip_no"/>
				<col ref="extnc_obj_slip_clsf"/>
				<col ref="extnc_dlco_no"/>
				<col ref="medi_cd"/>
				<col ref="biz_reg_no"/>
				<col ref="bank_id"/>
				<col ref="acct_num"/>
				<col ref="tran_date"/>
				<col ref="tran_date_seq"/>
				<col ref="slip_no"/>
			</datagrid>
			<caption id="caption29" class="list_cap02" style="left:760px; top:75px; width:167px; height:26px; font-family:굴림; font-size:9pt; font-weight:bold; text-align:center; background-color:#fefeee; "/>
			<caption id="caption35" class="list_cap03" style="left:681px; top:75px; width:80px; height:26px; ">피수정번호</caption>
			<caption id="caption38" style="left:860px; top:79px; width:13px; height:20px; font-family:굴림체; font-size:9pt; font-weight:bold; ">-</caption>
			<input id="input2" ref="/root/resData/resForm/p_upd_occr_seq" navindex="23" inputtype="button" style="left:875px; top:79px; width:45px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model1.setValue("/root/reqData/fwdData/func_nm", "setUpd_Occr_No");
						window.load("../../en/innexp/EN_INNEXP_1010.xrw","modal", "EN_INNEXP_1010", "align:center; width:950px; height:756px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
					]]>
				</script>
			</input>
			<input id="input4" ref="/root/resData/resForm/p_upd_occr_dt" navindex="22" inputtype="date" maxlength="10" format="yyyy-mm-dd" style="left:765px; top:79px; width:90px; height:18px; text-align:center; "/>
			<select1 id="combo1" ref="/root/resData/resForm/evnt_yy" class="req" navindex="5" appearance="minimal" caption="행사년도" style="left:275px; top:4px; width:60px; height:18px; text-align:center; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/evnt_yy/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<button id="button7" class="btn_grid05" style="left:0px; top:230px; width:165px; height:17px; ">
				<caption>가상계좌추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					 var v_boks_dlco_nmf;
				     //=======================================================================================================================================
				     //		var budg_cd = "";
				      //=======================================================================================================================================
				      //	if (switch1.selectedIndex == 0) {
				      //		budg_cd = "001100";
				      //	} else if (switch1.selectedIndex == 1) {
				      //=======================================================================================================================================	
				      //		if (model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3602") {
				      //			budg_cd = "017500";
			   	      //		} else if (model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3511" ||
			  	      //		           model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3512") {
				      //			budg_cd = "017300";
			  	      //		} else {
				      //			budg_cd = "011400";
			  	      //		}
				      //=======================================================================================================================================			
				      //=======================================================================================================================================		
				      //			
					//		if (model1.getValue("/root/resData/resDetailForm/deps_amt") == "") {
					//			alert("금액을 입력하십시오.");
					//			return;
					//		}
					//		
					//		if (model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "") {
					//			alert("은행구분을 입력하십시오.");
					//			return;
					//		}
					//		
					//		if (model1.getValue("/root/resData/resDetailForm/deps_rmtt_dt") == "") {
					//			alert("송금일자를 입력하십시오.");
					//			return;
					//		}
					//		
					//		initDrSubTotal();
					//		
					//		if (grd_dr.valueMatrix(grd_dr.rows-1, 1) != "")
					//			grd_dr.addRow();
                                     //
					//		if (model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3602") {
					//			grd_dr.valueMatrix(grd_dr.rows-1, 1) = "017500";
					//			grd_dr.valueMatrix(grd_dr.rows-1, 2) = "기업자유예금";
					//		} else if (model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3511" ||
					//		           model1.getValue("/root/resData/resDetailForm/deps_acct_mang_no") == "3512") {
					//			grd_dr.valueMatrix(grd_dr.rows-1, 1) = "017300";
					//			grd_dr.valueMatrix(grd_dr.rows-1, 2) = "외화예금";
					//		} else {
					//			grd_dr.valueMatrix(grd_dr.rows-1, 1) = "011400";
					//			grd_dr.valueMatrix(grd_dr.rows-1, 2) = "보통예금";
					//		}							
					//=======================================================================================================================================		
										      
				       //   model1.removeNodeset("/root/resData/gridData/gridData2");  
						 
					      button8.visible=  true;
                          //  20130912                btn_ins.visible = false;  
                          //                               btn_upd.visible = false;
						    
					    	model1.removenode("/root/resData/gridData/gridData2");
						model1.makeNode("/root/resData/gridData/gridData2");
						grd_dr.refresh();    
						  									               
					        for  (i = 1; i < datagrid1.rows; i++) {
					        	grd_dr.addRow();
							grd_dr.valueMatrix(i, 1)   = "017500" ;                                              // 예산코드 
							grd_dr.valueMatrix(i, 2)   = "기업자유예금";                                      // 예산코드명
						       grd_dr.valueMatrix(i, 3)   =  datagrid1.valueMatrix(i, 7);                    // 금액
							grd_dr.valueMatrix(i, 4)   = "3602" ;                                                 // 계좌관리번호
							grd_dr.valueMatrix(i, 5)   =  datagrid1.valueMatrix(i, 4);                    // 송금일자       
							grd_dr.valueMatrix(i, 6)   =  datagrid1.valueMatrix(i, 8);                    // 송금처   
							grd_dr.valueMatrix(i, 21)  = "신한기업자유" ;                                     // 계좌관리명
							
							grd_dr.valueMatrix(i, 22)   =  datagrid1.valueMatrix(i, 1);                    // 계좌주사업자번호      
							grd_dr.valueMatrix(i, 23)   =  datagrid1.valueMatrix(i, 2);                    // 은행ID       
							grd_dr.valueMatrix(i, 24)   =  datagrid1.valueMatrix(i, 3);                    // 계좌번호       
							grd_dr.valueMatrix(i, 25)   =  datagrid1.valueMatrix(i, 4);                    // 거래일자        
							grd_dr.valueMatrix(i, 26)   =  datagrid1.valueMatrix(i, 5);                    // 거래일자 일련번호       
							 	   							
						      }
						   //  model1.removenode("/root/resData/gridData/grid6/record/rmtt_plac");		 
					           // return;
						      grd_dr.refresh();
					          //  model1.removeNodeset("/root/resData/gridData/grid6");
					  	  // 예금 입력 컨트롤 초기화
						      commGroupInit(grp_deps);
							
					 	      getDrSubTotal();				
					]]>
				</script>
			</button>
		</group>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:45px; width:928px; height:21px; ">
			<button id="btn_upd" class="btn02" crud="U" style="left:710px; top:0px; width:53px; height:21px; ">
				<caption>수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (model1.getValue("/root/resData/resForm/occr_dt") == "") {
							alert("수정할 수입내역이 존재하지 않습니다.");
							return;
						}
						
						//수정모드 설정
						model1.setValue("/root/reqData/multiUpDate/mst_mode", "U");
						
						//수정 프로세스 수행
						if (window.alert("수정하시겠습니까?", "확인", 1) == 1)
							procReven();						
					]]>
				</script>
			</button>
			<button id="btn_srch" class="btn02" crud="R" style="left:595px; top:0px; width:53px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						
						model1.removeNodeset("/root/resData/gridData/gridData2/record");
						model1.removeNodeset("/root/resData/gridData/gridData3/record");	
						
						model1.setValue("/root/resData/resForm/occr_dt", "");
						
						model1.setValue("/root/resData/resForm/evnt_cd",""); 
						model1.setValue("/root/resData/resForm/evnt_nm",""); 
						model1.setValue("/root/resData/resForm/evnt_seq",""); 
						
						model1.setValue("/root/resData/resForm/rcpm_shet_no",""); 
						model1.setValue("/root/resData/resForm/dlco_clsf_cd",""); 						
						model1.setValue("/root/resData/resForm/dlco_no",""); 
						model1.setValue("/root/resData/resForm/dlco_nm",""); 
						
						model1.setValue("/root/resData/resForm/boks_dlco_nm",""); 
						model1.setValue("/root/resData/resForm/chrg_pers_emp_no",""); 						
						model1.setValue("/root/resData/resForm/chrg_pers_emp_nm",""); 
						
						model1.setValue("/root/resData/resForm/titl ",""); 
						model1.setValue("/root/resData/resForm/remk",""); 
						model1.setValue("/root/resData/resForm/chrg_dept_cd","");
						model1.setValue("/root/resData/resForm/chrg_dept_nm",""); 
						
						model1.setValue("/root/resData/resForm/p_upd_occr_dt","");
						model1.setValue("/root/resData/resForm/p_upd_occr_seq",""); 
						
						model1.send("en_innexp_1001");
									
						model1.copyNode("/root/resData/gridData/gridData1", "/root/tempData/dataSet/CURLIST");
						model1.removeNodeset("/root/tempData/dataSet");
						grd_reven_list.refresh();
						
						if (grd_reven_list.rows == 1)
							grd_reven_list.addRow();
                                          
                                            //수입내역 상세 조회시 차변, 대변의 '추가' 버튼을 비활성화 시킴
						button3.disabled = false;
						button5.disabled = false;
						
						//수입내역 상세 조회시 차변, 대변의 '삭제' 버튼을 비활성화 시킴
						button4.disabled = false;
						button6.disabled = false;
						
						//수입내역 상세 조회시 차변의 '가상추가' 버튼을 비활성화 시킴
                                               button7.disabled = false;
					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" style="left:820px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.reset();	
						initDrSubTotal();
						initCrSubTotal();	
					      
					      //수입내역 상세 조회시 차변, 대변의 '추가' 버튼을 비활성화 시킴
						button3.disabled = false;
						button5.disabled = false;
					      
						//수입내역 상세 조회시 차변, 대변의 '삭제' 버튼을 비활성화 시킴
						button4.disabled = false;
						button6.disabled = false;
						
						//수입내역 상세 조회시 차변의 '가상추가' 버튼을 비활성화 시킴
                                              button7.disabled = false;
						
						button2.visible = false;
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:875px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" visibility="hidden" style="left:460px; top:0px; width:53px; height:21px; ">
				<caption>도움말</caption>
			</button>
			<button id="btn_ins" class="btn02" crud="C" style="left:655px; top:0px; width:52px; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (model1.getValue("/root/resData/resForm/occr_dt") != "") {
							alert("이미 입력된 수입내역이므로 수정 또는 삭제만 가능합니다.");
							return;
						}

						//입력모드 설정
						model1.setValue("/root/reqData/multiUpDate/mst_mode", "I");
						
						//입력 프로세스 수행
						if (window.alert("입력하시겠습니까?", "확인", 1) == 1)
							procReven();						
					]]>
				</script>
			</button>
			<button id="btn_del" class="btn02" crud="D" style="left:765px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (model1.getValue("/root/resData/resForm/occr_dt") == "") {
							alert("삭제할 수입내역이 존재하지 않습니다.");
							return;
						}

						//삭제모드 설정
						model1.setValue("/root/reqData/multiUpDate/mst_mode", "D");
						
						//삭제 프로세스 수행
						if (window.alert("삭제하시겠습니까?", "확인", 1) == 1)
							procReven();						
						
					]]>
				</script>
			</button>
			<button id="button8" class="btn03" crud="C" style="left:515px; top:0px; width:68px; height:21px; ">
				<caption>가상계좌입금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (model1.getValue("/root/resData/resForm/occr_dt") != "") {
							alert("이미 입력된 수입내역이므로 수정 또는 삭제만 가능합니다.");
							return;
						}

						//입력모드 설정
						model1.setValue("/root/reqData/multiUpDate/mst_mode", "I");
						
						//입력 프로세스 수행
						if (window.alert("입력하시겠습니까?", "확인", 1) == 1){
							procReven_GsgJ();		
						}
					]]>
				</script>
			</button>
		</group>
		<import id="import1" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:927px; height:29px; "/>
		<group id="group_scr" class="gro_sel" style="left:10px; top:74px; width:927px; height:26px; ">
			<caption id="caption9" class="list_cap02" style="left:84px; top:0px; width:843px; height:26px; text-align:center; "/>
			<caption id="caption4" class="list_cap01" style="left:0px; top:0px; width:85px; height:26px; text-align:center; ">수입발생일자</caption>
			<input id="ipt_srch_occr_dt" ref="/root/reqData/searchData/occr_dt_fr" navindex="1" inputtype="date" maxlength="10" format="yyyy-mm-dd" style="left:89px; top:4px; width:85px; height:18px; "/>
			<input id="input1" ref="/root/reqData/searchData/occr_dt_to" navindex="1" inputtype="date" maxlength="10" format="yyyy-mm-dd" style="left:185px; top:4px; width:85px; height:18px; "/>
			<caption id="caption13" style="left:175px; top:4px; width:13px; height:20px; font-family:굴림체; font-size:9pt; ">~</caption>
			<caption id="caption16" class="list_cap01" style="left:305px; top:0px; width:85px; height:26px; text-align:center; ">거 래 처</caption>
			<output id="opt_srch_dlco_nm" ref="/root/reqData/searchData/srch_dlco_nm" navindex="10" appearance="output" style="left:473px; top:4px; width:132px; height:18px; "/>
			<input id="ipt_srch_dlco_no" ref="/root/reqData/searchData/srch_dlco_no" navindex="10" inputtype="button" maxlength="8" appearance="input" style="left:394px; top:4px; width:75px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model1.setValue("/root/reqData/fwdData/func_nm","setSrch_dlco_no");
						window.load("/xrw/co/dlco/CO_DLCO_1100.xrw","modal","CO_DLCO_1100","align:center; width:645; height:480; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (ipt_srch_dlco_no.value == "")
							opt_srch_dlco_nm.value = "";		
					]]>
				</script>
				<script type="javascript" ev:event="onmaxlength">
					<![CDATA[
						model1.setValue("/root/reqData/searchData/srch_dlco_no", ipt_srch_dlco_no.currentText);
						model1.setValue("/root/reqData/searchData/dlco_no", ipt_srch_dlco_no.currentText);
						model1.send("en_comm_1003");
						model1.setValue("/root/reqData/searchData/srch_dlco_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_nm"));
						model1.removeNodeset("/root/tempData/dataSet");
						model1.refresh();		
					]]>
				</script>
			</input>
			<caption id="caption27" class="list_cap01" style="left:635px; top:0px; width:85px; height:26px; text-align:center; ">제     목</caption>
			<input id="input3" ref="/root/reqData/searchData/srch_titl" navindex="10" appearance="input" style="left:724px; top:4px; width:150px; height:18px; "/>
		</group>
		<button id="btn_misu" class="tab08" group="tab" style="left:140px; top:106px; width:130px; height:23px; ">
			<caption>미수금잔액내역</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model1.toggle("case7");
					
					//입력항목 초기화
					commGroupInit(grp_main);
					grd_dr.addRow();
					grd_cr.addRow();
					model1.setValue("/root/resData/resForm/reven_dt", commCurDate("ymd"));
					
					//미수금 현황이 조회되지 않은 경우
					if (grd_misu.valueMatrix(1, 1) == "") {
						model1.send("en_innexp_1011");
						model1.copyNode("/root/resData/gridData/grid5", "/root/tempData/dataSet/CURLIST");
						model1.removeNodeset("/root/tempData/dataSet");
						model1.refresh();
					}
				]]>
			</script>
		</button>
		<button id="btn_reven" class="tab08" group="tab" selected="true" style="left:10px; top:106px; width:130px; height:23px; ">
			<caption>수입결의내역</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model1.toggle("case6");
				]]>
			</script>
		</button>
		<switch id="switch2" style="left:10px; top:130px; width:927px; height:205px; ">
			<case id="case6">
				<datagrid id="grd_reven_list" nodeset="/root/resData/gridData/gridData1/record" autoresize="true" caption="수입발생번호^행사명^제 목^거래처명^수입일자^수입금액^부가세액^입금액^계산서번호^현업전표번호^담당자^담당부서^등록자^등록일자^^^caption1^caption2^caption3" colsep="^" colwidth="90, 120, 120, 130, 80, 90, 80, 90, 100, 100, 70, 90, 70, 80, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" navindex="44" noeset="/root/gridData/main/a" style="left:5px; top:5px; width:915px; height:194px; ">
					<col ref="reven_no" style="text-align:center; "/>
					<col ref="evnt_nm" style="text-align:left; "/>
					<col ref="titl" style="text-align:left; "/>
					<col ref="dlco_nm" style="text-align:left; "/>
					<col ref="reven_dt" format="yyyy-mm-dd"/>
					<col ref="reven_amt" format="(-)#,###" style="text-align:right; "/>
					<col ref="vat_amt" format="(-)#,###" style="text-align:right; "/>
					<col ref="rcpm_amt" format="(-)#,###" style="text-align:right; "/>
					<col ref="stmt_no"/>
					<col ref="actu_slip_no" visibility="hidden"/>
					<col ref="chrg_pers_nm"/>
					<col ref="chrg_dept_nm"/>
					<col ref="incmg_pers_nm"/>
					<col ref="incmg_dt" format="yyyy-mm-dd"/>
					<col ref="occr_dt" visibility="hidden"/>
					<col ref="slip_clsf_cd" visibility="hidden"/>
					<col ref="occr_seq" visibility="hidden"/>
					<col ref="evnt_yy" visibility="hidden"/>
					<col ref="evnt_cd" visibility="hidden"/>
					<col ref="evnt_seq" visibility="hidden"/>
					<script type="javascript" ev:event="ondblclick">
						<![CDATA[
							if(grd_reven_list.row == 0) return;	
							
							if (grd_reven_list.col == 1) return;
							
							if (grd_reven_list.valueMatrix(grd_reven_list.row, 1) == "") return;
							
							//노드의 값을 초기화
							for (i = 0; i < root.resData.resDetailForm.childNodes.length; i++) {
								root.resData.resDetailForm.childNodes(i).nodeValue = "";
							}
							
							var selectedIdx = grd_reven_list.row;
							
							var occr_dt = grd_reven_list.valueMatrix(selectedIdx, 15);
							var slip_clsf_cd = grd_reven_list.valueMatrix(selectedIdx, 16);
							var occr_seq = grd_reven_list.valueMatrix(selectedIdx, 17);
							
							var evnt_yy = grd_reven_list.valueMatrix(selectedIdx, 18);
							var evnt_cd = grd_reven_list.valueMatrix(selectedIdx, 19);
							var evnt_seq = grd_reven_list.valueMatrix(selectedIdx, 20);
							
							model1.setValue("/root/reqData/searchData/searchDetail/occr_dt", occr_dt);
							model1.setValue("/root/reqData/searchData/searchDetail/slip_clsf_cd", slip_clsf_cd);
							model1.setValue("/root/reqData/searchData/searchDetail/occr_seq", occr_seq);
							model1.setValue("/root/reqData/searchData/searchDetail/evnt_yy", evnt_yy);
							model1.setValue("/root/reqData/searchData/searchDetail/evnt_cd", evnt_cd);
							model1.setValue("/root/reqData/searchData/searchDetail/evnt_seq", evnt_seq);
							
							//사업수일 일마감 체크용
							model1.setValue("/root/reqData/searchData/searchDetail/clos_dt", occr_dt);
							
							//수입발생내역 상세조회
							model1.send("en_innexp_1002");							
							model1.copyNode("/root/resData/resForm", "/root/tempData/dataSet/CURLIST1/record");
							model1.copyNode("/root/resData/gridData/gridData2", "/root/tempData/dataSet/CURLIST2");
							model1.copyNode("/root/resData/gridData/gridData3", "/root/tempData/dataSet/CURLIST3");
							
							//계산서가 발행된 경우 계산서 번호를 화면에 출력
							//if (model1.getValue("/root/resData/resForm/stmt_occr_dt") != "") {
							//	opt_stmt_no.value = model1.getValue("/root/resData/resForm/stmt_occr_dt") + "-35-" + model1.getValue("/root/resData/resForm/stmt_occr_seq");
							//}
							model1.refresh();
		
							//차변 및 대변 합계 계산
							getSubTotal();
							
							//거래처구분코드가 92(부서)일 경우 담당부서코드로 세팅
							if (model1.getValue("/root/resData/resForm/dlco_clsf_cd") == "92") {
								model1.setValue("/root/resData/resForm/dlco_no", model1.getValue("/root/resData/resForm/chrg_dept_cd"));
								model1.setValue("/root/resData/resForm/dlco_nm", model1.getValue("/root/resData/resForm/chrg_dept_nm"));
							}

							//행사년도-행사코드에 따른 행사일련번호 설정
							makeComboSet("", "/root/tempData/dataSet/CURLIST4/record", "/root/initData/comboSet/evnt_seq", "evnt_seq", "evnt_seq")

							//model1.removeNodeset("/root/tempData/dataSet");
		
							//행사년도-행사코드에 따른 행사일련번호 조회
							//model1.send("en_innexp_1003");
							//makeComboSet("", "/root/tempData/dataSet/CURLIST/record", "/root/initData/comboSet/evnt_seq", "evnt_seq", "evnt_seq")
							//model1.removeNodeset("/root/tempData/dataSet");
							
							//행사코드에 따른 예산계획조회
							//getBudgPlan();
							if (model1.getValue("/root/tempData/dataSet/CURLIST5/totalcnt") != "0") {
								model1.setValue("/root/resData/resTemp/reven_budg_amt", model1.getValue("/root/tempData/dataSet/CURLIST5/record/reven_amt"));
								model1.setValue("/root/resData/resTemp/expn_budg_amt", model1.getValue("/root/tempData/dataSet/CURLIST5/record/expn_amt"));
								model1.setValue("/root/resData/resTemp/bal_budg_amt", model1.getValue("/root/tempData/dataSet/CURLIST5/record/bal_amt"));
							}
							
							//행사코드에 따른 수입/지출 내역 조회
							//getRevenExpnAmt();
							if (model1.getValue("/root/tempData/dataSet/CURLIST6/totalcnt") != "0") {
								model1.setValue("/root/resData/resTemp/tot_reven_amt", model1.getValue("/root/tempData/dataSet/CURLIST6/record/reven_stot"));
								model1.setValue("/root/resData/resTemp/tot_expn_amt", model1.getValue("/root/tempData/dataSet/CURLIST6/record/expn_stot"));
								model1.setValue("/root/resData/resTemp/tot_bal_amt", model1.getValue("/root/tempData/dataSet/CURLIST6/record/bal_stot"));
							}
							
							//가상계좌 입금내역   
							// model1.removenode("/root/resData/gridData/grid6/record/rmtt_plac");	//20100809   
							model1.copyNode("/root/resData/gridData/grid6", "/root/tempData/dataSet/CURLIST7");
							

							model1.removeNodeset("/root/tempData/dataSet");
							model1.refresh();
		
							if (grd_cr.rows == 1)
								grd_cr.addRow();
		
							if (grd_dr.rows == 1)
								grd_dr.addRow();
		
							if (datagrid1.rows == 1)
								datagrid1.addRow();
							
							//수입내역 상세 조회시 차변, 대변의 '추가' 버튼을 비활성화 시킴
							button3.disabled = true;
							button5.disabled = true;
							
							//수입내역 상세 조회시 차변, 대변의 '삭제' 버튼을 비활성화 시킴
							button4.disabled = true;
							button6.disabled = true;
							
							//수입내역 상세 조회시 차변의 '가상추가' 버튼을 비활성화 시킴
                                                      button7.disabled = true;
							
						]]>
					</script>
				</datagrid>
			</case>
			<case id="case7" selected="true">
				<datagrid id="grd_misu" nodeset="/root/resData/gridData/grid5/record" autoresize="true" caption="행사코드^행사명^거래처구분^거래처번호^거래처명^담당자사번^담당자명^미수금잔액^caption1^caption2^caption3^caption4^caption5" colsep="^" colwidth="100, 185, 80, 80, 195, 80, 75, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:5px; top:5px; width:915px; height:194px; ">
					<col ref="evnt_code" style="text-align:center; "/>
					<col ref="evnt_nm" style="text-align:left; "/>
					<col ref="dlco_clsf_cd_nm" type="output" style="text-align:center; "/>
					<col ref="dlco_no" type="output" style="text-align:center; "/>
					<col ref="dlco_nm" type="output" style="text-align:left; "/>
					<col ref="chrg_pers_emp_no" style="text-align:center; "/>
					<col ref="chrg_pers_emp_nm" style="text-align:center; "/>
					<col ref="misu_amt" format="(-)#,###,###,###,###" style="text-align:right; "/>
					<col ref="evnt_yy" visibility="hidden"/>
					<col ref="evnt_cd" visibility="hidden"/>
					<col ref="evnt_seq" visibility="hidden"/>
					<col ref="budg_cd" visibility="hidden"/>
					<col ref="budg_nm" visibility="hidden"/>
					<script type="javascript" ev:event="ondblclick">
						<![CDATA[
							if(grd_misu.row == 0) return;	
							
							if (grd_misu.valueMatrix(grd_misu.row, 1) == "") return;
							
							var selectedIdx = grd_misu.row;
							
							model1.setValue("/root/resData/resForm/dlco_clsf_cd", grd_misu.valueMatrix(selectedIdx, 3).substring(0, 2));
							model1.setValue("/root/resData/resForm/dlco_no", grd_misu.valueMatrix(selectedIdx, 4));
							model1.setValue("/root/resData/resForm/dlco_nm", grd_misu.valueMatrix(selectedIdx, 5));
							model1.setValue("/root/resData/resForm/evnt_yy", grd_misu.valueMatrix(selectedIdx, 9));
							model1.setValue("/root/resData/resForm/evnt_cd", grd_misu.valueMatrix(selectedIdx, 10));
							model1.send("en_innexp_1003");
							makeComboSet("", "/root/tempData/dataSet/CURLIST/record", "/root/initData/comboSet/evnt_seq", "evnt_seq", "evnt_seq")
							model1.removeNodeset("/root/tempData/dataSet");
							model1.refresh();
							model1.setValue("/root/resData/resForm/evnt_nm", grd_misu.valueMatrix(selectedIdx, 2));
							model1.setValue("/root/resData/resForm/evnt_seq", grd_misu.valueMatrix(selectedIdx, 11));
							evnt_seq.dispatch("xforms-value-changed");
							
							btn_etc.dispatch("onclick");
							model1.setValue("/root/resData/resDetailForm/etc_budg_cd", grd_misu.valueMatrix(selectedIdx, 12));
							model1.setValue("/root/resData/resDetailForm/etc_budg_nm", grd_misu.valueMatrix(selectedIdx, 13));
							model1.setValue("/root/resData/resDetailForm/etc_amt", grd_misu.valueMatrix(selectedIdx, 8));
							
							//model1.setValue("/root/resData/resDetailForm/tmp_misu_amt", grd_misu.valueMatrix(selectedIdx, 8));
							
							model1.refresh();
						]]>
					</script>
				</datagrid>
			</case>
		</switch>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/grid6/record" visibility="hidden" caption="BIZ_REG_NO^BANK_ID^ACCT_NUM^TRAN_DATE^TRAN_DATE_SEQ^SLIP_NO^extnc_amt^caption1^EXTNC_AMT" colsep="#" colwidth="100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowheight="20" rowsep="|" style="left:275px; top:225px; width:625px; height:80px; ">
			<col ref="biz_reg_no"/>
			<col ref="bank_id"/>
			<col ref="acct_num"/>
			<col ref="tran_date"/>
			<col ref="tran_date_seq"/>
			<col ref="slip_no"/>
			<col ref="extnc_amt"/>
			<col ref="rmtt_plac"/>
		</datagrid>
	</xhtml:body>
</xhtml:html>
