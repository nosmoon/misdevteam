<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session>
							<uid/>
							<cmpy_cd/>
							<emp_no/>
							<emp_nm/>
							<dept_cd/>
							<dept_nm/>
						</session>
						<!-- 선택계열의 정보를 담당 -->
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<comboSet>
							<evnt_yy>
								<item>
									<label/>
									<value/>
								</item>
							</evnt_yy>
							<evnt_seq1>
								<item>
									<label/>
									<value/>
								</item>
							</evnt_seq1>
							<evnt_seq2>
								<item>
									<label/>
									<value/>
								</item>
							</evnt_seq2>
							<evnt_seq3>
								<item>
									<label/>
									<value/>
								</item>
							</evnt_seq3>
						</comboSet>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						<pageInfo>
						</pageInfo>
					</initData>
					<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
					<reqData>
						<!-- 검색조건 처리 -->
						<searchData>
							<searchTab1>
								<evnt_yy/>
								<evnt_clsf>1</evnt_clsf>
								<srch_clsf>1</srch_clsf>
							</searchTab1>
							<searchTab2>
								<evnt_yy1/>
								<evnt_cd1/>
								<evnt_seq1/>
								<evnt_yy2/>
								<evnt_cd2/>
								<evnt_seq2/>
								<evnt_yy3/>
								<evnt_cd3/>
								<evnt_seq3/>
								<srch_clsf>1</srch_clsf>
							</searchTab2>
							<searchTab3>
								<evnt_yy/>
								<evnt_frdt_fr/>
								<evnt_frdt_to/>
								<srch_clsf>1</srch_clsf>
							</searchTab3>
							<searchTab4>
								<evnt_yy_fr/>
								<evnt_yy_to/>
								<srch_clsf>1</srch_clsf>
							</searchTab4>
							<searchTab5>
								<evnt_yy_fr/>
								<evnt_yy_to/>
							</searchTab5>
						</searchData>
						<!-- 등록/수정/삭제 요청 Form Data -->
						<reqForm>
							<evnt_yy/>
							<evnt_cd/>
							<evnt_seq/>
							<evnt_nm/>
						</reqForm>
						<!-- MultiUpDate유형 사용시 처리 -->
						<multiUpDate>
						</multiUpDate>
						<!-- POPUP 페이지 Forward Data -->
						<fwdData>
							<func_nm/>
							<rtn_ref/>
							<evnt_yy/>
							<evnt_cd/>
						</fwdData>
					</reqData>
					<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
					<resData>
						<!-- 전달 받은 리스트 데이터를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<gridData1>
								<record>
									<type_nm/>
									<evnt_cd/>
									<evnt_nm/>
									<amt1/>
									<amt2/>
									<amt3/>
									<stlm_dt/>
									<evnt_frdt/>
									<evnt_todt/>
									<evnt_dds/>
									<entr_nops/>
									<chrg_pers_emp_nm/>
								</record>
							</gridData1>
							<gridData2>
								<record>
									<budg_cd/>
									<budg_nm/>
									<amt1/>
									<amt2/>
									<amt3/>
								</record>
							</gridData2>
							<gridData3>
								<record>
									<evnt_cd/>
									<evnt_nm/>
									<amt1/>
									<amt2/>
									<amt3/>
									<amt4/>
									<amt5/>
									<tot_amt/>
								</record>
							</gridData3>
							<gridData4>
								<record>
									<type_nm/>
									<value_1/>
									<value_2/>
									<value_3/>
									<value_4/>
									<value_5/>
									<value_6/>
									<value_7/>
									<value_8/>
									<value_9/>
									<value_10/>
									<value_11/>
									<value_12/>
								</record>
							</gridData4>
							<gridData5>
								<record>
									<chrg_pers_emp_nm/>
									<value_1/>
									<value_2/>
									<value_3/>
									<value_4/>
									<value_5/>
									<value_6/>
									<value_7/>
									<value_8/>
									<value_9/>
									<value_10/>
									<value_11/>
									<value_12/>
								</record>
							</gridData5>
						</gridData>
						<!-- 전달 받은 Msg를 담당 ( submit의 결과가 담김) -->
						<msg>
							<errCode/>
							<errMsg/>
						</msg>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<resForm>
						</resForm>
					</resData>
					<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
					<tempData>
					</tempData>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					function setEvnt_cd1(iv_evnt_yy, iv_evnt_cd, iv_evnt_seq, iv_evnt_nm) {
						//model1.setValue("/root/resData/resForm/evnt_yy", iv_evnt_yy);
						model1.setValue("/root/reqData/searchData/searchTab2/evnt_cd1", iv_evnt_cd);
						model1.setValue("/root/reqData/reqForm/evnt_cd", iv_evnt_cd);
						model1.setValue("/root/reqData/reqForm/evnt_seq", iv_evnt_seq);
						model1.setValue("/root/reqData/reqForm/evnt_nm", iv_evnt_nm);
						model1.refresh();
					}

					function setEvnt_cd2(iv_evnt_yy, iv_evnt_cd, iv_evnt_seq, iv_evnt_nm) {
						//model1.setValue("/root/resData/resForm/evnt_yy", iv_evnt_yy);
						model1.setValue("/root/reqData/searchData/searchTab2/evnt_cd2", iv_evnt_cd);
						model1.setValue("/root/reqData/reqForm/evnt_cd", iv_evnt_cd);
						model1.setValue("/root/reqData/reqForm/evnt_seq", iv_evnt_seq);
						model1.setValue("/root/reqData/reqForm/evnt_nm", iv_evnt_nm);
						model1.refresh();
					}

					function setEvnt_cd3(iv_evnt_yy, iv_evnt_cd, iv_evnt_seq, iv_evnt_nm) {
						//model1.setValue("/root/resData/resForm/evnt_yy", iv_evnt_yy);
						model1.setValue("/root/reqData/searchData/searchTab2/evnt_cd3", iv_evnt_cd);
						model1.setValue("/root/reqData/reqForm/evnt_cd", iv_evnt_cd);
						model1.setValue("/root/reqData/reqForm/evnt_seq", iv_evnt_seq);
						model1.setValue("/root/reqData/reqForm/evnt_nm", iv_evnt_nm);
						model1.refresh();
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					btn_tab1.dispatch("onclick");
					
					model1.send("en_evnt_1001");
					makeComboSet("", "/root/tempData/dataSet/CURLIST/record", "/root/initData/comboSet/evnt_yy", "evnt_yy", "evnt_yy")
					model1.removeNodeset("/root/tempData/dataSet");

					model1.setValue("/root/reqData/searchData/searchTab1/evnt_yy", commCurDate("y"));
					model1.setValue("/root/reqData/searchData/searchTab2/evnt_yy1", commCurDate("y"));
					model1.setValue("/root/reqData/searchData/searchTab2/evnt_yy2", commCurDate("y"));
					model1.setValue("/root/reqData/searchData/searchTab2/evnt_yy3", commCurDate("y"));
					model1.setValue("/root/reqData/searchData/searchTab3/evnt_yy", commCurDate("y"));
					model1.setValue("/root/reqData/searchData/searchTab4/evnt_yy_fr", commCurDate("y"));
					model1.setValue("/root/reqData/searchData/searchTab4/evnt_yy_to", commCurDate("y"));
					model1.setValue("/root/reqData/searchData/searchTab5/evnt_yy_fr", commCurDate("y"));
					model1.setValue("/root/reqData/searchData/searchTab5/evnt_yy_to", commCurDate("y"));

					model1.refresh();

					for (i = 2; i <= 13; i++)
						datagrid4.colHidden(i) = true;

					for (i = 2; i <= 13; i++)
						datagrid5.colHidden(i) = true;
				]]>
			</script>
			<submission id="en_evnt_1001" action="/en/evnt/1001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1003" action="/en/innexp/1003" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1004" action="/en/innexp/1004" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1005" action="/en/innexp/1005" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_3101" action="/en/innexp/3101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchTab3" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_3102" action="/en/innexp/3102" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchTab2" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_3103" action="/en/innexp/3103" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchTab4" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_3104" action="/en/innexp/3104" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchTab5" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_3105" action="/en/innexp/3105" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchTab1" resultref="/root/tempData/dataSet"/>
		</model>
		<script type="javascript" src="/js/en_common.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/TFCommon.js"/>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="1,937;" style="font-family:굴림; ">
		<button id="btn_tab4" class="tab11" group="tab" style="left:520px; top:77px; width:170px; height:23px; ">
			<caption>행사결산년도별비교현황</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.toggle("case4");
				]]>
			</script>
		</button>
		<button id="btn_tab5" class="tab15" group="tab" style="left:690px; top:77px; width:221px; height:23px; ">
			<caption>담당별연도별협찬금및광고료현황</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.toggle("case5");
				]]>
			</script>
		</button>
		<button id="btn_tab1" class="tab11" group="tab" selected="true" style="left:10px; top:77px; width:170px; height:23px; ">
			<caption>행사별결산현황조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.toggle("case1");
					]]>
			</script>
		</button>
		<button id="btn_tab2" class="tab11" group="tab" style="left:180px; top:77px; width:170px; height:23px; ">
			<caption>행사별결산현황비교조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.toggle("case2");
					]]>
			</script>
		</button>
		<switch id="switch1" style="left:10px; top:100px; width:927px; height:615px; border-color:#dddddd; border-style:solid; ">
			<case id="case1">
				<datagrid id="datagrid1" nodeset="/root/resData/gridData/gridData1/record" caption="구분^행사코드^행사명^총수입^총지출^차인손익^ 결산일자^행사시작일^행사종료일^행사일수^인원^결산일^담당자" colsep="^" colwidth="80, 90, 200, 100, 106, 100, 80, 80, 80, 70, 70, 90, 100" frozencols="3" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" subtotalposition="below" style="left:5px; top:40px; width:914px; height:565px; ">
					<col ref="type_nm" style="text-align:center; "/>
					<col ref="evnt_cd" style="text-align:center; "/>
					<col ref="evnt_nm" type="output" style="text-align:left; "/>
					<col ref="amt1" type="output" format="(-)#,###" style="text-align:right; "/>
					<col ref="amt2" type="output" format="(-)#,###" style="text-align:right; "/>
					<col ref="amt3" format="(-)#,###" style="text-align:right; "/>
					<col ref="stlm_dt" format="yyyy-mm-dd" style="text-align:center; "/>
					<col ref="evnt_frdt" format="yyyy-mm-dd" style="text-align:center; "/>
					<col ref="evnt_todt" format="yyyy-mm-dd" style="text-align:center; "/>
					<col ref="evnt_dds" format="(-)#,###" style="text-align:right; "/>
					<col ref="entr_nops" format="(-)#,###" style="text-align:right; "/>
					<col ref="chrg_pers_emp_nm" style="text-align:center; "/>
				</datagrid>
				<group id="group1" style="left:6px; top:6px; width:915px; height:26px; ">
					<caption id="caption12" class="list_cap02" style="left:84px; top:0px; width:829px; height:26px; border-style:solid; "/>
					<caption id="caption11" class="list_cap01" style="left:0px; top:0px; width:85px; height:26px; border-style:solid; ">행사년도</caption>
					<caption id="caption22" class="list_cap01" style="left:245px; top:0px; width:85px; height:26px; border-style:solid; ">행사구분</caption>
					<caption id="caption36" class="list_cap01" visibility="hidden" style="left:645px; top:0px; width:85px; height:26px; border-style:solid; ">조회구분</caption>
					<select1 id="radio1" ref="/root/reqData/searchData/searchTab1/evnt_clsf" navindex="2" appearance="full" cellspacing="10" cols="5" overflow="visible" style="left:334px; top:5px; width:281px; height:15px; border-style:none; ">
						<choices>
							<item>
								<label>행사성격</label>
								<value>1</value>
							</item>
							<item>
								<label>주최구분</label>
								<value>2</value>
							</item>
							<item>
								<label>유형구분</label>
								<value>3</value>
							</item>
							<item>
								<label>대관</label>
								<value>4</value>
							</item>
						</choices>
					</select1>
					<select1 id="combo5" ref="/root/reqData/searchData/searchTab1/evnt_yy" class="req" navindex="1" appearance="minimal" caption="행사년도" style="left:89px; top:4px; width:65px; height:18px; text-align:center; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/evnt_yy/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</select1>
					<select1 id="radio4" ref="/root/reqData/searchData/searchTab1/srch_clsf" navindex="3" visibility="hidden" appearance="full" cellspacing="10" cols="2" overflow="visible" style="left:734px; top:5px; width:130px; height:15px; border-style:none; ">
						<choices>
							<item>
								<label>결산</label>
								<value>1</value>
							</item>
							<item>
								<label>중간결산</label>
								<value>2</value>
							</item>
						</choices>
					</select1>
				</group>
			</case>
			<case id="case2">
				<datagrid id="datagrid2" nodeset="/root/resData/gridData/gridData2/record" caption="예산코드^예산명^행사 1^행사 2^행사 3" colsep="^" colwidth="140, 300, 150, 150, 150" frozencols="4" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" subtotalposition="below" style="left:5px; top:90px; width:914px; height:515px; ">
					<col ref="budg_cd" style="text-align:center; "/>
					<col ref="budg_nm" style="text-align:left; "/>
					<col ref="amt1" type="output" format="(-)#,###" style="text-align:right; "/>
					<col ref="amt2" type="output" format="(-)#,###" style="text-align:right; "/>
					<col ref="amt3" type="output" format="(-)#,###" style="text-align:right; "/>
				</datagrid>
				<group id="group2" style="left:6px; top:6px; width:915px; height:76px; ">
					<caption id="caption38" class="list_cap02" style="left:83px; top:0px; width:830px; height:26px; border-style:solid; "/>
					<caption id="caption47" class="list_cap02" style="left:83px; top:50px; width:830px; height:26px; border-style:solid; "/>
					<caption id="caption43" class="list_cap02" style="left:83px; top:25px; width:830px; height:26px; border-style:solid; "/>
					<caption id="caption50" class="list_cap01" style="left:693px; top:50px; width:80px; height:26px; border-style:solid; ">조회구분</caption>
					<caption id="caption41" style="left:560px; top:31px; width:75px; height:18px; font-family:굴림체; font-size:9pt; ">행사일련번호</caption>
					<caption id="caption42" class="list_cap01" style="left:0px; top:25px; width:85px; height:26px; border-style:solid; ">행사년도</caption>
					<caption id="caption1" class="list_cap01" style="left:198px; top:0px; width:85px; height:26px; border-style:solid; ">행사코드</caption>
					<caption id="caption45" style="left:560px; top:55px; width:75px; height:18px; font-family:굴림체; font-size:9pt; ">행사일련번호</caption>
					<caption id="caption46" class="list_cap01" style="left:0px; top:50px; width:85px; height:26px; border-style:solid; ">행사년도</caption>
					<caption id="caption4" style="left:560px; top:6px; width:75px; height:18px; font-family:굴림체; font-size:9pt; ">행사일련번호</caption>
					<select1 id="combo10" ref="/root/reqData/searchData/searchTab2/evnt_yy3" navindex="10" appearance="minimal" style="left:88px; top:54px; width:65px; height:18px; text-align:center; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/evnt_yy/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</select1>
					<caption id="caption48" class="list_cap01" style="left:198px; top:50px; width:85px; height:26px; border-style:solid; ">행사코드</caption>
					<input id="ipt_evnt_cd1" ref="/root/reqData/searchData/searchTab2/evnt_cd1" navindex="5" imemode="disabled" inputtype="button" maxlength="4" format="9999" style="left:286px; top:4px; width:60px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								//model1.setValue("/root/reqData/fwdData/rtn_ref", "/root/reqData/reqForm");
								//model1.setValue("/root/reqData/fwdData/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy1"));
								//window.load("/xrw/en/comm/EN_COMM_1100.xrw","modal", "EN_COMM_1100", "align:center; width:455; height:405; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/resData/resForm");
								//model1.setValue("/root/reqData/searchData/searchTab2/evnt_cd1", model1.getValue("/root/reqData/reqForm/evnt_cd"));

								model1.setValue("/root/reqData/reqForm/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy1"));
								model1.setValue("/root/reqData/fwdData/func_nm","setEvnt_cd1");
								model1.setValue("/root/reqData/fwdData/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy1"));
								window.load("/xrw/en/comm/EN_COMM_1100.xrw","modal", "EN_COMM_1100", "align:center; width:455; height:405; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
								model1.setValue("/root/reqData/searchData/searchTab2/evnt_seq1", model1.getValue("/root/reqData/reqForm/evnt_seq"));
								opt_evnt_nm1.value = model1.getValue("/root/reqData/reqForm/evnt_nm");
		
								model1.send("en_innexp_1003");
								makeComboSet("", "/root/tempData/dataSet/CURLIST/record", "/root/initData/comboSet/evnt_seq1", "evnt_seq", "evnt_seq")
								model1.removeNodeset("/root/tempData/dataSet");
	
								cbo_evnt_seq1.dispatch("xforms-value-changed");
								model1.refresh();
							]]>
						</script>
						<script type="javascript" ev:event="onmaxlength">
							<![CDATA[
								model1.setValue("/root/reqData/searchData/searchTab2/evnt_cd1", ipt_evnt_cd1.currentText);
								model1.setValue("/root/reqData/reqForm/evnt_cd", ipt_evnt_cd1.currentText);
								model1.setValue("/root/reqData/reqForm/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy1"));
								opt_evnt_nm1.value = "";
								
								model1.send("en_innexp_1004");
								
								if (model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt") == "1") {
									opt_evnt_nm1.value = model1.getValue("/root/tempData/dataSet/CURLIST/record/evnt_nm");
									model1.setValue("/root/reqData/searchData/searchTab2/evnt_seq1", model1.getValue("/root/tempData/dataSet/CURLIST/record/evnt_seq"));
								} else if (parseInt(model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt")) > 1) {
									model1.setValue("/root/reqData/fwdData/func_nm","setEvnt_cd1");
									model1.setValue("/root/reqData/fwdData/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy1"));
									model1.setValue("/root/reqData/fwdData/evnt_cd", model1.getValue("/root/reqData/searchData/searchTab2/evnt_cd1"));
									window.load("/xrw/en/comm/EN_COMM_1100.xrw","modal", "EN_COMM_1100", "align:center; width:455; height:405; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
									
									//model1.setValue("/root/reqData/fwdData/rtn_ref", "/root/reqData/reqForm");
									//model1.setValue("/root/reqData/fwdData/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy1"));
									//model1.setValue("/root/reqData/fwdData/evnt_cd", model1.getValue("/root/reqData/searchData/searchTab2/evnt_cd1"));
									//window.load("/xrw/en/comm/EN_COMM_1100.xrw","modal", "EN_COMM_1100", "align:center; width:455; height:405; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/resData/resForm");
									
									model1.setValue("/root/reqData/searchData/searchTab2/evnt_seq1", model1.getValue("/root/reqData/reqForm/evnt_seq"));
									opt_evnt_nm1.value = model1.getValue("/root/reqData/reqForm/evnt_nm");
									
									model1.resetInstanceNode("/root/reqData/fwdData");
								}
								model1.removeNodeset("/root/tempData/dataSet");
		
								model1.send("en_innexp_1003");
								makeComboSet("", "/root/tempData/dataSet/CURLIST/record", "/root/initData/comboSet/evnt_seq1", "evnt_seq", "evnt_seq")
								model1.removeNodeset("/root/tempData/dataSet");
	
								cbo_evnt_seq1.dispatch("xforms-value-changed");
		
								model1.refresh();
							]]>
						</script>
					</input>
					<caption id="caption37" class="list_cap01" style="left:0px; top:0px; width:85px; height:26px; border-style:solid; ">행사년도</caption>
					<select1 id="cbo_evnt_seq3" ref="/root/reqData/searchData/searchTab2/evnt_seq3" navindex="12" appearance="minimal" style="left:637px; top:54px; width:40px; height:18px; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/evnt_seq3/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								model1.setValue("/root/reqData/reqForm/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy3"));
								model1.setValue("/root/reqData/reqForm/evnt_cd", model1.getValue("/root/reqData/searchData/searchTab2/evnt_cd3"));
								model1.setValue("/root/reqData/reqForm/evnt_seq", model1.getValue("/root/reqData/searchData/searchTab2/evnt_seq3"));
								model1.send("en_innexp_1005");
								opt_evnt_nm3.value = model1.getValue("/root/tempData/dataSet/CURLIST/record/evnt_nm");
								model1.removeNodeset("/root/tempData/dataSet");
								model1.refresh();
							]]>
						</script>
					</select1>
					<input id="ipt_evnt_cd3" ref="/root/reqData/searchData/searchTab2/evnt_cd3" navindex="11" inputtype="button" maxlength="4" format="9999" style="left:286px; top:54px; width:60px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								model1.setValue("/root/reqData/reqForm/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy3"));
								model1.setValue("/root/reqData/fwdData/func_nm","setEvnt_cd3");
								model1.setValue("/root/reqData/fwdData/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy3"));
								window.load("/xrw/en/comm/EN_COMM_1100.xrw","modal", "EN_COMM_1100", "align:center; width:455; height:405; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
								model1.setValue("/root/reqData/searchData/searchTab2/evnt_seq3", model1.getValue("/root/reqData/reqForm/evnt_seq"));
								opt_evnt_nm3.value = model1.getValue("/root/reqData/reqForm/evnt_nm");
		
								model1.send("en_innexp_1003");
								makeComboSet("", "/root/tempData/dataSet/CURLIST/record", "/root/initData/comboSet/evnt_seq3", "evnt_seq", "evnt_seq")
								model1.removeNodeset("/root/tempData/dataSet");
	
								cbo_evnt_seq3.dispatch("xforms-value-changed");
								model1.refresh();
							]]>
						</script>
						<script type="javascript" ev:event="onmaxlength">
							<![CDATA[
								model1.setValue("/root/reqData/searchData/searchTab2/evnt_cd3", ipt_evnt_cd3.currentText);
								model1.setValue("/root/reqData/reqForm/evnt_cd", ipt_evnt_cd3.currentText);
								model1.setValue("/root/reqData/reqForm/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy3"));
								opt_evnt_nm3.value = "";
								
								model1.send("en_innexp_1004");
								
								if (model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt") == "1") {
									opt_evnt_nm3.value = model1.getValue("/root/tempData/dataSet/CURLIST/record/evnt_nm");
									model1.setValue("/root/reqData/searchData/searchTab2/evnt_seq3", model1.getValue("/root/tempData/dataSet/CURLIST/record/evnt_seq"));
								} else if (parseInt(model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt")) > 1) {
									model1.setValue("/root/reqData/fwdData/func_nm","setEvnt_cd3");
									model1.setValue("/root/reqData/fwdData/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy3"));
									model1.setValue("/root/reqData/fwdData/evnt_cd", model1.getValue("/root/reqData/searchData/searchTab2/evnt_cd3"));
									window.load("/xrw/en/comm/EN_COMM_1100.xrw","modal", "EN_COMM_1100", "align:center; width:455; height:405; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");

									model1.setValue("/root/reqData/searchData/searchTab2/evnt_seq3", model1.getValue("/root/reqData/reqForm/evnt_seq"));
									opt_evnt_nm3.value = model1.getValue("/root/reqData/reqForm/evnt_nm");

									model1.resetInstanceNode("/root/reqData/fwdData");
								}
								model1.removeNodeset("/root/tempData/dataSet");
		
								model1.send("en_innexp_1003");
								makeComboSet("", "/root/tempData/dataSet/CURLIST/record", "/root/initData/comboSet/evnt_seq3", "evnt_seq", "evnt_seq")
								model1.removeNodeset("/root/tempData/dataSet");
	
								cbo_evnt_seq3.dispatch("xforms-value-changed");
		
								model1.refresh();
							]]>
						</script>
					</input>
					<output id="opt_evnt_nm1" inputtype="button" appearance="output" style="left:350px; top:4px; width:200px; height:18px; "/>
					<select1 id="combo6" ref="/root/reqData/searchData/searchTab2/evnt_yy1" navindex="4" appearance="minimal" style="left:88px; top:4px; width:65px; height:18px; text-align:center; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/evnt_yy/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</select1>
					<output id="opt_evnt_nm3" inputtype="button" appearance="output" style="left:350px; top:54px; width:200px; height:18px; "/>
					<input id="ipt_evnt_cd2" ref="/root/reqData/searchData/searchTab2/evnt_cd2" navindex="8" inputtype="button" maxlength="4" format="9999" style="left:286px; top:29px; width:60px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								model1.setValue("/root/reqData/reqForm/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy2"));
								model1.setValue("/root/reqData/fwdData/func_nm","setEvnt_cd2");
								model1.setValue("/root/reqData/fwdData/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy2"));
								window.load("/xrw/en/comm/EN_COMM_1100.xrw","modal", "EN_COMM_1100", "align:center; width:455; height:405; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
								model1.setValue("/root/reqData/searchData/searchTab2/evnt_seq2", model1.getValue("/root/reqData/reqForm/evnt_seq"));
								opt_evnt_nm2.value = model1.getValue("/root/reqData/reqForm/evnt_nm");
		
								model1.send("en_innexp_1003");
								makeComboSet("", "/root/tempData/dataSet/CURLIST/record", "/root/initData/comboSet/evnt_seq2", "evnt_seq", "evnt_seq")
								model1.removeNodeset("/root/tempData/dataSet");
	
								cbo_evnt_seq2.dispatch("xforms-value-changed");
								model1.refresh();
							]]>
						</script>
						<script type="javascript" ev:event="onmaxlength">
							<![CDATA[
								model1.setValue("/root/reqData/searchData/searchTab2/evnt_cd2", ipt_evnt_cd2.currentText);
								model1.setValue("/root/reqData/reqForm/evnt_cd", ipt_evnt_cd2.currentText);
								model1.setValue("/root/reqData/reqForm/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy2"));
								opt_evnt_nm2.value = "";
								
								model1.send("en_innexp_1004");
								
								if (model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt") == "1") {
									opt_evnt_nm2.value = model1.getValue("/root/tempData/dataSet/CURLIST/record/evnt_nm");
									model1.setValue("/root/reqData/searchData/searchTab2/evnt_seq2", model1.getValue("/root/tempData/dataSet/CURLIST/record/evnt_seq"));
								} else if (parseInt(model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt")) > 1) {
									model1.setValue("/root/reqData/fwdData/func_nm","setEvnt_cd2");
									model1.setValue("/root/reqData/fwdData/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy2"));
									model1.setValue("/root/reqData/fwdData/evnt_cd", model1.getValue("/root/reqData/searchData/searchTab2/evnt_cd2"));
									window.load("/xrw/en/comm/EN_COMM_1100.xrw","modal", "EN_COMM_1100", "align:center; width:455; height:405; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");

									model1.setValue("/root/reqData/searchData/searchTab2/evnt_seq2", model1.getValue("/root/reqData/reqForm/evnt_seq"));
									opt_evnt_nm2.value = model1.getValue("/root/reqData/reqForm/evnt_nm");

									model1.resetInstanceNode("/root/reqData/fwdData");
								}
								model1.removeNodeset("/root/tempData/dataSet");
		
								model1.send("en_innexp_1003");
								makeComboSet("", "/root/tempData/dataSet/CURLIST/record", "/root/initData/comboSet/evnt_seq2", "evnt_seq", "evnt_seq")
								model1.removeNodeset("/root/tempData/dataSet");
	
								cbo_evnt_seq2.dispatch("xforms-value-changed");
		
								model1.refresh();
							]]>
						</script>
					</input>
					<caption id="caption39" class="list_cap01" style="left:198px; top:25px; width:85px; height:26px; border-style:solid; ">행사코드</caption>
					<select1 id="cbo_evnt_seq1" ref="/root/reqData/searchData/searchTab2/evnt_seq1" navindex="6" appearance="minimal" style="left:637px; top:4px; width:40px; height:18px; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/evnt_seq1/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								model1.setValue("/root/reqData/reqForm/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy1"));
								model1.setValue("/root/reqData/reqForm/evnt_cd", model1.getValue("/root/reqData/searchData/searchTab2/evnt_cd1"));
								model1.setValue("/root/reqData/reqForm/evnt_seq", model1.getValue("/root/reqData/searchData/searchTab2/evnt_seq1"));
								model1.send("en_innexp_1005");
								opt_evnt_nm1.value = model1.getValue("/root/tempData/dataSet/CURLIST/record/evnt_nm");
								model1.removeNodeset("/root/tempData/dataSet");
								model1.refresh();
							]]>
						</script>
					</select1>
					<select1 id="radio5" ref="/root/reqData/searchData/searchTab2/srch_clsf" navindex="13" appearance="full" cellspacing="10" cols="2" overflow="visible" style="left:777px; top:55px; width:130px; height:15px; border-style:none; ">
						<choices>
							<item>
								<label>수입부</label>
								<value>1</value>
							</item>
							<item>
								<label>지출부</label>
								<value>2</value>
							</item>
						</choices>
					</select1>
					<select1 id="combo8" ref="/root/reqData/searchData/searchTab2/evnt_yy2" navindex="7" appearance="minimal" style="left:88px; top:29px; width:65px; height:18px; text-align:center; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/evnt_yy/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</select1>
					<select1 id="cbo_evnt_seq2" ref="/root/reqData/searchData/searchTab2/evnt_seq2" navindex="9" appearance="minimal" style="left:637px; top:29px; width:40px; height:18px; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/evnt_seq2/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								model1.setValue("/root/reqData/reqForm/evnt_yy", model1.getValue("/root/reqData/searchData/searchTab2/evnt_yy2"));
								model1.setValue("/root/reqData/reqForm/evnt_cd", model1.getValue("/root/reqData/searchData/searchTab2/evnt_cd2"));
								model1.setValue("/root/reqData/reqForm/evnt_seq", model1.getValue("/root/reqData/searchData/searchTab2/evnt_seq2"));
								model1.send("en_innexp_1005");
								opt_evnt_nm2.value = model1.getValue("/root/tempData/dataSet/CURLIST/record/evnt_nm");
								model1.removeNodeset("/root/tempData/dataSet");
								model1.refresh();
							]]>
						</script>
					</select1>
					<output id="opt_evnt_nm2" inputtype="button" appearance="output" style="left:350px; top:29px; width:200px; height:18px; "/>
				</group>
			</case>
			<case id="case3">
				<datagrid id="datagrid3" nodeset="/root/resData/gridData/gridData3/record" caption="행사코드^행사명^협찬금^광고료^입장료^참가비^기타^합계^비율(%)" colsep="^" colwidth="100, 200, 100, 100, 100, 100, 100, 110, 90" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" subtotalposition="below" style="left:5px; top:40px; width:914px; height:565px; ">
					<col ref="evnt_cd" style="text-align:center; "/>
					<col ref="evnt_nm" type="output" style="text-align:left; "/>
					<col ref="amt1" type="output" format="(-)#,###" style="text-align:right; "/>
					<col ref="amt2" type="output" format="(-)#,###" style="text-align:right; "/>
					<col ref="amt3" format="(-)#,###" style="text-align:right; "/>
					<col ref="amt4" format="(-)#,###" style="text-align:right; "/>
					<col ref="amt5" format="(-)#,###" style="text-align:right; "/>
					<col ref="tot_amt" format="(-)#,###" style="text-align:right; "/>
					<col format="#,###.##" style="text-align:right; "/>
				</datagrid>
				<group id="group3" style="left:6px; top:6px; width:915px; height:26px; ">
					<caption id="caption9" class="list_cap02" style="left:84px; top:0px; width:829px; height:26px; border-style:solid; "/>
					<select1 id="combo2" ref="/root/reqData/searchData/searchTab3/evnt_yy" class="req" navindex="14" appearance="minimal" caption="행사년도" style="left:89px; top:4px; width:65px; height:18px; text-align:center; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/evnt_yy/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</select1>
					<input id="input8" ref="/root/reqData/searchData/searchTab3/evnt_frdt_fr" class="req" navindex="15" inputtype="date" maxlength="10" format="yyyy-mm-dd" caption="행사기간(시작)" style="left:324px; top:4px; width:85px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								if (!commGhkCal("/root/reqData/searchData/searchTab3/evnt_frdt_fr")) {
									alert("유효하지 않은 날짜 형식입니다.");
									input8.value ="";
									model1.setFocus("input8");
									return;
								}
							]]>
						</script>
					</input>
					<input id="input7" ref="/root/reqData/searchData/searchTab3/evnt_frdt_to" class="req" navindex="16" inputtype="date" maxlength="10" format="yyyy-mm-dd" caption="행사기간(종료)" style="left:434px; top:4px; width:85px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								if (!commGhkCal("/root/reqData/searchData/searchTab3/evnt_frdt_to")) {
									alert("유효하지 않은 날짜 형식입니다.");
									input7.value ="";
									model1.setFocus("input7");
									return;
								}
							]]>
						</script>
					</input>
					<caption id="caption23" style="left:417px; top:4px; width:15px; height:20px; font-family:굴림체; font-size:9pt; font-weight:bold; ">-</caption>
					<select1 id="radio2" ref="/root/reqData/searchData/searchTab3/srch_clsf" navindex="17" appearance="full" cellspacing="10" cols="2" overflow="visible" style="left:652px; top:5px; width:150px; height:15px; border-style:none; ">
						<choices>
							<item>
								<label>수입항목</label>
								<value>1</value>
							</item>
							<item>
								<label>지출항목</label>
								<value>2</value>
							</item>
						</choices>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
								if (model1.getValue("/root/reqData/searchData/searchTab3/srch_clsf") == "1")
									datagrid3.caption = "행사코드^행사명^협찬금^광고료^입장료^참가비^기타^합계^비율(%)";
								else
									datagrid3.caption = "행사코드^행사명^출연료^원고료^인건비^인쇄비^기타^합계^비율(%)";
							]]>
						</script>
					</select1>
					<caption id="caption16" class="list_cap01" style="left:235px; top:0px; width:85px; height:26px; border-style:solid; ">행사기간</caption>
					<caption id="caption7" class="list_cap01" style="left:560px; top:0px; width:85px; height:26px; border-style:solid; ">조회구분</caption>
					<caption id="caption8" class="list_cap01" style="left:0px; top:0px; width:85px; height:26px; border-style:solid; ">행사년도</caption>
				</group>
			</case>
			<case id="case4" selected="true">
				<datagrid id="datagrid4" nodeset="/root/resData/gridData/gridData4/record" caption="구분^caption1^caption2^caption3^caption4^caption5^caption6^caption7^caption8^caption9^caption10^caption11^caption12" colsep="^" colwidth="150, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" subtotalposition="below" style="left:6px; top:40px; width:913px; height:565px; ">
					<col ref="type_nm"/>
					<col ref="value_1" style="text-align:right; "/>
					<col ref="value_2" style="text-align:right; "/>
					<col ref="value_3" style="text-align:right; "/>
					<col ref="value_4" style="text-align:right; "/>
					<col ref="value_5" style="text-align:right; "/>
					<col ref="value_6" style="text-align:right; "/>
					<col ref="value_7" style="text-align:right; "/>
					<col ref="value_8" style="text-align:right; "/>
					<col ref="value_9" style="text-align:right; "/>
					<col ref="value_10" style="text-align:right; "/>
					<col ref="value_11" style="text-align:right; "/>
					<col ref="value_12" style="text-align:right; "/>
				</datagrid>
				<group id="group4" style="left:6px; top:6px; width:915px; height:26px; ">
					<caption id="caption33" class="list_cap02" style="left:84px; top:0px; width:829px; height:26px; border-style:solid; "/>
					<caption id="caption10" style="left:160px; top:4px; width:15px; height:20px; font-family:굴림체; font-size:9pt; font-weight:bold; ">-</caption>
					<caption id="caption32" class="list_cap01" style="left:0px; top:0px; width:85px; height:26px; border-style:solid; ">행사년도</caption>
					<select1 id="combo1" ref="/root/reqData/searchData/searchTab4/evnt_yy_fr" class="req" navindex="18" appearance="minimal" caption="행사년도(시작)" style="left:89px; top:4px; width:65px; height:18px; text-align:center; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/evnt_yy/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</select1>
					<select1 id="combo3" ref="/root/reqData/searchData/searchTab4/evnt_yy_to" class="req" navindex="19" appearance="minimal" caption="행사년도(종료)" style="left:175px; top:4px; width:65px; height:18px; text-align:center; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/evnt_yy/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</select1>
					<caption id="caption24" class="list_cap01" style="left:350px; top:0px; width:85px; height:26px; border-style:solid; ">조회구분</caption>
					<select1 id="radio6" ref="/root/reqData/searchData/searchTab4/srch_clsf" navindex="20" appearance="full" cellspacing="10" cols="3" overflow="visible" style="left:440px; top:5px; width:235px; height:15px; border-style:none; ">
						<choices>
							<item>
								<label>행사성격</label>
								<value>1</value>
							</item>
							<item>
								<label>주최구분</label>
								<value>2</value>
							</item>
							<item>
								<label>유형구분</label>
								<value>3</value>
							</item>
						</choices>
					</select1>
				</group>
			</case>
			<case id="case5">
				<group id="group5" style="left:6px; top:6px; width:915px; height:26px; ">
					<caption id="caption17" class="list_cap02" style="left:84px; top:0px; width:829px; height:26px; border-style:solid; "/>
					<caption id="caption13" style="left:159px; top:4px; width:15px; height:20px; font-family:굴림체; font-size:9pt; font-weight:bold; ">-</caption>
					<select1 id="combo4" ref="/root/reqData/searchData/searchTab5/evnt_yy_fr" class="req" navindex="21" appearance="minimal" caption="행사년도(시작)" style="left:89px; top:4px; width:65px; height:18px; text-align:center; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/evnt_yy/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</select1>
					<caption id="caption14" class="list_cap01" style="left:0px; top:0px; width:85px; height:26px; border-style:solid; ">행사년도</caption>
					<select1 id="combo12" ref="/root/reqData/searchData/searchTab5/evnt_yy_to" class="req" navindex="22" appearance="minimal" caption="행사년도(종료)" style="left:174px; top:4px; width:65px; height:18px; text-align:center; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/evnt_yy/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</select1>
				</group>
				<datagrid id="datagrid5" nodeset="/root/resData/gridData/gridData5/record" caption="구분^caption1^caption2^caption3^caption4^caption5^caption6^caption7^caption8^caption9^caption10^caption11^caption12" colsep="^" colwidth="150, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" subtotalposition="below" style="left:6px; top:40px; width:913px; height:565px; ">
					<col ref="chrg_pers_emp_nm"/>
					<col ref="value_1" style="text-align:right; "/>
					<col ref="value_2" style="text-align:right; "/>
					<col ref="value_3" style="text-align:right; "/>
					<col ref="value_4" style="text-align:right; "/>
					<col ref="value_5" style="text-align:right; "/>
					<col ref="value_6" style="text-align:right; "/>
					<col ref="value_7" style="text-align:right; "/>
					<col ref="value_8" style="text-align:right; "/>
					<col ref="value_9" style="text-align:right; "/>
					<col ref="value_10" style="text-align:right; "/>
					<col ref="value_11" style="text-align:right; "/>
					<col ref="value_12" style="text-align:right; "/>
				</datagrid>
			</case>
		</switch>
		<button id="btn_tab3" class="tab11" group="tab" style="left:350px; top:77px; width:170px; height:23px; ">
			<caption>행사수지항목결산현황</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.toggle("case3");
					]]>
			</script>
		</button>
		<import id="import1" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:927px; height:29px; "/>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:45px; width:927px; height:21px; ">
			<button id="btn_srch" class="btn02" crud="R" style="left:697px; top:0px; width:53px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (switch1.selectedIndex == 0) {
							datagrid1.subtotal("clear", 0, 0);

							if (!commReqCheck(group1))
								return;
							
							model1.send("en_innexp_3105");
							model1.copyNode("/root/resData/gridData/gridData1", "/root/tempData/dataSet/CURLIST");
							model1.removeNodeset("/root/tempData/dataSet");
							
							model1.refresh();
							
							datagrid1.subtotal("sum", -1, 4, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 1, "합 계");
							datagrid1.subtotal("sum", -1, 5, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 1, "합 계");
							datagrid1.subtotal("sum", -1, 6, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 1, "합 계");
							datagrid1.cellStyle("text-align", datagrid1.rows-1, 1, datagrid1.rows-1, 1) = "center";
							datagrid1.multiTotals = true;
							
							if (datagrid1.rows == 1)
								datagrid1.addRow();
						} else if (switch1.selectedIndex == 1) {
							datagrid2.subtotal("clear", 0, 0);

							if (!commReqCheck(group2))
								return;
							
							model1.send("en_innexp_3102");
							model1.copyNode("/root/resData/gridData/gridData2", "/root/tempData/dataSet/CURLIST");
							model1.removeNodeset("/root/tempData/dataSet");
							
							model1.refresh();
							
							datagrid2.subtotal("sum", -1, 3, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 2, "합 계");
							datagrid2.subtotal("sum", -1, 4, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 2, "합 계");
							datagrid2.subtotal("sum", -1, 5, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 2, "합 계");
							datagrid2.cellStyle("text-align", datagrid2.rows-1, 2, datagrid2.rows-1, 2) = "center";
							datagrid2.multiTotals = true;
							
							if (datagrid2.rows == 1)
								datagrid2.addRow();
						} else if (switch1.selectedIndex == 2) {
							datagrid3.subtotal("clear", 0, 0);

							if (!commReqCheck(group3))
								return;
							
							if (!(commGhkTerm("/root/reqData/searchData/searchTab3/evnt_frdt_fr", "/root/reqData/searchData/searchTab3/evnt_frdt_to"))) {
								alert("조회날짜의 범위가 올바르지 않습니다.");
								return;
							}
									
							model1.send("en_innexp_3101");
							model1.copyNode("/root/resData/gridData/gridData3", "/root/tempData/dataSet/CURLIST");
							model1.removeNodeset("/root/tempData/dataSet");
							
							model1.refresh();
							
							datagrid3.subtotal("sum", -1, 3, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 1, "합 계");
							datagrid3.subtotal("sum", -1, 4, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 1, "합 계");
							datagrid3.subtotal("sum", -1, 5, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 1, "합 계");
							datagrid3.subtotal("sum", -1, 6, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 1, "합 계");
							datagrid3.subtotal("sum", -1, 7, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 1, "합 계");
							datagrid3.subtotal("sum", -1, 8, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 1, "합 계");
							datagrid3.cellStyle("text-align", datagrid3.rows-1, 1, datagrid3.rows-1, 1) = "center";
							datagrid3.multiTotals = true;
							
							if (datagrid3.rows == 1)
								datagrid3.addRow();
							else {	
								var tot_amt = parseFloat(datagrid3.valueMatrix(datagrid3.rows-1, 8));
								for (i = 1; i < datagrid3.rows-1; i++) {
									var ratio = (parseFloat(datagrid3.valueMatrix(i, 8)) / tot_amt) * 100;
									datagrid3.valueMatrix(i, 9) = ratio.toFixed(2) + " %";
								}
							}
						} else if (switch1.selectedIndex == 3) {
							if (!commReqCheck(group4))
								return;
							
							var evnt_yy_fr = parseInt(model1.getValue("/root/reqData/searchData/searchTab4/evnt_yy_fr"));
							var evnt_yy_to = parseInt(model1.getValue("/root/reqData/searchData/searchTab4/evnt_yy_to"));
							var srch_range = evnt_yy_to - evnt_yy_fr;

							if (srch_range < 0) {
								alert("행사년도의 조회 종료년도가 시작년도 보다 작을 수 없습니다.");
								return;
							} else if (srch_range > 9) {
								alert("조회범위는 10년 이내로 설정하십시오.");
								return;
							}
							
							datagrid4.subtotal("clear", 0, 0);

							for (i = 2; i <= 13; i++)
								datagrid4.colHidden(i) = true;
							
						    var tmp_node = instance1.selectSingleNode("/root/resData/gridData/gridData4/record");
						    var copyedNode = tmp_node.cloneNode(true);
						
							var del_node_len = root.resData.gridData.gridData4.childNodes.length;
							for (i = 0; i < del_node_len; i++) {
								model1.removenode(root.resData.gridData.gridData4.childNodes(0));
							}
							
							datagrid4.caption = "구분";
							var col_idx = 2;
							for (i = 2; i <= (evnt_yy_to - evnt_yy_fr)+2; i++) {
								datagrid4.colHidden(i) = false;
								datagrid4.caption = datagrid4.caption + "^" + (evnt_yy_fr + (i - 2));
								datagrid4.colAttribute (i, "format" ) = "(-)#,###";
								col_idx++;
							}
							datagrid4.colAttribute (col_idx, "format" ) = "(-)#,###";
							datagrid4.colHidden(col_idx++) = false;
							datagrid4.colHidden(col_idx) = false;
							
							datagrid4.caption = datagrid4.caption + "^합계^비율(%)"
							
							var tmp_type_cd = "";
							
							model1.send("en_innexp_3103");
							if (submit_completed()) {
								if (model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt") != "0") {
									var record_length = root.tempData.dataSet.CURLIST.childNodes.length;
									var node_length = 0;
									//레코드 노드수 만큼 반복 수행
									for (i = 0; i < record_length; i++) {
										//totalcnt 노드를 제외한 record 노드부분 수행
										if (root.tempData.dataSet.CURLIST.childNodes(i).nodeName != "totalcnt") {
											//이전 유형코드가 현재 레코드의 유형코드와 같지 않으면 row 추가
											if (tmp_type_cd != root.tempData.dataSet.CURLIST.childNodes(i).type_cd.value) {
												instance1.selectSingleNode("/root/resData/gridData/gridData4").appendChild(copyedNode);
												node_length = root.resData.gridData.gridData4.childNodes.length;
												for (k = 0; k < root.resData.gridData.gridData4.childNodes(node_length-1).childNodes.length-1; k++)
													model1.setValue(root.resData.gridData.gridData4.childNodes(node_length-1).childNodes(k), "");
	
												model1.setValue(root.resData.gridData.gridData4.childNodes(node_length-1).type_nm, root.tempData.dataSet.CURLIST.childNodes(i).type_nm.value);
											}
											//년도를 비교하여 값을 해당 cell에 설정
											for (j = 1; j <= srch_range + 1; j++) {
												if (datagrid4.valueMatrix(0, j+1) == root.tempData.dataSet.CURLIST.childNodes(i).evnt_yy.value)
													model1.setValue(eval("root.resData.gridData.gridData4.childNodes(node_length-1).value_"+j), root.tempData.dataSet.CURLIST.childNodes(i).amt.value);
											}
											tmp_type_cd = root.tempData.dataSet.CURLIST.childNodes(i).type_cd.value;
										}
									}
									model1.refresh();
								}
								model1.removeNodeset("/root/tempData/dataSet");
								datagrid4.rebuild();
								
								if (datagrid4.rows == 1)
									datagrid4.addRow();
								else {	
									//각 행별 합계 계산
									var idx = 0;
									var sum_amt = 0;
									for (i = 1; i < datagrid4.rows; i++) {
										idx = 2;
										for (j = 2; j <= srch_range + 2; j++) {
											if (datagrid4.valueMatrix(i, j) == "") 
												datagrid4.valueMatrix(i, j) = "0";
												
										    sum_amt += parseInt(datagrid4.valueMatrix(i, j));
										    idx++;
										}    
										datagrid4.valueMatrix(i, idx) = sum_amt;
										sum_amt = 0;
									}
									idx = 2;
									for (i = 2; i <= srch_range + 2; i++) {
										datagrid4.subtotal("sum", -1, i, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 1, "합 계");
										idx++;
									}
									datagrid4.subtotal("sum", -1, idx, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 1, "합 계");
									datagrid4.cellStyle("text-align", datagrid4.rows-1, 1, datagrid4.rows-1, 1) = "center";
									datagrid4.multiTotals = true;
	
									var tot_amt = parseFloat(datagrid4.valueMatrix(datagrid4.rows-1, idx));
									for (j = 1; j < datagrid4.rows-1; j++) {
										var ratio = (parseFloat(datagrid4.valueMatrix(j, idx)) / tot_amt) * 100;
										datagrid4.valueMatrix(j, idx+1) = ratio.toFixed(2) + " %";
									}
								}
							}
						} else if (switch1.selectedIndex == 4) {
							if (!commReqCheck(group5))
								return;
							
							var evnt_yy_fr = parseInt(model1.getValue("/root/reqData/searchData/searchTab5/evnt_yy_fr"));
							var evnt_yy_to = parseInt(model1.getValue("/root/reqData/searchData/searchTab5/evnt_yy_to"));
							var srch_range = evnt_yy_to - evnt_yy_fr;

							if (srch_range < 0) {
								alert("행사년도의 조회 종료년도가 시작년도 보다 작을 수 없습니다.");
								return;
							} else if (srch_range > 9) {
								alert("조회범위는 10년 이내로 설정하십시오.");
								return;
							}
							
							datagrid5.subtotal("clear", 0, 0);

							for (i = 2; i <= 13; i++)
								datagrid5.colHidden(i) = true;
							
						    var tmp_node = instance1.selectSingleNode("/root/resData/gridData/gridData5/record");
						    var copyedNode = tmp_node.cloneNode(true);
						
							var del_node_len = root.resData.gridData.gridData5.childNodes.length;
							for (i = 0; i < del_node_len; i++) {
								model1.removenode(root.resData.gridData.gridData5.childNodes(0));
							}
							
							datagrid5.caption = "담당자";
							var col_idx = 2;
							for (i = 2; i <= (evnt_yy_to - evnt_yy_fr)+2; i++) {
								datagrid5.colHidden(i) = false;
								datagrid5.caption = datagrid5.caption + "^" + (evnt_yy_fr + (i - 2));
								datagrid5.colAttribute (i, "format" ) = "(-)#,###";
								col_idx++;
							}
							datagrid5.colAttribute (col_idx, "format" ) = "(-)#,###";
							datagrid5.colHidden(col_idx++) = false;
							datagrid5.colHidden(col_idx) = false;
							
							datagrid5.caption = datagrid5.caption + "^합계^비율(%)"
							
							var chrg_pers_emp_no = "";
							
							model1.send("en_innexp_3104");
							if (submit_completed()) {
								if (model1.getValue("/root/tempData/dataSet/CURLIST/totalcnt") != "0") {
									var record_length = root.tempData.dataSet.CURLIST.childNodes.length;
									var node_length = 0;
									//레코드 노드수 만큼 반복 수행
									for (i = 0; i < record_length; i++) {
										//totalcnt 노드를 제외한 record 노드부분 수행
										if (root.tempData.dataSet.CURLIST.childNodes(i).nodeName != "totalcnt") {
											//이전 유형코드가 현재 레코드의 유형코드와 같지 않으면 row 추가
											if (chrg_pers_emp_no != root.tempData.dataSet.CURLIST.childNodes(i).chrg_pers_emp_no.value) {
												instance1.selectSingleNode("/root/resData/gridData/gridData5").appendChild(copyedNode);
												node_length = root.resData.gridData.gridData5.childNodes.length;
												for (k = 0; k < root.resData.gridData.gridData5.childNodes(node_length-1).childNodes.length-1; k++)
													model1.setValue(root.resData.gridData.gridData5.childNodes(node_length-1).childNodes(k), "");
	
												model1.setValue(root.resData.gridData.gridData5.childNodes(node_length-1).chrg_pers_emp_nm, root.tempData.dataSet.CURLIST.childNodes(i).chrg_pers_emp_nm.value);
											}
											//년도를 비교하여 값을 해당 cell에 설정
											for (j = 1; j <= srch_range + 1; j++) {
												if (datagrid5.valueMatrix(0, j+1) == root.tempData.dataSet.CURLIST.childNodes(i).evnt_yy.value)
													model1.setValue(eval("root.resData.gridData.gridData5.childNodes(node_length-1).value_"+j), root.tempData.dataSet.CURLIST.childNodes(i).amt.value);
											}
											chrg_pers_emp_no = root.tempData.dataSet.CURLIST.childNodes(i).chrg_pers_emp_no.value;
										}
									}
									model1.refresh();
								}
								model1.removeNodeset("/root/tempData/dataSet");
								datagrid5.rebuild();
								
								if (datagrid5.rows == 1)
									datagrid5.addRow();
								else {	
									//각 행별 합계 계산
									var idx = 0;
									var sum_amt = 0;
									for (i = 1; i < datagrid5.rows; i++) {
										idx = 2;
										for (j = 2; j <= srch_range + 2; j++) {
											if (datagrid5.valueMatrix(i, j) == "") 
												datagrid5.valueMatrix(i, j) = "0";
												
										    sum_amt += parseInt(datagrid5.valueMatrix(i, j));
										    idx++;
										}    
										datagrid5.valueMatrix(i, idx) = sum_amt;
										sum_amt = 0;
									}
									idx = 2;
									for (i = 2; i <= srch_range + 2; i++) {
										datagrid5.subtotal("sum", -1, i, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 1, "합 계");
										idx++;
									}
									datagrid5.subtotal("sum", -1, idx, "(-)#,###", "background-color:#ffff88; font-weight:bold; color:#0000ff;", 1, "합 계");
									datagrid5.cellStyle("text-align", datagrid5.rows-1, 1, datagrid5.rows-1, 1) = "center";
									datagrid5.multiTotals = true;
	
									var tot_amt = parseFloat(datagrid5.valueMatrix(datagrid5.rows-1, idx));
									for (j = 1; j < datagrid5.rows-1; j++) {
										var ratio = (parseFloat(datagrid5.valueMatrix(j, idx)) / tot_amt) * 100;
										datagrid5.valueMatrix(j, idx+1) = ratio.toFixed(2) + " %";
									}
								}
							}
						}
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:875px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" style="left:820px; top:0px; width:53px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.reset();		
					]]>
				</script>
			</button>
			<button id="btn_excel" class="btn03" crud="R" style="left:752px; top:0px; width:64px; height:21px; ">
				<caption>엑셀저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//excel 파일로 저장한다
						/* Property
						sheetname - 시트명
						colhiddenextend - 숨은 col 저장 여부. true/false(default)
						rowhiddenextend - 숨은 row 저장 여부. true/false(default)
						exportfalsecols - 사용자 임의로 저장하지 않을 col index (0,1,...)
						exportfalserows - 사용자 임의로 저장하지 않을 row index (0,1,...)
						col_0, col_1... - 각 컬럼에 대해 저장할 값. value(default)/label */
						var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
						if (switch1.selectedIndex == 0)
							datagrid1.saveExcel(filename, "sheetname:sheet1;colhiddenextend:false;rowhiddenextend:false;exportfalsecols:0;row_0:label;");
						else if (switch1.selectedIndex == 1)
							datagrid2.saveExcel(filename, "sheetname:sheet1;colhiddenextend:false;rowhiddenextend:false;exportfalsecols:0;row_0:label;");
						else if (switch1.selectedIndex == 2)
							datagrid3.saveExcel(filename, "sheetname:sheet1;colhiddenextend:false;rowhiddenextend:false;exportfalsecols:0;row_0:label;");
						else if (switch1.selectedIndex == 3)
							datagrid4.saveExcel(filename, "sheetname:sheet1;colhiddenextend:false;rowhiddenextend:false;exportfalsecols:0;row_0:label;");
						else if (switch1.selectedIndex == 4)
							datagrid5.saveExcel(filename, "sheetname:sheet1;colhiddenextend:false;rowhiddenextend:false;exportfalsecols:0;row_0:label;");
				]]>
				</script>
			</button>
		</group>
	</xhtml:body>
</xhtml:html>
