<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session>
							<uid/>
							<cmpy_cd/>
							<emp_no/>
							<emp_nm/>
							<dept_cd/>
							<dept_nm/>
						</session>
						<!-- 선택계열의 정보를 담당 -->
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<comboSet>
							<slip_clsf_cd>
								<item>
									<label/>
									<value/>
								</item>
							</slip_clsf_cd>
							<prof_type_cd>
								<item>
									<label/>
									<value/>
								</item>
							</prof_type_cd>
							<re_issu_resn>
								<item>
									<label/>
									<value/>
								</item>
							</re_issu_resn>
							<erplace_cd>
								<item>
									<label/>
									<value/>
								</item>
							</erplace_cd>
						</comboSet>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						<pageInfo>
						</pageInfo>
					</initData>
					<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
					<reqData>
						<!-- 검색조건 처리 -->
						<searchData>
							<occr_dt_fr/>
							<occr_dt_to/>
							<prof_type_cd/>
							<slip_clsf_cd/>
							<srch_clsf>0</srch_clsf>
							<slip_occr_dt_fr/>
							<slip_occr_dt_to/>
							<make_dt_fr/>
							<make_dt_to/>
							<dlco_nm/>
						</searchData>
						<!-- 등록/수정/삭제 요청 Form Data -->
						<reqForm>
						</reqForm>
						<!-- MultiUpDate유형 사용시 처리 -->
						<multiUpDate>
							<mst_mode/>
							<multiUpdateData/>
						</multiUpDate>
						<!-- POPUP 페이지 Forward Data -->
						<fwdData>
						</fwdData>
					</reqData>
					<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
					<resData>
						<!-- 전달 받은 리스트 데이터를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<gridData1>
								<record>
									<proc_yn/>
									<occr_no/>
									<reven_dt/>
									<evnt_nm/>
									<dlco_clsf/>
									<dlco_no/>
									<dlco_nm/>
									<reven_amt/>
									<vat_amt/>
									<tot_amt/>
									<occr_dt/>
									<occr_seq/>
									<titl/>
									<ern/>
									<addr/>
									<presi_nm/>
									<bizcond/>
									<item/>
									<evnt_cd/>
									<chrg_pers_emp_no/>
									<chrg_pers_emp_nm/>
									<stmt_occr_dt/>
									<stmt_occr_seq/>
									<email/>
								</record>
							</gridData1>
							<gridData2>
								<record>
									<slip_occr_no/>
									<make_dt/>
									<ern/>
									<dlco_nm/>
									<presi_nm/>
									<tax_stmt_aprv_yn/>
									<tax_suply_amt/>
									<tax_vat_amt/>
									<tot_amt/>
									<slip_occr_dt/>
									<slip_seq/>
									<slip_clsf_cd/>
									<prof_type_cd/>
									<dlco_clsf_cd/>
									<dlco_cd/>
									<erplace_cd/>
									<deal_clsf/>
									<addr/>
									<bizcond/>
									<item/>
									<titl/>
									<canc_dt/>
									<vexc_cmpy_cd/>
									<issu_pers_emp_no/>
									<issu_pers_emp_nm/>
									<evnt_cd/>
									<evnt_nm/>
									<remk/>
									<ask_emp_no/>
									<ask_dept_cd/>
									<re_issu_resn_cd/>
									<issu_tms/>
									<chg_dt/>
									<chg_pers/>
									<chg_pers_nm/>
								</record>
							</gridData2>
							<gridData3>
								<record>
									<occr_dt/>
									<occr_seq/>
									<titl/>
									<reven_amt/>
									<vat_amt/>
								</record>
							</gridData3>
						</gridData>
						<!-- 전달 받은 Msg를 담당 ( submit의 결과가 담김) -->
						<msg>
							<errCode/>
							<errMsg/>
						</msg>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<make_dt/>
							<ern/>
							<dlco_nm/>
							<presi_nm/>
							<tax_stmt_aprv_yn/>
							<tax_suply_amt/>
							<tax_vat_amt/>
							<tot_amt/>
							<slip_occr_dt/>
							<slip_seq/>
							<slip_clsf_cd/>
							<prof_type_cd/>
							<dlco_clsf_cd/>
							<dlco_cd/>
							<erplace_cd/>
							<deal_clsf/>
							<addr/>
							<bizcond/>
							<item/>
							<titl/>
							<canc_dt/>
							<vexc_cmpy_cd/>
							<issu_pers_emp_no/>
							<issu_pers_emp_nm/>
							<evnt_cd/>
							<evnt_nm/>
							<remk/>
							<ask_emp_no/>
							<ask_dept_cd/>
							<re_issu_resn_cd/>
							<issu_tms/>
							<chg_dt/>
							<chg_pers/>
							<chg_pers_nm/>
							<email/>
						</resForm>
					</resData>
					<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
					<tempData>
					</tempData>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					var stmt_occr_dt = "";
					var stmt_occr_seq = "";
					
					function setInitValue() {
						model1.setValue("/root/resData/resForm/slip_occr_dt", commCurDate("ymd"));
						model1.setValue("/root/resData/resForm/make_dt", commCurDate("ymd"));
						model1.setValue("/root/resData/resForm/prof_type_cd", "31");
						model1.setValue("/root/resData/resForm/slip_clsf_cd", "35");
						model1.setValue("/root/resData/resForm/erplace_cd", "01");
						model1.refresh();
					}
					
					function procTaxStmt() {
						var prof_type_cd = model1.getValue("/root/resData/resForm/prof_type_cd");
					if (prof_type_cd != "39" ) {
						if ((model1.getValue("/root/resData/resForm/ern")).length == 12) {
							if (!(prof_type_cd == "31" || prof_type_cd == "33" || prof_type_cd == "34")) {
								alert("증빙유형코드가 정확하지 않습니다. (거래처가 사업자인 경우 '31' 선택)");
								return;
							}
						} else {
							if (!(prof_type_cd == "32" || prof_type_cd == "35" )) {
								alert("증빙유형코드가 정확하지 않습니다. (거래처가 개인인 경우 '32' 선택)");
								return;
							}
						}
					}	
						//필수입력항목 체크
						if (!commReqCheck(grp_main))
							return;
							
					      //  Start
					   
					       	if ((model1.getValue("/root/resData/resForm/prof_type_cd")).length == 0 ) {
							alert("증빙유형이 등록되어 있지 않습니다.");
								 return;  }
								 
						if ((model1.getValue("/root/resData/resForm/slip_clsf_cd")).length == 0 ) {
							alert("전표구분이 등록되어 있지 않습니다.");
								 return;  }
								 
					       if ((model1.getValue("/root/resData/resForm/slip_clsf_cd")) != "35" ) {
							alert("전표구분이 35가 아닙니다.");
								 return;  }	
								 
							if ((model1.getValue("/root/resData/resForm/dlco_cd")) != "501" ) {	 
					       	  if ((model1.getValue("/root/resData/resForm/ern")).length == 0 ) {
							     alert("사업자번호(주민등록번호)가 등록되어 있지 않습니다.");
								 return;  }
							}
							
					        if ((model1.getValue("/root/resData/resForm/dlco_cd")).length == 0 ) {
							alert("거래처코드가 등록되어 있지 않습니다.");
								 return;  }
								 	
					        if ((model1.getValue("/root/resData/resForm/dlco_nm")).length == 0 ) {
							alert("거래처명이 등록되어 있지 않습니다.");
								 return;  }
					
						if ((model1.getValue("/root/resData/resForm/make_dt")).length != 8 ) {
							alert("작성일자를 바르게 등록하시오.");
								 return;  }
				            
				               if (!(prof_type_cd == "32" || prof_type_cd == "35" || prof_type_cd == "39")) {             
				                  if ((model1.getValue("/root/resData/resForm/presi_nm")).length == 0 ) {
							alert("대표자명이 등록되어 있지 않습니다.");
								 return;  }			
				               }
				               
				            if (!(prof_type_cd == "32" || prof_type_cd == "35" || prof_type_cd == "39")) {        				              
						    if ((model1.getValue("/root/resData/resForm/bizcond")).length == 0 ) {
						  	  alert("업태가 등록되어 있지 않습니다.");
								 return;  }		
					         }
					        
					        if (!(prof_type_cd == "32" || prof_type_cd == "35" || prof_type_cd == "39")) {    
					            if ((model1.getValue("/root/resData/resForm/item")).length == 0 ) {
							alert("종목이 등록되어 있지 않습니다.");
								 return;  }	
						 }
						 
						if ((model1.getValue("/root/resData/resForm/dlco_cd")) != "501" && (model1.getValue("/root/resData/resForm/dlco_cd")) != "460000"  ) {	  
						  if ((model1.getValue("/root/resData/resForm/addr")).length == 0 ) {
							alert("주소가 등록되어 있지 않습니다.");
								 return;  }				 
						} 
						
						if ((model1.getValue("/root/resData/resForm/dlco_cd")) != "501"&& (model1.getValue("/root/resData/resForm/dlco_cd")) != "460000"   ) {	  
						 if ((model1.getValue("/root/resData/resForm/email")).length == 0 ) {
							alert("이메일이 등록되어 있지 않습니다.");
								 return;  }			
						}  		 	
					 //-----------------------------------------------------------------------------
					  //   if ((model1.getValue(" /root/resData/resForm/email")).length == 0 ) {
					  //      if (window.alert("이메일이 등록되어 있지 않습니다.", "확인", 1) == 1) {
					  //	        }
					  //	 }		
					  //-----------------------------------------------------------------------------    
						       
                                            //  Endt	
						if (model1.getValue("/root/resData/resForm/dlco_clsf_cd") == "93") {
							model1.setValue("/root/resData/resForm/deal_clsf", "3");
						} else if (model1.getValue("/root/resData/resForm/dlco_clsf_cd") == "94") {
							model1.setValue("/root/resData/resForm/deal_clsf", "4");
						}
						
						//어음체크 추가
						//
						//
						
						//취소일자
						model1.setValue("/root/resData/resForm/canc_dt", commCurDate("ymd"));
						
						var mst_mode = model1.getValue("/root/reqData/multiUpDate/mst_mode");
						var node_length = root.reqData.multiUpDate.childNodes.length;

						for (i = 0; i < node_length; i++) {
							model1.removenode(root.reqData.multiUpDate.childNodes(0));
						}

						model1.makeNode("/root/reqData/multiUpDate/mst_mode");
						model1.setValue("/root/reqData/multiUpDate/mst_mode", mst_mode);

						var node_nm = "";
						var node_val = "";
					
						//수입마스터 등록을 위해 입력값을 multiUpDate 노드에 복사
						for (i = 0; i < root.resData.resForm.childNodes.length; i++) {
							           
							node_nm = root.resData.resForm.childNodes(i).nodeName;
							node_val = root.resData.resForm.childNodes(i).nodeValue;
													
							model1.makeNode("/root/reqData/multiUpDate/" + node_nm);
							model1.setValue("/root/reqData/multiUpDate/" + node_nm, node_val);
						}
						
						if (model1.getValue("/root/reqData/multiUpDate/mst_mode") == "D") {
							for (i = 1; i < grd_reven_list.rows; i++) {
								if (grd_reven_list.valueMatrix(i, 1) == "true" && 
								    grd_reven_list.valueMatrix(i, 22) == model1.getValue("/root/resData/resForm/slip_occr_dt") &&
								    grd_reven_list.valueMatrix(i, 23) == model1.getValue("/root/resData/resForm/slip_seq")) {

									if (stmt_occr_dt == grd_reven_list.valueMatrix(i, 22) &&
									    stmt_occr_seq == grd_reven_list.valueMatrix(i, 23)) {
										if (grd_detail.valueMatrix(grd_detail.rows-1, 1) != "") 
											grd_detail.addRow();
		
										grd_detail.valueMatrix(grd_detail.rows-1, 1) = grd_reven_list.valueMatrix(i, 11);							
										grd_detail.valueMatrix(grd_detail.rows-1, 2) = grd_reven_list.valueMatrix(i, 12);							
										grd_detail.valueMatrix(grd_detail.rows-1, 3) = grd_reven_list.valueMatrix(i, 13);							
										grd_detail.valueMatrix(grd_detail.rows-1, 4) = grd_reven_list.valueMatrix(i, 8);							
										grd_detail.valueMatrix(grd_detail.rows-1, 5) = grd_reven_list.valueMatrix(i, 9);							
									}
								}
							}
						} else {
							for (i = 1; i < grd_reven_list.rows; i++) {
								if (grd_reven_list.valueMatrix(i, 1) == "true" && grd_reven_list.valueMatrix(i, 22) == "") {
									if (grd_detail.valueMatrix(grd_detail.rows-1, 1) != "") 
										grd_detail.addRow();
	
									grd_detail.valueMatrix(grd_detail.rows-1, 1) = grd_reven_list.valueMatrix(i, 11);							
									grd_detail.valueMatrix(grd_detail.rows-1, 2) = grd_reven_list.valueMatrix(i, 12);							
									grd_detail.valueMatrix(grd_detail.rows-1, 3) = model1.getValue("/root/resData/resForm/titl");							
									//grd_detail.valueMatrix(grd_detail.rows-1, 3) = grd_reven_list.valueMatrix(i, 13);							
									grd_detail.valueMatrix(grd_detail.rows-1, 4) = grd_reven_list.valueMatrix(i, 8);							
									grd_detail.valueMatrix(grd_detail.rows-1, 5) = grd_reven_list.valueMatrix(i, 9);							
								}
							}
						}
						
						model1.makeNode("/root/reqData/multiUpDate/multiUpdateData");
						
						for (i = 1; i < grd_detail.rows; i++)
							grd_detail.rowStatus(i) = 1;
							
						model1.setValue("/root/reqData/multiUpDate/multiUpdateData", grd_detail.getUpdateData());
						model1.send("en_innexp_1103");
						
						if (submit_completed()) {
							var occr_dt_fr = model1.getValue("/root/reqData/searchData/occr_dt_fr");
							var occr_dt_to = model1.getValue("/root/reqData/searchData/occr_dt_to");
							var prof_type_cd = model1.getValue("/root/reqData/searchData/prof_type_cd");
							var slip_clsf_cd = model1.getValue("/root/reqData/searchData/slip_clsf_cd");
							var srch_clsf = model1.getValue("/root/reqData/searchData/srch_clsf");
							
							model1.reset();
							
							model1.setValue("/root/reqData/searchData/occr_dt_fr", occr_dt_fr);
							model1.setValue("/root/reqData/searchData/occr_dt_to", occr_dt_to);
							model1.setValue("/root/reqData/searchData/prof_type_cd", prof_type_cd);
							model1.setValue("/root/reqData/searchData/slip_clsf_cd", slip_clsf_cd);
							model1.setValue("/root/reqData/searchData/srch_clsf", srch_clsf);
							
							btn_tax.dispatch("onclick");
							btn_srch.dispatch("onclick");
						}
						else
						{
						   //  model1.removeNodeset("/root/resData/gridData/gridData3");	
						       var occr_dt_fr = model1.getValue("/root/reqData/searchData/occr_dt_fr");
							var occr_dt_to = model1.getValue("/root/reqData/searchData/occr_dt_to");
							var prof_type_cd = model1.getValue("/root/reqData/searchData/prof_type_cd");
							var slip_clsf_cd = model1.getValue("/root/reqData/searchData/slip_clsf_cd");
							var srch_clsf = model1.getValue("/root/reqData/searchData/srch_clsf");
							
							model1.reset();
							
							model1.setValue("/root/reqData/searchData/occr_dt_fr", occr_dt_fr);
							model1.setValue("/root/reqData/searchData/occr_dt_to", occr_dt_to);
							model1.setValue("/root/reqData/searchData/prof_type_cd", prof_type_cd);
							model1.setValue("/root/reqData/searchData/slip_clsf_cd", slip_clsf_cd);
							model1.setValue("/root/reqData/searchData/srch_clsf", srch_clsf);
							
							btn_tax.dispatch("onclick");
							btn_srch.dispatch("onclick");
						}	
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					// session 정보 셋팅
					model.setValue("/root/initData/session/uid", getProperty("ss_uid")); 		     	// 아이디
					model.setValue("/root/initData/session/cmpy_cd", getProperty("ss_cmpycd"));		// 회사
					model.setValue("/root/initData/session/emp_no", getProperty("ss_emp_no"));      	// 사번
					model.setValue("/root/initData/session/emp_nm", getProperty("ss_emp_nm"));     	// 성명
					model.setValue("/root/initData/session/dept_cd", getProperty("ss_deptcd"));      	// 부서
					model.setValue("/root/initData/session/dept_nm", getProperty("ss_deptnm"));      	// 부서명
					
					var addDate = addDay(commCurDate("y"), commCurDate("m"), commCurDate("d"), -7);
					year = addDate.getYear();
					month = addDate.getMonth()+1;
					date = addDate.getDate();
					if(month < 10)
						month = "0" + month;
					if(date < 10)
						date = "0" + date;
						
					var from_date = year + "" + month + "" + date;
					model1.setValue("/root/reqData/searchData/occr_dt_fr", from_date);
					
					//현재날짜 설정
					model1.setValue("/root/reqData/searchData/occr_dt_to", commCurDate("ymd"));
					model1.setValue("/root/reqData/searchData/slip_occr_dt_fr", commCurDate("ymd"));
					model1.setValue("/root/reqData/searchData/slip_occr_dt_to", commCurDate("ymd"));
					model1.setValue("/root/resData/resForm/slip_occr_dt", commCurDate("ymd"));
					model1.setValue("/root/resData/resForm/make_dt", commCurDate("ymd"));

					//콤보데이터 설정
					model1.send("en_innexp_1100");
					makeComboSet("", "/root/tempData/dataSet/CURLIST1/record", "/root/initData/comboSet/re_issu_resn", "cdabrvnm_cd", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST2/record", "/root/initData/comboSet/prof_type_cd", "cdabrvnm_cd", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST3/record", "/root/initData/comboSet/slip_clsf_cd", "cdabrvnm_cd", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST4/record", "/root/initData/comboSet/erplace_cd", "cdabrvnm_cd", "cd")
					model1.removeNodeset("/root/tempData/dataSet");
					
					//초기값 설정
					model1.setValue("/root/reqData/searchData/prof_type_cd", "31");
					model1.setValue("/root/reqData/searchData/slip_clsf_cd", "35");
					
					setInitValue();
					
					model1.refresh();
					
					grd_reven_list.fixedcellcheckbox(0, 1) = true;
				]]>
			</script>
			<submission id="en_innexp_1100" action="/en/innexp/1100" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1101" action="/en/innexp/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1102" action="/en/innexp/1102" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="en_innexp_1103" action="/en/innexp/1103" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/tempData"/>
		</model>
		<script type="javascript" src="/js/en_common.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/TFCommon.js"/>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="1,937;" style="font-family:굴림; ">
		<group id="group1" class="gro_sel" style="left:10px; top:510px; width:927px; height:205px; ">
			<caption id="caption7" class="list_cap02" style="left:84px; top:26px; width:841px; height:26px; text-align:center; "/>
			<datagrid id="grd_tax" nodeset="/root/resData/gridData/gridData2/record" caption="계산서번호^작성일자^사업자등록번호^거래처명^대표자명^계산서상태^공급가액^부가세^총액^발생일자^일련번호^전표구분^증빙유형^거래처구분코드^거래처코드^사업장구분^거래구분^주소^업태^업종^품목^취소일자^대행사코드^발행자사번^발행자명^행사코드^행사명^비고^의뢰사번^의뢰부서^재발행사유^발행횟수^수정일자^수정자사번^수정자명" colsep="^" colwidth="90, 80, 100, 170, 90, 80, 100, 80, 110, 90, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowheight="20" rowsep="|" style="left:0px; top:57px; width:925px; height:148px; ">
				<col ref="slip_occr_no" type="output" style="left:100px; top:20px; width:233px; height:20px; text-align:center; "/>
				<col ref="make_dt" format="yyyy-mm-dd" style="text-align:center; "/>
				<col ref="ern" style="text-align:center; "/>
				<col ref="dlco_nm" style="text-align:left; "/>
				<col ref="presi_nm" style="text-align:center; "/>
				<col ref="tax_stmt_aprv_yn" style="text-align:center; "/>
				<col ref="tax_suply_amt" format="(-)#,###" style="text-align:right; "/>
				<col ref="tax_vat_amt" format="(-)#,###" style="text-align:right; "/>
				<col ref="tot_amt" format="(-)#,###" style="text-align:right; "/>
				<col ref="slip_occr_dt" visibility="hidden"/>
				<col ref="slip_seq" visibility="hidden"/>
				<col ref="slip_clsf_cd" visibility="hidden"/>
				<col ref="prof_type_cd" visibility="hidden"/>
				<col ref="dlco_clsf_cd" visibility="hidden"/>
				<col ref="dlco_cd" visibility="hidden"/>
				<col ref="erplace_cd" visibility="hidden"/>
				<col ref="deal_clsf" visibility="hidden"/>
				<col ref="addr" visibility="hidden"/>
				<col ref="bizcond" visibility="hidden"/>
				<col ref="item" visibility="hidden"/>
				<col ref="titl" visibility="hidden"/>
				<col ref="canc_dt" visibility="hidden"/>
				<col ref="vexc_cmpy_cd" visibility="hidden"/>
				<col ref="issu_pers_emp_no" visibility="hidden"/>
				<col ref="issu_pers_emp_nm" visibility="hidden"/>
				<col ref="evnt_cd" visibility="hidden"/>
				<col ref="evnt_nm" visibility="hidden"/>
				<col ref="remk" visibility="hidden"/>
				<col ref="ask_emp_no" visibility="hidden"/>
				<col ref="ask_dept_cd" visibility="hidden"/>
				<col ref="re_issu_resn_cd" visibility="hidden"/>
				<col ref="issu_tms" visibility="hidden"/>
				<col ref="chg_dt" visibility="hidden"/>
				<col ref="chg_pers" visibility="hidden"/>
				<col ref="chg_pers_nm" visibility="hidden"/>
				<script type="javascript" ev:event="ondblclick">
					<![CDATA[
						if(grd_tax.row == 0) return;	
						if (grd_tax.valueMatrix(grd_tax.row, 1) == "") return;
						
						var selectedIdx = grd_tax.row;
						model1.setValue("/root/resData/resForm/make_dt", grd_tax.valueMatrix(selectedIdx, 2));
						model1.setValue("/root/resData/resForm/ern", grd_tax.valueMatrix(selectedIdx, 3));
						model1.setValue("/root/resData/resForm/dlco_nm", grd_tax.valueMatrix(selectedIdx, 4));
						model1.setValue("/root/resData/resForm/presi_nm", grd_tax.valueMatrix(selectedIdx, 5));
						model1.setValue("/root/resData/resForm/tax_stmt_aprv_yn", grd_tax.valueMatrix(selectedIdx, 6));
						model1.setValue("/root/resData/resForm/tax_suply_amt", grd_tax.valueMatrix(selectedIdx, 7));
						model1.setValue("/root/resData/resForm/tax_vat_amt", grd_tax.valueMatrix(selectedIdx, 8));
						model1.setValue("/root/resData/resForm/tot_amt", grd_tax.valueMatrix(selectedIdx, 9));
						model1.setValue("/root/resData/resForm/slip_occr_dt", grd_tax.valueMatrix(selectedIdx, 10));
						model1.setValue("/root/resData/resForm/slip_seq", grd_tax.valueMatrix(selectedIdx, 11));
						model1.setValue("/root/resData/resForm/slip_clsf_cd", grd_tax.valueMatrix(selectedIdx, 12));
						model1.setValue("/root/resData/resForm/prof_type_cd", grd_tax.valueMatrix(selectedIdx, 13));
						model1.setValue("/root/resData/resForm/dlco_clsf_cd", grd_tax.valueMatrix(selectedIdx, 14));
						model1.setValue("/root/resData/resForm/dlco_cd", grd_tax.valueMatrix(selectedIdx, 15));
						model1.setValue("/root/resData/resForm/erplace_cd", grd_tax.valueMatrix(selectedIdx, 16));
						model1.setValue("/root/resData/resForm/deal_clsf", grd_tax.valueMatrix(selectedIdx, 17));
						model1.setValue("/root/resData/resForm/addr", grd_tax.valueMatrix(selectedIdx, 18));
						model1.setValue("/root/resData/resForm/bizcond", grd_tax.valueMatrix(selectedIdx, 19));
						model1.setValue("/root/resData/resForm/item", grd_tax.valueMatrix(selectedIdx, 20));
						model1.setValue("/root/resData/resForm/titl", grd_tax.valueMatrix(selectedIdx, 21));
						model1.setValue("/root/resData/resForm/canc_dt", grd_tax.valueMatrix(selectedIdx, 22));
						model1.setValue("/root/resData/resForm/vexc_cmpy_cd", grd_tax.valueMatrix(selectedIdx, 23));
						model1.setValue("/root/resData/resForm/issu_pers_emp_no", grd_tax.valueMatrix(selectedIdx, 24));
						model1.setValue("/root/resData/resForm/issu_pers_emp_nm", grd_tax.valueMatrix(selectedIdx, 25));
						model1.setValue("/root/resData/resForm/evnt_cd", grd_tax.valueMatrix(selectedIdx, 26));
						model1.setValue("/root/resData/resForm/evnt_nm", grd_tax.valueMatrix(selectedIdx, 27));
						model1.setValue("/root/resData/resForm/remk", grd_tax.valueMatrix(selectedIdx, 28));
						model1.setValue("/root/resData/resForm/ask_emp_no", grd_tax.valueMatrix(selectedIdx, 29));
						model1.setValue("/root/resData/resForm/ask_dept_cd", grd_tax.valueMatrix(selectedIdx, 30));
						model1.setValue("/root/resData/resForm/re_issu_resn_cd", grd_tax.valueMatrix(selectedIdx, 31));
						model1.setValue("/root/resData/resForm/issu_tms", grd_tax.valueMatrix(selectedIdx, 32));
						model1.setValue("/root/resData/resForm/chg_dt", grd_tax.valueMatrix(selectedIdx, 33));
						model1.setValue("/root/resData/resForm/chg_pers", grd_tax.valueMatrix(selectedIdx, 34));
						model1.setValue("/root/resData/resForm/chg_pers_nm", grd_tax.valueMatrix(selectedIdx, 35));

						model1.refresh();
						btn_ins.disabled = true;
						btn_canc.disabled = true;
					]]>
				</script>
			</datagrid>
			<input id="input4" ref="/root/reqData/searchData/slip_occr_dt_fr" navindex="14" inputtype="date" maxlength="10" format="yyyy-mm-dd" style="left:89px; top:30px; width:85px; height:18px; "/>
			<caption id="caption3" style="left:175px; top:30px; width:13px; height:20px; font-family:굴림체; font-size:9pt; ">~</caption>
			<caption id="caption5" class="list_cap01" style="left:0px; top:26px; width:85px; height:26px; text-align:center; ">발생일자</caption>
			<input id="input5" ref="/root/reqData/searchData/dlco_nm" navindex="18" appearance="input" style="left:685px; top:30px; width:140px; height:18px; "/>
			<input id="input6" ref="/root/reqData/searchData/slip_occr_dt_to" navindex="15" inputtype="date" maxlength="10" format="yyyy-mm-dd" style="left:185px; top:30px; width:85px; height:18px; "/>
			<caption id="caption6" class="list_cap01" style="left:596px; top:26px; width:85px; height:26px; text-align:center; ">거래처명</caption>
			<caption id="caption8" style="left:474px; top:30px; width:13px; height:20px; font-family:굴림체; font-size:9pt; ">~</caption>
			<caption id="caption10" class="list_cap01" style="left:299px; top:26px; width:85px; height:26px; text-align:center; ">작성일자</caption>
			<input id="input7" ref="/root/reqData/searchData/make_dt_fr" navindex="16" inputtype="date" maxlength="10" format="yyyy-mm-dd" style="left:388px; top:30px; width:85px; height:18px; "/>
			<input id="input8" ref="/root/reqData/searchData/make_dt_to" navindex="17" inputtype="date" maxlength="10" format="yyyy-mm-dd" style="left:484px; top:30px; width:85px; height:18px; "/>
			<group id="group2" class="gro_tit2" style="left:1px; top:0px; width:926px; height:25px; ">
				<caption id="caption11" class="tit02" style="left:0px; top:3px; width:926px; height:20px; ">계산서 조회</caption>
				<button id="btn_tax" class="btn03" crud="R" style="left:860px; top:3px; width:66px; height:21px; ">
					<caption>계산서조회</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							var slip_occr_dt_fr = model1.getValue("/root/reqData/searchData/slip_occr_dt_fr");
							var slip_occr_dt_to = model1.getValue("/root/reqData/searchData/slip_occr_dt_to");
							var make_dt_fr = model1.getValue("/root/reqData/searchData/make_dt_fr");
							var make_dt_to = model1.getValue("/root/reqData/searchData/make_dt_to");
							var dlco_nm = model1.getValue("/root/reqData/searchData/dlco_nm");
							
							model1.reset();
							
							model1.setValue("/root/reqData/searchData/slip_occr_dt_fr", slip_occr_dt_fr);
							model1.setValue("/root/reqData/searchData/slip_occr_dt_to", slip_occr_dt_to);
							model1.setValue("/root/reqData/searchData/make_dt_fr", make_dt_fr);
							model1.setValue("/root/reqData/searchData/make_dt_to", make_dt_to);
							model1.setValue("/root/reqData/searchData/dlco_nm", dlco_nm);

							model1.send("en_innexp_1101");
							model1.copyNode("/root/resData/gridData/gridData2", "/root/tempData/dataSet/CURLIST");
							model1.removeNodeset("/root/tempData/dataSet");
							model1.refresh();

							if (grd_tax.rows == 1)
								grd_tax.addRow();
						]]>
					</script>
				</button>
			</group>
		</group>
		<import id="import1" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:927px; height:29px; "/>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:45px; width:925px; height:21px; ">
			<button id="btn_srch" class="btn02" crud="R" style="left:627px; top:0px; width:53px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						model1.send("en_innexp_1102");
						model1.copyNode("/root/resData/gridData/gridData1", "/root/tempData/dataSet/CURLIST");
						model1.removeNodeset("/root/tempData/dataSet");

						grd_reven_list.refresh();

						for (i = 1; i < grd_reven_list.rows; i++)
						     
							if (grd_reven_list.valueMatrix(i, 22) != "")
								grd_reven_list.isReadOnly(i, 1, i, 1) = true;
							else
								grd_reven_list.isReadOnly(i, 1, i, 1) = false;
					
						commGroupInit(grp_main);
						setInitValue();
						
						if (grd_reven_list.rows == 1)
							grd_reven_list.addRow();

						btn_ins.disabled = false;
						btn_canc.disabled = false;
					]]>
				</script>
			</button>
			<button id="btn_ins" class="btn03" crud="C" style="left:680px; top:0px; width:66px; height:21px; ">
				<caption>발행등록</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.setValue("/root/reqData/multiUpDate/mst_mode", "I");

						if (window.alert("계산서를 등록하시겠습니까?", "확인", 1) == 1) {
							procTaxStmt();
						}
					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" style="left:818px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						btn_ins.disabled = false;
						btn_canc.disabled = false;
						model1.reset();	
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:873px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					]]>
				</script>
			</button>
			<button id="btn_canc" class="btn03" crud="U" style="left:750px; top:0px; width:66px; height:21px; ">
				<caption>등록취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (model1.getValue("/root/resData/resForm/slip_seq") == "") {
							alert("취소할 세금계산서를 선택하십시오.");
							return;
						}
						
						if (model1.getValue("/root/resData/resForm/canc_dt") != "") {
							alert("발행취소된 계산서입니다.");
							return;
						}
						
						if (model1.getValue("/root/resData/resForm/tax_stmt_aprv_yn") == "2") {
							alert("해당 세금계산서는 회계승인 상태이므로 취소처리가 불가능합니다.");
							return;
						}
						
						//계산서취소 가능여부 확인(행사종료월을 기준으로 세금계산서 처리 제한)
						//
						//
						//
						
						if (model1.getValue("/root/resData/resForm/issu_tms") != "0") {
							alert("이미 발행된 계산서입니다.");
							return;
						} else {
							model1.setValue("/root/reqData/multiUpDate/mst_mode", "D");
							
							if (window.alert("계산서 등록을 취소하시겠습니까?", "확인", 1) == 1) {
								procTaxStmt();
							}
						}
					]]>
				</script>
			</button>
			<button id="button2" class="btn02" visibility="hidden" style="left:500px; top:0px; width:52px; height:21px; ">
				<caption>수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					]]>
				</script>
			</button>
			<button id="button3" class="btn03" visibility="hidden" style="left:554px; top:0px; width:66px; height:21px; ">
				<caption>작업취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					]]>
				</script>
			</button>
		</group>
		<datagrid id="grd_reven_list" nodeset="/root/resData/gridData/gridData1/record" caption="^수입발생번호^수입일자^행사명^거래처구분^거래처번호^거래처명^공급가액^부가세액^총액^caption1^caption2^caption3^caption4^caption5^caption6^caption7^caption8^caption9^caption10^caption11^caption12^caption13^caption14" colsep="^" colwidth="21, 80, 70, 150, 90, 80, 149, 95, 85, 90, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowheight="20" rowsep="|" style="left:10px; top:120px; width:927px; height:185px; ">
			<col ref="proc_yn" type="checkbox" style="left:0px; top:20px; width:100px; height:20px; "/>
			<col ref="occr_no" type="output" style="left:100px; top:20px; width:233px; height:20px; text-align:left; "/>
			<col ref="reven_dt" format="yyyy-mm-dd"/>
			<col ref="evnt_nm" style="text-align:left; "/>
			<col ref="dlco_clsf"/>
			<col ref="dlco_no"/>
			<col ref="dlco_nm" style="text-align:left; "/>
			<col ref="reven_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="vat_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="tot_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="occr_seq" visibility="hidden"/>
			<col ref="titl" visibility="hidden"/>
			<col ref="ern" visibility="hidden"/>
			<col ref="addr" visibility="hidden"/>
			<col ref="presi_nm" visibility="hidden"/>
			<col ref="bizcond" visibility="hidden"/>
			<col ref="item" visibility="hidden"/>
			<col ref="evnt_cd" visibility="hidden"/>
			<col ref="chrg_pers_emp_no" visibility="hidden"/>
			<col ref="chrg_pers_emp_nm" visibility="hidden"/>
			<col ref="stmt_occr_dt" visibility="hidden"/>
			<col ref="stmt_occr_seq" visibility="hidden"/>
			<col ref="email"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if(grd_reven_list.row == 0) return;	
					
					if (grd_reven_list.col != 1 && grd_reven_list.valueMatrix(grd_reven_list.row, 22) == "")
						return;
					
					stmt_occr_dt = grd_reven_list.valueMatrix(grd_reven_list.row, 22);
					stmt_occr_seq = grd_reven_list.valueMatrix(grd_reven_list.row, 23);
					
					if (grd_reven_list.valueMatrix(grd_reven_list.row, 2) == "") return;
					
					if (grd_reven_list.valueMatrix(grd_reven_list.row, 22) != "") {
							
							model1.setValue("/root/reqData/searchData/slip_occr_dt_fr", grd_reven_list.valueMatrix(grd_reven_list.row, 22));
							model1.setValue("/root/reqData/searchData/slip_occr_dt_to", grd_reven_list.valueMatrix(grd_reven_list.row, 23));
							model1.send("en_innexp_1101");
                                          
							for (i = 0; i < root.tempData.dataSet.CURLIST.record.childNodes.length; i++) {
								node_nm = root.tempData.dataSet.CURLIST.record.childNodes(i).nodeName;
								node_val = root.tempData.dataSet.CURLIST.record.childNodes(i).nodeValue;	
								                                                    
								for (j = 0; j < root.resData.resForm.childNodes.length; j++) {
									
									if (node_nm == root.resData.resForm.childNodes(j).nodeName)								
									   {   model1.setValue("/root/resData/resForm/" + node_nm, node_val);
									   } 	
								}
							}
					} else {
						var tmp_dlco_no = "";
						var selected_rows = 0;
						
						for (i = 1; i < grd_reven_list.rows; i++) {
							tmp_dlco_no = grd_reven_list.valueMatrix(i, 6);
							if (grd_reven_list.valueMatrix(i, 1) == "true" && grd_reven_list.valueMatrix(i, 22) == "") {
								if (tmp_dlco_no != grd_reven_list.valueMatrix(grd_reven_list.row, 6) && grd_reven_list.row != i) {
									alert("동일한 거래처를 선택하십시오.");
									grd_reven_list.valueMatrix(grd_reven_list.row, 1) = "false";
									return;
								}
							}
						}
	
						commGroupInit(grp_main);
						setInitValue();
						selected_rows = 0;
						
						for (i = 1; i < grd_reven_list.rows; i++) {
							if (grd_reven_list.valueMatrix(i, 1) == "true" && grd_reven_list.valueMatrix(i, 22) == "") {
								if (selected_rows == 0) {
									selected_rows++;
									model1.setValue("/root/resData/resForm/make_dt", grd_reven_list.valueMatrix(i, 3));
									model1.setValue("/root/resData/resForm/ern", grd_reven_list.valueMatrix(i, 14));
									model1.setValue("/root/resData/resForm/dlco_cd", grd_reven_list.valueMatrix(i, 6));
									model1.setValue("/root/resData/resForm/dlco_nm", grd_reven_list.valueMatrix(i, 7));
									model1.setValue("/root/resData/resForm/dlco_clsf_cd", grd_reven_list.valueMatrix(i, 5).substring(0, 2));
									model1.setValue("/root/resData/resForm/addr", grd_reven_list.valueMatrix(i, 15));
									model1.setValue("/root/resData/resForm/presi_nm", grd_reven_list.valueMatrix(i, 16));
									model1.setValue("/root/resData/resForm/bizcond", grd_reven_list.valueMatrix(i, 17));
									model1.setValue("/root/resData/resForm/item", grd_reven_list.valueMatrix(i, 18));
									model1.setValue("/root/resData/resForm/tax_suply_amt", grd_reven_list.valueMatrix(i, 8));
									model1.setValue("/root/resData/resForm/tax_vat_amt", grd_reven_list.valueMatrix(i, 9));
									model1.setValue("/root/resData/resForm/tot_amt", grd_reven_list.valueMatrix(i, 10));
									model1.setValue("/root/resData/resForm/evnt_cd", grd_reven_list.valueMatrix(i, 19));
									model1.setValue("/root/resData/resForm/evnt_nm", grd_reven_list.valueMatrix(i, 4));
									model1.setValue("/root/resData/resForm/titl", grd_reven_list.valueMatrix(i, 13));
									model1.setValue("/root/resData/resForm/email", grd_reven_list.valueMatrix(i, 24));
								} else {
									var tax_suply_amt = parseInt(model1.getValue("/root/resData/resForm/tax_suply_amt"));
									var tax_vat_amt = parseInt(model1.getValue("/root/resData/resForm/tax_vat_amt"));
									var tot_amt = parseInt(model1.getValue("/root/resData/resForm/tot_amt"));
									model1.setValue("/root/resData/resForm/tax_suply_amt", tax_suply_amt + parseInt(grd_reven_list.valueMatrix(i, 8)));
									model1.setValue("/root/resData/resForm/tax_vat_amt", tax_vat_amt + parseInt(grd_reven_list.valueMatrix(i, 9)));
									model1.setValue("/root/resData/resForm/tot_amt", tot_amt + parseInt(grd_reven_list.valueMatrix(i, 10)));
								}
							}
						}
					}
					model1.refresh();
				]]>
			</script>
		</datagrid>
		<group id="group_scr" class="gro_sel" style="left:10px; top:89px; width:927px; height:26px; ">
			<caption id="caption9" class="list_cap02" style="left:84px; top:0px; width:843px; height:26px; text-align:center; "/>
			<caption id="caption4" class="list_cap01" style="left:0px; top:0px; width:85px; height:26px; text-align:center; ">수입발생일자</caption>
			<input id="ipt_srch_occr_dt" ref="/root/reqData/searchData/occr_dt_fr" navindex="1" inputtype="date" maxlength="10" format="yyyy-mm-dd" style="left:89px; top:4px; width:85px; height:18px; "/>
			<input id="input1" ref="/root/reqData/searchData/occr_dt_to" navindex="2" inputtype="date" maxlength="10" format="yyyy-mm-dd" style="left:185px; top:4px; width:85px; height:18px; "/>
			<caption id="caption13" style="left:175px; top:4px; width:13px; height:20px; font-family:굴림체; font-size:9pt; ">~</caption>
			<caption id="caption12" class="list_cap01" style="left:483px; top:0px; width:85px; height:26px; border-style:solid; ">전표구분</caption>
			<caption id="caption14" class="list_cap01" style="left:279px; top:0px; width:85px; height:26px; border-style:solid; ">증빙유형</caption>
			<select1 id="combo2" ref="/root/reqData/searchData/slip_clsf_cd" navindex="4" appearance="minimal" style="left:572px; top:4px; width:107px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/slip_clsf_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						model1.setValue("/root/resData/resForm/slip_clsf_cd", model1.getValue("/root/reqData/searchData/slip_clsf_cd"));		
						model1.refresh();
					]]>
				</script>
			</select1>
			<select1 id="combo3" ref="/root/reqData/searchData/prof_type_cd" navindex="3" appearance="minimal" style="left:368px; top:4px; width:107px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/prof_type_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						model1.setValue("/root/resData/resForm/prof_type_cd", model1.getValue("/root/reqData/searchData/prof_type_cd"));		
						model1.refresh();
					]]>
				</script>
			</select1>
			<caption id="caption15" class="list_cap01" style="left:687px; top:0px; width:85px; height:26px; border-style:solid; ">등록여부</caption>
			<select1 id="radio1" ref="/root/reqData/searchData/srch_clsf" navindex="5" appearance="full" cols="3" overflow="visible" style="left:777px; top:5px; width:150px; height:16px; border-style:none; ">
				<choices>
					<item>
						<label>미등록</label>
						<value>0</value>
					</item>
					<item>
						<label>등록</label>
						<value>1</value>
					</item>
					<item>
						<label>전체</label>
						<value>2</value>
					</item>
				</choices>
			</select1>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:75px; width:927px; height:5px; "/>
		<group id="grp_main" style="left:11px; top:317px; width:925px; height:185px; ">
			<caption id="caption38" class="list_cap02" style="left:84px; top:131px; width:841px; height:26px; border-style:solid; "/>
			<caption id="caption25" class="list_cap02" style="left:84px; top:156px; width:841px; height:26px; border-style:solid; "/>
			<caption id="caption46" class="list_cap02" style="left:84px; top:0px; width:841px; height:26px; "/>
			<caption id="caption45" class="list_cap02" style="left:84px; top:56px; width:841px; height:26px; border-style:solid; "/>
			<caption id="caption65" class="list_cap02" style="left:84px; top:81px; width:841px; height:26px; border-style:solid; "/>
			<caption id="caption53" class="list_cap02" style="left:84px; top:106px; width:841px; height:26px; border-style:solid; "/>
			<caption id="caption42" class="list_cap02" style="left:84px; top:31px; width:841px; height:26px; border-style:solid; "/>
			<caption id="caption70" class="list_cap03" style="left:0px; top:106px; width:85px; height:26px; border-style:solid; ">부가세액</caption>
			<caption id="caption81" class="list_cap03" style="left:229px; top:131px; width:85px; height:26px; border-style:solid; ">변경일자</caption>
			<caption id="caption60" class="list_cap03" style="left:0px; top:31px; width:85px; height:26px; border-style:solid; ">사업자번호</caption>
			<caption id="caption71" class="list_cap03" style="left:0px; top:131px; width:85px; height:26px; border-style:solid; ">총    액</caption>
			<caption id="caption50" class="list_cap03" style="left:460px; top:106px; width:85px; height:26px; border-style:solid; ">비  고</caption>
			<output id="input40" ref="/root/resData/resForm/tax_vat_amt" format="(-)#,###" appearance="output" maxlength="10" style="left:90px; top:110px; width:95px; height:18px; text-align:right; background-color:#eeeeee; "/>
			<caption id="caption72" class="list_cap03" style="left:694px; top:56px; width:85px; height:26px; border-style:solid; ">품    목</caption>
			<caption id="caption83" class="list_cap03" style="left:229px; top:106px; width:85px; height:26px; border-style:solid; ">변 경 자</caption>
			<output id="input51" ref="/root/resData/resForm/chg_dt" format="yyyy-mm-dd" appearance="output" maxlength="10" style="left:318px; top:135px; width:76px; height:18px; text-align:center; background-color:#eeeeee; "/>
			<output id="input41" ref="/root/resData/resForm/tot_amt" format="(-)#,###" appearance="output" maxlength="10" style="left:90px; top:135px; width:95px; height:18px; text-align:right; background-color:#eeeeee; "/>
			<caption id="caption73" class="list_cap03" style="left:460px; top:131px; width:85px; height:26px; border-style:solid; ">재발행사유</caption>
			<output id="input52" ref="/root/resData/resForm/chg_pers" appearance="output" maxlength="10" style="left:318px; top:110px; width:55px; height:18px; text-align:center; background-color:#eeeeee; "/>
			<caption id="caption52" class="list_cap03" style="left:0px; top:0px; width:85px; height:26px; border-style:solid; ">계산서번호</caption>
			<output id="input31" ref="/root/resData/resForm/ern" appearance="output" maxlength="10" style="left:90px; top:35px; width:115px; height:18px; text-align:center; background-color:#eeeeee; "/>
			<output id="input21" ref="/root/resData/resForm/slip_seq" appearance="output" maxlength="4" style="left:164px; top:4px; width:30px; height:18px; text-align:center; "/>
			<caption id="caption1" class="list_cap03" style="left:460px; top:0px; width:85px; height:26px; border-style:solid; ">전표구분</caption>
			<caption id="caption54" class="list_cap03" style="left:0px; top:81px; width:85px; height:26px; border-style:solid; ">공급가액</caption>
			<output id="input22" ref="/root/resData/resForm/tax_suply_amt" format="(-)#,###" appearance="output" maxlength="10" style="left:90px; top:85px; width:95px; height:18px; text-align:right; background-color:#eeeeee; "/>
			<input id="input44" ref="/root/resData/resForm/titl" class="req" navindex="11" caption="품목" style="left:783px; top:60px; width:132px; height:18px; "/>
			<caption id="caption2" class="list_cap03" style="left:229px; top:0px; width:85px; height:26px; border-style:solid; ">증빙유형</caption>
			<select1 id="combo1" ref="/root/resData/resForm/erplace_cd" class="req" navindex="9" appearance="minimal" caption="사업장코드" style="left:318px; top:35px; width:112px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/erplace_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<caption id="caption55" class="list_cap03" style="left:460px; top:31px; width:85px; height:26px; border-style:solid; ">거래처명</caption>
			<input id="input23" ref="/root/resData/resForm/dlco_cd" class="req" navindex="10" inputtype="button" maxlength="8" caption="거래처코드" style="left:549px; top:35px; width:75px; height:18px; "/>
			<output id="input34" ref="/root/resData/resForm/vexc_cmpy_cd" visibility="hidden" appearance="output" maxlength="10" style="left:850px; top:160px; width:65px; height:18px; background-color:#eeeeee; "/>
			<output id="input45" ref="/root/resData/resForm/issu_tms" appearance="output" style="left:783px; top:135px; width:27px; height:18px; background-color:#eeeeee; "/>
			<output id="input24" ref="/root/resData/resForm/dlco_nm" inputtype="button" appearance="output" style="left:628px; top:35px; width:182px; height:18px; "/>
			<caption id="caption56" class="list_cap03" style="left:0px; top:56px; width:85px; height:26px; border-style:solid; ">대표자명</caption>
			<caption id="caption67" class="list_cap03" style="left:460px; top:56px; width:85px; height:26px; border-style:solid; ">종    목</caption>
			<input id="input25" ref="/root/resData/resForm/remk" navindex="12" maxlength="10" style="left:549px; top:110px; width:136px; height:18px; "/>
			<caption id="caption68" class="list_cap03" style="left:229px; top:56px; width:85px; height:26px; border-style:solid; ">업    태</caption>
			<caption id="caption79" class="list_cap03" style="left:694px; top:0px; width:85px; height:26px; border-style:solid; ">작성일자</caption>
			<input id="input47" ref="/root/resData/resForm/make_dt" navindex="8" inputtype="date" maxlength="10" format="yyyy-mm-dd" caption="작성일자" style="left:783px; top:4px; width:87px; height:18px; text-align:center; "/>
			<caption id="caption47" class="list_cap03" style="left:0px; top:156px; width:85px; height:26px; border-style:solid; ">행 사 명</caption>
			<output id="input15" ref="/root/resData/resForm/evnt_nm" appearance="output" style="left:189px; top:160px; width:259px; height:18px; background-color:#eeeeee; "/>
			<caption id="caption58" class="list_cap03" style="left:229px; top:81px; width:85px; height:26px; border-style:solid; ">발 행 자</caption>
			<output id="input26" ref="/root/resData/resForm/presi_nm" appearance="output" maxlength="10" style="left:90px; top:60px; width:95px; height:18px; background-color:#eeeeee; "/>
			<output id="input37" ref="/root/resData/resForm/item" appearance="output" maxlength="10" style="left:549px; top:60px; width:112px; height:18px; background-color:#eeeeee; "/>
			<caption id="caption69" class="list_cap03" style="left:460px; top:81px; width:85px; height:26px; border-style:solid; ">주    소</caption>
			<output id="input48" ref="/root/resData/resForm/chg_pers_nm" appearance="output" maxlength="10" style="left:377px; top:110px; width:71px; height:18px; text-align:center; background-color:#eeeeee; "/>
			<output id="input16" ref="/root/resData/resForm/slip_occr_dt" format="yyyy-mm-dd" inputtype="date" appearance="output" maxlength="10" style="left:90px; top:4px; width:70px; height:18px; text-align:center; "/>
			<output id="input27" ref="/root/resData/resForm/issu_pers_emp_no" appearance="output" maxlength="10" style="left:318px; top:85px; width:55px; height:18px; text-align:center; background-color:#eeeeee; "/>
			<caption id="caption59" class="list_cap03" style="left:229px; top:31px; width:85px; height:26px; border-style:solid; ">사 업 장</caption>
			<output id="input38" ref="/root/resData/resForm/bizcond" appearance="output" maxlength="10" style="left:318px; top:60px; width:112px; height:18px; background-color:#eeeeee; "/>
			<caption id="caption16" class="list_cap03" style="left:694px; top:106px; width:85px; height:26px; border-style:solid; ">취소일자</caption>
			<output id="input28" ref="/root/resData/resForm/issu_pers_emp_nm" appearance="output" maxlength="10" style="left:377px; top:85px; width:71px; height:18px; text-align:center; background-color:#eeeeee; "/>
			<select1 id="combo6" ref="/root/resData/resForm/slip_clsf_cd" class="req" navindex="7" appearance="minimal" caption="전표구분" style="left:549px; top:4px; width:132px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/slip_clsf_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<output id="input39" ref="/root/resData/resForm/addr" appearance="output" maxlength="10" style="left:549px; top:85px; width:366px; height:18px; background-color:#eeeeee; "/>
			<caption id="caption17" class="list_cap03" style="left:694px; top:131px; width:85px; height:26px; border-style:solid; ">발행횟수</caption>
			<output id="input3" ref="/root/resData/resForm/evnt_cd" appearance="output" maxlength="10" style="left:90px; top:160px; width:95px; height:18px; text-align:center; background-color:#eeeeee; "/>
			<select1 id="combo7" ref="/root/resData/resForm/prof_type_cd" class="req" navindex="6" appearance="minimal" caption="증빙유형" style="left:318px; top:4px; width:132px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/prof_type_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<output id="output1" ref="/root/resData/resForm/canc_dt" format="yyyy-mm-dd" appearance="output" maxlength="10" style="left:783px; top:110px; width:76px; height:18px; text-align:center; background-color:#eeeeee; "/>
			<select1 id="combo8" ref="/root/resData/resForm/re_issu_resn_cd" navindex="13" appearance="minimal" style="left:549px; top:135px; width:112px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/re_issu_resn/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<output id="output2" ref="/root/resData/resForm/email" appearance="output" maxlength="50" style="left:550px; top:160px; width:295px; height:18px; background-color:#eeeeee; "/>
			<caption id="caption18" class="list_cap03" style="left:460px; top:155px; width:85px; height:26px; border-style:solid; ">EMail_Id</caption>
		</group>
		<datagrid id="grd_detail" nodeset="/root/resData/gridData/gridData3/record" visibility="hidden" caption="수입발생일자^수입발생일련번호^수입제목^수입금액^부가세" colsep="#" colwidth="100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowheight="20" rowsep="|" style="left:215px; top:215px; width:525px; height:80px; ">
			<col ref="occr_dt"/>
			<col ref="occr_seq"/>
			<col ref="titl"/>
			<col ref="reven_amt"/>
			<col ref="vat_amt"/>
		</datagrid>
	</xhtml:body>
</xhtml:html>
