<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<fac_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</fac_clsf>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						<login_info>
							<fac_clsf/>
							<dan_yn/>
						</login_info>
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<searchData>
							<inout_clsf/>
							<fac_clsf_fr/>
							<fac_clsf_to/>
							<inout_dt/>
							<fac_clsf/>
							<magam_dt/>
							<slip_proc_occr_dt/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seqfr/>
							<slip_seqto/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqForm>
							<magam_yn/>
							<somo/>
							<totSumWgt/>
							<pajiArg1/>
							<pajiArg2/>
							<argWgt/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seqfr/>
							<slip_seqto/>
							<clgbcd/>
						</reqForm>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<multiUpDate/>
						<!-- MultiUpDate유형 사용시 처리 -->
						<fwdData>
						</fwdData>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<fc_acct_2272_s>
								<dataSet/>
							</fc_acct_2272_s>
						</resForm>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<msg/>
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<sub>
								<record>
									<title/>
									<befor_roll/>
									<befor_wgt/>
									<purc_uprc/>
									<roll/>
									<wgt/>
									<amt/>
									<tot_jgroll/>
									<tot_jgwgt/>
									<tot_jgamt/>
									<cut_err_tms/>
									<matr_cd/>
									<grp/>
									<vat/>
								</record>
							</sub>
							<!-- datagrid2 -->
							<!-- datagrid3 -->
						</gridData>
						<gridData2>
							<main>
								<record>
									<issu_dt/>
									<medi_cdnm/>
									<sect_cdnm/>
									<pap_std/>
									<issu_pcnt/>
									<bw_pcnt/>
									<clr_pcnt/>
									<slip_qty/>
									<prt_wgt/>
								</record>
							</main>
						</gridData2>
						<dataSet/>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					function InitPage(){
						model1.copyNode("/root/initData/pageInfo",parent.root.initData.pageInfo);  
							
						model1.setValue("/root/reqData/searchData/inout_dt", getDate("yyyymmdd"));
						input1.refresh();
						input1.dispatch("xforms-value-changed");
							 
					 	model1.send("mt_papinout_2200");
						
						model1.copyNode("/root/initData/comboSet/fac_clsf", "/root/tempData/fac_clsf");
						model1.setValue("/root/initData/login_info/fac_clsf",   model1.getValue("/root/tempData/login_fac_clsf"));
						model1.setValue("/root/initData/login_info/dan_yn",    model1.getValue("/root/tempData/login_chk_yn"));
					   		
					   		
						InitPageSetting();     // 로그인 부서에 따른 환경 설정
					   		
					}
					
					function InitPageSetting(){
					   	
					   		model1.makeNode("/root/initData/comboSet/inout_clsf/item[1]");
					   		model1.makeNode("/root/initData/comboSet/inout_clsf/item[1]/value");
					   		model1.makeNode("/root/initData/comboSet/inout_clsf/item[1]/label");
					   		
					   		model1.setValue("/root/initData/comboSet/inout_clsf/item[1]/value" , "1");
					   		model1.setValue("/root/initData/comboSet/inout_clsf/item[1]/label" , "1.  입고");
					   		
					   		model1.makeNode("/root/initData/comboSet/inout_clsf/item[2]");
					   		model1.makeNode("/root/initData/comboSet/inout_clsf/item[2]/value");
					   		model1.makeNode("/root/initData/comboSet/inout_clsf/item[2]/label");
					   		
					   		model1.setValue("/root/initData/comboSet/inout_clsf/item[2]/value" , "2");
					   		model1.setValue("/root/initData/comboSet/inout_clsf/item[2]/label" , "2.  출고");
					   		
					   		if( model1.getValue("/root/initData/login_info/dan_yn") == 'Y'){
					   			model1.makeNode("/root/initData/comboSet/inout_clsf/item[3]");
						   		model1.makeNode("/root/initData/comboSet/inout_clsf/item[3]/value");
						   		model1.makeNode("/root/initData/comboSet/inout_clsf/item[3]/label");
						   		
						   		model1.setValue("/root/initData/comboSet/inout_clsf/item[3]/value" , "3");
						   		model1.setValue("/root/initData/comboSet/inout_clsf/item[3]/label" , "3.  전출입");
					   		}
					   		
					   		model1.setValue("/root/reqData/searchData/inout_clsf", "1");
					   		model1.setValue("/root/reqData/searchData/inout_dt", getDate("yyyymmdd") - 1); //입출고일자-입고선택일 경우 전일
							
					   		combo3.refresh();
							input1.refresh();
					   		comboSelectValue();       // 분공장 - 자재팀에 따른 콤보 선택 여부 
					   		if( model1.getValue("/root/initData/login_info/dan_yn") != 'Y'){
					   		     datagridVisibleChk();      // 데이터 그리드 숨김 체크
					   		}
					   		var cnt = 0;
							   	
						   	for( var i = 1 ; i < datagrid1.cols; i++){
						   		var hiddenChk = datagrid1.colHidden(i);
						   		
						   		//alert(datagrid1.colHidden(i));
						   		if( hiddenChk == false){
						   			cnt = cnt + 1;
						   		}
						   	}
							   	
					 
						   	for( var i = 1 ; i < datagrid1.cols; i++){
						   		datagrid1.colWidth(i) = 845 / cnt;
						   	}
							   	
					               datagrid1.refresh();
					   		//buttonSet();
					   		
					   }
					   function Fact_MaganChk(arg){
					   	     model1.makeNode("/root/reqData/searchData/job_clsf");
					   	     
					   	     model1.setValue("/root/reqData/searchData/job_clsf", arg);
					   	     
					   	     if( arg == 'S'){
					   	     		model1.send("mt_papinout_2218");
					   	     }else if( arg == 'A'){
					   	     		model1.send("mt_papinout_2219");
					   	     }	
					   	     else {
					   	     	
					   	     	model1.send("mt_papinout_2217");
					   	     }
					   	     
					   	     model1.destroy("/root/reqData/searchData/job_clsf");
					   }
					   
					   function OutClose_chk(arg){
					   	     model1.makeNode("/root/reqData/searchData/job_clsf");
					   	     
					   	     model1.setValue("/root/reqData/searchData/job_clsf", arg);
					   	     
					   	     model1.send("mt_papinout_2226");
					   	     
					   	     if(submit_completed()) {
					   	     	model1.destroy("/root/reqData/searchData/job_clsf");
					   	     	if (arg == "I") {
									alert("출고마감 처리가 되었습니다.");
					   		     } else {
					   		     	alert("출고마감 취소 처리가 되었습니다.");
					   		     }
								//button3.dispatch("onclick");
							}
					   	     
					   }
					   
					   function  comboSelectValue(){    // 분공장 - 자재에 따른 콤보 선택 크여부 
					   	      
					   		var fac_clsf = model1.getValue("/root/initData/login_info/fac_clsf");    //  분공장 : N 자재팀 :Y
					   		var dan_yn = model1.getValue("/root/initData/login_info/dan_yn");    //  분공장 : N 자재팀 :Y
					   		var inout_clsf = model1.getValue("/root/reqData/searchData/inout_clsf");
					   		
					   		if( inout_clsf == '1' || inout_clsf == '2'){
					   			if( fac_clsf != '' ){
					   				model1.setValue("/root/reqData/searchData/fac_clsf_to", fac_clsf );
					   				combo1.refresh();
					   				combo1.disabled = true;
					   			}
					   			else {
					   				combo1.disabled = false;
					   			}
					   			combo2.disabled = true;
					   		}
					   		combo1.refresh();
					   		combo2.refresh();
					   		combo3.refresh();
					   		
					   }
					   function datagridVisibleChk(){
							   	datagrid1.colHidden(4) = true;
							   	datagrid1.colHidden(7) = true;
							   	datagrid1.colHidden(10) = true;
							   	datagrid1.colHidden(14) = true;
					   }
					   
					   function buttonSet(){
					   		if( model1.getValue("/root/initData/login_info/dan_yn") != 'Y'){ 
					   		                  button2.disabled = true;
					   		                  button3.disabled = true;
					   		                  button4.disabled = false;
					   		                  button5.disabled = true;
					   		}else  {
					   		                  button2.disabled = false;
					   		                  button3.disabled = false;
					   		                  button4.disabled = true;
					   		                  button5.disabled = false;
					   		}
					   		group3.refresh();
					   }

					function gridata1SetValue(arg){
						var gubun = arg;
						var inout_clsf = model1.getValue("/root/reqData/searchData/inout_clsf");
						var sumWgt   = 0 ;
						
						if ( arg == '1')   { //입고 조회
							subTotalClear();
							model1.send("mt_papinout_2206");
							model1.copyNode("/root/resData/gridData/sub", "/root/tempData/gridData");
					   		 
							datagrid1.refresh();
							subTotal();
							datagrid1.rebuildStyle(2,5,datagrid1.rows,11);
							datagrid1.colType(5) 	= "input";
							datagrid1.colType(6) 	= "input";
							
							var slip_occr_dt = model1.getValue("/root/tempData/slip_occr_dt");
					          
							if( slip_occr_dt == '99999999'){
					               	model1.setValue("/root/reqData/reqForm/magam_yn" , 'N');
					               	model1.setValue("/root/reqData/searchData/magam_dt", getDate("yyyymmdd"));
					               	input2.disabled = false;
							} else {
					               	model1.setValue("/root/reqData/reqForm/magam_yn" , 'Y');
					               	model1.setValue("/root/reqData/searchData/magam_dt", slip_occr_dt );
					               	input2.disabled = true;
							}
							
							model1.setValue("/root/reqData/reqForm/somo", model1.getValue("/root/tempData/prt_wgt"));
							
							for ( var i = 2 ; i < datagrid1.rows ; i++){
								if ( datagrid1.valueMatrix(i, 1) == '소계' || datagrid1.valueMatrix(i,1) == '총계'){
									continue;
								} else {
									var roll =  datagrid1.valueMatrix(i,5);
									var wgt = datagrid1.valueMatrix(i,6);
									
									if( Number(roll) != 0  || Number(wgt) != 0 ) {
										datagrid1.isReadOnly(i, 5) = true;
										datagrid1.isReadOnly(i, 6) = true;
									}  else {
										datagrid1.isReadOnly(i, 5) = false;
										datagrid1.isReadOnly(i, 6) = false;
									}
								}
							}   // FOR END 
							datagrid1.colType(8) = "output" ;
							datagrid1.colType(9) = "output" ;
							datagrid1.colType(11) = "output";
						} else if ( arg == '2')   { //출고 조회
							subTotalClear();
							model1.send("mt_papinout_2207");
							model1.copyNode("/root/resData/gridData/sub", "/root/tempData/gridData");
							
							datagrid1.refresh();
							
							datagrid1.rebuildStyle(2,5,datagrid1.rows,11);
							datagrid1.colType(5)  = "output" ;
							datagrid1.colType(6)  = "output" ;
							datagrid1.colType(8)  = "input" ;
							datagrid1.colType(9)  = "input" ;
							datagrid1.colType(11) = "input";
				   	          
							var slip_occr_dt = model1.getValue("/root/tempData/slip_occr_dt");
					          
							if( slip_occr_dt == '99999999'){
					               	model1.setValue("/root/reqData/reqForm/magam_yn" , 'N');
					               	model1.setValue("/root/reqData/searchData/magam_dt", getDate("yyyymmdd"));
					               	input2.disabled = false;
							} else {
					               	model1.setValue("/root/reqData/reqForm/magam_yn" , 'Y');
					               	model1.setValue("/root/reqData/searchData/magam_dt", slip_occr_dt );
					               	input2.disabled = true;
							}
							
							model1.setValue("/root/reqData/reqForm/somo", model1.getValue("/root/tempData/prt_wgt"));
				   	          
				   	          
							for ( var i = 2 ; i < datagrid1.rows ; i++){
								var jegoState = datagrid1.valueMatrix(i, 2);
								var wgt = datagrid1.valueMatrix(i, 6);
								
								if ( Number(jegoState) == 0 ){
									datagrid1.isReadOnly( i , 8 ) = true;
									datagrid1.isReadOnly( i , 9 ) = true;
									datagrid1.isReadOnly( i , 11 ) = true;
								} else if( Number(jegoState) > 0) {
									datagrid1.isReadOnly( i , 8 ) = false;
									datagrid1.isReadOnly( i , 9 ) = false;
									datagrid1.isReadOnly( i , 11 ) = false;
									/*
									if( Number(wgt) > 0 ){
					   	                		//삭제 후 입력 
										datagrid1.colType(8)  = "output" ;
										datagrid1.colType(9)  = "output" ;
										datagrid1.colType(11) = "output";
										break;
									} else {
										datagrid1.colType(8)  = "input" ;
										datagrid1.colType(9)  = "input" ;
										datagrid1.colType(11) = "input";
									}
									*/
									//else   if( Number(wgt) == 0 ){
									//	datagrid1.valueMatrix( i , 8 )   = 0;
									//	datagrid1.valueMatrix( i , 9 )   = 0;
									//	datagrid1.valueMatrix( i , 10 ) = 0;
									//}
								}	
							}   // FOR END 
							subTotal();
						} else if(arg == '3') {  // FROM 공장 전출분 조회 
							subTotalClear();
							model1.send("mt_papinout_2223");
							model1.copyNode("/root/resData/gridData/sub", "/root/tempData/gridData");
							
							datagrid1.refresh();
					   	         
							datagrid1.colType(5)  = "input" ;
							datagrid1.colType(6)  = "input" ;
							datagrid1.colType(8)  = "output" ;
							datagrid1.colType(9)  = "output" ;
							datagrid1.colType(11) = "input";
							
							var slip_occr_dt = model1.getValue("/root/tempData/slip_occr_dt");
					          
							if( slip_occr_dt == '99999999'){
					               	model1.setValue("/root/reqData/reqForm/magam_yn" , 'N');
					               	model1.setValue("/root/reqData/searchData/magam_dt", getDate("yyyymmdd"));
					               	input2.disabled = false;
							} else {
					               	model1.setValue("/root/reqData/reqForm/magam_yn" , 'Y');
					               	model1.setValue("/root/reqData/searchData/magam_dt", slip_occr_dt );
					               	input2.disabled = true;
							}
							
							model1.setValue("/root/reqData/reqForm/somo", model1.getValue("/root/tempData/prt_wgt"));
							
							for ( var i = 2 ; i < datagrid1.rows ; i++){
								var jegoState = datagrid1.valueMatrix(i, 8 );
								
								if ( Number(jegoState) == 0 ){
									datagrid1.isReadOnly( i , 5 ) = true;
									datagrid1.isReadOnly( i , 6) = true;
									datagrid1.isReadOnly( i , 11 ) = true;
								} 
								
								var wgt = datagrid1.valueMatrix(i, 6);
								   	                
								if( Number(wgt) != 0 ){
									//삭제 후 입력 
									datagrid1.colType(5)  = "output" ;
									datagrid1.colType(6)  = "output" ;
									datagrid1.colType(11) = "output";
									break;
								}
								   	               
							}   // FOR END 
							subTotal();    
						} else if(arg == '4') { // TO 공장 전입분 조회
							subTotalClear();
							model1.send("mt_papinout_2224");
							model1.copyNode("/root/resData/gridData/sub", "/root/tempData/gridData");
							
							datagrid1.refresh();
							datagrid1.colType(5)  = "input" ;
							datagrid1.colType(6)  = "input" ;
							datagrid1.colType(8)  = "output" ;
							datagrid1.colType(9)  = "output" ;
							datagrid1.colType(11) = "input";
							 	  
							var slip_occr_dt = model1.getValue("/root/tempData/slip_occr_dt");
					          
							if( slip_occr_dt == '99999999'){
					               	model1.setValue("/root/reqData/reqForm/magam_yn" , 'N');
					               	model1.setValue("/root/reqData/searchData/magam_dt", getDate("yyyymmdd"));
					               	input2.disabled = false;
							} else {
					               	model1.setValue("/root/reqData/reqForm/magam_yn" , 'Y');
					               	model1.setValue("/root/reqData/searchData/magam_dt", slip_occr_dt );
					               	input2.disabled = true;
							}
							
							model1.setValue("/root/reqData/reqForm/somo", model1.getValue("/root/tempData/prt_wgt"));
							
							for ( var i = 2 ; i < datagrid1.rows ; i++){
								var jegoState = datagrid1.valueMatrix(i, 8 );
								   	       	         if ( Number(jegoState) == 0 ){
								   	       	         		datagrid1.isReadOnly( i , 5 ) = true;
								   	       	         		datagrid1.isReadOnly( i , 6) = true;
								   	       	         		datagrid1.isReadOnly( i , 11 ) = true;
								   	       	         } 
					   	         					
								var wgt = datagrid1.valueMatrix(i, 6);
								
								if( Number(wgt) != 0 ){
								   	                		//삭제 후 입력 
								   	                		 datagrid1.colType(5)  = "output" ;
										   	                datagrid1.colType(6)  = "output" ;
										   	                datagrid1.colType(11) = "output";
										   	                break;
								}
							}   // FOR END 
							subTotal();    
						}
						datagrid1.refresh();
						
					}
					   
					    function  datareset(){
					   		var    inout_dt      = model1.getValue("/root/reqData/searchData/inout_dt");
					   		var    inout_clsf   = model1.getValue("/root/reqData/searchData/inout_clsf");
					   		var    fac_clsf_to  = model1.getValue("/root/reqData/searchData/fac_clsf_to");
					   		var    fac_clsf_fr   = model1.getValue("/root/reqData/searchData/fac_clsf_fr");
					   		
					   		button1.dispatch("onclick");
					   		
					   		model1.setValue("/root/reqData/searchData/inout_dt"   , inout_dt    );
					   		model1.setValue("/root/reqData/searchData/inout_clsf" , inout_clsf  );
							model1.setValue("/root/reqData/searchData/fac_clsf_to", fac_clsf_to );
							model1.setValue("/root/reqData/searchData/fac_clsf_fr", fac_clsf_fr );
							   
							if ( inout_clsf == 3 ) {
								combo2.disabled = false;
							} else {
								combo2.disabled = true;
							}
									
							combo2.refresh();
							
							if( inout_clsf == 1){
								 datagrid1.caption= "용지종류^전일재고^전일재고^단가^금일입고^금일입고^금일입고^금일재고^금일재고^금일재고^지절수^자재코드^그룹|용지종류^ROLL^중량^단가^ROLL^중량^금액^ROLL^중량^금액^지절수^자재코드^그룹";
							}
							else if(  inout_clsf == 2){
								 datagrid1.caption= "용지종류^전일재고^전일재고^단가^금일출고^금일출고^금일출고^금일재고^금일재고^금일재고^지절수^자재코드^그룹|용지종류^ROLL^중량^단가^ROLL^중량^금액^ROLL^중량^금액^지절수^자재코드^그룹";
							}
							else if(  inout_clsf == 3){
								 datagrid1.caption= "용지종류^전일재고^전일재고^단가^금일전출^금일전출^금일전출^금일재고^금일재고^금일재고^지절수^자재코드^그룹|용지종류^ROLL^중량^단가^ROLL^중량^금액^ROLL^중량^금액^지절수^자재코드^그룹";
							}
							datagrid1.refresh();
							group2_Set();
					    }
					    
					    function valueChk(row, col){
					    	 
					    		 var ystRoll = datagrid1.valueMatrix(row, 8 ) ;
					    		 var ystWgt = datagrid1.valueMatrix(row, 9);
					    		 var baseWgt = datagrid1.valueMatrix(row, 15);
					    		 
					    		 if (  ( Number(ystRoll) > 0 ) && ( Number(ystWgt)  > 0 ) ) {
					    		            		var fac_clsf = model1.getValue("/root/reqData/searchData/fac_clsf_to");
					    		            		if ( fac_clsf == '10' || fac_clsf == '25' || fac_clsf == '20' || fac_clsf == '22' ){
					    		            			
					    		           		        res = Math.round( Number( ystWgt)  / Number( baseWgt ));
					    		           		       //alert(ystRoll + "-" + res + "=" + Math.abs( Number(ystRoll) - Number(res) ) );
						    		            		if( Math.abs( Number(ystRoll) - Number(res) ) > 1 ) {
						    		            			if ( window.alert("Roll 수 : " + Math.abs( Number(ystRoll) - Number(res) ) + " Roll 오류 \n 진행하시겠습니까?", "조선일보 MIS", 1) != 1){ 
						    		            					datagrid1.valueMatrix(row, col) = '0';
						    		            					
						    		            			}
						    		            		}
						    		              }
					    		} // if end
					    }// function end
					    
					    function input_btn_1(){
					    		model1.setValue("/root/reqData/searchData/fac_clsf",   model1.getValue("/root/reqData/searchData/fac_clsf_to"));
					    		model1.makeNode("/root/reqData/searchData/inout_fac_clsf");
					    		model1.makeNode("/root/reqData/searchData/tot_roll");
					    		
					    		if ( model1.getValue("/root/reqData/searchData/inout_clsf") == '3' ) {
						    		model1.setValue("/root/reqData/searchData/inout_fac_clsf" ,    model1.getValue("/root/reqData/searchData/fac_clsf_fr"));
						    		
						    		if ( model1.getValue("/root/reqData/searchData/fac_clsf") == model1.getValue("/root/reqData/searchData/inout_fac_clsf")){
						    			alert("창고From과 창고To가 같을 수 없습니다");
						    			return false;
						    		}
								}
					    		else {
					    			model1.setValue("/root/reqData/searchData/inout_fac_clsf" ," ");
					    		}
					    		
					    		if ( datagridChk_1() == false ) {
						    			return false;
						    	}
								for ( var i =2 ; i < datagrid1.rows; i++){
					    			if ( datagrid1.rowStatus(i) == 1 ) 
									{
										
										var matr_cd = datagrid1.valueMatrix(i, 12);
										var amt = datagrid1.valueMatrix(i, 7);
										
										if ( amt.length > 0 ) {
											if(datagrid1.valueMatrix(i , 14) == 0 || datagrid1.valueMatrix(i , 14) =="")
											{
												alert("부가세가 입력되지 않았습니다. MIS개발팀에 문의하세요."+matr_cd);
												return false;
											}
										}
										
									}
					    		}	
								
						    	if ( window.alert("내역을 입력 하시겠습니까?", "조선일보 MIS", 1) != 1){
						    		  return false;
						    	}
						    	
						    	var mulidataStr = datagrid1.getUpdateData();
									        
						        model1.makeNode("/root/reqData/searchData/multiUpdateData");
						        
						        model1.setValue("/root/reqData/searchData/multiUpdateData", mulidataStr);
						        model1.send("mt_papinout_2201");
						        
						        return true;
					    		
					    }
					    
					    function datagridChk_1(){
					    		var cnt = 0;
					    		var totRoll = 0;
					    		var sport_C = 0;
								//var cc = datagrid1.rows;
					    		//model1.alert(cc);
					    		for (var i = 2; i < datagrid1.rows; i++){
					    			 
													//var bb = datagrid1.rowStatus(i);
													//model1.alert(i + "==" + bb);
					    			if (  ( datagrid1.valueMatrix(i, 1 ) != '소계' ) && (datagrid1.valueMatrix(i,1) != '총계') ) {
					    				     if( datagrid1.rowStatus(i) == 2  ||  datagrid1.rowStatus(i) == 1 ||  datagrid1.rowStatus(i) == 3){
					    			           		datagrid1.rowStatus(i)  =  1;
					    			           		//부가세 셋팅 
					    			           		//var tax = Math.round(Number( datagrid1.valueMatrix(i, 7) ) * 0.1); 20100715 조동환과장님 요청으로 버림으로 변경
													var tax = Math.floor(Number( datagrid1.valueMatrix(i, 7) ) * 0.1);
					    			           	       datagrid1.valueMatrix(i , 14) =   tax ;
													   
													//var aa = Number( datagrid1.valueMatrix(i, 7) );   
													//var bb = datagrid1.rowStatus(i);
													//	model1.alert(aa + "==" + bb);
													
					    			           		totRoll = totRoll + Number(datagrid1.valueMatrix(i, 5));   // 비축 ROLL 업데이트를 위한 롤 합계
					    			           		var matr_cd = datagrid1.valueMatrix(i, 12);
					    			           		
					    			           		if( matr_cd == '1101705'  || matr_cd == '1102700' || matr_cd == '1105105' || matr_cd == '1106105' ){
					    			           			sport_C = sport_C + 1 ;
					    			           		}	
					    			           }
					    			}
					    		}
					    		datagrid1.refresh();
					    		
					    		for ( var i =2 ; i < datagrid1.rows; i++){
					    			if ( datagrid1.rowStatus(i) == 1 ) cnt = cnt + 1;
					    		}	
					    			
					    		if ( cnt == 0 ) {
					    			alert("입력 할 데이터가 없습니다.");
					    			return false;
					    		}
					    		
					    		model1.setValue("/root/reqData/searchData/tot_roll" , totRoll);
 					    		model1.send("mt_papinout_2208");
 					    		
 					    	       var resSport = model1.getValue("/root/tempData/prt_wgt");
 					    	       
 					    	       if( Number(resSport)  > 0 ) {
 					    	       		if( sport_C == 0 ) {
    				    	       			       alert("[스포츠 C권 입고 오류]");
   				    	       			       return false;
 					    	       		}
   				    	              }
					    	       
					    	       return true;
						}
						
						function input_btn_2(){
							var inputCnt   = 0 ;
							var tot_62_roll = 0;
							var tot_31_roll = 0;
							var fac_clsf = model.getValue("/root/reqData/searchData/fac_clsf_to");
							var sumWgt = 0;
					    	        
							model1.makeNode("/root/reqData/searchData/inout_fac_clsf");
					    	        
							//STEP 1 금일 재고 = 0 이면 전일 재고를 금일 출고에 SETTING 
							for ( var i = 2 ; i < datagrid1.rows;i++){
								//if ( datagrid1.rowStatus(i) == 2 ){
								var ystRoll = datagrid1.valueMatrix(i, 2);
								var ystWgt = datagrid1.valueMatrix(i, 3);
								var todRoll = datagrid1.valueMatrix(i, 8);
								var dan     = datagrid1.valueMatrix(i, 4);
					    					
								if( Number(ystRoll) > 0  &&  Number(todRoll) == 0 && datagrid1.valueMatrix(i, 12).length> 0){
									datagrid1.valueMatrix(i, 5 ) = ystRoll;
									datagrid1.valueMatrix(i, 6 ) = ystWgt;
									datagrid1.valueMatrix(i, 7 ) = Math.floor( Number(ystWgt) * Number(dan));
									datagrid1.rowStatus(i) = 2;
								}
								//}
							} // for end
					    		
							var x = 0;
					    		
							for ( var i = 1 ; i < datagrid2.rows;i++){
								datagrid2.rowStatus(i)  = 1;
							}
					    		for ( var i = 2 ; i < datagrid1.rows;i++){
					    			//alert(datagrid1.rowStatus(i));
					    			if ( datagrid1.rowStatus(i) == 2 || datagrid1.rowStatus(i) == 1  || datagrid1.rowStatus(i) == 3 ){
					    				var  chkMoney = datagrid1.valueMatrix(i, 7 );
					    				var  tmpMoney = 0 ;
					    				
					    				datagrid1.rowStatus(i)  = 1;
					    				
					    				sumWgt = sumWgt + Number(datagrid1.valueMatrix( i , 6 ));
					    				tmpMoney =  Math.floor( Number( datagrid1.valueMatrix(i,4)) * Number( datagrid1.valueMatrix( i , 6 ) ) );
					    				if ( Number(chkMoney) != Number(tmpMoney) ){
					    					datagrid1.valueMatrix(i, 7 ) = tmpMoney;
					    				}
					    				var matr_cd = datagrid1.valueMatrix(i, 12) ;
					    				matr_cd = matr_cd.substr(4, 7 );
					    				
					    				if( matr_cd == '402' || matr_cd == '605' || matr_cd == '600' || matr_cd == '104' || matr_cd == '101'){   //   62
					    				 	tot_62_roll = tot_62_roll + Number(datagrid1.valueMatrix( i , 5 )) ;
					    				}
					    			        else {
					    			        	tot_31_roll = tot_31_roll + Number(datagrid1.valueMatrix( i , 5 )) ;
					    			        }
					    				
					    				var tax = Math.round(Number( datagrid1.valueMatrix(i, 7) ) * 0.1);
					    			        datagrid1.valueMatrix(i , 14) =   tax ;
					    			} // if end 
					    		}//for end 
					    		
					    		for ( var i =2 ; i < datagrid1.rows; i++){
					    			if ( datagrid1.rowStatus(i) == 1 ) inputCnt = inputCnt + 1;
					    		}	
					    		
					    		if(  inputCnt < 1 ) {
					    			alert("[입력할 자료없음]");
					    			return false;
					    		}
					    		
					    		if (fac_clsf < "30") {
						    		model1.send("mt_papinout_2209");
					    			
						    		if( Number(model1.getValue("/root/tempData/totalcnt")) == 0 )
						    		{
						    			alert("용지 총 소모 내역과 매체별 소모내역이 입력 되지 않았습니다.");
						    		}
						    		else{
					 	   			 var pcsim62cnt = model1.getValue("/root/tempData/pcsim62cnt");
					  	  			 var mssim62cnt = model1.getValue("/root/tempData/mssim62cnt");
					   	 			 var pcsim31cnt = model1.getValue("/root/tempData/pcsim31cnt");
					    				 var mssim31cnt = model1.getValue("/root/tempData/mssim31cnt");

                                                             if( ( Number(pcsim62cnt) - Number(mssim62cnt) - Number(tot_62_roll) < -5 )  && (Number(pcsim62cnt) - Number(mssim62cnt) - Number(tot_62_roll) > 5 ) ) {
                                                             	      alert("출고롤수와 본지스포츠분리등록 심봉62 갯수와 5개 이상 차이가 발생됨..!!");
                                                             }
                                                             if( ( Number(pcsim31cnt) - Number(mssim31cnt) - Number(tot_31_roll) < -5 )  && (Number(pcsim31cnt) - Number(mssim31cnt) - Number(tot_31_roll) > 5 ) ) {
                                                             	      alert("출고롤수와 본지스포츠분리등록 심봉31 갯수와 5개 이상 차이가 발생됨..!!");
                                                             }
					    			}
					    		}
					    	   	if ( Number(sumWgt) != Number(model1.getValue("/root/reqData/reqForm/somo")) ) {
					    		       alert("본사소모량과 출고중량이 다릅니다\n(" + sumWgt + ", " + model1.getValue("/root/reqData/reqForm/somo") + ")");
					    		 		return false;
						    	}
					    		
					    		if ( window.alert("내역을 입력 하시겠습니까?", "조선일보 MIS", 1) != 1){
						    		  return false;
						    	}
						    	model1.setValue("/root/reqData/searchData/inout_fac_clsf", " ");
					    		
					    		var mulidataStr = datagrid1.getUpdateData();
					    		var mulidataStr2 = datagrid2.getUpdateData();
							
							//alert(mulidataStr2);
								var tot_jgwgt = datagrid1.valueMatrix(datagrid1.rows - 1 , datagrid1.colRef("tot_jgwgt"));
								
						        model1.makeNode("/root/reqData/searchData/multiUpdateData");
						        model1.makeNode("/root/reqData/searchData/multiUpdateData2");
						        model1.makeNode("/root/reqData/searchData/tot_jgwgt");
								
						        model1.setValue("/root/reqData/searchData/multiUpdateData", mulidataStr);
						        model1.setValue("/root/reqData/searchData/multiUpdateData2", mulidataStr2);
								model1.setValue("/root/reqData/searchData/tot_jgwgt", tot_jgwgt);
					    		model1.send("mt_papinout_2202");
					    		return true;
					    		//model1.destroy("/root/reqData/searchData/multiUpdateData");
					    		//model1.destroy("/root/reqData/searchData/multiUpdateData2");
					    		
					    }
					    
					    
					   function  group2_Set(){
					    		var inout_dt    = model1.getValue("/root/reqData/searchData/inout_dt");
					    		var fac_clsf    = model1.getValue("/root/reqData/searchData/fac_clsf_fr");
					    		var inout_clsf = model1.getValue("/root/reqData/searchData/inout_clsf");
					    		
					    		model1.makeNode("/root/resData/resForm/inout_dt");
					    		model1.makeNode("/root/resData/resForm/fac_clsf");
					    		model1.makeNode("/root/resData/resForm/inout_clsf");
					    		
					    		model1.setValue("/root/resData/resForm/inout_dt"    ,  inout_dt);
					    		model1.setValue("/root/resData/resForm/fac_clsf"    ,  fac_clsf);
					    		model1.setValue("/root/resData/resForm/inout_clsf" ,  inout_clsf );
					    		
					    		model1.send("mt_papinout_2211");
					    		 
					    		model1.destroy("/root/resData/resForm/inout_dt");
					    		model1.destroy("/root/resData/resForm/fac_clsf");
					    		model1.destroy("/root/resData/resForm/inout_clsf");
					               
					               var slip_occr_dt = model1.getValue("/root/tempData/slip_occr_dt");
					               
					               if( slip_occr_dt == '99999999'){
					               	model1.setValue("/root/reqData/reqForm/magam_yn" , 'N');
					               	model1.setValue("/root/reqData/searchData/magam_dt", getDate("yyyymmdd"));
					               	input2.disabled = false;
					               } else {
					               	
					               	model1.setValue("/root/reqData/reqForm/magam_yn" , 'Y');
					               	model1.setValue("/root/reqData/searchData/magam_dt", slip_occr_dt );
					               	input2.disabled = true;
					               }
					               
					               model1.setValue("/root/reqData/reqForm/somo", model1.getValue("/root/tempData/prt_wgt"));
					               
					    		group2.refresh();
					    }
					    
					function subTotalClear(){
						datagrid1.subtotal("clear",-1,13);
					}
					
					function subTotal(){
						datagrid1.subtotal("sum", 13, 2, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "소계");
						datagrid1.subtotal("sum", 13, 3, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "소계");
						datagrid1.subtotal("sum", 13, 5, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "소계");
						datagrid1.subtotal("sum", 13, 6, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "소계");
						datagrid1.subtotal("sum", 13, 7, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "소계");
						datagrid1.subtotal("sum", 13, 8, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "소계");
						datagrid1.subtotal("sum", 13, 9, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "소계");
						datagrid1.subtotal("sum", 13, 10, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "소계");
						datagrid1.subtotal("sum", 13, 11, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "소계");
					    	 
						datagrid1.subtotal("sum", -1, 2, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "총계");
						datagrid1.subtotal("sum", -1, 3, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "총계");
						datagrid1.subtotal("sum", -1, 5, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;",1, "총계");
						datagrid1.subtotal("sum", -1, 6, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "총계");
						datagrid1.subtotal("sum", -1, 7, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;",1, "총계");
						datagrid1.subtotal("sum", -1, 8, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "총계");
						datagrid1.subtotal("sum", -1, 9, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "총계");
						datagrid1.subtotal("sum", -1, 10, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "총계");
						datagrid1.subtotal("sum", -1, 11, "(-)#,###", "background-color:#ffff00; font-weight:bold; color:#0000ff;", 1, "총계");
					} 	
				]]>
			</script>
			<submission id="mt_papinout_2200" action="/mt/papinout/2200" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="mt_papinout_2201" action="/mt/papinout/2201" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2202" action="/mt/papinout/2202" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2203" action="/mt/papinout/2203" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2204" action="/mt/papinout/2204" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2205" action="/mt/papinout/2205" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2206" action="/mt/papinout/2206" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2207" action="/mt/papinout/2207" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2208" action="/mt/papinout/2208" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2209" action="/mt/papinout/2209" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2210" action="/mt/papinout/2210" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2211" action="/mt/papinout/2211" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2212" action="/mt/papinout/2212" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2213" action="/mt/papinout/2213" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2214" action="/mt/papinout/2214" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2216" action="/mt/papinout/2216" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2217" action="/mt/papinout/2217" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2218" action="/mt/papinout/2218" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2219" action="/mt/papinout/2219" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2220" action="/mt/papinout/2220" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2223" action="/mt/papinout/2223" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2224" action="/mt/papinout/2224" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2225" action="/mt/papinout/2225" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_2226" action="/mt/papinout/2226" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="fc_acct_2263_i" action="/fc/acct2000/2263" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/dataSet"/>
			<submission id="fc_acct_2272_s" action="/fc/acct2000/2272" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm/fc_acct_2272_s/dataSet"/>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
		</model>
	</xhtml:head>
	<xhtml:body pagewidth="890" pageheight="575">
		<group id="group3" style="left:15px; top:5px; width:865px; height:25px; ">
			<button id="button1" class="btn02" CRUD="R" style="left:104px; top:2px; width:56px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model1.reset();
					InitPage();
					]]>
				</script>
			</button>
			<button id="button4" class="btn02" CRUD="C" style="left:437px; top:2px; width:54px; height:21px; ">
				<caption>공장마감</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					 		 Fact_MaganChk("I");
					]]>
				</script>
			</button>
			<button id="button5" class="btn04" CRUD="C" style="left:494px; top:2px; width:73px; height:21px; ">
				<caption>공장마감취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					 		 Fact_MaganChk('D');
					]]>
				</script>
			</button>
			<button id="btnA1" class="btn02" CRUD="R" style="left:160px; top:2px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						datagrid1.allStyle("data", "background-color") = "#FFFFFF";
						if(  commReqCheck(group2) == false ) return; //필수사항 CHK
				              
						var inout_clsf = model1.getValue("/root/reqData/searchData/inout_clsf");
						var fac_clsf = model1.getValue("/root/reqData/searchData/fac_clsf_to");
				              
						datagrid1.clearStatus();
				              
						if( inout_clsf == '1' || inout_clsf == '2') {   //전입 / 전출
							if( model1.getValue("/root/reqData/searchData/fac_clsf_to") == ''){
								alert( combo1.attribute("caption") + " 이 누락 되었습니다.");
								return;
				              	}
						} else if ( inout_clsf  == '3'){                    // 전출입 구분
							if( model1.getValue("/root/reqData/searchData/fac_clsf_to") == '' && model1.getValue("/root/reqData/searchData/fac_clsf_fr") =='' ) {
								alert( combo1.attribute("caption") + "또는 " +  combo2.attribute("caption") +  " 이 누락 되었습니다.");
								return;
							}
						}
				              
				              //datareset();     //발생일자별 마감 여부 및 본사 소모량 데이터 조회 
				              
						if ( inout_clsf  == '1' ){    // 전입분 조회 
							model1.setValue("/root/reqData/searchData/fac_clsf", model1.getValue("/root/reqData/searchData/fac_clsf_to"));
							gridata1SetValue(1);
						} else if ( inout_clsf  == '2' ) {    //전출분 조회
							model1.setValue("/root/reqData/searchData/fac_clsf", model1.getValue("/root/reqData/searchData/fac_clsf_to"));
							gridata1SetValue(2);
						} else if ( inout_clsf = '3'  ) {
							var fac_to = model1.getValue("/root/reqData/searchData/fac_clsf_to");
							var fac_fr  = model1.getValue("/root/reqData/searchData/fac_clsf_fr");
				              		 
							if( fac_fr != ''  && fac_to != '' ) {
								alert("창고From 및 창고To를 동시 선택시\n창고From에 대한 재고 내역을 조회합니다");
								model1.setValue("/root/reqData/searchData/fac_clsf", model1.getValue("/root/reqData/searchData/fac_clsf_fr"));
								gridata1SetValue(3);        //전출분조회
							} else if (fac_fr == ''  && fac_to != '') {
								model1.setValue("/root/reqData/searchData/fac_clsf", model1.getValue("/root/reqData/searchData/fac_clsf_to"));
								gridata1SetValue(4);       //전입분 조회
							} else if (fac_fr != ''  && fac_to == '') {
								model1.setValue("/root/reqData/searchData/fac_clsf", model1.getValue("/root/reqData/searchData/fac_clsf_fr"));
								gridata1SetValue(3);        //전출분조회
							}
						}
				              
						model1.copyNode("/root/resData/gridData2/main" ,"/root/tempData/gridData2");
						datagrid2.refresh();
				              //return;
				              
				              //model1.send("mt_papinout_2205");
				              //model1.copyNode("/root/resData/gridData2/main" ,"/root/tempData/gridData");
				              //datagrid2.refresh();
				              
						if (fac_clsf > "30"){
							datagrid2. colType(9) = "input";
						} else {
							datagrid2. colType(9) = "output";
						}
				              
						//총중량
						var totPrtSum = 0 ; 
						for(var i = 1 ; i < datagrid2.rows;i++){
							totPrtSum = totPrtSum + Number(datagrid2.valueMatrix(i, 9 ));
						}
						model1.setValue("/root/reqData/reqForm/totSumWgt", totPrtSum);
				              
						if( Number(model1.getValue("/root/reqData/searchData/fac_clsf_to") ) < 30 ) {
							//model1.send("mt_papinout_2214");
							model1.setValue("/root/reqData/reqForm/argWgt" ,  model1.getValue("/root/tempData/argWgt"));
							model1.setValue("/root/reqData/reqForm/pajiArg1" , model1.getValue("/root/tempData/argPaji1"));
							model1.setValue("/root/reqData/reqForm/pajiArg2","");
						}else {
							//model1.send("mt_papinout_2210");
							var tmpValue1 = Number(model1.getValue("/root/tempData/argPaji1")) / 100;
							var tmpValue2 = Number(model1.getValue("/root/tempData/argPaji2")) / 100;
				                                     
							model1.setValue("/root/reqData/reqForm/argWgt" ,   model1.getValue("/root/tempData/argWgt"));
							model1.setValue("/root/reqData/reqForm/pajiArg1" , tmpValue1);
							model1.setValue("/root/reqData/reqForm/pajiArg2",  tmpValue2);
						}
				 	      
						group1.refresh();
						datagrid1.refresh();
						
						if( model1.getValue("/root/reqData/searchData/inout_clsf") == '3'){
							if( model1.getValue("/root/reqData/searchData/fac_clsf_fr") == '' || model1.getValue("/root/reqData/searchData/fac_clsf_to") == '' ){
				 	      				 btnA2.disabled = true;
				 	      				 btnA3.disabled = true;
							} else {
				 	      				 btnA2.disabled = false;
				 	      				 btnA3.disabled = false;
							}
						}
						
						for (var i=1; i< datagrid1.rows;i++){
//							if (datagrid1.valueMatrix(i, 12) == "1101605" ||datagrid1.valueMatrix(i, 12) == "1101705"||datagrid1.valueMatrix(i, 12) == "1102600"||datagrid1.valueMatrix(i, 12) == "1102700"||datagrid1.valueMatrix(i, 12) == "1105104"||datagrid1.valueMatrix(i, 12) == "1105105"||datagrid1.valueMatrix(i, 12) == "1106101"||datagrid1.valueMatrix(i, 12) == "1106105") {
//								//datagrid1.cellstyle("background-color", i, 1, i, 1) = "#AAAAFF";
//								datagrid1.rowStyle(i, "data", "background-color") = "#AAAAFF";
//							}

							if (datagrid1.valueMatrix(i, 12) == "1101605" ||datagrid1.valueMatrix(i, 12) == "1101705") {
								//datagrid1.cellstyle("background-color", i, 1, i, 1) = "#AAAAFF";
								datagrid1.rowStyle(i, "data", "background-color") = "#FFFF99";
							}
							if (datagrid1.valueMatrix(i, 12) == "1102600"||datagrid1.valueMatrix(i, 12) == "1102700") {
								//datagrid1.cellstyle("background-color", i, 1, i, 1) = "#AAAAFF";
								datagrid1.rowStyle(i, "data", "background-color") = "#FF7C80";
							}
							if (datagrid1.valueMatrix(i, 12) == "1105104"||datagrid1.valueMatrix(i, 12) == "1105105") {
								//datagrid1.cellstyle("background-color", i, 1, i, 1) = "#AAAAFF";
								datagrid1.rowStyle(i, "data", "background-color") = "#AAAAFF";
							}

						}
				]]>
				</script>
			</button>
			<button id="btnA2" class="btn02" CRUD="C" style="left:328px; top:2px; width:52px; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(  commReqCheck(group2) == false ) return;
						
						if(  model1.getValue("/root/reqData/searchData/fac_clsf_to") == '' ) {
							alert( combo1.attribute("caption") + "이 누락 되었습니다.");
							return;
						}
						
						if(  inout_clsf == '3' ) {  // 전출입
							if( model1.getValue("/root/reqData/searchData/fac_clsf_fr") == '' ) {
								alert(combo2.attribute("caption") +  " 이 누락 되었습니다.");
								return;
							}
						}
						var inout_clsf = model1.getValue("/root/reqData/searchData/inout_clsf");
						if( inout_clsf != '2'){
							Fact_MaganChk("S");    // 공장 마감 여부 확인 
							
							var clos_dt = model1.getValue("/root/tempData/clos_proc_dt");
							   	 
							if( clos_dt != '99999999'){
								alert(clos_dt + "일 날짜로 공장 마감 된 데이터 입니다.\n 수정이 불가능 합니다.");
								return;
							}
								
							var magam_yn = model1.getValue("/root/reqData/reqForm/magam_yn");
								
							if( magam_yn == 'Y' ){    // 자재 마감 상태 확인 
								alert(model1.getValue("/root/reqData/searchData/magam_dt") + "일자로 자재마감 된 데이터 입니다. \n 수정이 불가능 합니다.");
									return;
							}  
						}
						
						var res = true;
						
						if( inout_clsf == '1' || inout_clsf == '3'){
							res =  input_btn_1();
						} else if ( inout_clsf == '2' ){
							res = input_btn_2();
						}
						if (res){
							if(submit_completed()) {
								btnA1.dispatch("onclick");
							}
						}
				]]>
				</script>
			</button>
			<button id="btnA3" class="btn02" CRUD="D" style="left:382px; top:2px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if(  commReqCheck(group2) == false ) return;
					var delCnt = 0 ;
					var delCnt2 = 0 ;
					
					var input_clsf = model1.getValue("/root/reqData/searchData/inout_clsf");
						
					if(  model1.getValue("/root/reqData/searchData/fac_clsf_to") == '' ) {
					      alert( combo1.attribute("caption") + "이 누락 되었습니다.");
					      return;
					}
						
					if( input_clsf != '2'){
						Fact_MaganChk("S");    // 공장 마감 여부 확인 
								
						var clos_dt = model1.getValue("/root/tempData/clos_proc_dt");
							   	 
						if( clos_dt != '99999999'){
							alert(clos_dt + "일 날짜로 공장 마감 된 데이터 입니다.\n 수정이 불가능 합니다.");
							return;
						}
						
						var magam_yn = model1.getValue("/root/reqData/reqForm/magam_yn");
								
						if( magam_yn == 'Y' ){
							alert(model1.getValue("/root/reqData/searchData/magam_dt") + "일자로 자재마감 된 데이터 입니다. \n 수정이 불가능 합니다.");
							return;
						}
					}
						
					if ( input_clsf == '1' || input_clsf == '3'){
						if ( input_clsf == '3') {
							if ( model1.getValue("/root/reqData/searchData/fac_clsf_fr") == '') {
								alert("창고가 선택 되지 않았습니다.");
								return;
							}
							alert("창고To에 대한 전입 내역을 삭제합니다.");
						}
							     
						for ( var i = 2; i < datagrid1.rows; i++){
							var roll = datagrid1.valueMatrix(i , 5) ;
							var wgt = datagrid1.valueMatrix(i , 6) ;
							var papKind  = datagrid1.valueMatrix(i, 1);
							     		
							if( papKind != '소계' && papKind != '총계' ) {
								if (  Number(roll) != 0  ) {
									datagrid1.rowStatus(i) = 4;
									delCnt = delCnt + 1;
								}
								if (  Number(wgt) != 0  ) {
									datagrid1.rowStatus(i) = 4;
									delCnt2 = delCnt2 + 1;
								}
							}
						}
						
						if ( delCnt+delCnt2 == 0 ){
							alert("삭제할 데이터가 없습니다.");
							return ;
						}
							     
						if ( window.alert(" [자료 삭제 경고]  \n삭제 하시겠습니까? " ,  "조선일보 MIS" , 1) != 1 ){
							return ;
						}
						model1.makeNode("/root/reqData/searchData/inout_fac_clsf");
						model1.setValue("/root/reqData/searchData/fac_clsf", model1.getValue("/root/reqData/searchData/fac_clsf_to"));
						
						if( input_clsf == '1') {
							model1.setValue("/root/reqData/searchData/inout_fac_clsf", " ");
							
						} else if(input_clsf == '3'){
							model1.setValue("/root/reqData/searchData/inout_fac_clsf",  model1.getValue("/root/reqData/searchData/fac_clsf_fr")) ;
						}
							     
						var mulidataStr = datagrid1.getUpdateData();
									        
						model1.makeNode("/root/reqData/searchData/multiUpdateData");
						        
						model1.setValue("/root/reqData/searchData/multiUpdateData", mulidataStr);
						model1.send("mt_papinout_2203");
						    	     
						model1.destroy("/root/reqData/searchData/multiUpdateData");
						model1.destroy("/root/reqData/searchData/inout_fac_clsf");
						    	     
						if(submit_completed()) {
							btnA1.dispatch("onclick");
						}
					} else if (input_clsf == '2') {
						for ( var i = 2; i < datagrid1.rows; i++){
							var roll = datagrid1.valueMatrix(i , 5) ;
							var papKind  = datagrid1.valueMatrix(i, 1);
							     		
							if( papKind != '소계' && papKind != '총계' ) { 
								if (  Number(roll) > 0  ) {
									datagrid1.rowStatus(i) = 4;
									delCnt = delCnt + 1;
								}
							}
						}
						
						for ( var i = 1; i < datagrid2.rows; i++){
							datagrid2.rowStatus(i) = 4;
						}
						
						if ( delCnt == 0 ){
							alert("삭제할 데이터가 없습니다.");
							return ;
						}
						if ( window.alert(" [자료 삭제 경고]  \n삭제 하시겠습니까? " ,  "조선일보 MIS" , 1) != 1 ){
							return ;
						}
						model1.makeNode("/root/reqData/searchData/inout_fac_clsf");
						model1.setValue("/root/reqData/searchData/fac_clsf", model1.getValue("/root/reqData/searchData/fac_clsf_to"));
						model1.setValue("/root/reqData/searchData/inout_fac_clsf", " ");
							     
						var mulidataStr	= datagrid1.getUpdateData();
						var mulidataStr2	= datagrid2.getUpdateData();       
						
						model1.makeNode("/root/reqData/searchData/multiUpdateData");
						model1.makeNode("/root/reqData/searchData/multiUpdateData2");
						
						model1.setValue("/root/reqData/searchData/multiUpdateData", mulidataStr);
						model1.setValue("/root/reqData/searchData/multiUpdateData2", mulidataStr2);
						model1.send("mt_papinout_2204");
						
						    	     //model1.destroy("/root/reqData/searchData/multiUpdateData");
						    	     //model1.destroy("/root/reqData/searchData/multiUpdateData2");
						    	     //model1.destroy("/root/reqData/searchData/inout_fac_clsf");
						    	     
						if(submit_completed()) {
							btnA1.dispatch("onclick");
						}
							     
					}
				]]>
				</script>
			</button>
			<button id="btnA4" class="btn02" style="left:812px; top:2px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					parent.window.javaScript.winClose();
					]]>
				</script>
			</button>
			<button id="button6" class="btn05" CRUD="R" style="left:215px; top:2px; width:110px; height:21px; ">
				<caption>용지일일재고 내역</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var inout_dt = model1.getValue("/root/reqData/searchData/inout_dt");
					var fac_clsf = model1.getValue("/root/reqData/searchData/fac_clsf_to");
					var inout_clsf = model1.getValue("/root/reqData/searchData/inout_clsf");
					var fac_clsf_nm = "";
					var nodeList = instance1.selectNodes("/root/initData/comboSet/fac_clsf/item");
					
					for (var i=0; i<nodeList.length; i++){
						if (fac_clsf == nodeList.item(i).getElementsByTagName("value").item(0).value){
							fac_clsf_nm = nodeList.item(i).getElementsByTagName("label").item(0).value;
							break;
						}
					}
					
					if( inout_dt == '' ){
						alert("입고 일자를 선택해주세요");
						return;
					}
					
					if( fac_clsf == ''){
						alert("공장을 선택해주세요");
						return;
					}
					if( inout_clsf == ''){
						alert("입출고 구분을 선택해주세요");
						return;
					}
					
					if( inout_clsf  == '3'){
						alert("입출고 구분이 입고/출고일경우만 가능 합니다.");
						return;
					}
					
					if( datagrid1.valueMatrix( 2, 1 ) == '' ){
						alert("조회 후 선택 가능 합니다.");
						return;
					}
					
					if( window.alert(inout_dt + "일자 " + fac_clsf_nm + "공장의 " +  ((inout_clsf=='1')?"입고":"출고") + "내역을 가져오시겠습니까?", "확인", 1) != 1){
						return;
					}
					
					model1.send("mt_papinout_2220");
					
					if(submit_completed()) {
						var totCnt = model1.getValue("/root/tempData/gridData/totalcnt");
						
						if( Number(totCnt) == 0 ) {
							return;
						}
						
						var node = instance1.selectNodes("/root/tempData/gridData/record");
						
						for ( var i = 0 ; i < node.length ; i ++ ){
							var matr_cd = node.item(i).matr_cd.value;
							var roll_cnt = node.item(i).roll_cnt.value;
							var wgt = node.item(i).wgt.value;
							//alert( node.length + "***" + matr_cd  + "#" + roll_cnt + "#" + wgt);
							if(wgt.length>0){
								for ( var ii = 2 ; ii < datagrid1.rows; ii++){
									
									if( matr_cd == datagrid1.valueMatrix( ii , 12 )) {
										var    ystWgt  = datagrid1.valueMatrix(ii, 3 );
										var    ystRoll = datagrid1.valueMatrix(ii, 2 );
										var    dan      = datagrid1.valueMatrix(ii, 4 );
										
										if ( model1.getValue("/root/reqData/searchData/inout_clsf") == '1')  {  // 입고 
											if(wgt != 0){
												datagrid1.valueMatrix( ii , 5 ) = roll_cnt;
												datagrid1.valueMatrix(ii,  8 )  = Number(ystRoll) + Number( datagrid1.valueMatrix(ii, 5 )) ;  
												
												datagrid1.valueMatrix( ii , 6) = wgt;
												datagrid1.valueMatrix(ii, 7 )  = Math.floor( Number(dan) * Number(datagrid1.valueMatrix(ii, 6 )) ) ;  //금일입출고금액 = 금일입출고 중량 * 단가
												datagrid1.valueMatrix(ii, 9)  =  Number(ystWgt) + Number(datagrid1.valueMatrix(ii, 6 )) ;               //금일재고 중량 = 전일재고중량 + 금일입출고중량
												datagrid1.valueMatrix(ii, 10) = Math.floor(  Number(dan)  * (Number(ystWgt) + Number(datagrid1.valueMatrix(ii, 6 ))) ) ;  //금액
												datagrid1.rowStatus(ii) = 2;
											}
										} else {
										    datagrid1.valueMatrix( ii , 8 ) = roll_cnt;
										    datagrid1.valueMatrix(ii, 5)  = Number( ystRoll ) -   Number(roll_cnt) ;
										   
											datagrid1.valueMatrix(ii, 9) =  wgt;
										    datagrid1.valueMatrix(ii, 6)  = Number( ystWgt )  -   Number(wgt) ;
											datagrid1.valueMatrix(ii, 7 )  = Math.floor( Number(dan) * Number(datagrid1.valueMatrix(ii, 6 )) );
											datagrid1.valueMatrix(ii, 10) = Math.floor(  Number(dan)  *  wgt );
											// valueChk( row, col );                                //용지출고롤수 확인 2007/12/06 추가 (황우주과장 요청)
											datagrid1.rowStatus(ii) = 2;
										}
										
									}
								}
							}
						}
					}
					datagrid1.subtotal("clear", 13, 8);
					datagrid1.subtotal("clear", 13, 9);
					subTotal();
					]]>
				</script>
			</button>
			<button id="button7" class="btn02" CRUD="C" style="left:700px; top:2px; width:52px; height:21px; ">
				<caption>지절입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					window.load("MT_PAPINOUT_4300.xrw"
						, "modal" 
						, ""
						, "left:100; top:100; width:946; height:728; align:center;sysmenu:hidden; min:hidden; max:hidden; resize:false; caption:hidden;"
						, ""
						, ""
					);
					]]>
				</script>
			</button>
			<button id="button8" class="btn02" CRUD="A" style="left:756px; top:2px; width:52px; height:21px; ">
				<caption>인쇄</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var magam_yn = model.getValue("/root/reqData/reqForm/magam_yn");
					
					if (magam_yn != "Y"){
						alert("해당 일자가 마감되지 않았습니다. 인쇄할 수 없습니다.");
						return;
					}
					model.send("mt_papinout_2225");
					var slip_seq_fr = model.getValue("/root/tempData/seq_fr");
					var slip_seq_to = model.getValue("/root/tempData/seq_to");
					
					if (model.getValue("/root/tempData/seq_to") == "000" || model.getValue("/root/tempData/seq_fr") == "000"){
						alert("출력할 전표정보가 없습니다.");
						return;
					}
					
					var srch_slip_cd = "40";
					var srch_slip_dt = model.getValue("/root/reqData/searchData/magam_dt");
					var ss_cmpy_cd = getProperty("ss_cmpycd");
					
					
					
					//alert(srch_slip_seq);
					
					model1.setValue("/root/reqData/reqForm/slip_occr_dt", srch_slip_dt);
					model1.setValue("/root/reqData/reqForm/slip_clsf_cd", srch_slip_cd);
					model1.setValue("/root/reqData/reqForm/slip_seqfr", slip_seq_fr);
					model1.setValue("/root/reqData/reqForm/slip_seqto", slip_seq_to);
					model1.setValue("/root/reqData/reqForm/clgbcd","D");

					model.send("fc_acct_2263_i");

					if(submit_completed()){
						resetOznode();
						
						model1.setValue("/root/reqData/searchData/slip_occr_dt",	srch_slip_dt);
						model1.setValue("/root/reqData/searchData/slip_clsf_cd",	srch_slip_cd);
						model1.setValue("/root/reqData/searchData/slip_seqfr",		slip_seq_fr);
						model1.setValue("/root/reqData/searchData/slip_seqto",		slip_seq_to);	
						
						model.send("fc_acct_2272_s");
						var cnt = 0;
						cnt = model1.getValue("/root/resData/resForm/fc_acct_2272_s/dataSet/CURLIST/record/cnt");
						
						if(cnt == 0){
							alert("출력할 자료가 존재하지 않습니다.");
							return;
						}

						makeNodeValue("/root/oz_data/ozrName","fcmc/SP_FC_ACCT_2262_P")						

						// connection 파라미터 설정.
						makeNodeValue("/root/oz_data/conParam/uv_flag", "1");
							
						// odi 파라미터 설정.
						makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd",		ss_cmpy_cd);
						makeNodeValue("/root/oz_data/odiParam/iv_slip_occr_dt", 	srch_slip_dt);					
						makeNodeValue("/root/oz_data/odiParam/iv_slip_clsf_cd", 	srch_slip_cd);
						makeNodeValue("/root/oz_data/odiParam/iv_slip_seqfr", 		slip_seq_fr);	
						makeNodeValue("/root/oz_data/odiParam/iv_slip_seqto", 		slip_seq_to);
						
						makeNodeValue("/root/oz_data/childCount","1");			
						// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)
						makeNodeValue("/root/oz_data/child1/ozrName","fcmc/SP_FC_ACCT_2271_P")												
						
						// odi 파라미터 설정.
						makeNodeValue("/root/oz_data/child1/odiParam/iv_cmpy_cd",		ss_cmpy_cd);
						makeNodeValue("/root/oz_data/child1/odiParam/iv_slip_occr_dt", 	srch_slip_dt);					
						makeNodeValue("/root/oz_data/child1/odiParam/iv_slip_clsf_cd", 	srch_slip_cd);
						makeNodeValue("/root/oz_data/child1/odiParam/iv_slip_seqfr", 	slip_seq_fr);														
						makeNodeValue("/root/oz_data/child1/odiParam/iv_slip_seqto",	slip_seq_to);
						
						//makeNodeValue("/root/oz_data/preview", "print");
						
						// 레포트뷰어 호출.
						openOzwin("/root/oz_data");
					}
					]]>
				</script>
			</button>
			<button id="button9" class="btn02" CRUD="A" style="left:570px; top:2px; width:52px; height:21px; ">
				<caption>출고마감</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					 		 OutClose_chk("I");
					]]>
				</script>
			</button>
			<button id="button10" class="btn04" CRUD="A" style="left:625px; top:2px; width:72px; height:21px; ">
				<caption>출고마감 취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					 		 OutClose_chk("D");
					]]>
				</script>
			</button>
		</group>
		<group id="group2" class="gro_sel" style="left:15px; top:44px; width:865px; height:47px; ">
			<caption id="caption4" class="list_cap01" style="left:0px; top:0px; width:80px; height:24px; text-align:center; ">입출고일자</caption>
			<caption id="caption5" class="list_cap02" style="left:79px; top:0px; width:786px; height:24px; text-align:center; "/>
			<caption id="caption6" class="list_cap01" style="left:481px; top:0px; width:130px; height:24px; text-align:center; ">발생일자(마감여부)</caption>
			<caption id="caption35" class="list_cap01" style="left:0px; top:23px; width:80px; height:24px; text-align:center; ">공  장</caption>
			<caption id="caption36" class="list_cap02" style="left:79px; top:23px; width:786px; height:24px; text-align:center; "/>
			<input id="input1" ref="/root/reqData/searchData/inout_dt" class="req" inputtype="date" caption="입출고 일자" appearance="input" style="left:84px; top:3px; width:116px; height:18px; background-color:#ffffcc; border-color:#999999; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					
						var inout_clsf = model1.getValue("/root/reqData/searchData/inout_clsf");
						var fac_clsf = model1.getValue("/root/reqData/searchData/fac_clsf_to");
						
				        if(inout_clsf == ''){
							return;
						}
						if(fac_clsf  == ''){
							return;
						}
						if(datagrid1.rows < 4){
							return;
						}
						btnA1.dispatch("onclick");
					]]>
				</script>
			</input>
			<caption id="caption10" style="left:200px; top:28px; width:58px; height:18px; text-align:center; ">
				<![CDATA[<ㅡㅡ]]>
			</caption>
			<select1 id="combo3" ref="/root/reqData/searchData/inout_clsf" class="req" appearance="minimal" editmode="inputsearch" caption="입출고 구분" style="left:347px; top:2px; width:120px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/inout_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
					        var selectValue = model1.getValue("/root/reqData/searchData/inout_clsf");
							//alert(selectValue);
							model1.setValue("/root/reqData/searchData/fac_clsf_fr" , "");
							 
							if ( selectValue == 3 ) {
									combo2.disabled = false;
							}
							else  {
								       combo2.disabled = true;
							}
									
							combo2.refresh();
							
							if( selectValue == 1){
								datagrid1.caption= "용지종류^전일재고^전일재고^단가^금일입고^금일입고^금일입고^금일재고^금일재고^금일재고^지절수^자재코드^그룹|용지종류^ROLL^중량^단가^ROLL^중량^금액^ROLL^중량^금액^지절수^자재코드^그룹";
								model1.setValue("/root/reqData/searchData/inout_dt", getDate("yyyymmdd") - 1); //입출고일자-입고선택일 경우 전일 
							}
							else if(  selectValue == 2){
								datagrid1.caption= "용지종류^전일재고^전일재고^단가^금일출고^금일출고^금일출고^금일재고^금일재고^금일재고^지절수^자재코드^그룹|용지종류^ROLL^중량^단가^ROLL^중량^금액^ROLL^중량^금액^지절수^자재코드^그룹";
								model1.setValue("/root/reqData/searchData/inout_dt", getDate("yyyymmdd")); //입출고일자-입고가 아니면 당일
							}
							else if(  selectValue == 3){
								datagrid1.caption= "용지종류^전일재고^전일재고^단가^금일전출^금일전출^금일전출^금일재고^금일재고^금일재고^지절수^자재코드^그룹|용지종류^ROLL^중량^단가^ROLL^중량^금액^ROLL^중량^금액^지절수^자재코드^그룹";
								model1.setValue("/root/reqData/searchData/inout_dt", getDate("yyyymmdd")); //입출고일자-입고가 아니면 당일
							}
							datagrid1.refresh();
							input1.refresh();
							//group2_Set();
					]]>
				</script>
			</select1>
			<output id="output2" ref="/root/reqData/reqForm/magam_yn" style="left:615px; top:3px; width:17px; height:18px; background-color:#eaeaea; border-color:#999999; "/>
			<input id="input2" ref="/root/reqData/searchData/magam_dt" inputtype="date" style="left:636px; top:3px; width:100px; height:18px; "/>
			<caption id="caption1" class="list_cap01" style="left:258px; top:23px; width:85px; height:24px; text-align:center; ">창  고</caption>
			<select1 id="combo2" ref="/root/reqData/searchData/fac_clsf_fr" appearance="minimal" editmode="inputsearch" caption="창고" style="left:347px; top:26px; width:120px; height:18px; background-color:#ffffcc; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fac_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<caption id="caption16" class="list_cap01" style="left:481px; top:23px; width:130px; height:24px; text-align:center; ">본사소모량</caption>
			<input id="output3" ref="/root/reqData/reqForm/somo" format="#,###" style="left:615px; top:26px; width:175px; height:18px; text-align:right; background-color:#eaeaea; border-color:#999999; "/>
			<caption id="caption33" class="list_cap01" style="left:258px; top:0px; width:85px; height:24px; text-align:center; ">입출고구분</caption>
			<select1 id="combo1" ref="/root/reqData/searchData/fac_clsf_to" appearance="minimal" editmode="inputsearch" caption="공장" style="left:85px; top:26px; width:113px; height:18px; background-color:#ffffcc; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fac_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					//group2_Set();
					]]>
				</script>
			</select1>
			<button id="button2" class="btn02" CRUD="A" style="left:748px; top:2px; width:52px; height:21px; ">
				<caption>전표</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					       var ewh_dt = model1.getValue("/root/reqData/searchData/inout_dt");
					       var magam_clsf = model1.getValue("/root/reqData/reqForm/magam_yn");
					       var magam_dt = model1.getValue("/root/reqData/searchData/magam_dt");
				             		 
				               if ( ewh_dt == ''){
		             		  	     alert("입출고 일자를 입력해 주세요");
		             		  	    return;
		             		       }
		             		       
		             		       if( magam_clsf == 'Y' ) {
		             		       	     alert("이미 마감 처리 된 데이터 입니다 .");
		             		       	     return;
		             		       }
			             		 
 		             		      if ( magam_dt == ''){
			             		  	alert("마감 일자를 입력해 주세요");
			             		  	return;
		             		      }
					      if( window.alert("마감 처리 하시 겠습니까?", "조선일보 MIS",1) == 1 ){
				       
  				  			  Fact_MaganChk("A");    // 공장 마감 여부 확인 
 				
 							  var clos_chk = model1.getValue("/root/tempData/clos_chk");
							
  				   	     		
  					           	  if( clos_chk == 'N'){
  					   	     			alert( "(10 , 20 , 22 , 25 ) 분공장 중 공장 마감이 되지 않은 공장이 존재 합니다. \n분공장 마감 후 처리 해주세요.");
 					   	     			return;
  					   	 	  }
				  			        		 
				             		 model1.send("mt_papinout_2212");
				             		 
				             		 if(submit_completed()) {
								btnA1.dispatch("onclick");
							 }
				             }
				]]>
				</script>
			</button>
			<button id="button3" class="btn02" CRUD="A" style="left:805px; top:2px; width:52px; height:21px; ">
				<caption>전표취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					       var ewh_dt = model1.getValue("/root/reqData/searchData/inout_dt");
					       var magam_clsf = model1.getValue("/root/reqData/reqForm/magam_yn");
					       var magam_dt = model1.getValue("/root/reqData/searchData/magam_dt");
				             		 
				               if ( ewh_dt == ''){
		             		  	     alert("입출고 일자를 입력해 주세요");
		             		  	    return;
		             		       }
		             		       
		             		       if( magam_clsf == 'N' ) {
		             		       	     alert("마감 처리 되지 않은 데이터입니다 .");
		             		       	     return;
		             		       }
			             		 
 		             		      if ( magam_dt == ''){
			             		  	alert("마감 일자를 입력해 주세요");
			             		  	return;
		             		      }
		             		      
				             if( window.alert("마감 취소 처리 하시 겠습니까?", "조선일보 MIS",1) == 1 ){
				             		
				             		model1.send("mt_papinout_2213");
				             		if(submit_completed()) {
								btnA1.dispatch("onclick");
							}
				             }
				]]>
				</script>
			</button>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/sub/record" caption="용지종류^전일재고^전일재고^단가^금일입고^금일입고^금일입고^금일재고^금일재고^금일재고^지절수^자재코드^그룹^vat^롤당 중량|용지종류^ROLL^중량^단가^ROLL^중량^금액^ROLL^중량^금액^지절수^자재코드^그룹^vat^롤당 중량" colsep="#" frozencols="3" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" subtotalposition="below" style="left:15px; top:240px; width:865px; height:320px; ">
			<col ref="title" style="text-align:left; "/>
			<col ref="befor_roll" format="(-)#,###" style="text-align:right; "/>
			<col ref="befor_wgt" format="(-)#,###" style="text-align:right; "/>
			<col ref="purc_uprc" format="#,###" style="text-align:right; "/>
			<col ref="roll" format="(-)#,###" style="text-align:right; "/>
			<col ref="wgt" format="(-)#,###" style="text-align:right; "/>
			<col ref="amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="tot_jgroll" format="(-)#,###" style="text-align:right; "/>
			<col ref="tot_jgwgt" format="(-)#,###" style="text-align:right; "/>
			<col ref="tot_jgamt" format="(-)#,###" style="text-align:right; "/>
			<col ref="cut_err_tms" format="#,###" style="text-align:right; "/>
			<col ref="matr_cd" visibility="hidden"/>
			<col ref="grp" visibility="hidden"/>
			<col ref="vat" visibility="visible"/>
			<col ref="roll_wgt" format="#,###" style="text-align:right; "/>
			<script type="javascript" ev:event="onendedit">
				<![CDATA[
				var cell = datagrid1.selectedCells;
				            
				if(cell.length < 1){
					alert("select a Cell");
					return;
				}
					    
				var col  = cell.item(0).col;
				var row = cell.item(0).row;
					    
				var    ystRoll	= datagrid1.valueMatrix(row, datagrid1.colRef("befor_roll"));
				var    ystWgt	= datagrid1.valueMatrix(row, datagrid1.colRef("befor_wgt"));
				var    dan	= datagrid1.valueMatrix(row, datagrid1.colRef("purc_uprc"));
				var   inout_clsf = model1.getValue("/root/reqData/searchData/inout_clsf");
				
				switch (col){
					case 5 :
						if (datagrid1.valueMatrix(row, datagrid1.colRef("wgt")) == "" || datagrid1.valueMatrix(row, datagrid1.colRef("wgt")) == "0"){
							datagrid1.valueMatrix(row, datagrid1.colRef("wgt")) = eval(datagrid1.valueMatrix(row, datagrid1.colRef("roll"))) * eval(datagrid1.valueMatrix(row, datagrid1.colRef("roll_wgt")));
							datagrid1.valueMatrix(row, datagrid1.colRef("amt"))  = Math.floor( Number(dan) * eval( datagrid1.valueMatrix(row, datagrid1.colRef("wgt")) ) );
						}
						if ( inout_clsf == '3' ) {
							datagrid1.valueMatrix(row, datagrid1.colRef("tot_jgroll"))  = Number(ystRoll) - Number( datagrid1.valueMatrix(row, col )) ;     //금일재고ROLL = 전일재고 ROLL + 금일입출고 ROLL
							datagrid1.valueMatrix(row, datagrid1.colRef("tot_jgwgt"))  =  Number(ystWgt) - Number(datagrid1.valueMatrix(row, datagrid1.colRef("wgt") )) ;               //금일재고 중량 = 전일재고중량 + 금일입출고중량	
							datagrid1.valueMatrix(row, datagrid1.colRef("tot_jgamt")) = Math.floor(  Number(dan)  * (Number(ystWgt) - Number(datagrid1.valueMatrix(row, datagrid1.colRef("wgt"))) ) ) ;  //금액
						} else {
							datagrid1.valueMatrix(row, datagrid1.colRef("tot_jgroll"))  = Number(ystRoll) + Number( datagrid1.valueMatrix(row, col )) ;     //금일재고ROLL = 전일재고 ROLL + 금일입출고 ROLL
							datagrid1.valueMatrix(row, datagrid1.colRef("wgt")) = eval(datagrid1.valueMatrix(row, datagrid1.colRef("roll"))) * eval(datagrid1.valueMatrix(row, datagrid1.colRef("roll_wgt")));
							datagrid1.valueMatrix(row, datagrid1.colRef("amt"))  = Math.floor( Number(dan) * eval( datagrid1.valueMatrix(row, datagrid1.colRef("wgt")) ) );
							datagrid1.valueMatrix(row, datagrid1.colRef("tot_jgwgt"))  =  Number(ystWgt) + Number(datagrid1.valueMatrix(row, datagrid1.colRef("wgt") )) ;               //금일재고 중량 = 전일재고중량 + 금일입출고중량
							datagrid1.valueMatrix(row, datagrid1.colRef("tot_jgamt")) = Math.floor(  Number(dan)  * ( Number(ystWgt) + Number(datagrid1.valueMatrix(row, datagrid1.colRef("wgt") )) ) ) ;  //금액
						}
						datagrid1.subtotal("clear", 13, 5);
						subTotal();
						break;
					case 6:
						datagrid1.valueMatrix(row, datagrid1.colRef("amt"))  = Math.floor( Number(dan) * Number(datagrid1.valueMatrix(row,col )));  //금일입출고금액 = 금일입출고 중량 * 단가
						
						if ( inout_clsf == '3' ) {
							datagrid1.valueMatrix(row, datagrid1.colRef("tot_jgwgt"))  =  Number(ystWgt) - Number(datagrid1.valueMatrix(row, col )) ;               //금일재고 중량 = 전일재고중량 + 금일입출고중량	
							datagrid1.valueMatrix(row, datagrid1.colRef("tot_jgamt")) = Math.floor(  Number(dan)  * (Number(ystWgt) - Number(datagrid1.valueMatrix(row,col ))) ) ;  //금액
						}else {
							datagrid1.valueMatrix(row, datagrid1.colRef("tot_jgwgt"))  =  Number(ystWgt) + Number(datagrid1.valueMatrix(row, col )) ;               //금일재고 중량 = 전일재고중량 + 금일입출고중량
							datagrid1.valueMatrix(row, datagrid1.colRef("tot_jgamt")) = Math.floor(  Number(dan)  * (Number(ystWgt) + Number(datagrid1.valueMatrix(row,col ))) ) ;  //금액
						}
						datagrid1.subtotal("clear", 13, 6);
						subTotal();
						break;
					case 8:
						if( Number(ystRoll) < Number(datagrid1.valueMatrix(row,col ))){
							alert("[금일재고 Roll/중량]을 확인 하세요");
							datagrid1.valueMatrix(row,col ) = '';
							return;
						}
						
						datagrid1.valueMatrix(row, 5)  = Number( ystRoll ) -   Number(datagrid1.valueMatrix(row,col )) ;
						//alert( ystRoll + "-" +  datagrid1.valueMatrix(row,col ) + "=" + datagrid1.valueMatrix(row, 5) );
						//valueChk( row, col );
						
						datagrid1.subtotal("clear", 13, 8);
						subTotal();                              //용지출고롤수 확인 2007/12/06 추가 (황우주과장 요청)
						break;
					case 9 :
						if( Number(ystWgt) < Number(datagrid1.valueMatrix(row,col ))){
							alert("[금일재고 Roll/중량]을 확인 하세요");
							datagrid1.valueMatrix(row,col ) = '';
							return;
						}
						
						datagrid1.valueMatrix(row, 8 ) = Math.ceil(Number(datagrid1.valueMatrix(row,col )) / Number( datagrid1.valueMatrix(row,15 )));
						datagrid1.valueMatrix(row, 5)  =  Number(ystRoll) - Number(datagrid1.valueMatrix(row, 8 ));
						//alert(Number(datagrid1.valueMatrix(row,col )) / Number( datagrid1.valueMatrix(row,15 )));
						datagrid1.valueMatrix(row, 6)  = Number( ystWgt )  -   Number(datagrid1.valueMatrix(row,col )) ;
						datagrid1.valueMatrix(row, 7 )  = Math.floor( Number(dan) * Number(datagrid1.valueMatrix(row, 6 )) );
						
						datagrid1.valueMatrix(row, 10) = Math.floor(  Number(dan)  * Number(datagrid1.valueMatrix(row,col )) );
						 
						valueChk( row, col );                                //용지출고롤수 확인 2007/12/06 추가 (황우주과장 요청)
						datagrid1.subtotal("clear", 13, 9);
						subTotal();
						break;
					    	                     
				}
			        if ( Number(datagrid1.valueMatrix(row,5)) == 0  && Number(datagrid1.valueMatrix(row,6)) == 0){
					datagrid1.rowStatus(row) = 0;
				}
				
				if (event.keyCode == 13){
					datagrid1.select(row + 1, col) = true;
					datagrid1.row = row + 1;
					//alert(event.keyCode);
				}
				]]>
			</script>
			<script type="javascript" ev:event="onentercell">
				<![CDATA[
				/*
				var cell = datagrid1.selectedCells;
				            
				if(cell.length < 1){
					alert("select a Cell");
					return;
				}
				var col  = cell.item(0).col;
				var row = cell.item(0).row;
				
				datagrid1.select(row + 1, col) = true;
				*/
				]]>
			</script>
		</datagrid>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData2/main/record" caption="발행일자^매체^섹션^규격^면수^흑백면수^칼라면수^부수^인쇄중량^매체^섹션^인쇄일자" colsep="#" colwidth="90, 90, 100, 52, 76, 90, 90, 90, 90, 24, 24, 24" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:15px; top:102px; width:865px; height:98px; ">
			<col ref="issu_dt" format="yyyy-mm-dd"/>
			<col ref="medi_cdnm" style="text-align:left; "/>
			<col ref="sect_cdnm" style="text-align:left; "/>
			<col ref="pap_std"/>
			<col ref="issu_pcnt"/>
			<col ref="bw_pcnt"/>
			<col ref="clr_pcnt"/>
			<col ref="slip_qty" format="#,###" style="text-align:right; "/>
			<col ref="prt_wgt" format="#,###" style="text-align:right; "/>
			<col ref="medi_cd" visibility="hidden"/>
			<col ref="sect_cd" visibility="hidden"/>
			<col ref="prt_dt" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					/*
					var cell	= datagrid2.selectedCells;
					if(cell.length < 1){
						alert("select a Cell");
						return;
					}
					*/
					var col			= datagrid2.col;
					var row			= datagrid2.row;
					var sumWgt		= 0;
					
					//alert(col);
					if (col == 9){
						for (var i=1; i<datagrid2.rows; i++){
							sumWgt = sumWgt + eval(datagrid2.valueMatrix(i, datagrid2.colRef("prt_wgt")));
						}
					}
					model.setValue("/root/reqData/reqForm/somo", sumWgt);
					model.setValue("/root/reqData/reqForm/totSumWgt", sumWgt);
					output3.refresh();
					output1.refresh();
				]]>
			</script>
		</datagrid>
		<group id="group1" class="gro_sel" style="left:15px; top:205px; width:865px; height:24px; ">
			<caption id="caption8" class="list_cap02" style="left:64px; top:0px; width:246px; height:24px; text-align:center; "/>
			<caption id="caption3" class="list_cap01" style="left:0px; top:0px; width:65px; height:24px; text-align:center; ">파지율</caption>
			<caption id="caption14" class="list_cap02" style="left:670px; top:0px; width:195px; height:24px; text-align:center; "/>
			<caption id="caption15" class="list_cap02" style="left:365px; top:0px; width:297px; height:24px; text-align:center; "/>
			<output id="output1" ref="/root/reqData/reqForm/totSumWgt" format="#,###" style="left:685px; top:3px; width:100px; height:18px; text-align:right; border-color:#999999; "/>
			<output id="output4" ref="/root/reqData/reqForm/argWgt" style="left:414px; top:3px; width:145px; height:18px; text-align:right; border-color:#999999; "/>
			<output id="output7" ref="/root/reqData/reqForm/pajiArg1" style="left:69px; top:3px; width:65px; height:18px; text-align:right; border-color:#999999; "/>
			<output id="output8" ref="/root/reqData/reqForm/pajiArg2" style="left:139px; top:3px; width:65px; height:18px; text-align:right; border-color:#999999; "/>
			<caption id="caption12" class="list_cap01" style="left:295px; top:0px; width:90px; height:24px; text-align:center; ">평량(Kg/연)</caption>
			<caption id="caption9" class="list_cap01" style="left:626px; top:0px; width:50px; height:24px; text-align:center; ">중 량</caption>
		</group>
	</xhtml:body>
</xhtml:html>
