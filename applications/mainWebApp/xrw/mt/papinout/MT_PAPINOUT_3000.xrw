<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<fac_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</fac_clsf>
							<gitaPaji>
								<item>
									<label/>
									<value/>
								</item>
							</gitaPaji>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<searchData>
							<fac_clsf/>
							<issu_dt/>
							<use_yn/>
							<clos_yn/>
							<magam_state/>
							<magam_dt/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqForm/>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<multiUpDate/>
						<!-- MultiUpDate유형 사용시 처리 -->
						<fwdData>
						</fwdData>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<totPrtWgt/>
							<gitaPajiWgt/>
							<totPajiWgt/>
							<pajiYual/>
							<thoWgt/>
							<avgYang/>
							<cnt/>
						</resForm>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<msg/>
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<record>
								<issu_dt/>
								<prt_dt/>
								<paper_clsf/>
								<medi_cd/>
								<sect_cd/>
								<pap_std/>
								<issu_pcnt/>
								<clr_pcnt/>
								<bw_pcnt/>
								<slip_qty/>
								<somo_wgt/>
								<avgynag/>
							</record>
							<!-- datagrid2 -->
							<!-- datagrid3 -->
						</gridData>
						<gridData2>
							<record/>
						</gridData2>
						<gridData3>
							<record>
								<medi_cd/>
								<sect_cd/>
								<pj_kind/>
								<pj_cnt/>
								<pj_wgt/>
								<hdqt_paper_clsf/>
								<prt_clsf/>
								<prt_dt/>
							</record>
						</gridData3>
						<gitaPajiData>
							<cmpy_cd/>
							<occr_dt/>
							<seq/>
							<sub_seq/>
							<pj_kind/>
							<pj_wgt/>
							<etc_pj_resn_cd/>
							<remk/>
						</gitaPajiData>
						<gridData4>
							<record>
								<pj_kind/>
								<pj_kind_nm/>
								<cnt00/>
								<wgt00/>
								<cnt01/>
								<wgt01/>
								<cnt02/>
								<wgt02/>
								<cnt03/>
								<wgt03/>
								<cnt04/>
								<wgt04/>
								<cnt05/>
								<wgt05/>
							</record>
						</gridData4>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					 function date(){
						var d = new Date();
						var rec = ""; 
						var dd = "";
					     	    
						rec = "" + d.getYear();
						if(d.getDate() < 10 ) dd = "0" + d.getDate();
						else dd = d.getDate();

						if( d.getMonth() + 1 < 10 )  rec = rec + "0" + (d.getMonth() + 1 )  + dd;
						else if ( d.getMonth() + 1 >= 10 )  rec = rec  + (d.getMonth() + 1) + dd;   
					     	    
						return (rec);
					}
					
					
//					function initGrid2Data(){						
//						while (  datagrid2.cols  > 1 ){
//								datagrid2.removeColumn();
//						 }  
//						 
//						datagrid2.removeColumn();
//						 
//						model1.removenode("/root/resData/gridData2");
//						
//						model1.makeNode("/root/resData/gridData2");
//						model1.makeNode("/root/resData/gridData2/col");
//						model1.makeNode("/root/resData/gridData2/row");
//						model1.makeNode("/root/resData/gridData2/data");
//						model1.makeNode("/root/resData/gridData2/data/record");
//					
//						datagrid2.caption = "";
//						datagrid2.refresh();
//					}
//					function datagrid2Create(){
//						nodeDataList_y = instance1.selectNodes("/root/resData/gridData2/col/val");
//						
//						var     strCap = "";
//						
//						datagrid2.nodeset = "/root/resData/gridData2/data/record";  
//						for ( var i = 0; i < nodeDataList_y.length; i++ ) {
//							var typeStr = "";
//							if ( i != 0 ) strCap = strCap + "^";
//							strCap = strCap + nodeDataList_y.item(i).value;
//							typeStr = "output";
//							
//							datagrid2.addColumn("ref:row_" + i + ";type:" + typeStr + ";" );
//							
//						}
//						 						 
//						datagrid2.caption = strCap;
//						
//						datagrid2.refresh();
//						
//						datagrid2.colHidden(0) = true;
//   				               datagrid2.colHidden(2) = true;
//   				               
//   				               datagrid2.colWidth(0) = 0;
//   				               datagrid2.colWidth(1) = 100;
//   				               datagrid2.colWidth(2) = 0;
//   				             
//   				               for ( var i = 3 ; i < datagrid2.cols; i++){
//   				               	datagrid2.colWidth(i) = 810 / (datagrid2.cols - 3) ;
//   				               }
//   				               model1.copyNode("/root/resData/gridData2/data" , "/root/tempData/gridData4");
//   				               
//   				               datagrid2.refresh();
//					}
 				    
					
					function datagrid4ValueSet(){
						var res_sum_wgt   = 0;
						var res_sum_cnt    = 0;
						var taget_sum_wgt = 0;
						var taget_sum_cnt  = 0;
						var tot_cap_col       = 0;
						var tot_cap_row     = 0; 
						var totSumArr = new Array();
						var totPajiArr  = new Array();	
						var hqdt_th_wgt  = new Array();		
 						
						if( datagrid3.valueMatrix(1, 1 ) == '110' ){  // 입력 전일때 데이터 보정 
							for ( var i = 2 ; i < datagrid4.rows;i++){
								res_sum_wgt =  Number(datagrid4.valueMatrix(i , 4));
								res_sum_cnt  =  Number(datagrid4.valueMatrix(i , 3));  
								taget_sum_wgt = 0 ;
								taget_sum_cnt = 0;
								
								for ( ii = 1 ; ii < datagrid3.rows; ii ++){
									if ( datagrid3.valueMatrix( ii , 6) != '01' ) continue;
									if( Number(datagrid3.valueMatrix( ii , 3 ) ) == i - 1){
										taget_sum_wgt =  taget_sum_wgt + Number(datagrid3.valueMatrix(ii, 5));
										taget_sum_cnt  =  taget_sum_cnt + Number(datagrid3.valueMatrix(ii, 4));
									}
								}
								//alert("조정 전 WGT  " + (i - 1)  + " " + res_sum_wgt +"-" + taget_sum_wgt);
								if( res_sum_wgt != taget_sum_wgt){
									 //alert("죄송합니다. 데이터 확인 메세지 입니다\n 곧 수정 조치 하겠습니다.\n 조정 WGT  " + (i - 1)  + " " + res_sum_wgt +"-" + taget_sum_wgt);
									for( var iii = 1 ; iii < datagrid3.rows; iii++){
										if( datagrid3.valueMatrix( iii, 1 ) == '110' && datagrid3.valueMatrix( iii, 2 ) == '0100'  && Number(datagrid3.valueMatrix( iii, 3 )) ==  (i - 1) && datagrid3.valueMatrix( iii , 6) == '01' && datagrid3.valueMatrix( iii , 7) == '01' ) {
											//alert(datagrid3.valueMatrix( iii , 5)) ;
											datagrid3.valueMatrix( iii , 5) = Number(datagrid3.valueMatrix( iii , 5) ) + (res_sum_wgt - taget_sum_wgt);
											break;
										} else { continue; }
									}
								}
								
								if( res_sum_cnt != taget_sum_cnt){
									//alert("죄송합니다. 데이터 확인 메세지 입니다\n 곧 수정 조치 하겠습니다.\n조정 CNT  " + (i - 1)  + " " + res_sum_cnt +"-" + taget_sum_cnt);
									for( var iii = 1 ; iii < datagrid3.rows; iii++){
										if( datagrid3.valueMatrix( iii, 1 ) == '110' && datagrid3.valueMatrix( iii, 2 ) == '0100'  && Number(datagrid3.valueMatrix( iii, 3 )) ==  (i - 1) && datagrid3.valueMatrix( iii , 6) == '01'  && datagrid3.valueMatrix( iii , 7) == '01' ) {
											//    			   alert(datagrid3.valueMatrix( iii , 4)) ;
											datagrid3.valueMatrix( iii , 4) = Number(datagrid3.valueMatrix( iii , 4) ) + (res_sum_cnt - taget_sum_cnt);
											break;
										} else { continue; }
									}
								}
							}	// FOR
						}
						      
 					       
 						
 				    }
					
					function datagrid2ValueSet(){
						var res_sum_wgt   = 0;
						var res_sum_cnt    = 0;
						var taget_sum_wgt = 0;
						var taget_sum_cnt  = 0;
						var tot_cap_col       = 0;
						var tot_cap_row     = 0; 
						var totSumArr = new Array();
						var totPajiArr  = new Array();	
						var hqdt_th_wgt  = new Array();		
 						
						if( datagrid3.valueMatrix(1, 1 ) == '110' ){  // 입력 전일때 데이터 보정 
							for ( var i = 2 ; i < datagrid2.rows;i++){
								res_sum_wgt =  Number(datagrid2.valueMatrix(i , 4));
								res_sum_cnt  =  Number(datagrid2.valueMatrix(i , 3));  
								taget_sum_wgt = 0 ;
								taget_sum_cnt = 0;
								
								for ( ii = 1 ; ii < datagrid3.rows; ii ++){
									if ( datagrid3.valueMatrix( ii , 6) != '01' ) continue;
									if( Number(datagrid3.valueMatrix( ii , 3 ) ) == i - 1){
										taget_sum_wgt =  taget_sum_wgt + Number(datagrid3.valueMatrix(ii, 5));
										taget_sum_cnt  =  taget_sum_cnt + Number(datagrid3.valueMatrix(ii, 4));
									}
								}
								//alert("조정 전 WGT  " + (i - 1)  + " " + res_sum_wgt +"-" + taget_sum_wgt);
								if( res_sum_wgt != taget_sum_wgt){
									 //alert("죄송합니다. 데이터 확인 메세지 입니다\n 곧 수정 조치 하겠습니다.\n 조정 WGT  " + (i - 1)  + " " + res_sum_wgt +"-" + taget_sum_wgt);
									for( var iii = 1 ; iii < datagrid3.rows; iii++){
										if( datagrid3.valueMatrix( iii, 1 ) == '110' && datagrid3.valueMatrix( iii, 2 ) == '0100'  && Number(datagrid3.valueMatrix( iii, 3 )) ==  (i - 1) && datagrid3.valueMatrix( iii , 6) == '01' && datagrid3.valueMatrix( iii , 7) == '01' ) {
											//alert(datagrid3.valueMatrix( iii , 5)) ;
											datagrid3.valueMatrix( iii , 5) = Number(datagrid3.valueMatrix( iii , 5) ) + (res_sum_wgt - taget_sum_wgt);
											break;
										} else { continue; }
									}
								}
								
								if( res_sum_cnt != taget_sum_cnt){
									//alert("죄송합니다. 데이터 확인 메세지 입니다\n 곧 수정 조치 하겠습니다.\n조정 CNT  " + (i - 1)  + " " + res_sum_cnt +"-" + taget_sum_cnt);
									for( var iii = 1 ; iii < datagrid3.rows; iii++){
										if( datagrid3.valueMatrix( iii, 1 ) == '110' && datagrid3.valueMatrix( iii, 2 ) == '0100'  && Number(datagrid3.valueMatrix( iii, 3 )) ==  (i - 1) && datagrid3.valueMatrix( iii , 6) == '01'  && datagrid3.valueMatrix( iii , 7) == '01' ) {
											//    			   alert(datagrid3.valueMatrix( iii , 4)) ;
											datagrid3.valueMatrix( iii , 4) = Number(datagrid3.valueMatrix( iii , 4) ) + (res_sum_cnt - taget_sum_cnt);
											break;
										} else { continue; }
									}
								}
							}	// FOR
						}
						//Array 초기화 
						//alert(datagrid2.cols);
						/*
						for( var i = 1 ; i < datagrid2.cols ; i++) {
							totSumArr[i - 1 ] = 0;
							totPajiArr[i - 1]  =  "0";
						}
						
						for (var i = 0 ; i < 4 ; i++){
							hqdt_th_wgt[i] = 0;
						}
						
						// 각각의 ROW  합계 생성
						for ( var i = 2 ; i < datagrid2.rows; i++ ) {
							for ( var ii = 1 ; ii < datagrid2.cols ; ii++){
								var tmpColValue = datagrid2.valueMatrix( i , ii );
								totSumArr[ii - 1] =   Number(totSumArr[ii - 1])  + Number(tmpColValue);
							}	
						}
						datagrid2.addRow(true, true);
						datagrid2.valueMatrix ( datagrid2.rows - 1 , 0 ) = "합계 (KG)";
						for ( var i = 0 ;  i < totSumArr.length ; i++){
							datagrid2.valueMatrix( datagrid2.rows -1, i + 1) = totSumArr[i];
						}
						
						//	파지율 계산 
					    	totPajiArr[0] =  "-";
						totPajiArr[1] =  model1.getValue("/root/resData/resForm/pajiYual");
						
						for ( var i = 1; i < datagrid1.rows;i++){
							var papstd = datagrid1.valueMatrix(i, 4);
							var paji_issu_pcnt = Number(datagrid1.valueMatrix( i , 5));
							var paji_busu  = Number (datagrid1.valueMatrix( i , 8));
							
							if( papstd == 'T' ) {
 								paji_issu_pcnt = paji_issu_pcnt / 2;
 							}
 							
 							var rowData = Math.round(( paji_issu_pcnt * paji_busu ) / 4000 * 19.791, 3);
  						        if( datagrid1.valueMatrix( i, 1 ).substr(0, 2) == '01') {
  						        	hqdt_th_wgt[0] = hqdt_th_wgt[0] + rowData;
  						        }   
  						        if( datagrid1.valueMatrix( i, 1 ).substr(0, 2) == '02') {
  						        	hqdt_th_wgt[1] = hqdt_th_wgt[1] + rowData;
  						        } 
  						        if( datagrid1.valueMatrix( i, 1 ).substr(0, 2) == '03') {
  						        	hqdt_th_wgt[2] = hqdt_th_wgt[2] + rowData;
  						        } 
  						        if( datagrid1.valueMatrix( i, 1 ).substr(0, 2) == '04') {
  						        	hqdt_th_wgt[3] = hqdt_th_wgt[3] + rowData;
  						        }   
  						        
  						}
  						for ( var i = 0 ; i < 4 ; i++ ){
  							 totPajiArr[i * 2 + 2] =  "-";
  							// alert("totSumWgt" + totSumArr[i * 2+ 4]);
  							// alert("hqdt_th_wgt" + hqdt_th_wgt[i]);
  							 totPajiArr[i * 2 + 3] =  "" + ( (hqdt_th_wgt[i] == 0 ) ? 0 : (totSumArr[i * 2+ 3] / hqdt_th_wgt[i] * 100 ) );
  						}
  						
  						datagrid2.addRow(true, true);
  						datagrid2.valueMatrix ( datagrid2.rows - 1 , 0 ) = "파지율";
  						for ( var i = 0 ;  i < totPajiArr.length ; i++){
   							if ( ( i % 2 ) == 0 ){
								if (i==0){
									datagrid2.valueMatrix( datagrid2.rows -1, i + 2 ) = Math.round(eval(datagrid2.valueMatrix( datagrid2.rows -2, i + 2)) / eval(model.getValue("/root/resData/resForm/thoWgt")), 2);										} else if (i==1){
									datagrid2.valueMatrix( datagrid2.rows -1, i + 4 ) = Math.round(eval(datagrid2.valueMatrix( datagrid2.rows -2, i + 4)) / eval(model.getValue("/root/resData/resForm/thoWgt")), 2);
								} else {
									datagrid2.valueMatrix( datagrid2.rows -1, i + 1 ) = totPajiArr[i];
								}
   							} else {
  								 
    									datagrid2.valueMatrix( datagrid2.rows -1, i + 1 ) = totPajiArr[i].substr(0,  totPajiArr[i].indexOf(".") + 4) + "%";
							}				        
						}
						*/
// 						// 데이터 보정 작업 
// 						var res_sum_wgt   = 0;
// 						var res_sum_cnt    = 0;
// 						var taget_sum_wgt = 0;
// 						var taget_sum_cnt  = 0;
// 						var tot_cap_col    = 0;
// 						var tot_cap_row   = 0;
// 						  
// 						
// 						for ( var j = 0; j < datagrid2.cols ; j++){
// 						         var tmpData = datagrid2.valueMatrix(0, j );
// 						         if ( tmpData == '총파지량'){
// 						                   tot_cap_col  = j;
// 						                   break;
// 						         }
// 						}
// 						for (var  jj = 2 ; jj < datagrid2.rows ; jj++){
// 							 var tmpData = datagrid2.valueMatrix(jj, 0 );
// 							  if ( tmpData == '합계 (KG)'){
// 						                   tot_cap_row  = jj;
// 						         }
// 						}
// 						tot_cap_row = datagrid2.rows -1;
// 						
// 						alert( tot_cap_row );
// 						alert( tot_cap_col );
// 						
// 						for ( var iii = 2; iii <=  tot_cap_row ; iii++){
// 							 taget_sum_wgt = 0;
// 							 taget_sum_cnt = 0;
// 							 res_sum_cnt   =   Number(datagrid2.valueMatrix( iii, tot_cap_col));
// 							 res_sum_wgt  =   Number(datagrid2.valueMatrix( iii, tot_cap_col + 1));
// 							 
// 							 for (var   iiii = tot_cap_col + 2 ; iiii < datagrid2.cols; iiii++){
// 							 	 taget_sum_wgt = taget_sum_wgt + Number( datagrid2.valueMatrix( iii, iiii + 1));
// 							 	 taget_sum_cnt  = taget_sum_cnt + Number( datagrid2.valueMatrix( iii, iiii ));
// 							 	  iiii += 1; 
// 							 }
// 							 //alert("CNT" + res_sum_cnt + "####" + taget_sum_cnt);
// 							// alert("WGT" + res_sum_wgt + "####" + taget_sum_wgt);
// 							 if ( res_sum_cnt != taget_sum_cnt){
// 							 	  
// 							 	  datagrid2.valueMatrix(iii, tot_cap_col + 2) = Number(datagrid2.valueMatrix(iii, tot_cap_col + 2)) + res_sum_cnt - taget_sum_cnt;
// 							 	  
// 							 	  if( Number(datagrid3.valueMatrix( iii - 1, 3) )  ==  ( iii -1) ){
// 							 	  	       datagrid3.valueMatrix( iii - 1, 4)  =  Number(datagrid3.valueMatrix( iii - 1, 4)) + res_sum_cnt - taget_sum_cnt; 
// 							 	  }
// 							 }
// 							 if ( res_sum_wgt != taget_sum_wgt){
// 							 	  
// 							 	  datagrid2.valueMatrix(iii, tot_cap_col + 3) = Number(datagrid2.valueMatrix(iii, tot_cap_col + 3)) + res_sum_wgt - taget_sum_wgt;
// 							 	  
// 							 	  if( Number(datagrid3.valueMatrix( iii - 1, 3))  ==  ( iii -1) ){
// 							 	  	       datagrid3.valueMatrix( iii - 1, 5)  =  Number(datagrid3.valueMatrix( iii - 1, 5)) + res_sum_wgt - taget_sum_wgt;
// 							 	  }
// 							 }
// 							
// 						}
// 						
// 				               
// 						
// 						
// 						
// 					    	

 					       
 					       
 						
 				    }
//						

//						
//						// 그리드 합계와 올림처리에 따른 차이 처리
//						for ( var i = 1 ; i < datagrid2.rows ; i++){
//							var totSum = datagrid2.valueMatrix( i , 3 ) ;
//							
//							var sumMedi = 0;
//							for (var ii = 4 ; ii < datagrid2.cols  ; ii++){
//								sumMedi = Number(sumMedi) + Number( datagrid2.valueMatrix( i , ii )) ;
//							}
//							var tmpValue = Number(totSum) - Number(sumMedi);
//							
//							if( tmpValue != 0 ){
//								//alert(i + "@" +tmpValue+"#");
//								datagrid2.valueMatrix(i, 4 ) =  Number(datagrid2.valueMatrix(i, 4 )) + tmpValue;
//								//alert( datagrid2.valueMatrix(0,4).substr(0,3) + "X" +  datagrid2.valueMatrix(0,4).substr(4, 4) + "Y");
//								
//								matr_cd = datagrid2.valueMatrix(0,4).substr(0,3);
//								sect_cd = datagrid2.valueMatrix(0,4).substr(4, 4);
//								chktmp  = datagrid2.valueMatrix(i, 2);
//								cd        =  datagrid2.valueMatrix(i, 0);
//								
//								for( var j = 1; j < datagrid3.rows ; j++){
//									 if(  ( datagrid3.valueMatrix( j , 1 ) == cd )  && ( datagrid3.valueMatrix( j , 5 ) == matr_cd )  && ( datagrid3.valueMatrix( j , 6 ) == sect_cd )  ) {
//									 		if( chktmp == 'Y' ) {
//									 	  		datagrid3.valueMatrix(j, 8)  = Number(datagrid3.valueMatrix(j, 8))  + tmpValue;
//									 	  	}
//									  		else{
//									 	  		datagrid3.valueMatrix(j, 7)  = Number(datagrid3.valueMatrix(j, 7))  + tmpValue;
//									 	      }
//									 	      break;
//									 }
//								}
//								
//							}
//						}
//						
//						
//						
//						
//						 
//					       
//						 
//						

//					        
//						datagrid2.refresh();
//					}
					
					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				          model1.send("mt_papinout_3001");
				          model1.copyNode("/root/initData/comboSet/fac_clsf", "/root/tempData/fac_clsf");
				          model1.setValue("/root/reqData/searchData/use_yn" , model1.getValue("/root/tempData/use_yn"));
				          model1.copyNode("/root/initData/comboSet/gitaPaji", "/root/tempData/gitaPaji");
				          combo1.refresh();
				          model1.setValue("/root/reqData/searchData/issu_dt", date());
				          group1.refresh();
				          group6.refresh();
				          if ( model1.getValue("/root/reqData/searchData/use_yn") == 'N') {
				          		combo1.select(0);
				          		combo1.disabled = true;
				          		button10.disabled = true;
				          		button11.disabled = true;
				          		
				          }
				]]>
			</script>
			<submission id="mt_papinout_3001" action="/mt/papinout/3001" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="mt_papinout_3002" action="/mt/papinout/3002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_3003" action="/mt/papinout/3003" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_3004" action="/mt/papinout/3004" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_3005" action="/mt/papinout/3005" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_3006" action="/mt/papinout/3006" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_3007" action="/mt/papinout/3007" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_3012" action="/mt/papinout/3012" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_3013" action="/mt/papinout/3013" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_3014" action="/mt/papinout/3014" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papinout_3017" action="/mt/papinout/3017" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData2/record"/>
			<submission id="mt_papinout_3018" action="/mt/papinout/3018" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData4/record"/>
		</model>
		<script type="javascript" src="/js/CRMComm.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/TFCommon.js"/>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728">
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group6" class="gro_sel" style="left:10px; top:86px; width:925px; height:25px; ">
			<caption id="caption37" class="list_cap01" style="left:0px; top:0px; width:150px; height:24px; text-align:center; ">공  장</caption>
			<caption id="caption38" class="list_cap02" style="left:149px; top:0px; width:300px; height:24px; text-align:center; "/>
			<caption id="caption42" class="list_cap02" style="left:450px; top:0px; width:465px; height:24px; text-align:center; "/>
			<input id="input10" ref="/root/reqData/searchData/issu_dt" class="req" inputtype="date" caption="발행일자" style="left:463px; top:3px; width:122px; height:18px; background-color:#ffffcc; "/>
			<select1 id="combo1" ref="/root/reqData/searchData/fac_clsf" class="req" appearance="minimal" caption="공장" style="left:155px; top:3px; width:125px; height:18px; background-color:#ffffcc; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fac_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<caption id="caption41" class="list_cap01" style="left:323px; top:0px; width:132px; height:24px; text-align:center; ">발행일자</caption>
			<caption id="caption3" class="list_cap01" style="left:590px; top:0px; width:132px; height:24px; text-align:center; ">마감일자</caption>
			<output id="output1" ref="/root/reqData/searchData/magam_state" style="left:727px; top:3px; width:83px; height:18px; "/>
			<output id="output2" ref="/root/reqData/searchData/magam_dt" format="yyyy-mm-dd" style="left:814px; top:3px; width:93px; height:18px; "/>
		</group>
		<group id="group2" class="gro_sel" disabled="true" style="left:10px; top:270px; width:925px; height:49px; background-color:#ffffff; ">
			<caption id="caption106" class="list_cap02" style="left:660px; top:0px; width:252px; height:25px; text-align:center; "/>
			<caption id="caption66" class="list_cap02" style="left:389px; top:0px; width:175px; height:25px; text-align:center; "/>
			<caption id="caption67" class="list_cap02" style="left:101px; top:24px; width:185px; height:25px; text-align:center; "/>
			<caption id="caption76" class="list_cap02" style="left:103px; top:0px; width:185px; height:25px; text-align:center; "/>
			<caption id="caption77" class="list_cap01" style="left:0px; top:0px; width:105px; height:25px; text-align:center; ">총소모량</caption>
			<caption id="caption78" class="list_cap01" style="left:0px; top:24px; width:105px; height:25px; text-align:center; ">파지율</caption>
			<caption id="caption80" class="list_cap02" style="left:384px; top:24px; width:180px; height:25px; text-align:center; "/>
			<input id="input4" ref="/root/resData/resForm/totPrtWgt" format="#,###" style="left:111px; top:4px; width:115px; height:18px; text-align:right; "/>
			<input id="input5" ref="/root/resData/resForm/pajiYual" style="left:111px; top:28px; width:115px; height:18px; text-align:right; "/>
			<caption id="caption100" class="list_cap01" style="left:285px; top:24px; width:105px; height:25px; text-align:center; ">이론중량</caption>
			<caption id="caption104" class="list_cap01" style="left:285px; top:0px; width:105px; height:25px; text-align:center; ">41기타 발생량</caption>
			<caption id="caption96" class="list_cap01" style="left:563px; top:0px; width:110px; height:25px; text-align:center; ">총파지량</caption>
			<caption id="caption108" class="list_cap01" style="left:563px; top:24px; width:110px; height:25px; text-align:center; ">평량</caption>
			<caption id="caption112" class="list_cap02" style="left:672px; top:24px; width:240px; height:25px; text-align:center; "/>
			<input id="input7" ref="/root/resData/resForm/thoWgt" format="#,###" style="left:400px; top:27px; width:115px; height:18px; text-align:right; "/>
			<input id="input17" ref="/root/resData/resForm/avgYang" style="left:681px; top:28px; width:115px; height:18px; text-align:right; "/>
			<input id="input2" ref="/root/resData/resForm/gitaPajiWgt" format="#,###" style="left:399px; top:4px; width:115px; height:18px; text-align:right; "/>
			<input id="input3" ref="/root/resData/resForm/totPajiWgt" format="#,###" style="left:680px; top:4px; width:115px; height:18px; text-align:right; "/>
		</group>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData2/record" visibility="hidden" colsep="^" datatype="delimeter" mergecellsfixedrows="bycolrec" rowsep="|" selectionmode="free" style="left:10px; top:340px; width:910px; height:245px; ">
			<col/>
		</datagrid>
		<group id="group4" class="gro_btn" style="left:10px; top:55px; width:925px; height:21px; ">
			<button id="button6" class="btn04" style="left:696px; top:0px; width:88px; height:21px; ">
				<caption>제작이상건</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model1.setValue("/root/reqData/fwdData", "POPUP");
					
					window.load("MT_PAPINOUT_4100.xrw", "modal" , "", "left:100; top:100; width:895; height:575; align:center;sysmenu:hidden; min:hidden; max:hidden; resize:false; caption:hidden;"
						                     , "/root/reqData/fwdData", "/root/reqData/fwdData");
				 	 
					]]>
				</script>
			</button>
			<button id="button8" class="btn02" style="left:843px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//window.close();  
						viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					]]>
				</script>
			</button>
			<button id="button9" class="btn03" style="left:413px; top:0px; width:60px; height:21px; ">
				<caption>공장마감</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							 if(  commReqCheck(group6) == false ) return;
							 
							 var clos_clsf = model1.getValue("/root/reqData/searchData/clos_yn");
							 
							 if( clos_clsf != '00'){
							 	alert("마감 상태를 확인 하세요");
							 	return;
							 }
							 if( window.alert("마감 처리 하시겠습니까? ", "확인", 1) != 1 ){
							 	return;
							 }
							 
							 model1.send("mt_papinout_3007");
							 
							 if(submit_completed()) {
							     		button4.dispatch("onclick");
							 }
					]]>
				</script>
			</button>
			<button id="button1" class="btn02" style="left:297px; top:0px; width:52px; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					             var cnt = Number(model1.getValue("/root/resData/resForm/cnt"));
					             var sub_seq = model1.getValue("/root/resData/gitaPajiData/sub_seq");
					             var  flag = 0;
					             
					             if( model1.getValue("/root/resData/gitaPajiData/pj_wgt") != '' ){
							             if ( model1.getValue("/root/resData/gitaPajiData/pj_wgt").CheckNum()  == false ) {
							             		 	alert("기타 파지량 데이터를 확인해주세요");
							             		 	return ;
							             }
							             if( model1.getValue("/root/resData/gitaPajiData/etc_pj_resn_cd") == '' ){
							             	              alert("기타 파지 사유를 입력해 주세요");
							             	              return;
							             }
					             }
					             
					             if( datagrid3.rows < 1 ) {
					             	 alert("입력 할 매체 내역이 없습니다.");
					             	 return ;
					             }
					             
//					             model1.send("mt_papinout_3006");
//					             		 
//					             var magam_flag1 = model1.getValue("/root/tempData/qnt_clos");       // 매체 소모량 입력 마감 여부 
//					             var magam_flag2 = model1.getValue("/root/tempData/cnsm_clos");   // 용지 총소모 마감 여부  		  
					             // 마감 여부 확인 
					             var clos_clsf = model1.getValue("/root/reqData/searchData/clos_yn");
					             if( clos_clsf != '99' &&  clos_clsf != '00' ){
					             		alert("마감 여부를 확인하세요");
					             		return;
					             }
					              
					             
					             if  ( clos_clsf == '00' ) {
					           //  		 if( window.alert("매체별 소모내역 및 용지 총소모 내역이 존재 합니다.\n삭제 후 재 입력 하세요", "조선일보 MIS", 1) != 1){
					           //  		 	return ;
					           //  		 }
					           
					          		 alert("매체별 소모내역 및 용지 총소모 내역이 존재 합니다.\n삭제 후 재 입력 하세요", "조선일보 MIS");
					          		 return;
					             }
					             else if ( clos_clsf == '99'){
					             		 if( window.alert("매체별 소모내역 및 용지 총소모 내역을 입력 하시겠습니까?", "조선일보 MIS", 1) != 1){
					             		 	return ;
					             		 }
					             }	 
					            
					            model1.makeNode("/root/reqData/searchData/mutiupdate1");
					            var headData = "medi_cd_head#sect_cd_head#paper_clsf_head#issu_pcnt_head#slip_qty_head#somo_wgt_head#somo_paji_head#avgynag_head#prt_clsf#prt_dt";
					            
 				                   var gridData = "";
 				                   var tempgridData = "";
 				                   var gridRow = 0;
					            //alert(sumRow, sumCol);
					            var sum_wgt = 0 ;
					            
					            for( var i = 1 ; i < datagrid1.rows; i++){
					            	        var medi_cd  = datagrid1.valueMatrix(i, 2).substr(0, 3);
					            	        var sect_cd   = datagrid1.valueMatrix(i, 3).substr(0, 4);
					            	        var prt_clsf    = datagrid1.valueMatrix(i, 11);
					            	        var prt_dt      = datagrid1.valueMatrix(i, 12);
					            	        
					            	        var hdqt_paper_clsf    = datagrid1.valueMatrix(i, 1).substr(0, 2);
					            	        var gr3_sum_wgt = 0 ;
					            	        
					            	        for ( var ii = 1 ; ii < datagrid3.rows; ii++){
					            	        	if( hdqt_paper_clsf == '01' ) { 
						            	        	if( medi_cd == datagrid3.valueMatrix(ii , 1 ) && sect_cd  == datagrid3.valueMatrix(ii , 2) && prt_clsf == datagrid3.valueMatrix(ii, 7) && prt_dt == datagrid3.valueMatrix(ii, 8) && hdqt_paper_clsf == datagrid3.valueMatrix(ii, 6)) {
						            	        			gr3_sum_wgt = gr3_sum_wgt + Number(datagrid3.valueMatrix(ii , 5 ));
						            	        	}
					            	        		else { continue ; }
					            	        	} else if( hdqt_paper_clsf == '05' ) { 
						            	        	if( medi_cd == datagrid3.valueMatrix(ii , 1 ) && sect_cd  == datagrid3.valueMatrix(ii , 2) && prt_clsf == datagrid3.valueMatrix(ii, 7) && prt_dt == datagrid3.valueMatrix(ii, 8) && hdqt_paper_clsf == datagrid3.valueMatrix(ii, 6)) {
						            	        			gr3_sum_wgt = gr3_sum_wgt + Number(datagrid3.valueMatrix(ii , 5 ));
						            	        	}
					            	        		else { continue ; }
					            	        	} else {
					            	        		if( medi_cd == datagrid3.valueMatrix(ii , 1 ) && sect_cd  == datagrid3.valueMatrix(ii , 2) && prt_clsf == datagrid3.valueMatrix(ii, 7) ){
						            	        			gr3_sum_wgt = gr3_sum_wgt + Number(datagrid3.valueMatrix(ii , 5 ));
						            	        	}
						            	        	else { continue ; }
					            	        	}
					            	        }
					            	       
					            		gridData =datagrid1.valueMatrix(i, 2).substr(0, 3) + "#" + datagrid1.valueMatrix(i, 3).substr(0, 4) + "#" +   datagrid1.valueMatrix(i, 1).substr(0,2) + "#" + datagrid1.valueMatrix(i, 5) + "#" + datagrid1.valueMatrix(i, 8) +  "#" + datagrid1.valueMatrix(i, 9)  +  "#" + gr3_sum_wgt  +  "#" + datagrid1.valueMatrix(i, 10) + "#" + datagrid1.valueMatrix(i,11) + "#" + datagrid1.valueMatrix(i,12);
					            		//alert(gridData);
					            		if( hdqt_paper_clsf == '01' ) { 
					            		           headData = headData + "|" + gridData; 
					            		           sum_wgt = 0;
					            		           tempgridData = "";
					            		           gridData = "";
					            		}else {
					            			  if( gridRow == 0 ) {
					            		          		tempgridData = gridData;
					            		          		sum_wgt = gr3_sum_wgt;
					            		           		gridRow =   i;
					            			  } else {
					            			  	          if(datagrid1.valueMatrix(gridRow, 2).substr(0, 3) != medi_cd  || datagrid1.valueMatrix(gridRow, 3).substr(0, 4) != sect_cd){
					            			  	                    if( gridRow == (i -1) ){
					            			  	          	      	   headData = headData + "|" + tempgridData; 
					            			  	          		   gridRow =   i;
					            			  	          		   
					            			  	          		   sum_wgt = gr3_sum_wgt;
					            			  	          		   tempgridData = gridData;
					            			  	          	      } else{
						            			  	          	      	   var mn = 0 ;
						            			  	          	      	   var busu = 0;
						            			  	          	      	   var prtwgt = 0 ;
						            			  	          	      	   for ( var k = gridRow ; k < i ; k++){
							            			  	          	      	   	mn = mn + Number(datagrid1.valueMatrix(k, 5 )) ;
							            			  	          	      	   	busu = busu + Number(datagrid1.valueMatrix(k, 8 )) ;
							            			  	          	      	   	prtwgt = prtwgt + Number(datagrid1.valueMatrix(k, 9 )) ;
						            			  	          	      	   }
						            			  	          	      	   tempgridData = datagrid1.valueMatrix(gridRow, 2).substr(0, 3) + "#" + datagrid1.valueMatrix(gridRow, 3).substr(0, 4) + "#" +   datagrid1.valueMatrix(gridRow, 1).substr(0,2) + "#" + mn + "#" + busu +  "#" +  prtwgt  +  "#" + sum_wgt  +  "#" +  datagrid1.valueMatrix(gridRow,10) + "#" + datagrid1.valueMatrix(gridRow,11) + "#" + datagrid1.valueMatrix(i,12);
							            			  	          	   headData = headData + "|" + tempgridData; 
					            			  	          		           sum_wgt = gr3_sum_wgt;
						            			  	          		   gridRow =   i;
						            			  	          		   tempgridData= gridData;
					            			  	          	      } 
					            			  	          }
					            			  	          else {
					            			  	          	sum_wgt = sum_wgt + gr3_sum_wgt ;
					            			  	          }
					            			    }          
			            			  	           if (datagrid1.rows -1 == i ) {
			            			  	           	     if( gridRow ==  i  ){
			            			  	           	     	  //alert(tempgridData);
			            			  	          	      	   headData = headData + "|" + tempgridData; 
			            			  	          	     } else{
			            			  	          	      	   var mn = 0 ;
			            			  	          	      	   var busu = 0;
			            			  	          	      	   var prtwgt = 0 ;
			            			  	          	      	   for ( var k = gridRow ; k <=  i ; k++){
				            			  	          	      	   	mn = mn + Number(datagrid1.valueMatrix(k, 5 )) ;
				            			  	          	      	   	busu = busu + Number(datagrid1.valueMatrix(k, 8 )) ;
				            			  	          	      	   	prtwgt = prtwgt + Number(datagrid1.valueMatrix(k, 9 )) ;
			            			  	          	      	   }
			            			  	          	      	   
			            			  	          	      	   tempgridData = datagrid1.valueMatrix(gridRow, 2).substr(0, 3) + "#" + datagrid1.valueMatrix(gridRow, 3).substr(0, 4) + "#" +   datagrid1.valueMatrix(gridRow, 1).substr(0,2) + "#" + mn + "#" + busu +  "#" +  prtwgt  +  "#" + sum_wgt  +  "#" +  datagrid1.valueMatrix(gridRow,10) + "#" + datagrid1.valueMatrix(gridRow,11) + "#" + datagrid1.valueMatrix(i,12);
			            			  	          	          headData = headData + "|" + tempgridData; 
			            			  	          	      } 
			            			  	               
			            			  	          }
					          	 }     // if end 	            
					            } // for end 
					            //alert(headData);
					             model1.setValue("/root/reqData/searchData/mutiupdate1", headData );
					            
					            // 데이터 입력 
					            for( var i = 1 ; i < datagrid3.rows ; i++){
					            		datagrid3.rowStatus(i) = 3;
					            }
					             var mulidataStr = datagrid3.getUpdateData();
						     model1.makeNode("/root/reqData/searchData/mutiupdate2");		        
						     model1.setValue("/root/reqData/searchData/mutiupdate2", mulidataStr );
						     
						     model1.makeNode("/root/reqData/searchData/gita_pj_wgt");  
						     model1.makeNode("/root/reqData/searchData/etc_pj_resn_cd");  
						     model1.makeNode("/root/reqData/searchData/remk");
						     
						     model1.setValue("/root/reqData/searchData/gita_pj_wgt", model1.getValue("/root/resData/gitaPajiData/pj_wgt"));
						     model1.setValue("/root/reqData/searchData/etc_pj_resn_cd", model1.getValue("/root/resData/gitaPajiData/etc_pj_resn_cd"));
						     model1.setValue("/root/reqData/searchData/remk", model1.getValue("/root/resData/gitaPajiData/remk"));
						    
						     model1.makeNode("/root/reqData/searchData/totprtwgt");
						     var totPrtWgt = 0 ;
						     for( var i = 1 ; i < datagrid1.rows; i++){
						     		totPrtWgt = totPrtWgt + Number(datagrid1.valueMatrix(i, 9 ));
						     }
						  
						     var  sumRow = 0;
 					            var sumCol   = 0;
 					            
 					            for(var i = 1 ; i < datagrid2.row;i++){
 					            		if( datagrid2.valueMatrix(i, 0) == '합계 (KG)' ){
 					            		     sumRow = i;
 					            		     break;
 					            		}
 					            }
 					            
 					            for( var ii = 0 ; ii < datagrid2.cols;ii++){
 			            		     		var head_1 = datagrid2.valueMatrix(0, ii);
 			            		     		var head_2 = datagrid2.valueMatrix(1, ii);
 			            		     		 if ( head_1 == '총파지량' && head_2 == '중량'){
 			            		     				sumCol = ii;
 			            		     				break;
 			            		     		} 
 				                    }
						     totPrtWgt = totPrtWgt + Number(datagrid2.valueMatrix(sumRow, sumCol ));
						    
						     model1.setValue("/root/reqData/searchData/totprtwgt" ,   totPrtWgt);
 						     
 						     model1.send("mt_papinout_3005");
 						     if(submit_completed()) {
 						     		button4.dispatch("onclick");
 						     }
					]]>
				</script>
			</button>
			<button id="button2" class="btn02" style="left:192px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
					if( datagrid2.rows > 2 ) {  datagrid2.rows = 2; }
					model1.reset();
					]]>
				</script>
			</button>
			<button id="button3" class="btn02" style="left:357px; top:0px; width:53px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						     var clos_clsf = model1.getValue("/root/reqData/searchData/clos_yn");     
						     
						     if( clos_clsf == '99') {
						     		alert("삭제 할 데이터가 없습니다");
						     		return;
						     } else if( clos_clsf == '01' || clos_clsf == '02') {
						     		alert( ( ( clos_clsf ==  '01') ? '공장' : '자재' ) + "마감 된 데이터 입니다.\n마감 취소 후 삭제 하실수 있습니다.");
						     		return;
						     } 
						     
						     model1.send("mt_papinout_3004");
						     if(submit_completed()) {
						     		button4.dispatch("onclick");
						     }
					            
					]]>
				</script>
			</button>
			<button id="button4" class="btn02" CRUD="R" style="left:247px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						   if(  commReqCheck(group6) == false ) return;
						   
						   var fac_clsf = model1.getValue("/root/reqData/searchData/fac_clsf");
						   var issu_dt   = model1.getValue("/root/reqData/searchData/issu_dt");
						   
						   button2.dispatch("onclick");
						   
						   model1.setValue("/root/reqData/searchData/fac_clsf", fac_clsf);
						   model1.setValue("/root/reqData/searchData/issu_dt" , issu_dt);
						   
						   group6.refresh();
						   // 이전 단계 
						   
						   model1.send("mt_papinout_3003");
						   
						   model1.setValue("/root/reqData/searchData/magam_state", model1.getValue("/root/tempData/magam_state"));
						   model1.setValue("/root/reqData/searchData/magam_dt", model1.getValue("/root/tempData/magam_dt"));
						   output1.refresh();
						   output2.refresh();
						   
						   
						   var dpnc_yn = model1.getValue("/root/tempData/dpcn_clsf");
						   // 1. 전체 발행 내역 존재 여부 
						   if  ( dpnc_yn == 'N' ){
						   	alert("해당 일자의 전체 발행 내역이 존재 하지 않습니다.\n전체 발행내역을 선행 처리 해주세요");
						   	return ;
						   }
						   
						   var paji_clsf = model1.getValue("/root/tempData/paji_clsf");
						   
						   if ( paji_clsf == 'N' ){
						   	           alert("해당 일자의 용지일일재고 관리에 파지량이 입력 되지 않았습니다.\n용지 일일재고 관리 작업 후 작업 하세요");
						   	           return;
						   }else if ( paji_clsf == 'Y' ) {
						   		 // 2. 인쇄용지 일일 재고 관리 등록 여부 확인 
						   		var clos_clsf = model1.getValue("/root/tempData/clos_clsf");
						   		if ( clos_clsf == '00' ) {
						   			 alert("해당 일자의 용지일일재고 관리 마감 처리 후 잡업 하세요.\n 용지 일일재고 관리 작업 후 작업 하세요");
						   			 return;
						   		}
						   }else {
						   }
						   
						   // 매체별 소모내역 입력 여부 및 마감 상태 
						   // 99 미입력 상태 
						   // 00 입력 상태
						   // 01 공장 마감
						   // 02 자재 마감
						 //  alert(model1.getValue("/root/tempData/mqnt_clos_clsf"));
						   model1.setValue("/root/reqData/searchData/clos_yn", model1.getValue("/root/tempData/mqnt_clos_clsf"));
						   
						   //99 일때 용지 총소모도 미 존재
						   
					           model1.send("mt_papinout_3002");
				
					           if(submit_completed()) {
					           
								           model1.copyNode("/root/resData/gridData",  "/root/tempData/gridData");
								           datagrid1.refresh();
								           
								           model1.setValue("/root/resData/resForm/totPrtWgt" ,model1.getValue("/root/tempData/prtWgt"));
								           model1.setValue("/root/resData/resForm/gitaPajiWgt" ,model1.getValue("/root/tempData/gitaPjWgt"));
								           model1.setValue("/root/resData/resForm/totPajiWgt" ,model1.getValue("/root/tempData/totPjWgt"));
								           model1.setValue("/root/resData/resForm/thoWgt" ,model1.getValue("/root/tempData/tot_thoWgt"));
								           model1.setValue("/root/resData/resForm/pajiYual" , model1.getValue("/root/tempData/pajiYul") );
								           
								           var pageCnt = 0;  //면수 
								           var printCnt =  0; //부수 
								           var sumData = 0;
								           var toThoWgt = model1.getValue("/root/tempData/tot_thoWgt");
								           
								           for ( var i = 1 ; i < datagrid1.rows; i++){
								           	       var gubun =  datagrid1.valueMatrix(i,1).substr(0, 2);
								           	      // alert(gubun+ "@@");
								           	       var pagegubun =  datagrid1.valueMatrix(i,4);
								           	       
								           	       if ( gubun == '02' || gubun == '04' ) continue;
								           	        
								           		pageCnt = Number(datagrid1.valueMatrix(i,5));
								           		if( pagegubun == 'T' ) { pageCnt / 2; }
								           		
								           		printCnt  = Number(datagrid1.valueMatrix(i,8));
								           	       sumData = sumData + ( pageCnt * printCnt);
								           }
								           
								           //var avgYul = "" +  (Number(toThoWgt) * 4000)  / sumData;
								           //avgYul =  avgYul.substr(0, avgYul.indexOf(".") + 4);
								           
								           var avgYul = "";
								           if( datagrid1.rows > 1) {
								           		avgYul = datagrid1.valueMatrix(1, 10);
								           }
								           
								           model1.setValue("/root/resData/resForm/avgYang", avgYul );
								           
								           group2.refresh();
								           
								           model1.copyNode("/root/resData/gridData3",  "/root/tempData/gridData2");
								           datagrid3.refresh();
								           
								           
								           model1.copyNode("/root/resData/gridData2/col",  "/root/tempData/gridData3");
								           			           
								           model1.copyNode("/root/resData/gitaPajiData", "/root/tempData/gridGitaPaji");
								           
								           if( model1.getValue("/root/resData/gitaPajiData/sub_seq") != '') {
								           	          group1.disabled = true;
								           }else {    group1.disabled = false} ;
								           
								           group1.refresh();
								           model1.setValue("/root/resData/resForm/cnt" , model1.getValue( "/root/tempData/cnt"));
								           //model1.send("mt_papinout_3017");
										   model1.send("mt_papinout_3018");   
								          
								           //if( datagrid3.valueMatrix(1, 0 ) != '0' ){
 						     		             		 //datagrid2ValueSet();
														datagrid4ValueSet(); 
								           //}
 						    			               
			  						
					           }
					           
					]]>
				</script>
			</button>
			<button id="button5" class="btn02" style="left:787px; top:0px; width:52px; height:21px; ">
				<caption>외간등록</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						window.load("MT_PAPINOUT_3100.xrw", "modal" , "", "left:100; top:100; width:946; height:728; align:center;sysmenu:hidden; min:hidden; max:hidden; resize:false; caption:hidden;"
						                     , "", "");
					
					]]>
				</script>
			</button>
			<button id="button7" class="btn04" style="left:477px; top:0px; width:75px; height:21px; ">
				<caption>공장마감취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							 if(  commReqCheck(group6) == false ) return;
							  var clos_clsf = model1.getValue("/root/reqData/searchData/clos_yn");
							  
							  if( clos_clsf != '01'){
							 	alert("마감 상태를 확인 하세요");
							 	return;
							 }
							 if( window.alert("마감 취소 처리 하시겠습니까? ", "확인", 1) != 1 ){
							 	return;
							 }
							 
							 model1.send("mt_papinout_3012");
							 
							 if(submit_completed()) {
							     		button4.dispatch("onclick");
							 }
					]]>
				</script>
			</button>
			<button id="button10" class="btn04" style="left:617px; top:0px; width:75px; height:21px; ">
				<caption>자재마감취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							 if(  commReqCheck(group6) == false ) return;
							  var clos_clsf = model1.getValue("/root/reqData/searchData/clos_yn");
							  if( clos_clsf != '02'){
							 	alert("마감 상태를 확인 하세요");
							 	return;
							 }
							 if( window.alert("마감 취소 처리 하시겠습니까? ", "확인", 1) != 1 ){
							 	return;
							 }
							 
							 model1.send("mt_papinout_3014");
							 
							 if(submit_completed()) {
							     		button4.dispatch("onclick");
							 }
					]]>
				</script>
			</button>
			<button id="button11" class="btn03" style="left:554px; top:0px; width:60px; height:21px; ">
				<caption>자재마감</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							 if(  commReqCheck(group6) == false ) return;
							 
							 var clos_clsf = model1.getValue("/root/reqData/searchData/clos_yn");
							 
							 if( clos_clsf != '01'){
							 	alert("마감 상태를 확인 하세요");
							 	return;
							 }
							 if( window.alert("마감 처리 하시겠습니까? ", "확인", 1) != 1 ){
							 	return;
							 }
							 
							 model1.send("mt_papinout_3013");
							 
							 if(submit_completed()) {
							     		button4.dispatch("onclick");
							 }
					]]>
				</script>
			</button>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" caption="발행일자^외간구분^매체^섹션^규격^면수^컬러^흑백^부수^인쇄량^평량^섹션SEQ^인쇄일자" colsep="^" colwidth="100, 83, 101, 113, 51, 75, 65, 69, 64, 68, 68, 58" mergecellsfixedrows="bycolrec" rowsep="|" style="left:10px; top:130px; width:915px; height:125px; ">
			<col ref="issu_dt" format="yyyy-mm-dd"/>
			<col ref="paper_clsf" style="text-align:left; "/>
			<col ref="medi_cd" style="text-align:left; "/>
			<col ref="sect_cd" style="text-align:left; "/>
			<col ref="pap_std"/>
			<col ref="issu_pcnt" format="#,###" style="text-align:right; "/>
			<col ref="clr_pcnt" format="#,###" style="text-align:right; "/>
			<col ref="bw_pcnt" format="#,###" style="text-align:right; "/>
			<col ref="slip_qty" format="#,###" style="text-align:right; "/>
			<col ref="somo_wgt" format="#,###" style="text-align:right; "/>
			<col ref="avgynag" style="text-align:right; "/>
			<col ref="prt_clsf" visibility="hidden"/>
			<col ref="prt_dt" visibility="hidden"/>
		</datagrid>
		<group id="group1" class="gro_sel" style="left:10px; top:605px; width:909px; height:30px; background-color:#ffffff; ">
			<caption id="caption1" class="list_cap02" style="left:565px; top:0px; width:332px; height:25px; text-align:center; "/>
			<caption id="caption2" class="list_cap02" style="left:315px; top:0px; width:249px; height:25px; text-align:center; "/>
			<caption id="caption4" class="list_cap02" style="left:103px; top:0px; width:185px; height:25px; text-align:center; "/>
			<caption id="caption5" class="list_cap01" style="left:0px; top:0px; width:105px; height:25px; text-align:center; ">기타파지량(KG)</caption>
			<input id="input1" ref="/root/resData/gitaPajiData/pj_wgt" format="#,###" style="left:111px; top:4px; width:115px; height:18px; text-align:right; "/>
			<caption id="caption9" class="list_cap01" style="left:235px; top:0px; width:105px; height:25px; text-align:center; ">기타파지 사유</caption>
			<caption id="caption10" class="list_cap01" style="left:470px; top:0px; width:110px; height:25px; text-align:center; ">기타파지 사유 비고</caption>
			<select1 id="combo2" ref="/root/resData/gitaPajiData/etc_pj_resn_cd" appearance="minimal" style="left:349px; top:4px; width:115px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/gitaPaji/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<input id="input12" ref="/root/resData/gitaPajiData/remk" style="left:584px; top:4px; width:306px; height:18px; text-align:left; "/>
		</group>
		<datagrid id="datagrid3" nodeset="/root/resData/gridData3/record" visibility="hidden" caption="medi_cd^sect_cd^pj_kind^pj_cnt^pj_wgt^hqt_paper_clsf^prt_clsf^prt_dt" colsep="#" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:65px; top:640px; width:825px; height:55px; ">
			<col ref="medi_cd"/>
			<col ref="sect_cd"/>
			<col ref="pj_kind"/>
			<col ref="pj_cnt"/>
			<col ref="pj_wgt"/>
			<col ref="hdqt_paper_clsf"/>
			<col ref="prt_clsf"/>
			<col ref="prt_dt"/>
		</datagrid>
		<datagrid id="datagrid4" nodeset="/root/resData/gridData4/record" caption="코드명^총파지량^총파지량^본사^본사^스포츠^스포츠^본사용지외간^본사용지외간^본사외용지외간^본사외용지외간^분사용지(54g)-외간제외^분사용지(54g)-외간제외|코드명^개^중량^개^중량^개^중량^개^중량^개^중량^개^중량" colsep="^" colwidth="75, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70" mergecellsfixedrows="bycolrec" rowsep="|" style="left:10px; top:340px; width:915px; height:245px; ">
			<col ref="pj_kind_nm"/>
			<col ref="cnt00" format="#.#,###" style="text-align:right; "/>
			<col ref="wgt00" format="#.#,###" style="text-align:right; "/>
			<col ref="cnt01" format="#.#,###" style="text-align:right; "/>
			<col ref="wgt01" format="#.#,###" style="text-align:right; "/>
			<col ref="cnt02" format="#.#,###" style="text-align:right; "/>
			<col ref="wgt02" format="#.#,###" style="text-align:right; "/>
			<col ref="cnt03" format="#.#,###" style="text-align:right; "/>
			<col ref="wgt03" format="#.#,###" style="text-align:right; "/>
			<col ref="cnt04" format="#.#,###" style="text-align:right; "/>
			<col ref="wgt04" format="#.#,###" style="text-align:right; "/>
			<col ref="cnt05" format="#.#,###" style="text-align:right; "/>
			<col ref="wgt05" format="#.#,###" style="text-align:right; "/>
		</datagrid>
	</xhtml:body>
</xhtml:html>
