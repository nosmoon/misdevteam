<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<pageInfo>
							<pageID/>
						</pageInfo>
						<comboSet>
							<cnsg>
								<item>
									<label/>
									<value/>
								</item>
							</cnsg>
							<medt_cd>
								<item>
									<label/>
									<value/>
								</item>
							</medt_cd>
							<papcmpy_cd>
								<item>
									<label/>
									<value/>
								</item>
							</papcmpy_cd>
							<sect_cd>
								<item>
									<label/>
									<value/>
								</item>
							</sect_cd>
							<prt_clsf>
								<item/>
							</prt_clsf>
						</comboSet>
					</initData>
					<resData>
						<gridData>
							<record>
								<psplat_clsf/>
								<use_qunt/>
								<nul_plat_cnt/>
								<psplat_fee/>
								<psbg/>
								<gnaw_fee/>
								<sbbg/>
								<seq/>
								<occr_dt/>
								<sub_seq/>
							</record>
						</gridData>
						<curlist2>
							<record>
								<data/>
							</record>
						</curlist2>
						<curlist3>
							<film_use_qunt/>
							<ink_use_qunt/>
							<seq_curlist3/>
							<occr_dt_curlist3/>
							<dest_qunt/>
							<prd_cnt/>
							<prt_bgn_tm/>
							<prt_end_tm/>
						</curlist3>
						<curlist4>
							<record>
								<leas_use_fee/>
								<paper_amt/>
								<psplat_use_amt/>
								<gnaw_fee/>
								<film/>
								<pack_fee/>
								<paper_portage/>
								<total/>
								<occr_dt_curlist4/>
								<seq_curlist4/>
								<dest_fee/>
								<base_leas_fee/>
								<real_leas_fee/>
								<etc_matr_fee/>
								<ink_use_amt/>
							</record>
						</curlist4>
						<curlist5>
							<record>
								<issu_qty/>
								<issu_pcnt/>
								<bw_pcnt/>
								<clr_pcnt/>
								<paper_uprc/>
								<tot_bw_pcnt/>
								<tot_clr_pcnt/>
								<total/>
								<pap_std/>
								<pj_wgt/>
								<prt_wgt/>
								<prt_pj_rate/>
								<logic_wgt/>
								<hdqt_paper_clsf/>
							</record>
						</curlist5>
						<curlist6>
							<record>
								<film_make_fee/>
								<pack_fee/>
								<paper_portage/>
								<pj_basi_qty/>
								<prt_pj_rate_bw/>
								<prt_pj_rate/>
								<paper_wgt/>
								<dest_fee/>
								<base_leas_fee/>
								<real_leas_fee/>
								<etc_matr_fee_bw/>
								<etc_matr_fee_clr/>
								<leas_use_fee_bw/>
								<leas_use_fee_clr/>
								<bgn_tm/>
								<end_tm/>
							</record>
						</curlist6>
						<resForm>
							<temp/>
							<issu_dt/>
							<del/>
							<prt_cost_col/>
							<prt_cost_bw/>
						</resForm>
						<multiUpData1/>
						<multiUpData4/>
						<gridData9>
							<record>
								<ink_matr/>
								<matr_nm/>
								<ink_uprc/>
								<qunt/>
								<ink_fee/>
								<occr_dt/>
								<seq/>
								<sub_seq/>
							</record>
						</gridData9>
						<film_qunt/>
					</resData>
					<reqData>
						<searchData>
							<issu_dt/>
							<prt_dt/>
							<fac_clsf/>
							<medi_cd/>
							<papcmpy_cd/>
							<sect_cd/>
							<prt_clsf/>
						</searchData>
						<reqForm>
							<prt_dt/>
							<issu_dt/>
							<fac_clsf/>
							<medi_cd/>
							<sect_cd/>
							<prt_clsf/>
							<film_use_qunt/>
							<ink_use_qunt/>
							<dest_qunt/>
							<prd_cnt/>
							<prt_fee/>
							<psplat_use_amt/>
							<gnaw_fee/>
							<film_make_fee/>
							<pack_fee/>
							<issu_qty/>
							<issu_pcnt/>
							<bw_pcnt/>
							<clr_pcnt/>
							<paper_wgt/>
							<clr_prt_fee/>
							<bw_prt_fee/>
							<occr_dt/>
							<seq/>
							<sub_seq_1/>
							<papcmpy_cd/>
							<paper_amt/>
							<multiUpData1/>
							<mode/>
							<leas_use_fee/>
							<base_leas_fee/>
							<real_leas_fee/>
							<ink_use_amt/>
							<etc_matr_fee/>
							<dest_fee/>
							<prt_bgn_tm/>
							<prt_end_tm/>
							<multiUpData2/>
						</reqForm>
					</reqData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					function load(){
						model.copyNode("/root/initData/pageInfo",parent.root.initData.pageInfo);
						model1.setValue("/root/reqData/searchData/issu_dt" ,getDate("yyyymmdd"));
						model1.setValue("/root/reqData/searchData/prt_dt" , getDate("yyyymmdd"));
						model.setValue("/root/reqData/searchData/medi_cd", "610");
						
						// 스포츠조선 셋팅
						//model1.setValue("/root/reqData/searchData/issu_dt" ,"20090801");
						//model1.setValue("/root/reqData/searchData/prt_dt" ,"20090801");
						//model1.setValue("/root/reqData/searchData/fac_clsf" ,"25");
						//model.setValue("/root/reqData/searchData/medi_cd", "610");
						//model.setValue("/root/reqData/searchData/sect_cd", "0001");
						//model.setValue("/root/reqData/searchData/prt_clsf", "01");
						
						// 정동 포커스 셋팅
						
						//model1.setValue("/root/reqData/searchData/issu_dt" ,"20090810");
						//model1.setValue("/root/reqData/searchData/prt_dt" ,"20090810");
						//model1.setValue("/root/reqData/searchData/fac_clsf" ,"10");
						//model.setValue("/root/reqData/searchData/medi_cd", "610");
						//model.setValue("/root/reqData/searchData/sect_cd", "0008");
						//model.setValue("/root/reqData/searchData/prt_clsf", "01");
						
						
						datagrid1.isReadOnly(1,2) = true;
						datagrid1.isReadOnly(1,3) = true;
						datagrid4.isReadOnly(1,2) = true;
						input4.disabled = true;
						input5.disabled = true;
						
						

						//model1.send("mt_prnpap_3402_M");
						//model1.copyNode("/root/initData/comboSet/sect_cd","/root/tempData/sect_cd");  // 섹션

//						input1.text = "20090313";
//						input2.text = "20090313";
//						combo1.value = "35";
//						combo3.value = "110";
						
						model1.refresh();
					}
					
					function make_prt_cost(){
						var tot_bw_pcnt		= eval(model.getValue("/root/resData/curlist5/record/tot_bw_pcnt"));
						var tot_clr_pcnt		= eval(model.getValue("/root/resData/curlist5/record/tot_clr_pcnt"));
						var bw_purc_1 			= eval(model.getValue("/root/resData/curlist2/record[1]/data"));
						var bw_purc_2 			= eval(model.getValue("/root/resData/curlist2/record[3]/data"));
						var clr_purc_1 		= eval(model.getValue("/root/resData/curlist2/record[2]/data"));
						var clr_purc_2 		= eval(model.getValue("/root/resData/curlist2/record[4]/data"));
						
						var basi_qty 			= eval(model.getValue("/root/resData/curlist2/record[5]/data"));
						var issu_qty 			= eval(model.getValue("/root/resData/curlist5/record/issu_qty"));
						var issu_pcnt 			= eval(model.getValue("/root/resData/curlist5/record/issu_pcnt"));
						var bw_pcnt 			= eval(model.getValue("/root/resData/curlist5/record/bw_pcnt"));
						var clr_pcnt 			= eval(model.getValue("/root/resData/curlist5/record/clr_pcnt"));
						var pap_std 			= model.getValue("/root/resData/curlist5/record/pap_std");
						
						var pap_uprc 			= 0;
						if (model.getValue("/root/resData/curlist5/record/paper_portage") != ""){
							pap_uprc			= eval(model.getValue("/root/resData/curlist5/record/paper_portage"));
						}
						//alert(model.getValue("/root/resData/curlist5/record/tot_bw_pcnt") + "_\n" + model.getValue("/root/resData/curlist5/record/tot_clr_pcnt") + "_\n" + model.getValue("/root/resData/curlist6/record/pj_basi_qty"));
						//alert(model.getValue("/root/resData/curlist6/record/paper_portage") + "_\n" + model.getValue("/root/resData/curlist6/record/pack_fee") + "_\n" + model.getValue("/root/resData/curlist6/record/paper_wgt"));
						//alert(model.getValue("/root/resData/curlist6/record/prt_pj_rate_bw_1"));
						
						var tot_bw_pcnt		= eval(model.getValue("/root/resData/curlist5/record/tot_bw_pcnt"));
						var tot_clr_pcnt		= eval(model.getValue("/root/resData/curlist5/record/tot_clr_pcnt"));
						
						var pj_basi_qty 		= eval(model.getValue("/root/resData/curlist6/record/pj_basi_qty"));
						var paper_portage		= eval(model.getValue("/root/resData/curlist6/record/paper_portage"));
						var pack_fee			= eval(model.getValue("/root/resData/curlist6/record/pack_fee"));
						var pap_wgt 			= eval(model.getValue("/root/resData/curlist6/record/paper_wgt"));
						var prt_pj_rate_bw_1	= eval(model.getValue("/root/resData/curlist6/record/prt_pj_rate_bw_1"));
						//var prt_pj_rate_bw_2	= eval(model.getValue("/root/resData/curlist6/record/prt_pj_rate_bw_2"));
						var prt_pj_rate_bw_2	= 0;
						var prt_pj_rate_clr_1	= eval(model.getValue("/root/resData/curlist6/record/prt_pj_rate_clr_1"));
						var prt_pj_rate_clr_2	= eval(model.getValue("/root/resData/curlist6/record/prt_pj_rate_clr_2"));
						
						var prt_cost			= 0;
						var prt_cost_col		= 0;
						var prt_cost_bw		= 0;
						var pap_cost			= 0;
						var tot_pap_wgt		= 0;
						var tran_cost			= 0;
						var pack_cost			= 0;
						var leas_use_cost		= 0;
						var etc_matr_fee		= 0;
						var etc_matr_fee_bw		= eval(model.getValue("/root/resData/curlist6/record/etc_matr_fee_bw"));
						var etc_matr_fee_clr	= eval(model.getValue("/root/resData/curlist6/record/etc_matr_fee_clr"));
						
						leas_use_cost = ( (eval(model.getValue("/root/resData/curlist5/record/bw_pcnt")) * eval(model.getValue("/root/resData/curlist6/record/leas_use_fee_bw"))) + (eval(model.getValue("/root/resData/curlist5/record/clr_pcnt")) * eval(model.getValue("/root/resData/curlist6/record/leas_use_fee_clr"))) ) / 4000 * eval(model.getValue("/root/resData/curlist5/record/issu_qty"));
						if (pap_std == "T"){
							etc_matr_fee = Math.round(((bw_pcnt * issu_qty / 4000 * etc_matr_fee_bw) /2 ) + ((clr_pcnt * issu_qty / 4000 * etc_matr_fee_clr) /2 ));
						} else {
							etc_matr_fee = Math.round( (bw_pcnt * issu_qty / 4000 * etc_matr_fee_bw)  + ( clr_pcnt * issu_qty / 4000 * etc_matr_fee_clr) );
						}
						
						//ROUND((J6*L6/4000*472.5)/2+(K6*L6/4000*472.5)/2,0)
						
						model.setValue("/root/resData/curlist4/record/leas_use_fee", leas_use_cost);
						model.setValue("/root/resData/curlist4/record/etc_matr_fee", etc_matr_fee);
						
						model.refresh();
						if (model.getValue("/root/reqData/searchData/fac_clsf") == '70' || model.getValue("/root/reqData/searchData/fac_clsf") == '31'){
							
							if (issu_qty > basi_qty && basi_qty != 0){
								prt_cost = (((bw_pcnt * bw_purc_1) + (clr_pcnt * clr_purc_1)) * basi_qty / 4000) + (((bw_pcnt * bw_purc_2) + (clr_pcnt * clr_purc_2)) * (issu_qty - basi_qty) / 4000);
								if (pap_std == "T"){
									prt_cost = prt_cost * 0.5;
								}
								
								prt_cost_col = (clr_pcnt * clr_purc_1 * basi_qty / 4000) + (clr_pcnt * clr_purc_2 * (issu_qty - basi_qty) / 4000);
								if (pap_std == "T"){
									prt_cost_col = prt_cost_col * 0.5;
								}
								
							} else {
								prt_cost = ((bw_pcnt * bw_purc_1) + (clr_pcnt * clr_purc_1)) * issu_qty / 4000;
								if (pap_std == "T"){
									prt_cost = prt_cost * 0.5;
								}
								
								prt_cost_col = clr_pcnt * clr_purc_1 * issu_qty / 4000;
								if (pap_std == "T"){
									prt_cost_col = prt_cost_col * 0.5;
								}
								
							}
						} else {
							prt_cost = ((bw_pcnt * bw_purc_1) + (clr_pcnt * clr_purc_1)) * issu_qty / 4000;
							if (pap_std == "T"){
								prt_cost = prt_cost * 0.5;
							}
							prt_cost_col = clr_pcnt * clr_purc_1 * issu_qty / 4000;
							if (pap_std == "T"){
								prt_cost_col = prt_cost_col * 0.5;
							}
						}
						prt_cost_bw = prt_cost - prt_cost_col;
						
						if (prt_cost_bw > 0 && prt_cost_bw <= 1){
							prt_cost_col = prt_cost_col + 1;
							prt_cost_bw = 0;
						}
						
						//---------------
						//용지대,운송비
						//---------------
						//파지기준부수에 의해 계산한다.PajiGiZunBuSu PajiGiZunBuSu
						if (model.getValue("/root/reqData/searchData/fac_clsf") == '71'){
							if (issu_pcnt > pj_basi_qty){
								pap_cost = pj_basi_qty * issu_pcnt * (1 + prt_pj_rate_bw_1 / 100) + (issu_pcnt - pj_basi_qty) * issu_pcnt * (1 + prt_pj_rate_clr_1) * pap_uprc * pap_wgt / 4000;
								tot_pap_wgt 	= pj_basi_qty * issu_pcnt * (1 + prt_pj_rate_bw_1/100) + (issu_pcnt - pj_basi_qty) * issu_pcnt * (1 + prt_pj_rate_clr_1) * pap_wgt / 4000;
								tran_cost = pj_basi_qty * issu_pcnt * (1 + prt_pj_rate_bw_1/100) + (issu_pcnt - pj_basi_qty) * issu_pcnt * (1 + prt_pj_rate_clr_1) * paper_portage * pap_wgt /4000;
								
							} else {
								pap_cost = issu_qty * issu_pcnt * (1 + prt_pj_rate_bw_1 / 100) * pap_uprc * pap_wgt / 4000;
								tot_pap_wgt	= issu_qty * issu_pcnt * (1 + prt_pj_rate_bw_1/100) * pap_wgt / 4000;
								tran_cost 		= issu_qty * issu_pcnt * (1 + prt_pj_rate_bw_1/100) * paper_portage * pap_wgt / 4000;
							}
						} else if (model.getValue("/root/reqData/searchData/fac_clsf") == '73'){	//	제주 20081212 추가 pm실 김현수과장요청
							pap_cost		= Math.round((tot_bw_pcnt * (1 + prt_pj_rate_bw_1 / 100) + tot_clr_pcnt * (1 + prt_pj_rate_clr_1 / 100)) * pap_wgt / 4000) * pap_uprc;
							tot_pap_wgt	= Math.round((tot_bw_pcnt * (1 + prt_pj_rate_bw_1 / 100) + tot_clr_pcnt * (1 + prt_pj_rate_clr_1 / 100)) / 4000 * pap_wgt);
							tran_cost 	= Math.round((tot_bw_pcnt * (1 + prt_pj_rate_bw_1 / 100) + tot_clr_pcnt * (1 + prt_pj_rate_clr_1 / 100)) * pap_wgt / 4000) / 488 * paper_portage;
							tran_cost		= Math.round(tran_cost);
							//alert(tran_cost);
						} else {
							//용지대
							//alert(tot_bw_pcnt + "\n" + prt_pj_rate_bw_1 + "\n" + tot_clr_pcnt + "\n" + prt_pj_rate_clr_1 + "\n" + pap_wgt + "\n" + pap_uprc);
							pap_cost	= (tot_bw_pcnt * (1 + prt_pj_rate_bw_1 / 100) + tot_clr_pcnt * (1 + prt_pj_rate_clr_1 / 100)) * pap_wgt / 4000 * pap_uprc;
							tot_pap_wgt	= (tot_bw_pcnt * (1 + prt_pj_rate_bw_1 / 100) + tot_clr_pcnt * (1 + prt_pj_rate_clr_1 / 100)) / 4000 * pap_wgt;
							tran_cost 	= (tot_bw_pcnt * (1 + prt_pj_rate_bw_1 / 100) + tot_clr_pcnt * (1 + prt_pj_rate_clr_1 / 100)) / 488 * pap_wgt / 4000 * paper_portage;
							//alert((tot_bw_pcnt * (1 + prt_pj_rate_bw_1 / 100)) + "\n" + (tot_clr_pcnt * (1 + prt_pj_rate_clr_1 / 100)));
							//alert((tot_bw_pcnt * (1 + (prt_pj_rate_bw_1 / 100))) + "\n" + (tot_clr_pcnt * (1 + (prt_pj_rate_clr_1 / 100))));
						}
						if (pap_std == 'T'){
							tot_pap_wgt = tot_pap_wgt * 0.5;
						}
						
						pack_cost = (tot_bw_pcnt + tot_clr_pcnt) * pack_fee / 4000;
						if (pap_std == 'T'){
							pack_cost = pack_cost * 0.5;
						}
						tot_pap_wgt 	= Math.round(tot_pap_wgt * 1000)/1000;
						prt_cost_col	= Math.round(prt_cost_col * 100)/100;
						prt_cost_bw	= Math.round(prt_cost_bw * 100)/100;
						//alert("prt_cost=" + prt_cost);
						//model.setValue("/root/resData/curlist4/record/prt_fee", Math.round(prt_cost));
						//model.setValue("/root/resData/curlist4/record/paper_amt", pap_cost);
						model.setValue("/root/resData/curlist4/record/paper_portage", tran_cost);
						model.setValue("/root/resData/curlist4/record/pack_fee", pack_cost);
						//model.setValue("/root/resData/curlist3/paper_wgt", Math.round(tot_pap_wgt));
						
						//alert("prt_cost_col=" + prt_cost_col + "\nprt_cost_bw=" + prt_cost_bw);
						model.setValue("/root/resData/resForm/prt_cost_col", prt_cost_col);
						if (bw_pcnt == 0){
							model.setValue("/root/resData/resForm/prt_cost_bw", 0);
						} else {
							model.setValue("/root/resData/resForm/prt_cost_bw", prt_cost_bw);
						}
						
						//model.setValue("/root/resData/resForm/prt_cost_bw", prt_cost_bw);
						datagrid1.refresh();
						datagrid4.refresh();
						datagrid5.refresh();
						
						
						
										
						model1.refresh();
						
						//  발생일자 일련번호 구하기
						var seq = "";
						var occr_dt = "";
						for (var i=1 ; i <= datagrid1.rows ; i++){
							if(datagrid1.valueMatrix(i,2) != "" && datagrid1.valueMatrix(i,3) != ""){
								seq = datagrid1.valueMatrix(i,8);
								occr_dt = datagrid1.valueMatrix(i,9);
							}
						}
						
						if(seq != "" && occr_dt != ""){
							for(var i=1 ; i < datagrid1.rows; i++){
								model1.setValue("/root/resData/gridData/record["+i+"]/seq", seq);
								model1.setValue("/root/resData/gridData/record["+i+"]/occr_dt", occr_dt);
							}
						}
						// 필름 계산
						funMulti();	
						
						datagrid1.clearStatus();
						datagrid4.clearStatus();	
					}
					
					function funSearch(){
						var logic_prt_wgt			= 0;
						datagrid1.isReadOnly(1,2) 	= false;
						datagrid1.isReadOnly(1,3) 	= false;
						datagrid4.isReadOnly(1,2) 	= false;
						input4.disabled 			= false;
						input5.disabled 			= false;
						
						if (model.getValue("/root/reqData/searchData/issu_dt") == ""){
							alert("발행일자를 입력해주십시오.");
							return;
						}
						if (model.getValue("/root/reqData/searchData/prt_dt") == ""){
							alert("인쇄일자를 입력해주십시오.");
							return;
						}
						if (model.getValue("/root/reqData/searchData/fac_clsf") == ""){
							alert("공장을 선택해주십시오.");
							return;
						}
						if (model.getValue("/root/reqData/searchData/medi_cd") == ""){
							alert("매체코드를 선택해주십시오.");
							return;
						}
						if (model.getValue("/root/reqData/searchData/sect_cd") == ""){
							alert("섹션코드를 선택해주십시오.");
							return;
						}
						
						model1.send("pr_othcnsm_2100_L");
						
						var nodeList = instance1.selectNodes("/root/tempData/gridData8/record");
						
						model1.copyNode("/root/resData/gridData","/root/tempData/gridData8");
						model1.copyNode("/root/resData/gridData9","/root/tempData/gridData9");
						datagrid1.refresh();
						datagrid2.refresh();
						
						model1.copyNode("/root/resData/curlist2","/root/tempData/gridData2");
						
						var nodeList2 = instance1.selectNodes("/root/resData/gridData/record");
						//model1.copyNode("/root/resData/curlist3","/root/tempData/gridData3");

						if (model1.getValue("/root/tempData/curlist3/totalcnt") != "0")
							model1.setValue("/root/resData/curlist3/film_use_qunt", 		model1.getValue("/root/tempData/curlist3/film_use_qunt"));
						else
							model1.setValue("/root/resData/curlist3/film_use_qunt", model1.getValue("/root/tempData/film_qunt"));
						
						model1.setValue("/root/resData/curlist3/prd_cnt", 		model1.getValue("/root/tempData/curlist3/prd_cnt"));
						model1.setValue("/root/resData/curlist3/dest_qunt", 		model1.getValue("/root/tempData/curlist3/dest_qunt"));
						//model1.setValue("/root/resData/curlist3/paper_wgt", 			model1.getValue("/root/tempData/curlist3/paper_wgt"));
						model1.setValue("/root/resData/curlist3/seq_curlist3", 		model1.getValue("/root/tempData/curlist3/seq_curlist3"));
						model1.setValue("/root/resData/curlist3/occr_dt_curlist3", 		model1.getValue("/root/tempData/curlist3/occr_dt_curlist3"));
						//model1.setValue("/root/resData/curlist3/film_use_qunt", 		model1.getValue("/root/tempData/film_qunt"));

						model1.setValue("/root/resData/curlist3/prt_bgn_tm", model1.getValue("/root/tempData/curlist3/prt_bgn_tm"));
						model1.setValue("/root/resData/curlist3/prt_end_tm", model1.getValue("/root/tempData/curlist3/prt_end_tm"));
						
						var ps_cost		= 0;
						var gnaw_cost		= 0;
						var pack_cost		= 0;
						
						func_getPs_cost();
						func_getInk_cost();
						
						//model.setValue("/root/resData/curlist4/record/prt_fee", 		model.getValue("/root/tempData/gridData4/record/prt_fee"));
						if (model.getValue("/root/tempData/gridData4/record/paper_amt") != "" ){
							model.setValue("/root/resData/curlist4/record/paper_amt", 		model.getValue("/root/tempData/gridData4/record/paper_amt"));
						}
						if (model.getValue("/root/tempData/gridData4/record/psplat_use_amt") != "" ){
							model.setValue("/root/resData/curlist4/record/psplat_use_amt", 	model.getValue("/root/tempData/gridData4/record/psplat_use_amt"));
						}
						if (model.getValue("/root/tempData/gridData4/record/gnaw_fee") != "" ){
							model.setValue("/root/resData/curlist4/record/gnaw_fee", 		model.getValue("/root/tempData/gridData4/record/gnaw_fee"));
						}
						if (model.getValue("/root/tempData/gridData4/record/dest_fee") != "" ){
							model.setValue("/root/resData/curlist4/record/dest_fee", 		model.getValue("/root/tempData/gridData4/record/dest_fee"));
						}
						model.setValue("/root/resData/curlist4/record/film", 			model.getValue("/root/tempData/gridData4/record/film"));
						model.setValue("/root/resData/curlist4/record/pack_fee", 		model.getValue("/root/tempData/gridData4/record/pack_fee"));
						model.setValue("/root/resData/curlist4/record/paper_portage", 	model.getValue("/root/tempData/gridData4/record/paper_portage"));
						model.setValue("/root/resData/curlist4/record/total", 			model.getValue("/root/tempData/gridData4/record/total"));
						model.setValue("/root/resData/resForm/prt_cost_bw", 			model.getValue("/root/tempData/gridData4/record/bw_prt_fee"));
						model.setValue("/root/resData/resForm/prt_cost_col", 			model.getValue("/root/tempData/gridData4/record/clr_prt_fee"));
						model.setValue("/root/resData/curlist4/record/occr_dt_curlist4", model.getValue("/root/tempData/gridData4/record/occr_dt"));
						model.setValue("/root/resData/curlist4/record/seq_curlist4", 	model.getValue("/root/tempData/gridData4/record/seq"));
						
						model.setValue("/root/resData/curlist5/record/issu_qty", 		model.getValue("/root/tempData/gridData5/record/issu_qty"));
						model.setValue("/root/resData/curlist5/record/issu_pcnt",		model.getValue("/root/tempData/gridData5/record/issu_pcnt"));
						model.setValue("/root/resData/curlist5/record/bw_pcnt",		model.getValue("/root/tempData/gridData5/record/bw_pcnt"));
						model.setValue("/root/resData/curlist5/record/clr_pcnt", 		model.getValue("/root/tempData/gridData5/record/clr_pcnt"));
						model.setValue("/root/resData/curlist5/record/pap_std", 		model.getValue("/root/tempData/gridData5/record/pap_std"));
						model.setValue("/root/resData/curlist5/record/prt_pj_rate",		model.getValue("/root/tempData/gridData5/record/prt_pj_rate"));
						model.setValue("/root/resData/curlist5/record/pj_wgt", 		model.getValue("/root/tempData/gridData5/record/pj_wgt"));
						model.setValue("/root/resData/curlist5/record/hdqt_paper_clsf",	model.getValue("/root/tempData/gridData5/record/hdqt_paper_clsf"));
						model.setValue("/root/resData/curlist5/record/prt_wgt", 		model.getValue("/root/tempData/gridData5/record/prt_wgt"));
						model.setValue("/root/resData/curlist5/record/paper_uprc", 		model.getValue("/root/tempData/gridData5/record/paper_uprc"));
						model.setValue("/root/resData/curlist5/record/tot_bw_pcnt", 	model.getValue("/root/tempData/gridData5/record/tot_bw_pcnt"));
						model.setValue("/root/resData/curlist5/record/tot_clr_pcnt", 	model.getValue("/root/tempData/gridData5/record/tot_clr_pcnt"));
						model.setValue("/root/resData/curlist5/record/total", 			model.getValue("/root/tempData/gridData5/record/total"));
						
						if (model.getValue("/root/resData/curlist5/record/issu_qty") == ""){
							alert("전체발행내역에 정보가 없습니다.");
							page_reset();
							return;
						}
						
						var bw_pcnt 		= eval(model.getValue("/root/resData/curlist5/record/bw_pcnt"));
						var clr_pcnt 		= eval(model.getValue("/root/resData/curlist5/record/clr_pcnt"));
						var issu_qty 		= eval(model.getValue("/root/resData/curlist5/record/issu_qty"));
						var pcnt 			= eval(model.getValue("/root/resData/curlist5/record/issu_pcnt"));
						var qty 			= eval(model.getValue("/root/resData/curlist5/record/issu_qty"));
						var std 			= model.getValue("/root/resData/curlist5/record/pap_std");
						var prt_wgt		= eval(model.getValue("/root/resData/curlist5/record/prt_wgt"));
						var pap_uprc		= eval(model.getValue("/root/resData/curlist5/record/paper_uprc"));
						
						model.setValue("/root/resData/curlist6/record/film_make_fee", 	model.getValue("/root/tempData/gridData6/record/film_make_fee"));
						model.setValue("/root/resData/curlist6/record/pack_fee",		model.getValue("/root/tempData/gridData6/record/pack_fee"));
						model.setValue("/root/resData/curlist6/record/paper_portage",	model.getValue("/root/tempData/gridData6/record/paper_portage"));
						model.setValue("/root/resData/curlist6/record/pj_basi_qty",		model.getValue("/root/tempData/gridData6/record/pj_basi_qty"));
						model.setValue("/root/resData/curlist6/record/prt_pj_rate",		model.getValue("/root/tempData/gridData6/record/prt_pj_rate"));
						//model.setValue("/root/resData/curlist6/record/prt_pj_rate_clr",	model.getValue("/root/tempData/gridData6/record/prt_pj_rate_clr"));
						model.setValue("/root/resData/curlist6/record/dest_fee",		model.getValue("/root/tempData/gridData6/record/dest_fee"));
						model.setValue("/root/resData/curlist6/record/base_leas_fee",	model.getValue("/root/tempData/gridData6/record/base_leas_fee"));
						model.setValue("/root/resData/curlist6/record/real_leas_fee",	model.getValue("/root/tempData/gridData6/record/real_leas_fee"));
						model.setValue("/root/resData/curlist6/record/etc_matr_fee_bw",	model.getValue("/root/tempData/gridData6/record/etc_matr_fee_bw"));
						model.setValue("/root/resData/curlist6/record/etc_matr_fee_clr",	model.getValue("/root/tempData/gridData6/record/etc_matr_fee_clr"));
						model.setValue("/root/resData/curlist6/record/leas_use_fee_bw",	model.getValue("/root/tempData/gridData6/record/leas_use_fee_bw"));
						model.setValue("/root/resData/curlist6/record/leas_use_fee_clr",	model.getValue("/root/tempData/gridData6/record/leas_use_fee_clr"));
						model.setValue("/root/resData/curlist6/record/paper_wgt",		model.getValue("/root/tempData/gridData6/record/paper_wgt"));
						
						if (model.getValue("/root/resData/curlist6/record/film_make_fee") == "" || model.getValue("/root/resData/curlist6/record/film_make_fee") == "0"){
							input4.disabled = true;
						} else {
							input4.disabled = false;
						}
						
						if (model.getValue("/root/resData/curlist6/record/base_leas_fee") == "" || model.getValue("/root/resData/curlist6/record/base_leas_fee") == "0"){
							input5.disabled = true;
						} else {
							input5.disabled = false;
						}
						if (model.getValue("/root/resData/curlist6/record/real_leas_fee") == "" || model.getValue("/root/resData/curlist6/record/real_leas_fee") == "0"){
							input6.disabled = true;
							input7.disabled = true;
						} else {
							input6.disabled = false;
							input7.disabled = false;
						}
						if (model.getValue("/root/resData/curlist6/record/dest_fee") == ""){
							input8.disabled = true;
						} else {
							input8.disabled = false;
						}
						
						var pj_rate = eval(model.getValue("/root/resData/curlist6/record/prt_pj_rate"));
						
						if (std == "T") {
							logic_prt_wgt	= pcnt * qty /8000 * 19.791 * (1 + (pj_rate/100));
						} else {
							logic_prt_wgt	= pcnt * qty /4000 * 19.791 * (1 + (pj_rate/100));
						}
						model.setValue("/root/resData/curlist5/record/logic_wgt", 		Math.round(logic_prt_wgt) );
						//alert("_" + prt_wgt + "\n_" + model.getValue("/root/resData/curlist5/record/logic_wgt") + "\n_" + pap_uprc);
						if (model.getValue("/root/resData/curlist5/record/hdqt_paper_clsf") == "03") {
							model.setValue("/root/resData/curlist4/record/paper_amt",		Math.round(prt_wgt * pap_uprc) );
							//	20091201. 김현수과장님 요청으로 인쇄중량과 약정사용량의 차이에따라서 용지대 계산 방식으로 수정.
							if (logic_prt_wgt < prt_wgt){
								model.setValue("/root/resData/curlist4/record/paper_amt",		Math.round(prt_wgt * pap_uprc) );
							} else {
								model.setValue("/root/resData/curlist4/record/paper_amt",		Math.round(logic_prt_wgt * pap_uprc) );
							}
							//if (std == "T") {
							//	//model.setValue("/root/resData/curlist5/record/logic_wgt", 		Math.round(pcnt * qty /8000 * 19.791 * (1 + (pj_rate/100))) );
							//	
							//} else {
							//	//model.setValue("/root/resData/curlist5/record/logic_wgt", 		Math.round(pcnt * qty /4000 * 19.791 * (1 + (pj_rate/100))) );
							//	model.setValue("/root/resData/curlist4/record/paper_amt",		Math.round(logic_prt_wgt * pap_uprc) );
							//}
						} else if (model.getValue("/root/resData/curlist5/record/hdqt_paper_clsf") == "04") {
							if (model.getValue("/root/reqData/searchData/fac_clsf") == "20") {
								model.setValue("/root/resData/curlist4/record/paper_amt",		0);
							} else if (model.getValue("/root/reqData/searchData/fac_clsf") == "22") {
								model.setValue("/root/resData/curlist4/record/paper_amt",		0);
							} else {
								if ((prt_wgt - eval(model.getValue("/root/resData/curlist5/record/logic_wgt"))) < 0){
									model.setValue("/root/resData/curlist4/record/paper_amt",		0);
								} else {
									model.setValue("/root/resData/curlist4/record/paper_amt",		(prt_wgt - eval(model.getValue("/root/resData/curlist5/record/logic_wgt"))) * pap_uprc);
								}
							}
							
						}
						
						model.setValue("/root/reqData/reqForm/issu_dt", model.getValue("/root/reqData/searchData/issu_dt"));
						model.setValue("/root/reqData/reqForm/prt_dt", model.getValue("/root/reqData/searchData/prt_dt"));
						model.setValue("/root/reqData/reqForm/fac_clsf", model.getValue("/root/reqData/searchData/fac_clsf"));
						model.setValue("/root/reqData/reqForm/medi_cd", model.getValue("/root/reqData/searchData/medi_cd"));
						model.setValue("/root/reqData/reqForm/sect_cd", model.getValue("/root/reqData/searchData/sect_cd"));
						model.setValue("/root/reqData/reqForm/prt_clsf", model.getValue("/root/reqData/searchData/prt_clsf"));
						
						model1.setValue("/root/reqData/reqForm/seq", model1.getValue("/root/resData/curlist4/record/seq_curlist4"));
						model1.setValue("/root/reqData/reqForm/occr_dt", model1.getValue("/root/resData/curlist4/record/occr_dt_curlist4"));
						
						
						
						if (model.getValue("/root/resData/curlist4/record/occr_dt_curlist4") == ""){
							model.setValue("/root/reqData/reqForm/mode", "I");
						} else {
							model.setValue("/root/reqData/reqForm/mode", "U");
						}
						
						var etc_matr_fee_bw		= eval(model.getValue("/root/resData/curlist6/record/etc_matr_fee_bw"));
						var etc_matr_fee_clr	= eval(model.getValue("/root/resData/curlist6/record/etc_matr_fee_clr"));
						
						if (model.getValue("/root/resData/curlist6/record/leas_use_fee_clr") == "0"){
							leas_use_cost = 0;
						} else {
							leas_use_cost = ( (eval(model.getValue("/root/resData/curlist5/record/bw_pcnt")) * eval(model.getValue("/root/resData/curlist6/record/leas_use_fee_bw"))) + (eval(model.getValue("/root/resData/curlist5/record/clr_pcnt")) * eval(model.getValue("/root/resData/curlist6/record/leas_use_fee_clr"))) ) / 4000 * eval(model.getValue("/root/resData/curlist5/record/issu_qty"));
						}
						if (std == "T"){
							etc_matr_fee = Math.round( ((bw_pcnt * issu_qty / 4000 * etc_matr_fee_bw) /2 ) + ( (clr_pcnt * issu_qty / 4000 * etc_matr_fee_clr) /2) );
						} else {
							etc_matr_fee = Math.round( (bw_pcnt * issu_qty / 4000 * etc_matr_fee_bw) + (clr_pcnt * issu_qty / 4000 * etc_matr_fee_clr) );
						}
						
						//ROUND((J6*L6/4000*472.5)/2+(K6*L6/4000*472.5)/2,0)
						
						model.setValue("/root/resData/curlist4/record/leas_use_fee", leas_use_cost);
						model.setValue("/root/resData/curlist4/record/etc_matr_fee", etc_matr_fee);
						tot_bw_pcnt	= eval(model.getValue("/root/resData/curlist5/record/tot_bw_pcnt"));
						tot_clr_pcnt	= eval(model.getValue("/root/resData/curlist5/record/tot_clr_pcnt"));
						pack_fee		= eval(model.getValue("/root/resData/curlist6/record/pack_fee"));
						//alert(bw_pcnt + "\n" + clr_pcnt + "\n" + pack_fee);
						if (std == "T"){
							pack_cost = Math.round((tot_bw_pcnt + tot_clr_pcnt)/4000 * pack_fee / 2);
						} else {
							pack_cost = Math.round((tot_bw_pcnt + tot_clr_pcnt)/4000 * pack_fee);
						}
						
						model.setValue("/root/resData/curlist4/record/pack_fee", pack_cost);
						
						input4.refresh();
						input4.dispatch("xforms-value-changed");
						
						input5.refresh();
						input5.dispatch("xforms-value-changed");
						input6.refresh();
						input6.dispatch("xforms-value-changed");
						input7.refresh();
						input7.dispatch("xforms-value-changed");
						funDatagrid4Sum();
						
						if (model.getValue("/root/resData/curlist4/record/film") == "") {
							make_prt_cost();
						} else {
							model.refresh();
						}
					}
					
					function func_getPs_cost(){
						var ps_cost 	= 0;
						var gnaw_cost	= 0;
						
						for (var i=1; i<datagrid1.rows; i++){
							if (datagrid1.valueMatrix(i, 5) == ""){
								ps_cost = ps_cost + 0;
							} else {
								ps_cost = ps_cost + eval(datagrid1.valueMatrix(i, 5));
							}
							
							if (datagrid1.valueMatrix(i, 7) == ""){
								gnaw_cost = gnaw_cost + 0;
							} else {
								gnaw_cost = gnaw_cost + eval(datagrid1.valueMatrix(i, 7));
							}
						}
						//alert(ps_cost);
						model.setValue("/root/resData/curlist4/record/psplat_use_amt", ps_cost);
						model.setValue("/root/resData/curlist4/record/gnaw_fee", gnaw_cost);
						datagrid4.refresh();
						funDatagrid4Sum();
					}
					
					function func_getInk_cost(){
						var ink_cost 	= 0;
						var ink_qunt 	= 0;
						
						for (var i=1; i<datagrid2.rows; i++){
							if (datagrid2.valueMatrix(i, 4) == ""){
								ink_cost = ink_cost + 0;
							} else {
								ink_cost = ink_cost + eval(datagrid2.valueMatrix(i, 4));
							}
							if (datagrid2.valueMatrix(i, 2) == ""){
								ink_qunt = ink_qunt + 0;
							} else {
								ink_qunt = ink_qunt + eval(datagrid2.valueMatrix(i, 2));
							}
						}
						model.setValue("/root/resData/curlist3/ink_use_qunt", ink_qunt);
						model.setValue("/root/resData/curlist4/record/ink_use_amt", ink_cost);
						model.refresh();
						funDatagrid4Sum();
					}
					
					function funMulti(){

						var filmsomo = model1.getValue("/root/resData/curlist3/film_use_qunt");
						var film_make_fee = datagrid6.valueMatrix(2,0);
				
						// 필름소모량이 있을때 계산하기 
						if (filmsomo == "" || filmsomo == "0"){
							//alert(filmsomo);
							model1.setValue("/root/resData/curlist4/record/film", 0);
						} else {
							var multi = parseInt(filmsomo) * parseInt(film_make_fee);
							model1.setValue("/root/resData/curlist4/record/film", multi);
						}
						
						datagrid4.refresh();
						
						funDatagrid4Sum();
					}
					
					// griddata4 합계구하기 
					function funDatagrid4Sum(){						
						if(datagrid4.rows >1){
							// 합계 계산 
							var total = 0;
							for(var i=1 ; i <= 11 ; i++){
								if(datagrid4.valueMatrix(1, i).length >= 1){
									total = parseInt(total) + parseInt(datagrid4.valueMatrix(1, i));
								}
							}
							model1.setValue("/root/resData/curlist4/record/total", total);
							datagrid4.refresh();
						}
					}
					
					function fun_mamtstdpcn_Search(){
						model.send("pr_prtcnsg_1102");
					
						//model.copyNode("/root/resData/curlist5/record","/root/tempData/mamtstdpcn");
						model.setValue("/root/resData/curlist5/record/issu_qty", model.getValue("/root/tempData/mamtstdpcn/record/slip_qty"));
						model.setValue("/root/resData/curlist5/record/issu_pcnt", model.getValue("/root/tempData/mamtstdpcn/record/issu_pcnt"));
						model.setValue("/root/resData/curlist5/record/bw_pcnt", model.getValue("/root/tempData/mamtstdpcn/record/bw_pcnt"));
						model.setValue("/root/resData/curlist5/record/clr_pcnt", model.getValue("/root/tempData/mamtstdpcn/record/clr_pcnt"));
						model.setValue("/root/resData/curlist5/record/pap_std", model.getValue("/root/tempData/mamtstdpcn/record/pap_std"));
						
						model.setValue("/root/resData/curlist5/record/paper_portage", model.getValue("/root/tempData/papuprc/record/paper_uprc"));
						model.setValue("/root/resData/curlist5/record/tot_bw_pcnt", eval(model.getValue("/root/resData/curlist5/record/issu_qty")) * eval(model.getValue("/root/tempData/mamtstdpcn/record/bw_pcnt")));
						model.setValue("/root/resData/curlist5/record/tot_clr_pcnt", eval(model.getValue("/root/resData/curlist5/record/issu_qty")) * eval(model.getValue("/root/tempData/mamtstdpcn/record/clr_pcnt")));
						model.setValue("/root/resData/curlist5/record/total", eval(model.getValue("/root/resData/curlist5/record/tot_bw_pcnt")) + eval(model.getValue("/root/resData/curlist5/record/tot_clr_pcnt")));
						
						
						var tot_bw_pcnt		= eval(model.getValue("/root/resData/curlist5/record/tot_bw_pcnt"));
						var tot_clr_pcnt		= eval(model.getValue("/root/resData/curlist5/record/tot_clr_pcnt"));
						var bw_purc_1 			= eval(model.getValue("/root/resData/curlist2/record[1]/data"));
						var bw_purc_2 			= eval(model.getValue("/root/resData/curlist2/record[3]/data"));
						var clr_purc_1 		= eval(model.getValue("/root/resData/curlist2/record[2]/data"));
						var clr_purc_2 		= eval(model.getValue("/root/resData/curlist2/record[4]/data"));
						
						var basi_qty 			= eval(model.getValue("/root/resData/curlist2/record[5]/data"));
						var issu_qty 			= eval(model.getValue("/root/resData/curlist5/record/issu_qty"));
						var issu_pcnt 			= eval(model.getValue("/root/resData/curlist5/record/issu_pcnt"));
						var bw_pcnt 			= eval(model.getValue("/root/resData/curlist5/record/bw_pcnt"));
						var clr_pcnt 			= eval(model.getValue("/root/resData/curlist5/record/clr_pcnt"));
						var pap_std 			= model.getValue("/root/resData/curlist5/record/pap_std");
						
						var pap_uprc 			= 0;
						if (model.getValue("/root/resData/curlist5/record/paper_portage") != ""){
							pap_uprc			= eval(model.getValue("/root/resData/curlist5/record/paper_portage"));
						}
						var tot_bw_pcnt		= eval(model.getValue("/root/resData/curlist5/record/tot_bw_pcnt"));
						var tot_clr_pcnt		= eval(model.getValue("/root/resData/curlist5/record/tot_clr_pcnt"));
						
						var pj_basi_qty 		= eval(model.getValue("/root/resData/curlist6/record/pj_basi_qty"));
						var paper_portage		= eval(model.getValue("/root/resData/curlist6/record/paper_portage"));
						var pack_fee			= eval(model.getValue("/root/resData/curlist6/record/pack_fee"));
						var pap_wgt 			= eval(model.getValue("/root/resData/curlist6/record/paper_wgt"));
						var prt_pj_rate_bw_1	= eval(model.getValue("/root/resData/curlist6/record/prt_pj_rate_bw_1"));
						//var prt_pj_rate_bw_2	= eval(model.getValue("/root/resData/curlist6/record/prt_pj_rate_bw_2"));
						var prt_pj_rate_bw_2	= 0;
						var prt_pj_rate_clr_1	= eval(model.getValue("/root/resData/curlist6/record/prt_pj_rate_clr_1"));
						var prt_pj_rate_clr_2	= eval(model.getValue("/root/resData/curlist6/record/prt_pj_rate_clr_2"));
						
						var prt_cost			= 0;
						var prt_cost_col		= 0;
						var prt_cost_bw		= 0;
						var pap_cost			= 0;
						var tot_pap_wgt		= 0;
						var tran_cost			= 0;
						var pack_cost			= 0;
						//--------------------//
    						//인쇄비 계산		  //
    						//--------------------//
						
						if (model.getValue("/root/reqData/searchData/fac_clsf") == '70' || model.getValue("/root/reqData/searchData/fac_clsf") == '31'){
							if (issu_qty > basi_qty && basi_qty > 0){
								prt_cost = ((bw_pcnt * bw_purc_1) + (clr_pcnt * clr_purc_1) * basi_qty / 4000) + ((bw_pcnt * bw_purc_2) + (clr_pcnt * clr_purc_2) * basi_qty / 4000);
								if (pap_std == "T"){
									prt_cost = prt_cost * 0.5;
								}
								model.setValue("/root/resData/curlist4/record/prt_fee", prt_cost);
								
								prt_cost_col = (clr_pcnt * clr_purc_1 * basi_qty / 4000) + (clr_pcnt * clr_purc_2 * (issu_qty - basi_qty) / 4000);
								if (pap_std == "T"){
									prt_cost_col = prt_cost_col * 0.5;
								}
							} else {
								prt_cost = (bw_pcnt * bw_purc_1) + (clr_pcnt * clr_purc_1) * basi_qty / 4000;
								if (pap_std == "T"){
									prt_cost = prt_cost * 0.5;
								}
								
								prt_cost_col = clr_pcnt * clr_purc_1 * issu_qty / 4000;
								if (pap_std == "T"){
									prt_cost_col = prt_cost_col * 0.5;
								}
							}
						} else {
							prt_cost = ((bw_pcnt * bw_purc_1) + (clr_pcnt * clr_purc_1)) * issu_qty / 4000;
							if (pap_std == "T"){
								prt_cost = prt_cost * 0.5;
							}
							prt_cost_col = clr_pcnt * clr_purc_1 * issu_qty / 4000;
							if (pap_std == "T"){
								prt_cost_col = prt_cost_col * 0.5;
							}
						}
						prt_cost_bw = prt_cost - prt_cost_col;
						
						if (prt_cost_bw > 0 && prt_cost_bw <= 1){
							prt_cost_col = prt_cost_col + 1;
							prt_cost_bw = 0;
						}
						
						//---------------
						//용지대,운송비
						//---------------
						//파지기준부수에 의해 계산한다.PajiGiZunBuSu PajiGiZunBuSu
						if (model.getValue("/root/reqData/searchData/fac_clsf") == '71'){
							if (issu_pcnt > pj_basi_qty){
								pap_cost = pj_basi_qty * issu_pcnt * (1 + prt_pj_rate_bw_1 / 100) + (issu_pcnt - pj_basi_qty) * issu_pcnt * (1 + prt_pj_rate_clr_1) * pap_uprc * pap_wgt / 4000;
								tot_pap_wgt 	= pj_basi_qty * issu_pcnt * (1 + prt_pj_rate_bw_1/100) + (issu_pcnt - pj_basi_qty) * issu_pcnt * (1 + prt_pj_rate_clr_1) * pap_wgt / 4000;
								tran_cost = pj_basi_qty * issu_pcnt * (1 + prt_pj_rate_bw_1/100) + (issu_pcnt - pj_basi_qty) * issu_pcnt * (1 + prt_pj_rate_clr_1) * paper_portage * pap_wgt /4000;
								
							} else {
								pap_cost = issu_qty * issu_pcnt * (1 + prt_pj_rate_bw_1 / 100) * pap_uprc * pap_wgt / 4000;
								tot_pap_wgt	= issu_qty * issu_pcnt * (1 + prt_pj_rate_bw_1/100) * pap_wgt / 4000;
								tran_cost 		= issu_qty * issu_pcnt * (1 + prt_pj_rate_bw_1/100) * paper_portage * pap_wgt / 4000;
							}
						} else {
							//용지대
							//alert(tot_bw_pcnt + "\n" + prt_pj_rate_bw_1 + "\n" + tot_clr_pcnt + "\n" + prt_pj_rate_clr_1 + "\n" + pap_wgt + "\n" + pap_uprc);
							pap_cost	= tot_bw_pcnt * (1 + prt_pj_rate_bw_1 / 100) + tot_clr_pcnt * (1 + prt_pj_rate_clr_1 / 100) * pap_wgt / 4000 * pap_uprc;
							tot_pap_wgt	= (tot_bw_pcnt * (1 + prt_pj_rate_bw_1 / 100) + tot_clr_pcnt * (1 + prt_pj_rate_clr_1 / 100)) / 4000 * pap_wgt;
							tran_cost 	= (tot_bw_pcnt * (1 + prt_pj_rate_bw_1 / 100) + tot_clr_pcnt * (1 + prt_pj_rate_clr_1 / 100)) / 488 * pap_wgt / 4000 * paper_portage;
						}
						if (pap_std == 'T'){
							tot_pap_wgt = tot_pap_wgt * 0.5;
						}
						
						pack_cost = (tot_bw_pcnt + tot_clr_pcnt) * pack_fee / 4000;
						if (pap_std == 'T'){
							pack_cost = pack_cost * 0.5;
						}
						tot_pap_wgt 	= Math.round(tot_pap_wgt * 1000)/1000;
						prt_cost_col	= Math.round(prt_cost_col * 100)/100;
						prt_cost_bw	= Math.round(prt_cost_bw * 100)/100;
						//alert("prt_cost=" + prt_cost);
						model.setValue("/root/resData/curlist4/record/prt_fee", Math.round(prt_cost));
						model.setValue("/root/resData/curlist4/record/paper_amt", pap_cost);
						model.setValue("/root/resData/curlist4/record/paper_portage", tran_cost);
						model.setValue("/root/resData/curlist4/record/pack_fee", pack_cost);
						model.setValue("/root/resData/curlist3/paper_wgt", tot_pap_wgt);
						
						//alert("prt_cost_col=" + prt_cost_col + "\nprt_cost_bw=" + prt_cost_bw);
						model.setValue("/root/resData/resForm/prt_cost_col", prt_cost_col);
						model.setValue("/root/resData/resForm/prt_cost_bw", prt_cost_bw);
						//model.setValue("/root/resData/resForm/prt_cost_bw", prt_cost_bw);
						
						
						datagrid4.refresh();
						datagrid5.refresh();
					}
					
					function page_reset() {
						model.reset();
						
						model.copyNode("/root/initData/pageInfo",parent.root.initData.pageInfo);
						model1.setValue("/root/reqData/searchData/issu_dt" ,getCurrentDate());
						model1.setValue("/root/reqData/searchData/prt_dt" ,getCurrentDate());
						datagrid1.isReadOnly(1,2) = true;
						datagrid1.isReadOnly(1,3) = true;
						datagrid4.isReadOnly(1,2) = true;
						input4.disabled = true;
						input5.disabled = true;
						
						model1.copyNode("/root/initData/comboSet/cnsg", 		parent.root.tempData.cnsg);
						model1.copyNode("/root/initData/comboSet/prt_clsf", 	parent.root.tempData.prt_clsf);
						model1.copyNode("/root/initData/comboSet/medt_cd", 	parent.root.tempData.medt_cd);
						model1.copyNode("/root/initData/comboSet/papcmpy_cd", 	parent.root.tempData.papcmpy_cd);
						model1.copyNode("/root/initData/comboSet/sect_cd",	parent.root.tempData.sect_cd);
						model1.refresh();
					}
				]]>
			</script>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<submission id="pr_othcnsm_2000_M" action="/mt/prtcnsg/2000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="pr_othcnsm_2100_L" action="/mt/prtcnsg/2100" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="pr_othcnsm_2102" action="/mt/prtcnsg/2102" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="pr_othcnsm_2101_A" action="/mt/prtcnsg/2101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="pr_othcnsm_2105_A" action="/mt/prtcnsg/2105" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
		</model>
	</xhtml:head>
	<xhtml:body pagewidth="920" pageheight="575">
		<caption id="caption7" class="list_cap02" style="left:21px; top:220px; width:889px; height:26px; "/>
		<group id="group1" class="gro_sel" style="left:10px; top:35px; width:900px; height:47px; ">
			<caption id="caption36" class="list_cap02" style="left:79px; top:23px; width:756px; height:24px; text-align:center; "/>
			<caption id="caption32" class="list_cap02" style="left:79px; top:0px; width:756px; height:24px; text-align:center; "/>
			<caption id="caption4" class="list_cap01" style="left:0px; top:0px; width:120px; height:24px; text-align:center; ">발행일자</caption>
			<caption id="caption8" class="list_cap01" style="left:295px; top:23px; width:120px; height:24px; text-align:center; ">섹션</caption>
			<caption id="caption33" class="list_cap01" style="left:295px; top:0px; width:120px; height:24px; text-align:center; ">인쇄일자</caption>
			<caption id="caption35" class="list_cap01" style="left:0px; top:23px; width:120px; height:24px; text-align:center; ">매  체</caption>
			<select1 id="combo1" ref="/root/reqData/searchData/fac_clsf" navindex="3" appearance="minimal" style="left:695px; top:3px; width:120px; height:18px; background-color:#ffffcc; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/cnsg/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if (model.getValue("/root/reqData/searchData/fac_clsf") == "60"){
						model.setValue("/root/reqData/searchData/papcmpy_cd", "00129999");
					} else if (model.getValue("/root/reqData/searchData/fac_clsf") == "70"){
						model.setValue("/root/reqData/searchData/papcmpy_cd", "00000554");
					} else if (model.getValue("/root/reqData/searchData/fac_clsf") == "73"){
						model.setValue("/root/reqData/searchData/papcmpy_cd", "00000554");
					} else {
						model.setValue("/root/reqData/searchData/papcmpy_cd", "");
					}
					]]>
				</script>
			</select1>
			<select1 id="combo3" ref="/root/reqData/searchData/medi_cd" navindex="4" appearance="minimal" style="left:126px; top:26px; width:120px; height:18px; background-color:#ffffcc; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/medt_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<input id="input1" ref="/root/reqData/searchData/issu_dt" navindex="1" inputtype="date" style="left:126px; top:3px; width:120px; height:18px; background-color:#ffffcc; ">
				<script type="javascript" ev:event="onkeyup">
					<![CDATA[
						var issu_dt = input1.currentText;
						issu_dt = issu_dt.replace(/-/ig, "");
						model.setValue("/root/reqData/searchData/prt_dt", issu_dt);
						input2.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var issu_dt = input1.currentText;
						issu_dt = issu_dt.replace(/-/ig, "");
						model.setValue("/root/reqData/searchData/prt_dt", issu_dt);
						input2.refresh();
					]]>
				</script>
			</input>
			<input id="input2" ref="/root/reqData/searchData/prt_dt" navindex="2" inputtype="date" style="left:420px; top:3px; width:120px; height:18px; background-color:#ffffcc; "/>
			<select1 id="combo4" ref="/root/reqData/searchData/sect_cd" navindex="5" appearance="minimal" style="left:420px; top:26px; width:120px; height:18px; background-color:#ffffcc; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/sect_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<caption id="caption6" class="list_cap01" style="left:570px; top:0px; width:120px; height:24px; text-align:center; ">공장</caption>
			<caption id="caption1" class="list_cap01" style="left:570px; top:23px; width:120px; height:24px; text-align:center; ">인쇄구분</caption>
			<select1 id="combo5" ref="/root/reqData/searchData/prt_clsf" navindex="6" appearance="minimal" style="left:695px; top:26px; width:120px; height:18px; background-color:#ffffcc; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/prt_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" caption="PS판^소모^공판^PS판단가^PS판비계^소부비단가^소부비계^seq^occr_dt^sub_seq" colsep="#" colwidth="65, 77, 77, 85, 77, 84, 76, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" navindex="7" style="left:10px; top:90px; width:560px; height:123px; ">
			<col ref="psplat_clsf" style="text-align:left; "/>
			<col ref="psplat_qunt" type="input" format="#,###" style="text-align:right; "/>
			<col ref="nul_plat_cnt" type="input" format="#,###" style="text-align:right; "/>
			<col ref="psplat_fee" format="#,###" style="text-align:right; "/>
			<col ref="psplat_amt" format="#,###" style="text-align:right; "/>
			<col ref="gnaw_fee" format="#,###" style="text-align:right; "/>
			<col ref="gnaw_amt" format="#,###" style="text-align:right; "/>
			<col ref="seq" visibility="hidden"/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="sub_seq" visibility="hidden"/>
			<script type="javascript" ev:event="onendedit">
				<![CDATA[
					model1.setValue("/root/resData/resForm/temp", "1");
					
					var cell			= datagrid1.selectedCells;
					if(cell.length < 1){
						alert("select a Cell");
						return;
					}
					var col			= cell.item(0).col;
					var row			= cell.item(0).row;
					var ps_cost		= 0;
					var gnaw_cost		= 0;
					
					//alert(col + "\n" + row);
					if (col == 2 || col == 3){
						if (datagrid1.valueMatrix(row, 2) == ""){
							datagrid1.valueMatrix(row, 2) = 0;
						}
						if (datagrid1.valueMatrix(row, 3) == ""){
							datagrid1.valueMatrix(row, 3) = 0;
						}
						if (eval(datagrid1.valueMatrix(row, 2)) + eval(datagrid1.valueMatrix(row, 3)) == 0){
							ps_cost = 0;
						} else {
							ps_cost = (eval(datagrid1.valueMatrix(row, 2)) + eval(datagrid1.valueMatrix(row, 3))) * eval(datagrid1.valueMatrix(row, 4));
						}
						if (eval(datagrid1.valueMatrix(row, 2)) + eval(datagrid1.valueMatrix(row, 3)) == 0){
							gnaw_cost = 0;
						} else {
							gnaw_cost = (eval(datagrid1.valueMatrix(row, 2)) + eval(datagrid1.valueMatrix(row, 3))) * eval(datagrid1.valueMatrix(row, 6));
						}
					}
					
					datagrid1.valueMatrix(row, 5) = ps_cost;
					datagrid1.valueMatrix(row, 7) = gnaw_cost;
					func_getPs_cost();
					
				]]>
			</script>
		</datagrid>
		<caption id="caption2" class="list_cap01" style="left:10px; top:220px; width:100px; height:26px; text-align:center; ">필름소모량</caption>
		<input id="input4" ref="/root/resData/curlist3/film_use_qunt" navindex="9" format="#,###" style="left:114px; top:224px; width:110px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					model1.setValue("/root/resData/resForm/temp","1");
					funMulti();
				]]>
			</script>
		</input>
		<caption id="caption3" class="list_cap01" style="left:275px; top:220px; width:100px; height:26px; text-align:center; ">가동 대수</caption>
		<input id="input5" ref="/root/resData/curlist3/prd_cnt" navindex="10" format="#" style="left:379px; top:224px; width:110px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					model1.setValue("/root/resData/resForm/temp", "1");
					if (eval(model.getValue("/root/resData/curlist6/record/base_leas_fee")) == 0){
						model1.setValue("/root/resData/curlist4/record/base_leas_fee", 0);
					} else {
						model1.setValue("/root/resData/curlist4/record/base_leas_fee", eval(model.getValue("/root/resData/curlist6/record/base_leas_fee")) * eval(model.getValue("/root/resData/curlist3/prd_cnt")));
						
						if (eval(model.getValue("/root/resData/curlist6/record/real_leas_fee")) == 0){
							model.setValue("/root/resData/curlist4/record/real_leas_fee", 0);
						} else {
							if(model.getValue("/root/resData/curlist3/prt_end_tm") != ""){
								var interval = ( (eval(model.getValue("/root/resData/curlist3/prt_end_tm").substring(0,2)) * 60) + eval(model.getValue("/root/resData/curlist3/prt_end_tm").substring(2,4)) ) - ( (eval(model.getValue("/root/resData/curlist3/prt_bgn_tm").substring(0,2)) * 60) + eval(model.getValue("/root/resData/curlist3/prt_bgn_tm").substring(2,4)) );
								model.setValue("/root/resData/curlist4/record/real_leas_fee", (Math.round((interval/10),0) * eval(model.getValue("/root/resData/curlist6/record/real_leas_fee"))) * eval(model.getValue("/root/resData/curlist3/prd_cnt")));
							}
						}
					}
					funDatagrid4Sum();
				]]>
			</script>
		</input>
		<!--
		<caption id="caption9" class="list_cap01" style="left:499px; top:220px; width:86px; height:24px; text-align:center; ">흑백비용</caption>
		<caption id="caption10" class="list_cap01" style="left:676px; top:220px; width:84px; height:24px; text-align:center; ">칼라비용</caption>
		-->
		<datagrid id="datagrid4" nodeset="/root/resData/curlist4/record" caption="임대사용료^기본임대료^실제임대료^용지대^PS판대^소부비^필름^잉크^기타자재비^포장비^역지비^합계^occr_dt^seq" colsep="#" colwidth="72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" navindex="11" style="left:10px; top:275px; width:900px; height:75px; ">
			<col ref="leas_use_fee" type="input" format="#,###" style="text-align:right; "/>
			<col ref="base_leas_fee" format="#,###" style="text-align:right; "/>
			<col ref="real_leas_fee" type="input" format="#,###" style="text-align:right; "/>
			<col ref="paper_amt" type="input" format="#,###" style="text-align:right; "/>
			<col ref="psplat_use_amt" format="#,###" style="text-align:right; "/>
			<col ref="gnaw_fee" format="#,###" style="text-align:right; "/>
			<col ref="film" format="#,###" style="text-align:right; "/>
			<col ref="ink_use_amt" format="#,###" style="text-align:right; "/>
			<col ref="etc_matr_fee" format="#,###" style="text-align:right; "/>
			<col ref="pack_fee" type="input" format="#,###" style="text-align:right; "/>
			<col ref="dest_fee" type="input" format="#,###" style="text-align:right; "/>
			<col ref="total" format="#,###" style="text-align:right; "/>
			<col ref="occr_dt_curlist4" visibility="hidden"/>
			<col ref="seq_curlist4" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					model1.setValue("/root/resData/resForm/temp", "1");
					funDatagrid4Sum();
					
				]]>
			</script>
		</datagrid>
		<datagrid id="datagrid5" nodeset="/root/resData/curlist5/record" caption="발행부수^발행면수^흑백면수^칼라면수^용지단가^인쇄중량^약정사용량^파지중량^파율^발행총면수^발행총면수^발행총면수|발행부수^발행면수^흑백면수^칼라면수^용지단가^인쇄중량^약정사용량^파지중량^파율^흑백^칼라^총면수" colsep="^" colwidth="77, 77, 77, 77, 77, 77, 77, 77, 50, 77, 77, 77" mergecellsfixedrows="bycolrec" rowsep="|" selectionmode="free" navindex="12" style="left:10px; top:349px; width:900px; height:90px; ">
			<col ref="issu_qty" format="#,###" style="text-align:right; "/>
			<col ref="issu_pcnt" format="#,###" style="text-align:right; "/>
			<col ref="bw_pcnt" format="#,###" style="text-align:right; "/>
			<col ref="clr_pcnt" format="#,###" style="text-align:right; "/>
			<col ref="paper_uprc" format="#,###" style="text-align:right; "/>
			<col ref="prt_wgt" format="#,###" style="text-align:right; "/>
			<col ref="logic_wgt" format="#,###" style="text-align:right; "/>
			<col ref="pj_wgt" format="#,###" style="text-align:right; "/>
			<col ref="prt_pj_rate" visibility="hidden" format="#,###.99" style="text-align:right; "/>
			<col ref="tot_bw_pcnt" format="#,###" style="text-align:right; "/>
			<col ref="tot_clr_pcnt" format="#,###" style="text-align:right; "/>
			<col ref="total" format="#,###" style="text-align:right; "/>
		</datagrid>
		<datagrid id="datagrid6" nodeset="/root/resData/curlist6/record" caption="필름제작비^포장비^기본임대료^실제임대료^기타자재비^기타자재비^임대료^임대료^역지^파지기준중량^파율|필름제작비^포장비^기본임대료^실제임대료^흑백^칼라^흑백^칼라^역지^파지기준중량^파율" colsep="^" colwidth="81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81" mergecellsfixedrows="bycolrec" rowsep="|" selectionmode="free" style="left:10px; top:438px; width:900px; height:90px; ">
			<col ref="film_make_fee" format="#,###" style="text-align:right; "/>
			<col ref="pack_fee" format="#,###" style="text-align:right; "/>
			<col ref="base_leas_fee" format="#,###" style="text-align:right; "/>
			<col ref="real_leas_fee" format="#,###" style="text-align:right; "/>
			<col ref="etc_matr_fee_bw" format="#,###" style="text-align:right; "/>
			<col ref="etc_matr_fee_clr" format="#,###" style="text-align:right; "/>
			<col ref="leas_use_fee_bw" format="#,###" style="text-align:right; "/>
			<col ref="leas_use_fee_clr" format="#,###" style="text-align:right; "/>
			<col ref="dest_fee" format="#,###" style="text-align:right; "/>
			<col ref="pj_basi_qty" format="#,###" style="text-align:right; "/>
			<col ref="prt_pj_rate" type="input" format="#,###.99" style="text-align:right; "/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var iCol = datagrid6.col;
				var iRow = datagrid6.row;
				
				switch(iCol){
					case  10 :
						if(datagrid6.valueMatrix(iRow, 11) != ""){
							//alert(datagrid6.valueMatrix(iRow, 10) + "\n" + datagrid6.valueMatrix(iRow, 11));
							var interval = ( (eval(datagrid6.valueMatrix(iRow, 11).substring(0,2)) * 60) + eval(datagrid6.valueMatrix(iRow, 11).substring(2,4)) ) - ( (eval(datagrid6.valueMatrix(iRow, 10).substring(0,2)) * 60) + eval(datagrid6.valueMatrix(iRow, 10).substring(2,4)) );
							model.setValue("/root/resData/curlist4/record/real_leas_fee", Math.round((interval/10),0) * eval(model.getValue("/root/resData/curlist6/record/real_leas_fee")) );
							//alert(interval);
							funDatagrid4Sum();
						}
						break;
					case  11 :
						if(datagrid6.valueMatrix(iRow, 10) != ""){
							//alert(datagrid6.valueMatrix(iRow, 10) + "\n" + datagrid6.valueMatrix(iRow, 11));
							var interval = ( (eval(datagrid6.valueMatrix(iRow, 11).substring(0,2)) * 60) + eval(datagrid6.valueMatrix(iRow, 11).substring(2,4)) ) - ( (eval(datagrid6.valueMatrix(iRow, 10).substring(0,2)) * 60) + eval(datagrid6.valueMatrix(iRow, 10).substring(2,4)) );
							model.setValue("/root/resData/curlist4/record/real_leas_fee", Math.round((interval/10),0) * eval(model.getValue("/root/resData/curlist6/record/real_leas_fee")) );
							//alert(interval);
							funDatagrid4Sum();
						}
						break;
				}
				datagrid4.refresh();
				]]>
			</script>
		</datagrid>
		<group id="group3" style="left:10px; top:10px; width:900px; height:21px; ">
			<button id="button7" class="btn02" navindex="13" style="left:605px; top:0px; width:50px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[					
						funSearch();
					]]>
				</script>
			</button>
			<button id="button8" class="btn02" navindex="14" style="left:660px; top:0px; width:50px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//if(model1.getValue("/root/resData/resForm/temp") != "1"){
						//	alert("저장할 데이터가 없습니다.");
						//	return;
						//}
						
						if (window.alert("저장하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						for (var i=1; i<datagrid1.rows; i++){
							if (!(datagrid1.valueMatrix(i, 5) == "" || datagrid1.valueMatrix(i, 5) == "0" || datagrid1.valueMatrix(i, 7) == "" || datagrid1.valueMatrix(i, 7) == "0")){
								datagrid1.rowStatus(i) = 1;
							}
						}
						for (var i=1; i<datagrid2.rows; i++){
							if (!(datagrid2.valueMatrix(i, 2) == "")){
								datagrid2.rowStatus(i) = 1;
							}
						}
						
						model.setValue("/root/reqData/reqForm/film_use_qunt", model.getValue("/root/resData/curlist3/film_use_qunt"));
						//model.setValue("/root/reqData/reqForm/film_use_qunt", model.getValue("/root/resData/film_qunt"));
						model.setValue("/root/reqData/reqForm/paper_wgt", 	model.getValue("/root/resData/curlist3/paper_wgt"));
						model.setValue("/root/reqData/reqForm/ink_use_qunt", 	model.getValue("/root/resData/curlist3/ink_use_qunt"));
						model.setValue("/root/reqData/reqForm/dest_qunt", 	model.getValue("/root/resData/curlist3/dest_qunt"));
						model.setValue("/root/reqData/reqForm/prd_cnt", 		model.getValue("/root/resData/curlist3/prd_cnt"));
						model.setValue("/root/reqData/reqForm/prt_bgn_tm", 	model.getValue("/root/resData/curlist3/prt_bgn_tm"));
						model.setValue("/root/reqData/reqForm/prt_end_tm", 	model.getValue("/root/resData/curlist3/prt_end_tm"));
						
						//model.setValue("/root/reqData/reqForm/bw_prt_fee", 	model.getValue("/root/resData/resForm/prt_cost_bw"));
						//model.setValue("/root/reqData/reqForm/clr_prt_fee", 	model.getValue("/root/resData/resForm/prt_cost_col"));
						model.setValue("/root/reqData/reqForm/papcmpy_cd", 	model.getValue("/root/reqData/searchData/papcmpy_cd"));
						
						model.setValue("/root/reqData/reqForm/leas_use_fee", 	model.getValue("/root/resData/curlist4/record/leas_use_fee"));
						model.setValue("/root/reqData/reqForm/etc_matr_fee", 	model.getValue("/root/resData/curlist4/record/etc_matr_fee"));
						model.setValue("/root/reqData/reqForm/dest_fee", 		model.getValue("/root/resData/curlist4/record/dest_fee"));
						model.setValue("/root/reqData/reqForm/paper_amt", 	model.getValue("/root/resData/curlist4/record/paper_amt"));
						model.setValue("/root/reqData/reqForm/psplat_use_amt", model.getValue("/root/resData/curlist4/record/psplat_use_amt"));
						model.setValue("/root/reqData/reqForm/gnaw_fee", 		model.getValue("/root/resData/curlist4/record/gnaw_fee"));
						model.setValue("/root/reqData/reqForm/film_make_fee", 	model.getValue("/root/resData/curlist4/record/film"));
						model.setValue("/root/reqData/reqForm/ink_use_amt", 	model.getValue("/root/resData/curlist4/record/ink_use_amt"));
						model.setValue("/root/reqData/reqForm/base_leas_fee", 	model.getValue("/root/resData/curlist4/record/base_leas_fee"));
						model.setValue("/root/reqData/reqForm/real_leas_fee", 	model.getValue("/root/resData/curlist4/record/real_leas_fee"));
						model.setValue("/root/reqData/reqForm/pack_fee", 		model.getValue("/root/resData/curlist4/record/pack_fee"));
						
						model.setValue("/root/reqData/reqForm/issu_qty", 		model.getValue("/root/resData/curlist5/record/issu_qty"));
						model.setValue("/root/reqData/reqForm/issu_pcnt", 	model.getValue("/root/resData/curlist5/record/issu_pcnt"));
						model.setValue("/root/reqData/reqForm/bw_pcnt", 		model.getValue("/root/resData/curlist5/record/bw_pcnt"));
						model.setValue("/root/reqData/reqForm/clr_pcnt", 		model.getValue("/root/resData/curlist5/record/clr_pcnt"));
						//model.setValue("/root/reqData/reqForm/prt_bgn_tm", 	model.getValue("/root/resData/curlist6/record/prt_bgn_tm"));
						//model.setValue("/root/reqData/reqForm/prt_end_tm", 	model.getValue("/root/resData/curlist6/record/prt_end_tm"));
						model1.setValue("/root/reqData/reqForm/multiUpData1", datagrid1.getUpdateData());
						model1.setValue("/root/reqData/reqForm/multiUpData2", datagrid2.getUpdateData());
						model1.send("pr_othcnsm_2101_A");
					
						if(submit_completed()) {							
							alert("저장 완료되었습니다.");	
							var issu_dt = model1.getValue("/root/reqData/searchData/issu_dt");
							var prt_dt = model1.getValue("/root/reqData/searchData/prt_dt");
							var fac_clsf = model1.getValue("/root/reqData/searchData/fac_clsf");
							var medi_cd = model1.getValue("/root/reqData/searchData/medi_cd");
							var papcmpy_cd = model1.getValue("/root/reqData/searchData/papcmpy_cd");
							var sect_cd = model1.getValue("/root/reqData/searchData/sect_cd");
							var prt_clsf = model1.getValue("/root/reqData/searchData/prt_clsf");
							
							model1.reset();
							button2.dispatch("onclick");
							//load(); 
							
							model1.setValue("/root/reqData/searchData/issu_dt", issu_dt );
							model1.setValue("/root/reqData/searchData/prt_dt", prt_dt );
							model1.setValue("/root/reqData/searchData/fac_clsf", fac_clsf );
							model1.setValue("/root/reqData/searchData/medi_cd", medi_cd );
							model1.setValue("/root/reqData/searchData/papcmpy_cd", papcmpy_cd );
							model1.setValue("/root/reqData/searchData/sect_cd", sect_cd );	
							model1.setValue("/root/reqData/searchData/prt_clsf", prt_clsf );
							
							
							button7.dispatch("onclick");
							//funSearch();
						}
						
						model1.setValue("/root/resData/resForm/temp", "");
					]]>
				</script>
			</button>
			<button id="button1" class="btn02" navindex="15" style="left:715px; top:0px; width:50px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var occr_dt 	= model.getValue("/root/resData/curlist4/record/occr_dt_curlist4");
						var seq		= model.getValue("/root/resData/curlist4/record/seq_curlist4");
						
						//  필름 소모량 값체크해서 삭제하기
						if(model1.getValue("/root/resData/curlist4/record/seq_curlist4") == ""){
							alert("삭제할 데이터가 없습니다.");
							return;							
						}
						
						if (window.alert("삭제하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						
						model1.setValue("/root/reqData/reqForm/occr_dt", occr_dt); 
						model1.setValue("/root/reqData/reqForm/seq", seq); 
						
						model1.send("pr_othcnsm_2105_A");

						if(submit_completed()) {							
							alert("삭제 완료되었습니다.");	
							var issu_dt = model1.getValue("/root/reqData/searchData/issu_dt");
							var prt_dt = model1.getValue("/root/reqData/searchData/prt_dt");
							var fac_clsf = model1.getValue("/root/reqData/searchData/fac_clsf");
							var medi_cd = model1.getValue("/root/reqData/searchData/medi_cd");
							var papcmpy_cd = model1.getValue("/root/reqData/searchData/papcmpy_cd");
							var sect_cd = model1.getValue("/root/reqData/searchData/sect_cd");
							var prt_clsf = model1.getValue("/root/reqData/searchData/prt_clsf");
							
							button2.dispatch("onclick");
							
							//load();			
							model1.setValue("/root/reqData/searchData/issu_dt", issu_dt );
							model1.setValue("/root/reqData/searchData/prt_dt", prt_dt );
							model1.setValue("/root/reqData/searchData/fac_clsf", fac_clsf );
							model1.setValue("/root/reqData/searchData/medi_cd", medi_cd );
							model1.setValue("/root/reqData/searchData/papcmpy_cd", papcmpy_cd );
							model1.setValue("/root/reqData/searchData/sect_cd", sect_cd );	
							model1.setValue("/root/reqData/searchData/prt_clsf", prt_clsf );	
							
							button7.dispatch("onclick");
							//funSearch();
						}
							
						model1.setValue("/root/resData/resForm/temp", "");
						

					]]>
				</script>
			</button>
			<button id="button2" class="btn02" navindex="16" style="left:770px; top:0px; width:50px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//model1.reset();
						page_reset();
					]]>
				</script>
			</button>
			<!--
			<button id="button3" class="btn04" navindex="17" style="left:700px; top:0px; width:92px; height:21px; ">
				<caption>발행내역조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					fun_mamtstdpcn_Search();
					]]>
				</script>
			</button>
			-->
			<button id="button4" class="btn02" navindex="18" style="left:825px; top:0px; width:50px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					]]>
				</script>
			</button>
		</group>
		<!--
		<output id="input6" ref="/root/resData/resForm/prt_cost_bw" format="#,###" appearance="output" style="left:589px; top:223px; width:80px; height:18px; text-align:right; "/>
		<output id="input7" ref="/root/resData/resForm/prt_cost_col" format="#,###" appearance="output" style="left:764px; top:223px; width:80px; height:18px; text-align:right; "/>
		-->
		<output id="output1" ref="/root/resData/curlist3/seq_curlist3" visibility="hidden" style="left:30px; top:530px; width:100px; height:18px; "/>
		<output id="output2" ref="/root/resData/curlist3/occr_dt_curlist3" visibility="hidden" style="left:135px; top:530px; width:100px; height:18px; "/>
		<!--
		<group id="group2" class="gro_sel" style="left:20px; top:375px; width:835px; height:47px; ">
			<caption id="caption11" class="list_cap01" style="left:0px; top:0px; width:95px; height:24px; text-align:center; ">발행부수</caption>
			<caption id="caption12" class="list_cap02" style="left:94px; top:23px; width:95px; height:24px; text-align:center; "/>
			<caption id="caption13" class="list_cap01" style="left:470px; top:0px; width:95px; height:24px; text-align:center; ">흑백총면수</caption>
			<caption id="caption15" class="list_cap01" style="left:282px; top:0px; width:95px; height:24px; text-align:center; ">칼라면수</caption>
			<caption id="caption17" class="list_cap01" style="left:188px; top:0px; width:95px; height:24px; text-align:center; ">흑백면수</caption>
			<caption id="caption19" class="list_cap01" style="left:94px; top:0px; width:95px; height:24px; text-align:center; ">발행면수</caption>
			<caption id="caption20" class="list_cap02" style="left:0px; top:23px; width:95px; height:24px; text-align:center; "/>
			<caption id="caption21" class="list_cap01" style="left:564px; top:0px; width:95px; height:24px; text-align:center; ">칼라총면수</caption>
			<input id="input3" style="left:1px; top:26px; width:90px; height:18px; "/>
			<caption id="caption14" class="list_cap02" style="left:188px; top:23px; width:95px; height:24px; text-align:center; "/>
			<caption id="caption18" class="list_cap02" style="left:282px; top:23px; width:95px; height:24px; text-align:center; "/>
			<caption id="caption16" class="list_cap01" style="left:376px; top:0px; width:95px; height:24px; text-align:center; ">용지단가</caption>
			<caption id="caption23" class="list_cap02" style="left:376px; top:23px; width:95px; height:24px; text-align:center; "/>
			<caption id="caption24" class="list_cap01" style="left:658px; top:0px; width:95px; height:24px; text-align:center; ">총면수</caption>
			<caption id="caption22" class="list_cap02" style="left:470px; top:23px; width:95px; height:24px; text-align:center; "/>
			<caption id="caption25" class="list_cap02" style="left:564px; top:23px; width:95px; height:24px; text-align:center; "/>
			<caption id="caption26" class="list_cap02" style="left:658px; top:23px; width:95px; height:24px; text-align:center; "/>
		</group>
		-->
		<caption id="caption12" class="list_cap02" style="left:21px; top:245px; width:889px; height:26px; "/>
		<caption id="caption11" class="list_cap01" style="left:10px; top:245px; width:100px; height:26px; text-align:center; ">제지사</caption>
		<select1 id="combo2" ref="/root/reqData/searchData/papcmpy_cd" appearance="minimal" style="left:114px; top:249px; width:151px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/papcmpy_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="caption5" class="list_cap01" style="left:495px; top:220px; width:100px; height:26px; text-align:center; ">잉크사용량</caption>
		<input id="input3" ref="/root/resData/curlist3/ink_use_qunt" navindex="10" inputtype="button" format="#,###.99" style="left:599px; top:224px; width:110px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					model1.setValue("/root/resData/resForm/temp", "1");
				]]>
			</script>
		</input>
		<caption id="caption13" class="list_cap01" style="left:715px; top:220px; width:86px; height:26px; text-align:center; ">역지</caption>
		<input id="input8" ref="/root/resData/curlist3/dest_qunt" navindex="10" format="#,###.99" style="left:805px; top:224px; width:100px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					model1.setValue("/root/resData/resForm/temp", "1");
					model1.setValue("/root/resData/curlist4/record/dest_fee", eval(model1.getValue("/root/resData/curlist3/dest_qunt")) * eval(model1.getValue("/root/resData/curlist6/record/dest_fee")) );
					//funMulti();
					funDatagrid4Sum();
				]]>
			</script>
		</input>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData9/record" caption="잉크^소모^잉크단가^잉크비 계^seq^occr_dt^sub_seq^잉크자재" colsep="#" colwidth="65, 77, 85, 77, 10, 10, 10, 9" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" navindex="7" style="left:580px; top:90px; width:330px; height:123px; ">
			<col ref="matr_nm" style="text-align:left; "/>
			<col ref="qunt" type="input" format="#,###" style="text-align:right; "/>
			<col ref="ink_uprc" format="#,###" style="text-align:right; "/>
			<col ref="ink_fee" format="#,###" style="text-align:right; "/>
			<col ref="seq" visibility="hidden"/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="sub_seq" visibility="hidden"/>
			<col ref="ink_matr" visibility="hidden"/>
			<script type="javascript" ev:event="onendedit">
				<![CDATA[
					model1.setValue("/root/resData/resForm/temp", "1");
					
					var cell			= datagrid2.selectedCells;
					if(cell.length < 1){
						alert("select a Cell");
						return;
					}
					var col			= cell.item(0).col;
					var row			= cell.item(0).row;
					var ink_cost		= 0;
					
					//alert(col + "\n" + row);
					if (col == 2){
						if (datagrid2.valueMatrix(row, 2) == ""){
							datagrid2.valueMatrix(row, 2) = 0;
						}
						if (eval(datagrid2.valueMatrix(row, 2)) == 0){
							ink_cost = 0;
						} else {
							ink_cost = eval(datagrid2.valueMatrix(row, 2)) * eval(datagrid2.valueMatrix(row, 3));
						}
					}
					
					datagrid2.valueMatrix(row, 4) = ink_cost;
					//datagrid1.valueMatrix(row, 7) = gnaw_cost;
					func_getInk_cost();
					
				]]>
			</script>
		</datagrid>
		<caption id="caption9" class="list_cap01" style="left:275px; top:245px; width:100px; height:26px; text-align:center; ">시쇄시각</caption>
		<caption id="caption10" class="list_cap01" style="left:495px; top:245px; width:100px; height:26px; text-align:center; ">종쇄시각</caption>
		<input id="input6" ref="/root/resData/curlist3/prt_bgn_tm" navindex="10" maxlength="4" format="hh:nn" style="left:379px; top:249px; width:46px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var interval = 0;
					model1.setValue("/root/resData/resForm/temp", "1");
					if (eval(model.getValue("/root/resData/curlist6/record/real_leas_fee")) == 0){
						model.setValue("/root/resData/curlist4/record/real_leas_fee", 0);
					} else {
						if(model.getValue("/root/resData/curlist3/prt_end_tm") != ""){
							interval = ( (eval(model.getValue("/root/resData/curlist3/prt_end_tm").substring(0,2)) * 60) + eval(model.getValue("/root/resData/curlist3/prt_end_tm").substring(2,4)) ) - ( (eval(model.getValue("/root/resData/curlist3/prt_bgn_tm").substring(0,2)) * 60) + eval(model.getValue("/root/resData/curlist3/prt_bgn_tm").substring(2,4)) );
							if (model.getValue("/root/resData/curlist3/prd_cnt") == "0" ) {
								model.setValue("/root/resData/curlist4/record/real_leas_fee", Math.round((interval/10),0) * eval(model.getValue("/root/resData/curlist6/record/real_leas_fee")) );
							} else {
								model.setValue("/root/resData/curlist4/record/real_leas_fee", (Math.round((interval/10),0) * eval(model.getValue("/root/resData/curlist6/record/real_leas_fee"))) * eval(model.getValue("/root/resData/curlist3/prd_cnt")) );
							}
						}
					}
					funDatagrid4Sum();
					
				]]>
			</script>
		</input>
		<input id="input7" ref="/root/resData/curlist3/prt_end_tm" navindex="10" maxlength="4" format="hh:nn" style="left:599px; top:249px; width:46px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					model1.setValue("/root/resData/resForm/temp", "1");
					if (eval(model.getValue("/root/resData/curlist6/record/real_leas_fee")) == 0){
						model.setValue("/root/resData/curlist4/record/real_leas_fee", 0);
					} else {
						if(model.getValue("/root/resData/curlist3/prt_bgn_tm") != ""){
							interval = ( (eval(model.getValue("/root/resData/curlist3/prt_end_tm").substring(0,2)) * 60) + eval(model.getValue("/root/resData/curlist3/prt_end_tm").substring(2,4)) ) - ( (eval(model.getValue("/root/resData/curlist3/prt_bgn_tm").substring(0,2)) * 60) + eval(model.getValue("/root/resData/curlist3/prt_bgn_tm").substring(2,4)) );
							if (model.getValue("/root/resData/curlist3/prd_cnt") == "0" ) {
								model.setValue("/root/resData/curlist4/record/real_leas_fee", Math.round((interval/10),0) * eval(model.getValue("/root/resData/curlist6/record/real_leas_fee")) );
							} else {
								model.setValue("/root/resData/curlist4/record/real_leas_fee", (Math.round((interval/10),0) * eval(model.getValue("/root/resData/curlist6/record/real_leas_fee"))) * eval(model.getValue("/root/resData/curlist3/prd_cnt")) );
							}
							
							//var interval = ( (eval(model.getValue("/root/resData/curlist3/prt_end_tm").substring(0,2)) * 60) + eval(model.getValue("/root/resData/curlist3/prt_end_tm").substring(2,4)) ) - ( (eval(model.getValue("/root/resData/curlist3/prt_bgn_tm").substring(0,2)) * 60) + eval(model.getValue("/root/resData/curlist3/prt_bgn_tm").substring(2,4)) );
							//model.setValue("/root/resData/curlist4/record/real_leas_fee", Math.round((interval/10),0) * eval(model.getValue("/root/resData/curlist6/record/real_leas_fee")) );
							
						}
					}
					funDatagrid4Sum();
				]]>
			</script>
		</input>
	</xhtml:body>
</xhtml:html>
