<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>부재료입고등록</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<!-- 공장 -->
							<fact_cd>
								<item>
									<label/>
									<value/>
								</item>
							</fact_cd>
							<sgjbyh_cd>
								<item>
									<label/>
									<value/>
								</item>
							</sgjbyh_cd>
							<sgysjgb_cd>
								<item>
									<label/>
									<value/>
								</item>
							</sgysjgb_cd>
							<sub_seq>
								<item>
									<label/>
									<value/>
								</item>
							</sub_seq>
							<medi_cd>
								<item>
									<label/>
									<value/>
								</item>
							</medi_cd>
							<dlco_clsf_cd>
								<item>
									<label/>
									<value/>
								</item>
							</dlco_clsf_cd>
							<purc_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</purc_clsf>
						</comboSet>
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
					</initData>
					<resData>
						<formData>
							<fac_clsf/>
							<ewh_dt/>
							<ern/>
							<dlco_cd/>
							<addr/>
							<dlco_nm/>
							<vat_amt/>
							<suply_amt/>
							<dlco_clsf_cd/>
							<purc_clsf/>
							<prof_type_cd/>
							<make_dt/>
							<purc_stmt_no/>
							<rcpt_prof_clsf/>
							<slip_no/>
							<impt_yy/>
							<impt_seq/>
							<leas_clsf/>
							<sum_amt/>
							<incmg_slip_dt/>
							<slip_money/>
							<semuro_no/>
						</formData>
						<gridData>
							<record>
								<sub_seq/>
								<matr_cd/>
								<matr_nm/>
								<ewh_qunt/>
								<ewh_uprc/>
								<ewh_amt/>
								<ewh_vat/>
								<ewh_unit/>
								<ewh_budg_cd/>
								<owh_budg_cd/>
								<medi_cd/>
								<medi_ser_no/>
								<remk/>
								<owh_yn/>
								<usedeptcd/>
								<usedeptnm/>
								<owh_dt/>
								<owh_seq/>
								<owh_sub_seq/>
								<owh_no/>
								<mc_flag/>
								<dstb_rat_cd/>
								<bo_item_yn/>
							</record>
						</gridData>
						<gridData_Main>
							<record>
								<cmpy_cd/>
								<occr_dt/>
								<seq/>
								<ewh_dt/>
								<purc_clsf/>
								<fac_clsf_nm/>
								<inpt_yy/>
								<impt_seq/>
								<leas_clsf/>
								<clos_proc_dt/>
							</record>
						</gridData_Main>
						<gridRef>
							<record>
								<clam_dt/>
								<clam_seq/>
								<matr_cd/>
							</record>
						</gridRef>
					</resData>
					<reqData>
						<ewh_dt/>
						<matr_cd/>
						<semuro>
							<cmpy_cd/>
							<occr_dt/>
							<seq/>
							<elec_tax_no1/>
							<elec_tax_no2/>
							<elec_tax_no3/>
							<paper_yn/>
							<semuro_no/>
							<semuro_yn/>
						</semuro>
						<fwdData>
							<func_nm/>
							<matr_cd/>
							<func_type/>
							<ewh_occr_dt/>
							<ewh_seq/>
							<func_flag/>
						</fwdData>
						<searchData>
							<dept_cd/>
							<ewh_dt_fr/>
							<ewh_dt_to/>
							<fac_clsf/>
							<ern/>
							<magam_dt/>
						</searchData>
						<searchDoc>
							<cmpy_cd/>
							<occr_dt/>
							<seq/>
							<clos_clsf/>
						</searchDoc>
					</reqData>
					<tempData>
						<elec_tax_no1/>
						<elec_tax_no2/>
						<elec_tax_no3/>
						<paper_yn/>
						<semuro_no/>
					</tempData>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
						var rv_fac_clsf;
						function setSemuro(iv_cmpy_cd, iv_occr_dt, iv_seq, iv_semuro_no, iv_tax_stmt_clsf, iv_rmsg_pers_semuro_id, iv_send_pers_id, iv_send_pers_eps_no, iv_send_pers_presi_flnm, iv_send_pers_firmnm, iv_send_pers_addr, iv_send_pers_bizcond, iv_send_pers_indt, iv_send_pers_email, iv_issu_dt, iv_tot_suply_amt, iv_tot_amt, iv_tot_tax_amt, iv_cash, iv_note, iv_chqe, iv_trust_unrcp_amt, iv_rcpt_clam_yn, iv_stat_clsf) {

							//alert(iv_cmpy_cd + "-" + iv_occr_dt + "-" + iv_seq + "-" + iv_semuro_no + "-" + iv_tax_stmt_clsf + "-" + iv_rmsg_pers_semuro_id + "-" + iv_send_pers_id + "-" + iv_send_pers_eps_no + "-" + iv_send_pers_presi_flnm + "-" + iv_send_pers_firmnm + "-" + iv_send_pers_addr + "-" + iv_send_pers_bizcond + "-" + iv_send_pers_indt + "-" + iv_send_pers_email + "-" + iv_issu_dt + "-" + iv_tot_suply_amt + "-" + iv_tot_amt + "-" + iv_tot_tax_amt + "-" + iv_cash + "-" + iv_note + "-" + iv_chqe + "-" + iv_trust_unrcp_amt + "-" + iv_rcpt_clam_yn + "-" + iv_stat_clsf);
							
							//-model.setValue("/root/resData/resform/semu_cmpy_cd", iv_cmpy_cd);		// 회사코드
							//-model.setValue("/root/resData/resform/semu_occr_dt", iv_occr_dt);			// 발생일자
							//-model.setValue("/root/resData/resform/semu_seq", iv_seq);				// 일련번호
							model1.setValue("/root/reqData/semuro/semuro_no", iv_semuro_no);	// 세무로번호
							//setSemuro_yn_ck();
							//-ern.value = iv_send_pers_eps_no;		// 발송자사업자번호
							input7.value = iv_send_pers_eps_no;
							//-model.setValue("/root/resData/resform/semu_send_pers_email", iv_send_pers_email);		// 발송자EMAIL
							//-make_dt.value = iv_issu_dt;			// 발행일자
							//-suply_amt.value = iv_tot_suply_amt;		       // 총공급가액
							//-vat_amt.value = iv_tot_tax_amt;			// 총세액

							// 세금계산서구분
							if (iv_tax_stmt_clsf == "01") {		// 세금계산서
								//-prof_type_cd.value = "12"; 
								combo5.value = "12";
								//-prop_equip_cd.value = "8900";
								combo6.value = "8900";
							}
							else if (iv_tax_stmt_clsf == "02") { 	// 영세
								//-prof_type_cd.value = "15"; 
								combo5.value = "15";
								//-prop_equip_cd.value = "";
								combo6.value = "";
							}
							else if (iv_tax_stmt_clsf == "03") { 	// 면세(계산서)
								//-prof_type_cd.value = "14";
								combo5.value = "14";
								//-prop_equip_cd.value = "8950"; 
								combo6.value = "8950";
							}
							else { 
								//prof_type_cd.value = ""; 
								combo5.value = "";
								//prop_equip_cd.value = "";
								combo6.value = "";
							}
							
							//-prop_equip_cd.dispatch("xforms-value-changed"); //전자계산서 여부
							
							//-prof_type_cd.dispatch("xforms-select");
							combo5.dispatch("xforms-select");
							
							/*
							if (model.getValue("/root/reqData/semuro/semuro_no") != "") {
								semuro_yn.value = "Y";
								semuro_yn.disabled = false;
							}
							else {
								semuro_yn.value = "N";
								semuro_yn.disabled = true;
							}
							*/
							setSemuro_yn_ck();
						}
						function setSemuro_yn_ck(){
							//alert(model1.getValue("/root/reqData/semuro/semuro_no").length);
							if (model1.getValue("/root/reqData/semuro/semuro_no").length > 24) {
								semuro_yn.value = "Y";
								//model1.setValue("/root/reqData/semuro/semuro_yn","Y");
								//semuro_yn.disabled = false;
								//semuro_yn.refresh();
								paper_yn.value = " ";
								//model1.setValue("/root/reqData/semuro/paper_yn","N");
								//paper_yn.refresh();
								elec_tax_no1.value = "";
								elec_tax_no2.value = "";
								elec_tax_no3.value = "";
								elec_tax_no1.disabled = true;
								elec_tax_no2.disabled = true;
								elec_tax_no3.disabled = true;
							}else if (model1.getValue("/root/reqData/semuro/semuro_no").length == 24) {
								semuro_yn.value = "N";
								//model1.setValue("/root/reqData/semuro/semuro_yn","N");
								//semuro_yn.refresh();
								paper_yn.value = " ";
								//model1.setValue("/root/reqData/semuro/paper_yn","N");
								//paper_yn.refresh();
								elec_tax_no1.value = model.getValue("/root/reqData/semuro/semuro_no").substring(0, 8);
								elec_tax_no1.value = model.getValue("/root/reqData/semuro/semuro_no").substring(8, 16);
								elec_tax_no1.value = model.getValue("/root/reqData/semuro/semuro_no").substring(16, 24);
							}else if (model1.getValue("/root/resData/formData/semuro_no").length < 24) {
								semuro_yn.value = "N";
								paper_yn.value = "Y";	
								
							}
							
						}
					    function date(gubun)
					   {
					     	    var d = new Date();
					     	    var rec = "";
					     	    var dd = "";
					     	    
					     	    rec = "" + d.getYear();
					     	    if( gubun == 'FROM')
					     	    {
					     	    		dd = "01";
					     	    }
					     	    else if( gubun == 'TO')
					     	    {
						     	    if(d.getDate() < 10 ) dd = "0" + d.getDate();
						     	    else                       dd = d.getDate();
					     	    }
					     	    
					     	    if( d.getMonth() + 1 < 10 )  rec = rec + "0" + (d.getMonth() + 1 )  + dd;
					     	    else if ( d.getMonth() +1 == 10 )  rec = rec  + (d.getMonth() + 1) + dd;
								else if ( d.getMonth() +1 > 10 )  rec = rec  + (d.getMonth() + 1) + dd;
					     	    
					     	    return (rec);
					  }
					  function head_set(ewh_dt, fac_clsf){
					  	     model1.setValue("/root/reqData/searchData/ewh_dt_fr", ewh_dt);
					             model1.setValue("/root/reqData/searchData/ewh_dt_to", ewh_dt);
					             model1.setValue("/root/reqData/searchData/fac_clsf",fac_clsf);
					  }
					
					function head_search(){
						var ewh_dt  = model1.getValue("/root/resData/formData/ewh_dt");
					  	   var owh_dt_fr  = model1.getValue("/root/reqData/searchData/ewh_dt_fr");
					           var owh_dt_to = model1.getValue("/root/reqData/searchData/ewh_dt_to");
					           var fac_clsf    = model1.getValue("/root/reqData/searchData/fac_clsf");
					           
					           button5.dispatch("onclick");
					           
					           model1.setValue("/root/resData/formData/ewh_dt", ewh_dt);
					           model1.setValue("/root/reqData/searchData/ewh_dt_fr", owh_dt_fr);
					           model1.setValue("/root/reqData/searchData/ewh_dt_to", owh_dt_to);
					           model1.setValue("/root/reqData/searchData/fac_clsf", fac_clsf);
					           
					           input3.refresh();
					           input5.refresh();
					           input10.refresh();
					           combo7.refresh();
					           
					           model1.send("mt_submatrin_1102");
					           model1.copyNode("/root/resData/gridData_Main" , "/root/tempData/gridData");
					           
					           datagrid2.refresh();
					  }
					  function detail_search(cmpy_cd, occr_dt, seq){
					  	            
					  	               model1.setValue("/root/reqData/searchDoc/cmpy_cd", cmpy_cd);
								model1.setValue("/root/reqData/searchDoc/occr_dt",    occr_dt);
								model1.setValue("/root/reqData/searchDoc/seq",         seq);
								
								model1.send("mt_submatrin_1103");
								
								model1.copyNode("/root/resData/formData","/root/tempData/FormData");
								
								model1.copyNode("/root/resData/gridData","/root/tempData/gridData");
								model1.setValue("/root/reqData/searchDoc/clos_clsf"  , model1.getValue("/root/tempData/clos_clsf"));
								
								var semu_no, elec_yn;
								semu_no = model1.getValue("/root/resData/formData/semuro_no");
								//elec_yn = model1.getValue("/root/tempData/FormData/elec_tax_bill_yn");
								
								if (model1.getValue("/root/resData/formData/semuro_no").length == 24) {
									elec_tax_no1.value = model1.getValue("/root/resData/formData/semuro_no").substring(0,8);
									elec_tax_no2.value = model1.getValue("/root/resData/formData/semuro_no").substring(8,16);
									elec_tax_no3.value = model1.getValue("/root/resData/formData/semuro_no").substring(16,24);
									paper_yn.value = " ";
								}else if (model1.getValue("/root/resData/formData/semuro_no").length == 35) {
									elec_tax_no1.value = "";
									elec_tax_no2.value = "";
									elec_tax_no3.value = "";
									semuro_yn.value = "Y";
									paper_yn.value = " ";
								} else if (model1.getValue("/root/resData/formData/semuro_no").length == 0) {
									elec_tax_no1.value = "";
									elec_tax_no2.value = "";
									elec_tax_no3.value = "";
									semuro_yn.value = "N";
									paper_yn.value = "Y";
								}
								
								//model1.setValue("/root/tempData/paper_yn", elec_yn);
								//model1.setValue("/root/tempData/semuro_no", semu_no);
								
								group1.refresh();
								datagrid1.refresh();
								
								for( var i = 1 ; i < datagrid1.rows; i++){
									datagrid1.clearStatus();
								}
								
								if( model1.getValue("/root/reqData/searchDoc/clos_clsf") == 'Y' ){
									   group1.disabled = true;
									   datagrid1.isReadOnly(1,1,datagrid1.rows -1 , datagrid1.cols-1) = true;
								}else{
								          group1.disabled = false;
									   datagrid1.isReadOnly(1,1,datagrid1.rows -1 , datagrid1.cols-1) = false;
								}
					  }
					  function InitPage(){
					  	model1.copyNode("/root/initData/pageInfo",parent.root.initData.pageInfo);
					  	 
					  	model1.removenode("/root/resData/gridData/record"); 
						model1.setValue("/root/reqData/searchData/ewh_dt_fr",  date("FROM"));
					   	model1.setValue("/root/reqData/searchData/ewh_dt_to", date("TO"));
					   	model1.setValue("/root/reqData/searchData/magam_dt", date("TO"));
					   	input5.refresh();
					   	input10.refresh();
						input2.refresh();
						
						model1.send("mt_submatrin_1101");
						model1.copyNode("/root/initData/comboSet/fact_cd", "/root/tempData/fact_cd");
						model1.copyNode("/root/initData/comboSet/sgjbyh_cd", "/root/tempData/sgjbyh_cd");
						model1.copyNode("/root/initData/comboSet/sgysjgb_cd", "/root/tempData/sgysjgb_cd");
						model1.copyNode("/root/initData/comboSet/dlco_clsf_cd", "/root/tempData/dlco_clsf_cd");
						model1.copyNode("/root/initData/comboSet/purc_clsf", "/root/tempData/purc_clsf");
						model1.copyNode("/root/initData/comboSet/medi_cd", "/root/tempData/medi_cd");
						
						/*
						*	입력의 편의성을 위해서 자동으로 설정
						*/
						model1.setValue("/root/resData/formData/prof_type_cd" , "12");
						model1.setValue("/root/resData/formData/dlco_clsf_cd" , "93");
						model1.setValue("/root/resData/formData/purc_clsf" , "A");
						model1.setValue("/root/resData/formData/rcpt_prof_clsf" , "8900");
						
						var fac_clsf = model.getValue("/root/initData/comboSet/fact_cd[1]/item/value");
						if (rv_fac_clsf == "" )  rv_fac_clsf = fac_clsf;
						model1.setValue("/root/resData/formData/fac_clsf",rv_fac_clsf);
						model1.setValue("/root/reqData/searchData/fac_clsf",fac_clsf);
						
						//cbo_fac.select(1);
						//combo7.select(1);
						combo1.refresh();
						cbo_fac.refresh();
						combo4.refresh();
						combo5.refresh();
						combo6.refresh();
						combo7.refresh();
						for (var i=0; i<10; i++){
							datagrid1.addRow(true, true);
						}
						//datagrid1.isReadOnly(1,1,datagrid1.rows -1 , datagrid1.cols-1) = true;
						for( var i = 1 ; i < datagrid1.rows; i ++ ){
							datagrid1.rowStatus(i) = 0;
						}
						//datagrid1.refresh();
						
						
						
						combo1.refresh();
						group1.disabled = false;
						
						semuro_yn.value = " ";
						semuro_yn.disabled = true;
						paper_yn.value = " ";                 //디폴트 N						
						elec_tax_no1.value = "88888888";
						elec_tax_no2.value = "88888888";
						elec_tax_no3.value = "88888888";
						paper_yn.disabled = false;
						
						button12.disabled = true;
						button10.disabled = true;
						
					}
				
					function setMatrCd(matr_cd, matr_nm){
						var row = datagrid1.row;
						datagrid1.valueMatrix(row , 2)  = matr_cd;
						if(matr_cd=='5601000'){
							setOwhDept();
						}
						datagrid1.dispatch("onendedit");
							
					}
					function setOwhDept(){
						
						var fac_clsf = model1.getValue("/root/resData/formData/fac_clsf");
						var row = datagrid1.row;
						if(fac_clsf == '10')
						{
							datagrid1.valueMatrix(row , 14)  = "884410";
						}else if(fac_clsf == '22'){
							datagrid1.valueMatrix(row , 14)  = "884400";
						}else if(fac_clsf == '25'){
							datagrid1.valueMatrix(row , 14)  = "885530";
						}
						model1.setValue("/root/reqData/searchData/dept_cd", datagrid1.valueMatrix(row, 14) );
						model1.send("mt_common_0001");
						datagrid1.valueMatrix(row,14 ) =  model1.getValue("/root/tempData/cd");
						datagrid1.valueMatrix(row,15 ) =  model1.getValue("/root/tempData/cd_nm");
						
						if( model1.getValue("/root/tempData/cd") != '' ) {
							datagrid1.valueMatrix(row,13 ) = 'Y';
						}
						else {
							datagrid1.valueMatrix(row,13 ) = 'N';
						}
						
							
					}
					function setErn(dlco_no,  dlco_nm, ern,  persi_nm ){
						model.setValue("/root/resData/formData/ern", ern);
						model.setValue("/root/resData/formData/dlco_cd", dlco_no);
						model.setValue("/root/resData/formData/dlco_nm", dlco_nm);
						
						input1.refresh();
						input7.refresh();
						input8.refresh();
				      }
				      
				      function setDept(dept_cd, dept_nm){
				     		var row = datagrid1.row;
				     	        datagrid1.valueMatrix(row , 14)  = dept_cd;
				     	        datagrid1.valueMatrix(row , 15)  = dept_nm;
				     	        if( dept_cd != '' ) {
									datagrid1.valueMatrix(row,13 ) = 'Y';
						}
						else {
									datagrid1.valueMatrix(row,13 ) = 'N';
						}
				     	        
				      }
				      
				      function valueSet(matr_cd, row){
						var cnt = 0;
						model1.setValue("/root/reqData/matr_cd", matr_cd);
						model1.send("mt_submatrin_1104");
						
						model1.setValue("/root/resData/gridData/record[" + (row) + "]/matr_cd",          model1.getValue("/root/tempData/gridData/record/matr_cd"));
						model1.setValue("/root/resData/gridData/record[" + (row) + "]/matr_nm",         model1.getValue("/root/tempData/gridData/record/matr_nm"));
						model1.setValue("/root/resData/gridData/record[" + (row) + "]/ewh_uprc",       model1.getValue("/root/tempData/gridData/record/ewh_uprc"));
						model1.setValue("/root/resData/gridData/record[" + (row) + "]/ewh_unit",        model1.getValue("/root/tempData/gridData/record/ewh_unit"));
						model1.setValue("/root/resData/gridData/record[" + (row) + "]/ewh_budg_cd", model1.getValue("/root/tempData/gridData/record/ewh_budg_cd"));
						model1.setValue("/root/resData/gridData/record[" + (row) + "]/owh_budg_cd", model1.getValue("/root/tempData/gridData/record/owh_budg_cd"));
						model1.setValue("/root/resData/gridData/record[" + (row) + "]/dstb_rat_cd",    model1.getValue("/root/tempData/gridData/record/dstb_rat_cd"));
						
						var strTmpEwhBudg = datagrid1.valueMatrix(row, 9); //입고예산코드 
						var strTmpOwhcd = datagrid1.valueMatrix(row, 10 );
						var strTmpowhYn = (datagrid1.valueMatrix(row, 13 ) == 'Y' ?  1 : 0) ;
						//alert(strTmpEwhBudg + "_" + strTmpOwhcd +"_" +strTmpowhYn);
//						if ( ( strTmpEwhBudg.length == 0 ) &&    (strTmpOwhcd.length > 0 ) && (strTmpowhYn == 1 ) ){
//							model1.setValue("/root/resData/gridData/record[" + (row) + "]/ewh_budg_cd", model1.getValue("/root/tempData/gridData/record/owh_budg_cd"));					
//						}
						
						
						
						var    l_ewh_qunt =  datagrid1.valueMatrix(row, 4);     // 입고 수량
						var    l_ewh_amt  =  datagrid1.valueMatrix(row,5);     // 입고 금액
						var    l_ewh_uprc = 0;
						//alert(l_ewh_amt + "_" + l_ewh_qunt);
						
						var strTmpEwhUprc = model1.getValue("/root/tempData/gridData/record/ewh_uprc");
						if ( ( strTmpEwhUprc == "0" ) || ( strTmpEwhUprc == "" ) )
						{
							if ( Number(l_ewh_qunt) > 0 ) {
								l_ewh_uprc = Math.round(Number(l_ewh_amt) / Number(l_ewh_qunt)) ;
								model1.setValue("/root/resData/gridData/record[" + (row) + "]/ewh_uprc",       l_ewh_uprc);
							}
							
						}
						
						
						
					       cnt =  Number( model1.getValue("/root/tempData/mediCnt/cnt"));
					      // alert(row);
					       if ( cnt == 1 ){
					          	 model1.setValue("/root/resData/gridData/record[" + (row) + "]/mc_flag",  "MC");
					       } 
					}
					
					function sumuPk(cmpy_cd , occr_dt , seq , semuro_no , tax_stmt_clsf , rmsg_pers_semuro_id , send_pers_id , send_pers_eps_no , send_pers_presi_flnm , send_pers_firmnm , send_pers_addr , send_pers_bizcond , send_pers_indt , send_pers_email , issu_dt , tot_suply_amt , tot_amt , tot_tax_amt , cash , note , chqe , trust_unrcp_amt , rcpt_clam_yn , stat_clsf ){
						
						model1.setValue("/root/reqData/semuro/cmpy_cd",cmpy_cd);
						model1.setValue("/root/reqData/semuro/occr_dt",occr_dt);
						model1.setValue("/root/reqData/semuro/seq",seq);
						//alert(cmpy_cd + "-" + occr_dt + "-" + seq + "-" + semuro_no + "-" + tax_stmt_clsf + "-" + rmsg_pers_semuro_id + "-" + send_pers_id + "-" + send_pers_eps_no + "-" + send_pers_presi_flnm + "-" + send_pers_firmnm + "-" + send_pers_addr + "-" + send_pers_bizcond + "-" + send_pers_indt + "-" + send_pers_email + "-" + issu_dt + "-" + tot_suply_amt + "-" + tot_amt + "-" + tot_tax_amt + "-" + cash + "-" + note + "-" + chqe + "-" + trust_unrcp_amt + "-" + rcpt_clam_yn + "-" + stat_clsf );
  						model1.send("mt_submatrin_1120");
						
						//model1.setValue("" , model1.getValue("/root/tempData/formData/cmpy_cd"));
						//model1.setValue("" , model1.getValue("/root/tempData/formData/occr_dt"));
						//model1.setValue("" , model1.getValue("/root/tempData/formData/seq"));
						model1.setValue("/root/resData/formData/ern" , model1.getValue("/root/tempData/formData/ern"));
						model1.setValue("/root/resData/formData/dlco_cd" , model1.getValue("/root/tempData/formData/dlco_cd"));
						model1.setValue("/root/resData/formData/dlco_nm" , model1.getValue("/root/tempData/formData/dlco_nm"));
						model1.setValue("/root/resData/formData/semuro_no" , model1.getValue("/root/tempData/formData/semuro_no"));
						model1.setValue("/root/resData/formData/sum_amt" , model1.getValue("/root/tempData/formData/tot_suply_amt"));
						model1.setValue("/root/resData/formData/suply_amt" , model1.getValue("/root/tempData/formData/tot_amt"));
						model1.setValue("/root/resData/formData/vat_amt" , model1.getValue("/root/tempData/formData/tot_tax_amt"));
						model1.setValue("/root/resData/formData/make_dt" , model1.getValue("/root/tempData/formData/make_dt"));
						model1.setValue("/root/resData/formData/fac_clsf" , model1.getValue("/root/tempData/formData/fac_clsf"));
						
						model1.copyNode("/root/resData/gridData","/root/tempData/gridData");
    					        model1.refresh();
    					        
    					        for( var i = 1 ; i < datagrid1.rows; i++){
							//datagrid1.clearStatus();
							datagrid1.rowStatus(i) = 1;
						}
						
						if( model1.getValue("/root/reqData/searchDoc/clos_clsf") == 'Y' ){
							   group1.disabled = true;
							   datagrid1.isReadOnly(1,1,datagrid1.rows -1 , datagrid1.cols-1) = true;
						}else{
						          group1.disabled = false;
							   datagrid1.isReadOnly(1,1,datagrid1.rows -1 , datagrid1.cols-1) = false;
						}
					}
					
					 
					function setSlipNo(slipNo, slipMoney){
							model1.setValue("/root/resData/formData/slip_no" , slipNo);
							model1.setValue("/root/resData/formData/slip_money" , slipMoney);
							
							output6.refresh();
					}
					function setLs( yy , seq, ls_gubun){
							model1.setValue("/root/resData/formData/impt_yy" , yy);
							model1.setValue("/root/resData/formData/impt_seq" , seq);
							model1.setValue("/root/resData/formData/leas_clsf" , ls_gubun);
							
							output3.refresh();
							output4.refresh();
						       output5.refresh();
					}
					
					function inputDataChk(){
						
						var semu_set_no;
						if (model1.getValue("/root/reqData/semuro/paper_yn") != "Y"){ /* 종이계산서가 아니면 전자계산서 이면*/
							if (model1.getValue("/root/reqData/semuro/semuro_yn") != "Y") {	/* 스마트빌 계산서가 아니면*/
								if (model1.getValue("/root/reqData/semuro/elec_tax_no1").length != 8 || 
								    model1.getValue("/root/reqData/semuro/elec_tax_no2").length != 8 ||
								    model1.getValue("/root/reqData/semuro/elec_tax_no3").length  != 8  ) {
										alert("전자세금계산서 승인번호를 입력하여주십시요.");
										return false;
								} else if (model1.getValue("/root/reqData/semuro/elec_tax_no1").length == 8 ||  //계산서번호 세팅
												model1.getValue("/root/reqData/semuro/elec_tax_no2").length == 8 ||
												model1.getValue("/root/reqData/semuro/elec_tax_no3").length == 8  ) {
									semu_set_no = model1.getValue("/root/reqData/semuro/elec_tax_no1") +
															model1.getValue("/root/reqData/semuro/elec_tax_no2") +
															model1.getValue("/root/reqData/semuro/elec_tax_no3") ;
									//alert(semu_set_no);
									model.setValue("/root/resData/formData/semuro_no", semu_set_no);
								}
							} else { /*스마트빌 계산서 이면*/
									if (model.getValue("/root/reqData/semuro/semuro_no").length != 35) {
										alert("스마트빌 연계 팝업을 사용하여 주십시요.");
										return false;
									} else {
										semu_set_no = model.getValue("/root/reqData/semuro/semuro_no");
										model.setValue("/root/resData/formData/semuro_no", semu_set_no);
									}
							}
						} else {
							model.setValue("/root/resData/formData/semuro_no", "");
						}
						
						var rowNum = datagrid1.rows;
						var dataValidation = 'N';
						
						var in_ewh_dt =  model1.getValue("/root/resData/formData/ewh_dt");
						var in_make_dt = model1.getValue("/root/resData/formData/make_dt");
							
						if( model1.getValue("/root/resData/formData/fac_clsf") == '') {
							alert("공장은 필수 데이터 입니다.");
							return false;
						}
						if( in_ewh_dt == '' ) {
							alert("입고 일자를 선택 해주세요");
							return false;
						}
						if( in_make_dt == '' ) {
							alert("계산서 일자를 선택 해주세요");
							return false;
						}
						
						//입고월 계산서 입수월이 다르면 입력 불가
						//계산서 입수일이 회계일(입고일)보다 크면 입력이 불가,20040128추가
						if ( Number(in_make_dt) >Number(in_ewh_dt) ){
						 	alert("계산서 입수일이 회계일(입고일)보다 크면 입력이 불가합니다");
						 	return false;
						}
						
						//회계월(입고월)과 계산서 입수월이 다르면 입력이 불가합니다
						in_ewh_dt    = in_ewh_dt.substr(0,6);
						in_make_dt  = in_make_dt.substr(0,6);
						
						if ( in_ewh_dt != in_make_dt) {
							alert("회계월(입고월)과 계산서 입수월이 다르면 입력이 불가합니다");
							return false;
						}
						
						//매입구분 체크
						if( model1.getValue("/root/resData/formData/purc_clsf") == '' ){
							alert("매입구분이 누락 되었습니다.");
							return false;
						}
						if( model1.getValue("/root/resData/formData/rcpt_prof_clsf") == ''){
							alert("계산서 구분을 입력해주세요");
							return false;
						}
						// 사업자 번호 확인 
						if( model1.getValue("/root/resData/formData/ern") == '' ){
							alert("사업자 번호를 입력해주세요.");
							return false;
						}
						if( model1.getValue("/root/resData/formData/suply_amt") == '' || model1.getValue("/root/resData/formData/vat_amt") == ''){
							alert("계산서 금액과 세금금액이 누락 되었습니다.");
							return false;
						}
						
						for (var  i = 1  ; i < datagrid1.rows; i++) {
							switch(datagrid1.valueMatrix(i, 9)) {
								case '304301' :
								case '304302' :
								case '652101' :
								case '652103' :
				                           dataValidation = 'Y';
				                           break;
							} 

							if( dataValidation == 'Y' ) break;
						}
						
						if(  (dataValidation == 'Y') && (model1.getValue("/root/resData/formData/prof_type_cd") != '13' )){
							alert("계산서구분을 13으로 해야하는 예산코드가 있습니다");
							return false;
						}
						
						if( model1.getValue("/root/resData/formData/prof_type_cd") == '' ){
						 	alert("[계산서구분]을 입력하시오");
							return false;
						}
						
						//증빙유형 체크
						if (model1.getValue("/root/resData/formData/prof_type_cd") == '16' ){ // 부가세가 없다
							var chktax = true;
							
							if ( Number(model1.getValue("/root/resData/formData/vat_amt")) != 0 ) {
								chktax =  false;
							}
								
							if( chktax == true){
								for ( var i = 1 ;  i < datagrid1.rows; i++){
									if( Number(datagrid1.valueMatrix(i, 6 )) > 0 ) {
										chktax =  false;
									} 
								}
							}
								
							if ( chktax == false){
								if( window.alert("[계산서구분 16]은 부가세가 0 입니다.\n 전체 부가세를 0으로 수정 후 입력 하시겠습니까?", "확인", 1) != 1) return false;
							
								model1.setValue("/root/resData/formData/vat_amt", 0 );	
									
						 		for ( i = 1 ; i < datagrid1.rows ; i++){
									 datagrid1.valueMatrix(i,6) = 0;	
								}
							}
						}
						
						// 총 부가세액과 그리그 상의 부가세액이 틀리면 해당 입력 데이터 중 가장 위의 데이터에 부가세액 +/- 처리 
						var intInputVat = 0;
							
						for( var i = 1 ; i < datagrid1.rows ; i++){
							intInputVat = intInputVat + Number(datagrid1.valueMatrix(i,6)); 
						}
							
						if ( Number(model1.getValue("/root/resData/formData/vat_amt")) !=  intInputVat ){
							var intMinusVat = Number(model1.getValue("/root/resData/formData/vat_amt")) - intInputVat;
							  	
							for ( var i = 1 ; i < datagrid1.rows ; i++ ){
								datagrid1.valueMatrix(i ,6) = Number(datagrid1.valueMatrix( i , 6)) + intMinusVat;
								break;
							}
						}
						
						var ACNT = 0 ; //외상매입금 COUNT
						var BCNT = 0;  //미지급금 COUNT
						var lngSumSuplyAmt  = 0;
						var lngSumVatAmt = 0 ;
					    
						for (var i = 1 ; i < datagrid1.rows ; i++){
							var strTmpEwhBudg = "";   //입고 예산코드
							var strTmpOwhcd    = "";   //출고 예산코드 
							var strTmpRemk      = "";   // 비고 
							var strTmpDept        = "";   //부서코드
							var strTmpowhYn     ="";   // 출고 여부
							
							for(var j= 1;j < datagrid1.cols;j++){
							   		//alert(i + " - " + j + "= " + datagrid1.valueMatrix(i,j));
								switch(j) {
									case 5:
											lngSumSuplyAmt = lngSumSuplyAmt + Number(datagrid1.valueMatrix(i, j));
											break;
									case 6:
											var strTmpProfCd = model1.getValue("/root/resData/formData/prof_type_cd");
											lngSumVatAmt = lngSumVatAmt + Number(datagrid1.valueMatrix(i, j));
											
											// '20060914 자재부 조동환과장님 요청에 의해서
											// '20070827 자재부 황우주과장님 요청에 의해서 16,17번은 부가세 확인 안함
											if(  (strTmpProfCd  != '16' ) && ( strTmpProfCd  != '17' )   ){
												if( Number( datagrid1.valueMatrix(i, j) ) !=  (Math.round( Number( datagrid1.valueMatrix(i,5) ) / 10 ) )) {
													if( window.alert("부가세금액을 확인하십시요..\n진행하시겠습니까?(입고금액의 10%불일치)" ,"조선일보MIS",  1) != 1  ) {
														return false;
													}
												}
											}
											/*
											if( model1.getValue("/root/resData/formData/purc_clsf") == 'W'){
												datagrid1.valueMatrix(i, j) = 0;   // 외자 처리
											}
											break;
											 */
									case 8:
											strTmpEwhBudg = datagrid1.valueMatrix(i, 9); //입고예산코드 
											
											if( (strTmpEwhBudg.substr(1,2) == '14') && (model1.getValue("/root/resData/formData/prof_type_cd") == '13') ){
												alert("재고자산은 계산서구분 13 으로 입력할수 없습니다!!");
												return false;
											}
											break;
									case 10: 
											strTmpOwhcd = datagrid1.valueMatrix(i, 10 );
											break;
									case 12:
											strTmpRemk = datagrid1.valueMatrix(i, 12);
											//strTmpRemk= strTmpRemk.substring(0, strTmpRemk.indexOf(' '));
											
											if ( (strTmpOwhcd == '777019' ) && (strTmpRemk == "") ){
												alert("비고란에 부거래처명을 입력하십시오!!");
												return false;
											}
											break;
									case 13:
											strTmpowhYn = (datagrid1.valueMatrix(i, 13 ) == 'Y' ?  1 : 0) ;
											
											if (strTmpowhYn == 1 ) {
												if ( datagrid1.valueMatrix(i,14).length < 6 ){
													alert("[출고부서코드] 를 입력 하세요");
													return false;
												}
											}
											break;
									case 14 :
											strTmpDept = datagrid1.valueMatrix(i,14);
											break;
									case 15 :
											//alert("여부=" + strTmpowhYn + "\n입고예산=" + strTmpEwhBudg.length +"\n출고예산=" + strTmpOwhcd.length);
											if ( ( strTmpEwhBudg.length == 0 ) &&    (strTmpOwhcd.length > 0 ) && (strTmpowhYn == 1 ) ){
												//alert(datagrid1.valueMatrix(i, 10 ));
												model1.setValue("/root/resData/gridData/record[" + (i) + "]/ewh_budg_cd", datagrid1.valueMatrix(i, 10 ) );
												model1.setValue("/root/resData/gridData/record[" + (i) + "]/bo_item_yn", 'Y');
												

												//datagrid1.valueMatrix(i, 9) = datagrid1.valueMatrix(i, 10 );
												//datagrid1.valueMatrix(i, 21) = "Y";
											}
											//'재고자산이면서 동시입출고 항목
											if( (strTmpEwhBudg.length > 0 ) &&  (strTmpOwhcd.length> 0 ) && ( strTmpowhYn == 1 ) ){
												model1.setValue("/root/resData/gridData/record[" + (i) + "/bo_item_yn", ' ');
												if ( strTmpDept.length < 6 ){
													alert("부서코드를 입력하시오");
													return false;
												}
											} else if ( ( strTmpEwhBudg.length > 0 ) &&  (strTmpOwhcd.length> 0 ) && ( strTmpowhYn == 0 )) {	//순수 입고 항목 소모품이 아닌 경우(재고자산)
												model1.setValue("/root/resData/gridData/record[" + (i) + "/bo_item_yn", ' ');
												model1.setValue("/root/resData/gridData/record[" + (i) + "/usedept", ' ');
											}
											
											if( model1.getValue("/root/resData/formData/purc_clsf") == 'A') {                               //외상 매입금 이면
												if ( ( Number( strTmpEwhBudg ) >= 130500 ) && ( Number( strTmpEwhBudg ) <= 145500 ) ) {
													ACNT = ACNT + 1;   //회계법상 부재료 : 외상 매입금
												} else   {
													BCNT = BCNT + 1;  //미지급금
												}
											}
											break;
									case 20:
										var strTmpmcflag  = datagrid1.valueMatrix(i,20);
										var strTmpdstbCd  = datagrid1.valueMatrix(i,21);
										var strTmpMediCd = datagrid1.valueMatrix(i,11);
										
										//strTmpEwhBudg = datagrid1.valueMatrix(i, 9);
										               
										if( ( strTmpmcflag == 'MC' ) &&  (strTmpdstbCd.length == 0 ) ){
											alert("매체 코드를 입력 하세요");
											return false;
										}
										//alert("배부비코드=" + strTmpdstbCd.length + "\n매체코드=" + strTmpMediCd.length + "\n입고예산코드" + strTmpEwhBudg.length);
										if( (strTmpdstbCd.length == 0 ) &&  ( strTmpMediCd.length == 0 ) && ( strTmpEwhBudg.length > 0 ) ){
											alert('매체를 반드시 입력해야 하는 자재입니다(배부비코드 확인)');
											return false;
										}
										break;
								}// switch case end
							}//for end
						}// for end
						
						if ( lngSumSuplyAmt != Number( model1.getValue("/root/resData/formData/suply_amt")) ){
									alert("[입고금액]을 확인하시오");
									return false;
						}
						
						
						// 매입 구분 처리
						if(  (( ACNT > 0 ) && ( BCNT > 0 ) ) || ( ( ACNT > 0 ) && ( BCNT == 0 )) ) {
							        //외상매입금과 미지급금이 동일계산서에 발생하면 외상매입금으로 처리
								 model1.setValue("/root/resData/formData/purc_clsf", 'A');
						}
					       else if (  ( BCNT > 0 ) && ( ACNT == 0 ) ){
					       	                model1.setValue("/root/resData/formData/purc_clsf", 'B');
					       }
					       
						
						  
						if( model1.getValue("/root/resData/formData/purc_clsf")  == 'W' ){
    						  	//증빙유형코드
                                                      model1.setValue("/root/resData/formData/prof_type_cd" ,"");  //증빙유형코드가 Space이면 세금계산서를 입력하지 않는다.
    						} else {
 						  	model1.setValue("/root/resData/formData/impt_yy"  , "");
    						  	model1.setValue("/root/resData/formData/impt_seq", "");
    						  	model1.setValue("/root/resData/formData/leas_clsf", "");
    						}
    						  
    						if( model1.getValue("/root/resData/formData/purc_clsf")  != 'C' ){
    						  	model1.setValue("/root/resData/formData/slip_no", "");
    						}
    						  
    						if( ( model1.getValue("/root/resData/formData/ern").length > 0 ) && model1.getValue("/root/resData/formData/purc_clsf")  == 'Y')  {
    						  	/*   
    						  	  model1.setValue("/root/resData/formData/sgbscymd", model1.getValue("/root/resData/formData/make_dt"));
    						          model1.setValue("/root/resData/formData/sgseq", model1.getValue("/root/resData/formData/ewh_seq"));
    						  	  model1.setValue("/root/resData/formData/sgjpgbcd" ) = '41';
    						  	  model1.setValue("/root/resData/formData/sgsaeobcd" ) = '01';
    						  	  model1.setValue("/root/resData/formData/sggrgb") = ' ';
    						  	  model1.setValue("/root/resData/formData/sggssst") = '1';
    						  	  if( model1.getValue("").length == 0 ){
    						  	  	alert("영수증구분 을 선택 하세요");
    						  	  }
    						  	  model1.setValue("/root/resData/formData/sgmangi") = ' ';
    						  	  model1.setValue("/root/resData/formData/sgdelsyu") = ' ';
    						  	  model1.setValue("/root/resData/formData/sgbigo") = ' ';
    						  	  model1.setValue("/root/resData/formData/sgmccd") = ' ';
    						  	  */
    						  }
    						  
    						   // '예외처리 2002/10/10추가
    						  var tmpErn = model1.getValue("/root/resData/formData/ern");
    						  
						  if ( model1.getValue("/root/resData/formData/dlco_clsf_cd") == '96' )  {               //  '거래처구분코드
						    	  
						    	  if ( tmpErn  != '000-10-10101' )    {                                                            //'일본광고지사는 SKIP처리2004/01/15
						          	 if ( model1.getValue("/root/resData/formData/ern") != '' ){                    // '사업자번호(005등)
						                	   model1.setValue("/root/resData/formData/dlco_cd", tmpErn);         //거래처코드
						                }
						          }
						  }
    
                                               // ' 2007/08/27추가
                                               //' 사업자번호가 사업자 번호가 아닐때 거래처가 사업자가 들어가지 않게
						 if (model1.getValue("/root/resData/formData/dlco_clsf_cd") == "93")  {
						 	 
						         if (tmpErn.substr( 3, 1 ) != '-'  ){
						             alert ("거래처구분을 확인하시오!");
						             return false;
						         }
						         if (tmpErn.substr( 6, 1 ) != '-'  ){
						             alert ("거래처구분을 확인하시오!");
						             return false;
						         }
						 }
						 
						if ( model1.getValue("/root/resData/formData/purc_clsf") == 'C') {
							var sumMoney = Number(model1.getValue("/root/resData/formData/suply_amt")) + Number(model1.getValue("/root/resData/formData/vat_amt"));
							
							if ( sumMoney != Number(model1.getValue("/root/resData/formData/slip_money") ) ){
								alert("지출결의 번호의 결의금액[" + model1.getValue("/root/resData/formData/slip_money") +"]과 합계금액[" + sumMoney + "]이 다르면 입력이 불가능 합니다.");
								return false;
							}
						}
						
						
						return true;
				}
				
				function ResetClamData(){
					model.removenode("/root/resData/gridRef");
					model.makeNode("/root/resData/gridRef");
					/*
					var nodeList = instance1.selectNodes("/root/resData/gridRef/record");
					for (var i=0; i<nodeList.length + 1; i++){
						model.removenode("/root/resData/gridRef/record[" + (i) + "]");
					}
					*/
					datagrid3.refresh();
				}
				
				function setItemclam(clam_dt, clam_seq, clam_sub_seq, clam_matr, chk_yn){
					//alert(clam_dt + "\n" + clam_seq + "\n" + clam_matr);
					//alert(datagrid3.rows);
					if (datagrid3.rows == 1){
						if (chk_yn == "1"){
							datagrid3.addRow(true, true);
							datagrid3.valueMatrix(datagrid3.rows-1, datagrid3.colRef("clam_dt")) = clam_dt;
							datagrid3.valueMatrix(datagrid3.rows-1, datagrid3.colRef("clam_seq")) = clam_seq;
							datagrid3.valueMatrix(datagrid3.rows-1, datagrid3.colRef("clam_sub_seq")) = clam_sub_seq;
							datagrid3.valueMatrix(datagrid3.rows-1, datagrid3.colRef("clam_matr")) = clam_matr;
							datagrid1.valueMatrix(datagrid1.row, datagrid1.colRef("clam_yn")) = clam_dt + "-" + clam_seq;
							//alert("rows==1");
						}
					} else {
						datagrid1.valueMatrix(datagrid1.row, datagrid1.colRef("clam_yn")) = clam_dt + "-" + clam_seq;
						for (var i=datagrid3.fixedRows; i<datagrid3.rows; i++){
							if (datagrid3.valueMatrix(i, datagrid3.colRef("clam_dt")) == clam_dt && datagrid3.valueMatrix(i, datagrid3.colRef("clam_seq")) == clam_seq && datagrid3.valueMatrix(i, datagrid3.colRef("clam_sub_seq")) == clam_sub_seq){
								//alert("행 수정..");
								if (chk_yn == "0"){
									datagrid3.rowStatus(i) = 4;
									//alert("삭제");
								} else {
									datagrid3.valueMatrix(i, datagrid3.colRef("clam_matr")) = clam_matr;
									//alert("수정");
									if (datagrid3.rowStatus(i) != 1){
										datagrid3.rowStatus(i) = 1;
									}
									
								}
							} else {
								if (chk_yn == "1"){
									//alert("행추가..");
									datagrid3.addRow(true, true);
									datagrid3.valueMatrix(datagrid3.rows-1, datagrid3.colRef("clam_dt")) = clam_dt;
									datagrid3.valueMatrix(datagrid3.rows-1, datagrid3.colRef("clam_seq")) = clam_seq;
									datagrid3.valueMatrix(datagrid3.rows-1, datagrid3.colRef("clam_sub_seq")) = clam_sub_seq;
									datagrid3.valueMatrix(datagrid3.rows-1, datagrid3.colRef("clam_matr")) = clam_matr;
								}
							}
						}
					}
				}
				
				function setItemclam2(clam_dt, clam_seq, clam_matr, chk_yn){
					//alert(clam_dt + "\n" + clam_seq + "\n" + clam_matr);
					//alert(datagrid3.rows);
					if (datagrid3.rows == 1){
						datagrid3.addRow(true, true);
						datagrid3.valueMatrix(datagrid3.rows-1, datagrid3.colRef("clam_dt")) = clam_dt;
						datagrid3.valueMatrix(datagrid3.rows-1, datagrid3.colRef("clam_seq")) = clam_seq;
						datagrid3.valueMatrix(datagrid3.rows-1, datagrid3.colRef("clam_matr")) = clam_matr;
					} else {
						for (var i=datagrid3.fixedRows; i<datagrid3.rows; i++){
							if (datagrid3.valueMatrix(i, datagrid3.colRef("clam_dt")) == clam_dt && datagrid3.valueMatrix(i, datagrid3.colRef("clam_seq")) == clam_seq){
								//alert("행 수정..");
								if (chk_yn == "1"){
									datagrid3.rowStatus(i) = 4;
								} else {
									datagrid3.valueMatrix(i, datagrid3.colRef("clam_matr")) = clam_matr;
									if (datagrid3.rowStatus(i) != 1){
										datagrid3.rowStatus(i) = 1;
									}
								}
							} else {
								//alert("행추가..");
								datagrid3.addRow(true, true);
								datagrid3.valueMatrix(datagrid3.rows-1, datagrid3.colRef("clam_dt")) = clam_dt;
								datagrid3.valueMatrix(datagrid3.rows-1, datagrid3.colRef("clam_seq")) = clam_seq;
								datagrid3.valueMatrix(datagrid3.rows-1, datagrid3.colRef("clam_matr")) = clam_matr;
							}
						}
					}
				}
				]]>
			</script>
			<submission id="mt_submatrin_1101" action="/mt/submatrin/1101" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="mt_submatrin_1102" action="/mt/submatrin/1102" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_submatrin_1103" action="/mt/submatrin/1103" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchDoc" resultref="/root/tempData"/>
			<submission id="mt_submatrin_1105" action="/mt/submatrin/1105" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchDan" resultref="/root/tempData"/>
			<submission id="mt_submatrin_1104" action="/mt/submatrin/1104" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/matr_cd" resultref="/root/tempData"/>
			<submission id="mt_submatrin_1106" action="/mt/submatrin/1106" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/formData" resultref="/root/tempData"/>
			<submission id="mt_submatrin_1110" action="/mt/submatrin/1110" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchDoc" resultref="/root/tempData"/>
			<submission id="mt_submatrin_1116" action="/mt/submatrin/1116" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_submatrin_1119" action="/mt/submatrin/1119" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_submatrin_1120" action="/mt/submatrin/1120" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/semuro" resultref="/root/tempData"/>
			<submission id="mt_common_0001" action="/mt/common/0001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_common_0002" action="/mt/common/0002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				model1.setValue("/root/resData/formData/ewh_dt", getCurrentDate());
				model1.setValue("/root/resData/formData/incmg_slip_dt", getCurrentDate());
				
				model1.removenode("/root/resData/gridRef/record");
				
				elec_tax_no1.value = "88888888";
				elec_tax_no2.value = "88888888";
				elec_tax_no3.value = "88888888";
				input3.refresh();
				input4.refresh();
				
				var fac_clsf = model.getValue("/root/initData/comboSet/fact_cd[1]/item/value");
				rv_fac_clsf = fac_clsf;
				model1.setValue("/root/resData/formData/fac_clsf",rv_fac_clsf);
						
				cbo_fac.refresh();
				//cbo_fac.select(1);
				//combo7.select(1);
				datagrid3.refresh();
				//model.refresh();
				]]>
			</script>
			<submission id="mt_common_0003" action="/mt/common/1001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
		</model>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/TFCommon.js"/>
	</xhtml:head>
	<xhtml:body pagewidth="925" pageheight="600" guideline="2,394;2,8;1,5;1,915;2,32;2,73;">
		<group id="group1" class="gro_sel" style="left:5px; top:206px; width:910px; height:184px; border-color:#00ffff; ">
			<caption id="caption4" class="list_cap02" style="left:150px; top:151px; width:760px; height:26px; text-align:center; "/>
			<caption id="caption28" class="list_cap02" style="left:114px; top:51px; width:796px; height:26px; text-align:center; "/>
			<caption id="caption3" class="list_cap01" style="left:0px; top:1px; width:115px; height:26px; text-align:center; ">공장</caption>
			<caption id="caption2" class="list_cap02" style="left:114px; top:1px; width:796px; height:26px; text-align:center; "/>
			<caption id="caption33" class="list_cap01" style="left:323px; top:1px; width:100px; height:26px; text-align:center; ">입고일자</caption>
			<caption id="caption35" class="list_cap01" style="left:0px; top:26px; width:115px; height:26px; text-align:center; ">입력/전표일자</caption>
			<caption id="caption36" class="list_cap02" style="left:114px; top:26px; width:796px; height:26px; text-align:center; "/>
			<caption id="caption8" class="list_cap01" style="left:323px; top:26px; width:100px; height:26px; text-align:center; ">사업자번호</caption>
			<caption id="caption12" class="list_cap01" style="left:0px; top:51px; width:115px; height:26px; text-align:center; ">계산서금액</caption>
			<caption id="caption13" class="list_cap01" style="left:0px; top:76px; width:120px; height:26px; text-align:center; ">거래처구분</caption>
			<caption id="caption16" class="list_cap01" style="left:323px; top:51px; width:100px; height:26px; text-align:center; ">세금금액</caption>
			<caption id="caption18" class="list_cap02" style="left:114px; top:76px; width:796px; height:26px; text-align:center; "/>
			<caption id="caption20" class="list_cap01" style="left:323px; top:76px; width:100px; height:26px; text-align:center; ">매입구분</caption>
			<caption id="caption21" class="list_cap01" style="left:0px; top:101px; width:115px; height:26px; text-align:center; ">계산서일자</caption>
			<caption id="caption51" class="list_cap02" style="left:113px; top:126px; width:797px; height:26px; text-align:center; "/>
			<caption id="caption53" class="list_cap02" style="left:114px; top:101px; width:796px; height:26px; text-align:center; "/>
			<caption id="caption47" class="list_cap01" style="left:323px; top:101px; width:100px; height:26px; text-align:center; ">계산서번호</caption>
			<caption id="caption54" class="list_cap01" style="left:0px; top:126px; width:115px; height:26px; text-align:center; ">지출결의번호</caption>
			<input id="input3" ref="/root/resData/formData/ewh_dt" class="req" navindex="6" inputtype="date" style="left:428px; top:5px; width:120px; height:18px; "/>
			<input id="input6" ref="/root/resData/formData/suply_amt" navindex="9" format="(-)#,###" style="left:122px; top:56px; width:125px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var suply_amt	=  model1.getValue("/root/resData/formData/suply_amt");
					model1.setValue("/root/resData/formData/vat_amt", eval(suply_amt) * 0.1);
					var var_amt	=  model1.getValue("/root/resData/formData/vat_amt");
					var sum_amt	=  "" ;

					sum_amt		=  eval(suply_amt) + eval(var_amt);
					model1.setValue("/root/resData/formData/sum_amt", sum_amt);
					input12.refresh();
					output1.refresh();
					]]>
				</script>
			</input>
			<input id="input9" ref="/root/resData/formData/make_dt" navindex="14" inputtype="date" style="left:122px; top:105px; width:90px; height:18px; "/>
			<input id="input12" ref="/root/resData/formData/vat_amt" navindex="10" format="(-)#,###" style="left:428px; top:55px; width:117px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var suply_amt	=  model1.getValue("/root/resData/formData/suply_amt");
						var var_amt	=  model1.getValue("/root/resData/formData/vat_amt");
						var sum_amt	=  "";
						
						sum_amt         =  eval(suply_amt) + eval(var_amt) ;
						model1.setValue("/root/resData/formData/sum_amt", sum_amt);
						output1.refresh();
					]]>
				</script>
			</input>
			<input id="input16" ref="/root/resData/formData/purc_stmt_no" navindex="15" style="left:427px; top:105px; width:118px; height:18px; "/>
			<select1 id="cbo_fac" ref="/root/resData/formData/fac_clsf" class="req" navindex="5" appearance="minimal" style="left:122px; top:5px; width:90px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fact_cd/item">
						<value ref="value"/>
						<label ref="label"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
						rv_fac_clsf = model1.getValue("/root/resData/formData/fac_clsf");
					]]>
				</script>
			</select1>
			<input id="input4" ref="/root/resData/formData/incmg_slip_dt" navindex="7" inputtype="date" style="left:122px; top:30px; width:90px; height:18px; "/>
			<select1 id="combo1" ref="/root/resData/formData/dlco_clsf_cd" navindex="11" appearance="minimal" style="left:122px; top:80px; width:125px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dlco_clsf_cd/item">
						<value ref="value"/>
						<label ref="label"/>
					</itemset>
				</choices>
			</select1>
			<output id="output1" ref="/root/resData/formData/sum_amt" format="(-)#,###" style="left:675px; top:55px; width:155px; height:18px; background-color:#dddddd; border-color:#999999; "/>
			<select1 id="combo4" ref="/root/resData/formData/purc_clsf" navindex="12" appearance="minimal" style="left:428px; top:80px; width:117px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/purc_clsf/item">
						<value ref="value"/>
						<label ref="label"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
					    var purc_clsf;
					    purc_clsf= model1.getValue("/root/resData/formData/purc_clsf");
					    switch(purc_clsf){
					    	case 'C':  button10.disabled = false;
					    	               break;
					    	case 'W':
					    	               button12.disabled = false;
					    	               break;
					    	default :
					    	             button10.disabled = true;
					    	             button12.disabled = true;
					    }
					  
					]]>
				</script>
			</select1>
			<select1 id="combo5" ref="/root/resData/formData/prof_type_cd" navindex="13" appearance="minimal" style="left:676px; top:80px; width:154px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/sgjbyh_cd/item">
						<value ref="value"/>
						<label ref="label"/>
					</itemset>
				</choices>
			</select1>
			<output id="output3" ref="/root/resData/formData/impt_yy" style="left:430px; top:130px; width:80px; height:18px; background-color:#dddddd; border-color:#999999; "/>
			<output id="output4" ref="/root/resData/formData/impt_seq" style="left:520px; top:130px; width:85px; height:18px; background-color:#dddddd; border-color:#999999; "/>
			<output id="output5" ref="/root/resData/formData/leas_clsf" style="left:610px; top:130px; width:45px; height:18px; background-color:#dddddd; border-color:#999999; "/>
			<select1 id="combo6" ref="/root/resData/formData/rcpt_prof_clsf" navindex="16" appearance="minimal" style="left:676px; top:105px; width:155px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/sgysjgb_cd/item">
						<value ref="value"/>
						<label ref="label"/>
					</itemset>
				</choices>
			</select1>
			<output id="output6" ref="/root/resData/formData/slip_no" inputtype="button" style="left:120px; top:130px; width:121px; height:18px; "/>
			<button id="button10" class="btn_grid02" disabled="true" style="left:255px; top:130px; width:46px; height:17px; background-image:../../../images/btn_s_2.gif; ">
				<caption>...</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							model1.setValue("/root/reqData/fwdData/func_nm", "setSlipNo");
							model1.makeNode("/root/reqData/fwdData/inout_dt");
							model1.setValue("/root/reqData/fwdData/inout_dt" , model1.getValue("/root/resData/formData/ewh_dt"));
							
							
							window.load("MT_SUBMATRIN_1101.xrw"
								  , "modal"
					 		         , ""
					 			   , "left:100; top:100; width:650; height:520; align:center; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
					 			  , "/root/reqData/fwdData", "/root/reqData/fwdData");
					 		model1.destroy("/root/reqData/fwdData/inout_dt");
					 	     		 
					]]>
				</script>
			</button>
			<button id="button12" class="btn_grid02" disabled="true" style="left:660px; top:130px; width:46px; height:17px; background-image:../../../images/btn_s_2.gif; ">
				<caption>...</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							model1.setValue("/root/reqData/fwdData/func_nm", "setLs");
							
							window.load("MT_SUBMATRIN_1102.xrw"
					 	     		, "modal"
					 		        , ""
					 			    , "left:100; top:100; width:650; height:520; align:center; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
					 			  , "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
			</button>
			<input id="input7" ref="/root/resData/formData/ern" navindex="8" inputtype="button" maxlength="12" style="left:427px; top:30px; width:108px; height:18px; ">
				<script type="javascript" ev:event="onkeydown">
					<![CDATA[
						var keyCode = event.keycode;
						var dlco_gb = model.getValue("/root/resData/formData/dlco_clsf_cd");
						
						if ( keyCode == 9 || keyCode == 13 ){
							
							var dlco_cd =  input7.currentText;
							dlco_cd = dlco_cd.replace(/-/g, '').replace(/(\d{3})(\d{2})(\d{5})/g, '$1-$2-$3');
							///alert(dlco_cd);
							model.setValue("/root/reqData/searchData/ern", dlco_cd);
							//model.setValue("/root/reqData/searchData/ern", input7.currentText);
							
							//alert(dlco_gb);
							if (dlco_gb == "96"){
								model.send("mt_common_0003");								
							} else {
								model.send("mt_common_0002");
							}
							
							model.setValue("/root/resData/formData/ern",model.getValue("/root/tempData/ern"));
							model.setValue("/root/resData/formData/dlco_cd",model.getValue("/root/tempData/dlco_no"));
							model.setValue("/root/resData/formData/dlco_nm",model.getValue("/root/tempData/dlco_nm"));
							
							input7.refresh();
							input8.refresh();
							input1.refresh();
							input6.dispatch("xforms-next");
							//input7.dispatch("xforms-next");
						}
					]]>
				</script>
				<script type="javascript" ev:event="onkeyup">
					<![CDATA[
						var dlco_gb = model.getValue("/root/resData/formData/dlco_clsf_cd");
						
						var dlco_cd =  input7.currentText;
						dlco_cd = dlco_cd.TrimRight(); //공백제거
						dlco_cd = dlco_cd.replace(/-/g, '').replace(/(\d{3})(\d{2})(\d{5})/g, '$1-$2-$3');
						var dlco_cd_len =  dlco_cd.length;
						
						if (dlco_cd_len == 12){
							
							model.setValue("/root/reqData/searchData/ern", dlco_cd);
							
							if (dlco_gb == "96"){
								model.send("mt_common_0003");								
							} else {
								model.send("mt_common_0002");
							}
							
							model.setValue("/root/resData/formData/ern",model.getValue("/root/tempData/ern"));
							model.setValue("/root/resData/formData/dlco_cd",model.getValue("/root/tempData/dlco_no"));
							model.setValue("/root/resData/formData/dlco_nm",model.getValue("/root/tempData/dlco_nm"));
							
							input7.refresh();
							input8.refresh();
							input1.refresh();
							input6.dispatch("xforms-next");
							//input7.dispatch("xforms-next");
						}
					]]>
				</script>
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					var funcName = "setErn";
						
					model.setValue("/root/reqData/fwdData/func_nm", funcName );
					window.load(
						"/xrw/co/dlco/CO_DLCO_1100.xrw", 
						"modal", 
						"", 
						"left:30px; top:200px; width:640px; height:520; align:center; caption:hidden;"
						,"/root/reqData/fwdData"
						,"/root/reqData/fwdData"
					);
					
					]]>
				</script>
				<script type="javascript" ev:event="onmaxlength">
					<![CDATA[
					model.setValue("/root/reqData/searchData/ern", input7.currentText);
					model.send("mt_common_0002");
					
					model.setValue("/root/resData/formData/ern",model.getValue("/root/tempData/ern"));
					model.setValue("/root/resData/formData/dlco_cd",model.getValue("/root/tempData/dlco_no"));
					model.setValue("/root/resData/formData/dlco_nm",model.getValue("/root/tempData/dlco_nm"));
					
					input7.refresh();
					input8.refresh();
					input1.refresh();
					input6.dispatch("xforms-next");
					]]>
				</script>
			</input>
			<input id="input8" ref="/root/resData/formData/dlco_cd" style="left:545px; top:30px; width:73px; height:18px; "/>
			<input id="input1" ref="/root/resData/formData/dlco_nm" style="left:623px; top:30px; width:168px; height:18px; "/>
			<caption id="caption11" class="list_cap01" style="left:554px; top:76px; width:115px; height:26px; text-align:center; ">계산서구분</caption>
			<caption id="caption48" class="list_cap01" style="left:554px; top:101px; width:115px; height:26px; text-align:center; ">영수증구분</caption>
			<caption id="caption17" class="list_cap01" style="left:554px; top:51px; width:115px; height:26px; text-align:center; ">합계금액</caption>
			<input id="elec_tax_no1" ref="/root/reqData/semuro/elec_tax_no1" navindex="17" maxlength="8" style="left:157px; top:155px; width:68px; height:18px; text-align:right; "/>
			<input id="elec_tax_no2" ref="/root/reqData/semuro/elec_tax_no2" navindex="18" maxlength="8" style="left:230px; top:155px; width:68px; height:18px; text-align:right; "/>
			<input id="elec_tax_no3" ref="/root/reqData/semuro/elec_tax_no3" navindex="19" maxlength="8" style="left:305px; top:155px; width:68px; height:18px; text-align:right; "/>
			<caption id="caption68" class="list_cap01" style="left:0px; top:151px; width:154px; height:26px; text-align:center; ">전자세금계산서 승인번호</caption>
			<caption id="caption69" class="list_cap01" style="left:388px; top:151px; width:97px; height:26px; text-align:center; ">종이세금계산서</caption>
			<caption id="caption22" class="list_cap01" style="left:323px; top:126px; width:100px; height:26px; text-align:center; ">수입관리번호</caption>
			<input id="semuro_no" ref="/root/reqData/semuro/semuro_no" navindex="21" visibility="hidden" maxlength="35" style="left:695px; top:155px; width:205px; height:18px; text-align:left; "/>
			<caption id="caption5" class="list_cap01" style="left:545px; top:151px; width:121px; height:26px; text-align:center; ">스마트빌세금계산서</caption>
			<select id="semuro_yn" ref="/root/reqData/semuro/semuro_yn" disabled="true" navindex="20" overflow="visible" appearance="full" cellspacing="15" cols="2" style="left:671px; top:156px; width:17px; height:16px; border-style:none; ">
				<choices>
					<item>
						<label/>
						<value>Y</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						
						if (paper_yn.value == "Y") {
							elec_tax_no1.value = "";
							elec_tax_no2.value = "";
							elec_tax_no3.value = "";
						//	model.setValue("/root/resData/resform/semu_cmpy_cd", "");
						//	model.setValue("/root/resData/resform/semu_occr_dt", "");
						//	model.setValue("/root/resData/resform/semu_seq", "");
							//model.setValue("/root/resData/resform/semu_semuro_no", "");
							//model.setValue("/root/resData/resform/semu_send_pers_email", "");
							//semuro_yn.disabled = true;	
							elec_tax_no1.attribute("background-color") = "white";
							elec_tax_no2.attribute("background-color") = "white";
							elec_tax_no3.attribute("background-color") = "white";
							elec_tax_no1.disabled = true;
							elec_tax_no2.disabled = true;	
							elec_tax_no3.disabled = true;
							semuro_yn.value = "N";
							semuro_yn.disabled = true;
							semuro_no.value = "";
							
						}
						else {
							elec_tax_no1.disabled = false;
							elec_tax_no2.disabled = false;	
							elec_tax_no3.disabled = false;
							elec_tax_no1.attribute("background-color") = DEFAULT_COLOR_REQ;
							elec_tax_no2.attribute("background-color") = DEFAULT_COLOR_REQ;
							elec_tax_no3.attribute("background-color") = DEFAULT_COLOR_REQ;							
						}		
					]]>
				</script>
			</select>
			<select id="paper_yn" ref="/root/reqData/semuro/paper_yn" disabled="false" navindex="20" overflow="visible" appearance="full" cellspacing="15" cols="2" style="left:495px; top:155px; width:17px; height:16px; border-style:none; ">
				<choices>
					<item>
						<label/>
						<value>Y</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						
						if (paper_yn.value == "Y" || paper_yn.value == "N Y") {
							elec_tax_no1.value = "";
							elec_tax_no2.value = "";
							elec_tax_no3.value = "";
						//	model.setValue("/root/resData/resform/semu_cmpy_cd", "");
						//	model.setValue("/root/resData/resform/semu_occr_dt", "");
						//	model.setValue("/root/resData/resform/semu_seq", "");
							//model.setValue("/root/resData/resform/semu_semuro_no", "");
							//model.setValue("/root/resData/resform/semu_send_pers_email", "");
							semuro_yn.value      = "N";
							semuro_yn.disabled = true;
							semuro_no.value = "";
							elec_tax_no1.attribute("background-color") = "white";
							elec_tax_no2.attribute("background-color") = "white";
							elec_tax_no3.attribute("background-color") = "white";
							elec_tax_no1.disabled = true;
							elec_tax_no2.disabled = true;
							elec_tax_no3.disabled = true;
						}
						else {
							elec_tax_no1.disabled = false;
							elec_tax_no2.disabled = false;	
							elec_tax_no3.disabled = false;
							elec_tax_no1.value = "88888888";
							elec_tax_no2.value = "88888888";
							elec_tax_no3.value = "88888888";
							elec_tax_no1.attribute("background-color") = DEFAULT_COLOR_REQ;
							elec_tax_no2.attribute("background-color") = DEFAULT_COLOR_REQ;
							elec_tax_no3.attribute("background-color") = DEFAULT_COLOR_REQ;							
						}		
					]]>
				</script>
			</select>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" caption="SEQ^자재코드^품목명^입고수량^입고금액^부가세^입고단가^단위^입고예산^출고예산^매체^비고^출고여부^출고부서코드^출고부서명^출고일자^출고SEQ^출고번호^물품청구^매체코드체크필드^배부비코드^소모품여부^매체상세코드" colsep="#" colwidth="67, 76, 135, 84, 100, 100, 106, 59, 100, 100, 100, 200, 60, 100, 100, 100, 100, 100, 100, 100, 100, 0, 0" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:5px; top:420px; width:910px; height:160px; ">
			<col ref="sub_seq" type="output"/>
			<col class="req" ref="matr_cd" type="inputbutton" maxlength="7" caption="자재코드">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
			    		var funcName = "setMatrCd";
			    		
			    		var row = datagrid1.row;
			    		
			    		var matr_cd  = datagrid1.valueMatrix(row, 2);
			    		
			    		model1.setValue("/root/reqData/fwdData/matr_cd", matr_cd);
			    		
			    		model.setValue("/root/reqData/fwdData/func_nm", funcName );
			    		window.load("../common/MT_COMMON_MATR_0002.xrw"
			    			, "mdichild" 
			    			, ""
			    			, "left:100px; top:100px; width:450px; height:400; align:center; caption:hidden;"
			    			, "/root/reqData/fwdData"
			    			, "/root/reqData/fwdData");
						/*window.load("/xrw/mt/common/MT_COMMON_0000.xrw"
						                    ,"modal"
											, "mt_commatr_1100"
											, "align:center; width:420px;height:520px; sysmenu:visible; min:visible; max:true; resize:true"
											, "/root/reqData/fwdData"
											, "/root/reqData/fwdData");*/
					
					
					]]>
				</script>
			</col>
			<col ref="matr_nm" type="output"/>
			<col class="req" ref="ewh_qunt" type="input" format="(-)#,###" caption="입고 수량"/>
			<col class="req" ref="ewh_amt" type="input" format="(-)#,###" caption="입고 금액"/>
			<col ref="ewh_vat" type="input" format="(-)#,###"/>
			<col ref="ewh_uprc" type="input" format="(-)#,###"/>
			<col ref="ewh_unit" type="input"/>
			<col ref="ewh_budg_cd" type="output"/>
			<col ref="owh_budg_cd" type="inputbutton" style="left:847px; top:20px; width:100px; height:20px; "/>
			<col ref="medi_cd" type="combo" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/medi_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="remk" type="input" maxlength="30"/>
			<col checkvalue="Y,N" ref="owh_yn" type="checkbox"/>
			<col ref="usedeptcd" type="inputbutton" maxlength="6">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					var funcName = "setDept";
					model.setValue("/root/reqData/fwdData/func_nm", funcName );
					model.setValue("/root/reqData/fwdData/func_type", "1");
					window.load("../../hd/com/HD_COM_1100.xrw"
						, "mdichild"
						, "" 
						, "left:100px; top:100px; width:650px; height:520px; align:center; caption:hidden;"
						, "/root/reqData/fwdData"
						, "/root/reqData/fwdData"
					);
					]]>
				</script>
			</col>
			<col ref="usedeptnm" type="output"/>
			<col ref="owh_dt" type="output"/>
			<col ref="owh_seq" visibilty="hidden"/>
			<col ref="owh_no" type="output"/>
			<col ref="clam_yn" type="inputbutton">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					var funcName = "setItemclam";
					var row = datagrid1.row;
					var matr_cd  	= datagrid1.valueMatrix(row, datagrid1.colRef("matr_cd"));
					var sub_seq	= datagrid1.valueMatrix(row, datagrid1.colRef("sub_seq"));
					
					if (matr_cd == ""){
						alert("물품청구 연계할 자재코드를 먼저 선택해주십시오.");
						return;
					}
					model1.setValue("/root/reqData/fwdData/matr_cd", matr_cd);
					
					if (sub_seq == ""){
						model.setValue("/root/reqData/fwdData/func_nm", "setItemclam");
						model.setValue("/root/reqData/fwdData/func_flag", "1" );
					} else {
						model.setValue("/root/reqData/fwdData/func_nm", "setItemclam2");
						model.setValue("/root/reqData/fwdData/ewh_occr_dt", model.getValue("/root/reqData/searchDoc/occr_dt") );
						model.setValue("/root/reqData/fwdData/ewh_seq", model.getValue("/root/reqData/searchDoc/seq") );
						model.setValue("/root/reqData/fwdData/func_flag", "2" );
					}
					
				
					window.load("../common/MT_COMMON_0003.xrw"
			  	  			, "mdichild" 
			   	 			, ""
			    				, "left:100px; top:100px; width:700px; height:500px; align:center; caption:hidden;"
			    				, "/root/reqData/fwdData"
			    				, "/root/reqData/fwdData");
					]]>
				</script>
			</col>
			<col ref="mc_falg" visibilty="hidden"/>
			<col ref="dstb_rat_cd" type="output"/>
			<col ref="bo_item_yn" visibilty="hidden"/>
			<col ref="medi_ser_no" visibilty="hidden"/>
			<script type="javascript" ev:event="onendedit">
				<![CDATA[
					var cell = datagrid1.selectedCells;
					var codeVal;
					if(cell.length < 1){
						alert("select a Cell");
						return;
					}
					
					var col = cell.item(0).col;
					var row = cell.item(0).row;
					
					var selectValue = datagrid1.valueMatrix(row, col);
					if (selectValue.indexOf(' ') > -1){
							codeVal = selectValue.substring(0, selectValue.indexOf(' '));
					} else {
							codeVal = selectValue;
					}
					
					switch (col){
						case  2 :
								var fac_clsf =  model1.getValue("/root/resData/formData/fac_clsf");
								var matr_cd = datagrid1.valueMatrix(row,2);
//								if( datagrid1.valueMatrix(row,col).length == 7 ) {
//									valueSet(codeVal , row);
//									datagrid1.addStatus(row, "insert");
//								}
								
								if(matr_cd=='5601000'){
									setOwhDept();
								}
								//공장에 따라 자재코드 확인															
								if(fac_clsf == "10" || fac_clsf == "25")
								{
									
									if(matr_cd == "2703105" || matr_cd == "2109500" || matr_cd == "2109600" || matr_cd == "2109700" || matr_cd == "2109800" || matr_cd == "2109900")
									{
										alert("해당공장 자재코드가 아닙니다. 자재코드 확인요망.");
										datagrid1.valueMatrix(row,2) ="";
									}
									else
									{	
										if( datagrid1.valueMatrix(row,col).length == 7 ) {
											valueSet(codeVal , row);
											datagrid1.addStatus(row, "insert");
										}
									}
								}
								else if(fac_clsf == "22")
								{
									if(matr_cd == "2703107" || matr_cd == "2104104" || matr_cd == "2109100" || matr_cd == "2109203" || matr_cd == "2109306" || matr_cd == "2109402")
									{
										alert("해당공장 자재코드가 아닙니다. 자재코드 확인요망.");
										datagrid1.valueMatrix(row,2) ="";
									}
									else
									{	
										if( datagrid1.valueMatrix(row,col).length == 7 ) {
											valueSet(codeVal , row);
											datagrid1.addStatus(row, "insert");
										}
									}
								}								
								break;
						case  4 :
								/*  입고 수량 / 단가에 따른 입고금액 계산 */
								var    l_ewh_qunt =  datagrid1.valueMatrix(row, 4);     // 입고 수량
								var    l_ewh_uprc =  datagrid1.valueMatrix(row, 7);     // 입고 금액
								var    l_ewh_amt = l_ewh_qunt * l_ewh_uprc;
								l_ewh_vat   =  Math.floor(Number(l_ewh_amt) * 0.1);      // 부가세
								
								datagrid1.valueMatrix(row, 5) = l_ewh_amt;
								datagrid1.valueMatrix(row, 6) = l_ewh_vat;
								
//								var suply_amt=0;
//								var vat_amt=0;
//								for(var i=1; i<datagrid1.rows + 1;i++){
//									
//									suply_amt = suply_amt + Number(datagrid1.valueMatrix(i, 5));
//									vat_amt = vat_amt + Number(datagrid1.valueMatrix(i, 6));
//								}
//								model1.setValue("/root/resData/formData/suply_amt",suply_amt);
//								model1.setValue("/root/resData/formData/vat_amt",vat_amt);
//								model1.setValue("/root/resData/formData/sum_amt",suply_amt+vat_amt);
								model1.refresh();
								break;
						case  5 :
								/*  입고 수량 / 입고 금액 / 부가세 예 따른 입고 단가 계산 */
								var    l_ewh_qunt =  datagrid1.valueMatrix(row, 4);     // 입고 수량
								var    l_ewh_amt  =  datagrid1.valueMatrix(row,5);     // 입고 금액
								var    l_ewh_vat   = 0;
								var    l_ewh_uprc = 0; 
						        var matr_cd = datagrid1.valueMatrix(row,2);
								
						               if ( l_ewh_qunt == '' || l_ewh_amt == '' ) break;
						              
						              
								l_ewh_vat   =  Math.floor(Number(l_ewh_amt) * 0.1);      // 부가세
								if ( Number(l_ewh_qunt) > 0 ) {
									l_ewh_uprc = Math.round(Number(l_ewh_amt) / Number(l_ewh_qunt)) ;

								// if( col == 5 ) {
										// 당월 최근 등록 단가 //
										model1.makeNode("/root/reqData/searchDan" );
										model1.makeNode("/root/reqData/searchDan/ewh_dt");
										model1.makeNode("/root/reqData/searchDan/fac_clsf");
										model1.makeNode("/root/reqData/searchDan/matr_cd");
						                      	                      
										model1.setValue("/root/reqData/searchDan/ewh_dt",  model1.getValue("/root/resData/formData/ewh_dt"));
										model1.setValue("/root/reqData/searchDan/fac_clsf", model1.getValue("/root/resData/formData/fac_clsf"));
										model1.setValue("/root/reqData/searchDan/matr_cd", datagrid1.valueMatrix(row, 2));
						                      	                      
										model1.send("mt_submatrin_1105");
										model1.destroy("/root/reqData/searchDan");
						                      	                      
										if( Number( model1.getValue("root/tempData/totalcnt") ) > 0 )  {
											var ewh_uprc = model1.getValue("/root/tempData/ewh_uprc");
											
											if(matr_cd !='5601000'){ //인쇄장비유지부품은 메세지 X
												if( Number(l_ewh_uprc) != Number(ewh_uprc) ){
													alert( " 당월 최근등록 < " + model1.getValue("root/tempData/ewh_dt") + " > 단가가 < " + ewh_uprc +  " 원> 입니다,확인바랍니다");
												}
											}
											
										}
								//	}
								}
								datagrid1.valueMatrix(row, 4) = l_ewh_qunt;
								datagrid1.valueMatrix(row, 5) = l_ewh_amt;
								datagrid1.valueMatrix(row, 6) = l_ewh_vat;
								datagrid1.valueMatrix(row, 7) = l_ewh_uprc;
								break;
						      case 14:
								model1.setValue("/root/reqData/searchData/dept_cd", datagrid1.valueMatrix(row, 14) );
								model1.send("mt_common_0001");
								datagrid1.valueMatrix(row,14 ) =  model1.getValue("/root/tempData/cd");
								datagrid1.valueMatrix(row,15 ) =  model1.getValue("/root/tempData/cd_nm");
								
								if( model1.getValue("/root/tempData/cd") != '' ) {
									datagrid1.valueMatrix(row,13 ) = 'Y';
								}
								else {
									datagrid1.valueMatrix(row,13 ) = 'N';
								}
								break;
					}
					var keyCode = event.keycode;
						
					if (keyCode == 13 ){
						datagrid1.select(row + 1, col) = true;
						datagrid1.row = row + 1;
					}
					
				]]>
			</script>
		</datagrid>
		<group id="group2" style="left:5px; top:10px; width:910px; height:25px; ">
			<button id="button1" class="btn02" CRUD="R" style="left:493px; top:0px; width:52px; height:21px; ">
				<caption>조 회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					           head_search();
					]]>
				</script>
			</button>
			<button id="button3" class="btn02" style="left:546px; top:0px; width:52px; height:21px; ">
				<caption>삭 제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						   if( model1.getValue("/root/reqData/searchDoc/cmpy_cd") == ''){
						   	 alert("삭제 할 데이터를 선택해주세요");
						         return;	 
						   }
						   
						   if( window.alert("[자료 삭제 경고]삭제 하시겠습니까?" , "조선일보 MIS", 1) != 1){
						   	return ;
						   }
						  
						  //삭제 작업
						   model1.send("mt_submatrin_1110");
						   if(submit_completed()) {
								button1.dispatch("onclick");
						   }
						   
					]]>
				</script>
			</button>
			<button id="button4" class="btn02" style="left:601px; top:0px; width:52px; height:21px; ">
				<caption>인 쇄</caption>
			</button>
			<button id="button5" class="btn02" style="left:440px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							model1.reset();
							InitPage();
					]]>
				</script>
			</button>
			<button id="button6" class="btn02" style="left:656px; top:0px; width:52px; height:21px; ">
				<caption>마감</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var ewh_dt_fr =  model1.getValue("/root/reqData/searchData/ewh_dt_fr");
						var ewh_dt_to =  model1.getValue("/root/reqData/searchData/ewh_dt_to");
						var mamgam_dt = model1.getValue("/root/reqData/searchData/magam_dt");
						
						if( ewh_dt_fr != ewh_dt_to){
							alert( "마감시 입고일자 FROM 과 입고 일자 TO 가 같아야 합니다.");
							return;
						}
						
						if( mamgam_dt == '' ){
							alert("마감 처리 일자를 선택해주세요");
							return;
						}
						
						if( window.alert("입고일자 (" + ewh_dt_fr + ") 내역을 마감 처리 하시겠습니까? \n(마감일자 : " +  mamgam_dt  + ")", "조선일보 MIS" , 1 ) != 1){
							return;
						}
						
						model1.send("mt_submatrin_1116");
						  if(submit_completed()) {
								button1.dispatch("onclick");
						   }
						
					]]>
				</script>
			</button>
			<button id="button7" class="btn03" style="left:711px; top:0px; width:65px; height:21px; ">
				<caption>마감취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					    var ewh_dt_fr =  model1.getValue("/root/reqData/searchData/ewh_dt_fr");
						var ewh_dt_to =  model1.getValue("/root/reqData/searchData/ewh_dt_to");
						var mamgam_dt = model1.getValue("/root/reqData/searchData/magam_dt");
						
						if( ewh_dt_fr != ewh_dt_to){
							alert( "마감취소 시 입고일자 FROM 과 입고 일자 TO 가 같아야 합니다.");
							return;
						}
						
						if( mamgam_dt == '' ){
							alert("마감 처리 일자를 선택해주세요");
							return;
						}
						
						if( window.alert("입고일자 (" + ewh_dt_fr + ") 내역을 마감 취소 처리 하시겠습니까? \n(마감일자 : " +  mamgam_dt  + ")", "조선일보 MIS" , 1 ) != 1){
							return;
						}
						
						model1.send("mt_submatrin_1119");
						  if(submit_completed()) {
								button1.dispatch("onclick");
						   }
					]]>
				</script>
			</button>
			<button id="button8" class="btn04" style="left:779px; top:0px; width:75px; height:21px; ">
				<caption>스마트빌연계</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					   if( (model1.getValue("/root/reqData/searchDoc/cmpy_cd") != '' ) && (model1.getValue("/root/reqData/searchDoc/occr_dt") != '' ) && (model1.getValue("/root/reqData/searchDoc/seq") != '' ) ) {
					   	alert("신규 입력은 초기화 후 진행해 주세요");
					   	return;
					   }
						/*
					    var funcName = "sumuPk";
					  
					    model1.setValue("/root/reqData/fwdData/func_nm", funcName );
					    
					    window.load("/xrw/co/semuro/CO_SEMURO_1000.xrw"
					 	     		, "modal"
					 		        , ""
					 			    , "left:100; top:100; width:650; height:520; sysmenu:visible; min:visible; max:true; resize:true; caption:visible;"
					 			  , "/root/reqData/fwdData/func_nm","/root/reqData/fwdData/func_nm");
				         */
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setSemuro");
//						window.load("/xrw/co/semuro/CO_SEMURO_1000.xrw","modal", "co_semuro_1400", "align:center; width:645; height:475; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
						window.load("/xrw/co/smtb/CO_SMTB_1100.xrw"
						                    ,"modal"
											, "co_smtb_1100"
											, "align:center; width:645; height:475; caption:hidden;"
											, "/root/reqData/fwdData", "/root/reqData/fwdData");	  
					]]>
				</script>
			</button>
			<button id="button13" class="btn02" style="left:858px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					]]>
				</script>
				<caption/>
			</button>
			<!--
			<caption id="caption4" style="left:20px; top:-2px; width:170px; height:22px; ">134-82-61854</caption>
			-->
		</group>
		<button id="button9" class="btn_grid03" style="left:800px; top:400px; width:55px; height:17px; background-image:../../../images/btn_s_3.gif; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					    var fac_clsf = model1.getValue("/root/resData/formData/fac_clsf");
					    var ewh_dt  = model1.getValue("/root/resData/formData/ewh_dt");
					  
					    if( ( model1.getValue("/root/reqData/searchDoc/cmpy_cd") != '' ) && ( model1.getValue("/root/reqData/searchDoc/occr_dt") != '' ) && ( model1.getValue("/root/reqData/searchDoc/seq") != '' ) ) {
							if( model1.getValue("/root/reqData/searchDoc/clos_clsf") == 'Y'){
								alert("마감 처리 된 자료는 수정 하실 수 없습니다 .");
								return;
							}
					    }
						
					    if( fac_clsf == '' )
					    {
					  	  alert("입고 공장을 먼저 선택 해주세요");
					  	  return;
					    }
					    if( ewh_dt == '' )
					    {
					  	  alert("입고 일자를 먼저 선택 해주세요");
					  	  return;
					    }
					  
					    var matrVar = model1.getValue("/root/resData/gridData/record[1]/matr_cd");						
					    if(matrVar == '') {
					   	  datagrid1.isReadOnly(1, 1, 1, datagrid1.cols - 1)  =false;
						  datagrid1.addStatus(1, "insert");
					    }else{				
						  datagrid1.addRow(true, true);
					    }		
				]]>
			</script>
		</button>
		<button id="button11" class="btn_grid03" style="left:860px; top:400px; width:55px; height:17px; background-image:../../../images/btn_s_3.gif; ">
			<caption>행삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						var cell = datagrid1.selectedCells;
						if(cell.length < 1){
							alert("select a Cell");
							return;
						}
						//마감 여부 확인 
						if( ( model1.getValue("/root/reqData/searchDoc/cmpy_cd") != '' ) && ( model1.getValue("/root/reqData/searchDoc/occr_dt") != '' ) && ( model1.getValue("/root/reqData/searchDoc/seq") != '' ) ) {
							 
							if( model1.getValue("/root/reqData/searchDoc/clos_clsf") == 'Y'){
								alert("마감 처리 된 자료는 수정 하실 수 없습니다 .");
								return;
							}
						}
						
						var col = cell.item(0).col;
					        var row = cell.item(0).row;
					       
					       if( datagrid1.valueMatrix(row, 1) == ''){
					        					datagrid1.deleteItem(row);  
					       } else {
					       						datagrid1.rowStatus(row) = 4;  
					       }
				]]>
			</script>
		</button>
		<group id="group3" style="left:4px; top:40px; width:911px; height:29px; ">
			<caption id="caption24" class="list_cap01" style="left:0px; top:2px; width:100px; height:26px; text-align:center; ">입고일자</caption>
			<caption id="caption25" class="list_cap02" style="left:99px; top:2px; width:812px; height:26px; text-align:center; "/>
			<input id="input5" ref="/root/reqData/searchData/ewh_dt_fr" class="req" navindex="1" inputtype="date" style="left:107px; top:6px; width:100px; height:18px; "/>
			<input id="input10" ref="/root/reqData/searchData/ewh_dt_to" class="req" navindex="2" inputtype="date" style="left:229px; top:6px; width:100px; height:18px; "/>
			<caption id="caption26" class="list_cap01" style="left:335px; top:2px; width:115px; height:26px; text-align:center; ">공장</caption>
			<caption id="caption10" style="left:210px; top:10px; width:15px; height:10px; ">~</caption>
			<select1 id="combo7" ref="/root/reqData/searchData/fac_clsf" class="req" navindex="3" appearance="minimal" style="left:455px; top:6px; width:105px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fact_cd/item">
						<value ref="value"/>
						<label ref="label"/>
					</itemset>
				</choices>
			</select1>
			<caption id="caption1" class="list_cap01" style="left:588px; top:2px; width:115px; height:26px; text-align:center; ">마감일자</caption>
			<input id="input2" ref="/root/reqData/searchData/magam_dt" class="req" navindex="4" inputtype="date" caption="마감일자" style="left:710px; top:5px; width:100px; height:18px; "/>
		</group>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData_Main/record" caption="cmpy_cd^occr_dt^seq^입고일자^입고번호^공장구분^품목^사업자명칭^계산서일자^총합계금액^마감일자(마감여부)" colsep="^" colwidth="0, 0, 0, 93, 100, 99, 261, 107, 81, 105, 131" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:4px; top:72px; width:911px; height:119px; ">
			<col ref="cmpy_cd" type="hidden"/>
			<col ref="occr_dt" type="hidden"/>
			<col ref="seq" type="hidden"/>
			<col ref="ewh_dt" format="yyyy-mm-dd"/>
			<col ref="ewh_no"/>
			<col ref="fac_clsf_nm"/>
			<col ref="ewh_title"/>
			<col ref="dlco_nm"/>
			<col ref="make_dt" format="yyyy-mm-dd"/>
			<col ref="amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="clos_proc_dt"/>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
						var row = datagrid2.row;
						if( row < 1 ) return;
						
						if( datagrid2.valueMatrix(row, 1 ) == '') return;
						 
						if ((datagrid2.mouseCol > 0) && (datagrid2.mouseCol < datagrid2.cols) && (datagrid2.mouseRow >= datagrid2.fixedRows))  {
						   	detail_search(datagrid2.valueMatrix(row , 1), datagrid2.valueMatrix(row , 2), datagrid2.valueMatrix(row , 3) );
						}
				]]>
			</script>
		</datagrid>
		<button id="button2" class="btn02" CRUD="CU" style="left:740px; top:395px; width:52px; height:21px; ">
			<caption>입 력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var cnt = 0; 
					var deleteflag = false;
					var RowCnt	= datagrid1.rows;
					
					if( model1.getValue("/root/reqData/searchDoc/clos_clsf") == 'Y' ){
						alert("마감된 데이터입니다");
						return;
					}
					
					// 그리드 전체 데이터 삭제 인지 여부 확인 
					if( (model1.getValue("/root/reqData/searchDoc/cmpy_cd") != '' ) && (model1.getValue("/root/reqData/searchDoc/occr_dt") != '' ) && (model1.getValue("/root/reqData/searchDoc/seq") != '' ) ) {
						for (var i = 1; i < datagrid1.rows; i++){
							if ( datagrid1.rowStatus(i)  == 4){
								cnt = cnt + 1;
							}
						}
								
						if( cnt == datagrid1.rows - 1 ) {
							if( window.alert("전체 데이터를 삭제 하시겠습니까?",  "조선일보 MIS" , 1) != 1){
								return;
							}
							button3.dispatch("onclick");
							return;
									
						} else if (cnt < datagrid1.rows -1 ) {
							deleteflag = true;
						}
					} else {
								/*
								if( datagrid1.rows == 2 ) {
									if( datagrid1.valueMatrix(1, 2 ) == '' ){
										alert("입력할 데이터가 없습니다.");
										return ;
									}
								}
								*/
					}
					
					if(!commGridReqCheck("datagrid1"))  return;
					 		
					if( (model1.getValue("/root/reqData/searchDoc/cmpy_cd") != '' ) && (model1.getValue("/root/reqData/searchDoc/occr_dt") != '' ) && (model1.getValue("/root/reqData/searchDoc/seq") != '' ) ) {
						if( window.alert("이미 입력 된 데이터 입니다. 삭제 후 다시 입력 하시겠습니까?", "확인", 1) != 1){
							if( window.alert("수정된 데이터를 추가 입력하시겠습니까?","확인", 1) != 1){
							          return;
							} 
							else {
								 deleteflag = false;
							}
						}
					}else {
						if( window.alert("입고 내역을 입력하시겠습니까?", "확인", 1) != 1){
						      return;
						}
					}
					cnt = 0;
					//입력 상태로 변경
					for (var i = (RowCnt -1); i >  0; i--){
						//alert(datagrid1.rowStatus(i));
						if ( datagrid1.rowStatus(i)  != 4 ){
							if (datagrid1.valueMatrix(i, datagrid1.colRef("matr_cd")) == ""){
								datagrid1.deleteRow(i);
							} else {
								//alert(datagrid1.valueMatrix(i, datagrid1.colRef("owh_yn")));
								if (datagrid1.valueMatrix(i, datagrid1.colRef("owh_yn")) == "Y" && datagrid1.valueMatrix(i, datagrid1.colRef("usedeptcd")) == "" && datagrid1.valueMatrix(i, datagrid1.colRef("usedeptnm")) == "" ){
									alert("출고여부를 체크한 경우에는 반드시 사용부서코드를 입력해주십시오.");
									return;
								}
								if (datagrid1.valueMatrix(i, datagrid1.colRef("usedeptcd")) != "" && datagrid1.valueMatrix(i, datagrid1.colRef("usedeptnm")) == "" && datagrid1.valueMatrix(i, datagrid1.colRef("owh_yn")) == ""){
									alert("사용부서의 입력은 반드시 출고여부를 체크해야만 합니다.");
									return;
								}
								if( (model1.getValue("/root/reqData/searchDoc/cmpy_cd") != '' ) && (model1.getValue("/root/reqData/searchDoc/occr_dt") != '' ) && (model1.getValue("/root/reqData/searchDoc/seq") != '' ) ) {
									datagrid1.rowStatus(i) = 3;
								}
								cnt = cnt + 1;
							}
						} else if ( datagrid1.rowStatus(i)  == 4){
							datagrid1.deleteRow(i);                                                                            // 전체 삭제 후 수정 데이터 입력 삭제는 입력 안함
						}
					}
					/*
					for (var i = 1; i < RowCnt; i++){
						alert(datagrid1.rowStatus(i));
						if (   datagrid1.rowStatus(i)  != 4 ){
							
							if (datagrid1.valueMatrix(i, datagrid1.colRef("matr_cd")) == ""){
								datagrid1.deleteRow(i);
								cnt = cnt + 1;
							}
						} else if ( datagrid1.rowStatus(i)  == 4){
							datagrid1.deleteRow(i);                                                                                       // 전체 삭제 후 수정 데이터 입력 삭제는 입력 안함
						}
					}
					*/
							
					datagrid1.refresh();
					 	
					if ( cnt  == 0 ) {
						alert("입력할 데이터가 없습니다.");
						return;
					}
							
					if( inputDataChk() == false ) return ;
						var mulidataStr = datagrid1.getUpdateData();
						model1.makeNode("/root/resData/formData/multiUpdateData");
						model1.setValue("/root/resData/formData/multiUpdateData" ,  mulidataStr);
						model1.makeNode("/root/resData/formData/multiUpdateData1");
						model1.setValue("/root/resData/formData/multiUpdateData1" ,  datagrid3.getUpdateData());
						
						if( deleteflag == true){
							model1.makeNode("/root/resData/formData/cmpy_cd");
							model1.makeNode("/root/resData/formData/occr_dt");
							model1.makeNode("/root/resData/formData/seq");
						
							model1.setValue("/root/resData/formData/cmpy_cd", model1.getValue("/root/reqData/searchDoc/cmpy_cd"));
							model1.setValue("/root/resData/formData/occr_dt", model1.getValue("/root/reqData/searchDoc/occr_dt"));
							model1.setValue("/root/resData/formData/seq", model1.getValue("/root/reqData/searchDoc/seq"));
						       		
						}
						       
						model1.send("mt_submatrin_1106");
						
						if( deleteflag == true){
							model1.destroy("/root/resData/formData/cmpy_cd");
							model1.destroy("/root/resData/formData/occr_dt");
							model1.destroy("/root/resData/formData/seq");
						}
						model1.destroy("/root/resData/formData/multiUpdateData");
						
						if(submit_completed()) {
							model.setValue("/root/reqData/searchData/ewh_dt_fr", model.getValue("/root/resData/formData/ewh_dt"));
							model.setValue("/root/reqData/searchData/ewh_dt_to", model.getValue("/root/resData/formData/ewh_dt"));
							model.setValue("/root/reqData/searchData/fac_clsf", model.getValue("/root/resData/formData/fac_clsf"));
							button1.dispatch("onclick");
						}
					]]>
			</script>
		</button>
		<datagrid id="datagrid3" nodeset="/root/resData/gridRef/record" visibility="hidden" caption="clam_dt^clam_seq^clam_sub_seq^matr_cd" colsep="#" colwidth="100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowsep="|" style="left:540px; top:480px; width:350px; height:100px; ">
			<col ref="clam_dt"/>
			<col ref="clam_seq"/>
			<col ref="clam_sub_seq"/>
			<col ref="clam_matr"/>
		</datagrid>
		<button id="button14" class="btn_grid06" style="left:169px; top:401px; width:86px; height:17px; background-image:../../../images/btn_s_6.gif; ">
			<caption>자재정보입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					
					
					for (var i = 1; i < datagrid1.rows + 1; i++)
					{
						
						selectValue = datagrid1.valueMatrix(i, 2);
						if(selectValue.length > 0){
							
							if (selectValue.indexOf(' ') > -1){
									codeVal = selectValue.substring(0, selectValue.indexOf(' '));
							} else {
									codeVal = selectValue;
							}
							valueSet(codeVal , i);
							datagrid1.addStatus(i, "insert");
						}
						
					}
					

					    		
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
