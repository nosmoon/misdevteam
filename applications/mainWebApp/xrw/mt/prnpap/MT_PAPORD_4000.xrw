<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<pageInfo>
							<pageID/>
						</pageInfo>
						<session>
						</session>
						<comboSet>
							<fac_clsf>
								<item>
									<value/>
									<label/>
								</item>
							</fac_clsf>
							<medi_cd>
								<item>
									<value/>
									<label/>
								</item>
							</medi_cd>
							<sect_cd>
								<item>
									<value/>
									<label/>
								</item>
							</sect_cd>
							<sect_cd_2>
								<item/>
							</sect_cd_2>
							<pap_clsf_a>
								<item/>
							</pap_clsf_a>
							<pap_clsf_b>
								<item/>
							</pap_clsf_b>
							<pap_clsf_c>
								<item/>
							</pap_clsf_c>
							<dual_out_clsf>
								<item/>
							</dual_out_clsf>
						</comboSet>
					</initData>
					<reqData>
						<searchData>
							<issu_dt_s/>
							<fac_clsf_s/>
						</searchData>
						<searchData2>
							<issu_dt_s/>
							<fac_clsf_s/>
							<medi_cd_s/>
							<sect_cd_s/>
						</searchData2>
						<multiUpData/>
						<fwdData>
							<func_nm/>
						</fwdData>
						<searchData3>
							<issu_fr/>
							<issu_to/>
							<fac_clsf/>
						</searchData3>
					</reqData>
					<resData>
						<gridData>
							<record>
								<issu_dt/>
								<fac_clsf/>
								<medi_cd/>
								<sect_cd/>
								<issu_pcnt/>
								<issu_qty/>
								<dual_out_clsf_nm/>
								<check/>
								<roll_wgt_a/>
								<wgt_a/>
								<roll_cnt_a/>
								<roll_wgt_b/>
								<wgt_b/>
								<roll_cnt_b/>
								<roll_wgt_c/>
								<wgt_c/>
								<roll_cnt_c/>
								<rowCnt/>
								<matr_cd_a/>
								<matr_cd_b/>
								<matr_cd_c/>
								<dual_out_clsf/>
								<paper_std_cd/>
							</record>
						</gridData>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					funComboSet();
					//datagrid1.isReadOnly(2, 1, 2, 18)  = true;		//첫번째 행 readonly
				]]>
			</script>
			<submission id="mt_papord_4000_m" action="/mt/papord/4000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="mt_papord_4001_m" action="/mt/papord/4001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/mang_cd_3" resultref="/root/tempData"/>
			<submission id="mt_papord_4002_m" action="/mt/papord/4002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fac_clsf" resultref="/root/tempData"/>
			<submission id="mt_papord_4003_l" action="/mt/papord/4003" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData2" resultref="/root/tempData"/>
			<submission id="mt_papord_4004_a" action="/mt/papord/4004" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpData" resultref="/root/tempData"/>
			<submission id="mt_papord_4005_l" action="/mt/papord/4005" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papord_4006_l" action="/mt/papord/4006" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData3" resultref="/root/tempData"/>
		</model>
		<script type="javascript">
			<![CDATA[
				//공장, 매체, 섹션, 자재 콤보 조회
				function funComboSet() {
					model1.send("mt_papord_4000_m");
					model1.copyNode("/root/initData/comboSet/fac_clsf","/root/tempData/fac_clsf");
					model1.copyNode("/root/initData/comboSet/medi_cd","/root/tempData/medi_cd");
					model1.copyNode("/root/initData/comboSet/sect_cd","/root/tempData/sect_cd");
					model1.copyNode("/root/initData/comboSet/sect_cd_2","/root/tempData/sect_cd_2");
					model1.copyNode("/root/initData/comboSet/dual_out_clsf","/root/tempData/dual_out_clsf");
					combo1.refresh();
				}
				
				//매체 선택시 섹션콤보
				function funSectCd(sValue) {
					//model1.makeNode("/root/reqData/mang_cd_3");
					//model1.setValue("/root/reqData/mang_cd_3",sValue);
					//model1.send("mt_papord_4001_m");
					//model1.copyNode("/root/initData/comboSet/sect_cd","/root/tempData/sect_cd");
					
					
					
					var gridID = datagrid1;
					var nodeSet =  "/root/resData/gridData/record";
					var nodeName = "medi_cd";
					var comboNodeSet_1 = "/root/initData/comboSet/sect_cd";
					var comboNodeSet_2 = "/root/initData/comboSet/sect_cd_2";
					var nodeSetName = "item";
					var srcColIdx = 3;
					var targetColIdx = 4;
					
					if ( gridID.col == srcColIdx && gridID.row >= gridID.fixedRows ){
						var row = gridID.row - gridID.fixedRows+1;
						var idx = model.getValue(nodeSet+"["+row+"]/"+nodeName);

						//alert(idx);
						if ( idx == "610" )	{//첫번째 콤보에 선택한 아이템이 있을 때만 두번째 콤보 데이터 필터링
							gridID.cellComboNodeset(datagrid1.row, targetColIdx) =  comboNodeSet_2 + "/"+nodeSetName;
						} else {
							gridID.cellComboNodeset(datagrid1.row, targetColIdx) =  comboNodeSet_1 + "/"+nodeSetName;
						}
					}
				
				}
				
				//중량/1롤콤보
				function funRollWgt(iSelectedRow, sValue) {
					
					model1.makeNode("/root/reqData/fac_clsf");
					model1.setValue("/root/reqData/fac_clsf",sValue);
					model1.send("mt_papord_4002_m");
					
					//nodeSet Make
					model1.makeNode("/root/initData/comboSet/roll_wgt_a["+iSelectedRow+"]");
					model1.makeNode("/root/initData/comboSet/roll_wgt_b["+iSelectedRow+"]");
					model1.makeNode("/root/initData/comboSet/roll_wgt_c["+iSelectedRow+"]");
					//생성된 node에 데이터 copy
					model1.copyNode("/root/initData/comboSet/roll_wgt_a["+iSelectedRow+"]","/root/tempData/roll_wgt_a");
					model1.copyNode("/root/initData/comboSet/roll_wgt_b["+iSelectedRow+"]","/root/tempData/roll_wgt_b");
					model1.copyNode("/root/initData/comboSet/roll_wgt_c["+iSelectedRow+"]","/root/tempData/roll_wgt_c");
					
					//nodeSet Make
					model1.makeNode("/root/initData/comboSet/matr_cd_a["+iSelectedRow+"]");
					model1.makeNode("/root/initData/comboSet/matr_cd_b["+iSelectedRow+"]");
					model1.makeNode("/root/initData/comboSet/matr_cd_c["+iSelectedRow+"]");
					//생성된 node에 데이터 copy
					model1.copyNode("/root/initData/comboSet/matr_cd_a["+iSelectedRow+"]","/root/tempData/matr_cd_a");
					model1.copyNode("/root/initData/comboSet/matr_cd_b["+iSelectedRow+"]","/root/tempData/matr_cd_b");
					model1.copyNode("/root/initData/comboSet/matr_cd_c["+iSelectedRow+"]","/root/tempData/matr_cd_c");
					
					//해당 그리드에 nodeSet 지정
					datagrid1.cellComboNodeset(iSelectedRow, 9) = "/root/initData/comboSet/roll_wgt_a["+iSelectedRow+"]/item";
					datagrid1.cellComboNodeset(iSelectedRow, 12) = "/root/initData/comboSet/roll_wgt_b["+iSelectedRow+"]/item";
					datagrid1.cellComboNodeset(iSelectedRow, 15) = "/root/initData/comboSet/roll_wgt_c["+iSelectedRow+"]/item";
					datagrid1.cellComboNodeset(iSelectedRow, 19) = "/root/initData/comboSet/matr_cd_a["+iSelectedRow+"]/item";
					datagrid1.cellComboNodeset(iSelectedRow, 20) = "/root/initData/comboSet/matr_cd_b["+iSelectedRow+"]/item";
					datagrid1.cellComboNodeset(iSelectedRow, 21) = "/root/initData/comboSet/matr_cd_c["+iSelectedRow+"]/item";
					
				}
				
				//발행면수 입력시 A,B,C 판별
				function funPaperStd(iSelectedRow) {
					
					var sPcnt     = "";
					var sQunt     = "";
					var sPaperStd = "";
					var sFirRollValue = "";
					var sFirMatrValue = "";
					
					var ins = document.models(0).instances(0);
					var node_roll_a = ins.selectSingleNode("/root/initData/comboSet/roll_wgt_a["+iSelectedRow+"]/item");	//xpath 에 해당하는 node 를 반환한다.
					var node_roll_b = ins.selectSingleNode("/root/initData/comboSet/roll_wgt_b["+iSelectedRow+"]/item");	//xpath 에 해당하는 node 를 반환한다.
					var node_roll_c = ins.selectSingleNode("/root/initData/comboSet/roll_wgt_c["+iSelectedRow+"]/item");	//xpath 에 해당하는 node 를 반환한다.

					
					sPcnt = datagrid1.valueMatrix(iSelectedRow,5);		//발행면수
					sQunt = datagrid1.valueMatrix(iSelectedRow,22);		//양출여부
					
					if(sPcnt != "") {
						if(sQunt == "Y") {
							if(((sPcnt * 2) % 8) == 0) {
								//A
								sPaperStd = "A";
							} else if(((sPcnt * 2)  % 8) != 0 && ((sPcnt * 2) % 8) == 6) {
								//B
								sPaperStd = "B";
							} else if((sPcnt * 2) % 8 == 4) {
								//C
								sPaperStd = "C";
							}
						} else {
							if(sPcnt % 8 == 0) {
								//A
								sPaperStd = "A";
							} else if(sPcnt % 8 != 0 && sPcnt % 8 == 6) {
								//B
								sPaperStd = "B";
							} else if(sPcnt % 8 == 4) {
								//C
								sPaperStd = "C";
							}
						}
					}
					
					if(sPaperStd == "A") {
						//item의 배열 유무 확인
						if(node_roll_a.length > 0) {
							sFirRollValue = model1.getValue("/root/initData/comboSet/roll_wgt_a["+iSelectedRow+"]/item[1]/value");
							sFirMatrValue = model1.getValue("/root/initData/comboSet/matr_cd_a["+iSelectedRow+"]/item[1]/value");
						} else {
							sFirRollValue = model1.getValue("/root/initData/comboSet/roll_wgt_a["+iSelectedRow+"]/item/value");
							sFirMatrValue = model1.getValue("/root/initData/comboSet/matr_cd_a["+iSelectedRow+"]/item/value");
						}
						
						datagrid1.isReadOnly(iSelectedRow, 9) = true;
						datagrid1.isReadOnly(iSelectedRow, 11) = false;
						
						model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/roll_wgt_a", sFirRollValue);
						model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/matr_cd_a" , sFirMatrValue);
						datagrid1.refresh();
						datagrid1.isReadOnly(iSelectedRow,12,iSelectedRow,14) = true;
						datagrid1.isReadOnly(iSelectedRow,15,iSelectedRow,17) = true;
					}
					
					if(sPaperStd == "B") {
						//item의 배열 유무 확인
						if(node_roll_b.length > 0) {
							sFirRollValue = model1.getValue("/root/initData/comboSet/roll_wgt_b["+iSelectedRow+"]/item[1]/value");
							sFirMatrValue = model1.getValue("/root/initData/comboSet/matr_cd_b["+iSelectedRow+"]/item[1]/value");
						} else {
							sFirRollValue = model1.getValue("/root/initData/comboSet/roll_wgt_b["+iSelectedRow+"]/item/value");
							sFirMatrValue = model1.getValue("/root/initData/comboSet/matr_cd_b["+iSelectedRow+"]/item/value");
						}
						
						datagrid1.isReadOnly(iSelectedRow, 12) = true;
						datagrid1.isReadOnly(iSelectedRow, 14) = false;
						model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/roll_wgt_b", sFirRollValue);
						model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/matr_cd_b" , sFirMatrValue);
						datagrid1.refresh();
						datagrid1.isReadOnly(iSelectedRow,9,iSelectedRow,11) = true;
						datagrid1.isReadOnly(iSelectedRow,15,iSelectedRow,17) = true;

					}
					
					if(sPaperStd == "C") {
						//item의 배열 유무 확인
						if(node_roll_c.length > 0) {
							sFirRollValue = model1.getValue("/root/initData/comboSet/roll_wgt_c["+iSelectedRow+"]/item[1]/value");
							sFirMatrValue = model1.getValue("/root/initData/comboSet/matr_cd_c["+iSelectedRow+"]/item[1]/value");
						} else {
							sFirRollValue = model1.getValue("/root/initData/comboSet/roll_wgt_c["+iSelectedRow+"]/item/value");
							sFirMatrValue = model1.getValue("/root/initData/comboSet/matr_cd_c["+iSelectedRow+"]/item/value");
						}
						
						datagrid1.isReadOnly(iSelectedRow, 15) = true;
						datagrid1.isReadOnly(iSelectedRow, 17) = false;
						model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/roll_wgt_c", sFirRollValue);
						model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/matr_cd_c" , sFirMatrValue);
						datagrid1.refresh();
						datagrid1.isReadOnly(iSelectedRow,9,iSelectedRow,11) = true;
						datagrid1.isReadOnly(iSelectedRow,12,iSelectedRow,14) = true;
					}
					
				}
				
				//발행면수, 발행부수, 양출여부 셋팅
				function funDataSet(iSelectedRow) {
					var sIssuDt  = "";		//발행일자
					var sFacClsf = "";		//공장구분
					var sMediCd  = "";		//매체코드
					var sSectCd  = "";		//섹션코드
					
					sIssuDt  = model1.getValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/issu_dt"   );
					sFacClsf = model1.getValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/fac_clsf"  );
					sMediCd  = model1.getValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/medi_cd"   );
					sSectCd  = model1.getValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/sect_cd"   );
					
					if(sIssuDt == "") {
						alert("발행일자을 입력해 주세요");
						return false;
					}
					
					if(sFacClsf == "") {
						alert("공장을 선택해 주세요");
						return false;
					}
					
					if(sMediCd == "") {
						alert("매체를 선택해 주세요");
						return false;
					}
					
					if(sSectCd == "") {
						alert("섹션을 선택해 주세요");
						return false;
					}
					
					model1.setValue("/root/reqData/searchData2/issu_dt_s" , sIssuDt);
					model1.setValue("/root/reqData/searchData2/fac_clsf_s", sFacClsf);
					model1.setValue("/root/reqData/searchData2/medi_cd_s" , sMediCd);
					model1.setValue("/root/reqData/searchData2/sect_cd_s" , sSectCd);
					
					model1.send("mt_papord_4003_l");
					
					model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/issu_pcnt",model1.getValue("/root/tempData/pcnt"));
					model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/issu_qty",model1.getValue("/root/tempData/slip_qty"));
					model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/dual_out_clsf",model1.getValue("/root/tempData/dual_out_clsf"));
					model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/dual_out_clsf_nm",model1.getValue("/root/tempData/dual_out_clsf_nm"));
					
					return true;
				}
				
				//행입력
				function addRow() {
					var rowCnt      = 0;
					var selectedIdx = datagrid1.rows - 1;
					
					if(datagrid1.isReadOnly(2,1) == true) {
						datagrid1.isReadOnly(2, 1, 2, 8)  = false;
						datagrid1.addStatus(selectedIdx, "insert");
					} else {
						datagrid1.addRow(true, true);
					}
				}
				
				//중량계산
				function funWgt(iSelectedRow, iColIndex) {
					var iWgt = 0;
					var iRoll = 0;
					var iWgt2 = 0;
					if(iColIndex == 12) {
						iWgt = eval(datagrid1.valueMatrix(iSelectedRow, 10));
						iRoll = eval(datagrid1.valueMatrix(iSelectedRow, 12));
						iWgt2 = iWgt * iRoll;
						model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/wgt_a",iWgt2);
					} else if(iColIndex == 15) {
						iWgt = eval(datagrid1.valueMatrix(iSelectedRow,13));
						iRoll = eval(datagrid1.valueMatrix(iSelectedRow,15));
						iWgt2 = iWgt * iRoll;
						model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/wgt_b",iWgt2);
					} else if(iColIndex == 18) {
						iWgt = eval(datagrid1.valueMatrix(iSelectedRow,16));
						iRoll = eval(datagrid1.valueMatrix(iSelectedRow,18));
						iWgt2 = iWgt * iRoll;
						model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/wgt_c",iWgt2);
					}
					
					
				}
				
				//롤당중량 onChange시 자재코드 Change
				function funMatrSelect(iSelectedRow,iColIndex) {
					var iRollWgt = 0;
					var sMatrCd  = "";
					var iComIndex = 0;
					
					if(iColIndex == 9) {
						//iRollWgt = model1.getValue("/root/resData/gridData/record["+iSelectedRow+"]/roll_wgt_a");
						
						iRollWgt = datagrid1.valueMatrix(iSelectedRow,9);
						model1.setValue("/root/resData/resForm/roll_wgt_a",iRollWgt);
						
						iComIndex = combo2.focusIndex;
						combo5.select(iComIndex);
						
						model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/matr_cd_a", model1.getValue("/root/resData/resForm/matr_cd_a"));
						
					} else if(iColIndex == 12) {
						iRollWgt = model1.getValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/roll_wgt_b");
						model1.setValue("/root/resData/resForm/roll_wgt_b",iRollWgt);
						iComIndex = combo3.focusIndex;
						combo6.select(iComIndex);
						
						model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/matr_cd_b", model1.getValue("/root/resData/resForm/matr_cd_b"));
					} else if(iColIndex == 15) {
						iRollWgt = model1.getValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/roll_wgt_b");
						model1.setValue("/root/resData/resForm/roll_wgt_b",iRollWgt);
						iComIndex = combo4.focusIndex;
						combo7.select(iComIndex);
						
						model1.setValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/matr_cd_c", model1.getValue("/root/resData/resForm/matr_cd_c"));
					}
					datagrid1.refresh();
				}
				
				
				//저장
				function funSave() {
					if (window.alert("저장하시겠습니까?", "확인", 1) != 1) {
						return;
					}
					
					model1.setValue("/root/reqData/multiUpData",datagrid1.getUpdateData());

					model1.send("mt_papord_4004_a");
					
					if(submit_completed()) {
						alert("저장 완료되었습니다.");
						window.reload();
					}
				}
				
				//조회
				function funSearch() {
					model1.send("mt_papord_4005_l");
					model1.copyNode("/root/resData/gridData","/root/tempData/gridData");
					/*
					model.copyNode("/root/initData/comboSet/pap_clsf_a", "/root/tempData/pap_clsf_a");
					model.copyNode("/root/initData/comboSet/pap_clsf_b", "/root/tempData/pap_clsf_b");
					model.copyNode("/root/initData/comboSet/pap_clsf_c", "/root/tempData/pap_clsf_c");
					
					var nodeList = instance1.selectNodes("/root/resData/gridData/record");
					var nodeList_a = instance1.selectNodes("/root/initData/comboSet/pap_clsf_a/item");
					var nodeList_b = instance1.selectNodes("/root/initData/comboSet/pap_clsf_b/item");
					var nodeList_c = instance1.selectNodes("/root/initData/comboSet/pap_clsf_c/item");
					
					
					for (var i=0; i<nodeList.length; i++){
						if (nodeList_a.length > 0){
							model.setValue("/root/resData/gridData/record[" + (i + 1) + "]/roll_wgt_a", nodeList_a.item(0).getElementsByTagName("value").item(0).value);
						} else {
							model.setValue("/root/resData/gridData/record[" + (i + 1) + "]/roll_wgt_a", 0);
						}
						if (nodeList_b.length > 0){
							model.setValue("/root/resData/gridData/record[" + (i + 1) + "]/roll_wgt_b", nodeList_b.item(0).getElementsByTagName("value").item(0).value);
						} else {
							model.setValue("/root/resData/gridData/record[" + (i + 1) + "]/roll_wgt_b", 0);
						}
						if (nodeList_c.length > 0){
							model.setValue("/root/resData/gridData/record[" + (i + 1) + "]/roll_wgt_c", nodeList_c.item(0).getElementsByTagName("value").item(0).value);
						} else {
							model.setValue("/root/resData/gridData/record[" + (i + 1) + "]/roll_wgt_c", 0);
						}
					}
					datagrid1.refresh();
					
					for (var i=2; i<datagrid1.rows; i++){
						
						if (datagrid1.valueMatrix(i, 3) == "110"){
							datagrid1.cellComboNodeset(i, 4) = "/root/initData/comboSet/sect_cd/item";
						} else if (datagrid1.valueMatrix(i, 3) == "610"){
							datagrid1.cellComboNodeset(i, 4) = "/root/initData/comboSet/sect_cd_2/item";
						}
						
						
						if (nodeList_a.length > 0){
							datagrid1.valueMatrix(i,11) = Math.round(eval(datagrid1.valueMatrix(i,10)) / eval(datagrid1.valueMatrix(i, 9)));
							datagrid1.colDisabled(9) = false;
							datagrid1.colDisabled(10) = false;
							datagrid1.colDisabled(11) = false;
							datagrid1.colStyle(9, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(10, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(11, "data", "background-color")  = "#FFFFFF";
						} else {
							datagrid1.valueMatrix(i,11) = 0;
							datagrid1.colDisabled(9) = true;
							datagrid1.colDisabled(10) = true;
							datagrid1.colDisabled(11) = true;
							datagrid1.colStyle(9, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(10, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(11, "data", "background-color")  = "#DDEEDD";
						}
						if (nodeList_b.length > 0){
							datagrid1.valueMatrix(i,14) = Math.round(eval(datagrid1.valueMatrix(i,13)) / eval(datagrid1.valueMatrix(i, 12)));
							datagrid1.colDisabled(12) = false;
							datagrid1.colDisabled(13) = false;
							datagrid1.colDisabled(14) = false;
							datagrid1.colStyle(12, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(13, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(14, "data", "background-color")  = "#FFFFFF";
						} else {
							datagrid1.valueMatrix(i,14) = 0;
							datagrid1.colDisabled(12) = true;
							datagrid1.colDisabled(13) = true;
							datagrid1.colDisabled(14) = true;
							datagrid1.colStyle(12, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(13, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(14, "data", "background-color")  = "#DDEEDD";
						}
						if (nodeList_c.length > 0){
							datagrid1.valueMatrix(i,17) = Math.round(eval(datagrid1.valueMatrix(i,16)) / eval(datagrid1.valueMatrix(i, 15)));
							datagrid1.colDisabled(15) = false;
							datagrid1.colDisabled(16) = false;
							datagrid1.colDisabled(17) = false;
							datagrid1.colStyle(15, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(16, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(17, "data", "background-color")  = "#FFFFFF";
						} else {
							datagrid1.valueMatrix(i,17) = 0;
							datagrid1.colDisabled(15) = true;
							datagrid1.colDisabled(16) = true;
							datagrid1.colDisabled(17) = true;
							datagrid1.colStyle(15, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(16, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(17, "data", "background-color")  = "#DDEEDD";
						}
						datagrid1.valueMatrix(i,19) = getMatr_cd('A', datagrid1.valueMatrix(i, 9));
						datagrid1.valueMatrix(i,20) = getMatr_cd('B', datagrid1.valueMatrix(i, 12));
						datagrid1.valueMatrix(i,21) = getMatr_cd('C', datagrid1.valueMatrix(i, 15));
						
						//datagrid1.rowStatus(i) = 1;
						
						
						
						
						
						
						
						
						
						
						
						
						//datagrid1.valueMatrix(i,11) = Math.round(eval(datagrid1.valueMatrix(i,10)) / eval(datagrid1.valueMatrix(i, 9)));
						//datagrid1.valueMatrix(i,14) = Math.round(eval(datagrid1.valueMatrix(i,13)) / eval(datagrid1.valueMatrix(i, 12)));
						//datagrid1.valueMatrix(i,17) = Math.round(eval(datagrid1.valueMatrix(i,16)) / eval(datagrid1.valueMatrix(i, 15)));
						//datagrid1.valueMatrix(i,19) = getMatr_cd('A', datagrid1.valueMatrix(i, 9));
						//datagrid1.valueMatrix(i,20) = getMatr_cd('B', datagrid1.valueMatrix(i, 12));
						//datagrid1.valueMatrix(i,21) = getMatr_cd('C', datagrid1.valueMatrix(i, 15));
						
						//datagrid1.rowStatus(i) = 1;
					}
					
					*/
					
					
					datagrid1.refresh();
					
				}
				
				// 
				function setData() {
					for(var i=2; i < datagrid1.rows; i++) {
						sValue = datagrid1.valueMatrix(i,2);
						funRollWgt(i, sValue);
						
						sValue = datagrid1.valueMatrix(i,3);
						funSectCd(sValue);
						
						if(funDataSet(i) == false) {	//발행면수, 발행부수, 양출여부 셋팅
							return;
						} else {
							funPaperStd(i);	//A, B, C 확인
						}
					}
					
				}
				
				function getMatr_cd(fDiv, fVal){
					var nodeList;
					var retMatr_cd = "";
					if (fDiv == 'A'){
						nodeList = instance1.selectNodes("/root/initData/comboSet/pap_clsf_a/item");
					} else if (fDiv == 'B'){
						nodeList = instance1.selectNodes("/root/initData/comboSet/pap_clsf_b/item");
					} else if (fDiv == 'C'){
						nodeList = instance1.selectNodes("/root/initData/comboSet/pap_clsf_c/item");
					}
					
					for (var i=0; i< nodeList.length; i++){
						if (fVal == nodeList.item(i).getElementsByTagName("value").item(0).value){
							retMatr_cd = nodeList.item(i).getElementsByTagName("matr").item(0).value;
						}
					}
					return retMatr_cd;
				}
				
				//주간발행팝업
				function setWkIssu(issu_fr, issu_to, fac_clsf) {
					model.setValue("/root/reqData/searchData3/issu_fr", issu_fr);
					model.setValue("/root/reqData/searchData3/issu_to", issu_to);
					model.setValue("/root/reqData/searchData3/fac_clsf", fac_clsf);
					
					model.send("mt_papord_4006_l");
					
					model.copyNode("/root/resData/gridData", "/root/tempData/gridData");
					model.copyNode("/root/initData/comboSet/pap_clsf_a", "/root/tempData/pap_clsf_a");
					model.copyNode("/root/initData/comboSet/pap_clsf_b", "/root/tempData/pap_clsf_b");
					model.copyNode("/root/initData/comboSet/pap_clsf_c", "/root/tempData/pap_clsf_c");
					
					
					/*
					var nodeList = instance1.selectNodes("/root/resData/gridData/record");
					var nodeList_a = instance1.selectNodes("/root/initData/comboSet/pap_clsf_a/item");
					var nodeList_b = instance1.selectNodes("/root/initData/comboSet/pap_clsf_b/item");
					var nodeList_c = instance1.selectNodes("/root/initData/comboSet/pap_clsf_c/item");
					
					for (var i=0; i<nodeList.length; i++){
						if (nodeList_a.length > 0){
							model.setValue("/root/resData/gridData/record[" + (i + 1) + "]/roll_wgt_a", nodeList_a.item(0).getElementsByTagName("value").item(0).value);
						} else {
							model.setValue("/root/resData/gridData/record[" + (i + 1) + "]/roll_wgt_a", 0);
						}
						if (nodeList_b.length > 0){
							model.setValue("/root/resData/gridData/record[" + (i + 1) + "]/roll_wgt_b", nodeList_b.item(0).getElementsByTagName("value").item(0).value);
						} else {
							model.setValue("/root/resData/gridData/record[" + (i + 1) + "]/roll_wgt_b", 0);
						}
						if (nodeList_c.length > 0){
							model.setValue("/root/resData/gridData/record[" + (i + 1) + "]/roll_wgt_c", nodeList_c.item(0).getElementsByTagName("value").item(0).value);
						} else {
							model.setValue("/root/resData/gridData/record[" + (i + 1) + "]/roll_wgt_c", 0);
						}
					}
					*/
					datagrid1.refresh();
					
					for (var i=2; i<datagrid1.rows; i++){
						
						if (datagrid1.valueMatrix(i, datagrid1.colRef("medi_cd")) == "110"){
							datagrid1.cellComboNodeset(i, 4) = "/root/initData/comboSet/sect_cd/item";
						} else if (datagrid1.valueMatrix(i, datagrid1.colRef("medi_cd")) == "610"){
							datagrid1.cellComboNodeset(i, 4) = "/root/initData/comboSet/sect_cd_2/item";
						}
						
						if (datagrid1.valueMatrix(i, datagrid1.colRef("roll_wgt_a")) == "0"){
							datagrid1.valueMatrix(i, datagrid1.colRef("roll_cnt_a")) = 0;
							datagrid1.colDisabled(10) = true;
							datagrid1.colDisabled(11) = true;
							datagrid1.colDisabled(12) = true;
							datagrid1.colStyle(10, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(11, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(12, "data", "background-color")  = "#DDEEDD";
						} else {
							datagrid1.valueMatrix(i, datagrid1.colRef("roll_cnt_a")) = Math.ceil(eval(datagrid1.valueMatrix(i, datagrid1.colRef("wgt_a"))) / eval(datagrid1.valueMatrix(i, datagrid1.colRef("roll_wgt_a"))));
							datagrid1.colDisabled(10) = false;
							datagrid1.colDisabled(11) = false;
							datagrid1.colDisabled(12) = false;
							datagrid1.colStyle(10, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(11, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(12, "data", "background-color")  = "#FFFFFF";
						}
						
						if (datagrid1.valueMatrix(i, datagrid1.colRef("roll_wgt_b")) == "0"){
							datagrid1.valueMatrix(i, datagrid1.colRef("roll_cnt_b")) = 0;
							datagrid1.colDisabled(13) = true;
							datagrid1.colDisabled(14) = true;
							datagrid1.colDisabled(15) = true;
							datagrid1.colStyle(13, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(14, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(15, "data", "background-color")  = "#DDEEDD";
						} else {
							datagrid1.valueMatrix(i, datagrid1.colRef("roll_cnt_b")) = Math.ceil(eval(datagrid1.valueMatrix(i, datagrid1.colRef("wgt_b"))) / eval(datagrid1.valueMatrix(i, datagrid1.colRef("roll_wgt_b"))));
							datagrid1.colDisabled(13) = false;
							datagrid1.colDisabled(14) = false;
							datagrid1.colDisabled(15) = false;
							datagrid1.colStyle(13, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(14, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(15, "data", "background-color")  = "#FFFFFF";
						}
						
						if (datagrid1.valueMatrix(i, datagrid1.colRef("roll_wgt_c")) == "0"){
							ddatagrid1.valueMatrix(i, datagrid1.colRef("roll_cnt_c")) = 0;
							datagrid1.colDisabled(16) = true;
							datagrid1.colDisabled(17) = true;
							datagrid1.colDisabled(18) = true;
							datagrid1.colStyle(16, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(17, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(18, "data", "background-color")  = "#DDEEDD";
						} else {
							datagrid1.valueMatrix(i, datagrid1.colRef("roll_cnt_c")) = Math.round(eval(datagrid1.valueMatrix(i, datagrid1.colRef("wgt_c"))) / eval(datagrid1.valueMatrix(i, datagrid1.colRef("roll_wgt_c"))));
							datagrid1.colDisabled(16) = false;
							datagrid1.colDisabled(17) = false;
							datagrid1.colDisabled(18) = false;
							datagrid1.colStyle(16, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(17, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(18, "data", "background-color")  = "#FFFFFF";
						}
						/*
						if (nodeList_a.length > 0){
							datagrid1.valueMatrix(i, datagrid1.colRef("roll_cnt_a")) = Math.ceil(eval(datagrid1.valueMatrix(i, datagrid1.colRef("wgt_a"))) / eval(datagrid1.valueMatrix(i, datagrid1.colRef("roll_wgt_a"))));
							datagrid1.colDisabled(10) = false;
							datagrid1.colDisabled(11) = false;
							datagrid1.colDisabled(12) = false;
							datagrid1.colStyle(10, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(11, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(12, "data", "background-color")  = "#FFFFFF";
						} else {
							datagrid1.valueMatrix(i, datagrid1.colRef("roll_cnt_a")) = 0;
							datagrid1.colDisabled(10) = true;
							datagrid1.colDisabled(11) = true;
							datagrid1.colDisabled(12) = true;
							datagrid1.colStyle(10, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(11, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(12, "data", "background-color")  = "#DDEEDD";
						}
						if (nodeList_b.length > 0){
							datagrid1.valueMatrix(i, datagrid1.colRef("roll_cnt_b")) = Math.ceil(eval(datagrid1.valueMatrix(i, datagrid1.colRef("wgt_b"))) / eval(datagrid1.valueMatrix(i, datagrid1.colRef("roll_wgt_b"))));
							datagrid1.colDisabled(13) = false;
							datagrid1.colDisabled(14) = false;
							datagrid1.colDisabled(15) = false;
							datagrid1.colStyle(13, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(14, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(15, "data", "background-color")  = "#FFFFFF";
						} else {
							datagrid1.valueMatrix(i, datagrid1.colRef("roll_cnt_b")) = 0;
							datagrid1.colDisabled(13) = true;
							datagrid1.colDisabled(14) = true;
							datagrid1.colDisabled(15) = true;
							datagrid1.colStyle(13, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(14, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(15, "data", "background-color")  = "#DDEEDD";
						}
						if (nodeList_c.length > 0){
							datagrid1.valueMatrix(i, datagrid1.colRef("roll_cnt_c")) = Math.round(eval(datagrid1.valueMatrix(i, datagrid1.colRef("wgt_c"))) / eval(datagrid1.valueMatrix(i, datagrid1.colRef("roll_wgt_c"))));
							datagrid1.colDisabled(16) = false;
							datagrid1.colDisabled(17) = false;
							datagrid1.colDisabled(18) = false;
							datagrid1.colStyle(16, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(17, "data", "background-color")  = "#FFFFFF";
							datagrid1.colStyle(18, "data", "background-color")  = "#FFFFFF";
						} else {
							datagrid1.valueMatrix(i, datagrid1.colRef("roll_cnt_c")) = 0;
							datagrid1.colDisabled(16) = true;
							datagrid1.colDisabled(17) = true;
							datagrid1.colDisabled(18) = true;
							datagrid1.colStyle(16, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(17, "data", "background-color")  = "#DDEEDD";
							datagrid1.colStyle(18, "data", "background-color")  = "#DDEEDD";
						}
						*/
						datagrid1.valueMatrix(i, datagrid1.colRef("matr_cd_a")) = getMatr_cd('A', datagrid1.valueMatrix(i, datagrid1.colRef("roll_wgt_a")));
						datagrid1.valueMatrix(i, datagrid1.colRef("matr_cd_b")) = getMatr_cd('B', datagrid1.valueMatrix(i, datagrid1.colRef("roll_wgt_b")));
						datagrid1.valueMatrix(i, datagrid1.colRef("matr_cd_c")) = getMatr_cd('C', datagrid1.valueMatrix(i, datagrid1.colRef("roll_wgt_c")));
						
						datagrid1.rowStatus(i) = 1;
					}
				}
				
				//주간발행팝업
				function setWkIssu_2(sIssuDt, sFacClsf, sMediCd, sSectCd, sPcnt, sSlipQty, sDualOut, sDualOutNm) {
					
					var iSelectedIndex = 0;

					addRow();    //행추가
					datagrid1.refresh();
					iSelectedIndex = datagrid1.rows - 2;
					model1.setValue("/root/resData/gridData/record["+iSelectedIndex+"]/issu_dt"         , sIssuDt);
					model1.setValue("/root/resData/gridData/record["+iSelectedIndex+"]/fac_clsf"        , sFacClsf);
					model1.setValue("/root/resData/gridData/record["+iSelectedIndex+"]/medi_cd"         , sMediCd);
					model1.setValue("/root/resData/gridData/record["+iSelectedIndex+"]/sect_cd"         , sSectCd);
					model1.setValue("/root/resData/gridData/record["+iSelectedIndex+"]/issu_pcnt"       , sPcnt);
					model1.setValue("/root/resData/gridData/record["+iSelectedIndex+"]/issu_qty"        , sSlipQty);
					model1.setValue("/root/resData/gridData/record["+iSelectedIndex+"]/dual_out_clsf_nm", sDualOutNm);
					model1.setValue("/root/resData/gridData/record["+iSelectedIndex+"]/dual_out_clsf"   , sDualOut);
					
					iSelectedIndex = iSelectedIndex + 1;
					
					sValue = datagrid1.valueMatrix(iSelectedIndex,2);
					funRollWgt(iSelectedIndex, sValue);
					
					sValue = datagrid1.valueMatrix(iSelectedIndex,3);
					funSectCd(sValue);
					datagrid1.refresh();
					
					funPaperStd(iSelectedIndex);	//A, B, C 확인

				}
				
			]]>
		</script>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/TFCommon.js"/>
	</xhtml:head>
	<xhtml:body pagewidth="946" pageheight="728" guideline="2,125;1,10;1,935;">
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group1" class="gro_sel" style="left:10px; top:42px; width:926px; height:27px; ">
			<button id="btnA1" class="btn02" style="left:628px; top:3px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var sValue = "";
						funSearch();
						
						for(var i=2; i < datagrid1.rows; i++) {
							sValue = datagrid1.valueMatrix(i,2);
							//funRollWgt(i, sValue);
							
							sValue = datagrid1.valueMatrix(i,3);
							//funSectCd(sValue);
							
							//funPaperStd(i);
						}
						
						//setData();
						datagrid1.refresh();
						datagrid1.isReadOnly(2, 1, 2, 8)  = false;

					]]>
				</script>
			</button>
			<button id="button3" class="btn02" style="left:822px; top:3px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.reset();
						datagrid1.isReadOnly(2, 1, 2, 18)  = true;		//첫번째 행 readonly
					]]>
				</script>
			</button>
			<button id="button4" class="btn02" style="left:874px; top:3px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
						
					]]>
				</script>
			</button>
			<button id="button6" class="btn02" style="left:680px; top:3px; width:52px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						funSave();
					]]>
				</script>
			</button>
			<button id="button1" class="btn04" style="left:732px; top:3px; width:90px; height:21px; ">
				<caption>주간발행조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.setValue("/root/reqData/fwdData/func_nm", "setWkIssu");
						window.load(
							"/xrw/mt/prnpap/MT_PAPORD_4100.xrw"
							,"modal"
							,""
							,"left:30px; top:200px; width:650px; height:400px; align:center; caption:hidden;"
							,"/root/reqData/fwdData"
							,"/root/reqData/fwdData"
						);
					]]>
				</script>
			</button>
		</group>
		<group id="group2" style="left:10px; top:75px; width:926px; height:24px; ">
			<caption id="caption2" class="list_cap02" style="left:0px; top:0px; width:926px; height:24px; text-align:center; "/>
			<caption id="caption1" class="list_cap01" style="left:0px; top:0px; width:100px; height:24px; text-align:center; ">발행일자</caption>
			<input id="input1" ref="/root/reqData/searchData/issu_dt_s" navindex="1" inputtype="date" style="left:105px; top:3px; width:100px; height:18px; "/>
			<caption id="caption3" class="list_cap01" style="left:440px; top:0px; width:100px; height:24px; text-align:center; ">공장</caption>
			<select1 id="combo1" ref="/root/reqData/searchData/fac_clsf_s" navindex="2" appearance="minimal" style="left:545px; top:3px; width:116px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fac_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
		</group>
		<button id="button9" class="btn_grid03" style="left:827px; top:105px; width:52px; height:17px; ">
			<caption>행입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					addRow();

 				]]>
			</script>
		</button>
		<button id="button10" class="btn_grid03" style="left:882px; top:105px; width:52px; height:17px; ">
			<caption>행삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var iSelectedRow = 0;
					var sDelGubun = "";
					
					iSelectedRow = datagrid1.selectedRow(0);
					
					sDelGubun = model1.getValue("/root/resData/gridData/record["+(iSelectedRow-1)+"]/rowCnt");
					
					if(sDelGubun != "") {
						datagrid1.addStatus(datagrid1.row, "delete");
					} else {
						datagrid1.deleteRow(iSelectedRow,true);
					}
				]]>
			</script>
		</button>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" scroll="both" caption="발행일자^공장^매체^섹션^규격^발행&#xA;면수^발행부수^양출&#xA;여부^변경^자재코드_A권^자재코드_A권^자재코드_A권^자재코드_B권^자재코드_B권^자재코드_B권^자재코드_C권^자재코드_C권^자재코드_C권^caption1^caption2^caption3^caption4^caption5^caption6^caption7|발행일자^공장^매체^섹션^규격^발행&#xA;면수^발행부수^양출&#xA;여부^변경^중량/1롤^중량^롤수^중량/1롤^중량^롤수^중량/1롤^중량^롤수^caption1^caption2^caption3^caption4^caption5^caption6^caption7" colsep="#" colwidth="100, 90, 110, 123, 50, 50, 70, 50, 30, 70, 60, 50, 70, 60, 50, 70, 60, 50, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:10px; top:125px; width:925px; height:574px; ">
			<col ref="issu_dt" type="inputdate"/>
			<col ref="fac_clsf" type="combo" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fac_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="medi_cd" type="combo" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/medi_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="sect_cd" type="combo" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/sect_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="std"/>
			<col ref="pcnt" type="input"/>
			<col ref="slip_qty" type="input" format="#,###"/>
			<col ref="dual_out_nm" type="combo" style="text-align:center; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dual_out_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col checkvalue="1,0" ref="check" type="checkbox"/>
			<col id="roll_wgt_a" ref="roll_wgt_a" visibility="hidden" style="text-align:left; "/>
			<col ref="wgt_a" type="output" format="#,###" style="left:763px; top:40px; width:80px; height:20px; text-align:right; "/>
			<col ref="roll_cnt_a" type="input" format="#,###" style="left:843px; top:40px; width:50px; height:20px; "/>
			<col id="roll_wgt_b" ref="roll_wgt_b" visibility="hidden" style="left:913px; top:40px; width:100px; height:20px; text-align:left; "/>
			<col ref="wgt_b" type="output" format="#,###"/>
			<col ref="roll_cnt_b" type="input" format="#,###"/>
			<col id="roll_wgt_c" ref="roll_wgt_c" visibility="hidden" style="text-align:left; "/>
			<col ref="wgt_c" type="output" format="#,###"/>
			<col ref="roll_cnt_c" type="input" format="#,###"/>
			<col ref="rowCnt" visibility="hidden"/>
			<col ref="matr_cd_a" visibility="hidden"/>
			<col ref="matr_cd_b" visibility="hidden"/>
			<col ref="matr_cd_c" visibility="hidden"/>
			<col ref="dual_out_clsf" visibility="hidden"/>
			<col ref="paper_std_cd" visibility="hidden"/>
			<col ref="prt_clsf" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var cell			= datagrid1.selectedCells;
					if(cell.length < 1){
						alert("select a Cell");
						return;
					}
					var col			= eval(cell.item(0).col);
					var row			= eval(cell.item(0).row);
					
					var sValue = "";
					var iColIndex = 0;
					var iSelectedRow = 0;
					var pcnt			= 0;
					var wgt			= 0;
					
					if (datagrid1.valueMatrix(row, datagrid1.colRef("std")) == "T"){
						pcnt	= eval(datagrid1.valueMatrix(row, datagrid1.colRef("pcnt"))) / 2;
					} else {
						pcnt	= eval(datagrid1.valueMatrix(row, datagrid1.colRef("pcnt")));
					}
					wgt = Math.round(pcnt * eval(datagrid1.valueMatrix(row, datagrid1.colRef("slip_qty"))) / 4000 * 19.791 * 1.03);
					
					//alert(pcnt);
					iSelectedRow = datagrid1.selectedRow(0);
					if(datagrid1.col == 2) {		//공장콤보 Change
						sValue = datagrid1.valueMatrix(row,2);
						funRollWgt(row,sValue);
					} else if(datagrid1.col == 3) {	//매체콤보 Change
						sValue = datagrid1.valueMatrix(row,3);
						funSectCd(sValue);
					} else if(datagrid1.col == 4) {	//섹션콤보 Change
						if(funDataSet(row) == false) {	//발행면수, 발행부수, 양출여부 셋팅
							return;
						} else {
							funPaperStd(row);	//A, B, C 확인
						}
					}  else if(datagrid1.col == 6 || datagrid1.col == 7) {	//발행면수 변경(발행부수 변경)
						/* B권이면 */
						if ( (pcnt % 8) == 6){
							//alert("b권...");
							datagrid1.valueMatrix(row, datagrid1.colRef("wgt_b")) = Math.round((pcnt % 8) * eval(datagrid1.valueMatrix(row, datagrid1.colRef("slip_qty"))) / 4000 * 19.791 * 1.03 );
							datagrid1.valueMatrix(row, datagrid1.colRef("roll_cnt_b")) = Math.round(eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_b"))) / eval(datagrid1.valueMatrix(row, datagrid1.colRef("roll_wgt_b"))));
						} else {
							datagrid1.valueMatrix(row, datagrid1.colRef("wgt_b")) 		= 0;
							datagrid1.valueMatrix(row, datagrid1.colRef("roll_cnt_b")) 	= 0;
						}
						/* C권이면 */
						if ( (pcnt / 8) - Math.floor(pcnt / 8) == 0){
							datagrid1.valueMatrix(row, datagrid1.colRef("wgt_c")) = 0;
							datagrid1.valueMatrix(row, datagrid1.colRef("roll_cnt_c")) = 0;
						} else {
							datagrid1.valueMatrix(row, datagrid1.colRef("wgt_c")) = Math.round(4 * pcnt / 4000 * 19.791 * 1.03 );
							datagrid1.valueMatrix(row, datagrid1.colRef("roll_cnt_c")) = Math.round(eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_c"))) / eval(datagrid1.valueMatrix(row, datagrid1.colRef("roll_wgt_c"))));
						}
						/* A권이면 */
						if ( (pcnt / 8) - Math.floor(pcnt / 8) == 0){
							
							datagrid1.valueMatrix(row, datagrid1.colRef("wgt_a")) = Math.round(pcnt * eval(datagrid1.valueMatrix(row, datagrid1.colRef("slip_qty"))) / 4000 * 19.791 * 1.03);
							datagrid1.valueMatrix(row, datagrid1.colRef("roll_cnt_a")) = Math.round(eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_a"))) / eval(datagrid1.valueMatrix(row, datagrid1.colRef("roll_wgt_a"))) );
						} else {
							if (eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_c"))) > 0){
								if (eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_b"))) > 0){
									datagrid1.valueMatrix(row, datagrid1.colRef("wgt_a")) = Math.round((pcnt - 10) * eval(datagrid1.valueMatrix(row, datagrid1.colRef("slip_qty"))) / 4000 * 19.791 * 1.03);
									datagrid1.valueMatrix(row, datagrid1.colRef("roll_cnt_a")) = Math.round(eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_a"))) / eval(datagrid1.valueMatrix(row, datagrid1.colRef("roll_wgt_a"))) );
								} else {
									datagrid1.valueMatrix(row, datagrid1.colRef("wgt_a")) = Math.round((pcnt - 4) * eval(datagrid1.valueMatrix(row, datagrid1.colRef("slip_qty"))) / 4000 * 19.791 * 1.03);
									datagrid1.valueMatrix(row, datagrid1.colRef("roll_cnt_a")) = Math.round(eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_a"))) / eval(datagrid1.valueMatrix(row, datagrid1.colRef("roll_wgt_a"))) );
								}
							} else {
								if (eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_b"))) > 0){
									datagrid1.valueMatrix(row, datagrid1.colRef("wgt_a")) = Math.round((pcnt - 6) * eval(datagrid1.valueMatrix(row, datagrid1.colRef("slip_qty"))) / 4000 * 19.791 * 1.03);
									datagrid1.valueMatrix(row, datagrid1.colRef("roll_cnt_a")) = Math.round(eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_a"))) / eval(datagrid1.valueMatrix(row, datagrid1.colRef("roll_wgt_a"))) );
								} else {
									datagrid1.valueMatrix(row, datagrid1.colRef("wgt_a")) = Math.round(pcnt * eval(datagrid1.valueMatrix(row, datagrid1.colRef("slip_qty"))) / 4000 * 19.791 * 1.03);
									datagrid1.valueMatrix(row, datagrid1.colRef("roll_cnt_a")) = Math.round(eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_a"))) / eval(datagrid1.valueMatrix(row, datagrid1.colRef("roll_wgt_a"))) );
								}
							}
						}
						//alert(wgt + "\n" + ( eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_a"))) + eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_b"))) + eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_c"))) ));
							
						if (wgt - ( eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_a"))) + eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_b"))) + eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_c"))) ) > 0 ){
							datagrid1.valueMatrix(row, datagrid1.colRef("wgt_a")) = eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_a"))) - (wgt - ( eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_a"))) + eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_b"))) + eval(datagrid1.valueMatrix(row, datagrid1.colRef("wgt_c"))) ));
						}
					//} 
					//else if(datagrid1.col == 6) {	//발행부수 변경
					//	/* B권이면 */
					//	if ((eval(datagrid1.valueMatrix(row, 5)) / 8 % 6) == 0){
					//		datagrid1.valueMatrix(row, 13) = Math.round((eval(datagrid1.valueMatrix(row, 5)) % 8) * eval(datagrid1.valueMatrix(row, 6)) / 4000 * 19.791 );
					//		datagrid1.valueMatrix(row, 14) = Math.round(eval(datagrid1.valueMatrix(row, 13)) / eval(datagrid1.valueMatrix(row, 12)));
					//	} else {
					//		datagrid1.valueMatrix(row, 13) = 0;
					//		datagrid1.valueMatrix(row, 14) = 0;
					//	}
					//	/* C권이면 */
					//	if ((eval(datagrid1.valueMatrix(row, 5)) / 8) - Math.floor(eval(datagrid1.valueMatrix(row, 5)) / 8) == 0){
					//		datagrid1.valueMatrix(row, 16) = 0;
					//		datagrid1.valueMatrix(row, 17) = 0;
					//	} else {
					//		
					//		datagrid1.valueMatrix(row, 16) = Math.round(4 * eval(datagrid1.valueMatrix(row, 6)) / 4000 * 19.791 );
					//		//alert(Math.round(eval(datagrid1.valueMatrix(row, 16)) / eval(datagrid1.valueMatrix(row, 15))) );
					//		datagrid1.valueMatrix(row, 17) = Math.round(eval(datagrid1.valueMatrix(row, 16)) / eval(datagrid1.valueMatrix(row, 15)));
					//	}
					//	/* A권이면 */
					//	if ( (eval(datagrid1.valueMatrix(row, 5)) / 8) - Math.floor(eval(datagrid1.valueMatrix(row, 5)) / 8) == 0){
					//		datagrid1.valueMatrix(row, 10) = Math.round(eval(datagrid1.valueMatrix(row, 5)) * eval(datagrid1.valueMatrix(row, 6)) / 4000 * 19.791 );
					//		//alert( Math.round(eval(datagrid1.valueMatrix(row, 10)) / eval(datagrid1.valueMatrix(row, 9)) ) );
					//		datagrid1.valueMatrix(row, 11) = Math.round(eval(datagrid1.valueMatrix(row, 10)) / eval(datagrid1.valueMatrix(row, 9)) );
					//	} else {
					//		datagrid1.valueMatrix(row, 10) = Math.round((eval(datagrid1.valueMatrix(row, 5)) - 4) * eval(datagrid1.valueMatrix(row, 6)) / 4000 * 19.791 );
					//		//alert( Math.round(eval(datagrid1.valueMatrix(row, 10)) / eval(datagrid1.valueMatrix(row, 9)) ) );
					//		datagrid1.valueMatrix(row, 11) = Math.round(eval(datagrid1.valueMatrix(row, 10)) / eval(datagrid1.valueMatrix(row, 9)) );
					//	}
						
					} else if(datagrid1.col == 12 || datagrid1.col == 15 || datagrid1.col == 18) {	//롤수입력
						iColIndex = datagrid1.col;
						funWgt(row, iColIndex);
					} 
					//else if(datagrid1.col == 9 || datagrid1.col == 12 || datagrid1.col == 15) {		//롤당중량Change
					//	iColIndex = datagrid1.col;
					//	funMatrSelect(row,iColIndex);
					//}
				]]>
			</script>
			<!--
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var iSelectedRow = 0;
					var sRowCnt      = "";
					
					iSelectedRow = datagrid1.selectedRow(0);
					sRowCnt = datagrid1.valueMatrix(iSelectedRow,18);
					
					if(datagrid1.col == 8) {
						if(datagrid1.valueMatrix(iSelectedRow,8) == 1) {
							if(sRowCnt == "") {			//행입력
								//datagrid1.rowStatus(iSelectedRow) = 0;
								datagrid1.isReadOnly(iSelectedRow,9) = false;
								datagrid1.isReadOnly(iSelectedRow,12) = false;
								datagrid1.isReadOnly(iSelectedRow,15) = false;
							} else {
								datagrid1.rowStatus(iSelectedRow) = 0;
							}
						} else if(datagrid1.valueMatrix(iSelectedRow,8) == 0) {
							if(sRowCnt == "") {			//행입력
								//datagrid1.rowStatus(iSelectedRow) = 0;
								datagrid1.isReadOnly(iSelectedRow,9) = true;
								datagrid1.isReadOnly(iSelectedRow,12) = true;
								datagrid1.isReadOnly(iSelectedRow,15) = true;
							} else {
								datagrid1.rowStatus(iSelectedRow) = 0;
							}
						}
					}
				]]>
			</script>
			-->
		</datagrid>
	</xhtml:body>
</xhtml:html>
