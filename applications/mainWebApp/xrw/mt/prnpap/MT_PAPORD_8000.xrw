<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<!-- 선택계열의 정보를 담당 -->
							<fac_clsf>
								<item/>
							</fac_clsf>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<!-- 검색조건 처리 -->
						<!-- formData 팝업,화면전환시 data이동시 -->
						<!-- MultiUpDate유형 사용시 처리 -->
						<searchData>
							<issu_dt_fr/>
							<issu_dt_to/>
							<issu_dt/>
							<fac_clsf/>
							<occr_yymm/>
							<gubun/>
							<search_dt_fr/>
							<search_dt_to/>
						</searchData>
						<fwdData>
						</fwdData>
						<setlData>
						</setlData>
						<multiUpData/>
						<reqForm>
							<fac_clsf/>
							<issu_dt/>
							<multiUpData/>
							<occr_yy/>
							<occr_seq/>
							<end_clsf/>
							<fix_clsf/>
						</reqForm>
						<searchCode>
							<fac_clsf/>
							<issu_dt/>
							<pcnt/>
							<slip_qty/>
							<dual_out_clsf/>
							<medi_cd/>
							<add_prt_seq/>
						</searchCode>
						<reqForm2>
							<fac_clsf/>
							<issu_dt/>
							<issu_dt_day/>
						</reqForm2>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<main1>
								<!-- datagrid1 -->
								<record>
									<occr_yy/>
									<seq/>
									<frdt/>
									<todt/>
									<fix_clsf/>
								</record>
							</main1>
							<main2>
								<record/>
							</main2>
							<!-- datagrid2 -->
							<ref>
								<record>
									<occr_dt/>
									<pap_row/>
									<car_cnt_b/>
									<car_cnt_c/>
									<car_cnt_a/>
								</record>
							</ref>
							<!-- datagrid3 -->
							<baseData>
								<record/>
							</baseData>
							<max>
								<record>
									<roll_a/>
									<roll_c/>
									<roll_b/>
								</record>
							</max>
							<rate>
								<dataSet>
									<CURLIST>
										<record>
											<jejisa/>
											<paper_cmpy/>
											<wgt_tot/>
											<per_tot/>
											<std_rate/>
											<diff_rate/>
											<ad_wgt/>
										</record>
									</CURLIST>
								</dataSet>
							</rate>
						</gridData>
						<resForm>
						</resForm>
						<msg/>
						<gridData2>
							<record>
							</record>
						</gridData2>
						<tempEwh_a/>
						<tempEwh_c/>
						<tempEwh_b/>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					var fac_arr = new Array();
					//광고 면수 단수 정보를 조회 결과의 발송처와 노선상세정보의 발송처 조회
					function fac_status(fac_clsf, issu_dt, end_clsf){
						this.fac = fac_clsf;
						this.issu = issu_dt;
						this.end = end_clsf;
					}
					
					function initGridData(){						
						if (datagrid4.cols > 1) {
							for(var i=0; i<datagrid4.cols + 1; i++){
								datagrid4.removeColumn();
							}
						}
						if (datagrid4.cols > 1) {
							for(var i=0; i<datagrid4.cols + 1; i++){
								datagrid4.removeColumn();
							}
						}
						//alert(datagrid2.cols);
						if (datagrid4.rows > 1){
							for(var i = 0 ; i < datagrid4.rows; i++){
								datagrid4.removeRow();
							}
						}
						
						if (datagrid4.rows > 1){
							for(var i = 0 ; i < datagrid4.rows; i++){
								datagrid4.removeRow();
							}
						}
						
						datagrid4.caption = "";
					}
					
					
					function loadList(){
						model.send("mt_papord_8003");
						model.copyNode("/root/resData/gridData/baseData", "/root/tempData");
						datagrid3.refresh();
						
						model.send("mt_papord_8006");
						model.copyNode("/root/resData/gridData/max", "/root/tempData/gridData");
						
						datagrid2.refresh();
						
						model1.refresh();
						datagrid4.rows = 2;
						//datagrid2.rows = 1;
						model.removenode("/root/resData/gridData/main2");
						model.makeNode("/root/resData/gridData/main2/record");
						datagrid1.refresh();
						
						for(var i = 0 ; i < 7 ; i++){
						
							var bfday = dateAdd("d", -i, getCurrentDate());
							if(commGetDay(bfday) =="월"){
								
								model.setValue("/root/reqData/searchData/issu_dt_fr", bfday);
								var todt	=	dateAdd("d", 7, bfday);
							}
						}

						//datagrid3.refresh();
						model.setValue("/root/reqData/searchData/issu_dt_to", todt);
						model.send("mt_papord_8002");
						datagrid1.refresh();
//						
//						for (var i=1; i<datagrid3.rows+1; i++){
//							if (datagrid3.valueMatrix(i,3) == todt){
//								
//								   datagrid3.isselected(i) = true;
//							}
//							
//						}
						makeTable();
						
					}
					
					function makeGridData(){
						var nodeList_x = instance1.selectNodes("/root/resData/gridData2/x_data/record");
						var nodeList_y = instance1.selectNodes("/root/resData/gridData2/y_data/record");
						var nodeList_d = instance1.selectNodes("/root/resData/gridData2/d_data/record");
						var rowCount 	= 1;
						var colCount 	= 0;
						var strMedi	= "";
						var strSect	= "";
						//datagrid4.col
						datagrid4.colAttribute ( 0, "format" ) = "yyyy-mm-dd";
						for(var i=0; i<nodeList_x.length; i++){	
							var subNode_medi	= nodeList_x.item(i).getElementsByTagName("medi_nm").item(0).value;
							var subNode_sect	= nodeList_x.item(i).getElementsByTagName("sect_nm").item(0).value;
							var subNode_medicd	= nodeList_x.item(i).getElementsByTagName("medi_cd").item(0).value;
							var subNode_sectcd	= nodeList_x.item(i).getElementsByTagName("sect_cd").item(0).value;
							var colNm			= subNode_medicd + "_" + subNode_sectcd;
							
							if (subNode_medi == subNode_sect) {
								strMedi += "^" + subNode_medi;
								strSect += "^" + subNode_sect + " ";
							} else {
								strMedi += "^" + subNode_medi;
								strSect += "^" + subNode_sect;
							}
							
							var refNode = "d_" + (i + 1);
							datagrid4.addColumn("ref:" + refNode + "; ");
							
							if (i == 0){
								datagrid4.colWidth(i) = 70;
							} else {
								datagrid4.colWidth(i) = 70;
							}
						}
						datagrid4.caption += strMedi + "|" + strSect;

						model.copyNode("/root/resData/gridData/ref", "/root/resData/gridData2/d_data");
						datagrid4.fixedCols = "1";
						datagrid4.fixedRows = "2";
						//datagrid2.refresh();
					}
					
					function makeGridDataOnly(){
						var nodeList_x = instance1.selectNodes("/root/resData/gridData/divData/x_data/record");
						var nodeList_y = instance1.selectNodes("/root/resData/gridData/divData/y_data/record");
						var nodeList_d = instance1.selectNodes("/root/resData/gridData/divData/d_data/record");
						var rowCount = 0;
						var colCount = 0;
						
						//alert(nodeList_x.length);
//						model1.makeNode("/root/resData/gridData2/record/remark");
						
						//datagrid1.addColumn("ref:remark;");
						//datagrid1.caption = "";
						
						//alert("nodeList_y.length=" + nodeList_y.length);
						
						//alert("nodeList_d.length=" + nodeList_d.length);
						// 그리드에 데이터를 넣는다.
						for(i=0; i<nodeList_d.length;i++){
							//var ref = nodeList_d.item(i);
							var fac_clsf = nodeList_d.item(i).getElementsByTagName("fac_clsf").item(0).value;
							var issu_dt = nodeList_d.item(i).getElementsByTagName("issu_dt").item(0).value;
							var end_clsf = nodeList_d.item(i).getElementsByTagName("end_clsf").item(0).value;
							
							fac_arr[i] = new fac_status(fac_clsf, issu_dt, end_clsf);
							
							//alert(Node_pcnt + "\n" + Node_clr_pcnt);
							if (i % nodeList_y.length == 0){
								rowCount++;
								colCount=1;
							} else {
								colCount++;
							}
							datagrid1.valuematrix( rowCount, colCount) = end_clsf;
						}
						//datagrid2.refresh();
					}
					
					function makeVal(){
						this.label = "";
						this.value = "";
						this.setMakeVal = setMakeVal;
					}
					
					function setMakeVal(iLabel, iValue){
						this.label = iLabel;
						this.value = iValue;
					}
					function setEwhTotal(){
						var fac_clsf = model.getValue("/root/reqData/searchData/fac_clsf");
						var rows = datagrid1.rows;
						var tmp_rct = 0;
						
						
						for (var row=2; row<datagrid1.rows; row++){
						
						
							var row_num = datagrid1.valueMatrix(row, 47);
							var papcmpy_cd = datagrid1.valueMatrix(row, 55);
							var car_cnt =  datagrid1.valueMatrix(row, 21);     
							
							if(fac_clsf == "10"){
								if(row_num =="1"){
									var tmp_roll_cnt_a = 9;
									var tmp_roll_wgt_a = 1455;
									var tmp_roll_wgt_c = 727;
									var tmp_roll_wgt_b = 1091;
								}else if(row_num =="3")
								{
									var tmp_roll_cnt_a = 6;
									var tmp_roll_wgt_a = 1455;
									var tmp_roll_wgt_c = 727;
									var tmp_roll_wgt_b = 1091;
								}
								
							
							}
							else if(fac_clsf == "22"){
								
								var tmp_roll_cnt_a = 15;
								var tmp_roll_wgt_a = 1404;
								var tmp_roll_wgt_c = 702;
								var tmp_roll_wgt_b = 1053;
							
							}
							else if(fac_clsf == "25"){
								var tmp_roll_cnt_a = 15;
								var tmp_roll_wgt_a = 1455;
								var tmp_roll_wgt_c = 727;
								var tmp_roll_wgt_b = 1091;
								if(papcmpy_cd =="1102"){
									if(car_cnt !=""){
										tmp_rct = -6;
									}else{
										tmp_rct = 0;
									}
									
								}else{
									tmp_rct = 0;
								}
							
							}
							else if(fac_clsf == "35"){
								var tmp_roll_cnt_a = 17;
								var tmp_roll_wgt_a = 1143;
								var tmp_roll_wgt_c = 571;
								var tmp_roll_wgt_b = 857;
							
							}
							else if(fac_clsf == "65"){
								var tmp_roll_cnt_a = 10;
								var tmp_roll_wgt_a = 1404;
								var tmp_roll_wgt_c = 702;
								var tmp_roll_wgt_b = 857;
							
							}
							else if(fac_clsf == "75"){
								var tmp_roll_cnt_a = 9;
								var tmp_roll_wgt_a = 990;
								var tmp_roll_wgt_c = 702;
								var tmp_roll_wgt_b = 857;
							
							}
						
							
							var    car_c =  datagrid1.valueMatrix(row, 19);   
							var    car_b =  datagrid1.valueMatrix(row, 20);   
							//datagrid1.valueMatrix(row, 16) = car_c;	
							
							var rv_bf_dt = datagrid1.valueMatrix(row,38);
							var rv_medi_cd = datagrid1.valueMatrix(row,39);
							var rv_sect_cd = datagrid1.valueMatrix(row,40);
							
//							if(car_c !=""){
								datagrid1.valueMatrix(row, 18) = car_b;
								datagrid1.valueMatrix(row, 16) =Math.round((car_cnt * tmp_roll_cnt_a) + tmp_rct  - (datagrid1.valueMatrix(row, 19) / 2) - (datagrid1.valueMatrix(row, 20)*3/4)) ;	
//								datagrid1.valueMatrix(row, 13) = Math.round(((car_cnt * tmp_roll_cnt_a) + tmp_rct  - (datagrid1.valueMatrix(row, 19) / 2) - (datagrid1.valueMatrix(row, 20)*3/4)) * tmp_roll_wgt_a);	  
//								datagrid1.valueMatrix(row, 14) = datagrid1.valueMatrix(row, 19) * tmp_roll_wgt_c;
//								datagrid1.valueMatrix(row, 15) = datagrid1.valueMatrix(row, 20) * tmp_roll_wgt_b;
//											
								datagrid1.valueMatrix(row, 16) =Math.round((car_cnt * tmp_roll_cnt_a) + tmp_rct - (datagrid1.valueMatrix(row, 19) / 2) - (datagrid1.valueMatrix(row, 20)*3/4)) ;	
								datagrid1.valueMatrix(row, 13) = Math.round(((car_cnt * tmp_roll_cnt_a) + tmp_rct  - (datagrid1.valueMatrix(row, 19) / 2) - (datagrid1.valueMatrix(row, 20)*3/4)) * tmp_roll_wgt_a);	  
								datagrid1.valueMatrix(row, 14) = datagrid1.valueMatrix(row, 19) * tmp_roll_wgt_c;
								datagrid1.valueMatrix(row, 15) = datagrid1.valueMatrix(row, 20) * tmp_roll_wgt_b;
								datagrid1.valueMatrix(row, 17) = car_c;
								
								var rv_bf_dt = datagrid1.valueMatrix(row,38);
								var rv_issu_dt = datagrid1.valueMatrix(row,2);
								var rv_medi_cd = datagrid1.valueMatrix(row,39);
								var rv_sect_cd = datagrid1.valueMatrix(row,40);
								
//									var tot_ewh_wgt_c = 0;
//									var tot_bal_wgt_c = 0;
//									var rv_use_c =  0;
//									var rv_bal_ewh_c = 0;
//									
								var rv_use_a =  0;
								var rv_bal_ewh_a = 0;
								var rv_wgt_a = 0;
								var rv_kk_a = 0;
								var rv_use_c =  0;
								var rv_bal_ewh_c = 0;
								var rv_wgt_c = 0;
								var rv_kk_c = 0;
								var rv_use_b =  0;
								var rv_bal_ewh_b = 0;
								var rv_wgt_b = 0;
								var rv_kk_b = 0;
								
								
								for (var i=row; i<rows+1; i++){
									
									var tot_ewh_wgt_a = 0;
									var tot_ewh_wgt_c = 0;
									var tot_ewh_wgt_b = 0;
									var tot_ewh_cnt_a = 0;
									var tot_ewh_cnt_c = 0;
									var tot_ewh_cnt_b = 0;
									
									//입고
									for( var j = i-10 ; j<i+5 ; j++)
									{
										if (datagrid1.valueMatrix(j,2) == datagrid1.valueMatrix( i,2)){
										
											if(datagrid1.valueMatrix(j,47) != "10")
											{
												if(datagrid1.valueMatrix(j,13)>0){
													tot_ewh_wgt_a = Number(tot_ewh_wgt_a) + Number(datagrid1.valueMatrix(j,13)); 
													tot_ewh_wgt_c = Number(tot_ewh_wgt_c) + Number(datagrid1.valueMatrix(j,14)); 
													tot_ewh_wgt_b = Number(tot_ewh_wgt_b) + Number(datagrid1.valueMatrix(j,15)); 
													tot_ewh_cnt_a = Number(tot_ewh_cnt_a) + Number(datagrid1.valueMatrix(j,16)); 
													tot_ewh_cnt_c = Number(tot_ewh_cnt_c) + Number(datagrid1.valueMatrix(j,17)); 
													tot_ewh_cnt_b = Number(tot_ewh_cnt_b) + Number(datagrid1.valueMatrix(j,18)); 
												}
											}
										}
										
									}
								
										if (datagrid1.valueMatrix(i,2) == rv_issu_dt){
											
											if(datagrid1.valueMatrix(i,47) == "10")
											{
												datagrid1.valueMatrix(i,13) = tot_ewh_wgt_a;
												datagrid1.valueMatrix(i,14) = tot_ewh_wgt_c;
												datagrid1.valueMatrix(i,15) = tot_ewh_wgt_b;
												datagrid1.valueMatrix(i,16) = tot_ewh_cnt_a;
												datagrid1.valueMatrix(i,17) = tot_ewh_cnt_c;
												datagrid1.valueMatrix(i,18) = tot_ewh_cnt_b;
												
												var tot_bal_wgt_a = datagrid1.valueMatrix(i, 22);
												var tot_bal_wgt_c = datagrid1.valueMatrix(i, 23);
												var tot_bal_wgt_b = datagrid1.valueMatrix(i, 24);
												
												//당일아침잔고+입고
												datagrid1.valueMatrix(i,29) =  Number(tot_bal_wgt_a) + Number(tot_ewh_wgt_a);
												datagrid1.valueMatrix(i,30) =  Number(tot_bal_wgt_c) + Number(tot_ewh_wgt_c);
												datagrid1.valueMatrix(i,31) =  Number(tot_bal_wgt_b) + Number(tot_ewh_wgt_b);
												datagrid1.valueMatrix(i,51) =  Math.round((Number(tot_bal_wgt_a) + Number(tot_ewh_wgt_a)) / Number(tmp_roll_wgt_a));
												datagrid1.valueMatrix(i,52) =  Math.round((Number(tot_bal_wgt_c) + Number(tot_ewh_wgt_c)) / Number(tmp_roll_wgt_c));
												datagrid1.valueMatrix(i,53) =  Math.round((Number(tot_bal_wgt_b) + Number(tot_ewh_wgt_b)) / Number(tmp_roll_wgt_b));
												rv_wgt_a = datagrid1.valueMatrix(i,29);
												rv_wgt_c = datagrid1.valueMatrix(i,30);
												rv_wgt_b = datagrid1.valueMatrix(i,31);
												model.setValue("/root/resData/tempEwh_a",rv_wgt_a);
												model.setValue("/root/resData/tempEwh_c",rv_wgt_c);
												model.setValue("/root/resData/tempEwh_b",rv_wgt_b);
												
											}
											
											
										}
									
									
								
									
								}
//							}
							
						}
					}
					function makeTable(){
						var add_prt_seq = "";
						var n = 0;
						//datagrid1.mergecells = "byrestriccol";
						
						datagrid1.mergeCol(1) = true;
						datagrid1.mergeCol(2) = true;  
						datagrid1.mergeCol(3) = true;  
						datagrid1.merge();
						var merge_row = 0;
							
						datagrid1.allStyle("data", "background-color") = "#FFFFFF";
						//datagrid1.allStyle("data", "border-bottom-width") = "1px";
						//datagrid1.allStyle("data", "border-bottom-color") = "#c0c0c0";
						datagrid1.cellStyle("border-bottom-width", 0, -1, datagrid1.rows, 53) = "1px";
						datagrid1.cellStyle("border-bottom-color", 0, -1, datagrid1.rows, 53) = "#c0c0c0";
						
						for (var i=2; i<datagrid1.rows; i++){
							if (datagrid1.valueMatrix(i,2) != datagrid1.valueMatrix(i,32)){
								if(datagrid1.valueMatrix(i,3) !=""){
									datagrid1.cellStyle("background-color", i, 4, i, 9) = "#FFAAFF";
								}
							}
							if (add_prt_seq == ""){
								add_prt_seq = datagrid1.valueMatrix(i, 36);
							} else {
								if (add_prt_seq == datagrid1.valueMatrix(i, 36)){
									datagrid1.mergeByFree((i-1), 32, i, 32);
									datagrid1.mergeByFree((i-1), 33, i, 33);
									datagrid1.mergeByFree((i-1), 34, i, 34);
									datagrid1.mergeByFree((i-1), 35, i, 35);
									datagrid1.mergeByFree((i-1), 36, i, 36);
									datagrid1.mergeByFree((i-1), 37, i, 37);
								}
								
								n = eval((0x00ee00).toString(10));
								n = n + ((eval(add_prt_seq) -1) * 127);
								//datagrid1.rowStyle(i-1, "data", "background-color") = "#00" + n.toString(16);
								datagrid1.cellStyle("background-color", i-1, 4, i, 9) = "#00" + n.toString(16);
								
								if (datagrid1.valueMatrix(i,2) != datagrid1.valueMatrix(i, 32)){
									datagrid1.cellStyle("background-color", (i-1), 32, i, 34) = "#FFAAFF";
								}
								
								if (i== datagrid1.rows - 1){
									//datagrid1.rowStyle(i, "data", "background-color") = "#00" + n.toString(16);
									datagrid1.cellStyle("background-color", i-1, 4, i, 9) = "#00" + n.toString(16);
									if (datagrid1.valueMatrix(i,2) != datagrid1.valueMatrix(i, 32)){
										datagrid1.cellStyle("background-color", (i-1), 32, i, 34) = "#FFAAFF";
									}
								}
							}
							add_prt_seq = datagrid1.valueMatrix(i, 36);
							var rv_use_a = datagrid1.valueMatrix(i, 10);
							var rv_use_c = datagrid1.valueMatrix(i, 11);
							var rv_use_b = datagrid1.valueMatrix(i, 12);
							var rv_bf_bal_wgt_a = datagrid1.valueMatrix(i,48);
							var rv_bf_bal_wgt_c = datagrid1.valueMatrix(i,49);
							var rv_bf_bal_wgt_b = datagrid1.valueMatrix(i,50);
							var tot_rv_use_a = 0;
							var bf_tot_ewh_a = 0;
							var bf_tot_ewh_c = 0;
							var bf_tot_ewh_b = 0;
							var tot_ewh_a = 0;
							var tot_ewh_c = 0;
							var tot_ewh_b = 0;
							var bf_bal_ewh_a = 0;
							var bf_bal_ewh_c = 0;
							var bf_bal_ewh_b = 0;
							var bf_wgt_a = 0;
							var bf_wgt_c = 0;
							var bf_wgt_b = 0;
							var fac_clsf = model.getValue("/root/reqData/searchData/fac_clsf");
							var row_num = datagrid1.valueMatrix(i, 47);
						
							if(fac_clsf == "10"){
								if(row_num =="1"){
									var tmp_roll_cnt_a = 9;
									var tmp_roll_wgt_a = 1455;
									var tmp_roll_wgt_c = 727;
									var tmp_roll_wgt_b = 1091;
								}else if(row_num =="3")
								{
									var tmp_roll_cnt_a = 6;
									var tmp_roll_wgt_a = 1455;
									var tmp_roll_wgt_c = 727;
									var tmp_roll_wgt_b = 1091;
								}
								
							
							}
							else if(fac_clsf == "22"){
								
								var tmp_roll_cnt_a = 15;
								var tmp_roll_wgt_a = 1404;
								var tmp_roll_wgt_c = 702;
								var tmp_roll_wgt_b = 1053;
							
							}
							else if(fac_clsf == "25"){
								var tmp_roll_cnt_a = 15;
								var tmp_roll_wgt_a = 1455;
								var tmp_roll_wgt_c = 727;
								var tmp_roll_wgt_b = 1091;
							
							}
							else if(fac_clsf == "35"){
								var tmp_roll_cnt_a = 17;
								var tmp_roll_wgt_a = 1143;
								var tmp_roll_wgt_c = 571;
								var tmp_roll_wgt_b = 857;
							
							}
							else if(fac_clsf == "65"){
								var tmp_roll_cnt_a = 10;
								var tmp_roll_wgt_a = 1404;
								var tmp_roll_wgt_c = 702;
								var tmp_roll_wgt_b = 857;
							
							}
							else if(fac_clsf == "75"){
								var tmp_roll_cnt_a = 9;
								var tmp_roll_wgt_a = 990;
								var tmp_roll_wgt_c = 702;
								var tmp_roll_wgt_b = 857;
							
							}
							if(datagrid1.valueMatrix(i,datagrid1.colRef("remk")) == "A"){
								datagrid1.cellStyle("background-color", i, 10, i, 12) = "#FAF4C0";	
							}
							
							datagrid1.cellStyle("background-color", i, 16, i, 18) = "#FAF4C0";
							datagrid1.cellStyle("background-color", i, 26, i, 28) = "#FAF4C0";
							datagrid1.cellStyle("background-color", i, 51, i, 53) = "#FAF4C0";		
							if(datagrid1.valueMatrix(i,47) == "10")
							{
								//datagrid1.rowStyle(i, "data", "background-color") = "#AAAAFF";
								//datagrid1.cellStyle("background-color", i, 16, i, 18) = "#AAAAFF";
								datagrid1.cellStyle("background-color", i, 26, i, 28) = "#AAAAFF";
								datagrid1.cellStyle("background-color", i, 51, i, 53) = "#AAAAFF";	
								datagrid1.cellStyle("font-weight", i, 16, i, 18) = "bold";
								datagrid1.cellStyle("font-weight", i, 26, i, 28) = "bold";
								datagrid1.cellStyle("font-weight", i, 51, i, 53) = "bold";
								datagrid1.cellStyle("font-size", i, 16, i, 18) = "15";
								datagrid1.cellStyle("font-size", i, 26, i, 28) = "15";
								datagrid1.cellStyle("font-size", i, 51, i, 53) = "15";
								datagrid1.cellStyle("border-bottom-width", i, 0, i, 53) = "2px";
								datagrid1.cellStyle("border-bottom-color", i, 0, i, 53) = "#000000";
								if(commGetDay(datagrid1.valueMatrix(i,2))=="일"){
									//datagrid1.cellStyle("background-color", i, 16, i, 18) = "#00EE00";
									datagrid1.cellStyle("background-color", i, 26, i, 28) = "#00EE00";
									datagrid1.cellStyle("background-color", i, 51, i, 53) = "#00EE00";	
								}
								var bfday = dateAdd("d", -1, getCurrentDate());
							
//								if(datagrid1.valueMatrix(i,2) != bfday)
//								{
//									
									if(datagrid1.valueMatrix(i, 54) != "Y")
									{	
										
	//									if(rv_bf_bal_wgt_a > 0){
											
											for( var j = i-10 ; j<i ; j++)
											{
												if(datagrid1.valueMatrix(j,47) == "10")
												{
													
													
													bf_wgt_a = datagrid1.valueMatrix(j,29);
													bf_wgt_c = datagrid1.valueMatrix(j,30);
													bf_wgt_b = datagrid1.valueMatrix(j,31);
												
													//alert(datagrid1.valueMatrix(j,46));
												}
												
											}
											if(i<12){
												bf_wgt_a = datagrid1.valueMatrix(j,48);
												bf_wgt_c = datagrid1.valueMatrix(j,49);
												bf_wgt_b = datagrid1.valueMatrix(j,50);
											}
											//datagrid1.valueMatrix(i, 10) = tot_rv_use_a ;
//											datagrid1.valueMatrix(i, 22) = bf_wgt_a;
//											datagrid1.valueMatrix(i, 23) = bf_wgt_c;
//											datagrid1.valueMatrix(i, 24) = bf_wgt_b;
	//										datagrid1.valueMatrix(i, 25) = Number(bf_wgt_a)+ Number(bf_wgt_b)+ Number(bf_wgt_c);
											datagrid1.valueMatrix(i, 22) = bf_wgt_a - Number(rv_use_a);
											datagrid1.valueMatrix(i, 23) = bf_wgt_c - Number(rv_use_c);
											datagrid1.valueMatrix(i, 24) = bf_wgt_b - Number(rv_use_b);
											datagrid1.valueMatrix(i, 25) = Number(bf_wgt_a) - Number(rv_use_a) + Number(bf_wgt_c) - Number(rv_use_c) + Number(bf_wgt_b) - Number(rv_use_b);
											//alert(Number(bf_tot_ewh_a) + Number(bf_bal_ewh_a) - Number(rv_use_a));
											//datagrid1.valueMatrix(i, 21) = Number(rv_bf_bal_wgt_a) - Number(rv_use_a);
											//datagrid1.valueMatrix(i, 22) = Number(rv_bf_bal_wgt_c) - Number(rv_use_c);
											//datagrid1.valueMatrix(i, 23) = Number(rv_bf_bal_wgt_b) - Number(rv_use_b);
											//datagrid1.valueMatrix(i, 24) = Number(rv_bf_bal_wgt_a) - Number(rv_use_a) + Number(rv_bf_bal_wgt_c) - Number(rv_use_c) + Number(rv_bf_bal_wgt_b) - Number(rv_use_b);
											
											
											datagrid1.valueMatrix(i, 26) = Math.round((Number(bf_wgt_a)- Number(rv_use_a))/tmp_roll_wgt_a);
											datagrid1.valueMatrix(i, 27) = Math.round((Number(bf_wgt_c)- Number(rv_use_c))/tmp_roll_wgt_c);
											datagrid1.valueMatrix(i, 28) = Math.round((Number(bf_wgt_b) - Number(rv_use_b))/tmp_roll_wgt_b);
//											datagrid1.valueMatrix(i, 26) = Math.round(Number(bf_wgt_a)/tmp_roll_wgt_a);
//											datagrid1.valueMatrix(i, 27) = Math.round(Number(bf_wgt_c)/tmp_roll_wgt_c);
//											datagrid1.valueMatrix(i, 28) = Math.round(Number(bf_wgt_b)/tmp_roll_wgt_b);
											
	//										datagrid1.valueMatrix(i, 25) = Math.round((Number(rv_bf_bal_wgt_a) - Number(rv_use_a))/tmp_roll_wgt_a);
	//										datagrid1.valueMatrix(i, 26) = Math.round((Number(rv_bf_bal_wgt_c) - Number(rv_use_c))/tmp_roll_wgt_c);
	//										datagrid1.valueMatrix(i, 27) = Math.round((Number(rv_bf_bal_wgt_b) - Number(rv_use_b))/tmp_roll_wgt_b);
//												
											tot_ewh_a = datagrid1.valueMatrix(i, 13);
											tot_ewh_c = datagrid1.valueMatrix(i, 14);
											tot_ewh_b = datagrid1.valueMatrix(i, 15);	
											//alert(Number(tot_ewh_a) +"_"+Number(bf_wgt_a)  +"_"+ Number(rv_use_a));
											datagrid1.valueMatrix(i, 29) = Number(tot_ewh_a) +Number(bf_wgt_a) - Number(rv_use_a);
											datagrid1.valueMatrix(i, 30) = Number(tot_ewh_c) +Number(bf_wgt_c) - Number(rv_use_c);
											datagrid1.valueMatrix(i, 31) = Number(tot_ewh_b) +Number(bf_wgt_b) - Number(rv_use_b);
											
	//										datagrid1.valueMatrix(i, 28) = Number(datagrid1.valueMatrix(i, 12)) +Number(rv_bf_bal_wgt_a) - Number(rv_use_a);
	//										datagrid1.valueMatrix(i, 29) = Number(datagrid1.valueMatrix(i, 13)) +Number(rv_bf_bal_wgt_c) - Number(rv_use_c);
	//										datagrid1.valueMatrix(i, 30) = Number(datagrid1.valueMatrix(i, 14)) +Number(rv_bf_bal_wgt_b) - Number(rv_use_b);
											
											datagrid1.valueMatrix(i, 51) = Math.round((Number(datagrid1.valueMatrix(i, 13)) +Number(bf_wgt_a) - Number(rv_use_a))/tmp_roll_wgt_a);
											datagrid1.valueMatrix(i, 52) = Math.round((Number(datagrid1.valueMatrix(i, 14)) +Number(bf_wgt_c) - Number(rv_use_c))/tmp_roll_wgt_c);
											datagrid1.valueMatrix(i, 53) = Math.round((Number(datagrid1.valueMatrix(i, 15)) +Number(bf_wgt_b) - Number(rv_use_b))/tmp_roll_wgt_b);
											
											//datagrid1.valueMatrix(i, 50) = Math.round((Number(datagrid1.valueMatrix(i, 12)) +Number(rv_bf_bal_wgt_a) - Number(rv_use_a))/tmp_roll_wgt_a);
	//										datagrid1.valueMatrix(i, 50) = Math.round((Number(datagrid1.valueMatrix(i, 12)) +Number(rv_bf_bal_wgt_a) - Number(rv_use_a))/tmp_roll_wgt_a);
	//										datagrid1.valueMatrix(i, 51) = Math.round((Number(datagrid1.valueMatrix(i, 13)) +Number(rv_bf_bal_wgt_c) - Number(rv_use_c))/tmp_roll_wgt_c);
	//										datagrid1.valueMatrix(i, 52) = Math.round((Number(datagrid1.valueMatrix(i, 14)) +Number(rv_bf_bal_wgt_b) - Number(rv_use_b))/tmp_roll_wgt_b);
	//									}else{
	//										if( i>5 )
	//										{
	//											for( var j = i-10 ; j<i ; j++)
	//											{
	//												if(datagrid1.valueMatrix(j,47) == "10")
	//												{
	//													bf_tot_ewh_a = datagrid1.valueMatrix(j,13);
	//													bf_tot_ewh_c = datagrid1.valueMatrix(j,14);
	//													bf_tot_ewh_b = datagrid1.valueMatrix(j,15);
	//													bf_bal_ewh_a = datagrid1.valueMatrix(j,22);
	//													bf_bal_ewh_c = datagrid1.valueMatrix(j,23);
	//													bf_bal_ewh_b = datagrid1.valueMatrix(j,24);
	//													
	//													//alert(datagrid1.valueMatrix(j,46));
	//												}
	//												
	//											}
	//											datagrid1.valueMatrix(i, 22) = Number(bf_tot_ewh_a) + Number(bf_bal_ewh_a) - Number(rv_use_a);
	//											datagrid1.valueMatrix(i, 23) = Number(bf_tot_ewh_c) + Number(bf_bal_ewh_c) - Number(rv_use_c);
	//											datagrid1.valueMatrix(i, 24) = Number(bf_tot_ewh_b) + Number(bf_bal_ewh_b) - Number(rv_use_b);
	//											datagrid1.valueMatrix(i, 25) = Number(bf_tot_ewh_a) + Number(bf_bal_ewh_a) - Number(rv_use_a) +Number(bf_tot_ewh_c) + Number(bf_bal_ewh_c) - Number(rv_use_c)+ Number(bf_tot_ewh_b) + Number(bf_bal_ewh_b) - Number(rv_use_b);
	//											
	//											
	//											datagrid1.valueMatrix(i, 26) = Math.round((Number(bf_tot_ewh_a) + Number(bf_bal_ewh_a) - Number(rv_use_a)) / Number(tmp_roll_wgt_a)) ;
	//											datagrid1.valueMatrix(i, 27) = Math.round((Number(bf_tot_ewh_c) + Number(bf_bal_ewh_c) - Number(rv_use_c)) / Number(tmp_roll_wgt_c)) ;
	//											datagrid1.valueMatrix(i, 28) = Math.round((Number(bf_tot_ewh_b) + Number(bf_bal_ewh_b) - Number(rv_use_b)) / Number(tmp_roll_wgt_b)) ;
	//											
	//											datagrid1.valueMatrix(i, 29) = Number(bf_tot_ewh_a) + Number(bf_bal_ewh_a) - Number(rv_use_a);
	//											datagrid1.valueMatrix(i, 30) = Number(bf_tot_ewh_c) + Number(bf_bal_ewh_c) - Number(rv_use_c);
	//											datagrid1.valueMatrix(i, 31) = Number(bf_tot_ewh_b) + Number(bf_bal_ewh_b) - Number(rv_use_b);
	//											
	//											
	//											datagrid1.valueMatrix(i, 51) = Math.round((Number(bf_tot_ewh_a) + Number(bf_bal_ewh_a) - Number(rv_use_a)) / Number(tmp_roll_wgt_a)) ;
	//											datagrid1.valueMatrix(i, 52) = Math.round((Number(bf_tot_ewh_c) + Number(bf_bal_ewh_c) - Number(rv_use_c)) / Number(tmp_roll_wgt_c)) ;
	//											datagrid1.valueMatrix(i, 53) = Math.round((Number(bf_tot_ewh_b) + Number(bf_bal_ewh_b) - Number(rv_use_b)) / Number(tmp_roll_wgt_b)) ;
	//										}
	//									}
									}
									
//								}
								
							}
							for(var j=1; j<datagrid1.cols; j++){
						
								if(datagrid1.valueMatrix(i,j) =="0"){
									datagrid1.valueMatrix(i,j) = "";
								}
							}
						}
						
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					model.setValue("/root/reqData/searchData/occr_yymm", getDate("yyyymm"));
					
					model.setValue("/root/reqData/searchData/search_dt_fr", getDate("yyyymm"));
					model.setValue("/root/reqData/searchData/search_dt_to", getDate("yyyymm"));
					
					model.send("mt_papord_8000");
					
					model.copyNode("/root/initData/comboSet/fac_clsf", "/root/tempData/fac_clsf");
					
					var nodeList		= instance1.selectNodes("/root/initData/comboSet/fac_clsf/item");
					for (var i=0; i<nodeList.length; i++){
						if (nodeList.item(i).getElementsByTagName("value").item(0).value == 'ALL'){
							model.removenode("/root/initData/comboSet/fac_clsf/item[" + (i +1) +"]");
						}
					}
					combo1.refresh();
					//combo1.select(0);
					model.setValue("/root/reqData/searchData/fac_clsf", "10");
					
					model.removenode("/root/resData/gridData/baseData/record");
					datagrid3.refresh();
					
					
					datagrid1.autoMerge = false;
					datagrid1.mergeCells = "bycol";
					for(var i=datagrid1.fixedCols;i<datagrid1.cols;i++)
					{
						datagrid1.mergeCol(i) = false;
					}
					
					button2.dispatch("onclick");
					//loadList();
				]]>
			</script>
			<submission id="mt_papord_8000" action="/mt/papord/8000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="pr_prtexec_4001" action="/mt/prtexec/4001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/ref/record"/>
			<submission id="mt_papord_8002" action="/mt/papord/8002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/main2"/>
			<submission id="mt_papord_8006" action="/mt/papord/8006" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papord_8008" action="/mt/papord/8008" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papord_8003" action="/mt/papord/8003" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papord_8004" action="/mt/papord/8004" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/gridData/main"/>
			<submission id="mt_papord_8005" action="/mt/papord/8005" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchCode" resultref="/root/tempData"/>
			<submission id="mt_papord_8007" action="/mt/papord/8007" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_papord_8009" action="/mt/papord/8009" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm2" resultref="/root/tempData"/>
			<submission id="pr_prtexec_4004" action="/mt/prtexec/4004" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/main1/record"/>
			<submission id="mt_papord_8201" action="/mt/papord/8201" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/rate/dataSet"/>
		</model>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/mt_common.js"/>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="1530" pageheight="875" guideline="2,755;1,9;2,54;2,72;2,77;1,1125;" style="font-family:굴림; ">
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:1104px; height:29px; "/>
		<group id="group_scr" class="gro_sel" style="left:9px; top:68px; width:926px; height:27px; ">
			<caption id="caption2" class="list_cap01" style="left:0px; top:0px; width:100px; height:26px; text-align:center; ">공장</caption>
			<caption id="caption6" class="list_cap02" style="left:99px; top:0px; width:361px; height:26px; text-align:center; "/>
			<caption id="caption1" class="list_cap01" style="left:459px; top:0px; width:100px; height:26px; text-align:center; ">발행년월</caption>
			<caption id="caption3" class="list_cap02" style="left:558px; top:0px; width:367px; height:26px; text-align:center; "/>
			<input id="input2" ref="/root/reqData/searchData/occr_yymm" format="yyyy-mm" style="left:565px; top:4px; width:100px; height:18px; "/>
			<select1 id="combo1" ref="/root/reqData/searchData/fac_clsf" appearance="minimal" style="left:105px; top:4px; width:135px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fac_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						
					button2.dispatch("onclick");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
//						datagrid1.autoMerge = false;
//						datagrid1.mergeCells = "bycol";
//						for(var i=datagrid1.fixedCols;i<datagrid1.cols;i++)
//						{
//							datagrid1.mergeCol(i) = false;
//						}
//						
//						loadList();
					]]>
				</script>
			</select1>
		</group>
		<group id="group_btnG2" class="gro_btn" style="left:370px; top:100px; width:569px; height:119px; ">
			<datagrid id="datagrid4" nodeset="/root/resData/gridData/ref/record" visibility="hidden" caption="구분^caption1^caption2^caption3^caption4" colsep="^" colwidth="100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowsep="|" selectionmode="free" style="left:0px; top:0px; width:569px; height:110px; ">
				<col ref="occr_dt"/>
				<col ref="pap_row"/>
				<col ref="car_cnt_c"/>
				<col ref="car_cnt_b"/>
				<col ref="car_cnt_a"/>
			</datagrid>
		</group>
		<group id="group3" style="left:10px; top:41px; width:1104px; height:28px; ">
			<button id="button2" class="btn02" style="left:875px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
					
					
					
					
					model.send("mt_papord_8003");
					model.copyNode("/root/resData/gridData/baseData", "/root/tempData");
					datagrid3.refresh();
					
					model.send("mt_papord_8006");
					model.copyNode("/root/resData/gridData/max", "/root/tempData/gridData");
					
					datagrid2.refresh();
					
					model1.send("mt_papord_8201");
					//model1.copyNode("/root/resData/gridData/rate/rocord","/root/tempData/dataSet/CURLIST/rocord");
								
					datagrid5.refresh();
					
					model1.refresh();
					//datagrid4.rows = 2;
					//datagrid2.rows = 1;
					model.removenode("/root/resData/gridData/main2");
					model.makeNode("/root/resData/gridData/main2/record");
					datagrid1.refresh();
					
					for(var i = 0 ; i < 7 ; i++){
					
						var bfday = dateAdd("d", -i, getCurrentDate());
						if(commGetDay(bfday) =="월"){
							
							model.setValue("/root/reqData/searchData/issu_dt_fr", bfday);
							var todt	=	dateAdd("d", 7, bfday);
						}
					}

					//datagrid3.refresh();
					model.setValue("/root/reqData/searchData/issu_dt_to", todt);
					
					model.send("mt_papord_8007");
					
					
					model.send("mt_papord_8002");
					datagrid1.refresh();
//						
//						for (var i=1; i<datagrid3.rows+1; i++){
//							if (datagrid3.valueMatrix(i,3) == todt){
//								
//								   datagrid3.isselected(i) = true;
//							}
//							
//						}
					makeTable();
				]]>
				</script>
			</button>
			<button id="button3" class="btn02" style="left:986px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model1.reset();
					//datagrid4.rows= 2;
					datagrid1.removeRow(true);
					//datagrid2.rows= 1;
				]]>
				</script>
			</button>
			<button id="btnA4" class="btn02" style="left:1042px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
			      viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
			     ]]>
				</script>
			</button>
			<button id="button1" class="btn02" visibility="hidden" style="left:800px; top:0px; width:52px; height:21px; ">
				<caption>인쇄</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					//alert("장표 출력");
					model1.copyNode("/root/reqData/fwdData/fac_clsf", "/root/initData/comboSet/fac_clsf");
					create_report("MT_REPORT_4000.xrw");
				]]>
				</script>
			</button>
		</group>
		<group id="group2" style="left:10px; top:100px; width:349px; height:121px; ">
			<datagrid id="datagrid3" nodeset="/root/resData/gridData/baseData/record" caption="발행주^시작일자^종료일자^확정구분" colsep="^" colwidth="65, 82, 82, 80, 70" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:0px; top:0px; width:349px; height:105px; ">
				<col ref="occr_yy"/>
				<col ref="frdt" format="yyyy-mm-dd"/>
				<col ref="todt" format="yyyy-mm-dd"/>
				<col ref="fix_clsf_nm"/>
				<col ref="fix_clsf" visibility="hidden"/>
				<col ref="seq" visibility="hidden"/>
				<script type="javascript" ev:event="ondblclick">
					<![CDATA[
						
						model.removenode("/root/resData/gridData/main2");
						model.makeNode("/root/resData/gridData/main2/record");
						datagrid1.refresh();
						
						
						var selectValue = "";
						var n = 0;
						selectValue = datagrid3.valueMatrix(datagrid3.row, 2);
						model.setValue("/root/reqData/searchData/issu_dt_fr", selectValue);
						
						selectValue = datagrid3.valueMatrix(datagrid3.row, 3);
						model.setValue("/root/reqData/searchData/issu_dt_to", selectValue);
						
//						model.send("pr_prtexec_4001");
//						
//						datagrid4.initStyle("background-color");
//						
//						for (var i=2; i<datagrid4.rows;i++){
//							for (var ii=0; ii<datagrid4.cols;ii++){
//								if (datagrid4.valueMatrix(i, ii) == "Y"){
//									n = eval((0x00ee00).toString(10));
//									//alert(n);
//									n = n + ((eval(datagrid4.valueMatrix(i, ii + 1)) -1) * 127);
//									//alert(n.toString(16));
//									datagrid4.cellstyle("background-color", i, ii -1) = "#00" + n.toString(16);
//
//									if (datagrid4.valueMatrix(i, ii + 1) == "001"){
//										datagrid4.cellstyle("background-color", i, ii -1) = "#00FF00";
//									}
//								}
//							}
//						}
						
						model.send("mt_papord_8002");
						datagrid1.refresh();
						makeTable();
					]]>
				</script>
			</datagrid>
			<caption id="caption21" style="left:0px; top:105px; width:224px; height:15px; font-weight:bold; text-align:left; vertical-align:middle; background-color:#eaeaea; ">※ 조회할 기간을 더블클릭 하세요.</caption>
		</group>
		<group id="group5" class="gro_btn" style="left:10px; top:235px; width:1374px; height:610px; ">
			<datagrid id="datagrid1" nodeset="/root/resData/gridData/main2/record" caption="발행일자^발행일자^매체^섹션^양출구분^규격^면수^칼라면수^부수^사용량^사용량^사용량^입고량^입고량^입고량^입고롤^입고롤^입고롤^발주 차량 대수^발주 차량 대수^발주 차량 대수^아침 잔고량^아침 잔고량^아침 잔고량^아침 잔고량^아침 잔고롤^아침 잔고롤^아침 잔고롤^아침 잔고+입고량^아침 잔고+입고량^아침 잔고+입고량^인쇄일자^인쇄시각^시간외^양출구분^합쇄구분^참고사항^caption1^caption2^caption3^caption4^caption5^caption6^caption7^caption8^caption9^caption10^caption11^caption12^caption13^아침 잔고+입고롤^아침 잔고+입고롤^아침 잔고+입고롤^caption14^caption16^참고사항|발행일자^발행일자^매체^섹션^양출구분^규격^면수^칼라면수^부수^A^C^B^A^C^B^A^C^B^C^B^차량수^A^C^B^계^A^C^B^A^C^B^인쇄일자^인쇄시각^시간외^양출구분^합쇄구분^참고사항^caption1^caption2^caption3^caption4^caption5^caption6^caption7^caption8^caption9^caption10^caption11^caption12^caption13^A^C^B^caption14^caption16^참고사항" colsep="#" colwidth="63, 47, 39, 66, 47, 50, 34, 50, 67, 50, 50, 50, 50, 50, 50, 36, 35, 35, 32, 32, 39, 48, 48, 49, 51, 35, 35, 35, 49, 42, 42, 90, 65, 70, 51, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 43, 42, 42, 100, 100" frozencols="1" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="free" style="left:0px; top:5px; width:1369px; height:605px; ">
				<col ref="issu_dt_day"/>
				<col ref="issu_dt" visibility="hidden" format="yyyy-mm-dd"/>
				<col ref="medi_nm"/>
				<col ref="sect_nm"/>
				<col ref="dual_out_clsf" type="combo" style="text-align:left; ">
					<choices>
						<item>
							<label>양출</label>
							<value>01</value>
						</item>
						<item>
							<label>편출</label>
							<value>02</value>
						</item>
						<item>
							<label>양편출</label>
							<value>03</value>
						</item>
					</choices>
				</col>
				<col ref="std" visibility="hidden"/>
				<col ref="pcnt" type="input" format="(-)#,###"/>
				<col ref="clr_pcnt" visibility="hidden"/>
				<col ref="slip_qty" type="input" format="(-)#,###"/>
				<col ref="use_a" type="input" format="(-)#,###"/>
				<col ref="use_c" type="input" format="(-)#,###"/>
				<col ref="use_b" type="input" format="(-)#,###"/>
				<col ref="ewh_wgt_a" format="(-)#,###"/>
				<col ref="ewh_wgt_c" format="(-)#,###"/>
				<col ref="ewh_wgt_b" format="(-)#,###"/>
				<col ref="ewh_roll_a" format="(-)#,###"/>
				<col ref="ewh_roll_c" format="(-)#,###"/>
				<col ref="ewh_roll_b" format="(-)#,###"/>
				<col ref="car_c" type="input"/>
				<col ref="car_b" type="input"/>
				<col ref="car_cnt" type="input"/>
				<col ref="bal_wgt_a" format="(-)#,###"/>
				<col ref="bal_wgt_c" format="(-)#,###"/>
				<col ref="bal_wgt_b" format="(-)#,###"/>
				<col ref="bal_wgt_tot" visibility="hidden" format="(-)#,###"/>
				<col ref="bal_roll_a" format="(-)#,###"/>
				<col ref="bal_roll_c" format="(-)#,###"/>
				<col ref="bal_roll_b" format="(-)#,###"/>
				<col ref="wgt_a" format="(-)#,###"/>
				<col ref="wgt_c" format="(-)#,###"/>
				<col ref="wgt_b" format="(-)#,###"/>
				<col ref="prt_dt" visibility="hidden" format="yyyy-mm-dd"/>
				<col ref="prt_tm" visibility="hidden" format="hh:nn"/>
				<col ref="tm_in_yn" visibility="hidden"/>
				<col ref="dual_out_nm" visibility="hidden"/>
				<col ref="add_prt_seq" visibility="hidden"/>
				<col ref="remk" visibility="hidden"/>
				<col ref="bf_dt" visibility="hidden"/>
				<col ref="medi_cd" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<col ref="roll_wgt_a" visibility="hidden"/>
				<col ref="roll_wgt_b" visibility="hidden"/>
				<col ref="roll_wgt_c" visibility="hidden"/>
				<col ref="roll_cnt_a" visibility="hidden"/>
				<col ref="roll_cnt_b" visibility="hidden"/>
				<col ref="roll_cnt_c" visibility="hidden"/>
				<col ref="row_num" visibility="hidden"/>
				<col ref="bf_bal_wgt_a" visibility="hidden"/>
				<col ref="bf_bal_wgt_c" visibility="hidden"/>
				<col ref="bf_bal_wgt_b" visibility="hidden"/>
				<col ref="roll_a" format="(-)#,###"/>
				<col ref="roll_c" format="(-)#,###"/>
				<col ref="roll_b" format="(-)#,###"/>
				<col ref="clos_clsf" visibility="hidden"/>
				<col ref="papcmpy_cd" visibility="hidden"/>
				<script type="javascript" ev:event="onendedit">
					<![CDATA[
						var cell = datagrid1.selectedCells;
						var codeVal;
						if(cell.length < 1){
							alert("select a Cell");
							return;
						}
						
						var col = cell.item(0).col;
						var row = cell.item(0).row;
						var rows = datagrid1.rows;
						var fac_clsf = model.getValue("/root/reqData/searchData/fac_clsf");
						var row_num = datagrid1.valueMatrix(row, 47);
						var clos_clsf = datagrid1.valueMatrix(row, 54);
						var papcmpy_cd = datagrid1.valueMatrix(row, 55);
						var tmp_rct = 0;
						var issu_dt = datagrid1.valueMatrix(row,2);
						var sth = datagrid1.valueMatrix(row, col);
						
						if(issu_dt != getCurrentDate()){
							if(clos_clsf =="Y" ){
								alert("마감되었습니다.");
								//datagrid1.valueMatrix(row, col) = "";
								return;
							}
						}
						
						if(fac_clsf == "10"){
							if(row_num =="1"){
								var tmp_roll_cnt_a = 9;
								var tmp_roll_wgt_a = 1455;
								var tmp_roll_wgt_c = 727;
								var tmp_roll_wgt_b = 1091;
							}else if(row_num =="3")
							{
								var tmp_roll_cnt_a = 6;
								var tmp_roll_wgt_a = 1455;
								var tmp_roll_wgt_c = 727;
								var tmp_roll_wgt_b = 1091;
							}
							
						
						}
						else if(fac_clsf == "22"){
							
							var tmp_roll_cnt_a = 15;
							var tmp_roll_wgt_a = 1404;
							var tmp_roll_wgt_c = 702;
							var tmp_roll_wgt_b = 1053;
							
						}
						else if(fac_clsf == "25"){
							var tmp_roll_cnt_a = 15;
							var tmp_roll_wgt_a = 1455;
							var tmp_roll_wgt_c = 727;
							var tmp_roll_wgt_b = 1091;
							if(papcmpy_cd =="1102"){
								if ( sth !="" && sth !="0" ){
									tmp_rct = -6;
								}else{
									tmp_rct = 0;
								}
							}else{
								tmp_rct = 0;
							}
						}
						else if(fac_clsf == "35"){
							var tmp_roll_cnt_a = 17;
							var tmp_roll_wgt_a = 1143;
							var tmp_roll_wgt_c = 571;
							var tmp_roll_wgt_b = 857;
						
						}
						else if(fac_clsf == "65"){
							var tmp_roll_cnt_a = 10;
							var tmp_roll_wgt_a = 1404;
							var tmp_roll_wgt_c = 702;
							var tmp_roll_wgt_b = 857;
						
						}
						else if(fac_clsf == "75"){
							var tmp_roll_cnt_a = 9;
							var tmp_roll_wgt_a = 990;
							var tmp_roll_wgt_c = 702;
							var tmp_roll_wgt_b = 857;
						
						}
						
						
						switch (col){
						
							case  5 :
								model1.setValue("/root/reqData/searchCode/fac_clsf", fac_clsf);
								model1.setValue("/root/reqData/searchCode/issu_dt",  datagrid1.valueMatrix(row, datagrid1.colRef("issu_dt")));
								model1.setValue("/root/reqData/searchCode/pcnt", datagrid1.valueMatrix(row, datagrid1.colRef("pcnt")));
								model1.setValue("/root/reqData/searchCode/slip_qty", datagrid1.valueMatrix(row, datagrid1.colRef("slip_qty")));
								model1.setValue("/root/reqData/searchCode/medi_cd", datagrid1.valueMatrix(row, datagrid1.colRef("medi_cd")));
								model1.setValue("/root/reqData/searchCode/add_prt_seq", datagrid1.valueMatrix(row, datagrid1.colRef("add_prt_seq")));
								model1.setValue("/root/reqData/searchCode/dual_out_clsf", datagrid1.valueMatrix(row, datagrid1.colRef("dual_out_clsf")));
								model.send("mt_papord_8005");
								
								datagrid1.valueMatrix(row, 10) = model1.getValue("/root/tempData/CURLIST/record/use_a");
								datagrid1.valueMatrix(row, 11) = model1.getValue("/root/tempData/CURLIST/record/use_c");
								datagrid1.valueMatrix(row, 12) = model1.getValue("/root/tempData/CURLIST/record/use_b");
								
								var rv_issu_dt = datagrid1.valueMatrix(row,2);
									
								for (var i=row; i<rows+1; i++){
										
										var tot_use_wgt_a = 0;
										var tot_use_wgt_c = 0;
										var tot_use_wgt_b = 0;
										
										//입고
										for( var j = i-10 ; j<i+5 ; j++)
										{
											if (datagrid1.valueMatrix(j,2) == datagrid1.valueMatrix( i,2)){
											
												if(datagrid1.valueMatrix(j,47) != "10")
												{
														tot_use_wgt_a = Number(tot_use_wgt_a) + Number(datagrid1.valueMatrix(j,10));  
														tot_use_wgt_c = Number(tot_use_wgt_c) + Number(datagrid1.valueMatrix(j,11));  
														tot_use_wgt_b = Number(tot_use_wgt_b) + Number(datagrid1.valueMatrix(j,12));  
													
												}
											}
											
										}
										
										if (datagrid1.valueMatrix(i,2) == rv_issu_dt){
											
											if(datagrid1.valueMatrix(i,47) == "10")
											{
											datagrid1.valueMatrix(i,10) = tot_use_wgt_a;
											datagrid1.valueMatrix(i,11) = tot_use_wgt_c;
											datagrid1.valueMatrix(i,12) = tot_use_wgt_b;
											//alert(tot_use_wgt_a);
											}
										}
								}
								
								//model1.removeNodeset("/root/tempData/dataSet");
								makeTable();
								model1.refresh();
								break;
							case  7 :
								model1.setValue("/root/reqData/searchCode/fac_clsf", fac_clsf);
								model1.setValue("/root/reqData/searchCode/issu_dt",  datagrid1.valueMatrix(row, datagrid1.colRef("issu_dt")));
								model1.setValue("/root/reqData/searchCode/pcnt", datagrid1.valueMatrix(row, datagrid1.colRef("pcnt")));
								model1.setValue("/root/reqData/searchCode/slip_qty", datagrid1.valueMatrix(row, datagrid1.colRef("slip_qty")));
								model1.setValue("/root/reqData/searchCode/medi_cd", datagrid1.valueMatrix(row, datagrid1.colRef("medi_cd")));
								model1.setValue("/root/reqData/searchCode/add_prt_seq", datagrid1.valueMatrix(row, datagrid1.colRef("add_prt_seq")));
								model1.setValue("/root/reqData/searchCode/dual_out_clsf", datagrid1.valueMatrix(row, datagrid1.colRef("dual_out_clsf")));
								model.send("mt_papord_8005");
								
								datagrid1.valueMatrix(row, 10) = model1.getValue("/root/tempData/CURLIST/record/use_a");
								datagrid1.valueMatrix(row, 11) = model1.getValue("/root/tempData/CURLIST/record/use_c");
								datagrid1.valueMatrix(row, 12) = model1.getValue("/root/tempData/CURLIST/record/use_b");
								
								var rv_issu_dt = datagrid1.valueMatrix(row,2);
									
								for (var i=row; i<rows+1; i++){
										
										var tot_use_wgt_a = 0;
										var tot_use_wgt_c = 0;
										var tot_use_wgt_b = 0;
										
										//입고
										for( var j = i-10 ; j<i+5 ; j++)
										{
											if (datagrid1.valueMatrix(j,2) == datagrid1.valueMatrix( i,2)){
											
												if(datagrid1.valueMatrix(j,47) != "10")
												{
														tot_use_wgt_a = Number(tot_use_wgt_a) + Number(datagrid1.valueMatrix(j,10));  
														tot_use_wgt_c = Number(tot_use_wgt_c) + Number(datagrid1.valueMatrix(j,11));  
														tot_use_wgt_b = Number(tot_use_wgt_b) + Number(datagrid1.valueMatrix(j,12));  
													
												}
											}
											
										}
										
										if (datagrid1.valueMatrix(i,2) == rv_issu_dt){
											
											if(datagrid1.valueMatrix(i,47) == "10")
											{
											datagrid1.valueMatrix(i,10) = tot_use_wgt_a;
											datagrid1.valueMatrix(i,11) = tot_use_wgt_c;
											datagrid1.valueMatrix(i,12) = tot_use_wgt_b;
											//alert(tot_use_wgt_a);
											}
										}
								}
								
								//model1.removeNodeset("/root/tempData/dataSet");
								makeTable();
								model1.refresh();
								break;
							case  9 :
								model1.setValue("/root/reqData/searchCode/fac_clsf", fac_clsf);
								model1.setValue("/root/reqData/searchCode/issu_dt",  datagrid1.valueMatrix(row, datagrid1.colRef("issu_dt")));
								model1.setValue("/root/reqData/searchCode/pcnt", datagrid1.valueMatrix(row, datagrid1.colRef("pcnt")));
								model1.setValue("/root/reqData/searchCode/slip_qty", datagrid1.valueMatrix(row, datagrid1.colRef("slip_qty")));
								model1.setValue("/root/reqData/searchCode/medi_cd", datagrid1.valueMatrix(row, datagrid1.colRef("medi_cd")));
								model1.setValue("/root/reqData/searchCode/add_prt_seq", datagrid1.valueMatrix(row, datagrid1.colRef("add_prt_seq")));
								model1.setValue("/root/reqData/searchCode/dual_out_clsf", datagrid1.valueMatrix(row, datagrid1.colRef("dual_out_clsf")));
								model.send("mt_papord_8005");
								
								datagrid1.valueMatrix(row, 10) = model1.getValue("/root/tempData/CURLIST/record/use_a");
								datagrid1.valueMatrix(row, 11) = model1.getValue("/root/tempData/CURLIST/record/use_c");
								datagrid1.valueMatrix(row, 12) = model1.getValue("/root/tempData/CURLIST/record/use_b");
								
								var rv_issu_dt = datagrid1.valueMatrix(row,2);
									
								for (var i=row; i<rows+1; i++){
										
										var tot_use_wgt_a = 0;
										var tot_use_wgt_c = 0;
										var tot_use_wgt_b = 0;
										
										//입고
										for( var j = i-10 ; j<i+5 ; j++)
										{
											if (datagrid1.valueMatrix(j,2) == datagrid1.valueMatrix( i,2)){
											
												if(datagrid1.valueMatrix(j,47) != "10")
												{
														tot_use_wgt_a = Number(tot_use_wgt_a) + Number(datagrid1.valueMatrix(j,10));  
														tot_use_wgt_c = Number(tot_use_wgt_c) + Number(datagrid1.valueMatrix(j,11));  
														tot_use_wgt_b = Number(tot_use_wgt_b) + Number(datagrid1.valueMatrix(j,12));  
													
												}
											}
											
										}
										
										if (datagrid1.valueMatrix(i,2) == rv_issu_dt){
											
											if(datagrid1.valueMatrix(i,47) == "10")
											{
											datagrid1.valueMatrix(i,10) = tot_use_wgt_a;
											datagrid1.valueMatrix(i,11) = tot_use_wgt_c;
											datagrid1.valueMatrix(i,12) = tot_use_wgt_b;
											//alert(tot_use_wgt_a);
											}
										}
								}
								
								//model1.removeNodeset("/root/tempData/dataSet");
								makeTable();
								model1.refresh();
								break;	
							case  10 :
								var rv_issu_dt = datagrid1.valueMatrix(row,2);
									
								for (var i=row; i<rows+1; i++){
										
										var tot_use_wgt_a = 0;
										var tot_use_wgt_c = 0;
										var tot_use_wgt_b = 0;
										
										//입고
										for( var j = i-10 ; j<i+5 ; j++)
										{
											if (datagrid1.valueMatrix(j,2) == datagrid1.valueMatrix( i,2)){
											
												if(datagrid1.valueMatrix(j,47) != "10")
												{
														tot_use_wgt_a = Number(tot_use_wgt_a) + Number(datagrid1.valueMatrix(j,10));  
														tot_use_wgt_c = Number(tot_use_wgt_c) + Number(datagrid1.valueMatrix(j,11));  
														tot_use_wgt_b = Number(tot_use_wgt_b) + Number(datagrid1.valueMatrix(j,12));  
													
												}
											}
											
										}
										
										if (datagrid1.valueMatrix(i,2) == rv_issu_dt){
											
											if(datagrid1.valueMatrix(i,47) == "10")
											{
											datagrid1.valueMatrix(i,10) = tot_use_wgt_a;
											datagrid1.valueMatrix(i,11) = tot_use_wgt_c;
											datagrid1.valueMatrix(i,12) = tot_use_wgt_b;
											//alert(tot_use_wgt_a);
											}
										}
								}
								
								//model1.removeNodeset("/root/tempData/dataSet");
								makeTable();
								model1.refresh();
								break;	
							case  11 :
								
								var rv_issu_dt = datagrid1.valueMatrix(row,2);
									
								for (var i=row; i<rows+1; i++){
										
										var tot_use_wgt_a = 0;
										var tot_use_wgt_c = 0;
										var tot_use_wgt_b = 0;
										
										//입고
										for( var j = i-10 ; j<i+5 ; j++)
										{
											if (datagrid1.valueMatrix(j,2) == datagrid1.valueMatrix( i,2)){
											
												if(datagrid1.valueMatrix(j,47) != "10")
												{
														tot_use_wgt_a = Number(tot_use_wgt_a) + Number(datagrid1.valueMatrix(j,10));  
														tot_use_wgt_c = Number(tot_use_wgt_c) + Number(datagrid1.valueMatrix(j,11));  
														tot_use_wgt_b = Number(tot_use_wgt_b) + Number(datagrid1.valueMatrix(j,12));  
													
												}
											}
											
										}
										
										if (datagrid1.valueMatrix(i,2) == rv_issu_dt){
											
											if(datagrid1.valueMatrix(i,47) == "10")
											{
											datagrid1.valueMatrix(i,10) = tot_use_wgt_a;
											datagrid1.valueMatrix(i,11) = tot_use_wgt_c;
											datagrid1.valueMatrix(i,12) = tot_use_wgt_b;
											//alert(tot_use_wgt_a);
											}
										}
								}
								
								//model1.removeNodeset("/root/tempData/dataSet");
								makeTable();
								model1.refresh();
								break;	
							case  12 :
								
								var rv_issu_dt = datagrid1.valueMatrix(row,2);
									
								for (var i=row; i<rows+1; i++){
										
										var tot_use_wgt_a = 0;
										var tot_use_wgt_c = 0;
										var tot_use_wgt_b = 0;
										
										//입고
										for( var j = i-10 ; j<i+5 ; j++)
										{
											if (datagrid1.valueMatrix(j,2) == datagrid1.valueMatrix( i,2)){
											
												if(datagrid1.valueMatrix(j,47) != "10")
												{
														tot_use_wgt_a = Number(tot_use_wgt_a) + Number(datagrid1.valueMatrix(j,10));  
														tot_use_wgt_c = Number(tot_use_wgt_c) + Number(datagrid1.valueMatrix(j,11));  
														tot_use_wgt_b = Number(tot_use_wgt_b) + Number(datagrid1.valueMatrix(j,12));  
													
												}
											}
											
										}
										
										if (datagrid1.valueMatrix(i,2) == rv_issu_dt){
											
											if(datagrid1.valueMatrix(i,47) == "10")
											{
											datagrid1.valueMatrix(i,10) = tot_use_wgt_a;
											datagrid1.valueMatrix(i,11) = tot_use_wgt_c;
											datagrid1.valueMatrix(i,12) = tot_use_wgt_b;
											//alert(tot_use_wgt_a);
											}
										}
								}
								
								//model1.removeNodeset("/root/tempData/dataSet");
								makeTable();
								model1.refresh();
								break;		
							case  19 :
								if(datagrid1.valueMatrix(row,41) =="" || row_num =="10" ){
									datagrid1.valueMatrix(row, col) = "";
									return;
								}
								var    car_c =  datagrid1.valueMatrix(row, 19);   
								
								//datagrid1.valueMatrix(row, 16) = car_c;	
								
								var    car_cnt =  datagrid1.valueMatrix(row, 21);     
								
								var rv_bf_dt = datagrid1.valueMatrix(row,38);
								var rv_medi_cd = datagrid1.valueMatrix(row,39);
								var rv_sect_cd = datagrid1.valueMatrix(row,40);
								/*
								if(datagrid1.valueMatrix(row, 21) == "0")
								{
//									for (var i=2; i<datagrid1.rows; i++){
//										
//										if (datagrid1.valueMatrix(i,1) == rv_bf_dt){
//											if (datagrid1.valueMatrix(i,38) == rv_medi_cd && datagrid1.valueMatrix(i,39) == rv_sect_cd  ){
//												datagrid1.valueMatrix(row, 21) = datagrid1.valueMatrix(i,12) - datagrid1.valueMatrix(row, 9);
//												
//											}
//										}
//										 
//									}  
								}
								*/
								
								if(car_c !=""){
									datagrid1.valueMatrix(row, 16) =Math.round((car_cnt * tmp_roll_cnt_a) + tmp_rct - (datagrid1.valueMatrix(row, 19) / 2) - (datagrid1.valueMatrix(row, 20)*3/4)) ;	
									datagrid1.valueMatrix(row, 13) = Math.round(((car_cnt * tmp_roll_cnt_a) + tmp_rct  - (datagrid1.valueMatrix(row, 19) / 2) - (datagrid1.valueMatrix(row, 20)*3/4)) * tmp_roll_wgt_a);	  
									datagrid1.valueMatrix(row, 14) = datagrid1.valueMatrix(row, 19) * tmp_roll_wgt_c;
									datagrid1.valueMatrix(row, 15) = datagrid1.valueMatrix(row, 20) * tmp_roll_wgt_b;
									datagrid1.valueMatrix(row, 17) = car_c;
									
									var rv_bf_dt = datagrid1.valueMatrix(row,38);
									var rv_issu_dt = datagrid1.valueMatrix(row,2);
									var rv_medi_cd = datagrid1.valueMatrix(row,39);
									var rv_sect_cd = datagrid1.valueMatrix(row,40);
									
//									var tot_ewh_wgt_c = 0;
//									var tot_bal_wgt_c = 0;
//									var rv_use_c =  0;
//									var rv_bal_ewh_c = 0;
//									
									var rv_use_a =  0;
									var rv_bal_ewh_a = 0;
									var rv_wgt_a = 0;
									var rv_kk_a = 0;
									var rv_use_c =  0;
									var rv_bal_ewh_c = 0;
									var rv_wgt_c = 0;
									var rv_kk_c = 0;
									var rv_use_b =  0;
									var rv_bal_ewh_b = 0;
									var rv_wgt_b = 0;
									var rv_kk_b = 0;
									
									
									for (var i=row; i<rows+1; i++){
										
										var tot_ewh_wgt_a = 0;
										var tot_ewh_wgt_c = 0;
										var tot_ewh_wgt_b = 0;
										var tot_ewh_cnt_a = 0;
										var tot_ewh_cnt_c = 0;
										var tot_ewh_cnt_b = 0;
										
										//입고
										for( var j = i-10 ; j<i+5 ; j++)
										{
											if (datagrid1.valueMatrix(j,2) == datagrid1.valueMatrix( i,2)){
											
												if(datagrid1.valueMatrix(j,47) != "10")
												{
													if(datagrid1.valueMatrix(j,13)>0){
														tot_ewh_wgt_a = Number(tot_ewh_wgt_a) + Number(datagrid1.valueMatrix(j,13)); 
														tot_ewh_wgt_c = Number(tot_ewh_wgt_c) + Number(datagrid1.valueMatrix(j,14)); 
														tot_ewh_wgt_b = Number(tot_ewh_wgt_b) + Number(datagrid1.valueMatrix(j,15)); 
														tot_ewh_cnt_a = Number(tot_ewh_cnt_a) + Number(datagrid1.valueMatrix(j,16)); 
														tot_ewh_cnt_c = Number(tot_ewh_cnt_c) + Number(datagrid1.valueMatrix(j,17)); 
														tot_ewh_cnt_b = Number(tot_ewh_cnt_b) + Number(datagrid1.valueMatrix(j,18)); 
													}
												}
											}
											
										}
									
										if (datagrid1.valueMatrix(i,2) == rv_issu_dt){
											
											if(datagrid1.valueMatrix(i,47) == "10")
											{
												datagrid1.valueMatrix(i,13) = tot_ewh_wgt_a;
												datagrid1.valueMatrix(i,14) = tot_ewh_wgt_c;
												datagrid1.valueMatrix(i,15) = tot_ewh_wgt_b;
												datagrid1.valueMatrix(i,16) = tot_ewh_cnt_a;
												datagrid1.valueMatrix(i,17) = tot_ewh_cnt_c;
												datagrid1.valueMatrix(i,18) = tot_ewh_cnt_b;
												
												var tot_bal_wgt_a = datagrid1.valueMatrix(i, 22);
												var tot_bal_wgt_c = datagrid1.valueMatrix(i, 23);
												var tot_bal_wgt_b = datagrid1.valueMatrix(i, 24);
												
												//당일아침잔고+입고
												datagrid1.valueMatrix(i,29) =  Number(tot_bal_wgt_a) + Number(tot_ewh_wgt_a);
												datagrid1.valueMatrix(i,30) =  Number(tot_bal_wgt_c) + Number(tot_ewh_wgt_c);
												datagrid1.valueMatrix(i,31) =  Number(tot_bal_wgt_b) + Number(tot_ewh_wgt_b);
												datagrid1.valueMatrix(i,51) =  Math.round((Number(tot_bal_wgt_a) + Number(tot_ewh_wgt_a)) / Number(tmp_roll_wgt_a));
												datagrid1.valueMatrix(i,52) =  Math.round((Number(tot_bal_wgt_c) + Number(tot_ewh_wgt_c)) / Number(tmp_roll_wgt_c));
												datagrid1.valueMatrix(i,53) =  Math.round((Number(tot_bal_wgt_b) + Number(tot_ewh_wgt_b)) / Number(tmp_roll_wgt_b));
												rv_wgt_a = datagrid1.valueMatrix(i,29);
												rv_wgt_c = datagrid1.valueMatrix(i,30);
												rv_wgt_b = datagrid1.valueMatrix(i,31);
												model.setValue("/root/resData/tempEwh_a",rv_wgt_a);
												model.setValue("/root/resData/tempEwh_c",rv_wgt_c);
												model.setValue("/root/resData/tempEwh_b",rv_wgt_b);
												
											}
											
											
										}
										
										
									
										
									}
									var cnt = 0;
									if(datagrid1.valueMatrix(row+5,47) < 5){
										cnt = 5;
									}else{
										cnt = Number(datagrid1.valueMatrix(row+5,47))+2;
									}
									
									var rv_ewh_a;
									var rv_ewh_c;
									var rv_ewh_b;
									
									for( var k = row+cnt+1 ; k < rows+1 ; k++)
									{
										
										
										if(datagrid1.valueMatrix(k,47) == "10")
										{
											rv_use_a = datagrid1.valueMatrix(k, 10); 
											rv_use_c = datagrid1.valueMatrix(k, 11); 
											rv_use_b = datagrid1.valueMatrix(k, 12); 
											
											rv_ewh_a = datagrid1.valueMatrix(k, 13); 
											rv_ewh_c = datagrid1.valueMatrix(k, 14); 
											rv_ewh_b = datagrid1.valueMatrix(k, 15); 
											
											//tomo_ewh_wgt_a = datagrid1.valueMatrix(k, 12); 
											//alert(model.getValue("/root/resData/tempEwh_a"));
											tomo_ewh_wgt_a = model.getValue("/root/resData/tempEwh_a");
											tomo_ewh_wgt_c = model.getValue("/root/resData/tempEwh_c");
											tomo_ewh_wgt_b = model.getValue("/root/resData/tempEwh_b");
											//datagrid1.valueMatrix(k, 21) = Number(tot_ewh_wgt_a) + Number(rv_bal_ewh_a) - Number(rv_use_a);
											datagrid1.valueMatrix(k, 22) = Number(tomo_ewh_wgt_a) - Number(rv_use_a);
											datagrid1.valueMatrix(k, 23) = Number(tomo_ewh_wgt_c) - Number(rv_use_c);
											datagrid1.valueMatrix(k, 24) = Number(tomo_ewh_wgt_b) - Number(rv_use_b);
											datagrid1.valueMatrix(k, 25) = Number(datagrid1.valueMatrix(k, 22))+Number(datagrid1.valueMatrix(k, 23))+Number(datagrid1.valueMatrix(k, 24));
//											model.setValue("/root/resData/tempEwh_a",datagrid1.valueMatrix(k, 21));
//											model.setValue("/root/resData/tempEwh_c",datagrid1.valueMatrix(k, 22));
//											model.setValue("/root/resData/tempEwh_b",datagrid1.valueMatrix(k, 23));
											

											//datagrid1.valueMatrix(k, 21) = rv_kk_a;
											//datagrid1.valueMatrix(k, 25) = Math.round((Number(tot_ewh_wgt_a) + Number(rv_bal_ewh_a) - Number(rv_use_a))/ tmp_roll_wgt_a) ;
											datagrid1.valueMatrix(k, 26) = Math.round((Number(tomo_ewh_wgt_a) - Number(rv_use_a)) / tmp_roll_wgt_a) ;
											datagrid1.valueMatrix(k, 27) = Math.round((Number(tomo_ewh_wgt_c) - Number(rv_use_c)) / tmp_roll_wgt_c) ;
											datagrid1.valueMatrix(k, 28) = Math.round((Number(tomo_ewh_wgt_b) - Number(rv_use_b)) / tmp_roll_wgt_b) ;
											
											datagrid1.valueMatrix(k, 29) = Math.round((Number(datagrid1.valueMatrix(k, 13)) + Number(tomo_ewh_wgt_a) - Number(rv_use_a))) ;
											datagrid1.valueMatrix(k, 30) = Math.round((Number(datagrid1.valueMatrix(k, 14)) + Number(tomo_ewh_wgt_c) - Number(rv_use_c))) ;
											datagrid1.valueMatrix(k, 31) = Math.round((Number(datagrid1.valueMatrix(k, 15)) + Number(tomo_ewh_wgt_b) - Number(rv_use_b))) ;
											
											model.setValue("/root/resData/tempEwh_a",datagrid1.valueMatrix(k, 29));
											model.setValue("/root/resData/tempEwh_c",datagrid1.valueMatrix(k, 30));
											model.setValue("/root/resData/tempEwh_b",datagrid1.valueMatrix(k, 31));
											
											datagrid1.valueMatrix(k, 51) = Math.round((Number(datagrid1.valueMatrix(k, 13)) + Number(tomo_ewh_wgt_a) - Number(rv_use_a)) / Number(tmp_roll_wgt_a)) ;
											datagrid1.valueMatrix(k, 52) = Math.round((Number(datagrid1.valueMatrix(k, 14)) + Number(tomo_ewh_wgt_c) - Number(rv_use_c)) / Number(tmp_roll_wgt_c)) ;
											datagrid1.valueMatrix(k, 53) = Math.round((Number(datagrid1.valueMatrix(k, 15)) + Number(tomo_ewh_wgt_b) - Number(rv_use_b)) / Number(tmp_roll_wgt_b)) ;
											
											
										}
										
									}
									
									
									
//									for (var i=row; i<row+10; i++){
//									//for (var i=row; i<rows; i++){						
//										
//								
//										if (datagrid1.valueMatrix(i,1) == rv_issu_dt){
//											
//											if(datagrid1.valueMatrix(i,46) != "10")
//											{
//												tot_ewh_wgt_c = Number(datagrid1.valueMatrix(i,13)) + Number(tot_ewh_wgt_c); 
//											}
//											if(datagrid1.valueMatrix(i,46) == "10")
//											{
//												datagrid1.valueMatrix(i,13) = tot_ewh_wgt_c;
//												tot_bal_wgt_c = datagrid1.valueMatrix(i, 26);
//												datagrid1.valueMatrix(i, 29) = Number(tot_bal_wgt_c) + Number(car_c);
//											}
//												
//												rv_use_c = datagrid1.valueMatrix(i, 10); 
//												rv_bal_ewh_c = datagrid1.valueMatrix(i,22);
//												if(datagrid1.valueMatrix(i, 47) == "0")
//												{					
//													
//													if(i<rows-5){ //다음날 아침 재고 구하기
//														for( var k = i+6 ; k < i+10 ; k++)
//														{
//															if(datagrid1.valueMatrix(k,46) == "10")
//															{
//	//														
//																//alert(tot_ewh_wgt_c +"_"+ rv_bal_ewh_c +"_"+rv_use_c);
//																datagrid1.valueMatrix(k, 22) = Number(tot_ewh_wgt_c) + Number(rv_bal_ewh_c) - Number(rv_use_c);
//																datagrid1.valueMatrix(k, 26) = Math.round((Number(tot_ewh_wgt_c) + Number(rv_bal_ewh_c) - Number(rv_use_c))/ tmp_roll_wgt_c) ;
//																
//															}
//															
//														}
//													}
//													
//													
//												}
//												
//												
//												
//												
//											}
//											
//										}
//										
//										
//									
										
//									}
//									
								}
								
								
								
								
								break;
							case  20 :
							    if(datagrid1.valueMatrix(row,41) =="" || row_num =="10" ){
									datagrid1.valueMatrix(row, col) = "";
									return;
								}
								var    car_b =  datagrid1.valueMatrix(row, 20);   
								var    car_cnt =  datagrid1.valueMatrix(row, 21);   
								/*datagrid1.valueMatrix(row, 17) = car_b;	
								
								var    car_cnt =  datagrid1.valueMatrix(row, 20);     
								datagrid1.valueMatrix(row, 15) =Math.round((car_cnt * tmp_roll_cnt_a) - (datagrid1.valueMatrix(row, 16) / 2) - (datagrid1.valueMatrix(row, 17)*3/4)) ;	
								datagrid1.valueMatrix(row, 12) = Math.round(((car_cnt * tmp_roll_cnt_a) - (datagrid1.valueMatrix(row, 16) / 2) - (datagrid1.valueMatrix(row, 17)*3/4)) * tmp_roll_wgt_a);	  
								datagrid1.valueMatrix(row, 13) = datagrid1.valueMatrix(row, 16) *tmp_roll_wgt_c;
								datagrid1.valueMatrix(row, 14) = datagrid1.valueMatrix(row, 17) * tmp_roll_wgt_b;
								
								var rv_bf_dt = datagrid1.valueMatrix(row,37);
								var rv_medi_cd = datagrid1.valueMatrix(row,38);
								var rv_sect_cd = datagrid1.valueMatrix(row,39);
								*/
								
								if(car_b !=""){
									datagrid1.valueMatrix(row, 18) = car_b;
									datagrid1.valueMatrix(row, 16) =Math.round((car_cnt * tmp_roll_cnt_a) + tmp_rct  - (datagrid1.valueMatrix(row, 19) / 2) - (datagrid1.valueMatrix(row, 20)*3/4)) ;	
									datagrid1.valueMatrix(row, 13) = Math.round(((car_cnt * tmp_roll_cnt_a) + tmp_rct  - (datagrid1.valueMatrix(row, 19) / 2) - (datagrid1.valueMatrix(row, 20)*3/4)) * tmp_roll_wgt_a);	  
									datagrid1.valueMatrix(row, 14) = datagrid1.valueMatrix(row, 19) * tmp_roll_wgt_c;
									datagrid1.valueMatrix(row, 15) = datagrid1.valueMatrix(row, 20) * tmp_roll_wgt_b;
									
									
									
									
									var rv_bf_dt = datagrid1.valueMatrix(row,38);
									var rv_issu_dt = datagrid1.valueMatrix(row,2);
									var rv_medi_cd = datagrid1.valueMatrix(row,39);
									var rv_sect_cd = datagrid1.valueMatrix(row,40);
									
									var tot_ewh_wgt_b = 0;
									var tot_bal_wgt_b = 0;
									var rv_use_b =  0;
									var rv_bal_ewh_b = 0;
									
									
									for (var i=row; i<rows+1; i++){
										
										var tot_ewh_wgt_a = 0;
										var tot_ewh_wgt_c = 0;
										var tot_ewh_wgt_b = 0;
										var tot_ewh_cnt_a = 0;
										var tot_ewh_cnt_c = 0;
										var tot_ewh_cnt_b = 0;
										
										//입고
										for( var j = i-10 ; j<i+5 ; j++)
										{
											if (datagrid1.valueMatrix(j,2) == datagrid1.valueMatrix( i,2)){
											
												if(datagrid1.valueMatrix(j,47) != "10")
												{
													if(datagrid1.valueMatrix(j,13)>0){
														tot_ewh_wgt_a = Number(tot_ewh_wgt_a) + Number(datagrid1.valueMatrix(j,13)); 
														tot_ewh_wgt_c = Number(tot_ewh_wgt_c) + Number(datagrid1.valueMatrix(j,14)); 
														tot_ewh_wgt_b = Number(tot_ewh_wgt_b) + Number(datagrid1.valueMatrix(j,15)); 
														tot_ewh_cnt_a = Number(tot_ewh_cnt_a) + Number(datagrid1.valueMatrix(j,16)); 
														tot_ewh_cnt_c = Number(tot_ewh_cnt_c) + Number(datagrid1.valueMatrix(j,17)); 
														tot_ewh_cnt_b = Number(tot_ewh_cnt_b) + Number(datagrid1.valueMatrix(j,18)); 
													}
												}
											}
											
										}
									
										if (datagrid1.valueMatrix(i,2) == rv_issu_dt){
											
											if(datagrid1.valueMatrix(i,47) == "10")
											{
												datagrid1.valueMatrix(i,13) = tot_ewh_wgt_a;
												datagrid1.valueMatrix(i,14) = tot_ewh_wgt_c;
												datagrid1.valueMatrix(i,15) = tot_ewh_wgt_b;
												datagrid1.valueMatrix(i,16) = tot_ewh_cnt_a;
												datagrid1.valueMatrix(i,17) = tot_ewh_cnt_c;
												datagrid1.valueMatrix(i,18) = tot_ewh_cnt_b;
												
												var tot_bal_wgt_a = datagrid1.valueMatrix(i, 22);
												var tot_bal_wgt_c = datagrid1.valueMatrix(i, 23);
												var tot_bal_wgt_b = datagrid1.valueMatrix(i, 24);
												
												//당일아침잔고+입고
												datagrid1.valueMatrix(i,29) =  Number(tot_bal_wgt_a) + Number(tot_ewh_wgt_a);
												datagrid1.valueMatrix(i,30) =  Number(tot_bal_wgt_c) + Number(tot_ewh_wgt_c);
												datagrid1.valueMatrix(i,31) =  Number(tot_bal_wgt_b) + Number(tot_ewh_wgt_b);
												datagrid1.valueMatrix(i,51) =  Math.round((Number(tot_bal_wgt_a) + Number(tot_ewh_wgt_a)) / Number(tmp_roll_wgt_a));
												datagrid1.valueMatrix(i,52) =  Math.round((Number(tot_bal_wgt_c) + Number(tot_ewh_wgt_c)) / Number(tmp_roll_wgt_c));
												datagrid1.valueMatrix(i,53) =  Math.round((Number(tot_bal_wgt_b) + Number(tot_ewh_wgt_b)) / Number(tmp_roll_wgt_b));
												rv_wgt_a = datagrid1.valueMatrix(i,29);
												rv_wgt_c = datagrid1.valueMatrix(i,30);
												rv_wgt_b = datagrid1.valueMatrix(i,31);
												model.setValue("/root/resData/tempEwh_a",rv_wgt_a);
												model.setValue("/root/resData/tempEwh_c",rv_wgt_c);
												model.setValue("/root/resData/tempEwh_b",rv_wgt_b);
												
											}
											
											
										}
									
										
									}
									
									var cnt = 0;
									if(datagrid1.valueMatrix(row+5,47) < 5){
										cnt = 5;
									}else{
										cnt = Number(datagrid1.valueMatrix(row+5,47))+2;
									}
									
									var rv_ewh_a;
									var rv_ewh_c;
									var rv_ewh_b;
									
									for( var k = row+cnt+1 ; k < rows+1 ; k++)
									{
										
										
										if(datagrid1.valueMatrix(k,47) == "10")
										{
											rv_use_a = datagrid1.valueMatrix(k, 10); 
											rv_use_c = datagrid1.valueMatrix(k, 11); 
											rv_use_b = datagrid1.valueMatrix(k, 12); 
											
											rv_ewh_a = datagrid1.valueMatrix(k, 13); 
											rv_ewh_c = datagrid1.valueMatrix(k, 14); 
											rv_ewh_b = datagrid1.valueMatrix(k, 15); 
											
											//tomo_ewh_wgt_a = datagrid1.valueMatrix(k, 12); 
											//alert(model.getValue("/root/resData/tempEwh_a"));
											tomo_ewh_wgt_a = model.getValue("/root/resData/tempEwh_a");
											tomo_ewh_wgt_c = model.getValue("/root/resData/tempEwh_c");
											tomo_ewh_wgt_b = model.getValue("/root/resData/tempEwh_b");
											//datagrid1.valueMatrix(k, 21) = Number(tot_ewh_wgt_a) + Number(rv_bal_ewh_a) - Number(rv_use_a);
											datagrid1.valueMatrix(k, 22) = Number(tomo_ewh_wgt_a) - Number(rv_use_a);
											datagrid1.valueMatrix(k, 23) = Number(tomo_ewh_wgt_c) - Number(rv_use_c);
											datagrid1.valueMatrix(k, 24) = Number(tomo_ewh_wgt_b) - Number(rv_use_b);
											datagrid1.valueMatrix(k, 25) = Number(datagrid1.valueMatrix(k, 22))+Number(datagrid1.valueMatrix(k, 23))+Number(datagrid1.valueMatrix(k, 24));
//											model.setValue("/root/resData/tempEwh_a",datagrid1.valueMatrix(k, 21));
//											model.setValue("/root/resData/tempEwh_c",datagrid1.valueMatrix(k, 22));
//											model.setValue("/root/resData/tempEwh_b",datagrid1.valueMatrix(k, 23));
											

											//datagrid1.valueMatrix(k, 21) = rv_kk_a;
											//datagrid1.valueMatrix(k, 25) = Math.round((Number(tot_ewh_wgt_a) + Number(rv_bal_ewh_a) - Number(rv_use_a))/ tmp_roll_wgt_a) ;
											datagrid1.valueMatrix(k, 26) = Math.round((Number(tomo_ewh_wgt_a) - Number(rv_use_a)) / tmp_roll_wgt_a) ;
											datagrid1.valueMatrix(k, 27) = Math.round((Number(tomo_ewh_wgt_c) - Number(rv_use_c)) / tmp_roll_wgt_c) ;
											datagrid1.valueMatrix(k, 28) = Math.round((Number(tomo_ewh_wgt_b) - Number(rv_use_b)) / tmp_roll_wgt_b) ;
											
											datagrid1.valueMatrix(k, 29) = Math.round((Number(datagrid1.valueMatrix(k, 13)) + Number(tomo_ewh_wgt_a) - Number(rv_use_a))) ;
											datagrid1.valueMatrix(k, 30) = Math.round((Number(datagrid1.valueMatrix(k, 14)) + Number(tomo_ewh_wgt_c) - Number(rv_use_c))) ;
											datagrid1.valueMatrix(k, 31) = Math.round((Number(datagrid1.valueMatrix(k, 15)) + Number(tomo_ewh_wgt_b) - Number(rv_use_b))) ;
											
											model.setValue("/root/resData/tempEwh_a",datagrid1.valueMatrix(k, 29));
											model.setValue("/root/resData/tempEwh_c",datagrid1.valueMatrix(k, 30));
											model.setValue("/root/resData/tempEwh_b",datagrid1.valueMatrix(k, 31));
											
											datagrid1.valueMatrix(k, 51) = Math.round((Number(datagrid1.valueMatrix(k, 13)) + Number(tomo_ewh_wgt_a) - Number(rv_use_a)) / Number(tmp_roll_wgt_a)) ;
											datagrid1.valueMatrix(k, 52) = Math.round((Number(datagrid1.valueMatrix(k, 14)) + Number(tomo_ewh_wgt_c) - Number(rv_use_c)) / Number(tmp_roll_wgt_c)) ;
											datagrid1.valueMatrix(k, 53) = Math.round((Number(datagrid1.valueMatrix(k, 15)) + Number(tomo_ewh_wgt_b) - Number(rv_use_b)) / Number(tmp_roll_wgt_b)) ;
											
											
										}
										
									}
									
//									for (var i=row; i<row+10; i++){
//										
//								
//										if (datagrid1.valueMatrix(i,1) == rv_issu_dt){
//											
//											if(datagrid1.valueMatrix(i,46) != "10")
//											{
//												tot_ewh_wgt_b = Number(datagrid1.valueMatrix(i,14)) + Number(tot_ewh_wgt_b); 
//											}
//											if(datagrid1.valueMatrix(i,46) == "10")
//											{
//												datagrid1.valueMatrix(i,14) = tot_ewh_wgt_b;
//												tot_bal_wgt_b = datagrid1.valueMatrix(i, 27);
//												datagrid1.valueMatrix(i, 30) = Number(tot_bal_wgt_b) + Number(car_b);
//											}
//												
//												rv_use_b = datagrid1.valueMatrix(i, 11); 
//												rv_bal_ewh_b = datagrid1.valueMatrix(i,23);
//												if(datagrid1.valueMatrix(i, 47) == "0")
//												{					
//													
//													if(i<rows-5){ //다음날 아침 재고 구하기
//														for( var k = i+6 ; k < i+10 ; k++)
//														{
//															if(datagrid1.valueMatrix(k,46) == "10")
//															{
//										
//																datagrid1.valueMatrix(k, 23) = Number(tot_ewh_wgt_b) + Number(rv_bal_ewh_b) - Number(rv_use_b);
//																datagrid1.valueMatrix(k, 27) = Math.round((Number(tot_ewh_wgt_b) + Number(rv_bal_ewh_b) - Number(rv_use_b))/ tmp_roll_wgt_b) ;
//																
//															}
//															
//														}
//													}
//													
//													
//												}
//												
//												
//												
//												
//
//											
//										}
//										
//										
//									
//										
//									}
								}
									
								
								
								
								
								break;
							case  21 :
							    if(datagrid1.valueMatrix(row,41) =="" || row_num =="10" ){
									datagrid1.valueMatrix(row, col) = "";
									return;
								}
								var    car_cnt =  datagrid1.valueMatrix(row, 21); 
								
								if(car_cnt !=""){
									datagrid1.valueMatrix(row, 16) =Math.round((car_cnt * tmp_roll_cnt_a) + tmp_rct  - (datagrid1.valueMatrix(row, 17) / 2) - (datagrid1.valueMatrix(row, 18)*3/4)) ;	
									datagrid1.valueMatrix(row, 13) = Math.round(((car_cnt * tmp_roll_cnt_a) + tmp_rct  - (datagrid1.valueMatrix(row, 17) / 2) - (datagrid1.valueMatrix(row, 18)*3/4)) * tmp_roll_wgt_a);	  
									datagrid1.valueMatrix(row, 14) = datagrid1.valueMatrix(row, 17) * tmp_roll_wgt_c;
									datagrid1.valueMatrix(row, 15) = datagrid1.valueMatrix(row, 18) * tmp_roll_wgt_b;
									
									var rv_bf_dt = datagrid1.valueMatrix(row,38);
									var rv_issu_dt = datagrid1.valueMatrix(row,2);
									var rv_medi_cd = datagrid1.valueMatrix(row,39);
									var rv_sect_cd = datagrid1.valueMatrix(row,40);
									
									//var tot_ewh_wgt_a = 0;
									//var bf_tot_ewh_a = 0;
									//var bf_bal_ewh_a = 0;
									var rv_use_a =  0;
									var rv_bal_ewh_a = 0;
									var rv_wgt_a = 0;
									var rv_kk_a = 0;
									var rv_use_c =  0;
									var rv_bal_ewh_c = 0;
									var rv_wgt_c = 0;
									var rv_kk_c = 0;
									var rv_use_b =  0;
									var rv_bal_ewh_b = 0;
									var rv_wgt_b = 0;
									var rv_kk_b = 0;
									
//									//입고
//									for( var j = row-5 ; j<row+5 ; j++)
//									{
//										if (datagrid1.valueMatrix(j,1) == datagrid1.valueMatrix( row,1)){
//										
//											if(datagrid1.valueMatrix(j,46) != "10")
//											{
//												if(datagrid1.valueMatrix(j,12)>0){
//													tot_ewh_wgt_a = Number(tot_ewh_wgt_a) + Number(datagrid1.valueMatrix(j,12)); 
//												}
//											}
//										}
//										
//									}
									
									//for (var i=row; i<row+10; i++){
									for (var i=row; i<rows+1; i++){
										
										var tot_ewh_wgt_a = 0;
										var tot_ewh_wgt_c = 0;
										var tot_ewh_wgt_b = 0;
										var tot_ewh_cnt_a = 0;
										var tot_ewh_cnt_c = 0;
										var tot_ewh_cnt_b = 0;
//										if( i>5 )
//										{
//											for( var j = i-5 ; j<row ; j++)
//											{
//												if(datagrid1.valueMatrix(j,46) == "10")
//												{
//													bf_tot_ewh_a = datagrid1.valueMatrix(j,12);
//													bf_bal_ewh_a = datagrid1.valueMatrix(j,21);
//												
//												}
//												
//											}
//										}

										//입고
										for( var j = i-10 ; j<i+5 ; j++)
										{
											if (datagrid1.valueMatrix(j,2) == datagrid1.valueMatrix( i,2)){
											
												if(datagrid1.valueMatrix(j,47) != "10")
												{
													if(datagrid1.valueMatrix(j,13)>0){
														tot_ewh_wgt_a = Number(tot_ewh_wgt_a) + Number(datagrid1.valueMatrix(j,13)); 
														tot_ewh_wgt_c = Number(tot_ewh_wgt_c) + Number(datagrid1.valueMatrix(j,14)); 
														tot_ewh_wgt_b = Number(tot_ewh_wgt_b) + Number(datagrid1.valueMatrix(j,15)); 
														tot_ewh_cnt_a = Number(tot_ewh_cnt_a) + Number(datagrid1.valueMatrix(j,16)); 
														tot_ewh_cnt_c = Number(tot_ewh_cnt_c) + Number(datagrid1.valueMatrix(j,17)); 
														tot_ewh_cnt_b = Number(tot_ewh_cnt_b) + Number(datagrid1.valueMatrix(j,18)); 
													}
												}
											}
											
										}
									
										if (datagrid1.valueMatrix(i,2) == rv_issu_dt){
											
											if(datagrid1.valueMatrix(i,47) == "10")
											{
												datagrid1.valueMatrix(i,13) = tot_ewh_wgt_a;
												datagrid1.valueMatrix(i,14) = tot_ewh_wgt_c;
												datagrid1.valueMatrix(i,15) = tot_ewh_wgt_b;
												datagrid1.valueMatrix(i,16) = tot_ewh_cnt_a;
												datagrid1.valueMatrix(i,17) = tot_ewh_cnt_c;
												datagrid1.valueMatrix(i,18) = tot_ewh_cnt_b;
												var tot_bal_wgt_a = datagrid1.valueMatrix(i, 22);
												var tot_bal_wgt_c = datagrid1.valueMatrix(i, 23);
												var tot_bal_wgt_b = datagrid1.valueMatrix(i, 24);
												
												//당일아침잔고+입고
												datagrid1.valueMatrix(i,29) =  Number(tot_bal_wgt_a) + Number(tot_ewh_wgt_a);
												datagrid1.valueMatrix(i,30) =  Number(tot_bal_wgt_c) + Number(tot_ewh_wgt_c);
												datagrid1.valueMatrix(i,31) =  Number(tot_bal_wgt_b) + Number(tot_ewh_wgt_b);
												datagrid1.valueMatrix(i,51) =  Math.round((Number(tot_bal_wgt_a) + Number(tot_ewh_wgt_a)) / Number(tmp_roll_wgt_a));
												datagrid1.valueMatrix(i,52) =  Math.round((Number(tot_bal_wgt_c) + Number(tot_ewh_wgt_c)) / Number(tmp_roll_wgt_c));
												datagrid1.valueMatrix(i,53) =  Math.round((Number(tot_bal_wgt_b) + Number(tot_ewh_wgt_b)) / Number(tmp_roll_wgt_b));
												rv_wgt_a = datagrid1.valueMatrix(i,29);
												rv_wgt_c = datagrid1.valueMatrix(i,30);
												rv_wgt_b = datagrid1.valueMatrix(i,31);
												model.setValue("/root/resData/tempEwh_a",rv_wgt_a);
												model.setValue("/root/resData/tempEwh_c",rv_wgt_c);
												model.setValue("/root/resData/tempEwh_b",rv_wgt_b);
												
												//if(i<rows-5){ //다음날 아침 재고 구하기
														//for( var k = i+5 ; k < i+10 ; k++)
//														for( var k = i+5 ; k < rows+1 ; k++)
//														{
//															
//															
//															if(datagrid1.valueMatrix(k,46) == "10")
//															{
//																rv_use_a = datagrid1.valueMatrix(k, 9); 
//																//tomo_ewh_wgt_a = datagrid1.valueMatrix(k, 12); 
//																tomo_ewh_wgt_a = model.getValue("/root/resData/tempEwh");
//																//datagrid1.valueMatrix(k, 21) = Number(tot_ewh_wgt_a) + Number(rv_bal_ewh_a) - Number(rv_use_a);
//																datagrid1.valueMatrix(k, 21) = Number(tomo_ewh_wgt_a) - Number(rv_use_a);
//																model.setValue("/root/resData/tempEwh",tomo_ewh_wgt_a);
//																alert(tomo_ewh_wgt_a);
//																//datagrid1.valueMatrix(k, 21) = rv_kk_a;
//																//datagrid1.valueMatrix(k, 25) = Math.round((Number(tot_ewh_wgt_a) + Number(rv_bal_ewh_a) - Number(rv_use_a))/ tmp_roll_wgt_a) ;
//																datagrid1.valueMatrix(k, 25) = Math.round((Number(rv_wgt_a) - Number(rv_use_a)) / tmp_roll_wgt_a) ;
//																datagrid1.valueMatrix(k, 28) = Math.round((Number(datagrid1.valueMatrix(k, 12)) + Number(rv_wgt_a) - Number(rv_use_a))) ;
//																datagrid1.valueMatrix(k, 50) = Math.round((Number(datagrid1.valueMatrix(k, 12)) + Number(rv_wgt_a) - Number(rv_use_a)) / Number(tmp_roll_wgt_a)) ;
//																
//																
//															}
//															
//														}
												//	}
											}
											 
//											if(datagrid1.valueMatrix(i,46) == "10")
//											{
//												

//												datagrid1.valueMatrix(i,12) = 0;
												//rv_use_a = datagrid1.valueMatrix(i, 9); 
//												rv_bal_ewh_a = datagrid1.valueMatrix(i,21);
//												if(datagrid1.valueMatrix(i, 47) == "0")
//												{					
//													
//													if(i<rows-5){ //다음날 아침 재고 구하기
//														for( var k = i+6 ; k < i+10 ; k++)
//														{
//															if(datagrid1.valueMatrix(k,46) == "10")
//															{
//	//															
//																//datagrid1.valueMatrix(k, 21) = Number(tot_ewh_wgt_a) + Number(rv_bal_ewh_a) - Number(rv_use_a);
//																//datagrid1.valueMatrix(k, 21) = Number(rv_wgt_a) - Number(rv_use_a);
//																datagrid1.valueMatrix(k, 21) = rv_kk_a;
//																//datagrid1.valueMatrix(k, 25) = Math.round((Number(tot_ewh_wgt_a) + Number(rv_bal_ewh_a) - Number(rv_use_a))/ tmp_roll_wgt_a) ;
//																datagrid1.valueMatrix(k, 25) = Math.round((Number(tot_ewh_wgt_a) + Number(rv_bal_ewh_a) - Number(rv_use_a))/ tmp_roll_wgt_a) ;
//																
//																
//															}
//															
//														}
//													}
//													
//													
//												}
												
												
												
												
//											}
											
										}
										
										
									
										
									}
									var cnt = 0;
									if(datagrid1.valueMatrix(row+5,47) < 5){
										cnt = 5;
									}else{
										cnt = Number(datagrid1.valueMatrix(row+5,47))+2;
									}
									
									var rv_ewh_a;
									var rv_ewh_c;
									var rv_ewh_b;
									//alert(cnt);
									for( var k = row+cnt+1 ; k < rows+1 ; k++)
									{
										
										
										if(datagrid1.valueMatrix(k,47) == "10")
										{
											rv_use_a = datagrid1.valueMatrix(k, 10); 
											rv_use_c = datagrid1.valueMatrix(k, 11); 
											rv_use_b = datagrid1.valueMatrix(k, 12); 
											
											rv_ewh_a = datagrid1.valueMatrix(k, 13); 
											rv_ewh_c = datagrid1.valueMatrix(k, 14); 
											rv_ewh_b = datagrid1.valueMatrix(k, 15); 
											
											//tomo_ewh_wgt_a = datagrid1.valueMatrix(k, 12); 
											//alert(model.getValue("/root/resData/tempEwh_a"));
											tomo_ewh_wgt_a = model.getValue("/root/resData/tempEwh_a");
											tomo_ewh_wgt_c = model.getValue("/root/resData/tempEwh_c");
											tomo_ewh_wgt_b = model.getValue("/root/resData/tempEwh_b");
											//datagrid1.valueMatrix(k, 21) = Number(tot_ewh_wgt_a) + Number(rv_bal_ewh_a) - Number(rv_use_a);
											datagrid1.valueMatrix(k, 22) = Number(tomo_ewh_wgt_a) - Number(rv_use_a);
											datagrid1.valueMatrix(k, 23) = Number(tomo_ewh_wgt_c) - Number(rv_use_c);
											datagrid1.valueMatrix(k, 24) = Number(tomo_ewh_wgt_b) - Number(rv_use_b);
											datagrid1.valueMatrix(k, 25) = Number(datagrid1.valueMatrix(k, 22))+Number(datagrid1.valueMatrix(k, 23))+Number(datagrid1.valueMatrix(k, 24));
//											model.setValue("/root/resData/tempEwh_a",datagrid1.valueMatrix(k, 21));
//											model.setValue("/root/resData/tempEwh_c",datagrid1.valueMatrix(k, 22));
//											model.setValue("/root/resData/tempEwh_b",datagrid1.valueMatrix(k, 23));
											

											//datagrid1.valueMatrix(k, 21) = rv_kk_a;
											//datagrid1.valueMatrix(k, 25) = Math.round((Number(tot_ewh_wgt_a) + Number(rv_bal_ewh_a) - Number(rv_use_a))/ tmp_roll_wgt_a) ;
											//datagrid1.valueMatrix(k, 26) = Math.round((Number(tomo_ewh_wgt_a) - Number(rv_use_a)) / tmp_roll_wgt_a) ;
											//datagrid1.valueMatrix(k, 27) = Math.round((Number(tomo_ewh_wgt_c) - Number(rv_use_c)) / tmp_roll_wgt_c) ;
											//datagrid1.valueMatrix(k, 28) = Math.round((Number(tomo_ewh_wgt_b) - Number(rv_use_b)) / tmp_roll_wgt_b) ;
											
											datagrid1.valueMatrix(k, 29) = Math.round((Number(datagrid1.valueMatrix(k, 13)) + Number(tomo_ewh_wgt_a) - Number(rv_use_a))) ;
											datagrid1.valueMatrix(k, 30) = Math.round((Number(datagrid1.valueMatrix(k, 14)) + Number(tomo_ewh_wgt_c) - Number(rv_use_c))) ;
											datagrid1.valueMatrix(k, 31) = Math.round((Number(datagrid1.valueMatrix(k, 15)) + Number(tomo_ewh_wgt_b) - Number(rv_use_b))) ;
											
											model.setValue("/root/resData/tempEwh_a",datagrid1.valueMatrix(k, 29));
											model.setValue("/root/resData/tempEwh_c",datagrid1.valueMatrix(k, 30));
											model.setValue("/root/resData/tempEwh_b",datagrid1.valueMatrix(k, 31));
											
											datagrid1.valueMatrix(k, 51) = Math.round((Number(datagrid1.valueMatrix(k, 13)) + Number(tomo_ewh_wgt_a) - Number(rv_use_a)) / Number(tmp_roll_wgt_a)) ;
											datagrid1.valueMatrix(k, 52) = Math.round((Number(datagrid1.valueMatrix(k, 14)) + Number(tomo_ewh_wgt_c) - Number(rv_use_c)) / Number(tmp_roll_wgt_c)) ;
											datagrid1.valueMatrix(k, 53) = Math.round((Number(datagrid1.valueMatrix(k, 15)) + Number(tomo_ewh_wgt_b) - Number(rv_use_b)) / Number(tmp_roll_wgt_b)) ;
											
											
										}
										
									}
									
								}
								break;
							
								
						}
						
						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
							var cell = datagrid1.selectedCells;
						var codeVal;
						if(cell.length < 1){
							alert("select a Cell");
							return;
						}
						
						var col = cell.item(0).col;
						var row = cell.item(0).row;
						var rows = datagrid1.rows;
						var fac_clsf = model.getValue("/root/reqData/searchData/fac_clsf");
						var row_num = datagrid1.valueMatrix(row, 47);
						var clos_clsf = datagrid1.valueMatrix(row, 54);
						
						if(clos_clsf =="Y"){
							alert("마감되었습니다.");
							//datagrid1.valueMatrix(row, col) = "";
							return;
						}
						
						
						switch (col){
						
							case  5 :
								model1.setValue("/root/reqData/searchCode/fac_clsf", fac_clsf);
								model1.setValue("/root/reqData/searchCode/issu_dt",  datagrid1.valueMatrix(row, datagrid1.colRef("issu_dt")));
								model1.setValue("/root/reqData/searchCode/pcnt", datagrid1.valueMatrix(row, datagrid1.colRef("pcnt")));
								model1.setValue("/root/reqData/searchCode/slip_qty", datagrid1.valueMatrix(row, datagrid1.colRef("slip_qty")));
								model1.setValue("/root/reqData/searchCode/medi_cd", datagrid1.valueMatrix(row, datagrid1.colRef("medi_cd")));
								model1.setValue("/root/reqData/searchCode/add_prt_seq", datagrid1.valueMatrix(row, datagrid1.colRef("add_prt_seq")));
								model1.setValue("/root/reqData/searchCode/dual_out_clsf", datagrid1.valueMatrix(row, datagrid1.colRef("dual_out_clsf")));
								model.send("mt_papord_8005");
								
								datagrid1.valueMatrix(row, 10) = model1.getValue("/root/tempData/CURLIST/record/use_a");
								datagrid1.valueMatrix(row, 11) = model1.getValue("/root/tempData/CURLIST/record/use_c");
								datagrid1.valueMatrix(row, 12) = model1.getValue("/root/tempData/CURLIST/record/use_b");
								
								var rv_issu_dt = datagrid1.valueMatrix(row,2);
									
								for (var i=row; i<rows+1; i++){
										
										var tot_use_wgt_a = 0;
										var tot_use_wgt_c = 0;
										var tot_use_wgt_b = 0;
										
										//입고
										for( var j = i-10 ; j<i+5 ; j++)
										{
											if (datagrid1.valueMatrix(j,2) == datagrid1.valueMatrix( i,2)){
											
												if(datagrid1.valueMatrix(j,47) != "10")
												{
														tot_use_wgt_a = Number(tot_use_wgt_a) + Number(datagrid1.valueMatrix(j,10));  
														tot_use_wgt_c = Number(tot_use_wgt_c) + Number(datagrid1.valueMatrix(j,11));  
														tot_use_wgt_b = Number(tot_use_wgt_b) + Number(datagrid1.valueMatrix(j,12));  
													
												}
											}
											
										}
										
										if (datagrid1.valueMatrix(i,2) == rv_issu_dt){
											
											if(datagrid1.valueMatrix(i,47) == "10")
											{
											datagrid1.valueMatrix(i,10) = tot_use_wgt_a;
											datagrid1.valueMatrix(i,11) = tot_use_wgt_c;
											datagrid1.valueMatrix(i,12) = tot_use_wgt_b;
											//alert(tot_use_wgt_a);
											}
										}
								}
								
								//model1.removeNodeset("/root/tempData/dataSet");
								makeTable();
								model1.refresh();
								break;
						}
					]]>
				</script>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						
						var cell = datagrid1.selectedCells;
						var codeVal;
						if(cell.length < 1){
							alert("select a Cell");
							return;
						}
						
						var col = cell.item(0).col;
						var row = cell.item(0).row;
						var rows = datagrid1.rows;
						var fac_clsf = model.getValue("/root/reqData/searchData/fac_clsf");
						var clos_clsf = datagrid1.valueMatrix(row, 54);
						var issu_dt = datagrid1.valueMatrix(row,2);
						var issu_dt_day = datagrid1.valueMatrix(row,1);
						
						if(issu_dt != getCurrentDate()){
							if(clos_clsf =="Y" ){
								alert("마감되었습니다.");
								//datagrid1.valueMatrix(row, col) = "";
								return;
							}else{
								
							model.setValue("/root/reqData/reqForm2/fac_clsf", 		fac_clsf );	
							model.setValue("/root/reqData/reqForm2/issu_dt", 		issu_dt );	
							model.setValue("/root/reqData/reqForm2/issu_dt_day", 		issu_dt_day );
							}
						}
						
					
						
					]]>
				</script>
			</datagrid>
		</group>
		<group id="group1" style="left:9px; top:849px; width:496px; height:25px; ">
			<caption id="caption4" style="left:60px; top:0px; width:55px; height:20px; ">합쇄1</caption>
			<input id="input5" style="left:0px; top:0px; width:60px; height:25px; background-color:#00EE00; "/>
			<caption id="caption5" style="left:170px; top:0px; width:55px; height:20px; ">합쇄2</caption>
			<input id="input1" style="left:110px; top:0px; width:60px; height:18px; background-color:#00EE80; "/>
			<caption id="caption7" style="left:275px; top:0px; width:55px; height:20px; ">합쇄3</caption>
			<input id="input3" style="left:215px; top:0px; width:60px; height:18px; background-color:#00EEFF; "/>
			<caption id="caption8" style="left:390px; top:0px; width:100px; height:20px; ">시간외 인쇄</caption>
			<input id="input4" style="left:330px; top:0px; width:60px; height:18px; background-color:#FFAAFF; "/>
		</group>
		<button id="button4" class="btn02" style="left:806px; top:215px; width:52px; height:21px; ">
			<caption>저장</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					for (var i=2; i< datagrid1.rows;i++){
//						var clos_clsf = datagrid1.valueMatrix(i, 53);
//						
//						if(clos_clsf =="N"){
							datagrid1.rowStatus(i) = 2;
//						}
							
					}
				
				
					if (window.alert("저장하시겠습니까?", "저장", 1) != 1) {
						return;
					}
					model.setValue("/root/reqData/reqForm/fac_clsf", 		model.getValue("/root/reqData/searchData/fac_clsf"));	
					model.setValue("/root/reqData/reqForm/multiUpData", 		datagrid1.getUpdateData());	
					model.send("mt_papord_8004");
					
					if(submit_completed()) {
						datagrid1.clearStatus();
						model.removenode("/root/resData/gridData/main2");
						model.makeNode("/root/resData/gridData/main2/record");
						datagrid1.refresh();
						
						
						model.send("mt_papord_8002");
					
						//model.copyNode("/root/resData/gridData/baseData", "/root/tempData");
						//datagrid3.refresh();
						datagrid1.refresh();
						makeTable();
						//datagrid2.rows = 1;
//						model.removenode("/root/resData/gridData/main2");
//						model.makeNode("/root/resData/gridData/main2/record");
//						datagrid1.refresh();
//						

						model1.send("mt_papord_8201");
					//model1.copyNode("/root/resData/gridData/rate/rocord","/root/tempData/dataSet/CURLIST/rocord");
								
						datagrid5.refresh();
					
					}
					
				]]>
			</script>
		</button>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData/max/record" caption="최대수용량^최대수용량^최대수용량" colsep="^" colwidth="42, 42, 42" dataheight="25" mergecellsfixedrows="bycolrec" rowheight="25" rowsep="|" style="left:1241px; top:185px; width:126px; height:52px; font-size:15; ">
			<col ref="roll_a" style="height:25; font-size:15pt; font-weight:bold; word-wrap:none; "/>
			<col ref="roll_c" style="left:42px; top:20px; width:42px; height:25; font-size:20; font-weight:bold; "/>
			<col ref="roll_b" style="height:25; font-size:20; font-weight:bold; "/>
		</datagrid>
		<button id="button5" class="btn02" visibility="hidden" style="left:985px; top:100px; width:52px; height:21px; ">
			<caption>--*</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				
					model.send("mt_papord_8007");
					
					
					
				]]>
			</script>
		</button>
		<button id="button6" class="btn07" style="left:890px; top:190px; width:120px; height:21px; ">
			<caption>1주전 발주량 불러오기</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.setValue("/root/reqData/searchData/gubun", 		"A");	
					
				
					model.send("mt_papord_8008");
					model.copyNode("/root/resData/gridData/ref", "/root/tempData/gridData");
					
					datagrid4.refresh();
					model1.refresh();
					
					for (var i=1; i<datagrid4.rows; i++){
						var occr_dt = datagrid4.valueMatrix(i, 0);
						var pap_row = datagrid4.valueMatrix(i, 1);
						
						
						for (var j=2; j<datagrid1.rows; j++){
							var ord_occr_dt = datagrid1.valueMatrix(j, datagrid1.colRef("issu_dt"));
							var ord_pap_row = datagrid1.valueMatrix(j, datagrid1.colRef("row_num"));
							//alert(ord_occr_dt);

							if(occr_dt == ord_occr_dt && pap_row == ord_pap_row)
							{
								//alert(ord_occr_dt);
								
								datagrid1.valueMatrix(j, datagrid1.colRef("car_c")) = datagrid4.valueMatrix(i, datagrid4.colRef("car_cnt_c") );
								datagrid1.valueMatrix(j, datagrid1.colRef("car_b")) = datagrid4.valueMatrix(i, datagrid4.colRef("car_cnt_b"));
								datagrid1.valueMatrix(j, datagrid1.colRef("car_cnt")) = datagrid4.valueMatrix(i, datagrid4.colRef("car_cnt_a"));
								
							}
			
						}
					}
					setEwhTotal();
					makeTable();
				]]>
			</script>
		</button>
		<button id="button7" class="btn02" style="left:1015px; top:190px; width:52px; height:21px; ">
			<caption>2주전</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.setValue("/root/reqData/searchData/gubun", 		"B");	
					
				
					model.send("mt_papord_8008");
					model.copyNode("/root/resData/gridData/ref", "/root/tempData/gridData");
					
					datagrid4.refresh();
					model1.refresh();
					
					for (var i=1; i<datagrid4.rows; i++){
						var occr_dt = datagrid4.valueMatrix(i, 0);
						var pap_row = datagrid4.valueMatrix(i, 1);
						
						
						for (var j=2; j<datagrid1.rows; j++){
							var ord_occr_dt = datagrid1.valueMatrix(j, datagrid1.colRef("issu_dt"));
							var ord_pap_row = datagrid1.valueMatrix(j, datagrid1.colRef("row_num"));
							//alert(ord_occr_dt);

							if(occr_dt == ord_occr_dt && pap_row == ord_pap_row)
							{
								//alert(ord_occr_dt);
								
								datagrid1.valueMatrix(j, datagrid1.colRef("car_c")) = datagrid4.valueMatrix(i, datagrid4.colRef("car_cnt_c") );
								datagrid1.valueMatrix(j, datagrid1.colRef("car_b")) = datagrid4.valueMatrix(i, datagrid4.colRef("car_cnt_b"));
								datagrid1.valueMatrix(j, datagrid1.colRef("car_cnt")) = datagrid4.valueMatrix(i, datagrid4.colRef("car_cnt_a"));
							}
			
						}
					}
					
					setEwhTotal();
					makeTable();
				]]>
			</script>
		</button>
		<datagrid id="datagrid5" nodeset="/root/resData/gridData/rate/dataSet/CURLIST/record" backcoloralternate="transparent" backcolorfrozen="transparent" caption="제지사^조정할 비율^조정할 량" colsep="#" colwidth="66, 84, 74" dataheight="20" mergecellsfixedrows="bycolrec" rowheader="select" rowheight="20" rowsep="|" selectionmode="free" style="left:370px; top:100px; width:245px; height:105px; font-size:10pt; ">
			<col ref="paper_cmpy"/>
			<col ref="diff_rate" format="(-)0.#" style="left:200px; top:25px; width:100px; height:20px; font-size:14pt; text-align:right; "/>
			<col ref="ad_wgt" format="(-)#,###.#" style="left:100px; top:25px; width:100px; height:20px; font-size:14pt; text-align:right; "/>
		</datagrid>
		<button id="button8" class="btn02" style="left:940px; top:41px; width:52px; height:21px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				
							//alert(Node_pcnt + "\n" + Node_clr_pcnt);
					var issu_dt_day = model.getValue("/root/reqData/reqForm2/issu_dt_day");	
					var issu_dt = model.getValue("/root/reqData/reqForm2/issu_dt");	
					if(issu_dt =="" ){
						alert("선택한 날짜가 없습니다.");
						//datagrid1.valueMatrix(row, col) = "";
						return;
					}
						
					if (window.alert(issu_dt_day+" 일자 데이터를 삭제하시겠습니까?", "삭제", 1) != 1) {
						return;
					}		
					model.send("mt_papord_8009");
					if(submit_completed()) {
						datagrid1.clearStatus();
						model.removenode("/root/resData/gridData/main2");
						model.makeNode("/root/resData/gridData/main2/record");
						datagrid1.refresh();
						
						
						model.send("mt_papord_8002");
					
					
						datagrid1.refresh();
						makeTable();

						model1.send("mt_papord_8201");
								
						datagrid5.refresh();
					
					}
					
					
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
