<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<searchData>
							<fac_clsf/>
							<issu_dt/>
							<clos/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqForm>
						</reqForm>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<multiUpDate/>
						<!-- MultiUpDate유형 사용시 처리 -->
						<fwdData>
							<pajiInfo>
								<pajiKind/>
								<pajiNm/>
								<row/>
							</pajiInfo>
						</fwdData>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<msg/>
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData_1>
							<record>
								<hdqt_paper_clsf/>
								<prt_dt/>
								<issu_dt/>
								<medi_cd/>
								<sect_cd/>
								<pap_std/>
								<issu_pcnt/>
								<slip_qty/>
								<matr_cd_a/>
								<use_qunt_a/>
								<matr_cd_b/>
								<use_qunt_b/>
								<matr_cd_c/>
								<use_qunt_c/>
								<use_qunt_tot/>
								<cmpy_cd/>
								<occr_dt/>
								<seq/>
							</record>
						</gridData_1>
						<gridData_2>
							<record>
								<hdqt_paper_clsf/>
								<prt_dt/>
								<issu_dt/>
								<medi_cd/>
								<sect_cd/>
								<pap_std/>
								<issu_pcnt/>
								<slip_qty/>
								<matr_cd_a/>
								<use_qunt_a/>
								<matr_cd_b/>
								<use_qunt_b/>
								<matr_cd_c/>
								<use_qunt_c/>
								<use_qunt_tot/>
								<cmpy_cd/>
								<occr_dt/>
								<seq/>
							</record>
						</gridData_2>
						<gridData_3>
							<record>
								<title/>
								<medi_cd_nm/>
								<sect_cd_nm/>
								<cd/>
								<cdnm/>
								<mang_cd_1/>
								<tmpdata/>
								<cnt/>
								<wgt/>
								<hdqt_paper_clsf/>
								<medi_cd/>
								<sect_cd/>
								<pre_prt_clsf/>
								<issu_dt/>
								<prt_dt/>
							</record>
						</gridData_3>
						<resForm>
							<wgt_clsf/>
							<stat_flag/>
							<temp>
								<temp1/>
								<temp2/>
								<temp3/>
								<stat_flag/>
								<wgt_clsf/>
							</temp>
						</resForm>
						<gridData_4>
							<record/>
						</gridData_4>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
				     function setInitData( issu_dt , fac_clsf , magam_yn ){
				     	
				     	model1.setValue("/root/reqData/searchData/fac_clsf", fac_clsf);
						model1.setValue("/root/reqData/searchData/issu_dt", issu_dt);
						model1.setValue("/root/reqData/searchData/clos", magam_yn);
						
					//	model1.send("mt_prnpap_3407");
						var node_1 = instance1.selectNodes("/root/resData/gridData_1");
						var node_2 = instance1.selectNodes("/root/resData/gridData_2");
						var node_3 = instance1.selectNodes("/root/resData/gridData_3");
						node_1.reset();
						node_2.reset();
						node_3.reset();
						
						model.copyNode("/root/resData/gridData_1", "/root/resData/resForm/temp/temp1");
						model.copyNode("/root/resData/gridData_2", "/root/resData/resForm/temp/temp2");
						model.copyNode("/root/resData/gridData_3", "/root/resData/resForm/temp/temp3");
						
						model.setValue("/root/resData/resForm/wgt_clsf", model1.getValue("/root/resData/resForm/temp/wgt_clsf"));
						model.setValue("/root/resData/resForm/stat_flag", model1.getValue("/root/resData/resForm/temp/stat_flag"));
						model1.refresh();
						
						pageSet();
					}
					
					
					function pageSet(){
						 gridSet();
						var statFlag =  model1.getValue("/root/resData/resForm/stat_flag");
						/*
						     statFlag 
						          00 확정 이전 미 입력 상태 
						          01 확정 상태 
						          02 파지량 입력 상태
						*/
						ligthgridCreat();
						
						for( var i = 1 ; i < datagrid4.rows; i++){
							if ( datagrid4.valueMatrix(i, 3 ) == '1' ){
								datagrid4.rowHidden(i) = true;
							}
							else {continue;}
						}
						
						if( statFlag == '00') {
							   button1.disabled = false;
							   button2.disabled = true;
							   button3.disabled = true;
							   combo1.disabled = false;
							   datagrid2.isReadOnly( 1,1, datagrid2.rows-1, datagrid2.cols-1) = false;
							   
						}
						else if (statFlag == '01') {
							   button1.disabled = true;
							   button2.disabled = false;
							   button3.disabled = false;
							   combo1.disabled = true;
							   datagrid2.isReadOnly( 1,1, datagrid2.rows-1, datagrid2.cols-1) = true;
							   datagrid4.isReadOnly( 1,1, datagrid4.rows-1, datagrid4.cols-1) = true;
						}
						else if (statFlag == '02') {
							   button1.disabled = true;
							   if ( model1.getValue("/root/reqData/searchData/clos") == '02' || model1.getValue("/root/reqData/searchData/clos") == '01' ){
							   			button2.disabled = true;
							   			button3.disabled = true;
							   }else {   button2.disabled = false;
							                 button3.disabled = false; }
							   combo1.disabled = true;
							   datagrid2.isReadOnly( 1,1, datagrid2.rows-1, datagrid2.cols-1) = true;
							   datagrid4.isReadOnly( 1,1, datagrid4.rows-1, datagrid4.cols-1) = true;
						}
						
						datagrid4.initStyle("border-top-color");
						datagrid4.initStyle("border-top-width");
						datagrid4.initStyle("border-top-style");
						
						for (var i=1; i<datagrid4.rows; i++) {
							if (datagrid4.valueMatrix(i, 0) == "소계"){
								datagrid4.cellstyle("border-top-color", i, 0, i, 9) = "#333300";
								datagrid4.cellstyle("border-top-width", i, 0, i, 9) = "4px";
								datagrid4.cellstyle("border-top-style", i, 0, i, 9) = "solid";
								//border-color:#333300; border-top-width:2px; border-style:solid;
							}
						}
					}
					function ligthgridCreat(){
						if( datagrid2.rows > 1 ){
							  datagrid2.dispatch("xforms-value-changed");
						}
						 
						 if( datagrid3.rows > 3 ) {  datagrid3.rows = 3; }
						  
						 var statFlag =  model1.getValue("/root/resData/resForm/stat_flag");
						 if( statFlag != '02' ) return ;
						 
						 model1.send("mt_prnpap_3416");
						 datagrid3.refresh();
		 		 
						 if( datagrid3.rows > 3 ){
						 	 // 총 파지량 계산 
						 	 for ( var i = 3 ; i < datagrid3.rows ; i++){
						 	 	 var a_somo_kg = 0 ;
				 	 	  	  	 var b_somo_kg = 0;
				 	 	  		 var c_somo_kg = 0;
				 	 	  		 var tot_somo_kg = 0;
						 	 
						 	 	  for ( var ii = 0 ; ii < datagrid3.cols; ii++){
						 	 	  		
						 	 	  		if( datagrid3.valueMatrix( 2, ii ) != '중량') continue;
						 	 	  		
						 	 	  		var gubun = datagrid3.valueMatrix(0 , ii ).substr(0, 1);
						 	 	  		
						 	 	  		if( gubun == 'A') {
						 	 	  		         a_somo_kg = a_somo_kg + Number( datagrid3.valueMatrix(i, ii ) );
						 	 	  		}
						 	 	  		if( gubun == 'B') {
						 	 	  		         b_somo_kg = b_somo_kg + Number( datagrid3.valueMatrix(i, ii ) );
						 	 	  		}
						 	 	  		if( gubun == 'C') {
						 	 	  		         c_somo_kg = c_somo_kg + Number( datagrid3.valueMatrix(i, ii ) );
						 	 	  		}
						 	 	  		
						 	 	  		
						 	 	  }
						 	       //tot_somo_kg = a_somo_kg + b_somo_kg - c_somo_kg;
						 	       tot_somo_kg = a_somo_kg  + b_somo_kg;
						 	       datagrid3.valueMatrix(i, 1 )  = tot_somo_kg;
						 	 }
						 	 
						 }
						 
					}

					function func_bebun_cd5(totWgt, row){
						   var cd5Totwgt = totWgt;
						   
						   model1.makeNode("/root/reqData/searchData/wgt");
						   model1.setValue("/root/reqData/searchData/wgt",  cd5Totwgt);
						   
						   model1.send("mt_prnpap_3411");
						   model1.destroy("/root/reqData/searchData/wgt");
						   
						   var node = instance1.selectNodes("/root/tempData/gridData/record");
						   
						   for ( var i = row + 1 ; i < datagrid4.rows; i++){
						   		if( datagrid4.valueMatrix( i , 0) == '소계') break;
						   		if( datagrid4.valueMatrix( i,  9) == '01') continue;
						   		if( datagrid4.valueMatrix( i, 9 ) == '02' ||  datagrid4.valueMatrix( i, 9 ) == '03' ||  datagrid4.valueMatrix( i, 9 ) == '04'){
						   			    var gridMedi_cd = datagrid4.valueMatrix( i , 10);
						   			    var gridSect_cd = datagrid4.valueMatrix( i , 11);
						   			    var gridPreprt    = datagrid4.valueMatrix( i , 12);
						   			    
						   			    
						   			    for ( var ii = 0 ; ii < node.length ; ii++){
						   			    		var resMedi_cd = node.item(ii).medi_cd.value;
						   			    		var resSect_cd = node.item(ii).sect_cd.value;
						   			    		var resPreprt_cd = node.item(ii).gubun.value;
						   			    		var resWgt = node.item(ii).wgt.value;
						   			    		//alert(gridMedi_cd+"#"+ gridSect_cd+"#"+gridPreprt+"\n" + resMedi_cd +"#"+resSect_cd+"#"+resPreprt_cd+"#"resWgt);
						   			    		
						   			    		if( ( gridMedi_cd == resMedi_cd ) && ( gridSect_cd == resSect_cd )  && ( gridPreprt == resPreprt_cd ) ){
						   			    			datagrid4.valueMatrix( i , 8) = resWgt;
						   			    			break;
						   			    		}
						   			    }
						   		}
						   }	 
						   
					}
					
					function gridSet(){
						       var cnt  =  0 ;
						       var wgt =  0 ;
							
							for( var i = 1 ; i < datagrid4.rows ; i++){
								if ( datagrid4.valueMatrix( i , 0 ) == '소계'){
										datagrid4.rowStyle(i, "all", "background-color") = "#ffff99";
								}
								else {
									       datagrid4.rowStyle(i, "all", "background-color") = "#ffffff";
								}
							}
							WgtGubunSet();
					}
					
					function WgtGubunSet(){
						
						 var wgt_yn = model1.getValue("/root/resData/resForm/wgt_clsf");
						// alert(wgt_yn);
						 for( var i = 1 ; i < datagrid4.rows ; i++){
						 	        var inputYn = datagrid4.valueMatrix(i, 5);
						 	        var pj_kind  = datagrid4.valueMatrix(i,  3);
						 	
						 		if ( datagrid4.valueMatrix( i , 9 ) == '01' || datagrid4.valueMatrix( i , 12 ) == 'Y'){    // 본지 이거나 선인쇄는 입력 불가 
						 	                var Chkmatr_cd = datagrid4.valueMatrix( i , 10 );
						 	                var Chksect_cd = datagrid4.valueMatrix( i , 11 );
						 	                // alert(Chkmatr_cd + "%%%" + Chksect_cd + "%%%" + pj_kind);
						 	                 
						 	                 
						 	                if( Chkmatr_cd == '000' &&  Chksect_cd == '0000' && pj_kind == '2'){
						 	                	 datagrid4.isReadOnly( i , 8) = false;
					 				        datagrid4.cellStyle( "background-color" , i,8) = "#ffff99";
						 	                } 	
						 			 else {
						 			 	datagrid4.cellStyle( "background-color" , i,0, i ,datagrid4.cols -1 ) = "#c0c0c0";
						 			        datagrid4.isReadOnly( i , 1, i, datagrid4.cols-1 ) = true; 
						 			 }
						 		}
						 		else {
						 			if ( wgt_yn == 'Y' ){ // 중량계 존재 
						 			     datagrid4.isReadOnly( i , 6 ) = true; 	 
						 			     datagrid4.cellStyle( "background-color" , i,6 ) = "#c0c0c0";
						 			     datagrid4.isReadOnly( i , 7, i, 8) = false;
					 				     datagrid4.cellStyle( "background-color" , i,7, i,8) = "#ffff99";
						 			}
						 			else {
						 			      
						 			     datagrid4.isReadOnly( i , 6 ) = false; 	 
						 			     datagrid4.cellStyle( "background-color" , i,6 ) = "#ffff99";
						 			     datagrid4.isReadOnly( i , 7, i, 8) = false;
					 				     datagrid4.cellStyle( "background-color" , i,7, i,8) = "#ffff99";
						 			}     
						 			
					 			       if ( inputYn == 'Y' ) {        // 개수 입력 여부 
					 			               datagrid4.isReadOnly( i , 7, i, 8) = false;
					 					datagrid4.cellStyle( "background-color" , i,7, i,8) = "#ffff99";
					 			       }
					 			      else{
					 			      	       datagrid4.isReadOnly( i , 6 ) = true; 	 
						 			       datagrid4.cellStyle( "background-color" , i,6 ) = "#c0c0c0";
					 			  		datagrid4.isReadOnly( i , 7) = true;
						 				datagrid4.cellStyle( "background-color" , i,7) = "#c0c0c0";
						 				if( datagrid4.valueMatrix( i , 0) == '소계' && datagrid4.valueMatrix( i , 3) == '2' ){
						 					datagrid4.isReadOnly( i , 8) = true;
						 					datagrid4.cellStyle( "background-color" , i,7) = "#c0c0c0";
						 				}else{
							 				datagrid4.isReadOnly( i , 8) = false;
							 				datagrid4.cellStyle( "background-color" , i,8) = "#ffff99";
						 				}
					 			      }
						 		      
						 		}	
						 }
					}
					function funReset() {
						model1.reset();
					}
					function  funPageRefresh(){
									  model1.send("mt_prnpap_3418");
									  model.copyNode("/root/resData/gridData_1", "/root/tempData/thisPage1");
									  model.copyNode("/root/resData/gridData_2", "/root/tempData/thisPage2");
									  model.copyNode("/root/resData/gridData_3", "/root/tempData/thisPage3");
									
									  model.setValue("/root/resData/resForm/wgt_clsf", model1.getValue("/root/tempData/wgt_clsf"));
									  model.setValue("/root/resData/resForm/stat_flag", model1.getValue("/root/tempData/stat_flag"));
								          
								          model1.copyNode(parent.root.resData.gridData , " /root/tempData/mainPage");
								          datagrid1.clearStatus();
								          model1.refresh();
								          pageSet();
								          parent.datagrid1.refresh();
								          parent.window.javascript.subTotal();
					}
					function gridMath(row, col){
						     // 소계 위치 확인 
						     var befor_row = Number(row);
						     var after_row = Number(row) + 1 ;
						     var totValue = 0;
						     var sumValue = 0;
						      for ( befor_row ; befor_row >= 1 ; befor_row--){
						     	   	if( datagrid4.valueMatrix( befor_row , 0 ) == '소계'){
						     	   	             break;
						     	   	}
						     }
						    
						     for ( after_row ; after_row < datagrid4.rows; after_row++){
						     		if( datagrid4.valueMatrix( after_row , 0 ) == '소계'){
						     	   	             break;
						     	   	}
						     }
						      totValue = Number(datagrid4.valueMatrix(befor_row, col));  // 소계 
						    if( totValue == 0 ) {
						     	          for ( var i = befor_row ; i < after_row ; i++){
								     		if( datagrid4.valueMatrix( i , 9 ) == '01') {
								     			  datagrid4.valueMatrix(i, col) = 0;
								     			  break;
								     		}
								     }
						     }
						     else { 
								     for( var i = befor_row + 1 ; i < after_row ; i++){
								     	        if( datagrid4.valueMatrix(i, 9) == '01' ) continue;
								     	    
								                sumValue =  sumValue + Number(datagrid4.valueMatrix(i, col));
								     }
								     
								     
								     //본지에 적용 
								     for ( var i = befor_row ; i < after_row ; i++){
								     		if( datagrid4.valueMatrix( i , 9 ) == '01') {
								     			  datagrid4.valueMatrix(i, col) = totValue - sumValue;
								     			  break;
								     		}
								     }
						     }
						     
					}
					function gridBLKMath(row, col){
						     // 소계 위치 확인 
						     var befor_row = Number(row);
						     var after_row = Number(row) + 1 ;
						     var totValue = 0;
						     var sumValue = 0;
						   
						      for ( befor_row ; befor_row >= 1 ; befor_row--){
						     	   	if( datagrid4.valueMatrix( befor_row , 0 ) == '소계'){
						     	   	             break;
						     	   	}
						     }
						  //   alert(befor_row);
						    // var bw_wgt  =  datagrid2.valueMatrix(i, 18);
						    
						     for ( after_row ; after_row < datagrid4.rows; after_row++){
						     		if( datagrid4.valueMatrix( after_row , 0 ) == '소계'){
						     	   	             break;
						     	   	}
						     }
						   //  alert(after_row);
						     
						     for( var j = 1 ; j < datagrid2.rows; j++){
						     	    sumValue = sumValue + Number(datagrid2.valueMatrix(j, 18));
						     }
						  
						     for( var i = befor_row + 1 ; i < after_row ; i++){
						     			sumValue =  sumValue + Number(datagrid4.valueMatrix(i, 8));
						     }
						     // alert(sumValue);
						     datagrid4.valueMatrix(befor_row, 8) = sumValue;
					}
				]]>
			</script>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<submission id="mt_prnpap_3409" action="/mt/prnpap/3409" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_prnpap_3410" action="/mt/prnpap/3410" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_prnpap_3411" action="/mt/prnpap/3411" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mt_prnpap_3416" action="/mt/prnpap/3416" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData_4/record"/>
			<submission id="mt_prnpap_3417" action="/mt/prnpap/3417" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" replace="instance" resultref="/root/tempData"/>
			<submission id="mt_prnpap_3418" action="/mt/prnpap/3418" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
		</model>
	</xhtml:head>
	<xhtml:body pagewidth="925" pageheight="900" guideline="1,7;2,503;2,494;2,4;1,908;">
		<group id="group1" style="left:10px; top:10px; width:898px; height:429px; ">
			<caption id="caption3" class="list_cap02" style="left:0px; top:0px; width:898px; height:25px; text-align:center; "/>
			<caption id="caption18" class="list_cap01" style="left:0px; top:0px; width:168px; height:25px; text-align:center; ">A. 전일 선인쇄량</caption>
			<datagrid id="datagrid1" nodeset="/root/resData/gridData_1/record" caption="본사용지구분^인쇄일자^발행일자^매체^섹션^규격^면수^부수^A권자재코드^A권^B권자재코드^B권^C권자재코드^C권^총사용량^회사코드^발생일자^SEQ" colsep="^" colwidth="19, 82, 84, 109, 100, 49, 44, 66, 5, 70, 3, 70, 3, 70, 90, 100, 100, 100" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:24px; width:898px; height:71px; ">
				<col ref="hdqt_paper_clsf" visibility="hidden"/>
				<col ref="prt_dt" format="yyyy-mm-dd"/>
				<col ref="issu_dt" format="yyyy-mm-dd"/>
				<col ref="medi_cd"/>
				<col ref="sect_cd"/>
				<col ref="pap_std"/>
				<col ref="issu_pcnt" format="#,###" style="text-align:right; "/>
				<col ref="slip_qty" format="#,###" style="text-align:right; "/>
				<col ref="matr_cd_a" visibility="hidden"/>
				<col ref="use_qunt_a" format="#,###" style="text-align:right; "/>
				<col ref="matr_cd_b" visibility="hidden"/>
				<col ref="use_qunt_b" format="#,###" style="text-align:right; "/>
				<col ref="matr_cd_c" visibility="hidden"/>
				<col ref="use_qunt_c" format="#,###" style="text-align:right; "/>
				<col ref="use_qunt_tot" format="#,###" style="text-align:right; "/>
				<col ref="cmpy_cd" visibility="hidden"/>
				<col ref="occr_dt" visibility="hidden"/>
				<col ref="seq" visibility="hidden"/>
			</datagrid>
			<caption id="caption1" class="list_cap02" style="left:0px; top:100px; width:898px; height:25px; text-align:center; "/>
			<caption id="caption2" class="list_cap01" style="left:0px; top:100px; width:168px; height:25px; text-align:center; ">B. 금일 선인쇄량</caption>
			<datagrid id="datagrid2" nodeset="/root/resData/gridData_2/record" caption="본사용지구분^인쇄일자^발행일자^매체^섹션^규격^면수^부수^A권자재코드^A권^B권자재코드^B권^C권자재코드^C권^총사용량^회사코드^발생일자^SEQ^선인쇄 흑파" colsep="^" colwidth="19, 81, 86, 108, 100, 43, 49, 64, 5, 70, 2, 70, 3, 70, 80, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:125px; width:898px; height:80px; ">
				<col ref="hdqt_paper_clsf" visibility="hidden"/>
				<col ref="prt_dt" format="yyyy-mm-dd"/>
				<col ref="issu_dt" format="yyyy-mm-dd"/>
				<col ref="medi_cd"/>
				<col ref="sect_cd"/>
				<col ref="pap_std"/>
				<col ref="issu_pcnt" format="#,###" style="text-align:right; "/>
				<col ref="slip_qty" format="#,###" style="text-align:right; "/>
				<col ref="matr_cd_a" visibility="hidden"/>
				<col ref="use_qunt_a" format="#,###" style="text-align:right; "/>
				<col ref="matr_cd_b" visibility="hidden"/>
				<col ref="use_qunt_b" format="#,###" style="text-align:right; "/>
				<col ref="matr_cd_c" visibility="hidden"/>
				<col ref="use_qunt_c" format="#,###" style="text-align:right; "/>
				<col ref="use_qunt_tot" format="#,###" style="text-align:right; "/>
				<col ref="cmpy_cd" visibility="hidden"/>
				<col ref="occr_dt" visibility="hidden"/>
				<col ref="seq" visibility="hidden"/>
				<col ref="bw_pj_wgt" type="input"/>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					               /*
					               var  row = datagrid2.row;
					               
					               var hdqt_paper_clsf = datagrid2.valueMatrix( row, 0);
					               var prt_dt     =  datagrid2.valueMatrix(row, 1) ;
					               var issu_dt   = datagrid2.valueMatrix(row, 2);
					               var medi_cd = datagrid2.valueMatrix( row , 3);
					               var sect_cd = datagrid2.valueMatrix(row, 4);
					               var bw_wgt  =  datagrid2.valueMatrix(row, 18);
					               
					             				
							for ( var i = 1 ; i < datagrid4.rows; i++){
								var pj_kind = datagrid4.valueMatrix( i , 3);
								var ghdqt_paper_clsf = datagrid4.valueMatrix( i ,9 );
								var gmedi_cd = datagrid4.valueMatrix(i, 10);
								var gsect_cd = datagrid4.valueMatrix(i ,11);
								var gper_prt_yn = datagrid4.valueMatrix(i, 12);
								var gissu_dt  = datagrid4.valueMatrix(i, 13);
								var gprt_dt   = datagrid4.valueMatrix(i, 14);
								
								 if( (hdqt_paper_clsf == ghdqt_paper_clsf)  &&     
								             (prt_dt == gprt_dt) &&  ( issu_dt == gissu_dt) && (medi_cd == gmedi_cd ) &&
								                         (sect_cd == gsect_cd ) && (pj_kind == '2') && ( gper_prt_yn == 'Y') ){
								               datagrid4.valueMatrix( i ,  8 )  = bw_wgt;
								               gridBLKMath( i, 8);
								               break;
								  }
							} 
							*/
							//alert("111111111");
							
							for ( var i = 1 ; i < datagrid4.rows; i++){
								 var pj_kind = datagrid4.valueMatrix( i , 3);
								 var title    = datagrid4.valueMatrix( i ,0 );
								 
								 if ( title == '소계' && pj_kind == '2'){
								 	        //alert(">>>>" + i);
							 			gridBLKMath( i, 8);
							                       break;
								 }
							}
							
							
					]]>
				</script>
			</datagrid>
			<caption id="caption4" class="list_cap02" style="left:0px; top:210px; width:898px; height:25px; text-align:center; "/>
			<caption id="caption5" class="list_cap01" style="left:0px; top:210px; width:168px; height:25px; text-align:center; ">C. 금일  파지량</caption>
			<datagrid id="datagrid4" nodeset="/root/resData/gridData_3/record" caption="본사용지구분^매체명^섹션명^파지구분코드^파지구분^심봉입력여부^수치/잔량^개수^중량^본사용지구분코드^매체코드^섹션코드^선인쇄여부^발생일자^인쇄일자" colsep="^" colwidth="100, 130, 113, 36, 120, 24, 70, 100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowsep="|" selectionmode="free" style="left:0px; top:237px; width:898px; height:188px; ">
				<col ref="title"/>
				<col ref="medi_cd_nm"/>
				<col ref="sect_cd_nm"/>
				<col ref="cd" visibility="hidden"/>
				<col ref="cdnm" style="font-weight:bold; "/>
				<col ref="mang_cd_1" visibility="hidden"/>
				<col ref="tmpdata" type="inputbutton"/>
				<col ref="cnt" type="input"/>
				<col ref="wgt" type="input"/>
				<col ref="hdqt_paper_clsf" visibility="hidden"/>
				<col ref="medi_cd" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<col ref="pre_prt_clsf" visibility="hidden"/>
				<col ref="issu_dt" visibility="hidden"/>
				<col ref="prt_dt" visibility="hidden"/>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
							var row = datagrid4.row;
							var col  = datagrid4.col;
							var tot = 0 ;
							var sp_tot = 0;
							var bonji = 0;
							 
							//확인차 ....
							//if( datagrid4.valueMatrix(row, 0 ) != '소계') return;
							
							switch( col ){
								case 6:
								                break;
								case 7:
										 gridMath(row, col);
								               break;
								case 8:
								                
										 if( datagrid4.valueMatrix(row, 0 ) == '소계'){
										 	var cd = Number(datagrid4.valueMatrix(row, 3)) ;
										 	
										 	tot = Number(datagrid4.valueMatrix(row , 8));
								                      if( cd == 5 ){
								    				func_bebun_cd5( tot , row);  // 설지 배분 
								                      }
								                      if ( cd != 2) {
								                      	               switch( cd ) {
								                      	               	
								                      	               	case 3 :    
								                      	               	                 var tCnt = Number(datagrid4.valueMatrix(row , datagrid4.colRef("cnt")) ) ;
								                      	               	                 var tWgt = Number(datagrid4.valueMatrix( row, datagrid4.colRef("wgt") )) ;
								                      	               	                  
								                      	               	                 if( (  tCnt * 6 ) > tWgt ) {
								                      	               	                 		alert( datagrid4.valueMatrix( row , datagrid4.colRef("cnt") ) + "의 심봉 개수 (" + tCnt + "개)의 최소 중량은\n" +  (tCnt * 6) + "입니다. 확인 하세요"); 
								                      	               	                 }
								                      	               	                 break;
								                      	               	case 4 : 
								                      	               	                 var tCnt = Number(datagrid4.valueMatrix(row , datagrid4.colRef("cnt")) ) ;
								                      	               	                 var tWgt = Number(datagrid4.valueMatrix( row, datagrid4.colRef("wgt") )) ;
								                      	               	                 if( (  tCnt * 3 ) > tWgt ) {
								                      	               	                 		alert( datagrid4.valueMatrix( row , datagrid4.colRef("cnt") ) + "의 심봉 개수 (" + tCnt + "개)의 최소 중량은\n" +  (tCnt * 3) + "입니다. 확인 하세요"); 
								                      	               	                 }
								                      	               	                 break;
								                      	               	case  6 : 
								                      	               	                 var tCnt = Number(datagrid4.valueMatrix(row , datagrid4.colRef("cnt")) ) ;
								                      	               	                 var tWgt = Number(datagrid4.valueMatrix( row, datagrid4.colRef("wgt") )) ;
								                      	               	                 if( Math.round(  tCnt * 4.5 ) > tWgt ) {
								                      	               	                 		alert( datagrid4.valueMatrix( row , datagrid4.colRef("cnt") ) + "의 심봉 개수 (" + tCnt + "개)의 최소 중량은\n" +  Math.round(tCnt * 4.5) + "입니다. 확인 하세요"); 
								                      	               	                 }
								                      	               	                 break;
								                      	               }
								                      	               
								                      			gridMath(row, col);
								                      }
										}
										else {
											 var cd = Number(datagrid4.valueMatrix(row, 3)) ;
											 
											 if ( cd == 2 ){
											 		gridBLKMath( row, col);
											 }
											 else    {
											 	     switch( cd ) {
								                      	               	
								                      	               	case 3 :    
								                      	               	                 var tCnt = Number(datagrid4.valueMatrix(row , datagrid4.colRef("cnt")) ) ;
								                      	               	                 var tWgt = Number(datagrid4.valueMatrix( row, datagrid4.colRef("wgt") )) ;
								                      	               	                 
								                      	               	                 if( (  tCnt * 6 ) > tWgt ) {
								                      	               	                 		alert( datagrid4.valueMatrix( row , datagrid4.colRef("cnt") ) + "의 심봉 개수 (" + tCnt + "개)의 최소 중량은\n" +  (tCnt * 6) + "입니다. 확인 하세요"); 
								                      	               	                 }
								                      	               	                 break;
								                      	               	case 4 : 
								                      	               	                 var tCnt = Number(datagrid4.valueMatrix(row , datagrid4.colRef("cnt")) ) ;
								                      	               	                 var tWgt = Number(datagrid4.valueMatrix( row, datagrid4.colRef("wgt") )) ;
								                      	               	                 if( (  tCnt * 3 ) > tWgt ) {
								                      	               	                 		alert( datagrid4.valueMatrix( row , datagrid4.colRef("cnt") ) + "의 심봉 개수 (" + tCnt + "개)의 최소 중량은\n" +  (tCnt * 3) + "입니다. 확인 하세요"); 
								                      	               	                 }
								                      	               	                 break;
								                      	               	case  6 : 
								                      	               	                 var tCnt = Number(datagrid4.valueMatrix(row , datagrid4.colRef("cnt")) ) ;
								                      	               	                 var tWgt = Number(datagrid4.valueMatrix( row, datagrid4.colRef("wgt") )) ;
								                      	               	                 if( Math.round(  tCnt * 4.5 ) > tWgt ) {
								                      	               	                 		alert( datagrid4.valueMatrix( row , datagrid4.colRef("cnt") ) + "의 심봉 개수 (" + tCnt + "개)의 최소 중량은\n" +  Math.round(tCnt * 4.5) + "입니다. 확인 하세요"); 
								                      	               	                 }
								                      	               	                 break;
								                      	               }
								                      	               
								                      	               gridMath(row, col);
								                      	     }
										}
								                break;                
							}
					]]>
				</script>
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
							var row = datagrid4.row;
							var col  = datagrid4.col;
							
							 if( col == 6 ) {
								model1.setValue("/root/reqData/fwdData/pajiInfo/pajiKind" , datagrid4.valueMatrix(row, 3));
								model1.setValue("/root/reqData/fwdData/pajiInfo/pajiNm"  , datagrid4.valueMatrix(row, 4));
								model1.setValue("/root/reqData/fwdData/pajiInfo/row "      , row);
								window.load("/xrw/mt/prnpap/MT_PRNPAP_3401.xrw","modal", "mt_prnpap_3401", "width:530px;height:400px;", "/root/reqData/fwdData", "/root/reqData/fwdData"); 	
							}
					]]>
				</script>
				<script type="javascript" ev:event="onstartedit">
					<![CDATA[
							var row = datagrid4.row;
							var col  = datagrid4.col;
							
							if( col == 6 ) {
								model1.setValue("/root/reqData/fwdData/pajiInfo/pajiKind" , datagrid4.valueMatrix(row, 3));
								model1.setValue("/root/reqData/fwdData/pajiInfo/pajiNm"  , datagrid4.valueMatrix(row, 4));
								model1.setValue("/root/reqData/fwdData/pajiInfo/row "      , row);
								window.load("/xrw/mt/prnpap/MT_PRNPAP_3401.xrw","modal", "mt_prnpap_3401", "width:530px;height:400px;", "/root/reqData/fwdData", "/root/reqData/fwdData"); 	
							}
					]]>
				</script>
			</datagrid>
			<caption id="caption6" style="left:174px; top:216px; width:136px; height:15px; ">
				<![CDATA[>> 중량계 유무  :]]>
			</caption>
			<select1 id="combo1" ref="/root/resData/resForm/wgt_clsf" appearance="minimal" style="left:310px; top:214px; width:85px; height:18px; ">
				<choices>
					<item>
						<label>Y</label>
						<value>Y</value>
					</item>
					<item>
						<label>N</label>
						<value>N</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					       WgtGubunSet();
					]]>
				</script>
			</select1>
			<caption id="caption7" style="left:410px; top:215px; width:445px; height:15px; font-family:돋움; font-weight:bold; ">* 흑파 : 발행일자 기준 / 심봉, 설지 : 발생분 기준</caption>
		</group>
		<group id="group2" class="gro_btn" style="left:605px; top:445px; width:291px; height:27px; ">
			<button id="button1" class="btn02" style="left:160px; top:3px; width:52px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					                      for ( var i = 1; i < datagrid2.rows; i++){
					                             if( datagrid2.valueMatrix(i , 18 ) == ''){
					                             		if( window.alert("흑파량이 입력 되지 않은 선인쇄가 있습니다\n계속 진행 하시겠습니까?", "확인", 1) != 1){
					                             			return;
					                             		}
					                             }
					                      }
								
								model1.makeNode("/root/reqData/searchData/multiUpData1");
								
								var mulitUpdata = "cmpy_cd#occr_dt#seq#bw_pj_wgt";
								
								for ( var i = 1 ; i < datagrid2.rows;i++){
									var cmpy_cd = datagrid2.valueMatrix(i, 15);
									var occr_dt   =  datagrid2.valueMatrix(i, 16);
									var seq        =  datagrid2.valueMatrix(i, 17);
									var bw_wgt  =  ( (datagrid2.valueMatrix(i, 18) == '') ? '0':datagrid2.valueMatrix(i, 18));
									
									var tmpData = cmpy_cd + "#" + occr_dt + "#" + seq + "#" + bw_wgt;
									
									mulitUpdata = mulitUpdata + "|"  + tmpData;
								}
								
								model1.setValue("/root/reqData/searchData/multiUpData1", mulitUpdata);
								
								 var multiUpdata2 = "issu_dt#prt_dt#medi_cd#sect_cd#pre_prt_clsf#hdqt_paper_clsf#pj_kind#cnt#wgt";
							   
								model1.makeNode("/root/reqData/searchData/multiUpData2");
								for( var i = 1; i < datagrid4.rows; i++){
									   var paperGubun =    datagrid4.valueMatrix(i, 0 );
										   	   
									   if ( paperGubun == '소계'){
										 continue;
								   	   }
								  	    var issu_dt                  = datagrid4.valueMatrix(i, 13);
							         	    var prt_dt                    = datagrid4.valueMatrix(i, 14);
								            var medi_cd                = datagrid4.valueMatrix(i, 10);
								            var sect_cd                 = datagrid4.valueMatrix(i, 11);
								            var pre_prt_clsf           = datagrid4.valueMatrix(i, 12);
									    var hdqt_paper_clsf      = datagrid4.valueMatrix(i, 9);
										   	   
									     var pj_kind                  = datagrid4.valueMatrix(i, 3);
									     var cnt                        = datagrid4.valueMatrix(i,7);
									     var wgt                       = datagrid4.valueMatrix(i,8);
									   	   
									      multiUpdata2 = multiUpdata2 + "|" + issu_dt + "#" + prt_dt + "#" + medi_cd + "#" + sect_cd + "#" + pre_prt_clsf +"#" + hdqt_paper_clsf + "#" + pj_kind + "#" + cnt + "#" + wgt;
							         }
							        model1.setValue("/root/reqData/searchData/multiUpData2", multiUpdata2);
								          
							        model1.makeNode("/root/reqData/searchData/wgt_clsf");
							        model1.setValue("/root/reqData/searchData/wgt_clsf",  model.getValue("/root/resData/resForm/wgt_clsf"));
								          
							        model1.send("mt_prnpap_3409");
								
							        model1.destroy("/root/reqData/searchData/multiUpData2");
							        model1.destroy("/root/reqData/searchData/wgt_clsf");
							       	 model1.destroy("/root/reqData/searchData/multiUpData1");
								
							        if(submit_completed()) {			
									  funPageRefresh();
								 }
					]]>
				</script>
			</button>
			<button id="button2" class="btn02" style="left:215px; top:3px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					                  // 마감 여부 확인 해서 삭제 
					                  if( model1.getValue("/root/reqData/searchData/clos") == '02' ){
					                  	    alert("자재 마감 처리도 데이터 입니다.\n본사 스포츠 분리 등록에서 취소 하신 후 삭제가 가능 합니다");
					                  	    return;
					                  }
					                  
							   if( window.alert("[삭제경고] " + model1.getValue("/root/reqData/searchData/issu_dt") + "일자 상세 파지 내역을 삭제 하시겠습니까?", "확인", 1) != 1){
						          		return;
						  	   }
						          
							   model1.send("mt_prnpap_3410");
							   model1.destroy("/root/reqData/searchData/multiUpData1");
							   if(submit_completed()) {			
							               // 삭제 후 처리 
							                 button1.disabled = false;
									   button2.disabled = true;
									   button3.disabled = true;
									   combo1.disabled = false;
									   datagrid2.isReadOnly( 1,1, datagrid2.rows-1, datagrid2.cols-1) = false;
									   WgtGubunSet();
							            	// parent.window.javascript.funbtnSearch(2);
							  }
					]]>
				</script>
			</button>
			<button id="button3" class="btn04" style="left:1px; top:4px; width:74px; height:21px; ">
				<caption>선인쇄보정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					                     var row =  datagrid3.row ;
					                     var pj_kind = "";
					                     
					                     if( row < 2 ) {
					                     	alert("수정할 파지를 선택해 주세요");
					                     	return ;
					                     }
					                     
					                     if( datagrid3.valueMatrix( row, 0 ) == '백파' || datagrid3.valueMatrix( row, 0 ) == '흑파' ) {
					                        alert("보정 메뉴로 수정할 수 없는 파지입니다."); 		
					                        return ;
					                     }
					                     if( datagrid3.valueMatrix( row, 0 ) == '심봉62' ) {
					                        pj_kind = "3";
					                     }
					                     if( datagrid3.valueMatrix( row, 0 ) == '심봉31' ) {
					                        pj_kind = "4";
					                     }
					                     if( datagrid3.valueMatrix( row, 0 ) == '설지' ) {
					                        pj_kind = "5";
					                     }
					                     if( datagrid3.valueMatrix( row, 0 ) == '심봉46.5' ) {
					                        pj_kind = "6";
					                     }
					                      
					                      model1.makeNode("/root/reqData/fwdData/bojung");
					                      model1.makeNode("/root/reqData/fwdData/bojung/prt_dt");
					                      model1.makeNode("/root/reqData/fwdData/bojung/fac_clsf");
					                      model1.makeNode("/root/reqData/fwdData/bojung/pj_kind");
					                      
					                      model1.setValue("/root/reqData/fwdData/bojung/prt_dt" ,   model1.getValue("/root/reqData/searchData/issu_dt"));
								model1.setValue("/root/reqData/fwdData/bojung/fac_clsf"  , model1.getValue("/root/reqData/searchData/fac_clsf"));
								model1.setValue("/root/reqData/fwdData/bojung/pj_kind"  , pj_kind);
								
								window.load("/xrw/mt/prnpap/MT_PRNPAP_3402.xrw","modal", "mt_prnpap_3401", "width:530px;height:400px;", "/root/reqData/fwdData/bojung", "/root/reqData/fwdData"); 	        
					]]>
				</script>
			</button>
		</group>
		<datagrid id="datagrid3" nodeset="/root/resData/gridData_4/record" colsep="^" colwidth="100" datatype="delimeter" mergecellsfixedrows="bycolrec" rowsep="|" style="left:8px; top:474px; width:900px; height:291px; ">
			<col/>
		</datagrid>
	</xhtml:body>
</xhtml:html>
