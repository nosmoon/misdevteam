<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<!-- 선택계열의 정보를 담당 -->
							<sys_clsf_cd>
								<item>
									<value/>
									<label/>
								</item>
							</sys_clsf_cd>
							<natn_cd>
								<item>
									<label/>
									<value/>
								</item>
							</natn_cd>
							<setl_bank>
								<item>
									<label/>
									<value/>
								</item>
							</setl_bank>
							<srch_tag>
								<item>
									<label/>
									<value/>
								</item>
							</srch_tag>
							<mail_host>
								<item>
									<label/>
									<value/>
								</item>
							</mail_host>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						<setl_yn/>
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<sys_clsf_cd/>
						<!-- 검색조건 처리 -->
						<reqForm/>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<multiUpDate/>
						<!-- MultiUpDate유형 사용시 처리 -->
						<srch_tag/>
						<srch_key/>
						<searchData>
							<sys_clsf_cd/>
							<search_clsf/>
							<search_key_1/>
							<search_key_2/>
							<dlco_no/>
						</searchData>
						<fwdData>
							<func_nm/>
						</fwdData>
						<zip_search_form>
							<zip/>
							<job_flag/>
							<disp_flag/>
						</zip_search_form>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<dlco_no/>
							<dlco_nm/>
							<setl_bank/>
							<ern/>
							<zip_1/>
							<zip_2/>
							<addr/>
							<dtls_addr/>
							<dlco_abrv_nm/>
							<natn_cd/>
							<tel_no/>
							<fax_no/>
							<bizcond/>
							<item/>
							<presi_nm/>
							<presi_prn/>
							<presi_zip_1/>
							<presi_zip_2/>
							<presi_addr/>
							<presi_dtls_addr/>
							<presi_tel_no/>
							<acct_no/>
							<rcpm_main_nm/>
							<err_eps_no_aprv_yn/>
							<corp_clsf/>
							<elec_tax_stmt_yn/>
							<email_1/>
							<sys_clsf_cd/>
							<natn_tel_no/>
							<frnc_addr/>
							<mang_no_2/>
							<mode/>
							<incmg_pers_cmpy_cd/>
							<corp_clsf_nm/>
							<incmg_pers/>
							<incmg_dt_tm/>
							<chg_pers_cmpy_cd/>
							<chg_pers/>
							<chg_dt_tm/>
							<chg_nm/>
							<incmg_nm/>
							<frnc_pers_yn/>
							<email_host/>
							<email_2/>
							<email/>
						</resForm>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<msg/>
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<main>
								<!-- datagrid1 -->
								<!--
								<record>
									<dlco_no/>
									<dlco_nm/>
									<presi_nm/>
									<ern/>
								</record>
								-->
							</main>
							<sub/>
							<!-- datagrid2 -->
							<detail/>
							<!-- datagrid3 -->
						</gridData>
					</resData>
					<tempData>
					</tempData>
				</root>
			</instance>
			<script type="javascript" src="/js/CRMComm.js"/>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<script type="javascript">
				<![CDATA[
					var strType = "";
					
					function dlco_clsf_set(bVal){
						if (bVal){
							input13.disabled	= true;
							input14.disabled	= true;
							input15.disabled	= true;
							input16.disabled	= true;
							input17.disabled	= true;
							input18.disabled	= true;
							input19.disabled	= true;
						} else {
							input13.disabled	= false;
							input14.disabled	= false;
							input15.disabled	= false;
							input16.disabled	= false;
							input17.disabled	= false;
							input18.disabled	= false;
							input19.disabled	= false;
						}
					}
					
					function dlco_init(bVal){
						if (bVal){
							input13.disabled	= true;
							input14.disabled	= true;
							input15.disabled	= true;
							input16.disabled	= true;
							input17.disabled	= true;
							input18.disabled	= true;
							input19.disabled	= true;
							//combo4.disabled	= true;
						} else {
							input13.disabled	= false;
							input14.disabled	= false;
							input15.disabled	= false;
							input16.disabled	= false;
							input17.disabled	= false;
							input18.disabled	= false;
							input19.disabled	= false;
							//combo4.disabled	= false;
						}
					}
					
					function dlco_onclick(){
						if(datagrid1.row == 0) {
							return;
						}
						var idx = 1;					
						var selectValue = "";
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/dlco_no", selectValue);
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/dlco_nm", selectValue);
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);	
						model1.setValue("/root/resData/resForm/dlco_abrv_nm", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);	
						model1.setValue("/root/resData/resForm/ern", selectValue);
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						//selectValue = selectValue.substring(0, selectValue.indexOf("@"));
						model1.setValue("/root/resData/resForm/email_1", selectValue.substring(0, selectValue.indexOf("@")));
						model1.setValue("/root/resData/resForm/email_2", selectValue.substring(selectValue.indexOf("@") + 1, selectValue.length));
						model1.setValue("/root/resData/resForm/email_host", selectValue.substring(selectValue.indexOf("@") + 1, selectValue.length));
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);	
						model1.setValue("/root/resData/resForm/presi_nm", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);	
						model1.setValue("/root/resData/resForm/tel_no", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/fax_no", selectValue);
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/corp_clsf_nm", selectValue);
									
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/natn_cd", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/zip_1", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/zip_2", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/addr", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/dtls_addr", selectValue);
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/frnc_pers_yn", selectValue);
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/presi_prn", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/presi_zip_1", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/presi_zip_2", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/presi_addr", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/presi_dtls_addr", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/bizcond", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/item", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/frnc_addr", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/sys_clsf_cd", selectValue);
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/setl_bank", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/acct_no", selectValue);
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/rcpm_main_nm", selectValue);
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/err_eps_no_aprv_yn", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/mang_no_2", selectValue);
						
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/corp_clsf", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/incmg_pers_cmpy_cd", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/incmg_pers", selectValue);
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/incmg_nm", selectValue);
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/incmg_dt_tm", selectValue);
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/chg_pers_cmpy_cd", selectValue);
							
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/chg_pers", selectValue);
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/chg_nm", selectValue);
						
						selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
						model1.setValue("/root/resData/resForm/chg_dt_tm", selectValue);
						
						model.send("co_dlco_1004");
						
						var sys_clsf_1 = model.getValue("/root/tempData/sys_clsf/sys_clsf_1");
						var sys_clsf_2 = model.getValue("/root/tempData/sys_clsf/sys_clsf_2");
						var sys_clsf_3 = model.getValue("/root/tempData/sys_clsf/sys_clsf_3");
						var sys_clsf_4 = model.getValue("/root/tempData/sys_clsf/sys_clsf_4");
						
						if (eval(sys_clsf_1) == 0) {
							button3.disabled = true;
						} else {
							button3.disabled = false;
						}
						if (eval(sys_clsf_2) == 0) {
							button4.disabled = true;
						} else {
							button4.disabled = false;
						}
						if (eval(sys_clsf_3) == 0) {
							button5.disabled = true;
						} else {
							button5.disabled = false;
						}
						if (eval(sys_clsf_4) == 0) {
							button6.disabled = true;
						} else {
							button6.disabled = false;
						}
						if (model1.getValue("/root/resData/resForm/corp_clsf") == "1"){
							dlco_clsf_set(false);
						} else {
							dlco_clsf_set(true);
						}
						strType = "U";
						model1.setValue("/root/resData/resForm/mode", "U");
						model1.refresh();
					}
					
					/**
					 * 공통거래처 정보를 부모창에 리턴
					 * parameter
					 *  - 팝업에서 넘겨줄 노드
					 *  - 부모창에서 넘겨받을 노드
					*/
					function openerCopyNode()	{	
						try {
							var length = arguments.length;	
							var targNode = arguments[0];
							
							if (opener.instance1.selectSingleNode(targNode)==null) opener.model.makeNode(targNode);
							for(var j = 1; j<length; j++){					
								var node1 = instance1.selectSingleNode(arguments[j]);
								var nodeList = node1.childNodes;
								
								while (childNode = nodeList.nextNode()) {
									opener.model.duplicate(targNode,childNode.cloneNode(true));
								}
							}
						} catch (e) {
							model.alert("Error", "해당노드의 선택이 잘못되었습니다");
							return false;
						}
					}
					
					function isLength(str){
						return str.length;
					}
					/**
					 * 주민번호 검사
					 * parameter
					 *  - resident_number1 : 앞자리(6자리)
					 *  - resident_number2 : 뒷자리(7)
					*/
					function CheckResident_number(resident_number1, resident_number2){
						blnResident_number = false;
						// 잘못된 생년월일을 검사합니다.
						b_Year = (resident_number2.charAt(0) <= "2") ? "19" : "20";
						/* 2000년도부터 성구별 번호가 바뀌였슴으로 구별수가 2보다 작다면
						1900년도 생이되고 2보다 크다면 2000년도 이상생이 됩니다. 
						단 1800년도 생은 계산에서 제외합니다.*/
					
						b_Year += resident_number1.substr(0, 2);
						// 주민번호의 앞에서 2자리를 이어서 4자리의 생년을 저장합니다.
						b_Month = resident_number1.substr(2, 2) - 1;
						// 달을 구합니다. 1을 뺀것은 자바스크립트에서는 1월을 0으로 표기하기 때문입니다.
						b_Date = resident_number1.substr(4, 2);
						b_sum = new Date(b_Year, b_Month, b_Date);
						if ( b_sum.getYear() % 100 != resident_number1.substr(0, 2) || b_sum.getMonth() != b_Month || b_sum.getDate() != b_Date) {
						return blnResident_number;
						// 생년월일의 타당성을 검사하여 거짓이 있을시 에러메세지를 나타냄
						}
					
						total = 0;
						temp = new Array(13);
						for(i=1; i<=6; i++) temp[i] = resident_number1.charAt(i-1);
						for(i=7; i<=13; i++) temp[i] = resident_number2.charAt(i-7);
						for(i=1; i<=12; i++) {
						k = i + 1;
						if(k >= 10) k = k % 10 + 2;
						/* 각 수와 곱할 수를 뽑아냅니다. 곱수가 만일 10보다 크거나 같다면
						계산식에 의해 2로 다시 시작하게 됩니다. */
						total = total + (temp[i] * k);
						// 각 자리수와 계산수를 곱한값을 변수 total에 누적합산시킵니다.
						}
					
						last_num = (11- (total % 11)) % 10;
						// 마지막 계산식을 변수 last_num에 대입합니다.
						if(last_num == temp[13]) blnResident_number = true;
						// laster_num이 주민번호의마지막수와 같은면 참을 틀리면 거짓을 반환합니다.
						else blnResident_number = false;
						return blnResident_number;
					}

					/**
					 * 사업자등록번호 검사
					 * parameter
					 *  - businessNo : 사업자번호
					*/
					function CheckBusiness_Number(businessNo){
						if (businessNo.length == 10) {
						
							a  	= businessNo.charAt(0);
							b  	= businessNo.charAt(1);
							c  	= businessNo.charAt(2);
							d  	= businessNo.charAt(3);
							e  	= businessNo.charAt(4);
							f  	= businessNo.charAt(5);
							g  	= businessNo.charAt(6);
							h  	= businessNo.charAt(7);
							i  	= businessNo.charAt(8);
							Osub 	= businessNo.charAt(9);
							
							suma = a*1 + b*3 + c*7 + d*1 + e*3 + f*7 + g*1 + h*3;
							sumb = (i*5) %10;
							sumc = parseInt((i*5) / 10,10);
							sumd = sumb + sumc;	
							sume = suma + sumd;
							sumf = a + b + c + d + e + f + g + h + i
							k = sume % 10;
							Modvalue = 10 - k;
							LastVal = Modvalue % 10;
							
							if (sumf == 0) {
								return false;
							}
							
						} else {
							return false;
						}	
					
					  	if ( Osub == LastVal ) {
							return true;
						} else {
							return false;
						}
					}
					
					/**
					 * 법인번호 검사
					 * parameter
					 *  - bubinNum : 법인번호
					*/
					function is_bubinno(bubinNum){ 
						var as_Biz_no = String(bubinNum); 
						var isNum = true; 
						var I_TEMP_SUM = 0 ; 
						var I_TEMP = 0; 
						var S_TEMP; 
						var I_CHK_DIGIT = 0; 
						 
						if(bubinNum.length != 13) {
							return false;
						}
						
						for(index01 = 1; index01 < 13; index01++) {
							var i = index01 % 2;
							var j = 0;
						  
						 	if(i == 1) j = 1;
						 	else if( i == 0) j = 2;
						  
						 	I_TEMP_SUM = I_TEMP_SUM + parseInt(as_Biz_no.substring(index01-1, index01),10) * j;
						}
						
						I_CHK_DIGIT= I_TEMP_SUM%10 ; 
						if(I_CHK_DIGIT != 0 ) I_CHK_DIGIT = 10 - I_CHK_DIGIT;
						
						if (as_Biz_no.substring(12,13) != String(I_CHK_DIGIT)) return false; 
						
						return true;
					}
					
					function dlcoMsg(){
						// properties
						this.bVal = false;
						this.strMsg = "";
						// method
						this.setDlco = setDlco;
					}
					
					function setDlco(biVal, iMsg){
						this.bVal = biVal;
						this.strMsg = iMsg;
					}
					
					function isRegNo_fgnno2(fgnno) { 
						
						nA = new Array(9);
						nA[1] = fgnno.substring(0,1);
						nA[2] = fgnno.substring(1,2);
						nA[3] = parseFloat(fgnno.substring(2,3));
						nA[4] = parseFloat(fgnno.substring(3,4));
						nA[5] = parseFloat(fgnno.substring(4,5));
						nA[6] = parseFloat(fgnno.substring(5,6));
						nA[7] = parseFloat(fgnno.substring(6,7));
						nA[8] = parseFloat(fgnno.substring(7,8));
						nA[9] = parseFloat(fgnno.substring(8,9));
						
						
						if ( isLength( fgnno ) != 9 ) {
							return false;
						}
						if ( nA[1] < 'A' || nA[1] > 'Z' ) {
							//alert("첫번째 자리는 영문입니다. \n\n대문자로 입력하세요!");
							return false;
						} else if ( nA[2] < 'A' || nA[2] > 'Z' ) {
							//alert("두번째 자리는 영문입니다. \n\n대문자로 입력하세요!");
							return false;
						}
						
						nSum = nA[3] * 1000000 + nA[4] * 100000 + nA[5] * 10000 + nA[6] * 1000 + nA[7] * 100 + nA[8] * 10 + nA[9];
						if ( nSum < 0 || nSum > 9999999 ) {
							return false;
						}
						return true;
					}


				
					/**
					*/
					function check_corp_ern(ern, corp_clsf, frnc_pers_yn){
						var ret = new dlcoMsg();

						if (ern == ""){
							ret.setDlco(false, "주민/사업자번호를 반드시 입력해주십시오.");
						} else {
							if (corp_clsf == "1"){		// 법인이면
								ern = ern.replace(/-/ig, "");
								if (!is_bubinno(ern)) {
									if (!CheckBusiness_Number(ern)){
										ret.setDlco(false, "정상적인 법인번호도 아니고 정상적인 사업자번호도 아닙니다.");
									} else {
										ret.setDlco(true, "정상적인 법인번호는 아니지만 정상적인 사업자번호는 맞습니다.");
									}
									
								} else {
									ret.setDlco(true, "정상적인 법인번호 입니다.");
								}
							} else if (corp_clsf == "2"){		// 개인이면
								var ern_arr = new Array();
								if (frnc_pers_yn == "Y"){	// 개인이면서 외국인이면.
									ern = ern.replace(/-/ig, "");
									if (!isRegNo_fgnno2(ern)){
										//ret.setDlco(false, "잘못된 여권번호입니다.");
										ret.setDlco(true, "정상적인 여권번호입니다.");
									} else {
										ret.setDlco(true, "정상적인 여권번호입니다.");
									}
								} else {
									if (ern.indexOf("-") > 0){
										ern_arr = ern.split("-");
									} else {
										ern_arr[0] = ern.substring(0,6);
										ern_arr[1] = ern.substring(6,13);
									}
									if (!CheckResident_number(ern_arr[0], ern_arr[1])){
										ret.setDlco(false, "잘못된 주민번호입니다.");
									} else {
										ret.setDlco(true, "정상적인 주민번호입니다.");
									}
								}
								//alert("ern_arr.length=" + ern_arr.length);
								//if (ern_arr.length == 2) {	//	개인이면서 주민번호를 입력한 경우
									//if (!CheckResident_number(ern_arr[0], ern_arr[1])){
									//	ret.setDlco(false, "잘못된 주민번호입니다.");
									//} else {
									//	ret.setDlco(true, "정상적인 주민번호입니다.");
									//}
								//} else if (ern_arr.length > 2) {	//	개인이면서 개인사업자인 경우에 사업자번호를 입력한 경우
								//	ern = ern.replace(/-/ig, "");
								//	if (!CheckBusiness_Number(ern)){
								//		ret.setDlco(false, "잘못된 사업자번호입니다.");
								//	} else {
								//		ret.setDlco(true, "정상적인 사업자번호입니다.");
								//	}
								//}
							} else {
								ret.setDlco(false, "거래처구분이 개인인지 법인인지 체크해주십시오.");
							}
						}
						//alert(ret.bVal + "\n" + ret.strMsg);
						return ret;
					}

					/**
					 * 우편번호 호출
					 * parameter
					 *  - bogb : 지국명 보일지여부(L이면 안보임)
					 *  - zip1Ref : 우편번호1 xPath
					 *  - zip2Ref : 우편번호2 xPath
					 *  - addrRef : 주소 xPath
					*/
					function se_openZip(bogb, zip1Ref, zip2Ref, addrRef){
						
						var tempReq = "/root/tempData/posttemp";
						if(instance1.selectSingleNode(tempReq) == null){
							model.makeNode(tempReq);
						}
						tempReq = "/root/tempData/posttemp/send";
						if(instance1.selectSingleNode(tempReq) == null){
							model.makeNode(tempReq);
						}
						tempReq = "/root/tempData/posttemp/send/zip";
						if(instance1.selectSingleNode(tempReq) == null){
							model.makeNode(tempReq);
						}
						tempReq = "/root/tempData/posttemp/send/disp_flag";
						if(instance1.selectSingleNode(tempReq) == null){
							model.makeNode(tempReq);
						}
						tempReq = "/root/tempData/posttemp/recv";
						if(instance1.selectSingleNode(tempReq) == null){
							model.makeNode(tempReq);
						}
						
						//"L"이면 지국항목 안보임
						model.setValue("/root/tempData/posttemp/send/disp_flag", bogb);
						model.setValue("/root/tempData/posttemp/send/zip", model.getValue(zip1Ref)+model.getValue(zip2Ref));
						
						openZip("/root/tempData/posttemp/send", "/root/tempData/posttemp/recv");
						
						model.setValue(zip1Ref, model.getValue("/root/tempData/posttemp/recv/zip1"));
						model.setValue(zip2Ref, model.getValue("/root/tempData/posttemp/recv/zip2"));
						model.setValue(addrRef, model.getValue("/root/tempData/posttemp/recv/addr"));
						
						model.refresh();
					}
					
					function makeVal(){
						this.label = "";
						this.value = "";
						this.setMakeVal = setMakeVal;
					}
					
					function setMakeVal(iLabel, iValue){
						this.label = iLabel;
						this.value = iValue;
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					var search_clsf_arr = new Array();
					var mail_host_arr = new Array();
					
					search_clsf_arr[0] = new makeVal();
					search_clsf_arr[0].setMakeVal("거래처명", "A");
					search_clsf_arr[1] = new makeVal();
					search_clsf_arr[1].setMakeVal("대표자명", "B");
					search_clsf_arr[2] = new makeVal();
					search_clsf_arr[2].setMakeVal("거래처번호", "C");
					
					mail_host_arr[0] = new makeVal();
					mail_host_arr[0].setMakeVal("직접입력", "");
					mail_host_arr[1] = new makeVal();
					mail_host_arr[1].setMakeVal("네이버(naver.com)", "naver.com");
					mail_host_arr[2] = new makeVal();
					mail_host_arr[2].setMakeVal("다음(hanmail.net)", "hanmail.net");
					mail_host_arr[3] = new makeVal();
					mail_host_arr[3].setMakeVal("파란(paran.com)", "paran.com");
					mail_host_arr[4] = new makeVal();
					mail_host_arr[4].setMakeVal("네이트(nate.com)", "nate.com");
					mail_host_arr[5] = new makeVal();
					mail_host_arr[5].setMakeVal("천리안(chol.com)", "chol.com");
					mail_host_arr[6] = new makeVal();
					mail_host_arr[6].setMakeVal("드림위즈(cdreamwiz.com)", "dreamwiz.com");
					mail_host_arr[7] = new makeVal();
					mail_host_arr[7].setMakeVal("엠파스(empal.com)", "empal.com");
					mail_host_arr[8] = new makeVal();
					mail_host_arr[8].setMakeVal("프리챌(freechal.com)", "freechal.com");
					mail_host_arr[9] = new makeVal();
					mail_host_arr[9].setMakeVal("구글(gmail.com)", "gmail.com");
					mail_host_arr[10] = new makeVal();
					mail_host_arr[10].setMakeVal("하나로(hanafos.com)", "hanafos.com");
					mail_host_arr[11] = new makeVal();
					mail_host_arr[11].setMakeVal("한미르(hanmir.com)", "hanmir.com");
					mail_host_arr[12] = new makeVal();
					mail_host_arr[12].setMakeVal("하이텔(hitel.net)", "hitel.net");
					mail_host_arr[13] = new makeVal();
					mail_host_arr[13].setMakeVal("핫메일(hotmail.com)", "hotmail.com");
					mail_host_arr[14] = new makeVal();
					mail_host_arr[14].setMakeVal("코리아닷컴(korea.com)", "korea.com");
					mail_host_arr[15] = new makeVal();
					mail_host_arr[15].setMakeVal("라이코스(lycos.co.kr)", "lycos.co.kr");
					mail_host_arr[16] = new makeVal();
					mail_host_arr[16].setMakeVal("네띠앙(netian.com)", "netian.com");
					mail_host_arr[17] = new makeVal();
					mail_host_arr[17].setMakeVal("야후(yahoo.com)", "yahoo.com");
					mail_host_arr[18] = new makeVal();
					mail_host_arr[18].setMakeVal("야후(yahoo.co.kr)", "yahoo.co.kr");

					dlco_init(true);
					
					//maintitle.text = "공통거래처";
					model1.send("co_dlco_1001");
					
					//model1.copyNode("/root/initData/comboSet/sys_clsf_cd", "/root/tempData/sys_clsf_cd");
//					combo1.refresh();
					//combo5.refresh();
					
					model1.copyNode("/root/initData/comboSet/natn_cd", "/root/tempData/natn_cd");
					combo2.refresh();
					
					model1.copyNode("/root/initData/comboSet/setl_bank", "/root/tempData/setl_bank");
					combo4.refresh();
					
					model.setValue("/root/initData/setl_yn", model.getValue("/root/tempData/setl_yn"));
					if (model.getValue("/root/initData/setl_yn") == "Y"){
						combo4.disabled	= false;
						input21.disabled	= false;
						input22.disabled	= false;
						//input21.attribute("editable") = "false";
					} else {
						combo4.disabled	= true;
						input21.disabled	= true;
						input22.disabled	= true;
					}
//					model1.setValue("/root/initData/comboSet/srch_tag/item/label", "전체");
//					model1.setValue("/root/initData/comboSet/srch_tag/item/value", "ALL");
//					model.makeNode("/root/initData/comboSet/srch_tag/item[2]/label");
//					model.makeNode("/root/initData/comboSet/srch_tag/item[2]/value");
					
					for (var i=0; i<search_clsf_arr.length; i++){
						if (i==0){
							model1.setValue("/root/initData/comboSet/srch_tag/item/label", search_clsf_arr[i].label);
							model1.setValue("/root/initData/comboSet/srch_tag/item/value", search_clsf_arr[i].value);
						} else {
							model.makeNode("/root/initData/comboSet/srch_tag/item[" + (i + 1) + "]/label");
							model.makeNode("/root/initData/comboSet/srch_tag/item[" + (i + 1) + "]/value");
							model1.setValue("/root/initData/comboSet/srch_tag/item[" + (i + 1) + "]/label", search_clsf_arr[i].label);
							model1.setValue("/root/initData/comboSet/srch_tag/item[" + (i + 1) + "]/value", search_clsf_arr[i].value);
						}
					}

					combo3.refresh();
					combo3.select(0);
					
					for (var i=0; i<mail_host_arr.length; i++){
						if (i==0){
							model1.setValue("/root/initData/comboSet/mail_host/item/label", mail_host_arr[i].label);
							model1.setValue("/root/initData/comboSet/mail_host/item/value", mail_host_arr[i].value);
						} else {
							model.makeNode("/root/initData/comboSet/mail_host/item[" + (i + 1) + "]/label");
							model.makeNode("/root/initData/comboSet/mail_host/item[" + (i + 1) + "]/value");
							model1.setValue("/root/initData/comboSet/mail_host/item[" + (i + 1) + "]/label", mail_host_arr[i].label);
							model1.setValue("/root/initData/comboSet/mail_host/item[" + (i + 1) + "]/value", mail_host_arr[i].value);
						}
					}
					combo1.refresh();
					combo1.select(0);
					
					strType = "I";
					model1.setValue("/root/resData/resForm/mode", "I");
					//input28.disabled = true;
					button3.disabled = true;
					button4.disabled = true;
					button5.disabled = true;
					button6.disabled = true;
					
					model.property("IF_DLCO_NO") = "";
					model.property("IF_ERN") = "";
					model.property("IF_DLCO_NM") = "";
					model.property("IF_DLCO_ABRV_NM") = "";
					model.property("IF_ACCT_NO") = "";
					model.property("IF_CORP_CLSF") = "";
					model.property("IF_RCPM_MAIN_NM") = "";
					
				]]>
			</script>
			<submission id="co_dlco_1001" action="/co/dlco/1001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchDetail" resultref="/root/tempData"/>
			<submission id="co_dlco_1000" action="/co/dlco/1000" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData"/>
			<submission id="co_dlco_1002" action="/co/dlco/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData"/>
			<submission id="co_dlco_1003" action="/co/dlco/1003" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData"/>
			<submission id="co_dlco_1004" action="/co/dlco/1004" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData"/>
			<submission id="co_dlco_1005" action="/co/dlco/1005" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData"/>
			<submission id="co_dlco_1006" action="/co/dlco/1006" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
		</model>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="740" guideline="2,34;2,39;2,40;2,49;2,73;2,78;2,80;2,113;2,113;2,117;2,119;2,705;1,935;1,927;1,926;" style="font-family:굴림; ">
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group_line" class="gro_line" style="left:10px; top:78px; width:926px; height:5px; "/>
		<group id="group_tit" class="gro_tit2" style="left:10px; top:93px; width:926px; height:25px; ">
			<caption id="subtitle" class="tit02" style="left:0px; top:0px; width:926px; height:20px; ">공통거래처관리</caption>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/main/record" overflow="scroll" scroll="auto" caption="관리번호^거래처명^거래처약어^주민/사업자번호^email^대표자명^전화^팩스^법인구분" colsep="^" colwidth="100, 172, 148, 160, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="listbox" style="left:10px; top:118px; width:926px; height:227px; ">
			<col ref="dlco_no"/>
			<col ref="dlco_nm"/>
			<col ref="dlco_abrv_nm"/>
			<col ref="ern"/>
			<col ref="email"/>
			<col ref="presi_nm"/>
			<col ref="tel_no"/>
			<col ref="fax_no"/>
			<col ref="corp_clsf_nm"/>
			<col ref="natn_cd" visibility="hidden"/>
			<col ref="zip_1" visibility="hidden"/>
			<col ref="zip_2" visibility="hidden"/>
			<col ref="addr" visibility="hidden"/>
			<col ref="dtls_addr" visibility="hidden"/>
			<col ref="frnc_pers_yn" visibility="hidden"/>
			<col ref="presi_prn" visibility="hidden"/>
			<col ref="presi_zip_1" visibility="hidden"/>
			<col ref="presi_zip_2" visibility="hidden"/>
			<col ref="presi_addr" visibility="hidden"/>
			<col ref="presi_dtls_addr" visibility="hidden"/>
			<col ref="bizcond" visibility="hidden"/>
			<col ref="item" visibility="hidden"/>
			<col ref="frnc_addr" visibility="hidden"/>
			<col ref="sys_clsf_cd" visibility="hidden"/>
			<col ref="setl_bank" visibility="hidden"/>
			<col ref="acct_no" visibility="hidden"/>
			<col ref="rcpm_main_nm" visibility="hidden"/>
			<col ref="err_eps_no_aprv_yn" visibility="hidden"/>
			<col ref="mang_no_2" visibility="hidden"/>
			<col ref="corp_clsf" visibility="hidden"/>
			<col ref="incmg_pers_cmpy_cd" visibility="hidden"/>
			<col ref="incmg_pers" visibility="hidden"/>
			<col ref="incmg_nm" visibility="hidden"/>
			<col ref="incmg_dt_tm" visibility="hidden"/>
			<col ref="chg_pers_cmpy_cd" visibility="hidden"/>
			<col ref="chg_pers" visibility="hidden"/>
			<col ref="chg_nm" visibility="hidden"/>
			<col ref="chg_dt_tm" visibility="hidden"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				/*
				if(datagrid1.row == 0) return;
				var idx = 1;					
				var selectValue = "";
				
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/dlco_no", selectValue);
				
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/dlco_nm", selectValue);
				
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);	
				model1.setValue("/root/resData/resForm/dlco_abrv_nm", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);	
				model1.setValue("/root/resData/resForm/ern", selectValue);
				
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				//selectValue = selectValue.substring(0, selectValue.indexOf("@"));
				model1.setValue("/root/resData/resForm/email_1", selectValue.substring(0, selectValue.indexOf("@")));
				model1.setValue("/root/resData/resForm/email_2", selectValue.substring(selectValue.indexOf("@") + 1, selectValue.length));
				model1.setValue("/root/resData/resForm/email_host", selectValue.substring(selectValue.indexOf("@") + 1, selectValue.length));
				
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);	
				model1.setValue("/root/resData/resForm/presi_nm", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);	
				model1.setValue("/root/resData/resForm/tel_no", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/fax_no", selectValue);
				
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/corp_clsf_nm", selectValue);
							
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/natn_cd", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/zip_1", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/zip_2", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/addr", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/dtls_addr", selectValue);
				
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/frnc_pers_yn", selectValue);
				
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/presi_prn", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/presi_zip_1", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/presi_zip_2", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/presi_addr", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/presi_dtls_addr", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/bizcond", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/item", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/frnc_addr", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/sys_clsf_cd", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/setl_bank", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/acct_no", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/err_eps_no_aprv_yn", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/mang_no_2", selectValue);
				
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/corp_clsf", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/incmg_pers_cmpy_cd", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/incmg_pers", selectValue);
				
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/incmg_nm", selectValue);
				
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/incmg_dt_tm", selectValue);
				
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/chg_pers_cmpy_cd", selectValue);
					
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/chg_pers", selectValue);
				
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/chg_nm", selectValue);
				
				selectValue = datagrid1.valueMatrix(datagrid1.row, idx++);
				model1.setValue("/root/resData/resForm/chg_dt_tm", selectValue);
				
				model.send("co_dlco_1004");
				
				var sys_clsf_1 = model.getValue("/root/tempData/sys_clsf/sys_clsf_1");
				var sys_clsf_2 = model.getValue("/root/tempData/sys_clsf/sys_clsf_2");
				var sys_clsf_3 = model.getValue("/root/tempData/sys_clsf/sys_clsf_3");
				var sys_clsf_4 = model.getValue("/root/tempData/sys_clsf/sys_clsf_4");
				
				if (eval(sys_clsf_1) == 0) {
					button3.disabled = true;
				} else {
					button3.disabled = false;
				}
				if (eval(sys_clsf_2) == 0) {
					button4.disabled = true;
				} else {
					button4.disabled = false;
				}
				if (eval(sys_clsf_3) == 0) {
					button5.disabled = true;
				} else {
					button5.disabled = false;
				}
				if (eval(sys_clsf_4) == 0) {
					button6.disabled = true;
				} else {
					button6.disabled = false;
				}
				
				strType = "U";
				model1.setValue("/root/resData/resForm/mode", "U");
				model1.refresh();
				*/
				//datagrid1.dispatch("dlco_onclick");
				dlco_onclick();
				]]>
			</script>
		</datagrid>
		<group id="group1" class="gro_sel" style="left:10px; top:350px; width:926px; height:350px; ">
			<caption id="caption5" class="list_cap01" style="left:0px; top:0px; width:100px; height:26px; ">성명/거래처명</caption>
			<caption id="caption4" class="list_cap01" style="left:308px; top:0px; width:100px; height:26px; ">약어명</caption>
			<caption id="caption3" class="list_cap01" style="left:0px; top:25px; width:100px; height:26px; ">주민/사업자번호</caption>
			<caption id="caption1" class="list_cap02" style="left:99px; top:0px; width:210px; "/>
			<caption id="caption2" class="list_cap02" style="left:99px; top:25px; width:210px; height:26px; "/>
			<caption id="caption6" class="list_cap02" style="left:407px; top:0px; width:210px; height:26px; "/>
			<caption id="caption7" class="list_cap01" style="left:616px; top:0px; width:100px; height:26px; ">관리번호</caption>
			<caption id="caption8" class="list_cap02" style="left:715px; top:0px; width:210px; height:26px; "/>
			<caption id="caption9" class="list_cap01" style="left:0px; top:50px; width:100px; height:26px; ">주소</caption>
			<caption id="caption10" class="list_cap02" style="left:99px; top:50px; width:518px; height:26px; "/>
			<caption id="caption15" class="list_cap01" style="left:308px; top:25px; width:100px; height:26px; ">전화번호</caption>
			<caption id="caption16" class="list_cap02" style="left:407px; top:25px; width:210px; height:26px; "/>
			<caption id="caption17" class="list_cap01" style="left:616px; top:25px; width:100px; height:26px; ">FAX</caption>
			<caption id="caption18" class="list_cap02" style="left:715px; top:25px; width:210px; height:26px; "/>
			<caption id="caption21" class="list_cap01" style="left:0px; top:133px; width:100px; height:26px; ">대표자명</caption>
			<caption id="caption22" class="list_cap01" style="left:308px; top:133px; width:100px; height:26px; ">대표자주민번호</caption>
			<caption id="caption23" class="list_cap01" style="left:0px; top:158px; width:100px; height:26px; ">대표자 주소</caption>
			<caption id="caption24" class="list_cap02" style="left:407px; top:100px; width:210px; height:26px; "/>
			<caption id="caption25" class="list_cap02" style="left:99px; top:100px; width:210px; height:26px; "/>
			<caption id="caption26" class="list_cap02" style="left:99px; top:133px; width:210px; height:26px; "/>
			<caption id="caption27" class="list_cap02" style="left:407px; top:133px; width:210px; height:26px; "/>
			<caption id="caption28" class="list_cap02" style="left:99px; top:158px; width:518px; height:26px; "/>
			<caption id="caption31" class="list_cap01" style="left:616px; top:133px; width:100px; height:26px; ">대표자전화번호</caption>
			<caption id="caption32" class="list_cap01" style="left:0px; top:183px; width:100px; height:26px; ">결제은행</caption>
			<caption id="caption33" class="list_cap01" style="left:308px; top:183px; width:100px; height:26px; ">계좌번호</caption>
			<caption id="caption34" class="list_cap01" style="left:616px; top:183px; width:100px; height:26px; ">입금주명</caption>
			<caption id="caption37" class="list_cap02" style="left:715px; top:133px; width:210px; height:26px; "/>
			<caption id="caption38" class="list_cap02" style="left:99px; top:183px; width:210px; height:26px; "/>
			<caption id="caption39" class="list_cap02" style="left:407px; top:183px; width:210px; height:26px; "/>
			<caption id="caption40" class="list_cap02" style="left:715px; top:183px; width:210px; height:26px; "/>
			<caption id="caption14" class="list_cap01" style="left:0px; top:215px; width:100px; height:26px; ">법인구분</caption>
			<caption id="caption45" class="list_cap01" style="left:308px; top:215px; width:100px; height:26px; ">인명관리번호</caption>
			<caption id="caption48" class="list_cap02" style="left:99px; top:215px; width:210px; height:26px; "/>
			<caption id="caption49" class="list_cap02" style="left:407px; top:215px; width:210px; height:26px; "/>
			<caption id="caption53" class="list_cap02" style="left:99px; top:75px; width:518px; height:26px; "/>
			<caption id="caption54" class="list_cap01" style="left:0px; top:75px; width:100px; height:26px; ">외국주소</caption>
			<caption id="caption29" class="list_cap02" style="left:99px; top:240px; width:518px; height:26px; "/>
			<caption id="caption35" class="list_cap01" style="left:0px; top:240px; width:100px; height:26px; ">E-MAIL</caption>
			<caption id="caption55" class="list_cap02" style="left:715px; top:240px; width:210px; height:26px; "/>
			<caption id="caption56" class="list_cap01" style="left:616px; top:240px; width:100px; height:26px; ">전자세금계산서</caption>
			<caption id="caption57" class="list_cap01" style="left:616px; top:215px; width:100px; height:26px; ">오류사업자번호</caption>
			<caption id="caption58" class="list_cap02" style="left:715px; top:215px; width:210px; height:26px; "/>
			<input id="input1" ref="/root/resData/resForm/dlco_nm" navindex="1" style="left:105px; top:4px; width:170px; height:18px; background-color:#ffff99; "/>
			<input id="input2" ref="/root/resData/resForm/dlco_abrv_nm" navindex="2" style="left:412px; top:4px; width:170px; height:18px; background-color:#ffff99; ">
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[
						model1.setValue("/root/resData/resForm/dlco_abrv_nm", model1.getValue("/root/resData/resForm/dlco_nm"));
						input2.refresh();
					]]>
				</script>
			</input>
			<input id="input3" ref="/root/resData/resForm/ern" navindex="3" style="left:104px; top:29px; width:126px; height:18px; background-color:#ffff99; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var ern = input3.currentText;
						var ern_arr = new Array();
						
						if (ern.length == 12){
							dlco_init(false);
						} else {
							dlco_init(true);
						}
						
						if (ern.indexOf("-") > 0){
							ern_arr = ern.split("-");
						} else {
							ern_arr[0] = ern.substring(0,6);
							ern_arr[1] = ern.substring(6,13);
							//alert(ern_arr[0] + "\n" + ern_arr[1]);
						}
						var b_corp_clsf_1 = false;
						var b_corp_clsf_2 = false;
						//var b_corp_clsf_3 = false;
						//var b_corp_clsf_4 = false;
						
						if (CheckResident_number(ern_arr[0], ern_arr[1])){
							//alert("주민번호는 안맞는다.");
							b_corp_clsf_1 = true;
							if (ern.indexOf("-") < 0){
								//input3.currentText = ern_arr[0] + "-" + ern_arr[1];
								model1.setValue("/root/resData/resForm/ern", ern_arr[0] + "-" + ern_arr[1]);
								//alert(ern_arr[0] + "\n" + ern_arr[1]);
							}
							model.setValue("/root/resData/resForm/corp_clsf", "2");
							radio1.refresh();
						} else {
							b_corp_clsf_1 = false;
						}
						var ern_biz = ern.replace(/-/ig, "");
						if (CheckBusiness_Number(ern_biz)){
							//alert("사업자번호는 맞는다.");
							if (ern.indexOf("-") < 0){
								//input3.currentText = ern.substring(0,3) + "-" + ern.substring(3,5) + "-" + ern.substring(5,12);
								model1.setValue("/root/resData/resForm/ern", ern.substring(0,3) + "-" + ern.substring(3,5) + "-" + ern.substring(5,12));
								//alert(ern_arr[0] + "\n" + ern_arr[1]);
							}
							b_corp_clsf_2 = true;
							model.setValue("/root/resData/resForm/corp_clsf", "1");
							radio1.refresh();
						} else {
							b_corp_clsf_2 = false;
							//alert("사업자번호는 안맞는다.");
						}
						/*
						if (is_bubinno(ern)) {
							b_corp_clsf_3 = true;
							//alert("법인번호는 맞는다.");
							model.setValue("/root/resData/resForm/corp_clsf", "1");
							radio1.refresh();
						} else {
							b_corp_clsf_3 = false;
							//alert("법인번호는 안맞는다.");
						}
						
						if (!b_corp_clsf_1 && !b_corp_clsf_2 && !b_corp_clsf_3){
							showConfirmBox("주민번호 와 사업자번호 둘다 맞지 않습니다. 외국인으로 등록하시겠습니까?");
							if (model.getValue("/root/tempData/confirm") == "Y"){
								
								if (isRegNo_fgnno2(ern)){
									//input28.disabled = false;
									model.setValue("/root/resData/resForm/frnc_pers_yn", "Y");
									checkbox3.refresh();
									
									model.setValue("/root/resData/resForm/corp_clsf", "2");
									radio1.refresh();
								} else {
									model.alert("여권번호가 정확하지 않습니다. 등록이 불가능합니다.");
									model.setValue("/root/tempData/confirm", "");
									return;
								}
							} else {
								return;
							}
							model.setValue("/root/tempData/confirm", "");
						}
						*/
						input3.refresh();
						ern = input3.currentText;
						
						if (!b_corp_clsf_1 && !b_corp_clsf_2){
							//showConfirmBox("주민번호 와 사업자번호 둘다 맞지 않습니다.");
							model.alert("주민번호 와 사업자번호 둘다 맞지 않습니다.");
							return;
						} else {
							
							model.send("co_dlco_1005");
							
							var tempNode = instance1.selectNodes("/root/tempData/resForm/record/ern");
							if (tempNode.length > 0){
								model.copyNode("/root/resData/resForm","/root/tempData/resForm/record");
								model.setValue("/root/resData/resForm/ern", ern);
								model.makeNode("/root/resData/resForm/email_1");
								model.makeNode("/root/resData/resForm/email_2");
								model.makeNode("/root/resData/resForm/frnc_pers_yn");
								model.makeNode("/root/resData/resForm/email_host");
								
								if (model.getValue("/root/resData/resForm/corp_clsf") == "1"){
									dlco_clsf_set(false);
								} else {
									dlco_clsf_set(true);
								}
								model.makeNode("/root/resData/resForm/mode");
								model.setValue("/root/resData/resForm/mode", "U");
							}
							group1.refresh();
						}
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					/*
						if (event.keyCode ==13){
							model.setValue("/root/resData/resForm/ern", input3.currentText);
							model.send("co_dlco_1005");
						} else {
							var ern = input3.currentText;
							//alert(ern.length);
							//if (ern.length == 6){
							//	input3.currentText = ern + "-";
							//}
							if (ern.length == 12){
								dlco_init(false);
							} else {
								dlco_init(true);
							}
						}
						*/
					]]>
				</script>
			</input>
			<input id="input4" ref="/root/resData/resForm/zip_1" navindex="7" style="left:104px; top:54px; width:35px; height:18px; "/>
			<input id="input5" ref="/root/resData/resForm/zip_2" navindex="8" inputtype="button" style="left:150px; top:54px; width:45px; height:18px; ">
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//onClickZipPopup();
						//se_openZip();
						se_openZip("L", "/root/resData/resForm/zip_1", "/root/resData/resForm/zip_2", "/root/resData/resForm/addr");
					]]>
				</script>
			</input>
			<input id="output2" ref="/root/resData/resForm/addr" navindex="9" editable="false" style="left:200px; top:54px; width:195px; height:18px; "/>
			<input id="input7" ref="/root/resData/resForm/dtls_addr" navindex="10" style="left:397px; top:54px; width:210px; height:18px; "/>
			<input id="input26" ref="/root/resData/resForm/frnc_addr" navindex="12" style="left:104px; top:79px; width:503px; height:18px; "/>
			<input id="input9" ref="/root/resData/resForm/tel_no" navindex="5" style="left:412px; top:30px; width:170px; height:18px; "/>
			<input id="input11" ref="/root/resData/resForm/fax_no" navindex="6" style="left:720px; top:29px; width:116px; height:18px; "/>
			<input id="input13" ref="/root/resData/resForm/presi_nm" navindex="16" style="left:105px; top:137px; width:65px; height:18px; "/>
			<input id="input14" ref="/root/resData/resForm/presi_prn" navindex="17" style="left:412px; top:137px; width:112px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var ern = input14.currentText;
						var ern_arr = new Array();
						
						if (ern.indexOf("-") > 0){
							ern_arr = ern.split("-");
						} else {
							ern_arr[0] = ern.substring(0,6);
							ern_arr[1] = ern.substring(6,13);
						}
						
						if (CheckResident_number(ern_arr[0], ern_arr[1])){
							if (ern.indexOf("-") < 0){
								model1.setValue("/root/resData/resForm/presi_prn", ern_arr[0] + "-" + ern_arr[1]);
							}
						} else {
							model.alert("대표자주민번호가 정확하지 않습니다.");
							return;
						}
						input14.refresh();
					]]>
				</script>
			</input>
			<input id="input15" ref="/root/resData/resForm/presi_zip_1" navindex="19" style="left:105px; top:162px; width:35px; height:18px; "/>
			<input id="input16" ref="/root/resData/resForm/presi_zip_2" navindex="20" inputtype="button" style="left:150px; top:162px; width:45px; height:18px; ">
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						se_openZip("L", "/root/resData/resForm/presi_zip_1", "/root/resData/resForm/presi_zip_2", "/root/resData/resForm/presi_addr");
					]]>
				</script>
			</input>
			<input id="input17" ref="/root/resData/resForm/presi_addr" navindex="21" style="left:200px; top:162px; width:195px; height:18px; "/>
			<input id="input18" ref="/root/resData/resForm/presi_dtls_addr" navindex="22" style="left:400px; top:162px; width:205px; height:18px; "/>
			<input id="input19" ref="/root/resData/resForm/presi_tel_no" navindex="18" style="left:720px; top:137px; width:116px; height:18px; "/>
			<select1 id="combo4" ref="/root/resData/resForm/setl_bank" navindex="23" appearance="minimal" style="left:105px; top:187px; width:116px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/setl_bank/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<input id="input21" ref="/root/resData/resForm/acct_no" navindex="24" style="left:412px; top:187px; width:170px; height:18px; "/>
			<input id="input22" ref="/root/resData/resForm/rcpm_main_nm" navindex="25" style="left:720px; top:187px; width:115px; height:18px; "/>
			<select1 id="radio1" ref="/root/resData/resForm/corp_clsf" navindex="26" appearance="full" cols="2" rows="1" overflow="visible" style="left:104px; top:218px; width:196px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>개인</label>
						<value>2</value>
					</item>
					<item>
						<label>법인</label>
						<value>1</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
					var corp_clsf = radio1.value;
					var ern = model1.getValue("/root/resData/resForm/ern");
					var ern_arr = new Array();
					var ern_biz = ern.replace(/-/ig, "");
					
					if (ern.indexOf("-") > 0){
						ern_arr = ern.split("-");
					} else {
						ern_arr[0] = ern.substring(0,6);
						ern_arr[1] = ern.substring(6,13);
					}
					
					if (corp_clsf == 2){
						if (model.getValue("/root/resData/resForm/frnc_pers_yn") != "Y"){
							if (!CheckResident_number(ern_arr[0], ern_arr[1])){
								alert("주민/사업자번호가 개인에 적합하지 않습니다.");
								radio1.value = 1;
								return;
							}
						}
					} else if (corp_clsf == 1){
						if (!CheckBusiness_Number(ern_biz)){
							alert("주민/사업자번호가 법인에 적합하지 않습니다.");
							radio1.value = 2;
							return;
						}
					}
					
					/*
					if (CheckResident_number(ern_arr[0], ern_arr[1])){
							//alert("주민번호는 안맞는다.");
							b_corp_clsf_1 = true;
							if (ern.indexOf("-") < 0){
								//input3.currentText = ern_arr[0] + "-" + ern_arr[1];
								model1.setValue("/root/resData/resForm/ern", ern_arr[0] + "-" + ern_arr[1]);
								//alert(ern_arr[0] + "\n" + ern_arr[1]);
							}
							model.setValue("/root/resData/resForm/corp_clsf", "2");
							radio1.refresh();
						} else {
							b_corp_clsf_1 = false;
						}
						var ern_biz = ern.replace(/-/ig, "");
						if (CheckBusiness_Number(ern_biz)){
							//alert("사업자번호는 맞는다.");
							if (ern.indexOf("-") < 0){
								//input3.currentText = ern.substring(0,3) + "-" + ern.substring(3,5) + "-" + ern.substring(5,12);
								model1.setValue("/root/resData/resForm/ern", ern.substring(0,3) + "-" + ern.substring(3,5) + "-" + ern.substring(5,12));
								//alert(ern_arr[0] + "\n" + ern_arr[1]);
							}
							b_corp_clsf_2 = true;
							model.setValue("/root/resData/resForm/corp_clsf", "1");
							radio1.refresh();
						} else {
							b_corp_clsf_2 = false;
							//alert("사업자번호는 안맞는다.");
						}
						*/
					]]>
				</script>
			</select1>
			<input id="input20" ref="/root/resData/resForm/mang_no_2" navindex="27" style="left:413px; top:219px; width:115px; height:18px; "/>
			<input id="input27" ref="/root/resData/resForm/email_1" navindex="29" style="left:105px; top:244px; width:135px; height:18px; "/>
			<select id="checkbox2" ref="/root/resData/resForm/elec_tax_stmt_yn" navindex="32" overflow="visible" appearance="full" style="left:720px; top:245px; width:200px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>전자세금계산서 사용</label>
						<value>Y</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
					if (model.getValue("/root/resData/resForm/email_1") == "" || model.getValue("/root/resData/resForm/email_2") == ""){
						model.alert("전자세금계산서를 사용하기 위해서는 반드시 전자우편주소를 입력하셔야 합니다.");
						model.setValue("/root/resData/resForm/elec_tax_stmt_yn", "");
						checkbox2.refresh();
						return;
					}
					]]>
				</script>
			</select>
			<select id="checkbox1" ref="/root/resData/resForm/err_eps_no_aprv_yn" navindex="28" overflow="visible" appearance="full" style="left:720px; top:219px; width:200px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>오류사업자번호 사용</label>
						<value>Y</value>
					</item>
				</choices>
			</select>
			<caption id="caption11" class="list_cap01" style="left:616px; top:75px; width:100px; height:26px; ">국가코드</caption>
			<caption id="caption30" class="list_cap02" style="left:715px; top:75px; width:210px; height:26px; "/>
			<select1 id="combo2" ref="/root/resData/resForm/natn_cd" navindex="13" appearance="minimal" style="left:720px; top:79px; width:170px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/natn_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<input id="output1" ref="/root/resData/resForm/dlco_no" editable="false" style="left:720px; top:4px; width:100px; height:18px; "/>
			<caption id="caption36" class="list_cap01" style="left:0px; top:297px; width:100px; height:26px; ">입력자</caption>
			<caption id="caption42" class="list_cap02" style="left:99px; top:297px; width:210px; height:26px; "/>
			<output id="output3" ref="/root/resData/resForm/incmg_pers" style="left:105px; top:301px; width:85px; height:18px; "/>
			<output id="output4" ref="/root/resData/resForm/incmg_nm" style="left:195px; top:301px; width:85px; height:18px; "/>
			<caption id="caption44" class="list_cap02" style="left:99px; top:322px; width:210px; height:26px; "/>
			<caption id="caption47" class="list_cap01" style="left:0px; top:322px; width:100px; height:26px; ">수정자</caption>
			<output id="output5" ref="/root/resData/resForm/chg_pers" style="left:105px; top:326px; width:85px; height:18px; "/>
			<output id="output6" ref="/root/resData/resForm/chg_nm" style="left:195px; top:326px; width:85px; height:18px; "/>
			<caption id="caption50" class="list_cap02" style="left:407px; top:297px; width:210px; height:26px; "/>
			<caption id="caption51" class="list_cap01" style="left:308px; top:297px; width:100px; height:26px; ">입력일자</caption>
			<output id="output7" ref="/root/resData/resForm/incmg_dt_tm" style="left:413px; top:301px; width:85px; height:18px; "/>
			<caption id="caption52" class="list_cap02" style="left:407px; top:322px; width:210px; height:26px; "/>
			<caption id="caption59" class="list_cap01" style="left:308px; top:322px; width:100px; height:26px; ">수정일자</caption>
			<output id="output8" ref="/root/resData/resForm/chg_dt_tm" style="left:413px; top:326px; width:85px; height:18px; "/>
			<caption id="caption12" class="list_cap01" style="left:0px; top:272px; width:100px; height:26px; ">연관업무</caption>
			<caption id="caption60" class="list_cap02" style="left:99px; top:272px; width:826px; height:26px; "/>
			<select id="checkbox3" ref="/root/resData/resForm/frnc_pers_yn" navindex="4" overflow="visible" appearance="full" style="left:230px; top:30px; width:78px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>외국인여부</label>
						<value>Y</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
						var corp_clsf = model.getValue("/root/resData/resForm/corp_clsf");
						var ern = model.getValue("/root/resData/resForm/ern");
						var err_eps_no_aprv_yn = model.getValue("/root/resData/resForm/err_eps_no_aprv_yn");
						var ret = new dlcoMsg();
							
						ern = ern.replace(/-/ig, "");
						if (corp_clsf == "1"){
							ret.setDlco(false, "법인은 외국인 체크가 될 수 없습니다.");
						} else {
							if (isRegNo_fgnno2(ern)){
								ret.setDlco(true, "외국인 여권번호가 정확합니다.");
							} else {
								ret.setDlco(false, "주민사업자번호의 여권번호가 정확하지 않습니다.");
							}
						}
						
						if (err_eps_no_aprv_yn == "Y"){
							if (!ret.bVal){
								showConfirmBox("여권번호가 정확하지 않습니다. 그래도 사용하시겠습니까?");
								if (model.getValue("/root/tempData/confirm") == "Y"){
									//input28.disabled = false;
									model.setValue("/root/tempData/confirm", "");
									return;
								}
							}
						} else {
							if (ret.bVal){
								//input28.disabled = false;
								return;
							} else {
								showConfirmBox("여권번호가 정확하지 않습니다. 그래도 사용하시겠습니까?");
								//model.alert(ret.strMsg);
								if (model.getValue("/root/tempData/confirm") == "N"){
									//input28.disabled = false;
									model.setValue("/root/resData/resForm/frnc_pers_yn", "");
									model.setValue("/root/tempData/confirm", "");
									checkbox3.refresh();
									return;
								}
							}
						}
					]]>
				</script>
			</select>
			<button id="button3" class="btn02" style="left:105px; top:275px; width:52px; height:21px; ">
				<caption>판매</caption>
			</button>
			<button id="button4" class="btn02" style="left:165px; top:275px; width:52px; height:21px; ">
				<caption>출판</caption>
			</button>
			<button id="button5" class="btn02" style="left:225px; top:275px; width:52px; height:21px; ">
				<caption>광고</caption>
			</button>
			<button id="button6" class="btn02" style="left:285px; top:275px; width:52px; height:21px; ">
				<caption>자재</caption>
			</button>
			<select1 id="combo1" ref="/root/resData/resForm/email_host" navindex="31" appearance="minimal" style="left:455px; top:244px; width:150px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/mail_host/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						model.setValue("/root/resData/resForm/email_2", model.getValue("/root/resData/resForm/email_host"));
						input24.refresh();
					]]>
				</script>
			</select1>
			<caption id="caption13" style="left:245px; top:245px; width:20px; height:20px; ">@</caption>
			<input id="input24" ref="/root/resData/resForm/email_2" navindex="30" style="left:260px; top:244px; width:180px; height:18px; "/>
			<caption id="caption46" class="list_cap01" style="left:616px; top:50px; width:100px; height:26px; ">국가전화번호</caption>
			<caption id="caption61" class="list_cap02" style="left:715px; top:50px; width:210px; height:26px; "/>
			<input id="input25" ref="/root/resData/resForm/natn_tel_no" navindex="11" style="left:720px; top:55px; width:116px; height:18px; "/>
			<caption id="caption20" class="list_cap01" style="left:308px; top:100px; width:100px; height:26px; ">종목</caption>
			<input id="input12" ref="/root/resData/resForm/item" navindex="15" style="left:413px; top:104px; width:170px; height:18px; "/>
			<input id="input10" ref="/root/resData/resForm/bizcond" navindex="14" style="left:104px; top:104px; width:170px; height:18px; "/>
			<caption id="caption19" class="list_cap01" style="left:0px; top:100px; width:100px; height:26px; ">업태</caption>
		</group>
		<group id="group2" style="left:10px; top:48px; width:575px; height:26px; ">
			<caption id="caption41" class="list_cap01" heigth="26px" style="left:0px; top:0px; width:70px; height:26px; ">검색구분</caption>
			<caption id="caption43" class="list_cap02" style="left:69px; top:0px; width:456px; "/>
			<!--
			<select1 id="combo1" ref="/root/reqData/srchData/sys_clsf_cd" appearance="minimal" style="left:75px; top:4px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/sys_clsf_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			-->
			<select1 id="combo3" ref="/root/reqData/searchData/search_clsf" appearance="minimal" style="left:75px; top:4px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/srch_tag/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
						var idx = combo3.focusIndex;
						if (idx == 2){
							input8.attribute("visibility") = "visible";
							input23.value = "";
							input8.value = "";
						} else {
							input8.attribute("visibility") = "hidden";
							input23.value = "";
						}
					]]>
				</script>
			</select1>
			<input id="input23" ref="/root/reqData/searchData/search_key_1" style="left:207px; top:4px; width:108px; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if (event.keyCode ==13){
							var tmpVal1 = input23.currentText;
							var tmpVal2 = input8.currentText;
							
							model1.setValue("/root/reqData/searchData/search_key_1", tmpVal1);
							model1.setValue("/root/reqData/searchData/search_key_2", tmpVal2);
							
							var search_clsf = model.getValue("/root/reqData/searchData/search_clsf");
							var str_search_clsf = "";

							if (search_clsf == "A"){
								str_search_clsf = "거래처명을";
							} else if (search_clsf == "B"){
								str_search_clsf = "대표자명을";
							} else if (search_clsf == "C"){
								str_search_clsf = "거래처번호를";
							}
							if (tmpVal1 == "" && tmpVal1 == ""){
								alert("검색할 거래처의 " + str_search_clsf + " 입력해주십시오.");
								return;
							} else {
								model1.send("co_dlco_1000");
							}
						}
					]]>
				</script>
			</input>
			<input id="input8" ref="/root/reqData/searchData/search_key_2" visibility="hidden" style="left:330px; top:4px; width:108px; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if (event.keyCode ==13){
							var tmpVal1 = input23.currentText;
							var tmpVal2 = input8.currentText;
							model1.setValue("/root/reqData/searchData/search_key_1", tmpVal1);
							model1.setValue("/root/reqData/searchData/search_key_2", tmpVal2);
							
							var search_clsf = model.getValue("/root/reqData/searchData/search_clsf");
							var str_search_clsf = "";

							if (search_clsf == "A"){
								str_search_clsf = "거래처명을";
							} else if (search_clsf == "B"){
								str_search_clsf = "대표자명을";
							} else if (search_clsf == "C"){
								str_search_clsf = "거래처번호를";
							}
							if (tmpVal1 == "" && tmpVal2 == ""){
								alert("검색할 거래처의 " + str_search_clsf + " 입력해주십시오.");
								return;
							} else {
								model1.send("co_dlco_1000");
							}
						}
					]]>
				</script>
			</input>
		</group>
		<group id="group_btnA" class="gro_btn" style="left:635px; top:52px; width:301px; height:21px; ">
			<button id="button1" class="btn02" style="left:78px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="DOMActivate">
					<![CDATA[
					var search_key_1 = model.getValue("/root/reqData/searchData/search_key_1");
					var search_key_2 = model.getValue("/root/reqData/searchData/search_key_2");
					var search_clsf = model.getValue("/root/reqData/searchData/search_clsf");
					var str_search_clsf = "";
					
					if (search_clsf == "A"){
						str_search_clsf = "거래처명을";
					} else if (search_clsf == "B"){
						str_search_clsf = "대표자명을";
					} else if (search_clsf == "C"){
						str_search_clsf = "거래처번호를";
					}
					model.reset();
					model.setValue("/root/reqData/searchData/search_key_1", search_key_1);
					model.setValue("/root/reqData/searchData/search_key_2", search_key_2);
					model.setValue("/root/reqData/searchData/search_clsf", search_clsf);
					if (search_key_1 == "" && search_key_2 == ""){
						alert("검색할 거래처의 " + str_search_clsf + " 입력해주십시오.");
						return;
					} else {
						model1.send("co_dlco_1000");
					}
					
					button3.disabled = true;
					button4.disabled = true;
					button5.disabled = true;
					button6.disabled = true;
					
					]]>
				</script>
			</button>
			<button id="btnA1" class="btn02" style="left:192px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model1.reset();
					//input28.disabled = true;
					button3.disabled = true;
					button4.disabled = true;
					button5.disabled = true;
					button6.disabled = true;
					
					model.property("IF_DLCO_NO") = "";
					model.property("IF_ERN") = "";
					model.property("IF_DLCO_NM") = "";
					model.property("IF_DLCO_ABRV_NM") = "";
					model.property("IF_ACCT_NO") = "";
					model.property("IF_CORP_CLSF") = "";
					model.property("IF_RCPM_MAIN_NM") = "";
//					var nodeList;
//					combo1.refresh();
//					combo3.refresh();
//					input23.value = "";
//					model1.removeNode("/root/gridData/main");
//					model1.setValue("/root/resData/resForm/type", "I");
//					
//					nodeList = instance1.selectNodes("/root/bodyData/formData");
//					alert("폼의 갯수=" + nodeList);
//					for(i=0; i<nodeList.length; i++){
//						model1.setValue(nodeList.item(i), "");
//					}
//					model1.removeNode("/root/bodyData/formData");
//					model1.refresh();
//					//sys_initialize();
					]]>
				</script>
			</button>
			<button id="btnA2" class="btn02" style="left:135px; top:0px; width:52px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var strMode = "";
						strMode = model1.getValue("/root/resData/resForm/mode");
						
						//필수입력사항 체크
						if (model.getValue("/root/resData/resForm/dlco_nm") == ""){
							model.alert("성명/거래처명을 입력해주십시오.");
							return;
						}
						if (model.getValue("/root/resData/resForm/dlco_abrv_nm") == ""){
							model.alert("약어명을 입력해주십시오.");
							return;
						}
						//if (model.getValue("/root/resData/resForm/ern") == ""){
						//	model.alert("주민/사업자번호를 입력해주십시오.");
						//	return;
						//}
						
						// 오류사업자번호 사용여부에 따른 주민사업자번호 체크
						var err_eps_no_aprv_yn = model.getValue("/root/resData/resForm/err_eps_no_aprv_yn");
						var ern = model.getValue("/root/resData/resForm/ern");
						var aNode = instance1.selectSingleNode("/root/resData/resForm");
						
						var corp_clsf		= model.getValue("/root/resData/resForm/corp_clsf");
						var frnc_pers_yn	= model.getValue("/root/resData/resForm/frnc_pers_yn");
						var returnVal		= check_corp_ern(ern, corp_clsf, frnc_pers_yn);
						var mail_check		= new Array();
						var setl_check		= new Array();
						var check_count	= 0;

						if (err_eps_no_aprv_yn == "" || err_eps_no_aprv_yn == "N" ){
							if (!returnVal.bVal){
								model.alert(returnVal.strMsg);
								return;
							}
							/*
							if (model.getValue("/root/resData/resForm/presi_prn") == "" && model.getValue("/root/resData/resForm/corp_clsf") == "1"){
								model.alert("법인은 대표자의 주민번호를 입력해주십시오.");
								return;
							}
							*/
							
						} else if (err_eps_no_aprv_yn == "Y") {
							if (!returnVal.bVal){
								showConfirmBox(returnVal.strMsg + " 사용하시겠습니까?");
								
								if (model.getValue("/root/tempData/confirm") != "Y"){
									return;
								}
								model.setValue("/root/tempData/confirm", "");
							}
						}
						if (frnc_pers_yn == "Y"){
							if (model.getValue("/root/resData/resForm/natn_tel_no") == ""){
								model.alert("외국인 거래처는 전화번호에서 외국 국가전화코드를 입력해주십시오.");
								return;
							}
							if (model.getValue("/root/resData/resForm/frnc_addr") == ""){
								model.alert("외국인 거래처는 외국주소를 입력해주십시오.");
								return;
							}
							if (model.getValue("/root/resData/resForm/natn_cd") == ""){
								model.alert("외국인 거래처는 국가코드를 입력해주십시오.");
								return;
							}
						}
						
						if (model.getValue("/root/resData/resForm/email_1") == ""){
							check_count++;
						}
						if (model.getValue("/root/resData/resForm/email_2") == ""){
							check_count++;
						}

						if (check_count < 2 && check_count > 0){
							alert("E-MAIL 입력이 정확하지 않습니다. 마저 입력해주십시오.");
							return;
						}
						if (model.getValue("/root/resData/resForm/email_1") != "" && model.getValue("/root/resData/resForm/email_2") != ""){
							model.setValue("/root/resData/resForm/email", model.getValue("/root/resData/resForm/email_1") + "@" + model.getValue("/root/resData/resForm/email_2"));
						}
						
						check_count = 0;
						if (model.getValue("/root/resData/resForm/setl_bank") == ""){
							check_count++;
						}
						if (model.getValue("/root/resData/resForm/acct_no") == ""){
							check_count++;
						}
						if (model.getValue("/root/resData/resForm/rcpm_main_nm") == ""){
							check_count++;
						}

						if (check_count < 3 && check_count > 0){
							alert("결제은행 정보와 계좌정보, 입금주 정보 중에서 한개가 빠졌습니다. 마저 입력해주십시오.");
							return;
						}
						if (strMode == "I") {
							//	중복 공통거래처 유무를 체크한다.
							model1.send("co_dlco_1003");
							var chk_count = model.getValue("/root/tempData/chk_count");
							if (eval(chk_count) > 0){
								model.alert("중복된 공통거래처입니다.거래처정보를 입력하신 거래처명으로 조회해주십시오.");
								return;
							}
							
							model1.setValue("/root/resData/resForm/incmg_pers_cmpy_cd", "100");
						} else if (strMode == "U") {
							model1.setValue("/root/resData/resForm/chg_pers_cmpy_cd", "100");
						}

						model1.refresh();
						model1.send("co_dlco_1002");
						
						if(submit_completed()) {
							alert("정상적으로 처리되었습니다.");
							if (strMode == "U") {
								var srch_tag = model1.getValue("/root/reqData/searchData/search_clsf");
								var srch_key_1 = model1.getValue("/root/reqData/searchData/search_key_1");
								var srch_key_2 = model1.getValue("/root/reqData/searchData/search_key_2");
								var dlco_no = model1.getValue("/root/resData/resForm/dlco_no");
								var selectedRow = datagrid1.row;
								
								model1.reset();
								model1.setValue("/root/reqData/searchData/search_clsf", srch_tag);
								model1.setValue("/root/reqData/searchData/search_key_1", srch_key_1);
								model1.setValue("/root/reqData/searchData/search_key_2", srch_key_2);
								
								if (!(srch_key_1 == "" && srch_key_2 == "")){
									model1.send("co_dlco_1000");
								}
								datagrid1.isselected(selectedRow) = true;
								model1.setValue("/root/reqData/searchData/dlco_no", dlco_no);
								
								model1.send("co_dlco_1006");
								
								model.copyNode("/root/resData/resForm", "/root/tempData/record");
								model.makeNode("/root/resData/resForm/email_1");
								model.makeNode("/root/resData/resForm/email_2");
								model.makeNode("/root/resData/resForm/frnc_pers_yn");
								model.makeNode("/root/resData/resForm/email_host");
								
								model1.setValue("/root/resData/resForm/email_1", model.getValue("/root/tempData/record/email").substring(0, model.getValue("/root/tempData/record/email").indexOf("@")));
								model1.setValue("/root/resData/resForm/email_2", model.getValue("/root/tempData/record/email").substring(model.getValue("/root/tempData/record/email").indexOf("@") + 1, model.getValue("/root/tempData/record/email").length));
								model1.setValue("/root/resData/resForm/email_host", model.getValue("/root/tempData/record/email").substring(model.getValue("/root/tempData/record/email").indexOf("@") + 1, model.getValue("/root/tempData/record/email").length));
								
								if (model.getValue("/root/resData/resForm/corp_clsf") == "1"){
									dlco_clsf_set(false);
								} else {
									dlco_clsf_set(true);
								}
								model.makeNode("/root/resData/resForm/mode");
								model.setValue("/root/resData/resForm/mode", "U");
								model.refresh();
								//datagrid1.dispatch("onclick");
								
							} else if (strMode == "I") {
								var dlco_no = model1.getValue("/root/tempData/dlco_no");
								
								if(window.type == "mdi"){
									model1.reset();
								} else {
									//model.property("IF_DLCO_NO") = dlco_no;
									//openerCopyNode("/root/tempData", "/root/tempData");
									model.property("IF_DLCO_NO") = model1.getValue("/root/tempData/dlco_no");
									model.property("IF_ERN") = model1.getValue("/root/tempData/ern");
									model.property("IF_DLCO_NM") = model1.getValue("/root/tempData/dlco_nm");
									model.property("IF_DLCO_ABRV_NM") = model1.getValue("/root/tempData/dlco_abrv_nm");
									model.property("IF_ACCT_NO") = model1.getValue("/root/tempData/acct_no");
									model.property("IF_CORP_CLSF") = model1.getValue("/root/tempData/corp_clsf");
									model.property("IF_RCPM_MAIN_NM") = model1.getValue("/root/tempData/rcpm_main_nm");
									
									window.close();
								}
								
							}
						}
						
					]]>
				</script>
			</button>
			<!--
			<button id="btnA3" class="btn02" style="left:193px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					strType = "D";
					model1.setValue("/root/resData/resForm/mode", "D");
					model1.send("co_dlco_1002");
					]]>
				</script>
			</button>
			-->
			<button id="button2" class="btn02" style="left:249px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if(window.type == "mdi"){
						viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					}else{
//						model.property("IF_DLCO_NO") = "99999999";
						window.close();
					}
					]]>
				</script>
			</button>
		</group>
	</xhtml:body>
</xhtml:html>
