<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>세금계산서 관리(CO_SMTB_1040)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session>
							<semuro_id/>
						</session>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<!-- 선택계열의 정보를 담당 -->
							<dataSet>
								<SMTB_STAT_CD_LIST>
									<record>
										<cd/>
										<cdnm/>
										<cd_abrv_nm/>
										<cdnm_cd/>
										<cdabrvnm_cd/>
									</record>
								</SMTB_STAT_CD_LIST>
								<ERPLACE_CD_LIST>
									<record>
										<cd/>
										<cdnm/>
										<cd_abrv_nm/>
										<cdnm_cd/>
										<cdabrvnm_cd/>
									</record>
								</ERPLACE_CD_LIST>
								<DLCO_CLSF_CD_LIST>
									<record>
										<cd/>
										<cdnm/>
										<cd_abrv_nm/>
										<cdnm_cd/>
										<cdabrvnm_cd/>
									</record>
								</DLCO_CLSF_CD_LIST>
								<SLIP_CLSF_LIST>
									<record>
										<cd/>
										<cdnm/>
										<cd_abrv_nm/>
										<cdnm_cd/>
										<cdabrvnm_cd/>
									</record>
								</SLIP_CLSF_LIST>
							</dataSet>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<searchData>
							<cmpy_cd/>
							<supbuy_type>AP</supbuy_type>
							<direction/>
							<dti_status/>
							<sup_bizplace_code/>
							<dti_wdate_fr/>
							<dti_wdate_to/>
							<com_regno/>
							<com_name/>
							<slip_clsf_cd/>
							<slip_occr_dt_fr/>
							<slip_occr_dt_to/>
							<dti_type>0</dti_type>
							<search_type>1</search_type>
						</searchData>
						<reqForm>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<semuro_no/>
						</reqForm>
						<multiUpDate>
							<multiUpdateData/>
						</multiUpDate>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<resForm>
							<co_smtb_1021_u>
								<dataSet>
									<errcode/>
									<errmsg/>
									<batch_id/>
									<smart_id/>
									<smart_pw/>
								</dataSet>
							</co_smtb_1021_u>
						</resForm>
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<co_smtb_1031_l>
								<dataSet>
									<TAX_STMTLIST>
										<record>
											<conversation_id/>
											<supbuy_type/>
											<direction/>
											<dti_wdate/>
											<blank_cnt/>
											<dti_type/>
											<tax_demand/>
											<seq_id/>
											<sup_com_id/>
											<sup_com_regno/>
											<sup_rep_name/>
											<sup_com_name/>
											<sup_com_type/>
											<sup_com_classify/>
											<sup_com_addr/>
											<sup_bizplace_code/>
											<byr_com_regno/>
											<byr_rep_name/>
											<byr_com_name/>
											<byr_com_type/>
											<byr_com_classify/>
											<byr_com_addr/>
											<byr_tel_num/>
											<byr_email/>
											<sup_amount/>
											<tax_amount/>
											<total_amount/>
											<dtt_yn/>
											<remark/>
											<dti_status/>
											<dti_status_nm/>
											<return_code/>
											<return_description/>
											<sbdescription/>
											<created_by/>
											<creation_date/>
											<last_updated_by/>
											<last_update_date/>
										</record>
										<totalcnt/>
									</TAX_STMTLIST>
									<errcode/>
									<errmsg/>
								</dataSet>
							</co_smtb_1031_l>
							<co_smtb_1030_m>
								<dataSet>
									<SMTB_STAT_CD_LIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</SMTB_STAT_CD_LIST>
									<ERPLACE_CD_LIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</ERPLACE_CD_LIST>
									<DLCO_CLSF_CD_LIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</DLCO_CLSF_CD_LIST>
									<SLIP_CLSF_LIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</SLIP_CLSF_LIST>
								</dataSet>
							</co_smtb_1030_m>
						</gridData>
						<MsgData/>
					</resData>
					<tempData>
						<dt_clsf/>
						<dlco_cd/>
						<dlco_nm/>
					</tempData>
				</root>
			</instance>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<script type="javascript" src="/js/fcmc_common.js"/>
			<script type="javascript" src="/js/se_comm.js"/>
			<submission id="co_smtb_1030_m" action="/co/smtb/1030" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/comboSet/dataSet"/>
			<submission id="co_smtb_1031_l" action="/co/smtb/1031" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/co_smtb_1031_l/dataSet"/>
			<submission id="co_smtb_1021_u" action="/co/smtb/1021" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/resData/resForm/co_smtb_1021_u/dataSet"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					model.send("co_smtb_1030_m");
//					model.copyNode("/root/initData/comboSet", "/root/resData");
					makeComboGubun("", "/root/initData/comboSet/dataSet/SMTB_STAT_CD_LIST", "record", "cdnm_cd", "cd");
					makeComboGubun("", "/root/initData/comboSet/dataSet/ERPLACE_CD_LIST", "record", "cd_abrv_nm", "cd");
					//makeComboGubun("", "/root/initData/comboSet/dataSet/CUR_SLIP_CLSF_LIST", "record", "cd_nm", "cd");

					set_refvalue("/root/reqData/searchData/dti_wdate_fr",commCurDate());
					set_refvalue("/root/reqData/searchData/dti_wdate_to",commCurDate());	
					set_refvalue(combo2,"I");
					model.refresh();
										
				]]>
			</script>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
				init_controls();
				set_column_visibility();
				]]>
			</script>
		</model>
		<script type="javascript">
			<![CDATA[
			var	_oth_clsf = "1";
			
			function init_controls(){
				set_default(datagrid1);							//datagrid

			}	
			function set_column_visibility() {
				//모든 컬럼을 감춘다.
				hide_all_columns(datagrid1);
				//공통항목을 보여준다.
				show_all_columns(datagrid1);
			}		
			
			function open_fc_acct_1180(p_where,p_mode) {
				var need_popup = true;
				var rcvs_flag = false;

				//버튼클릭으로 이벤트가 발생하기 전에
				//value-changed 이벤트가 먼저 발생한 경우
				//input button의 내부 버튼이 클릭됐는지 여부를 확인한다.
				if (check_dup_input_event()) {					
					return rcvs_flag;
				}
				
				//검색조건이 모두 충족하지 않으면 종료한다.
				if (gstr_popupid == "dlco_cd") { 		// 거래처
					if (p_where == "FOCUS" && (dlco_clsf_cd.value.Trim() == "" || dlco_cd.value.Trim() == "")) {
						dlco_nm.value	= "";
						return rcvs_flag;
					}
				}
				else if (gstr_popupid == "ern") { // 공급자번호
					if (p_where == "FOCUS" && (dlco_cd.value.Trim() == "")) {
						return rcvs_flag;
					}				
				}
				
				p_where = p_where.toUpperCase();
				
				var popid = "fc_acct_1180";
				var subid = "fc_acct_1181_l";

				set_popup_send_data(popid		,"mode"			,p_mode			);
				set_popup_send_data(popid  ,"title"   ,""    );
//				set_popup_send_data(popid  ,"readonly"  ,"1"    );

				if (gstr_popupid == "dlco_cd") { 		// 거래처
					set_popup_send_data(popid		,"clsf_cd"			,dlco_clsf_cd.value	);
					set_popup_send_data(popid		,"cd_f"			,dlco_cd.value		);
					set_popup_send_data(popid		,"cd_t"			,dlco_cd.value		);
//					set_popup_send_data(popid		,"cd_abrv_nm"		,dlco_cd.value		);
				}
				else if (gstr_popupid == "ern") { // 공급자번호
					set_popup_send_data(popid		,"clsf_cd"			,"93"	);
					set_popup_send_data(popid		,"cd_f"			,dlco_cd.value		);
					set_popup_send_data(popid		,"cd_t"			,dlco_cd.value		);
//					set_popup_send_data(popid		,"cd_abrv_nm"		,ern.value		);
				}
				


				//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
				if (p_where == "FOCUS") {
					//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
					//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
					model.removenode(get_popup_rcvs_ref(popid));
					//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
					model.makeNode(get_popup_rcvs_ref(popid));
					
//					alert(get_popup_send_ref(popid));
					
					//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
					send_submission(
							"auto_" + subid
						,	get_popup_send_ref(popid)
						,	get_popup_rcvs_ref(subid) + "/dataSet"
						,	"/fc/acct1000/1181"
						,	"urlencoded-post"
						,	"application/x-www-form-urlencoded"
					);
					
					totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
			
//					alert(totalcnt);
			
					if (totalcnt == 1) {
						//데이터가 1건이고 focus out에서 호출한 경우
						//데이터를 설정하고 나간다.

//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
						model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
//						return;
						need_popup = false;
						 rcvs_flag = false;
					}
					else if (totalcnt == 0) {
//						show_message("[거래처코드]의 검색결과가 없습니다.");
//						return;
						need_popup = true;		
						 rcvs_flag = false;				
					}
					else {
						//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
						//만약 1건 이상인 경우 popup을 호출해 달라고 하면
						//return을 지우면 됨
						//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
						//return;
						need_popup = true;
					}
				}
				
				//그외 버튼인 경우는 계속 진행
				if (need_popup) {
					 rcvs_flag = open_popup(popid,"640");
				}

				//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
				//다시 조회 하기 쉽도록 하고
				if (gstr_popupid == "dlco_cd") { 		// 거래처
					if (get_popup_rcvs_data(popid,"clsf_cd") != "")			dlco_clsf_cd.value		=	get_popup_rcvs_data(popid,"clsf_cd");
					if (get_popup_rcvs_data(popid,"cd") != "")				dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
					//그외의 값은 지워지도록 한다.
					//if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					//intg_dlco_cd.value		=	get_popup_rcvs_data(popid,"intg_cd");
				}
				else if (gstr_popupid == "ern") { // 공급자번호
//					if (get_popup_rcvs_data(popid,"clsf_cd") != "")			recp_pers_clsf.value		=	get_popup_rcvs_data(popid,"clsf_cd");
					if (get_popup_rcvs_data(popid,"cd") != "")				dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
					if (get_popup_rcvs_data(popid,"cd") != "")				srch_com_regno.value	=	get_popup_rcvs_data(popid,"cd");
					//그외의 값은 지워지도록 한다.
					if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					//pay_bank_cd_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
				}
				return rcvs_flag;
			}			
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="2,34;2,39;2,40;2,50;2,70;2,78;2,80;2,104;2,105;2,112;2,113;2,117;2,118;2,132;2,133;2,157;2,158;2,366;2,377;2,376;2,393;2,408;2,409;1,936;1,927;1,926;1,459;1,449;2,755;">
		<group id="group_scr" class="gro_sel" style="left:10px; top:79px; width:926px; height:76px; ">
			<caption id="caption1" class="list_cap02" style="left:0px; top:0px; width:926px; height:76px; text-align:center; "/>
			<caption id="caption13" class="list_cap02" style="left:470px; top:25px; width:456px; height:26px; text-align:center; "/>
			<caption id="caption12" class="list_cap02" style="left:470px; top:50px; width:456px; height:26px; text-align:center; "/>
			<caption id="caption7" class="list_cap02" style="left:0px; top:50px; width:440px; height:26px; text-align:center; "/>
			<caption id="caption11" class="list_cap02" style="left:0px; top:25px; width:439px; height:26px; text-align:center; "/>
			<caption id="caption9" class="list_cap02" style="left:0px; top:0px; width:439px; height:26px; text-align:center; "/>
			<caption id="caption8" class="list_cap03" style="left:0px; top:0px; width:120px; height:27px; text-align:center; ">발생일자</caption>
			<caption id="caption10" class="list_cap03" style="left:0px; top:25px; width:120px; height:26px; text-align:center; ">발행구분</caption>
			<caption id="caption4" class="list_cap03" style="left:0px; top:50px; width:120px; height:26px; text-align:center; ">상      태</caption>
			<select1 id="combo1" ref="/root/reqData/searchData/direction" appearance="minimal" editmode="inputsearch" itemcount="10" style="left:123px; top:29px; width:98px; height:18px; ">
				<choices>
					<item>
						<label>전체</label>
						<value/>
					</item>
					<item>
						<label>정발행</label>
						<value>2</value>
					</item>
					<item>
						<label>역발행</label>
						<value>1</value>
					</item>
				</choices>
			</select1>
			<select1 id="combo2" ref="/root/reqData/searchData/dti_status" appearance="minimal" editmode="inputsearch" itemcount="10" style="left:123px; top:54px; width:220px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/SMTB_STAT_CD_LIST/record">
						<label ref="cdnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(combo2, combo2.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(combo2,"");
							return;
						}
					]]>
				</script>
			</select1>
			<caption id="caption6" style="left:226px; top:5px; width:15px; height:20px; ">~</caption>
			<input id="srch_dti_wdate_fr" ref="/root/reqData/searchData/dti_wdate_fr" class="req" inputtype="date" required="true" format="yyyy-mm-dd" style="left:123px; top:4px; width:100px; height:18px; "/>
			<input id="srch_dti_wdate_to" ref="/root/reqData/searchData/dti_wdate_to" class="req" inputtype="date" required="true" format="yyyy-mm-dd" style="left:242px; top:4px; width:100px; height:18px; "/>
			<caption id="caption14" class="list_cap02" style="left:470px; top:0px; width:456px; height:26px; text-align:center; "/>
			<caption id="caption15" class="list_cap03" style="left:438px; top:0px; width:113px; height:26px; text-align:center; ">사      업      장</caption>
			<select1 id="combo3" ref="/root/reqData/searchData/sup_bizplace_code" appearance="minimal" editmode="inputsearch" itemcount="10" style="left:555px; top:4px; width:220px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/ERPLACE_CD_LIST/record">
						<label ref="cd_abrv_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(combo3, combo3.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(combo1,"");
							return;
						}								
					]]>
				</script>
			</select1>
			<select1 id="cb_dt_clsf" ref="/root/tempData/dt_clsf" navindex="5" appearance="minimal" style="left:348px; top:4px; width:67px; height:18px; ">
				<choices>
					<item>
						<label>당일</label>
						<value>01</value>
					</item>
					<item>
						<label>당월</label>
						<value>02</value>
					</item>
					<item>
						<label>전월</label>
						<value>03</value>
					</item>
					<item>
						<label>년간</label>
						<value>04</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var currentdt = getCurrentDate();
						var currentmt = getCurrentMonth();				
									
						var dt_clsf = model.getValue("/root/tempData/dt_clsf"); //선택한 콤보박스 값..
										
						if(dt_clsf == "01"){  
							var frdt = dateAdd("d", 0, currentdt);	//당일
							var todt = dateAdd("d",0, currentdt);	//당일
							
							model.setValue("/root/reqData/searchData/dti_wdate_fr", frdt); 
							model.setValue("/root/reqData/searchData/dti_wdate_to", todt); 
						}else if(dt_clsf == "02"){
							var frdt = currentdt.substring(0,6)+"01"; //당월의 1일부터
							var todt = dateAdd("d",0, currentdt);	//당월의 현재일 
							
							model.setValue("/root/reqData/searchData/dti_wdate_fr", frdt); 
							model.setValue("/root/reqData/searchData/dti_wdate_to", todt); 
						}else if(dt_clsf == "03") {
							var frdt = dateAdd("m", -1, currentmt+"01");
							var pre_month = frdt.substring(0,6);
							var todt = pre_month+commLastDay(pre_month); 	//전월의 말일 
							
							model.setValue("/root/reqData/searchData/dti_wdate_fr", frdt); 
							model.setValue("/root/reqData/searchData/dti_wdate_to", todt);
						}else if(dt_clsf == "04") {
							var frdt =  currentmt.substring(0,4)+"0101";  //전월의 1일부터
							var todt =  currentdt;	//전월의 말일 
							
							model.setValue("/root/reqData/searchData/dti_wdate_fr", frdt); 
							model.setValue("/root/reqData/searchData/dti_wdate_to", todt);
						}	
					
						model.refresh();
						
					]]>
				</script>
			</select1>
			<caption id="caption2" class="list_cap03" style="left:438px; top:25px; width:113px; height:26px; text-align:center; ">거      래      처</caption>
			<caption id="caption3" class="list_cap03" style="left:438px; top:50px; width:113px; height:26px; text-align:center; ">사업자등록번호</caption>
			<input id="dlco_nm" ref="/root/tempData/dlco_nm" editable="false" style="left:678px; top:29px; width:239px; height:18px; "/>
			<caption id="caption5" class="list_cap03" style="left:677px; top:50px; width:120px; height:26px; text-align:center; ">사   업   자   명</caption>
			<input id="dlco_cd" ref="/root/tempData/dlco_cd" navindex="5" inputtype="button" style="left:554px; top:29px; width:119px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						gstr_popupid = "ern";
						open_fc_acct_1180("button","s");	
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						gstr_popupid = "ern";
						open_fc_acct_1180("focus","s");		
					]]>
				</script>
			</input>
			<input id="srch_com_name" ref="/root/reqData/searchData/com_name" navindex="-1" editable="true" appearance="input" style="left:800px; top:53px; width:121px; height:18px; text-align:right; border-style:none; "/>
			<input id="srch_com_regno" ref="/root/reqData/searchData/com_regno" navindex="-1" editable="true" appearance="input" style="left:554px; top:54px; width:119px; height:18px; text-align:right; border-style:none; "/>
			<caption id="caption16" class="list_cap03" style="left:241px; top:25px; width:100px; height:26px; text-align:center; ">E-MAIL</caption>
			<select1 id="radio1" ref="/root/reqData/searchData/search_type" appearance="full" cols="2" rows="1" overflow="visible" style="left:349px; top:31px; width:79px; height:15px; text-align:left; border-style:none; ">
				<choices>
					<item>
						<label>유</label>
						<value>1</value>
					</item>
					<item>
						<label>무</label>
						<value>0</value>
					</item>
				</choices>
			</select1>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:160px; width:926px; height:5px; "/>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/co_smtb_1031_l/dataSet/TAX_STMTLIST/record" caption="^발행일자^사업자번호^거래처명^공급가액^부가세^합계^대표자^상태^E-MAIL^세금계산서번호" colsep="#" colwidth="28, 74, 81, 135, 99, 104, 96, 84, 77, 116, 96, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" frozencols="7" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:8px; top:205px; width:931px; height:518px; ">
			<col checkvalue="1,0" type="checkbox"/>
			<col ref="dti_wdate" format="yyyy-mm-dd"/>
			<col ref="sup_com_regno"/>
			<col ref="sup_com_name"/>
			<col ref="sup_amount" format="(-)#,###" style="text-align:right; "/>
			<col ref="tax_amount" format="(-)#,###" style="text-align:right; "/>
			<col ref="total_amount" format="(-)#,###" style="text-align:right; "/>
			<col ref="sup_rep_name"/>
			<col ref="dti_status_nm" style="text-align:left; "/>
			<col ref="byr_email" style="text-align:right; "/>
			<col ref="seq_id" style="text-align:right; "/>
			<col ref="sbdescription"/>
			<col ref="dti_status" type="hidden"/>
			<col ref="direction" type="hidden"/>
			<col ref="blank_cnt" type="hidden" style="text-align:left; "/>
			<col ref="dti_type" type="hidden" style="text-align:left; "/>
			<col ref="tax_demand" format="(-)#,###" style="text-align:right; "/>
			<col ref="sup_com_id" style="text-align:left; "/>
			<col ref="byr_com_regno"/>
			<col ref="byr_com_name"/>
			<col ref="byr_rep_name"/>
			<col ref="sup_com_type"/>
			<col ref="sup_com_classify"/>
			<col ref="sup_com_addr"/>
			<col ref="sup_bizplace_code"/>
			<col ref="conversation_id" type="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					if (datagrid1.valueMatrix(datagrid1.row, 1) == "1") {
						datagrid1.rowStatus(datagrid1.row) = 1;
					}
					else {
						datagrid1.rowStatus(datagrid1.row) = 0;
					}				
				]]>
			</script>
		</datagrid>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:50px; width:926px; height:21px; ">
			<button id="btn_select" class="btn02" crud="R" style="left:795px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (!check_reqItem(srch_dti_wdate_fr,"trim","focus","발생일자FR은 필수입력항목입니다.")) { return false; }
						if (!check_reqItem(srch_dti_wdate_to,"trim","focus","발생일자TO는 필수입력항목입니다.")) { return false; }

						var slip_occr_dt_diff;
						slip_occr_dt_diff = get_datediff(srch_dti_wdate_fr.value,srch_dti_wdate_fr.value);												
						
						if(slip_occr_dt_diff > 366){
							show_message("1년이 초과하는 자료는 조회할 수 없습니다.");
							return;
						}
											
						model.send("co_smtb_1031_l");	
						
						if(get_refvalue("/root/resData/gridData/co_smtb_1031_l/dataSet/TAX_STMTLIST/totalcnt") == 0)
						{
							show_message("검색결과가 없습니다.");
							//tot_suply_amt.value = "";
							//tot_vat_amt.value = "";
							//return;
						}else{				

							for(var i=1; i<datagrid1.rows; i++){
								datagrid1.valueMatrix(i,1) = 0;	
							}
						}
						// 상태에따른 버튼 컨트롤 추가.
						//debugger;
						btn_recv_acpt.disabled = true; 			//수신승인
						btn_recv_ref.disabled = true;			//수신거부
						btn_canc_req.disabled = true;		//발행취소요청
						btn_canc_acpt.disabled = true;		//발행취소승인
						btn_canc_ref.disabled = true;		//발행취소거부
						btn_email.disabled = true;			//이메일재발송
						btn_tax_view.disabled = true;		//세금계산서보기
					      
						switch (get_refvalue("/root/reqData/searchData/dti_status")) {
						
						   case "A" : //매입저장
						      //btn_inv_req.disabled = false; 			//역발행요청
						      break;
						   case "I" : //수신미승인
						      btn_recv_acpt.disabled = false;			//수신승인
						      btn_recv_ref.disabled = false;			//수신거부
						      btn_tax_view.disabled = false;		//세금계산서보기
      						      break;
						   case "V" : //역발행요청
						      //btn_inv_req_canc.disabled = false; 			//역발행요청
						      btn_email.disabled = false;			//이메일재발송	
     						      break;						      
						   case "C" : //수신승인
						      btn_canc_req.disabled = false;		//발행취소요청
						      btn_tax_view.disabled = false;		//세금계산서보기
      						      break;						      
						   case "N" : //발행취소요청(공급자)
							btn_canc_acpt.disabled = false;		//발행취소승인
							btn_canc_ref.disabled = false;		//발행취소거부									
      						      break;	
						/*      						      					      
						   case "R" : //수신거부
						      						      break;	
						   case "M" : //발행취소요청(공급받는자)
						      						      break;							   						      						      
						   case "O" :  //취소완료
						      						      break;						   
						   case "T" :  //역발행거부
						      						      break;						   
						   case "W" : //역발행요청취소
						      						      break;						   
						*/
						   default :
							btn_recv_acpt.disabled = true; 			//수신승인
							btn_recv_ref.disabled = true;			//수신거부
							btn_canc_req.disabled = true;		//발행취소요청
							btn_canc_acpt.disabled = true;		//발행취소승인
							btn_canc_ref.disabled = true;		//발행취소거부
							btn_email.disabled = true;			//이메일재발송
							btn_tax_view.disabled = true;		//세금계산서보기
				      			break;
						}							
					]]>
				</script>
			</button>
			<button id="btn_pop1" class="btn02" visibility="hidden" crud="R" style="left:145px; top:0px; width:52px; height:21px; ">
				<caption>수입결의</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//var tax_stmt_aprv_yn = get_refvalue("/root/resData/gridData/dataSet/TAX_STMTLIST/record["+datagrid1.row+"]/tax_stmt_aprv_yn").Trim();
						var tax_stmt_no = get_refvalue("/root/resData/gridData/co_smtb_1031_l/dataSet/TAX_STMTLIST/record["+datagrid1.row+"]/seq_id");
						if(tax_stmt_no.substring(11,2) == "30"){
							//공통수입결의등록 호출
							model.property("FC_ACCT_2120_srch_tax_stmt_no")  = tax_stmt_no;
							model.property("FC_ACCT_2120_popup_flag") = "Y";
							
							// 화면호출
	//							viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2120", "modal", "align:center; caption:hidden; width:946px; height:728px;");
							viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2120");	
						}
						else{
							show_message("수입결의건이 아닌 세금계산서는 조회할 수 없습니다.");
						}
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" visibility="hidden" crud="R" style="left:90px; top:0px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:871px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose();			
					]]>
				</script>
			</button>
			<button id="button1" class="btn04" visibility="hidden" crud="R" style="left:5px; top:0px; width:82px; height:21px; ">
				<caption>세무로전송</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(semuro_id.value == ""){
							show_message("전송할 수 있는 사용자가 아닙니다.");
							return false;
						}
						if(pwd.value ==""){
							show_message("비밀번호는 필수입력항목입니다.");
							return false;
						}

						var cnt = 0;
	
						for (var i=1; i<datagrid1.rows; i++){
							if(datagrid1.rowStatus(i) == "1"){
								cnt = cnt+1;
							}
						}

						if(cnt == 0){
							show_message("전송할 자료가 없습니다.");
							return false;
						}						

						if(show_message("전송하시겠습니까?", "전송 확인", MB_YESNO) != IDYES) {
							return false;
						}
						set_refvalue("/root/reqData/multiUpDate/tmsg_type","1");		//전송구분 1:순발행, 2:역발행
						set_refvalue("/root/reqData/multiUpDate/stmt_clsf","1");		//증빙구분 1:과새, 2:영세, 3:면세 
						set_refvalue("/root/reqData/multiUpDate/pers_clsf","2");		//수신처구분 1:가입자, 2:비가입자, 3: 수기등록
						set_refvalue("/root/reqData/multiUpDate/semuro_id", semuro_id.value);		//세무로 ID
						set_refvalue("/root/reqData/multiUpDate/multiUpdateData",datagrid1.getUpdateData());
						
						model.send("fc_acct_2172_a");
						
						if(submit_completed()){
						}
						else{
							return false;
						}

						var rtnString;
						var ret;
						var slip_occr_dt, slip_clsf_cd, slip_seq;
						var rows		= datagrid2.rows;
						var tmsg_type   = "1";
						var tax_stmt_clsf = "1";
						var rmsg_pers_clsf = "2";
						
//						if(rows = datagrid2.fixedRows){
						if(rows == 0){							
							show_message("전송할 자료가 없습니다.");
							return false;
						}

						for(var i=1; i < rows; i++){
							rtnString = datagrid2.valueMatrix(i,1);
							
							
							ret = object1.misSndDocRtnMsg(tmsg_type, tax_stmt_clsf, rmsg_pers_clsf, semuro_id.value, pwd.value, semuro_id.value, rtnString, "","");

							if(ret == ""){		
								return false;
							}
							else if(ret.length != 24 ){
								break;
							}
							 slip_occr_dt = datagrid2.valueMatrix(i,2);
							 slip_clsf_cd = datagrid2.valueMatrix(i,3);
							 slip_seq = datagrid2.valueMatrix(i,4);
							 
							 set_refvalue("/root/reqData/reqForm/slip_occr_dt", slip_occr_dt);
							 set_refvalue("/root/reqData/reqForm/slip_clsf_cd", slip_clsf_cd);
							 set_refvalue("/root/reqData/reqForm/slip_seq", slip_seq);
							 set_refvalue("/root/reqData/reqForm/semuro_no", ret);
							 model.send("fc_acct_2173_u");							 
						}

						if(submit_completed()){
							show_message("전송되었습니다.");
							btn_select.dispatch("onclick");
						}
					]]>
				</script>
			</button>
		</group>
		<group id="group1" class="gro_sel" style="left:10px; top:170px; width:926px; height:21px; ">
			<button id="btn_recv_acpt" class="btn04" crud="R" style="left:5px; top:0px; width:90px; height:21px; ">
				<caption>수신승인</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[

						var cnt = 0;

						for (var i=1; i<datagrid1.rows; i++){
							if(datagrid1.rowStatus(i) == "1"){
								if(datagrid1.valueMatrix(datagrid1.row, 13) != "I"){
									show_message("상태가 수신미승인(I)인 경우에만 수신승인이 가능합니다."+datagrid1.valueMatrix(datagrid1.row, 13));
									return false;
								}									
								cnt = cnt+1;
							}
						}

						if(cnt == 0){
							show_message("선택한 자료가 없습니다.");
							return false;
						}						

						if(show_message("수신승인 하시겠습니까?", "수신승인 확인", MB_YESNO) != IDYES) {
							return false;
						}
						
						set_refvalue("/root/reqData/multiUpDate/multiUpdateData",datagrid1.getUpdateData());
						
						model.send("co_smtb_1021_u");
						
						if(submit_completed()){
							var batch_id = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/batch_id");
							var smart_id = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/smart_id");
							var smart_pw = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/smart_pw");
							var status = "C";
							var signal = "APPROVE";
							var sbdescription = "";
							var url = CIISComm_SMTB_URL + "/callSB_V3/XXSB_DTI_STATUS_CHANGE.asp"
								  + "?BATCH_ID=" + batch_id
								  + "&STATUS=" + status
								  + "&SIGNAL=" + signal
								  + "&ID=" + smart_id
								  + "&PASS=" + smart_pw
								  + "&SBDESCRIPTION=" + sbdescription;
							//alert(url);
							makeNodeValue("/root/tempData/url",url);

							window.load("/common/xrw/ie_pop.xrw"
								,"modal"
								,"ie_pop"
								,"resize:false;width:420px;height:330px;top:20px;left:100px;align:center;min:hidden;max:hidden;"
								,"/root/tempData"
								,"/root/tempData");
							/*
							window.load(url				
								,"new"				
								,"ie_pop"				
								,"sysmenu:hidden;min:hidden; resize:false;max:hidden;caption:hidden;width:400px;height:300px;top:100px;left:100px;align:center;"				
								,"/root/tempData"
								,"/root/tempData");								
							*/
							/*
							window.load(
							url, 
							"mdichild",
							"", 
							"left:30px; top:200px; width:100px; height:100; align:center; caption:hidden;"
							,""
							,""
							);
							*/							
							//show_message("전송되었습니다.");
							
							btn_select.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="btn_email" class="btn05" crud="U" style="left:705px; top:0px; width:115px; height:21px; ">
				<caption>E-MAIL재발송</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						var cnt = 0;
						var email = "";
						var conversation_id = "";
						var status = "";
						
						for (var i=1; i<datagrid1.rows; i++){
							if(datagrid1.rowStatus(i) == "1"){
								if(datagrid1.valueMatrix(datagrid1.row, 13) != "I" && datagrid1.valueMatrix(datagrid1.row, 13) != "C" && datagrid1.valueMatrix(datagrid1.row, 13) != "V" & datagrid1.valueMatrix(datagrid1.row, 13) != "N"){
									show_message("상태가 미승인(I),수신승인(C),역발행요청(V),공급자발행취소요청(N)인 경우에만 재발송이 가능합니다."+datagrid1.valueMatrix(datagrid1.row, 13));
									return false;
								}
								status = datagrid1.valueMatrix(datagrid1.row, 13);
								email = datagrid1.valueMatrix(datagrid1.row, 10);
								conversation_id = datagrid1.valueMatrix(datagrid1.row, 15);
								cnt = cnt+1;
							}
						}
						
						if(cnt < 1){
							show_message("선택된 건이 없습니다.");
							return false;						
						}else if(cnt > 1){
							show_message("E-Mail 재발송은 한건씩만 가능합니다.");
							return false;
						}

						if(show_message("E-Mail을 재발송 하시겠습니까?", "재발송 확인", MB_YESNO) != IDYES) {
							return false;
						}
						
						set_refvalue("/root/reqData/multiUpDate/multiUpdateData",datagrid1.getUpdateData());
						
						model.send("co_smtb_1021_u");
						
						if(submit_completed()){
							var batch_id = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/batch_id");
							var smart_id = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/smart_id");
							var smart_pw = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/smart_pw");

							var url = CIISComm_SMTB_URL + "/callSB_V3/XXSB_DTI_SEND_EMAIL.asp"
								  + "?CONVERSATION_ID=" + conversation_id
								  + "&EMAIL=" + email
								  + "&ID=" + smart_id
								  + "&PASS=" + smart_pw
								  + "&STATUS=" + status
//							alert(url);
							makeNodeValue("/root/tempData/url",url);

							window.load("/common/xrw/ie_pop.xrw"
								,"modal"
								,"ie_pop"
								,"resize:false;width:680px;height:580px;top:20px;left:100px;align:center;min:hidden;max:hidden;"
								,"/root/tempData"
								,"/root/tempData");
							/*
							window.load(url				
								,"new"				
								,"ie_pop"				
								,"sysmenu:hidden;min:hidden; resize:false;max:hidden;caption:hidden;width:400px;height:300px;top:100px;left:100px;align:center;"				
								,"/root/tempData"
								,"/root/tempData");								
							*/
							/*
							window.load(
							url, 
							"mdichild",
							"", 
							"left:30px; top:200px; width:100px; height:100; align:center; caption:hidden;"
							,""
							,""
							);
							*/							
							//show_message("전송되었습니다.");
							
							btn_select.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="btn_recv_ref" class="btn04" crud="U" style="left:101px; top:0px; width:90px; height:21px; ">
				<caption>수신거부</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						var cnt = 0;
	
						for (var i=1; i<datagrid1.rows; i++){
							if(datagrid1.rowStatus(i) == "1"){
								if(datagrid1.valueMatrix(datagrid1.row, 13) != "I"){
									show_message("상태가 수신미승인(I)인 경우에만 수신거부가 가능합니다."+datagrid1.valueMatrix(datagrid1.row, 13));
									return false;
								}								
								cnt = cnt+1;
							}
						}

						if(cnt == 0){
							show_message("선택한 자료가 없습니다.");
							return false;
						}						

						showPromptBox("수신거부 사유를 입력하세요!","");
						
						if (model.getValue("/root/tempData/confirm") == "Y"){
							//alert(model.getValue("/root/tempData/result"));
							var sbdescription = model.getValue("/root/tempData/result");
						}else{
							return false;							
						}		

						if(show_message("수신거부 하시겠습니까?", "수신거부 확인", MB_YESNO) != IDYES) {
							return false;
						}
						
						set_refvalue("/root/reqData/multiUpDate/multiUpdateData",datagrid1.getUpdateData());
						
						model.send("co_smtb_1021_u");
						
						if(submit_completed()){
							var batch_id = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/batch_id");
							var smart_id = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/smart_id");
							var smart_pw = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/smart_pw");
							var status = "R";
							var signal = "REJECT";
							var url = CIISComm_SMTB_URL + "/callSB_V3/XXSB_DTI_STATUS_CHANGE.asp"
								  + "?BATCH_ID=" + batch_id
								  + "&STATUS=" + status
								  + "&SIGNAL=" + signal
								  + "&ID=" + smart_id
								  + "&PASS=" + smart_pw
								  + "&SBDESCRIPTION=" + sbdescription;
							//alert(url);
							makeNodeValue("/root/tempData/url",url);

							window.load("/common/xrw/ie_pop.xrw"
								,"modal"
								,"ie_pop"
								,"resize:false;width:420px;height:330px;top:20px;left:100px;align:center;min:hidden;max:hidden;"
								,"/root/tempData"
								,"/root/tempData");
							/*
							window.load(url				
								,"new"				
								,"ie_pop"				
								,"sysmenu:hidden;min:hidden; resize:false;max:hidden;caption:hidden;width:400px;height:300px;top:100px;left:100px;align:center;"				
								,"/root/tempData"
								,"/root/tempData");								
							*/
							/*
							window.load(
							url, 
							"mdichild",
							"", 
							"left:30px; top:200px; width:100px; height:100; align:center; caption:hidden;"
							,""
							,""
							);
							*/							
							//show_message("전송되었습니다.");
							
							btn_select.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="btn_canc_req" class="btn04" crud="U" style="left:197px; top:0px; width:90px; height:21px; ">
				<caption>발행취소요청</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						var cnt = 0;
	
						for (var i=1; i<datagrid1.rows; i++){
							if(datagrid1.rowStatus(i) == "1"){
								if(datagrid1.valueMatrix(datagrid1.row, 13) != "C"){
									show_message("상태가 수신승인(C)인 경우에만 발행취소요청이 가능합니다."+datagrid1.valueMatrix(datagrid1.row, 13));
									return false;
								}									
								cnt = cnt+1;
							}
						}

						if(cnt == 0){
							show_message("선택한 자료가 없습니다.");
							return false;
						}						

						showPromptBox("발행취소요청 사유를 입력하세요!","");
						
						if (model.getValue("/root/tempData/confirm") == "Y"){
							//alert(model.getValue("/root/tempData/result"));
							var sbdescription = model.getValue("/root/tempData/result");
						}else{
							return false;							
						}		

						if(show_message("발행취소를 요청 하시겠습니까?", "발행취소요청 확인", MB_YESNO) != IDYES) {
							return false;
						}
						
						set_refvalue("/root/reqData/multiUpDate/multiUpdateData",datagrid1.getUpdateData());
						
						model.send("co_smtb_1021_u");
						
						if(submit_completed()){
							var batch_id = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/batch_id");
							var smart_id = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/smart_id");
							var smart_pw = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/smart_pw");
							var status = "M";
							var signal = "CANCELREQ";
							var url = CIISComm_SMTB_URL + "/callSB_V3/XXSB_DTI_STATUS_CHANGE.asp"
								  + "?BATCH_ID=" + batch_id
								  + "&STATUS=" + status
								  + "&SIGNAL=" + signal
								  + "&ID=" + smart_id
								  + "&PASS=" + smart_pw
								  + "&SBDESCRIPTION=" + sbdescription;
							//alert(url);
							makeNodeValue("/root/tempData/url",url);

							window.load("/common/xrw/ie_pop.xrw"
								,"modal"
								,"ie_pop"
								,"resize:false;width:420px;height:330px;top:20px;left:100px;align:center;min:hidden;max:hidden;"
								,"/root/tempData"
								,"/root/tempData");
							/*
							window.load(url				
								,"new"				
								,"ie_pop"				
								,"sysmenu:hidden;min:hidden; resize:false;max:hidden;caption:hidden;width:400px;height:300px;top:100px;left:100px;align:center;"				
								,"/root/tempData"
								,"/root/tempData");								
							*/
							/*
							window.load(
							url, 
							"mdichild",
							"", 
							"left:30px; top:200px; width:100px; height:100; align:center; caption:hidden;"
							,""
							,""
							);
							*/							
							//show_message("전송되었습니다.");
							
							btn_select.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="btn_canc_acpt" class="btn04" crud="U" style="left:292px; top:0px; width:90px; height:21px; ">
				<caption>발행취소승인</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						var cnt = 0;
	
						for (var i=1; i<datagrid1.rows; i++){
							if(datagrid1.rowStatus(i) == "1"){
								if(datagrid1.valueMatrix(datagrid1.row, 13) != "N"){
									show_message("상태가 발행취소요청(N)인 경우에만 발행취소승인이 가능합니다."+datagrid1.valueMatrix(datagrid1.row, 13));
									return false;
								}									
								cnt = cnt+1;
							}
						}

						if(cnt == 0){
							show_message("선택한 자료가 없습니다.");
							return false;
						}						

						if(show_message("발행취소요청를 승인 하시겠습니까?", "발행취소승인 확인", MB_YESNO) != IDYES) {
							return false;
						}
						
						set_refvalue("/root/reqData/multiUpDate/multiUpdateData",datagrid1.getUpdateData());
						
						model.send("co_smtb_1021_u");
						
						if(submit_completed()){
							var batch_id = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/batch_id");
							var smart_id = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/smart_id");
							var smart_pw = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/smart_pw");
							var status = "O";
							var signal = "SRADAPPRP";
							var sbdescription = "";
							var url = CIISComm_SMTB_URL + "/callSB_V3/XXSB_DTI_STATUS_CHANGE.asp"
								  + "?BATCH_ID=" + batch_id
								  + "&STATUS=" + status
								  + "&SIGNAL=" + signal
								  + "&ID=" + smart_id
								  + "&PASS=" + smart_pw
								  + "&SBDESCRIPTION=" + sbdescription;
							//alert(url);
							makeNodeValue("/root/tempData/url",url);

							window.load("/common/xrw/ie_pop.xrw"
								,"modal"
								,"ie_pop"
								,"resize:false;width:420px;height:330px;top:20px;left:100px;align:center;min:hidden;max:hidden;"
								,"/root/tempData"
								,"/root/tempData");
							/*
							window.load(url				
								,"new"				
								,"ie_pop"				
								,"sysmenu:hidden;min:hidden; resize:false;max:hidden;caption:hidden;width:400px;height:300px;top:100px;left:100px;align:center;"				
								,"/root/tempData"
								,"/root/tempData");								
							*/
							/*
							window.load(
							url, 
							"mdichild",
							"", 
							"left:30px; top:200px; width:100px; height:100; align:center; caption:hidden;"
							,""
							,""
							);
							*/							
							//show_message("전송되었습니다.");
							
							btn_select.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="btn_canc_ref" class="btn04" crud="U" style="left:387px; top:0px; width:90px; height:21px; ">
				<caption>발행취소거부</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						var cnt = 0;
	
						for (var i=1; i<datagrid1.rows; i++){
							if(datagrid1.rowStatus(i) == "1"){
								if(datagrid1.valueMatrix(datagrid1.row, 13) != "N"){
									show_message("상태가 발행취소요청(N)인 경우에만 발행취소거부가 가능합니다."+datagrid1.valueMatrix(datagrid1.row, 13));
									return false;
								}										
								cnt = cnt+1;
							}
						}

						if(cnt == 0){
							show_message("선택한 자료가 없습니다.");
							return false;
						}						

						showPromptBox("발행취소요청 거부에 대한 사유를 입력하세요!","");
						
						if (model.getValue("/root/tempData/confirm") == "Y"){
							//alert(model.getValue("/root/tempData/result"));
							var sbdescription = model.getValue("/root/tempData/result");
						}else{
							return false;							
						}		

						if(show_message("발행취소요청을 거부 하시겠습니까?", "발행취소거부 확인", MB_YESNO) != IDYES) {
							return false;
						}
						
						set_refvalue("/root/reqData/multiUpDate/multiUpdateData",datagrid1.getUpdateData());
						
						model.send("co_smtb_1021_u");
						
						if(submit_completed()){
							var batch_id = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/batch_id");
							var smart_id = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/smart_id");
							var smart_pw = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/smart_pw");
							var status = "C";
							var signal = "REQREJECTP";
							var url = CIISComm_SMTB_URL + "/callSB_V3/XXSB_DTI_STATUS_CHANGE.asp"
								  + "?BATCH_ID=" + batch_id
								  + "&STATUS=" + status
								  + "&SIGNAL=" + signal
								  + "&ID=" + smart_id
								  + "&PASS=" + smart_pw
								  + "&SBDESCRIPTION=" + sbdescription;
							//alert(url);
							makeNodeValue("/root/tempData/url",url);

							window.load("/common/xrw/ie_pop.xrw"
								,"modal"
								,"ie_pop"
								,"resize:false;width:420px;height:330px;top:20px;left:100px;align:center;min:hidden;max:hidden;"
								,"/root/tempData"
								,"/root/tempData");
							/*
							window.load(url				
								,"new"				
								,"ie_pop"				
								,"sysmenu:hidden;min:hidden; resize:false;max:hidden;caption:hidden;width:400px;height:300px;top:100px;left:100px;align:center;"				
								,"/root/tempData"
								,"/root/tempData");								
							*/
							/*
							window.load(
							url, 
							"mdichild",
							"", 
							"left:30px; top:200px; width:100px; height:100; align:center; caption:hidden;"
							,""
							,""
							);
							*/							
							//show_message("전송되었습니다.");
							
							btn_select.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="btn_tax_view" class="btn04" crud="U" style="left:826px; top:0px; width:90px; height:21px; ">
				<caption>세금계산서보기</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						var cnt = 0;
	
						for (var i=1; i<datagrid1.rows; i++){
							if(datagrid1.rowStatus(i) == "1"){
								if(datagrid1.valueMatrix(datagrid1.row, 13) != "I" && datagrid1.valueMatrix(datagrid1.row, 13) != "C"){
									show_message("상태가 수신미승인(I),수신승인(C)인 경우에만 세금계산서보기가 가능합니다."+datagrid1.valueMatrix(datagrid1.row, 13));
									return false;
								}										
								cnt = cnt+1;
							}
						}

						if(cnt == 0){
							show_message("선택한 자료가 없습니다.");
							return false;
						}						

						if(show_message("세금계산서보기을 실행 하시겠습니까?", "취소 확인", MB_YESNO) != IDYES) {
							return false;
						}
						
						set_refvalue("/root/reqData/multiUpDate/multiUpdateData",datagrid1.getUpdateData());
						
						model.send("co_smtb_1021_u");
						
						if(submit_completed()){
							var batch_id = model1.getValue("/root/resData/resForm/co_smtb_1021_u/dataSet/batch_id");

							var url = CIISComm_SMTB_URL + "/callSB_V3/XXSB_DTI_PRINT.asp"
								  + "?BATCH_ID=" + batch_id;
							//alert(url);
							makeNodeValue("/root/tempData/url",url);

							window.load("/common/xrw/ie_pop.xrw"
								,"modal"
								,"ie_pop"
								,"resize:false;width:720px;height:700px;top:20px;left:100px;align:center;min:hidden;max:hidden;"
								,"/root/tempData"
								,"/root/tempData");
							/*
							window.load(url				
								,"new"				
								,"ie_pop"				
								,"sysmenu:hidden;min:hidden; resize:false;max:hidden;caption:hidden;width:400px;height:300px;top:100px;left:100px;align:center;"				
								,"/root/tempData"
								,"/root/tempData");								
							*/
							/*
							window.load(
							url, 
							"mdichild",
							"", 
							"left:30px; top:200px; width:100px; height:100; align:center; caption:hidden;"
							,""
							,""
							);
							*/							
							//show_message("전송되었습니다.");
							
							btn_select.dispatch("onclick");
						}
					]]>
				</script>
			</button>
		</group>
		<group id="group2" class="gro_line" style="left:10px; top:195px; width:926px; height:5px; "/>
	</xhtml:body>
</xhtml:html>
