<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>회원약정납입</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<codeData/>
							<tn_dns_1000_m>
								<dataSet>
									<ACCOUNT_LIST>
										<record>
											<cd/>
											<cdnm/>
											<bankaccountcode/>
											<bankcode/>
											<bankaccountowner/>
										</record>
									</ACCOUNT_LIST>
									<BANK_LIST>
										<record>
											<cd/>
											<cdnm/>
										</record>
									</BANK_LIST>
								</dataSet>
							</tn_dns_1000_m>
						</comboSet>
					</initData>
					<reqData>
						<fwdData/>
						<searchData>
							<tn_dns_1010_l>
								<name/>
								<memberidx/>
							</tn_dns_1010_l>
							<tn_dns_1020_l>
								<membercode/>
								<memberidx/>
							</tn_dns_1020_l>
							<proofidx/>
						</searchData>
						<reqform>
							<paydate/>
							<payprice/>
							<receiptissue>1</receiptissue>
							<promisedate/>
							<promiseprice/>
							<paystopped/>
							<contributormemo/>
							<promisememo/>
							<fundidx/>
							<supportidx/>
							<useoriginal/>
							<purposememo/>
							<paymethod>M</paymethod>
							<paymethodcode/>
							<bankownerclsf>1</bankownerclsf>
							<bankowneridentity/>
							<bankcode/>
							<bankaccount/>
							<bankaccountowner/>
							<filename/>
							<partitiontype/>
							<bankaccount/>
							<monthlypayday/>
							<monthlypayprice/>
							<partitioncount/>
							<paystartdate/>
							<payenddate/>
							<excludenopay/>
							<cmsstatus/>
							<promisecode/>
							<memberidx/>
							<mode/>
							<promiseidx/>
							<proofname/>
							<prooftype>1</prooftype>
							<proofdata/>
							<paymentidx/>
							<stopdate/>
							<stopresn/>
							<itemname/>
							<itemqty/>
							<itemprice/>
							<itemremk/>
							<mobiaprvname/>
							<mobiaprvcmpy/>
							<mobiaprvnumber/>
							<mobiaprvprn/>
							<multiUpdateData/>
							<regno/>
							<issuedatecategory>1</issuedatecategory>
							<issuedate/>
							<biz_reg_no/>
							<bank_id/>
							<acct_num/>
							<g1_rcpm_dt/>
							<tran_date_seq/>
							<current_clsf/>
							<g1_rcpm_pers_nm/>
							<cardcmpy/>
							<cardnumber/>
							<cardyymm/>
							<cardidentity/>
							<cardowner/>
							<paymentmemo/>
							<bank_id/>
							<acct_num/>
							<tran_date/>
							<tran_date_seq/>
						</reqform>
						<tn_dns_1030_a>
							<mode/>
							<membertype/>
							<membercode/>
							<memberidx/>
							<mbr_name/>
							<isanonymous/>
							<mbr_regno/>
							<isforeigner/>
							<unknownregno/>
							<president/>
							<businessno/>
							<birthdayorigin/>
							<birthday/>
							<birthdaytype/>
							<membercategorycode/>
							<partycode/>
							<writedate/>
							<memo/>
							<adrs_name/>
							<dept/>
							<title/>
							<email/>
							<phone1/>
							<cellphone/>
							<fax/>
							<zipcode1/>
							<address1/>
							<addressdetail1/>
							<zipcode2/>
							<address2/>
							<addressdetail2/>
							<postaddress/>
							<useaddress/>
							<password/>
							<deptidx/>
							<donatorcategory/>
							<receiptcategory/>
							<rcp_name/>
							<rcp_regno/>
							<relation/>
							<zipcode/>
							<address/>
							<addressdetail/>
							<receiptconfigmemo/>
						</tn_dns_1030_a>
						<phot>
							<proofdata/>
							<promiseidx/>
							<accflag/>
							<proofname/>
							<prooftype/>
							<cmsidx/>
							<proofpath/>
							<extension/>
						</phot>
						<mdiparent>
							<memberidx/>
							<name/>
							<membercode/>
						</mdiparent>
						<mdichild2>
							<memberidx/>
							<name/>
							<membercode/>
						</mdichild2>
						<mdichild>
							<umsidx/>
						</mdichild>
						<aplcForm>
							<cmpy_cd/>
							<aplcclsf/>
							<promiseidx/>
						</aplcForm>
					</reqData>
					<resData>
						<resform>
						</resform>
						<gridData>
							<tn_dns_1010_l>
								<dataSet>
									<CURLIST>
										<record>
											<membercode/>
											<memberidx/>
										</record>
									</CURLIST>
								</dataSet>
							</tn_dns_1010_l>
							<tn_dns_1020_l>
								<dataSet>
									<CURLIST1>
										<record>
											<membertype/>
											<membercode/>
											<memberidx/>
											<mbr_name/>
											<isanonymous/>
											<mbr_regno/>
											<isforeigner/>
											<unknownregno/>
											<president/>
											<businessno/>
											<birthdayorigin/>
											<birthday/>
											<birthdaytype/>
											<membercategorycode/>
											<partycode/>
											<writedate/>
											<memo/>
											<adrs_name/>
											<dept/>
											<title/>
											<email/>
											<phone1/>
											<cellphone/>
											<fax/>
											<zipcode1/>
											<address1/>
											<addressdetail1/>
											<zipcode2/>
											<address2/>
											<addressdetail2/>
											<postaddress/>
											<useaddress/>
											<password/>
											<deptidx/>
											<donatorcategory/>
											<receiptcategory/>
											<rcp_name/>
											<rcp_regno/>
											<relation/>
											<zipcode/>
											<address/>
											<addressdetail/>
											<receiptconfigmemo/>
										</record>
									</CURLIST1>
									<CURLIST2>
										<record>
											<promisecode/>
											<promisedate/>
											<promise_status/>
											<fundidx_nm/>
											<useoriginal_nm/>
											<paymethodcode_nm/>
											<promiseprice/>
											<payprice/>
											<payrate/>
											<promiseidx/>
											<memberidx/>
											<paystopped/>
											<contributormemo/>
											<promisememo/>
											<fundidx/>
											<supportidx_nm/>
											<supportidx/>
											<useoriginal/>
											<purposememo/>
											<paymethod/>
											<paymethodcode/>
											<bankaccountcode/>
											<partitiontype/>
											<paystartdate/>
											<payenddate/>
											<partitioncount/>
											<monthlypayday/>
											<monthlypayprice/>
											<excludenopay/>
											<ispromiseanonymous/>
											<itemname/>
											<itemqty/>
											<itemprice/>
											<itemremk/>
											<bankcode/>
											<bankaccount/>
											<bankaccountowner/>
											<bankownerclsf/>
											<bankowneridentity/>
											<cmsstatus/>
											<proofname/>
											<prooftype/>
											<stopdate/>
											<stopresn/>
											<cardcmpy/>
											<cardnumber/>
											<cardyymm/>
											<mobiaprvname/>
											<mobiaprvcmpy/>
											<mobiaprvnumber/>
											<mobiaprvprn/>
											<cmsstopped/>
											<cmsstopdate/>
											<cmsupdatedate/>
											<cardidentity/>
											<cardowner/>
											<cms_payment_status/>
											<cms_status/>
											<proofidx/>
										</record>
									</CURLIST2>
									<CURLIST3>
										<record>
											<paymentcode/>
											<paydate/>
											<promisecode/>
											<fundidx/>
											<supportidx/>
											<paymethodcode/>
											<promiseprice/>
											<payprice/>
											<sumpayprice/>
											<receiptissue/>
											<paymentidx/>
											<receiptcount/>
											<memo/>
											<bank_id/>
											<acct_num/>
											<tran_date/>
											<tran_date_seq/>
											<slip_no/>
										</record>
									</CURLIST3>
									<CURLIST4>
										<record>
											<memberidx/>
											<fundidx/>
											<supportidx/>
											<scheduleprice/>
											<payprice/>
											<bankcode/>
											<bankaccount/>
											<bankaccountowner/>
											<his_type/>
											<status/>
											<errorcode/>
											<isdelete/>
											<paydate/>
											<writedate/>
										</record>
									</CURLIST4>
									<CURLIST5>
										<record>
											<receiptidx/>
											<memberidx/>
											<deptidx/>
											<receiptcode/>
											<name/>
											<issuecategory/>
											<issuedate/>
											<donatorcategory/>
											<receiptcategory/>
											<price/>
											<membername/>
											<paymentissue/>
											<issuecount/>
											<isdeleted/>
										</record>
									</CURLIST5>
									<CURLIST6>
										<record>
											<receiverinfo/>
											<status/>
											<sendtype/>
											<senddate/>
											<failreason/>
											<umsidx/>
										</record>
									</CURLIST6>
									<CURLIST7>
										<record>
											<memberidx/>
											<fundidx/>
											<supportidx/>
											<scheduleprice/>
											<payprice/>
											<acptprice/>
											<status/>
											<errorcode/>
											<isdelete/>
											<paydate/>
											<cardcmpy/>
											<cardno/>
											<cardyymm/>
											<ownername/>
										</record>
									</CURLIST7>
									<CURLIST8>
										<record>
											<memberidx/>
											<fundidx/>
											<supportidx/>
											<scheduleprice/>
											<payprice/>
											<status/>
											<errorcode/>
											<isdelete/>
											<paydate/>
											<mobicmpy/>
											<mobino/>
											<ownername/>
										</record>
									</CURLIST8>
								</dataSet>
							</tn_dns_1020_l>
						</gridData>
						<MsgData/>
						<resPhoto>
							<proofdata/>
							<prooftype/>
						</resPhoto>
					</resData>
					<tempData>
						<keyData/>
						<resTemp/>
						<chk_regno/>
						<membercode/>
						<name/>
						<tmp_mbr_regno/>
						<total>
							<total_promise/>
							<total_payment/>
						</total>
						<list_promisecode/>
					</tempData>
					<nodetmp/>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					var p_pageid = model1.getValue("/root/initData/pageInfo/pageID");
					if( p_pageid =="")
					{
						//회원조회에서 선택한 회원정보
						model1.copyNode("/root/reqData/mdiparent", parent.root.reqData.mdichild);
						model1.setValue("/root/reqData/searchData/tn_dns_1020_l/memberidx", model1.getValue("/root/reqData/mdiparent/memberidx"));
						model1.setValue("/root/reqData/searchData/tn_dns_1020_l/membercode", model1.getValue("/root/reqData/mdiparent/membercode"));
						model1.setValue("/root/reqData/searchData/tn_dns_1010_l/name", model1.getValue("/root/reqData/mdiparent/name"));						
						model1.refresh();
						send_tn_dns_1020_l();
					}
					if(model.property("TN_DNS_1000_popup_flag") =="Y"){
						model1.setValue("/root/reqData/searchData/tn_dns_1020_l/memberidx", model.property("TN_DNS_1000_memberidx"));
						name.value =	model.property("TN_DNS_1000_name") ;
						model1.refresh();
						send_tn_dns_1020_l();
						model.property("TN_DNS_1000_popup_flag") = "";
						model.property("TN_DNS_1000_memberidx") ="";
						model.property("TN_DNS_1000_name")  ="";
					}
					PID1700input16.value = commCurDate();
					model.toggle("case_reset");
					//실행
					send_tn_dns_1000_m();
					model.refresh();
				]]>
			</script>
			<submission id="tn_dns_1000_m" action="/tn/dns/1000" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/initData/comboSet/tn_dns_1000_m/dataSet"/>
			<submission id="tn_dns_1010_l" action="/tn/dns/1010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/tn_dns_1010_l" resultref="/root/resData/gridData/tn_dns_1010_l/dataSet"/>
			<submission id="tn_dns_1020_l" action="/tn/dns/1020" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/tn_dns_1020_l" resultref="/root/resData/gridData/tn_dns_1020_l/dataSet"/>
			<submission id="tn_dns_1030_a" action="/tn/dns/1030" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/tn_dns_1030_a" resultref="/root/resData/MsgData"/>
			<submission id="tn_dns_1040_a" action="/tn/dns/1040" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqform" resultref="/root/resData/MsgData"/>
			<submission id="tn_dns_1050_a" action="/tn/dns/1050" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqform" resultref="/root/resData/MsgData"/>
			<submission id="tn_dns_1060_l" action="/tn/dns/1060" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqform" resultref="/root/resData/resPhoto"/>
			<submission id="tn_dns_1070_a" action="/tn/dns/1070" mediatype="multipart/form-data" method="form-data-post" ref="/root/reqData/phot" resultref="/root/tempData"/>
			<submission id="tn_dns_1080_l" action="/tn/dns/1080" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqform" resultref="/root/tempData"/>
			<submission id="tn_dns_3040_a" action="/tn/dns/3040" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqform" resultref="/root/resData/MsgData"/>
			<submission id="tn_lnk_6090_a" action="/tn/lnk/6090" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/aplcForm" resultref="/root/resData/resform"/>
			<bind id="tot_promise" ref="/root/tempData/total/total_promise" calculate="sum(/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST2/record/promiseprice)"/>
			<bind id="tot_payment" ref="/root/tempData/total/total_payment" calculate="sum(/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST2/record/payprice)"/>
		</model>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/CRMComm.js"/>
		<script type="javascript" src="/js/CRMTeamCommSE.js"/>
		<script type="javascript" src="/js/fcmc_common.js"/>
		<script type="javascript">
			<![CDATA[
			var visible_grp_upload = false;
			function ctrl_btn_payment(tmp){
				if (tmp == "I"){
					btn_i_payment.visible = true;
					btn_u_payment.visible = false;
				}else if(tmp == "U"){
					btn_i_payment.visible = false;
					btn_u_payment.visible = true;
				}
			}
			
			function promise_cms_status(){
				var rcvs_flag = false;
				var cms_status = datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("cms_status"));
				//alert(cms_status);
				if(cms_status =="1"){
					alert("송신완료처리 상태이므로 결과반영 후 사용 가능합니다."); return rcvs_flag;
				}else if(cms_status =="0"){
					alert("현재 준비상태인 cms파일 생성 취소 후 신규/해지/변경이 가능합니다."); return rcvs_flag;
				}
			}
			function set_partitontype(){
				if(PID1700combo14.value == "1"){
						promiseprice.disabled = false;
						monthlypayday.disabled = false;
						monthlypayprice.disabled = true;
						partitioncount.disabled = true;
						paystartdate.disabled = true;
						payenddate.value = paystartdate.value;
					}else{
						promiseprice.disabled = true;
						monthlypayday.disabled = false;
						monthlypayprice.disabled = false;
						partitioncount.disabled = false;
						paystartdate.disabled = false;
						//payenddate.value = "";
					}					
			}
			
			function select_mbr(select_name){
					mbr_regno.disabled = false;
					group5.visible = false;
					grp_upload.visible = false;
					if(select_name == ""){
						alert("검색어를 입력해주세요.");
						model.setFocus("name");
						return;
					}					
					model.send("tn_dns_1010_l");
					var cnt = model.getValue("/root/resData/gridData/tn_dns_1010_l/dataSet/CURLIST/totalcnt");
					if( cnt == "1"){	
						model.setValue("/root/reqData/searchData/tn_dns_1020_l/membercode",model.getValue("/root/resData/gridData/tn_dns_1010_l/dataSet/CURLIST/record/membercode"));		
						model.setValue("/root/reqData/searchData/tn_dns_1020_l/memberidx",model.getValue("/root/resData/gridData/tn_dns_1010_l/dataSet/CURLIST/record/memberidx"));	
						send_tn_dns_1020_l();
					}else if ( cnt == 0) {
						alert("검색 결과가 존재하지 않습니다.");
					}else{
						//alert(isFinite(select_name.replace("-","")));
						if(isFinite(select_name.replace("-","")) == true ){ //휴대폰
							model.property("TN_DNS_2000_cellphone")  = select_name;
						}else if(select_name.replace("-","").substring(0,1) == "M"){ //멤버코드
							model.property("TN_DNS_2000_membercode")  =select_name;
						}else { //이름
							model.property("TN_DNS_2000_name")  =select_name;
						}							
						model.property("TN_DNS_2000_popup_flag")  = "Y";
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("TN_DNS_2000");
						//formClose();
					}
					model.refresh();
			}
			
			function send_tn_dns_1000_m()
			{
				model.send("tn_dns_1000_m", false);
			}
			function set_PayCase()
			{
				var pay_method = paymethod.value;
				var pay_method_code1 = PID1700combo11.value;
				var pay_method_code2 = PID1700combo12.value;
				
				if(pay_method_code2.substring(0, 1) == "G" && pay_method == "G"){
					model.toggle("case2");
				}else if( pay_method_code1=="M002" && pay_method == "M"){  //cms 자동이체
					model.toggle("case1");					
				}else if( pay_method_code1=="M003" && pay_method == "M"){  //신용카드
					model.toggle("case3");
				}else if( pay_method_code1=="M004" && pay_method == "M"){  //휴대폰
					model.toggle("case5");
				}else if( pay_method_code1=="M001" && pay_method == "M"){
					model.toggle("case4");	
				}else{
					model.toggle("case_reset");	
				}

			}
			function se_openZip(bogb, zip1Ref, zip2Ref, addrRef){
					
				var tempReq = "/root/tempData/posttemp";
				if(instance1.selectSingleNode(tempReq) == null){
					model.makeNode(tempReq);
				}
				tempReq = "/root/tempData/posttemp/send";
				if(instance1.selectSingleNode(tempReq) == null){
					model.makeNode(tempReq);
				}
				tempReq = "/root/tempData/posttemp/send/zip";
				if(instance1.selectSingleNode(tempReq) == null){
					model.makeNode(tempReq);
				}
				tempReq = "/root/tempData/posttemp/send/disp_flag";
				if(instance1.selectSingleNode(tempReq) == null){
					model.makeNode(tempReq);
				}
				tempReq = "/root/tempData/posttemp/recv";
				if(instance1.selectSingleNode(tempReq) == null){
					model.makeNode(tempReq);
				}
				
				//"L"이면 지국항목 안보임
				model.setValue("/root/tempData/posttemp/send/disp_flag", bogb);
				model.setValue("/root/tempData/posttemp/send/zip", model.getValue(zip1Ref)+model.getValue(zip2Ref));
				
				openZip("/root/tempData/posttemp/send", "/root/tempData/posttemp/recv","new");
				if (model.getValue("/root/tempData/posttemp/recv/zip1") != ""){
				model.setValue(zip1Ref, model.getValue("/root/tempData/posttemp/recv/zip1"));				
				model.setValue(addrRef, model.getValue("/root/tempData/posttemp/recv/addr"));
				}
				model.refresh();
			}
			function send_tn_dns_1020_l(){
				grp_upload.visible = false;
				model.setValue("/root/resData/resPhoto/proofdata","");
				model.send("tn_dns_1020_l");
				makeComboGubun("", "/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST9", "record", "promisecode", "promisecode");		
				reset_promise();
				reset_payment();
				model.toggle("case_reset");	
				btn_tab_01.dispatch("onclick");
				for (var i=1; i<datagrid1.rows; i++){
					if (datagrid1.valueMatrix(i,datagrid1.colRef("promise_status")) == "해지"){							
						datagrid1.cellStyle("color", i, datagrid1.colRef("promise_status"), i, datagrid1.colRef("promise_status")) = "#ff0000";
					}
				}
				for (var i=1; i<PID1700datagrid4.rows; i++){
					if (PID1700datagrid4.valueMatrix(i,PID1700datagrid4.colRef("isdeleted")) == "1"){						
						PID1700datagrid4.cellStyle("text-decoration", i, PID1700datagrid4.colRef("receiptcode"), i, PID1700datagrid4.colRef("receiptcode")) = "line-through";
					}
				}
				
			}

			function send_tn_dns_1030_a()
			{
				model.setValue("/root/reqData/tn_dns_1030_a/membertype",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/membertype"));
				model.setValue("/root/reqData/tn_dns_1030_a/membercode",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/membercode"));
				model.setValue("/root/reqData/tn_dns_1030_a/memberidx",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/memberidx"));
				model.setValue("/root/reqData/tn_dns_1030_a/mbr_name",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/mbr_name"));
				model.setValue("/root/reqData/tn_dns_1030_a/isanonymous",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/isanonymous"));
				model.setValue("/root/reqData/tn_dns_1030_a/mbr_regno",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/mbr_regno"));
				model.setValue("/root/reqData/tn_dns_1030_a/isforeigner",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/isforeigner"));
				model.setValue("/root/reqData/tn_dns_1030_a/unknownregno",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/unknownregno"));
				model.setValue("/root/reqData/tn_dns_1030_a/president",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/president"));
				model.setValue("/root/reqData/tn_dns_1030_a/businessno",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/businessno"));
				model.setValue("/root/reqData/tn_dns_1030_a/birthdayorigin",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/birthdayorigin"));
				model.setValue("/root/reqData/tn_dns_1030_a/birthday",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/birthday"));
				model.setValue("/root/reqData/tn_dns_1030_a/birthdaytype",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/birthdaytype"));
				model.setValue("/root/reqData/tn_dns_1030_a/membercategorycode",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/membercategorycode"));
				model.setValue("/root/reqData/tn_dns_1030_a/partycode",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/partycode"));
				model.setValue("/root/reqData/tn_dns_1030_a/writedate",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/writedate"));
				model.setValue("/root/reqData/tn_dns_1030_a/memo",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/memo"));
				model.setValue("/root/reqData/tn_dns_1030_a/adrs_name",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/adrs_name"));
				model.setValue("/root/reqData/tn_dns_1030_a/dept",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/dept"));
				model.setValue("/root/reqData/tn_dns_1030_a/title",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/title"));
				model.setValue("/root/reqData/tn_dns_1030_a/email",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/email"));
				model.setValue("/root/reqData/tn_dns_1030_a/phone1",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/phone1"));
				model.setValue("/root/reqData/tn_dns_1030_a/cellphone",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/cellphone"));
				model.setValue("/root/reqData/tn_dns_1030_a/fax",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/fax"));
				model.setValue("/root/reqData/tn_dns_1030_a/zipcode1",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/zipcode1"));
				model.setValue("/root/reqData/tn_dns_1030_a/address1",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/address1"));
				model.setValue("/root/reqData/tn_dns_1030_a/addressdetail1",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/addressdetail1"));
				model.setValue("/root/reqData/tn_dns_1030_a/zipcode2",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/zipcode2"));
				model.setValue("/root/reqData/tn_dns_1030_a/address2",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/address2"));
				model.setValue("/root/reqData/tn_dns_1030_a/addressdetail2",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/addressdetail2"));
				model.setValue("/root/reqData/tn_dns_1030_a/postaddress",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/postaddress"));
				model.setValue("/root/reqData/tn_dns_1030_a/useaddress",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/useaddress"));
				model.setValue("/root/reqData/tn_dns_1030_a/password",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/password"));
				model.setValue("/root/reqData/tn_dns_1030_a/deptidx",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/deptidx"));
				model.setValue("/root/reqData/tn_dns_1030_a/donatorcategory",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/donatorcategory"));
				model.setValue("/root/reqData/tn_dns_1030_a/receiptcategory",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/receiptcategory"));
				model.setValue("/root/reqData/tn_dns_1030_a/rcp_name",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/rcp_name"));
				model.setValue("/root/reqData/tn_dns_1030_a/rcp_regno",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/rcp_regno"));
				model.setValue("/root/reqData/tn_dns_1030_a/relation",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/relation"));
				model.setValue("/root/reqData/tn_dns_1030_a/zipcode",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/zipcode"));
				model.setValue("/root/reqData/tn_dns_1030_a/address",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/address"));
				model.setValue("/root/reqData/tn_dns_1030_a/addressdetail",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/addressdetail"));
				model.setValue("/root/reqData/tn_dns_1030_a/receiptconfigmemo",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/receiptconfigmemo"));
				var md = model.getValue("/root/reqData/tn_dns_1030_a/mode");
				var name = model.getValue("/root/reqData/tn_dns_1030_a/mbr_name");
				var word;
				
				if (md == "I"){
					word = "입력";					
					
					if (!check_reqItem(mbr_name,"trim","focus","회원명은 필수입력항목입니다.")) { return false; }   
					if (!check_reqItem(mbr_regno,"trim","focus","주민번호는 필수입력항목입니다.")) { return false; }   
					if (!check_reqItem(membercategorycode,"trim","focus","회원분류는 필수입력항목입니다.")) { return false; }  
					if (!check_reqItem(membertype,"trim","focus","회원구분은 필수입력항목입니다.")) { return false; }  
					
				}else if(md == "U"){
					word = name+" 회원의 정보를 수정";
				}else if(md == "D"){
					word = name+" 회원의 정보를 삭제";
				}
				
				if(show_message(word+"하시겠습니까?", "확인", MB_YESNO) != IDYES) {
					return false;
				}
					
				model.send("tn_dns_1030_a");
				if(submit_completed()){
					show_message(word+"되었습니다.","");
					if(md == "D"){
						model.reset();
					}else{
						send_tn_dns_1020_l();
					}
				}
			}
			function send_tn_dns_1040_a()
			{
				model.setValue("/root/reqData/reqform/memberidx",memberidx.value);	
				
				 if (PID1700combo6.value == ""){
					alert("기금을 선택해주세요.");
					model.setFocus("PID1700combo6");
					return;
				}
				
				if (PID1700combo7.value == ""){
					alert("지원 단위를 선택해주세요.");
					model.setFocus("PID1700combo7");
					return;
				}
				
				if (PID1700combo8.value == ""){
					alert("원금사용여부를 선택해주세요.");
					model.setFocus("PID1700combo8");
					return;
				}
				
				if(promisedate.value == ""){
					alert("약정 일자를 선택해주세요.");				
					model.setFocus("promisedate");
					return;
				}
				
				if (promiseprice.value == ""){
					alert("약정 금액을 입력해주세요.");
					model.setFocus("promiseprice");
					return;
				}
	
				if (paymethod.value == ""){
					alert("자산형태를 선택해주세요.");
					model.setFocus("paymethod");
					return;
				}
            
				if (model.getValue("/root/reqData/reqform/paymethodcode") == ""){
					alert("납입방법을 선택해주세요.");
					model.setFocus("paymethodcode");
					return;
				}
				var partitiontype = model.getValue("/root/reqData/reqform/partitiontype");
				if (partitiontype == ""){
					alert("분납방식을 선택해주세요.");
					model.setFocus("partitiontype");
					return;
				}
				      
				if (monthlypayday.value == "" && partitiontype == "2"){
					alert("월 납입일을 입력해주세요.");
					model.setFocus("monthlypayday");
					return;
				}
				
				if (monthlypayprice.value == "" && partitiontype == "2"){
					alert("월 납입금액을 입력해주세요.");
					model.setFocus("monthlypayprice");
					return;
				}
				
				if (partitioncount.value == "" && partitiontype == "2"){
					alert("분납횟수를 입력해주세요.");
					model.setFocus("partitioncount");
					return;
				}
				
				if (paystartdate.value == "" && partitiontype == "2" ){
					alert("납입예정 시작일을 입력해주세요.");
					model.setFocus("paystartdate");
					return;
				}
				
				if (payenddate.value == "" && partitiontype == "2"){
					alert("납입예정 종료일을 입력해주세요.");
					model.setFocus("payenddate");
					return;
				}
        
				if (paystartdate.value > payenddate.value && partitiontype == "2" ){
					alert("납입예정 시작일이 납입예정 종료일보다 이후일 수 없습니다.");
					model.setFocus("paystartdate");
					return;
				}

				var md = model.getValue("/root/reqData/reqform/mode");
				var word;
				var word2;
				var code = datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("paymethodcode"));

				if (md == "I"){
					word = "입력";
				}else if(md == "U"){					
					word = "수정";					
					word2 = "CMS 계좌 수정시, 증빙자료는 삭제됩니다. ";
					if(model.getValue("/root/reqData/reqform/paymethodcode") == "M002"){
						if(model.getValue("/root/reqData/reqform/paymethodcode") == code ){
							word = word2 +word;
						}
					}
				}else if(md == "D"){
					word = "삭제";
				}

				if(show_message(word+"하시겠습니까?", "확인", MB_YESNO) != IDYES) {
					return false;
				}
				
				var mobi_promiseidx ="";
				var pay_type = model.getValue("/root/reqData/reqform/paymethodcode");
				mobi_promiseidx = model.getValue("/root/reqData/reqform/promiseidx");
				if(pay_type =="M004" && md == "D"){  //삭제시에 6090 먼저 실행
					mobi_promiseidx = model.getValue("/root/reqData/reqform/promiseidx");
					set_refvalue("/root/reqData/aplcForm/cmpy_cd", 	  getProperty("ss_cmpycd"));
					set_refvalue("/root/reqData/aplcForm/aplcclsf",   md);
					set_refvalue("/root/reqData/aplcForm/promiseidx", mobi_promiseidx);
					model.send("tn_lnk_6090_a");
					return;
				}
					
				model.send("tn_dns_1040_a");
				
				if(submit_completed()){
					show_message(word+"되었습니다.","");
					send_tn_dns_1020_l();
					if(pay_type =="M004" && md != "D"){
						if(md == "I"){
							md = "N";
							mobi_promiseidx = model.getValue("/root/resData/dataSet/new_promiseidx");
						}else{
							//mobi_promiseidx = model.getValue("/root/reqData/reqform/promiseidx");
						}
						set_refvalue("/root/reqData/aplcForm/cmpy_cd", 	  getProperty("ss_cmpycd"));
						set_refvalue("/root/reqData/aplcForm/aplcclsf",   md);
						set_refvalue("/root/reqData/aplcForm/promiseidx", mobi_promiseidx);
						model.send("tn_lnk_6090_a");
						return;
					}
				}
				
			}
			
			function send_tn_dns_1050_a()
			{				
				model.setValue("/root/reqData/reqform/memberidx",memberidx.value);
				var md = model.getValue("/root/reqData/reqform/mode");
				var word;
				
				if(md =="I" || md =="U"){
					if (PID1700radio1.value =="") {
						alert("영수증 발급대상여부를 선택해주세요."); return;
					}
					if (PID1700input43.value =="") {
						alert("납입일자를 입력해주세요."); return;
					}
					if (PID1700input32.value =="") {
						alert("납입금액을 입력해주세요."); return;
					}
				}
				
				if (md == "I"){
					word = "저장";
				}else if(md == "U"){
					word = "수정";
					//model.setValue("/root/reqData/reqform/paymentidx",datagrid2.valueMatrix(datagrid2.row,12));
				}else if(md == "D"){
					word = "삭제";
				}
				//alert(model.getValue("/root/reqData/reqform/paymentidx")); 
				if(show_message(word+"하시겠습니까?", "확인", MB_YESNO) != IDYES) {
					return false;
				}
				
				model.send("tn_dns_1050_a");
				if(submit_completed()){
					show_message(word+"되었습니다.","");
					send_tn_dns_1020_l();
				}
			}	
			function send_tn_dns_1070_a(){
				var md = model.getValue("/root/reqData/phot/accflag");
				var promisecode = datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("promisecode"));
				var word;
				
				if (md == "U"){
					word = "저장";
					if (model.getValue("/root/reqData/reqform/prooftype") == ""){
						alert("증빙자료구분을 선택하세요."); return;						
					}
					if (model.getValue("/root/resData/resPhoto/proofdata") == ""){
						alert("증빙자료를 업로드 해주세요."); return;						
					}
				}else if(md == "D"){
					word = "삭제";
				}
				model.setValue("/root/reqData/phot/prooftype",PID1700combo18.value);
				model.setValue("/root/reqData/phot/proofname",promisecode);
				model.setValue("/root/reqData/phot/promiseidx",model.getValue("/root/reqData/reqform/promiseidx"));
				model.send("tn_dns_1070_a");					
				if(submit_completed()){
					if(md == "D"){						
						model.setValue("/root/resData/resPhoto/proofdata","");						
						model.refresh();
					}
					show_message(word+"되었습니다.","");
					upload1.revalidate();
					img1.refresh();
					visible_grp_upload = !visible_grp_upload;
					grp_upload.visible = visible_grp_upload;
					send_tn_dns_1020_l();
				}
				
			}
			function ctrl_promise_btn(tmp){
				if(tmp == "I"){
					promise_insert.visible = true;
					promise_edit.visible = false;
				}else if(tmp == "U"){
					promise_insert.visible = false;
					promise_edit.visible = true;
				}
				
			}
			function ctrl_promise_cncl_btn(){
				var row = datagrid1.row;			
				if(memberidx.value == ""){
					alert("회원 조회 후 약정 해지가 가능합니다."); return;
				}
				//if(datagrid1.valueMatrix(row,3) != ""){
				//	alert("이미 약정 해지 상태 입니다."); return;
				//}
				if(row < 0){
					alert("약정 선택 후 사용 가능합니다."); return;
				}
				
				model.property("TN_DNS_1060_promisedate")  = datagrid1.valueMatrix(row, 2);
				model.property("TN_DNS_1060_promisecode")  = datagrid1.valueMatrix(row, 1);
				model.property("TN_DNS_1060_promiseidx")  = datagrid1.valueMatrix(row, 10);
				model.property("TN_DNS_1060_memberidx")  = model.getValue("/root/reqData/reqform/memberidx");
				model.property("TN_DNS_1060_promiseprice")  = datagrid1.valueMatrix(row, 7);
				model.property("TN_DNS_1060_cmsstatus")  = datagrid1.valueMatrix(row, 40);
				model.property("TN_DNS_1060_paymethodcode")  = datagrid1.valueMatrix(row, 21);
				if(datagrid1.valueMatrix(row,3) ==""){
					model.property("TN_DNS_1060_mode")  = "S";
				}else{
					model.property("TN_DNS_1060_mode")  = "C";
				}						
				model.property("TN_DNS_1060_popup_flag")  = "Y";
				window.load("../../tn/dns/TN_DNS_1060.xrw", "modal", "", "align:center; width:460; height:170; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
				if(model.property("TN_DNS_1060_end") == "Y"){
				}else{
					send_tn_dns_1020_l();
				}
			}
			function reset_promise(){
				model.setValue("/root/reqData/reqform/promisedate","");
				model.setValue("/root/reqData/reqform/promiseprice","");
				model.setValue("/root/reqData/reqform/paystopped","");
				model.setValue("/root/reqData/reqform/contributormemo","");
				model.setValue("/root/reqData/reqform/promisememo","");
				model.setValue("/root/reqData/reqform/fundidx","");
				model.setValue("/root/reqData/reqform/supportidx","");
				model.setValue("/root/reqData/reqform/useoriginal","");
				model.setValue("/root/reqData/reqform/purposememo","");
				model.setValue("/root/reqData/reqform/paymethod","");
				model.setValue("/root/reqData/reqform/paymethodcode","");
				model.setValue("/root/reqData/reqform/bankownerclsf","");
				model.setValue("/root/reqData/reqform/bankowneridentity","");
				model.setValue("/root/reqData/reqform/bankcode","");
				model.setValue("/root/reqData/reqform/bankaccount","");
				model.setValue("/root/reqData/reqform/bankaccountowner","");
				model.setValue("/root/reqData/reqform/cmsstatus","");
				model.setValue("/root/reqData/reqform/filename","");
				model.setValue("/root/reqData/reqform/bankaccount","");
				model.setValue("/root/reqData/reqform/partitiontype","");
				model.setValue("/root/reqData/reqform/excludenopay","");
				model.setValue("/root/reqData/reqform/monthlypayday","");
				model.setValue("/root/reqData/reqform/monthlypayprice","");
				model.setValue("/root/reqData/reqform/partitioncount","");
				model.setValue("/root/reqData/reqform/paystartdate","");
				model.setValue("/root/reqData/reqform/payenddate","");
				//2018.08.17 추가
				model.setValue("/root/reqData/reqform/biz_reg_no","");
				model.setValue("/root/reqData/reqform/bank_id","");
				model.setValue("/root/reqData/reqform/acct_num","");
				//model.setValue("/root/reqData/reqform/g1_rcpm_dt","");
				model.setValue("/root/reqData/reqform/tran_date_seq","");
				model.setValue("/root/reqData/reqform/current_clsf","");
				model.refresh();
			}
			function reset_payment(){
				model.setValue("/root/reqData/reqform/promisecode","");
				model.setValue("/root/reqData/reqform/receiptissue","");
				model.setValue("/root/reqData/reqform/paydate","");
				model.setValue("/root/reqData/reqform/payprice","");
				model.setValue("/root/reqData/reqform/promiseidx","");
			}
			function promise_bnkidentity(){
				if(bankownerclsf.value == "1"){
					//bankowneridentity.disabled = true;
					PID1700caption119.visible = false;
				}else{
					//bankowneridentity.disabled = false;
					PID1700caption119.visible = true;
					//model.setValue("/root/reqData/reqform/bankowneridentity","");
				}
				model.refresh();
			}
			function btn_cms_stopped(){
				var status = model.getValue("/root/reqData/reqform/cmsstatus");
				if (status == "3" || status == "4" || status == "5"|| status == "6"|| status == "10"|| status == "11"){
					cms_stop.visible = true;
					cencel_cms_stop.visible = false;
				}else if(status == "7"|| status == "12"){
					cms_stop.visible = false;
					cencel_cms_stop.visible = true;
				}else{
					cms_stop.visible = false;
					cencel_cms_stop.visible = false;
				}
			}
			function cms_cncl(){
				model.property("TN_DNS_1070_promisecode")  = model.getValue("/root/reqData/reqform/promisecode");
				model.property("TN_DNS_1070_promiseidx")  = model.getValue("/root/reqData/reqform/promiseidx");
				model.property("TN_DNS_1070_memberidx")  = model.getValue("/root/reqData/reqform/memberidx");
				model.property("TN_DNS_1070_cmsstatus")  = model.getValue("/root/reqData/reqform/cmsstatus");
				model.property("TN_DNS_1070_popup_flag")  = "Y";
				window.load("../../tn/dns/TN_DNS_1070.xrw", "modal", "", "align:center; width:460; height:150; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");							
				if(model.property("TN_DNS_1070_end") == "Y"){
				}else{
					send_tn_dns_1020_l();
				}
			}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body pagewidth="1200" pageheight="820" guideline="1,1190;" style="font-family:굴림; border-style:none; ">
		<button id="PID1700button19" class="tab03" group="1" style="left:90.00%; top:6.22%; width:65px; height:23px; background-stretch:stretch; ">
			<caption>카드</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						model.toggle("paycase3");
					]]>
			</script>
		</button>
		<button id="button3" class="tab03" group="1" style="left:95.50%; top:6.22%; width:65px; height:23px; background-stretch:stretch; ">
			<caption>휴대폰</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						model.toggle("paycase6");
					]]>
			</script>
		</button>
		<button id="PID1700button24" class="tab07" group="1" style="left:74.75%; top:6.22%; width:118px; height:23px; background-stretch:stretch; ">
			<caption>영수증 발행내역</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						model.toggle("paycase5");
					]]>
			</script>
		</button>
		<button id="PID1700button20" class="tab03" group="1" style="left:69.25%; top:6.22%; width:65px; height:23px; background-stretch:stretch; ">
			<caption>UMS</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						model.toggle("paycase4");
					]]>
			</script>
		</button>
		<button id="PID1700button15" class="tab03" group="1" style="left:84.50%; top:6.22%; width:65px; height:23px; background-stretch:stretch; ">
			<caption>CMS</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						model.toggle("paycase2");
					]]>
			</script>
		</button>
		<button id="btn_tab_01" class="tab03" group="1" style="left:63.75%; top:6.22%; width:65px; height:23px; background-stretch:stretch; ">
			<caption>납입</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						model.toggle("paycase1");
					]]>
			</script>
		</button>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:0.83%; top:0.61%; width:99.17%; height:4.88%; background-stretch:stretch; "/>
		<!--iviewer id="PID1700iviewer1" src="/xrw/tn/dns/TN_DNS_1001.xrw" style="left:1010px; top:5px; width:115px; height:55px; "/-->
		<group id="group_btnA" class="gro_btn" style="left:77.08%; top:0.98%; width:17.50%; height:3.29%; ">
			<!--button id="btnA4" class="btn02" crud="R" style="left:819px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					search();
					]]>
				</script>
			</button-->
			<button id="btnClose" class="btn02" style="left:64.29%; top:0.00%; width:24.76%; height:100.00%; background-stretch:stretch; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					formClose();
					]]>
				</script>
			</button>
		</group>
		<group id="PID1700group2" style="left:1.50%; top:6.10%; width:61.67%; height:47.56%; background-color:transparent; border-color:transparent; border-style:none; ">
			<caption id="caption2" class="list_cap02" format="###,###,###,##0" style="left:86.35%; top:92.31%; width:12.97%; height:7.18%; text-align:left; border-style:solid; "/>
			<caption id="caption1" class="list_cap02" format="###,###,###,##0" style="left:86.35%; top:85.38%; width:12.97%; height:7.18%; text-align:left; border-width:1px; border-style:solid; "/>
			<caption id="PID1700caption73" class="list_cap02" style="left:6.08%; top:20.77%; width:93.24%; height:14.10%; text-align:left; "/>
			<caption id="PID1700caption14" class="list_cap02" style="left:77.70%; top:77.18%; width:21.62%; height:7.18%; text-align:left; "/>
			<caption id="PID1700caption80" class="list_cap02" style="left:8.65%; top:84.10%; width:68.38%; height:13.33%; text-align:left; "/>
			<caption id="PID1700caption79" class="list_cap02" style="left:8.65%; top:77.44%; width:68.38%; height:7.18%; text-align:left; "/>
			<caption id="PID1700caption72" class="list_cap02" style="left:4.86%; top:27.69%; width:45.81%; height:7.18%; text-align:left; "/>
			<caption id="PID1700caption36" class="list_cap02" style="left:4.86%; top:20.77%; width:45.14%; height:7.18%; text-align:left; "/>
			<caption id="PID1700caption21" class="list_cap02" style="left:6.08%; top:7.20%; width:93.24%; height:7.20%; text-align:left; "/>
			<caption id="PID1700caption10" class="list_cap02" style="left:6.08%; top:37.18%; width:93.24%; height:7.20%; text-align:left; "/>
			<caption id="PID1700caption30" class="list_cap02" style="left:6.08%; top:57.69%; width:93.24%; height:7.18%; text-align:left; "/>
			<caption id="PID1700caption28" class="list_cap02" style="left:6.08%; top:51.01%; width:93.24%; height:7.20%; text-align:left; "/>
			<caption id="PID1700caption19" class="list_cap02" style="left:6.08%; top:44.09%; width:93.24%; height:7.20%; text-align:left; "/>
			<caption id="PID1700caption40" class="list_cap02" style="left:8.65%; top:70.61%; width:68.38%; height:7.20%; text-align:left; "/>
			<caption id="PID1700caption33" class="list_cap02" style="left:6.08%; top:14.12%; width:93.24%; height:7.20%; text-align:left; "/>
			<caption id="PID1700caption1" class="list_cap03" style="left:0.00%; top:7.20%; width:8.78%; height:7.20%; text-align:left; ">회원명</caption>
			<caption id="PID1700caption6" class="list_cap03" style="left:48.65%; top:14.12%; width:8.78%; height:7.20%; text-align:left; ">생년월일</caption>
			<caption id="PID1700caption8" class="list_cap03" style="left:57.30%; top:37.18%; width:8.78%; height:7.20%; text-align:left; ">이메일</caption>
			<caption id="PID1700caption18" class="list_cap03" style="left:0.00%; top:44.09%; width:8.78%; height:7.20%; text-align:left; ">전화</caption>
			<caption id="PID1700caption29" class="list_cap03" style="left:39.86%; top:7.18%; width:8.78%; height:7.18%; text-align:left; ">주민번호</caption>
			<input id="PID1700input18" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/phone1" navindex="23" imemode="disabled" dataType="number" caption="휴대폰번호" style="left:9.19%; top:44.96%; width:13.51%; height:5.19%; "/>
			<input id="PID1700input23" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/birthday" navindex="13" imemode="disabled" inputtype="date" format="yyyy-mm-dd" dataType="date" caption="생년월일" style="left:77.03%; top:15.27%; width:14.05%; height:5.19%; "/>
			<select id="PID1700checkbox1" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/birthdaytype" navindex="14" overflow="visible" appearance="full" caption="음력체크" style="left:92.03%; top:15.27%; width:5.95%; height:5.76%; border-style:none; ">
				<choices>
					<item>
						<label>음력</label>
						<value>2</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						
					]]>
				</script>
			</select>
			<input id="PID1700input20" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/email" navindex="22" imemode="alpha" dataType="email" caption="이메일" style="left:66.49%; top:38.33%; width:30.00%; height:5.19%; "/>
			<input id="mbr_regno" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/mbr_regno" class="req" navindex="6" imemode="disabled" format="999999-9999999" dataType="jumin" caption="주민등록번호" style="left:49.19%; top:7.95%; width:14.86%; height:18px; "/>
			<!-- 구독정보 -->
			<input id="PID1700input2" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/membercode" editable="false" style="left:9.19%; top:8.07%; width:9.05%; height:5.19%; "/>
			<select id="PID1700checkbox2" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/isanonymous" navindex="5" overflow="visible" appearance="full" style="left:30.81%; top:8.36%; width:6.08%; height:5.76%; border-style:none; ">
				<choices>
					<item>
						<label>익명</label>
						<value>1</value>
					</item>
				</choices>
			</select>
			<caption id="PID1700caption38" class="list_cap03" style="left:0.00%; top:20.77%; width:8.78%; height:7.18%; text-align:left; ">회원분류</caption>
			<select1 id="membercategorycode" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/membercategorycode" class="req" navindex="15" appearance="minimal" style="left:9.19%; top:22.19%; width:13.51%; height:5.19%; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/tn_dns_1000_m/dataSet/MEMBERCATEGORYCODE_LIST/record">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</select1>
			<input id="mbr_name" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/mbr_name" class="req" navindex="4" style="left:18.38%; top:8.07%; width:12.03%; height:5.19%; "/>
			<select id="checkbox3" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/isforeigner" navindex="7" overflow="visible" appearance="full" style="left:64.19%; top:8.72%; width:7.43%; height:5.64%; border-style:none; ">
				<choices>
					<item>
						<label>외국인</label>
						<value>1</value>
					</item>
				</choices>
			</select>
			<caption id="PID1700caption34" class="list_cap03" style="left:0.00%; top:27.69%; width:8.78%; height:7.18%; text-align:left; ">거주지역</caption>
			<select1 id="PID1700combo5" navindex="17" appearance="minimal" style="left:9.19%; top:28.82%; width:13.51%; height:5.19%; ">
				<choices/>
			</select1>
			<caption id="PID1700caption35" class="list_cap03" style="left:0.00%; top:14.12%; width:8.78%; height:7.20%; text-align:left; ">대표자명</caption>
			<input id="PID1700input4" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/president" navindex="10" style="left:9.19%; top:14.99%; width:13.51%; height:5.19%; "/>
			<input id="PID1700input5" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/adrs_name" navindex="19" style="left:9.19%; top:38.33%; width:13.51%; height:5.19%; ">
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[
						model.setValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/adrs_name",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/mbr_name"));
						PID1700input5.refresh();
					]]>
				</script>
			</input>
			<caption id="PID1700caption39" class="list_cap03" style="left:0.00%; top:37.18%; width:8.78%; height:7.20%; text-align:left; ">수신자명</caption>
			<input id="PID1700input25" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/dept" navindex="20" style="left:33.51%; top:38.33%; width:13.51%; height:5.19%; "/>
			<caption id="PID1700caption41" class="list_cap03" style="left:24.32%; top:37.18%; width:8.78%; height:7.20%; text-align:left; ">소속/직위</caption>
			<input id="PID1700input26" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/title" navindex="21" style="left:48.51%; top:38.33%; width:8.24%; height:5.19%; "/>
			<caption id="PID1700caption42" style="left:47.30%; top:38.62%; width:1.35%; height:5.76%; ">/</caption>
			<caption id="PID1700caption45" class="list_cap03" style="left:24.32%; top:44.09%; width:8.78%; height:7.20%; text-align:left; ">휴대폰</caption>
			<caption id="PID1700caption25" class="list_cap03" style="left:77.70%; top:51.01%; width:8.78%; height:7.20%; text-align:left; ">우편수령지</caption>
			<select1 id="PID1700radio3" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/postaddress" navindex="32" appearance="full" cols="2" overflow="visible" style="left:86.89%; top:51.79%; width:11.76%; height:5.64%; border-style:none; ">
				<choices>
					<item>
						<label>자택</label>
						<value>1</value>
					</item>
					<item>
						<label>직장</label>
						<value>2</value>
					</item>
				</choices>
			</select1>
			<input id="input7" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/addressdetail1" navindex="28" maxlength="100" style="left:59.46%; top:52.16%; width:17.97%; height:5.19%; "/>
			<caption id="caption9" class="list_cap03" style="left:0.00%; top:51.01%; width:8.78%; height:7.49%; text-align:left; ">주소(자택)</caption>
			<input id="output2" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/address1" navindex="27" editable="true" style="left:21.35%; top:52.16%; width:37.43%; height:5.19%; "/>
			<input id="inp_new_zip" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/zipcode1" navindex="26" visibility="visible" inputtype="button" maxlength="5" format="99999" style="left:9.19%; top:52.16%; width:11.62%; height:5.19%; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						se_openZip("L", "/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/zipcode1", "", "/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/address1","new");
						model.setFocus("input7");
					]]>
				</script>
			</input>
			<input id="PID1700input24" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/addressdetail2" navindex="31" maxlength="100" style="left:59.46%; top:59.08%; width:17.97%; height:5.19%; "/>
			<caption id="PID1700caption47" class="list_cap03" style="left:0.00%; top:57.69%; width:8.78%; height:7.18%; text-align:left; ">주소(직장)</caption>
			<input id="PID1700output1" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/address2" navindex="30" editable="true" style="left:21.35%; top:59.08%; width:37.43%; height:5.19%; "/>
			<input id="PID1700input30" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/zipcode2" navindex="29" visibility="visible" inputtype="button" maxlength="5" format="99999" style="left:9.19%; top:59.08%; width:11.62%; height:5.19%; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						se_openZip("L", "/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/zipcode2", "", "/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/address2","new");
						model.setFocus("PID1700input24");
					]]>
				</script>
			</input>
			<output id="PID1700input6" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/writedate" disabled="true" style="left:33.51%; top:29.11%; width:13.51%; height:5.19%; "/>
			<caption id="PID1700caption2" class="list_cap03" style="left:24.32%; top:27.69%; width:8.78%; height:7.18%; text-align:left; ">등록일자</caption>
			<caption id="PID1700caption5" class="list_cap03" style="left:0.00%; top:70.61%; width:8.78%; height:7.20%; text-align:left; ">발급대상</caption>
			<caption id="PID1700caption7" class="list_cap03" style="left:24.32%; top:70.61%; width:12.84%; height:7.20%; text-align:left; ">기부자분류</caption>
			<caption id="PID1700caption13" style="left:0.00%; top:64.84%; width:13.51%; height:5.76%; font-weight:bold; ">영수증설정</caption>
			<caption id="PID1700caption4" style="left:77.30%; top:64.84%; width:18.65%; height:5.76%; font-weight:bold; ">웹사이트 연동정보</caption>
			<caption id="PID1700caption15" class="list_cap03" style="left:77.70%; top:70.61%; width:21.62%; height:7.20%; text-align:left; ">비밀번호등록여부</caption>
			<input id="PID1700input7" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/password" style="left:78.11%; top:78.39%; width:13.51%; height:5.19%; "/>
			<button id="PID1700button1" class="btn02" style="left:92.30%; top:78.10%; width:6.76%; height:6.05%; color:#ffffff; ">
				<caption>RESET</caption>
			</button>
			<textarea id="PID1700textarea4" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/memo" navindex="18" imemode="hangul" caption="비고" style="left:58.11%; top:21.54%; width:40.54%; height:11.79%; vertical-align:top; "/>
			<caption id="PID1700caption11" class="tit02" style="left:0.00%; top:0.00%; width:9.46%; height:5.76%; ">회원</caption>
			<caption id="PID1700caption12" class="list_cap03" style="left:48.65%; top:20.77%; width:8.78%; height:14.10%; text-align:left; ">회원메모</caption>
			<select1 id="membertype" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/membertype" class="req" navindex="3" appearance="full" cols="3" overflow="visible" style="left:8.65%; top:1.44%; width:18.24%; height:5.76%; background-color:transparent; border-style:none; ">
				<choices>
					<item>
						<label>개인</label>
						<value>1</value>
					</item>
					<item>
						<label>법인</label>
						<value>2</value>
					</item>
					<item>
						<label>단체</label>
						<value>3</value>
					</item>
				</choices>
			</select1>
			<caption id="PID1700caption37" class="list_cap03" style="left:24.32%; top:14.12%; width:8.78%; height:7.20%; text-align:left; ">사업자번호</caption>
			<input id="PID1700input1" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/businessno" navindex="11" imemode="disabled" dataType="jumin" caption="주민등록번호" style="left:33.51%; top:15.27%; width:13.51%; height:5.19%; "/>
			<button id="PID1700button5" class="btn_grid03" navindex="9" style="left:86.08%; top:8.72%; width:7.97%; height:17px; ">
				<caption>중복확인</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							var regno =mbr_regno.currentText;
							if (regno.Trim().ReplaceString("-", "").length != 13){
								alert("올바른 주민등록번호를 입력하세요."); return;
							}						
							model.setValue("/root/reqData/reqform/regno",regno);							
							model.send("tn_dns_1080_l");
							var name = model.getValue("/root/tempData/name");
							var membercode = model.getValue("/root/tempData/membercode");
							if (model.getValue("/root/tempData/chk_regno") == "Y"){
								alert("사용 가능한 주민등록번호입니다."); return;
							}else{								
								alert(name+"("+membercode+") 회원이 이미 사용중인 주민등록번호입니다."); return;
							}
						]]>
				</script>
			</button>
			<select1 id="PID1700combo1" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/partycode" navindex="16" appearance="minimal" style="left:33.51%; top:22.19%; width:13.51%; height:5.19%; ">
				<choices/>
			</select1>
			<caption id="PID1700caption46" class="list_cap03" style="left:24.32%; top:20.77%; width:8.78%; height:7.18%; text-align:left; ">단체</caption>
			<select id="PID1700checkbox4" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/unknownregno" navindex="8" overflow="visible" appearance="full" style="left:71.62%; top:8.72%; width:14.19%; height:5.64%; border-style:none; ">
				<choices>
					<item>
						<label>주민번호 미확인</label>
						<value>1</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
							model.setValue("/root/tempData/tmp_mbr_regno",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/mbr_regno"));
							mbr_regno.value = "999999";
							mbr_regno.disabled = true;
					]]>
				</script>
				<script type="javascript" ev:event="xforms-deselect">
					<![CDATA[
						mbr_regno.value = model.getValue("/root/tempData/tmp_mbr_regno");
						mbr_regno.disabled = false;
					]]>
				</script>
			</select>
			<select1 id="PID1700combo2" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/birthdayorigin" navindex="12" appearance="minimal" style="left:58.11%; top:14.99%; width:18.51%; height:5.19%; ">
				<choices>
					<item>
						<label>주민번호 기준</label>
						<value>1</value>
					</item>
					<item>
						<label>생일확인완료</label>
						<value>2</value>
					</item>
				</choices>
			</select1>
			<caption id="PID1700caption76" class="list_cap03" style="left:57.30%; top:44.09%; width:8.78%; height:7.20%; text-align:left; ">팩스</caption>
			<input id="PID1700input29" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/cellphone" navindex="24" imemode="disabled" dataType="number" caption="휴대폰번호" style="left:33.51%; top:45.24%; width:13.51%; height:5.19%; "/>
			<input id="PID1700input34" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/fax" navindex="25" imemode="disabled" dataType="number" caption="휴대폰번호" style="left:66.49%; top:44.87%; width:13.51%; height:105px; "/>
			<select1 id="PID1700combo3" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/donatorcategory" navindex="34" appearance="minimal" style="left:9.19%; top:71.76%; width:13.51%; height:5.19%; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/tn_dns_1000_m/dataSet/DONATORCATEGORY_LIST/record">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</select1>
			<select1 id="PID1700combo4" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/receiptcategory" navindex="35" appearance="minimal" style="left:37.57%; top:71.76%; width:13.51%; height:5.19%; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/tn_dns_1000_m/dataSet/RECEIPTCATEGORY_LIST/record">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</select1>
			<caption id="PID1700caption77" class="list_cap03" style="left:0.00%; top:77.44%; width:8.78%; height:7.18%; text-align:left; ">기부자명</caption>
			<input id="PID1700input35" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/rcp_regno" navindex="38" imemode="disabled" dataType="jumin" caption="주민등록번호" style="left:37.57%; top:78.21%; width:13.51%; height:18px; "/>
			<caption id="PID1700caption78" class="list_cap03" style="left:24.32%; top:77.44%; width:12.84%; height:7.18%; text-align:left; ">주민/사업자번호</caption>
			<input id="PID1700input36" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/rcp_name" navindex="37" style="left:9.19%; top:78.46%; width:13.51%; height:18px; "/>
			<input id="PID1700input37" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/addressdetail" navindex="41" maxlength="100" style="left:24.32%; top:91.54%; width:31.76%; height:18px; "/>
			<caption id="PID1700caption81" class="list_cap03" style="left:0.00%; top:84.10%; width:8.78%; height:13.33%; text-align:left; ">주소</caption>
			<input id="PID1700output2" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/address" navindex="40" editable="false" style="left:24.32%; top:85.64%; width:31.76%; height:18px; "/>
			<input id="PID1700input38" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/zipcode" navindex="39" visibility="visible" inputtype="button" maxlength="5" format="99999" style="left:9.19%; top:85.64%; width:13.51%; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						se_openZip("L", "/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/zipcode", "", "/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/address","new");
						model.setFocus("PID1700input37");
					]]>
				</script>
			</input>
			<caption id="PID1700caption82" class="list_cap03" style="left:57.30%; top:70.61%; width:10.27%; height:7.20%; text-align:left; ">본인과의관계</caption>
			<input id="PID1700input39" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/relation" navindex="36" style="left:67.97%; top:71.76%; width:8.38%; height:5.19%; "/>
			<caption id="PID1700caption83" class="list_cap03" style="left:57.30%; top:77.44%; width:19.73%; height:7.18%; text-align:left; ">영수증설정메모</caption>
			<textarea id="PID1700textarea5" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/receiptconfigmemo" navindex="42" imemode="hangul" caption="비고" style="left:57.43%; top:85.38%; width:18.92%; height:11.28%; vertical-align:top; "/>
			<select id="PID1700checkbox5" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/useaddress" navindex="33" overflow="visible" appearance="full" style="left:77.70%; top:59.08%; width:20.95%; height:5.76%; font-size:11.5px; border-style:none; ">
				<choices>
					<item>
						<label>우편,이메일,SMS,FAX 수신</label>
						<value>1</value>
					</item>
				</choices>
			</select>
			<input id="memberidx" ref="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/memberidx" disabled="true" visibility="hidden" style="left:67.70%; top:1.03%; width:9.46%; height:18px; "/>
			<caption id="caption5" class="list_cap03" style="left:77.70%; top:85.38%; width:8.78%; height:7.18%; font-weight:bold; text-align:left; ">총약정액</caption>
			<caption id="caption6" class="list_cap03" style="left:77.70%; top:92.31%; width:8.78%; height:7.18%; font-weight:bold; text-align:left; ">총납입액</caption>
			<output id="output1" ref="/root/tempData/total/total_promise" format="#,###" style="left:86.76%; top:86.41%; width:12.16%; height:4.62%; font-weight:bold; text-align:right; "/>
			<output id="output3" ref="/root/tempData/total/total_payment" format="#,###" style="left:86.76%; top:93.33%; width:12.16%; height:4.62%; font-weight:bold; text-align:right; background-color:#ff9900; "/>
		</group>
		<group id="PID1700group3" style="left:63.75%; top:8.78%; width:35.83%; height:88.17%; background-color:#eeeeee; border-color:transparent; border-style:none; ">
			<switch id="PID1700switch2" style="left:1.16%; top:2.02%; width:98.84%; height:94.40%; border-style:none; ">
				<case id="paycase1" selected="true" style="left:0.00%; top:0.00%; width:100.00%; height:100.00%; border-style:none; ">
					<caption id="caption11" class="list_cap02" style="left:15.29%; top:77.45%; width:41.18%; height:4.10%; text-align:left; "/>
					<caption id="PID1700caption63" class="list_cap02" style="left:15.29%; top:69.55%; width:82.35%; height:4.10%; text-align:left; "/>
					<datagrid id="datagrid2" nodeset="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST3/record" caption="^약정코드^납입일^납입코드^기금^지원단위^납입방식^약정액^납입액^누적납입액^영수증발급대상^paymentidx^영수증발급건수^메모^bank_id^acct_num^tran_date^tran_date_seq^slip_no" colsep="#" colwidth="20, 63, 75, 63, 81, 11, 72, 70, 70, 110, 10, 10, 100, 11, 50, 85, 71, 90, 100" explorerbar="sortshow" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:1.18%; top:3.95%; width:96.47%; height:65.30%; ">
						<col checkvalue="1,0" ref="chk" type="checkbox"/>
						<col ref="promisecode"/>
						<col ref="paydate" format="yyyy-mm-dd"/>
						<col ref="paymentcode"/>
						<col ref="fundidx"/>
						<col ref="supportidx" visibility="hidden"/>
						<col ref="paymethodcode"/>
						<col ref="promiseprice" format="(-)#,###"/>
						<col ref="payprice" format="(-)#,###"/>
						<col ref="sumpayprice" format="(-)#,###"/>
						<col ref="receiptissue" visibility="hidden"/>
						<col ref="paymentidx" visibility="hidden"/>
						<col ref="receiptcount"/>
						<col ref="paymentmemo" visibility="hidden"/>
						<col ref="bank_id"/>
						<col ref="acct_num"/>
						<col ref="tran_date"/>
						<col ref="tran_date_seq"/>
						<col ref="slip_no" visibility="hidden"/>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
								var row = datagrid2.row;
								if (-1 != event.target.lastIndexOf("scroll.thumb")) {
									return;
								}
								
								if (datagrid2.mouseRow < 1) {
									return;
								}
									
								var grid = eval(event.currentTarget);
								var rowid = grid.row;
								var colid = grid.col;
								
								if (rowid < grid.fixedRows || colid < grid.fixedCols) {
									return;
								}									
								model.setValue("/root/reqData/reqform/paydate",datagrid2.valueMatrix(row,3));
								model.setValue("/root/reqData/reqform/payprice",datagrid2.valueMatrix(row,9));
								model.setValue("/root/reqData/reqform/receiptissue",datagrid2.valueMatrix(row,11));
								model.setValue("/root/reqData/reqform/paymentidx",datagrid2.valueMatrix(row,12));
								model.setValue("/root/reqData/reqform/paymentmemo",datagrid2.valueMatrix(row,14));
								
								model.setValue("/root/reqData/reqform/bank_id",datagrid2.valueMatrix(row,15));
								model.setValue("/root/reqData/reqform/acct_num",datagrid2.valueMatrix(row,16));
								model.setValue("/root/reqData/reqform/tran_date",datagrid2.valueMatrix(row,17));
								model.setValue("/root/reqData/reqform/tran_date_seq",datagrid2.valueMatrix(row,18));
								ctrl_btn_payment("U");
								model.refresh();
								//alert(model.getValue("/root/reqData/reqform/paymentidx"));
								]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								if (datagrid2.valueMatrix(datagrid2.row, 1) == "1") {
									datagrid2.rowStatus(datagrid2.row) = 1;
								}
								else {
									datagrid2.rowStatus(datagrid2.row) = 0;
								}	
							]]>
						</script>
					</datagrid>
					<caption id="PID1700caption3" class="list_cap03" style="left:37.65%; top:69.55%; width:27.29%; height:4.10%; text-align:left; ">영수증 발급대상여부</caption>
					<caption id="PID1700caption126" class="list_cap02" style="left:15.29%; top:73.50%; width:41.18%; height:4.10%; text-align:left; "/>
					<select1 id="PID1700radio1" ref="/root/reqData/reqform/receiptissue" navindex="80" appearance="full" cols="2" overflow="visible" style="left:65.88%; top:70.28%; width:32.94%; height:2.93%; border-style:none; ">
						<choices>
							<item>
								<label>발급대상</label>
								<value>1</value>
							</item>
							<item>
								<label>발급제외</label>
								<value>0</value>
							</item>
						</choices>
					</select1>
					<input id="PID1700input32" ref="/root/reqData/reqform/payprice" navindex="82" format="(-)#,###" style="left:17.18%; top:78.18%; width:27.53%; height:18px; text-align:right; "/>
					<caption id="PID1700caption129" class="tit02" style="left:0.24%; top:0.00%; width:14.12%; height:3.29%; ">납입</caption>
					<caption id="PID1700caption130" style="left:45.41%; top:78.04%; width:3.53%; height:3.22%; ">원</caption>
					<input id="PID1700input43" ref="/root/reqData/reqform/paydate" navindex="81" inputtype="date" style="left:17.18%; top:74.08%; width:18.12%; height:18px; ">
						<script type="javascript" ev:event="ondblclick">
							<![CDATA[
							var paymethodcode = PID1700combo11.value;
							if(paymethodcode == "M001" || paymethodcode == "M006"){
								model.makeNode("/root/reqData/fwdData/tran_amt_ref");	
								model.setValue("/root/reqData/fwdData/tran_amt_ref", "/root/reqData/reqform/payprice");
								model.makeNode("/root/reqData/fwdData/tran_content_ref");	
								model.setValue("/root/reqData/fwdData/tran_content_ref", "/root/reqData/reqform/g1_rcpm_pers_nm");
								loadRcpmDtlsPop("H1"
													,""
									                ,"/root/reqData/reqform/biz_reg_no"
									                ,"/root/reqData/reqform/bank_id"
									                ,"/root/reqData/reqform/acct_num"
									                ,"/root/reqData/reqform/paydate"
									                ,"/root/reqData/reqform/tran_date_seq"
									                ,"/root/reqData/reqform/current_clsf"
												    ,"/root/reqData/fwdData"); 
								model.setValue("/root/reqData/reqform/g1_rcpm_dt",model.getValue("/root/reqData/reqform/paydate"));
								model.refresh();
							}else{
							}
							]]>
						</script>
					</input>
					<button id="btn_i_payment" class="btn02" navindex="77" style="left:72.24%; top:82.28%; width:11.76%; height:21px; text-align:center; ">
						<caption>납입입력</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
							if(PID1700input15.value == ""){
								alert("약정 선택 후 납입 입력이 가능합니다."); return;
							}
							model.setValue("/root/reqData/reqform/mode","I");
							model.setValue("/root/reqData/reqform/paymentidx","");
							model.setValue("/root/reqData/reqform/multiUpdateData",datagrid2.getUpdateData());
							send_tn_dns_1050_a();
						]]>
						</script>
					</button>
					<button id="PID1700button13" class="btn02" navindex="79" style="left:85.18%; top:82.28%; width:11.76%; height:21px; text-align:center; ">
						<caption>납입삭제</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[		
							var today = commCurDate();
							model.setValue("/root/reqData/reqform/mode","D");
							model.setValue("/root/reqData/reqform/multiUpdateData",datagrid2.getUpdateData());
							var cnt = 0;
							for(var i=1; i<datagrid2.rows; i++){
								if(datagrid2.valueMatrix(i,1) == "1"){
									cnt = cnt +1;
								}
							}
							if(cnt <1){
								alert("체크박스를 통해 삭제를 원하시는 납입 내역을 선택해주세요.");return;
							}
							
							for(var i=1; i<datagrid2.rows; i++){
								if(datagrid2.valueMatrix(i,1) == "1"){
									if(datagrid2.valueMatrix(i,datagrid2.colRef("paydate")) != today){
										alert("당일 납입건 이외에는 수정과 삭제가 불가능 합니다.");return;
									}
									if(datagrid2.valueMatrix(i,13) > 0){
										alert("영수증발급건수가 있어 납입 삭제가 불가능 합니다.");return;
									}
								}
							}
							send_tn_dns_1050_a();
						]]>
						</script>
					</button>
					<input id="PID1700input15" ref="/root/reqData/reqform/promisecode" editable="false" style="left:17.18%; top:70.28%; width:15.76%; height:18px; "/>
					<caption id="PID1700caption64" class="list_cap03" style="left:1.18%; top:69.55%; width:15.29%; height:4.10%; text-align:left; ">약정코드</caption>
					<caption id="PID1700caption68" class="list_cap02" style="left:15.29%; top:88.43%; width:82.35%; height:4.10%; text-align:left; "/>
					<caption id="PID1700caption69" class="list_cap03" style="left:1.18%; top:88.43%; width:15.29%; height:4.10%; text-align:left; ">발급일</caption>
					<caption id="PID1700caption107" class="list_cap03" style="left:1.18%; top:73.50%; width:15.29%; height:4.10%; text-align:left; ">납입일자</caption>
					<input id="PID1700input16" ref="/root/reqData/reqform/issuedate" inputtype="date" style="left:17.18%; top:89.02%; width:25.18%; height:18px; "/>
					<caption id="PID1700caption70" class="list_cap03" visibility="hidden" style="left:47.29%; top:88.43%; width:15.29%; height:4.10%; text-align:left; ">발급차수</caption>
					<caption id="PID1700caption71" class="list_cap02" style="left:15.29%; top:92.39%; width:82.35%; height:4.10%; text-align:left; "/>
					<caption id="PID1700caption74" class="list_cap03" style="left:1.18%; top:92.39%; width:15.29%; height:4.10%; text-align:left; ">발급옵션</caption>
					<select1 id="PID1700radio2" ref="/root/reqData/reqform/issuedatecategory" appearance="full" cellspacing="3" cols="2" overflow="visible" style="left:17.18%; top:92.97%; width:54.12%; height:2.78%; border-style:none; ">
						<choices>
							<item>
								<label>통합발급(납입일)</label>
								<value>1</value>
							</item>
							<item>
								<label>개별발급(납입건)</label>
								<value>2</value>
							</item>
						</choices>
					</select1>
					<button id="PID1700button12" class="btn03" navindex="78" style="left:82.12%; top:96.78%; width:15.06%; height:21px; ">
						<caption>영수증 발행</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
							
							var cnt = 0;
							for(var i=1; i<datagrid2.rows; i++){
								if(datagrid2.valueMatrix(i,1) == "1"){
									cnt = cnt +1;
								}
							}
							if(cnt <1){
								alert("체크박스를 통해 영수증 발행을 원하시는 납입 내역을 선택해주세요.");return;
							}
							
							if (PID1700input16.value =="") {
								alert("발급일을 입력해주세요."); return;
							}
							
							if (PID1700radio2.value =="") {
								alert("발급옵션을 선택해주세요."); return;
							}
							
							var row = datagrid2.row;	
							model.setValue("/root/reqData/reqform/regno",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/mbr_regno"));
							model.setValue("/root/reqData/reqform/memberidx",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/memberidx"));
							model.setValue("/root/reqData/reqform/multiUpdateData",datagrid2.getUpdateData());
							if(show_message("발급 하시겠습니까?", "확인", MB_YESNO) != IDYES) {
								return false;
							}else{
								model.send("tn_dns_3040_a");
								if(submit_completed()){
								show_message("발행되었습니다.","");
								send_tn_dns_1020_l();
								PID1700button24.dispatch("onclick");
								}
							}
							]]>
						</script>
					</button>
					<output id="PID1700output3" visibility="hidden" style="left:63.29%; top:89.02%; width:12.00%; height:18px; "/>
					<caption id="PID1700caption75" class="tit02" style="left:0.24%; top:85.07%; width:22.35%; height:20px; ">영수증 발급</caption>
					<!--output id="paymentidx" ref="/root/reqData/reqform/paymentidx" visibility="hidden" disabled="true" style="left:230px; top:475px; width:67px; height:18px; "/-->
					<button id="button2" style="left:35.76%; top:74.08%; width:13.18%; height:21px; text-align:center; background-color:#dce5ec; border-color:#000000; border-style:solid; ">
						<caption>입금내역</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
								var paymethodcode = PID1700combo11.value;
								if(paymethodcode == "M001" || paymethodcode == "M006" || paymethodcode == "M005" ){
									if (model.getValue("/root/reqData/reqform/tran_date") != ""){										
										model.property("TN_DNS_1000_TO_BANK")="Y";									
										model.property("TN_DNS_1000_acct_num") =model.getValue("/root/reqData/reqform/acct_num");
										model.property("TN_DNS_1000_tran_date") =model.getValue("/root/reqData/reqform/tran_date");
										//model.property("TN_DNS_1000_tran_content") =mbr_name.value;
									}

									model.makeNode("/root/reqData/fwdData/tran_amt_ref");	
									model.setValue("/root/reqData/fwdData/tran_amt_ref", "/root/reqData/reqform/payprice");
									model.makeNode("/root/reqData/fwdData/tran_content_ref");	
									model.setValue("/root/reqData/fwdData/tran_content_ref", "/root/reqData/reqform/g1_rcpm_pers_nm");
									loadRcpmDtlsPop("H1"
														,""
														,"/root/reqData/reqform/biz_reg_no"
														,"/root/reqData/reqform/bank_id"
														,"/root/reqData/reqform/acct_num"
														,"/root/reqData/reqform/paydate"
														,"/root/reqData/reqform/tran_date_seq"
														,"/root/reqData/reqform/current_clsf"
														,"/root/reqData/fwdData"); 									
									model.setValue("/root/reqData/reqform/g1_rcpm_dt",model.getValue("/root/reqData/reqform/paydate"));
									model.refresh();
								}else{
								}
							]]>
						</script>
					</button>
					<caption id="caption10" class="list_cap03" style="left:1.18%; top:77.45%; width:15.29%; height:4.10%; text-align:left; ">납입금액</caption>
					<caption id="caption12" class="list_cap02" style="left:56.47%; top:73.50%; width:41.18%; height:8.0%; text-align:left; "/>
					<caption id="PID1700caption23" class="list_cap03" style="left:49.65%; top:73.50%; width:15.29%; height:8.0%; text-align:left; ">납입메모</caption>
					<textarea id="textarea1" ref="/root/reqData/reqform/paymentmemo" navindex="42" imemode="hangul" caption="비고" style="left:65.88%; top:73.94%; width:30.59%; height:6.59%; vertical-align:top; "/>
					<button id="btn_u_payment" class="btn02" navindex="77" visibility="hidden" style="left:72.24%; top:82.28%; width:11.76%; height:21px; text-align:center; ">
						<caption>납입수정</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
							var today = commCurDate();
							if(datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("paydate")) != today){
								alert("당일 납입건 이외에는 수정과 삭제가 불가능 합니다.");return;
							}

							//model.setValue("/root/reqData/reqform/paymentidx",datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("paymentidx")));
							model.setValue("/root/reqData/reqform/mode","U");
							send_tn_dns_1050_a();
						]]>
						</script>
					</button>
					<select1 id="combo1" ref="/root/tempData/list_promisecode" appearance="minimal" style="left:51px; top:1px; width:94px; height:18px; ">
						<choices>
							<itemset nodeset="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST9/record">
								<label ref="promisecode"/>
								<value ref="promisecode"/>
							</itemset>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								var p_code = model.getValue("/root/tempData/list_promisecode");
								if (p_code == ""){
									for (var i=1; i<datagrid2.rows; i++){
										datagrid2.rowHidden(i) = false;
									}
								}else{
									for (var i=1; i<datagrid2.rows; i++){
										if (datagrid2.valueMatrix(i,datagrid2.colRef("promisecode")) == p_code){		
											datagrid2.rowHidden(i) = false;
										}else {
											datagrid2.rowHidden(i) = true;
										}
									}
								}
							]]>
						</script>
					</select1>
				</case>
				<case id="paycase2">
					<datagrid id="PID1700datagrid2" nodeset="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST4/record" caption="멤버인덱스^기금^지원단위^청구금액^납입금액^납입일^상태^불능코드^은행^계좌^예금주^구분^제외여부^작성일시" colsep="^" colwidth="10, 10, 8, 75, 75, 80, 82, 165, 79, 100, 75, 74, 63, 116" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:1.18%; top:3.95%; width:96.47%; height:92.68%; ">
						<col ref="memberidx" visibility="hidden"/>
						<col ref="fundidx" visibility="hidden"/>
						<col ref="supportidx" visibility="hidden"/>
						<col ref="scheduleprice" format="(-)#,###"/>
						<col ref="payprice" format="(-)#,###"/>
						<col ref="paydate"/>
						<col ref="status"/>
						<col ref="errorcode"/>
						<col ref="bankcode"/>
						<col ref="bankaccount"/>
						<col ref="bankaccountowner"/>
						<col ref="his_type"/>
						<col ref="isdelete"/>
						<col ref="writedate"/>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
					var row = datagrid2.row;
					if (-1 != event.target.lastIndexOf("scroll.thumb")) {
						return;
					}
					
					if (datagrid2.mouseRow < 1) {
						return;
					}
						
					var grid = eval(event.currentTarget);
					var rowid = grid.row;
					var colid = grid.col;
					
					if (rowid < grid.fixedRows || colid < grid.fixedCols) {
						return;
					}	
					model.setValue("/root/reqData/reqform/paydate",datagrid2.valueMatrix(row,2));
					model.setValue("/root/reqData/reqform/payprice",datagrid2.valueMatrix(row,7));
					model.setValue("/root/reqData/reqform/receiptissue",datagrid2.valueMatrix(row,10));
					model.refresh();
					]]>
						</script>
					</datagrid>
					<caption id="PID1700caption20" class="tit02" style="left:0.24%; top:0.00%; width:40.94%; height:3.29%; ">CMS HISROTY</caption>
				</case>
				<case id="paycase3">
					<datagrid id="PID1700datagrid1" nodeset="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST7/record" caption="멤버인덱스^기금^지원단위^청구금액^납입금액^acptprice^납입일^상태^불능코드^카드사^카드번호^유효기간^성명^제외여부^작성일시" colsep="^" colwidth="10, 10, 8, 68, 68, 10, 66, 48, 87, 51, 109, 54, 61, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:1.18%; top:3.95%; width:96.47%; height:92.86%; ">
						<col ref="memberidx" visibility="hidden"/>
						<col ref="fundidx" visibility="hidden"/>
						<col ref="supportidx" visibility="hidden"/>
						<col ref="scheduleprice" format="(-)#,###"/>
						<col ref="payprice" format="(-)#,###"/>
						<col ref="acptprice" visibility="hidden" format="(-)#,###"/>
						<col ref="paydate"/>
						<col ref="status"/>
						<col ref="errorcode"/>
						<col ref="cardcmpy"/>
						<col ref="cardno"/>
						<col ref="cardyymm"/>
						<col ref="ownername"/>
						<col ref="writedate" visibility="hidden"/>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
								var row = datagrid2.row;
								if (-1 != event.target.lastIndexOf("scroll.thumb")) {
									return;
								}
								
								if (datagrid2.mouseRow < 1) {
									return;
								}
									
								var grid = eval(event.currentTarget);
								var rowid = grid.row;
								var colid = grid.col;
								
								if (rowid < grid.fixedRows || colid < grid.fixedCols) {
									return;
								}	
								model.setValue("/root/reqData/reqform/paydate",datagrid2.valueMatrix(row,2));
								model.setValue("/root/reqData/reqform/payprice",datagrid2.valueMatrix(row,7));
								model.setValue("/root/reqData/reqform/receiptissue",datagrid2.valueMatrix(row,10));
								model.refresh();
							]]>
						</script>
					</datagrid>
					<caption id="PID1700caption65" class="tit02" style="left:0.24%; top:0.00%; width:40.94%; height:3.29%; ">카드</caption>
				</case>
				<case id="paycase4">
					<caption id="PID1700caption66" class="tit02" style="left:0.24%; top:0.00%; width:40.94%; height:3.29%; ">UMS</caption>
					<datagrid id="PID1700datagrid3" nodeset="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST6/record" caption="수신처^발송상태^발송수단^발송일^실패사유^umsidx" colsep="^" colwidth="90, 70, 70, 120, 70,50" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:1.18%; top:3.95%; width:96.47%; height:65.24%; ">
						<col ref="receiverinfo"/>
						<col ref="status"/>
						<col ref="sendtype"/>
						<col ref="senddate"/>
						<col ref="failreason"/>
						<col ref="umsidx" visibility="hidden"/>
						<script type="javascript" ev:event="ondblclick">
							<![CDATA[
							var selectedIdx1  = PID1700datagrid3.row;
							if( selectedIdx1 < 1 ) return;
							model1.setValue("/root/reqData/mdichild/umsidx", PID1700datagrid3.valueMatrix(selectedIdx1, PID1700datagrid3.colRef("umsidx")));
							window.load("/xrw/tn/lnk/TN_LNK_4110.xrw", "modal" , "", "left:100; top:100; width:850; height:800; align:center;sysmenu:hidden; min:hidden; max:hidden; resize:false; caption:hidden;"
										 , "", "");
							]]>
						</script>
					</datagrid>
					<button id="PID1700button6" class="btn02" navindex="75" style="left:75.29%; top:69.55%; width:21.41%; height:21px; ">
						<caption>UMS발송</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[					
								var mbr_idx = model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/memberidx");
								model1.setValue("/root/reqData/mdichild2/memberidx",mbr_idx);
								model1.setValue("/root/reqData/mdichild2/name",model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/mbr_name"));
								model1.refresh();
								if(mbr_idx.length > 0){
								window.load("/xrw/tn/lnk/TN_LNK_4000.xrw", "modal" , "", "left:100; top:100; width:700; height:690; align:center;sysmenu:hidden; min:hidden; max:hidden; resize:false; caption:hidden;"
											 , "", "");
								}else{
									alert("회원 조회 후 UMS 발송이 가능합니다.");
									return;
								}
							]]>
						</script>
					</button>
				</case>
				<case id="paycase5">
					<datagrid id="PID1700datagrid4" nodeset="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST5/record" caption="영수증인덱스^멤버인덱스^발급부서^영수증코드^발급성명^발급구분^발급일^발급대상^기부자분류^발급금액^회원명^납입중복발급^발급차수^^구분^제외여부^작성일시^삭제여부" colsep="^" colwidth="16, 17, 16, 90, 70, 80, 75, 75, 79, 79, 70, 90, 60" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:1.18%; top:3.95%; width:96.47%; height:92.86%; ">
						<col ref="receiptidx" visibility="hidden"/>
						<col ref="memberidx" visibility="hidden"/>
						<col ref="deptidx" visibility="hidden"/>
						<col ref="receiptcode"/>
						<col ref="name"/>
						<col ref="issuecategory"/>
						<col ref="issuedate"/>
						<col ref="donatorcategory"/>
						<col ref="receiptcategory"/>
						<col ref="price" format="(-)#,###"/>
						<col ref="membername"/>
						<col ref="paymentissue"/>
						<col ref="issuecount"/>
						<col ref="isdeleted" visibility="hidden"/>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
					var row = datagrid2.row;
					if (-1 != event.target.lastIndexOf("scroll.thumb")) {
						return;
					}
					
					if (datagrid2.mouseRow < 1) {
						return;
					}
						
					var grid = eval(event.currentTarget);
					var rowid = grid.row;
					var colid = grid.col;
					
					if (rowid < grid.fixedRows || colid < grid.fixedCols) {
						return;
					}	
					model.setValue("/root/reqData/reqform/paydate",datagrid2.valueMatrix(row,2));
					model.setValue("/root/reqData/reqform/payprice",datagrid2.valueMatrix(row,7));
					model.setValue("/root/reqData/reqform/receiptissue",datagrid2.valueMatrix(row,10));
					model.refresh();
					]]>
						</script>
						<script type="javascript" ev:event="ondblclick">
							<![CDATA[
								var row = PID1700datagrid4.row;
								//오즈관련 노드초기화
								 resetOznode();
								 //ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅
								 makeNodeValue("/root/oz_data/ozrName" , "tn/SP_TN_DNS_3050_P");
								 makeNodeValue("/root/oz_data/preview","preview");    //preview : 미리보기, print : 인쇄
								 makeNodeValue("/root/oz_data/printsize","A4");   //페이지용지설정(기본 A4)
								 
								 //odi파라미터 설정								 
								 makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , getProperty("ss_cmpycd") );
								 makeNodeValue("/root/oz_data/odiParam/iv_receiptcode" , PID1700datagrid4.valueMatrix(row,4)); 
									   
								 
								 //레포트뷰어 호출
								 if (PID1700datagrid4.valueMatrix(row,PID1700datagrid4.colRef("isdeleted")) == "1"){
								 alert("삭제된 영수증이므로 출력할 수 없습니다.");
								 }else{ 
								 openOzwin("/root/oz_data");
								 } 
							]]>
						</script>
					</datagrid>
					<caption id="PID1700caption67" class="tit02" style="left:0.24%; top:0.00%; width:40.94%; height:3.29%; ">영수증 발행내역</caption>
				</case>
				<case id="paycase6">
					<caption id="caption8" class="tit02" style="left:0.24%; top:0.00%; width:40.94%; height:3.29%; ">휴대폰</caption>
					<datagrid id="datagrid4" nodeset="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST8/record" caption="멤버인덱스^기금^지원단위^청구금액^납입금액^납입일^상태^불능코드^통신사^핸드폰번호^성명^제외여부^작성일시" colsep="^" colwidth="10, 10, 8, 68, 68, 75, 70, 80, 46, 76, 73" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:1.18%; top:3.95%; width:96.47%; height:92.86%; ">
						<col ref="memberidx" visibility="hidden"/>
						<col ref="fundidx" visibility="hidden"/>
						<col ref="supportidx" visibility="hidden"/>
						<col ref="scheduleprice" format="(-)#,###"/>
						<col ref="payprice" format="(-)#,###"/>
						<col ref="paydate"/>
						<col ref="status"/>
						<col ref="errorcode"/>
						<col ref="mobicmpy"/>
						<col ref="mobino"/>
						<col ref="ownername"/>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
								var row = datagrid2.row;
								if (-1 != event.target.lastIndexOf("scroll.thumb")) {
									return;
								}
								
								if (datagrid2.mouseRow < 1) {
									return;
								}
									
								var grid = eval(event.currentTarget);
								var rowid = grid.row;
								var colid = grid.col;
								
								if (rowid < grid.fixedRows || colid < grid.fixedCols) {
									return;
								}	
								model.setValue("/root/reqData/reqform/paydate",datagrid2.valueMatrix(row,2));
								model.setValue("/root/reqData/reqform/payprice",datagrid2.valueMatrix(row,7));
								model.setValue("/root/reqData/reqform/receiptissue",datagrid2.valueMatrix(row,10));
								model.refresh();
							]]>
						</script>
					</datagrid>
				</case>
			</switch>
			<group id="grp_upload" visibility="hidden" style="left:2.33%; top:76.76%; width:96.51%; height:21.44%; background-color:#ffffff; border-color:#99ccff; border-width:2px; border-style:solid; ">
				<img id="img1" ref="/root/resData/resPhoto/proofdata" class="gro_sel" style="left:54.81%; top:24.36%; width:43.27%; height:70.51%; background-stretch:stretch; border-color:#999999; border-style:solid; ">
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							window.load("../dns/TN_DNS_1050.xrw","modeless","pop1","left:200; top:10; width:800px; height:1000px; ","/root/resData/resPhoto/proofdata","/root/resData/resForm/phot_img");
						]]>
					</script>
				</img>
				<button id="PID1700button16" style="left:77.88%; top:5.77%; width:9.62%; height:12.18%; text-align:center; background-color:#dce5ec; border-color:#000000; border-style:solid; ">
					<caption>삭제</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[			
							model.setValue("/root/reqData/phot/accflag","D");
							send_tn_dns_1070_a();
						]]>
					</script>
				</button>
				<button id="PID1700button17" style="left:88.70%; top:5.77%; width:9.62%; height:12.18%; text-align:center; background-color:#dce5ec; border-color:#000000; border-style:solid; ">
					<caption>닫기</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						visible_grp_upload = !visible_grp_upload;	
						grp_upload.visible = visible_grp_upload;					
						]]>
					</script>
				</button>
				<caption id="PID1700caption49" class="tit02" style="left:2.16%; top:5.77%; width:39.66%; height:12.82%; font-size:12pxpt; ">CMS 출금동의 증빙자료</caption>
				<button id="PID1700button18" style="left:53.85%; top:5.77%; width:10.82%; height:12.18%; text-align:center; background-color:#dce5ec; border-color:#000000; border-style:solid; ">
					<caption>업로드</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[		
						var type = model.getValue("/root/reqData/reqform/prooftype");
						if(type == "1"){
							var upload = window.fileDialog("open", "", false, "", "", "jpg files (*.jpg)|*.jpg|gif files (*.gif)|*.gif");
						}else if(type == "4"){
							var upload = window.fileDialog("open", "", false, "", "", "mp3 files (*.mp3)|*.mp3");
						}
						var type = model.getValue("/root/reqData/reqform/prooftype");
						
						if(type ==""){
							alert("증빙자료구분을 선택하신 후 업로드 가능합니다.");
						}
						var promiseidx = model.getValue("/root/reqData/reqform/promiseidx");
						model.setValue("/root/reqData/phot/accflag","U");
						model.setValue("/root/reqData/phot/promiseidx",promiseidx);
						model.removenode("/root/resData/resPhoto/proofdata");
						model.makeNode("/root/resData/resPhoto/proofdata");
						model.setValue("/root/resData/resPhoto/proofdata",upload);
						model.setValue("/root/reqData/phot/proofdata",upload);
						model.setValue("/root/reqData/phot/extension",upload);
						model.setValue("/root/reqData/phot/proofname",upload);
						upload1.revalidate();	
						img1.refresh();
						]]>
					</script>
				</button>
				<upload id="upload1" visibility="hidden" nodeset="/root/reqData/phot/proofdata" filesize="300KB" ext="jpg;gif;png;mp3;" filecount="1" validate="false" style="left:68.03%; top:46.79%; width:16.83%; height:19.23%; ">
					<script type="javascript" ev:event="upload-filesize-error">
						<![CDATA[
							alert("최대 첨부파일 사이즈는 300KB입니다.");		
						]]>
					</script>
				</upload>
				<caption id="PID1700caption51" class="list_cap03" style="left:3.37%; top:25.64%; width:18.27%; height:16.03%; text-align:left; ">증빙자료구분</caption>
				<caption id="PID1700caption53" class="list_cap03" visibility="visible" style="left:3.37%; top:41.03%; width:18.27%; height:16.03%; text-align:left; ">업로드</caption>
				<caption id="PID1700caption54" class="list_cap02" style="left:21.39%; top:25.64%; width:32.21%; height:16.03%; text-align:left; "/>
				<caption id="PID1700caption60" class="list_cap02" visibility="visible" style="left:21.39%; top:41.03%; width:32.21%; height:16.03%; text-align:left; "/>
				<select1 id="PID1700combo18" ref="/root/reqData/reqform/prooftype" appearance="minimal" style="left:22.60%; top:28.21%; width:28.61%; height:11.54%; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/tn_dns_1000_m/dataSet/PROOFTYPE_LIST/record">
							<label ref="cdnm"/>
							<value ref="cd"/>
						</itemset>
					</choices>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						model.removenode("/root/resData/resPhoto/proofdata");
						if(model.getValue("/root/reqData/reqform/prooftype") =="4"){
							img1.visible = false;
						}else{
							img1.visible = true;
						}
						model.refresh();
						]]>
					</script>
				</select1>
				<output id="PID1700input8" ref="/root/reqData/reqform/proofname" visibility="visible" style="left:22.60%; top:43.59%; width:28.61%; height:11.54%; ">
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							var file_nm = model.getValue("/root/reqData/reqform/proofname");
							if( file_nm != ""){
								makeNodeValue("/root/tempData/proofidx", datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("proofidx")));
								//현재 주소창의 uri가져오기
								var uri; 
								 uri=document.location; 
								 uri=uri.split("//"); 
								 uri=uri[0]+"//"+uri[1].substr(0,uri[1].indexOf("/")); 
								
								var fileName = file_nm;								
								var file = window.fileDialog("save","","",fileName,"*.*","All Files (*.*)|*.*");
								
								if(file!=""){
									//http://203.255.110.250:7001/ad/bas/1590?rept_clsf=01&make_dt=20120228&rept_no=3&add_file_no=1
									//model.download("http://www.comsquare.co.kr/images/ban_hee.gif", file, false);
									var params = "proofidx=" + datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("proofidx"));
									model.download(uri+"/tn/dns/1075?"+params, file, false);
								}								
							}else{
								alert("다운받을 파일이 없습니다.");
							}
						]]>
					</script>
				</output>
				<button id="PID1700button22" style="left:65.63%; top:5.77%; width:10.82%; height:12.18%; text-align:center; background-color:#dce5ec; border-color:#000000; border-style:solid; ">
					<caption>저장</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							model.setValue("/root/reqData/phot/accflag","U");
							send_tn_dns_1070_a();
						]]>
					</script>
				</button>
			</group>
		</group>
		<group id="PID1700group1" style="left:1.25%; top:55.49%; width:62.08%; height:41.46%; background-color:#eeeeee; border-color:transparent; border-style:none; ">
			<caption id="PID1700caption57" class="list_cap02" style="left:9.26%; top:58.24%; width:89.40%; height:7.81%; text-align:left; border-bottom-width:1px; "/>
			<caption id="PID1700caption31" class="list_cap02" style="left:9.26%; top:43.13%; width:89.40%; height:15.31%; text-align:left; "/>
			<caption id="PID1700caption27" class="list_cap02" style="left:9.26%; top:50.63%; width:24.30%; height:7.81%; text-align:left; "/>
			<caption id="PID1700caption50" class="list_cap02" style="left:0.67%; top:66.47%; width:97.99%; height:7.94%; color:#cc99ff; text-align:left; border-color:#ff0000; border-width:2px; "/>
			<datagrid id="datagrid1" nodeset="/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST2/record" caption="약정코드^약정일^약정상태^기금^원금사용여부^납입방식^약정액^납입액^납입률^promiseidx^memberidx^paystopped^contributormemo^promisememo^fundidx^supportidx_nm^supporidx^useoriginal^purposememo^paymethod^paymethodcode^bankaccoutcode^partitiontype^paystartdate^payenddate^partitioncount^monthlypayday^monthlypayprice^excludenopay^ispromiseanonymous^itemname^itemqty^itemprice^itemremk^bankcode^bankaccount^bankaccountowner^bankownerclsf^bankowneridentity^cmsstatus^proofname^prooftype^proofsize^stopdate^stopresn^cardidentity^cardowner^cmspaymentstatus^cmsstatus^proofidx" colsep="^" colwidth="67, 80, 59, 80, 82, 155, 65, 65, 50, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100,100,100,100,50,50,50" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:0.67%; top:8.13%; width:97.99%; height:26.56%; ">
				<!-- 1.  -->
				<col ref="promisecode"/>
				<col ref="promisedate" format="yyyy-mm-dd"/>
				<col ref="promise_status"/>
				<col ref="fundidx_nm"/>
				<!-- 5.  -->
				<col ref="useoriginal_nm"/>
				<col ref="paymethodcode_nm"/>
				<col ref="promiseprice" format="(-)#,###"/>
				<col ref="payprice" format="(-)#,###"/>
				<col ref="payrate"/>
				<!-- 10.  -->
				<col ref="promiseidx" visibility="hidden"/>
				<col ref="memberidx" visibility="hidden"/>
				<col ref="paystopped" visibility="hidden"/>
				<col ref="contributormemo" visibility="hidden"/>
				<col ref="promisememo" visibility="hidden"/>
				<!-- 15.  -->
				<col ref="fundidx" visibility="hidden"/>
				<col ref="supportidx_nm" visibility="hidden"/>
				<col ref="supportidx" visibility="hidden"/>
				<col ref="useoriginal" visibility="hidden"/>
				<col ref="purposememo" visibility="hidden"/>
				<!-- 20.  -->
				<col ref="paymethod" visibility="hidden"/>
				<col ref="paymethodcode" visibility="hidden"/>
				<col ref="bankaccountcode" visibility="hidden"/>
				<col ref="partitiontype" visibility="hidden"/>
				<col ref="paystartdate" visibility="hidden"/>
				<!-- 25.  -->
				<col ref="payenddate" visibility="hidden"/>
				<col ref="partitioncount" visibility="hidden"/>
				<col ref="monthlypayday" visibility="hidden"/>
				<col ref="monthlypayprice" visibility="hidden"/>
				<col ref="excludenopay" visibility="hidden"/>
				<!-- 30.  -->
				<col ref="ispromiseanonymous" visibility="hidden"/>
				<col ref="itemname" visibility="hidden"/>
				<col ref="itemqty" visibility="hidden"/>
				<col ref="itemprice" visibility="hidden"/>
				<col ref="itempremk" visibility="hidden"/>
				<!-- 35.  -->
				<col ref="bankcode" visibility="hidden"/>
				<col ref="bankaccount" visibility="hidden"/>
				<col ref="bankaccountowner" visibility="hidden"/>
				<col ref="bankownerclsf" visibility="hidden"/>
				<col ref="bankowneridentity" visibility="hidden"/>
				<!-- 40.  -->
				<col ref="cmsstatus" visibility="hidden"/>
				<col ref="proofname" visibility="hidden"/>
				<col ref="prooftype" visibility="hidden"/>
				<col ref="proofsize" visibility="hidden"/>
				<col ref="stopdate" visibility="hidden"/>
				<!-- 45.  -->
				<col ref="stopresn" visibility="hidden"/>
				<col ref="cardcmpy" visibility="hidden"/>
				<col ref="cardnumber" visibility="hidden"/>
				<col ref="cardyymm" visibility="hidden"/>
				<col ref="mobiaprvname" visibility="hidden"/>
				<!-- 50.  -->
				<col ref="mobiaprvcmpy" visibility="hidden"/>
				<col ref="mobiaprvnumber" visibility="hidden"/>
				<col ref="mobiaprvprn" visibility="hidden"/>
				<col ref="cmsstopped" visibility="hidden"/>
				<col ref="cmsstopdate" visibility="hidden"/>
				<!-- 55.  -->
				<col ref="cmsupdatedate" visibility="hidden"/>
				<col ref="cardidentity" visibility="hidden"/>
				<col ref="cardowner" visibility="hidden"/>
				<col ref="cms_payment_status" visibility="hidden"/>
				<col ref="cms_status" visibility="hidden"/>
				<col ref="proofidx" visibility="hidden"/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var row = datagrid1.row;
						if (-1 != event.target.lastIndexOf("scroll.thumb")) {
							return;
						}
						
						if (datagrid1.mouseRow < 1) {
							return;
						}
							
						var grid = eval(event.currentTarget);
						var rowid = grid.row;
						var colid = grid.col;
						
						if (rowid < grid.fixedRows || colid < grid.fixedCols) {
							return;
						}	
						
						grp_upload.visible = false;
						model.setValue("/root/resData/resPhoto/proofdata","");
						model.setValue("/root/reqData/reqform/promisecode",datagrid1.valueMatrix(row,1)); //납입>약정코드
						model.setValue("/root/reqData/reqform/promisedate",datagrid1.valueMatrix(row,2));	//약정일
						model.setValue("/root/reqData/reqform/promiseprice",datagrid1.valueMatrix(row,7));	//약정금액
						model.setValue("/root/reqData/reqform/paystopped",datagrid1.valueMatrix(row,12));	//납입일시중단
						model.setValue("/root/reqData/reqform/contributormemo",datagrid1.valueMatrix(row,13));	//기부자메모
						model.setValue("/root/reqData/reqform/promisememo",datagrid1.valueMatrix(row,14));	//약정메모
						model.setValue("/root/reqData/reqform/fundidx",datagrid1.valueMatrix(row,15));	//기금
						model.setValue("/root/reqData/reqform/supportidx",datagrid1.valueMatrix(row,17)); //지원단위
						model.setValue("/root/reqData/reqform/useoriginal",datagrid1.valueMatrix(row,18)); //원금사용여부
						model.setValue("/root/reqData/reqform/purposememo",datagrid1.valueMatrix(row,19)); //모금메모	
						model.setValue("/root/reqData/reqform/paymethod",datagrid1.valueMatrix(row,20)); //자산형태
						model.setValue("/root/reqData/reqform/paymethodcode",datagrid1.valueMatrix(row,21)); //납입방법
						model.setValue("/root/reqData/reqform/bankownerclsf",datagrid1.valueMatrix(row,38)); //
						model.setValue("/root/reqData/reqform/bankowneridentity",datagrid1.valueMatrix(row,39));
						model.setValue("/root/reqData/reqform/bankcode",datagrid1.valueMatrix(row,35));
						model.setValue("/root/reqData/reqform/bankaccount",datagrid1.valueMatrix(row,36));
						model.setValue("/root/reqData/reqform/bankaccountowner",datagrid1.valueMatrix(row,37));
						model.setValue("/root/reqData/reqform/partitiontype",datagrid1.valueMatrix(row,23));
						model.setValue("/root/reqData/reqform/excludenopay",datagrid1.valueMatrix(row,29));
						model.setValue("/root/reqData/reqform/monthlypayday",datagrid1.valueMatrix(row,27));
						model.setValue("/root/reqData/reqform/monthlypayprice",datagrid1.valueMatrix(row,28));
						model.setValue("/root/reqData/reqform/partitioncount",datagrid1.valueMatrix(row,26));
						model.setValue("/root/reqData/reqform/paystartdate",datagrid1.valueMatrix(row,24));
						model.setValue("/root/reqData/reqform/payenddate",datagrid1.valueMatrix(row,25));
						model.setValue("/root/reqData/reqform/cmsstatus",datagrid1.valueMatrix(row,40));
						model.setValue("/root/reqData/reqform/proofname",datagrid1.valueMatrix(row,41));
						model.setValue("/root/reqData/reqform/prooftype",datagrid1.valueMatrix(row,42));
						model.setValue("/root/reqData/reqform/promiseidx",datagrid1.valueMatrix(row,10));
						model.setValue("/root/reqData/reqform/stopdate",datagrid1.valueMatrix(row,44));
						model.setValue("/root/reqData/reqform/stopresn",datagrid1.valueMatrix(row,45));
						model.setValue("/root/reqData/reqform/itemname",datagrid1.valueMatrix(row,31));
						model.setValue("/root/reqData/reqform/itemqty",datagrid1.valueMatrix(row,32));
						model.setValue("/root/reqData/reqform/itemprice",datagrid1.valueMatrix(row,33));
						model.setValue("/root/reqData/reqform/itemremk",datagrid1.valueMatrix(row,34));
						model.setValue("/root/reqData/reqform/mobiaprvname",datagrid1.valueMatrix(row,49));
						model.setValue("/root/reqData/reqform/mobiaprvcmpy",datagrid1.valueMatrix(row,50));
						model.setValue("/root/reqData/reqform/mobiaprvnumber",datagrid1.valueMatrix(row,51));
						model.setValue("/root/reqData/reqform/mobiaprvprn",datagrid1.valueMatrix(row,52));
						model.setValue("/root/reqData/reqform/memberidx",datagrid1.valueMatrix(row,11));
						
						model.setValue("/root/reqData/reqform/cardcmpy",datagrid1.valueMatrix(row,46));
						model.setValue("/root/reqData/reqform/cardnumber",datagrid1.valueMatrix(row,47));
						model.setValue("/root/reqData/reqform/cardyymm",datagrid1.valueMatrix(row,48));
						model.setValue("/root/reqData/reqform/cardidentity",datagrid1.valueMatrix(row,56));
						model.setValue("/root/reqData/reqform/cardowner",datagrid1.valueMatrix(row,57));
						
						set_PayCase();
						if(datagrid1.valueMatrix(row,42) ==""){
							cms_btn1.visible = true;
							cms_btn2.visible = false;
						}else{
							cms_btn1.visible = false;
							cms_btn2.visible = true;	
							model.send("tn_dns_1060_l");
						}
						ctrl_promise_btn("U");
						
						if(datagrid1.valueMatrix(row,3) != ""){
							alert
							group5.visible = true;
							PID1700button25.visible = false;
							PID1700button25_1.visible = true;
						}else{
							group5.visible = false;
							PID1700button25.visible = true;
							PID1700button25_1.visible = false;
						}
						promise_bnkidentity();
						btn_cms_stopped();
						set_partitontype();
						ctrl_btn_payment("I");
						model.refresh();
					]]>
				</script>
			</datagrid>
			<caption id="PID1700caption16" class="list_cap02" style="left:9.26%; top:43.13%; width:24.30%; height:7.94%; text-align:left; "/>
			<input id="promisedate" ref="/root/reqData/reqform/promisedate" navindex="46" inputtype="date" style="left:9.80%; top:44.41%; width:13.42%; height:18px; "/>
			<caption id="PID1700caption24" class="list_cap03" style="left:0.67%; top:66.47%; width:8.72%; height:7.94%; text-align:left; border-left-color:#ff0000; border-top-color:#ff0000; border-bottom-color:#ff0000; border-left-width:2px; border-top-width:2px; border-bottom-width:2px; ">약정금액</caption>
			<input id="promiseprice" ref="/root/reqData/reqform/promiseprice" navindex="54" format="(-)#,###" style="left:9.80%; top:67.65%; width:11.01%; height:18px; text-align:right; "/>
			<caption id="PID1700caption26" style="left:21.34%; top:67.35%; width:2.01%; height:6.18%; font-weight:bold; ">원</caption>
			<select id="paystopped" ref="/root/reqData/reqform/paystopped" navindex="52" overflow="visible" appearance="full" style="left:69.13%; top:60.00%; width:12.35%; height:4.69%; border-style:none; ">
				<choices>
					<item>
						<label>납입일시중단</label>
						<value>1</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[						
						alert("납입일시중단을 설정할 경우 1. CMS 납입대상자, 2. 미납자 목록, 3. 급여공제, 4. 납입스케쥴 검색에서 제외됩니다.");
					]]>
				</script>
			</select>
			<caption id="PID1700caption48" class="list_cap03" style="left:58.79%; top:43.13%; width:10.74%; height:15.31%; text-align:left; ">약정메모</caption>
			<textarea id="PID1700textarea2" ref="/root/reqData/reqform/promisememo" navindex="49" imemode="hangul" caption="비고" style="left:69.93%; top:44.69%; width:18.12%; height:12.50%; vertical-align:top; "/>
			<caption id="PID1700caption56" class="list_cap02" style="left:9.26%; top:35.63%; width:89.40%; height:7.81%; text-align:left; "/>
			<caption id="PID1700caption58" class="list_cap03" style="left:0.67%; top:35.63%; width:8.72%; height:7.81%; text-align:left; ">기금</caption>
			<caption id="PID1700caption59" class="list_cap03" style="left:58.79%; top:35.63%; width:10.74%; height:7.81%; text-align:left; ">원금사용여부</caption>
			<caption id="PID1700caption61" class="list_cap03" visibility="hidden" style="left:89.93%; top:36.88%; width:2.82%; height:5.31%; text-align:left; ">모금목적메모</caption>
			<textarea id="PID1700textarea3" ref="/root/reqData/reqform/purposememo" visibility="hidden" imemode="hangul" caption="비고" style="left:93.29%; top:36.25%; width:4.70%; height:6.88%; vertical-align:top; "/>
			<caption id="subtitle" class="tit02" style="left:0.00%; top:0.00%; width:8.05%; height:6.25%; ">약정</caption>
			<caption id="PID1700caption52" class="list_cap03" style="left:30.47%; top:35.63%; width:8.72%; height:7.81%; text-align:left; ">지원단위</caption>
			<caption id="PID1700caption17" class="list_cap03" style="left:30.47%; top:43.13%; width:8.72%; height:15.29%; text-align:left; ">
				<![CDATA[기부자
한마디]]>
			</caption>
			<textarea id="PID1700textarea1" ref="/root/reqData/reqform/contributormemo" navindex="48" imemode="hangul" caption="비고" style="left:39.60%; top:44.71%; width:18.12%; height:12.65%; vertical-align:top; "/>
			<select1 id="PID1700combo6" ref="/root/reqData/reqform/fundidx" navindex="43" appearance="minimal" style="left:9.80%; top:36.56%; width:18.12%; height:5.63%; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/tn_dns_1000_m/dataSet/FUND_LIST/record">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</select1>
			<select1 id="PID1700combo7" ref="/root/reqData/reqform/supportidx" navindex="44" appearance="minimal" style="left:39.60%; top:36.56%; width:18.12%; height:5.63%; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/tn_dns_1000_m/dataSet/SUPPORT_LIST/record">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</select1>
			<select1 id="PID1700combo8" ref="/root/reqData/reqform/useoriginal" navindex="45" appearance="minimal" style="left:69.93%; top:36.88%; width:18.12%; height:5.63%; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/tn_dns_1000_m/dataSet/USEORIGINAL_LIST/record">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</select1>
			<select1 id="paymethod" ref="/root/reqData/reqform/paymethod" navindex="47" appearance="minimal" style="left:9.80%; top:51.76%; width:13.42%; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/tn_dns_1000_m/dataSet/PAYMETHOD_LIST/record">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var pay_method = paymethod.value;
						var pay_method_code1 = PID1700combo11.value;
						var pay_method_code2 = PID1700combo12.value;
						if(pay_method == "M"){
							PID1700combo11.visible = true;
							PID1700combo12.visible = false;					
						}else{
							PID1700combo11.visible = false;
							PID1700combo12.visible = true;
						}
						set_PayCase();
					]]>
				</script>
			</select1>
			<caption id="PID1700caption62" class="list_cap03" style="left:0.67%; top:58.24%; width:8.72%; height:7.94%; text-align:left; ">납입방법</caption>
			<select1 id="PID1700combo11" ref="/root/reqData/reqform/paymethodcode" navindex="50" appearance="minimal" style="left:9.93%; top:59.41%; width:18.12%; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/tn_dns_1000_m/dataSet/PAYMETHOD_M_LIST/record">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						set_PayCase();
					]]>
				</script>
			</select1>
			<caption id="PID1700caption97" class="list_cap03" style="left:30.47%; top:58.24%; width:8.72%; height:7.81%; text-align:left; ">분납방식</caption>
			<select1 id="PID1700combo14" ref="/root/reqData/reqform/partitiontype" navindex="51" appearance="minimal" style="left:39.60%; top:59.41%; width:18.12%; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/tn_dns_1000_m/dataSet/PARTITIONTYPE_LIST/record">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						set_partitontype();			
					]]>
				</script>
			</select1>
			<caption id="PID1700caption90" style="left:23.62%; top:67.06%; width:4.70%; height:6.18%; font-weight:bold; color:#000000; ">매월</caption>
			<select id="PID1700checkbox6" ref="/root/reqData/reqform/excludenopay" navindex="53" overflow="visible" appearance="full" style="left:82.55%; top:59.69%; width:15.44%; height:4.69%; border-style:none; ">
				<choices>
					<item>
						<label>월별미납목록제외</label>
						<value>1</value>
					</item>
				</choices>
			</select>
			<caption id="PID1700caption93" style="left:32.35%; top:67.06%; width:2.01%; height:6.18%; font-weight:bold; color:#000000; ">일</caption>
			<caption id="PID1700caption98" style="left:42.68%; top:67.06%; width:2.28%; height:6.18%; font-weight:bold; color:#000000; ">원</caption>
			<caption id="PID1700caption99" style="left:57.72%; top:67.06%; width:2.28%; height:6.18%; font-weight:bold; color:#000000; ">회</caption>
			<input id="paystartdate" ref="/root/reqData/reqform/paystartdate" navindex="58" inputtype="date" style="left:71.14%; top:67.35%; width:12.08%; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var times = partitioncount.value;
						if(monthlypayprice.value != "" && partitioncount.value !=""){
							promiseprice.value = monthlypayprice.value * partitioncount.value;
							var paystartdate = model.getValue("/root/reqData/reqform/paystartdate");
							if (Number(paystartdate.substring(6)) < Number(times)){
								times = times-1;
							}			
							paystartdate = paystartdate.substring(0,6)+monthlypayday.value;  //20170104 봉은정추가
							payenddate.value = dateAdd("m", Number(times),  paystartdate).substring(0,6)+monthlypayday.value;
							model.refresh();
						}
					]]>
				</script>
			</input>
			<output id="payenddate" ref="/root/reqData/reqform/payenddate" format="yyyy-mm-dd" inputtype="date" style="left:85.23%; top:67.35%; width:12.35%; height:18px; "/>
			<caption id="PID1700caption100" style="left:45.23%; top:67.06%; width:8.19%; height:6.18%; font-weight:bold; color:#000000; ">분납횟수</caption>
			<caption id="PID1700caption101" style="left:60.13%; top:67.06%; width:12.21%; height:6.18%; font-weight:bold; color:#000000; ">납입예정기간</caption>
			<input id="partitioncount" ref="/root/reqData/reqform/partitioncount" navindex="57" style="left:52.75%; top:67.35%; width:4.70%; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(monthlypayprice.value != "" && partitioncount.value !=""){
							var times = partitioncount.value;
							promiseprice.value = monthlypayprice.value * partitioncount.value;
							var paystartdate = model.getValue("/root/reqData/reqform/paystartdate");
							if (Number(paystartdate.substring(6))  < monthlypayday.value){
								times = times-1;
							}	
							paystartdate = paystartdate.substring(0,6)+monthlypayday.value;  //20170104 봉은정추가
							payenddate.value = dateAdd("m", Number(times),  paystartdate).substring(0,6)+monthlypayday.value;
							model.refresh();
							
						}
					]]>
				</script>
			</input>
			<switch id="PID1700switch1" style="left:0.67%; top:74.41%; width:98.66%; height:16.76%; border-left-color:#ff0000; border-style:none; ">
				<case id="case1" style="left:0px; top:0px; width:100.00%; height:100.00%; ">
					<caption id="PID1700caption112" class="list_cap02" style="left:8.59%; top:42.11%; width:90.75%; height:43.86%; text-align:left; "/>
					<caption id="PID1700caption111" class="list_cap02" style="left:8.59%; top:0.00%; width:90.75%; height:43.86%; text-align:left; "/>
					<input id="PID1700input42" ref="/root/reqData/reqform/bankaccount" navindex="67" style="left:39.32%; top:49.12%; width:18.12%; height:31.58%; "/>
					<select1 id="bankownerclsf" ref="/root/reqData/reqform/bankownerclsf" navindex="64" appearance="full" cols="2" overflow="visible" style="left:12.79%; top:7.02%; width:12.24%; height:28.07%; border-style:none; ">
						<choices>
							<item>
								<label>본인</label>
								<value>1</value>
							</item>
							<item>
								<label>타인</label>
								<value>2</value>
							</item>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								promise_bnkidentity();
							]]>
						</script>
					</select1>
					<caption id="PID1700caption109" class="list_cap03" style="left:0.00%; top:0.00%; width:12.24%; height:43.86%; text-align:left; ">예금주본인여부</caption>
					<caption id="PID1700caption110" class="list_cap03" style="left:30.20%; top:42.11%; width:8.72%; height:43.86%; text-align:left; ">계좌번호</caption>
					<select1 id="PID1700combo16" ref="/root/reqData/reqform/bankcode" navindex="66" appearance="minimal" style="left:9.39%; top:49.12%; width:16.05%; height:31.58%; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/tn_dns_1000_m/dataSet/BANK_LIST/record">
								<label ref="cdnm"/>
								<value ref="cd"/>
							</itemset>
						</choices>
					</select1>
					<caption id="PID1700caption91" class="list_cap03" visibility="visible" style="left:58.91%; top:0.00%; width:8.71%; height:43.86%; text-align:left; ">CMS상태</caption>
					<caption id="PID1700caption103" class="list_cap03" style="left:0.00%; top:42.11%; width:8.72%; height:43.86%; text-align:left; ">은행</caption>
					<button id="cms_btn1" class="btn05" navindex="71" visibility="hidden" style="left:82.99%; top:47.37%; width:15.65%; height:36.84%; text-align:center; ">
						<caption>CMS증빙자료 업로드</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
									visible_grp_upload = !visible_grp_upload;
									grp_upload.visible = visible_grp_upload;
								]]>
						</script>
					</button>
					<button id="cms_btn2" class="btn05" navindex="73" visibility="hidden" style="left:82.99%; top:47.37%; width:15.65%; height:36.84%; text-align:center; ">
						<caption>CMS증빙자료 보기</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[									
									visible_grp_upload = !visible_grp_upload;
									grp_upload.visible = visible_grp_upload;
									if(model.getValue("/root/reqData/reqform/prooftype") =="4"){
										img1.visible = false;
									}else{
										img1.visible = true;
									}
								]]>
						</script>
					</button>
					<caption id="PID1700caption85" class="list_cap03" style="left:58.91%; top:42.11%; width:8.72%; height:43.86%; text-align:left; ">예금주</caption>
					<input id="PID1700input9" ref="/root/reqData/reqform/bankaccountowner" navindex="68" style="left:68.03%; top:49.12%; width:10.48%; height:31.58%; "/>
					<button id="PID1700button2" class="btn02" visibility="hidden" style="left:91.84%; top:0.00%; width:6.80%; height:21px; color:#ffffff; ">
						<caption>upload</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
								visible_grp_upload = !visible_grp_upload;
								grp_upload.visible = visible_grp_upload;
							]]>
						</script>
					</button>
					<button id="cms_stop" class="btn03" navindex="83" visibility="hidden" style="left:89.80%; top:3.51%; width:8.84%; height:21px; ">
						<caption>CMS해지</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
								if(promise_cms_status() == false){
								}else{
									cms_cncl();
								}
								]]>
						</script>
					</button>
					<caption id="PID1700caption87" class="list_cap03" visibility="visible" style="left:30.20%; top:0.00%; width:8.72%; height:43.86%; font-size:11px; text-align:left; ">주민번호앞자리</caption>
					<input id="bankowneridentity" ref="/root/reqData/reqform/bankowneridentity" navindex="65" visibility="visible" style="left:39.32%; top:5.26%; width:18.10%; height:18px; "/>
					<caption id="PID1700caption86" class="list_cap03" visibility="hidden" style="left:83.67%; top:0.00%; width:3.13%; height:43.86%; text-align:left; ">CMS증빙자료</caption>
					<input id="PID1700input48" ref="/root/reqData/reqform/filename" visibility="hidden" style="left:89.80%; top:0.00%; width:1.36%; height:18px; "/>
					<select1 id="PID1700combo15" ref="/root/reqData/reqform/cmsstatus" disabled="true" visibility="visible" appearance="minimal" style="left:68.03%; top:5.26%; width:14.29%; height:18px; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/tn_dns_1000_m/dataSet/CMS_STATUS_LIST/record">
								<label ref="cdnm"/>
								<value ref="cd"/>
							</itemset>
						</choices>
					</select1>
					<select1 id="PID1700combo17" visibility="hidden" appearance="minimal" style="left:87.76%; top:0.00%; width:1.50%; height:18px; ">
						<choices>
							<item>
								<label>서면</label>
								<value>1</value>
							</item>
							<item>
								<label>전자문서-공인전자서명</label>
								<value>2</value>
							</item>
							<item>
								<label>전자문서-일반전자서명</label>
								<value>3</value>
							</item>
							<item>
								<label>녹취</label>
								<value>4</value>
							</item>
							<item>
								<label>ARS</label>
								<value>5</value>
							</item>
						</choices>
					</select1>
					<caption id="PID1700caption119" class="list_cap03" visibility="hidden" style="left:30.20%; top:0.00%; width:8.72%; height:43.86%; font-size:10px; text-align:left; ">
						<![CDATA[주민번호앞자리/사업자번호]]>
					</caption>
					<button id="cencel_cms_stop" class="btn03" navindex="76" visibility="hidden" style="left:89.80%; top:3.51%; width:8.84%; height:21px; ">
						<caption>CMS해지취소</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
								if(promise_cms_status() == false){
								}else{
									cms_cncl();
								}
								]]>
						</script>
					</button>
				</case>
				<case id="case2">
					<caption id="PID1700caption104" class="list_cap02" style="left:8.59%; top:42.11%; width:90.75%; height:43.86%; text-align:left; "/>
					<caption id="PID1700caption102" class="list_cap02" style="left:8.59%; top:0.00%; width:90.75%; height:43.86%; text-align:left; "/>
					<input id="PID1700input13" ref="/root/reqData/reqform/itemname" style="left:9.25%; top:7.02%; width:16.05%; height:31.58%; "/>
					<caption id="PID1700caption94" class="list_cap03" style="left:0.00%; top:0.00%; width:8.72%; height:43.86%; text-align:left; ">품명</caption>
					<caption id="PID1700caption95" class="list_cap03" style="left:30.20%; top:0.00%; width:8.72%; height:43.86%; text-align:left; ">수량</caption>
					<caption id="PID1700caption105" class="list_cap03" style="left:0.00%; top:42.11%; width:8.72%; height:43.86%; text-align:left; ">단가</caption>
					<caption id="PID1700caption114" class="list_cap03" style="left:30.20%; top:42.11%; width:8.72%; height:43.86%; text-align:left; ">메모</caption>
					<input id="PID1700input41" ref="/root/reqData/reqform/itemprice" style="left:9.25%; top:47.37%; width:16.05%; height:31.58%; "/>
					<input id="PID1700input44" ref="/root/reqData/reqform/itemqty" style="left:39.46%; top:5.26%; width:16.05%; height:31.58%; "/>
					<input id="PID1700input45" ref="/root/reqData/reqform/itemremk" style="left:39.59%; top:49.12%; width:57.01%; height:18px; "/>
				</case>
				<case id="case3">
					<caption id="PID1700caption115" class="list_cap02" style="left:8.59%; top:0.00%; width:90.75%; height:43.86%; text-align:left; "/>
					<caption id="PID1700caption96" class="list_cap03" style="left:0.00%; top:0.00%; width:8.72%; height:43.86%; text-align:left; ">카드사명</caption>
					<caption id="PID1700caption117" class="list_cap03" style="left:30.20%; top:0.00%; width:8.72%; height:43.86%; text-align:left; ">카드번호</caption>
					<caption id="PID1700caption122" class="list_cap03" style="left:69.39%; top:0.00%; width:14.29%; height:43.86%; text-align:left; ">유효기간(yy-mm)</caption>
					<input id="PID1700input27" ref="/root/reqData/reqform/cardnumber" style="left:39.32%; top:7.02%; width:28.57%; height:31.58%; "/>
					<input id="PID1700input28" ref="/root/reqData/reqform/cardyymm" format="yy-mm" style="left:84.90%; top:7.02%; width:13.61%; height:18px; "/>
					<caption id="caption4" class="list_cap02" style="left:8.57%; top:42.11%; width:90.75%; height:43.86%; text-align:left; "/>
					<caption id="caption3" class="list_cap03" style="left:0.00%; top:42.11%; width:16.87%; height:43.86%; text-align:left; ">카드소유주별식별번호</caption>
					<caption id="caption7" class="list_cap03" style="left:30.20%; top:42.11%; width:8.71%; height:43.86%; text-align:left; ">카드소유주</caption>
					<input id="input2" ref="/root/reqData/reqform/cardidentity" style="left:17.14%; top:47.37%; width:12.79%; height:31.58%; "/>
					<input id="input3" ref="/root/reqData/reqform/cardowner" style="left:39.59%; top:49.12%; width:13.61%; height:31.58%; "/>
					<input id="input1" ref="/root/reqData/reqform/cardcmpy" style="left:9.39%; top:7.02%; width:13.61%; height:18px; "/>
				</case>
				<case id="case4">
					<caption id="PID1700caption44" class="list_cap02" style="left:8.59%; top:0.00%; width:90.75%; height:43.86%; text-align:left; "/>
					<caption id="PID1700caption43" class="list_cap03" style="left:0.00%; top:0.00%; width:8.72%; height:43.86%; text-align:left; ">납입계좌</caption>
					<select1 id="PID1700combo19" ref="/root/reqData/reqform/bankaccount" appearance="minimal" style="left:9.39%; top:7.02%; width:24.63%; height:31.58%; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/tn_dns_1000_m/dataSet/ACCOUNT_LIST/record">
								<label ref="cdnm"/>
								<value ref="cd"/>
							</itemset>
						</choices>
					</select1>
				</case>
				<case id="case5">
					<caption id="PID1700caption106" class="list_cap02" style="left:8.59%; top:0.00%; width:90.75%; height:43.86%; text-align:left; "/>
					<caption id="PID1700caption84" class="list_cap03" style="left:0.00%; top:0.00%; width:8.72%; height:43.86%; text-align:left; ">통신사</caption>
					<caption id="PID1700caption108" class="list_cap03" style="left:30.20%; top:0.00%; width:8.72%; height:43.86%; text-align:left; ">결제자</caption>
					<caption id="PID1700caption116" class="list_cap02" style="left:8.59%; top:42.11%; width:90.75%; height:43.86%; text-align:left; "/>
					<caption id="PID1700caption118" class="list_cap03" style="left:0.00%; top:42.11%; width:8.72%; height:43.86%; text-align:left; ">휴대번호</caption>
					<caption id="PID1700caption113" class="list_cap03" style="left:30.20%; top:42.11%; width:8.72%; height:43.86%; text-align:left; ">식별번호</caption>
					<input id="PID1700input31" ref="/root/reqData/reqform/mobiaprvcmpy" visibility="hidden" style="left:9.52%; top:7.02%; width:13.61%; height:31.58%; "/>
					<input id="PID1700input33" ref="/root/reqData/reqform/mobiaprvname" style="left:39.73%; top:7.02%; width:13.61%; height:31.58%; ">
						<script type="javascript" ev:event="DOMFocusIn">
							<![CDATA[
							var name =model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/mbr_name");
							model.setValue("/root/reqData/reqform/mobiaprvname",name);
							PID1700input33.refresh();
							]]>
						</script>
					</input>
					<input id="PID1700input49" ref="/root/reqData/reqform/mobiaprvnumber" style="left:9.52%; top:47.37%; width:13.61%; height:31.58%; ">
						<script type="javascript" ev:event="DOMFocusIn">
							<![CDATA[
							var mobiaprvnumber =model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/cellphone");
							model.setValue("/root/reqData/reqform/mobiaprvnumber",mobiaprvnumber.replace(/-/ig, ""));
							PID1700input49.refresh();
							]]>
						</script>
					</input>
					<input id="PID1700input50" ref="/root/reqData/reqform/mobiaprvprn" maxlength="7" style="left:39.73%; top:49.12%; width:13.61%; height:31.58%; ">
						<script type="javascript" ev:event="DOMFocusIn">
							<![CDATA[
							var reg_no = model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/mbr_regno").substring(0,7);
							model.setValue("/root/reqData/reqform/mobiaprvprn",reg_no);
							PID1700input50.refresh();
							]]>
						</script>
					</input>
					<select1 id="combo2" ref="/root/reqData/reqform/mobiaprvcmpy" appearance="minimal" style="left:9.52%; top:7.02%; width:13.61%; height:31.58%; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/tn_dns_1000_m/dataSet/MOBLCMPY_LIST/record">
								<label ref="cdnm"/>
								<value ref="cd"/>
							</itemset>
						</choices>
					</select1>
					<button id="button4" class="btn04" navindex="61" visibility="hidden" style="left:87.89%; top:3.51%; width:10.34%; height:21px; ">
						<caption>모바일해지신청</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[		
								var promiseidx = datagrid1.valueMatrix(datagrid1.row,10);
								if(promiseidx == ""){
									alert("약정 선택 후 수정하세요."); return;
								};		
						
								var mobi_promiseidx ="";
								var pay_type = model.getValue("/root/reqData/reqform/paymethodcode");
								
								if(show_message("모바일해지신청을 하시겠습니까?", "확인", MB_YESNO) != IDYES) {
									return false;
								}
								
								mobi_promiseidx = model.getValue("/root/reqData/reqform/promiseidx");
								if(pay_type =="M004" ){  //삭제시에 6090 먼저 실행
									mobi_promiseidx = model.getValue("/root/reqData/reqform/promiseidx");
									set_refvalue("/root/reqData/aplcForm/cmpy_cd", 	  getProperty("ss_cmpycd"));
									set_refvalue("/root/reqData/aplcForm/aplcclsf",   "D");
									set_refvalue("/root/reqData/aplcForm/promiseidx", mobi_promiseidx);
									model.send("tn_lnk_6090_a");
									return;
								}
							]]>
						</script>
					</button>
				</case>
				<case id="case_reset" selected="true"/>
			</switch>
			<select1 id="monthlypayday" ref="/root/reqData/reqform/monthlypayday" navindex="55" appearance="minimal" style="left:27.25%; top:67.65%; width:4.97%; height:18px; text-align:left; ">
				<choices>
					<item>
						<label>05</label>
						<value>05</value>
					</item>
					<item>
						<label>10</label>
						<value>10</value>
					</item>
					<item>
						<label>25</label>
						<value>25</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(monthlypayprice.value != "" && partitioncount.value !=""){
							var times = partitioncount.value;
							promiseprice.value = monthlypayprice.value * partitioncount.value;
							var paystartdate = model.getValue("/root/reqData/reqform/paystartdate");
							if (Number(paystartdate.substring(6))  <monthlypayday.value){
								times = times-1;
							}	
							paystartdate = paystartdate.substring(0,6)+monthlypayday.value;  //20170104 봉은정추가
							payenddate.value = dateAdd("m", Number(times),  paystartdate).substring(0,6)+monthlypayday.value;
							model.refresh();
						}
					]]>
				</script>
			</select1>
			<input id="monthlypayprice" ref="/root/reqData/reqform/monthlypayprice" navindex="56" format="(-)#,###" style="left:34.36%; top:67.35%; width:8.05%; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(partitioncount.value !=""){
							promiseprice.value = monthlypayprice.value * partitioncount.value;							
							model.refresh();
						}
					]]>
				</script>
			</input>
			<select1 id="PID1700combo12" ref="/root/reqData/reqform/paymethodcode" navindex="50" visibility="hidden" appearance="minimal" style="left:9.93%; top:59.41%; width:11.14%; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/tn_dns_1000_m/dataSet/PAYMETHOD_G_LIST/record">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						set_PayCase();
					]]>
				</script>
			</select1>
			<caption id="PID1700caption32" style="left:83.36%; top:67.50%; width:2.01%; height:5.00%; font-weight:bold; color:#333399; ">~</caption>
			<caption id="PID1700caption55" class="list_cap03" style="left:0.67%; top:50.63%; width:8.72%; height:7.81%; text-align:left; ">자산형태</caption>
			<group id="group5" visibility="hidden" style="left:0.67%; top:89.41%; width:98.66%; height:9.41%; ">
				<caption id="PID1700caption92" class="list_cap02" style="left:8.59%; top:0.00%; width:90.75%; height:78.13%; text-align:left; "/>
				<input id="PID1700input17" ref="/root/reqData/reqform/stopdate" inputtype="date" style="left:9.25%; top:9.38%; width:13.61%; height:56.25%; "/>
				<input id="PID1700input19" ref="/root/reqData/reqform/stopresn" style="left:39.46%; top:9.38%; width:25.58%; height:56.25%; "/>
				<caption id="PID1700caption88" class="list_cap03" style="left:30.20%; top:0.00%; width:8.72%; height:78.13%; text-align:left; ">해약사유</caption>
				<caption id="PID1700caption89" class="list_cap03" style="left:0.00%; top:0.00%; width:8.72%; height:78.13%; text-align:left; ">해약일자</caption>
			</group>
			<caption id="PID1700caption22" class="list_cap03" style="left:0.67%; top:43.13%; width:8.72%; height:7.81%; text-align:left; ">약정일자</caption>
		</group>
		<input id="name" ref="/root/reqData/searchData/tn_dns_1010_l/name" visibility="visible" style="left:18.67%; top:6.46%; width:8.33%; height:18px; background-color:#cce5fe; ">
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if(event.keycode == "13"){
						var select_name = name.currentText.toUpperCase();
						model.setValue("/root/reqData/searchData/tn_dns_1010_l/name",select_name);
						select_mbr(select_name);
					}
				]]>
			</script>
		</input>
		<button id="btn_select" class="btn02" visibility="visible" style="left:27.42%; top:6.22%; width:4.33%; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[					
					var select_name = model.getValue("/root/reqData/searchData/tn_dns_1010_l/name").toUpperCase();
					select_mbr(select_name);
				]]>
			</script>
		</button>
		<button id="PID1700button3" class="btn02" style="left:83.75%; top:0.98%; width:4.33%; height:2.56%; background-stretch:stretch; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					//model.copyNode("/root/nodetmp","/root/resData/gridData/tn_dns_1020_l/dataSet");
					model1.reset();
					//tn_dns_1000
					//model1.copyNode("/root/initData/pageInfo",parent.root.initData.pageInfo);
					group5.visible = false;
					model1.toggle("case_reset");
					//model.reset();
					model.refresh();
				]]>
			</script>
		</button>
		<button id="button1" class="btn02" navindex="69" visibility="hidden" style="left:49.50%; top:6.22%; width:4.17%; height:21px; ">
			<caption>회원입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						model.setValue("/root/reqData/tn_dns_1030_a/mode","I");
    					send_tn_dns_1030_a();
					]]>
			</script>
		</button>
		<button id="PID1700button4" class="btn02" navindex="70" style="left:54.00%; top:6.22%; width:4.17%; height:2.56%; ">
			<caption>회원저장</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						if(model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/memberidx") == ""){
							model.setValue("/root/reqData/tn_dns_1030_a/mode","I");
						}else{
							model.setValue("/root/reqData/tn_dns_1030_a/mode","U");
						}						
						send_tn_dns_1030_a();
					]]>
			</script>
		</button>
		<button id="PID1700button7" class="btn02" navindex="74" style="left:58.50%; top:6.22%; width:4.17%; height:2.56%; ">
			<caption>회원삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						if(model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/memberidx") == ""){
							alert("회원 조회 후 삭제할 수 있습니다.");
							return;
						}
						if(model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST2/totalcnt") > 0){
							alert("약정내역이 있어 회원 삭제를 할 수 없습니다.");
							return;
						}
						model.setValue("/root/reqData/tn_dns_1030_a/mode","D");
						send_tn_dns_1030_a();						
					]]>
			</script>
		</button>
		<button id="promise_insert" class="btn02" navindex="72" visibility="hidden" style="left:49.50%; top:55.85%; width:4.17%; height:21px; ">
			<caption>약정입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						model.setValue("/root/reqData/reqform/mode","I");
    					send_tn_dns_1040_a();
					]]>
			</script>
		</button>
		<button id="promise_edit" class="btn02" navindex="60" style="left:49.50%; top:55.85%; width:4.17%; height:21px; ">
			<caption>약정수정</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						model.setValue("/root/reqData/reqform/mode","U");
						var promiseidx = datagrid1.valueMatrix(datagrid1.row,10);
						if(promiseidx == ""){
							alert("약정 선택 후 수정하세요."); return;
						}				
						if(datagrid1.valueMatrix(datagrid1.row,3) != ""){
							alert("약정 해지상태이므로 수정이 불가능합니다."); return;
						}					
						model.setValue("/root/reqData/reqform/promiseidx",promiseidx);
						send_tn_dns_1040_a();
					]]>
			</script>
		</button>
		<button id="PID1700button10" class="btn02" navindex="62" style="left:58.50%; top:55.85%; width:4.17%; height:21px; ">
			<caption>약정삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						model.setValue("/root/reqData/reqform/mode","D");
						var promisecode = datagrid1.valueMatrix(datagrid1.row,1);
						if(promisecode == ""){
							alert("약정 선택 후 수정하세요."); return;
						}
						for (var i=1; i<datagrid2.rows; i++){
							if (datagrid2.valueMatrix(i,datagrid2.colRef("promisecode")) == promisecode){			
								alert("해당 약정에 납입 내역이 존재하므로 약정 삭제가 불가능합니다."); return;
							}
						}
						send_tn_dns_1040_a();
					]]>
			</script>
		</button>
		<button id="PID1700button14" class="btn02" navindex="59" style="left:44.92%; top:55.85%; width:4.17%; height:21px; ">
			<caption>약정추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						if(memberidx.value == ""){
							alert("회원 조회 후 약정 추가가 가능합니다."); return;
						}
						grp_upload.visible = false;		
						ctrl_promise_btn("I");		
						reset_promise();
						btn_cms_stopped();
						promisedate.value = commCurDate();						
						model.setValue("/root/reqData/reqform/paymethod","M");
						paystartdate.value = commCurDate();
						model.setValue("/root/reqData/reqform/bankownerclsf","1");
						var reg = model.getValue("/root/resData/gridData/tn_dns_1020_l/dataSet/CURLIST1/record/mbr_regno").substring(0,6);
						model.setValue("/root/reqData/reqform/bankowneridentity",reg);
						model.toggle("case_reset");
						model.refresh();
					]]>
			</script>
		</button>
		<button id="PID1700button23" class="btn02" visibility="hidden" style="left:70.42%; top:1.22%; width:4.33%; height:2.56%; ">
			<caption>상세조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					
				]]>
			</script>
		</button>
		<button id="PID1700button25" class="btn02" navindex="61" style="left:54.00%; top:55.85%; width:4.17%; height:21px; ">
			<caption>약정해지</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[						
						if(promise_cms_status() == false){
						}else{
							ctrl_promise_cncl_btn();
						}
					]]>
			</script>
		</button>
		<button id="PID1700button25_1" class="btn02" navindex="61" visibility="hidden" style="left:54.00%; top:55.85%; width:4.17%; height:21px; ">
			<caption>해지취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[		
						if(promise_cms_status() == false){
						}else{
							ctrl_promise_cncl_btn();
						}
					]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
