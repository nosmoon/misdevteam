<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 선택계열의 정보를 담당 -->
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<comboSet>
							<xx_job_clsf_02/>
							<xx_budg_cd/>
							<xx_budg_nm/>
							<xx_mang_cd_4/>
							<xx_cd_clsf/>
							<xx_occr_slip_clsf/>
							<mang_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</mang_clsf>
							<note_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</note_clsf>
							<issu_cmpy_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</issu_cmpy_clsf>
							<whco_slip_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</whco_slip_clsf>
							<seq_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</seq_clsf>
						</comboSet>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						<pageInfo>
						</pageInfo>
					</initData>
					<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
					<reqData>
						<!-- 검색조건 처리 -->
						<searchData>
							<chg_dt/>
							<dt_clsf/>
							<seq_clsf/>
							<chg_clsf/>
							<occr_dt/>
							<occr_seq/>
							<dlco_ern/>
							<dlco_no/>
							<dlco_nm/>
							<rcpm_dt_fr/>
							<rcpm_dt_to/>
							<remk/>
						</searchData>
						<!-- 등록/수정/삭제 요청 Form Data -->
						<reqForm>
							<budg_cd/>
						</reqForm>
						<!-- MultiUpDate유형 사용시 처리 -->
						<multiUpDate>
							<mst_mode/>
							<rcpm_dt/>
							<occr_dt/>
							<occr_seq/>
							<rcpm_shet_no/>
							<rcpm_shet_kind/>
							<actu_slip/>
							<remk/>
							<dlco_ern/>
							<dlco_nm/>
							<dlco_clsf_cd/>
							<ref_occr_dt/>
							<ref_occr_seq/>
							<cash_sub_seq/>
							<cash_rcpm_amt/>
							<multiUpdateData1/>
							<multiUpdateData2/>
							<multiUpdateData3/>
						</multiUpDate>
						<!-- POPUP 페이지 Forward Data -->
						<fwdData>
							<func_nm/>
							<chg_dt/>
							<occr_seq/>
						</fwdData>
					</reqData>
					<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
					<resData>
						<!-- 전달 받은 리스트 데이터를 담당 ( submit의 결과가 담김) -->
						<gridData1>
							<record>
								<deps_rmtt_dt/>
								<deps_rcpm_amt/>
								<deps_rmtt_plac/>
								<deps_acct_mang_no/>
								<deps_acct_mang_nm/>
								<deps_coms_amt/>
								<deps_sub_seq/>
								<deps_biz_reg_no/>
								<deps_bank_id/>
								<deps_acct_num/>
								<deps_tran_date/>
								<deps_tran_date_seq/>
							</record>
						</gridData1>
						<gridData2>
							<record>
								<note_note_no/>
								<note_rcpm_amt/>
								<note_note_clsf_cd/>
								<note_bank_cd/>
								<note_bank_nm/>
								<note_issu_pers_nm/>
								<note_issu_cmpy_clsf/>
								<note_comp_dt/>
								<note_mtry_dt/>
								<note_rcpm_acct/>
								<note_sale_aprv_no/>
								<note_sub_seq/>
							</record>
						</gridData2>
						<gridData3>
							<record>
								<etc_budg_cd/>
								<etc_budg_nm/>
								<etc_rcpm_amt/>
								<etc_bal_occr_slip_clsf/>
								<etc_bal_occr_slip_no/>
								<etc_sub_seq/>
							</record>
						</gridData3>
						<gridData4>
							<record>
								<rcpm_dt/>
								<remk/>
								<rcpm_tot_amt/>
								<actu_slip/>
								<rcpm_shet_no/>
								<chg_dt/>
								<dlco_nm/>
								<misu_amt/>
								<misu_remk/>
								<occr_dt/>
								<occr_seq/>
								<ref_occr_dt/>
								<ref_occr_seq/>
								<actu_slip_dt/>
								<slip_clsf_cd/>
								<actu_slip_no/>
								<dlco_ern/>
								<dlco_clsf_cd/>
							</record>
						</gridData4>
						<gridData5>
							<record>
								<occr_dt/>
								<occr_seq/>
							</record>
						</gridData5>
						<!-- 전달 받은 Msg를 담당 ( submit의 결과가 담김) -->
						<msg>
							<errCode/>
							<errMsg/>
						</msg>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<popupData>
								<bank_cd/>
								<bank_cd_nm/>
							</popupData>
						</resForm>
					</resData>
					<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
					<tempData>
					</tempData>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					function setDlco_no(iv_dlco_no, iv_dlco_nm){
						model1.setValue("/root/reqData/searchData/dlco_no", iv_dlco_no);
						model1.setValue("/root/reqData/searchData/dlco_nm", iv_dlco_nm);
					
						model1.send("as_com_1100");
						model1.setValue("/root/reqData/searchData/dlco_ern", model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_no"))
						model1.refresh();
					}
					
					function getRcpmTotAmt() {
						var cash_amt = 0;
						if (model1.getValue("/root/reqData/multiUpDate/cash_rcpm_amt") != "")
							cash_amt = parseInt(model1.getValue("/root/reqData/multiUpDate/cash_rcpm_amt"));
							
						var deps_amt = getGrid2TotAmt();
						var note_amt = getGrid3TotAmt();
						var etc_amt  = getGrid4TotAmt();
						opt_rcpm_amt.value = cash_amt + deps_amt + note_amt + etc_amt;
					}
					
					function getGrid2TotAmt() {
						var tot_amt = 0;
						for (i = 1; i < datagrid2.rows; i++) {
							if ((datagrid2.valueMatrix(i, 2) != "") && (datagrid2.rowStatus(i) != 4)) {
								tot_amt += parseInt(datagrid2.valueMatrix(i, 2));
							}
						}
						return tot_amt;
					}
					
					function getGrid3TotAmt() {
						var tot_amt = 0;
						for (i = 1; i < datagrid3.rows; i++) {
							if ((datagrid3.valueMatrix(i, 2) != "") && (datagrid3.rowStatus(i) != 4)) {
								tot_amt += parseInt(datagrid3.valueMatrix(i, 2));
							}
						}
						return tot_amt;
					}
					
					function getGrid4TotAmt() {
						var tot_amt = 0;
						for (i = 1; i < datagrid4.rows; i++) {
							if ((datagrid4.valueMatrix(i, 3) != "") && (datagrid4.rowStatus(i) != 4)) {
								tot_amt += parseInt(datagrid4.valueMatrix(i, 3));
							}
						}
						return tot_amt;
					}
					
					function resetForms() {
						var ref_occr_dt = model1.getValue("/root/reqData/multiUpDate/ref_occr_dt");
						var ref_occr_seq = model1.getValue("/root/reqData/multiUpDate/ref_occr_seq");
						var dlco_ern = model1.getValue("/root/reqData/multiUpDate/dlco_ern");
						var dlco_clsf_cd = model1.getValue("/root/reqData/multiUpDate/dlco_clsf_cd");

						for (i = 0; i < root.reqData.multiUpDate.childNodes.length; i++) {
							model1.setValue(root.reqData.multiUpDate.childNodes(i), "");
						}

						var length = root.resData.gridData1.childNodes.length;
						for (i = 0; i < length; i++)
							model1.removeNodeset("/root/resData/gridData1/record["+(1)+"]");

						length = root.resData.gridData2.childNodes.length;
						for (i = 0; i < length; i++)
							model1.removeNodeset("/root/resData/gridData2/record["+(1)+"]");

						length = root.resData.gridData3.childNodes.length;
						for (i = 0; i < length; i++)
							model1.removeNodeset("/root/resData/gridData3/record["+(1)+"]");

						opt_rcpm_amt.value = "";
						
						model1.refresh();
						
						if (datagrid2.rows == 1) {
							datagrid2.addRow();
							datagrid2.rowStatus(1) = 0;
							datagrid2.isReadOnly(1, 1, 1, 5) = true;
						}

						if (datagrid3.rows == 1) {
							datagrid3.addRow();
							datagrid3.rowStatus(1) = 0;
							datagrid3.isReadOnly(1, 1, 1, 11) = true;
						}
						
						if (datagrid4.rows == 1) {
							datagrid4.addRow();
							datagrid4.rowStatus(1) = 0;
							datagrid4.isReadOnly(1, 1, 1, 5) = true;
						}

						model1.setValue("/root/reqData/multiUpDate/ref_occr_dt", ref_occr_dt);
						model1.setValue("/root/reqData/multiUpDate/ref_occr_seq", ref_occr_seq);
						model1.setValue("/root/reqData/multiUpDate/dlco_ern", dlco_ern);
						model1.setValue("/root/reqData/multiUpDate/dlco_clsf_cd", dlco_clsf_cd);
					}
					
					function setEvntInfo(budg_cd, budg_nm){
						// 예산코드
						if (gstr_popupid == "budg_cd") {
							datagrid4.valueMatrix(datagrid4.row, datagrid4.col) = budg_cd;
							datagrid4.valueMatrix(datagrid4.row, datagrid4.col+1) = budg_nm;
							//model1.setValue("/root/reqData/searchData/budg_cd", Evnt_cd);
							//model1.setValue("/root/reqData/searchData/budg_cd_nm", Evnt_cd_nm);
							model1.refresh();
							//budg_cd.refresh();
							//budg_cd_nm.refresh();
						}
					}
					
					function getRcpmDetailInfo() {
						var selectedIdx = datagrid1.row;
						model1.setValue("/root/reqData/multiUpDate/rcpm_dt", datagrid1.valueMatrix(selectedIdx, 2));
						model1.setValue("/root/reqData/multiUpDate/remk", datagrid1.valueMatrix(selectedIdx, 3));
						model1.setValue("/root/reqData/multiUpDate/actu_slip", datagrid1.valueMatrix(selectedIdx, 5));
						model1.setValue("/root/reqData/multiUpDate/rcpm_shet_no", datagrid1.valueMatrix(selectedIdx, 6));
						model1.setValue("/root/reqData/multiUpDate/occr_dt", datagrid1.valueMatrix(selectedIdx, 11));
						model1.setValue("/root/reqData/multiUpDate/occr_seq", datagrid1.valueMatrix(selectedIdx, 12));
						model1.setValue("/root/reqData/multiUpDate/ref_occr_dt", datagrid1.valueMatrix(selectedIdx, 13));
						model1.setValue("/root/reqData/multiUpDate/ref_occr_seq", datagrid1.valueMatrix(selectedIdx, 14));
						model1.setValue("/root/reqData/multiUpDate/dlco_ern", datagrid1.valueMatrix(selectedIdx, 18));
						model1.setValue("/root/reqData/multiUpDate/dlco_clsf_cd", datagrid1.valueMatrix(selectedIdx, 19));
						
						model1.setValue("/root/reqData/searchData/occr_dt", datagrid1.valueMatrix(selectedIdx, 11));
						model1.setValue("/root/reqData/searchData/occr_seq", datagrid1.valueMatrix(selectedIdx, 12));
						model1.send("as_aset_1704");
						
						if (model1.getValue("/root/tempData/dataSet/CURLIST1/totalcnt") != "0") {
							model1.setValue("/root/reqData/multiUpDate/cash_rcpm_amt", model1.getValue("/root/tempData/dataSet/CURLIST1/record/cash_rcpm_amt"));
							model1.setValue("/root/reqData/multiUpDate/cash_sub_seq", model1.getValue("/root/tempData/dataSet/CURLIST1/record/cash_sub_seq"));
						}
						
						model1.copyNode("/root/resData/gridData1", "/root/tempData/dataSet/CURLIST2");
						model1.copyNode("/root/resData/gridData2", "/root/tempData/dataSet/CURLIST3");
						model1.copyNode("/root/resData/gridData3", "/root/tempData/dataSet/CURLIST4");
						
						if (model1.getValue("/root/tempData/dataSet/CURLIST4/totalcnt") != "0")
							btnT4.dispatch("onclick");
						if (model1.getValue("/root/tempData/dataSet/CURLIST3/totalcnt") != "0")
							btnT3.dispatch("onclick");
						if (model1.getValue("/root/tempData/dataSet/CURLIST2/totalcnt") != "0")
							btnT2.dispatch("onclick");
						if (model1.getValue("/root/tempData/dataSet/CURLIST1/totalcnt") != "0")
							btnT1.dispatch("onclick");
						
						model1.removeNodeset("/root/tempData/dataSet");
						model1.refresh();
						//getRcpmTotAmt();
						
						if (datagrid2.rows == 1) {
							datagrid2.addRow();
							datagrid2.rowStatus(1) = 0;
							datagrid2.isReadOnly(1, 1, 1, 5) = true;
						} else {
							datagrid2.isReadOnly(1, 1, 1, 5) = false;
						}
						
						if (datagrid3.rows == 1) {
							datagrid3.addRow();
							datagrid3.rowStatus(1) = 0;
							datagrid3.isReadOnly(1, 1, 1, 11) = true;
						} else {
							datagrid3.isReadOnly(1, 1, 1, 11) = false;
						}
						
						if (datagrid4.rows == 1) {
							datagrid4.addRow();
							datagrid4.rowStatus(1) = 0;
							datagrid4.isReadOnly(1, 1, 1, 5) = true;
						} else {
							datagrid4.isReadOnly(1, 1, 1, 5) = false;
						}
	
						getRcpmTotAmt();
					}
					
					function ins_btn_setting() {
						if (model1.getValue("/root/reqData/multiUpDate/occr_dt") == "")
							button5.disabled = false;
						else
							button5.disabled = true;
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					//iv_Title.maintitle.caption="";
					//탭컨트롤 '현금입금' 상태로 초기화
					btnT1.dispatch("onclick");
					
					datagrid2.isReadOnly(1, 1, 1, 5) = true;
					datagrid3.isReadOnly(1, 1, 1, 11) = true;
					datagrid4.isReadOnly(1, 1, 1, 5) = true;
					
					//공통코드 조회하여 콤보박스에 설정
					model1.send("as_aset_1701");
					makeComboSet("", "/root/tempData/dataSet/CURLIST1/record", "/root/initData/comboSet/mang_clsf", "cd_abrv_nm", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST2/record", "/root/initData/comboSet/note_clsf", "cd_abrv_nm", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST3/record", "/root/initData/comboSet/issu_cmpy_clsf", "cd_abrv_nm", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST4/record", "/root/initData/comboSet/whco_slip_clsf", "cd_abrv_nm", "cd")
					model.setValue("/root/initData/comboSet/xx_job_clsf_02", model.getValue("/root/tempData/dataSet/xx_job_clsf_02"));
					model.setValue("/root/initData/comboSet/xx_budg_cd", model.getValue("/root/tempData/dataSet/xx_budg_cd"));
					model.setValue("/root/initData/comboSet/xx_budg_nm", model.getValue("/root/tempData/dataSet/xx_budg_nm"));
					model.setValue("/root/initData/comboSet/xx_mang_cd_4", model.getValue("/root/tempData/dataSet/xx_mang_cd_4"));
					model.setValue("/root/initData/comboSet/xx_cd_clsf", model.getValue("/root/tempData/dataSet/xx_cd_clsf"));
					model.setValue("/root/initData/comboSet/xx_occr_slip_clsf", model.getValue("/root/tempData/dataSet/xx_occr_slip_clsf"));
					
					/*
					alert(model.getValue("/root/initData/comboSet/xx_job_clsf_02"));
					alert(model.getValue("/root/initData/comboSet/xx_budg_cd")); 
					alert(model.getValue("/root/initData/comboSet/xx_budg_nm"));
					alert(model.getValue("/root/initData/comboSet/xx_mang_cd_4"));
					alert(model.getValue("/root/initData/comboSet/xx_cd_clsf"));
					alert(model.getValue("/root/initData/comboSet/xx_occr_slip_clsf"));
					
					*/
					
					
					model1.removeNodeset("/root/tempData/dataSet");
					
					//초기값 설정
					model1.setValue("/root/reqData/searchData/dt_clsf", "1");

					//alert(model1.getValue("/root/reqData/fwdData/chg_clsf"));
					//model1.setValue("/root/reqData/searchData/chg_clsf", "K"); 120227					
					model1.setValue("/root/reqData/searchData/chg_clsf", model1.getValue("/root/reqData/fwdData/chg_clsf"));
					model1.setValue("/root/reqData/multiUpDate/rcpm_dt", commCurDate("ymd"));

					//입금내역조회에서  입금일자(fr)~입금일자(to)로 설정 함
					model1.setValue("/root/reqData/searchData/rcpm_dt_fr", model1.getValue("/root/reqData/fwdData/chg_dt"));
					var now = new Date();
					var year = now.getYear();
					var month = now.getMonth()+1;
					var date = now.getDate();
					if(month < 10)
						month = "0" + month;
					if(date < 10)
						date = "0" + date;
					today = year + month + date;
					model1.setValue("/root/reqData/searchData/rcpm_dt_to", today);						
					//model1.setValue("/root/reqData/searchData/dlco_ern", opt_dlco_ern.value);	// 거래처코드 설정
					//model1.setValue("/root/reqData/searchData/dlco_nm", opt_dlco_nm.value);	// 거래처명 설정
											
					//부모창에서 넘겨준 변동일자를 화면에 설정
					model1.setValue("/root/reqData/searchData/chg_dt", model1.getValue("/root/reqData/fwdData/chg_dt"));

					//부모창에서 넘겨준 변동일자가 있을경우 조회
					if (model1.getValue("/root/reqData/fwdData/chg_dt") != "") {
						ipt_chg_dt.dispatch("xforms-value-changed");
						
						//부모창에서 넘겨받은 변동내역 발생일련번호를 '순차' 컨트롤에 설정
						model1.setValue("/root/reqData/searchData/seq_clsf", model1.getValue("/root/reqData/fwdData/occr_seq"));
						model1.refresh();
						cbo_seq_clsf.dispatch("xforms-value-changed");
						
						//미수거래처를 매각처 초기값으로 설정
						model1.setValue("/root/reqData/searchData/dlco_ern", model1.getValue("/root/reqData/multiUpDate/dlco_ern"));
						model1.setValue("/root/reqData/searchData/dlco_nm", model1.getValue("/root/reqData/multiUpDate/dlco_nm"));
					}

					model1.refresh();
					datagrid1.fixedcellcheckbox(0, 1) = true;
					
					button1.dispatch("onclick");
				]]>
			</script>
			<submission id="as_com_1100" action="/as/com/1100" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1201" action="/as/aset/1201" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1701" action="/as/aset/1701" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1702" action="/as/aset/1702" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1703" action="/as/aset/1703" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1704" action="/as/aset/1704" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1705" action="/as/aset/1705" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/tempData/msgData"/>
			<submission id="as_aset_1708" action="/as/aset/1708" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/tempData/msgData"/>
			<submission id="as_aset_1709" action="/as/aset/1709" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData/dataSet"/>
		</model>
		<script type="javascript" src="/js/as_common.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/TFCommon.js"/>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="1,992;1,952;1,935;" style="font-family:굴림; ">
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData4/record" caption="^입금정보^입금정보^입금정보^입금정보^입금정보^미수정보^미수정보^미수정보^미수정보^caption8^caption9^caption1^caption2^caption3^caption4^caption5^caption6^caption7|^입금일자^입금비고^입금액^전표번호^입금표번호^미수일자^거래처^미수금액^미수비고^caption8^caption9^caption1^caption2^caption3^caption4^caption5^caption6^caption7" colsep="^" colwidth="22, 66, 153, 82, 98, 84, 70, 124, 83, 232, 100, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:10px; top:420px; width:926px; height:300px; ">
			<col type="checkbox"/>
			<col ref="rcpm_dt" format="yyyy-mm-dd" style="text-align:center; "/>
			<col ref="remk" style="text-align:left; "/>
			<col ref="rcpm_tot_amt" format="#,###" style="text-align:right; "/>
			<col ref="actu_slip" style="text-align:center; "/>
			<col ref="rcpm_shet_no" style="text-align:center; "/>
			<col ref="chg_dt" format="yyyy-mm-dd" style="text-align:center; "/>
			<col ref="dlco_nm" style="text-align:left; "/>
			<col ref="misu_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="misu_remk" style="text-align:left; "/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="occr_seq" visibility="hidden"/>
			<col ref="ref_occr_dt" visibility="hidden"/>
			<col ref="ref_occr_seq" visibility="hidden"/>
			<col ref="actu_slip_dt" visibility="hidden"/>
			<col ref="slip_clsf_cd" visibility="hidden"/>
			<col ref="actu_slip_no" visibility="hidden"/>
			<col ref="dlco_ern" visibility="hidden"/>
			<col ref="dlco_clsf_cd" visibility="hidden"/>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					if (datagrid1.col == 1)
						return;
						
					getRcpmDetailInfo();
					ins_btn_setting();
				]]>
			</script>
		</datagrid>
		<group id="group_btnT" class="gro_tab" style="left:10px; top:221px; width:926px; height:25px; ">
			<caption id="caption37" class="tabline" style="left:0px; top:22px; width:925px; height:1px; "/>
			<button id="btnT1" class="tab05" group="tab" selected="true" style="left:0px; top:0px; width:92px; height:23px; ">
				<caption>현금입금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case1");	
						button2.visible = false;
						button6.visible = false;				
					]]>
				</script>
			</button>
			<button id="btnT2" class="tab05" group="tab" selected="false" style="left:92px; top:0px; width:92px; height:23px; ">
				<caption>예금입금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case2");		
						button2.visible = true;
						button6.visible = true;				
					]]>
				</script>
			</button>
			<button id="btnT3" class="tab05" group="tab" selected="false" style="left:184px; top:0px; width:92px; height:23px; ">
				<caption>어음입금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case3");		
						button2.visible = true;
						button6.visible = true;				
					]]>
				</script>
			</button>
			<button id="btnT4" class="tab05" group="tab" selected="false" style="left:276px; top:0px; width:92px; height:23px; ">
				<caption>기타입금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case4");		
						button2.visible = true;
						button6.visible = true;				
					]]>
				</script>
			</button>
			<button id="button2" class="btn_grid02" navindex="6" visibility="hidden" style="left:635px; top:3px; width:42px; height:17px; ">
				<caption>추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (switch1.selectedIndex == 1) {
							if (datagrid2.valueMatrix(datagrid2.rows-1, 1) != "")
								datagrid2.addRow();
							else {
								datagrid2.rowStatus(1) = 1;
								datagrid2.isReadOnly(1, 1, 1, 5) = false;
							}
						}
						else if (switch1.selectedIndex == 2) {
							if (datagrid3.valueMatrix(datagrid3.rows-1, 1) != "")
								datagrid3.addRow();
							else {
								datagrid3.rowStatus(1) = 1;
								datagrid3.isReadOnly(1, 1, 1, 11) = false;
							}
						}
						else if (switch1.selectedIndex == 3) {
							if (datagrid4.valueMatrix(datagrid4.rows-1, 1) != "") {
								datagrid4.addRow();
							 } else {
								datagrid4.rowStatus(1) = 1;
								datagrid4.isReadOnly(1, 1, 1, 5) = false;
							}
							//datagrid4.valueMatrix(datagrid4.rows-1, 1) = "466400"; 120227
							datagrid4.valueMatrix(datagrid4.rows-1, 1) = model.getValue("/root/initData/comboSet/xx_budg_cd");
							//datagrid4.valueMatrix(datagrid4.rows-1, 2) = "예수금(기타)"; 120302
							datagrid4.valueMatrix(datagrid4.rows-1, 2) = model.getValue("/root/initData/comboSet/xx_budg_nm");
						}
					]]>
				</script>
			</button>
			<button id="button6" class="btn_grid02" navindex="7" visibility="hidden" style="left:678px; top:3px; width:42px; height:17px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (switch1.selectedIndex == 1) {
							datagrid2.rowStatus(datagrid2.row) = 4;
						}
						else if (switch1.selectedIndex == 2) {
							datagrid3.rowStatus(datagrid3.row) = 4;
						}
						else if (switch1.selectedIndex == 3) {
							datagrid4.rowStatus(datagrid4.row) = 4;
						}
						getRcpmTotAmt();
					]]>
				</script>
			</button>
		</group>
		<group id="group2" class="gro_tit2" style="left:10px; top:136px; width:926px; height:25px; ">
			<caption id="caption3" class="tit02" style="left:0px; top:3px; width:926px; height:20px; ">입금정보</caption>
		</group>
		<switch id="switch1" style="left:10px; top:244px; width:926px; height:115px; ">
			<case id="case1" scroll="none">
				<group id="tab" class="gro_tab1" style="left:0px; top:0px; width:937px; height:200px; ">
					<caption id="caption51" class="list_cap02" style="left:84px; top:5px; width:131px; height:26px; text-align:center; "/>
					<input id="input20" ref="/root/reqData/multiUpDate/cash_rcpm_amt" navindex="21" inputtype="input" format="#,###" appearance="input" style="left:89px; top:9px; width:116px; height:18px; text-align:right; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								getRcpmTotAmt();
							]]>
						</script>
					</input>
					<caption id="caption52" class="list_cap03" style="left:5px; top:5px; width:80px; height:26px; text-align:center; ">입금금액</caption>
				</group>
			</case>
			<case id="case2" selected="true">
				<datagrid id="datagrid2" nodeset="/root/resData/gridData1/record" caption="입금일자^입금금액^입금자명^관리구분^관리구분명^수수료^deps_sub_seq^biz_reg_no^bank_id^acct_num^tran_date^tran_date_seq^계좌조회" colsep="#" colwidth="120, 130, 170, 194, 90, 120, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" navindex="22" style="left:5px; top:5px; width:915px; height:104px; ">
					<col ref="deps_rmtt_dt" type="inputdate" format="yyyy-mm-dd" style="text-align:center; "/>
					<col editable="true" ref="deps_rcpm_amt" type="input" format="#,###" style="text-align:right; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								getRcpmTotAmt();
							]]>
						</script>
					</col>
					<col ref="deps_rmtt_plac" type="input" style="text-align:center; "/>
					<col ref="deps_acct_mang_no" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/mang_clsf/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col ref="deps_acct_mang_nm" visibility="hidden" style="text-align:left; "/>
					<col ref="deps_coms_amt" type="input" format="#,###" style="text-align:right; "/>
					<col ref="deps_sub_seq" visibility="hidden"/>
					<col ref="deps_biz_reg_no" visibility="hidden"/>
					<col ref="deps_bank_id" visibility="hidden"/>
					<col ref="deps_acct_num" visibility="hidden"/>
					<col ref="deps_tran_date" visibility="hidden"/>
					<col ref="deps_tran_date_seq" visibility="hidden"/>
					<col editable="false" type="inputbutton">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
			  					var selectIdx = datagrid2.selectedRow(0);
			  					
			  					model.makeNode("/root/reqData/fwdData/acct_mang_no_ref");	
			  					model.setValue("/root/reqData/fwdData/acct_mang_no_ref", "/root/resData/gridData1/record["+selectIdx+"]/deps_acct_mang_no");		
			  					model.makeNode("/root/reqData/fwdData/acct_mang_nm_ref");	
			  					model.setValue("/root/reqData/fwdData/acct_mang_nm_ref", "/root/resData/gridData1/record["+selectIdx+"]/deps_acct_mang_nm");	  					
			  					model.makeNode("/root/reqData/fwdData/tran_amt_ref");	
			  					model.setValue("/root/reqData/fwdData/tran_amt_ref", "/root/resData/gridData1/record["+selectIdx+"]/deps_rcpm_amt");
			  					model.makeNode("/root/reqData/fwdData/tran_content_ref");	
			  					model.setValue("/root/reqData/fwdData/tran_content_ref", "/root/resData/gridData1/record["+selectIdx+"]/deps_rmtt_plac");			
			  							
								//loadRcpmDtlsPop("K1", 120227
								loadRcpmDtlsPop(model.getValue("/root/initData/comboSet/xx_mang_cd_4"),
								                "",
								                "/root/resData/gridData1/record["+selectIdx+"]/deps_biz_reg_no",
								                "/root/resData/gridData1/record["+selectIdx+"]/deps_bank_id",
								                "/root/resData/gridData1/record["+selectIdx+"]/deps_acct_num",
								                "/root/resData/gridData1/record["+selectIdx+"]/deps_rmtt_dt",
								                "/root/resData/gridData1/record["+selectIdx+"]/deps_tran_date_seq",
											     "/root/reqData/fwdData");
											     
								model1.setValue("/root/resData/gridData1/record["+selectIdx+"]/deps_tran_date", model1.getValue("/root/resData/gridData1/record["+selectIdx+"]/deps_rmtt_dt"))
								getRcpmTotAmt();
							]]>
						</script>
					</col>
				</datagrid>
			</case>
			<case id="case3">
				<datagrid id="datagrid3" nodeset="/root/resData/gridData2/record" caption="어음번호^입금금액^어음구분^금융기관^금융기관명^발행인^발행사코드^기산일^만기일^입금계좌^매출승인번호^note_sub_seq" colsep="#" colwidth="80, 80, 80, 80, 80, 80, 80, 85, 85, 80, 80, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" navindex="24" style="left:5px; top:5px; width:915px; height:104px; ">
					<col ref="note_note_no" type="input" maxlength="8" style="text-align:center; "/>
					<col ref="note_rcpm_amt" type="input" format="(-)#,###" style="text-align:right; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								getRcpmTotAmt();
							]]>
						</script>
					</col>
					<col ref="note_note_clsf_cd" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/note_clsf/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col ref="note_bank_cd" type="inputbutton" maxlength="6">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								var getRow = datagrid3.row;
								var getCol = datagrid3.col;							
							
								if (getCol== 4) {		// 금융기관
									var cd   =  "";
									var cdnm =  "";
																
									var resultRef1 = "/root/resData/resForm/popupData/bank_cd";
									var resultRef2 = "/root/resData/resForm/popupData/bank_cd_nm";							
		
									//showCommonCodePopup1("02", "71", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", ""); 120227
									showCommonCodePopup1(model.getValue("/root/initData/comboSet/xx_job_clsf_02"), model.getValue("/root/initData/comboSet/xx_cd_clsf"), cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");

									datagrid3.valueMatrix(getRow,getCol) = model.getValue(resultRef1);
									datagrid3.valueMatrix(getRow,getCol+1) = model.getValue(resultRef2);
								}
							]]>
						</script>
					</col>
					<col ref="note_bank_nm" format="(-)#,###" style="text-align:left; "/>
					<col ref="note_issu_pers_nm" type="input" style="text-align:center; "/>
					<col ref="note_issu_cmpy_clsf" type="combo">
						<choices>
							<itemset nodeset="/root/initData/comboSet/issu_cmpy_clsf/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col ref="note_comp_dt" type="inputdate"/>
					<col ref="note_mtry_dt" type="inputdate"/>
					<col ref="note_rcpm_acct" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/mang_clsf/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col ref="note_sale_aprv_no" type="input" style="text-align:left; "/>
					<col ref="note_sub_seq" visibility="hidden"/>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
								var getRow = datagrid2.row;
								var getCol = datagrid2.col;			
							
								if (getCol== 5) {
									if (datagrid2.valueMatrix(getRow, getCol) == "") {
										datagrid2.valueMatrix(getRow, getCol+1) = "";
									}
								}						
							]]>
					</script>
				</datagrid>
			</case>
			<case id="case4">
				<datagrid id="datagrid4" nodeset="/root/resData/gridData3/record" caption="예산코드^예산명^입금금액^전사전표구분^전사전표번호^etc_sub_seq" colsep="#" colwidth="170, 222, 170, 170, 160, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" navindex="25" style="left:5px; top:5px; width:915px; height:104px; ">
					<col ref="etc_budg_cd" style="text-align:center; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								model.removeNodeset("/root/reqData/fwdData");  

								model.makeNode("/root/reqData/fwdData/G_Tag");
								model.makeNode("/root/reqData/fwdData/G_Caption");
								model.makeNode("/root/reqData/fwdData/G_Codenu");
								model.makeNode("/root/reqData/fwdData/G_BRCode");
								
								model.setValue("/root/reqData/fwdData/G_Tag", "1");
								model.setValue("/root/reqData/fwdData/G_Caption", "예산코드조회");
								model.setValue("/root/reqData/fwdData/G_Codenu", "");					
								model.setValue("/root/reqData/fwdData/G_BRCode", "");
		
								gstr_popupid = "budg_cd";
								window.load("/xrw/mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								if (datagrid4.valueMatrix(datagrid4.row, 1).length == 6) {
									model1.setValue("/root/reqData/reqForm/budg_cd", datagrid4.valueMatrix(datagrid4.row, 1));
									model1.send("as_aset_1709");
									if (model1.getValue("/root/tempData/dataSet/CURLIST/totcount") != "0") {
										datagrid4.valueMatrix(datagrid4.row, 2) = model1.getValue("/root/tempData/dataSet/CURLIST/record/budg_nm");
										model1.removeNodeset("/root/tempData/dataSet");
										model1.refresh();
									}
								}
							]]>
						</script>
					</col>
					<col ref="etc_budg_nm" style="text-align:left; "/>
					<col ref="etc_rcpm_amt" type="input" format="(-)#,###" style="text-align:right; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								getRcpmTotAmt();
							]]>
						</script>
					</col>
					<col ref="etc_bal_occr_slip_clsf" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/whco_slip_clsf/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col ref="etc_bal_occr_slip_no" type="inputbutton" style="text-align:left; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								model1.makeNode("/root/reqData/fwdData/occr_slip_clsf");
								model1.makeNode("/root/reqData/fwdData/bal_occr_slip_no");
								//model1.setValue("/root/reqData/fwdData/occr_slip_clsf", "96"); 120227
								model1.setValue("/root/reqData/fwdData/occr_slip_clsf", model.getValue("/root/initData/comboSet/xx_occr_slip_clsf"));
								
								window.load("/xrw/en/comm/EN_COMM_1300.xrw","modal", "EN_COMM_1300", "align:center; width:805; height:605; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
								
								if (model1.getValue("/root/reqData/fwdData/bal_occr_slip_no") != "") {
									datagrid4.valueMatrix(datagrid4.row, 5) = (model1.getValue("/root/reqData/fwdData/bal_occr_slip_no")).ReplaceWord("-", "");
									datagrid4.valueMatrix(datagrid4.row, 4) = model1.getValue("/root/reqData/fwdData/occr_slip_clsf");
								}
									
								model1.removenode("/root/reqData/fwdData/occr_slip_clsf");
								model1.removenode("/root/reqData/fwdData/bal_occr_slip_no");

								/*
								model.property("FC_ACCT_2500_popup_clsf")  = "Y";
								model.property("FC_ACCT_2500_srch_occr_slip_clsf")  = datagrid3.valueMatrix(datagrid3.row,5).substring(0, 2);
							
								viewer("mainFrame").window.javaScript.onLoadPopupPage("FC_ACCT_2500");

								datagrid4.valueMatrix(datagrid4.row,5) = model.property("FC_ACCT_2500_occr_slip");
								datagrid4.valueMatrix(datagrid4.row,4) = model.property("FC_ACCT_2500_srch_occr_slip_clsf");
								
								model.property("FC_ACCT_2500_occr_slip") = "";
								model.property("FC_ACCT_2500_srch_occr_slip_clsf") = "";
								*/
							]]>
						</script>
					</col>
					<col ref="etc_sub_seq" visibility="hidden"/>
				</datagrid>
			</case>
		</switch>
		<group id="group_line" class="gro_line" style="left:10px; top:70px; width:926px; height:5px; "/>
		<group id="group_tit" class="gro_tit2" style="left:10px; top:370px; width:926px; height:20px; ">
			<caption id="subtitle" class="tit02" style="left:0px; top:0px; width:926px; height:25px; ">입금내역조회</caption>
		</group>
		<group id="group_tab" class="gro_tab1" style="left:10px; top:160px; width:926px; height:51px; ">
			<caption id="caption15" class="list_cap02" style="left:89px; top:0px; width:837px; height:26px; text-align:center; "/>
			<caption id="caption66" class="list_cap02" style="left:89px; top:25px; width:837px; height:26px; text-align:center; "/>
			<caption id="caption67" class="list_cap03" style="left:0px; top:25px; width:90px; height:26px; text-align:center; ">입금전표번호</caption>
			<output id="input21" ref="/root/reqData/multiUpDate/actu_slip" inputtype="input" appearance="output" style="left:94px; top:29px; width:136px; height:18px; "/>
			<caption id="caption38" class="list_cap03" style="left:725px; top:0px; width:80px; height:26px; ">입금표번호</caption>
			<input id="input6" ref="/root/reqData/multiUpDate/remk" navindex="4" inputtype="input" appearance="input" style="left:464px; top:4px; width:220px; height:18px; "/>
			<caption id="caption10" class="list_cap03" style="left:370px; top:0px; width:90px; height:26px; ">비  고</caption>
			<caption id="caption16" class="list_cap03" style="left:0px; top:0px; width:90px; height:26px; text-align:center; ">입금일자</caption>
			<input id="input8" ref="/root/reqData/multiUpDate/rcpm_dt" class="req" navindex="3" inputtype="date" caption="입금일자" appearance="input" style="left:94px; top:4px; width:85px; height:18px; text-align:left; "/>
			<input id="input4" ref="/root/reqData/multiUpDate/rcpm_shet_no" navindex="5" editable="false" inputtype="button" style="left:809px; top:4px; width:96px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model1.makeNode("/root/reqData/fwdData/rcpm_clsf");
						model1.makeNode("/root/reqData/fwdData/rcpm_shet_kind");
						model1.makeNode("/root/reqData/fwdData/rcpm_shet_no");
						//model1.setValue("/root/reqData/fwdData/rcpm_clsf", "96"); 120227
						model1.setValue("/root/reqData/fwdData/rcpm_clsf", model.getValue("/root/initData/comboSet/xx_occr_slip_clsf"));
						window.load("/xrw/en/comm/EN_COMM_1400.xrw","modal", "EN_COMM_1400", "align:center; width:805; height:605; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
						model1.setValue("/root/reqData/multiUpDate/rcpm_shet_kind", model.getValue("/root/reqData/fwdData/rcpm_shet_kind"));
						model1.setValue("/root/reqData/multiUpDate/rcpm_shet_no", model.getValue("/root/reqData/fwdData/rcpm_shet_no"));
						model1.removenode("/root/reqData/fwdData/rcpm_clsf");
						model1.removenode("/root/reqData/fwdData/rcpm_shet_kind");
						model1.removenode("/root/reqData/fwdData/rcpm_shet_no");
						model1.refresh();
					]]>
				</script>
			</input>
			<output id="input1" ref="/root/reqData/multiUpDate/occr_dt" inputtype="input" appearance="output" style="left:183px; top:4px; width:56px; height:18px; text-align:center; "/>
			<output id="output2" ref="/root/reqData/multiUpDate/occr_seq" inputtype="input" appearance="output" style="left:250px; top:4px; width:25px; height:18px; text-align:center; "/>
			<caption id="caption6" style="left:240px; top:4px; width:15px; height:20px; ">-</caption>
		</group>
		<group id="group1" class="gro_tab1" style="left:10px; top:390px; width:926px; height:26px; ">
			<caption id="caption12" class="list_cap02" style="left:89px; top:0px; width:837px; height:26px; "/>
			<caption id="caption17" class="list_cap03" style="left:300px; top:0px; width:90px; height:26px; ">매각처</caption>
			<input id="input10" ref="/root/reqData/searchData/remk" navindex="20" inputtype="input" appearance="input" style="left:770px; top:4px; width:150px; height:18px; "/>
			<caption id="caption24" class="list_cap03" style="left:676px; top:0px; width:90px; height:26px; ">입금비고</caption>
			<caption id="caption33" class="list_cap03" style="left:0px; top:0px; width:90px; height:26px; ">입금일자</caption>
			<output id="output4" ref="/root/reqData/searchData/dlco_nm" inputtype="input" appearance="output" style="left:504px; top:4px; width:161px; height:18px; "/>
			<input id="input9" ref="/root/reqData/searchData/rcpm_dt_fr" class="req" navindex="17" inputtype="date" style="left:94px; top:4px; width:85px; height:18px; "/>
			<input id="input11" ref="/root/reqData/searchData/dlco_ern" navindex="19" inputtype="button" style="left:394px; top:4px; width:106px; height:18px; ">
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.removeNodeset("/root/reqData/fwdData");  
						model1.makeNode("/root/reqData/fwdData/func_nm");
						model1.setValue("/root/reqData/fwdData/func_nm","setDlco_no");
						window.load("../../co/dlco/CO_DLCO_1100.xrw","modeless","pop1","left:300; top:150; width:660px; height:540px; ","/root/reqData/fwdData","/root/reqData/fwdData");
					]]>
				</script>
			</input>
			<input id="input13" ref="/root/reqData/searchData/rcpm_dt_to" class="req" navindex="18" inputtype="date" style="left:195px; top:4px; width:85px; height:18px; "/>
			<caption id="caption5" style="left:181px; top:5px; width:15px; height:20px; ">~</caption>
		</group>
		<group id="group3" class="gro_tit2" style="left:10px; top:82px; width:926px; height:25px; ">
			<caption id="caption8" class="tit02" style="left:0px; top:3px; width:926px; height:20px; ">미수금정보</caption>
		</group>
		<group id="group4" class="gro_tab1" style="left:10px; top:107px; width:926px; height:28px; ">
			<caption id="caption4" class="list_cap02" style="left:89px; top:0px; width:837px; height:26px; text-align:center; "/>
			<button id="output1" inputtype="input" appearance="button" style="left:285px; top:4px; width:85px; height:18px; text-align:left; ">
				<caption/>
			</button>
			<output id="opt_dlco_nm" inputtype="input" appearance="output" style="left:570px; top:4px; width:136px; height:18px; text-align:left; "/>
			<caption id="caption30" class="list_cap03" style="left:370px; top:0px; width:90px; height:26px; text-align:center; ">미수거래처</caption>
			<output id="opt_dlco_ern" navindex="16" inputtype="button" appearance="output" style="left:464px; top:4px; width:101px; height:18px; text-align:center; "/>
			<caption id="caption36" class="list_cap03" style="left:0px; top:0px; width:90px; height:26px; text-align:center; ">미수일자</caption>
			<input id="ipt_chg_dt" ref="/root/reqData/searchData/chg_dt" class="req" navindex="1" inputtype="date" appearance="input" style="left:94px; top:4px; width:85px; height:18px; text-align:left; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						model1.send("as_aset_1201");
						model1.copyNode("/root/initData/comboSet/seq_clsf","/root/tempData/dataSet/CURLIST/seq_clsf");
						cbo_seq_clsf.value = "";
						model1.refresh();
					]]>
				</script>
			</input>
			<caption id="caption40" class="list_cap03" style="left:185px; top:0px; width:75px; height:26px; text-align:center; ">순  차</caption>
			<caption id="caption42" class="list_cap03" style="left:725px; top:0px; width:80px; height:26px; text-align:center; ">미수금</caption>
			<output id="opt_misu_amt" format="#,###" inputtype="input" appearance="output" style="left:809px; top:4px; width:95px; height:18px; text-align:right; "/>
			<select1 id="cbo_seq_clsf" ref="/root/reqData/searchData/seq_clsf" navindex="2" appearance="minimal" style="left:268px; top:4px; width:101px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/seq_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						model1.setValue("/root/reqData/multiUpDate/ref_occr_dt", cbo_seq_clsf.label.substring(0,8));
						model1.setValue("/root/reqData/multiUpDate/ref_occr_seq", model1.getValue("/root/reqData/searchData/seq_clsf"));

						model1.setValue("/root/reqData/searchData/occr_dt", cbo_seq_clsf.label.substring(0,8));
						model1.setValue("/root/reqData/searchData/occr_seq", model1.getValue("/root/reqData/searchData/seq_clsf"));
						model1.send("as_aset_1703");

						opt_dlco_ern.value = model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_ern");
						opt_dlco_nm.value = model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_nm");
						opt_misu_amt.value = model1.getValue("/root/tempData/dataSet/CURLIST/record/misu_amt");

						model1.setValue("/root/reqData/multiUpDate/dlco_ern", model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_ern"));
						model1.setValue("/root/reqData/multiUpDate/dlco_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_nm"));
						model1.setValue("/root/reqData/multiUpDate/dlco_clsf_cd", model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_clsf_cd"));

						model1.removeNodeset("/root/tempData/dataSet");
						
						//입금내역조회에서  입금일자(fr)~입금일자(to)로 설정 함
						model1.setValue("/root/reqData/searchData/rcpm_dt_fr", model1.getValue("/root/reqData/fwdData/chg_dt"));
						var now = new Date();
						var year = now.getYear();
						var month = now.getMonth()+1;
						var date = now.getDate();
						if(month < 10)
							month = "0" + month;
						if(date < 10)
							date = "0" + date;
						today = year + month + date;
						model1.setValue("/root/reqData/searchData/rcpm_dt_to", today);						
						//model1.setValue("/root/reqData/searchData/dlco_ern", opt_dlco_ern.value);	// 거래처코드 설정
						//model1.setValue("/root/reqData/searchData/dlco_nm", opt_dlco_nm.value);	// 거래처명 설정
					]]>
				</script>
			</select1>
		</group>
		<caption id="caption1" class="list_cap02" style="left:815px; top:218px; width:121px; height:26px; text-align:center; "/>
		<caption id="caption2" class="list_cap03" style="left:736px; top:218px; width:80px; height:26px; text-align:center; ">입금액</caption>
		<output id="opt_rcpm_amt" format="#,###" inputtype="input" appearance="output" style="left:820px; top:222px; width:95px; height:18px; text-align:right; "/>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:42px; width:926px; height:21px; ">
			<button id="button3" class="btn02" navindex="10" visibility="visible" crud="U" style="left:349px; top:0px; width:52px; height:21px; ">
				<caption>수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
				  	        // 발생일련번호가 없는 경우에는 입력 상태임 수정, 삭제 불가 함					
						if (model1.getValue("/root/reqData/searchData/occr_seq") == '' ) {
							alert(" 수정 가능한 상태가 아닙니다.");
							return;							    
						}		
											
						if (opt_rcpm_amt.label == "" || opt_rcpm_amt.label == "0") {
							alert("수정할 입금내역이 없습니다.");
							return;
						}

                                             // 현업전표가 생성되었으므로 수정,삭제 불가 함
						if (model1.getValue("/root/reqData/multiUpDate/actu_slip") != '' ) {
							alert(" 현업전표가 생성되었습니다. 수정 가능한 상태가 아닙니다.");
							return;							    
						}

						if (Number((opt_rcpm_amt.label).ReplaceWord(",", "")) > Number((opt_misu_amt.label).ReplaceWord(",", ""))) {
							alert("입금액이 미수금을 초과할 수 없습니다.");
							return;
						}

						var   tmp_cash_amt = getRcpmTotAmt();                           // 현금
						var   tmp_deps_amt = getGrid2TotAmt();                          // 예금
	
						if ((tmp_cash_amt  + tmp_deps_amt != 0) && model1.getValue("/root/reqData/multiUpDate/rcpm_shet_no" ) == "" ) {
							alert("입금표번호를 입력하세요.");
							return;
						}

						var selectedRow = datagrid1.row;
						if (commReqCheck(group_tab)) {
							if (window.alert("입금내역을 수정하시겠습니까?", "입력", 1) == 1) {
								model1.setValue("/root/reqData/multiUpDate/mst_mode", "U");
								model1.setValue("/root/reqData/multiUpDate/multiUpdateData1", datagrid2.getUpdateData());
								model1.setValue("/root/reqData/multiUpDate/multiUpdateData2", datagrid3.getUpdateData());
								model1.setValue("/root/reqData/multiUpDate/multiUpdateData3", datagrid4.getUpdateData());
								model1.send("as_aset_1705");
								
								if (submit_completed()) {
									model1.removeNodeset("/root/tempData/msgData");
									resetForms();
									button1.dispatch("onclick");
									cbo_seq_clsf.dispatch("xforms-value-changed");
									
									datagrid1.select(selectedRow, 1, selectedRow, 10) = true;
									datagrid1.row = selectedRow;
									getRcpmDetailInfo();
									ins_btn_setting();
								}
							}
						}
					]]>
				</script>
			</button>
			<button id="button4" class="btn02" navindex="11" crud="D" style="left:403px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
				  	        // 발생일련번호가 없는 경우에는 입력 상태임 수정, 삭제 불가 함					
						if (model1.getValue("/root/reqData/searchData/occr_seq") == '' ) {
							alert(" 삭제 가능한 상태가 아닙니다.");
							return;							    
						}
											
						if (model1.getValue("/root/reqData/multiUpDate/occr_dt") == "") {
							alert("삭제할 입금내역이 없습니다.");
							return;
						}
						
						// 현업전표가 생성되었으므로 수정,삭제 불가 함
						if (model1.getValue("/root/reqData/multiUpDate/actu_slip") != '' ) {
							alert(" 현업전표가 생성되었습니다. 삭제 가능한 상태가 아닙니다.");
							return;							    
						}
												
						if (commReqCheck(group_tab)) {
							if (window.alert("입금내역을 삭제하시겠습니까?", "입력", 1) == 1) {
								for (i = 1; i < datagrid2.rows;i++) {
									if (datagrid2.valueMatrix(i, 1) != "")
										datagrid2.rowStatus(i) = 4;
									else
										datagrid2.rowStatus(i) = 0;
								}

								for (i = 1; i < datagrid3.rows;i++) {
									if (datagrid3.valueMatrix(i, 1) != "")
										datagrid3.rowStatus(i) = 4;
									else
										datagrid3.rowStatus(i) = 0;
								}

								for (i = 1; i < datagrid4.rows;i++) {
									if (datagrid4.valueMatrix(i, 1) != "")
										datagrid4.rowStatus(i) = 4;
									else
										datagrid4.rowStatus(i) = 0;
								}

								model1.setValue("/root/reqData/multiUpDate/mst_mode", "D");
								model1.setValue("/root/reqData/multiUpDate/multiUpdateData1", datagrid2.getUpdateData());
								model1.setValue("/root/reqData/multiUpDate/multiUpdateData2", datagrid3.getUpdateData());
								model1.setValue("/root/reqData/multiUpDate/multiUpdateData3", datagrid4.getUpdateData());
								model1.send("as_aset_1705");
								
								if (submit_completed()) {
									model1.removeNodeset("/root/tempData/msgData");
									resetForms();
									button1.dispatch("onclick");
									cbo_seq_clsf.dispatch("xforms-value-changed");
									ins_btn_setting();
								}
							}
						}
					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" navindex="12" style="left:458px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.reset();
						datagrid2.isReadOnly(1, 1, 1, 5) = true;
						datagrid2.rowStatus(1) = 0;
						datagrid3.isReadOnly(1, 1, 1, 11) = true;
						datagrid3.rowStatus(1) = 0;
						datagrid4.isReadOnly(1, 1, 1, 5) = true;
						datagrid4.rowStatus(1) = 0;
						ins_btn_setting();
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" navindex="15" style="left:874px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						window.close();		
					]]>
				</script>
			</button>
			<button id="button5" class="btn02" navindex="9" crud="C" style="left:295px; top:0px; width:52px; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (opt_rcpm_amt.label == "" || opt_rcpm_amt.label == "0") {
							alert("입력할 입금내역이 없습니다.");
							return;
						}
						
						if (Number((opt_rcpm_amt.label).ReplaceWord(",", "")) > Number((opt_misu_amt.label).ReplaceWord(",", ""))) {
							alert("입금액이 미수금을 초과할 수 없습니다.");
							return;
						}
						var   tmp_cash_amt = getRcpmTotAmt();                           // 현금
						var   tmp_deps_amt = getGrid2TotAmt();                          // 예금
	
						if ((tmp_cash_amt  + tmp_deps_amt != 0) && model1.getValue("/root/reqData/multiUpDate/rcpm_shet_no" ) == "" ) {
							alert("입금표번호를 입력하세요.");
							// return;
						}
												
						if (commReqCheck(group_tab)) {
							if (window.alert("입금내역을 입력하시겠습니까?", "입력", 1) == 1) {
								for (i = 1; i < datagrid2.rows;i++) {
									if (datagrid2.rowStatus(i) == 4)
										datagrid2.rowStatus(i) = 0;
									else
										if (datagrid2.valueMatrix(i, 1) != "")
											datagrid2.rowStatus(i) = 1;
								}

								for (i = 1; i < datagrid3.rows;i++) {
									if (datagrid3.rowStatus(i) == 4)
										datagrid3.rowStatus(i) = 0;
									else
										if (datagrid3.valueMatrix(i, 1) != "")
											datagrid3.rowStatus(i) = 1;
								}

								for (i = 1; i < datagrid4.rows;i++) {
									if (datagrid4.rowStatus(i) == 4)
										datagrid4.rowStatus(i) = 0;
									else
										if (datagrid4.valueMatrix(i, 1) != "")
											datagrid4.rowStatus(i) = 1;
								}

								model1.setValue("/root/reqData/multiUpDate/mst_mode", "I");
								model1.setValue("/root/reqData/multiUpDate/multiUpdateData1", datagrid2.getUpdateData());
								model1.setValue("/root/reqData/multiUpDate/multiUpdateData2", datagrid3.getUpdateData());
								model1.setValue("/root/reqData/multiUpDate/multiUpdateData3", datagrid4.getUpdateData());
								model1.send("as_aset_1705");
								
								if (submit_completed()) {
									model1.removeNodeset("/root/tempData/msgData");
									if (model1.getValue("/root/reqData/searchData/rcpm_dt_fr") == "") {
										model1.setValue("/root/reqData/searchData/rcpm_dt_fr", model1.getValue("/root/reqData/multiUpDate/rcpm_dt"));
										model1.setValue("/root/reqData/searchData/rcpm_dt_to", model1.getValue("/root/reqData/multiUpDate/rcpm_dt"));
										model1.refresh();
									}
									resetForms();
									button1.dispatch("onclick");
									cbo_seq_clsf.dispatch("xforms-value-changed");
									ins_btn_setting();
								}
							}
						}
					]]>
				</script>
			</button>
			<button id="button1" class="btn02" navindex="8" crud="R" style="left:240px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.send("as_aset_1702");
						model1.copyNode("/root/resData/gridData4", "/root/tempData/dataSet/CURLIST");
						model1.removeNodeset("/root/tempData/dataSet");
						model1.refresh();

						if (datagrid1.rows == 2)
							datagrid1.addRow();

						ins_btn_setting();
					]]>
				</script>
			</button>
			<button id="button7" class="btn04" navindex="13" style="left:580px; top:0px; width:86px; height:21px; ">
				<caption>현업전표생성</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var selected_rows = 0;
						for (i = 2; i < datagrid1.rows; i++) {
							if (datagrid1.valueMatrix(i, 1) == "true") {
								selected_rows++;
								
								if (datagrid1.valueMatrix(i, 5) != "") {
									alert("[" + datagrid1.valueMatrix(i, 2) + "] '" + datagrid1.valueMatrix(i, 3) + "'은(는) 이미 현업전표를 생성하였습니다.");
									return;
								}
							}
						}
						
						if (selected_rows == 0) {
							alert("현업전표를 생성할 대상을 선택하십시오.");
							return;
						}
						
						if (!(window.alert("현업전표를 생성하시겠습니까?", "확인", 1) == 1))
							return;
							
						model1.removeNodeSet("/root/resData/gridData5");
						model1.makeNode("/root/resData/gridData5");
						model1.makeNode("/root/resData/gridData5/record");
						model1.makeNode("/root/resData/gridData5/record/occr_dt");
						model1.makeNode("/root/resData/gridData5/record/occr_seq");
	
						var node = instance1.selectSingleNode("/root/resData/gridData5/record");
						var copyedNode = node.cloneNode(true);
	
						var idx = 0;
						selected_rows = 0;
						for (i = 1; i < datagrid1.rows; i++) {
							if (datagrid1.valueMatrix(i, 1) == "true") {
								if (selected_rows != 0) {
									instance1.selectSingleNode("/root/resData/gridData5").appendChild(copyedNode);
	
									model1.setValue("/root/resData/gridData5/record["+(selected_rows+1)+"]/occr_dt", datagrid1.valueMatrix(i, 11));
									model1.setValue("/root/resData/gridData5/record["+(selected_rows+1)+"]/occr_seq", datagrid1.valueMatrix(i, 12));
								} else {
									model1.setValue("/root/resData/gridData5/record/occr_dt", datagrid1.valueMatrix(i, 11));
									model1.setValue("/root/resData/gridData5/record/occr_seq", datagrid1.valueMatrix(i, 12));
								}
								selected_rows++;
							}
						}
						datagrid5.refresh();
						
						for (i = 1; i < datagrid5.rows; i++)
							datagrid5.addStatus(i, 1);
							
						
						model1.makeNode("/root/reqData/multiUpDate/job_mode");
						model1.makeNode("/root/reqData/multiUpDate/chg_clsf");
						model1.makeNode("/root/reqData/multiUpDate/multiUpdateData");
						model1.setValue("/root/reqData/multiUpDate/job_mode", "I");
						model1.setValue("/root/reqData/multiUpDate/chg_clsf", "0");
						model1.setValue("/root/reqData/multiUpDate/multiUpdateData", datagrid5.getUpdateData());
						
						model1.send("as_aset_1708");
						
						if (submit_completed()) {
							model1.removeNodeset("/root/tempData/msgData");
							if (model1.getValue("/root/reqData/searchData/rcpm_dt_fr") == "") {
								model1.setValue("/root/reqData/searchData/rcpm_dt_fr", model1.getValue("/root/reqData/multiUpDate/rcpm_dt"));
								model1.setValue("/root/reqData/searchData/rcpm_dt_to", model1.getValue("/root/reqData/multiUpDate/rcpm_dt"));
								model1.refresh();
							}
							resetForms();
							button1.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="button8" class="btn04" navindex="14" style="left:670px; top:0px; width:86px; height:21px; ">
				<caption>현업전표취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var selected_rows = 0;
						for (i = 2; i < datagrid1.rows; i++) {
							if (datagrid1.valueMatrix(i, 1) == "true") {
								selected_rows++;

								if (datagrid1.valueMatrix(i, 5) == "") {
									alert("[" + datagrid1.valueMatrix(i, 2) + "] '" + datagrid1.valueMatrix(i, 3) + "'은(는) 현업전표번호가 존재하지 않습니다.");
									return;
								}
							}
						}
						
						if (selected_rows == 0) {
							alert("현업전표 취소 대상을 선택하십시오.");
							return;
						}
						
						if (!(window.alert("현업전표를 취소하시겠습니까?", "확인", 1) == 1))
							return;
							
						model1.removeNodeSet("/root/resData/gridData5");
						model1.makeNode("/root/resData/gridData5");
						model1.makeNode("/root/resData/gridData5/record");
						model1.makeNode("/root/resData/gridData5/record/occr_dt");
						model1.makeNode("/root/resData/gridData5/record/occr_seq");
	
						var node = instance1.selectSingleNode("/root/resData/gridData5/record");
						var copyedNode = node.cloneNode(true);
	
						var idx = 0;
						selected_rows = 0;
						for (i = 1; i < datagrid1.rows; i++) {
							if (datagrid1.valueMatrix(i, 1) == "true") {
								if (selected_rows != 0) {
									instance1.selectSingleNode("/root/resData/gridData5").appendChild(copyedNode);
	
									model1.setValue("/root/resData/gridData5/record["+(selected_rows+1)+"]/occr_dt", datagrid1.valueMatrix(i, 11));
									model1.setValue("/root/resData/gridData5/record["+(selected_rows+1)+"]/occr_seq", datagrid1.valueMatrix(i, 12));
								} else {
									model1.setValue("/root/resData/gridData5/record/occr_dt", datagrid1.valueMatrix(i, 11));
									model1.setValue("/root/resData/gridData5/record/occr_seq", datagrid1.valueMatrix(i, 12));
								}
								selected_rows++;
							}
						}
						datagrid5.refresh();
						
						for (i = 1; i < datagrid5.rows; i++)
							datagrid5.addStatus(i, 1);
							
						
						model1.makeNode("/root/reqData/multiUpDate/job_mode");
						model1.makeNode("/root/reqData/multiUpDate/chg_clsf");
						model1.makeNode("/root/reqData/multiUpDate/multiUpdateData");
						model1.setValue("/root/reqData/multiUpDate/job_mode", "D");
						model1.setValue("/root/reqData/multiUpDate/chg_clsf", "0");
						model1.setValue("/root/reqData/multiUpDate/multiUpdateData", datagrid5.getUpdateData());
						
						model1.send("as_aset_1708");
						
						if (submit_completed()) {
							model1.removeNodeset("/root/tempData/msgData");
							if (model1.getValue("/root/reqData/searchData/rcpm_dt_fr") == "") {
								model1.setValue("/root/reqData/searchData/rcpm_dt_fr", model1.getValue("/root/reqData/multiUpDate/rcpm_dt"));
								model1.setValue("/root/reqData/searchData/rcpm_dt_to", model1.getValue("/root/reqData/multiUpDate/rcpm_dt"));
								model1.refresh();
							}
							resetForms();
							button1.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="button9" class="btn03" style="left:513px; top:0px; width:63px; height:21px; ">
				<caption>엑셀저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
						datagrid1.saveExcel(filename, "sheetname:sheet1;colhiddenextend:false;rowhiddenextend:false;exportfalsecols:0;row_0,row_1:label;");
					]]>
				</script>
			</button>
			<button id="button10" class="btn05" style="left:760px; top:0px; width:111px; height:21px; ">
				<caption>자산매각입금명세서</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var slip_no = model.getValue("/root/reqData/multiUpDate/actu_slip");
						//alert(slip_no.substring(0,8)+"::::"+slip_no.substring(12));					
						if (slip_no == "") {
							alert("출력대상을 선택하십시오.");
							return;
						}
						
						//오즈관련 노드초기화
						resetOznode();						
						//ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅
						makeNodeValue("/root/oz_data/ozrName", "as/SP_AS_ASPR_1310_P");
						var cmpycd = getProperty("ss_cmpycd");
						//odi파라미터 설정
						makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd", getProperty("ss_cmpycd"));
						makeNodeValue("/root/oz_data/odiParam/iv_actu_slip_dt", slip_no.substring(0,8));
						makeNodeValue("/root/oz_data/odiParam/iv_actu_slip_no", slip_no.substring(12));
						//makeNodeValue("/root/oz_data/odiParam/iv_dept_nm", getProperty("ss_deptcd"));
						//if (cmpycd == "100"){
						//	makeNodeValue("/root/oz_data/odiParam/iv_dept_nm", "자산팀");
						//}else{
						//	makeNodeValue("/root/oz_data/odiParam/iv_dept_nm", "총무팀");
						//}						
						makeNodeValue("/root/oz_data/odiParam/iv_dept_nm", getProperty("ss_deptnm"));
						makeNodeValue("/root/oz_data/odiParam/iv_chrg_emp_nm", getProperty("ss_emp_nm"));					
					
						//레포트뷰어 호출
						openOzwin("/root/oz_data");							
						
					]]>
				</script>
			</button>
		</group>
		<caption id="caption7" class="tit01" style="left:10px; top:5px; width:315px; height:27px; ">자산입금등록/수정</caption>
		<datagrid id="datagrid5" nodeset="/root/resData/gridData5/record" visibility="hidden" caption="occr_dt^occr_seq" colsep="#" colwidth="90, 90" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" navindex="23" style="left:370px; top:595px; width:202px; height:104px; ">
			<col ref="occr_dt" format="yyyy-mm-dd" style="text-align:center; "/>
			<col ref="occr_seq"/>
		</datagrid>
	</xhtml:body>
</xhtml:html>
