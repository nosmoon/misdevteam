<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session>
							<uid/>
							<cmpy_cd/>
							<emp_no/>
							<emp_nm/>
							<dept_cd/>
							<dept_nm/>
						</session>
						<!-- 선택계열의 정보를 담당 -->
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<datas/>
						<comboSet>
							<XX_COMBO_010>
								<record>
									<cd_nm/>
									<cd/>
								</record>
							</XX_COMBO_010>
							<chg_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</chg_clsf>
						</comboSet>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						<pageInfo>
						</pageInfo>
					</initData>
					<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
					<reqData>
						<!-- 검색조건 처리 -->
						<searchData>
							<fr_chg_dt/>
							<to_chg_dt/>
							<chg_clsf/>
							<searchDetail>
								<chg_clsf/>
								<occr_dt/>
								<occr_seq/>
								<ndduc_year/>
								<ndduc_prd_clsf/>
							</searchDetail>
							<cmpy_cd/>
						</searchData>
						<!-- 등록/수정/삭제 요청 Form Data -->
						<reqForm>
							<clos_yymm/>
						</reqForm>
						<!-- MultiUpDate유형 사용시 처리 -->
						<multiUpDate>
						</multiUpDate>
						<!-- POPUP 페이지 Forward Data -->
						<fwdData>
							<chg_clsf/>
							<func_nm/>
							<aset_no_list/>
							<chg_dt/>
							<occr_seq/>
							<aset_no/>
						</fwdData>
					</reqData>
					<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
					<resData>
						<!-- 전달 받은 리스트 데이터를 담당 ( submit의 결과가 담김) -->
						<gridData1>
							<record>
								<selected/>
								<chg_dt/>
								<chg_clsf_nm/>
								<remk/>
								<update/>
								<chg_tot_amt/>
								<vat_tot_amt/>
								<rcpm_tot_amt/>
								<dlco_nm/>
								<tax_stmt_no/>
								<slip_no/>
								<incmg_dt_tm/>
								<incmg_pers/>
								<chg_clsf/>
								<occr_dt/>
								<occr_seq/>
								<ndduc_year/>
								<ndduc_prd_clsf/>
							</record>
						</gridData1>
						<gridData2>
							<record>
								<aset_no/>
								<aset_nm/>
								<chg_amt/>
								<chg_vat_amt/>
								<hsty_cnt/>
								<hsty_dlco_ern/>
								<dlco_nm/>
								<remk/>
								<chg_clsf/>
								<occr_dt/>
								<occr_seq/>
								<sub_seq/>
							</record>
						</gridData2>
						<gridData3>
							<record>
								<aset_no/>
								<aset_nm/>
								<befo_dept_nm/>
								<befo_loca/>
								<now_dept_nm/>
								<now_loca/>
								<remk/>
								<hsty_cnt/>
								<dlco_nm/>
								<chg_clsf/>
								<occr_dt/>
								<occr_seq/>
								<sub_seq/>
							</record>
						</gridData3>
						<gridData4>
							<record>
								<budg_nm/>
								<aset_no/>
								<aset_nm/>
								<ndduc_rate/>
								<ndduc_amt/>
								<chg_vat_amt/>
								<add_vat/>
								<acct_agg_amt/>
								<budg_cd/>
							</record>
						</gridData4>
						<gridData5>
							<record>
								<aset_no/>
								<aset_nm/>
								<cur_acqr_amt/>
								<tot_redm_amt/>
								<un_redm_amt/>
								<chg_amt/>
								<chg_vat_amt/>
								<sale_pfls_amt/>
								<remk/>
							</record>
						</gridData5>
						<gridData6>
							<record>
								<aset_no/>
								<aset_nm/>
								<cur_acqr_amt/>
								<tot_redm_amt/>
								<un_redm_amt/>
								<sale_pfls_amt/>
								<remk/>
							</record>
						</gridData6>
						<gridData7>
							<record>
								<aset_no/>
								<aset_nm/>
								<dept_nm/>
								<acqr_dt/>
								<orgin_acqr_amt/>
								<buy_clsf_nm/>
								<aset_qunt_cnt/>
								<aset_usag/>
								<aset_size/>
								<aset_loca/>
							</record>
						</gridData7>
						<gridData8>
							<record>
								<rcpm_dt/>
								<rcpm_clsf/>
								<rcpm_amt/>
								<actu_slip/>
								<rmtt_dt/>
								<rmtt_plac/>
								<remk/>
							</record>
						</gridData8>
						<gridData9>
							<record>
								<occr_dt/>
								<occr_seq/>
								<chg_clsf/>
							</record>
						</gridData9>
						<!-- 전달 받은 Msg를 담당 ( submit의 결과가 담김) -->
						<msg>
							<errCode/>
							<errMsg/>
						</msg>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<resForm>
						</resForm>
					</resData>
					<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
					<tempData>
					</tempData>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					function procActuSlip(mode) {
						model1.removeNodeSet("/root/resData/gridData9");
						model1.makeNode("/root/resData/gridData9");
						model1.makeNode("/root/resData/gridData9/record");
						model1.makeNode("/root/resData/gridData9/record/occr_dt");
						model1.makeNode("/root/resData/gridData9/record/occr_seq");
						model1.makeNode("/root/resData/gridData9/record/chg_clsf");
	
						var node = instance1.selectSingleNode("/root/resData/gridData9/record");
						var copyedNode = node.cloneNode(true);
	
						var idx = 0;
						var selected_rows = 0;
						for (i = 1; i < grd_aset_chg.rows; i++) {
							if (grd_aset_chg.valueMatrix(i, 1) == "true") {
								if (selected_rows != 0) {
									instance1.selectSingleNode("/root/resData/gridData9").appendChild(copyedNode);
	
									model1.setValue("/root/resData/gridData9/record["+(selected_rows+1)+"]/occr_dt", grd_aset_chg.valueMatrix(i, 15));
									model1.setValue("/root/resData/gridData9/record["+(selected_rows+1)+"]/occr_seq", grd_aset_chg.valueMatrix(i, 16));
									model1.setValue("/root/resData/gridData9/record["+(selected_rows+1)+"]/chg_clsf", grd_aset_chg.valueMatrix(i, 14));
								} else {
									model1.setValue("/root/resData/gridData9/record/occr_dt", grd_aset_chg.valueMatrix(i, 15));
									model1.setValue("/root/resData/gridData9/record/occr_seq", grd_aset_chg.valueMatrix(i, 16));
									model1.setValue("/root/resData/gridData9/record/chg_clsf", grd_aset_chg.valueMatrix(i, 14));
								}
								selected_rows++;
							}
						}
						datagrid9.refresh();
						
						for (i = 1; i < datagrid9.rows; i++)
							datagrid9.addStatus(i, 1);
							
						
						model1.makeNode("/root/reqData/multiUpDate/job_mode");
						model1.makeNode("/root/reqData/multiUpDate/multiUpdateData");
						model1.setValue("/root/reqData/multiUpDate/job_mode", mode);
						model1.setValue("/root/reqData/multiUpDate/multiUpdateData", datagrid9.getUpdateData());
						
						model1.send("as_aset_1110");
						
						if (submit_completed()) {
							var fr_chg_dt = model1.getValue("/root/reqData/searchData/fr_chg_dt");
							var to_chg_dt = model1.getValue("/root/reqData/searchData/to_chg_dt");
							var chg_clsf = model1.getValue("/root/reqData/searchData/chg_clsf");
							model1.reset();
							model1.setValue("/root/reqData/searchData/fr_chg_dt", fr_chg_dt);
							model1.setValue("/root/reqData/searchData/to_chg_dt", to_chg_dt);
							model1.setValue("/root/reqData/searchData/chg_clsf", chg_clsf);
							button9.dispatch("onclick");
						}
					}
					
					function getAsetChgList() {
						var pattern = ","+grd_aset_chg.valueMatrix(selectedIdx, 14)+",";
						var validation  = (","+model1.getValue("/root/initData/datas/xx_cd_020")+",").indexOf(pattern)>-1;

						var selectedIdx = grd_aset_chg.row;
						model1.setValue("/root/reqData/searchData/searchDetail/chg_clsf", grd_aset_chg.valueMatrix(selectedIdx, 14));
						model1.setValue("/root/reqData/searchData/searchDetail/occr_dt", grd_aset_chg.valueMatrix(selectedIdx, 15));
						model1.setValue("/root/reqData/searchData/searchDetail/occr_seq", grd_aset_chg.valueMatrix(selectedIdx, 16));
						
						//매각일 경우만 입금등록 버튼을 활성화 함.
						//if (grd_aset_chg.valueMatrix(selectedIdx, 14) == "K") { 120224
						if (grd_aset_chg.valueMatrix(selectedIdx, 14) == model1.getValue("/root/initData/datas/xx_cd_013")) {
							if (grd_aset_chg.valueMatrix(selectedIdx, 11) == "")
								button2.disabled = true;
							else
								button2.disabled = false;
						}
						else
							button2.disabled = true;
						
						//입금내역조회 그리드 초기화
						model1.removeNodeset("/root/resData/gridData8");
						model1.makeNode("/root/resData/gridData8");
						datagrid2.refresh();
						datagrid2.addRow();
	
						//원가가산
						//if (grd_aset_chg.valueMatrix(selectedIdx, 14) == "L") { 120224
						if (grd_aset_chg.valueMatrix(selectedIdx, 14) == model1.getValue("/root/initData/datas/xx_cd_010")) {
							btnT1.disabled = false;
							btnT1.dispatch("onclick");
							btnT2.disabled = true;
							btnT3.disabled = true;
							btnT4.disabled = true;
							btnT5.disabled = true;
							btnT6.disabled = true;
							model1.send("as_aset_1103");
							model1.copyNode("/root/resData/gridData2","/root/tempData/dataSet/CURLIST");
						}
						//부서이동
						//else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == "I") { 120224
						else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == model1.getValue("/root/initData/datas/xx_cd_011")) {
							btnT2.disabled = false;
							btnT2.dispatch("onclick");
							btnT1.disabled = true;
							btnT3.disabled = true;
							btnT4.disabled = true;
							btnT5.disabled = true;
							btnT6.disabled = true;
							model1.send("as_aset_1104");
							model1.copyNode("/root/resData/gridData3","/root/tempData/dataSet/CURLIST");
						}
						//부가세불공제가산
						//else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == "V") { 120224
						else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == model1.getValue("/root/initData/datas/xx_cd_012")) {
							btnT3.disabled = false;
							btnT3.dispatch("onclick");
							btnT1.disabled = true;
							btnT2.disabled = true;
							btnT4.disabled = true;
							btnT5.disabled = true;
							btnT6.disabled = true;
							model1.setValue("/root/reqData/searchData/searchDetail/ndduc_year", grd_aset_chg.valueMatrix(selectedIdx, 17));
							model1.setValue("/root/reqData/searchData/searchDetail/ndduc_prd_clsf", grd_aset_chg.valueMatrix(selectedIdx, 18));
							model1.send("as_aset_1403");
							model1.copyNode("/root/resData/gridData4", "/root/tempData/dataSet/CURLIST");
							model1.refresh();
							
							if (datagrid1.rows == 1) {
								datagrid1.addRow();
							} else {
								var acct_agg_amt = 0;
								var budg_cd = "";
								for (i = 1; i < datagrid1.rows; i++) {
									datagrid1.cellstyle("background-color", i, 8, i, 8) = "#FFFFFF"; // 백그라운드 컬러 초기화
									acct_agg_amt += parseInt(model1.getValue("/root/resData/gridData4/record["+(i)+"]/add_vat"));
									model1.setValue("/root/resData/gridData4/record["+(i)+"]/acct_agg_amt", acct_agg_amt);
									budg_cd = model1.getValue("/root/resData/gridData4/record["+(i)+"]/budg_cd");
									if (i == datagrid1.rows-1) {
										datagrid1.cellstyle("background-color", i, 8, i, 8) = "#FFF000";
									} else {
										if (budg_cd != model1.getValue("/root/resData/gridData4/record["+(i+1)+"]/budg_cd")) {
											acct_agg_amt = 0;
											datagrid1.cellstyle("background-color", i, 8, i, 8) = "#FFF000";
										}
									}
								}
								datagrid1.refresh();
							}
						}
						//매각
						//else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == "K") { 120224
						else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == model1.getValue("/root/initData/datas/xx_cd_013")) {
							btnT4.disabled = false;
							btnT4.dispatch("onclick");
							btnT1.disabled = true;
							btnT2.disabled = true;
							btnT3.disabled = true;
							btnT5.disabled = true;
							btnT6.disabled = true;
							model1.send("as_aset_1106");
							model1.copyNode("/root/resData/gridData5","/root/tempData/dataSet/CURLIST");
							model1.removeNodeset("/root/tempData/dataSet");
							
							//매각에 대한 입금내역 조회
							model1.send("as_aset_1109");
							model1.copyNode("/root/resData/gridData8", "/root/tempData/dataSet/CURLIST");
							model1.removeNodeset("/root/tempData/dataSet");
							model1.refresh();
							if (datagrid2.rows == 1)
								datagrid2.addRow();
						}
						//폐기
						//else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == "J") { 120224
						else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == model1.getValue("/root/initData/datas/xx_cd_014")) {
							btnT5.disabled = false;
							btnT5.dispatch("onclick");
							btnT1.disabled = true;
							btnT2.disabled = true;
							btnT3.disabled = true;
							btnT4.disabled = true;
							btnT6.disabled = true;
							model1.send("as_aset_1107");
							model1.copyNode("/root/resData/gridData6","/root/tempData/dataSet/CURLIST");
						}
						//취득
						
						/* 120224
						else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == "A" ||
						         grd_aset_chg.valueMatrix(selectedIdx, 14) == "B" ||
						         grd_aset_chg.valueMatrix(selectedIdx, 14) == "C" ||
						         grd_aset_chg.valueMatrix(selectedIdx, 14) == "D" ||
						         grd_aset_chg.valueMatrix(selectedIdx, 14) == "E" ||
						         grd_aset_chg.valueMatrix(selectedIdx, 14) == "F" ||
						         grd_aset_chg.valueMatrix(selectedIdx, 14) == "G" ||
						         grd_aset_chg.valueMatrix(selectedIdx, 14) == "S") {*/
						else if (validation) {
								btnT6.disabled = false;
								btnT6.dispatch("onclick");
								btnT1.disabled = true;
								btnT2.disabled = true;
								btnT3.disabled = true;
								btnT4.disabled = true;
								btnT5.disabled = true;
								model1.send("as_aset_1108");
								model1.copyNode("/root/resData/gridData7","/root/tempData/dataSet/CURLIST");
						}
						model1.removeNodeset("/root/tempData/dataSet");
						model1.refresh();
						
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					// session 정보 셋팅
					model.setValue("/root/initData/session/uid", getProperty("ss_uid")); 		     	// 아이디
					model.setValue("/root/initData/session/cmpy_cd", getProperty("ss_cmpycd"));		// 회사
					model.setValue("/root/initData/session/emp_no", getProperty("ss_emp_no"));      	// 사번
					model.setValue("/root/initData/session/emp_nm", getProperty("ss_emp_nm"));     	// 성명
					model.setValue("/root/initData/session/dept_cd", getProperty("ss_deptcd"));      	// 부서
					model.setValue("/root/initData/session/dept_nm", getProperty("ss_deptnm"));      	// 부서명
					
					//변동일자 초기값
					/*
					var now = new Date();
					var year = now.getYear();
					var month = now.getMonth()+1;
					var date = now.getDate();
					if(month < 10)
						month = "0" + month;
					if(date < 10)
						date = "0" + date;
					today = year + month + date;
					*/
					var yyyymm  = getCurrentMonth();
					var yyyymmdd  = getCurrentDate();
					model1.setValue("/root/reqData/searchData/fr_chg_dt", yyyymm +"01");
					model1.setValue("/root/reqData/searchData/to_chg_dt", yyyymmdd);
					
				     if(model1.getValue("/root/initData/session/uid")=="c192043"){     //c183069->192043 20170713 봉은정변경            
					  model1.setValue("/root/reqData/searchData/fr_chg_dt", "20170613");
					  model1.setValue("/root/reqData/searchData/to_chg_dt", "20170613");
					  input1.disabled = true;                  
					  input2.disabled = true;
				   }else{
					  model1.setValue("/root/reqData/searchData/fr_chg_dt", yyyymm +"01");
					  model1.setValue("/root/reqData/searchData/to_chg_dt", yyyymmdd);
				   }

/*                           // 취득자산일괄조회
				model1.send("as_asrd_1301");
				makeComboSet("", "/root/tempData/dataSet/CURLIST1/record", "/root/initData/comboSet/aset_stat", "cdabrvnm_cd", "cd");
				model1.removeNodeset("/root/tempData/dataSet");
 CDNM VARCHAR2 CD_ABRV_NM VARCHAR2 CDNM_CD VARCHAR2 CDABRVNM_CD
 /root/initData/comboSet/aset_stat/item
 /root/initData/comboSet/chg_clsf/item
 
*/					
					// 변동구분
					model1.send("as_aset_1101");
				    makeComboSet("", "/root/tempData/dataSet/CURLIST1/record", "/root/initData/comboSet/chg_clsf", "cdabrvnm_cd", "cd");
				    makeComboSet("", "/root/tempData/dataSet/CURLIST1/record", "/root/initData/comboSet/chg_clsf", "cdabrvnm_cd", "cd");
				    model1.copyNode("/root/initData/comboSet/XX_COMBO_010","/root/tempData/dataSet/XX_COMBO_010"); 
				    model1.copyNode("/root/initData/datas","/root/tempData/dataSet/datas");
				   
	//			model1.copyNode("/root/initData/comboSet/chg_clsf","/root/tempData/dataSet/CURLIST1/chg_clsf");
					model1.removeNodeset("/root/tempData/dataSet");
					model1.refresh();
					btnT1.dispatch("onclick");
					
					//최종마감년월을 세팅한다.
					model1.send("as_aset_1010");
					model1.setValue("/root/reqData/reqForm/clos_yymm" , model1.getValue("/root/tempData/dataSet/CURLIST/record/clos_yymm") );
					model1.removeNodeset("/root/tempData/dataSet");
					model1.refresh();
					
					/*
					alert(model1.getValue("/root/initData/datas/xx_cd_010"));
					alert(model1.getValue("/root/initData/datas/xx_cd_011"));
					alert(model1.getValue("/root/initData/datas/xx_cd_012"));
					alert(model1.getValue("/root/initData/datas/xx_cd_013"));
					alert(model1.getValue("/root/initData/datas/xx_cd_014"));
					alert(model1.getValue("/root/initData/datas/xx_cd_015"));
					alert(model1.getValue("/root/initData/datas/xx_cd_020"));
					alert(model1.getValue("/root/initData/datas/xx_srch_slip_clsf_cd"));
					*/
					
				]]>
			</script>
			<submission id="as_aset_1101" action="/as/aset/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1102" action="/as/aset/1102" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1103" action="/as/aset/1103" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchDetail" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1104" action="/as/aset/1104" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchDetail" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1105" action="/as/aset/1105" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchDetail" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1106" action="/as/aset/1106" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchDetail" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1107" action="/as/aset/1107" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchDetail" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1108" action="/as/aset/1108" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchDetail" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1109" action="/as/aset/1109" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchDetail" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1403" action="/as/aset/1403" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchDetail" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1010" action="/as/aset/1010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1110" action="/as/aset/1110" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/tempData/msgData"/>
		</model>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/as_common.js"/>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="2,34;2,39;2,40;2,70;1,992;1,948;" style="font-family:굴림; ">
		<group id="group_btnT" class="gro_tab" style="left:10px; top:527px; width:938px; height:178px; ">
			<caption id="caption37" class="tabline" style="left:0px; top:22px; width:925px; height:1px; "/>
			<button id="btnT1" class="tab05" group="tab" selected="true" style="left:0px; top:0px; width:92px; height:23px; ">
				<caption>가  산</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case1");
						model.refresh();
					]]>
				</script>
			</button>
			<button id="btnT2" class="tab05" group="tab" style="left:92px; top:0px; width:92px; height:23px; ">
				<caption>부서이동</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case2");
						model.refresh();
					]]>
				</script>
			</button>
			<button id="btnT3" class="tab05" group="tab" style="left:184px; top:0px; width:92px; height:23px; ">
				<caption>부가세불공제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case3");
						model.refresh();
					]]>
				</script>
			</button>
			<button id="btnT4" class="tab05" group="tab" style="left:276px; top:0px; width:92px; height:23px; ">
				<caption>매  각</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case4");
						model.refresh();
					]]>
				</script>
			</button>
			<button id="btnT5" class="tab05" group="tab" style="left:368px; top:0px; width:92px; height:23px; ">
				<caption>폐  기</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case5");
						model.refresh();
					]]>
				</script>
			</button>
			<button id="btnT6" class="tab05" group="tab" style="left:460px; top:0px; width:92px; height:23px; ">
				<caption>취  득</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case6");
						model.refresh();
					]]>
				</script>
			</button>
			<button id="button8" class="btn_grid04" disabled="false" style="left:781px; top:4px; width:65px; height:17px; ">
				<caption>자산관리</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[

                                             // 가산
                                             if (btnT1.disabled == false ) {
                                             	
							var i = grd_aset_chg_add.row;

							if (i==-1) { alert("자산변동이력정보의 자산을 먼저 선택하세요"); return }
							
							model1.property("aset_no")  = grd_aset_chg_add.valueMatrix(i, 1);
							model1.property("pop_clsf") = "popup";
//							viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASET_1000");              
						       viewer("mainFrame").window.javaScript.onLoadPage2("AS_ASET_1000");	                               	
                                             // 부서이동
                                             } if (btnT2.disabled == false ) {
							var i = grd_aset_chg_move.row;

							if (i==-1) { alert("자산변동이력정보의 자산을 먼저 선택하세요"); return }
							
							model1.property("aset_no")  = grd_aset_chg_move.valueMatrix(i, 1);
							model1.property("pop_clsf") = "popup";
//							viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASET_1000");            
						       viewer("mainFrame").window.javaScript.onLoadPage2("AS_ASET_1000");	                               								                                 	
                                             // 부가세불공제
                                             } if (btnT3.disabled == false ) {
							var i = datagrid1.row;

							if (i==-1) { alert("자산변동이력정보의 자산을 먼저 선택하세요"); return }
							
							model1.property("aset_no")  = datagrid1.valueMatrix(i, 2);
							model1.property("pop_clsf") = "popup";
//							viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASET_1000");    
						       viewer("mainFrame").window.javaScript.onLoadPage2("AS_ASET_1000");	                               								                                 								                                         	
                                             // 매각
                                             } if (btnT4.disabled == false ) {
							var i = grd_aset_chg_sale.row;

							if (i==-1) { alert("자산변동이력정보의 자산을 먼저 선택하세요"); return }
							
							model1.property("aset_no")  = grd_aset_chg_sale.valueMatrix(i, 1);
							model1.property("pop_clsf") = "popup";
//							viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASET_1000");                                             	
						       viewer("mainFrame").window.javaScript.onLoadPage2("AS_ASET_1000");	                               								                                 								                                         	

                                             // 폐기
                                             } if (btnT5.disabled == false ) {
							var i = datagrid4.row;

							if (i==-1) { alert("자산변동이력정보의 자산을 먼저 선택하세요"); return }
							
							model1.property("aset_no")  = datagrid4.valueMatrix(i, 1);
							model1.property("pop_clsf") = "popup";
//							viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASET_1000");                                             	
 						       viewer("mainFrame").window.javaScript.onLoadPage2("AS_ASET_1000");	                               								                                 								                                         	
                                            // 취득
                                             } if (btnT6.disabled == false ) {
							var i = datagrid3.row;

							if (i==-1) { alert("자산변동이력정보의 자산을 먼저 선택하세요"); return }
							
							model1.property("aset_no")  = datagrid3.valueMatrix(i, 1);
							model1.property("pop_clsf") = "popup";
//							viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASET_1000");   
						       viewer("mainFrame").window.javaScript.onLoadPage2("AS_ASET_1000");	                               								                                 								                                         								                                          	
                                             }                                                                                                                                                                                                                        
				]]>
				</script>
			</button>
			<button id="button10" class="btn_grid04" disabled="false" style="left:854px; top:4px; width:74px; height:17px; ">
				<caption>이력조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
                                             // 가산
                                             if (btnT1.disabled == false ) {
                                             	
							var i = grd_aset_chg_add.row;

							if (i==-1) { alert("자산변동이력정보의 자산을 먼저 선택하세요"); return }
							
							model1.property("aset_no")  = grd_aset_chg_add.valueMatrix(i, 1);
							model1.property("pop_clsf") = "popup";
//							viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASRD_1400");   
						       viewer("mainFrame").window.javaScript.onLoadPage2("AS_ASRD_1400");      							
//							model1.property("pop_clsf") = "";  //초기화.
//							model1.property("aset_no") = "";  //초기화.								                                          	
                                             // 부서이동
                                             } if (btnT2.disabled == false ) {
							var i = grd_aset_chg_move.row;

							if (i==-1) { alert("자산변동이력정보의 자산을 먼저 선택하세요"); return }
							
							model1.property("aset_no")  = grd_aset_chg_move.valueMatrix(i, 1);
							model1.property("pop_clsf") = "popup";
//							viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASRD_1400");      
						       viewer("mainFrame").window.javaScript.onLoadPage2("AS_ASRD_1400");    							
//							model1.property("pop_clsf") = "";  //초기화.
//							model1.property("aset_no") = "";  //초기화.							                                       	
                                             // 부가세불공제
                                             } if (btnT3.disabled == false ) {
							var i = datagrid1.row;

							if (i==-1) { alert("자산변동이력정보의 자산을 먼저 선택하세요"); return }
							
							model1.property("aset_no")  = datagrid1.valueMatrix(i, 2);
							model1.property("pop_clsf") = "popup";
//							viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASRD_1400");       
						       viewer("mainFrame").window.javaScript.onLoadPage2("AS_ASRD_1400");     							
//							model1.property("pop_clsf") = "";  //초기화.
//							model1.property("aset_no") = "";  //초기화.							                                      	
                                             // 매각
                                             } if (btnT4.disabled == false ) {
							var i = grd_aset_chg_sale.row;

							if (i==-1) { alert("자산변동이력정보의 자산을 먼저 선택하세요"); return }
							
							model1.property("aset_no")  = grd_aset_chg_sale.valueMatrix(i, 1);
							model1.property("pop_clsf") = "popup";
//							viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASRD_1400");     
						       viewer("mainFrame").window.javaScript.onLoadPage2("AS_ASRD_1400");      							
//							model1.property("pop_clsf") = "";  //초기화.
//							model1.property("aset_no") = "";  //초기화.							                                        	
                                             // 폐기
                                             } if (btnT5.disabled == false ) {
							var i = datagrid4.row;

							if (i==-1) { alert("자산변동이력정보의 자산을 먼저 선택하세요"); return }
							
							model1.property("aset_no")  = datagrid4.valueMatrix(i, 1);
							model1.property("pop_clsf") = "popup";
//							viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASRD_1400");   
						       viewer("mainFrame").window.javaScript.onLoadPage2("AS_ASRD_1400");							   
//							model1.property("pop_clsf") = "";  //초기화.
//							model1.property("aset_no") = "";  //초기화.							                                       	
                                             // 취득
                                             } if (btnT6.disabled == false ) {
							var i = datagrid3.row;

							if (i==-1) { alert("자산변동이력정보의 자산을 먼저 선택하세요"); return }
							
							model1.property("aset_no")  = datagrid3.valueMatrix(i, 1);
							model1.property("pop_clsf") = "popup";
//							viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASRD_1400");           
						       viewer("mainFrame").window.javaScript.onLoadPage2("AS_ASRD_1400");
//							model1.property("pop_clsf") = "";  //초기화.
//							model1.property("aset_no") = "";  //초기화.							                                  	
                                             }  
				]]>
				</script>
			</button>
		</group>
		<switch id="switch1" style="left:10px; top:550px; width:925px; height:170px; ">
			<case id="case1" scroll="none" style="left:0px; top:0px; width:923px; height:243px; ">
				<group id="group1" class="gro_tab1" style="left:0px; top:0px; width:937px; height:170px; ">
					<datagrid id="grd_aset_chg_add" nodeset="/root/resData/gridData2/record" scroll="auto" caption="자산번호^자산명^가산금액^부가세^수량,면적^거래처코드^거래처명^세부항목 비고^chg_clsf^occr_dt^occr_seq^sub_seq" colsep="^" colwidth="83, 256, 92, 86, 120, 89, 156, 229, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:5px; top:5px; width:913px; height:135px; ">
						<col ref="aset_no" format="yyyy-mm-dd" style="text-align:center; "/>
						<col ref="aset_nm" style="text-align:left; "/>
						<col ref="chg_amt" format="#,###" style="text-align:right; "/>
						<col ref="chg_vat_amt" format="#,###" style="text-align:right; "/>
						<col ref="hsty_cnt" format="#,###" style="text-align:right; "/>
						<col ref="hsty_dlco_ern" style="text-align:center; "/>
						<col ref="dlco_nm" style="text-align:left; "/>
						<col ref="remk" style="text-align:left; "/>
						<col ref="chg_clsf" visibility="hidden"/>
						<col ref="occr_dt" visibility="hidden"/>
						<col ref="occr_seq" visibility="hidden"/>
						<col ref="sub_seq" visibility="hidden"/>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
/*							
							var i = grd_aset_chg_add.row;
							model1.property("aset_no")  = grd_aset_chg_add.valueMatrix(i, 1);
							model1.property("pop_clsf") = "popup";
							viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASET_1000");
*/							
							]]>
						</script>
					</datagrid>
				</group>
			</case>
			<case id="case2" selected="true" style="left:0px; top:0px; width:923px; height:243px; ">
				<datagrid id="grd_aset_chg_move" nodeset="/root/resData/gridData3/record" scroll="auto" caption="자산번호^자산명^전부서^전위치^현부서^현위치^비고^수량/면적^거래처명^chg_clsf^occr_dt^occr_seq^sub_seq" colsep="^" colwidth="78, 233, 129, 124, 120, 136, 207, 64, 182, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:5px; top:5px; width:913px; height:155px; ">
					<col ref="aset_no" format="yyyy-mm-dd" style="text-align:center; "/>
					<col ref="aset_nm" style="text-align:left; "/>
					<col ref="befo_dept_nm" style="text-align:left; "/>
					<col ref="befo_loca" style="text-align:left; "/>
					<col ref="now_dept_nm" style="text-align:left; "/>
					<col ref="now_loca" style="text-align:left; "/>
					<col ref="remk" style="text-align:left; "/>
					<col ref="hsty_cnt" visibility="hidden" style="text-align:right; "/>
					<col ref="dlco_nm" style="text-align:center; "/>
					<col ref="chg_clsf" visibility="hidden"/>
					<col ref="occr_dt" visibility="hidden"/>
					<col ref="occr_seq" visibility="hidden"/>
					<col ref="sub_seq" visibility="hidden"/>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
/*						
						var i = grd_aset_chg_move.row;
						model1.property("aset_no")  = grd_aset_chg_move.valueMatrix(i, 1);
						model1.property("pop_clsf") = "popup";
						viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASET_1000");
*/						
						]]>
					</script>
				</datagrid>
			</case>
			<case id="case3">
				<datagrid id="datagrid1" nodeset="/root/resData/gridData4/record" caption="계정분류^자산번호^자산명^불공제율^계정별불공제총액^부가세총액^원가가산액^계정별누계액^budg_cd" colsep="^" colwidth="114, 77, 287, 55, 101, 86, 73, 85, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:5px; top:5px; width:913px; height:155px; ">
					<col ref="budg_nm" style="text-align:left; "/>
					<col ref="aset_no" style="text-align:center; "/>
					<col ref="aset_nm" style="text-align:left; "/>
					<col ref="ndduc_rate" format="#,###.999" style="text-align:right; "/>
					<col ref="ndduc_amt" format="#,###" style="text-align:right; "/>
					<col ref="chg_vat_amt" format="#,###" style="text-align:right; "/>
					<col ref="add_vat" format="#,###" style="text-align:right; "/>
					<col ref="acct_agg_amt" format="#,###" style="text-align:right; "/>
					<col ref="budg_cd" visibility="hidden"/>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
/*						
						var i = datagrid1.row;
						model1.property("aset_no")  = datagrid1.valueMatrix(i, 2);
						model1.property("pop_clsf") = "popup";
						viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASET_1000");
*/						
						]]>
					</script>
				</datagrid>
			</case>
			<case id="case4">
				<datagrid id="grd_aset_chg_sale" nodeset="/root/resData/gridData5/record" visibility="visible" caption="자산번호^자산명칭^현취득금액^충당금누계^미상각잔액^매각액^부가세^처분손익^상세비고" colsep="#" colwidth="78, 212, 84, 86, 77, 81, 74, 83, 387" extendlastcol="scroll" mergecellsfixedrows="bycolrec" multitotal="true" rowheader="update" rowsep="|" style="left:5px; top:5px; width:913px; height:155px; ">
					<col ref="aset_no" style="text-align:center; "/>
					<col ref="aset_nm" style="text-align:left; "/>
					<col ref="cur_acqr_amt" format="#,###" style="text-align:right; "/>
					<col ref="tot_redm_amt" format="#,###" style="text-align:right; "/>
					<col ref="un_redm_amt" format="#,###" style="text-align:right; "/>
					<col ref="chg_amt" format="#,###" style="text-align:right; "/>
					<col ref="chg_vat_amt" format="#,###" style="text-align:right; "/>
					<col ref="sale_pfls_amt" format="(-)#,###" style="text-align:right; "/>
					<col ref="remk" style="text-align:left; "/>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
/*						
						var i = grd_aset_chg_sale.row;
						model1.property("aset_no")  = grd_aset_chg_sale.valueMatrix(i, 1);
						model1.property("pop_clsf") = "popup";
						viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASET_1000");
*/						
						]]>
					</script>
				</datagrid>
			</case>
			<case id="case5">
				<datagrid id="datagrid4" nodeset="/root/resData/gridData6/record" visibility="visible" caption="자산번호^자산명칭^현취득금액^충당금누계^미상각잔액^처분손익^상세비고" colsep="#" colwidth="80, 213, 100, 103, 99, 99, 200" extendlastcol="scroll" mergecellsfixedrows="bycolrec" multitotal="true" rowheader="update" rowsep="|" style="left:5px; top:5px; width:913px; height:155px; ">
					<col explorerbar="sortshow" ref="aset_no" style="text-align:center; "/>
					<col ref="aset_nm" style="text-align:left; "/>
					<col ref="cur_acqr_amt" format="#,###" style="text-align:right; "/>
					<col ref="tot_redm_amt" format="#,###" style="text-align:right; "/>
					<col ref="un_redm_amt" format="#,###" style="text-align:right; "/>
					<col ref="sale_pfls_amt" format="(-)#,###" style="text-align:right; "/>
					<col ref="remk" style="text-align:left; "/>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
/*						
						var i = datagrid4.row;
						model1.property("aset_no")  = datagrid4.valueMatrix(i, 1);
						model1.property("pop_clsf") = "popup";
						viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASET_1000");
*/						
						]]>
					</script>
				</datagrid>
			</case>
			<case id="case6">
				<datagrid id="datagrid3" nodeset="/root/resData/gridData7/record" caption="자산코드^자산명^부서^취득일자^원취득금액^구입구분^수량/면적^용도/지목^규격^위치" colsep="^" colwidth="74, 237, 122, 65, 90, 70, 62, 120, 171, 183" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:5px; top:5px; width:913px; height:155px; ">
					<col ref="aset_no" style="text-align:center; "/>
					<col ref="aset_nm" style="text-align:left; "/>
					<col ref="dept_nm" style="text-align:left; "/>
					<col ref="acqr_dt" format="yyyy-mm-dd" style="text-align:center; "/>
					<col ref="orgin_acqr_amt" format="#,###" style="text-align:right; "/>
					<col ref="buy_clsf_nm" style="text-align:center; "/>
					<col ref="aset_qunt_cnt" format="#,###" style="text-align:right; "/>
					<col ref="aset_usag" style="text-align:left; "/>
					<col ref="aset_size" style="text-align:left; "/>
					<col ref="aset_loca" style="text-align:left; "/>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
/*						
						var i = datagrid3.row;
						model1.property("aset_no")  = datagrid3.valueMatrix(i, 1);
						model1.property("pop_clsf") = "popup";
						viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASET_1000");
*/						
						]]>
					</script>
				</datagrid>
			</case>
		</switch>
		<group id="group_scr" class="gro_sel" style="left:10px; top:80px; width:926px; height:26px; ">
			<caption id="caption2" class="list_cap02" style="left:79px; top:0px; width:847px; height:26px; "/>
			<caption id="caption1" class="list_cap01" style="left:0px; top:0px; width:80px; height:26px; ">변동일자</caption>
			<input id="input1" ref="/root/reqData/searchData/fr_chg_dt" class="req" navindex="1" inputtype="date" style="left:85px; top:4px; width:85px; height:18px; "/>
			<input id="input2" ref="/root/reqData/searchData/to_chg_dt" class="req" navindex="2" inputtype="date" style="left:191px; top:4px; width:85px; height:18px; "/>
			<caption id="caption5" class="list_cap01" style="left:425px; top:0px; width:80px; height:26px; ">변동구분</caption>
			<select1 id="combo2" ref="/root/reqData/searchData/chg_clsf" navindex="3" appearance="minimal" style="left:510px; top:4px; width:110px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/chg_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<caption id="caption104" style="left:177px; top:3px; width:12px; height:20px; font-family:굴림체; ">~</caption>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:113px; width:926px; height:5px; "/>
		<group id="group_tit" class="gro_tit2" style="left:10px; top:128px; width:610px; height:25px; ">
			<caption id="subtitle" class="tit02" style="left:0px; top:0px; width:300px; height:20px; ">자산변동내역조회</caption>
		</group>
		<datagrid id="grd_aset_chg" nodeset="/root/resData/gridData1/record" caption="선택^변동일자^변동구분^비고^상세^변동금액^부가세액^입금총액^거래처^계산서^전표번호^작업일자^작업자^chg_clsf^occr_dt^occr_seq^ndduc_year^ndduc_prd_clsf" colsep="^" colwidth="34, 66, 82, 250, 30, 78, 73, 73, 138, 119, 96, 120, 48, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:10px; top:151px; width:925px; height:234px; ">
			<col ref="selected" type="checkbox"/>
			<col ref="chg_dt" format="yyyy-mm-dd" style="text-align:center; "/>
			<col ref="chg_clsf_nm" style="text-align:left; "/>
			<col ref="remk" style="text-align:left; "/>
			<col ref="update" style="background-image:../../../images/brow03_ov.gif; background-stretch:no-stretch; background-position:center; cursor:hand; "/>
			<col ref="chg_tot_amt" format="#,###" style="text-align:right; "/>
			<col ref="vat_tot_amt" format="#,###" style="text-align:right; "/>
			<col ref="rcpm_tot_amt" format="#,###" style="text-align:right; "/>
			<col ref="dlco_nm" style="text-align:left; "/>
			<col ref="tax_stmt_no" style="text-align:center; "/>
			<col ref="slip_no" style="text-align:center; "/>
			<col ref="incmg_dt_tm"/>
			<col ref="incmg_pers" style="text-align:center; "/>
			<col ref="chg_clsf" visibility="hidden"/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="occr_seq" visibility="hidden"/>
			<col ref="ndduc_year" visibility="hidden"/>
			<col ref="ndduc_prd_clsf" visibility="hidden"/>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					if (grd_aset_chg.row == 0)
						return;
						
					if (grd_aset_chg.col == 1)
						return;
					
					getAsetChgList();
				]]>
			</script>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if (grd_aset_chg.row == 0)
						return;
						
					if (grd_aset_chg.col == 1)
						return;
					
					var selectedIdx = grd_aset_chg.row;
					//그리드의 상세버튼을 클릭하였을 경우 변동구분에 해당하는 화면을 호출하여 오픈
					
					if (grd_aset_chg.col == 5 ) {
						//원가가산
						//if (grd_aset_chg.valueMatrix(selectedIdx, 14) == "L") { 120224
						if (grd_aset_chg.valueMatrix(selectedIdx, 14) == model1.getValue("/root/initData/datas/xx_cd_010")) {
							model1.makeNode("/root/reqData/fwdData/dt_clsf");
							model1.makeNode("/root/reqData/fwdData/seq_clsf");
							model1.setValue("/root/reqData/fwdData/dt_clsf", "2");
							//model1.setValue("/root/reqData/fwdData/chg_clsf", "L"); 120224
							model1.setValue("/root/reqData/fwdData/chg_clsf", model1.getValue("/root/initData/datas/xx_cd_010"));
							model1.setValue("/root/reqData/fwdData/chg_dt", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_dt"));
							model1.setValue("/root/reqData/fwdData/seq_clsf", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_seq"));
							
							window.load("./AS_ASET_1200.xrw","modal","AS_ASET_1200","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden; ","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");

							model1.removenode("/root/reqData/fwdData/dt_clsf");
							model1.removenode("/root/reqData/fwdData/seq_clsf");

							/*
							for (i = 0; i < window.mdiChildren.length;i++) {
								var child = window.mdiChildren.item(i);
								alert(child.attribute("id"));
								if (child.attribute("id") == "AS_ASET_1200") { 
									child.model1.setValue("/root/reqData/searchData/dt_clsf", "2");
									child.model1.setValue("/root/reqData/searchData/chg_clsf", "L");
									child.model1.setValue("/root/reqData/searchData/chg_dt", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_dt"));
									child.model1.setValue("/root/reqData/searchData/seq_clsf", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_seq"));
									child.model1.refresh();
								}
							}
							*/
						//부서이동
						//} else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == "I") { 120224
						} else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == model1.getValue("/root/initData/datas/xx_cd_011")) {
							model1.makeNode("/root/reqData/fwdData/dt_clsf");
							model1.makeNode("/root/reqData/fwdData/seq_clsf");
							model1.setValue("/root/reqData/fwdData/dt_clsf", "2");
							//model1.setValue("/root/reqData/fwdData/chg_clsf", "I"); 120224
							model1.setValue("/root/reqData/fwdData/chg_clsf", model1.getValue("/root/initData/datas/xx_cd_011"));
							model1.setValue("/root/reqData/fwdData/chg_dt", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_dt"));
							model1.setValue("/root/reqData/fwdData/seq_clsf", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_seq"));

							window.load("./AS_ASET_1300.xrw","modal","AS_ASET_1300","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden; ","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");

							model1.removenode("/root/reqData/fwdData/dt_clsf");
							model1.removenode("/root/reqData/fwdData/seq_clsf");

							/*
							for (i = 0; i < window.mdiChildren.length;i++) {
								var child = window.mdiChildren.item(i);
								if (child.attribute("id") == "AS_ASET_1300") { 
									child.model1.setValue("/root/reqData/searchData/dt_clsf", "2");
									child.model1.setValue("/root/reqData/searchData/chg_clsf", "I");
									child.model1.setValue("/root/reqData/searchData/chg_dt", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_dt"));
									child.model1.setValue("/root/reqData/searchData/seq_clsf", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_seq"));
									child.model1.refresh();
								}
							}
							*/
						//부가세불공제
						//} else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == "V") { 120224
						} else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == model1.getValue("/root/initData/datas/xx_cd_012")) {
							model1.makeNode("/root/reqData/fwdData/ndduc_year");
							model1.makeNode("/root/reqData/fwdData/ndduc_prd_clsf");
							model1.setValue("/root/reqData/fwdData/ndduc_year", grd_aset_chg.valueMatrix(selectedIdx, 17));
							model1.setValue("/root/reqData/fwdData/ndduc_prd_clsf", grd_aset_chg.valueMatrix(selectedIdx, 18));

							window.load("./AS_ASET_1400.xrw","modal","AS_ASET_1400","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden; ","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");

							model1.removenode("/root/reqData/fwdData/ndduc_year");
							model1.removenode("/root/reqData/fwdData/ndduc_prd_clsf");

							/*
							var ndduc_year = grd_aset_chg.valueMatrix(selectedIdx, 17);
							var ndduc_prd_clsf = grd_aset_chg.valueMatrix(selectedIdx, 18);
							for (i = 0; i < window.mdiChildren.length;i++) {
								var child = window.mdiChildren.item(i);
								if (child.attribute("id") == "AS_ASET_1400") {
									for (j = 1; j < child.datagrid1.rows; j++) {
										//alert(child.datagrid1.valueMatrix(j, 1) + ":" + child.datagrid1.valueMatrix(j, 6));
										if (ndduc_year == child.datagrid1.valueMatrix(j, 1) &&
										    ndduc_prd_clsf == child.datagrid1.valueMatrix(j, 6)) {
										    child.datagrid1.isSelected(j) = true;
										    child.datagrid1.dispatch("onclick");
										}
									}
								}
							}
							*/
						//매각
						//} else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == "K") { 120224
						} else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == model1.getValue("/root/initData/datas/xx_cd_013")) {
							model1.makeNode("/root/reqData/fwdData/dt_clsf");
							model1.makeNode("/root/reqData/fwdData/seq_clsf");
							model1.setValue("/root/reqData/fwdData/dt_clsf", "2");
							//model1.setValue("/root/reqData/fwdData/chg_clsf", "K"); 120224
							model1.setValue("/root/reqData/fwdData/chg_clsf", model1.getValue("/root/initData/datas/xx_cd_013"));
							model1.setValue("/root/reqData/fwdData/chg_dt", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_dt"));
							model1.setValue("/root/reqData/fwdData/seq_clsf", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_seq"));

							window.load("./AS_ASET_1500.xrw","modal","AS_ASET_1500","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden; ","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");

							model1.removenode("/root/reqData/fwdData/dt_clsf");
							model1.removenode("/root/reqData/fwdData/seq_clsf");

							/*
							for (i = 0; i < window.mdiChildren.length;i++) {
								var child = window.mdiChildren.item(i);
								if (child.attribute("id") == "AS_ASET_1500") { 
									child.model1.setValue("/root/reqData/searchData/dt_clsf", "2");
									child.model1.setValue("/root/reqData/searchData/chg_clsf", "K");
									child.model1.setValue("/root/reqData/searchData/chg_dt", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_dt"));

									child.model1.send("as_aset_1201");
									child.model1.copyNode("/root/initData/comboSet/seq_clsf","/root/tempData/dataSet/CURLIST/seq_clsf");
									child.model1.removeNodeset("/root/tempData/dataSet");
									child.model1.setValue("/root/reqData/searchData/seq_clsf", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_seq"));
									
									if (child.model1.getValue("/root/reqData/searchData/dt_clsf") == "1") {
										child.model1.setValue("/root/reqData/searchData/occr_dt", child.cbo_seq_clsf.label.substring(0,8));	
									} else {
										child.model1.setValue("/root/reqData/searchData/occr_dt", child.model1.getValue("/root/reqData/searchData/chg_dt"));
									}
									child.model1.setValue("/root/reqData/searchData/occr_seq", child.model1.getValue("/root/reqData/searchData/seq_clsf"));		
									child.model1.refresh();
									
									//child.javascript.getAsetSaleList();
								}
							}
							*/
						//폐기
						//} else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == "J") { 120224
						} else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == model1.getValue("/root/initData/datas/xx_cd_014")) {
							model1.makeNode("/root/reqData/fwdData/dt_clsf");
							model1.makeNode("/root/reqData/fwdData/seq_clsf");
							model1.setValue("/root/reqData/fwdData/dt_clsf", "2");
							//model1.setValue("/root/reqData/fwdData/chg_clsf", "J"); 120224
							model1.setValue("/root/reqData/fwdData/chg_clsf", model1.getValue("/root/initData/datas/xx_cd_014"));
							model1.setValue("/root/reqData/fwdData/chg_dt", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_dt"));
							model1.setValue("/root/reqData/fwdData/seq_clsf", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_seq"));

							window.load("./AS_ASET_1600.xrw","modal","AS_ASET_1600","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden; ","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");

							model1.removenode("/root/reqData/fwdData/dt_clsf");
							model1.removenode("/root/reqData/fwdData/seq_clsf");

							/*
							for (i = 0; i < window.mdiChildren.length;i++) {
								var child = window.mdiChildren.item(i);
								if (child.attribute("id") == "AS_ASET_1600") { 
									child.model1.setValue("/root/reqData/searchData/dt_clsf", "2");
									child.model1.setValue("/root/reqData/searchData/chg_clsf", "J");
									child.model1.setValue("/root/reqData/searchData/chg_dt", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_dt"));
									child.model1.setValue("/root/reqData/searchData/seq_clsf", model1.getValue("/root/resData/gridData1/record["+(grd_aset_chg.row)+"]/occr_seq"));
									child.model1.refresh();
								}
							}
							*/
						//지가관리
						//} else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == "W") { 120224
						} else if (grd_aset_chg.valueMatrix(selectedIdx, 14) == model1.getValue("/root/initData/datas/xx_cd_015")) {
//							model1.makeNode("/root/reqData/fwdData/ndduc_year");
//							model1.makeNode("/root/reqData/fwdData/ndduc_prd_clsf");
//							model1.setValue("/root/reqData/fwdData/ndduc_year", grd_aset_chg.valueMatrix(selectedIdx, 17));
//							model1.setValue("/root/reqData/fwdData/ndduc_prd_clsf", grd_aset_chg.valueMatrix(selectedIdx, 18));

							window.load("./AS_ASET_1900.xrw","modal","AS_ASET_1900","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden; ","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");

//							model1.removenode("/root/reqData/fwdData/ndduc_year");
//							model1.removenode("/root/reqData/fwdData/ndduc_prd_clsf");

						} else {
							    alert("신규자산입력 된 내역은  자산변동이력정보에서 자산 선택 후 [자산관리]에서  확인 하실 수 있읍니다. " );
						}
					}
				]]>
			</script>
		</datagrid>
		<group id="group2" class="gro_tit2" style="left:10px; top:504px; width:926px; height:25px; ">
			<caption id="caption3" class="tit02" style="left:0px; top:3px; width:926px; height:20px; ">자산변동이력정보</caption>
		</group>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:45px; width:926px; height:23px; ">
			<button id="button7" class="btn03" crud="C" style="left:532px; top:0px; width:63px; height:21px; ">
				<caption>엑셀저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
						grd_aset_chg.saveExcel(filename, "sheetname:sheet1;colhiddenextend:false;rowhiddenextend:false;exportfalsecols:0;row_0:label;");
					]]>
				</script>
			</button>
			<button id="button3" class="btn04" crud="C" style="left:599px; top:0px; width:86px; height:21px; ">
				<caption>현업전표생성</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var selected_rows = 0;
						for (i = 1; i < grd_aset_chg.rows; i++) {
							if (grd_aset_chg.valueMatrix(i, 1) == "true")
								selected_rows++;
						}
						
						if (selected_rows == 0) {
							alert("현업전표를 생성할 대상을 선택하십시오.");
							return;
						}
						
						if (!(window.alert("현업전표를 생성하시겠습니까?", "확인", 1) == 1))
							return;
						
						procActuSlip("I");
					]]>
				</script>
			</button>
			<button id="button4" class="btn04" crud="C" style="left:689px; top:0px; width:86px; height:21px; ">
				<caption>현업전표취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var selected_rows = 0;
						for (i = 1; i < grd_aset_chg.rows; i++) {
							if (grd_aset_chg.valueMatrix(i, 1) == "true")
								selected_rows++;
						}
						
						if (selected_rows == 0) {
							alert("현업전표를 취소할 대상을 선택하십시오.");
							return;
						}
						
						if (!(window.alert("현업전표를 취소하시겠습니까?", "확인", 1) == 1))
							return;
						
						procActuSlip("D");
					]]>
				</script>
			</button>
			<button id="button5" class="btn02" crud="C" style="left:471px; top:0px; width:53px; height:21px; ">
				<caption>등록</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var chg_clsf = model1.getValue("/root/reqData/fwdData/chg_clsf");
						model1.resetInstanceNode("/root/reqData/fwdData");
						model1.refresh();
						model1.setValue("/root/reqData/fwdData/chg_clsf", chg_clsf);
						
						/* 120224
						if (model1.getValue("/root/reqData/fwdData/chg_clsf") == "L") {
							window.load("./AS_ASET_1200.xrw","modal","AS_ASET_1200","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");
						} else if (model1.getValue("/root/reqData/fwdData/chg_clsf") == "I") {
							window.load("./AS_ASET_1300.xrw","modal","AS_ASET_1300","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");
						} else if (model1.getValue("/root/reqData/fwdData/chg_clsf") == "V") {
							window.load("./AS_ASET_1400.xrw","modal","AS_ASET_1400","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");
						} else if (model1.getValue("/root/reqData/fwdData/chg_clsf") == "K") {
							window.load("./AS_ASET_1500.xrw","modal","AS_ASET_1500","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");
						} else if (model1.getValue("/root/reqData/fwdData/chg_clsf") == "J") {
							window.load("./AS_ASET_1600.xrw","modal","AS_ASET_1600","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");
						} else if (model1.getValue("/root/reqData/fwdData/chg_clsf") == "W") {
							window.load("./AS_ASET_1900.xrw","modal","AS_ASET_1900","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");
						} else {
							alert("자산변동 구분을 선택하신 후 '등록'버튼을 클릭하십시오.");
						} */
						
						if (model1.getValue("/root/reqData/fwdData/chg_clsf") == model1.getValue("/root/initData/datas/xx_cd_010")) {
							window.load("./AS_ASET_1200.xrw","modal","AS_ASET_1200","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");
						} else if (model1.getValue("/root/reqData/fwdData/chg_clsf") == model1.getValue("/root/initData/datas/xx_cd_011")) {
							if(getProperty("ss_cmpycd") != "500"){
								window.load("./AS_ASET_1300.xrw","modal","AS_ASET_1300","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
							}else{
								window.load("./AS_ASET_1300_500.xrw","modal","AS_ASET_1300_500","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");

							}
							button9.dispatch("onclick");
						} else if (model1.getValue("/root/reqData/fwdData/chg_clsf") == model1.getValue("/root/initData/datas/xx_cd_012")) {
							window.load("./AS_ASET_1400.xrw","modal","AS_ASET_1400","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");
						} else if (model1.getValue("/root/reqData/fwdData/chg_clsf") == model1.getValue("/root/initData/datas/xx_cd_013")) {
							window.load("./AS_ASET_1500.xrw","modal","AS_ASET_1500","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");
						} else if (model1.getValue("/root/reqData/fwdData/chg_clsf") == model1.getValue("/root/initData/datas/xx_cd_014")) {
							window.load("./AS_ASET_1600.xrw","modal","AS_ASET_1600","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");
						} else if (model1.getValue("/root/reqData/fwdData/chg_clsf") == model1.getValue("/root/initData/datas/xx_cd_015")) {
							window.load("./AS_ASET_1900.xrw","modal","AS_ASET_1900","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
							button9.dispatch("onclick");
						} else {
							alert("자산변동 구분을 선택하신 후 '등록'버튼을 클릭하십시오.");
						}
					]]>
				</script>
			</button>
			<select1 id="radio1" ref="/root/reqData/fwdData/chg_clsf" appearance="full" cols="6" overflow="visible" style="left:124px; top:2px; width:341px; height:16px; border-style:none; ">
				<choices>
					<item>
						<label>가산</label>
						<value>L</value>
					</item>
					<item>
						<label>부서이동</label>
						<value>I</value>
					</item>
					<item>
						<label>불공가산</label>
						<value>V</value>
					</item>
					<item>
						<label>매각</label>
						<value>K</value>
					</item>
					<item>
						<label>폐기</label>
						<value>J</value>
					</item>
					<item>
						<label>공시지가</label>
						<value>W</value>
					</item>
					<!-- 120224
					
					
					<itemset nodeset="/root/initData/comboSet/XX_COMBO_010/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
					-->
				</choices>
			</select1>
			<button id="btnClose" class="btn02" style="left:869px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					]]>
				</script>
			</button>
			<button id="button9" class="btn02" crud="R" style="left:55px; top:0px; width:53px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.send("as_aset_1102");
						model1.copyNode("/root/resData/gridData1","/root/tempData/dataSet/CURLIST");
						model1.removeNodeset("/root/tempData/dataSet");
						model1.refresh();
						
						for (i = 1; i < grd_aset_chg.rows; i++) {
							//if (grd_aset_chg.valueMatrix(i, 14) == "J" || grd_aset_chg.valueMatrix(i, 14) == "K") 120224
							if (grd_aset_chg.valueMatrix(i, 14) == model1.getValue("/root/initData/datas/xx_cd_014") 
							 || grd_aset_chg.valueMatrix(i, 14) == model1.getValue("/root/initData/datas/xx_cd_013"))
								grd_aset_chg.isReadOnly(i, 1, i, 1) = false;
							else
								grd_aset_chg.isReadOnly(i, 1, i, 1) = true;
						}

						if (grd_aset_chg.rows == 1)
							grd_aset_chg.addRow();
					]]>
				</script>
			</button>
			<shape id="roundrect1" appearance="roundrect" ellipsewidth="20" ellipseheight="20" style="left:115px; top:0px; width:415px; height:20px; "/>
			<button id="button1" class="btn04" crud="C" style="left:779px; top:0px; width:86px; height:21px; ">
				<caption>세금계산서출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[

						var i = grd_aset_chg.row;

						if (i==-1) { alert("자산변동내역의 세금계산서 출력 대상을 먼저 선택하세요"); return }							
					
                                             var slip_no = grd_aset_chg.valueMatrix(i, 10);
//						alert(slip_no);
//						alert(slip_no.substring(6,14));
//						alert(slip_no.substring(15,20));	
						model.property("FC_ACCT_2180_srch_prof_type_cd")  = "";
						model.property("FC_ACCT_2180_srch_slip_occr_dt")  = slip_no.substring(6,14);
						//model.property("FC_ACCT_2180_srch_slip_clsf_cd")  = "96"; 120224
						model.property("FC_ACCT_2180_srch_slip_clsf_cd")  = model1.getValue("/root/initData/datas/xx_srch_slip_clsf_cd");
						model.property("FC_ACCT_2180_srch_slip_seq_fr")  = slip_no.substring(15,20);
						model.property("FC_ACCT_2180_srch_slip_seq_to")  = slip_no.substring(15,20);
						model.property("FC_ACCT_2180_popup_flag")  = "Y";
						
						// 화면호출
//						viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2180", "modal", "align:center; caption:hidden; width:650px; height:480px;");
						viewer("mainFrame").window.javaScript.onLoadPage2("FC_ACCT_2180");		
					]]>
				</script>
			</button>
		</group>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData8/record" caption="입금일자^입금구분^입금액^전표번호^송금일자^송금자^적요사항" colsep="^" colwidth="66, 100, 92, 107, 72, 170, 291" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:10px; top:415px; width:925px; height:86px; ">
			<col ref="rcpm_dt" format="yyyy-mm-dd" style="text-align:center; "/>
			<col ref="rcpm_clsf" style="text-align:center; "/>
			<col ref="rcpm_amt" format="#,###" style="text-align:right; "/>
			<col ref="actu_slip" style="text-align:center; "/>
			<col ref="rmtt_dt" format="yyyy-mm-dd" style="text-align:center; "/>
			<col ref="rmtt_plac" style="text-align:center; "/>
			<col ref="remk" style="text-align:left; "/>
		</datagrid>
		<group id="group3" class="gro_tit2" style="left:10px; top:390px; width:926px; height:25px; ">
			<caption id="caption4" class="tit02" style="left:0px; top:3px; width:926px; height:20px; ">입금내역조회</caption>
		</group>
		<button id="button2" class="btn_grid04" disabled="true" style="left:870px; top:395px; width:65px; height:17px; ">
			<caption>입금등록</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var selectedIdx = grd_aset_chg.row;
					model1.setValue("/root/reqData/fwdData/chg_dt", grd_aset_chg.valueMatrix(selectedIdx, 2));
					model1.setValue("/root/reqData/fwdData/occr_seq", grd_aset_chg.valueMatrix(selectedIdx, 16));
					model1.setValue("/root/reqData/fwdData/chg_clsf", model1.getValue("/root/initData/datas/xx_cd_013"));
					//viewer("mainFrame").window.javaScript.onLoadPopupPage("AS_ASET_1700");
					//window.load("./AS_ASET_1700.xrw","modal","AS_ASET_1700","left:0; top:0; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
					window.load("./AS_ASET_1700.xrw","modal","AS_ASET_1700","align:center; width:953px; height:760px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden; ","/root/reqData/fwdData","/root/reqData/fwdData");
					
					button9.dispatch("onclick");
					
					grd_aset_chg.select(selectedIdx, 1, selectedIdx, 13) = true;
					grd_aset_chg.col = 2;
					grd_aset_chg.row = selectedIdx;
					
					getAsetChgList();
				]]>
			</script>
		</button>
		<caption id="caption120" class="list_cap02" style="left:870px; top:123px; width:66px; height:24px; text-align:center; "/>
		<caption id="caption121" class="list_cap03" style="left:791px; top:123px; width:80px; height:24px; color:#0000ff; text-align:center; ">최종마감년월</caption>
		<output id="opt_clos_yymm" ref="/root/reqData/reqForm/clos_yymm" format="yyyy-mm" inputtype="input" appearance="output" style="left:875px; top:126px; width:56px; height:18px; text-align:center; "/>
		<datagrid id="datagrid9" nodeset="/root/resData/gridData9/record" visibility="hidden" caption="occr_dt^occr_seq^chg_clsf" colsep="#" colwidth="90, 90, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" navindex="4" style="left:330px; top:240px; width:305px; height:104px; ">
			<col ref="occr_dt" format="yyyy-mm-dd" style="text-align:center; "/>
			<col ref="occr_seq"/>
			<col ref="chg_clsf"/>
		</datagrid>
	</xhtml:body>
</xhtml:html>
