<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>매각등록/수정</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<as_aset_1500_m>
							<dataSet>
								<xx_budg_cd/>
								<xx_budg_nm/>
								<xx_mang_cd_4/>
								<xx_job_clsf_02/>
								<xx_cd_clsf/>
								<xx_occr_slip_clsf/>
							</dataSet>
						</as_aset_1500_m>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session>
							<dept_cd/>
						</session>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<mang_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</mang_clsf>
							<note_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</note_clsf>
							<issu_cmpy_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</issu_cmpy_clsf>
							<whco_slip_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</whco_slip_clsf>
							<seq_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</seq_clsf>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<searchData>
							<dt_clsf>1</dt_clsf>
							<chg_dt/>
							<seq_clsf/>
							<chg_clsf/>
							<occr_dt/>
							<occr_seq/>
							<dlco_no/>
							<cmpy_cd/>
							<dlco_ern/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqForm>
							<clos_yymm/>
							<budg_cd/>
						</reqForm>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<multiUpdate>
							<mst_mode/>
							<occr_dt/>
							<occr_seq/>
							<chg_dt/>
							<remk/>
							<draft_doc_no2/>
							<tax_stmt_no/>
							<dlco_clsf_cd/>
							<dlco_ern/>
							<dlco_nm/>
							<slip_no/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<multiUpdateData/>
							<rcpm_amt/>
							<rcpm_shet_no/>
							<rcpm_shet_kind/>
							<cash_rcpm_amt/>
							<cash_sub_seq/>
						</multiUpdate>
						<!-- MultiUpDate유형 사용시 처리 -->
						<fwdData>
							<func_nm/>
							<aset_no_list/>
							<dt_clsf/>
							<chg_clsf/>
							<chg_dt/>
							<seq_clsf/>
							<url/>
						</fwdData>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<chg_amt/>
							<chg_vat_amt/>
							<popupData>
								<bank_cd/>
								<bank_cd_nm/>
							</popupData>
						</resForm>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<msg>
							<errMsg/>
							<errCode/>
						</msg>
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<!-- datagrid2 -->
							<!-- datagrid3 -->
							<record>
								<aset_no/>
								<aset_nm/>
								<sale_now_acqr_amt/>
								<sale_redm_tot_amt/>
								<sale_un_redm_amt/>
								<chg_amt/>
								<chg_vat_amt/>
								<sale_pfls_amt/>
								<dtls_remk/>
								<chg_clsf_nm/>
								<chg_dt/>
								<occr_dt/>
								<occr_seq/>
								<dept_cd/>
								<budg_cd/>
								<sub_seq/>
							</record>
						</gridData>
						<gridData1>
							<record>
								<deps_rmtt_dt/>
								<deps_rcpm_amt/>
								<deps_rmtt_plac/>
								<deps_acct_mang_no/>
								<deps_acct_mang_nm/>
								<deps_coms_amt/>
								<deps_sub_seq/>
								<deps_biz_reg_no/>
								<deps_bank_id/>
								<deps_acct_num/>
								<deps_tran_date/>
								<deps_tran_date_seq/>
							</record>
						</gridData1>
						<gridData2>
							<record>
								<note_note_no/>
								<note_rcpm_amt/>
								<note_note_clsf_cd/>
								<note_bank_cd/>
								<note_bank_nm/>
								<note_issu_pers_nm/>
								<note_issu_cmpy_clsf/>
								<note_comp_dt/>
								<note_mtry_dt/>
								<note_rcpm_acct/>
								<note_sale_aprv_no/>
								<note_sub_seq/>
							</record>
						</gridData2>
						<gridData3>
							<record>
								<etc_budg_cd/>
								<etc_budg_nm/>
								<etc_rcpm_amt/>
								<etc_bal_occr_slip_clsf/>
								<etc_bal_occr_slip_no/>
								<etc_sub_seq/>
							</record>
						</gridData3>
					</resData>
					<tempData>
					</tempData>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[	
					model1.send("as_aset_1500_m");
					model1.refresh();
				/*
					alert(model1.getValue("/root/initData/as_aset_1500_m/dataSet/xx_budg_cd"));				
					alert(model1.getValue("/root/initData/as_aset_1500_m/dataSet/xx_budg_nm"));
					alert(model1.getValue("/root/initData/as_aset_1500_m/dataSet/xx_mang_cd_4"));
					alert(model1.getValue("/root/initData/as_aset_1500_m/dataSet/xx_job_clsf_02"));
					alert(model1.getValue("/root/initData/as_aset_1500_m/dataSet/xx_cd_clsf"));
					alert(model1.getValue("/root/initData/as_aset_1500_m/dataSet/xx_occr_slip_clsf"));
				*/
				
					
					datagrid2.isReadOnly(1, 1, 1, 5) = true;
					datagrid3.isReadOnly(1, 1, 1, 11) = true;
					datagrid4.isReadOnly(1, 1, 1, 5) = true;
//alert(model1.getValue("/root/reqData/fwdData/chg_clsf"));
					//초기 자산변동 화면(부모화면)에서 변동일자를 설정한 경우의 처리
					if (model1.getValue("/root/reqData/fwdData/chg_dt") != "") {
						//srch_ipt_chg_dt.dispatch("xforms-value-changed");
						model1.setValue("/root/reqData/searchData/chg_dt", model1.getValue("/root/reqData/fwdData/chg_dt"));
						model1.setValue("/root/reqData/searchData/dt_clsf", model1.getValue("/root/reqData/fwdData/dt_clsf"));
						model1.setValue("/root/reqData/searchData/chg_clsf", model1.getValue("/root/reqData/fwdData/chg_clsf"));

						model1.send("as_aset_1201");
						model1.copyNode("/root/initData/comboSet/seq_clsf","/root/tempData/dataSet/CURLIST/seq_clsf");
						model1.removeNodeset("/root/tempData/dataSet");
						model1.setValue("/root/reqData/searchData/seq_clsf", model1.getValue("/root/reqData/fwdData/seq_clsf"));
						
						if (model1.getValue("/root/reqData/searchData/dt_clsf") == "1") {
							model1.setValue("/root/reqData/searchData/occr_dt", cbo_seq_clsf.label.substring(0,8));	
						} else {
							model1.setValue("/root/reqData/searchData/occr_dt", model1.getValue("/root/reqData/searchData/chg_dt"));
						}
						model1.setValue("/root/reqData/searchData/occr_seq", model1.getValue("/root/reqData/searchData/seq_clsf"));		
						getAsetSaleList();
						getRcpmTotAmt();
						model1.refresh();
					} else { //초기 자산변동 화면(부모화면)에서 변동일자를 설정하지 않고 호출할 경우는 현재날짜로 설정
					//if (model1.getValue("/root/reqData/searchData/chg_dt") == "") {
						now = new Date();
						srch_ipt_chg_dt.value = toTimeString(now);
						ipt_chg_dt.value = toTimeString(now);
						//model1.setValue("/root/reqData/searchData/chg_clsf", "K");
						model1.setValue("/root/reqData/searchData/chg_clsf", model1.getValue("/root/reqData/fwdData/chg_clsf"));
						cbo_dt_clsf.dispatch("xforms-value-changed");
						model1.refresh();
						grd_aset_chg.isReadOnly(1, 6, 1, 9) = true;
						btnT2.dispatch("onclick");
					}
					
					//공통코드 조회하여 콤보박스에 설정
					model1.send("as_aset_1701");
					makeComboSet("", "/root/tempData/dataSet/CURLIST1/record", "/root/initData/comboSet/mang_clsf", "cd_abrv_nm", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST2/record", "/root/initData/comboSet/note_clsf", "cd_abrv_nm", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST3/record", "/root/initData/comboSet/issu_cmpy_clsf", "cd_abrv_nm", "cd")
					makeComboSet("", "/root/tempData/dataSet/CURLIST4/record", "/root/initData/comboSet/whco_slip_clsf", "cd_abrv_nm", "cd")
					model1.removeNodeset("/root/tempData/dataSet");

					//최종마감년월을 세팅한다.
					model1.send("as_aset_1010");
					model1.setValue("/root/reqData/reqForm/clos_yymm" , model1.getValue("/root/tempData/dataSet/CURLIST/record/clos_yymm") );
					model1.removeNodeset("/root/tempData/dataSet");
					model1.refresh();
				]]>
			</script>
			<script type="javascript">
				<![CDATA[
				//팝업화면에서 선택한 자산목록에 대한 정보를 조회해서 매각내역 상세 그리드에 추가
				function getAsetList(aset_no_list){
					model1.setValue("/root/reqData/fwdData/aset_no_list", aset_no_list);
					model1.setValue("/root/reqData/fwdData/chg_dt", model1.getValue("/root/reqData/multiUpdate/chg_dt"));				
					model1.send("as_aset_1502");
					model1.removeNodeset("/root/tempData/dataSet/CURLIST/totalcnt"); //조회결과에서 totalcnt 인스턴스 삭제
					
					//SUBTOTAL 수행에 따른 합계금액이 계산된 Row를 삭제
					if (grd_aset_chg.valueMatrix(grd_aset_chg.rows-1, 2) == "합계금액") {
						grd_aset_chg.removeRow(grd_aset_chg.rows-1);
						model1.refresh();
					}
					
					var node_nm;
					var node_val;
					var row_cnt;
					if (grd_aset_chg.rows > 1) {
						if (grd_aset_chg.valueMatrix(1, 1) == "")
							row_cnt = 1;
						else
							row_cnt = grd_aset_chg.rows;
					}
					
					//조회한 레코드에 대해 매각내역 상세 그리드에 추가 수행
					for (i = 0; i < root.tempData.dataSet.CURLIST.childNodes.length; i++) {
						if (grd_aset_chg.valueMatrix(1, 1) != "") {
							grd_aset_chg.addRow();
							model1.makeNode("/root/resData/gridData/record["+(i+row_cnt)+"]");
						} else {
							grd_aset_chg.addStatus(1, "insert");
						}
						for (j = 0; j < root.tempData.dataSet.CURLIST.childNodes(i).childNodes.length; j++) {
							node_nm = root.tempData.dataSet.CURLIST.childNodes(i).childNodes(j).nodeName;
							node_val = root.tempData.dataSet.CURLIST.childNodes(i).childNodes(j).nodeValue;
							if (grd_aset_chg.valueMatrix(1, 1) != "") {
								model1.makeNode("/root/resData/gridData/record["+(i+row_cnt)+"]/" + node_nm);
							}
							model1.setValue("/root/resData/gridData/record["+(i+row_cnt)+"]/" + node_nm, node_val);
						}
					}
					
					model1.refresh();
					//조회한 임시 인스턴스 삭제
					model1.removeNodeset("/root/tempData/dataSet");
					model1.refresh();

					//추가된 자산에 대한 현취득금액, 충당금누계, 미상각잔액 등을 계산을 위한 함수 호출
					getSubTotal();
					
					if (grd_aset_chg.valueMatrix(1, 1) != "")
						grd_aset_chg.isReadOnly(1, 6, 1, 9) = false;
				}
				
				//그리드의 열단위로 합을 구하기 위해 subtotal()함수 실행
				function getSubTotal() {
					grd_aset_chg.subtotal("clear", 0, 0);
					if (grd_aset_chg.valueMatrix(1, 1) == "")
						return;
						
					//SUBTOTAL 실행
					grd_aset_chg.subtotal("sum", -1, 3, "(-)#,###", "background-color:#ffffaa; font-weight; color:#0000ff;", 2, "합계금액");
					grd_aset_chg.subtotal("sum", -1, 4, "(-)#,###", "background-color:#ffffaa; font-weight; color:#0000ff;", 2, "합계금액");
					grd_aset_chg.subtotal("sum", -1, 5, "(-)#,###", "background-color:#ffffaa; font-weight; color:#0000ff;", 2, "합계금액");
					grd_aset_chg.subtotal("sum", -1, 6, "(-)#,###", "background-color:#ffffaa; font-weight; color:#0000ff;", 2, "합계금액");
					grd_aset_chg.subtotal("sum", -1, 7, "(-)#,###", "background-color:#ffffaa; font-weight; color:#0000ff;", 2, "합계금액");
					grd_aset_chg.subtotal("sum", -1, 8, "(-)#,###", "background-color:#ffffaa; font-weight; color:#0000ff;", 2, "합계금액");					
					grd_aset_chg.cellStyle("text-align", grd_aset_chg.rows-1, 2, grd_aset_chg.rows-1, 2) = "center";
					grd_aset_chg.multiTotals = true;
					model1.refresh();
				}
				
				function getAsetChgDtlsList() {
					/*
					var dt_clsf = model1.getValue("/root/reqData/searchData/dt_clsf");
					var chg_dt = model1.getValue("/root/reqData/searchData/chg_dt");
					var seq_clsf = model1.getValue("/root/reqData/searchData/seq_clsf");
					
					btnReset.dispatch("onclick");
					
					model1.setValue("/root/reqData/searchData/dt_clsf", dt_clsf);
					model1.setValue("/root/reqData/searchData/chg_dt", chg_dt);
					model1.setValue("/root/reqData/searchData/seq_clsf", seq_clsf);
					*/
					//cbo_seq_clsf.dispatch("xforms-value-changed");
					//cbo_dt_clsf.dispatch("xforms-value-changed");
					
					
					var dt_clsf = model1.getValue("/root/reqData/searchData/dt_clsf");
					var chg_dt = model1.getValue("/root/reqData/searchData/chg_dt");
					var seq_clsf = model1.getValue("/root/reqData/searchData/seq_clsf");
					var chg_clsf = model1.getValue("/root/reqData/searchData/chg_clsf");
					var occr_dt = model1.getValue("/root/reqData/searchData/occr_dt");
					var occr_seq = model1.getValue("/root/reqData/searchData/occr_seq");
					btnReset.dispatch("onclick");
					model1.setValue("/root/reqData/searchData/dt_clsf", dt_clsf);
					model1.setValue("/root/reqData/searchData/chg_dt", chg_dt);
					cbo_dt_clsf.dispatch("xforms-value-changed");
					model1.setValue("/root/reqData/searchData/seq_clsf", seq_clsf);
					model1.setValue("/root/reqData/searchData/chg_clsf", chg_clsf);
					model1.setValue("/root/reqData/searchData/occr_dt", occr_dt);
					model1.setValue("/root/reqData/searchData/occr_seq", occr_seq);
					model1.refresh();
					
					getAsetSaleList();
				}
				
				function getAsetSaleList() {
					model1.send("as_aset_1501");
					//조회한 매각정보를 화면에 설정
					model1.setValue("/root/reqData/multiUpdate/occr_dt", model1.getValue("/root/tempData/dataSet/CURLIST1/record/occr_dt"));
					model1.setValue("/root/reqData/multiUpdate/occr_seq", model1.getValue("/root/tempData/dataSet/CURLIST1/record/occr_seq"));
					model1.setValue("/root/reqData/multiUpdate/chg_dt", model1.getValue("/root/tempData/dataSet/CURLIST1/record/chg_dt"));
					model1.setValue("/root/reqData/multiUpdate/remk", model1.getValue("/root/tempData/dataSet/CURLIST1/record/remk"));
					model1.setValue("/root/reqData/multiUpdate/draft_doc_no2", model1.getValue("/root/tempData/dataSet/CURLIST1/record/draft_doc_no2"));
					model1.setValue("/root/reqData/multiUpdate/tax_stmt_no", model1.getValue("/root/tempData/dataSet/CURLIST1/record/tax_stmt_no"));
					model1.setValue("/root/reqData/multiUpdate/dlco_ern", model1.getValue("/root/tempData/dataSet/CURLIST1/record/dlco_ern"));
					model1.setValue("/root/reqData/multiUpdate/dlco_clsf_cd", model1.getValue("/root/tempData/dataSet/CURLIST1/record/dlco_clsf_cd"));
					model1.setValue("/root/reqData/multiUpdate/dlco_nm", model1.getValue("/root/tempData/dataSet/CURLIST1/record/dlco_nm"));
					model1.setValue("/root/reqData/multiUpdate/slip_no", model1.getValue("/root/tempData/dataSet/CURLIST1/record/slip_no"));
					model1.setValue("/root/reqData/multiUpdate/slip_occr_dt", model1.getValue("/root/tempData/dataSet/CURLIST1/record/slip_occr_dt"));
					model1.setValue("/root/reqData/multiUpdate/slip_clsf_cd", model1.getValue("/root/tempData/dataSet/CURLIST1/record/slip_clsf_cd"));
					model1.setValue("/root/reqData/multiUpdate/slip_seq", model1.getValue("/root/tempData/dataSet/CURLIST1/record/slip_seq"));

					//조회한 매각상세 내역을 그리드에 설정
					model1.copyNode("/root/resData/gridData", "/root/tempData/dataSet/CURLIST2");
					model1.removeNodeset("/root/resData/gridData/totalcnt");

					//현금입금내역
					if (model1.getValue("/root/tempData/dataSet/CURLIST3/totalcnt") != "0") {
						model1.setValue("/root/reqData/multiUpdate/cash_rcpm_amt", model1.getValue("/root/tempData/dataSet/CURLIST3/record/cash_rcpm_amt"));
						model1.setValue("/root/reqData/multiUpdate/cash_sub_seq", model1.getValue("/root/tempData/dataSet/CURLIST3/record/cash_sub_seq"));
					}
					
					model1.copyNode("/root/resData/gridData1", "/root/tempData/dataSet/CURLIST4");
					model1.copyNode("/root/resData/gridData2", "/root/tempData/dataSet/CURLIST5");
					model1.copyNode("/root/resData/gridData3", "/root/tempData/dataSet/CURLIST6");
					
					if (model1.getValue("/root/tempData/dataSet/CURLIST6/totalcnt") != "0")
						btnT4.dispatch("onclick");
					if (model1.getValue("/root/tempData/dataSet/CURLIST5/totalcnt") != "0")
						btnT3.dispatch("onclick");
					if (model1.getValue("/root/tempData/dataSet/CURLIST4/totalcnt") != "0")
						btnT2.dispatch("onclick");
					if (model1.getValue("/root/tempData/dataSet/CURLIST3/totalcnt") != "0")
						btnT1.dispatch("onclick");
					
					if (datagrid2.rows == 1) {
						datagrid2.addRow();
						datagrid2.rowStatus(1) = 0;
						datagrid2.isReadOnly(1, 1, 1, 5) = true;
					} else {
						datagrid2.isReadOnly(1, 1, 1, 5) = false;
					}
					
					if (datagrid3.rows == 1) {
						datagrid3.addRow();
						datagrid3.rowStatus(1) = 0;
						datagrid3.isReadOnly(1, 1, 1, 11) = true;
					} else {
						datagrid3.isReadOnly(1, 1, 1, 11) = false;
					}
					
					if (datagrid4.rows == 1) {
						datagrid4.addRow();
						datagrid4.rowStatus(1) = 0;
						datagrid4.isReadOnly(1, 1, 1, 5) = true;
					} else {
						datagrid4.isReadOnly(1, 1, 1, 5) = false;
					}

					getRcpmTotAmt();


					model1.removeNodeset("/root/tempData/dataSet");
					model1.refresh();
					
					//현취득금액, 충당금누계, 미상각잔액, 매각액, 부가세, 처분수익 등의 합계를 구하는 함수 호출
					getSubTotal(); 
					
					if (grd_aset_chg.rows == 1) {
						grd_aset_chg.addRow();
						grd_aset_chg.rowStatus(1) = 0;
						grd_aset_chg.isReadOnly(1, 6, 1, 9) = true;
					} else {
						grd_aset_chg.isReadOnly(1, 6, 1, 9) = false;
					}
				}
					
				function setDlco_no_fr(iv_dlco_no, iv_dlco_nm){
					model1.setValue("/root/reqData/searchData/dlco_no", iv_dlco_no);
					model1.setValue("/root/reqData/multiUpdate/dlco_nm", iv_dlco_nm);
					
					model1.send("as_com_1100");
					model1.setValue("/root/reqData/multiUpdate/dlco_ern", model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_no"))
					model1.setValue("/root/reqData/multiUpdate/dlco_clsf_cd", model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_clsf_cd"))
					model1.refresh();
				}
				
				function getGrid2TotAmt() {
					var tot_amt = 0;
					for (i = 1; i < datagrid2.rows; i++) {
						if ((datagrid2.valueMatrix(i, 2) != "") && (datagrid2.rowStatus(i) != 4)) {
							tot_amt += Number(datagrid2.valueMatrix(i, 2));
						}
					}
					return tot_amt;
				}
				
				function getGrid3TotAmt() {
					var tot_amt = 0;
					for (i = 1; i < datagrid3.rows; i++) {
						if ((datagrid3.valueMatrix(i, 2) != "") && (datagrid3.rowStatus(i) != 4)) {
							tot_amt += Number(datagrid3.valueMatrix(i, 2));
						}
					}
					return tot_amt;
				}
				
				function getGrid4TotAmt() {
					var tot_amt = 0;
					for (i = 1; i < datagrid4.rows; i++) {
						if ((datagrid4.valueMatrix(i, 3) != "") && (datagrid4.rowStatus(i) != 4)) {
							tot_amt += Number(datagrid4.valueMatrix(i, 3));
						}
					}
					return tot_amt;
				}
					
				function getRcpmTotAmt() {
					var cash_amt = 0;
					if (model1.getValue("/root/reqData/multiUpdate/cash_rcpm_amt") != "")
						cash_amt = parseInt(model1.getValue("/root/reqData/multiUpdate/cash_rcpm_amt"));
						
					var deps_amt = getGrid2TotAmt();
					var note_amt = getGrid3TotAmt();
					var etc_amt  = getGrid4TotAmt();
					opt_rcpm_amt.value = cash_amt + deps_amt + note_amt + etc_amt;
				}
					
				]]>
			</script>
			<submission id="as_aset_1201" action="/as/aset/1201" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1501" action="/as/aset/1501" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1502" action="/as/aset/1502" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1503" action="/as/aset/1503" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpdate" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1504" action="/as/aset/1504" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpdate" resultref="/root/tempData/dataSet"/>
			<submission id="as_com_1100" action="/as/com/1100" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1010" action="/as/aset/1010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1701" action="/as/aset/1701" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1709" action="/as/aset/1709" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData/dataSet"/>
			<submission id="as_com_1900" action="/as/com/1900" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_aset_1500_m" action="/as/aset/1500" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/as_aset_1500_m/dataSet"/>
		</model>
		<script type="javascript" src="/js/as_common.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/fcmc_common.js"/>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" style="font-family:굴림; ">
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group3" class="gro_tit2" style="left:10px; top:555px; width:926px; height:25px; ">
			<caption id="caption5" class="tit02" style="left:0px; top:3px; width:926px; height:20px; ">입금정보</caption>
		</group>
		<caption id="caption9" class="list_cap02" style="left:814px; top:554px; width:121px; height:26px; text-align:center; "/>
		<group id="group_sale" class="gro_tab1" style="left:10px; top:147px; width:926px; height:51px; ">
			<caption id="caption26" class="list_cap02" style="left:79px; top:0px; width:846px; height:26px; "/>
			<caption id="caption1" class="list_cap02" style="left:79px; top:25px; width:846px; height:26px; "/>
			<input id="input10" ref="/root/reqData/multiUpdate/remk" class="req" navindex="5" inputtype="input" caption="제목" appearance="input" style="left:457px; top:4px; width:183px; height:18px; background-color:#ffffcc; "/>
			<caption id="caption24" class="list_cap03" style="left:373px; top:0px; width:80px; height:26px; ">제      목</caption>
			<caption id="caption31" class="list_cap03" style="left:651px; top:25px; width:80px; height:26px; ">세금계산서</caption>
			<caption id="caption33" class="list_cap03" style="left:0px; top:0px; width:80px; height:26px; ">매각일자</caption>
			<output id="output4" ref="/root/reqData/multiUpdate/dlco_nm" inputtype="input" appearance="output" style="left:193px; top:29px; width:172px; height:18px; "/>
			<output id="output8" ref="/root/reqData/multiUpdate/tax_stmt_no" inputtype="input" appearance="output" style="left:735px; top:29px; width:130px; height:18px; "/>
			<input id="ipt_chg_dt" ref="/root/reqData/multiUpdate/chg_dt" class="req" navindex="4" inputtype="date" caption="매각일자" style="left:84px; top:4px; width:90px; height:18px; background-color:#ffffcc; "/>
			<input id="input5" ref="/root/reqData/multiUpdate/dlco_ern" class="req" navindex="6" inputtype="button" caption="매각처번호" style="left:84px; top:29px; width:106px; height:18px; background-color:#ffffcc; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					model1.setValue("/root/reqData/fwdData/func_nm","setDlco_no_fr");
					window.load("../../co/dlco/CO_DLCO_1100.xrw","modal","CO_DLCO_1100","align:center; width:660px; height:540px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(input5.currentText == "" ) {	//매각처번호에 값이 없을 경우
						output4.value = "";	        //매각처명 초기화
					} else {
						model1.setValue("/root/reqData/searchData/dlco_ern", input5.currentText);
						model1.send("as_com_1900");
						output4.value = model1.getValue("/root/tempData/dataSet/CURLIST/record/dlco_nm");						
					}																
					]]>
				</script>
			</input>
			<caption id="caption15" class="list_cap03" style="left:373px; top:25px; width:80px; height:26px; ">기안번호</caption>
			<output id="output2" ref="/root/reqData/multiUpdate/slip_no" inputtype="input" appearance="output" style="left:735px; top:5px; width:130px; height:18px; "/>
			<caption id="caption10" class="list_cap03" style="left:0px; top:25px; width:80px; height:26px; ">매각처번호</caption>
			<input id="draft_doc_no" ref="/root/reqData/multiUpdate/draft_doc_no2" navindex="7" inputtype="button" style="left:457px; top:29px; width:113px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						set_refvalue("/root/reqData/fwdData/url",XFORMS_EP_WEB_ADDRESS + "/nanum/flow/ihtml/ecab/ecab_list_chosun_f.jsp?deptid=" + getProperty("ss_deptcd"));
						window.load("/xrw/fc/co/FC_CO_9010.xrw","modal","FC_CO_9010","width:790; height:728; sysmenu:visible; min:hidden; max:hidden; resize:false; caption:visible; align:center;","/root/reqData/fwdData","/root/reqData/fwdData");						
						if (draft_doc_no.value != "") {
							var var_draft_doc_no = draft_doc_no.value.split("^");
							draft_doc_no.value = var_draft_doc_no[0];
						}						
					]]>
				</script>
			</input>
			<caption id="caption19" class="list_cap03" style="left:651px; top:0px; width:80px; height:26px; ">전표번호</caption>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:109px; width:926px; height:5px; "/>
		<group id="group_tit" class="gro_tit2" style="left:10px; top:125px; width:535px; height:20px; ">
			<caption id="subtitle" class="tit02" style="left:0px; top:0px; width:375px; height:20px; ">매각정보</caption>
		</group>
		<datagrid id="grd_aset_chg" nodeset="/root/resData/gridData/record" caption="자산번호^자산명칭^현취득금액^충당금누계^미상각잔액^매각금액^부가세^처분손익^상세비고^caption1^caption2^caption3^caption4^caption5^caption6^caption7" colsep="#" colwidth="75, 192, 84, 80, 76, 95, 82, 93, 167, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" frozenbottomrows="1" mergecellsfixedrows="bycolrec" multitotal="true" rowheader="update" rowsep="|" subtotalposition="below" style="left:10px; top:235px; width:925px; height:310px; ">
			<col ref="aset_no" style="text-align:center; "/>
			<col ref="aset_nm" style="text-align:left; "/>
			<col ref="sale_now_acqr_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="sale_redm_tot_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="sale_un_redm_amt" format="(-)#,###" style="text-align:right; "/>
			<col class="req" ref="chg_amt" type="input" format="(-)#,###" caption="매각금액" style="text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (grd_aset_chg.valueMatrix(grd_aset_chg.row, 6) != "" &&
						    grd_aset_chg.valueMatrix(grd_aset_chg.row, 5) != "") {
							var sale_pfls_amt = parseInt(grd_aset_chg.valueMatrix(grd_aset_chg.row, 6)) - parseInt(grd_aset_chg.valueMatrix(grd_aset_chg.row, 5));
							grd_aset_chg.valueMatrix(grd_aset_chg.row, 8) = sale_pfls_amt;
							
							//SUBTOTAL 수행에 따른 합계금액이 계산된 Row를 삭제
							//if (grd_aset_chg.valueMatrix(grd_aset_chg.rows-1, 2) == "합계금액") {
							//	grd_aset_chg.removeRow(grd_aset_chg.rows-1);
							//	model1.refresh();
							//}
							
							getSubTotal();
						}
					]]>
				</script>
			</col>
			<col class="req" ref="chg_vat_amt" type="input" format="(-)#,###" caption="부가세" style="text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						getSubTotal();
					]]>
				</script>
			</col>
			<col ref="sale_pfls_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="dtls_remk" type="input" style="text-align:left; "/>
			<col ref="chg_clsf_nm" visibility="hidden"/>
			<col ref="chg_dt" visibility="hidden"/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="occr_seq" visibility="hidden"/>
			<col ref="dept_cd" visibility="hidden"/>
			<col ref="budg_cd" visibility="hidden"/>
			<col ref="sub_seq" visibility="hidden"/>
		</datagrid>
		<caption id="caption21" class="tit02" style="left:10px; top:212px; width:195px; height:20px; ">매각내역 상세</caption>
		<group id="group1" class="gro_tab1" style="left:348px; top:208px; width:588px; height:26px; ">
			<caption id="caption14" class="list_cap02" style="left:409px; top:0px; width:178px; height:26px; "/>
			<caption id="caption61" class="list_cap03" style="left:0px; top:0px; width:90px; height:26px; ">매각금액</caption>
			<caption id="caption12" class="list_cap02" style="left:89px; top:0px; width:321px; height:26px; "/>
			<input id="input2" ref="/root/resData/resForm/chg_amt" class="req" navindex="8" inputtype="input" format="#,###" appearance="input" style="left:94px; top:4px; width:96px; height:18px; text-align:right; "/>
			<caption id="caption36" class="list_cap03" style="left:205px; top:0px; width:90px; height:26px; ">부가세</caption>
			<input id="input4" ref="/root/resData/resForm/chg_vat_amt" class="req" navindex="9" inputtype="input" format="#,###" appearance="input" style="left:299px; top:4px; width:96px; height:18px; text-align:right; "/>
			<button id="button2" class="btn_grid04" navindex="10" style="left:414px; top:4px; width:65px; height:17px; ">
				<caption>일괄입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (grd_aset_chg.valueMatrix(1, 1) == "") {
							alert("매각금액, 부가세를 일괄적용할 자산목록이 존재하지 않습니다.");
							return;
						}		
						
						if (window.alert("매각금액, 부가세를 일괄 적용하시겠습니까?", "확인", 1) == 1) {
							//매각금액, 부가세를 매각내역 상세 그리드에 일괄적용 처리
							for (i = 1; i < grd_aset_chg.rows-1; i++) {
								model1.setValue("/root/resData/gridData/record["+(i)+"]/chg_amt", model1.getValue("/root/resData/resForm/chg_amt"));
								model1.setValue("/root/resData/gridData/record["+(i)+"]/chg_vat_amt", model1.getValue("/root/resData/resForm/chg_vat_amt"));

								//(매각액 - 미상각잔액) 계산 후, 처분손익 항목에 반영
								if (grd_aset_chg.valueMatrix(i, 5) != "" &&
								    grd_aset_chg.valueMatrix(i, 6) != "") {
									var sale_pfls_amt = parseInt(grd_aset_chg.valueMatrix(i, 6)) - parseInt(grd_aset_chg.valueMatrix(i, 5));
									grd_aset_chg.valueMatrix(i, 8) = sale_pfls_amt;
								}
							}
						}
						//SUBTOTAL 수행에 따른 합계금액이 계산된 Row를 삭제
						if (grd_aset_chg.valueMatrix(grd_aset_chg.rows-1, 2) == "합계금액") {
							grd_aset_chg.removeRow(grd_aset_chg.rows-1);
							model1.refresh();
						}
					
						getSubTotal();
					]]>
				</script>
			</button>
			<button id="button1" class="btn_grid02" navindex="11" style="left:498px; top:4px; width:42px; height:17px; ">
				<caption>추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var aset_no_list = "";
					if (grd_aset_chg.valueMatrix(1, 1) != "") {
						//매각내역 상세 그리드에 포함된 자산번호 문자열 생성
						for (i = 1; i < grd_aset_chg.rows-1; i++) {
							if (i == 1)
								aset_no_list = grd_aset_chg.valueMatrix(i, 1);
							else
								aset_no_list = aset_no_list + "#" + grd_aset_chg.valueMatrix(i, 1);
						}
						//aset_no_list = "E1032001002#E1032001004#E1032001005";
						model1.setValue("/root/reqData/fwdData/aset_no_list", aset_no_list);
					}
					model1.setValue("/root/reqData/fwdData/func_nm","getAsetList");
					window.load("../asrd/AS_ASRD_1900.xrw","modal","AS_ASRD_1900","align:center; width:953px; height:730px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden; ","/root/reqData/fwdData","/root/reqData/fwdData");
				]]>
				</script>
			</button>
			<button id="button6" class="btn_grid02" navindex="12" style="left:541px; top:4px; width:42px; height:17px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						grd_aset_chg.rowStatus(grd_aset_chg.row) = 4;
					]]>
				</script>
			</button>
		</group>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:45px; width:926px; height:21px; ">
			<button id="btnA1" class="btn02" style="left:589px; top:0px; width:52px; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (grd_aset_chg.rows == 1 || grd_aset_chg.valueMatrix(1, 1) == "") {
							alert("입력할 매각상세 내역이 없습니다.");
							return;
						}
						
						//매각일자가 최종마감년월 보다 같거나 작을경우 입력,수정,삭제,현업전표생성,현업전표취소 불가.
						if ( model1.getValue("/root/reqData/multiUpdate/chg_dt").substring(0,6) <= model1.getValue("/root/reqData/reqForm/clos_yymm") ) {
							alert("월마감 이후에는 자산변경을 할 수 없습니다.");
							return;
						}
						
						// 입금(현금,예금,어음) 입금시 매각년월을 다르게 입력 시 저장불가 처리
						var now = new Date();
						var year = now.getYear();
						var month = now.getMonth()+1;
						var date = now.getDate();
						if(month < 10)
							month = "0" + month;
						var   tmp_sys_yymm        = year + "" + month;                                                                           //시스템년월
						var   tmp_sale_yymm       = model1.getValue("/root/reqData/multiUpdate/chg_dt").substring(0,6);  // 매각년월
						var   tmp_rcpm_tot_amt     = model1.getValue("/root/reqData/multiUpdate/rcpm_amt");                 // 입금총액
						var   tmp_cash_amt = 0;                                                                                                         // 현금
						if (model1.getValue("/root/reqData/multiUpdate/cash_rcpm_amt") != "")                                  
							tmp_cash_amt = parseInt(model1.getValue("/root/reqData/multiUpdate/cash_rcpm_amt"));						
						var   tmp_deps_amt = getGrid2TotAmt();                                                                                   // 예금
						var   tmp_note_amt  = getGrid3TotAmt();                                                                                   // 어음
						var   tmp_chk_amt   = tmp_cash_amt + tmp_deps_amt + tmp_note_amt;                                        // 체크대상(현금+어음+예금) 
/*						
						alert("[today ]     : " + tmp_sys_yymm   );
						alert("[매각일]    : " + tmp_sale_yymm   );
                                             alert("[입금총액] : " + tmp_rcpm_tot_amt );
                                             alert("[체크금액] : " + tmp_chk_amt        );
*/

						//alert(tmp_sys_yymm+":"+tmp_sale_yymm);
						
						if (tmp_sys_yymm!= tmp_sale_yymm && tmp_rcpm_tot_amt != 0 ) {	
					            if (tmp_rcpm_tot_amt == tmp_chk_amt) {					
							alert(" (현금,예금,어음) 입금시 매각월을  틀리게 입력 할 수 없습니다.");
							return;						        
					            }
						}
						
						var sale_amt = Number(grd_aset_chg.valueMatrix(grd_aset_chg.rows-1, 6));
						var vat_amt = Number(grd_aset_chg.valueMatrix(grd_aset_chg.rows-1, 7));
						var rcpm_amt = Number(model1.getValue("/root/reqData/multiUpdate/rcpm_amt"));
						
						//alert("sale_amt:" + sale_amt + ":vat_amt:" + vat_amt + ":rcpm_amt: "+rcpm_amt);
						
						if (sale_amt + vat_amt - rcpm_amt < 0) {
							alert("입금총액이 매각총액(매각액+부가세)보다 클 수 없습니다.");
							return;
						}
		
						if ((tmp_cash_amt  + tmp_deps_amt != 0) && model1.getValue("/root/reqData/multiUpdate/rcpm_shet_no" ) == "" ) {
							alert("입금표번호를 입력하세요.");
							// return;
						}
						
												
						if (commReqCheck(group_sale)) {
							if (commGridReqCheck("grd_aset_chg")) {
								if (window.alert("자산 매각정보를 입력하시겠습니까?", "입력", 1) == 1) {
									//그리드 마직막 라인은 '합계'를 표시하는 라인이므로 이전 라인까지만 상태값 변경처리
									for (i = 1; i < grd_aset_chg.rows-1; i++) {
										if (grd_aset_chg.rowStatus(i) == 4) {
											grd_aset_chg.rowStatus(i) = 0;
											datagrid1.rowStatus(i) = 0;
										} else {
											grd_aset_chg.rowStatus(i) = 1;
											datagrid1.rowStatus(i) = 1;
										}
									}
									model1.setValue("/root/reqData/multiUpdate/multiUpdateData", datagrid1.getUpdateData());

									//입금정보 처리
									//if (model1.getValue("/root/reqData/multiUpdate/rcpm_amt") != "") {
										//if (Number(model1.getValue("/root/reqData/multiUpdate/rcpm_amt")) > 0) {
											for (i = 1; i < datagrid2.rows;i++) {
												if (datagrid2.rowStatus(i) == 4)
													datagrid2.rowStatus(i) = 0;
												else
													if (datagrid2.valueMatrix(i, 1) != "")
														datagrid2.rowStatus(i) = 1;
											}
			
											for (i = 1; i < datagrid3.rows;i++) {
												if (datagrid3.rowStatus(i) == 4)
													datagrid3.rowStatus(i) = 0;
												else
													if (datagrid3.valueMatrix(i, 1) != "")
														datagrid3.rowStatus(i) = 1;
											}
			
											for (i = 1; i < datagrid4.rows;i++) {
												if (datagrid4.rowStatus(i) == 4)
													datagrid4.rowStatus(i) = 0;
												else
													if (datagrid4.valueMatrix(i, 1) != "")
														datagrid4.rowStatus(i) = 1;
											}
											
											model1.makeNode("/root/reqData/multiUpdate/multiUpdateData1");
											model1.makeNode("/root/reqData/multiUpdate/multiUpdateData2");
											model1.makeNode("/root/reqData/multiUpdate/multiUpdateData3");
											model1.setValue("/root/reqData/multiUpdate/multiUpdateData1", datagrid2.getUpdateData());
											model1.setValue("/root/reqData/multiUpdate/multiUpdateData2", datagrid3.getUpdateData());
											model1.setValue("/root/reqData/multiUpdate/multiUpdateData3", datagrid4.getUpdateData());
										//}
									//}

									
									model1.send("as_aset_1503");
									
									if (submit_completed()) {
										getAsetChgDtlsList();
									} else {
										model1.makeNode("/root/tempData");
									}
								}
							}
						}
					]]>
				</script>
			</button>
			<button id="btnA2" class="btn02" style="left:644px; top:0px; width:52px; height:21px; ">
				<caption>수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					       // 발생일련번호가 없는 경우에는 입력 상태임 수정, 삭제 불가 함
						if (model1.getValue("/root/reqData/searchData/occr_seq") == '' ) {
							alert(" 수정 가능한 상태가 아닙니다.");
							return;							    
						}
												
						if (grd_aset_chg.rows == 1 || grd_aset_chg.valueMatrix(1, 1) == "") {
							alert("수정할 매각상세 내역이 없습니다.");
							return;
						}
						
						// 현업전표가 생성되었으므로 수정,삭제 불가 함
						if (model1.getValue("/root/reqData/multiUpdate/slip_no") != '' ) {
							alert(" 현업전표가 생성되었습니다. 수정 가능한 상태가 아닙니다.");
							return;							    
						}
												
						//매각일자가 최종마감년월 보다 같거나 작을경우 입력,수정,삭제,현업전표생성,현업전표취소 불가.
						if ( model1.getValue("/root/reqData/multiUpdate/chg_dt").substring(0,6) <= model1.getValue("/root/reqData/reqForm/clos_yymm") ) {
							alert("월마감 이후에는 자산변경을 할 수 없습니다.");
							return;
						}

						//매각일자가 최종마감년월 보다 같거나 작을경우 입력,수정,삭제,현업전표생성,현업전표취소 불가.
						if ( model1.getValue("/root/reqData/multiUpdate/chg_dt").substring(0,6) <= model1.getValue("/root/reqData/reqForm/clos_yymm") ) {
							alert("월마감 이후에는 자산변경을 할 수 없습니다.");
							return;
						}
						
						// 입금(현금,예금,어음) 입금시 매각년월을 다르게 입력 시 저장불가 처리
						var now = new Date();
						var year = now.getYear();
						var month = now.getMonth()+1;
						var date = now.getDate();
						if(month < 10)
							month = "0" + month;
						var   tmp_sys_yymm        = year + "" + month;                                                                                //시스템년월
						var   tmp_sale_yymm       = model1.getValue("/root/reqData/multiUpdate/chg_dt").substring(0,6);  // 매각년월
						var   tmp_rcpm_tot_amt     = model1.getValue("/root/reqData/multiUpdate/rcpm_amt");                 // 입금총액
						var   tmp_cash_amt = 0;                                                                                                         // 현금
						if (model1.getValue("/root/reqData/multiUpdate/cash_rcpm_amt") != "")                                  
							tmp_cash_amt = parseInt(model1.getValue("/root/reqData/multiUpdate/cash_rcpm_amt"));						
						var   tmp_deps_amt = getGrid2TotAmt();                                                                                   // 예금
						var   tmp_note_amt  = getGrid3TotAmt();                                                                                   // 어음
						var   tmp_chk_amt   = tmp_cash_amt + tmp_deps_amt + tmp_note_amt;                                        // 체크대상(현금+어음+예금) 
/*						
						alert("[today ]     : " + tmp_sys_yymm   );
						alert("[매각일]    : " + tmp_sale_yymm   );
                                             alert("[입금총액] : " + tmp_rcpm_tot_amt );
                                             alert("[체크금액] : " + tmp_chk_amt        );
*/
						
						
						if (tmp_sys_yymm!= tmp_sale_yymm && tmp_rcpm_tot_amt != 0 ) {	
					            if (tmp_rcpm_tot_amt == tmp_chk_amt) {					
							alert(" (현금,예금,어음) 입금시 매각월을  틀리게 입력 할 수 없습니다.");
							return;						        
					            }
						}
						
						var sale_amt = Number(grd_aset_chg.valueMatrix(grd_aset_chg.rows-1, 6));
						var vat_amt = Number(grd_aset_chg.valueMatrix(grd_aset_chg.rows-1, 7));
						var rcpm_amt = Number(model1.getValue("/root/reqData/multiUpdate/rcpm_amt"));
						
						//alert("sale_amt:" + sale_amt + ":vat_amt:" + vat_amt + ":rcpm_amt: "+rcpm_amt);
						
						if (sale_amt + vat_amt - rcpm_amt < 0) {
							alert("입금총액이 매각총액(매각액+부가세)보다 클 수 없습니다.");
							return;
						}

						if ((tmp_cash_amt  + tmp_deps_amt != 0) && model1.getValue("/root/reqData/multiUpdate/rcpm_shet_no" ) == "" ) {
							alert("입금표번호를 입력하세요.");
							//return;
						}
												
						if (commReqCheck(group_sale)) {
							if (window.alert("자산변동내역을 수정하시겠습니까?", "수정", 1) == 1) {
								model1.setValue("/root/reqData/multiUpdate/mst_mode", "U");
								model1.setValue("/root/reqData/multiUpdate/occr_dt", model1.getValue("/root/reqData/searchData/occr_dt"));
								model1.setValue("/root/reqData/multiUpdate/occr_seq", model1.getValue("/root/reqData/searchData/occr_seq"));
									
								for (i = 1; i < grd_aset_chg.rows-1; i++)
									datagrid1.rowStatus(i) = grd_aset_chg.rowStatus(i);

								model1.setValue("/root/reqData/multiUpdate/multiUpdateData", datagrid1.getUpdateData());

								for (i = 1; i < datagrid2.rows;i++) {
									if (datagrid2.valueMatrix(i, 1) != "") {
										if (datagrid2.rowStatus(i) == 0)
											datagrid2.rowStatus(i) = 2;
									} else {
										datagrid2.rowStatus(i) = 0;
									}
								}

								for (i = 1; i < datagrid3.rows;i++) {
									if (datagrid3.valueMatrix(i, 1) != "") {
										if (datagrid3.rowStatus(i) == 0)
											datagrid3.rowStatus(i) = 2;
									} else {
										datagrid3.rowStatus(i) = 0;
									}
								}

								for (i = 1; i < datagrid4.rows;i++) {
									if (datagrid4.valueMatrix(i, 1) != "") {
										if (datagrid4.rowStatus(i) == 0)
											datagrid4.rowStatus(i) = 2;
									} else {
										datagrid4.rowStatus(i) = 0;
									}
								}

								model1.makeNode("/root/reqData/multiUpdate/multiUpdateData1");
								model1.makeNode("/root/reqData/multiUpdate/multiUpdateData2");
								model1.makeNode("/root/reqData/multiUpdate/multiUpdateData3");
								model1.setValue("/root/reqData/multiUpdate/multiUpdateData1", datagrid2.getUpdateData());
								model1.setValue("/root/reqData/multiUpdate/multiUpdateData2", datagrid3.getUpdateData());
								model1.setValue("/root/reqData/multiUpdate/multiUpdateData3", datagrid4.getUpdateData());

								model1.send("as_aset_1504");
								
								if (submit_completed()) {
									getAsetChgDtlsList();
								} else {
									model1.makeNode("/root/tempData");
								}
							}
						}
					]]>
				</script>
			</button>
			<button id="btnA3" class="btn02" style="left:698px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					       // 발생일련번호가 없는 경우에는 입력 상태임 수정, 삭제 불가 함					
						if (model1.getValue("/root/reqData/searchData/occr_seq") == '' ) {
							alert(" 삭제 가능한 상태가 아닙니다.");
							return;							    
						}
											
						if (grd_aset_chg.rows == 1 || grd_aset_chg.valueMatrix(1, 1) == "") {
							alert("삭제할 매각상세 내역이 없습니다.");
							return;
						}
						
						// 현업전표가 생성되었으므로 수정,삭제 불가 함
						if (model1.getValue("/root/reqData/multiUpdate/slip_no") != '' ) {
							alert(" 현업전표가 생성되었습니다. 삭제 가능한 상태가 아닙니다.");
							return;							    
						}
						
						//매각일자가 최종마감년월 보다 같거나 작을경우 입력,수정,삭제,현업전표생성,현업전표취소 불가.
						if ( model1.getValue("/root/reqData/multiUpdate/chg_dt").substring(0,6) <= model1.getValue("/root/reqData/reqForm/clos_yymm") ) {
							alert("월마감 이후에는 자산변경을 할 수 없습니다.");
							return;
						}
						
						if (window.alert("자산변동내역을 삭제하시겠습니까?", "삭제", 1) == 1) {
							model1.setValue("/root/reqData/multiUpdate/mst_mode", "D");
							model1.setValue("/root/reqData/multiUpdate/occr_dt", model1.getValue("/root/reqData/searchData/occr_dt"));
							model1.setValue("/root/reqData/multiUpdate/occr_seq", model1.getValue("/root/reqData/searchData/occr_seq"));

							for (i = 1; i < grd_aset_chg.rows-1; i++) {
								grd_aset_chg.rowStatus(i) = 4;
								datagrid1.rowStatus(i) = 4;
							}

							model1.setValue("/root/reqData/multiUpdate/multiUpdateData", datagrid1.getUpdateData());

							for (i = 1; i < datagrid2.rows;i++) {
								if (datagrid2.valueMatrix(i, 1) != "")
									datagrid2.rowStatus(i) = 4;
								else
									datagrid2.rowStatus(i) = 0;
							}

							for (i = 1; i < datagrid3.rows;i++) {
								if (datagrid3.valueMatrix(i, 1) != "")
									datagrid3.rowStatus(i) = 4;
								else
									datagrid3.rowStatus(i) = 0;
							}

							for (i = 1; i < datagrid4.rows;i++) {
								if (datagrid4.valueMatrix(i, 1) != "")
									datagrid4.rowStatus(i) = 4;
								else
									datagrid4.rowStatus(i) = 0;
							}

							model1.makeNode("/root/reqData/multiUpdate/multiUpdateData1");
							model1.makeNode("/root/reqData/multiUpdate/multiUpdateData2");
							model1.makeNode("/root/reqData/multiUpdate/multiUpdateData3");
							model1.setValue("/root/reqData/multiUpdate/multiUpdateData1", datagrid2.getUpdateData());
							model1.setValue("/root/reqData/multiUpdate/multiUpdateData2", datagrid3.getUpdateData());
							model1.setValue("/root/reqData/multiUpdate/multiUpdateData3", datagrid4.getUpdateData());


							model1.send("as_aset_1504");
							
							if (submit_completed()) {
								getAsetChgDtlsList();
							}
						}
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:874px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						window.close();
					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" style="left:819px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.reset();
						grd_aset_chg.subtotal("clear", 0, 0);
						grd_aset_chg.rowStatus(1) = 0;
						grd_aset_chg.isReadOnly(1, 6, 1, 9) = true;
					]]>
				</script>
			</button>
			<button id="button4" class="btn04" visibility="hidden" style="left:407px; top:0px; width:87px; height:21px; ">
				<caption>현업전표생성</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						 //매각일자가 최종마감년월 보다 같거나 작을경우 입력,수정,삭제,현업전표생성,현업전표취소 불가.
						if ( model1.getValue("/root/reqData/multiUpdate/chg_dt").substring(0,6) <= model1.getValue("/root/reqData/reqForm/clos_yymm") ) {
							alert("월마감 이후에는 자산변경을 할 수 없습니다.");
							return;
						}
					]]>
				</script>
			</button>
			<button id="button5" class="btn04" visibility="hidden" style="left:498px; top:0px; width:87px; height:21px; ">
				<caption>현업전표취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//매각일자가 최종마감년월 보다 같거나 작을경우 입력,수정,삭제,현업전표생성,현업전표취소 불가.
						if ( model1.getValue("/root/reqData/multiUpdate/chg_dt").substring(0,6) <= model1.getValue("/root/reqData/reqForm/clos_yymm") ) {
							alert("월마감 이후에는 자산변경을 할 수 없습니다.");
							return;
						}
					]]>
				</script>
			</button>
			<button id="button8" class="btn03" style="left:752px; top:0px; width:63px; height:21px; ">
				<caption>엑셀저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
						grd_aset_chg.saveExcel(filename, "sheetname:sheet1;colhiddenextend:false;rowhiddenextend:false;exportfalsecols:0;row_0:label;");
					]]>
				</script>
			</button>
		</group>
		<group id="group2" class="gro_sel" style="left:10px; top:75px; width:926px; height:27px; ">
			<caption id="caption6" class="list_cap01" style="left:0px; top:0px; width:90px; height:26px; "/>
			<caption id="caption7" class="list_cap02" style="left:89px; top:0px; width:836px; height:26px; "/>
			<input id="srch_ipt_chg_dt" ref="/root/reqData/searchData/chg_dt" navindex="2" inputtype="date" appearance="input" style="left:94px; top:4px; width:90px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					//getAsetChgDtlsList();
					cbo_dt_clsf.dispatch("xforms-value-changed");
					]]>
				</script>
			</input>
			<caption id="caption8" class="list_cap01" style="left:340px; top:0px; width:90px; height:26px; ">순    차</caption>
			<select1 id="cbo_seq_clsf" ref="/root/reqData/searchData/seq_clsf" navindex="3" appearance="minimal" style="left:434px; top:4px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/seq_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (model1.getValue("/root/reqData/searchData/dt_clsf") == "1") {
							model1.setValue("/root/reqData/searchData/occr_dt", cbo_seq_clsf.label.substring(0,8));	
						} else {
							model1.setValue("/root/reqData/searchData/occr_dt", model1.getValue("/root/reqData/searchData/chg_dt"));
						}
						model1.setValue("/root/reqData/searchData/occr_seq", model1.getValue("/root/reqData/searchData/seq_clsf"));		
						
						getAsetChgDtlsList();
						
						
						/*
						var dt_clsf = model1.getValue("/root/reqData/searchData/dt_clsf");
						var chg_dt = model1.getValue("/root/reqData/searchData/chg_dt");
						var seq_clsf = model1.getValue("/root/reqData/searchData/seq_clsf");
						var chg_clsf = model1.getValue("/root/reqData/searchData/chg_clsf");
						var occr_dt = model1.getValue("/root/reqData/searchData/occr_dt");
						var occr_seq = model1.getValue("/root/reqData/searchData/occr_seq");
						btnReset.dispatch("onclick");
						model1.setValue("/root/reqData/searchData/dt_clsf", dt_clsf);
						model1.setValue("/root/reqData/searchData/chg_dt", chg_dt);
						model1.setValue("/root/reqData/searchData/seq_clsf", seq_clsf);
						model1.setValue("/root/reqData/searchData/chg_clsf", chg_clsf);
						model1.setValue("/root/reqData/searchData/occr_dt", occr_dt);
						model1.setValue("/root/reqData/searchData/occr_seq", occr_seq);
						
						model1.send("as_aset_1501");

						//조회한 매각정보를 화면에 설정
						model1.setValue("/root/reqData/multiUpdate/occr_dt", model1.getValue("/root/tempData/dataSet/CURLIST1/record/occr_dt"));
						model1.setValue("/root/reqData/multiUpdate/occr_seq", model1.getValue("/root/tempData/dataSet/CURLIST1/record/occr_seq"));
						model1.setValue("/root/reqData/multiUpdate/chg_dt", model1.getValue("/root/tempData/dataSet/CURLIST1/record/chg_dt"));
						model1.setValue("/root/reqData/multiUpdate/remk", model1.getValue("/root/tempData/dataSet/CURLIST1/record/remk"));
						model1.setValue("/root/reqData/multiUpdate/draft_doc_no2", model1.getValue("/root/tempData/dataSet/CURLIST1/record/draft_doc_no2"));
						model1.setValue("/root/reqData/multiUpdate/tax_stmt_no", model1.getValue("/root/tempData/dataSet/CURLIST1/record/tax_stmt_no"));
						model1.setValue("/root/reqData/multiUpdate/dlco_ern", model1.getValue("/root/tempData/dataSet/CURLIST1/record/dlco_ern"));
						model1.setValue("/root/reqData/multiUpdate/dlco_clsf_cd", model1.getValue("/root/tempData/dataSet/CURLIST1/record/dlco_clsf_cd"));
						model1.setValue("/root/reqData/multiUpdate/dlco_nm", model1.getValue("/root/tempData/dataSet/CURLIST1/record/dlco_nm"));
						model1.setValue("/root/reqData/multiUpdate/slip_no", model1.getValue("/root/tempData/dataSet/CURLIST1/record/slip_no"));
						model1.setValue("/root/reqData/multiUpdate/slip_occr_dt", model1.getValue("/root/tempData/dataSet/CURLIST1/record/slip_occr_dt"));
						model1.setValue("/root/reqData/multiUpdate/slip_clsf_cd", model1.getValue("/root/tempData/dataSet/CURLIST1/record/slip_clsf_cd"));
						model1.setValue("/root/reqData/multiUpdate/slip_seq", model1.getValue("/root/tempData/dataSet/CURLIST1/record/slip_seq"));

						//조회한 매각상세 내역을 그리드에 설정
						model1.copyNode("/root/resData/gridData", "/root/tempData/dataSet/CURLIST2");
						model1.removeNodeset("/root/tempData/dataSet");
						model1.removeNodeset("/root/resData/gridData/totalcnt");
						model1.refresh();
						
						//현취득금액, 충당금누계, 미상각잔액, 매각액, 부가세, 처분수익 등의 합계를 구하는 함수 호출
						getSubTotal(); 
						
						if (grd_aset_chg.rows == 1) {
							grd_aset_chg.addRow();
							grd_aset_chg.rowStatus(1) = 0;
							grd_aset_chg.isReadOnly(1, 6, 1, 9) = true;
						} else {
							grd_aset_chg.isReadOnly(1, 6, 1, 9) = false;
						}
						*/
					]]>
				</script>
			</select1>
			<select1 id="cbo_dt_clsf" ref="/root/reqData/searchData/dt_clsf" navindex="1" appearance="minimal" style="left:5px; top:4px; width:80px; height:18px; background-color:#eaedfe; ">
				<choices>
					<item>
						<label>변동일자</label>
						<value>1</value>
					</item>
					<item>
						<label>발생일자</label>
						<value>2</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						model1.send("as_aset_1201");
						model1.copyNode("/root/initData/comboSet/seq_clsf","/root/tempData/dataSet/CURLIST/seq_clsf");
						model1.removeNodeset("/root/tempData/dataSet");
						cbo_seq_clsf.value = "";
						model1.refresh();
					]]>
				</script>
			</select1>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" visibility="hidden" caption="자산번호^자산명칭^현취득금액^충당금누계^미상각잔액^매각액^부가세^처분손익^상세비고^caption1^caption2^caption3^caption4^caption5^caption6^caption7" colsep="#" colwidth="74, 193, 85, 80, 75, 94, 82, 89, 167, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" multitotal="true" rowheader="update" rowsep="|" style="left:10px; top:305px; width:925px; height:70px; ">
			<col explorerbar="sortshow" ref="aset_no" style="text-align:center; "/>
			<col ref="aset_nm" style="text-align:left; "/>
			<col ref="sale_now_acqr_amt" format="#,###" style="text-align:right; "/>
			<col ref="sale_redm_tot_amt" format="#,###" style="text-align:right; "/>
			<col ref="sale_un_redm_amt" format="#,###" style="text-align:right; "/>
			<col ref="chg_amt" type="input" format="#,###" style="text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (grd_aset_chg.valueMatrix(grd_aset_chg.row, 6) != "" &&
						    grd_aset_chg.valueMatrix(grd_aset_chg.row, 5) != "") {
							var sale_pfls_amt = parseInt(grd_aset_chg.valueMatrix(grd_aset_chg.row, 6)) - parseInt(grd_aset_chg.valueMatrix(grd_aset_chg.row, 5));
							grd_aset_chg.valueMatrix(grd_aset_chg.row, 8) = sale_pfls_amt;
						}
					]]>
				</script>
			</col>
			<col ref="chg_vat_amt" type="input" format="#,###" style="text-align:right; "/>
			<col ref="sale_pfls_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="dtls_remk" type="input" style="text-align:left; "/>
			<col ref="chg_clsf_nm" visibility="hidden"/>
			<col ref="chg_dt" visibility="hidden"/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="occr_seq" visibility="hidden"/>
			<col ref="dept_cd" visibility="hidden"/>
			<col ref="budg_cd" visibility="hidden"/>
			<col ref="sub_seq" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					//SUBTOTAL 수행에 따른 합계금액이 계산된 Row를 삭제
					if (grd_aset_chg.valueMatrix(grd_aset_chg.rows-1, 2) == "합계금액") {
						grd_aset_chg.removeRow(grd_aset_chg.rows-1);
						model1.refresh();
					}
					
					getSubTotal();
				]]>
			</script>
		</datagrid>
		<caption id="caption2" class="tit01" style="left:10px; top:5px; width:765px; height:27px; ">매각등록/수정</caption>
		<caption id="caption120" class="list_cap02" style="left:869px; top:120px; width:66px; height:24px; text-align:center; "/>
		<caption id="caption121" class="list_cap03" style="left:790px; top:120px; width:80px; height:24px; color:#0000ff; text-align:center; ">최종마감년월</caption>
		<output id="opt_clos_yymm" ref="/root/reqData/reqForm/clos_yymm" format="yyyy-mm" inputtype="input" appearance="output" style="left:874px; top:123px; width:56px; height:18px; text-align:center; "/>
		<group id="group_btnT" class="gro_tab" style="left:10px; top:582px; width:926px; height:25px; ">
			<caption id="caption37" class="tabline" style="left:0px; top:22px; width:925px; height:1px; "/>
			<button id="btnT1" class="tab05" group="tab" selected="true" style="left:0px; top:0px; width:92px; height:23px; ">
				<caption>현금입금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case1");	
						button3.visible = false;
						button7.visible = false;				
					]]>
				</script>
			</button>
			<button id="btnT2" class="tab05" group="tab" selected="false" style="left:92px; top:0px; width:92px; height:23px; ">
				<caption>예금입금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case2");		
						button3.visible = true;
						button7.visible = true;				
					]]>
				</script>
			</button>
			<button id="btnT3" class="tab05" group="tab" selected="false" style="left:184px; top:0px; width:92px; height:23px; ">
				<caption>어음입금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case3");		
						button3.visible = true;
						button7.visible = true;				
					]]>
				</script>
			</button>
			<button id="btnT4" class="tab05" group="tab" selected="false" style="left:276px; top:0px; width:92px; height:23px; ">
				<caption>기타입금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case4");		
						button3.visible = true;
						button7.visible = true;				
					]]>
				</script>
			</button>
			<button id="button3" class="btn_grid02" navindex="16" visibility="hidden" style="left:630px; top:3px; width:42px; height:17px; ">
				<caption>추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (switch1.selectedIndex == 1) {
							if (datagrid2.valueMatrix(datagrid2.rows-1, 1) != "")
								datagrid2.addRow();
							else {
								datagrid2.rowStatus(1) = 1;
								datagrid2.isReadOnly(1, 1, 1, 5) = false;
							}
						}
						else if (switch1.selectedIndex == 2) {
							if (datagrid3.valueMatrix(datagrid3.rows-1, 1) != "")
								datagrid3.addRow();
							else {
								datagrid3.rowStatus(1) = 1;
								datagrid3.isReadOnly(1, 1, 1, 11) = false;
							}
						}
						else if (switch1.selectedIndex == 3) {
							if (datagrid4.valueMatrix(datagrid4.rows-1, 1) != "") {
								datagrid4.addRow();
							} else {
								datagrid4.rowStatus(1) = 1;
								datagrid4.isReadOnly(1, 1, 1, 5) = false;
							}
							//datagrid4.valueMatrix(datagrid4.rows-1, 1) = "466400"; 120224
							datagrid4.valueMatrix(datagrid4.rows-1, 1) = model1.getValue("/root/initData/as_aset_1500_m/dataSet/xx_budg_cd");
							//datagrid4.valueMatrix(datagrid4.rows-1, 2) = "예수금(기타)"; 120302
							datagrid4.valueMatrix(datagrid4.rows-1, 2) = model1.getValue("/root/initData/as_aset_1500_m/dataSet/xx_budg_nm");
						}
					]]>
				</script>
			</button>
			<button id="button7" class="btn_grid02" navindex="18" visibility="hidden" style="left:673px; top:3px; width:42px; height:17px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (switch1.selectedIndex == 1) {
							datagrid2.rowStatus(datagrid2.row) = 4;
						}
						else if (switch1.selectedIndex == 2) {
							datagrid3.rowStatus(datagrid3.row) = 4;
						}
						else if (switch1.selectedIndex == 3) {
							datagrid4.rowStatus(datagrid4.row) = 4;
						}
						getRcpmTotAmt();
					]]>
				</script>
			</button>
		</group>
		<caption id="caption3" class="list_cap02" style="left:814px; top:579px; width:121px; height:26px; text-align:center; "/>
		<caption id="caption4" class="list_cap03" style="left:736px; top:579px; width:80px; height:26px; text-align:center; ">입금액</caption>
		<switch id="switch1" style="left:10px; top:605px; width:926px; height:115px; ">
			<case id="case1" scroll="none">
				<group id="tab" class="gro_tab1" style="left:0px; top:0px; width:937px; height:200px; ">
					<caption id="caption51" class="list_cap02" style="left:84px; top:5px; width:206px; height:26px; text-align:center; "/>
					<input id="input20" ref="/root/reqData/multiUpdate/cash_rcpm_amt" navindex="14" inputtype="input" format="#,###" appearance="input" style="left:89px; top:9px; width:116px; height:18px; text-align:right; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								getRcpmTotAmt();
							]]>
						</script>
					</input>
					<caption id="caption52" class="list_cap03" style="left:5px; top:5px; width:80px; height:26px; text-align:center; ">입금금액</caption>
				</group>
			</case>
			<case id="case2" selected="true">
				<datagrid id="datagrid2" nodeset="/root/resData/gridData1/record" caption="입금일자^입금금액^입금자명^관리구분^관리구분명^수수료^deps_sub_seq^biz_reg_no^bank_id^acct_num^tran_date^tran_date_seq^잔액조회" colsep="#" colwidth="120, 130, 170, 219, 68, 120, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" navindex="15" style="left:5px; top:5px; width:915px; height:104px; ">
					<col ref="deps_rmtt_dt" type="inputdate" format="yyyy-mm-dd" style="text-align:center; "/>
					<col ref="deps_rcpm_amt" type="input" format="#,###" style="text-align:right; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								getRcpmTotAmt();
							]]>
						</script>
					</col>
					<col ref="deps_rmtt_plac" type="input" style="text-align:center; "/>
					<col ref="deps_acct_mang_no" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/mang_clsf/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col ref="deps_acct_mang_nm" visibility="hidden" style="text-align:left; "/>
					<col ref="deps_coms_amt" type="input" format="#,###" style="text-align:right; "/>
					<col ref="deps_sub_seq" visibility="hidden"/>
					<col ref="deps_biz_reg_no" visibility="hidden"/>
					<col ref="deps_bank_id" visibility="hidden"/>
					<col ref="deps_acct_num" visibility="hidden"/>
					<col ref="deps_tran_date" visibility="hidden"/>
					<col ref="deps_tran_date_seq" visibility="hidden"/>
					<col type="inputbutton" editable="false">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
			  					var selectIdx = datagrid2.row;
			  					
			  					model.makeNode("/root/reqData/fwdData/acct_mang_no_ref");	
			  					model.setValue("/root/reqData/fwdData/acct_mang_no_ref", "/root/resData/gridData1/record["+selectIdx+"]/deps_acct_mang_no");		
			  					model.makeNode("/root/reqData/fwdData/acct_mang_nm_ref");	
			  					model.setValue("/root/reqData/fwdData/acct_mang_nm_ref", "/root/resData/gridData1/record["+selectIdx+"]/deps_acct_mang_nm");	  					
			  					model.makeNode("/root/reqData/fwdData/tran_amt_ref");	
			  					model.setValue("/root/reqData/fwdData/tran_amt_ref", "/root/resData/gridData1/record["+selectIdx+"]/deps_rcpm_amt");
			  					model.makeNode("/root/reqData/fwdData/tran_content_ref");	
			  					model.setValue("/root/reqData/fwdData/tran_content_ref", "/root/resData/gridData1/record["+selectIdx+"]/deps_rmtt_plac");			
			  							
								//loadRcpmDtlsPop("K1", 120224 (시스템 구분) (잔액조회 팝업 CO_BANK_1000.xrw)
								loadRcpmDtlsPop(model1.getValue("/root/initData/as_aset_1500_m/dataSet/xx_mang_cd_4"),
								                "",
								                "/root/resData/gridData1/record["+selectIdx+"]/deps_biz_reg_no",
								                "/root/resData/gridData1/record["+selectIdx+"]/deps_bank_id",
								                "/root/resData/gridData1/record["+selectIdx+"]/deps_acct_num",
								                "/root/resData/gridData1/record["+selectIdx+"]/deps_rmtt_dt",
								                "/root/resData/gridData1/record["+selectIdx+"]/deps_tran_date_seq",
											     "/root/reqData/fwdData");
											     
								model1.setValue("/root/resData/gridData1/record["+selectIdx+"]/deps_tran_date", model1.getValue("/root/resData/gridData1/record["+selectIdx+"]/deps_rmtt_dt"))
								getRcpmTotAmt();
							]]>
						</script>
					</col>
				</datagrid>
			</case>
			<case id="case3">
				<datagrid id="datagrid3" nodeset="/root/resData/gridData2/record" caption="어음번호^입금금액^어음구분^금융기관^금융기관명^발행인^발행사코드^기산일^만기일^입금계좌^매출승인번호^note_sub_seq" colsep="#" colwidth="80, 80, 80, 80, 80, 80, 80, 85, 85, 80, 80, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" navindex="17" style="left:5px; top:5px; width:915px; height:104px; ">
					<col ref="note_note_no" type="input" maxlength="8" style="text-align:center; "/>
					<col ref="note_rcpm_amt" type="input" format="(-)#,###" style="text-align:right; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								getRcpmTotAmt();
							]]>
						</script>
					</col>
					<col ref="note_note_clsf_cd" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/note_clsf/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col ref="note_bank_cd" type="inputbutton" maxlength="6">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								var getRow = datagrid3.row;
								var getCol = datagrid3.col;							
							
								if (getCol== 4) {		// 금융기관
									var cd   =  "";
									var cdnm =  "";
																
									var resultRef1 = "/root/resData/resForm/popupData/bank_cd";
									var resultRef2 = "/root/resData/resForm/popupData/bank_cd_nm";							
		
									//showCommonCodePopup1("02", "71", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", ""); 120224
									showCommonCodePopup1(model1.getValue("/root/initData/as_aset_1500_m/dataSet/xx_job_clsf_02"), model1.getValue("/root/initData/as_aset_1500_m/dataSet/xx_cd_clsf"), cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");

									datagrid3.valueMatrix(getRow,getCol) = model.getValue(resultRef1);
									datagrid3.valueMatrix(getRow,getCol+1) = model.getValue(resultRef2);
								}
							]]>
						</script>
					</col>
					<col ref="note_bank_nm" format="(-)#,###" style="text-align:left; "/>
					<col ref="note_issu_pers_nm" type="input" style="text-align:center; "/>
					<col ref="note_issu_cmpy_clsf" type="combo">
						<choices>
							<itemset nodeset="/root/initData/comboSet/issu_cmpy_clsf/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col ref="note_comp_dt" type="inputdate"/>
					<col ref="note_mtry_dt" type="inputdate"/>
					<col ref="note_rcpm_acct" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/mang_clsf/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col ref="note_sale_aprv_no" type="input" style="text-align:left; "/>
					<col ref="note_sub_seq" visibility="hidden"/>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
								var getRow = datagrid2.row;
								var getCol = datagrid2.col;			
							
								if (getCol== 5) {
									if (datagrid2.valueMatrix(getRow, getCol) == "") {
										datagrid2.valueMatrix(getRow, getCol+1) = "";
									}
								}						
							]]>
					</script>
				</datagrid>
			</case>
			<case id="case4">
				<datagrid id="datagrid4" nodeset="/root/resData/gridData3/record" caption="예산코드^예산명^입금금액^전사전표구분^전사전표번호^etc_sub_seq" colsep="#" colwidth="170, 222, 170, 170, 160, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" navindex="19" style="left:5px; top:5px; width:915px; height:104px; ">
					<col ref="etc_budg_cd" style="text-align:center; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								model.removeNodeset("/root/reqData/fwdData");  

								model.makeNode("/root/reqData/fwdData/G_Tag");
								model.makeNode("/root/reqData/fwdData/G_Caption");
								model.makeNode("/root/reqData/fwdData/G_Codenu");
								model.makeNode("/root/reqData/fwdData/G_BRCode");
								
								model.setValue("/root/reqData/fwdData/G_Tag", "1");
								model.setValue("/root/reqData/fwdData/G_Caption", "예산코드조회");
								model.setValue("/root/reqData/fwdData/G_Codenu", "");					
								model.setValue("/root/reqData/fwdData/G_BRCode", "");
		
								gstr_popupid = "budg_cd";
								window.load("/xrw/mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								if (datagrid4.valueMatrix(datagrid4.row, 1).length == 6) {
									model1.setValue("/root/reqData/reqForm/budg_cd", datagrid4.valueMatrix(datagrid4.row, 1));
									model1.send("as_aset_1709");
									if (model1.getValue("/root/tempData/dataSet/CURLIST/totcount") != "0") {
										datagrid4.valueMatrix(datagrid4.row, 2) = model1.getValue("/root/tempData/dataSet/CURLIST/record/budg_nm");
										model1.removeNodeset("/root/tempData/dataSet");
										model1.refresh();
									}
								}
							]]>
						</script>
					</col>
					<col ref="etc_budg_nm" style="text-align:left; "/>
					<col ref="etc_rcpm_amt" type="input" format="(-)#,###" style="text-align:right; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								getRcpmTotAmt();
							]]>
						</script>
					</col>
					<col ref="etc_bal_occr_slip_clsf" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/whco_slip_clsf/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col ref="etc_bal_occr_slip_no" type="inputbutton" style="text-align:left; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								model1.makeNode("/root/reqData/fwdData/occr_slip_clsf");
								model1.makeNode("/root/reqData/fwdData/bal_occr_slip_no");
								//model1.setValue("/root/reqData/fwdData/occr_slip_clsf", "96"); 120224 (기타입금탭의 전사전표번호 )
								model1.setValue("/root/reqData/fwdData/occr_slip_clsf", model1.getValue("/root/initData/as_aset_1500_m/dataSet/xx_occr_slip_clsf"));
								
								window.load("/xrw/en/comm/EN_COMM_1300.xrw","modal", "EN_COMM_1300", "align:center; width:805; height:605; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
								
								if (model1.getValue("/root/reqData/fwdData/bal_occr_slip_no") != "") {
									datagrid4.valueMatrix(datagrid4.row, 5) = (model1.getValue("/root/reqData/fwdData/bal_occr_slip_no")).ReplaceWord("-", "");
									datagrid4.valueMatrix(datagrid4.row, 4) = model1.getValue("/root/reqData/fwdData/occr_slip_clsf");
								}
									
								model1.removenode("/root/reqData/fwdData/occr_slip_clsf");
								model1.removenode("/root/reqData/fwdData/bal_occr_slip_no");

								/*
								model.property("FC_ACCT_2500_popup_clsf")  = "Y";
								model.property("FC_ACCT_2500_srch_occr_slip_clsf")  = datagrid3.valueMatrix(datagrid3.row,5).substring(0, 2);
							
								viewer("mainFrame").window.javaScript.onLoadPopupPage("FC_ACCT_2500");

								datagrid4.valueMatrix(datagrid4.row,5) = model.property("FC_ACCT_2500_occr_slip");
								datagrid4.valueMatrix(datagrid4.row,4) = model.property("FC_ACCT_2500_srch_occr_slip_clsf");
								
								model.property("FC_ACCT_2500_occr_slip") = "";
								model.property("FC_ACCT_2500_srch_occr_slip_clsf") = "";
								*/
							]]>
						</script>
					</col>
					<col ref="etc_sub_seq" visibility="hidden"/>
				</datagrid>
			</case>
		</switch>
		<output id="opt_rcpm_amt" ref="/root/reqData/multiUpdate/rcpm_amt" format="#,###" inputtype="input" appearance="output" style="left:820px; top:583px; width:96px; height:18px; text-align:right; "/>
		<input id="input1" ref="/root/reqData/multiUpdate/rcpm_shet_no" navindex="13" editable="false" inputtype="button" style="left:820px; top:558px; width:96px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					model1.makeNode("/root/reqData/fwdData/rcpm_clsf");
					model1.makeNode("/root/reqData/fwdData/rcpm_shet_kind");
					model1.makeNode("/root/reqData/fwdData/rcpm_shet_no");
					//model1.setValue("/root/reqData/fwdData/rcpm_clsf", "96"); 120224 (전표구분)
					model1.setValue("/root/reqData/fwdData/rcpm_clsf", model1.getValue("/root/initData/as_aset_1500_m/dataSet/xx_occr_slip_clsf"));
					
					window.load("/xrw/en/comm/EN_COMM_1400.xrw","modal", "EN_COMM_1400", "align:center; width:805; height:605; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
					
					model1.setValue("/root/reqData/multiUpdate/rcpm_shet_kind", model.getValue("/root/reqData/fwdData/rcpm_shet_kind"));
					model1.setValue("/root/reqData/multiUpdate/rcpm_shet_no", model.getValue("/root/reqData/fwdData/rcpm_shet_no"));

					model1.removenode("/root/reqData/fwdData/rcpm_clsf");
					model1.removenode("/root/reqData/fwdData/rcpm_shet_kind");
					model1.removenode("/root/reqData/fwdData/rcpm_shet_no");
					model1.refresh();
				]]>
			</script>
		</input>
		<caption id="caption38" class="list_cap03" style="left:736px; top:554px; width:80px; height:26px; ">입금표번호</caption>
	</xhtml:body>
</xhtml:html>
