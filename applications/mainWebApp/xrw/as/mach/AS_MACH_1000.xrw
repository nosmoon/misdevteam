<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<xx_phot_job_clsf/>
							<!-- 선택계열의 정보를 담당 -->
							<work_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</work_clsf>
							<mach_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</mach_clsf>
							<bldg_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</bldg_clsf>
							<work_clsf2>
								<item>
									<label/>
									<value/>
								</item>
							</work_clsf2>
							<mach_clsf2>
								<item>
									<label/>
									<value/>
								</item>
							</mach_clsf2>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<initReqForm>
							<as_fee/>
							<usag/>
							<stnd/>
							<inst_dt/>
							<exp_dt/>
							<loca/>
							<life_year/>
							<mach_name/>
							<make_comp/>
							<inst_comp/>
							<inst_fee/>
							<as_tel/>
							<model_name/>
							<as_comp/>
							<remk/>
							<up_phot_img/>
							<work_clsf/>
							<mach_clsf/>
							<bldg_clsf/>
							<job_clsf/>
							<mach_seq/>
						</initReqForm>
						<initAsForm>
							<mach_as_dt/>
							<as_comp/>
							<as_fee/>
							<as_cont/>
							<remk/>
							<mach_seq/>
							<as_seq/>
							<job_clsf/>
						</initAsForm>
						<initGrid2>
							<record>
								<mach_as_dt/>
								<as_comp/>
								<as_fee/>
								<as_cont/>
								<remk/>
								<mach_seq/>
								<as_seq/>
							</record>
						</initGrid2>
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<searchData>
							<cmpy_cd/>
							<work_clsf/>
							<mach_clsf/>
							<bldg_clsf/>
							<mach_seq/>
							<job_clsf/>
							<aset_no/>
							<work_clsf2/>
							<sflag/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqForm>
							<as_fee/>
							<usag/>
							<stnd/>
							<inst_dt/>
							<exp_dt/>
							<loca/>
							<life_year/>
							<mach_name/>
							<make_comp/>
							<inst_comp/>
							<inst_fee/>
							<as_tel/>
							<model_name/>
							<as_comp/>
							<remk/>
							<up_phot_img/>
							<work_clsf/>
							<mach_clsf/>
							<bldg_clsf/>
							<job_clsf/>
							<mach_seq/>
						</reqForm>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<!-- MultiUpDate유형 사용시 처리 -->
						<fwdData>
						</fwdData>
						<reqAsForm>
							<mach_as_dt/>
							<as_comp/>
							<as_fee/>
							<as_cont/>
							<remk/>
							<mach_seq/>
							<as_seq/>
							<job_clsf/>
						</reqAsForm>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<cmpy_cd/>
							<phot_img type="xsd:base64Binary"/>
						</resForm>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<msg>
							<errMsg/>
							<errCode/>
						</msg>
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<!-- datagrid2 -->
							<!-- datagrid3 -->
							<record>
								<work_clsf_nm/>
								<mach_clsf_nm/>
								<bldg_clsf_nm/>
								<mach_name/>
								<model_name/>
								<stnd/>
								<usag/>
								<loca/>
								<life_year/>
								<make_comp/>
								<inst_comp/>
								<inst_fee/>
								<inst_dt/>
								<exp_dt/>
								<as_comp/>
								<as_fee/>
								<as_tel/>
								<mach_seq/>
							</record>
						</gridData>
						<gridData2>
							<record>
								<mach_as_dt/>
								<as_comp/>
								<as_fee/>
								<as_cont/>
								<remk/>
								<mach_seq/>
								<as_seq/>
							</record>
						</gridData2>
					</resData>
					<tempData>
					</tempData>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					
					function getArtDetailInfo() {
						var mach_seq  = "";
						var selectValue = "";
						var selectedIdx = datagrid1.row;

						mach_seq = model1.getValue("/root/resData/gridData/record["+ selectedIdx +"]/mach_seq");
						
						if(mach_seq == "") return;
						
						model1.setValue("/root/reqData/searchData/mach_seq",  mach_seq );
						model1.send("as_mach_1015_s");

						if(submit_completed()) { //서브밋 성공시

							model1.copyNode("/root/reqData/reqForm" ,"/root/tempData/dataSet/reqForm");
							model1.copyNode("/root/resData/gridData2","/root/tempData/dataSet/CURLIST");
							model1.removenode("/root/tempData/dataSet");														
							model1.refresh();
							
							if (datagrid2.rows == 1) {
								datagrid2.addRow();
							}
							
							//이미지 부르기
							model1.setValue("/root/reqData/searchData/aset_no", mach_seq);
							model1.setValue("/root/reqData/searchData/job_clsf", "3");

							model1.send("as_com_1000");
							model1.makeNode("/root/resData/resForm/phot_img");
							root.resData.resForm.phot_img.setAttribute("type", "xsd:base64Binary");
							model1.setValue("/root/resData/resForm/phot_img", model1.getValue("/root/tempData/dataSet/phot_img"));

							img1.visible = false;
							img2.visible = true;
							img1.refresh();	
							
							model1.setValue("/root/reqData/reqAsForm/mach_seq", mach_seq);

						}
						
						model1.refresh();

					}
					
					function openAsForm(job_clsf) {
						var selectedIdx = datagrid2.row;
											
						model1.removeNodeset("/root/reqData/fwdData");  
						model1.makeNode("/root/reqData/fwdData/cmpy_cd");
						//----------------------------------------------------------------------
						model1.makeNode("/root/reqData/fwdData/reqAsForm/mach_as_dt");
						model1.makeNode("/root/reqData/fwdData/reqAsForm/as_comp");
						model1.makeNode("/root/reqData/fwdData/reqAsForm/as_fee");
						model1.makeNode("/root/reqData/fwdData/reqAsForm/as_cont");
						model1.makeNode("/root/reqData/fwdData/reqAsForm/remk");
						model1.makeNode("/root/reqData/fwdData/reqAsForm/mach_seq");
						model1.makeNode("/root/reqData/fwdData/reqAsForm/as_seq");
						//----------------------------------------------------------------------					
						model1.makeNode("/root/reqData/fwdData/G_Tag");
						model1.makeNode("/root/reqData/fwdData/G_Caption");
						model1.makeNode("/root/reqData/fwdData/G_Codenu");
						model1.makeNode("/root/reqData/fwdData/G_BRCode");

						model1.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
						model1.setValue("/root/reqData/fwdData/G_Tag", "");
						model1.setValue("/root/reqData/fwdData/G_Caption", "유지보수이력관리");
						model1.setValue("/root/reqData/fwdData/G_Codenu", "");
						model1.setValue("/root/reqData/fwdData/G_BRCode", "");

						if(job_clsf == "I") {
							model1.setValue("/root/reqData/fwdData/reqAsForm/mach_seq", model1.getValue("/root/reqData/reqForm/mach_seq"));
						} else {
							model1.copyNode("/root/reqData/fwdData/reqAsForm" ,"/root/resData/gridData2/record["+ selectedIdx +"]");
						}

						window.load("../../as/mach/AS_MACH_1035.xrw", "modal", "", "align:center; width:660; height:480; sysmenu:hidden; min:false; max:false; resize:false; ", "/root/reqData/fwdData", "/root/reqData/fwdData");
					}

					function updateAsList() {
						var mach_seq = "";
						mach_seq = model1.getValue("/root/reqData/reqForm/mach_seq");	

						model1.send("as_mach_1030_l");
						model1.copyNode("/root/resData/gridData2","/root/tempData/dataSet/CURLIST");
						model1.removenode("/root/tempData/dataSet");
						
						//model1.copyNode("/root/reqData/reqAsForm", "/root/initData/initAsForm");
						//model1.setValue("/root/reqData/reqAsForm/mach_seq", mach_seq);
						datagrid2.refresh();

						if (datagrid2.rows == 1) {
							datagrid2.addRow();
						}
					}

				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					model1.setValue("/root/reqData/searchData/cmpy_cd", "100");
					model1.send("as_mach_1000_m");
					
					makeComboSet("", "/root/tempData/dataSet/curwork/record", "/root/initData/comboSet/work_clsf", "cdabrvnm_cd", "cd");
					makeComboSet("", "/root/tempData/dataSet/curwork/record", "/root/initData/comboSet/work_clsf2", "cdabrvnm_cd", "cd");
					makeComboSet("", "/root/tempData/dataSet/curmach/record", "/root/initData/comboSet/mach_clsf", "cdabrvnm_cd", "cd");
					makeComboSet("", "/root/tempData/dataSet/curmach/record", "/root/initData/comboSet/mach_clsf2", "cdabrvnm_cd", "cd");
					makeComboSet("", "/root/tempData/dataSet/curbldg/record", "/root/initData/comboSet/bldg_clsf", "cdabrvnm_cd", "cd");
				]]>
			</script>
			<submission id="as_com_1000" action="/as/com/1000" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_mach_1000_m" action="/as/mach/1000" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_mach_1005_l" action="/as/mach/1005" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_mach_1020_a" action="/as/mach/1020" mediatype="multipart/form-data" method="form-data-post" ref="/root/reqData/reqForm" replace="instance" resultref="/root/tempData/dataSet/"/>
			<submission id="as_mach_1010_l" action="/as/mach/1010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_mach_1015_s" action="/as/mach/1015" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_mach_1030_l" action="/as/mach/1030" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqAsForm" replace="instance" resultref="/root/tempData/dataSet"/>
			<submission id="as_mach_1040_a" action="/as/mach/1040" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqAsForm" replace="instance" resultref="/root/tempData/dataSet"/>
		</model>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/as_common.js"/>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="740" guideline="1,952;2,301;2,727;" style="font-family:굴림; ">
		<group id="group_tab" class="gro_tab1" style="left:10px; top:327px; width:926px; height:271px; ">
			<caption id="caption12" class="list_cap02" style="left:704px; top:0px; width:220px; height:265px; "/>
			<caption id="caption16" class="list_cap02" style="left:0px; top:-6px; width:705px; height:271px; "/>
			<caption id="caption47" class="list_cap02" style="left:79px; top:75px; width:626px; height:26px; text-align:center; "/>
			<caption id="caption6" class="list_cap02" style="left:79px; top:50px; width:626px; height:26px; "/>
			<caption id="caption4" class="list_cap02" style="left:79px; top:25px; width:626px; height:26px; "/>
			<caption id="caption8" class="list_cap02" style="left:79px; top:100px; width:626px; height:26px; "/>
			<caption id="caption7" class="list_cap03" style="left:0px; top:25px; width:85px; height:26px; ">장비명</caption>
			<caption id="caption11" class="list_cap03" style="left:0px; top:75px; width:85px; height:26px; ">제작회사</caption>
			<caption id="caption13" class="list_cap03" style="left:470px; top:75px; width:85px; height:26px; ">설치금액</caption>
			<caption id="caption14" class="list_cap02" style="left:79px; top:150px; width:626px; height:115px; "/>
			<caption id="caption15" class="list_cap03" style="left:233px; top:125px; width:85px; height:26px; ">월유지보수비</caption>
			<caption id="caption17" class="list_cap03" style="left:0px; top:150px; width:85px; height:115px; ">비고</caption>
			<input id="input6" ref="/root/reqData/reqForm/mach_name" class="req" navindex="7" autonext="false" maxlength="25" caption="장비명" appearance="input" style="left:89px; top:29px; width:117px; height:18px; text-align:left; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("input9",true);
						}
					]]>
				</script>
			</input>
			<caption id="caption46" class="list_cap03" style="left:233px; top:50px; width:85px; height:26px; text-align:center; ">위치</caption>
			<input id="input17" inputtype="input" appearance="input" style="left:84px; top:3px; width:95px; height:18px; "/>
			<caption id="caption51" class="list_cap02" style="left:79px; top:0px; width:626px; height:26px; text-align:center; "/>
			<caption id="caption52" class="list_cap03" style="left:0px; top:0px; width:85px; height:26px; text-align:center; ">업무구분</caption>
			<input id="input14" ref="/root/reqData/reqForm/usag" navindex="10" autonext="false" inputtype="input" maxlength="25" appearance="input" style="left:89px; top:54px; width:117px; height:18px; text-align:left; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("input19",true);
						}					
					]]>
				</script>
			</input>
			<input id="input4" ref="/root/reqData/reqForm/inst_dt" navindex="15" autonext="false" inputtype="date" maxlength="8" format="yyyy-mm-dd" style="left:89px; top:104px; width:117px; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("input11",true);
						}					
					]]>
				</script>
			</input>
			<input id="input2" ref="/root/reqData/reqForm/make_comp" navindex="12" autonext="false" maxlength="25" appearance="input" style="left:89px; top:79px; width:117px; height:18px; text-align:left; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("input15",true);
						}					
					]]>
				</script>
			</input>
			<input id="input3" ref="/root/reqData/reqForm/inst_fee" navindex="14" autonext="false" maxlength="25" format="#,###" appearance="input" style="left:560px; top:79px; width:115px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("input4",true);
						}
					]]>
				</script>
			</input>
			<input id="input9" ref="/root/reqData/reqForm/model_name" navindex="8" autonext="false" maxlength="25" appearance="input" style="left:322px; top:29px; width:117px; height:18px; text-align:left; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("input10",true);
						}
					]]>
				</script>
			</input>
			<textarea id="input12" ref="/root/reqData/reqForm/remk" navindex="20" maxlength="2000" appearance="textarea" style="left:89px; top:155px; width:611px; height:105px; text-align:left; vertical-align:top; "/>
			<caption id="caption3" class="list_cap03" style="left:470px; top:0px; width:85px; height:26px; ">건물구분</caption>
			<caption id="caption5" class="list_cap03" style="left:470px; top:25px; width:85px; height:26px; ">규격</caption>
			<input id="input10" ref="/root/reqData/reqForm/stnd" navindex="9" autonext="false" maxlength="50" appearance="input" style="left:560px; top:29px; width:115px; height:18px; text-align:left; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("input14",true);
						}
					]]>
				</script>
			</input>
			<caption id="caption19" class="list_cap03" style="left:233px; top:25px; width:85px; height:26px; ">모델명</caption>
			<caption id="caption21" class="list_cap03" style="left:0px; top:100px; width:85px; height:26px; text-align:center; ">설치일자</caption>
			<input id="input11" ref="/root/reqData/reqForm/exp_dt" navindex="16" autonext="false" inputtype="date" maxlength="8" format="yyyy-mm-dd" style="left:322px; top:104px; width:117px; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("input5",true);
						}					
					]]>
				</script>
			</input>
			<caption id="caption24" class="list_cap03" style="left:233px; top:75px; width:85px; height:26px; ">설치회사</caption>
			<input id="input15" ref="/root/reqData/reqForm/inst_comp" navindex="13" autonext="false" maxlength="25" appearance="input" style="left:322px; top:79px; width:117px; height:18px; text-align:left; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("input3",true);
						}					
					]]>
				</script>
			</input>
			<caption id="caption27" class="list_cap03" style="left:470px; top:125px; width:85px; height:26px; ">연락처</caption>
			<caption id="caption22" class="list_cap03" style="left:0px; top:125px; width:85px; height:26px; ">유지보수업체</caption>
			<input id="input16" ref="/root/reqData/reqForm/as_tel" navindex="19" autonext="false" maxlength="25" appearance="input" style="left:560px; top:129px; width:115px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("input12",true);
						}					
					]]>
				</script>
			</input>
			<caption id="caption9" class="list_cap03" style="left:233px; top:0px; width:85px; height:26px; text-align:center; ">장비구분</caption>
			<select1 id="combo2" ref="/root/reqData/reqForm/mach_clsf" class="req" navindex="5" appearance="minimal" caption="장비구분" style="left:322px; top:4px; width:117px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/mach_clsf2/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("combo1",true);
						}
					]]>
				</script>
			</select1>
			<caption id="caption20" class="list_cap03" style="left:0px; top:50px; width:85px; height:26px; ">용도</caption>
			<caption id="caption10" class="list_cap03" style="left:233px; top:100px; width:85px; height:26px; ">폐기일자</caption>
			<input id="input19" ref="/root/reqData/reqForm/loca" navindex="11" autonext="false" maxlength="25" appearance="input" style="left:322px; top:54px; width:117px; height:18px; text-align:left; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("input2",true);
						}					
					]]>
				</script>
			</input>
			<input id="input5" ref="/root/reqData/reqForm/as_comp" navindex="17" autonext="false" maxlength="25" appearance="input" style="left:89px; top:129px; width:117px; height:18px; text-align:left; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("input7",true);
						}					
					]]>
				</script>
			</input>
			<input id="input7" ref="/root/reqData/reqForm/as_fee" navindex="18" autonext="false" maxlength="25" format="#,###" appearance="input" style="left:322px; top:129px; width:117px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("input16",true);
						}					
					]]>
				</script>
			</input>
			<select1 id="combo1" ref="/root/reqData/reqForm/bldg_clsf" class="req" navindex="6" appearance="minimal" caption="건물구분" style="left:560px; top:4px; width:115px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/bldg_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("input6",true);
						}
					]]>
				</script>
			</select1>
			<select1 id="combo4" ref="/root/reqData/reqForm/work_clsf" class="req" navindex="4" appearance="minimal" caption="업무구분" style="left:89px; top:4px; width:117px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/work_clsf2/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("combo2",true);
						}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						model1.setValue("/root/reqData/searchData/work_clsf2", combo4.value);
						model1.setValue("/root/reqData/searchData/sflag", "2");
						model1.send("as_mach_1005_l");

						if(submit_completed()) { //서브밋 성공시
							makeComboSet("", "/root/tempData/dataSet/curmach/record", "/root/initData/comboSet/mach_clsf2", "cdabrvnm_cd", "cd");
							combo2.selectedIndex = 0;
							model1.refresh();
						}
					]]>
				</script>
			</select1>
			<caption id="caption2" class="list_cap03" style="left:470px; top:50px; width:85px; height:26px; ">내용연수</caption>
			<output id="life_year" ref="/root/reqData/reqForm/life_year" navindex="11" appearance="output" maxlength="25" style="left:560px; top:54px; width:115px; height:18px; text-align:left; "/>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:94px; width:926px; height:5px; "/>
		<group id="group_tit" class="gro_tit2" style="left:10px; top:98px; width:926px; height:20px; ">
			<caption id="subtitle" class="tit02" style="left:0px; top:0px; width:515px; height:20px; ">장비조회</caption>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" scroll="auto" caption="업무구분^장비구분^건물구분^장비명^모델명^규격^용도^위치^내용연수^제작회사^설치회사^설치금액^설치일자^폐기일자^유지보수업체^유지보수금액^연락처^" colsep="^" colwidth="73, 96, 130, 165, 111, 124, 90, 108, 110, 110, 110, 110, 110, 110, 110, 110, 110, 0" extendlastcol="false" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" navindex="38" style="left:10px; top:119px; width:926px; height:198px; ">
			<col ref="work_clsf_nm" style="text-align:center; "/>
			<col ref="mach_clsf_nm" style="text-align:center; "/>
			<col ref="bldg_clsf_nm" style="text-align:center; "/>
			<col ref="mach_name" style="text-align:center; "/>
			<col ref="model_name" style="text-align:center; "/>
			<col ref="stnd" style="text-align:center; "/>
			<col ref="usag" style="text-align:center; "/>
			<col ref="loca" style="text-align:center; "/>
			<col ref="life_year" style="text-align:center; "/>
			<col ref="make_comp" style="text-align:center; "/>
			<col ref="inst_comp" style="text-align:center; "/>
			<col ref="inst_fee" format="#,###" style="text-align:right; "/>
			<col ref="inst_dt" format="yyyy-mm-dd" style="text-align:center; "/>
			<col ref="exp_dt" format="yyyy-mm-dd" style="text-align:center; "/>
			<col ref="as_comp" style="text-align:center; "/>
			<col ref="as_fee" format="#,###" style="text-align:right; "/>
			<col ref="as_tel" style="text-align:center; "/>
			<col ref="mach_seq" visibility="hidden"/>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					if(datagrid1.row == 0) return;				
					getArtDetailInfo()
					
					//var inst_dt = model1.getValue("/root/reqData/reqForm/inst_dt");
					//life_year.attribute("color") = "#FF0000";
				]]>
			</script>
		</datagrid>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:41px; width:926px; height:21px; ">
			<button id="btnA1" class="btn02" navindex="28" style="left:588px; top:0px; width:52px; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var mach_seq = "";
						mach_seq = model1.getValue("/root/reqData/reqForm/mach_seq");
/*						
						if( mach_seq != "" ) {
							alert("이미 등록되어 있는 자료입니다.");
							return;
						}
*/						

						//설치일자 자릿수체크.
						var inst_dt = input4.value;
						if ( inst_dt != "" ) {
							if ( inst_dt.length < "8" ) {
								alert("설치일자를 정확히 입력하세요");
								return;
							}
						}
						//폐기일자 자릿수 체크.
						var exp_dt = input11.value;
						if ( exp_dt != "" ) {
							if ( exp_dt.length < "8" ) {
								alert("폐기일자를 정확히 입력하세요");
								return;
							}
						}

					
						if (commReqCheck(group_tab)) {	
							if (window.alert("입력하시겠습니까?", "확인", 1) == 1) {
								model1.makeNode("/root/reqData/reqForm/job_clsf");
								model1.setValue("/root/reqData/reqForm/job_clsf", "I");

								model1.send("as_mach_1020_a");
								
								if(submit_completed()) { //서브밋 성공시
									alert("입력 되었습니다");
									btnA5.dispatch("onclick");
								}
							}
						}
					]]>
				</script>
			</button>
			<button id="btnA2" class="btn02" navindex="29" style="left:643px; top:0px; width:52px; height:21px; ">
				<caption>수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[					
						var mach_seq = "";
						mach_seq = model1.getValue("/root/reqData/reqForm/mach_seq");
						
						if( mach_seq == "" ) {
							alert("수정 할 자료를 목록에서 선택하십시오.");
							return;
						}
						
						if (datagrid1.valueMatrix(1, 1) == "") {
							alert("수정 할 자료를 목록에서 선택하십시오.");
							return;
						}

						//설치일자 자릿수체크.
						var inst_dt = input4.value;
						if ( inst_dt != "" ) {
							if ( inst_dt.length < "8" ) {
								alert("설치일자를 정확히 입력하세요");
								return;
							}
						}
						//폐기일자 자릿수 체크.
						var exp_dt = input11.value;
						if ( exp_dt != "" ) {
							if ( exp_dt.length < "8" ) {
								alert("폐기일자를 정확히 입력하세요");
								return;
							}
						}

						var selectedRow = datagrid1.row;
						
						if (commReqCheck(group_tab)) {
							if (window.alert("수정하시겠습니까?", "확인", 1) == 1) {
								model1.makeNode("/root/reqData/reqForm/job_clsf");
								model1.setValue("/root/reqData/reqForm/job_clsf", "U");
								model1.send("as_mach_1020_a");
								
								if(submit_completed()) { //서브밋 성공시
									alert("수정되었습니다");
									btnA5.dispatch("onclick");
								}
							}
						}
					]]>
				</script>
			</button>
			<button id="btnA3" class="btn02" navindex="30" style="left:698px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (model1.getValue("/root/reqData/reqForm/mach_seq") == "" ) {
							alert("삭제 할 자료를 목록에서 선택하십시오.");
							return;
						}
						
						if (window.alert("삭제하시겠습니까?\n(삭제시 유지보수 이력도 함께 삭제됩니다.)", "확인", 1) == 1) {
							model1.makeNode("/root/reqData/reqForm/job_clsf");
			 				model1.setValue("/root/reqData/reqForm/job_clsf", "D");
			 				model1.send("as_mach_1020_a");

							if(submit_completed()) { //성공
								alert("삭제 되었습니다");
								btnA5.dispatch("onclick");
							}
						}	
					
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" navindex="33" style="left:874px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					]]>
				</script>
			</button>
			<button id="btnA5" class="btn02" navindex="27" style="left:533px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//model1.send("as_artmgr_1002");
						model1.send("as_mach_1010_l");
						model1.copyNode("/root/resData/gridData","/root/tempData/dataSet/CURLIST");
						//model1.removenode("/root/tempData/dataSet");
						model1.refresh();
						
						if (datagrid1.rows == 1) {
							datagrid1.addRow();
						}
						
						/*
						model1.resetInstanceNode("/root/reqData/reqForm");
						model1.resetInstanceNode("/root/resData/resForm");
						model1.resetInstanceNode("/root/resData/gridData2/record");
						*/
						model1.copyNode("/root/reqData/reqForm", "/root/initData/initReqForm");
						model1.copyNode("/root/reqData/reqAsForm", "/root/initData/initAsForm");
						model1.copyNode("/root/resData/gridData2", "/root/initData/initGrid2");
						
						model1.setValue("/root/resData/resForm/phot_img", "");
						model1.setValue("/root/reqData/reqForm/up_phot_img", "");

						
						model1.refresh();
					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" navindex="32" style="left:820px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.reset();
						combo5.dispatch("xforms-value-changed");
					]]>
				</script>
			</button>
			<button id="button3" class="btn03" navindex="31" style="left:753px; top:0px; width:63px; height:21px; ">
				<caption>엑셀저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
						
						if(filename != "") {
							datagrid1.saveExcel(filename, "sheetname:sheet1;colhiddenextend:false;rowhiddenextend:false;row_0:label;");
						}
					]]>
				</script>
			</button>
		</group>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group3" class="gro_sel" style="left:10px; top:69px; width:926px; height:26px; ">
			<caption id="caption30" class="list_cap02" style="left:79px; top:0px; width:846px; height:26px; "/>
			<caption id="caption31" class="list_cap01" style="left:0px; top:0px; width:80px; height:26px; ">업무구분</caption>
			<caption id="caption32" class="list_cap01" style="left:270px; top:0px; width:80px; height:26px; ">장비구분</caption>
			<select1 id="combo5" ref="/root/reqData/searchData/work_clsf" navindex="1" appearance="minimal" style="left:83px; top:4px; width:135px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/work_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if (event.keyCode == 13) {
							model1.setValue("/root/reqData/searchData/work_clsf", combo5.value);
							btnA5.dispatch("onclick");
						}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						model1.setValue("/root/reqData/searchData/work_clsf", combo5.value);
						model1.setValue("/root/reqData/searchData/sflag", "1");
						model1.send("as_mach_1005_l");

						if(submit_completed()) { //서브밋 성공시
							makeComboSet("", "/root/tempData/dataSet/curmach/record", "/root/initData/comboSet/mach_clsf", "cdabrvnm_cd", "cd");
							combo6.selectedIndex = 0;
							model1.refresh();
						}
					]]>
				</script>
			</select1>
			<select1 id="combo6" ref="/root/reqData/searchData/mach_clsf" navindex="2" appearance="minimal" style="left:355px; top:4px; width:135px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/mach_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if (event.keyCode == 13) {
						model1.setValue("/root/reqData/searchData/mach_clsf", combo6.value);
						btnA5.dispatch("onclick");
					}
					]]>
				</script>
			</select1>
			<caption id="caption1" class="list_cap01" style="left:555px; top:0px; width:80px; height:26px; ">건물구분</caption>
			<select1 id="combo3" ref="/root/reqData/searchData/bldg_clsf" navindex="3" appearance="minimal" style="left:640px; top:4px; width:135px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/bldg_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if (event.keyCode == 13) {
						model1.setValue("/root/reqData/searchData/bldg_clsf", combo3.value);
						btnA5.dispatch("onclick");
					}
					]]>
				</script>
			</select1>
		</group>
		<upload id="upload1" nodeset="/root/reqData/reqForm/up_phot_img" ext="jpg;gif;png" filecount="1" filesize="10MB" validate="false" style="left:920px; top:365px; width:15px; height:20px; ">
			<script type="javascript" ev:event="upload-filesize-error">
				<![CDATA[
					alert("이미지의 사이즈가 초과되었습니다.\n10MB 이하의 이미지만 업로드가 가능합니다.");
					model.setValue("/root/resData/resForm/up_phot_img", "");
				]]>
			</script>
		</upload>
		<img id="img1" ref="/root/reqData/reqForm/up_phot_img" style="left:714px; top:327px; width:220px; height:198px; background-color:#f0f0f0; background-stretch:stretch; border-color:#99ccff; border-style:solid; ">
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				window.load("../com/AS_COM_1000.xrw","modeless","pop1","left:300; top:150; width:400px; height:300px; ","/root/reqData/reqForm/up_phot_img","/root/reqData/reqForm/up_phot_img");
				]]>
			</script>
		</img>
		<img id="img2" ref="/root/resData/resForm/phot_img" style="left:714px; top:327px; width:220px; height:198px; background-color:#f0f0f0; background-stretch:stretch; border-color:#99ccff; border-style:solid; ">
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				window.load("../com/AS_COM_1000.xrw","modeless","pop1","left:300; top:150; width:400px; height:300px; ","/root/resData/resForm/phot_img","/root/resData/resForm/phot_img");
				]]>
			</script>
		</img>
		<button id="button4" class="btn_grid05" navindex="21" style="left:820px; top:530px; width:105px; height:17px; background-stretch:stretch; ">
			<caption>장비사진업로드</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						var upload_photo = window.fileDialog("open", "", false, "", "", "jpg files (*.jpg)|*.jpg|gif files (*.gif)|*.gif|all files (*.*)|*.*");	
						if (upload_photo != "") {
							img1.visible = true;
							img2.visible = false;
							model.makeNode("/root/reqData/reqForm/up_phot_img");
							model.setValue("/root/reqData/reqForm/up_phot_img", upload_photo);
							upload1.revalidate(); // 유효성 체크
							img1.refresh();
						}
					]]>
			</script>
		</button>
		<caption id="caption37" class="tit02" style="left:10px; top:606px; width:100px; height:20px; ">이력관리</caption>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData2/record" caption="보수일자^보수업체^보수금액^보수내용^비고^^" colsep="#" colwidth="100, 100, 100, 154, 153, 0, 0" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" navindex="39" style="left:10px; top:629px; width:925px; height:101px; ">
			<col ref="mach_as_dt" format="yyyy-mm-dd"/>
			<col ref="as_comp"/>
			<col ref="as_fee" format="#,###" style="text-align:right; "/>
			<col ref="as_cont"/>
			<col ref="remk" style="text-align:left; "/>
			<col ref="mach_seq" visibility="hidden"/>
			<col ref="as_seq" visibility="hidden"/>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
				/*
					var selectedIdx = datagrid2.row;
										
					model1.removeNodeset("/root/reqData/fwdData");  
					model1.makeNode("/root/reqData/fwdData/cmpy_cd");
					//----------------------------------------------------------------------
					model1.makeNode("/root/reqData/fwdData/reqAsForm/mach_as_dt");
					model1.makeNode("/root/reqData/fwdData/reqAsForm/as_comp");
					model1.makeNode("/root/reqData/fwdData/reqAsForm/as_fee");
					model1.makeNode("/root/reqData/fwdData/reqAsForm/as_cont");
					model1.makeNode("/root/reqData/fwdData/reqAsForm/remk");
					model1.makeNode("/root/reqData/fwdData/reqAsForm/mach_seq");
					model1.makeNode("/root/reqData/fwdData/reqAsForm/as_seq");
					//----------------------------------------------------------------------					
					model1.makeNode("/root/reqData/fwdData/G_Tag");
					model1.makeNode("/root/reqData/fwdData/G_Caption");
					model1.makeNode("/root/reqData/fwdData/G_Codenu");
					model1.makeNode("/root/reqData/fwdData/G_BRCode");


					model1.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
					model1.setValue("/root/reqData/fwdData/G_Tag", "");
					model1.setValue("/root/reqData/fwdData/G_Caption", "유지보수이력관리");
					model1.setValue("/root/reqData/fwdData/G_Codenu", "");
					model1.setValue("/root/reqData/fwdData/G_BRCode", "");
					model1.copyNode("/root/reqData/fwdData/reqAsForm" ,"/root/resData/gridData2/record["+ selectedIdx +"]");

					window.load("../../as/mach/AS_MACH_1035.xrw", "modal", "", "align:center; width:660; height:480; sysmenu:hidden; min:false; max:false; resize:false; ", "/root/reqData/fwdData", "/root/reqData/fwdData");
					updateAsList();
				*/
				
					openAsForm("");
					updateAsList();
				]]>
			</script>
		</datagrid>
		<button id="button7" class="btn05" navindex="37" style="left:820px; top:605px; width:115px; height:21px; ">
			<caption>이력내용 엑셀저장</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");

						if(filename != "") {
							datagrid2.saveExcel(filename, "sheetname:sheet1;colhiddenextend:false;rowhiddenextend:false;row_0:label;");
						}
					]]>
			</script>
		</button>
		<button id="button1" class="btn02" navindex="37" style="left:765px; top:605px; width:52px; height:21px; ">
			<caption>입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					openAsForm("I");
					updateAsList();
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
