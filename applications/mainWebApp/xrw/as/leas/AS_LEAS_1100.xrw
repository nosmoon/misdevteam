<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<xx_cd_010/>
							<xx_cd_020/>
							<!-- 선택계열의 정보를 담당 -->
							<XX_CURLIST5>
								<item>
									<label/>
									<value/>
								</item>
							</XX_CURLIST5>
							<bldg_cd>
								<item>
									<label/>
									<value/>
								</item>
							</bldg_cd>
							<good_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</good_clsf>
							<pymt_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</pymt_clsf>
							<hire_dlco_clsf_cd>
								<item>
									<label/>
									<value/>
								</item>
							</hire_dlco_clsf_cd>
							<ern_nm>
								<item>
									<label/>
									<value/>
								</item>
							</ern_nm>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<searchData>
							<cmpy_cd/>
							<cntr_star>A</cntr_star>
							<bldg_cd/>
							<cntr_no/>
							<leas_fr_dt_1/>
							<leas_fr_dt_2/>
							<leas_to_dt_1/>
							<leas_to_dt_2/>
							<hire_dlco_nm/>
							<hire_dlco_ern/>
							<hire_dlco_ern_nm/>
							<srch_aset_no/>
							<leas_bldg_cd/>
							<aset_no/>
							<cntr_yy/>
							<cntr_seq/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqForm>
							<cmpy_cd/>
						</reqForm>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<multiUpDate/>
						<!-- MultiUpDate유형 사용시 처리 -->
						<fwdData>
							<func_nm/>
							<leas_bldg_cd/>
							<search_tag/>
							<aset_no/>
						</fwdData>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<mode/>
							<cmpy_cd/>
							<bldg_cd/>
							<aset_no/>
							<aset_no_e/>
							<aset_nm/>
							<rcpm_amt_end/>
							<leas_fr_dt/>
							<leas_to_dt/>
							<draft_no/>
							<cntr_no/>
							<cntr_leas_amt/>
							<leas_cntr_dt/>
							<last_leas_clam_dt/>
							<gurt_tot_amt/>
							<cntr_mang_amt/>
							<midw_expy_dt/>
							<last_mang_clam_dt/>
							<precpt_tot_amt/>
							<cntr_gurt_amt/>
							<cntr_star/>
							<gurt_out_amt/>
							<gurt_amt/>
							<leas_clam_cycl/>
							<end_clsf/>
							<precpt_out_amt/>
							<precpt_amt/>
							<mang_clam_cycl/>
							<pymt_clsf/>
							<expy_remk/>
							<good_clsf/>
							<ser_no/>
							<leas_area_size/>
							<remk/>
							<aset_addr/>
							<gurt_dlco_ern/>
							<gurt_dlco_nm/>
							<ref_cntr_no/>
							<leas_dlco_ern/>
							<leas_dlco_nm/>
							<hire_dlco_clsf_cd/>
							<hire_dlco_ern/>
							<hire_dlco_nm/>
							<cntr_yy/>
							<cntr_seq/>
							<bldg_cd_nm/>
							<bo_cd/>
							<bo_seq/>
							<ori_leas_cntr_dt/>
							<ori_leas_fr_dt/>
							<ori_leas_to_dt/>
							<ori_cntr_leas_amt/>
							<ori_cntr_mang_amt/>
							<ori_cntr_gurt_amt/>
							<ori_leas_clam_cycl/>
							<ori_mang_clam_cycl/>
							<ori_good_clsf/>
							<ori_ser_no/>
							<ori_leas_area_size/>
							<ori_hire_dlco_clsf_cd/>
							<ori_hire_dlco_ern/>
							<ori_pymt_clsf/>
							<frex_rcpm_yn/>
							<vat_non_yn/>
							<email/>
							<leas_telno1/>
							<leas_telno2/>
							<leas_telno3/>
							<unrcpm_info/>
						</resForm>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<msg>
							<errMsg/>
							<errCode/>
						</msg>
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<!-- datagrid2 -->
							<!-- datagrid3 -->
							<record>
								<cntr_no/>
								<bldg_cd_nm/>
								<ser_no/>
								<dlco_nm/>
								<leas_area_size/>
								<leas_fr_dt/>
								<leas_to_dt/>
								<cntr_star/>
								<cntr_leas_amt/>
								<leas_clam_cycl/>
								<cntr_mang_amt/>
								<mang_clam_cycl/>
								<tot_amt/>
								<cntr_gurt_amt/>
								<gurt_tot_amt/>
								<gurt_out_amt/>
								<gurt_amt/>
								<ref_cntr_no/>
								<bldg_cd/>
								<aset_no/>
								<aset_nm/>
								<draft_no/>
								<rcpm_amt_end/>
								<leas_cntr_dt/>
								<last_leas_clam_dt/>
								<midw_expy_dt/>
								<last_mang_clam_dt/>
								<precpt_tot_amt/>
								<end_clsf/>
								<precpt_out_amt/>
								<precpt_amt/>
								<pymt_clsf/>
								<expy_remk/>
								<good_clsf/>
								<remk/>
								<aset_addr/>
								<gurt_dlco_ern/>
								<gurt_dlco_nm/>
								<ref_cntr_nm/>
								<hire_dlco_clsf_cd/>
								<hire_dlco_ern/>
								<hire_dlco_nm/>
								<cmpy_cd/>
								<cntr_yy/>
								<cntr_seq/>
								<bo_cd/>
								<bo_seq/>
								<vat_non_yn/>
								<frex_rcpm_yn/>
								<email/>
								<leas_telno1/>
								<leas_telno2/>
								<leas_telno3/>
								<unrcpm_info/>
							</record>
						</gridData>
						<gridData2>
							<record>
								<aset_nm/>
								<plcw/>
								<aset_qunt_cnt/>
								<acqr_dt/>
								<aset_no/>
							</record>
						</gridData2>
					</resData>
					<tempData>
					</tempData>
				</root>
			</instance>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<script type="javascript" src="/js/fcmc_common.js"/>
			<script type="javascript" src="/js/as_common.js"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					//공통코드 조회하여 콤보박스에 설정
					model1.send("as_leas_1101");
					makeComboSet("", "/root/tempData/dataSet/CURLIST1/record", "/root/initData/comboSet/bldg_cd", "cdabrvnm_cd", "cd");
					makeComboSet("", "/root/tempData/dataSet/CURLIST2/record", "/root/initData/comboSet/good_clsf", "cdabrvnm_cd", "cd");
					makeComboSet("", "/root/tempData/dataSet/CURLIST3/record", "/root/initData/comboSet/pymt_clsf", "cdabrvnm_cd", "cd");
					makeComboSet("", "/root/tempData/dataSet/CURLIST4/record", "/root/initData/comboSet/hire_dlco_clsf_cd", "cdabrvnm_cd", "cd");
					model.copyNode("/root/initData/comboSet/XX_CURLIST5","/root/tempData/dataSet/XX_CURLIST5");
					model.setValue("/root/initData/comboSet/xx_cd_010",model.getValue("/root/tempData/dataSet/xx_cd_010"));
					model.setValue("/root/initData/comboSet/xx_cd_020",model.getValue("/root/tempData/dataSet/xx_cd_020"));
					model1.removeNodeset("/root/tempData/dataSet");
					
					//alert(model.getValue("/root/initData/comboSet/xx_cd_010"));
					//alert(model.getValue("/root/initData/comboSet/xx_cd_020"));
					
					//임대인등록번호 콤보 설정.
					model1.send("as_leas_1107");
					makeComboSet("", "/root/tempData/dataSet/CURLIST/record", "/root/initData/comboSet/ern_nm", "ern_nm", "ern");
					model1.removeNodeset("/root/tempData/dataSet");
					
					input16.disabled = true;  //해지일자 비활성화.
				       input4.disabled = true;  //이전계약번호 비활성화.
				]]>
			</script>
			<script type="javascript">
				<![CDATA[
					function setAset_no(iv_aset_no, iv_aset_nm){
						model1.setValue("/root/resData/resForm/aset_no", iv_aset_no);
						model1.setValue("/root/resData/resForm/aset_nm", iv_aset_nm);
						input10.refresh();
						output22.refresh();
						
						//부동산자력-하단그리드조회.
						model1.setValue("/root/reqData/searchData/aset_no", model1.getValue("/root/resData/resForm/aset_no") );
						model1.send("as_leas_1104");
						model1.copyNode("/root/resData/gridData2", "/root/tempData/dataSet/CURLIST1");
						model1.removeNodeset("/root/tempData/dataSet");
						model1.refresh();
						
						//소재지,임대인등록번호 가져오기.
						model1.send("as_leas_1106");
						model1.setValue("/root/resData/resForm/aset_addr" , model1.getValue("/root/tempData/dataSet/CURLIST/record/aset_size") );
						model1.setValue("/root/resData/resForm/hire_dlco_ern" , model1.getValue("/root/tempData/dataSet/CURLIST/record/leas_ern_no") );
						model1.setValue("/root/resData/resForm/hire_dlco_nm" , model1.getValue("/root/tempData/dataSet/CURLIST/record/leas_ern_nm") );
						model1.removeNodeset("/root/tempData/dataSet");
						model1.refresh();
					}
					
					function addDay(yyyy, mm, dd, pDay) { // 년, 월, 일, 계산할 일자 (년도는 반드시 4자리로 입력)
						var oDate; // 리턴할 날짜 객체 선언
						dd = dd*1 + pDay*1; // 날짜 계산
						mm--; // 월은 0~11 이므로 하나 빼준다
						oDate = new Date(yyyy, mm, dd) // 계산된 날짜 객체 생성 (객체에서 자동 계산)
						return oDate;
					}
					
					function addMonth(yyyy, mm, dd, pMonth) { // 년, 월, 일, 계산할 월 (년도는 반드시 4자리로 입력)
						var cDate; // 계산에 사용할 날짜 객체 선언
						var oDate; // 리턴할 날짜 객체 선언
						var cYear, cMonth, cDay // 계산된 날짜값이 할당될 변수
						mm = mm*1 + ((pMonth*1)-1); // 월은 0~11 이므로 하나 빼준다
						cDate = new Date(yyyy, mm, dd) // 계산된 날짜 객체 생성 (객체에서 자동 계산)
						cYear = cDate.getFullYear(); // 계산된 년도 할당
						cMonth = cDate.getMonth(); // 계산된 월 할당
						cDay = cDate.getDate(); // 계산된 일자 할당
						oDate = (dd == cDay) ? cDate : new Date(cYear, cMonth, 0); // 넘어간 월의 첫쨋날 에서 하루를 뺀 날짜 객체를 생성한다.
						return oDate;
					}
					
					function setDlco_no_fr(iv_dlco_no, iv_dlco_nm, iv_ern, iv_presi_nm){
						model1.setValue("/root/resData/resForm/gurt_dlco_ern", iv_ern);
						model1.setValue("/root/resData/resForm/gurt_dlco_nm", iv_dlco_nm);
						model1.refresh();
					}
					
					function setDlco_no(iv_dlco_no, iv_dlco_nm, iv_ern, iv_presi_nm){
						model1.setValue("/root/resData/resForm/hire_dlco_ern", iv_ern);
						model1.setValue("/root/resData/resForm/hire_dlco_nm", iv_dlco_nm);
						model1.refresh();
					}
					
					function setDlco_no_srch(iv_dlco_no, iv_dlco_nm, iv_ern, iv_presi_nm){
						model1.setValue("/root/reqData/searchData/hire_dlco_ern", iv_ern);
						model1.setValue("/root/reqData/searchData/hire_dlco_ern_nm", iv_dlco_nm);
						model1.refresh();
					}
					
					function getLeasDetailInfo() {
						var idx = 1;					
						var selectValue = "";
						var selectedIdx = datagrid1.row;
						
						model1.copyNode("/root/resData/resForm" , "/root/resData/gridData/record["+ selectedIdx +"]");
						model1.makeNode("/root/resData/resForm/aset_no");
						model1.makeNode("/root/resData/resForm/aset_nm");
						model1.makeNode("/root/resData/resForm/aset_no_ex");
						model1.setValue("/root/resData/resForm/aset_no_ex", model1.getValue("/root/resData/resForm/aset_no") );
		
						model1.refresh();
						
						strType = "U";
						model1.makeNode("/root/resData/resForm/mode");
						model1.setValue("/root/resData/resForm/mode", "U");
						
						model1.setValue("/root/reqData/searchData/leas_bldg_cd" , model1.getValue("/root/resData/resForm/bldg_cd") );
						//combo3.dispatch("xforms-value-changed");
						
						//부동산자력-하단그리드조회.
						model1.setValue("/root/reqData/searchData/aset_no", model1.getValue("/root/resData/resForm/aset_no") );
						model1.send("as_leas_1104");
						model1.copyNode("/root/resData/gridData2", "/root/tempData/dataSet/CURLIST1");
						model1.removeNodeset("/root/tempData/dataSet");
						model1.refresh();
						
						model1.makeNode("/root/resData/resForm/ori_leas_cntr_dt");        // 계약일자
						model1.makeNode("/root/resData/resForm/ori_leas_fr_dt");            // 임대기간-시작일자
						model1.makeNode("/root/resData/resForm/ori_leas_to_dt");           // 임대기간-종료일자
						model1.makeNode("/root/resData/resForm/ori_cntr_leas_amt");      //"임대료
						model1.makeNode("/root/resData/resForm/ori_cntr_mang_amt");    // 관리비
						model1.makeNode("/root/resData/resForm/ori_cntr_gurt_amt");       // 부가세
						model1.makeNode("/root/resData/resForm/ori_leas_clam_cycl");    // 임대료청구주기
						model1.makeNode("/root/resData/resForm/ori_mang_clam_cycl");  // 관리비청구주기
						model1.makeNode("/root/resData/resForm/ori_good_clsf");            //  물건구분
						model1.makeNode("/root/resData/resForm/ori_ser_no");                //  호수
						model1.makeNode("/root/resData/resForm/ori_leas_area_size");    // 평수
						model1.makeNode("/root/resData/resForm/ori_hire_dlco_clsf_cd"); // 임차사구분코드
						model1.makeNode("/root/resData/resForm/ori_hire_dlco_ern");      // 임차사번호
						model1.makeNode("/root/resData/resForm/ori_pymt_clsf");           // 납입방법

						//보증금누계, 보증금대체, 선수금누계, 선수금대체 항목의 금액이 0이 아닐경우 삭제불가
						if ( model1.getValue("/root/resData/resForm/rcpm_amt_end")  == "A" &&
						     model1.getValue("/root/resData/resForm/last_leas_clam_dt") == ""  &&   // 최종임대료청구일이 없는 경우 
						     model1.getValue("/root/resData/resForm/last_mang_clam_dt") == ""  &&   // 최종관리비청구일이 없는 경우 
						     model1.getValue("/root/resData/resForm/gurt_tot_amt")      == "0"  && 
						     model1.getValue("/root/resData/resForm/gurt_out_amt")     == "0" &&
						     model1.getValue("/root/resData/resForm/precpt_tot_amt")   == "0" && 
						     model1.getValue("/root/resData/resForm/precpt_out_amt")  == "0" 
						  ) {
							model1.setValue("/root/resData/resForm/ori_leas_cntr_dt",        "new" );
							model1.setValue("/root/resData/resForm/ori_leas_fr_dt",            "new" );
							model1.setValue("/root/resData/resForm/ori_leas_to_dt",           "new" );
							model1.setValue("/root/resData/resForm/ori_cntr_leas_amt",     "new" );
							model1.setValue("/root/resData/resForm/ori_cntr_mang_amt",   "new" );
							model1.setValue("/root/resData/resForm/ori_cntr_gurt_amt",      "new" );
							model1.setValue("/root/resData/resForm/ori_leas_clam_cycl",   "new" );
							model1.setValue("/root/resData/resForm/ori_mang_clam_cycl", "new" );
							model1.setValue("/root/resData/resForm/ori_good_clsf",           "new" );
							model1.setValue("/root/resData/resForm/ori_ser_no",               "new" );
							model1.setValue("/root/resData/resForm/ori_leas_area_size",   "new" );
							model1.setValue("/root/resData/resForm/ori_hire_dlco_clsf_cd","new" );  // 임차사구분코드
							model1.setValue("/root/resData/resForm/ori_hire_dlco_ern",      "new" );  // 임차사번호
							model1.setValue("/root/resData/resForm/ori_pymt_clsf",           "new" );  // 납입방법
							
					       } else {
							model1.setValue("/root/resData/resForm/ori_leas_cntr_dt",        model1.getValue("/root/resData/resForm/leas_cntr_dt") );
							model1.setValue("/root/resData/resForm/ori_leas_fr_dt",            model1.getValue("/root/resData/resForm/leas_fr_dt") );
							model1.setValue("/root/resData/resForm/ori_leas_to_dt",           model1.getValue("/root/resData/resForm/leas_to_dt") );
							model1.setValue("/root/resData/resForm/ori_cntr_leas_amt",     model1.getValue("/root/resData/resForm/cntr_leas_amt") );
							model1.setValue("/root/resData/resForm/ori_cntr_mang_amt",   model1.getValue("/root/resData/resForm/cntr_mang_amt") );
							model1.setValue("/root/resData/resForm/ori_cntr_gurt_amt",      model1.getValue("/root/resData/resForm/cntr_gurt_amt") );
							model1.setValue("/root/resData/resForm/ori_leas_clam_cycl",   model1.getValue("/root/resData/resForm/leas_clam_cycl") );
							model1.setValue("/root/resData/resForm/ori_mang_clam_cycl", model1.getValue("/root/resData/resForm/mang_clam_cycl") );
							model1.setValue("/root/resData/resForm/ori_good_clsf",           model1.getValue("/root/resData/resForm/good_clsf") );
							model1.setValue("/root/resData/resForm/ori_ser_no",               model1.getValue("/root/resData/resForm/ser_no") );
							model1.setValue("/root/resData/resForm/ori_leas_area_size",   model1.getValue("/root/resData/resForm/leas_area_size") );
							model1.setValue("/root/resData/resForm/ori_hire_dlco_clsf_cd",model1.getValue("/root/resData/resForm/hire_dlco_clsf_cd") );  // 임차사구분코드
							model1.setValue("/root/resData/resForm/ori_hire_dlco_ern",      model1.getValue("/root/resData/resForm/hire_dlco_ern") );  // 임차사번호					       
							model1.setValue("/root/resData/resForm/ori_pymt_clsf",           model1.getValue("/root/resData/resForm/pymt_clsf") );       // 납입방법
					       }	

						inp_area_size2.value = inp_area_size.value * 3.3058;	  // 면적2 (평방미터)
											       							
						//입금상태 값변환.
						if ( model1.getValue("/root/resData/resForm/rcpm_amt_end") == "A" ) {
							model1.setValue("/root/resData/resForm/rcpm_amt_end" , "A 입금중" );
							model1.refresh();
						}
						if ( model1.getValue("/root/resData/resForm/rcpm_amt_end") == "B" ) {
							model1.setValue("/root/resData/resForm/rcpm_amt_end" , "B 입금완료" );
							model1.refresh();
						}
						
						//계약상태 값변화.
						if ( model1.getValue("/root/resData/resForm/cntr_star") == "A" ) {
							model1.setValue("/root/resData/resForm/cntr_star" , "A 임대중" );
							model1.refresh();
						}
						if ( model1.getValue("/root/resData/resForm/cntr_star") == "B" ) {
							model1.setValue("/root/resData/resForm/cntr_star" , "B 임대완료" );
							model1.refresh();
						}
						
						//종료구분 값변환.
						if ( model1.getValue("/root/resData/resForm/end_clsf") == "A" ) {
							model1.setValue("/root/resData/resForm/end_clsf" , "A 만기종료" );
							model1.refresh();
						}
						if ( model1.getValue("/root/resData/resForm/end_clsf") == "B" ) {
							model1.setValue("/root/resData/resForm/end_clsf" , "B 중도해지" );
							model1.refresh();
						}
						
						//수정못하게 비활성화 시킴.
						//combo3.disabled = true;
						//input10.disabled = true;
						//input7.disabled = true;
						//input24.disabled = true;
						//input30.disabled = true;
						//input6.disabled = true;
						//input15.disabled = true;
						//input2.disabled = true;
						//input9.disabled = true;
						//input5.disabled = true;
						//input8.disabled = true;
						//combo1.disabled = true;
						//combo2.disabled = true;
						//input3.disabled = true;
						//input21.disabled = true;
						//input4.disabled = true;
						//output3.disabled = true;
						//input23.disabled = true;
					       
					       combo3.disabled = true;  //건물구분 비활성화
						input10.disabled = true;   //자산번호 비활성화
						input16.disabled = false;  //해지일자 활성화
						//input4.disabled =  false;  //이전계약번호 활성화.											
					}
					
					function open_fc_acct_1180(p_where,p_mode) {
						var need_popup = true;
						var rcvs_flag = false;
		
						//버튼클릭으로 이벤트가 발생하기 전에
						//value-changed 이벤트가 먼저 발생한 경우
						//input button의 내부 버튼이 클릭됐는지 여부를 확인한다.
						/*
						if (check_dup_input_event()) {					
							return rcvs_flag;
						}
						*/
						//검색조건이 모두 충족하지 않으면 종료한다.
						if (gstr_popupid == "dlco_cd") { 		// 거래처
							if (p_where == "FOCUS" && (hire_dlco_clsf_cd.value.Trim() == "" || hire_dlco_ern.value.Trim() == "")) {
								hire_dlco_nm.value	= "";
								return rcvs_flag;
							}
						}
						else if (gstr_popupid == "ern") { // 공급자번호
							if (p_where == "FOCUS" && (hire_dlco_ern.value.Trim() == "")) {
								return rcvs_flag;
							}				
						}
						
						p_where = p_where.toUpperCase();
						
						var popid = "fc_acct_1180";
						var subid = "fc_acct_1181_l";
		
						set_popup_send_data(popid		,"mode"			,p_mode			);
						set_popup_send_data(popid  ,"title"   ,""    );
		//				set_popup_send_data(popid  ,"readonly"  ,"1"    );
		
						if (gstr_popupid == "dlco_cd") { 		// 거래처
							set_popup_send_data(popid		,"clsf_cd"			,hire_dlco_clsf_cd.value	);
							set_popup_send_data(popid		,"cd_f"			,hire_dlco_ern.value		);
							set_popup_send_data(popid		,"cd_t"			,hire_dlco_ern.value		);
		//					set_popup_send_data(popid		,"cd_abrv_nm"		,dlco_cd.value		);
						}
						else if (gstr_popupid == "ern") { // 공급자번호
							//set_popup_send_data(popid		,"clsf_cd"			,"93"	); 120228
							set_popup_send_data(popid		,"clsf_cd"			,model.getValue("/root/initData/comboSet/xx_cd_010")	);
							set_popup_send_data(popid		,"cd_f"			,hire_dlco_ern.value		);
							set_popup_send_data(popid		,"cd_t"			,hire_dlco_ern.value		);
		//					set_popup_send_data(popid		,"cd_abrv_nm"		,ern.value		);
						}
						
		
		
						//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
						if (p_where == "FOCUS") {
							//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
							//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
							model.removenode(get_popup_rcvs_ref(popid));
							//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
							model.makeNode(get_popup_rcvs_ref(popid));
							
		//					alert(get_popup_send_ref(popid));
							
							//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
							send_submission(
									"auto_" + subid
								,	get_popup_send_ref(popid)
								,	get_popup_rcvs_ref(subid) + "/dataSet"
								,	"/fc/acct1000/1181"
								,	"urlencoded-post"
								,	"application/x-www-form-urlencoded"
							);
							
							totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
					
		//					alert(totalcnt);
					
							if (totalcnt == 1) {
								//데이터가 1건이고 focus out에서 호출한 경우
								//데이터를 설정하고 나간다.
		
		//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
								model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
		//						return;
								need_popup = false;
								 rcvs_flag = false;
							}
							else if (totalcnt == 0) {
		//						show_message("[거래처코드]의 검색결과가 없습니다.");
		//						return;
								need_popup = true;		
								 rcvs_flag = false;				
							}
							else {
								//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
								//만약 1건 이상인 경우 popup을 호출해 달라고 하면
								//return을 지우면 됨
								//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
								//return;
								need_popup = true;
							}
						}
						
						//그외 버튼인 경우는 계속 진행
						if (need_popup) {
							 rcvs_flag = open_popup(popid,"640");
						}
		
						//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
						//다시 조회 하기 쉽도록 하고
						if (gstr_popupid == "dlco_cd") { 		// 거래처
							if (get_popup_rcvs_data(popid,"clsf_cd") != "")			hire_dlco_clsf_cd.value		=	get_popup_rcvs_data(popid,"clsf_cd");
							if (get_popup_rcvs_data(popid,"cd") != "")				hire_dlco_ern.value			=	get_popup_rcvs_data(popid,"cd");
							//그외의 값은 지워지도록 한다.
							//if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
							hire_dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");

							//intg_dlco_cd.value		=	get_popup_rcvs_data(popid,"intg_cd");
						}
						else if (gstr_popupid == "ern") { // 공급자번호
		//					if (get_popup_rcvs_data(popid,"clsf_cd") != "")			recp_pers_clsf.value		=	get_popup_rcvs_data(popid,"clsf_cd");
							if (get_popup_rcvs_data(popid,"cd") != "")				hire_dlco_ern.value		=	get_popup_rcvs_data(popid,"cd");
							//그외의 값은 지워지도록 한다.
							hire_dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
							//if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
							//pay_bank_cd_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
						}
						return rcvs_flag;
					}					
				]]>
			</script>
			<submission id="as_leas_1101" action="/as/leas/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_leas_1102" action="/as/leas/1102" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_asrd_1600" action="/as/asrd/1600" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_leas_1103" action="/as/leas/1103" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData/dataSet"/>
			<submission id="as_leas_1104" action="/as/leas/1104" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_leas_1105" action="/as/leas/1105" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm/bldg_cd" resultref="/root/tempData/dataSet"/>
			<submission id="as_leas_1106" action="/as/leas/1106" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_leas_1107" action="/as/leas/1107" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/dataSet"/>
			<submission id="as_leas_1108" action="/as/leas/1108" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData/dataSet"/>
		</model>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" style="font-family:굴림; ">
		<group id="group_tab" class="gro_tab1" style="left:10px; top:349px; width:930px; height:326px; ">
			<caption id="caption22" class="list_cap02" style="left:290px; top:250px; width:635px; height:26px; text-align:center; "/>
			<caption id="caption18" class="list_cap02" style="left:85px; top:300px; width:840px; height:26px; "/>
			<caption id="caption17" class="list_cap02" style="left:80px; top:75px; width:845px; height:26px; "/>
			<caption id="caption12" class="list_cap02" style="left:285px; top:225px; width:640px; height:26px; text-align:center; "/>
			<caption id="caption96" class="list_cap02" style="left:45px; top:0px; width:880px; height:26px; "/>
			<caption id="caption51" class="list_cap02" style="left:80px; top:25px; width:845px; height:26px; text-align:center; "/>
			<caption id="caption74" class="list_cap02" style="left:70px; top:100px; width:855px; height:26px; "/>
			<caption id="caption72" class="list_cap02" style="left:80px; top:125px; width:845px; height:26px; "/>
			<caption id="caption68" class="list_cap02" style="left:85px; top:150px; width:840px; height:26px; "/>
			<caption id="caption63" class="list_cap02" style="left:230px; top:175px; width:695px; height:26px; "/>
			<caption id="caption85" class="list_cap02" style="left:80px; top:50px; width:845px; height:26px; "/>
			<caption id="caption20" class="list_cap02" style="left:90px; top:200px; width:835px; height:26px; text-align:center; "/>
			<caption id="caption31" class="list_cap03" style="left:215px; top:25px; width:106px; height:26px; text-align:center; ">임대기간</caption>
			<caption id="caption53" class="list_cap03" style="left:730px; top:50px; width:80px; height:26px; ">종료구분</caption>
			<caption id="caption7" class="list_cap03" style="left:0px; top:100px; width:100px; height:26px; ">(약정)임대료</caption>
			<caption id="caption11" class="list_cap03" style="left:0px; top:125px; width:100px; height:26px; ">(약정)관리비</caption>
			<caption id="caption13" class="list_cap03" style="left:0px; top:150px; width:100px; height:26px; ">(약정)보증금</caption>
			<caption id="caption19" class="list_cap03" style="left:0px; top:200px; width:106px; height:26px; text-align:center; ">임차사구분코드</caption>
			<input id="input2" ref="/root/resData/resForm/cntr_mang_amt" navindex="23" inputtype="input" format="#,###" appearance="input" style="left:103px; top:129px; width:100px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
/*					
					if (model1.getValue("/root/resData/resForm/cntr_mang_amt") != 0) {
						model1.setValue("/root/resData/resForm/mang_clam_cycl", "1");
						model1.refresh();
					}
					if (model1.getValue("/root/resData/resForm/cntr_mang_amt") == 0) {
						model1.setValue("/root/resData/resForm/mang_clam_cycl", "");
						model1.refresh();
					}
*/
			                      // (약정)임대료청구액이 존재 시 임대료청구주기 설정 체크처리
						if ( (model1.getValue("/root/resData/resForm/cntr_leas_amt") != 0) ||
						     (model1.getValue("/root/resData/resForm/cntr_leas_amt") != "") 
						) {
							if ( model1.getValue("/root/resData/resForm/leas_clam_cycl") == "" ) {
								model1.setValue("/root/resData/resForm/leas_clam_cycl", "1");
								model1.refresh();
							}
						} else {
								model1.setValue("/root/resData/resForm/leas_clam_cycl", "");		
								model1.refresh();													
					       }
			                      // (약정)임대료관리비 존재 시 관리비청구주기 설정 체크처리						
						if ( (model1.getValue("/root/resData/resForm/cntr_mang_amt") != 0) ||
						     (model1.getValue("/root/resData/resForm/cntr_mang_amt") != "") 
						  ) {
							if ( model1.getValue("/root/resData/resForm/mang_clam_cycl") == "" ) {							
								model1.setValue("/root/resData/resForm/mang_clam_cycl", "1");
								model1.refresh();
							}
						} else {
							model1.setValue("/root/resData/resForm/mang_clam_cycl", "");
							model1.refresh();																
						}					
					]]>
				</script>
			</input>
			<caption id="caption4" class="list_cap03" style="left:215px; top:225px; width:106px; height:26px; text-align:center; ">보증인등록번호</caption>
			<caption id="caption42" class="list_cap03" style="left:0px; top:300px; width:100px; height:26px; ">해지일자</caption>
			<caption id="caption48" class="list_cap03" style="left:730px; top:25px; width:80px; height:26px; ">계약상태</caption>
			<caption id="caption33" class="list_cap03" style="left:215px; top:75px; width:106px; height:26px; ">납입방법</caption>
			<output id="output2" ref="/root/resData/resForm/gurt_dlco_nm" inputtype="input" appearance="output" style="left:440px; top:229px; width:261px; height:18px; text-align:left; "/>
			<input id="input12" ref="/root/resData/resForm/gurt_dlco_ern" navindex="28" inputtype="button" caption="보증인등록번호" style="left:323px; top:229px; width:112px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					model1.setValue("/root/reqData/fwdData/func_nm","setDlco_no_fr");
					window.load("../../co/dlco/CO_DLCO_1100.xrw","modal","CO_DLCO_1100","align:center; width:660px; height:540px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
					]]>
				</script>
			</input>
			<caption id="caption67" class="list_cap03" style="left:215px; top:0px; width:106px; height:26px; text-align:center; ">자산번호</caption>
			<caption id="caption40" class="list_cap03" style="left:0px; top:75px; width:100px; height:26px; ">계약일자</caption>
			<caption id="caption52" class="list_cap03" style="left:0px; top:25px; width:100px; height:26px; text-align:center; ">계약번호</caption>
			<caption id="caption5" class="list_cap03" style="left:215px; top:50px; width:106px; height:26px; text-align:center; ">물건구분</caption>
			<input id="input10" ref="/root/resData/resForm/aset_no" class="req" navindex="11" inputtype="button" maxlength="11" caption="자산번호" style="left:323px; top:4px; width:100px; height:18px; background-color:#ffffcc; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					if ( model1.getValue("/root/reqData/fwdData/leas_bldg_cd") == "") {
						alert("건물구분을 먼저 선택 하십시오.");
						return;
					}					
					model1.setValue("/root/reqData/fwdData/func_nm",  "setAset_no");
					model1.setValue("/root/reqData/fwdData/leas_bldg_cd", model1.getValue("/root/resData/resForm/bldg_cd"));
					model1.setValue("/root/reqData/fwdData/aset_no", model1.getValue("/root/resData/resForm/aset_no"));
					model1.setValue("/root/reqData/fwdData/search_tag",  "LEAS");
					window.load("../asrd/AS_ASRD_1600.xrw","modal", "AS_ASRD_1600", "align:center; width:430px; height:380px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="onmaxlength">
					<![CDATA[
					//부동산자력-하단그리드조회.
					model1.setValue("/root/reqData/searchData/aset_no", model1.getValue("/root/resData/resForm/aset_no") );
					model1.send("as_leas_1104");
					model1.copyNode("/root/resData/gridData2", "/root/tempData/dataSet/CURLIST1");
					model1.removeNodeset("/root/tempData/dataSet");
					model1.refresh();
					
					//소재지,임대인등록번호 가져오기.
					model1.send("as_leas_1106");
					model1.setValue("/root/resData/resForm/aset_addr", model1.getValue("/root/tempData/dataSet/CURLIST1/record/aset_size") );
					model1.setValue("/root/resData/resForm/hire_dlco_ern", model1.getValue("/root/tempData/dataSet/CURLIST1/record/leas_ern_no") );
					model1.setValue("/root/resData/resForm/hire_dlco_nm", model1.getValue("/root/tempData/dataSet/CURLIST1/record/leas_ern_nm") );
					model1.removeNodeset("/root/tempData/dataSet");
					model1.refresh();
					
					]]>
				</script>
			</input>
			<input id="input11" ref="/root/resData/resForm/remk" navindex="20" inputtype="input" appearance="input" style="left:552px; top:79px; width:362px; height:18px; "/>
			<caption id="caption25" class="list_cap03" style="left:440px; top:75px; width:110px; height:26px; text-align:center; ">비고</caption>
			<caption id="caption29" class="list_cap03" style="left:215px; top:250px; width:106px; height:26px; text-align:center; ">사업장코드</caption>
			<input id="inp_area_size" ref="/root/resData/resForm/leas_area_size" navindex="17" inputtype="input" appearance="input" style="left:552px; top:55px; width:45px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
								inp_area_size2.value = inp_area_size.value * 3.3058;	
					]]>
				</script>
			</input>
			<caption id="caption32" style="left:494px; top:55px; width:30px; height:20px; ">호</caption>
			<caption id="caption34" style="left:599px; top:55px; width:30px; height:20px; ">평</caption>
			<input id="input7" ref="/root/resData/resForm/leas_fr_dt" class="req" navindex="12" inputtype="date" caption="임대기간-시작일자" style="left:323px; top:29px; width:85px; height:18px; background-color:#ffffcc; "/>
			<input id="input24" ref="/root/resData/resForm/leas_to_dt" class="req" navindex="13" inputtype="date" caption="임대기간-종료일자" style="left:429px; top:29px; width:85px; height:18px; background-color:#ffffcc; "/>
			<caption id="caption37" style="left:515px; top:30px; width:30px; height:20px; ">개월</caption>
			<input id="input15" ref="/root/resData/resForm/leas_cntr_dt" class="req" navindex="18" inputtype="date" caption="계약일자" style="left:103px; top:79px; width:100px; height:18px; background-color:#ffffcc; "/>
			<input id="input16" ref="/root/resData/resForm/midw_expy_dt" navindex="30" inputtype="date" style="left:103px; top:304px; width:100px; height:18px; background-color:#ffffff; ">
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
					if ( model1.getValue("/root/resData/resForm/midw_expy_dt") == "") {
						model1.setValue("/root/resData/resForm/expy_remk" , "");
						model1.refresh();
					}
					]]>
				</script>
			</input>
			<caption id="caption38" style="left:351px; top:104px; width:30px; height:20px; ">개월</caption>
			<caption id="caption39" style="left:351px; top:129px; width:30px; height:20px; ">개월</caption>
			<caption id="caption46" class="list_cap03" style="left:440px; top:100px; width:110px; height:26px; ">최종임대료청구일</caption>
			<caption id="caption47" class="list_cap03" style="left:440px; top:125px; width:110px; height:26px; ">최종관리비청구일</caption>
			<caption id="caption56" class="list_cap03" style="left:440px; top:175px; width:110px; height:26px; ">선수금대체</caption>
			<caption id="caption64" class="list_cap03" style="left:440px; top:150px; width:110px; height:26px; ">보증금대체</caption>
			<input id="input22" ref="/root/resData/resForm/expy_remk" navindex="31" inputtype="input" appearance="input" style="left:323px; top:304px; width:587px; height:18px; text-align:left; ">
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[
					/*
					if (model1.getValue("/root/resData/resForm/midw_expy_dt") == "") {
						alert("해지일자를 입력하신후 입력하십시오.");
						return;
					}
					*/
					]]>
				</script>
			</input>
			<caption id="caption69" class="list_cap03" style="left:730px; top:150px; width:80px; height:26px; ">보증금잔액</caption>
			<caption id="caption71" class="list_cap03" style="left:730px; top:175px; width:80px; height:26px; ">선수금잔액</caption>
			<caption id="caption73" class="list_cap03" style="left:215px; top:150px; width:106px; height:26px; ">보증금누계</caption>
			<caption id="caption75" class="list_cap03" style="left:215px; top:175px; width:106px; height:26px; ">선수금누계</caption>
			<caption id="caption59" class="list_cap03" style="left:215px; top:300px; width:106px; height:26px; ">해지비고</caption>
			<caption id="caption77" class="list_cap03" style="left:215px; top:200px; width:106px; height:26px; ">임차사번호</caption>
			<input id="hire_dlco_ern" ref="/root/resData/resForm/hire_dlco_ern" class="req" navindex="27" inputtype="button" caption="임차사번호" style="left:323px; top:204px; width:112px; height:18px; background-color:#ffffcc; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						//if(hire_dlco_clsf_cd.value == "96"){ 120228
						if(hire_dlco_clsf_cd.value == model.getValue("/root/initData/comboSet/xx_cd_020")){
							gstr_popupid = "dlco_cd";
						}else{
							gstr_popupid = "ern";
						}
						if(open_fc_acct_1180("button","s")==false)
						{
							hire_dlco_ern.value = "";
						};	
					//model1.setValue("/root/reqData/fwdData/func_nm","setDlco_no");
					//window.load("../../co/dlco/CO_DLCO_1100.xrw","modal","CO_DLCO_1100.xrw","align:center; width:660px; height:540px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						//if(hire_dlco_clsf_cd.value == "96"){ 120228
						if(hire_dlco_clsf_cd.value == model.getValue("/root/initData/comboSet/xx_cd_020")){
							gstr_popupid = "dlco_cd";
						}else{
							gstr_popupid = "ern";
						}
						if(open_fc_acct_1180("focus","s")==false)
						{
							hire_dlco_ern.value = "";
						};							
					]]>
				</script>
			</input>
			<output id="hire_dlco_nm" ref="/root/resData/resForm/hire_dlco_nm" inputtype="input" appearance="output" style="left:440px; top:204px; width:260px; height:18px; text-align:left; "/>
			<caption id="caption82" class="list_cap03" style="left:0px; top:50px; width:100px; height:26px; text-align:center; ">이전계약번호</caption>
			<caption id="caption84" class="list_cap03" visibility="hidden" style="left:549px; top:275px; width:106px; height:26px; text-align:center; ">소재지</caption>
			<select1 id="combo2" ref="/root/resData/resForm/good_clsf" navindex="15" appearance="minimal" style="left:323px; top:54px; width:80px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/good_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<caption id="caption93" class="tit02" style="left:0px; top:180px; width:100px; height:20px; ">임대차인 정보</caption>
			<caption id="caption95" class="list_cap03" style="left:730px; top:0px; width:80px; height:26px; text-align:center; ">입금상태</caption>
			<output id="output14" ref="/root/resData/resForm/rcpm_amt_end" inputtype="input" appearance="output" style="left:813px; top:4px; width:100px; height:18px; text-align:left; "/>
			<input id="input30" ref="/root/resData/resForm/draft_no" visibility="hidden" editable="false" inputtype="button" style="left:814px; top:79px; width:107px; height:18px; "/>
			<caption id="caption98" class="list_cap03" visibility="hidden" style="left:730px; top:75px; width:80px; height:26px; text-align:center; ">기안번호</caption>
			<caption id="caption1" style="left:409px; top:32px; width:20px; height:15px; text-align:center; ">~</caption>
			<input id="input6" ref="/root/resData/resForm/cntr_leas_amt" navindex="21" format="#,###" style="left:103px; top:104px; width:100px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
/*
					if (model1.getValue("/root/resData/resForm/cntr_leas_amt") != 0) {
						model1.setValue("/root/resData/resForm/leas_clam_cycl", "1");
						model1.refresh();
					}
					if (model1.getValue("/root/resData/resForm/cntr_leas_amt") == 0) {
						model1.setValue("/root/resData/resForm/leas_clam_cycl", "");
						model1.refresh();
					}
*/		
			                      // (약정)임대료청구액이 존재 시 임대료청구주기 설정 체크처리
						if ( (model1.getValue("/root/resData/resForm/cntr_leas_amt") != 0) ||
						     (model1.getValue("/root/resData/resForm/cntr_leas_amt") != "") 
						) {
							if ( model1.getValue("/root/resData/resForm/leas_clam_cycl") == "" ) {
								model1.setValue("/root/resData/resForm/leas_clam_cycl", "1");
								model1.refresh();
							}
						} else {
								model1.setValue("/root/resData/resForm/leas_clam_cycl", "");		
								model1.refresh();													
					       }
			                      // (약정)임대료관리비 존재 시 관리비청구주기 설정 체크처리						
						if ( (model1.getValue("/root/resData/resForm/cntr_mang_amt") != 0) ||
						     (model1.getValue("/root/resData/resForm/cntr_mang_amt") != "") 
						  ) {
							if ( model1.getValue("/root/resData/resForm/mang_clam_cycl") == "" ) {							
								model1.setValue("/root/resData/resForm/mang_clam_cycl", "1");
								model1.refresh();
							}
						} else {
							model1.setValue("/root/resData/resForm/mang_clam_cycl", "");
							model1.refresh();																
						}			
					]]>
				</script>
			</input>
			<output id="output4" ref="/root/resData/resForm/last_leas_clam_dt" format="yyyy-mm-dd" style="left:553px; top:104px; width:100px; height:18px; "/>
			<output id="output6" ref="/root/resData/resForm/gurt_tot_amt" format="#,###" style="left:324px; top:154px; width:100px; height:18px; text-align:right; "/>
			<output id="output9" ref="/root/resData/resForm/last_mang_clam_dt" format="yyyy-mm-dd" style="left:553px; top:129px; width:100px; height:18px; "/>
			<output id="output10" ref="/root/resData/resForm/precpt_tot_amt" format="#,###" style="left:324px; top:179px; width:100px; height:18px; text-align:right; "/>
			<output id="output13" ref="/root/resData/resForm/gurt_out_amt" format="#,###" style="left:553px; top:154px; width:100px; height:18px; text-align:right; "/>
			<output id="output15" ref="/root/resData/resForm/precpt_out_amt" format="#,###" style="left:553px; top:179px; width:100px; height:18px; text-align:right; "/>
			<output id="output16" ref="/root/resData/resForm/gurt_amt" format="#,###" style="left:813px; top:154px; width:100px; height:18px; text-align:right; "/>
			<output id="output17" ref="/root/resData/resForm/precpt_amt" format="#,###" style="left:813px; top:179px; width:100px; height:18px; text-align:right; "/>
			<output id="output19" ref="/root/resData/resForm/cntr_star" style="left:813px; top:29px; width:100px; height:18px; "/>
			<output id="output20" ref="/root/resData/resForm/end_clsf" style="left:813px; top:54px; width:100px; height:18px; "/>
			<select1 id="combo1" ref="/root/resData/resForm/pymt_clsf" class="req" navindex="19" appearance="minimal" caption="납입방법" style="left:323px; top:79px; width:100px; height:18px; background-color:#ffffcc; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/pymt_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<output id="output21" ref="/root/resData/resForm/cntr_no" style="left:103px; top:29px; width:97px; height:18px; "/>
			<caption id="caption10" class="list_cap03" style="left:0px; top:0px; width:100px; height:26px; text-align:center; ">건물구분</caption>
			<select1 id="combo3" ref="/root/resData/resForm/bldg_cd" class="req" navindex="10" appearance="minimal" caption="건물구분" style="left:103px; top:4px; width:100px; height:18px; background-color:#ffffcc; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/bldg_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					//건물에 연결된 자산이 1개일때만 자산번호,자산명을 가져온다.
					model1.send("as_leas_1105");
					model1.setValue("/root/resData/resForm/aset_no", model1.getValue("/root/tempData/dataSet/CURLIST/record/aset_no") );
					model1.setValue("/root/reqData/searchData/aset_no", model1.getValue("/root/tempData/dataSet/CURLIST/record/aset_no") ); 
					model1.setValue("/root/resData/resForm/aset_nm", model1.getValue("/root/tempData/dataSet/CURLIST/record/aset_nm") );
					model1.removeNodeset("/root/tempData/dataSet");
					model1.refresh();
					
					//건물구분값을 자산번호 팝업창으로 넘긴다.
					model1.setValue("/root/reqData/fwdData/leas_bldg_cd" , model1.getValue("/root/resData/resForm/bldg_cd") );
					model1.refresh();
					
					input10.dispatch("onmaxlength");
					]]>
				</script>
			</select1>
			<input id="input3" ref="/root/resData/resForm/ser_no" navindex="16" style="left:440px; top:54px; width:53px; height:18px; "/>
			<output id="output22" ref="/root/resData/resForm/aset_nm" style="left:428px; top:4px; width:217px; height:18px; "/>
			<input id="input5" ref="/root/resData/resForm/leas_clam_cycl" navindex="22" style="left:323px; top:104px; width:27px; height:18px; text-align:right; "/>
			<input id="input8" ref="/root/resData/resForm/mang_clam_cycl" navindex="24" style="left:323px; top:129px; width:27px; height:18px; text-align:right; "/>
			<input id="input9" ref="/root/resData/resForm/cntr_gurt_amt" navindex="25" format="#,###" style="left:103px; top:154px; width:100px; height:18px; text-align:right; "/>
			<output id="output7" ref="/root/resData/resForm/aset_addr" visibility="hidden" style="left:550px; top:305px; width:356px; height:18px; text-align:left; "/>
			<select1 id="hire_dlco_clsf_cd" ref="/root/resData/resForm/hire_dlco_clsf_cd" navindex="26" appearance="minimal" style="left:109px; top:204px; width:88px; height:18px; background-color:#ffffcc; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/hire_dlco_clsf_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<select1 id="leas_dlco_ern" ref="/root/resData/resForm/leas_dlco_ern" navindex="29" appearance="minimal" style="left:323px; top:255px; width:222px; height:18px; background-color:#ffffcc; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/ern_nm/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<output id="output3" ref="/root/resData/resForm/bldg_cd_nm" visibility="hidden" style="left:150px; top:54px; width:55px; height:18px; text-align:left; "/>
			<input id="input4" ref="/root/resData/resForm/ref_cntr_no" navindex="14" editable="false" style="left:103px; top:54px; width:97px; height:18px; "/>
			<caption id="caption14" class="list_cap03" style="left:730px; top:200px; width:80px; height:26px; text-align:center; ">지국코드</caption>
			<output id="input14" ref="/root/resData/resForm/bo_seq" appearance="output" style="left:869px; top:204px; width:33px; height:18px; text-align:center; "/>
			<output id="output5" ref="/root/resData/resForm/bo_cd" style="left:813px; top:204px; width:52px; height:18px; text-align:center; "/>
			<caption id="caption15" class="list_cap03" style="left:215px; top:125px; width:106px; height:26px; ">관리비청구주기</caption>
			<caption id="caption16" class="list_cap03" style="left:215px; top:100px; width:106px; height:26px; ">임대료청구주기</caption>
			<caption id="caption21" class="tit02" style="left:0px; top:282px; width:100px; height:20px; ">해지 정보</caption>
			<button id="button4" class="btn_grid04" style="left:552px; top:30px; width:88px; height:17px; ">
				<caption>기간연장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						var tmp_leas_fr_yr = parseInt(model1.getValue("/root/resData/resForm/leas_fr_dt").substring(0,4))+1
						var tmp_leas_to_yr = parseInt(model1.getValue("/root/resData/resForm/leas_to_dt").substring(0,4))+1
						var tmp_leas_fr_dt = tmp_leas_fr_yr+model1.getValue("/root/resData/resForm/leas_fr_dt").substring(4,8) ;	
						var tmp_leas_to_dt = tmp_leas_to_yr+model1.getValue("/root/resData/resForm/leas_to_dt").substring(4,8);	
						model1.setValue("/root/resData/resForm/leas_fr_dt", tmp_leas_fr_dt);
						model1.setValue("/root/resData/resForm/leas_to_dt", tmp_leas_to_dt);
						model1.refresh();						
										
					]]>
				</script>
			</button>
			<output id="inp_area_size2" navindex="17" inputtype="input" appearance="output" style="left:625px; top:55px; width:75px; height:18px; text-align:right; "/>
			<caption id="caption6" style="left:702px; top:55px; width:30px; height:20px; ">m²</caption>
			<caption id="caption23" style="left:750px; top:131px; width:140px; height:18px; border-style:none; ">부가세제외대상여부</caption>
			<bool id="vat_non_yn" checkvalue="Y,N" ref="/root/resData/resForm/vat_non_yn" style="left:730px; top:130px; width:20px; height:18px; border-style:none; "/>
			<caption id="caption2" style="left:749px; top:231px; width:90px; height:15px; ">외화계약여부</caption>
			<bool id="frex_rcpm_yn" checkvalue="Y,N" ref="/root/resData/resForm/frex_rcpm_yn" style="left:729px; top:226px; width:20px; height:25px; "/>
			<input id="email" ref="/root/resData/resForm/email" navindex="31" inputtype="input" appearance="input" style="left:659px; top:254px; width:181px; height:18px; text-align:left; "/>
			<caption id="caption26" class="list_cap03" style="left:549px; top:250px; width:106px; height:26px; ">E-MAIL</caption>
			<caption id="caption27" class="list_cap02" style="left:290px; top:275px; width:635px; height:26px; text-align:center; "/>
			<caption id="caption28" class="list_cap03" style="left:215px; top:275px; width:106px; height:26px; text-align:center; ">임차인연락처1</caption>
			<input id="input17" ref="/root/resData/resForm/leas_telno1" navindex="20" inputtype="input" showmask="false" appearance="input" style="left:323px; top:280px; width:110px; height:18px; "/>
			<input id="input18" ref="/root/resData/resForm/leas_telno2" navindex="20" inputtype="input" appearance="input" style="left:550px; top:280px; width:110px; height:18px; "/>
			<caption id="caption30" class="list_cap03" style="left:440px; top:275px; width:106px; height:26px; text-align:center; ">임차인연락처2</caption>
			<caption id="caption35" class="list_cap03" style="left:695px; top:275px; width:106px; height:26px; text-align:center; ">임차인연락처3</caption>
			<input id="input20" ref="/root/resData/resForm/leas_telno3" navindex="20" inputtype="input" appearance="input" style="left:805px; top:280px; width:110px; height:18px; "/>
			<caption id="caption36" class="list_cap03" style="left:730px; top:100px; width:80px; height:26px; ">미수금현황</caption>
			<output id="output1" ref="/root/resData/resForm/unrcpm_info" format="#,###" style="left:815px; top:105px; width:100px; height:18px; text-align:right; "/>
		</group>
		<group id="group_scr" class="gro_sel" style="left:10px; top:67px; width:927px; height:53px; ">
			<caption id="caption89" class="list_cap02" style="left:0px; top:25px; width:925px; height:26px; "/>
			<caption id="caption62" class="list_cap02" style="left:0px; top:0px; width:925px; height:26px; "/>
			<caption id="caption44" class="list_cap01" style="left:220px; top:0px; width:100px; height:26px; ">건물구분</caption>
			<caption id="caption65" class="list_cap01" style="left:0px; top:0px; width:80px; height:26px; ">계약상태</caption>
			<caption id="caption3" class="list_cap01" style="left:615px; top:0px; width:90px; height:26px; ">임대시작일</caption>
			<input id="input25" ref="/root/reqData/searchData/leas_to_dt_1" navindex="8" inputtype="date" style="left:711px; top:29px; width:91px; height:18px; "/>
			<caption id="caption61" class="list_cap01" style="left:615px; top:25px; width:90px; height:26px; ">임대종료일</caption>
			<input id="input19" ref="/root/reqData/searchData/leas_fr_dt_1" navindex="4" inputtype="date" style="left:711px; top:4px; width:91px; height:18px; "/>
			<input id="input26" ref="/root/reqData/searchData/leas_fr_dt_2" navindex="5" inputtype="date" style="left:825px; top:4px; width:92px; height:18px; "/>
			<input id="input27" ref="/root/reqData/searchData/leas_to_dt_2" navindex="9" inputtype="date" style="left:825px; top:29px; width:92px; height:18px; "/>
			<caption id="caption88" class="list_cap01" style="left:0px; top:25px; width:80px; height:26px; ">임차업체명</caption>
			<input id="input13" ref="/root/reqData/searchData/hire_dlco_ern" navindex="7" imemode="disabled" inputtype="button" style="left:323px; top:29px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					model1.setValue("/root/reqData/fwdData/func_nm","setDlco_no_srch");
					window.load("../../co/dlco/CO_DLCO_1100.xrw","modal","CO_DLCO_1100","align:center; width:660px; height:540px; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;","/root/reqData/fwdData","/root/reqData/fwdData");
					]]>
				</script>
			</input>
			<caption id="caption90" class="list_cap01" style="left:220px; top:25px; width:100px; height:26px; ">임차업체</caption>
			<input id="input28" ref="/root/reqData/searchData/hire_dlco_nm" navindex="6" imemode="hangul" inputtype="input" appearance="input" style="left:83px; top:29px; width:110px; height:18px; text-align:left; "/>
			<output id="output11" ref="/root/reqData/searchData/hire_dlco_ern_nm" inputtype="input" appearance="output" style="left:427px; top:29px; width:153px; height:18px; text-align:left; "/>
			<input id="input1" ref="/root/reqData/searchData/cntr_no" navindex="3" imemode="disabled" style="left:510px; top:4px; width:97px; height:18px; ">
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
					model1.setValue("/root/reqData/searchData/cntr_no", input1.currentText.toUpperCase());
					input1.refresh();
					]]>
				</script>
			</input>
			<caption id="caption97" class="list_cap01" style="left:427px; top:0px; width:80px; height:26px; ">계약번호</caption>
			<caption id="caption8" style="left:804px; top:7px; width:20px; height:15px; text-align:center; ">~</caption>
			<caption id="caption9" style="left:804px; top:32px; width:20px; height:15px; text-align:center; ">~</caption>
			<select1 id="radio1" ref="/root/reqData/searchData/cntr_star" class="req" navindex="1" appearance="full" cols="2" overflow="visible" caption="계약상태" style="left:83px; top:4px; width:125px; height:18px; background-color:#ffffcc; border-style:none; ">
				<choices>
					<!-- 120228
					<item>
						<label>임대중</label>
						<value>A</value>
					</item>
					<item>
						<label>임대완료</label>
						<value>B</value>
					</item>
					-->
					<itemset nodeset="/root/initData/comboSet/XX_CURLIST5/record">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</select1>
			<select1 id="combo4" ref="/root/reqData/searchData/bldg_cd" navindex="2" appearance="minimal" style="left:323px; top:4px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/bldg_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:120px; width:926px; height:5px; "/>
		<group id="group_tit" class="gro_tit2" style="left:10px; top:126px; width:926px; height:20px; ">
			<caption id="subtitle" class="tit02" style="left:0px; top:0px; width:170px; height:20px; ">계약내역조회</caption>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" caption="계약번호^건물구분^호수^사업자명^면적^임대시작일^임대종료일^계약상태^임대료^주기^관리비^주기^총계^보증금^보증금누계^보증금대체^보증금잔액^이전계약번호^^caption28^caption29^caption2^caption3^caption4^caption5^caption6^caption7^caption8^caption9^caption10^caption11^caption12^caption13^caption14^caption15^caption17^caption18^caption19^caption20^caption21^caption22^caption23^caption24^caption25^caption16^caption30^caption31^부가세제외여부^외화계약여부" colsep="^" colwidth="60, 64, 43, 131, 47, 67, 67, 67, 60, 33, 60, 33, 76, 77, 77, 77, 77, 82, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" explorerbar="sortshowmove" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:10px; top:145px; width:925px; height:185px; ">
			<col ref="cntr_no"/>
			<col ref="bldg_cd_nm" style="text-align:left; "/>
			<col ref="ser_no" style="text-align:left; "/>
			<col ref="dlco_nm" style="text-align:left; "/>
			<col ref="leas_area_size" style="text-align:right; "/>
			<col ref="leas_fr_dt" format="yyyy-mm-dd"/>
			<col ref="leas_to_dt" format="yyyy-mm-dd"/>
			<col ref="cntr_star"/>
			<col ref="cntr_leas_amt" format="#,###" style="text-align:right; "/>
			<col ref="leas_clam_cycl"/>
			<col ref="cntr_mang_amt" format="#,###" style="text-align:right; "/>
			<col ref="mang_clam_cycl"/>
			<col ref="tot_amt" format="#,###" style="text-align:right; "/>
			<col ref="cntr_gurt_amt" format="#,###" style="text-align:right; "/>
			<col ref="gurt_tot_amt" format="#,###" style="text-align:right; "/>
			<col ref="gurt_out_amt" format="#,###" style="text-align:right; "/>
			<col ref="gurt_amt" format="#,###" style="text-align:right; "/>
			<col ref="ref_cntr_no"/>
			<col ref="bldg_cd" visibility="hidden"/>
			<col ref="aset_no" visibility="hidden"/>
			<col ref="aset_nm" visibility="hidden"/>
			<col ref="draft_no" visibility="hidden"/>
			<col ref="rcpm_amt_end" visibility="hidden"/>
			<col ref="leas_cntr_dt" visibility="hidden"/>
			<col ref="last_leas_clam_dt" visibility="hidden"/>
			<col ref="midw_expy_dt" visibility="hidden"/>
			<col ref="last_mang_clam_dt" visibility="hidden"/>
			<col ref="precpt_tot_amt" visibility="hidden"/>
			<col ref="end_clsf" visibility="hidden"/>
			<col ref="precpt_out_amt" visibility="hidden"/>
			<col ref="precpt_amt" visibility="hidden"/>
			<col ref="pymt_clsf" visibility="hidden"/>
			<col ref="expy_remk" visibility="hidden"/>
			<col ref="good_clsf" visibility="hidden"/>
			<col ref="remk" visibility="hidden"/>
			<col ref="aset_addr" visibility="hidden"/>
			<col ref="gurt_dlco_ern" visibility="hidden"/>
			<col ref="gurt_dlco_nm" visibility="hidden"/>
			<col ref="ref_cntr_nm" visibility="hidden"/>
			<col ref="hire_dlco_clsf_cd" visibility="hidden"/>
			<col ref="hire_dlco_ern" visibility="hidden"/>
			<col ref="hire_dlco_nm" visibility="hidden"/>
			<col ref="cmpy_cd" visibility="hidden"/>
			<col ref="cntr_yy" visibility="hidden"/>
			<col ref="cntr_seq" visibility="hidden"/>
			<col ref="bo_cd" visibility="hidden"/>
			<col ref="bo_seq" visibility="hidden"/>
			<col ref="vat_non_yn" visibility="hidden"/>
			<col ref="frex_rcpm_yn" visibility="hidden"/>
			<col ref="email" visibility="hidden"/>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					if(datagrid1.row == 0) return;	

					getLeasDetailInfo();
				]]>
			</script>
			<script type="javascript" ev:event="onaftersort">
				<![CDATA[
					datagrid1.gridToInstance();
				]]>
			</script>
		</datagrid>
		<group id="group1" class="gro_tit2" style="left:10px; top:330px; width:926px; height:20px; ">
			<caption id="caption91" class="tit02" style="left:0px; top:0px; width:150px; height:20px; ">계약사항</caption>
		</group>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData2/record" caption="자산명^소재지^면적^취득일^caption1" colsep="^" colwidth="364, 288, 89, 74, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:109px; top:680px; width:825px; height:105px; ">
			<col ref="aset_nm" style="text-align:left; "/>
			<col ref="plcw" style="text-align:left; "/>
			<col ref="aset_qunt_cnt" style="text-align:right; "/>
			<col ref="acqr_dt" format="yyyy-mm-dd"/>
			<col ref="aset_no" visibility="hidden"/>
		</datagrid>
		<caption id="caption24" class="tit02" style="left:10px; top:680px; width:100px; height:20px; ">부동산 자력</caption>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:42px; width:926px; height:21px; ">
			<button id="btnA1" class="btn02" style="left:534px; top:0px; width:52px; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if (commReqCheck(group_tab)) {
						//자산번호 자릿수 체크.
						var aset_no = input10.value;
						if ( aset_no != "" ) {
							if ( aset_no.length < "11" ) {
								alert("자산번호를 정확히 입력하세요");
								return;
							}
						}
						//임대시작일자 자릿수 체크.
						var leas_fr_dt = input7.value;
						if ( leas_fr_dt != "" ) {
							if ( leas_fr_dt.length < "8" ) {
								alert("임대시작일자를 정확히 입력하세요");
								return;
							}
						}
						//임대종료일자 자릿수 체크.
						var leas_to_dt = input24.value;
						if ( leas_to_dt != "" ) {
							if ( leas_to_dt.length < "8" ) {
								alert("임대종료일자를 정확히 입력하세요");
								return;
							}
						}
						//계약일자 자릿수 체크.
						var leas_cntr_dt = input15.value;
						if ( leas_cntr_dt != "" ) {
							if ( leas_cntr_dt.length < "8" ) {
								alert("계약일자를 정확히 입력하세요");
								return;
							}
						}
						
						var var_leas_dlco_ern = leas_dlco_ern.value; 
						if (var_leas_dlco_ern == "") {
							alert("사업장코드는 반드시 입력해야 합니다.");
							return;						
						}else{
							if ( var_leas_dlco_ern.length != 2 ) {
								alert("사업장코드를 정확히 입력하세요");
								return;
							}							
						}						
/*
						//임대료 존재 시 임대관리주기를 1로 설정 함
						var cntr_leas_amt    = input6.value;
						var leas_clam_cycle= input5.value;
						if ( cntr_leas_amt != "" ) {
							if ( leas_cntr_dt.length < "8" ) {
								alert("임대료가 존재하여 임대청구주기를 1로 설정하였습니다.");
								return;
							}
						}
*/
/*
						if (model1.getValue("/root/resData/resForm/cntr_mang_amt") != 0) {
							model1.setValue("/root/resData/resForm/mang_clam_cycl", "1");
							model1.refresh();
						}
						if (model1.getValue("/root/resData/resForm/cntr_mang_amt") == 0) {
							model1.setValue("/root/resData/resForm/mang_clam_cycl", "");
							model1.refresh();
						}
*/
			                      // (약정)임대료청구액이 존재 시 임대료청구주기 설정 체크처리
						if ( (model1.getValue("/root/resData/resForm/cntr_leas_amt") != 0) ||
						     (model1.getValue("/root/resData/resForm/cntr_leas_amt") != "") 
						) {
							if ( model1.getValue("/root/resData/resForm/leas_clam_cycl") == "" ) {
								model1.setValue("/root/resData/resForm/leas_clam_cycl", "1");
								model1.refresh();
							} 
						} else {
								model1.setValue("/root/resData/resForm/leas_clam_cycl", "");		
								model1.refresh();
					       }
			                      // (약정)임대료관리비 존재 시 관리비청구주기 설정 체크처리						
						if ( (model1.getValue("/root/resData/resForm/cntr_mang_amt") != 0) ||
						     (model1.getValue("/root/resData/resForm/cntr_mang_amt") != "") 
						  ) {
							if ( model1.getValue("/root/resData/resForm/mang_clam_cycl") == "" ) {							
								model1.setValue("/root/resData/resForm/mang_clam_cycl", "1");
								model1.refresh();
							}
						} else {
							model1.setValue("/root/resData/resForm/mang_clam_cycl", "");
							model1.refresh();																
						}
																							
						if (window.alert("입력하시겠습니까?", "확인", 1) == 1) {
							model1.setValue("/root/resData/resForm/mode", "I"); 
							model1.send("as_leas_1103");
								
							if(submit_completed()) { //서브밋 성공시
								button3.dispatch("onclick");
								model1.resetInstanceNode("/root/resData/resForm");
								model1.refresh();
							}

						
							for (i = 1; i < datagrid1.rows; i++) {
	
								if ( datagrid1.valueMatrix(i, 25) == "" && datagrid1.valueMatrix(i, 27) == ""   ) {
									datagrid1.cellstyle("background-color", i, 1) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 2) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 3) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 4) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 5) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 6) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 7) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 8) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 9) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 10) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 11) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 12) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 13) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 14) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 15) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 16) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 17) = "#FFFFCC";
									datagrid1.cellstyle("background-color", i, 18) = "#FFFFCC";
							      }							
							}		
						      										
	    				       }
					}
					]]>
				</script>
			</button>
			<button id="btnA2" class="btn02" style="left:589px; top:0px; width:52px; height:21px; ">
				<caption>수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[

					//alert(model1.getValue("/root/resData/resForm/vat_non_yn"));
					//alert(model1.getValue("/root/resData/resForm/frex_rcpm_yn"));
/*
					alert(model1.getValue("/root/resData/resForm/ori_pymt_clsf"));
					
					if((model1.getValue("/root/resData/resForm/vat_non_yn") == "") || (model1.getValue("/root/resData/resForm/vat_non_yn") == "N"){
						model1.setValue("/root/resData/resForm/vat_non_yn","N");
					}else{
						model1.setValue("/root/resData/resForm/vat_non_yn","Y");
					}
*/					
					if (model1.getValue("/root/resData/resForm/bldg_cd") == "" ) {
						alert("수정할 항목이 없습니다.\n'조회'를 하신 후 수정할 항목을 선택하십시오.");
						return;
					}
					
					
					var var_leas_dlco_ern = leas_dlco_ern.value; 
					if (var_leas_dlco_ern == "") {
						alert("사업장코드는 반드시 입력해야 합니다.");
						return;						
					}else{
						if ( var_leas_dlco_ern.length != 2 ) {
							alert("사업장코드를 정확히 입력하세요");
							return;
						}							
					}	

					var selectedRow = datagrid1.row;
/*
					if (model1.getValue("/root/resData/resForm/gurt_dlco_ern") == "" ) {
						alert("보증인등록번호 : 필수 입력사항이 누락되었습니다.");
						return;
					}
*/					
					//자산번호 자릿수 체크.
					var aset_no = input10.value;
					if ( aset_no != "" ) {
						if ( aset_no.length < "11" ) {
							alert("자산번호를 정확히 입력하세요");
							return;
						}
					}
					//임대시작일자 자릿수 체크.
					var leas_fr_dt = input7.value;
					if ( leas_fr_dt != "" ) {
						if ( leas_fr_dt.length < "8" ) {
							alert("임대시작일자를 정확히 입력하세요");
							return;
						}
					}
					//임대종료일자 자릿수 체크.
					var leas_to_dt = input24.value;
					if ( leas_to_dt != "" ) {
						if ( leas_to_dt.length < "8" ) {
							alert("임대종료일자를 정확히 입력하세요");
							return;
						}
					}
					//계약일자 자릿수 체크.
					var leas_cntr_dt = input15.value;
					if ( leas_cntr_dt != "" ) {
						if ( leas_cntr_dt.length < "8" ) {
							alert("계약일자를 정확히 입력하세요");
							return;
						}
					}
					//해지일자 자릿수 체크.
					var midw_expy_dt = input16.value;
					if ( midw_expy_dt != "" ) {
						if ( midw_expy_dt.length < "8" ) {
							alert("해지일자를 정확히 입력하세요");
							return;
						}
						//해지일자와 계약기간 비교하여 종료구분 업데이트 처리.
						if ( model1.getValue("/root/resData/resForm/expy_remk") == "" ) {
							alert("해지비고를 입력하세요");
							return;							
						}	

						//해지일자를 계약기간(종료일) 이후 입력 시 체크
						if ( model1.getValue("/root/resData/resForm/ori_leas_to_dt") < midw_expy_dt ) {
							alert("해지일자는 계약기간(종료일) 이후로 입력 할 수 없습니다.");
							return;							
						}												
					}

		                      // 보증금 또는 임대료 발생 시 계약사항수정불가 체크			                      
                      			if ( 
                      			     model1.getValue("/root/resData/resForm/cntr_star")                == "B"  || 
                      			     model1.getValue("/root/resData/resForm/end_clsf")                 != ""  || 
                      			     model1.getValue("/root/resData/resForm/last_leas_clam_dt")    != ""  || 
                      			     model1.getValue("/root/resData/resForm/last_mang_clam_dt")  != ""  || 
                      			     //model1.getValue("/root/resData/resForm/gurt_tot_amt")            != "0"  || 
					     model1.getValue("/root/resData/resForm/gurt_out_amt")           != "0"  ||
					     model1.getValue("/root/resData/resForm/precpt_tot_amt")        != "0"  ||
					     model1.getValue("/root/resData/resForm/precpt_out_amt")       != "0" 
					   ) 
					{
						// 계약일자 변경 체크
						if ( model1.getValue("/root/resData/resForm/ori_leas_cntr_dt") != "new" && 
						   (model1.getValue("/root/resData/resForm/ori_leas_cntr_dt") !=  model1.getValue("/root/resData/resForm/leas_cntr_dt") )) {
							alert("청구 또는 입/출금이 발생된 계약서는 계약일자는 변경 할 수 없습니다.");
							return;
						}							
					        
						// 임대기간(시작일) 변경 체크
						if ( model1.getValue("/root/resData/resForm/ori_leas_fr_dt") != "new" && 
						   (model1.getValue("/root/resData/resForm/ori_leas_fr_dt") !=  model1.getValue("/root/resData/resForm/leas_fr_dt") )) {
							alert("청구 또는 입/출금이 발생된 계약서는 임대기간(시작일)을 수정 할 수 없습니다.");
							return;
						}							

						// 임대기간(종료일) 변경 체크
						if ( model1.getValue("/root/resData/resForm/ori_leas_to_dt") != "new" && 
						   (model1.getValue("/root/resData/resForm/ori_leas_to_dt") !=  model1.getValue("/root/resData/resForm/leas_to_dt") )) {
							alert("청구 또는 입/출금이 발생된 계약서는 임대기간(종료일)을 수정 할 수 없습니다.");
							return;
						}							
/*
						// 약정임대료 변경 체크
						if ( model1.getValue("/root/resData/resForm/ori_cntr_leas_amt") != "new" && 
						   (model1.getValue("/root/resData/resForm/ori_cntr_leas_amt") !=  model1.getValue("/root/resData/resForm/cntr_leas_amt") )) {
							alert("청구 또는 입/출금이 발생된 계약서는 약정임대료를 수정 할 수 없습니다.");
							return;
						}	
						// 약정관리비 변경 체크
						if ( model1.getValue("/root/resData/resForm/ori_cntr_mang_amt") != "new" && 
						   (model1.getValue("/root/resData/resForm/ori_cntr_mang_amt") !=  model1.getValue("/root/resData/resForm/cntr_mang_amt") )) {
							alert("청구 또는 입/출금이 발생된 계약서는 약정관리비를 수정 할 수 없습니다.");
							return;
						}

						// 약정보증금 변경 체크
						if ( model1.getValue("/root/resData/resForm/ori_cntr_gurt_amt") != "new" && 
						   (model1.getValue("/root/resData/resForm/ori_cntr_gurt_amt") !=  model1.getValue("/root/resData/resForm/cntr_gurt_amt") )) {
							alert("청구 또는 입/출금이 발생된 계약서는 약정보증금을 수정 할 수 없습니다.");
							return;
						}						
*/						
						// 임대료청구주기 변경 체크
						if ( model1.getValue("/root/resData/resForm/ori_leas_clam_cycl") != "new" && 
						   (model1.getValue("/root/resData/resForm/ori_leas_clam_cycl") !=  model1.getValue("/root/resData/resForm/leas_clam_cycl") )) {
							alert("청구 또는 입/출금이 발생된 계약서는 임대료청구주기를 수정 할 수 없습니다.");
							return;
						}	
						// 관리비청구주기 변경 체크
						if ( model1.getValue("/root/resData/resForm/ori_mang_clam_cycl") != "new" && 
						   (model1.getValue("/root/resData/resForm/ori_mang_clam_cycl") !=  model1.getValue("/root/resData/resForm/mang_clam_cycl") )) {
							alert("청구 또는 입/출금이 발생된 계약서는 관리비청구주기를 수정 할 수 없습니다.");
							return;
						}	
						// 물건구분 변경 체크
						if ( model1.getValue("/root/resData/resForm/ori_good_clsf") != "new" && 
						   (model1.getValue("/root/resData/resForm/ori_good_clsf") !=  model1.getValue("/root/resData/resForm/good_clsf") )) {
							alert("청구 또는 입/출금이 발생된 계약서는 물건구분을 수정 할 수 없습니다.");
							return;
						}	
						// 호수 변경 체크
						if ( model1.getValue("/root/resData/resForm/ori_ser_no") != "new" && 
						   (model1.getValue("/root/resData/resForm/ori_ser_no") !=  model1.getValue("/root/resData/resForm/ser_no") )) {
							alert("청구 또는 입/출금이 발생된 계약서는 호수를 수정 할 수 없습니다.");
							return;
						}	
						// 면적 변경 체크
						if ( model1.getValue("/root/resData/resForm/ori_leas_area_size") != "new" && 
						   (model1.getValue("/root/resData/resForm/ori_leas_area_size") !=  model1.getValue("/root/resData/resForm/leas_area_size") )) {
							alert("청구 또는 입/출금이 발생된 계약서는 면적을 수정 할 수 없습니다.");
							return;
						}	
						// 임차사구분코드 변경 체크
						if ( model1.getValue("/root/resData/resForm/ori_hire_dlco_clsf_cd") != "new" && 
						   (model1.getValue("/root/resData/resForm/ori_hire_dlco_clsf_cd") !=  model1.getValue("/root/resData/resForm/hire_dlco_clsf_cd") )) {
							alert("청구 또는 입/출금이 발생된 계약서는 임차사구분코드를 수정 할 수 없습니다.");
							return;
						}		
						// 임차사번호 변경 체크
						if ( model1.getValue("/root/resData/resForm/ori_hire_dlco_ern") != "new" && 
						   (model1.getValue("/root/resData/resForm/ori_hire_dlco_ern") !=  model1.getValue("/root/resData/resForm/hire_dlco_ern") )) {
							alert("청구 또는 입/출금이 발생된 계약서는 임차사번호를 수정 할 수 없습니다.");
							return;
						}												
						// 납입방법 변경 체크
						if ( model1.getValue("/root/resData/resForm/ori_pymt_clsf") != "new" && 
						   (model1.getValue("/root/resData/resForm/ori_pymt_clsf") !=  model1.getValue("/root/resData/resForm/pymt_clsf") )) {
							alert("청구 또는 입/출금이 발생된 계약서는 납입방법을 수정 할 수 없습니다.");
							return;
						}												
				        }
								
					if (window.alert("수정하시겠습니까?", "확인", 1) == 1) {
			                      // (약정)임대료청구액이 존재 시 임대료청구주기 설정 체크처리
						if ( (model1.getValue("/root/resData/resForm/cntr_leas_amt") != 0) ||
						     (model1.getValue("/root/resData/resForm/cntr_leas_amt") != "") 
						) {
							if ( model1.getValue("/root/resData/resForm/leas_clam_cycl") == "" ) {
								model1.setValue("/root/resData/resForm/leas_clam_cycl", "1");
								model1.refresh();
							}
						} else {
								model1.setValue("/root/resData/resForm/leas_clam_cycl", "");		
								model1.refresh();													
					       }
			                      // (약정)임대료관리비 존재 시 관리비청구주기 설정 체크처리						
						if ( (model1.getValue("/root/resData/resForm/cntr_mang_amt") != 0) ||
						     (model1.getValue("/root/resData/resForm/cntr_mang_amt") != "") 
						  ) {
							if ( model1.getValue("/root/resData/resForm/mang_clam_cycl") == "" ) {							
								model1.setValue("/root/resData/resForm/mang_clam_cycl", "1");
								model1.refresh();
							}
						} else {
							model1.setValue("/root/resData/resForm/mang_clam_cycl", "");
							model1.refresh();																
						}
/*						
						if (model1.getValue("/root/resData/resForm/cntr_mang_amt") == 0) {
							model1.setValue("/root/resData/resForm/mang_clam_cycl", "");
							model1.refresh();
						}
*/										
						
						//해지일자와 계약기간 비교하여 종료구분 업데이트 처리.
						/*
						if ( model1.getValue("/root/resData/resForm/midw_expy_dt") != "" ) {
							if ( model1.getValue("/root/resData/resForm/midw_expy_dt")  <  model1.getValue("/root/resData/resForm/leas_to_dt") ) {  //해지일자가 계약일자(to)보다 작을경우.
								model1.setValue("/root/resData/resForm/end_clsf" , "B");   //종료구분을 B(중도해지)로 업데이트.
							}
							if ( model1.getValue("/root/resData/resForm/midw_expy_dt")  >=  model1.getValue("/root/resData/resForm/leas_to_dt") ) {  //해지일자가 계약일자(to)보다 같거나 클경우.
								model1.setValue("/root/resData/resForm/end_clsf" , "A");  //종료구분을 A(만기종료)로 업데이트.
							}
							
							//alert(model1.getValue("/root/resData/resForm/rcpm_amt_end").substring(0, 1));
							if ( model1.getValue("/root/resData/resForm/rcpm_amt_end").substring(0, 1)  == "B" ) {  //해지일자가 계약일자(to)보다 같거나 클경우.
								model1.setValue("/root/resData/resForm/cntr_star" , "B");  //계약상태를 B(임대종료)로 업데이트.
							}
						}
						*/
						//model1.makeNode("/root/resData/resForm/mode");
		 				model1.setValue("/root/resData/resForm/mode", "U");
						model1.send("as_leas_1103");
						
						if(submit_completed()) { //성공
							button3.dispatch("onclick");
							//model1.setValue("/root/reqData/searchData/bldg_cd" , "" );
							//model1.setValue("/root/reqData/searchData/cntr_yy" , "" );
							//model1.setValue("/root/reqData/searchData/cntr_seq" , "" );
							model1.resetInstanceNode("/root/resData/resForm");
							model1.resetInstanceNode("/root/resData/gridData2/record");
							model1.refresh();
							
							datagrid1.select(selectedRow, 1, selectedRow, 18) = true;
							datagrid1.row = selectedRow;
							getLeasDetailInfo();
						}
					}
				
					]]>
				</script>
			</button>
			<button id="btnA3" class="btn02" style="left:644px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if (model1.getValue("/root/resData/resForm/bldg_cd") == "") {
						alert("삭제할 항목이 없습니다.\n'조회'를 하신 후 삭제할 항목을 선택하십시오.");
						return;
					}
					
					//최종임대료청구일, 최종관리비청구일이 존재 할 경우 삭제불가
					if ( model1.getValue("/root/resData/resForm/last_leas_clam_dt") != "" || model1.getValue("/root/resData/resForm/last_mang_clam_dt") != "" ) {
						alert("임대료를 청구한 계약서는 삭제 할 수 없습니다.");
						return;
					}
					
					//보증금누계, 보증금대체, 선수금누계, 선수금대체 항목의 금액이 0이 아닐경우 삭제불가
					if ( model1.getValue("/root/resData/resForm/gurt_tot_amt") != "0"  || model1.getValue("/root/resData/resForm/gurt_out_amt") != "0" ||
					  model1.getValue("/root/resData/resForm/precpt_tot_amt") != "0" || model1.getValue("/root/resData/resForm/precpt_out_amt") != "0" ) {
						alert("입/출금이 발생된 계약서는 삭제 할 수 없습니다.");
						return;
					}
					
					if (window.alert("삭제하시겠습니까?", "삭제", 1) == 1) {
						model1.setValue("/root/resData/resForm/mode", "D");
						model1.send("as_leas_1103");
					
						if (submit_completed()){	
							button3.dispatch("onclick");
							model1.resetInstanceNode("/root/resData/resForm");
							model1.refresh();
						}	
					}
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:874px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					]]>
				</script>
			</button>
			<button id="btnA5" class="btn04" style="left:444px; top:0px; width:89px; height:21px; ">
				<caption>만기대상조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model1.reset();
					
					var now = new Date();
					//오늘날짜 구하기 -> today
					var year = now.getYear();
					var month = now.getMonth()+1;
					var date = now.getDate();
					if(month < 10)
						month = "0" + month;
					if(date < 10)
						date = "0" + date;
					var today = year + "" + month + "" + date; //오늘날짜
                                     
                                     //오늘날짜에서 +한달 구하기.
                                     var addMon = addMonth(year, month, date, 1);
                                     year = addMon.getYear();
					month = addMon.getMonth()+1;
					date = addMon.getDate();
					if(month < 10)
						month = "0" + month;
					if(date < 10)
						date = "0" + date;
						
					var mtry_month = year + "" + month + "" + date; //오늘날짜 +한달
                                     
                                     //오늘날짜에서 +한달+10일 구하기.
                                     var addDate = addDay(year, month, date, 10);
					year = addDate.getYear();
					month = addDate.getMonth()+1;
					date = addDate.getDate();
					if(month < 10)
						month = "0" + month;
					if(date < 10)
						date = "0" + date;
						
					var mtry_date = year + "" + month + "" + date; //오늘날짜 +한달+10일
                                     
                                     model1.setValue("/root/reqData/searchData/leas_to_dt_1" , today);
                                     model1.setValue("/root/reqData/searchData/leas_to_dt_2" , mtry_date);
                                     model1.refresh();
                                     button3.dispatch("onclick"); //조회버튼실행.
					
					]]>
				</script>
			</button>
			<button id="button2" class="btn02" style="left:819px; top:0px; width:52px; height:21px; ">
				<caption>재계약</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
					if (model1.getValue("/root/resData/resForm/bldg_cd") == "" ) {
						alert("재계약 할 항목이 없습니다.\n'조회'를 하신 후 재계약 할 항목을 선택하십시오.");
						return;
					}
					
					var selectedRow = datagrid1.row;
				
					//자산번호 자릿수 체크.
					var aset_no = input10.value;
					if ( aset_no != "" ) {
						if ( aset_no.length < "11" ) {
							alert("자산번호를 정확히 입력하세요");
							return;
						}
					}
					//임대시작일자 자릿수 체크.
					var leas_fr_dt = input7.value;
					if ( leas_fr_dt != "" ) {
						if ( leas_fr_dt.length < "8" ) {
							alert("임대시작일자를 정확히 입력하세요");
							return;
						}
					}
					//임대종료일자 자릿수 체크.
					var leas_to_dt = input24.value;
					if ( leas_to_dt != "" ) {
						if ( leas_to_dt.length < "8" ) {
							alert("임대종료일자를 정확히 입력하세요");
							return;
						}
					}
					//계약일자 자릿수 체크.
					var leas_cntr_dt = input15.value;
					if ( leas_cntr_dt != "" ) {
						if ( leas_cntr_dt.length < "8" ) {
							alert("계약일자를 정확히 입력하세요");
							return;
						}
					}
					//해지일자 자릿수 체크.
					var midw_expy_dt = input16.value;
					if ( midw_expy_dt != "" ) {
						if ( midw_expy_dt.length < "8" ) {
							alert("해지일자를 정확히 입력하세요");
							return;
						}
						//해지일자와 계약기간 비교하여 종료구분 업데이트 처리.
						if ( model1.getValue("/root/resData/resForm/expy_remk") == "" ) {
							alert("해지비고를 입력하세요");
							return;							
						}						
					}
					
					// 계약일자 변경 체크
					if ( model1.getValue("/root/resData/resForm/ori_leas_cntr_dt") != "new" && 
					   (model1.getValue("/root/resData/resForm/ori_leas_cntr_dt") ==  model1.getValue("/root/resData/resForm/leas_cntr_dt") )) {
						if (window.alert("계약일자가  변경되지 않았습니다. \n(계속 진행 하시겠습니까?)", "확인", 1) != 1) {
	   					   return;
						}						
					}

				        
					// 임대기간(시작일) 변경 체크

					if ( model1.getValue("/root/resData/resForm/ori_leas_fr_dt") ==  model1.getValue("/root/resData/resForm/leas_fr_dt") ) {
						if (window.alert("임대기간(시작일)이 변경되지 않았습니다. \n(계속 진행 하시겠습니까?)", "확인", 1) != 1) {
	   					   return;
						}
					}							

					// 임대기간(종료일) 변경 체크
					if ( model1.getValue("/root/resData/resForm/ori_leas_to_dt") ==  model1.getValue("/root/resData/resForm/leas_to_dt") ) {
						if (window.alert("임대기간(종료일)이 변경되지 않았습니다. \n(계속 진행 하시겠습니까?)", "확인", 1) != 1) {
	   					   return;
						}						
					}							

					// 임차사번호 변경 체크
					if ( model1.getValue("/root/resData/resForm/ori_hire_dlco_ern") != "new" && 
					   (model1.getValue("/root/resData/resForm/ori_hire_dlco_ern") !=  model1.getValue("/root/resData/resForm/hire_dlco_ern") )) {
						alert("재계약시 임차사번호를 수정 할 수 없습니다.");
						return;
					}

					var var_leas_dlco_ern = leas_dlco_ern.value; 
					if (var_leas_dlco_ern == "") {
						alert("사업장코드는 반드시 입력해야 합니다.");
						return;						
					}else{
						if ( var_leas_dlco_ern.length != 2 ) {
							alert("사업장코드를 정확히 입력하세요");
							return;
						}							
					}
			        					
					if (commReqCheck(group_tab)) {
						
						if (window.alert("재계약 입력하시겠습니까? \n(신규 계약서로 보증금잔액은 자동으로 이동 됩니다.)", "확인", 1) == 1) {
							model1.setValue("/root/resData/resForm/ref_cntr_no" , model1.getValue("/root/resData/resForm/cntr_no") );
							//input4.disabled = true;  //비활성화.
							model1.send("as_leas_1108");
						
								
							if(submit_completed()) { //서브밋 성공시
								//var bldg_cd = model1.getValue("/root/resData/resForm/bldg_cd");
								//var cntr_yy = model1.getValue("/root/resData/resForm/cntr_yy");
								//var cntr_seq = model1.getValue("/root/resData/resForm/cntr_seq");
								//var cntr_star = model1.getValue("/root/resData/resForm/cntr_star");
								var cntr_star = model1.getValue("/root/reqData/searchData/cntr_star");
								var bldg_cd = model1.getValue("/root/reqData/searchData/bldg_cd");
								var cntr_no = model1.getValue("/root/reqData/searchData/cntr_no");
								var leas_fr_dt_1 = model1.getValue("/root/reqData/searchData/leas_fr_dt_1");
								var leas_fr_dt_2 = model1.getValue("/root/reqData/searchData/leas_fr_dt_2");
								var leas_to_dt_1 = model1.getValue("/root/reqData/searchData/leas_to_dt_1");
								var leas_to_dt_2 = model1.getValue("/root/reqData/searchData/leas_to_dt_2");
								var hire_dlco_nm = model1.getValue("/root/reqData/searchData/hire_dlco_nm");
								var hire_dlco_ern = model1.getValue("/root/reqData/searchData/hire_dlco_ern");
								var hire_dlco_ern_nm = model1.getValue("/root/reqData/searchData/hire_dlco_ern_nm");

								model1.reset();

								model1.setValue("/root/reqData/searchData/cntr_star" ,  cntr_star);
								model1.setValue("/root/reqData/searchData/bldg_cd" , bldg_cd );
								model1.setValue("/root/reqData/searchData/cntr_no" ,  cntr_no);
								model1.setValue("/root/reqData/searchData/leas_fr_dt_1" ,  leas_fr_dt_1);
								model1.setValue("/root/reqData/searchData/leas_fr_dt_2" ,  leas_fr_dt_2);
								model1.setValue("/root/reqData/searchData/leas_to_dt_1" ,  leas_to_dt_1);
								model1.setValue("/root/reqData/searchData/leas_to_dt_2" ,  leas_to_dt_2);
								model1.setValue("/root/reqData/searchData/hire_dlco_nm" ,  hire_dlco_nm);
								model1.setValue("/root/reqData/searchData/hire_dlco_ern" ,  hire_dlco_ern);
								model1.setValue("/root/reqData/searchData/hire_dlco_ern_nm" ,  hire_dlco_ern_nm);
								
								button3.dispatch("onclick");
							}
	    				}
					}
					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" style="left:765px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model1.reset();
					//combo3.disabled = false;
					//input10.disabled = false;
					//input7.disabled = false;
					//input24.disabled = false;
					//input30.disabled = false;
					//input6.disabled = false;
					//input15.disabled = false;
					//input2.disabled = false;
					//input9.disabled = false;
					//input5.disabled = false;
					//input8.disabled = false;
					//combo1.disabled = false;
					//combo2.disabled = false;
					//input3.disabled = false;
					//input21.disabled = false;
					//input4.disabled = false;
					//output3.disabled = false;
					//input23.disabled = false;
					
				       combo3.disabled = false;  //건물구분 활성화
					input10.disabled = false;   //자산번호 활성화					
					input16.disabled = true; //해지일자 비활성화.
					//input4.disabled = true;  //이전계약번호 비활성화.

					]]>
				</script>
			</button>
			<button id="button3" class="btn02" style="left:390px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if (commReqCheck(group_scr)) {
						model1.send("as_leas_1102");
						model1.copyNode("/root/resData/gridData", "/root/tempData/dataSet/CURLIST");
						model1.removeNodeset("/root/tempData/dataSet");
						model1.refresh();
						
						for (i = 1; i < datagrid1.rows; i++) {
                                                    
                                                 //   alert( datagrid1.valueMatrix(i, 4) );
                                                 //   alert( datagrid1.valueMatrix(i, 15) );
                                                //    alert( datagrid1.valueMatrix(i, 25) );

                  
							if ( datagrid1.valueMatrix(i, 25) == "" && datagrid1.valueMatrix(i, 27) == "" ) {
								datagrid1.cellstyle("background-color", i, 1) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 2) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 3) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 4) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 5) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 6) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 7) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 8) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 9) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 10) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 11) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 12) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 13) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 14) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 15) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 16) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 17) = "#FFFFCC";
								datagrid1.cellstyle("background-color", i, 18) = "#FFFFCC";
						      }							
						}						
					}
					]]>
				</script>
			</button>
			<button id="button1" class="btn03" navindex="32" style="left:698px; top:0px; width:63px; height:21px; ">
				<caption>엑셀저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
						datagrid1.saveExcel(filename, "sheetname:sheet1;colhiddenextend:false;rowhiddenextend:false;exportfalsecols:0;row_0:label;");
					]]>
				</script>
			</button>
		</group>
	</xhtml:body>
</xhtml:html>
