<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>휴가대휴신청</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<hd_vaca_1706_m>
							<dataSet>
								<xx_proc_stat_010/>
								<xx_proc_stat_020/>
								<xx_vaca_clsf_010/>
								<xx_vaca_clsf_020/>
								<xx_vaca_clsf_030/>
								<xx_vaca_clsf_040/>
								<xx_vaca_clsf_050/>
								<xx_vaca_clsf_060/>
								<xx_vaca_clsf_070/>
								<xx_vaca_clsf_080/>
								<xx_vaca_clsf_090/>
								<xx_vaca_clsf_100/>
								<xx_vaca_clsf_110/>
								<xx_vaca_clsf_120/>
								<xx_vaca_clsf_130/>
								<xx_cd_010/>
								<xx_cd_020/>
								<xx_vaca_dtls_clsf_010/>
							</dataSet>
						</hd_vaca_1706_m>
						<session/>
						<comboSet>
							<vaca_clsf>
								<item>
									<cd_type/>
									<cd/>
									<cdnm/>
									<remk/>
									<mang_cd_4/>
								</item>
							</vaca_clsf>
							<vaca_dtls_clsf>
								<gridgbn>
								</gridgbn>
							</vaca_dtls_clsf>
							<vaca_dtls_46>
								<item>
									<cd_type/>
									<cd/>
									<cdnm/>
									<remk/>
									<mang_cd_4/>
								</item>
							</vaca_dtls_46>
							<vaca_dtls_42>
								<item>
									<cd_type/>
									<cd/>
									<cdnm/>
									<remk/>
									<mang_cd_4/>
								</item>
							</vaca_dtls_42>
							<vaca_dtls_51>
								<item>
									<cd_type/>
									<cd/>
									<cdnm/>
									<remk/>
									<mang_cd_4/>
								</item>
							</vaca_dtls_51>
							<vaca_dtls_49>
								<item>
									<cd_type/>
									<cd/>
									<cdnm/>
									<remk/>
									<mang_cd_4/>
								</item>
							</vaca_dtls_49>
							<vaca_dtls_41>
								<item>
									<cd_type/>
									<cd/>
									<cdnm/>
									<remk/>
									<mang_cd_4/>
								</item>
							</vaca_dtls_41>
							<vaca_dtls_44>
								<item>
									<cd_type/>
									<cd/>
									<cdnm/>
									<remk/>
									<mang_cd_4/>
								</item>
							</vaca_dtls_44>
							<vaca_dtls_50>
								<item>
									<cd_type/>
									<cd/>
									<cdnm/>
									<remk/>
									<mang_cd_4/>
								</item>
							</vaca_dtls_50>
							<vaca_dtls_60>
								<item>
									<cd_type/>
									<cd/>
									<cdnm/>
									<remk/>
									<mang_cd_4/>
								</item>
							</vaca_dtls_60>
						</comboSet>
						<pageInfo>
						</pageInfo>
					</initData>
					<reqData>
						<reqForm>
							<occr_dt/>
						</reqForm>
						<searchData>
							<emp_no/>
							<vaca_clsf/>
							<vaca_dtls_clsf/>
							<mang_cd_4/>
							<vaca_frdt/>
							<vaca_todt/>
						</searchData>
						<popData>
							<emp_no/>
							<cmpy_cd/>
							<vaca_ck/>
						</popData>
						<fwdData>
							<func_nm/>
						</fwdData>
						<multiUpData/>
					</reqData>
					<resData>
						<resForm>
						</resForm>
						<msg/>
						<gridData3>
							<record>
								<del_chk/>
								<dept_cd/>
								<dept_nm/>
								<emp_no/>
								<nm_korn/>
								<posi_nm/>
								<vaca_clsf/>
								<vaca_dtls_clsf/>
								<duty_dt/>
								<vaca_frdt/>
								<vaca_todt/>
								<vaca_dds/>
								<remk/>
								<occr_dt/>
								<seq/>
								<proc_stat/>
								<mang_cd_4/>
								<app_emp_no/>
								<proc_stat_nm/>
							</record>
						</gridData3>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					//전역
					var obj = htmldocument.SessionInfo;   //obj.deptcd.value
					
					function loadPopData(hodyClsf, dutyDt, alvcPlanDt){
						var rowIdx = datagrid3.row;					
						var colIdx = datagrid3.col;
						model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dtls_clsf",hodyClsf);
						model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/duty_dt",dutyDt);
						datagrid3.refresh();
					}
					function setEmp_no(emp_no, nm_korn, dept_cd, dept_nm, dty_cd, dty_nm, posi_cd, posi_nm){
						var rowIdx =datagrid3.row;					
						var colIdx =datagrid3.col;
						model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/emp_no", emp_no);
						model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/nm_korn", nm_korn);
						model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/dept_cd", dept_cd);
						model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/dept_nm", dept_nm);
						model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/posi_nm", posi_nm);
						var obj = htmldocument.SessionInfo;
						//session의 결재자 정보
						if(obj.cmpycd.value != "100")
						{
							app_emp_no = rtnApp_emp_no_getRef_vaca(emp_no); //app_emp_no = rtnApp_emp_no_getRef_vaca(model1.getValue("/root/tempData/emp_no"));//2018.09.13 변경  
						}
						else
						{
							app_emp_no = rtnApp_emp_no_getRef_vaca2(emp_no);//2018.08.13 변경 

						}
						if (app_emp_no == "err1") {
							alert("결재자 오류");
							model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/emp_no", "" );
							model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/nm_korn", "" );
							model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/dept_cd", "" );
							model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/dept_nm", "" );
							model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/posi_nm", "" );
							model1.removenode("/root/tempData");
							model1.removenode("/root/dataSet");
							model1.refresh();
						}
						model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/app_emp_no", app_emp_no);
						model1.removenode("/root/tempData");
						gridOpenReadOnly(rowIdx, "vaca_clsf");
						datagrid3.refresh();
					}
					function setEmp_Data(){
						var rowIdx =datagrid3.row;					
						var colIdx =datagrid3.col;
						model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/emp_no", model1.getValue("/root/tempData/emp_no"));
						model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/nm_korn", model1.getValue("/root/tempData/nm_korn"));
						model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/dept_cd", model1.getValue("/root/tempData/dept_cd"));
						model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/dept_nm", model1.getValue("/root/tempData/dept_nm"));
						model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/posi_nm", model1.getValue("/root/tempData/posi_nm"));
						
						var obj = htmldocument.SessionInfo;
						//session의 결재자 정보
						if(obj.cmpycd.value != "100")
						{
							app_emp_no = rtnApp_emp_no_getRef_vaca( model1.getValue("/root/tempData/emp_no"));
						}
						else
						{
							app_emp_no = rtnApp_emp_no_getRef_vaca2( model1.getValue("/root/tempData/emp_no"));//2018.08.13 변경 
						}
						
						if (app_emp_no == "err1") {
							alert("결재자 오류");
							model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/emp_no", "" );
							model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/nm_korn", "" );
							model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/dept_cd", "" );
							model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/dept_nm", "" );
							model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/posi_nm", "" );
							model1.removenode("/root/tempData");
							model1.removenode("/root/dataSet");
							model1.refresh();
							return;
						}
						model1.setValue("/root/resData/gridData3/record[" + (rowIdx) + "]/app_emp_no", app_emp_no);
						model1.removenode("/root/tempData");
						resetRow(rowIdx);//row초기화..
						gridOpenReadOnly(rowIdx, "vaca_clsf");
						
						model1.refresh();
					}
					function gridReadOnly_all(_row){
						datagrid3.isReadOnly(_row, datagrid3.colRef("vaca_clsf")) = true;
						datagrid3.isReadOnly(_row, datagrid3.colRef("vaca_dtls_clsf")) = true;
						datagrid3.isReadOnly(_row, datagrid3.colRef("vaca_frdt")) = true;
						datagrid3.isReadOnly(_row, datagrid3.colRef("vaca_todt")) = true;
					}
					function gridOpenReadOnly(_row, _colRef){
						datagrid3.isReadOnly(_row, datagrid3.colRef(""+_colRef+"")) = false;
					}
					function gridCloseReadOnly(_row, _colRef){
						datagrid3.isReadOnly(_row, datagrid3.colRef(""+_colRef+"")) = true;
					}
					function findMang_cd( path, findpath, rv_cd ){ //비교대상1, 리턴값 path, 비교2
						var nodeList = model1.instances(0).selectNodes(""+path+"");
						var findNode = model1.instances(0).selectNodes(""+findpath+"");
						for( i=0 ; i<=nodeList.length ; i++){
							var tmp_cd = nodeList.item(i).text;
							if (rv_cd == tmp_cd){
								return findNode.item(i).text;
								break;
							}
						}
					}
					function resetRow(_row){//해당 row를 초기화 한다.(사번 성명 제외...)
						model1.setValue("/root/resData/gridData3/record["+_row+"]/vaca_clsf","");//휴가구분
						model1.setValue("/root/resData/gridData3/record["+_row+"]/vaca_dtls_clsf","");//세부구분
						model1.setValue("/root/resData/gridData3/record["+_row+"]/duty_dt","");//휴일근무일
						model1.setValue("/root/resData/gridData3/record["+_row+"]/vaca_frdt","");//휴가시작일
						model1.setValue("/root/resData/gridData3/record["+_row+"]/vaca_todt","");//휴가종료일
						model1.setValue("/root/resData/gridData3/record["+_row+"]/vaca_dds","");//휴가일수
						model1.setValue("/root/resData/gridData3/record["+_row+"]/remk","");//비고
						model1.setValue("/root/resData/gridData3/record["+_row+"]/mang_cd_4","");//mang_cd_4
						gridReadOnly_all(_row);
					}
					function del_chk_close(){
						for (i=datagrid3.fixedRows; i<= datagrid3.rows; i++){
							var tmp_proc_stat = datagrid3.valueMatrix(i, datagrid3.colRef("proc_stat") );

							var pattern = ","+tmp_proc_stat+",";
							var validation  = (","+model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_proc_stat_010")+",").indexOf(pattern)>-1;

							//if (tmp_proc_stat == "" || tmp_proc_stat == "15" || tmp_proc_stat == "25"){ //120203
							if (tmp_proc_stat == "" || validation){
								datagrid3.isReadOnly(i, datagrid3.colRef("del_chk")) = true;
							}
						}
					}
					function setStatus(){
						datagrid3.clearStatus();
						datagrid3.rebuild();
						for(i=datagrid3.fixedRows;i<datagrid3.rows;i++){
							var del_chk_data = datagrid3.valueMatrix(i,datagrid3.colRef("del_chk"));
							var tmp_proc_stat = datagrid3.valueMatrix(i, datagrid3.colRef("proc_stat") );
							if( (del_chk_data == "1") ){
								datagrid3.rowStatus(i) = 4;
							}else{
								
								var pattern = ","+tmp_proc_stat+",";
								var validation  = (","+model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_proc_stat_020")+",").indexOf(pattern)>-1;
								//if ( tmp_proc_stat == "01" || tmp_proc_stat == "10" || tmp_proc_stat == "13" || tmp_proc_stat == "22" || tmp_proc_stat == "27"){ //120203
								if ( validation){
									datagrid3.rowStatus(i) = 0;
								}else if (tmp_proc_stat == ""){
									datagrid3.rowStatus(i) = 3;
								}else{
									datagrid3.rowStatus(i) = 0;
								}
							}
						}
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					model.send("hd_vaca_1706_m");
					model.refresh();
					/*
					alert(model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_proc_stat_010"));
					alert(model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_proc_stat_020"));
					alert(model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_010"));
					alert(model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_020"));
					alert(model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_030"));
					alert(model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_040"));
					alert(model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_050"));
					alert(model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_060"));
					alert(model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_070"));
					alert(model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_080"));
					alert(model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_090"));
					alert(model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_100"));
					alert(model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_cd_010"));
					alert(model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_cd_020"));
					alert(model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_dtls_clsf_010"));
					
					*/
					
					
					if(model.getValue("/root/initData/pageInfo/pageID") == ""){
						maintitle.text = "휴가대휴신청";
						iv_Title.visible = false;  // 숨김
						iv_PopTitle.visible = true;  // 보임
					}else if(model.getValue("/root/initData/pageInfo/pageID") != ""){
						iv_Title.visible = true;  // 보임
						iv_PopTitle.visible = false;  // 숨김
					}
					//node셋팅
					setResetRef();
					//접근권한부서
					setDeptCdCombo(combo200);
					
					//콤보
					model1.send("hd_vaca_1710");
					model1.copyNode("/root/initData/comboSet/vaca_clsf","/root/dataSet/VACA_CLSF");
					model1.copyNode("/root/initData/comboSet/vaca_dtls_46","/root/dataSet/VACA_DTLS_46");
					model1.copyNode("/root/initData/comboSet/vaca_dtls_42","/root/dataSet/VACA_DTLS_42");
					model1.copyNode("/root/initData/comboSet/vaca_dtls_51","/root/dataSet/VACA_DTLS_51");
					model1.copyNode("/root/initData/comboSet/vaca_dtls_49","/root/dataSet/VACA_DTLS_49");
					model1.copyNode("/root/initData/comboSet/vaca_dtls_41","/root/dataSet/VACA_DTLS_41");
					model1.copyNode("/root/initData/comboSet/vaca_dtls_44","/root/dataSet/VACA_DTLS_44");
					model1.copyNode("/root/initData/comboSet/vaca_dtls_50","/root/dataSet/VACA_DTLS_50");
					model1.copyNode("/root/initData/comboSet/vaca_dtls_60","/root/dataSet/VACA_DTLS_60");
					model1.removenode("/root/dataSet");
					
					model1.removenode("/root/resData/gridData3");
					datagrid3.refresh();
					
					datagrid3.fixedcellcheckbox(0, datagrid3.colRef("del_chk"), false  ) = true;
					
					datagrid3.addRow();
					
					gridReadOnly_all(1);
					del_chk_close();
					model1.setValue("/root/reqData/reqForm/occr_dt",commCurDate("ymd"));
					
					model1.refresh();
				]]>
			</script>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/HD_Common.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<submission id="hd_vaca_1710" action="/hd/vaca/1710" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_vaca_1711" action="/hd/vaca/1711" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_vaca_1712" action="/hd/vaca/1712" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpData" resultref="/root/tempData"/>
			<submission id="hd_vaca_1713" action="/hd/vaca/1713" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpData" resultref="/root/tempData"/>
			<submission id="hd_vaca_1612" action="/hd/vaca/1612" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_vaca_1706_m" action="/hd/vaca/1706" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/hd_vaca_1706_m/dataSet"/>
		</model>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="760" guideline="1,9;1,931;2,695;" style="font-family:굴림; ">
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<import id="iv_PopTitle" src="../../../common/xrw/iv_PopTitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:43px; width:921px; height:21px; ">
			<button id="btnA2" class="btn02" style="left:535px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.reset();
						datagrid3.addStatus(1, "insert");
						gridReadOnly_all(1);
						del_chk_close();
					]]>
				</script>
			</button>
			<button id="button10" class="btn02" style="left:869px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(model.getValue("/root/initData/pageInfo/pageID") != ""){
							viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
						}else{
							window.close();
						}
					]]>
				</script>
			</button>
			<button id="button1" class="btn04" style="left:776px; top:0px; width:89px; height:21px; ">
				<caption>신청서 출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							var emp_no_list = "";
							var chk_cnt = "";
							var obj = htmldocument.SessionInfo;   //obj.deptcd.value
							
							var cmpycd = obj.cmpycd.value;
							
							
							for(var i = 1;  i< datagrid3.rows; i++) {
								var chk = datagrid3.valueMatrix(i, datagrid3.colRef("del_chk"));
								if(chk == "1"){
									chk_cnt = chk;
								}
							}
							
							if(chk_cnt != "" &&  cmpycd == "100")
							{
								for(var i = 1;  i< datagrid3.rows; i++) 
								{
									var chk = datagrid3.valueMatrix(i, datagrid3.colRef("del_chk"));
									
									if(chk == "1") {
										var vaca_clsf = datagrid3.valueMatrix(i, datagrid3.colRef("vaca_clsf"));

										if(vaca_clsf == "44") 
										{
												emp_no_list = datagrid3.valueMatrix(i, datagrid3.colRef("emp_no"))  ;
												if (emp_no_list != "")
												{
													//출력 코딩
													resetOznode();											//오즈node 초기화
													makeNodeValue("/root/oz_data/ozrName","hd/SP_HD_VACA_1707_P");	//odi 파일경로('/' root경로 제외)
													makeNodeValue("/root/oz_data/preview","preview"); 			//preview : 미리보기, print : 인쇄
													makeNodeValue("/root/oz_data/printsize",""); 				//페이지용지설정(기본 A4)
													
													//Parameter setting
													makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , obj.cmpycd.value );	//회사코드
													makeNodeValue("/root/oz_data/odiParam/iv_occr_dt",model1.getValue("/root/reqData/reqForm/occr_dt"));
													makeNodeValue("/root/oz_data/odiParam/iv_proc_stat_clsf", model1.getValue("/root/reqData/searchData/proc_stat_clsf"));
													makeNodeValue("/root/oz_data/odiParam/iv_emp_no", emp_no_list );
													
													openOzwin("/root/oz_data");
												}
										}	
										else 
										{
											//alert("휴가 구분이 출산전후휴가가 아닙니다. ")
										//	return;
										}
									}
								}
							}
							else 
							{
								
									//출력 코딩
								resetOznode();											//오즈node 초기화
								makeNodeValue("/root/oz_data/ozrName","hd/SP_HD_VACA_1704_P");	//odi 파일경로('/' root경로 제외)
								makeNodeValue("/root/oz_data/preview","preview"); 			//preview : 미리보기, print : 인쇄
								makeNodeValue("/root/oz_data/printsize",""); 				//페이지용지설정(기본 A4)
								
								//Parameter setting
								makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , obj.cmpycd.value );	//회사코드
								makeNodeValue("/root/oz_data/odiParam/iv_occr_dt",model1.getValue("/root/reqData/reqForm/occr_dt"));
								makeNodeValue("/root/oz_data/odiParam/iv_proc_stat_clsf", model1.getValue("/root/reqData/searchData/proc_stat_clsf"));
								makeNodeValue("/root/oz_data/odiParam/iv_ss_emp_no", getProperty("ss_emp_no") );
								makeNodeValue("/root/oz_data/odiParam/iv_dept_cd", model1.getValue("/root/reqData/appData/app_dept_cd"));
								
								openOzwin("/root/oz_data");
								
								
								
							}
					]]>
				</script>
			</button>
			<button id="button2" class="btn02" style="left:595px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var tmp_chk1 = model1.getValue("/root/reqData/reqForm/occr_dt");
						var tmp_chk2 = model1.getValue("/root/reqData/appData/app_dept_cd");
						if( tmp_chk1 == ""){
							alert("작업일은 필수입력사항입니다.");
							return;
						}
						if(tmp_chk2 == ""){
							alert("부서정보는 필수입력사항입니다.");
							return;
						}
						model1.removenode("/root/resData/gridData3");
						model1.makeNode("/root/resData/gridData3");
						model1.removenode("/root/initData/comboSet/vaca_dtls_clsf");
						model1.makeNode("/root/initData/comboSet/vaca_dtls_clsf");
						datagrid3.refresh();
						model1.send("hd_vaca_1711");
						model1.copyNode("/root/resData/gridData3","/root/dataSet/CURLIST");
						model1.removenode("/root/dataSet");
						datagrid3.refresh();
						
						var rowcnt = datagrid3.rows;
						for(i= datagrid3.fixedRows ; i<rowcnt; i++){
							// 세부구분 콤보 맞추기..
							var tmp_vaca_clsf = datagrid3.valueMatrix(i, datagrid3.colRef("vaca_clsf"));
							model1.makeNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]");
							/*if(tmp_vaca_clsf == "41"){//연차휴가    //120203
								model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]","/root/initData/comboSet/vaca_dtls_41");
								datagrid3.cellComboNodeset(i, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]/item";
							}else if(tmp_vaca_clsf == "42"){//경조휴가
								model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]","/root/initData/comboSet/vaca_dtls_42");
								datagrid3.cellComboNodeset(i, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]/item";
							}else if(tmp_vaca_clsf == "46"){//공가
								model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]","/root/initData/comboSet/vaca_dtls_46");
								datagrid3.cellComboNodeset(i, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]/item";
							}else if(tmp_vaca_clsf == "49"){//안식
								model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]","/root/initData/comboSet/vaca_dtls_49");
								datagrid3.cellComboNodeset(i, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]/item";
							}else if(tmp_vaca_clsf == "51"){//대휴
								model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]","/root/initData/comboSet/vaca_dtls_51");
								datagrid3.cellComboNodeset(i, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]/item";
							}*/
							if(tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_010")){//연차휴가
								model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]","/root/initData/comboSet/vaca_dtls_41");
								datagrid3.cellComboNodeset(i, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]/item";
							}else if(tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_020")){//경조휴가
								model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]","/root/initData/comboSet/vaca_dtls_42");
								datagrid3.cellComboNodeset(i, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]/item";
							}else if(tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_060")){//공가
								model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]","/root/initData/comboSet/vaca_dtls_46");
								datagrid3.cellComboNodeset(i, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]/item";
							}else if(tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_090")){//안식
								model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]","/root/initData/comboSet/vaca_dtls_49");
								datagrid3.cellComboNodeset(i, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]/item";
							}else if(tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_100")){//대휴
								model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]","/root/initData/comboSet/vaca_dtls_51");
								datagrid3.cellComboNodeset(i, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]/item";
							}else if(tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_040")){// 출산휴가 2017.06.15 추가 
								model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]","/root/initData/comboSet/vaca_dtls_44");
								datagrid3.cellComboNodeset(i, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]/item";
							}else if(tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_110")){// 유산사산  2017.06.15 추가 
								model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]","/root/initData/comboSet/vaca_dtls_50");
								datagrid3.cellComboNodeset(i, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]/item";
							}else if(tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_120")){// 육아바우처  2018.03.16 추가 
								model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]","/root/initData/comboSet/vaca_dtls_60");
								datagrid3.cellComboNodeset(i, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+i+"]/item";
							}
							
							gridCloseReadOnly(i, "emp_no");
							gridCloseReadOnly(i, "nm_korn");
							gridCloseReadOnly(i, "vaca_clsf");
							gridCloseReadOnly(i, "vaca_dtls_clsf");
							gridCloseReadOnly(i, "vaca_frdt");
							gridCloseReadOnly(i, "vaca_todt");
						}
						del_chk_close();
						datagrid3.refresh();
					]]>
				</script>
			</button>
			<button id="button3" class="btn02" style="left:650px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						setStatus();
						if (!rowDelSubmit(datagrid3)) {
							return;
						}
	 					if (window.alert("삭제 하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						model1.setValue("/root/reqData/multiUpData", datagrid3.getUpdateData());
						model1.send("hd_vaca_1712");
						if(submit_completed()) {
							button2.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="button4" class="btn03" style="left:707px; top:0px; width:65px; height:21px; ">
				<caption>결재신청</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					 var obj = htmldocument.SessionInfo;
					
					if(obj.emp_no.value != "216010") { // 총무국 박재범씨만 임시로 입력가능
						for(var i=1;i<datagrid3.rows;i++){
							if(datagrid3.valueMatrix(i,datagrid3.colRef("vaca_clsf")) == "41"){
								var emp_no = datagrid3.valueMatrix(i,datagrid3.colRef("emp_no"));
								var fr_dt = datagrid3.valueMatrix(i,datagrid3.colRef("vaca_frdt"));
								var to_dt = datagrid3.valueMatrix(i,datagrid3.colRef("vaca_todt"));
								if ( fr_dt.substr(0,4) < to_dt.substr(0,4) ){ 
									alert("연차휴가일 경우 휴가시작일과 휴가종료일이 다른 년도 일 수 없습니다.(사번:" +emp_no+")");
					
									return;
								}
							}
						}  
					}
						if (!rowInSubmit(datagrid3)) {
							return;
						}
						if(!commGridReqCheck("datagrid3")) return;
						if (window.alert("저장하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						
						var row = datagrid3.row;
						var vaca_clsf = datagrid3.valueMatrix(row,datagrid3.colRef("vaca_clsf"));
						var duty_dt = datagrid3.valueMatrix(row,datagrid3.colRef("duty_dt"));
						
						for(var i = 1; i < datagrid3.rows; i++)
						{
								if(model1.getValue("/root/resData/gridData3/record["+i+"]/vaca_clsf")== model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_100"))
								{
									//if(duty_dt == "")
									if(model1.getValue("/root/resData/gridData3/record["+i+"]/duty_dt")=="")
									{
										alert("대휴일경우 휴일근무일은 필수 입니다.");
										return;
									}
								}
						}
						
						model1.setValue("/root/reqData/multiUpData", datagrid3.getUpdateData());
						model1.send("hd_vaca_1713");
						if(submit_completed()) {
							model1.removenode("/root/resData/gridData3");
							model1.makeNode("/root/resData/gridData3");
							datagrid3.refresh();
						}
					]]>
				</script>
			</button>
			<button id="button5" class="btn04" visibility="hidden" style="left:441px; top:0px; width:89px; height:21px; ">
				<caption>신청서 출력2</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							var emp_no_list = "";
							var chk_cnt = "";
							for(var i = 1;  i< datagrid3.rows; i++) {
								var chk = datagrid3.valueMatrix(i, datagrid3.colRef("del_chk"));
								if(chk == "1"){
									chk_cnt = chk;
								}
							}
							if(chk_cnt == ""){
								alert("출력하실 장표를 선택해 주세요.");
								return;
							}
							for(var i = 1;  i< datagrid3.rows; i++) {
								var chk = datagrid3.valueMatrix(i, datagrid3.colRef("del_chk"));
								if(chk == "1") {
									emp_no_list = datagrid3.valueMatrix(i, datagrid3.colRef("emp_no"))  ;
								}
								else 
								{
									alert("한명의 사원만 선택해 주세요 ");
								
								}
							}
						if (emp_no_list != "")
						{
							//출력 코딩
							resetOznode();											//오즈node 초기화
							makeNodeValue("/root/oz_data/ozrName","hd/SP_HD_VACA_1707_P");	//odi 파일경로('/' root경로 제외)
							makeNodeValue("/root/oz_data/preview","preview"); 			//preview : 미리보기, print : 인쇄
							makeNodeValue("/root/oz_data/printsize",""); 				//페이지용지설정(기본 A4)
							
							//Parameter setting
							makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , obj.cmpycd.value );	//회사코드
							makeNodeValue("/root/oz_data/odiParam/iv_occr_dt",model1.getValue("/root/reqData/reqForm/occr_dt"));
							makeNodeValue("/root/oz_data/odiParam/iv_proc_stat_clsf", model1.getValue("/root/reqData/searchData/proc_stat_clsf"));
							makeNodeValue("/root/oz_data/odiParam/iv_emp_no", emp_no_list );
							
							openOzwin("/root/oz_data");
						}
					]]>
				</script>
			</button>
		</group>
		<group id="group1" class="gro_btn" style="left:10px; top:105px; width:921px; height:20px; ">
			<caption id="caption5" class="tit02" style="left:2px; top:0px; width:335px; height:20px; font-weight:bold; ">휴가(대휴) 신청</caption>
		</group>
		<caption id="rowCnt" style="left:806px; top:675px; width:125px; height:20px; font-weight:bold; text-align:right; "/>
		<group id="group100" style="left:9px; top:75px; width:626px; height:29px; ">
			<caption id="caption101" class="list_cap02" style="left:69px; top:0px; width:376px; height:26px; text-align:center; "/>
			<caption id="caption203" class="list_cap01" visibility="visible" style="left:194px; top:0px; width:70px; height:26px; text-align:center; ">부   서</caption>
			<select1 id="combo200" ref="/root/reqData/appData/app_dept_cd" class="req" visibility="visible" appearance="minimal" style="left:268px; top:4px; width:170px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/combo200/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
						//getApp_emp_no("/root/reqData/appData/app_dept_cd");
					]]>
				</script>
			</select1>
			<input id="search_dt" ref="/root/reqData/reqForm/occr_dt" inputtype="date" format="yyyy-mm-dd" appearance="input" style="left:93px; top:4px; width:98px; height:18px; text-align:center; "/>
			<caption id="caption39" class="list_cap01" style="left:0px; top:0px; width:90px; height:26px; text-align:center; ">작업일</caption>
		</group>
		<datagrid id="datagrid3" nodeset="/root/resData/gridData3/record" scroll="auto" caption="삭제^부서코드^부서^사번^성명^직책^휴가구분^세부구분^휴일근무일^휴가시작일^휴가종료일^휴가일수^비고^occr_dt^seq^proc_stat^mang_cd_4^결재자^진행상태" colsep="#" colwidth="53, 50, 120, 70, 75, 60, 90, 80, 70, 90, 90, 55, 213, 100, 100, 100, 100, 100, 70" extendlastcol="scroll" frozencols="5" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" tooltip="true" style="left:7px; top:125px; width:924px; height:530px; ">
			<col checkvalue="1,0" ref="del_chk" type="checkbox"/>
			<col ref="dept_cd" visibility="hidden"/>
			<col ref="dept_nm" style="text-align:left; "/>
			<col class="req" ref="emp_no" type="input" maxlength="6" caption="사번">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(datagrid3.col == datagrid3.colRef("emp_no")){
							var rowIdx =datagrid3.row;					
							var colIdx =datagrid3.col;					
							var empno = datagrid3.valueMatrix(rowIdx,colIdx);
							setInfoSearchInput(empno,"","","setEmp_no");
							if(model1.getValue("/root/tempData/totalcnt") != 1){
								model1.removenode("/root/tempData");
								return;
							}
							setEmp_Data();
						}
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keyCode == 13 ){
							if(datagrid3.col == datagrid3.colRef("emp_no")){
								var rowIdx =datagrid3.row;					
								var colIdx =datagrid3.col;					
								var empno = datagrid3.valueMatrix(rowIdx,colIdx);
								setInfoSearchInput(empno,"","","setEmp_no");
								if(model1.getValue("/root/tempData/totalcnt") != 1){
									model1.removenode("/root/tempData");
									return;
								}
								setEmp_Data();
							}
						}
					]]>
				</script>
			</col>
			<col class="req" imemode="hangul" ref="nm_korn" type="input" caption="성명">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(datagrid3.col == datagrid3.colRef("nm_korn")){
							var rowIdx =datagrid3.row;					
							var colIdx =datagrid3.col;					
							var nm_korn = datagrid3.valueMatrix(rowIdx,colIdx);
							setInfoSearchInput("",nm_korn,"","setEmp_no");
							if(model1.getValue("/root/tempData/totalcnt") != 1){
								model1.removenode("/root/tempData");
								return;
							}
							setEmp_Data();
						}
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keyCode == 13 ){
							if(datagrid3.col == datagrid3.colRef("nm_korn")){
								var rowIdx =datagrid3.row;					
								var colIdx =datagrid3.col;					
								var nm_korn = datagrid3.valueMatrix(rowIdx,colIdx);
								setInfoSearchInput("",nm_korn,"","setEmp_no");
								if(model1.getValue("/root/tempData/totalcnt") != 1){
									model1.removenode("/root/tempData");
									return;
								}
								setEmp_Data();
							}
						}
					]]>
				</script>
			</col>
			<col ref="posi_nm"/>
			<col id="combo1" class="req" ref="vaca_clsf" type="combo" caption="휴가구분" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/vaca_clsf/item">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</col>
			<col ref="vaca_dtls_clsf" type="combo" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/vaca_dtls_clsf">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</col>
			<col ref="duty_dt" format="yyyy-mm-dd"/>
			<col class="req" ref="vaca_frdt" type="inputdate" format="yyyy-mm-dd" caption="휴가시작일"/>
			<col class="req" ref="vaca_todt" type="inputdate" format="yyyy-mm-dd" caption="휴가종료일"/>
			<col class="req" ref="vaca_dds" caption="휴가일수"/>
			<col ref="remk" type="input" style="text-align:left; "/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="proc_stat" visibility="hidden"/>
			<col ref="mang_cd_4" visibility="hidden"/>
			<col class="req" ref="app_emp_no" visibility="hidden" caption="결재자"/>
			<col ref="proc_stat_nm"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var rowIdx = datagrid3.row;					
					var colIdx = datagrid3.col;
					if(datagrid3.col == datagrid3.colRef("vaca_clsf")){ //휴가구분변경시
						//초기화부분
						model1.removenode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]");
						model1.makeNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]");
						model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dtls_clsf","");//세부구분
						model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/duty_dt","");//휴일근무일
						model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_frdt","");//휴가시작일
						model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");//휴가종료일
						model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");//휴가일수
						model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4","");//mang_cd_4
						gridOpenReadOnly(rowIdx, "vaca_frdt");
						gridOpenReadOnly(rowIdx, "vaca_todt");
						datagrid3.refresh();
						//조회조건 searchData 초기화
						model1.setValue("/root/reqData/searchData/emp_no", "");
						model1.setValue("/root/reqData/searchData/vaca_clsf", "");
						model1.setValue("/root/reqData/searchData/vaca_dtls_clsf", "");
						model1.setValue("/root/reqData/searchData/mang_cd_4", "");
						model1.setValue("/root/reqData/searchData/vaca_frdt", "");
						model1.setValue("/root/reqData/searchData/vaca_todt", "");
						
						var vaca_clsf = datagrid3.valueMatrix(rowIdx, datagrid3.colRef("vaca_clsf"));
						/*120203
						if (vaca_clsf == "41") {//연차휴가    
							model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]","/root/initData/comboSet/vaca_dtls_41");
							datagrid3.cellComboNodeset(rowIdx, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]/item";
						}else if(vaca_clsf == "42"){//경조휴가
							model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]","/root/initData/comboSet/vaca_dtls_42");
							datagrid3.cellComboNodeset(rowIdx, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]/item";
						}else if(vaca_clsf == "43"){//보건휴가
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4", findMang_cd( "/root/initData/comboSet/vaca_clsf/item/cd", "/root/initData/comboSet/vaca_clsf/item/mang_cd_3", "43")); //1일하드코딩
							alert("보건휴가를 사용하는 경우 1일치의 급여를 공제합니다. ");
						}else if(vaca_clsf == "44"){//산전후휴가
						//	model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4", findMang_cd( "/root/initData/comboSet/vaca_clsf/item/cd", "/root/initData/comboSet/vaca_clsf/item/mang_cd_3", "44"));//90일하드코딩
						//변경 
							model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]","/root/initData/comboSet/vaca_dtls_44");
							datagrid3.cellComboNodeset(rowIdx, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]/item";
						}else if(vaca_clsf == "45"){//병가
							alert("연차와 대휴를 사용한 후 병가신청이 가능합니다.\n"+"인사팀에 문의 후 신청 바랍니다.");
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4", findMang_cd( "/root/initData/comboSet/vaca_clsf/item/cd", "/root/initData/comboSet/vaca_clsf/item/mang_cd_3", "45"));//90일하드코딩
						}else if(vaca_clsf == "46"){//공가
							model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]","/root/initData/comboSet/vaca_dtls_46");
							datagrid3.cellComboNodeset(rowIdx, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]/item";
						}else if(vaca_clsf == "47"){//특가
						}else if(vaca_clsf == "48"){//기타휴가
						}else if(vaca_clsf == "49"){//안식휴가
							model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]","/root/initData/comboSet/vaca_dtls_49");
							datagrid3.cellComboNodeset(rowIdx, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]/item";
						}else if(vaca_clsf == "51"){//대휴
							gridCloseReadOnly(rowIdx, "vaca_todt");
							model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]","/root/initData/comboSet/vaca_dtls_51");
							datagrid3.cellComboNodeset(rowIdx, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]/item";
							var cmpy_cd = obj.cmpycd.value;
							var emp_no = model1.getValue("/root/reqData/searchData/emp_no");
							model1.setValue("/root/reqData/popData/cmpy_cd",cmpy_cd);
							model1.setValue("/root/reqData/popData/emp_no", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/emp_no") );
							model1.setValue("/root/reqData/popData/vaca_ck","10");
							window.load("/xrw/hd/vaca/HD_VACA_1610.xrw","mdichild", "hd_vaca_1610", "align:center; caption:hidden; width:540; height:400;", "/root/reqData/popData",  "/root/reqData/popData");
							gridCloseReadOnly(rowIdx, "vaca_todt");
						}*/
						if (vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_010")) {//연차휴가
							model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]","/root/initData/comboSet/vaca_dtls_41");
							datagrid3.cellComboNodeset(rowIdx, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]/item";
						}else if(vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_020")){//경조휴가
							model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]","/root/initData/comboSet/vaca_dtls_42");
							datagrid3.cellComboNodeset(rowIdx, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]/item";
						}else if(vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_030")){//보건휴가
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4", findMang_cd( "/root/initData/comboSet/vaca_clsf/item/cd", "/root/initData/comboSet/vaca_clsf/item/mang_cd_3", model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_030"))); //1일하드코딩
							alert("보건휴가를 사용하는 경우 1일치의 급여를 공제합니다. ");
						}else if(vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_040")){//산전후휴가
							//model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4", findMang_cd( "/root/initData/comboSet/vaca_clsf/item/cd", "/root/initData/comboSet/vaca_clsf/item/mang_cd_3", model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_040")));//90일하드코딩
							//변경
							model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]","/root/initData/comboSet/vaca_dtls_44");
							datagrid3.cellComboNodeset(rowIdx, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]/item";
						}else if(vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_110")){//유산사산휴가
							model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]","/root/initData/comboSet/vaca_dtls_50");
							datagrid3.cellComboNodeset(rowIdx, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]/item";

						}else if(vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_050")){//병가
							alert("연차와 대휴를 사용한 후 병가신청이 가능합니다.\n"+"인사팀에 문의 후 신청 바랍니다.");
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4", findMang_cd( "/root/initData/comboSet/vaca_clsf/item/cd", "/root/initData/comboSet/vaca_clsf/item/mang_cd_3", model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_050")));//90일하드코딩
						}else if(vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_060")){//공가
							model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]","/root/initData/comboSet/vaca_dtls_46");
							datagrid3.cellComboNodeset(rowIdx, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]/item";
						}else if(vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_070")){//특가
						}else if(vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_080")){//기타휴가
						}else if(vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_090")){//안식휴가
							model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]","/root/initData/comboSet/vaca_dtls_49");
							datagrid3.cellComboNodeset(rowIdx, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]/item";
						}else if(vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_100")){//대휴
							gridCloseReadOnly(rowIdx, "vaca_todt");
							model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]","/root/initData/comboSet/vaca_dtls_51");
							datagrid3.cellComboNodeset(rowIdx, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]/item";
							var cmpy_cd = obj.cmpycd.value;
							var emp_no = model1.getValue("/root/reqData/searchData/emp_no");
							model1.setValue("/root/reqData/popData/cmpy_cd",cmpy_cd);
							model1.setValue("/root/reqData/popData/emp_no", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/emp_no") );
							model1.setValue("/root/reqData/popData/vaca_ck","10");
							window.load("/xrw/hd/vaca/HD_VACA_1610.xrw","mdichild", "hd_vaca_1610", "align:center; caption:hidden; width:540; height:400;", "/root/reqData/popData",  "/root/reqData/popData");
							gridCloseReadOnly(rowIdx, "vaca_todt");
						}else if(vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_120")) {//육아바우처 
						//	model1.copyNode("/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]","/root/initData/comboSet/vaca_dtls_60");
						//	datagrid3.cellComboNodeset(rowIdx, datagrid3.colRef("vaca_dtls_clsf")) = "/root/initData/comboSet/vaca_dtls_clsf/gridgbn["+rowIdx+"]/item";
						    alert("육아바우처는 휴가신청(개인)화면에서 등록 가능합니다. ");
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_clsf","");
						}else if(vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_130")){//난임 휴가
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4", findMang_cd( "/root/initData/comboSet/vaca_clsf/item/cd", "/root/initData/comboSet/vaca_clsf/item/mang_cd_3", model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_130"))); //1일하드코딩
						}
						gridOpenReadOnly(rowIdx, "vaca_dtls_clsf");
					}else if ( datagrid3.col == datagrid3.colRef("vaca_dtls_clsf") ) { //세부구분 변경시
						//초기화부분
						model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/duty_dt","");//휴일근무일
						model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_frdt","");//휴가시작일
						model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");//휴가종료일
						model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");//휴가일수
						model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4","");//mang_cd_4
						datagrid3.refresh();
						/* // 120203
						if ( model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_clsf") == "41"){//연차
							if( model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dtls_clsf") == "20"){ //반일
								gridCloseReadOnly(rowIdx, "vaca_todt");
							}
						}
						//경조 휴가일수 셋팅
						if ( model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_clsf") == "42"){//경조
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4", findMang_cd( "/root/initData/comboSet/vaca_dtls_42/item/cd", "/root/initData/comboSet/vaca_dtls_42/item/mang_cd_4", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dtls_clsf")));
							//gridCloseReadOnly(rowIdx, "vaca_todt");
						}
						//안식 휴가일수 셋팅
						if ( model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_clsf") == "49"){//경조
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4", findMang_cd( "/root/initData/comboSet/vaca_dtls_49/item/cd", "/root/initData/comboSet/vaca_dtls_49/item/mang_cd_4", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dtls_clsf")));
							//gridCloseReadOnly(rowIdx, "vaca_todt");
						}*/
						if ( model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_clsf") == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_010")){//연차
							if( model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dtls_clsf") == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_cd_020")){ //반일
								gridCloseReadOnly(rowIdx, "vaca_todt");
							}
						}
						//경조 휴가일수 셋팅
						if ( model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_clsf") == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_020")){//경조
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4", findMang_cd( "/root/initData/comboSet/vaca_dtls_42/item/cd", "/root/initData/comboSet/vaca_dtls_42/item/mang_cd_4", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dtls_clsf")));
							//gridCloseReadOnly(rowIdx, "vaca_todt");
						}
						//안식 휴가일수 셋팅
						if ( model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_clsf") == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_090")){//경조
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4", findMang_cd( "/root/initData/comboSet/vaca_dtls_49/item/cd", "/root/initData/comboSet/vaca_dtls_49/item/mang_cd_4", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dtls_clsf")));
							//gridCloseReadOnly(rowIdx, "vaca_todt");
						}
						//출산전후휴가  휴가일수 셋팅 20170615
						if ( model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_clsf") == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_040")){//출산전후휴가 
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4", findMang_cd( "/root/initData/comboSet/vaca_dtls_44/item/cd", "/root/initData/comboSet/vaca_dtls_44/item/mang_cd_4", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dtls_clsf")));
							//gridCloseReadOnly(rowIdx, "vaca_todt");
						}
						//유산사산휴가  휴가일수 셋팅 20170615
						if ( model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_clsf") == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_110")){//
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4", findMang_cd( "/root/initData/comboSet/vaca_dtls_50/item/cd", "/root/initData/comboSet/vaca_dtls_50/item/mang_cd_4", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dtls_clsf")));
							//gridCloseReadOnly(rowIdx, "vaca_todt");
						}
						//육아바우처   휴가일수 셋팅 20180316
						if ( model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_clsf") == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_120")){//
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4", findMang_cd( "/root/initData/comboSet/vaca_dtls_60/item/cd", "/root/initData/comboSet/vaca_dtls_60/item/mang_cd_4", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dtls_clsf")));
							//gridCloseReadOnly(rowIdx, "vaca_todt");
						}
					}else if (datagrid3.col == datagrid3.colRef("vaca_frdt")) {  //휴가시작일 변경시
						//초기화...
						model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");//휴가종료일
						model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");//휴가일수
						datagrid3.refresh();
						
						var tmp_vaca_clsf = model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_clsf");
						var tmp_vaca_dtls_clsf = model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dtls_clsf");
						if( tmp_vaca_clsf == "" ){
							alert("휴가구분을 선택해주세요.");
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_frdt","");
							datagrid3.refresh();
							return;
						//}else if( tmp_vaca_clsf == "41" || tmp_vaca_clsf == "42" || tmp_vaca_clsf == "46" || tmp_vaca_clsf == "49" ){  //120203
						}else if( tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_010") 
							   || tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_020") 
							   || tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_060") 
							   || tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_090") ){ 
							if( tmp_vaca_dtls_clsf == "" ){
								alert("세부구분을 선택해주세요.");
								model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_frdt","");
								datagrid3.refresh();
								return;
							}
						}
						//조회조건 searchData에 셋팅
						model1.setValue("/root/reqData/searchData/emp_no", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/emp_no"));
						model1.setValue("/root/reqData/searchData/vaca_clsf", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_clsf"));
						model1.setValue("/root/reqData/searchData/vaca_dtls_clsf", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dtls_clsf"));
						model1.setValue("/root/reqData/searchData/mang_cd_4", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4"));
						model1.setValue("/root/reqData/searchData/vaca_frdt", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_frdt"));
						model1.setValue("/root/reqData/searchData/vaca_todt", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt"));
						
						if ( model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_frdt").length == 8 ) {
							model1.send("hd_vaca_1612");
							if(submit_completed()) {
								var vaca_chk = model1.getValue("/root/dataSet/CURLIST/record/stat_proc");
								if (vaca_chk == "10"){
									alert("휴일은 선택하실수 없습니다.");
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_frdt","");
									datagrid3.refresh();
									model1.removenode("/root/dataSet");
									return;
								}else if( vaca_chk == "20"){
									alert("등록되어 있는 휴가일입니다.");
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_frdt","");
									datagrid3.refresh();
									model1.removenode("/root/dataSet");
									return;
								}
								//반일휴가
								//if(tmp_vaca_clsf == "41" && tmp_vaca_dtls_clsf == "20" ){ //120203
								if(tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_010") && tmp_vaca_dtls_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_cd_020") ){
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt", model1.getValue("/root/dataSet/CURLIST/record/vaca_todt") );
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
									datagrid3.refresh();
								}
								//경조휴가
								/*  //120203
								if( tmp_vaca_clsf == "42" ){//경조휴가
									if( tmp_vaca_dtls_clsf == "10"  //본인결혼
									|| tmp_vaca_dtls_clsf == "30"  //배우자출산
									|| tmp_vaca_dtls_clsf == "35"  //부모상,
									|| tmp_vaca_dtls_clsf == "40"  // 배우자부모상, 
									|| tmp_vaca_dtls_clsf == "45"  //승조부모상,
									|| tmp_vaca_dtls_clsf == "50"  // 배우자상,
									|| tmp_vaca_dtls_clsf == "55"  // 자녀상,
									|| tmp_vaca_dtls_clsf == "60"  // 조부모상, 
									|| tmp_vaca_dtls_clsf == "65"  //외조부모상, 
									|| tmp_vaca_dtls_clsf == "70"  //배우자조부모상,
									|| tmp_vaca_dtls_clsf == "75"){// 형제.자매상  */
									
								

								if( tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_020") ){//경조휴가
									var pattern = ","+tmp_vaca_dtls_clsf+",";
									var validation  = (","+model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_dtls_clsf_010")+",").indexOf(pattern)>-1;
									if( validation){
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt", model1.getValue("/root/dataSet/CURLIST/record/vaca_todt") );
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
										datagrid3.refresh();
									}else{ //나머지들..
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt", model1.getValue("/root/dataSet/CURLIST/record/vaca_todt") );
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
										datagrid3.refresh();
									}
								}
								//if( tmp_vaca_clsf == "43" ){//보건휴가.  //120203
								if( tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_030") ){//보건휴가.
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt", model1.getValue("/root/dataSet/CURLIST/record/vaca_todt") );
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
									datagrid3.refresh();
								}
								//if (tmp_vaca_clsf == "44"){//산전후휴가  //120203
								if (tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_040")){//산전후휴가
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt", model1.getValue("/root/dataSet/CURLIST/record/vaca_todt") );
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
									datagrid3.refresh();
								}
								if (tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_110")){//유산사산 휴가 2017.06.16 
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt", model1.getValue("/root/dataSet/CURLIST/record/vaca_todt") );
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
									datagrid3.refresh();
								}
								//if (tmp_vaca_clsf == "45"){//병가  //120203
								if (tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_050")){//병가
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt", model1.getValue("/root/dataSet/CURLIST/record/vaca_todt") );
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
									datagrid3.refresh();
								}
								//if (tmp_vaca_clsf == "46" || tmp_vaca_clsf == "47" || tmp_vaca_clsf == "48"){//공가, 특가, 기타휴가  //120203
								if (tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_060")
								 || tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_070") 
								 || tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_080")){//공가, 특가, 기타휴가
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt", model1.getValue("/root/dataSet/CURLIST/record/vaca_todt") );
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
									datagrid3.refresh();
								}
								//if (tmp_vaca_clsf == "49"){//안식휴가  //120203
								if (tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_090")){//안식휴가
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt", model1.getValue("/root/dataSet/CURLIST/record/vaca_todt") );
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
									datagrid3.refresh();
								}
								//if (tmp_vaca_clsf == "51"){//대휴  //120203
								if (tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_100")){//대휴
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt", model1.getValue("/root/dataSet/CURLIST/record/vaca_todt") );
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
									datagrid3.refresh();
								}
								//if (tmp_vaca_clsf == "65"){//난임휴가  //180517
								if (tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_130")){//난임휴가
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt", model1.getValue("/root/dataSet/CURLIST/record/vaca_todt") );
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
									datagrid3.refresh();
								}
								model1.removenode("/root/dataSet");
							}else{
								if (model1.getValue("/root/errData/errmsg") != ""){
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_frdt", "");
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt", "");
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", "");
									datagrid3.refresh();
								}
							}
						}
					}else if (datagrid3.col == datagrid3.colRef("vaca_todt")) {  //휴가종료일 변경시
						var tmp_vaca_clsf = model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_clsf");
						var tmp_vaca_dtls_clsf = model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dtls_clsf");
						var fr_dt = model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_frdt");
						var to_dt = model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt");
						if( tmp_vaca_clsf == "" ){
							alert("휴가구분을 선택해주세요.");
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
							datagrid3.refresh();
							return;
						//}else if( tmp_vaca_clsf == "41" || tmp_vaca_clsf == "42" || tmp_vaca_clsf == "46" || tmp_vaca_clsf == "49" ){   //120203
						}else if( tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_010") 
							   || tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_020") 
							   || tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_060") 
							   || tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_090") ){ 
							if( tmp_vaca_dtls_clsf == "" ){
								alert("세부구분을 선택해주세요.");
								model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
								datagrid3.refresh();
								return;
							}
						}
						if(model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_frdt") == ""){
							alert("휴가시작일을 먼저 입력해주세요.");
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
							datagrid3.refresh();
							return;
						}
						if(fr_dt == "" && to_dt == ""){
							alert("기간설정을 입력 후 조회해주세요.");
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_frdt","");
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");
							datagrid3.refresh();
							return;
						}
						if(fr_dt.length != 8 || to_dt.length != 8){
							alert("휴가기간을 정확히 입력해주세요.");
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_frdt","");
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");
							datagrid3.refresh();
							return;
						}
						if(fr_dt > to_dt){
							alert("휴가종료일은 휴가시작일보다 빠를수 없습니다.");
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_frdt","");
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
							model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");
							datagrid3.refresh();
							return;
						}
						//휴가종료일check
						//if(model1.getValue("/root/reqData/reqForm/vaca_clsf") == "41"){  //120203
						if(model1.getValue("/root/reqData/reqForm/vaca_clsf") == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_010")){ 
							if ( fr_dt.substr(0,4) < to_dt.substr(0,4) ){ 
								alert("종료일은 12월31일 이전으로 등록해야 합니다.");
								model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
								datagrid3.refresh();
								return;
							}
						}
						//조회조건 searchData에 셋팅
						model1.setValue("/root/reqData/searchData/emp_no", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/emp_no"));
						model1.setValue("/root/reqData/searchData/vaca_clsf", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_clsf"));
						model1.setValue("/root/reqData/searchData/vaca_dtls_clsf", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dtls_clsf"));
						model1.setValue("/root/reqData/searchData/mang_cd_4", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4"));
						model1.setValue("/root/reqData/searchData/vaca_frdt", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_frdt"));
						model1.setValue("/root/reqData/searchData/vaca_todt", model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt"));
						
						if ( model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt").length == 8 ) {
							model1.send("hd_vaca_1612");
							if(submit_completed()) {
								var vaca_chk = model1.getValue("/root/dataSet/CURLIST/record/stat_proc");
								if (vaca_chk == "10"){
									alert("휴일은 선택하실수 없습니다.");
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");
									datagrid3.refresh();
									model1.removenode("/root/dataSet");
									return;
								}else if( vaca_chk == "20"){
									alert("등록되어 있는 휴가일입니다.");
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");
									datagrid3.refresh();
									model1.removenode("/root/dataSet");
									return;
								}
								//전일휴가
								//if(tmp_vaca_clsf == "41" && tmp_vaca_dtls_clsf == "10" ){  //120203
								if(tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_010") && tmp_vaca_dtls_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_cd_010") ){ 
									if(vaca_chk == "30"){//에러처리
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
										alert("신청가능휴가일보다 많은 휴가일수를 신청하셨습니다.\n");//+"신청가능일수 : "+model1.getValue("/root/resData/resForm/rmn_vaca_dds"));
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");
										datagrid3.refresh();
										model1.removenode("/root/dataSet");
										return;
									}else{//정상처리
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
										datagrid3.refresh();
									}
								}
								//경조휴가
								/*  //120203
								if( tmp_vaca_clsf == "42" ){//경조휴가
									if( tmp_vaca_dtls_clsf == "10"  //본인결혼
									|| tmp_vaca_dtls_clsf == "30"  //배우자출산
									|| tmp_vaca_dtls_clsf == "35"  //부모상,
									|| tmp_vaca_dtls_clsf == "40"  // 배우자부모상, 
									|| tmp_vaca_dtls_clsf == "45"  //승조부모상,
									|| tmp_vaca_dtls_clsf == "50"  // 배우자상,
									|| tmp_vaca_dtls_clsf == "55"  // 자녀상,
									|| tmp_vaca_dtls_clsf == "60"  // 조부모상, 
									|| tmp_vaca_dtls_clsf == "65"  //외조부모상, 
									|| tmp_vaca_dtls_clsf == "70"  //배우자조부모상,
									|| tmp_vaca_dtls_clsf == "75"){// 형제.자매상 */
								if( tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_020") ){//경조휴가
									var pattern = ","+tmp_vaca_dtls_clsf+",";
									var validation  = (","+model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_dtls_clsf_010")+",").indexOf(pattern)>-1;
									if( validation){// 형제.자매상
										if(vaca_chk == "30"){//에러처리
											alert("신청가능일수는  휴일포함 "+model1.getValue("/root/reqData/reqForm/mang_cd_4")+"일 입니다.");
											model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
											model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");
											datagrid3.refresh();
											model1.removenode("/root/dataSet");
											return;
										}else{//정상처리
											model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
											datagrid3.refresh();
										}
									}else{ //나머지들..
										if(vaca_chk == "30"){//에러처리
											alert("신청가능일수는  휴일포함 "+model1.getValue("/root/reqData/searchData/mang_cd_4")+"일 입니다.");
											model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
											model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");
											datagrid3.refresh();
											model1.removenode("/root/dataSet");
											return;
										}else{//정상처리
											model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
											datagrid3.refresh();
										}
									}
								}
								//if( tmp_vaca_clsf == "44" ){//산전후휴가  //120203
								if( tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_040") ){//산전후휴가
									if(vaca_chk == "30"){//에러처리
										alert("신청가능일수는 휴일포함 "+model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4")+"일 입니다.");
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");
										datagrid3.refresh();
										model1.removenode("/root/dataSet");
										return;
									}else{//정상처리
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
										datagrid3.refresh();
									}
								}
								//if( tmp_vaca_clsf == "50" ){//유산사산휴가   
								if( tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_110") ){//유산사산휴가
									if(vaca_chk == "30"){//에러처리
										alert("신청가능일수는 휴일포함 "+model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4")+"일 입니다.");
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");
										datagrid3.refresh();
										model1.removenode("/root/dataSet");
										return;
									}else{//정상처리
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
										datagrid3.refresh();
									}
								}
								//if( tmp_vaca_clsf == "45" ){//병가  //120203
								if( tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_050") ){//병가
									if(vaca_chk == "30"){//에러처리
										alert("신청가능일수는 휴일포함 "+model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4")+"일 입니다.");
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");
										datagrid3.refresh();
										model1.removenode("/root/dataSet");
										return;
									}else{//정상처리
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
										datagrid3.refresh();
									}
								}
								//if( tmp_vaca_clsf == "46" || tmp_vaca_clsf == "47" || tmp_vaca_clsf == "48"){//공가,특가,기타휴가  //120203
								if( tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_060") 
								 || tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_070") 
								 || tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_080")){//공가,특가,기타휴가
									model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
									datagrid3.refresh();
								}
								//if( tmp_vaca_clsf == "49" ){//안식휴가  //120203
								if( tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_090") ){//안식휴가
									if(vaca_chk == "30"){//에러처리
										alert("신청가능일수는 휴일포함 "+model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4")+"일 입니다.");
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");
										datagrid3.refresh();
										model1.removenode("/root/dataSet");
										return;
									}else{//정상처리
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
										datagrid3.refresh();
									}
								}
								//if( tmp_vaca_clsf == "60" ){//육아바우처  //180216
								if( tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_120") ){//육아바우처 
									if(vaca_chk == "30"){//에러처리
										alert("신청가능일수는 휴일포함 "+model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4")+"일 입니다.");
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");
										datagrid3.refresh();
										model1.removenode("/root/dataSet");
										return;
									}else{//정상처리
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
										datagrid3.refresh();
									}
								}
								//if( tmp_vaca_clsf == "65" ){//난임휴가  //180216
								if( tmp_vaca_clsf == model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_vaca_clsf_130") ){//육아바우처 
									if(vaca_chk == "30"){//에러처리
										alert("신청가능일수는 휴일포함 "+model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/mang_cd_4")+"일 입니다.");
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_todt","");
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds","");
										datagrid3.refresh();
										model1.removenode("/root/dataSet");
										return;
									}else{//정상처리
										model1.setValue("/root/resData/gridData3/record["+rowIdx+"]/vaca_dds", model1.getValue("/root/dataSet/CURLIST/record/vaca_dds") );
										datagrid3.refresh();
									}
								}
								model1.removenode("/root/dataSet");
							}
						}
					}
				]]>
			</script>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var rowIdx =datagrid3.row;					
					var colIdx =datagrid3.col;
					if(colIdx == 0){
						var tmp_proc_stat = model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/proc_stat");
						var tmp_occr_dt = model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/occr_dt");
						var tmp_seq = model1.getValue("/root/resData/gridData3/record["+rowIdx+"]/seq");
						if( tmp_proc_stat == "" &&  tmp_occr_dt == "" && tmp_seq == ""){
							rowStatus(datagrid3);
							gridReadOnly_all(rowIdx);
						}else{
							rowStatus(datagrid3);
						}
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
					var col = datagrid3.col;
					var row = datagrid3.row;
					if(col == datagrid3.colRef("del_chk")){//삭제부분
						if(row == datagrid3.fixedRows-1){ //헤더부분 클릭시.
							for(i=datagrid3.fixedRows;i<datagrid3.rows;i++){
								var tmp_proc_stat = datagrid3.valueMatrix(i, datagrid3.colRef("proc_stat") );
								
								var pattern = ","+tmp_proc_stat+",";
								var validation  = (","+model.getValue("/root/initData/hd_vaca_1706_m/dataSet/xx_proc_stat_010")+",").indexOf(pattern)>-1;
								//if (tmp_proc_stat == "" || tmp_proc_stat == "15" || tmp_proc_stat == "25"){    //120203
								if (validation){
									model1.setValue("/root/resData/gridData3/record["+i+"]/del_chk","0");//체크해제.
								}else{
									//삭제sign
									datagrid3.rowStatus(i)=4;
								}
							}
						}else{ //그 이외부분.. 하나씩 선택 할 경우..
							var rowIdx =datagrid3.row;					
							var colIdx =datagrid3.col;
							datagrid3.rowStatus(rowIdx)=4;
						}
						datagrid3.refresh();
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[
					setStatus();
				]]>
			</script>
		</datagrid>
		<button id="button6" class="btn_grid03" style="left:878px; top:105px; width:53px; height:17px; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					datagrid3.addRow();
					gridReadOnly_all(datagrid3.rows-1);
					del_chk_close();
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
