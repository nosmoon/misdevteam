<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>일일출근정보신청(서무)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<hd_duty_1207_m>
							<dataSet>
								<xx_pr_job_clsf_20/>
								<xx_annc_clsf/>
								<xx_proc_stat_010/>
								<xx_dept_cd/>
								<xx_proc_stat_020/>
								<xx_proc_stat_030/>
								<xx_proc_stat_040/>
								<xx_finish_dd_clsf_010/>
								<xx_finish_dd_clsf_020/>
							</dataSet>
						</hd_duty_1207_m>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<!-- 선택계열의 정보를 담당 -->
							<proc_stat>
								<item/>
							</proc_stat>
							<finish_dd_clsf>
								<item/>
							</finish_dd_clsf>
							<dept_cd>
								<item/>
							</dept_cd>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<searchData>
							<emp_no/>
							<clndr_dt/>
							<dept_cd/>
							<dept_cd_nm/>
							<proc_stat>all</proc_stat>
							<duty_dt/>
							<dept_cd/>
							<emp_no_tm/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqForm>
						</reqForm>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<!-- MultiUpDate유형 사용시 처리 -->
						<fwdData>
							<func_nm/>
							<emp_no/>
						</fwdData>
						<submit>
							<multiUpDate/>
							<gubun/>
						</submit>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<msg/>
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<record>
								<!-- datagrid1 -->
								<dept_nm/>
								<emp_no/>
								<nm_korn/>
								<posi_nm/>
								<duty_dt/>
								<hody_nm/>
								<prsnt_tm/>
								<finish_dd_clsf/>
								<finish_tm/>
								<proc_nm/>
								<vaca_nm/>
								<dept_cd/>
								<posi_cd/>
								<proc_stat/>
								<hody_clsf/>
								<vaca/>
								<finish_dd_nm/>
								<addm_rest_minute/>
								<duty_clsf/>
							</record>
							<!-- datagrid2 -->
							<!-- datagrid3 -->
						</gridData>
						<resForm>
							<emp_no/>
							<record>
								<nm_korn/>
							</record>
							<temp/>
							<temp_tm/>
							<emp_no_tm/>
						</resForm>
						<totcnt/>
						<hody_nm/>
						<prsnData>
							<emp_no/>
							<nm_korn/>
							<dept_cd/>
							<dty_cd/>
							<posi_cd/>
							<pgm_id/>
							<pgm_nm/>
							<pgm_url/>
							<job_clsf/>
							<annc_frdt/>
							<annc_todt/>
							<annc_cont/>
							<annc_clsf/>
						</prsnData>
						<prsnDel>
							<emp_no/>
							<pgm_id>HD_DUTY_1300</pgm_id>
						</prsnDel>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
				function noticeSubmit(){
					//공지등록(7/30)
					var emp_no = model1.getValue("/root/resData/resForm/emp_no");
					model1.setValue("/root/resData/resForm/emp_no_tm", emp_no);
					//var emp_no = model1.getValue("/root/reqData/searchData/emp_no_tm");
					model1.send("hd_vaca_1608");
					model1.copyNode("/root/resData/prsnData","/root/dataSet/CURLIST/record");
					model1.refresh();
					model1.removenode("/root/dataSet");
					
					model1.makeNode("/root/resData/prsnData/pgm_id");
					model1.makeNode("/root/resData/prsnData/pgm_nm");
					model1.makeNode("/root/resData/prsnData/pgm_url");
					model1.makeNode("/root/resData/prsnData/job_clsf");
					model1.makeNode("/root/resData/prsnData/annc_frdt");
					model1.makeNode("/root/resData/prsnData/annc_todt");
					model1.makeNode("/root/resData/prsnData/annc_cont");
					model1.makeNode("/root/resData/prsnData/annc_clsf");
					
					//공지시작일자 (현재일자) 구하기
					var now_date = new Date();
					var year = now_date.getYear();
					var month = now_date.getMonth() + 1;
					var day = now_date.getDate();    
					var month_tm = '0' + month;
					var day_tm = '0' + day;  
					if(month_tm.length == 3){
						month_tm = month_tm.substring(1, 3);
					}
					if(day_tm.length == 3){
						day_tm = day_tm.substring(1, 3);
					}
					var now_dt = year + month_tm + day_tm;
					
					//공지종료일자 구하기
					var afr_date = new Date();
					var afr_date1 = new Date(afr_date.getYear(), afr_date.getMonth(), afr_date.getDate()+7 );
					var year1 = afr_date1.getYear();
					var month1 = afr_date1.getMonth() + 1;
					var day1 = afr_date1.getDate();   
					var month_tm1 = '0' + month1;
					var day_tm1 = '0' + day1;  
					if(month_tm1.length == 3){
						month_tm1 = month_tm1.substring(1, 3);
					}
					if(day_tm1.length == 3){
						day_tm1 = day_tm1.substring(1, 3);
					}
					var afr_dt = year1 + month_tm1 + day_tm1;
					
					var annc_frdt = now_dt
					var annc_todt = afr_dt
					
					model1.setValue("/root/resData/prsnData/pgm_id","HD_DUTY_1300");
					model1.setValue("/root/resData/prsnData/pgm_nm","일일출근정보승인");
					model1.setValue("/root/resData/prsnData/pgm_url","/xrw/hd/duty/HD_DUTY_1300.xrw");
					//model1.setValue("/root/resData/prsnData/job_clsf","20");
					model1.setValue("/root/resData/prsnData/job_clsf",model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_pr_job_clsf_20"));
					model1.setValue("/root/resData/prsnData/annc_frdt",annc_frdt);
					model1.setValue("/root/resData/prsnData/annc_todt",annc_todt);
					model1.setValue("/root/resData/prsnData/annc_cont","일근태 결재바랍니다.");
					//model1.setValue("/root/resData/prsnData/annc_clsf","20");
					model1.setValue("/root/resData/prsnData/annc_clsf",model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_annc_clsf"));
					
					model1.send("hd_prsn_2010");
					alert("일근태결재 승인을 요청하였습니다.");
				}	
				function loadData(){
					//model1.send("hd_duty_1100");
					//model1.copyNode("/root/resData/resForm", "/root/tempData");
					//model1.removenode("/root/tempData");
					
					//datagrid1.isReadOnly(1, 1, 1, 11) = true;
					
					//datagrid1.addStatus(1, "insert");	
					model1.setValue("/root/reqData/searchData/clndr_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
					model1.send("hd_duty_1102");
					model1.setValue("/root/resData/hody_nm", model1.getValue("/root/dataSet/hody_clsf"));
					model1.removenode("/root/dataSet");
					model1.setValue("/root/resData/gridData/record[1]/hody_nm", model1.getValue("/root/resData/hody_nm"));
					model1.setValue("/root/resData/gridData/record[1]/duty_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
					
					loadSearch();
					
					model1.refresh();
				}
				function setEmp_no_tm(emp_no){
					model1.setValue("/root/reqData/searchData/emp_no_tm", emp_no);
					model1.send("hd_duty_1206");
					model1.setValue("/root/resData/resForm/emp_no", model1.getValue("/root/dataSet/CURLIST/record/emp_no"));
					model1.setValue("/root/resData/resForm/temp", model1.getValue("/root/dataSet/CURLIST/record/temp"));
					if(model1.getValue("/root/dataSet/CURLIST/record/temp_tm") == "/"){
						model1.setValue("/root/resData/resForm/temp_tm", "");
					}else{
						model1.setValue("/root/resData/resForm/temp_tm", model1.getValue("/root/dataSet/CURLIST/record/temp_tm"));
					}
					//model1.setValue("/root/reqData/searchData/dept_cd", model1.getValue("/root/dataSet/CURLIST/record/dept_cd"));
					model1.removenode("/root/dataSet");
					model1.refresh();
				}
				function setEmp_no(emp_no){
					model1.setValue("/root/reqData/searchData/emp_no", emp_no);
					model.send("hd_duty_1200");
					
					//var nodeList = root.selectNodes("/root/resData/gridData/record");
					//var rowIdx = nodeList.length;
					var rowIdx = datagrid1.row;
					var obj = htmldocument.SessionInfo;
	    	 			setProperty("ss_deptcd"   , obj.deptcd.value);
				//		alert(model1.getValue("/root/tempData/record/dept_cd").substring(0, 2)+" __" +  obj.deptcd.value.substring(0, 2));
	    	 			if(model1.getValue("/root/tempData/record/dept_cd").substring(0, 2) != obj.deptcd.value.substring(0, 2)){
	    	 				alert("다른 부서사원은 등록 하실 수 없습니다.");
					    	for(var i = 1; i < 5; 
							i++){
					    		datagrid1.valueMatrix(rowIdx, i) = "";
					    	}
					    	for(var j = 1; 6 + j < datagrid1.cols - 1; j++){
					    		datagrid1.valueMatrix(rowIdx, 6 + j) = "";
					    	}
	    	 				return;
	    	 			}else{
						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/emp_no", model1.getValue("/root/tempData/record/emp_no"));
						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/nm_korn", model1.getValue("/root/tempData/record/nm_korn"));
						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_cd", model1.getValue("/root/tempData/record/dept_cd"));
						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_nm", model1.getValue("/root/tempData/record/dept_nm"));
						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_cd", model1.getValue("/root/tempData/record/posi_cd"));
						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_nm", model1.getValue("/root/tempData/record/posi_nm"));
	    	 			}

					model1.refresh();
				}
				function setDept_cd(dept_cd, dept_nm){
					model1.setValue("/root/reqData/searchData/dept_cd", dept_cd);
					model1.setValue("/root/reqData/searchData/dept_nm", dept_nm);
					clam_dept_cd.refresh();
					clam_dept_cd_nm.refresh();
				}
				function loadSearch(){
					model1.send("hd_duty_1203");
					model1.copyNode("/root/resData/gridData", "/root/dataSet/CURLIST");
					model1.removenode("/root/dataSet/CURLIST");
					var proc_stat = model1.getValue("/root/reqData/searchData/proc_stat");
					//if(proc_stat == "not"){
						model1.setValue("/root/reqData/searchData/clndr_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
						model1.send("hd_duty_1102");
						model1.setValue("/root/resData/hody_nm", model1.getValue("/root/dataSet/hody_clsf"));
						model1.removenode("/root/dataSet");
						
						//var nodeList = root.selectNodes("/root/resData/gridData/record");
						//var rowIdx = nodeList.length;
					var rowIdx = datagrid1.rows -1;
					for(var i=1; i<rowIdx + 1; i++){
						model1.setValue("/root/resData/gridData/record[" + (i) + "]/hody_nm", model1.getValue("/root/resData/hody_nm"));
						model1.setValue("/root/resData/gridData/record[" + (i) + "]/duty_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
					
					}
					//}
					var dept_nm = model1.getValue("/root/resData/gridData/record[1]/dept_nm");
					if(dept_nm != ""){
						datagrid1.isReadOnly(1, 1, 1, 11) = false;
					}
					model1.removenode("/root/totalcnt");
					datagrid1.refresh();
				}
				function setEmp_no_pop(emp_no ,nm_korn ,dept_cd , dept_nm , dty_cd , dty_nm , posi_cd, posi_nm){
					
					var row = datagrid1.row;
					var obj = htmldocument.SessionInfo;
	    	 			setProperty("ss_deptcd"   , obj.deptcd.value);
	    	 			if(dept_cd.substring(0, 2) != obj.deptcd.value.substring(0, 2)){
	    	 				alert("다른 부서사원은 등록 하실 수 없습니다.");
					    	for(var i = 1; i < 5; i++){
					    		datagrid1.valueMatrix(row, i) = "";
					    	}
					    	for(var j = 1; 6 + j < datagrid1.cols - 1; j++){
					    		datagrid1.valueMatrix(row, 6 + j) = "";
					    	}
	    	 				return;
	    	 			}else{
						model1.setValue("/root/resData/gridData/record[" + (row) + "]/emp_no", emp_no);
						model1.setValue("/root/resData/gridData/record[" + (row) + "]/nm_korn", nm_korn);
						model1.setValue("/root/resData/gridData/record[" + (row) + "]/dept_cd", dept_cd);
						model1.setValue("/root/resData/gridData/record[" + (row) + "]/dept_nm", dept_nm);
						model1.setValue("/root/resData/gridData/record[" + (row) + "]/posi_cd", posi_cd);
						model1.setValue("/root/resData/gridData/record[" + (row) + "]/posi_nm", posi_nm);
	    	 			}

					model1.refresh();
				}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				//초기화
				model.send("hd_duty_1207_m");
				/*
				alert(model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_pr_job_clsf_20"));
				alert(model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_annc_clsf"));
				alert(model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_proc_stat_010"));
				alert(model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_dept_cd"));
				alert(model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_proc_stat_020"));
				alert(model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_proc_stat_030"));
				alert(model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_proc_stat_040"));
				alert(model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_finish_dd_clsf_010"));
				alert(model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_finish_dd_clsf_020"));
				*/
				model.refresh();
				if(model.getValue("/root/initData/pageInfo/pageID") == ""){
					maintitle.text = "일일출근정보신청(서무)";
					iv_Title.visible = false;  // 숨김
					iv_PopTitle.visible = true;  // 보임
				}else if(model.getValue("/root/initData/pageInfo/pageID") != ""){
					iv_Title.visible = true;  // 보임
					iv_PopTitle.visible = false;  // 숨김
				}
				
				model1.send("hd_co_1000");
				model1.copyNode("/root/initData/comboSet/dept_cd", "/root/dataSet/dept_cd");
				model1.removenode("/root/dataSet");
				model1.send("hd_duty_1202");
				model1.copyNode("/root/initData/comboSet/proc_stat", "/root/dataSet/proc_stat");
				model1.copyNode("/root/initData/comboSet/finish_dd_clsf", "/root/dataSet/finish_dd_clsf");
				model1.removenode("/root/dataSet");
				
				//model1.send("hd_duty_1100");
				//model1.copyNode("/root/resData/resForm", "/root/tempData");
				//model1.removenode("/root/tempData");
				//model1.removenode("/root/totalcnt");
				
				var now_date = new Date();
				var year = now_date.getYear();
				var month = now_date.getMonth() + 1;
				var day = now_date.getDate();    
				var month_tm = '0' + month;
				var day_tm = '0' + day;  
				if(month_tm.length == 3){
					month_tm = month_tm.substring(1, 3);
				}
				if(day_tm.length == 3){
					day_tm = day_tm.substring(1, 3);
				}
				var now_dt = year + month_tm + day_tm;
				model1.setValue("/root/reqData/searchData/duty_dt", now_dt);
				model1.makeNode("/root/reqData/temp_dt");
				model1.setValue("/root/reqData/temp_dt", now_dt);
				
				 // model1.send("hd_duty_1205");
				var obj = htmldocument.SessionInfo;
				if(obj.cmpycd.value == "100")  // 조선일보일 경우 통합결재라인을 탈수 있도록 수정2018.07.22수정 이가연 
				{
					model1.send("hd_com_5004");
				}
				else 
				{
					model1.send("hd_duty_1114");
				}
				//model1.send("hd_co_1002");
				model1.setValue("/root/resData/resForm/emp_no", model1.getValue("/root/dataSet/CURLIST1/record/emp_no"));
				model1.setValue("/root/resData/resForm/temp", model1.getValue("/root/dataSet/CURLIST1/record/nm_korn"));
				if(model1.getValue("/root/dataSet/CURLIST1/record/posi_nm") != "" || model1.getValue("/root/dataSet/CURLIST1/record/dty_nm") != ""){
					model1.setValue("/root/resData/resForm/temp_tm", model1.getValue("/root/dataSet/CURLIST1/record/dty_nm")+"/"+model1.getValue("/root/dataSet/CURLIST1/record/posi_nm"));
				}else if(model1.getValue("/root/dataSet/CURLIST1/record/dty_nm") == "" && model1.getValue("/root/dataSet/CURLIST1/record/posi_nm") == ""){
					model1.setValue("/root/resData/resForm/temp_tm", "");
				}
				model1.setValue("/root/reqData/searchData/dept_cd", model1.getValue("/root/dataSet/CURLIST2/record/dept_cd"));
				model1.removenode("/root/dataSet");
				
					/* ----------------------------------------- */
				model1.setValue("/root/reqData/searchData/clndr_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
				model1.send("hd_duty_1102");
				model1.setValue("/root/resData/hody_nm", model1.getValue("/root/dataSet/hody_clsf"));
				model1.removenode("/root/dataSet");
				model1.setValue("/root/resData/gridData/record[1]/hody_nm", model1.getValue("/root/resData/hody_nm"));
				model1.setValue("/root/resData/gridData/record[1]/duty_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
				
				loadSearch();
					
				var nodeList = root.selectNodes("/root/resData/gridData/record");
				var rowIdx = nodeList.length;
				for(var i=1; i<rowIdx + 1; i++){
					var proc_stat = model1.getValue("/root/resData/gridData/record[" + (i) + "]/proc_stat");
					var duty_dt = model1.getValue("/root/resData/gridData/record[" + (i) + "]/duty_dt");
					var nm_korn = model1.getValue("/root/resData/gridData/record[" + (i) + "]/nm_korn");
					//if(proc_stat == "14" || proc_stat == "13" || proc_stat == "29") {
					datagrid1.isReadOnly(i, 1, i, 11) = false;
					//if(proc_stat == "14" || proc_stat == "29" || proc_stat == "25") { //120130
					var pattern = ","+proc_stat+",";
					var validation  = (","+model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_proc_stat_010")+",").indexOf(pattern)>-1;
					
					if(validation) {
						datagrid1.isReadOnly(i, 1, i, 11) = true;
					}else{
						datagrid1.isReadOnly(i, 1, i, 5) = true;
					}
					var vaca_nm = model1.getValue("/root/resData/gridData/record[" + (i) + "]/vaca_nm");
					if(vaca_nm != ""){
						datagrid1.isReadOnly(i, 1, i, 11) = true;
					}else{
						//datagrid1.isReadOnly(i, 6, i, 11) = false;
						datagrid1.isReadOnly(i, 1, i, 5) = true;
					}
					var duty_clsf = model1.getValue("/root/resData/gridData/record[" + (i) + "]/duty_clsf"); // 2018.08.10 추가 : 근무구분(출장:10) 일경우 근태구분 앞부분을 수정 안되게 처리함 
					if(duty_clsf == "10"){
						datagrid1.isReadOnly(i, 1, i, 10) = true;
					}
					//datagrid1.isReadOnly(i, 8, i, 8) = true;
				}
				datagrid1.clearStatus();
				
				//datagrid1.isReadOnly(1, 1, 1, 11) = true;
				/*datagrid1.addStatus(1, "insert");	
				model1.setValue("/root/reqData/searchData/clndr_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
				model1.send("hd_duty_1102");
				model1.setValue("/root/resData/hody_nm", model1.getValue("/root/dataSet/hody_clsf"));
				model1.removenode("/root/dataSet");
				model1.setValue("/root/resData/gridData/record[1]/hody_nm", model1.getValue("/root/resData/hody_nm"));
				model1.setValue("/root/resData/gridData/record[1]/duty_dt", model1.getValue("/root/reqData/searchData/duty_dt"));*/
					/* ----------------------------------------- */
			
				var obj = htmldocument.SessionInfo;
    	 			setProperty("ss_deptcd"   , obj.deptcd.value);
    	 			//if(obj.deptcd.value.substring(0, 2) == "25"){
			    if(obj.cmpycd.value != "100") // 2018.06.25 조선일보가 아닐경우 추가휴게시간항목을 보이지 않도록 함 
				{ 
					datagrid1.colHidden(datagrid1.colRef("addm_rest_minute")) = true; 
					datagrid1.colHidden(datagrid1.colRef("duty_clsf")) = true; 
				}
				if(obj.deptcd.value.substring(0, 2) == model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_dept_cd")){
					input1.visible = false;
				}
				model1.refresh();
				var totcnt = datagrid1.rows;
				model1.setValue("/root/resData/totcnt", "총 " + Number(totcnt - 1) + " 건");
				model1.refresh();
				]]>
			</script>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<submission id="hd_duty_1100" action="/hd/duty/1100" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_duty_1200" action="/hd/duty/1200" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_duty_1102" action="/hd/duty/1102" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/clndr_dt" resultref="/root/tempData"/>
			<submission id="hd_duty_1201" action="/hd/duty/1201" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/submit" resultref="/root/tempData"/>
			<submission id="hd_duty_1202" action="/hd/duty/1202" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/dataSet"/>
			<submission id="hd_duty_1203" action="/hd/duty/1203" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/dataSet"/>
			<submission id="hd_co_1000" action="/hd/co/1000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_duty_1209" action="/hd/duty/1209" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_com_5004" action="/hd/com/5004" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_duty_1114" action="/hd/duty/1114" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_duty_1205" action="/hd/duty/1205" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_duty_1206" action="/hd/duty/1206" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_duty_1107" action="/hd/duty/1107" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_co_1002" action="/hd/co/1002" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_vaca_1608" action="/hd/vaca/1608" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm/emp_no_tm" resultref="/root/tempData"/>
			<submission id="hd_prsn_2010" action="/hd/prsn/2010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/prsnData" resultref="/root/tempData"/>
			<submission id="hd_com_2100" action="/hd/com/2100" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/prsnDel" resultref="/root/tempData"/>
			<submission id="hd_duty_1207_m" action="/hd/duty/1207" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/hd_duty_1207_m/dataSet"/>
		</model>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="2,56;2,71;2,80;2,80;2,691;1,936;1,926;1,926;" style="font-family:굴림; background-image:../../images/bg_946.gif; ">
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<import id="iv_PopTitle" src="../../../common/xrw/iv_PopTitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:50px; width:926px; height:26px; ">
			<button id="btnA2" class="btn02" style="left:544px; top:2px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model1.reset();
					//datagrid1.rowStatus(1) = 0;
					datagrid1.clearStatus();
					/*datagrid1.addStatus(1, "insert");	
					model1.setValue("/root/resData/gridData/record[1]/dept_cd", "");
					model1.setValue("/root/resData/gridData/record[1]/dept_nm", "");
					model1.setValue("/root/resData/gridData/record[1]/emp_no", "");
					model1.setValue("/root/resData/gridData/record[1]/nm_korn", "");
					model1.setValue("/root/resData/gridData/record[1]/posi_cd", "");
					model1.setValue("/root/resData/gridData/record[1]/posi_nm", "");
					//model1.setValue("/root/resData/gridData/record[1]/duty_dt", "");
					//model1.setValue("/root/resData/gridData/record[1]/hody_clsf", "");
					model1.setValue("/root/resData/gridData/record[1]/prsnt_tm", "");
					model1.setValue("/root/resData/gridData/record[1]/finish_dd_clsf", "");
					model1.setValue("/root/resData/gridData/record[1]/finish_tm", "");
					datagrid1.isReadOnly(1, 1, 1, 11) = false;*/
					]]>
				</script>
			</button>
			<button id="button4" class="btn02" style="left:874px; top:2px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if(model.getValue("/root/initData/pageInfo/pageID") != ""){
					 	viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					}else{
						window.close();
					}
					]]>
				</script>
			</button>
			<button id="button1" class="btn02" style="left:599px; top:2px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var duty_dt = model1.getValue("/root/reqData/searchData/duty_dt");
					var dept_cd = model1.getValue("/root/reqData/searchData/dept_cd");
					if(duty_dt == ""){
						alert("근무일을 입력해 주세요.");
						return;
					}
					if(duty_dt.length != 8){
						alert("근무일을 정확히 입력해주세요.");
						return;
					}
					//if(dept_cd == ""){
					//	alert("부서를 선택해 주세요.");
					//	return;
					//}
					loadSearch();
					
					var nodeList = root.selectNodes("/root/resData/gridData/record");
					var rowIdx = nodeList.length;
					for(var i=1; i<rowIdx + 1; i++){
						var proc_stat = model1.getValue("/root/resData/gridData/record[" + (i) + "]/proc_stat");
						var duty_dt = model1.getValue("/root/resData/gridData/record[" + (i) + "]/duty_dt");
						var nm_korn = model1.getValue("/root/resData/gridData/record[" + (i) + "]/nm_korn");
						//if(proc_stat == "14" || proc_stat == "13" || proc_stat == "29") {
						datagrid1.isReadOnly(i, 1, i, 11) = false;
						//if(proc_stat == "14" || proc_stat == "29" || proc_stat == "25") {
						var pattern = ","+proc_stat+",";
						var validation  = (","+model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_proc_stat_010")+",").indexOf(pattern)>-1;
						if(validation) {
							datagrid1.isReadOnly(i, 1, i, 11) = true;
						}else{
							datagrid1.isReadOnly(i, 1, i, 5) = true;
						}
						var vaca_nm = model1.getValue("/root/resData/gridData/record[" + (i) + "]/vaca_nm");
						if(vaca_nm != ""){
							datagrid1.isReadOnly(i, 1, i, 11) = true;
						}else{
							//datagrid1.isReadOnly(i, 6, i, 11) = false;
							datagrid1.isReadOnly(i, 1, i, 5) = true;
						}
						var duty_clsf = model1.getValue("/root/resData/gridData/record[" + (i) + "]/duty_clsf");// 2018.08.10 추가 : 근무구분(출장:10) 일경우 근태구분 앞부분을 수정 안되게 처리함 
						if(duty_clsf == "10"){
							datagrid1.isReadOnly(i, 1, i, 10) = true;
						}
						
						//datagrid1.isReadOnly(i, 8, i, 8) = true;
					}
					datagrid1.clearStatus();
					
					model1.refresh();
					var totcnt = datagrid1.rows;
					model1.setValue("/root/resData/totcnt", "총 " + Number(totcnt - 1) + " 건");
					model1.refresh();
					]]>
				</script>
			</button>
			<caption id="caption1" class="list_cap01" style="left:0px; top:0px; width:90px; height:26px; text-align:center; ">결재자</caption>
			<caption id="caption2" class="list_cap02" style="left:89px; top:0px; width:336px; height:26px; text-align:center; "/>
			<caption id="caption7" class="list_cap01" style="left:195px; top:0px; width:90px; height:26px; text-align:center; ">직책/직급</caption>
			<output id="output2" ref="/root/resData/resForm/temp_tm" style="left:288px; top:4px; width:132px; height:18px; "/>
			<output id="output1" ref="/root/resData/resForm/temp" style="left:92px; top:4px; width:82px; height:18px; "/>
			<input id="input1" inputtype="button" style="left:174px; top:4px; width:18px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setEmp_no_tm");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
			</input>
			<button id="button3" class="btn02" style="left:764px; top:2px; width:52px; height:21px; ">
				<caption>결재신청</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if(model1.getValue("/root/resData/gridData/record[1]/emp_no") == ""){
						alert("입력할 자료가 없거나 모든 자료를 입력해주세요.");
						return;
					}
					if(model1.getValue("/root/resData/resForm/temp") == ""){
						alert("결재자를 선택해주세요.");
						return;
					}
					if (window.alert("결재신청 하시겠습니까?", "확인", 1) != 1) {
						return;
					}
					var nodeList = root.selectNodes("/root/resData/gridData/record");
					var rowIdx = nodeList.length;
					for(var i=1; i<rowIdx + 1; i++){
						var proc_stat = model1.getValue("/root/resData/gridData/record[" + (i) + "]/proc_stat");
						var duty_dt = model1.getValue("/root/resData/gridData/record[" + (i) + "]/duty_dt");
						/*if(proc_stat == "14"){
							alert(duty_dt + "날짜의 자료는 현업결재된 자료입니다. 현업결재된 자료는 수정 및 삭제가 불가능합니다.");
							return;
						}*/
						/*var finish = model1.getValue("/root/resData/gridData/record[" + (i) + "]/finish_tm");
						if(('0900' < finish) && (finish != "")){
							if(model1.getValue("/root/resData/gridData/record[" + (i) + "]/prsnt_tm") > model1.getValue("/root/resData/gridData/record[" + (i) + "]/finish_tm")){
								alert("출퇴근 시간을 확인해 주세요.");
								return;
							}
						}*/
						//if(datagrid1.rowStatus(i) != "0"){
						//if(proc_stat == "01" || proc_stat == "00" || datagrid1.rowStatus(i) == 2){
						if(proc_stat == model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_proc_stat_030") || proc_stat == model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_proc_stat_020") || datagrid1.rowStatus(i) == 2){
							var nm_korn = model1.getValue("/root/resData/gridData/record[" + (i) + "]/nm_korn");
							var prsnt_tm = model1.getValue("/root/resData/gridData/record[" + (i) + "]/prsnt_tm");
							var finish_dd_clsf = model1.getValue("/root/resData/gridData/record[" + (i) + "]/finish_dd_clsf");
							var finish_tm = model1.getValue("/root/resData/gridData/record[" + (i) + "]/finish_tm");
							if(model1.getValue("/root/resData/gridData/record[" + (i) + "]/prsnt_tm").length != 4){
								alert("출근 시간을 확인해 주세요.");
								return;
							}
							if(model1.getValue("/root/resData/gridData/record[" + (i) + "]/finish_tm").length != 4){
								alert("퇴근 시간을 확인해 주세요.");
								return;
							}
							if(prsnt_tm != "" || finish_tm != ""){
								if(prsnt_tm == "" && finish_tm == ""){
									alert("모든항목을 입력해주세요.");
									datagrid1.clearStatus();
									return;
								}
							}
							var proc_stat_tm = model1.getValue("/root/resData/gridData/record[" + (i) + "]/proc_stat");
							//if(proc_stat_tm == "14" || proc_stat_tm == "13" || proc_stat_tm == "29") {
							var pattern = ","+proc_stat_tm+",";
							var validation  = (","+model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_proc_stat_040")+",").indexOf(pattern)>-1;
 
							if(validation) {
								alert(nm_korn + " 님의 " + duty_dt + " 날짜의 자료는 현업결재된 자료입니다. 현업결재된 자료는 수정 및 삭제가 불가능합니다. 작업은 계속 진행 됩니다.");
							}
							//if(proc_stat_tm == ""){
							//	datagrid1.rowStatus(i) = 1;
							//}
							/*if(proc_stat_tm == "01" || proc_stat_tm == ""
							// || proc_stat_tm == "10"
							){
								if(datagrid1.rowStatus(i) != "4"){
									//datagrid1.rowStatus(i) = 2;*/
									datagrid1.rowStatus(i) = 3;
								/*}else{
									datagrid1.rowStatus(i) = 4;
								}
							}*/
						}
					}
					if (!rowInSubmit(datagrid1)) {
						return;
					}
					//model1.setValue("/root/reqData/submit/gubun", "1");
					var gubun_tm = "1" + model1.getValue("/root/resData/resForm/emp_no");
					model1.setValue("/root/reqData/submit/gubun", gubun_tm); // 결재자를 구분에 넣어줌
					model1.setValue("/root/reqData/submit/multiUpDate", datagrid1.getUpdateData());
					model1.send("hd_duty_1201");
					if(submit_completed()) {
						//datagrid1.rowStatus(1) = 0;
						datagrid1.clearStatus();
						noticeSubmit();
						
						//model1.makeNode("/root/reqData/fwdData/annc_clsf"); // 일반, 승인의 구분을 위해 넘김
						//model1.setValue("/root/reqData/fwdData/annc_clsf", "20");
						/*model1.makeNode("/root/reqData/fwdData/emp_no"); // 결재자를 넘김
						model1.setValue("/root/reqData/fwdData/emp_no", model1.getValue("/root/resData/resForm/emp_no"));
						model1.makeNode("/root/reqData/fwdData/pgm_id"); // 링크된 페이지
						model1.setValue("/root/reqData/fwdData/pgm_id", "HD_DUTY_1300");
						window.load("/xrw/hd/prsn/HD_PRSN_2000.xrw","modal","HD_PRSN_2000","left:0; top:0; width:953px; height:760px; ","/root/reqData/fwdData","/root/reqData/fwdData");*/
						//window.load("/xrw/hd/prsn/HD_PRSN_2000.xrw","mdichild", "hd_prsn_2000", "width:953px; height:760px;  align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						
						loadData();
					}
					]]>
				</script>
			</button>
			<button id="button2" class="btn02" style="left:654px; top:2px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if (!rowDelSubmit(datagrid1)) {
						return;
					}
					var nodeList = root.selectNodes("/root/resData/gridData/record");
					var rowIdx = nodeList.length;
					for(var i=1; i<rowIdx + 1; i++){
						var proc_stat = model1.getValue("/root/resData/gridData/record[" + (i) + "]/proc_stat");
//						var duty_dt = model1.getValue("/root/resData/gridData/record[" + (i) + "]/duty_dt");
						var nm_korn = model1.getValue("/root/resData/gridData/record[" + (i) + "]/nm_korn");
						if(datagrid1.rowStatus(i) != "0"){
							var proc_stat_tm = model1.getValue("/root/resData/gridData/record[" + (i) + "]/proc_stat");
							//if(proc_stat_tm == "14" || proc_stat_tm == "13" || proc_stat_tm == "29") {
							
							
							//if(proc_stat_tm == "14" || proc_stat_tm == "29" || proc_stat_tm == "25") {  // 120130
								
							var pattern = ","+proc_stat_tm+",";
							var validation  = (","+model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_proc_stat_010")+",").indexOf(pattern)>-1;

							if(validation) {
								alert(nm_korn + " 님의 " + duty_dt + " 날짜의 자료는 현업결재된 자료입니다. 현업결재된 자료는 수정 및 삭제가 불가능합니다. 작업은 계속 진행 됩니다.");
								datagrid1.rowStatus(i) = "0";
							}
						}
					}
					if (window.alert("삭제하시겠습니까?", "확인", 1) != 1) {
						return;
					}
					model1.setValue("/root/reqData/submit/multiUpDate", datagrid1.getUpdateData());
					model1.send("hd_duty_1201");
					if(submit_completed()) {
						//datagrid1.rowStatus(1) = 0;
						datagrid1.clearStatus();
						
						//model1.makeNode("/root/reqData/fwdData/annc_clsf"); // 일반, 승인의 구분을 위해 넘김
						//model1.setValue("/root/reqData/fwdData/annc_clsf", "20");
						//model1.makeNode("/root/reqData/fwdData/emp_no"); // 결재자를 넘김
						//model1.setValue("/root/reqData/fwdData/emp_no", model1.getValue("/root/resData/resForm/emp_no"));
						//model1.makeNode("/root/reqData/fwdData/pgm_id"); // 링크된 페이지
						//model1.setValue("/root/reqData/fwdData/pgm_id", "HD_DUTY_1300");
						//window.load("/xrw/hd/prsn/HD_PRSN_2000.xrw","mdichild","HD_PRSN_2000","left:0; top:0; width:953px; height:760px; ","/root/reqData/fwdData","/root/reqData/fwdData");
						//window.load("/xrw/hd/prsn/HD_PRSN_2000.xrw","mdichild", "hd_prsn_2000", "width:953px; height:760px;  align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						
						//model1.reset();
						
						var emp_no = model1.getValue("/root/resData/resForm/emp_no");
						model1.setValue("/root/resData/prsnDel/emp_no", emp_no);
						model1.send("hd_com_2100");
						
						loadData();
					}
					]]>
				</script>
			</button>
			<button id="button5" class="btn02" style="left:709px; top:2px; width:52px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if(model1.getValue("/root/resData/gridData/record[1]/emp_no") == ""){
						alert("입력할 자료가 없거나 모든 자료를 입력해주세요.");
						return;
					}
					if(model1.getValue("/root/resData/resForm/temp") == ""){
						alert("결재자를 선택해주세요.");
						return;
					}
					if (window.alert("저장 하시겠습니까?", "확인", 1) != 1) {
						return;
					}
					var nodeList = root.selectNodes("/root/resData/gridData/record");
					var rowIdx = nodeList.length;
					for(var i=1; i<rowIdx + 1; i++){
						var proc_stat = model1.getValue("/root/resData/gridData/record[" + (i) + "]/proc_stat");
						var duty_dt = model1.getValue("/root/resData/gridData/record[" + (i) + "]/duty_dt");
						/*if(proc_stat == "14"){
							alert(duty_dt + "날짜의 자료는 현업결재된 자료입니다. 현업결재된 자료는 수정 및 삭제가 불가능합니다.");
							return;
						}*/
						/*var finish = model1.getValue("/root/resData/gridData/record[" + (i) + "]/finish_tm");
						if(('0900' < finish) && (finish != "")){
							if(model1.getValue("/root/resData/gridData/record[" + (i) + "]/prsnt_tm") > model1.getValue("/root/resData/gridData/record[" + (i) + "]/finish_tm")){
								alert("출퇴근 시간을 확인해 주세요.");
								return;
							}
						}*/
						//if(datagrid1.rowStatus(i) != "0"){
						if(datagrid1.rowStatus(i) == 2){
							if(model1.getValue("/root/resData/gridData/record[" + (i) + "]/prsnt_tm") == "" ||
							model1.getValue("/root/resData/gridData/record[" + (i) + "]/finish_tm") == ""){
								model1.setValue("/root/resData/gridData/record[" + (i) + "]/prsnt_tm", "");
								model1.setValue("/root/resData/gridData/record[" + (i) + "]/finish_tm", "");
								model1.setValue("/root/resData/gridData/record[" + (i) + "]/finish_dd_clsf", "");
								datagrid1.rowStatus(i) = 0;
							}
						}
						//if(proc_stat == "01" || datagrid1.rowStatus(i) == 2){
						if(proc_stat == model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_proc_stat_030") || datagrid1.rowStatus(i) == 2){
							var nm_korn = model1.getValue("/root/resData/gridData/record[" + (i) + "]/nm_korn");
							var prsnt_tm = model1.getValue("/root/resData/gridData/record[" + (i) + "]/prsnt_tm");
							var finish_dd_clsf = model1.getValue("/root/resData/gridData/record[" + (i) + "]/finish_dd_clsf");
							var finish_tm = model1.getValue("/root/resData/gridData/record[" + (i) + "]/finish_tm");
							if(model1.getValue("/root/resData/gridData/record[" + (i) + "]/prsnt_tm").length != 4){
								alert("출근 시간을 확인해 주세요.");
								return;
							}
							if(model1.getValue("/root/resData/gridData/record[" + (i) + "]/finish_tm").length != 4){
								alert("퇴근 시간을 확인해 주세요.");
								return;
							}
							if(prsnt_tm != "" || finish_tm != ""){
								if(prsnt_tm == "" && finish_tm == ""){
									alert("모든항목을 입력해주세요.");
									datagrid1.clearStatus();
									return;
								}
							}
							var proc_stat_tm = model1.getValue("/root/resData/gridData/record[" + (i) + "]/proc_stat");
							//if(proc_stat_tm == "14" || proc_stat_tm == "13" || proc_stat_tm == "29") {
							
							var pattern = ","+proc_stat_tm+",";
							var validation  = (","+model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_proc_stat_010")+",").indexOf(pattern)>-1;
							var validation2  = (","+model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_proc_stat_010")+",").indexOf(pattern)==-1;
							//if(proc_stat_tm == "14" || proc_stat_tm == "29" || proc_stat_tm == "25") {
							if(validation) {
								alert(nm_korn + " 님의 " + duty_dt + " 날짜의 자료는 현업결재된 자료입니다. 현업결재된 자료는 수정 및 삭제가 불가능합니다. 작업은 계속 진행 됩니다.");
							}
							//if(proc_stat_tm == ""){
							//	datagrid1.rowStatus(i) = 1;
							//}
							/*if(proc_stat_tm == "01" || proc_stat_tm == ""
							// || proc_stat_tm == "10"
							){
								if(datagrid1.rowStatus(i) != "4"){
									//datagrid1.rowStatus(i) = 2;*/
									//if(proc_stat_tm != "14" && proc_stat_tm != "29" && proc_stat_tm != "25") {  //120130
									if(validation2) {
										datagrid1.rowStatus(i) = 3;
									//}else if(proc_stat_tm == "14" || proc_stat_tm == "29" || proc_stat_tm == "25") { //120130
									}else if(validation) {
										datagrid1.rowStatus(i) = 0;
									}
								/*}else{
									datagrid1.rowStatus(i) = 4;
								}
							}*/
						}
					}
					if (!rowInSubmit(datagrid1)) {
						return;
					}
					//model1.setValue("/root/reqData/submit/gubun", "2");
					var gubun_tm = "2" + model1.getValue("/root/resData/resForm/emp_no");
					model1.setValue("/root/reqData/submit/gubun", gubun_tm); // 결재자를 구분에 넣어줌
					model1.setValue("/root/reqData/submit/multiUpDate", datagrid1.getUpdateData());
					model1.send("hd_duty_1201");
					if(submit_completed()) {
						//datagrid1.rowStatus(1) = 0;
						datagrid1.clearStatus();
						
						//model1.makeNode("/root/reqData/fwdData/annc_clsf"); // 일반, 승인의 구분을 위해 넘김
						//model1.setValue("/root/reqData/fwdData/annc_clsf", "20");
						//model1.makeNode("/root/reqData/fwdData/emp_no"); // 결재자를 넘김
						//model1.setValue("/root/reqData/fwdData/emp_no", model1.getValue("/root/resData/resForm/emp_no"));
						//model1.makeNode("/root/reqData/fwdData/pgm_id"); // 링크된 페이지
						//model1.setValue("/root/reqData/fwdData/pgm_id", "HD_DUTY_1300");
						//window.load("/xrw/hd/prsn/HD_PRSN_2000.xrw","mdichild","HD_PRSN_2000","left:0; top:0; width:953px; height:760px; ","/root/reqData/fwdData","/root/reqData/fwdData");
						//window.load("/xrw/hd/prsn/HD_PRSN_2000.xrw","mdichild", "hd_prsn_2000", "width:953px; height:760px;  align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						
						//model1.reset();
						loadData();
					}
					]]>
				</script>
			</button>
			<button id="button7" class="btn02" style="left:819px; top:2px; width:52px; height:21px; ">
				<caption>출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						resetOznode();											//오즈node 초기화
						makeNodeValue("/root/oz_data/ozrName","hd/SP_HD_DUTY_1303_P");	//odi 파일경로('/' root경로 제외)
						makeNodeValue("/root/oz_data/preview","preview"); 			//preview : 미리보기, print : 인쇄
						makeNodeValue("/root/oz_data/printsize",""); 				//페이지용지설정(기본 A4)
						
						//Parameter setting
						makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , getProperty("ss_cmpycd") );			
						makeNodeValue("/root/oz_data/odiParam/iv_dept_cd",model1.getValue("/root/reqData/searchData/dept_cd"));	
						makeNodeValue("/root/oz_data/odiParam/iv_duty_dt",model1.getValue("/root/reqData/searchData/duty_dt"));	
						//makeNodeValue("/root/oz_data/odiParam/iv_dept_cd",getProperty("ss_deptcd"));	
						
						openOzwin("/root/oz_data");
					]]>
				</script>
			</button>
		</group>
		<!--<group id="group1" style="left:10px; top:80px; width:926px; height:30px; ">
			<caption id="caption2" class="list_cap01" style="left:0px; top:0px; width:90px; height:26px; text-align:center; ">신청자</caption>
			<caption id="caption10" class="list_cap02" style="left:89px; top:0px; width:303px; height:26px; text-align:center; "/>
			<caption id="caption1" class="list_cap01" style="left:195px; top:0px; width:90px; height:26px; text-align:center; ">부서장</caption>
			<output id="input1" ref="/root/resData/resForm/emp_no" style="left:92px; top:4px; width:100px; height:18px; "/>
			<output id="input2" ref="/root/resData/resForm/record/nm_korn" style="left:288px; top:4px; width:100px; height:18px; "/>
		</group>-->
		<group id="group2" style="left:10px; top:131px; width:926px; height:570px; ">
			<caption id="caption9" class="tit02" style="left:0px; top:0px; width:205px; height:20px; font-weight:bold; ">일일 출퇴근 신청</caption>
			<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" caption="부서^사번^성명^대표직급^근무일^휴일구분^출근시각^퇴근시각^퇴근일구분^추가휴게시간^근태구분^진행상태^휴가구분" colsep="#" colwidth="120, 80, 80, 70, 80, 60, 70, 70, 70, 85, 80, 80, 80, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:0px; top:25px; width:926px; height:545px; ">
				<col class="req" ref="dept_nm" caption="부서" style="text-align:left; "/>
				<col class="req" imemode="hangul" ref="emp_no" type="inputbutton" maxlength="6" caption="사번">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						]]>
					</script>
				</col>
				<col class="req" imemode="hangul" ref="nm_korn" type="input" caption="성명"/>
				<col class="req" ref="posi_nm" caption="직급"/>
				<!--<col class="req" ref="duty_dt" type="inputdate" caption="근무일"/>-->
				<col class="req" ref="duty_dt" format="yyyy-mm-dd" caption="근무일"/>
				<col class="req" ref="hody_nm" caption="휴일구분"/>
				<col class="req" ref="prsnt_tm" type="input" format="hh:nn" caption="출근시간"/>
				<col class="req" ref="finish_tm" type="input" format="hh:nn" caption="퇴근시간"/>
				<!--<col class="req" ref="finish_dd_nm" caption="퇴근일구분"/>-->
				<col class="req" ref="finish_dd_clsf" type="combo" caption="퇴근일구분" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/finish_dd_clsf/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="addm_rest_minute" type="input" format="hh:nn" caption="추가휴게시간"/>
				<col class="req" ref="duty_clsf" type="combo" caption="근태구분" style="text-align:left; ">
					<choices>
						<item>
							<label/>
							<value>00</value>
						</item>
						<item>
							<label>출장</label>
							<value>10</value>
						</item>
					</choices>
				</col>
				<col class="req" ref="proc_nm" caption="진행상태"/>
				<col class="req" ref="vaca_nm" caption="휴가구분"/>
				<col class="req" ref="dept_cd" visibility="hidden" caption="부서코드"/>
				<col class="req" ref="posi_cd" visibility="hidden" caption="직급코드"/>
				<!--<col class="req" ref="finish_dd_clsf" visibility="hidden" caption="퇴근일구분"/>-->
				<col class="req" ref="proc_stat" visibility="hidden" caption="진행상태"/>
				<col class="req" ref="hody_clsf" visibility="hidden" caption="휴일구분"/>
				<col class="req" ref="vaca" visibility="hidden" caption="휴가구분"/>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var row = datagrid1.row;
					var col = datagrid1.col;
					
					var cell = datagrid1.selectedCells;
					
					var dt = model1.getValue("/root/resData/gridData/record[" + (row) + "]/duty_dt");
					if(dt == ''){
					//if(model1.getValue("/root/resData/gridData/record[" + (row) + "]/duty_dt") == ""){
						alert("근무일 먼저 선택해 주세요.");
						model1.setValue("/root/resData/gridData/record[" + (row) + "]/prsnt_tm", "");
						model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_tm", "");
						return;
					}
					
					var codeVal;
					var cellCol = cell.item(0).col;
					var cellRow = cell.item(0).row;
					var selectValue = datagrid1.valueMatrix(cellRow, cellCol);
					if (selectValue.indexOf(' ') > -1){
						codeVal = selectValue.substring(0, selectValue.indexOf(' '));
					} else {
						codeVal = selectValue;
					}
										

					if (codeVal != ''){
						if (cellCol == 2){
							var emp_no = model1.getValue("/root/resData/gridData/record["+row+"]/emp_no");
							setInfoSearchInput(emp_no, "", "", "setEmp_no_pop"); // 사번, 성명, 주민번호
							if(model1.getValue("/root/tempData/totalcnt") != 1){
								return;
							} // 카운트
							var obj = htmldocument.SessionInfo;
			    	 			setProperty("ss_deptcd"   , obj.deptcd.value);
								//사번 직접 입력시 
			    	 			if(model1.getValue("/root/tempData/dept_cd").substring(0, 2) != obj.deptcd.value.substring(0, 2)){
			    	 				alert("다른 부서사원은 등록 하실 수 없습니다.");
							    	for(var i = 1; i < 5; i++){
							    		datagrid1.valueMatrix(row, i) = "";
							    	}
							    	for(var j = 1; 6 + j < datagrid1.cols - 1; j++){
							    		datagrid1.valueMatrix(row, 6 + j) = "";
							    	}
			    	 				return;
			    	 			}else{
								model1.setValue("/root/resData/gridData/record["+row+"]/emp_no", model1.getValue("/root/tempData/emp_no")); // 사번
								model1.setValue("/root/resData/gridData/record["+row+"]/nm_korn", model1.getValue("/root/tempData/nm_korn")); // 성명
								model1.setValue("/root/resData/gridData/record["+row+"]/dept_cd", model1.getValue("/root/tempData/dept_cd")); // 부서코드
								model1.setValue("/root/resData/gridData/record["+row+"]/dept_nm", model1.getValue("/root/tempData/dept_nm")); // 부서명
								model1.setValue("/root/resData/gridData/record["+row+"]/posi_cd", model1.getValue("/root/tempData/posi_cd")); // 직급코드
								model1.setValue("/root/resData/gridData/record["+row+"]/posi_nm", model1.getValue("/root/tempData/posi_nm")); // 직급명
								//model1.setValue("", model1.getValue("/root/tempData/posi_cd")); // 직책코드
								//model1.setValue("", model1.getValue("/root/tempData/posi_nm")); // 직책명
			    	 			}
							model1.removenode("/root/tempData");
						}else if (cellCol == 3){
							var nm_korn = model1.getValue("/root/resData/gridData/record["+row+"]/nm_korn");
							setInfoSearchInput("", nm_korn, "", "setEmp_no_pop"); // 사번, 성명, 주민번호, 리턴함수
							if(model1.getValue("/root/tempData/totalcnt") != 1){
								return;
							} // 카운트
							var obj = htmldocument.SessionInfo;
			    	 			setProperty("ss_deptcd"   , obj.deptcd.value);
			    	 			if(model1.getValue("/root/tempData/dept_cd").substring(0, 2) != obj.deptcd.value.substring(0, 2)){
			    	 				alert("다른 부서사원은 등록 하실 수 없습니다.");
							    	for(var i = 1; i < 5; i++){
							    		datagrid1.valueMatrix(row, i) = "";
							    	}
							    	for(var j = 1; 6 + j < datagrid1.cols - 1; j++){
							    		datagrid1.valueMatrix(row, 6 + j) = "";
							    	}
			    	 				return;
			    	 			}else{
								model1.setValue("/root/resData/gridData/record["+row+"]/emp_no", model1.getValue("/root/tempData/emp_no")); // 사번
								model1.setValue("/root/resData/gridData/record["+row+"]/nm_korn", model1.getValue("/root/tempData/nm_korn")); // 성명
								model1.setValue("/root/resData/gridData/record["+row+"]/dept_cd", model1.getValue("/root/tempData/dept_cd")); // 부서코드
								model1.setValue("/root/resData/gridData/record["+row+"]/dept_nm", model1.getValue("/root/tempData/dept_nm")); // 부서명
								model1.setValue("/root/resData/gridData/record["+row+"]/posi_cd", model1.getValue("/root/tempData/posi_cd")); // 직급코드
								model1.setValue("/root/resData/gridData/record["+row+"]/posi_nm", model1.getValue("/root/tempData/posi_nm")); // 직급명
								//model1.setValue("", model1.getValue("/root/tempData/posi_cd")); // 직책코드
								//model1.setValue("", model1.getValue("/root/tempData/posi_nm")); // 직책명
			    	 			}
							model1.removenode("/root/tempData");
						}else if (cellCol == 5){
							if(model1.getValue("/root/resData/gridData/record[" + (row) + "]/emp_no") == ""){
								alert("사번먼저 조회해 주세요.");
								//datagrid1.valueMatrix(row, 5) = "";
								return;
							}
							model1.setValue("/root/reqData/searchData/emp_no", model1.getValue("/root/resData/gridData/record[" + (row) + "]/emp_no"));
							model1.setValue("/root/reqData/searchData/clndr_dt", dt);
							model1.send("hd_duty_1107");
							if(model1.getValue("/root/dataSet/CURLIST/record/cnt") != "0"){
								alert("이미 등록되어있는 근무일 또는 휴가일 입니다.");
								model1.removenode("/root/dataSet");
								return;
							}
							model1.removenode("/root/dataSet");
							model1.send("hd_duty_1102");
							
							//model1.setValue("/root/resData/gridData/record[" + (row) + "]/hody_clsf", model1.getValue("/root/dataSet/hody_clsf"));
							model1.setValue("/root/resData/gridData/record[" + (row) + "]/hody_nm", model1.getValue("/root/dataSet/hody_clsf"));
							model1.removenode("/root/dataSet");
							
							if(model1.getValue("/root/reqData/temp_dt") < dt){
								alert("현재일 이후의 일자는 등록하실 수 없습니다.");
								
								model1.setValue("/root/resData/gridData/record[" + (row) + "]/duty_dt", model1.getValue("/root/reqData/temp_dt"));
								model1.setValue("/root/reqData/searchData/clndr_dt", model1.getValue("/root/reqData/temp_dt"));
								model1.send("hd_duty_1102");
								
								//model1.setValue("/root/resData/gridData/record[" + (row) + "]/hody_clsf", model1.getValue("/root/dataSet/hody_clsf"));
								model1.setValue("/root/resData/gridData/record[" + (row) + "]/hody_nm", model1.getValue("/root/dataSet/hody_clsf"));
								model1.removenode("/root/dataSet");
								return;
							}
							datagrid1.refresh();
						}
						if (cellCol == 7){
							if(model1.getValue("/root/resData/gridData/record[" + (row) + "]/prsnt_tm").length != 4){
								alert("출근시간을 확인해 주세요.");
								model1.setValue("/root/resData/gridData/record[" + (row) + "]/prsnt_tm", "");
								model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_clsf", "");
								datagrid1.rowStatus(row) = 0;
								return;
							}else{
								var finish = model1.getValue("/root/resData/gridData/record[" + (row) + "]/finish_tm");
								var prsnt = model1.getValue("/root/resData/gridData/record[" + (row) + "]/prsnt_tm");
								/*if(('0900' < finish) && (finish != "")){
									if(model1.getValue("/root/resData/gridData/record[" + (row) + "]/prsnt_tm") > model1.getValue("/root/resData/gridData/record[" + (row) + "]/finish_tm")){
										alert("출퇴근 시간을 확인해 주세요.");
										return;
									}
								}*/
								if(prsnt != "" && finish != ""){
									//if(('0000' <= finish) && ('0900' >= finish)){
									if(prsnt < finish){
										model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_nm", "당일");
										//model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_clsf", "10"); 120130
										model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_clsf", model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_finish_dd_clsf_010"));
									//}else{
									}else if(prsnt >= finish){
										model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_nm", "익일");
										//model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_clsf", "20"); //120130
										model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_clsf", model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_finish_dd_clsf_020"));
									}
								}
							}
							/*datagrid1.endEditCell();
							datagrid1.col ++;
							datagrid1.editCell();*/
						}
						if (cellCol == 8){
							if(model1.getValue("/root/resData/gridData/record[" + (row) + "]/finish_tm").length != 4){
								alert("퇴근시간을 확인해 주세요.");
								model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_tm", "");
								model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_clsf", "");
								datagrid1.rowStatus(row) = 0;
								return;
							}else{
								var finish = model1.getValue("/root/resData/gridData/record[" + (row) + "]/finish_tm");
								var prsnt = model1.getValue("/root/resData/gridData/record[" + (row) + "]/prsnt_tm");
								/*if(('0900' < finish) && (finish != "")){
									if(model1.getValue("/root/resData/gridData/record[" + (row) + "]/prsnt_tm") > model1.getValue("/root/resData/gridData/record[" + (row) + "]/finish_tm")){
										alert("출퇴근 시간을 확인해 주세요.");
										return;
									}
								}*/
								if(prsnt != "" && finish != ""){
									//if(('0000' <= finish) && ('0900' >= finish)){
									if(prsnt < finish){
										//model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_nm", "당일");
										//model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_clsf", "10"); //120130
										model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_clsf", model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_finish_dd_clsf_010"));
									//}else{
									}else if(prsnt >= finish){
										//model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_nm", "익일");
										//model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_clsf", "20"); //120130
										model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_clsf", model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_finish_dd_clsf_020"));
									}
								}
							}
						}
						if (cellCol == 9){
							if(model1.getValue("/root/resData/gridData/record[" + (row) + "]/prsnt_tm").length == 4 && model1.getValue("/root/resData/gridData/record[" + (row) + "]/finish_tm").length == 4){
							
								var finish = model1.getValue("/root/resData/gridData/record[" + (row) + "]/finish_tm");
								var prsnt = model1.getValue("/root/resData/gridData/record[" + (row) + "]/prsnt_tm");
								var finish_dd_clsf = model1.getValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_clsf");
								
                                if(finish_dd_clsf == "10" ){
									model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_clsf", model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_finish_dd_clsf_020"));

									alert("퇴근일 구분이 당일일 경우 퇴근시각이 출근시간 보다 빠를 수 없습니다.");
								//	model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_clsf", model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_finish_dd_clsf_020"));
									return;
								}
							}
						}
						if (cellCol == 11){ // 2018.08.10 추가 : 근무구분(출장:10) 일경우 근태구분 앞부분을 수정 안되게 처리함 
							var duty_clsf =  datagrid1.valueMatrix(row, cellCol);

							if(duty_clsf == "10") 
							{
								model1.setValue("/root/resData/gridData/record[" + (row) + "]/prsnt_tm", "0930");
								model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_tm", "1830");
								model1.setValue("/root/resData/gridData/record[" + (row) + "]/finish_dd_clsf", "10");
								model1.setValue("/root/resData/gridData/record[" + (row) + "]/addm_rest_minute", "0000");	
								datagrid1.isReadOnly(row, 1, row, 9)  = true;
							}
							else 
							{
								datagrid1.isReadOnly(row, 1, row, 9)  = false;
							//	datagrid1.colDisabled(7) = false;								
							//	datagrid1.colDisabled(8) = false;
							//	datagrid1.colDisabled(9) = false;
							//	datagrid1.colDisabled(10) = false;
							}
							
						}
					}
					
					/*
					model1.setValue("/root/reqData/searchData/clndr_dt", dt);
					model1.send("hd_duty_1102");
					
					var hody_clsf = model1.getValue("/root/dataSet/hody_clsf");
					model1.setValue("/root/resData/gridData/record[" + (row) + "]/hody_clsf", hody_clsf);
					model1.removenode("/root/dataSet");*/
					]]>
				</script>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					rowStatus(datagrid1);
					]]>
				</script>
			</datagrid>
			<button id="button6" class="btn_grid02" style="left:872px; top:5px; width:54px; height:17px; background-image:../../../images/btn_s_3.gif; ">
				<caption>행추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var dept_nm = model1.getValue("/root/resData/gridData/record[1]/dept_nm");
					
					var nodeList = root.selectNodes("/root/resData/gridData/record");
					var rowIdx = nodeList.length;
					
					if (datagrid1.rows == 2 && datagrid1.rowStatus(1) == 0 ) {
						if(dept_nm == ""){
							datagrid1.addStatus(1, "insert");
							datagrid1.isReadOnly(1, 1, 1, 11) = false;
							model1.setValue("/root/resData/gridData/record[1]/duty_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
							
							model1.setValue("/root/reqData/searchData/clndr_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
							model1.send("hd_duty_1102");
							var hody_clsf = model1.getValue("/root/dataSet/hody_clsf");
							model1.setValue("/root/resData/gridData/record[1]/hody_nm", hody_clsf);
							model1.removenode("/root/dataSet");
						}else {
							datagrid1.addRow(true, true);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx + 1) + "]/duty_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
							model1.setValue("/root/reqData/searchData/clndr_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
							model1.send("hd_duty_1102");
							var hody_clsf = model1.getValue("/root/dataSet/hody_clsf");
							model1.setValue("/root/resData/gridData/record[" + (rowIdx + 1) + "]/hody_nm", hody_clsf);
							model1.removenode("/root/dataSet");
						}
					} else {
						datagrid1.addRow(true, true);
						model1.setValue("/root/resData/gridData/record[" + (rowIdx + 1) + "]/duty_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
						model1.setValue("/root/reqData/searchData/clndr_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
						model1.send("hd_duty_1102");
						var hody_clsf = model1.getValue("/root/dataSet/hody_clsf");
						model1.setValue("/root/resData/gridData/record[" + (rowIdx + 1) + "]/hody_nm", hody_clsf);
						model1.removenode("/root/dataSet");
					}
					]]>
				</script>
			</button>
		</group>
		<group id="group3" style="left:10px; top:90px; width:926px; height:30px; ">
			<caption id="caption3" class="list_cap01" style="left:0px; top:0px; width:90px; height:26px; text-align:center; ">근무일</caption>
			<caption id="caption4" class="list_cap02" style="left:89px; top:0px; width:837px; height:26px; text-align:center; "/>
			<caption id="caption5" class="list_cap01" style="left:195px; top:0px; width:90px; height:26px; text-align:center; ">부서</caption>
			<caption id="caption6" class="list_cap01" style="left:493px; top:0px; width:90px; height:26px; text-align:center; ">진행상태</caption>
			<input id="input3" ref="/root/reqData/searchData/duty_dt" class="req" inputtype="date" style="left:92px; top:4px; width:100px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					/* ----------------------------------------- */
						var now_date = new Date();
						var year = now_date.getYear();
						var month = now_date.getMonth() + 1;
						var day = now_date.getDate();    
						var month_tm = '0' + month;
						var day_tm = '0' + day;  
						if(month_tm.length == 3){
							month_tm = month_tm.substring(1, 3);
						}
						if(day_tm.length == 3){
							day_tm = day_tm.substring(1, 3);
						}
						var now_dt = year + month_tm + day_tm;
						if(model1.getValue("/root/reqData/searchData/duty_dt") > now_dt){
							alert("현재일 이후의 일자는 등록하실 수 없습니다.");
							return;
						}
						model1.setValue("/root/reqData/searchData/clndr_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
						model1.send("hd_duty_1102");
						model1.setValue("/root/resData/hody_nm", model1.getValue("/root/dataSet/hody_clsf"));
						model1.removenode("/root/dataSet");
						model1.setValue("/root/resData/gridData/record[1]/hody_nm", model1.getValue("/root/resData/hody_nm"));
						model1.setValue("/root/resData/gridData/record[1]/duty_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
						
						loadSearch();
					
						var nodeList = root.selectNodes("/root/resData/gridData/record");
						var rowIdx = nodeList.length;
						for(var i=1; i<rowIdx + 1; i++){
							var proc_stat = model1.getValue("/root/resData/gridData/record[" + (i) + "]/proc_stat");
							var duty_dt = model1.getValue("/root/resData/gridData/record[" + (i) + "]/duty_dt");
							var nm_korn = model1.getValue("/root/resData/gridData/record[" + (i) + "]/nm_korn");
							//if(proc_stat == "14" || proc_stat == "13" || proc_stat == "29") {
							datagrid1.isReadOnly(i, 1, i, 11) = false;
							
							var pattern = ","+proc_stat+",";
							var validation  = (","+model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_proc_stat_010")+",").indexOf(pattern)>-1;
							//if(proc_stat == "14" || proc_stat == "29" || proc_stat == "25") { //120130
							if(validation) {
								datagrid1.isReadOnly(i, 1, i, 11) = true;
							}else{
								datagrid1.isReadOnly(i, 1, i, 5) = true;
							}
							var vaca_nm = model1.getValue("/root/resData/gridData/record[" + (i) + "]/vaca_nm");
							if(vaca_nm != ""){
								datagrid1.isReadOnly(i, 1, i, 11) = true;
							}else{
								//datagrid1.isReadOnly(i, 6, i, 11) = false;
								datagrid1.isReadOnly(i, 1, i, 5) = true;
							}
							var duty_clsf = model1.getValue("/root/resData/gridData/record[" + (i) + "]/duty_clsf");// 2018.08.10 추가 : 근무구분(출장:10) 일경우 근태구분 앞부분을 수정 안되게 처리함 
							if(duty_clsf == "10"){
								datagrid1.isReadOnly(i, 1, i, 10) = true;
							}
							
							//datagrid1.isReadOnly(i, 8, i, 8) = true;
						}
						datagrid1.clearStatus();
						
					/* ----------------------------------------- */
						model1.refresh();
						var totcnt = datagrid1.rows;
						model1.setValue("/root/resData/totcnt", "총 " + Number(totcnt - 1) + " 건");
						model1.refresh();
					]]>
				</script>
			</input>
			<!--<input id="clam_dept_cd" ref="/root/reqData/searchData/dept_cd" inputtype="button" style="left:288px; top:4px; width:80px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						window.load("/xrw/hd/com/HD_COM_1100.xrw","mdichild", "hd_com_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
			</input>
			<output id="clam_dept_cd_nm" ref="/root/reqData/searchData/dept_cd_nm" style="left:373px; top:4px; width:120px; height:18px; "/>-->
			<select1 id="combo1" ref="/root/reqData/searchData/proc_stat" appearance="minimal" style="left:586px; top:4px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/proc_stat/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<select1 id="combo2" ref="/root/reqData/searchData/dept_cd" class="req" appearance="minimal" style="left:288px; top:4px; width:202px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dept_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
					var obj = htmldocument.SessionInfo;

					var temp = model1.getValue("/root/reqData/searchData/dept_cd");
					model1.setValue("/root/reqData/searchData/dept_cd", temp);
					//model1.send("hd_duty_1204");
					
					//session의 결재자 정보
					if(obj.cmpycd.value != "100")
					{
						model1.send("hd_duty_1209");
						model1.setValue("/root/resData/resForm/emp_no", model1.getValue("/root/dataSet/CURLIST/record/emp_no"));
						model1.setValue("/root/resData/resForm/temp", model1.getValue("/root/dataSet/CURLIST/record/temp"));
						model1.setValue("/root/resData/resForm/temp_tm", model1.getValue("/root/dataSet/CURLIST/record/temp_tm"));
						var temp_tm = model1.getValue("/root/dataSet/CURLIST/record/temp_tm");
					}
					else 
					{
						model1.send("hd_com_5004");
						model1.setValue("/root/resData/resForm/emp_no", model1.getValue("/root/dataSet/CURLIST1/record/emp_no"));
						model1.setValue("/root/resData/resForm/temp", model1.getValue("/root/dataSet/CURLIST1/record/nm_korn"));
						model1.setValue("/root/resData/resForm/temp_tm", model1.getValue("/root/dataSet/CURLIST1/record/posi_nm"));
						var temp_tm = model1.getValue("/root/dataSet/CURLIST1/record/nm_korn");
					}
					model1.removenode("/root/dataSet/CURLIST/record/temp_tm");
					model1.removenode("/root/dataSet");
					var temp = datagrid1.rows;
					//for(var i=1; i< temp;  i++) {
					//	datagrid1.deleteRow(1);
					//}
					if(temp_tm == ""){
						alert("해당부서에 결재자가 없습니다.");
						output1.value = "";
						output2.value = "";
					}
				
					/* ----------------------------------------- */
					model1.setValue("/root/reqData/searchData/clndr_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
					model1.send("hd_duty_1102");
					model1.setValue("/root/resData/hody_nm", model1.getValue("/root/dataSet/hody_clsf"));
					model1.removenode("/root/dataSet");
					//model1.setValue("/root/resData/gridData/record[1]/hody_nm", model1.getValue("/root/resData/hody_nm"));
					//model1.setValue("/root/resData/gridData/record[1]/duty_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
					
					loadSearch();
					
					var nodeList = root.selectNodes("/root/resData/gridData/record");
					var rowIdx = nodeList.length;
					for(var i=1; i<rowIdx + 1; i++){
						var proc_stat = model1.getValue("/root/resData/gridData/record[" + (i) + "]/proc_stat");
						var duty_dt = model1.getValue("/root/resData/gridData/record[" + (i) + "]/duty_dt");
						var nm_korn = model1.getValue("/root/resData/gridData/record[" + (i) + "]/nm_korn");
						//if(proc_stat == "14" || proc_stat == "13" || proc_stat == "29") {
						datagrid1.isReadOnly(i, 1, i, 11) = false;
						
						var pattern = ","+proc_stat+",";
						var validation  = (","+model1.getValue("/root/initData/hd_duty_1207_m/dataSet/xx_proc_stat_010")+",").indexOf(pattern)>-1;
						//if(proc_stat == "14" || proc_stat == "29" || proc_stat == "25") {
						if(validation) {
							datagrid1.isReadOnly(i, 1, i, 11) = true;
						}else{
							datagrid1.isReadOnly(i, 1, i, 5) = true;
						}
						var vaca_nm = model1.getValue("/root/resData/gridData/record[" + (i) + "]/vaca_nm");
						if(vaca_nm != ""){
							datagrid1.isReadOnly(i, 1, i, 11) = true;
						}else{
							//datagrid1.isReadOnly(i, 6, i, 11) = false;
							datagrid1.isReadOnly(i, 1, i, 5) = true;
						}
						var duty_clsf = model1.getValue("/root/resData/gridData/record[" + (i) + "]/duty_clsf");// 2018.08.10 추가 : 근무구분(출장:10) 일경우 근태구분 앞부분을 수정 안되게 처리함 
						if(duty_clsf == "10"){
							datagrid1.isReadOnly(i, 1, i, 10) = true;
						}
						//datagrid1.isReadOnly(i, 8, i, 8) = true;
					}
					datagrid1.clearStatus();
					
					//datagrid1.isReadOnly(1, 1, 1, 11) = true;
					/*datagrid1.addStatus(1, "insert");	
					model1.setValue("/root/reqData/searchData/clndr_dt", model1.getValue("/root/reqData/searchData/duty_dt"));
					model1.send("hd_duty_1102");
					model1.setValue("/root/resData/hody_nm", model1.getValue("/root/dataSet/hody_clsf"));
					model1.removenode("/root/dataSet");
					model1.setValue("/root/resData/gridData/record[1]/hody_nm", model1.getValue("/root/resData/hody_nm"));
					model1.setValue("/root/resData/gridData/record[1]/duty_dt", model1.getValue("/root/reqData/searchData/duty_dt"));*/
					/* ----------------------------------------- */
					
					model1.refresh();
					var totcnt = datagrid1.rows;
					model1.setValue("/root/resData/totcnt", "총 " + Number(totcnt - 1) + " 건");
					model1.refresh();
					]]>
				</script>
			</select1>
		</group>
		<caption id="caption14" ref="/root/resData/totcnt" style="left:849px; top:700px; width:87px; height:20px; font-weight:bold; text-align:right; "/>
	</xhtml:body>
</xhtml:html>
