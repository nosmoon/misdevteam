<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<comboSet>
							<memb_clsf/>
							<bank_cd/>
							<stlm_desty/>
							<expn_clsf/>
							<medi_cd1/>
							<medi_cd2/>
							<resn_cd_1>
								<item>
									<value/>
									<label/>
								</item>
							</resn_cd_1>
							<resn_cd_2>
								<item>
									<value/>
									<label/>
								</item>
							</resn_cd_2>
						</comboSet>
						<medi_cd/>
						<dtl_medi_cd/>
						<supr_dept_cd/>
						<dept_cd/>
					</initData>
					<reqData>
						<searchData>
							<flnm/>
							<expn_clsf_cd/>
							<memb_clsf/>
							<mang_cd_1/>
							<slip_no/>
						</searchData>
						<multiUpData/>
						<reqForm>
						</reqForm>
						<fwdData>
							<func_nm/>
						</fwdData>
						<proc_gubun/>
					</reqData>
					<resData>
						<gridData>
							<record>
								<mang_no/>
								<flnm/>
								<memb_clsf/>
								<memb_clsf_nm/>
								<str_dt/>
								<end_dt/>
								<limt_amt/>
								<clam_amt/>
								<bank_cd/>
								<prn/>
								<tel_no/>
								<addr/>
								<draft_no/>
								<mang_no/>
								<bank_cd/>
								<bank_nm/>
								<acct_no/>
								<proc_mang_dt/>
								<spos_name/>
								<incm_clsf_cd/>
								<draft_dept_cd/>
								<deps_per/>
								<proc_stat/>
								<chkbox/>
								<seq/>
								<aply_obj_name/>
								<mode/>
							</record>
						</gridData>
						<resForm>
							<mang_no/>
							<flnm/>
							<aply_obj_name/>
							<memb_clsf/>
							<dth_ym/>
							<spos_name/>
							<expn_cont/>
							<str_dt/>
							<end_dt/>
							<limt_amt/>
							<clam_amt/>
							<excl_amt/>
							<sply_amt/>
							<left_limit_amt/>
							<bank_cd/>
							<acct_no/>
							<deps_per/>
							<expn_clsf_cd/>
							<mode/>
							<reg_dt/>
							<stlm_desty/>
							<remk/>
							<proc_gubun/>
							<aply_obj_clsf/>
							<cash_payment/>
							<seq/>
							<expn_resn_cd1/>
							<expn_resn_cd2/>
						</resForm>
						<msg/>
						<temp/>
						<totcnt/>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
				//현재 날짜 
					function DateDemo()
					{
						var now_dt = "";
						var now_date = new Date();
						var year = now_date.getYear();
						var month = now_date.getMonth() + 1;
						var day = now_date.getDate();    
						var month_tm = '0' + month;
						var day_tm = '0' + day;  
						if(month_tm.length == 3){
							month_tm = month_tm.substring(1, 3);
						}
						if(day_tm.length == 3){
							day_tm = day_tm.substring(1, 3);
						}
						now_dt = year + month_tm + day_tm;
					       return(now_dt);
					}	
					
				function se_openZip(bogb, zip1Ref, zip2Ref, addrRef, gub){
					
						var tempReq = "/root/tempData/posttemp";
						if(instance1.selectSingleNode(tempReq) == null){
							model.makeNode(tempReq);
						}
						tempReq = "/root/tempData/posttemp/send";
						if(instance1.selectSingleNode(tempReq) == null){
							model.makeNode(tempReq);
						}
						tempReq = "/root/tempData/posttemp/send/zip";
						if(instance1.selectSingleNode(tempReq) == null){
							model.makeNode(tempReq);
						}
						tempReq = "/root/tempData/posttemp/send/disp_flag";
						if(instance1.selectSingleNode(tempReq) == null){
							model.makeNode(tempReq);
						}
						tempReq = "/root/tempData/posttemp/recv";
						if(instance1.selectSingleNode(tempReq) == null){
							model.makeNode(tempReq);
						}
						
						//"L"이면 지국항목 안보임
						model.setValue("/root/tempData/posttemp/send/disp_flag", bogb);
												
						model.setValue("/root/tempData/posttemp/send/zip", model.getValue(zip1Ref)+model.getValue(zip2Ref));
						
						openZip("/root/tempData/posttemp/send", "/root/tempData/posttemp/recv","new");
												
						model.setValue(zip1Ref, model.getValue("/root/tempData/posttemp/recv/zip1"));
					//	model.setValue(zip2Ref, model.getValue("/root/tempData/posttemp/recv/zip2"));
						model.setValue(addrRef, model.getValue("/root/tempData/posttemp/recv/addr"));
						model.removenode("/root/tempData");
						
						model.refresh();
					}
					
					function loadData(){
						var flnm = model.getValue("/root/reqData/searchData/flnm");
						var expn_clsf_cd = model.getValue("/root/reqData/searchData/expn_clsf_cd");
						var memb_clsf= model.getValue("/root/reqData/searchData/memb_clsf");
						var slip_no= model.getValue("/root/reqData/searchData/slip_no");
						
						model.reset();
						model.setValue("/root/reqData/searchData/flnm",flnm);
						model.setValue("/root/reqData/searchData/expn_clsf_cd",expn_clsf_cd);
						model.setValue("/root/reqData/searchData/memb_clsf",memb_clsf);
						model.setValue("/root/reqData/searchData/slip_no",slip_no);

						model.send("hd_affr_9601_l");

						model.copyNode("/root/resData/gridData","/root/dataSet/CURLIST");			
						model1.refresh();
						input1.disabled = false;				
						
						var totcnt = datagrid2.rows;
						model1.setValue("/root/resData/totcnt", "총 " + Number(totcnt - 1) + " 건");
						model1.refresh(); 
					}
					
					function setExcl_amt() {
						var clam_amt = model1.getValue("/root/resData/resForm/clam_amt"); // 청구액 
						var sply_amt = model1.getValue("/root/resData/resForm/sply_amt");  // 지원액
					    var excl_amt = model1.getValue("/root/resData/resForm/excl_amt");  // 제외액  
					    var expn_clsf_cd = model1.getValue("/root/resData/resForm/expn_clsf_cd");  // 지출구분
						
						if(expn_clsf_cd   == "")
						{
							alert("지출구분을 선택해 주세요");
							return;
						}
						
						if(clam_amt  != "")
						{
							//model1.setValue("/root/resData/resForm/mang_no", mang_no);
							//model1.setValue("/root/resData/resForm/flnm", flnm);
						
							model.send("hd_affr_9604_l");
							var limit =  model1.getValue("/root/tempData/diff_limt_amt");
							
							if (limit < 0 )
							{
								var abslimit = Math.abs(limit); 
								alert("지원 가능한 한도액이 "+abslimit+"만큼 초과 되었습니다." );
								input12.value = "";
								sply_amt = 0 ;
								 return;
							}
						    
							excl_amt   =  clam_amt - sply_amt  ;
							model1.setValue( "/root/resData/resForm/excl_amt", excl_amt) ;
							model1.refresh();
						//	input12.refresh();
						}
					}
					function setExcl_amt2() {
						var flnm = model1.getValue("/root/resData/resForm/flnm"); // 성명
						var mang_no = model1.getValue("/root/resData/resForm/mang_no");  // 관리번호
						
						if(mang_no   == "")
						{
							alert("성명을 선택해 주세요");
							return;
						}
		
							model.send("hd_affr_9605_l");
							var leftlimit =  model1.getValue("/root/tempData/left_limt_amt");
							model1.setValue( "/root/resData/resForm/left_limit_amt", leftlimit) ;
							model1.refresh();

					}
					
					function setMang_no(){
						var mang_no = input4.currentText;
						var flnm = input1.currentText ;//model1.getValue("/root/resData/resForm/flnm");

						model1.setValue("/root/resData/resForm/mang_no", mang_no);
						model1.setValue("/root/resData/resForm/flnm", flnm);
						

						input1.refresh();
						input10.refresh();
						
					    model.send("hd_affr_9503_l");
						
						model.setValue("/root/resData/resForm/mang_no",model1.getValue("/root/tempData/CURLIST/record/mang_no"));
						model.setValue("/root/resData/resForm/flnm",model1.getValue("/root/tempData/CURLIST/record/flnm"));
						model.setValue("/root/resData/resForm/memb_clsf",model1.getValue("/root/tempData/CURLIST/record/memb_clsf"));
						model.setValue("/root/resData/resForm/spos_name",model1.getValue("/root/tempData/CURLIST/record/spos_name"));
						model.setValue("/root/resData/resForm/bank_cd",model1.getValue("/root/tempData/CURLIST/record/bank_cd"));
						model.setValue("/root/resData/resForm/acct_no",model1.getValue("/root/tempData/CURLIST/record/acct_no"));
						model.setValue("/root/resData/resForm/deps_per",model1.getValue("/root/tempData/CURLIST/record/deps_per"));
						
						if(model1.getValue("/root/tempData/CURLIST/record/memb_clsf") == "90"){
							input2.disabled = true;
							input2.value = "00";
							combo2.value = "40";
							var getComboValue = combo2.value;
							model1.setValue("/root/reqData/searchData/mang_cd_1", getComboValue);
							model1.send("hd_affr_9704");
							model1.copyNode("/root/initData/comboSet/resn_cd_1", "/root/tempData/GETCONDONM");
							model1.copyNode("/root/initData/comboSet/resn_cd_2", "/root/tempData/GETCONDONM");
							model1.removenode("/root/tempData");	
							combo4.refresh();
							combo4.select(0);
							combo5.refresh();
							combo5.select(0);
						}else{
							input2.disabled = false;
						}
						
						if(checkbox1.value  == "Y" )
						{
							output1.value = model.getValue("/root/resData/resForm/spos_name");
						}else 
						{
							output1.value = model.getValue("/root/resData/resForm/flnm");
						}
							
							
						model.refresh();
					}
					function setStatus(grid){
						for(i=grid.fixedRows;i<grid.rows;i++){
							var send_data = grid.valueMatrix(i,datagrid2.colRef("chkbox"));
							if( (send_data == "true") ){
								grid.rowStatus(i) = 2;
							}else{
								grid.rowStatus(i) = 0;
							}
						}
					}
				
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					model.send("hd_affr_9600_m");
					model.copyNode("/root/initData/comboSet/stlm_desty", 	"/root/tempData/XX_STLM_DESTY");
					model.copyNode("/root/initData/comboSet/memb_clsf",  "/root/tempData/XX_MEMB_CLSF");
					model.copyNode("/root/initData/comboSet/bank_cd",  "/root/tempData/XX_BANK_CD");
					model.copyNode("/root/initData/comboSet/expn_clsf",  "/root/tempData/XX_EXPN_CLSF");
					
					datagrid2.fixedcellcheckbox(0, datagrid2.colRef("chkbox"), false) = true;					

					var curDate = getCurrentDate();
					model.setValue("/root/resData/resForm/str_dt",curDate);
					model.setValue("/root/resData/resForm/end_dt",curDate);
					
					model.refresh();				
				]]>
			</script>
			<submission id="fc_acct_2013_s" action="/fc/acct2000/2013" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resform" resultref="/root/resData/resform3/fc_acct_2013_s/dataSet"/>
			<submission id="hd_affr_9600_m" action="/hd/affr/9600" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_affr_9503_l" action="/hd/affr/9503" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData"/>
			<submission id="hd_affr_9601_l" action="/hd/affr/9601" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/dataSet"/>
			<submission id="hd_affr_9602_a" action="/hd/affr/9602" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData"/>
			<submission id="hd_affr_9604_l" action="/hd/affr/9604" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData"/>
			<instance id="instance2">
				<root/>
			</instance>
			<submission id="hd_affr_9703_a" action="/hd/affr/9703" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpData" resultref="/root/tempData"/>
			<submission id="hd_affr_9704" action="/hd/affr/9704/" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_affr_9605_l" action="/hd/affr/9605" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData"/>
		</model>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CRMComm.js"/>
		<script type="javascript" src="/js/fcmc_common.js"/>
		<xhtml:style id="style1">
			<![CDATA[ 
				.yellow    { background-color:#99FFCC;}
				button.btn_grid081{
											color:#0000FF;
											font-size:14px !important;
											font-weight : bolder;
											width:75px !impotant;
											height:17px !important;
											text-align:left;
											letter-spacing:-1px!important; 
											padding-left:13px!important;
											vertical-align:middle;
											down.padding-left:20px !important;
											disable.color:#AEAEAE!important; 
											background-image:/images/btn_s_8.gif; 
											hover.color:#FF0000;  
										} 
				button.btn_grid0811{
											color:#0000FF;
											font-size:11px !important;
											font-weight : bolder;
											width:75px !impotant;
											height:17px !important;
											text-align:left;
											letter-spacing:-1px!important; 
											padding-left:13px!important;
											vertical-align:middle;
											down.padding-left:20px !important;
											disable.color:#AEAEAE!important; 
											background-image:/images/btn_s_7.gif; 
											hover.color:#FF0000;  
										} 
				button.btn_grid0101{
											color:#0000FF;
											font-size:11px !important;
											font-weight : bolder;
											width:75px !impotant;
											height:17px !important;
											text-align:left;
											letter-spacing:-1px!important; 
											padding-left:13px!important;
											vertical-align:middle;
											down.padding-left:20px !important;
											disable.color:#AEAEAE!important; 
											background-image:/images/btn_s_9.gif; 
											hover.color:#FF0000;  
										} 
			]]>
		</xhtml:style>
	</xhtml:head>
	<!--<xhtml:body class="main" pagewidth="946" pageheight="765">-->
	<xhtml:body class="main" disabled="true" pagewidth="946" pageheight="765" guideline="2,685;1,935;1,10;2,52;2,140;2,80;2,749;1,261;" style="font-family:굴림; ">
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<script type="javascript" ev:event="iviewer1(xforms:iviewer)">
			<![CDATA[
			
			]]>
		</script>
		<button id="btnA1" class="btn02" style="left:452px; top:47px; width:52px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="DOMActivate">
				<![CDATA[
					loadData();
				]]>
			</script>
		</button>
		<button id="btnA2" class="btn02" style="left:507px; top:47px; width:52px; height:21px; ">
			<caption>저장</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var mang_no = model.getValue("/root/resData/resForm/mang_no");
					if (mang_no == ""){
						alert("관리번호를  입력해 주십시오."); return;
					}
					var flnm = model.getValue("/root/resData/resForm/flnm");
					if (flnm == ""){
						alert("성명을 입력해 주십시오."); return;
					}
					if (!commReqCheck("group_scr"))
					 return;

					if(checkbox1.value == "20"){
						model1.setValue("/root/resData/resForm/aply_obj_clsf","20");
						model1.setValue("/root/resData/resForm/aply_obj_name",input10.value);
					}else{ 
						model1.setValue("/root/resData/resForm/aply_obj_clsf","10");
						model1.setValue("/root/resData/resForm/aply_obj_name",input1.value);
					}
				
					
					if(!commConfirmBox("저장 하시겠습니까?")) return;

					model.setValue("/root/resData/resForm/mode","U");
					model.send("hd_affr_9602_a");
					
					if(submit_completed()) {
						loadData();
					}
					
				]]>
			</script>
		</button>
		<button id="btnA4" class="btn02" style="left:885px; top:47px; width:52px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				 viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
				]]>
			</script>
		</button>
		<button id="button2" class="btn02" style="left:397px; top:47px; width:52px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model1.reset();
					input1.disabled = false;
					//group2.disabled = true;
				]]>
			</script>
		</button>
		<button id="button3" class="btn04" style="left:795px; top:47px; width:87px; height:21px; ">
			<caption>엑셀다운로드</caption>
			<script type="javascript" ev:event="DOMActivate">
				<![CDATA[
				//excel 파일로 저장한다
				var filePath = window.fileDialog("save", "", false, "", "xls", "Excel Files(*.xls)|*.xls");
				if(filePath != "") {
					datagrid2.saveExcel(filePath);
					window.exec(filePath);
				}
				]]>
			</script>
		</button>
		<caption id="caption36" ref="/root/resData/totcnt" style="left:841px; top:478px; width:87px; height:20px; font-weight:bold; text-align:right; "/>
		<group id="group1" class="gro_sel" style="left:7px; top:82px; width:926px; height:51px; ">
			<caption id="caption39" class="list_cap02" style="left:757px; top:25px; width:169px; height:25px; text-align:center; "/>
			<caption id="caption38" class="list_cap02" style="left:67px; top:25px; width:213px; height:25px; text-align:center; "/>
			<caption id="caption40" class="list_cap01" style="left:3px; top:25px; width:72px; height:25px; text-align:center; ">성  명</caption>
			<input id="emp_no" ref="/root/reqData/searchData/flnm" type="inputbutton" style="left:82px; top:29px; width:128px; height:18px; "/>
			<caption id="caption42" class="list_cap02" style="left:531px; top:25px; width:169px; height:25px; text-align:center; "/>
			<select1 id="combo7" ref="/root/reqData/searchData/memb_clsf" appearance="minimal" style="left:542px; top:29px; width:153px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/memb_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<caption id="caption37" class="list_cap02" style="left:284px; top:25px; width:171px; height:25px; text-align:center; "/>
			<select1 id="combo9" ref="/root/reqData/searchData/expn_clsf_cd" appearance="minimal" style="left:295px; top:29px; width:150px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/expn_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
						<pcode ref="pcode"/>
					</itemset>
				</choices>
			</select1>
			<caption id="caption34" class="list_cap01" style="left:215px; top:25px; width:75px; height:25px; text-align:center; ">지출구분</caption>
			<caption id="caption30" class="list_cap01" style="left:452px; top:25px; width:83px; height:25px; text-align:center; ">당연직/종전직</caption>
			<caption id="caption21" class="tit02" style="left:4px; top:2px; width:80px; height:20px; font-weight:bold; ">조회</caption>
			<caption id="caption35" class="list_cap01" style="left:700px; top:25px; width:83px; height:25px; text-align:center; ">전표번호</caption>
			<input id="input15" ref="/root/reqData/searchData/slip_no" type="inputbutton" style="left:790px; top:29px; width:128px; height:18px; "/>
		</group>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData/record" caption="^관리번호^성명^대상자^구분코드^구분^지출구분^기간^기간^한도액^지원액^은행코드^은행명^계좌번호^입금주^연락처^결산기수^퇴임시직책^비고^전표번호^진행상태" colsep="#" colwidth="25, 80, 80, 80, 80, 80, 80, 80, 75, 80, 80, 70, 115, 130, 80, 100, 70, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" explorerbar="sortshowmove" extendlastcol="scroll" frozencols="3" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" tooltip="true" style="left:8px; top:335px; width:926px; height:350px; ">
			<col checkvalue="1,0" ref="chkbox" type="checkbox"/>
			<col ref="mang_no"/>
			<col ref="flnm">
				<![CDATA[>]]>
			</col>
			<col ref="aply_obj_name"/>
			<col ref="memb_clsf" visibility="hidden"/>
			<col ref="memb_clsf_nm"/>
			<col ref="expn_clsf_nm"/>
			<col ref="str_dt" format="yyyy-mm-dd" style="left:338px; top:20px; width:80px; height:20px; "/>
			<col ref="end_dt" format="yyyy-mm-dd"/>
			<col ref="limt_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="sply_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="bank_cd"/>
			<col ref="bank_nm"/>
			<col ref="acct_no"/>
			<col ref="deps_per"/>
			<col ref="tel_no"/>
			<col ref="stlm_desty"/>
			<col ref="dtynm"/>
			<col ref="remk"/>
			<col ref="proc_mang_dt_seq"/>
			<col ref="proc_stat_nm"/>
			<col ref="back_cd" visibility="hidden"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="proc_mang_dt" visibility="hidden"/>
			<col ref="spos_name" visibility="hidden"/>
			<col ref="thrw_pgm2" visibility="hidden"/>
			<col ref="medi_cd" visibility="hidden"/>
			<col ref="medi_cd2" visibility="hidden"/>
			<col ref="frlc_no" visibility="hidden"/>
			<col ref="pay_cycl" visibility="hidden"/>
			<col ref="lvcmpy_dt" visibility="hidden"/>
			<col ref="dept_cd" visibility="hidden"/>
			<col ref="supr_dept_cd" visibility="hidden"/>
			<col ref="expn_clsf_cd" visibility="hidden"/>
			<col ref="expn_resn_cd1" visibility="hidden"/>
			<col ref="expn_resn_cd2" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
					if (event.target == "datagrid2") {
						var row = datagrid2.row;	
						
						if(datagrid2.rows == 2 && datagrid2.valueMatrix(1,2) == "" )
							return;
							
						for (var i=1; i<datagrid2.rows; i++) {
							var proc_stat = model1.getValue("/root/resData/gridData/record["+ i +"]/proc_stat");
							var status = datagrid2.rowstatus(i);
							if(status == 0  &&  (proc_stat != "40")  ){
									datagrid2.addStatus(i, "update");	
							}else{
								//if(status == 0  &&  (proc_stat != "29" || proc_stat == "36" ) && proc_stat == "" ){
								if(status == 0  &&  (proc_stat != "40")  ){
									datagrid2.addStatus(i, "update");
								}
							}
						}
						
						for (var i=1; i<datagrid2.rows; i++) {
							var status1 = datagrid2.rowstatus(i);
							
							if(status1 == 0){
								datagrid2.valueMatrix(i, datagrid2.colRef("chkbox")) = 0;
							}
						}
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[
					if (event.target == "datagrid2") {
						var row = datagrid2.row;
							
						for(var i=1;i<datagrid2.rows;i++)	{
							  datagrid2.rowstatus(i) = 0;
						}		
					}
				]]>
			</script>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var row = datagrid2.row;
					model.refresh();
				//	input1.disabled = true;
					if(datagrid2.row == 0){
						return;
					}
					var idx = 2;
					var selectValue = "";
					
					input1.disabled = true;
					input4.disabled = true;
					
					if(datagrid2.row == 0) return;		
				
					var selectValue = "";
					var selectedIdx = datagrid2.row;

					rowStatus(datagrid2);
					

					var proc_stat = model1.getValue("/root/resData/gridData/record["+ selectedIdx +"]/proc_stat");
					 
					if (proc_stat == "40" || proc_stat =="30"){ 
						input9.disabled = true;
						input3.disabled = true;
						input11.disabled = true;
						combo5.disabled = true;
						combo4.disabled = true;
						input2.disabled = true;
						input12.disabled = true;
						input5.disabled = true;
						combo2.disabled = true;
						checkbox1.disabled =true;
					}else{
						input9.disabled = false;
						input3.disabled = false;
						input11.disabled = false;
						combo5.disabled = false;
						combo4.disabled = false;
						input2.disabled = false;
						input12.disabled = false;
						input5.disabled = false;
						combo2.disabled = false;
						checkbox1.disabled =false;
					}

					if (datagrid2.col != 1)
					{
						model1.copyNode("/root/resData/resForm" ,"/root/resData/gridData/record["+ selectedIdx +"]");
					}
					else 
					{
							var row = datagrid2.row;
						if (datagrid2.valueMatrix(row, 1) == "0" && datagrid2.rowStatus(row) == 2)
							datagrid2.rowStatus(row) = 0;
					}
					model1.makeNode("/root/resData/resForm/mode");
					model1.refresh();
					
					var getComboValue = combo2.value;
					model1.setValue("/root/reqData/searchData/mang_cd_1", getComboValue);
					model1.send("hd_affr_9704");
					model1.copyNode("/root/initData/comboSet/resn_cd_1", "/root/tempData/GETCONDONM");
					model1.copyNode("/root/initData/comboSet/resn_cd_2", "/root/tempData/GETCONDONM");
					model1.removenode("/root/tempData");	
						combo4.refresh();
						//combo4.select(0);
						combo5.refresh();
						//combo5.select(0);
						//combo6.select(0);
					
				]]>
			</script>
		</datagrid>
		<group id="group_btnG1" class="gro_btn" style="left:6px; top:151px; width:926px; height:17px; "/>
		<button id="button5" class="btn02" visibility="hidden" style="left:342px; top:47px; width:52px; height:21px; ">
			<caption>수정</caption>
			<script type="javascript" ev:event="DOMActivate">
				<![CDATA[
					alert("내용 수정 후 저장버튼을 클릭해주세요.");
					input1.disabled = false;
					input4.disabled = false;
				]]>
			</script>
		</button>
		<group id="group_scr" class="gro_sel" style="left:9px; top:174px; width:926px; height:156px; ">
			<caption id="caption14" class="list_cap02" style="left:394px; top:100px; width:532px; height:26px; text-align:center; "/>
			<caption id="caption12" class="list_cap02" style="left:71px; top:125px; width:855px; height:26px; text-align:center; "/>
			<caption id="caption7" class="list_cap02" style="left:74px; top:1px; width:256px; height:26px; text-align:center; "/>
			<caption id="caption9" class="list_cap02" style="left:394px; top:75px; width:532px; height:26px; text-align:center; "/>
			<caption id="caption3" class="list_cap02" style="left:0px; top:26px; width:312px; height:26px; text-align:center; "/>
			<caption id="caption6" class="list_cap02" style="left:322px; top:1px; width:310px; height:26px; text-align:center; "/>
			<caption id="caption16" class="list_cap02" style="left:626px; top:1px; width:300px; height:26px; text-align:center; "/>
			<caption id="caption13" class="list_cap01" style="left:310px; top:1px; width:95px; height:26px; text-align:center; ">배우자명</caption>
			<caption id="caption22" class="list_cap02" style="left:89px; top:75px; width:296px; height:26px; text-align:center; "/>
			<caption id="caption18" class="list_cap01" style="left:0px; top:26px; width:95px; height:26px; text-align:center; ">지출구분</caption>
			<caption id="caption4" class="list_cap01" style="left:0px; top:1px; width:95px; height:26px; text-align:center; ">관리번호/성명</caption>
			<caption id="caption11" class="list_cap01" style="left:310px; top:75px; width:95px; height:26px; text-align:center; ">한도액/제외액</caption>
			<caption id="caption31" class="list_cap02" style="left:395px; top:26px; width:531px; height:26px; text-align:center; "/>
			<caption id="caption15" class="list_cap01" style="left:617px; top:1px; width:95px; height:26px; text-align:center; ">당연직/종전직</caption>
			<caption id="caption48" class="list_cap01" style="left:310px; top:26px; width:95px; height:26px; text-align:center; ">내용</caption>
			<input id="input8" ref="/root/resData/resForm/excl_amt" disabled="true" format="##,###" style="left:518px; top:79px; width:92px; height:18px; text-align:right; "/>
			<input id="input1" ref="/root/resData/resForm/flnm" class="req" navindex="2" imemode="hangul" style="left:196px; top:5px; width:95px; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[

						if (event.keyCode ==13){
							if(input1.currentText==""){
								alert("조회할 이름이 없습니다.");
								model1.reset();
								return;
							}else{
								model1.removenode("/root/tempData");
								model1.makeNode("/root/tempData");
													
							//	setInfoSearchInput("", input1.currentText, "","setEmp_no"); // 사번, 성명, 주민번호
							    setMang_no() ;
							
								if(model1.getValue("/root/tempData/totalcnt") != 1){	
									model1.removenode("/root/tempData");
									model1.makeNode("/root/tempData");
									return;
								}else{
									model1.setValue("/root/reqData/searchData/mang_no", model1.getValue("/root/tempData/mang_no")); // 사번
									model1.setValue("/root/reqData/searchData/flnm", model1.getValue("/root/tempData/flnm")); // 성명
									//조회
								//	searchDate();
								
								}
								
					
								
							}
						}
					]]>
				</script>
			</input>
			<output id="output2" ref="/root/resData/resForm/incm_clsf_nm" visibility="hidden" style="left:805px; top:5px; width:24px; height:18px; "/>
			<caption id="caption44" class="list_cap01" style="left:617px; top:26px; width:95px; height:26px; text-align:center; ">일자(기간)</caption>
			<select1 id="combo1" ref="/root/resData/resForm/memb_clsf" class="req" disabled="true" appearance="minimal" caption="소득구분" style="left:716px; top:5px; width:195px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/memb_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<output id="output5" ref="/root/resData/resForm/reg_dt" style="left:100px; top:129px; width:190px; height:18px; text-align:center; "/>
			<caption id="caption1" class="list_cap01" style="left:0px; top:125px; width:95px; height:26px; text-align:center; ">등록일자</caption>
			<select1 id="combo2" ref="/root/resData/resForm/expn_clsf_cd" class="req" appearance="minimal" caption="지출구분" style="left:100px; top:30px; width:190px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/expn_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
						<pcode ref="pcode"/>
						<pcode ref="pcode2"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
						
						var expn_clsf = combo2.value;
						var pcode2 = model1.getValue("/root/initData/comboSet/expn_clsf/item["+idx+"]/pcode2");  
				
						if(expn_clsf != ""){
							if(checkbox1.value == "20" ){ //배우자 적용일 경우 배우자한도액을 뿌려준다.
								var idx = combo2.focusIndex+1;		
								var pcode2 = model1.getValue("/root/initData/comboSet/expn_clsf/item["+idx+"]/pcode2");  
								
								model.setValue("/root/resData/resForm/limt_amt",pcode2);	
							}else{
							var idx = combo2.focusIndex+1;		
							var pcode = model1.getValue("/root/initData/comboSet/expn_clsf/item["+idx+"]/pcode");  							
				
							 model.setValue("/root/resData/resForm/limt_amt",pcode);	
							}		
						}else{
							model.setValue("/root/resData/resForm/limt_amt","");
						}			
						model.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						setExcl_amt2(); // 남은한도액 조회
						var getComboValue = combo2.value;
						model1.setValue("/root/reqData/searchData/mang_cd_1", getComboValue);
				
						model1.send("hd_affr_9704");
						model1.copyNode("/root/initData/comboSet/resn_cd_1", "/root/tempData/GETCONDONM");
						model1.copyNode("/root/initData/comboSet/resn_cd_2", "/root/tempData/GETCONDONM");
						model1.removenode("/root/tempData");	
						combo4.refresh();
						combo4.select(0);
						combo5.refresh();
						combo5.select(0);
						input2.value = '';
						input12.value = '';
						input8.value = '';

					]]>
				</script>
			</select1>
			<input id="input2" ref="/root/resData/resForm/clam_amt" class="req" maxlength="20" format="##,###" caption="청구액" style="left:100px; top:79px; width:190px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var clam_amt = model1.getValue("/root/resData/resForm/clam_amt"); // 청구액 
						var sply_amt = model1.getValue("/root/resData/resForm/sply_amt");  // 지원액
					    var excl_amt = model1.getValue("/root/resData/resForm/excl_amt");  // 제외액  
						
						if(sply_amt  != "")
						{
							excl_amt   =  clam_amt - sply_amt  ;
							model1.setValue( "/root/resData/resForm/excl_amt", excl_amt) ;
							input8.refresh();

						}
						
					]]>
				</script>
			</input>
			<input id="input3" ref="/root/resData/resForm/str_dt" class="req" navindex="1" inputtype="date" format="yyyy-mm-dd" caption="기간(시작일)" style="left:716px; top:30px; width:85px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var str_dt = model1.getValue("/root/resData/resForm/str_dt"); 
						var end_dt = model1.getValue("/root/resData/resForm/end_dt"); 

						
						if(end_dt != "")
						{
							if(str_dt > end_dt ) 
							{
								 alert("종료일이 시작일 보다 늦을 수 없습니다..");
								 model1.setValue("/root/resData/resForm/end_dt","");
								 input11.value = ""; 
								return;
							}
						}
						setExcl_amt2(); // 남은한도액 조회
					]]>
				</script>
			</input>
			<caption id="caption2" class="list_cap02" style="left:89px; top:100px; width:296px; height:26px; font-weight:bold; text-align:center; "/>
			<select1 id="dank_cd" ref="/root/resData/resForm/bank_cd" disabled="true" appearance="minimal" style="left:100px; top:104px; width:153px; height:18px; text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/bank_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<caption id="caption5" class="list_cap01" style="left:0px; top:100px; width:95px; height:26px; text-align:center; ">은행명</caption>
			<caption id="caption8" class="list_cap01" style="left:310px; top:100px; width:95px; height:26px; text-align:center; ">계좌번호</caption>
			<caption id="caption19" class="list_cap01" style="left:0px; top:75px; width:95px; height:26px; text-align:center; ">청구액</caption>
			<caption id="caption17" class="list_cap01" style="left:617px; top:100px; width:95px; height:26px; text-align:center; ">입금주</caption>
			<caption id="caption20" class="list_cap01" style="left:310px; top:125px; width:95px; height:26px; text-align:center; ">결산기수</caption>
			<input id="input5" ref="/root/resData/resForm/deps_per" maxlength="20" style="left:716px; top:104px; width:195px; height:18px; text-align:left; "/>
			<input id="input6" ref="/root/resData/resForm/acct_no" disabled="true" maxlength="20" style="left:410px; top:104px; width:200px; height:18px; text-align:center; "/>
			<line id="line1" style="x1:190px; y1:10px; x2:185px; y2:20px; "/>
			<input id="input10" ref="/root/resData/resForm/spos_name" disabled="true" maxlength="20" style="left:410px; top:5px; width:150px; height:18px; text-align:left; "/>
			<input id="input11" ref="/root/resData/resForm/end_dt" class="req" navindex="1" inputtype="date" format="yyyy-mm-dd" caption="기간(종료일)" style="left:826px; top:30px; width:85px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var str_dt = model1.getValue("/root/resData/resForm/str_dt"); 
						var end_dt = model1.getValue("/root/resData/resForm/end_dt"); 

						
						if(end_dt != "")
						{
							if(str_dt > end_dt ) 
							{
								 alert("종료일이 시작일 보다 늦을 수 없습니다..");
								 model1.setValue("/root/resData/resForm/end_dt","");
								 input11.value = ""; 
								return;
							}
						}
						setExcl_amt2(); // 남은한도액 조회
					]]>
				</script>
			</input>
			<input id="input4" ref="/root/resData/resForm/mang_no" class="req" disabled="false" maxlength="20" style="left:100px; top:5px; width:80px; height:18px; text-align:left; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[

						if (event.keyCode ==13){
							if(input4.currentText==""){
								alert("조회할 관리번호가 없습니다.");
								model1.reset();
								return;
							}else{
								model1.removenode("/root/tempData");
								model1.makeNode("/root/tempData");
													
							//	setInfoSearchInput("", input1.currentText, "","setEmp_no"); // 사번, 성명, 주민번호
							    setMang_no() ;
							
								if(model1.getValue("/root/tempData/totalcnt") != 1){	
									model1.removenode("/root/tempData");
									model1.makeNode("/root/tempData");
									return;
								}else{
									model1.setValue("/root/reqData/searchData/mang_no", model1.getValue("/root/tempData/mang_no")); // 사번
									model1.setValue("/root/reqData/searchData/flnm", model1.getValue("/root/tempData/flnm")); // 성명
									//조회
								//	searchDate();
								}
							}
						}
					]]>
				</script>
			</input>
			<input id="input9" ref="/root/resData/resForm/expn_cont" maxlength="20" style="left:409px; top:30px; width:200px; height:18px; text-align:left; "/>
			<input id="input12" ref="/root/resData/resForm/sply_amt" class="req" format="##,###" caption="지원액" style="left:716px; top:79px; width:195px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						 setExcl_amt();
					]]>
				</script>
			</input>
			<caption id="caption23" class="list_cap01" style="left:617px; top:75px; width:95px; height:26px; text-align:center; ">지원액</caption>
			<caption id="caption24" style="left:809px; top:31px; width:20px; height:20px; ">~</caption>
			<caption id="caption25" class="list_cap01" style="left:617px; top:125px; width:95px; height:26px; text-align:center; ">비고</caption>
			<input id="input7" ref="/root/resData/resForm/remk" maxlength="20" style="left:716px; top:129px; width:195px; height:18px; text-align:left; "/>
			<select id="checkbox1" ref="/root/resData/resForm/aply_obj_clsf" overflow="visible" appearance="full" style="left:564px; top:5px; width:41px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>적용</label>
						<value>20</value>
					</item>
				</choices>
				<script type="javascript" ev:event="onclick">
					<![CDATA[					
						combo2.value = '';
						input2.value = '';
						input8.value = '';
						input12.value = '';
						
						 model.setValue("/root/resData/resForm/limt_amt","");	
						if(checkbox1.value.substring(3,5) == "20" )
						{
							//model1.setValue("/root/resData/resForm/aply_obj_clsf","20");
							output1.value = model.getValue("/root/resData/resForm/spos_name");
						}else 
						{	
							output1.value = model.getValue("/root/resData/resForm/flnm");
						}
						checkbox1.refresh();
						output1.refresh();
					]]>
				</script>
			</select>
			<input id="input13" ref="/root/resData/resForm/limt_amt" disabled="true" format="##,###" style="left:410px; top:79px; width:92px; height:18px; text-align:right; "/>
			<caption id="caption26" style="left:505px; top:79px; width:20px; height:20px; ">/</caption>
			<output id="output1" ref="/root/resData/resForm/aply_obj_name" visibility="hidden" style="left:605px; top:5px; width:15px; height:18px; "/>
			<output id="output3" ref="/root/resData/resForm/seq" visibility="hidden" style="left:295px; top:5px; width:15px; height:18px; "/>
			<caption id="caption28" class="list_cap02" style="left:0px; top:50px; width:312px; height:26px; text-align:center; "/>
			<caption id="caption27" class="list_cap01" style="left:0px; top:50px; width:95px; height:26px; text-align:center; ">지원근거1</caption>
			<caption id="caption32" class="list_cap02" style="left:395px; top:50px; width:531px; height:26px; text-align:center; "/>
			<caption id="caption29" class="list_cap01" style="left:310px; top:50px; width:95px; height:26px; text-align:center; ">지원근거2</caption>
			<caption id="caption33" class="list_cap01" style="left:617px; top:50px; width:95px; height:26px; text-align:center; ">남은한도액</caption>
			<select1 id="combo4" ref="/root/resData/resForm/expn_resn_cd1" appearance="minimal" style="left:100px; top:54px; width:190px; height:18px; text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/resn_cd_1/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<select1 id="combo5" ref="/root/resData/resForm/expn_resn_cd2" appearance="minimal" style="left:410px; top:54px; width:200px; height:18px; text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/resn_cd_2/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<input id="input14" ref="/root/resData/resForm/stlm_desty" disabled="true" maxlength="20" style="left:410px; top:130px; width:200px; height:18px; text-align:center; "/>
			<input id="input16" ref="/root/resData/resForm/left_limit_amt" class="req" disabled="true" format="##,###" caption="남은한도액" style="left:715px; top:54px; width:195px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						 setExcl_amt();
					]]>
				</script>
			</input>
			<select id="checkbox2" ref="/root/resData/resForm/cash_payment" overflow="visible" appearance="full" style="left:264px; top:104px; width:41px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>현금</label>
						<value>20</value>
					</item>
				</choices>
				<script type="javascript" ev:event="onclick">
					<![CDATA[					 
						if(checkbox2.value=="20")
						{	
							alert("111");
							model.setValue("/root/resData/resForm/bank_cd","");	
							model.setValue("/root/resData/resForm/acct_no","");	
						}else 
						{	
							alert("222");
							if(input1.currentText!=""){ 
								setMang_no();
							}
						}
						//input6.refresh();
						model.refresh();
						//checkbox2.refresh();
						//output1.refresh();
					]]>
				</script>
			</select>
		</group>
		<caption id="caption10" class="tit02" style="left:10px; top:151px; width:85px; height:20px; font-weight:bold; ">등록사항</caption>
		<button id="button1" class="btn02" style="left:562px; top:47px; width:52px; height:21px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var mang_no = model.getValue("/root/resData/resForm/mang_no");
					if (mang_no == ""){
						alert("관리번호를  입력해 주십시오."); return;
					}
					var flnm = model.getValue("/root/resData/resForm/flnm");
					if (flnm == ""){
						alert("성명을 입력해 주십시오."); return;
					}
					
					if(!commConfirmBox("삭제 하시겠습니까?")) return;
					model.setValue("/root/resData/resForm/mode","D");
					model.send("hd_affr_9602_a");
					
					if(submit_completed()) {
						loadData();

					}
				]]>
			</script>
		</button>
		<button id="button4" class="btn02" style="left:619px; top:47px; width:52px; height:21px; ">
			<caption>마감</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						var check_cnt = "";
						var check_expn = "";
						var check_oz = "";
						var check_expn2 = "";
						for (var i=1; i<datagrid2.rows; i++){
							if (datagrid2.valueMatrix(i, datagrid2.colRef("chkbox")) == "1"){
								// 10만 등록취소 가능
								check_cnt = "1";
								//if(model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf") != "10"){ 120207
								if(model1.getValue("/root/resData/gridData/record["+i+"]/proc_stat") == "30" || model1.getValue("/root/resData/gridData/record["+i+"]/proc_stat") == "40"){
									model.removenode("/root/resData");
									model.refresh();
									alert("이미 마감이 된 데이터가 있습니다.");
									return;
								}
							}
						}
						// 동일한 관리번호만 체크하여야 마감클릭 가능  
						var arr = new Array();
						for (var i=1; i<datagrid2.rows; i++){
							if (datagrid2.valueMatrix(i, datagrid2.colRef("chkbox")) == "1"){
								arr.push(i)
							}
						}
						for(var i=0; i<arr.length; i++){
							for(var j=i+1; j<arr.length; j++){
								if(datagrid2.valueMatrix(arr[i], datagrid2.colRef("mang_no")) != datagrid2.valueMatrix(arr[j], datagrid2.colRef("mang_no"))){
									alert("동일한 관리번호만 마감할 수 있습니다.");							
									return;
								}
							}
						}	
						//조우회장 지출구분과 다른 지출구분을 선택할 수 없게 막아놓기
						for (var i=1; i<datagrid2.rows; i++){
							if (datagrid2.valueMatrix(i, datagrid2.colRef("chkbox")) == "1"){
								if (datagrid2.valueMatrix(i, datagrid2.colRef("expn_clsf_cd")) == "40"){ //조우회장 지출구분
									check_expn = "1";
								}else{
									check_expn2 = "1";
								}
							}
						}
						
						// 지출구분이 조우회장일때만 HD_AFFR_9705, 아닐경우 HD_AFFR_9702 오즈파일 선택
						for (var i=1; i<datagrid2.rows; i++){
							if (datagrid2.valueMatrix(i, datagrid2.colRef("chkbox")) == "1"){
								if (datagrid2.valueMatrix(i, datagrid2.colRef("expn_clsf_cd")) == "40"){ //조우회장 지출구분
									check_oz = "1";
								}else{
									check_oz = "2";
								}
							}
						}
						if(check_cnt != "1"){
							alert("마감 할 데이터를 선택해 주세요.");
							return;
						}
						
						if(check_expn == "1" && check_expn2 == "1"){
							alert("조우회장 지출구분과 다른 지출구분을 마감할 수 없습니다.");
							return;
						}
						
						if (!commGridReqCheck("datagrid2"))
						return;

						if (window.alert("마감하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						model1.setValue("/root/reqData/proc_gubun", "30");
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());				

						model1.send("hd_affr_9703_a");

						var proc_no = model1.getValue("/root/tempData/CURLIST/record/proc_no");
	
						//model1.removenode("/root/slipNoData/proc_no");
						//model1.makeValue("/root/slipNoData/proc_no",proc_no);
						//model1.removenode("/root/tempData");
						if(submit_completed()) {
							model1.resetInstanceNode("/root/reqData/reqForm");
							model1.removeNode("/root/reqData");
							//model1.reset();
							loadData();
							var ss_cmpy_cd = getProperty("ss_cmpycd");						 						
						 	var ss_emp_no = getProperty("ss_emp_no");

						 	//var proc_no = model1.getValue("/root/slipNoData/proc_no");
							
							// 오즈관련 노드 초기화..
						 	resetOznode();					
						 	// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)		
							
							
							if (check_oz == "1"){
								makeNodeValue("/root/oz_data/ozrName","hd/HD_AFFR_9705");
							}else{
								makeNodeValue("/root/oz_data/ozrName","hd/HD_AFFR_9702");
							}
							makeNodeValue("/root/oz_data/preview","preview");
							//model.makeNode("/root/oz_data/printsize");
							makeNodeValue("/root/oz_data/printsize","B5 (JIS)"); 		//페이지용지설정(기본 A4)
						 	makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd",ss_cmpy_cd);	
							makeNodeValue("/root/oz_data/odiParam/iv_proc_no",proc_no);	
							makeNodeValue("/root/oz_data/odiParam/iv_incmg_pers",ss_emp_no);					
							// 레포트뷰어 호출.
						 	openOzwin("/root/oz_data");
	
						}	
						
					]]>
			</script>
		</button>
		<button id="button6" class="btn03" style="left:674px; top:47px; width:62px; height:21px; ">
			<caption>마감취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						var check_cnt = "";
						for (var i=1; i<datagrid2.rows; i++){
							if (datagrid2.valueMatrix(i, datagrid2.colRef("chkbox")) == "1"){
								// 10만 등록취소 가능
								check_cnt = "1";
								//if(model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf") != "10"){ 120207
								if(model1.getValue("/root/resData/gridData/record["+i+"]/proc_stat") != "30"){
									alert("마감취소 할 데이터만 선택해 주세요.");
									return;
								}
							}
						}
						if(check_cnt != "1"){
							alert("마감취소 할 데이터를 선택해 주세요.");
							return;
						}
						
						if (window.alert("마감취소 하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						//model1.setValue("/root/reqData/mode_gubun", "13"); 120207
						model1.setValue("/root/reqData/proc_gubun", "20");
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
												
						model1.send("hd_affr_9703_a");
						if(submit_completed()) {
							//model1.reset();
							model1.removeNode("/root/reqData");
							loadData();
						}	
						
					]]>
			</script>
		</button>
		<button id="button7" class="btn02" style="left:739px; top:47px; width:52px; height:21px; ">
			<caption>장표출력</caption>
			<script type="javascript" ev:event="DOMActivate">
				<![CDATA[
						//model.removenode("/root/resData");

						var slip_no = model1.getValue("/root/reqData/searchData/slip_no");
						var check_oz = "";
						
						if(slip_no == "") {
							alert("전표번호는 필수 입력 항목입니다.");
							return;
						}

						loadData();
						// 지출구분이 조우회장일때만 HD_AFFR_9705, 아닐경우 HD_AFFR_9702 오즈파일 선택
						for (var i=1; i<datagrid2.rows; i++){
							if (datagrid2.valueMatrix(i, datagrid2.colRef("expn_clsf_cd")) == "40"){ //조우회장 지출구분
								check_oz = "1";
							}else{
								check_oz = "2";
							}							
						}
						if(check_oz == ""){
							alert("전표번호가 존재하지 않습니다.");
							return;
						}
						var ss_cmpy_cd = getProperty("ss_cmpycd");						 						
					 	var ss_emp_no = getProperty("ss_emp_no");

					 	//var proc_no = model1.getValue("/root/slipNoData/proc_no");
						
						// 오즈관련 노드 초기화..
					 	resetOznode();					
					 	// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)		
											
						if (check_oz == "1"){
							makeNodeValue("/root/oz_data/ozrName","hd/HD_AFFR_9705");
						}else{
							makeNodeValue("/root/oz_data/ozrName","hd/HD_AFFR_9702");
						}
						makeNodeValue("/root/oz_data/preview","preview");
						//model.makeNode("/root/oz_data/printsize");
						makeNodeValue("/root/oz_data/printsize","B5 (JIS)"); 		//페이지용지설정(기본 A4)
					 	makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd",ss_cmpy_cd);	
						makeNodeValue("/root/oz_data/odiParam/iv_proc_no",slip_no);	
						makeNodeValue("/root/oz_data/odiParam/iv_incmg_pers",ss_emp_no);					
						// 레포트뷰어 호출.
					 	openOzwin("/root/oz_data");
				]]>
			</script>
		</button>
		<caption id="caption41" ref="/root/resData/totcnt" style="left:848px; top:690px; width:87px; height:20px; font-weight:bold; text-align:right; "/>
	</xhtml:body>
</xhtml:html>
