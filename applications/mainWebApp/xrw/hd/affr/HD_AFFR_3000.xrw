<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet ype="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<pageInfo/>
						<comboSet>
						</comboSet>
					</initData>
					<tempData/>
					<reqData>
						<searchData>
							<emp_no/>
							<flnm/>
							<dept_cd/>
							<dept_nm/>
							<fr_lvcmpy_dt/>
							<to_lvcmpy_dt/>
							<srch_emp_no/>
						</searchData>
						<reqForm>
							<emp_no/>
							<flnm/>
							<dept_nm/>
							<dty_nm/>
							<posi_nm/>
							<open_invit_desty/>
							<in_cmpy_dt/>
							<lvcmpy_dt/>
							<lvcmpy_resn_cd/>
							<zip_temp/>
							<addr/>
							<dtls_addr/>
							<tel_no/>
							<ptph_no/>
							<cur_dty_nm/>
							<seq/>
							<occr_dt/>
							<dept_cd/>
							<dty_cd/>
							<posi_cd/>
							<zip_1/>
							<zip_2/>
							<lvcmpy_resn_nm/>
						</reqForm>
						<multiUpData/>
						<fwdData>
							<func_nm/>
						</fwdData>
					</reqData>
					<resData>
						<gridData>
							<record>
								<emp_no/>
								<flnm/>
								<dept_nm/>
								<dty_nm/>
								<posi_nm/>
								<open_invit_desty/>
								<in_cmpy_dt/>
								<lvcmpy_dt/>
								<lvcmpy_resn_cd/>
								<zip_temp/>
								<addr/>
								<dtls_addr/>
								<tel_no/>
								<ptph_no/>
								<cur_dty_nm/>
								<seq/>
								<occr_dt/>
								<dept_cd/>
								<dty_cd/>
								<posi_cd/>
								<zip_1/>
								<zip_2/>
							</record>
						</gridData>
						<resForm>
							<record/>
						</resForm>
					</resData>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					defaultPage();
				]]>
			</script>
			<script type="javascript">
				<![CDATA[
					String.prototype.trim = function()
					 {
					   return this.replace(/(^\s*)|(\s*$)/gi, "");
					 }
					 String.prototype.replaceAll = function(str1, str2)
					 {
					   var temp_str = "";
					   if (this.trim() != "" && str1 != str2)
					   {
					     temp_str = this.trim();
					     while (temp_str.indexOf(str1) > -1)
					     {
					       temp_str = temp_str.replace(str1, str2);
					     }
					   }
					   return temp_str;
					  }
				
					function roomDay(){	
						var v1 = model1.getValue("/root/reqData/reqForm/use_frdt");
						var v2 = model1.getValue("/root/reqData/reqForm/use_todt");
						if(v1 < v2 ){
							var day_dds = dayDiff(v1,v2);
							model1.setValue("/root/reqData/reqForm/use_dds",day_dds);
							model1.refresh();
						}else{
							model1.setValue("/root/reqData/reqForm/use_dds","0");
							model1.refresh();
						}								  
					}		
					
					 function dayDiff(v1,v2){ 
					 	if(v1 != "" && v2 != ""){
							var sdate = new Date(v1.substring(0,4),v1.substring(4,6),v1.substring(6,8));  
						 	var edate = new Date(v2.substring(0,4),v2.substring(4,6),v2.substring(6,8));  
							return  Math.ceil((edate - sdate) / 1000 / 24 / 60 / 60); 
					 	}
					  }								

					function setEmp_noForm(emp_no, nm_korn){                                
 						model1.setValue("/root/reqData/reqForm/emp_no", emp_no);               
						insertForm(emp_no,""); 
 						if(submit_completed()) {
 							chk_lev_emp(emp_no);
 						}						
						model1.refresh();
					}                                                                           
                    
					function searchEmpno(){
						model1.resetInstanceNode("/root/reqData/reqForm");
						model1.send("hd_affr_2800");
						var emp_no = model1.getValue("/root/tempData/record/emp_no");             
						var flnm = model1.getValue("/root/tempData/record/flnm");                 
//						var dept_nm = model1.getValue("/root/tempData/record/dept_nm");           
//						var dept_cd = model1.getValue("/root/tempData/record/dept_cd");           
//						var dty_nm = model1.getValue("/root/tempData/record/dty_nm");             
//						var dty_cd = model1.getValue("/root/tempData/record/dty_cd");             
//						var posi_nm = model1.getValue("/root/tempData/record/posi_nm");           
//						var posi_cd = model1.getValue("/root/tempData/record/posi_cd");    
//						 
//				               var nm_engl = model1.getValue("/root/tempData/record/nm_engl");
//				               var aplc_offi_nm = model1.getValue("/root/tempData/record/aplc_offi_nm");
//				               var ptph_no = model1.getValue("/root/tempData/record/ptph_no");
//				               var email_id = model1.getValue("/root/tempData/record/email_id");
//				               var tel_no = model1.getValue("/root/tempData/record/tel_no");
//				               var fax_no = model1.getValue("/root/tempData/record/fax_no");
				               				               						                                                                          
						model1.setValue("/root/reqData/reqForm/emp_no",emp_no);                   
						model1.setValue("/root/reqData/reqForm/flnm",flnm);                       
//						model1.setValue("/root/reqData/reqForm/dept_cd",dept_cd);                 
//						model1.setValue("/root/reqData/reqForm/dty_cd",dty_cd);                   
//						model1.setValue("/root/reqData/reqForm/posi_cd",posi_cd);                 
//						model1.setValue("/root/reqData/reqForm/dept_nm",dept_nm);                 
//						model1.setValue("/root/reqData/reqForm/dty_nm",dty_nm);                   
//						model1.setValue("/root/reqData/reqForm/posi_nm",posi_nm);          
//						model1.setValue("/root/reqData/reqForm/aplc_engl_flnm",nm_engl);
//						model1.setValue("/root/reqData/reqForm/aplc_offi_nm",aplc_offi_nm);
//						model1.setValue("/root/reqData/reqForm/ceph_no",ptph_no);
//						model1.setValue("/root/reqData/reqForm/email",email_id);
//						model1.setValue("/root/reqData/reqForm/aplc_flnm",flnm);
////						model1.setValue("/root/reqData/reqForm/dept_cd",dept_cd);
//						model1.setValue("/root/reqData/reqForm/aplc_dept_nm",dept_nm);
////						model1.setValue("/root/reqData/reqForm/dty_cd",dty_cd);
//						model1.setValue("/root/reqData/reqForm/aplc_dty_nm",dty_nm);
//						model1.setValue("/root/reqData/reqForm/tel_no",tel_no);
//						model1.setValue("/root/reqData/reqForm/fax_no",fax_no);
						model1.refresh();
					}
					 				
					function setEmp_no(emp_no, flnm){
						model1.setValue("/root/reqData/searchData/emp_no", emp_no);
						model1.setValue("/root/reqData/searchData/flnm", flnm);
						model1.refresh(); 
					}
						function setDept_cd(dept_cd, dept_nm) {
						      model1.setValue("/root/reqData/searchData/dept_cd", dept_cd);
						      model1.setValue("/root/reqData/searchData/dept_nm", dept_nm);
						      model1.refresh(); 
					     } 									
					
 
					
						//오늘 날짜
						function todaydate(val){
							var e_date = new Date();
							var year = e_date.getFullYear(); 
							var month = e_date.getMonth() + 1;
							var day = e_date.getDate();
							if (("" + month).length==1){month = "0"+month;}
							if (("" + day).length==1){day = "0"+day;}
							if(val == '-'){
								e_date = year+""+month+""+day;
							}
							else{
								e_date = year+"-"+month+"-"+day;
							}
							return e_date;
						}			
						//한달후 날짜	
						function monthdate(val){
						 m = 1+parseInt(val);
						 var f_date = "";
						 var cDate=new Date();
						 var year=cDate.getYear();
						 var month=(cDate.getMonth()+ (parseInt(m))).toString();
						 month = month.length==1?"0"+month:month;
						 if (month=="00"){
						  month="12";
						  year--;
						 }
						 var day=cDate.getDate().toString();
						 day = day.length==1?"0"+day:day;
						 f_date = year+month+day;
						 return f_date;  
						}	

						function defaultPage(){
							datagrid2.addStatus(1, "insert");
							var to_day = monthdate(-1);
							var mon_date = monthdate(1);
							to_day = to_day.replaceAll("-","");
							mon_date = mon_date.replaceAll("-","");
							//model1.setValue("/root/reqData/searchData/fr_occr_dt",to_day);
							//model1.setValue("/root/reqData/searchData/to_occr_dt",mon_date);
							model1.refresh();	
						}	
						
						function chkempno(){
							var rowIdx =datagrid2.row;			
							var emp_no = datagrid2.valueMatrix(rowIdx,2);
							if(emp_no  == ""){
								alert("사번을 넣어주세요");
								model1.setValue("/root/reqData/searchData/emp_no","" );
								return;
								
								}
							model1.setValue("/root/reqData/searchData/grid_emp_no",emp_no );
							model1.send("hd_affr_2901");
							model1.copyNode("/root/resData/resForm/record","/root/tempData/record");
							var totalcnt = model1.getValue("/root/tempData/totalcnt");
							if(totalcnt == 0 ){
								alert("검색결과가 없습니다");
								model1.setValue("/root/reqData/searchData/grid_emp_no","" );
								model1.setValue("/root/reqData/searchData/grid_flnm","" );
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/emp_no", "");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/flnm", "");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_cd", "");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_cd", "");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_cd", "");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_nm", "");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_nm", "");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_nm", "");
								model1.refresh();
								return;
							}
							
							var emp_no = model1.getValue("/root/resData/resForm/record/emp_no");
							var flnm = model1.getValue("/root/resData/resForm/record/flnm");
							var dept_cd = model1.getValue("/root/resData/resForm/record/dept_cd");
							var dept_nm = model1.getValue("/root/resData/resForm/record/dept_nm");
							var dty_cd = model1.getValue("/root/resData/resForm/record/dty_cd");
							var dty_nm = model1.getValue("/root/resData/resForm/record/dty_nm");
							var posi_cd = model1.getValue("/root/resData/resForm/record/posi_cd");
							var posi_nm = model1.getValue("/root/resData/resForm/record/posi_nm");
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/emp_no", emp_no);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/flnm", flnm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_cd", dept_cd);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_nm", dept_nm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_cd", dty_cd);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_nm", dty_nm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_cd", posi_cd);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_nm", posi_nm);
							model1.refresh();		
						}	 
					
						function chkflnm(){
							var rowIdx =datagrid2.row;					
							var flnm = datagrid2.valueMatrix(rowIdx,3);
							model1.setValue("/root/reqData/searchData/grid_flnm",flnm );
							model1.send("hd_affr_2901");				
							model1.copyNode("/root/resData/resForm/record","/root/tempData/record");
							var totalcnt = model1.getValue("/root/tempData/totalcnt");
							if(totalcnt == 0){
								alert("검색결과가 없습니다");
								model1.setValue("/root/reqData/searchData/grid_emp_no","" );
								model1.setValue("/root/reqData/searchData/grid_flnm","" );
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/emp_no", "");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/flnm", "");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_cd", "");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_cd", "");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_cd", "");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_nm", "");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_nm", "");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_nm", "");
								model1.refresh();
								return;
							}					
							if(totalcnt > 1){
								model1.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
								window.load("/xrw/hd/com/hd_com_1000.xrw","mdichild", "hd_com_1000", "", "/root/reqData/fwdData", "/root/reqData/fwdData");
								return;
							
							}
							
							var emp_no = model1.getValue("/root/resData/resForm/record/emp_no");
							var flnm = model1.getValue("/root/resData/resForm/record/flnm");
							var dept_cd = model1.getValue("/root/resData/resForm/record/dept_cd");
							var dept_nm = model1.getValue("/root/resData/resForm/record/dept_nm");
							var dty_cd = model1.getValue("/root/resData/resForm/record/dty_cd");
							var dty_nm = model1.getValue("/root/resData/resForm/record/dty_nm");
							var posi_cd = model1.getValue("/root/resData/resForm/record/posi_cd");
							var posi_nm = model1.getValue("/root/resData/resForm/record/posi_nm");
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/emp_no", emp_no);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/flnm", flnm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_cd", dept_cd);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_nm", dept_nm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_cd", dty_cd);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_nm", dty_nm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_cd", posi_cd);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_nm", posi_nm);
							model1.refresh();		
						
						}		
						

						
						function se_openZip(bogb, zip1Ref, zip2Ref, addrRef){
						
							var tempReq = "/root/tempData/posttemp";
							if(instance1.selectSingleNode(tempReq) == null){
								model.makeNode(tempReq);
							}
							tempReq = "/root/tempData/posttemp/send";
							if(instance1.selectSingleNode(tempReq) == null){
								model.makeNode(tempReq);
							}
							tempReq = "/root/tempData/posttemp/send/zip";
							if(instance1.selectSingleNode(tempReq) == null){
								model.makeNode(tempReq);
							}
							tempReq = "/root/tempData/posttemp/send/disp_flag";
							if(instance1.selectSingleNode(tempReq) == null){
								model.makeNode(tempReq);
							}
							tempReq = "/root/tempData/posttemp/recv";
							if(instance1.selectSingleNode(tempReq) == null){
								model.makeNode(tempReq);
							}
							
							//"L"이면 지국항목 안보임
							model.setValue("/root/tempData/posttemp/send/disp_flag", bogb);
							model.setValue("/root/tempData/posttemp/send/zip", model.getValue(zip1Ref)+model.getValue(zip2Ref));
							openZip("/root/tempData/posttemp/send", "/root/tempData/posttemp/recv","new");
							
							model.setValue(zip1Ref, model.getValue("/root/tempData/posttemp/recv/zip1"));
							model.setValue(zip2Ref, model.getValue("/root/tempData/posttemp/recv/zip2"));
							model.setValue(addrRef, model.getValue("/root/tempData/posttemp/recv/addr"));
							
							model.refresh();
						
						}
						
						function insertForm(emp_no,flnm){
	 						model1.setValue("/root/reqData/reqForm/emp_no",emp_no);		
	 						model1.setValue("/root/reqData/reqForm/flnm",flnm);		
	 						model1.send("hd_affr_3000");
	 						var totalcnt = model1.getValue("/root/tempData/totalcnt");
	 						if(totalcnt == 0){
	 							alert("퇴직사원이 아닙니다.");
	 							model1.resetInstanceNode("/root/reqData/reqForm");
		 						return;
		 					}
							var emp_no = model1.getValue("/root/tempData/record/emp_no");
	 						var flnm = model1.getValue("/root/tempData/record/flnm");
	 						var dept_cd = model1.getValue("/root/tempData/record/dept_cd");
	 						var dept_nm = model1.getValue("/root/tempData/record/dept_nm");
	 						var dty_cd = model1.getValue("/root/tempData/record/dty_cd");
	 						var dty_nm = model1.getValue("/root/tempData/record/dty_nm");
	 						var posi_cd = model1.getValue("/root/tempData/record/posi_cd");
	 						var posi_nm = model1.getValue("/root/tempData/record/posi_nm");
	 						
	 						var open_invit_desty = model1.getValue("/root/tempData/record/open_invit_desty");
	 						var in_cmpy_dt = model1.getValue("/root/tempData/record/in_cmpy_dt");
	 						var lvcmpy_dt = model1.getValue("/root/tempData/record/lvcmpy_dt");
	 						var lvcmpy_resn_cd = model1.getValue("/root/tempData/record/lvcmpy_resn_cd");
	 						var lvcmpy_resn_nm = model1.getValue("/root/tempData/record/lvcmpy_resn_nm");
	 						
	 						var zip_1 = model1.getValue("/root/tempData/record/zip_1");
	 						var zip_2 = model1.getValue("/root/tempData/record/zip_2");
	 						var addr = model1.getValue("/root/tempData/record/addr");
	 						var dtls_addr = model1.getValue("/root/tempData/record/dtls_addr");


							model1.setValue("/root/reqData/reqForm/emp_no",emp_no);
							model1.setValue("/root/reqData/reqForm/flnm",flnm);
							model1.setValue("/root/reqData/reqForm/dept_cd",dept_cd);
							model1.setValue("/root/reqData/reqForm/dept_nm",dept_nm);
							model1.setValue("/root/reqData/reqForm/dty_cd",dty_cd);
							model1.setValue("/root/reqData/reqForm/dty_nm",dty_nm);
							model1.setValue("/root/reqData/reqForm/posi_cd",posi_cd); 
							model1.setValue("/root/reqData/reqForm/posi_nm",posi_nm); 	
							
							model1.setValue("/root/reqData/reqForm/open_invit_desty",open_invit_desty); 	
							model1.setValue("/root/reqData/reqForm/in_cmpy_dt",in_cmpy_dt); 	
							model1.setValue("/root/reqData/reqForm/lvcmpy_dt",lvcmpy_dt); 	
							model1.setValue("/root/reqData/reqForm/lvcmpy_resn_cd",lvcmpy_resn_cd); 	
							model1.setValue("/root/reqData/reqForm/lvcmpy_resn_nm",lvcmpy_resn_nm); 	

							model1.setValue("/root/reqData/reqForm/zip_1",zip_1); 	
							model1.setValue("/root/reqData/reqForm/zip_2",zip_2); 	
							model1.setValue("/root/reqData/reqForm/addr",addr); 	
							model1.setValue("/root/reqData/reqForm/dtls_addr",dtls_addr); 	
						} 						
						function searchList(){
							model1.send("hd_affr_3001");
							model1.copyNode("/root/resData/gridData", "/root/tempData");
							datagrid2.clearStatus();
							model1.resetInstanceNode("/root/reqData/reqForm");
							model1.refresh();
//							gridrowcnt.value = "[총 "+ (parseInt(datagrid2.rows)- 1) + "건]";							
							gridrowcnt.value = "[총 "+ model.getValue("/root/resData/gridData/totalcnt") + "건]";
							model1.refresh();
						}
						
						function chk_lev_emp(emp_no){
							model1.setValue("/root/reqData/searchData/srch_emp_no",emp_no);
							model1.send("hd_affr_3003");
							var r_cnt = model1.getValue("/root/tempData/CURLIST/record/cnt");
							if(Number(r_cnt) >= 1){
								alert("이미 등록된 사원입니다");	
								model1.resetInstanceNode("/root/reqData/reqForm");
								return;
							}
						}
						
					function setEmp_no(emp_no, flnm){
						model1.setValue("/root/reqData/searchData/emp_no", emp_no);
						model1.setValue("/root/reqData/searchData/flnm", flnm);
						model1.refresh(); 
					}
					function setEmp_no2(emp_no, flnm){
 						model1.resetInstanceNode("/root/reqData/reqForm");
 						insertForm(emp_no,"");	
 						if(submit_completed()) {
 							chk_lev_emp(emp_no);
 						}
 						model1.refresh();
					}
				]]>
			</script>
			<submission id="hd_affr_3000" action="/hd/affr/3000/" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="hd_affr_3001" action="/hd/affr/3001/" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_affr_3002" action="/hd/affr/3002/" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpData" resultref="/root/tempData"/>
			<submission id="hd_affr_3003" action="/hd/affr/3003/" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_com_1103" action="/hd/com/1103" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/dept_cd" resultref="/root/tempData"/>
		</model>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/CRMComm.js"/>
	</xhtml:head>
	<xhtml:body pagewidth="946" pageheight="728" guideline="1,1;">
		<caption id="caption19" class="list_cap02" style="left:85px; top:70px; width:851px; height:26px; "/>
		<caption id="caption1" class="list_cap03" style="left:10px; top:70px; width:80px; height:26px; ">퇴사기간</caption>
		<caption id="caption3" class="list_cap03" style="left:595px; top:70px; width:80px; height:26px; ">부서명</caption>
		<input id="input2" ref="/root/reqData/searchData/fr_lvcmpy_dt" inputtype="date" style="left:95px; top:74px; width:85px; height:18px; "/>
		<input id="input3" ref="/root/reqData/searchData/to_lvcmpy_dt" inputtype="date" style="left:200px; top:74px; width:85px; height:18px; "/>
		<output id="input5" ref="/root/reqData/searchData/dept_nm" inputtype="button" appearance="output" style="left:753px; top:74px; width:95px; height:18px; "/>
		<input id="input6" ref="/root/reqData/searchData/dept_cd" inputtype="button" maxlength="6" style="left:679px; top:74px; width:70px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					model1.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
    				     window.load("/xrw/hd/com/HD_COM_1100.xrw","mdichild", "hd_com_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData"); 
			]]>
			</script>
			<script type="javascript" ev:event="onmaxlength">
				<![CDATA[
						model1.setValue("/root/reqData/searchData/dept_cd", input6.currentText);
						model1.send("hd_com_1103");
						if(model1.getValue("/root/dataSet/CURLIST/record/cnt") != "1"){
							alert("없는 부서이거나 사용중이 아닌 부서 입니다.");
							model1.setValue("/root/reqData/searchData/dept_cd", "");
							model1.setValue("/root/reqData/searchData/dept_nm", "");
							model1.removenode("/root/dataSet");
							model1.refresh();
							return;
						}
						model1.setValue("/root/reqData/searchData/dept_cd", model1.getValue("/root/dataSet/CURLIST/record/dept_cd"));
						model1.setValue("/root/reqData/searchData/dept_nm", model1.getValue("/root/dataSet/CURLIST/record/abrv_nm"));
						model1.removenode("/root/dataSet");
						model1.refresh();
				]]>
			</script>
		</input>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<caption id="caption14" style="left:185px; top:77px; width:15px; height:15px; ">~</caption>
		<group id="group1" class="gro_btn" style="left:10px; top:241px; width:926px; height:17px; ">
			<!--			<button id="button4" class="btn_grid03" style="left:789px; top:0px; width:57px; height:17px; ">
				<caption>행삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var chkrow = datagrid2.row;
					datagrid2.addStatus(chkrow, "delete");
					]]>
				</script>
			</button>
-->
			<button id="button1" class="btn_grid03" style="left:872px; top:0px; width:54px; height:17px; ">
				<caption>행수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (!commReqCheck(group2))
							return;
					
						//if(datagrid2.isReadOnly(1,1) == 1){alert("행추가버튼을 눌러주세요.");return;}
						var selectValue = "";
						var selectedIdx = datagrid2.row;
						if(datagrid2.rows == 2){
							selectedIdx  = 1;	
						}
						var zip1 = input17.currentText;
						var zip2 = input18.currentText;
						var zip_temp = zip1+"-"+zip2;
									
						model1.copyNode("/root/resData/gridData/record["+ selectedIdx +"]","/root/reqData/reqForm");
						model1.setValue("/root/resData/gridData/record["+ datagrid2.row +"]/zip_temp",zip_temp);
	
						var chkrow = datagrid2.row;
						//datagrid2.addStatus(chkrow, "update");
						datagrid2.rowStatus(chkrow) = "2";
						
						model1.resetInstanceNode("/root/reqData/reqForm");
						model1.refresh();
					]]>
				</script>
			</button>
			<button id="button2" class="btn_grid03" style="left:816px; top:0px; width:54px; height:17px; ">
				<caption>행추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (!commReqCheck(group2))
							return;

						if(datagrid2.valueMatrix(1,2) == "" && datagrid2.rowStatus(1) == 1){
							var zip1 = input17.currentText;
							var zip2 = input18.currentText;
							var zip_temp = zip1+"-"+zip2;
							model1.copyNode("/root/resData/gridData/record[1]","/root/reqData/reqForm");
							model1.setValue("/root/resData/gridData/record[1]/zip_temp",zip_temp);
							datagrid2.rowStatus(1) = 3;
						}else{
							var zip1 = input17.currentText;
							var zip2 = input18.currentText;
							var zip_temp = zip1+"-"+zip2;
							datagrid2.addRow(true, true);
							datagrid2.rowStatus(datagrid2.rows-1) = 3;
							model1.copyNode("/root/resData/gridData/record["+datagrid2.row+"]","/root/reqData/reqForm");
							model1.setValue("/root/resData/gridData/record["+ datagrid2.row +"]/zip_temp",zip_temp);
						}
						model1.resetInstanceNode("/root/reqData/reqForm");
						model1.refresh();
					]]>
				</script>
			</button>
			<!--
			<button id="button5" class="btn_grid03" style="left:847px; top:0px; width:52px; height:17px; ">
				<caption>행취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						datagrid2.rowStatus(datagrid2.row) = "0";
//						var firstRow = datagrid2.selectedRow(datagrid2.row);
//						var lastRow = datagrid2.selectedRow(datagrid2.selectedRows-1);
//						
//						for(var i=firstRow;i<=lastRow;i++){
//							if(datagrid2.rowStatus(i) == "1" || datagrid2.rowStatus(i) == "3"){
//								datagrid2.removeRow(i);
//								i- -;
//							}else if(datagrid2.rowStatus(i) == "4"){
//								datagrid2.rowStatus(i) = "0";
//							}else{
//								datagrid2.rowStatus(i) = "0";
//							}
//						}				
					]]>
				</script>
			</button>
-->
		</group>
		<caption id="caption43" class="tit02" style="left:10px; top:108px; width:180px; height:20px; font-weight:bold; ">퇴사자 추가정보 등록</caption>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:40px; width:926px; height:21px; ">
			<button id="button3" class="btn04" style="left:785px; top:0px; width:87px; height:21px; ">
				<caption>엑셀다운로드</caption>
				<script type="javascript" ev:event="DOMActivate">
					<![CDATA[
					//excel 파일로 저장한다
					    var filePath = window.fileDialog("save", "", false, "", "xls", "Excel Files(*.xls)|*.xls");
					      
					    if(filePath != "") {
					     datagrid2.saveExcel(filePath);
					     window.exec(filePath);
					    }
				]]>
				</script>
			</button>
			<button id="button6" class="btn02" style="left:876px; top:0px; width:50px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
			      viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
			     ]]>
				</script>
			</button>
			<button id="button7" class="btn02" style="left:565px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					//model.reset();
					model1.reset();
					datagrid2.clearStatus();
					datagrid2.addStatus(1, "insert");
				]]>
				</script>
			</button>
			<button id="button8" class="btn02" style="left:620px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					searchList();				
				]]>
				</script>
			</button>
			<button id="button9" class="btn02" style="left:730px; top:0px; width:52px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (!commGridReqCheck("datagrid2"))
							return;
							
						if (!rowInSubmit(datagrid2))
							return;

						if (window.alert("저장하시겠습니까?", "확인", 1) != 1)
							return;

						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_affr_3002");
						if(submit_completed()) {
							model1.resetInstanceNode("/root/resData/gridData/record");
							searchList();				
						}							
					]]>
				</script>
			</button>
			<button id="button4" class="btn02" style="left:675px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (!rowDelSubmit(datagrid2))
							return;
							
						if (window.alert("삭제하시겠습니까?", "확인", 1) != 1)
							return;

						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_affr_3002");
						if(submit_completed()) {
							model1.resetInstanceNode("/root/resData/gridData/record");
							searchList();				
						}							
					]]>
				</script>
			</button>
		</group>
		<caption id="caption5" class="list_cap03" style="left:320px; top:70px; width:80px; height:26px; ">사번/성명</caption>
		<input id="input1" ref="/root/reqData/searchData/flnm" style="left:473px; top:74px; width:70px; height:18px; ">
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if(event.keyCode == 13){
						var flnm = input1.currentText;
						model1.setValue("/root/reqData/searchData/emp_no", "");
						model1.setValue("/root/reqData/searchData/flnm", "");
						model1.refresh();
						//model1.send("hd_affr_1102");
						setInfoSearchInput("", flnm, "", "setEmp_no");
						if(model1.getValue("/root/tempData/totalcnt") != 1) {
							return;
						}
						var emp_no =  model1.getValue("/root/tempData/emp_no");
						var flnm =  model1.getValue("/root/tempData/nm_korn");
						model1.setValue("/root/reqData/searchData/emp_no", emp_no);
						model1.setValue("/root/reqData/searchData/flnm", flnm);
						model1.refresh();
					}
				]]>
			</script>
		</input>
		<input id="input4" ref="/root/reqData/searchData/emp_no" inputtype="button" maxlength="6" format="9999999999" style="left:404px; top:75px; width:65px; height:17px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					model1.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
					window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");					    
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == 13){
					var emp_no = input4.currentText;
					setInfoSearchInput(emp_no,"","","");
					if(model1.getValue("/root/tempData/totalcnt") != 1) {
						return;
					}
					var emp_no =  model1.getValue("/root/tempData/emp_no");
					var flnm =  model1.getValue("/root/tempData/nm_korn");
					model1.setValue("/root/reqData/searchData/emp_no", emp_no);
					model1.setValue("/root/reqData/searchData/flnm", flnm);
					model1.refresh();
				}
				/*
				if(event.keyCode == 13){
					var emp_no = input4.currentText;
					model1.setValue("/root/reqData/searchData/emp_no",emp_no );
					model1.send("hd_affr_2901");
					var flnm =  model1.getValue("/root/tempData/flnm");
					model1.setValue("/root/reqData/searchData/flnm", flnm);
					var totalcnt = model1.getValue("/root/tempData/totalcnt");
					if(totalcnt == 0 ){
						alert("검색결과가 없습니다");
						model1.setValue("/root/reqData/searchData/emp_no","" );
						model1.setValue("/root/reqData/searchData/flnm","" );
						return;
					} 
					model1.refresh();
				}
				*/
				
				]]>
			</script>
			<script type="javascript" ev:event="onmaxlength">
				<![CDATA[
					var emp_no = input4.currentText;
					setInfoSearchInput(emp_no,"","","");
					if(model1.getValue("/root/tempData/totalcnt") != 1) {
						return;
					}
					var emp_no =  model1.getValue("/root/tempData/emp_no");
					var flnm =  model1.getValue("/root/tempData/nm_korn");
					model1.setValue("/root/reqData/searchData/emp_no", emp_no);
					model1.setValue("/root/reqData/searchData/flnm", flnm);
					model1.refresh();
				]]>
			</script>
		</input>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData/record" caption="부서^사번^성명^직책^직급^기수^입사일^퇴사일^퇴직사유^우편번호^기본주소^상세주소^전화번호^휴대폰번호^현직책" colsep="#" colwidth="100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 250, 200, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:10px; top:260px; width:926px; height:445px; ">
			<col ref="dept_nm"/>
			<col class="req" ref="emp_no" caption="사번">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						chkempno();	
					]]>
				</script>
			</col>
			<col class="req" ref="flnm" caption="성명">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						chkflnm();
					]]>
				</script>
			</col>
			<col ref="dty_nm"/>
			<col ref="posi_nm"/>
			<col ref="open_invit_desty" type="output" maxlength="2"/>
			<col ref="in_cmpy_dt" type="output" format="yyyy-mm-dd" maxlength="8"/>
			<col ref="lvcmpy_dt" type="output" format="yyyy-mm-dd" maxlength="8"/>
			<col ref="lvcmpy_resn_nm" type="output" maxlength="10"/>
			<col ref="zip_temp" type="output" maxlength="30" style="left:920px; top:20px; width:100px; height:20px; "/>
			<col ref="addr" type="output" maxlength="30" style="text-align:left; "/>
			<col ref="dtls_addr" type="output" maxlength="30" style="text-align:left; "/>
			<col ref="tel_no" type="output" maxlength="20"/>
			<col ref="ptph_no" type="output" maxlength="20"/>
			<col ref="cur_dty_nm" type="output" maxlength="20"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="dept_cd" visibility="hidden"/>
			<col ref="dty_cd" visibility="hidden"/>
			<col ref="posi_cd" visibility="hidden"/>
			<col ref="zip_1" visibility="hidden"/>
			<col ref="zip_2" visibility="hidden"/>
			<col ref="lvcmpy_resn_cd" visibility="hidden"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if (datagrid2.col == 0) {
						rowStatus(datagrid2);
						return;
					}
						
					if(datagrid2.row == 0) return;		
					var chk_emp =  datagrid2.valueMatrix(datagrid2.row,1);
					if(chk_emp == ""){return;}
					var selectedIdx = datagrid2.row;
					model1.copyNode("/root/reqData/reqForm" ,"/root/resData/gridData/record["+ selectedIdx +"]");
// 					var emp_no = datagrid2.valueMatrix(selectedIdx,1);
//					insertForm(emp_no,"");
					model1.refresh();				
				]]>
			</script>
		</datagrid>
		<caption id="gridrowcnt" style="left:835px; top:705px; width:100px; height:20px; text-align:right; "/>
		<group id="group2" style="left:10px; top:130px; width:926px; height:101px; ">
			<caption id="caption9" class="list_cap02" style="left:75px; top:50px; width:851px; height:26px; "/>
			<caption id="caption15" class="list_cap02" style="left:75px; top:0px; width:851px; height:26px; text-align:center; "/>
			<caption id="caption22" class="list_cap02" style="left:75px; top:75px; width:851px; height:26px; "/>
			<caption id="caption20" class="list_cap02" style="left:75px; top:25px; width:851px; height:26px; "/>
			<output id="input7" ref="/root/reqData/reqForm/open_invit_desty" appearance="output" style="left:85px; top:29px; width:100px; height:18px; text-align:center; "/>
			<output id="input8" ref="/root/reqData/reqForm/lvcmpy_resn_nm" appearance="output" style="left:792px; top:29px; width:125px; height:18px; "/>
			<output id="input9" ref="/root/reqData/reqForm/lvcmpy_dt" format="yyyy-mm-dd" appearance="output" style="left:581px; top:29px; width:100px; height:18px; text-align:center; "/>
			<input id="input20" ref="/root/reqData/reqForm/dtls_addr" style="left:581px; top:54px; width:336px; height:18px; "/>
			<caption id="caption41" class="list_cap01" style="left:0px; top:25px; width:80px; height:26px; text-align:center; ">기수</caption>
			<input id="input21" ref="/root/reqData/reqForm/ptph_no" style="left:342px; top:79px; width:149px; height:18px; "/>
			<output id="input10" ref="/root/reqData/reqForm/dept_cd" appearance="output" style="left:342px; top:4px; width:50px; height:18px; text-align:center; "/>
			<input id="input22" ref="/root/reqData/reqForm/addr" editable="false" style="left:342px; top:54px; width:149px; height:18px; "/>
			<caption id="caption21" class="list_cap01" style="left:496px; top:75px; width:80px; height:26px; text-align:center; ">현직책</caption>
			<caption id="caption10" class="list_cap01" style="left:257px; top:0px; width:80px; height:26px; ">부서명</caption>
			<output id="input11" ref="/root/reqData/reqForm/dept_nm" appearance="output" style="left:396px; top:4px; width:95px; height:18px; text-align:center; "/>
			<input id="input23" ref="/root/reqData/reqForm/cur_dty_nm" style="left:581px; top:79px; width:165px; height:18px; "/>
			<caption id="caption2" class="list_cap01" style="left:0px; top:50px; width:80px; height:26px; text-align:center; ">우편번호</caption>
			<input id="input12" ref="/root/reqData/reqForm/flnm" style="left:155px; top:4px; width:86px; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keyCode == 13){
							var flnm = input12.currentText;
							model1.setValue("/root/reqData/reqForm/emp_no", "");
							model1.setValue("/root/reqData/reqForm/flnm", "");
							model1.refresh();
							setInfoSearchInput("", flnm, "", "setEmp_no2");
							if(model1.getValue("/root/tempData/totalcnt") != 1) {
								return;
							}
							var emp_no =  model1.getValue("/root/tempData/emp_no");
	 						model1.resetInstanceNode("/root/reqData/reqForm");
	 						insertForm(emp_no,"");	
	 						if(submit_completed()) {
	 							chk_lev_emp(emp_no);
	 						}
	 						model1.refresh();
	 						
							/*
	 						var flnm = input12.currentText;
	 						model1.resetInstanceNode("/root/reqData/reqForm");
	 						insertForm("",flnm);	
	 						if(submit_completed()) {
	 							chk_lev_emp(model1.getValue("/root/reqData/reqForm/emp_no"));
	 						}
	 						model1.refresh();
	 						*/
	 					}
					]]>
				</script>
			</input>
			<caption id="caption11" class="list_cap01" style="left:712px; top:25px; width:75px; height:26px; text-align:center; ">퇴직사유</caption>
			<caption id="caption12" class="list_cap01" style="left:496px; top:0px; width:80px; height:26px; ">직책</caption>
			<input id="input13" ref="/root/reqData/reqForm/emp_no" class="req" inputtype="button" maxlength="6" caption="사번" style="left:85px; top:4px; width:65px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model1.setValue("/root/reqData/fwdData/func_nm", "setEmp_noForm");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
 					if(event.keyCode == 13){
 						var emp_no = input13.currentText;
 						model1.resetInstanceNode("/root/reqData/reqForm");
 						insertForm(emp_no,"");	
 						if(submit_completed()) {
 							chk_lev_emp(emp_no);
 						}
 						model1.refresh();
 					}
				]]>
				</script>
				<script type="javascript" ev:event="onmaxlength">
					<![CDATA[
 						var emp_no = input13.currentText;
 						model1.resetInstanceNode("/root/reqData/reqForm");
 						insertForm(emp_no,"");	
 						if(submit_completed()) {
 							chk_lev_emp(emp_no);
 						}
 						model1.refresh();
					]]>
				</script>
			</input>
			<caption id="caption4" class="list_cap01" style="left:0px; top:75px; width:80px; height:26px; text-align:center; ">전화번호</caption>
			<output id="input14" ref="/root/reqData/reqForm/dty_cd" appearance="output" style="left:581px; top:4px; width:40px; height:18px; "/>
			<caption id="caption13" class="list_cap01" style="left:257px; top:50px; width:80px; height:26px; text-align:center; ">기본주소</caption>
			<output id="input15" ref="/root/reqData/reqForm/posi_cd" appearance="output" style="left:792px; top:4px; width:45px; height:18px; "/>
			<caption id="caption6" style="left:140px; top:54px; width:15px; height:21px; ">-</caption>
			<output id="input16" ref="/root/reqData/reqForm/in_cmpy_dt" format="yyyy-mm-dd" appearance="output" style="left:342px; top:29px; width:100px; height:18px; text-align:center; "/>
			<input id="input17" ref="/root/reqData/reqForm/zip_1" maxlength="3" format="999" style="left:85px; top:54px; width:50px; height:18px; "/>
			<caption id="caption7" class="list_cap01" style="left:257px; top:75px; width:80px; height:26px; text-align:center; ">휴대폰번호</caption>
			<caption id="caption16" class="list_cap01" style="left:496px; top:25px; width:80px; height:26px; text-align:center; ">퇴사일</caption>
			<input id="input18" ref="/root/reqData/reqForm/zip_2" inputtype="button" maxlength="3" format="999" style="left:155px; top:54px; width:60px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					se_openZip("L", "/root/reqData/reqForm/zip_1", "/root/reqData/reqForm/zip_2", "/root/reqData/reqForm/addr","new");				
				]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
				if(input17.value.length == 3 && input18.value.length == 3) { 
					se_openZip("L", "/root/reqData/reqForm/zip_1", "/root/reqData/reqForm/zip_2", "/root/reqData/reqForm/addr","new");				
				}				
				]]>
				</script>
			</input>
			<caption id="caption8" class="list_cap01" style="left:0px; top:0px; width:80px; height:26px; ">사번/성명</caption>
			<caption id="caption28" class="list_cap01" style="left:712px; top:0px; width:75px; height:26px; ">직급</caption>
			<caption id="caption17" class="list_cap01" style="left:257px; top:25px; width:80px; height:26px; text-align:center; ">입사일</caption>
			<input id="input19" ref="/root/reqData/reqForm/tel_no" style="left:85px; top:79px; width:155px; height:18px; "/>
			<output id="output1" ref="/root/reqData/reqForm/dty_nm" appearance="output" style="left:627px; top:4px; width:75px; height:18px; "/>
			<caption id="caption18" class="list_cap01" style="left:496px; top:50px; width:80px; height:26px; text-align:center; ">상세주소</caption>
			<output id="output2" ref="/root/reqData/reqForm/posi_nm" appearance="output" style="left:843px; top:4px; width:75px; height:18px; "/>
		</group>
	</xhtml:body>
</xhtml:html>
