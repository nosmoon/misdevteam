<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<certi_clsf_cd>
								<item>
									<label/>
									<value/>
								</item>
							</certi_clsf_cd>
							<posi_cd>
								<item>
									<lable/>
									<value/>
								</item>
							</posi_cd>
							<dty_cd>
								<item>
									<lable/>
									<value/>
								</item>
							</dty_cd>
						</comboSet>
						<pageInfo/>
					</initData>
					<reqData>
						<searchData>
							<st_issu_dt/>
							<et_issu_dt/>
							<certi_clsf_ck/>
							<certi_clsf/>
							<emp_no/>
						</searchData>
						<reqForm>
							<certi_clsf/>
							<emp_no/>
							<dept_cd/>
							<dty_cd/>
							<posi_cd/>
							<dept_nm/>
							<dty_name/>
							<posi_name/>
							<prn/>
							<in_cmpy_dt/>
							<issu_num_shet/>
							<issu_dt/>
							<issu_no/>
							<nm_korn/>
							<usag/>
							<remk/>
							<dirc_incmg_posi/>
							<dty_cd_ck/>
							<posi_cd_ck/>
							<dirc_incmg_posi_ck/>
							<mode/>
							<seq/>
							<cmpy_cd/>
							<et_in_cmpy_dt/>
							<occr_dt/>
							<prn_cnt/>
							<busi_trip_purp/>
							<busi_trip_area/>
							<busi_trip_frdt/>
							<busi_trip_todt/>
							<engl_flnm/>
							<engl_bidt/>
							<engl_dept_posi/>
							<engl_in_cmpy_dt/>
							<engl_now_dt/>
							<engl_busi_trip_purp/>
							<engl_busi_trip_area/>
							<engl_busi_trip_frdt/>
							<engl_busi_trip_todt/>
							<dirc_incmg_posi/>
							<chce_posi_clsf/>
						</reqForm>
						<multiUpData/>
						<fwdData>
							<func_nm/>
							<emp_no/>
						</fwdData>
					</reqData>
					<resData>
						<resForm>
							<certi_clsf/>
							<emp_no/>
							<dept_cd/>
							<dty_cd/>
							<posi_cd/>
							<dept_nm/>
							<dty_name/>
							<posi_name/>
							<prn/>
							<in_cmpy_dt/>
							<issu_num_shet/>
							<issu_dt/>
							<issu_no/>
							<nm_korn/>
							<usag/>
							<remk/>
							<dirc_incmg_posi/>
							<dty_cd_ck/>
							<posi_cd_ck/>
							<dirc_incmg_posi_ck/>
							<seq/>
							<mode/>
							<cmpy_cd/>
							<et_in_cmpy_dt/>
							<occr_dt/>
							<prn_cnt/>
							<busi_trip_purp/>
							<busi_trip_area/>
							<busi_trip_frdt/>
							<busi_trip_todt/>
							<engl_flnm/>
							<engl_bidt/>
							<engl_dept_posi/>
							<engl_in_cmpy_dt/>
							<engl_now_dt/>
							<engl_busi_trip_purp/>
							<engl_busi_trip_area/>
							<engl_busi_trip_frdt/>
							<engl_busi_trip_todt/>
							<dirc_incmg_posi/>
							<chce_posi_clsf/>
							<temp/>
						</resForm>
						<msg/>
						<gridData>
							<record>
								<certi_clsf/>
								<emp_no/>
								<dept_cd/>
								<dty_cd/>
								<posi_cd/>
								<dept_nm/>
								<dty_name/>
								<posi_name/>
								<prn/>
								<in_cmpy_dt/>
								<issu_num_shet/>
								<issu_dt/>
								<issu_no/>
								<nm_korn/>
								<usag/>
								<remk/>
								<dirc_incmg_posi/>
								<dty_cd_ck/>
								<posi_cd_ck/>
								<dirc_incmg_posi_ck/>
								<mode/>
								<seq/>
								<cmpy_cd/>
								<et_in_cmpy_dt/>
								<occr_dt/>
								<prn_cnt/>
								<busi_trip_purp/>
								<busi_trip_area/>
								<busi_trip_frdt/>
								<busi_trip_todt/>
								<engl_flnm/>
								<engl_bidt/>
								<engl_dept_posi/>
								<engl_in_cmpy_dt/>
								<engl_now_dt/>
								<engl_busi_trip_purp/>
								<engl_busi_trip_area/>
								<engl_busi_trip_frdt/>
								<engl_busi_trip_todt/>
								<dirc_incmg_posi/>
								<chce_posi_clsf/>
							</record>
						</gridData>
						<empInfo>
							<dept_cd/>
							<dept_nm/>
							<emp_no/>
							<nm_korn/>
							<posi_cd/>
							<posi_nm/>
							<dty_cd/>
							<dty_name/>
						</empInfo>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
				
				var mode_ck = "i";
				
				function loadCombo(){
					model1.send("hd_affr_7010");
					model1.copyNode("/root/initData/comboSet/certi_clsf_cd", "/root/tempData/certi_clsf_cd");
					model1.copyNode("/root/initData/comboSet/posi_cd", "/root/tempData/posi_cd");
					model1.copyNode("/root/initData/comboSet/dty_cd", "/root/tempData/dty_cd");
					model1.removenode("/root/tempData");
					model1.refresh();	
				}
				function setEmpInfo(emp_no, nm_korn)
				{
					var n_row = datagrid2.row;
					
					model1.setValue("/root/reqData/searchData/emp_no",emp_no);
					
					model1.send("hd_affr_7012");
					
					model1.copyNode("/root/resData/empInfo","/root/tempData/empInfo/record");
					model1.removenode("/root/tempData");
					var emp_no = model1.getValue("/root/resData/empInfo/emp_no");
					var nm_korn = model1.getValue("/root/resData/empInfo/nm_korn");
					var posi_cd = model1.getValue("/root/resData/empInfo/posi_cd");
					var posi_nm = model1.getValue("/root/resData/empInfo/posi_nm");
					var dty_cd = model1.getValue("/root/resData/empInfo/dty_cd");
					var dty_nm = model1.getValue("/root/resData/empInfo/dty_nm");
					var cmpy_cd = model1.getValue("/root/resData/empInfo/cmpy_cd");
					
					datagrid2.valueMatrix(n_row, datagrid2.colRef("cmpy_cd")) = cmpy_cd;
					datagrid2.valueMatrix(n_row, datagrid2.colRef("emp_no")) = emp_no;
					datagrid2.valueMatrix(n_row, datagrid2.colRef("nm_korn")) = nm_korn;
					datagrid2.valueMatrix(n_row, datagrid2.colRef("posi_name")) = posi_nm;
					datagrid2.valueMatrix(n_row, datagrid2.colRef("posi_cd")) = posi_cd;
					datagrid2.valueMatrix(n_row, datagrid2.colRef("dty_name")) = dty_nm;
					datagrid2.valueMatrix(n_row, datagrid2.colRef("dty_cd")) = dty_cd;
				
//						model1.setValue("/root/resData/gridData/record[" + n_row + "]/cmpy_cd", cmpy_cd);
//						model1.setValue("/root/resData/gridData/record[" + n_row + "]/emp_no", emp_no);
//						model1.setValue("/root/resData/gridData/record[" + n_row + "]/nm_korn", nm_korn);
//						model1.setValue("/root/resData/gridData/record[" + n_row + "]/posi_name", posi_nm);
//						model1.setValue("/root/resData/gridData/record[" + n_row + "]/posi_cd", posi_cd);
//						model1.setValue("/root/resData/gridData/record[" + n_row + "]/dty_name", dty_nm);
//						model1.setValue("/root/resData/gridData/record[" + n_row + "]/dty_cd", dty_cd);
//					
					model1.refresh();
				}
			
				function DateDemo()
				{
					var s="";
					var mydate=new Date() 
					var year=mydate.getYear() 
					    if (year < 1000) 
					        year+=1900 
					
					var day=mydate.getDay() 
					var month=mydate.getMonth()+1 
					    if (month<10) 
					        month="0"+month 
					
					var daym=mydate.getDate() 
					    if (daym<10) 
					        daym="0"+daym 
					s  = year+month+daym;
				       return(s);
				}

				function loadData(st_issu_dt,et_issu_dt,certi_clsf_ck,certi_clsf) {
					model1.setValue("/root/reqData/searchData/st_issu_dt",st_issu_dt);	
					model1.setValue("/root/reqData/searchData/et_issu_dt",et_issu_dt);	
					model1.setValue("/root/reqData/searchData/certi_clsf_ck",certi_clsf_ck);	
					model1.setValue("/root/reqData/searchData/certi_clsf",certi_clsf);	
					
					model1.send("hd_affr_7010");
					model1.copyNode("/root/resData/gridData","/root/tempData/CURLIST");
					model1.copyNode("/root/initData/comboSet/certi_clsf_cd", "/root/tempData/certi_clsf_cd");
					model1.copyNode("/root/initData/comboSet/posi_cd", "/root/tempData/posi_cd");
					model1.copyNode("/root/initData/comboSet/dty_cd", "/root/tempData/dty_cd");
					//model1.removenode("/root/tempData");
					model1.refresh();	
					
					datagrid2.isReadOnly(1, 1, 1, 9)  = false;
					
					for (i = 1; i < datagrid2.rows; i++) {
						datagrid2.isReadOnly(i, 1, i, 9) =true;
					//	datagrid2.isReadOnly(i, 7) = true;
					}
					datagrid2.refresh();
					rowCnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + " 건";
				}
				
				function initLloadData(st_issu_dt,et_issu_dt,certi_clsf_ck,certi_clsf) {
					datagrid2.addStatus(1, "insert");		
					
					model1.setValue("/root/reqData/searchData/st_issu_dt",st_issu_dt);	
					model1.setValue("/root/reqData/searchData/et_issu_dt",et_issu_dt);	
					model1.setValue("/root/reqData/searchData/certi_clsf_ck",certi_clsf_ck);	
					model1.setValue("/root/reqData/searchData/certi_clsf",certi_clsf);	
					
					model1.send("hd_affr_7010");
					model1.copyNode("/root/initData/comboSet/certi_clsf_cd", "/root/tempData/certi_clsf_cd");
					model1.copyNode("/root/initData/comboSet/posi_cd", "/root/tempData/posi_cd");
					model1.copyNode("/root/initData/comboSet/dty_cd", "/root/tempData/dty_cd");
					//model1.removenode("/root/tempData");
					model1.refresh();	
					//datagrid2.isReadOnly(1, 1, 1, 9)  = true;
					datagrid2.refresh();
					
					//rowCnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + " 건";
				}
				
				function tabLoadData() {
					
					if(datagrid2.isReadOnly(1,2) ==true) {
						//datagrid2.isReadOnly(1, 1, 1, 9)  = true;	
					}else{
						//datagrid2.isReadOnly(1, 1, 1, 9)  = false;
						
						for (i = 1; i <= datagrid2.rows; i++) {
						//	datagrid2.isReadOnly(i, 5, i, 7) = true;
							//datagrid2.isReadOnly(i, 7) = true;
						}
					}
					datagrid2.refresh();
					//rowCnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + " 건";
				}
				
				function resetData(certi_clsf){
					
					model1.reset();
					certi_nm_korn.disabled = false;
					model1.setValue("/root/reqData/reqForm/certi_clsf",certi_clsf);	
					model1.refresh();
					rowCnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + " 건";
				}
				
				function resetLoad() {
					model1.reset();	
					//datagrid2.isReadOnly(1, 1, 1, 9) = true;
					datagrid2.refresh();
					datagrid2.addStatus(1, "insert");		
					rowCnt.value = "";
				}
				
				function setEmp_no_pop(emp_no ,nm_korn ,dept_cd , dept_nm , dty_cd , dty_nm , posi_cd, posi_nm){
					
					var row = datagrid2.row;
					model1.setValue("/root/resData/gridData/record[" + (row) + "]/emp_no", emp_no);
					model1.setValue("/root/resData/gridData/record[" + (row) + "]/nm_korn", nm_korn);
					model1.setValue("/root/resData/gridData/record[" + (row) + "]/dept_cd", dept_cd);
					model1.setValue("/root/resData/gridData/record[" + (row) + "]/dept_nm", dept_nm);
					model1.setValue("/root/resData/gridData/record[" + (row) + "]/dty_cd", dty_cd);
					model1.setValue("/root/resData/gridData/record[" + (row) + "]/dty_name", dty_nm);
					model1.setValue("/root/resData/gridData/record[" + (row) + "]/posi_cd", posi_cd);
					model1.setValue("/root/resData/gridData/record[" + (row) + "]/posi_name", posi_nm);

					model1.refresh();
				}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					datagrid2.rowStatus(1) = 1;
					//rowCnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + " 건";
				]]>
			</script>
			<script type="javascript" src="/js/CIISComm.js"/>
			<submission id="hd_info_1001" action="/hd/info/1001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="hd_com_1200" action="/hd/com/1200" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm/nm_korn" resultref="/root/tempData"/>
			<submission id="hd_affr_7010" action="/hd/affr/7010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_affr_7011" action="/hd/affr/7011" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_affr_7012" action="/hd/affr/7012" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
		</model>
	</xhtml:head>
	<xhtml:body pagewidth="925" pageheight="600" guideline="1,6;1,922;1,914;1,914;">
		<import id="iv_Title" visibility="hidden" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:0px; height:0px; "/>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData/record" scroll="auto" caption="사번^성명^직책^직급^발급번호^발급일자^증명서구분^발급매수^용도^caption1^caption2^caption3^caption4^caption5^caption6^caption7" colsep="#" colwidth="110, 110, 110, 110, 120, 120, 170, 75, 300, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:10px; top:49px; width:905px; height:526px; ">
			<col class="req" ref="emp_no" type="inputbutton" maxlength="6" caption="사번">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var row =datagrid2.row;					
						var emp_no = datagrid2.valueMatrix(row,datagrid2.colRef("emp_no"));
						
						model1.setValue("/root/reqData/reqForm/nm_korn", "");
						model1.setValue("/root/reqData/reqForm/emp_no", emp_no);
						//model1.setValue("/root/reqData/reqForm/prn", "");
						setInfoSearchInput(emp_no, "", "", "setEmp_no_pop"); // 사번, 성명, 주민번호
						
						if(model1.getValue("/root/tempData/totalcnt") != 1){
							return;
						} // 카운트
							
						model1.setValue("/root/resData/gridData/record["+row+"]/emp_no", model1.getValue("/root/tempData/emp_no")); // 사번
						model1.setValue("/root/resData/gridData/record["+row+"]/nm_korn", model1.getValue("/root/tempData/nm_korn")); // 성명
						model1.setValue("/root/resData/gridData/record["+row+"]/dept_cd", model1.getValue("/root/tempData/dept_cd")); // 부서코드
						model1.setValue("/root/resData/gridData/record["+row+"]/dept_nm", model1.getValue("/root/tempData/dept_nm")); // 부서명
						model1.setValue("/root/resData/gridData/record["+row+"]/dty_cd", model1.getValue("/root/tempData/dty_cd")); // 직책코드
						model1.setValue("/root/resData/gridData/record["+row+"]/dty_name", model1.getValue("/root/tempData/dty_nm")); // 직책명
						model1.setValue("/root/resData/gridData/record["+row+"]/posi_cd", model1.getValue("/root/tempData/posi_cd")); // 직급코드
						model1.setValue("/root/resData/gridData/record["+row+"]/posi_name", model1.getValue("/root/tempData/posi_nm")); // 직급명
						
						model1.removenode("/root/tempData");
						model1.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					var col = datagrid2.col;
					if(datagrid2.row == 0) return;			
					if(col == 1) 
					{
						model1.setValue("/root/reqData/fwdData/func_nm", "setEmpInfo");
	//					window.load("/xrw/hd/com/hd_com_1000.xrw","mdichild", "hd_com_1000", "", "/root/reqData/fwdData", "/root/reqData/fwdData");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					}
					]]>
				</script>
			</col>
			<col class="req" ref="nm_korn" type="input" caption="성명">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						row = datagrid2.row;
						var nm_korn = model1.getValue("/root/resData/gridData/record["+row+"]/nm_korn");
						setInfoSearchInput("", nm_korn, "", "setEmp_no_pop"); // 사번, 성명, 주민번호, 리턴함수
						if(model1.getValue("/root/tempData/totalcnt") != 1){
							return;
						} // 카운트
						model1.setValue("/root/resData/gridData/record["+row+"]/emp_no", model1.getValue("/root/tempData/emp_no")); // 사번
						model1.setValue("/root/resData/gridData/record["+row+"]/nm_korn", model1.getValue("/root/tempData/nm_korn")); // 성명
						model1.setValue("/root/resData/gridData/record["+row+"]/dept_cd", model1.getValue("/root/tempData/dept_cd")); // 부서코드
						model1.setValue("/root/resData/gridData/record["+row+"]/dept_nm", model1.getValue("/root/tempData/dept_nm")); // 부서명
						model1.setValue("/root/resData/gridData/record["+row+"]/dty_cd", model1.getValue("/root/tempData/dty_cd")); // 직책코드
						model1.setValue("/root/resData/gridData/record["+row+"]/dty_name", model1.getValue("/root/tempData/dty_nm")); // 직책명
						model1.setValue("/root/resData/gridData/record["+row+"]/posi_cd", model1.getValue("/root/tempData/posi_cd")); // 직급코드
						model1.setValue("/root/resData/gridData/record["+row+"]/posi_name", model1.getValue("/root/tempData/posi_nm")); // 직급명
						model1.removenode("/root/tempData");
						model1.refresh();
						/*
						var rowIdx =datagrid2.row;					
						var nm_korn = datagrid2.valueMatrix(rowIdx,datagrid2.colRef("nm_korn"));
	
						model1.setValue("/root/reqData/reqForm/nm_korn", nm_korn);
						model1.setValue("/root/reqData/reqForm/emp_no", "");
						model1.setValue("/root/reqData/reqForm/prn", "");
						model1.send("hd_com_1200");
						var cnt = model1.getValue("/root/dataSet/CURLIST/record/cnt");
						model1.removenode("/root/dataSet");
						if(cnt == "0"){
							alert(nm_korn + " 사원에 대한 정보가 없습니다.");
							return;
						}else if(cnt == "1"){ // 중복된 성명이 없을때
							model1.send("hd_info_1001");
							//model1.copyNode("/root/resData/resForm", "/root/tempData");
							setEmpInfo(model1.getValue("/root/tempData/emp_no"), model1.getValue("/root/tempData/nm_korn"));
							model1.removenode("/root/tempData");
							model1.removenode("/root/totalcnt");
							//model1.refresh();
						}else if(cnt != "1"){ // 성명이 한개 이상일때
							model1.removeNodeset("/root/reqData/fwdData");  
							model1.makeNode("/root/reqData/fwdData/func_nm");
							model1.setValue("/root/reqData/fwdData/func_nm", "setEmpInfo");
							model1.makeNode("/root/reqData/fwdData/nm_korn");
							model1.setValue("/root/reqData/fwdData/nm_korn", nm_korn);
							window.load("/xrw/hd/com/HD_COM_1200.xrw","mdichild", "hd_com_1200", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						}
						*/
						//model1.refresh();
					]]>
				</script>
			</col>
			<col ref="dty_name"/>
			<col ref="posi_name"/>
			<col ref="issu_no"/>
			<col class="req" ref="issu_dt" type="inputdate" format="yyyy-mm-dd" caption="발급일자"/>
			<col class="req" ref="certi_clsf" type="combo" caption="증명서구분" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/certi_clsf_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col class="req" ref="issu_num_shet" type="input" caption="발급매수"/>
			<col class="req" ref="usag" type="input" caption="용도" style="text-align:left; "/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="cmpy_cd" visibility="hidden"/>
			<col ref="dty_cd" visibility="hidden"/>
			<col ref="posi_cd" visibility="hidden"/>
			<col ref="dept_cd" visibility="hidden"/>
			<col ref="dept_nm" visibility="hidden"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if(datagrid2.row == 0) return;			
					
					 trKey = true;

					var selectedIdx = datagrid2.row;
					model1.copyNode("/root/reqData/reqForm" ,"/root/resData/gridData/record["+ selectedIdx +"]");		
					model1.refresh();		
					
					rowStatus(datagrid2);
				]]>
			</script>
			<script type="javascript" ev:event="onendedit">
				<![CDATA[
				model1.setValue("/root/resData/resForm/temp", "1");
				]]>
			</script>
			<script type="javascript" ev:event="oncolchanged">
				<![CDATA[
				model1.setValue("/root/resData/resForm/temp", "1");
				]]>
			</script>
		</datagrid>
		<button id="button1" class="btn04" style="left:829px; top:5px; width:86px; height:21px; ">
			<caption>엑셀다운로드</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						//excel 파일로 저장한다
						var filePath = window.fileDialog("save", "", false, "", "xls", "Excel Files(*.xls)|*.xls");
						if(filePath != "") {
							datagrid2.saveExcel(filePath);
							window.exec(filePath);
						}
				]]>
			</script>
		</button>
		<button id="button2" class="btn_grid03" style="left:862px; top:30px; width:53px; height:17px; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					/*
					var selectedIdx = datagrid2.rows-1;
					var issu_dt = model1.getValue("/root/resData/gridData/record[1]/issu_dt");	
					var emp_no = model1.getValue("/root/resData/gridData/record["+ selectedIdx +"]/emp_no");	
					var certi_clsf = model1.getValue("/root/resData/gridData/record["+ selectedIdx +"]/certi_clsf");	
					var issu_num_shet =  model1.getValue("/root/resData/gridData/record["+ selectedIdx +"]/issu_num_shet");	
					var usag = model1.getValue("/root/resData/gridData/record["+ selectedIdx +"]/usag");	
					
					if (!(datagrid2.rows == 2 && datagrid2.valueMatrix(1, 1) == ""))
						datagrid2.addRow(true, true);
					
					model1.setValue("/root/resData/resForm/temp", "1");
					*/
					datagrid2.addRow(true, true);
					datagrid2.rowStatus(datagrid2.rows-1) = 1;
					datagrid2.refresh();
				]]>
			</script>
		</button>
		<button id="button3" class="btn02" style="left:774px; top:5px; width:52px; height:21px; ">
			<caption>저장</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if (!rowInSubmit(datagrid2))
						return;
					
					if (!commGridReqCheck(datagrid2))
						return;
							
 					if (window.alert("저장하시겠습니까?", "확인", 1) != 1) {
						return;
					}
					model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
					model1.send("hd_affr_7011");

					if(submit_completed()) {
						model1.reset();
						datagrid2.clearStatus();
						
						model1.setValue("/root/reqData/searchData/certi_clsf_ck","A");
						
						/*
						model1.send("hd_affr_7010");
						model1.copyNode("/root/resData/gridData","/root/tempData/CURLIST");
						model1.copyNode("/root/initData/comboSet/certi_clsf_cd", "/root/tempData/certi_clsf_cd");
						model1.copyNode("/root/initData/comboSet/posi_cd", "/root/tempData/posi_cd");
						model1.copyNode("/root/initData/comboSet/dty_cd", "/root/tempData/dty_cd");
						model1.removenode("/root/tempData");
						model1.refresh();	
						*/
						parent.btnA1.dispatch("onclick");
						datagrid2.isReadOnly(1, 1, 1, 9)  = false;
						
						for (i = 1; i < datagrid2.rows; i++) {
							datagrid2.isReadOnly(i, 1, i, 9) =true;
						}
						datagrid2.refresh();
						rowCnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + " 건";
					}

					/*
					var temp = model1.getValue("/root/resData/resForm/temp");
					if(temp == ""){
						alert("등록 및 삭제 하실 데이터를 입력 또는 선택하신 후 저장 해주세요.");
						return;
					}else if(temp == "1"){
						
						var selectedIdx = datagrid2.rows-1;
						var issu_dt = model1.getValue("/root/resData/gridData/record["+ selectedIdx +"]/issu_dt");	
						var emp_no = model1.getValue("/root/resData/gridData/record["+ selectedIdx +"]/emp_no");	
						var certi_clsf = model1.getValue("/root/resData/gridData/record["+ selectedIdx +"]/certi_clsf");	
						var issu_num_shet =  model1.getValue("/root/resData/gridData/record["+ selectedIdx +"]/issu_num_shet");	
						var usag = model1.getValue("/root/resData/gridData/record["+ selectedIdx +"]/usag");	
						
						if(!commGridReqCheck("datagrid2")) return;
						 
	 					if (window.alert("저장하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						if (!rowInSubmit(datagrid2)) {
							return;
						}
						 
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_affr_7011");
	
						if(submit_completed()) {
							//alert("저장되었습니다.");
							model1.reset();
							datagrid2.clearStatus();
							
							model1.setValue("/root/reqData/searchData/certi_clsf_ck","A");
							
							model1.send("hd_affr_7010");
							model1.copyNode("/root/resData/gridData","/root/tempData/CURLIST");
							model1.copyNode("/root/initData/comboSet/certi_clsf_cd", "/root/tempData/certi_clsf_cd");
							model1.copyNode("/root/initData/comboSet/posi_cd", "/root/tempData/posi_cd");
							model1.copyNode("/root/initData/comboSet/dty_cd", "/root/tempData/dty_cd");
							model1.removenode("/root/tempData");
							model1.refresh();	
							
							datagrid2.isReadOnly(1, 1, 1, 9)  = false;
							
							for (i = 1; i < datagrid2.rows; i++) {
								datagrid2.isReadOnly(i, 1, i, 9) =true;
							//	datagrid2.isReadOnly(i, 7) = true;
							}
							datagrid2.refresh();
							rowCnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + " 건";
						}
					}
					*/
				]]>
			</script>
		</button>
		<caption id="rowCnt" style="left:792px; top:575px; width:125px; height:20px; font-weight:bold; text-align:right; "/>
		<button id="button4" class="btn02" style="left:719px; top:5px; width:52px; height:21px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if (!rowDelSubmit(datagrid2))
						return;
		 					
 					if (window.alert("삭제하시겠습니까?", "확인", 1) != 1) {
						return;
					}
					model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
					model1.send("hd_affr_7011");

					if(submit_completed()) {
						model1.reset();
						datagrid2.clearStatus();
						
						model1.setValue("/root/reqData/searchData/certi_clsf_ck","A");
						/*
						model1.send("hd_affr_7010");
						model1.copyNode("/root/resData/gridData","/root/tempData/CURLIST");
						model1.copyNode("/root/initData/comboSet/certi_clsf_cd", "/root/tempData/certi_clsf_cd");
						model1.copyNode("/root/initData/comboSet/posi_cd", "/root/tempData/posi_cd");
						model1.copyNode("/root/initData/comboSet/dty_cd", "/root/tempData/dty_cd");
						model1.removenode("/root/tempData");
						model1.refresh();	
						*/
						parent.btnA1.dispatch("onclick");
						datagrid2.isReadOnly(1, 1, 1, 9)  = false;
						
						for (i = 1; i < datagrid2.rows; i++) {
							datagrid2.isReadOnly(i, 1, i, 9) =true;
						}
						datagrid2.refresh();
						rowCnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + " 건";
					}
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
