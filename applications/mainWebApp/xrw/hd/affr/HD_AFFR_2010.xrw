<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet ype="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<hd_affr_2018_m>
							<dataSet>
								<xx_proc_stat_010/>
								<xx_proc_stat_020/>
								<xx_proc_stat_030/>
							</dataSet>
						</hd_affr_2018_m>
						<session/>
						<pageInfo/>
						<comboSet>
						</comboSet>
					</initData>
					<tempData/>
					<reqData>
						<searchData>
							<emp_no/>
							<sply_yymm/>
							<flnm/>
							<child_flnm/>
							<pay_plac_clsf>20</pay_plac_clsf>
							<actu_slip_no_in/>
							<actu_slip_no/>
							<tmp_crdt_amt/>
							<titl/>
							<slip_seq/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<incmg_pers/>
							<incmg_pers_ipadd/>
						</searchData>
						<multiUpData/>
						<fwdData>
							<func_nm/>
						</fwdData>
						<reqForm>
							<cmpy_cd/>
							<emp_no/>
							<occr_dt/>
							<seq/>
							<flnm/>
							<dept_cd/>
							<dty_cd/>
							<posi_cd/>
							<sply_yymm/>
							<child_flnm/>
							<child_seqo/>
							<sply_amt/>
							<slip_proc_mang_dt/>
							<slip_proc_mang_seq/>
							<sply_strt_yymm/>
							<acml_sply_tms/>
							<dept_nm/>
							<dty_nm/>
							<posi_nm/>
							<proc_stat/>
							<pay_plac_clsf/>
						</reqForm>
						<multiUpData1/>
					</reqData>
					<resData>
						<gridData>
							<record>
								<chkbox/>
								<emp_no/>
								<flnm/>
								<dept_nm/>
								<dty_nm/>
								<posi_nm/>
								<child_flnm/>
								<child_seqo/>
								<child_bidt/>
								<sply_amt/>
								<sply_strt_yymm/>
								<sply_tms/>
								<last_sply_yymm/>
								<acml_sply_tms/>
								<proc_stat/>
								<seq/>
								<occr_dt/>
								<dept_cd/>
								<dty_cd/>
								<posi_cd/>
								<pay_plac_clsf/>
								<slip_proc_mang_dt/>
								<slip_proc_mang_seq/>
								<proc_stat_nm/>
								<slip_proc_seq/>
								<actu_slip_no/>
								<ch_occr_dt/>
								<ch_seq/>
							</record>
						</gridData>
						<slipData>
							<record>
								<cmpy_cd/>
								<emp_no/>
								<dept_cd/>
								<flnm/>
								<tmp_dr_amt/>
								<tmp_crdt_amt/>
								<titl/>
								<slip_seq/>
								<slip_occr_dt/>
								<slip_clsf_cd/>
								<incmg_pres/>
								<incmg_pers_ipadd/>
								<proc_stat/>
								<slip_proc_mang_dt/>
								<slip_proc_mang_seq/>
								<cmpy_welf_fund_clsf/>
								<occr_dt/>
								<seq/>
							</record>
						</slipData>
						<resForm>
							<record/>
						</resForm>
					</resData>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					model.send("hd_affr_2018_m");
					model.refresh();
					//alert(model.getValue("/root/initData/hd_affr_2018_m/dataSet/xx_proc_stat_010"));
					//alert(model.getValue("/root/initData/hd_affr_2018_m/dataSet/xx_proc_stat_020"));
					//alert(model.getValue("/root/initData/hd_affr_2018_m/dataSet/xx_proc_stat_030"));
					
					//model1.copyNode("/root/resData/gridData", "");				
					//datagrid2.isReadOnly(1, 1, 1, 16) = true;
					datagrid2.fixedcellcheckbox(0, datagrid2.colRef("chkbox"), false) = true;
					datagrid2.addStatus(1, "insert");
					datagrid2.isReadOnly(1, 1, 1, 1) = true;
					input5.value = todaydate('-').substring(0,6);
					model1.refresh();
				]]>
			</script>
			<script type="javascript">
				<![CDATA[
			     							
					var combo_cnt = 1;
					String.prototype.trim = function()
					 {
					   return this.replace(/(^\s*)|(\s*$)/gi, "");
					 }
					 String.prototype.replaceAll = function(str1, str2)
					 {
					   var temp_str = "";
					   if (this.trim() != "" && str1 != str2)
					   {
					     temp_str = this.trim();
					     while (temp_str.indexOf(str1) > -1)
					     {
					       temp_str = temp_str.replace(str1, str2);
					     }
					   }
					   return temp_str;
					  }
 
					
						//오늘 날짜
						function todaydate(val){
							var e_date = new Date();
							var year = e_date.getFullYear(); 
							var month = e_date.getMonth() + 1;
							var day = e_date.getDate();
							if (("" + month).length==1){month = "0"+month;}
							if (("" + day).length==1){day = "0"+day;}
							if(val == '-'){
								e_date = year+""+month+""+day;
							}
							else{
								e_date = year+"-"+month+"-"+day;
							}
							return e_date;
						}			
						//한달후 날짜	
						function monthdate(val){
							 m = 1+parseInt(val);
							 var f_date = "";
							 var cDate=new Date();
							 var year=cDate.getYear();
							 var month=(cDate.getMonth()+ (parseInt(m))).toString();
							 month = month.length==1?"0"+month:month;
							 if (month=="00"){
							  month="12";
							  year--;
							 }
							 var day=cDate.getDate().toString();
							 day = day.length==1?"0"+day:day;
							 f_date = year+month+day;
							 return f_date;  
						}	
						 
						function setEmp_no(emp_no, flnm){						
							var rowIdx = datagrid2.row;					
							model1.setValue("/root/reqData/searchData/emp_no",emp_no );
							//model1.setValue("/root/reqData/searchData/flnm",flnm );
							model1.send("hd_affr_2011");				
							model1.copyNode("/root/resData/resForm/record","/root/tempData/record");
							model1.removenode("root/tempData");
							var totalcnt = model1.getValue("/root/resData/resForm/record/totalcnt");
							
							var emp_no = model1.getValue("/root/resData/resForm/record/emp_no");
							var flnm = model1.getValue("/root/resData/resForm/record/flnm");
							var dept_cd = model1.getValue("/root/resData/resForm/record/dept_cd");
							var dept_nm = model1.getValue("/root/resData/resForm/record/dept_nm");
							var dty_cd = model1.getValue("/root/resData/resForm/record/dty_cd");
							var dty_nm = model1.getValue("/root/resData/resForm/record/dty_nm");
							var posi_cd = model1.getValue("/root/resData/resForm/record/posi_cd");
							var posi_nm = model1.getValue("/root/resData/resForm/record/posi_nm");
							var pay_plac_clsf = model1.getValue("/root/resData/resForm/record/pay_plac_clsf");
							
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/emp_no", emp_no);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/flnm", flnm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_cd", dept_cd);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_nm", dept_nm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_cd", dty_cd);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_nm", dty_nm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_cd", posi_cd);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_nm", posi_nm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/pay_plac_clsf", pay_plac_clsf);
							
							var combo_totalcnt = model1.getValue("/root/tempData/child_flnm/totalcnt");
							for(var i=0; i<=combo_totalcnt; i++){
								model1.makeNode("/root/tempData/comboSet/item["+i+"]");
								model1.makeNode("/root/initData/comboSet["+combo_cnt+"]/item["+i+"]");
								model1.copyNode("/root/tempData/comboSet/item["+i+"]","/root/tempData/child_flnm/item["+i+"]");
								model1.copyNode("/root/initData/comboSet["+combo_cnt+"]/item["+i+"]","/root/tempData/comboSet/item["+i+"]");
							}
							datagrid2.cellComboNodeset(datagrid2.row, 7) = "/root/initData/comboSet["+combo_cnt+"]/item";
							model1.refresh();		
							combo_cnt++;	
						}
						
						function setEmp_noForm(emp_no,flnm){
							insertForm(emp_no,flnm);	
	 						model1.refresh();							
						}
						
						function chkempno(){
							var rowIdx =datagrid2.row;			
							var emp = datagrid2.valueMatrix(rowIdx,3);
							if(emp  == ""){
								alert("사번을 입력하십시오.");
								model1.setValue("/root/reqData/searchData/emp_no","" );
								return;
								
								}
							model1.setValue("/root/reqData/searchData/emp_no",emp );
							
							model1.send("hd_affr_2011");
							model1.copyNode("/root/resData/resForm/record","/root/tempData/record");
							model1.removenode("/root/tempData");
							var totalcnt = model1.getValue("/root/resData/resForm/record/totalcnt");
							if(totalcnt == ""){
								alert("검색결과가 없습니다");
								model1.setValue("/root/reqData/searchData/emp_no","" );
								model1.setValue("/root/reqData/searchData/flnm","" );
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/emp_no", emp_no);
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/flnm", flnm);
								model1.refresh();
								return;
							}
							
							//var child_combo = 
							var emp_no = model1.getValue("/root/resData/resForm/record/emp_no");
							var flnm = model1.getValue("/root/resData/resForm/record/flnm");
							var dept_cd = model1.getValue("/root/resData/resForm/record/dept_cd");
							var dept_nm = model1.getValue("/root/resData/resForm/record/dept_nm");
							var dty_cd = model1.getValue("/root/resData/resForm/record/dty_cd");
							var dty_nm = model1.getValue("/root/resData/resForm/record/dty_nm");
							var posi_cd = model1.getValue("/root/resData/resForm/record/posi_cd");
							var posi_nm = model1.getValue("/root/resData/resForm/record/posi_nm");
							var pay_plac_clsf = model1.getValue("/root/resData/resForm/record/pay_plac_clsf");
							
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/emp_no", emp_no);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/flnm", flnm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_cd", dept_cd);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_nm", dept_nm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_cd", dty_cd);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_nm", dty_nm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_cd", posi_cd);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_nm", posi_nm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/pay_plac_clsf", pay_plac_clsf);
							
							var combo_totalcnt = model1.getValue("/root/tempData/child_flnm/totalcnt");
							for(var i=0; i<=combo_totalcnt; i++){
								model1.makeNode("/root/tempData/comboSet/item["+i+"]");
								model1.makeNode("/root/initData/comboSet["+combo_cnt+"]/item["+i+"]");
								model1.copyNode("/root/tempData/comboSet/item["+i+"]","/root/tempData/child_flnm/item["+i+"]");
								model1.copyNode("/root/initData/comboSet["+combo_cnt+"]/item["+i+"]","/root/tempData/comboSet/item["+i+"]");
							}
							datagrid2.cellComboNodeset(datagrid2.row, 7) = "/root/initData/comboSet["+combo_cnt+"]/item";
							model1.refresh();		
							combo_cnt++;		
						}	
						
						function chkflnm(){
							var rowIdx =datagrid2.row;					
							var flnm = datagrid2.valueMatrix(rowIdx,4);
							var tmp_flnm = flnm.trim();
							if(tmp_flnm == "") flnm = "xxx";
							model1.setValue("/root/reqData/searchData/flnm",flnm );
							model1.send("hd_affr_2011");				
							model1.copyNode("/root/resData/resForm/record","/root/tempData/record");
							model1.removenode("/root/tempData");
							var totalcnt = model1.getValue("/root/resData/resForm/record/totalcnt");							
							if(totalcnt == ""){
								alert("검색결과가 없습니다");
								model1.setValue("/root/reqData/searchData/emp_no","" );
								model1.setValue("/root/reqData/searchData/flnm","" );
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/emp_no", "");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/flnm","");
								model1.refresh();
								return;
							}					
							if(totalcnt > 1){
								model1.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
								window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/flnm","");
								return;
							
							}				
							
							var emp_no = model1.getValue("/root/resData/resForm/record/emp_no");
							var flnm = model1.getValue("/root/resData/resForm/record/flnm");
							var dept_cd = model1.getValue("/root/resData/resForm/record/dept_cd");
							var dept_nm = model1.getValue("/root/resData/resForm/record/dept_nm");
							var dty_cd = model1.getValue("/root/resData/resForm/record/dty_cd");
							var dty_nm = model1.getValue("/root/resData/resForm/record/dty_nm");
							var posi_cd = model1.getValue("/root/resData/resForm/record/posi_cd");
							var posi_nm = model1.getValue("/root/resData/resForm/record/posi_nm");
							var pay_plac_clsf = model1.getValue("/root/resData/resForm/record/pay_plac_clsf");
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/emp_no", emp_no);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/flnm", flnm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_cd", dept_cd);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_nm", dept_nm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_cd", dty_cd);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_nm", dty_nm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_cd", posi_cd);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_nm", posi_nm);
							model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/pay_plac_clsf", pay_plac_clsf);
							var combo_totalcnt = model1.getValue("/root/tempData/child_flnm/totalcnt");
							for(var i=0; i<=combo_totalcnt; i++){
								model1.makeNode("/root/tempData/comboSet/item["+i+"]");
								model1.makeNode("/root/initData/comboSet["+combo_cnt+"]/item["+i+"]");
								model1.copyNode("/root/tempData/comboSet/item["+i+"]","/root/tempData/child_flnm/item["+i+"]");
								model1.copyNode("/root/initData/comboSet["+combo_cnt+"]/item["+i+"]","/root/tempData/comboSet/item["+i+"]");
							}
							datagrid2.cellComboNodeset(datagrid2.row, 7) = "/root/initData/comboSet["+combo_cnt+"]/item";
							model1.refresh();		
							combo_cnt++;							
						}		
												
						
						function getChildFlnm(){
							var rowIdx =datagrid2.row;			
							var emp = datagrid2.valueMatrix(rowIdx,3);	
							if(emp == ""){return;}
							model1.setValue("/root/reqData/searchData/emp_no",emp );
							model1.send("hd_affr_2011");
							var combo_totalcnt = model1.getValue("/root/tempData/child_flnm/totalcnt");
							for(var i=0; i<=combo_totalcnt; i++){
								model1.makeNode("/root/tempData/comboSet/item["+i+"]");
								model1.makeNode("/root/initData/comboSet["+combo_cnt+"]/item["+i+"]");
								model1.copyNode("/root/tempData/comboSet/item["+i+"]","/root/tempData/child_flnm/item["+i+"]");
								model1.copyNode("/root/initData/comboSet["+combo_cnt+"]/item["+i+"]","/root/tempData/comboSet/item["+i+"]");
							}
							datagrid2.cellComboNodeset(datagrid2.row, 7) = "/root/initData/comboSet["+combo_cnt+"]/item";
							combo_cnt++;	
						}		
						var searchFlag = false;
					     //총금액 총인원 구하기
					     function setTotal_amt_pep(){
					     	var emp_no_tmp = "xxxxxx";	
					     	var row1 = datagrid1.rows;
					     	var total_amt = 0;
					     	var cnt = 0;
					     	if(row1 == 1 || row1 == -1){
					     		return;
					     	}
							if(row1 > 1 && datagrid1.valueMatrix(1, 1) != ""){					     	

								var s_flnm = model1.getValue("/root/resData/slipData/record[1]/flnm");
						     	for(var i=1;i < row1;i++){
						     		var alon_amt = model1.getValue("/root/resData/slipData/record["+i+"]/tmp_dr_amt");
						     		var emp_no = model1.getValue("/root/resData/slipData/record["+i+"]/emp_no");
						     		total_amt =  Number(total_amt) + Number(alon_amt);
						     		if(emp_no_tmp != emp_no){
						     			cnt++;
						     			emp_no_tmp = emp_no;
						     		}
						     	}
						     	cnt = cnt - 1;
						     	if(cnt == 0){
						     		model1.setValue("/root/resData/slipData/record[1]/tmp_crdt_amt",total_amt);
									model1.setValue("/root/resData/slipData/record[1]/titl",s_flnm+" 양육비");								
						     		model1.setValue("/root/reqData/searchData/tmp_crdt_amt",total_amt);
									model1.setValue("/root/reqData/searchData/titl",s_flnm+" 양육비");								
						     	}else{
						     		model1.setValue("/root/resData/slipData/record[1]/tmp_crdt_amt",total_amt);
									model1.setValue("/root/resData/slipData/record[1]/titl",s_flnm+" 외 "+cnt+"명 양육비");								
						     		model1.setValue("/root/reqData/searchData/tmp_crdt_amt",total_amt);
									model1.setValue("/root/reqData/searchData/titl",s_flnm+" 외 "+cnt+"명 양육비");								
						     	}						     	

							}
							model1.refresh();
					     }			
					     //전표등록시 벨류
					     function setInsertSlipValue(){
					     	
					     	var row = datagrid1.rows;
					     	var total_amt = 0;
					     	var cnt = 0;
					     	
					     	if(row == 1){
					     		return;
					     	}
							else if(row > 1){					     	
								var tmp_crdt_amt = model1.getValue("/root/resData/slipData/record[1]/tmp_crdt_amt");
								var titl = model1.getValue("/root/resData/slipData/record[1]/titl");
					     		model1.setValue("/root/reqData/searchData/tmp_crdt_amt",tmp_crdt_amt);
					     		model1.setValue("/root/reqData/searchData/titl",titl);
							}
							model1.refresh();
					     }					     
					     
					     
					     //전표 삭제시 벨류
					     function setDeleteSlipValue(){
					     	
					     	var row = datagrid1.rows;
					     	var total_amt = 0;
					     	var cnt = 0;
					     	
					     	if(row == 1){
					     		return;
					     	}
							else if(row > 1){					     	
								var slip_seq = model1.getValue("/root/resData/slipData/record[1]/slip_seq");
								var slip_occr_dt = model1.getValue("/root/resData/slipData/record[1]/slip_occr_dt");
								var slip_clsf_cd = model1.getValue("/root/resData/slipData/record[1]/slip_clsf_cd");
								var incmg_pers = model1.getValue("/root/resData/slipData/record[1]/incmg_pers");
								var incmg_pers_ipadd = model1.getValue("/root/resData/slipData/record[1]/incmg_pers_ipadd");
					     		model1.setValue("/root/reqData/searchData/slip_seq",slip_seq);
					     		model1.setValue("/root/reqData/searchData/slip_occr_dt",slip_occr_dt);
					     		model1.setValue("/root/reqData/searchData/slip_clsf_cd",slip_clsf_cd);
					     		model1.setValue("/root/reqData/searchData/incmg_pers",incmg_pers);
					     		model1.setValue("/root/reqData/searchData/incmg_pers_ipadd",incmg_pers_ipadd);
							}
							model1.refresh();
					     }											
 								
 					function gridSearchList(){
						if (!commReqCheck(group2))
							return;
						model1.send("hd_affr_2010");
						var listsize = model1.getValue("/root/tempData/totalcnt");
						model1.copyNode("/root/resData/gridData", "/root/tempData/CURLIST");
						model1.copyNode("/root/resData/slipData", "/root/tempData/CURLIST1");	
						model1.removenode("/root/tempData");			
						model1.refresh();				
						//setTotal_amt_pep();
						setDeleteSlipValue();
						searchFlag = true;
	 					model1.refresh();	
						var emp_no = model1.getValue("/root/resData/gridData/record[1]/emp_no");
						if(emp_no != ""){
							datagrid2.isReadOnly(1, 1, 1, 11) = false;
						}
						for(var i=1 ;i<=datagrid2.rows;i++){
							var child_flnm = model1.getValue("/root/resData/gridData/record["+i+"]/child_flnm");
							model1.makeNode("/root/initData/comboSet/child_flnm["+i+"]/item/value");
							model1.makeNode("/root/initData/comboSet/child_flnm["+i+"]/item/label");
							model1.setValue("/root/initData/comboSet/child_flnm["+i+"]/item/value",child_flnm);
							model1.setValue("/root/initData/comboSet/child_flnm["+i+"]/item/label",child_flnm);
							datagrid2.cellComboNodeset(i, 7) = "/root/initData/comboSet/child_flnm["+i+"]/item";
							datagrid2.isReadOnly(i, 7) = true;
						}
						model1.refresh();	
						for(var i=1 ;i< datagrid2.rows;i++){
							var proc_stat = model1.getValue("/root/resData/gridData/record["+i+"]/proc_stat");							
							//if(proc_stat == '29' || proc_stat == '36'){ 120216
							if(proc_stat == model.getValue("/root/initData/hd_affr_2018_m/dataSet/xx_proc_stat_010") 
							|| proc_stat == model.getValue("/root/initData/hd_affr_2018_m/dataSet/xx_proc_stat_020")){
								datagrid2.isReadOnly(i, 1, i, 17) = true;
							}else if(proc_stat == ""){
								datagrid2.isReadOnly(i, 1, i, 20) = true;
							}else{
								datagrid2.isReadOnly(i, 1, i, 17) = false;
							}					
							//tmp_emp[i] = "";
							datagrid2.fixedcellischeck(i, datagrid2.colRef("chkbox")) = false;		
						}
						datagrid2.fixedcellischeck(0, datagrid2.colRef("chkbox")) = false;
						gridrowcnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + "건";	
						datagrid2.clearStatus();																						
						model1.refresh();	 						
 					}			
					var tmp_emp =  new Array();
					var emp_cnt = 0;
					//개별선택
				     function setTitl(val){
				     	for(var i = 1; i < datagrid2.rows; i++){
				     		if(model1.getValue("/root/resData/gridData/record["+i+"]/chkbox") == "true"){
				     			//alert();
				     		}
				     	}
				     	/*var flnm = "";
				     	var cnt = 0;
				     	var tmp_cnt = 0;
				     	var flag = true;
				     	var emp_no = model1.getValue("/root/resData/gridData/record["+datagrid2.row+"]/emp_no");
				     	//등록자 이름
			     	     for(var i=1;i<datagrid1.rows;i++){
							if(datagrid1.rowStatus(i) == 1){
								if(flnm == ""){
									flnm = model1.getValue("/root/resData/slipData/record["+i+"]/flnm");
								}
							}
				     	}
				     	//등록자 카운터 (중복제거)
				     	if(val == 1){
				     		for(var i=1;i<tmp_emp.length;i++){
				     			if(tmp_emp[i] == emp_no ){
				     				tmp_cnt++;
				     			}
				     		}
				     		if(tmp_cnt == 0){
				     			emp_cnt++;
				     		}
				     		tmp_emp[datagrid2.row] = emp_no;
				     	}else{
				     		//alert(tmp_emp+"-"+emp_no+"--"+datagrid2.row)
				     		for(var i=1;i<tmp_emp.length;i++){
				     			if(tmp_emp[i] == emp_no ){
				     				tmp_cnt++;
				     			}
				     		}
				     		if(tmp_cnt == 1){
				     			emp_cnt--;
				     		}
				     		tmp_emp[datagrid2.row] = "";
				     	} 
						if(emp_cnt == 1){
							model1.setValue("/root/resData/slipData/record/titl",flnm+" 양육비");
							model1.setValue("/root/reqData/searchData/titl",flnm+" 양육비");							
						}else if(emp_cnt > 1) {
							cnt = emp_cnt - 1;
							model1.setValue("/root/resData/slipData/record/titl",flnm+" 외 "+cnt+"명 양육비");		
							model1.setValue("/root/reqData/searchData/titl",flnm+" 외 "+cnt+"명 양육비");						
						}
						datagrid1.refresh();*/
				     }		
    				     //전체선택
				     function setTitl_all(val){
				     	var flnm = "";
				     	var cnt = 0;
				     	var flag = true;
				     	var row = datagrid1.rows;
						if(row > 1 && datagrid1.valueMatrix(1, 1) != ""){					     					     	
				     	     for(var i=1;i<datagrid1.rows;i++){
					     		var emp_no = model1.getValue("/root/resData/slipData/record["+i+"]/emp_no");
				     			tmp_emp[i] = emp_no;						     		
								if(datagrid1.rowStatus(i) == 1){
									if(flnm == ""){
										flnm = model1.getValue("/root/resData/slipData/record["+i+"]/flnm");
									}
								}
					     	}
						}
						if(val == 1){
							// 배열내에 중복된 요소 제거함수
							for(var i=0; i<tmp_emp.length; i++) {
   						         var checkDobl = 0;
							    for(var j=0; j<tmp_emp.length; j++) {
							        if(tmp_emp[i] != tmp_emp[j]) {
							            continue;
							        }else {      
							            checkDobl++;
							            if(checkDobl>1){
							               spliced = tmp_emp.splice(j,1);
							               emp_cnt++;
							            }
							        }
						         }
							}
							cnt = tmp_emp.length-1;
							emp_cnt = cnt;
				     	     for(var i=1;i<datagrid2.rows;i++){
					     		var emp_no = model1.getValue("/root/resData/gridData/record["+i+"]/emp_no");
				     			tmp_emp[i] = emp_no;						     		
					     	}
							if(cnt == 1){
								model1.setValue("/root/resData/slipData/record/titl",flnm+" 양육비");
								model1.setValue("/root/reqData/searchData/titl",flnm+" 양육비");
							}else{
								cnt = cnt - 1
								model1.setValue("/root/resData/slipData/record/titl",flnm+" 외 "+cnt+"명 양육비");								
								model1.setValue("/root/reqData/searchData/titl",flnm+" 외 "+cnt+"명 양육비");
							}
						}else {
				     	     for(var i=1;i<datagrid1.rows;i++){
				     	     	spliced = tmp_emp.splice(i,1);
//				     			tmp_emp[i] = "";
				     			emp_cnt = 0;
					     	}							
							model1.setValue("/root/resData/slipData/record/titl","");								
							model1.setValue("/root/reqData/searchData/titl","");
						}
						datagrid1.refresh();
				     }	
				     //대변금액합계	
					function slip_submit_sum(){
						var row = datagrid1.row;	
						var sum_amt = 0;
						for(var i=1 ;i< datagrid1.rows;i++){
							if(datagrid1.rowStatus(i) == 1){
								var amt = model1.getValue("/root/resData/slipData/record["+i+"]/tmp_dr_amt");
								sum_amt = Number(sum_amt) + Number(amt);
							}
						}
						model1.setValue("/root/resData/slipData/record[1]/tmp_crdt_amt",sum_amt);
						model1.setValue("/root/reqData/searchData/tmp_crdt_amt",sum_amt);
						datagrid1.refresh();
					}   			 							
 
				]]>
			</script>
			<submission id="hd_affr_2010" action="/hd/affr/2010/" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_affr_2011" action="/hd/affr/2011/" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_affr_2012" action="/hd/affr/2012/" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpData" resultref="/root/tempData"/>
			<submission id="hd_affr_2013" action="/hd/affr/2013/" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_affr_2014" action="/hd/affr/2014/" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_affr_2015" action="/hd/affr/2015/" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_affr_2017" action="/hd/affr/2017/" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_affr_2018_m" action="/hd/affr/2018" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/hd_affr_2018_m/dataSet"/>
		</model>
		<script type="javascript" src="/js/CIISComm.js"/>
	</xhtml:head>
	<xhtml:body pagewidth="946" pageheight="728">
		<group id="group1" class="gro_btn" style="left:10px; top:75px; width:905px; height:18px; ">
			<button id="button2" class="btn_grid03" visibility="hidden" style="left:852px; top:0px; width:53px; height:17px; ">
				<caption>행추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(datagrid2.isReadOnly(1,1) == 1 && datagrid2.valueMatrix(1,2) == "") {
							datagrid2.isReadOnly(1, 2, 1, 11) = false;							
							datagrid2.addStatus(1, "insert");							
						}else{
							datagrid2.addRow(true, true);
							datagrid2.isReadOnly(datagrid2.row, 7) = true;							
						}

					]]>
				</script>
			</button>
		</group>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:0px; top:5px; width:0px; height:0px; "/>
		<caption id="caption43" class="tit02" style="left:10px; top:75px; width:175px; height:20px; font-weight:bold; ">양육비 지급 대상 등록</caption>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData/record" caption="선택^부서^사번^성명^직책^직급^자녀명^자녀순서^자녀생년월일^지원금액^지원개시월^지원회차^최종지원월^누적지원회차^진행상태^관리번호^전표번호" colsep="#" colwidth="45, 125, 70, 70, 60, 60, 80, 65, 90, 100, 70, 60, 70, 85, 70, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:10px; top:95px; width:905px; height:530px; ">
			<col ref="chkbox" type="checkbox">
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
						var row = datagrid2.row;
						//if(datagrid2.rowstatus(row) == 1 || datagrid2.rowstatus(row) == 3){
						//	datagrid2.rowstatus(row) = 1;
						//}else{
						//	datagrid2.rowstatus(row) = 2;
						//}
						var slip_proc_seq = model1.getValue("/root/resData/gridData/record["+row+"]/occr_dt")
									       + model1.getValue("/root/resData/gridData/record["+row+"]/seq");
						var tmp_slip_proc_seq = "";
						for (i = 1; i < datagrid2.rows; i++) {
							tmp_slip_proc_seq = model1.getValue("/root/resData/gridData/record["+i+"]/occr_dt")
									           + model1.getValue("/root/resData/gridData/record["+i+"]/seq");
							if (slip_proc_seq == tmp_slip_proc_seq) {
								datagrid2.valueMatrix(i, 1) = "true";
								if(datagrid2.rowstatus(i) == 1 || datagrid2.rowstatus(i) == 3){
									datagrid2.rowstatus(i) = 1;
								}else{
									datagrid2.rowstatus(i) = 2;
								}
							}
						}
															       
						for(var i=1 ;i<datagrid1.rows;i++){
							//var emp_no = model1.getValue("/root/resData/slipData/record["+i+"]/emp_no");
							var occr_dt = model1.getValue("/root/resData/slipData/record["+i+"]/occr_dt");
							var seq = model1.getValue("/root/resData/slipData/record["+i+"]/seq");
							//var tmp_seq = emp_no + occr_dt + seq;
							var tmp_seq = occr_dt + seq;
							if(slip_proc_seq == tmp_seq){
								datagrid1.rowStatus(i) = 1;
							}
						}
						/*var slip_proc_seq = model1.getValue("/root/resData/gridData/record["+row+"]/slip_proc_seq");
						for(var i=1 ;i<datagrid1.rows;i++){
							var slip_proc_mang_dt = model1.getValue("/root/resData/slipData/record["+i+"]/slip_proc_mang_dt");
							var slip_proc_mang_seq = model1.getValue("/root/resData/slipData/record["+i+"]/slip_proc_mang_seq");
							var tmp_seq = slip_proc_mang_dt+""+slip_proc_mang_seq;
							if(slip_proc_seq == tmp_seq){
								datagrid1.rowStatus(i) = 1;
							}
						}*/
						
						if (datagrid1.rows > 1) {
							slip_submit_sum();
							setTitl(1);						
						}
						//model1.refresh();						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-deselect">
					<![CDATA[
						var row = datagrid2.row;
						var slip_proc_seq = model1.getValue("/root/resData/gridData/record["+row+"]/occr_dt")
									       + model1.getValue("/root/resData/gridData/record["+row+"]/seq");
						var tmp_slip_proc_seq = "";
						for (i = 1; i < datagrid2.rows; i++) {
							tmp_slip_proc_seq = model1.getValue("/root/resData/gridData/record["+i+"]/occr_dt")
									           + model1.getValue("/root/resData/gridData/record["+i+"]/seq");
							if (slip_proc_seq == tmp_slip_proc_seq) {
								datagrid2.valueMatrix(i, 1) = "false";
								if(datagrid2.rowstatus(i) == 1 || datagrid2.rowstatus(i) == 3){
									datagrid2.rowstatus(i) = 1;
								}else{
									datagrid2.rowstatus(i) = 0;
								}
							}
						}

						for(var i=1 ;i<datagrid1.rows;i++){
							//var emp_no = model1.getValue("/root/resData/slipData/record["+i+"]/emp_no");
							var occr_dt = model1.getValue("/root/resData/slipData/record["+i+"]/occr_dt");
							var seq = model1.getValue("/root/resData/slipData/record["+i+"]/seq");
							//var tmp_seq = emp_no + occr_dt + seq;
							var tmp_seq = occr_dt + seq;
							if(slip_proc_seq == tmp_seq){
								datagrid1.rowStatus(i) = 0;
							}
						}
						/*var slip_proc_seq = model1.getValue("/root/resData/gridData/record["+row+"]/slip_proc_seq");
						for(var i=1 ;i<datagrid1.rows;i++){
							var slip_proc_mang_dt = model1.getValue("/root/resData/slipData/record["+i+"]/slip_proc_mang_dt");
							var slip_proc_mang_seq = model1.getValue("/root/resData/slipData/record["+i+"]/slip_proc_mang_seq");
							var tmp_seq = slip_proc_mang_dt+""+slip_proc_mang_seq;
							if(slip_proc_seq == tmp_seq){
								datagrid1.rowStatus(i) = 0;
							}
						}*/
						datagrid2.rowStatus(row) = 0;
						if (datagrid1.rows > 1) {
							slip_submit_sum();		
							setTitl(2);		
						}
						//model1.refresh();
						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var row = datagrid2.row;
						if (datagrid2.valueMatrix(row, 1) == "false" && datagrid2.rowStatus(row) == 2)
							datagrid2.rowStatus(row) = 0;
					]]>
				</script>
			</col>
			<col ref="dept_nm" style="text-align:left; "/>
			<col class="req" ref="emp_no" caption="사번">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						chkempno();	
					]]>
				</script>
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");					
						model.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
			</col>
			<col class="req" ref="flnm" caption="성명">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var row = datagrid2.row;
						var nm_korn = model1.getValue("/root/resData/gridData/record["+row+"]/flnm");
						setInfoSearchInput("", nm_korn, "", "setEmp_no"); // 사번, 성명, 주민번호, 리턴함수
						if(model1.getValue("/root/tempData/totalcnt") != 1){
							return;
						} // 카운트
						model1.setValue("/root/resData/gridData/record["+row+"]/emp_no", model1.getValue("/root/tempData/emp_no")); // 사번
						model1.setValue("/root/resData/gridData/record["+row+"]/flnm", model1.getValue("/root/tempData/nm_korn")); // 성명
						model1.setValue("/root/resData/gridData/record["+row+"]/dept_cd", model1.getValue("/root/tempData/dept_cd")); // 부서코드
						model1.setValue("/root/resData/gridData/record["+row+"]/dept_nm", model1.getValue("/root/tempData/dept_nm")); // 부서명
						model1.setValue("/root/resData/gridData/record["+row+"]/dty_cd", model1.getValue("/root/tempData/dty_cd")); // 직책코드
						model1.setValue("/root/resData/gridData/record["+row+"]/dty_nm", model1.getValue("/root/tempData/dty_nm")); // 직책명
						model1.setValue("/root/resData/gridData/record["+row+"]/posi_cd", model1.getValue("/root/tempData/posi_cd")); // 직급코드
						model1.setValue("/root/resData/gridData/record["+row+"]/posi_nm", model1.getValue("/root/tempData/posi_nm")); // 직급명
						model1.removenode("/root/tempData");
						
						//chkflnm();
					]]>
				</script>
			</col>
			<col ref="dty_nm"/>
			<col ref="posi_nm"/>
			<col class="req" ref="child_flnm" caption="자녀명"/>
			<col ref="child_seqo"/>
			<col ref="child_bidt" format="yyyy-mm-dd"/>
			<col ref="sply_amt" format="#,###" style="text-align:right; "/>
			<col ref="sply_strt_yymm" format="yyyy-mm"/>
			<col ref="sply_tms"/>
			<col ref="last_sply_yymm" format="yyyy-mm"/>
			<col ref="acml_sply_tms"/>
			<col ref="proc_stat_nm"/>
			<col ref="slip_proc_seq" format="99999999-99999"/>
			<col ref="actu_slip_no" format="99999999-99-999"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="dept_cd" visibility="hidden"/>
			<col ref="dty_cd" visibility="hidden"/>
			<col ref="posi_cd" visibility="hidden"/>
			<col ref="slip_proc_mang_dt" visibility="hidden"/>
			<col ref="slip_proc_mang_seq" visibility="hidden"/>
			<col ref="sply_yymm" visibility="hidden"/>
			<col ref="pay_plac_clsf" visibility="hidden"/>
			<col ref="proc_stat" visibility="hidden"/>
			<col ref="ch_occr_dt" visibility="hidden"/>
			<col ref="ch_seq" visibility="hidden"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var proc_stat = model1.getValue("/root/resData/gridData/record["+datagrid2.row+"]/proc_stat");							
					
					//if(proc_stat == '29'){ 120216
					if(proc_stat == model.getValue("/root/initData/hd_affr_2018_m/dataSet/xx_proc_stat_010")){
						return;
					}							
					
					rowStatus(datagrid2);
					
					var emp_no = model1.getValue("/root/resData/gridData/record[1]/emp_no");
					model1.setValue("/root/reqData/searchData/child_flnm","");
				 	if(datagrid2.col == 7 && emp_no != ""){
			 			datagrid2.isReadOnly(datagrid2.row, 7) = false;
			 			getChildFlnm();
				 	}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
					if(datagrid2.col == 1 ){
						return;
					}
						
					var rowIdx =datagrid2.row;
					if(rowIdx == 0){return;}
					var child_flnm = datagrid2.valueMatrix(rowIdx,7);	
					var emp_no = datagrid2.valueMatrix(rowIdx,3);
					model1.setValue("/root/reqData/searchData/child_flnm",child_flnm);
					model1.setValue("/root/reqData/searchData/emp_no",emp_no);
					model1.send("hd_affr_2011");							
					var child_seqo = model1.getValue("/root/tempData/child_flnm/record/child_seqo");
					var child_bidt = model1.getValue("/root/tempData/child_flnm/record/child_bidt");
					var sply_strt_yymm = model1.getValue("/root/tempData/child_flnm/record/sply_strt_yymm");
					var last_sply_yymm = model1.getValue("/root/tempData/child_flnm/record/last_sply_yymm");
					var sply_amt = model1.getValue("/root/tempData/child_flnm/record/sply_amt");
					var ch_occr_dt = model1.getValue("/root/tempData/child_flnm/record/ch_occr_dt");
					var ch_seq = model1.getValue("/root/tempData/child_flnm/record/ch_seq");
					model1.removenode("/root/tempData");
					
					model1.setValue("/root/resData/gridData/record["+datagrid2.row+"]/child_seqo",child_seqo);										
					model1.setValue("/root/resData/gridData/record["+datagrid2.row+"]/child_bidt",child_bidt);
					model1.setValue("/root/resData/gridData/record["+datagrid2.row+"]/sply_strt_yymm",sply_strt_yymm);
					model1.setValue("/root/resData/gridData/record["+datagrid2.row+"]/last_sply_yymm",last_sply_yymm);
					model1.setValue("/root/resData/gridData/record["+datagrid2.row+"]/sply_amt",sply_amt);
					model1.setValue("/root/resData/gridData/record["+datagrid2.row+"]/ch_occr_dt",ch_occr_dt);
					model1.setValue("/root/resData/gridData/record["+datagrid2.row+"]/ch_seq",ch_seq);
				]]>
			</script>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
					if(datagrid2.col == 1){
						if(event.target == "datagrid2"){						
							for(var i=1;i<datagrid2.rows;i++)	{
								var status = datagrid2.rowstatus(i);
								if(status == 0 && datagrid2.valueMatrix(i, datagrid2.colRef("actu_slip_no")) == ""){
									datagrid2.addStatus(i, "update");	
								}
							}						
						}
					} 
				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[
					if(datagrid2.col == 1 ){
						if(event.target == "datagrid2"){	
							for(var i=1;i<datagrid2.rows;i++)	{
								var status = datagrid2.rowstatus(i);
								if(status == 2){
									datagrid2.rowstatus(i) = 0;
								}
							}						
						}						
					} 
					model1.refresh();
				
				]]>
			</script>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
				if(event.target == "datagrid2")
				{
					if(datagrid2.rowStatus(1) == 1 && datagrid2.valueMatrix(1,2) == "" ) {return;}
					for(var i=1;i<datagrid2.rows;i++)	{
						var proc_stat = model1.getValue("/root/resData/gridData/record["+ i +"]/proc_stat");
						var status = datagrid2.rowstatus(i);
						//if(status == 0  &&  (proc_stat != '29' || proc_stat == '36') ){ 120216
						if(status == 0  &&  (proc_stat != model.getValue("/root/initData/hd_affr_2018_m/dataSet/xx_proc_stat_010")
										 || proc_stat == model.getValue("/root/initData/hd_affr_2018_m/dataSet/xx_proc_stat_020")) ){
							datagrid2.addStatus(i, "update");	
						}
					}
					for(var i=1 ;i<datagrid1.rows;i++){
						datagrid1.rowStatus(i) = 1;
					}		
					if(datagrid1.rows > 1 ){
						slip_submit_sum();
						setTitl_all(1);
					}
				}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[
				if(event.target == "datagrid2")
				{
					for(var i=1 ;i<datagrid1.rows;i++){
						datagrid1.rowStatus(i) = 0;
					}	
					if(datagrid1.rows > 1 ){
						slip_submit_sum();
						setTitl_all(2);
					}
				}
				]]>
			</script>
		</datagrid>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:10px; width:905px; height:21px; ">
			<button id="button3" class="btn03" style="left:627px; top:0px; width:64px; height:21px; ">
				<caption>양육비생성</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						/*
						if (!rowInSubmit(datagrid2)) {
							return;
						}
						
						var flag = false;
						if(datagrid2.rows == -1){
							alert("생성할 양육비가 없습니다.");
							return;
						}					
						if(datagrid2.valueMatrix(1,2) == ""){
							alert("생성할 양육비가 없습니다.");	
							return;
						}						
						
						for(var i=1;i<datagrid2.rows;i++){
							var chk = datagrid2.valueMatrix(i,datagrid2.colRef("chkbox")) 
							alert(chk);
							if(chk =='true'){
								flag = true;	
							}
						}

						if (window.alert("저장하시겠습니까?", "확인", 1) != 1) {
							return;
						}					

						if(!commGridReqCheck("datagrid2")) return;					
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_affr_2012");
						if(submit_completed()) {
							gridSearchList();
							//alert("양육비가 생성되었습니다");
						}							
						*/
						if (!commReqCheck(group2))
							return;
							
						var sply_yymm = input5.value.substring(0, 4) + "년 " + input5.value.substring(4, 6) + "월분";
						if (window.alert(sply_yymm + " 양육비 지급내역을 생성하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						
						model1.send("hd_affr_2017");
						if(submit_completed()) {
							gridSearchList();
						}
				]]>
				</script>
			</button>
			<button id="button5" class="btn04" style="left:763px; top:0px; width:87px; height:21px; ">
				<caption>발행(전표등록)</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var flag = true;
						/*
						if(datagrid1.rows == -1){
							alert("생성할전표가 없습니다.");
							return;
						}					
						if(datagrid1.valueMatrix(1,2) == ""){
							alert("생성할전표가 없습니다.");	
							return;
						}	
						*/		
						var flag1 = false;
						for(var i=1;i<datagrid2.rows;i++){
							var chk = datagrid2.valueMatrix(i,datagrid2.colRef("chkbox"));
							if(chk == "true"){
								flag1 = true;
							}
						}
						if(!flag1){
							alert("전표를 생성할 대상을 선택하십시오.");	
							return;
						}								
						for(var i=1; i<datagrid2.rows;i++){
							var proc_stat = model1.getValue("/root/resData/gridData/record["+i+"]/proc_stat");
							//var actu_slip_no = model1.getValue("/root/resData/gridData/record["+i+"]/actu_slip_no");
							//var pay_dt = model1.getValue("/root/resData/gridData/record["+i+"]/pay_dt");
							//전표 등록 체크
							var chk = datagrid2.valueMatrix(i,datagrid2.colRef("chkbox"));
							if(chk == "true"){
								var pattern = ","+proc_stat+",";
								var validation  = (","+model.getValue("/root/initData/hd_affr_2018_m/dataSet/xx_proc_stat_030")+",").indexOf(pattern)>-1;
								//if(proc_stat == 25 || proc_stat == 28){ 120216
								if(validation){
									flag = false;
								}
							}
						}
						if(flag){
							alert("전표를 생성할 대상이 존재하지 않습니다.");
							return;								
						}
						if (window.alert("전표를 생성하시겠습니까?", "확인", 1) != 1) {
							return;
						}	
						model1.setValue("/root/reqData/multiUpData1", datagrid1.getUpdateData());
						datagrid1.clearStatus();
						datagrid2.clearStatus();							
						model1.send("hd_affr_2014");
						var actu_slip_no = model1.getValue("/root/tempData/CURLIST/record/actu_slip_no");
						model1.removenode("/root/slipNoData/slip_no");
						model1.makeValue("/root/slipNoData/slip_no",actu_slip_no);
						model1.removenode("/root/tempData");						
						if(submit_completed()) {			
							gridSearchList();	
							
							// odi 파라미터 설정.					
						 	var ss_cmpy_cd = getProperty("ss_cmpycd");						 						
						 	var ss_emp_no = getProperty("ss_emp_no");
						 	var slip_no = model1.getValue("/root/slipNoData/slip_no");
						 	var emp_clsf = model1.getValue("/root/reqData/searchData/pay_plac_clsf");		
						 	var sply_yymm = model1.getValue("/root/reqData/searchData/sply_yymm");	
							 
							// 오즈관련 노드 초기화..
						 	resetOznode();	
						
						 	// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
						 	makeNodeValue("/root/oz_data/ozrName","hd/HD_AFFR_2016");					
						 	// 프린터로 직접출력할 경우에만 사용.. ( preview:미리보기,print:직접출력, export:파일 )					
							makeNodeValue("/root/oz_data/preview","preview");
							//model.makeNode("/root/oz_data/printsize");
							makeNodeValue("/root/oz_data/printsize","B5 (JIS)"); 		//페이지용지설정(기본 A4)
						 	
						 	makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd",ss_cmpy_cd);					
						 	makeNodeValue("/root/oz_data/odiParam/iv_actu_slip_no",slip_no);					
						 	makeNodeValue("/root/oz_data/odiParam/iv_incmg_pers",ss_emp_no);					 
						 	makeNodeValue("/root/oz_data/odiParam/iv_pay_plac_clsf",emp_clsf);	
						 	makeNodeValue("/root/oz_data/odiParam/iv_sply_yymm",sply_yymm);	
							
						 //   if(emp_clsf == "10"){
							
							 	//은행송금 확인서
						 		makeNodeValue("/root/oz_data/childCount","2");
								
								makeNodeValue("/root/oz_data/child1/ozrName","hd/HD_COM_3000_P");
								
								makeNodeValue("/root/oz_data/child1/odiParam/iv_cmpy_cd"     , ss_cmpy_cd);	
								makeNodeValue("/root/oz_data/child1/odiParam/iv_pay_plac_clsf",emp_clsf);	
								//makeNodeValue("/root/oz_data/child1/odiParam/iv_cmpy_cd"     ,"332" );	
								makeNodeValue("/root/oz_data/child1/odiParam/iv_actu_slip_no",actu_slip_no);
								
								makeNodeValue("/root/oz_data/child1/printsize","B5 (JIS)"); 		//페이지용지설정(기본 A4)
								
								//은행송금 의뢰서
								makeNodeValue("/root/oz_data/child2/ozrName","hd/HD_COM_3001_P");
								makeNodeValue("/root/oz_data/child2/odiParam/iv_cmpy_cd"     , ss_cmpy_cd );	
								makeNodeValue("/root/oz_data/child2/odiParam/iv_pay_plac_clsf",emp_clsf);	
								//makeNodeValue("/root/oz_data/child1/odiParam/iv_cmpy_cd"     ,"332" );	
								makeNodeValue("/root/oz_data/child2/odiParam/iv_actu_slip_no",actu_slip_no);
								makeNodeValue("/root/oz_data/child2/printsize","B5 (JIS)"); 		//페이지용지설정(기본 A4)
					 	 //	}
						 			
						 	// 레포트뷰어 호출.
						 	openOzwin("/root/oz_data");									
						}				
					]]>
				</script>
			</button>
			<button id="button6" class="btn02" style="left:572px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						gridSearchList();
					]]>
				</script>
			</button>
			<button id="button7" class="btn02" style="left:854px; top:0px; width:51px; height:21px; ">
				<caption>발행취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(searchFlag == false && actu_slip_no_in.value == ""){
							alert("취소할 전표번호를 입력하여 조회 후 진행하십시오.");	
							return;
						}								
						if (datagrid1.rows < 2) {
							alert("취소할 전표번호를 입력하여 조회 후 진행하십시오.");
							return;
						}					
						/*
						if(datagrid1.rows == 1){
							alert("취소할 전표번호를 조회해 주세요.");	
							return;
						}	
						*/				
						for(var i=1; i<datagrid1.rows;i++){
							var proc_stat = model1.getValue("/root/resData/slipData/record["+i+"]/proc_stat");
							var actu_slip_no = model1.getValue("/root/resData/slipData/record["+i+"]/actu_slip_no");
							//전표 등록 체크
							//if(proc_stat == 29 || proc_stat == 36){ 120216
							if(proc_stat == model.getValue("/root/initData/hd_affr_2018_m/dataSet/xx_proc_stat_010") 
							|| proc_stat == model.getValue("/root/initData/hd_affr_2018_m/dataSet/xx_proc_stat_020")){
							}else{
								alert("취소할 전표가 존재하지 않습니다.");
								return;								
							}
						}
						if (window.alert("전표를 취소하시겠습니까?", "확인", 1) != 1) {
							return;
						}							
						for(var i=0;i<datagrid1.rows;i++){ 
							datagrid1.addStatus(i, "insert");							
						}
						model1.setValue("/root/reqData/multiUpData1", datagrid1.getUpdateData());
						model1.send("hd_affr_2015");
						datagrid1.clearStatus();
						datagrid2.clearStatus();
						if(submit_completed()) {
							//alert('전표취소 되었습니다.');
							model1.reset();
							gridSearchList();									
						}
						
				     ]]>
				</script>
			</button>
			<button id="button1" class="btn03" style="left:695px; top:0px; width:63px; height:21px; ">
				<caption>생성취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (datagrid2.rows < 2) {
							alert("취소할 대상이 없습니다.");
							return;
						}
						
						if (datagrid2.valueMatrix(1, 3) == "") {
							alert("취소할 대상이 없습니다.");
							return;
						}

						for (i = 1; i < datagrid2.rows; i++) {
							if (datagrid2.valueMatrix(i, datagrid2.colRef("actu_slip_no")) != "") {
								alert("현업전표등록 상태이므로 취소할 수 없습니다. 전표발행취소 후 진행하십시오.");
								return;
							}
						}
						
						if (!commReqCheck(group2))
							return;
							
						var sply_yymm = input5.value.substring(0, 4) + "년 " + input5.value.substring(4, 6) + "월분";
						if (window.alert(sply_yymm + " 양육비 지급내역 생성을 취소하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						
						for (i = 1; i < datagrid2.rows; i++)
							datagrid2.rowStatus(i) = 4;
							
						//if(!commGridReqCheck("datagrid2")) return;					
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_affr_2012");
						if(submit_completed()) {
							gridSearchList();
						}							
				]]>
				</script>
			</button>
			<button id="button4" class="btn02" style="left:517px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.reset();
					]]>
				</script>
			</button>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/slipData/record" visibility="hidden" caption="회사코드^사번^부서^이름^차변금액(개인)^대변금액(총합계)^적요1^전표관리번호^전표일련번호^전표발생일자^전표구분코드^입력자^입력자IP^진행상태^관리일자^관리번호^사원구분^OCCR_DT^SEQ" colsep="#" colwidth="63, 79, 100, 100, 100, 114, 170, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:10px; top:380px; width:905px; height:215px; ">
			<col ref="cmpy_cd"/>
			<col ref="emp_no"/>
			<col ref="dept_cd"/>
			<col ref="flnm"/>
			<col ref="tmp_dr_amt"/>
			<col ref="tmp_crdt_amt"/>
			<col ref="titl"/>
			<col ref="actu_slip_no"/>
			<col ref="slip_seq"/>
			<col ref="slip_occr_dt"/>
			<col ref="slip_clsf_cd"/>
			<col ref="incmg_pers"/>
			<col ref="incmg_pers_ipadd"/>
			<col ref="proc_stat"/>
			<col ref="slip_proc_mang_dt"/>
			<col ref="slip_proc_mang_seq"/>
			<col ref="cmpy_welf_fund_clsf"/>
			<col ref="occr_dt"/>
			<col ref="seq"/>
		</datagrid>
		<caption id="gridrowcnt" style="left:815px; top:625px; width:100px; height:20px; font-weight:bold; text-align:right; "/>
		<group id="group2" style="left:10px; top:40px; width:905px; height:26px; ">
			<caption id="caption19" class="list_cap02" style="left:70px; top:0px; width:835px; height:26px; "/>
			<input id="actu_slip_no_in" ref="/root/reqData/searchData/actu_slip_no" format="99999999-99-999" style="left:545px; top:4px; width:100px; height:18px; "/>
			<caption id="caption1" class="list_cap01" style="left:0px; top:0px; width:86px; height:26px; ">지원년월</caption>
			<caption id="caption3" class="list_cap01" style="left:224px; top:0px; width:86px; height:26px; ">발행대상구분</caption>
			<caption id="caption5" class="list_cap01" style="left:454px; top:0px; width:86px; height:26px; ">전표번호</caption>
			<select1 id="radio2" ref="/root/reqData/searchData/pay_plac_clsf" appearance="full" cols="2" overflow="visible" style="left:314px; top:4px; width:92px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>사원</label>
						<value>20</value>
					</item>
					<item>
						<label>임원</label>
						<value>10</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
				]]>
				</script>
			</select1>
			<input id="input5" ref="/root/reqData/searchData/sply_yymm" class="req" navindex="1" inputtype="date" maxlength="6" format="yyyy-mm" caption="지원년월" style="left:91px; top:4px; width:85px; height:18px; "/>
		</group>
	</xhtml:body>
</xhtml:html>
