<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<posi_cd>
								<item>
									<lable/>
									<value/>
								</item>
							</posi_cd>
							<dty_cd>
								<item>
									<lable/>
									<value/>
								</item>
							</dty_cd>
						</comboSet>
						<pageInfo/>
					</initData>
					<reqData>
						<searchData>
							<s_emp_no/>
							<s_nm_korn/>
							<s_prn/>
						</searchData>
						<reqForm>
							<certi_clsf/>
							<emp_no/>
							<dept_cd/>
							<dty_cd/>
							<posi_cd/>
							<dept_nm/>
							<dty_name/>
							<posi_name/>
							<prn/>
							<in_cmpy_dt/>
							<issu_num_shet/>
							<issu_dt/>
							<issu_no/>
							<nm_korn/>
							<usag/>
							<remk/>
							<dirc_incmg_posi/>
							<dty_cd_ck/>
							<posi_cd_ck/>
							<dirc_incmg_posi_ck/>
							<mode/>
							<seq/>
							<cmpy_cd/>
							<et_in_cmpy_dt/>
							<occr_dt/>
							<prn_cnt/>
							<busi_trip_purp/>
							<busi_trip_area/>
							<busi_trip_frdt/>
							<busi_trip_todt/>
							<engl_flnm/>
							<engl_bidt/>
							<engl_dept_posi/>
							<engl_in_cmpy_dt/>
							<engl_now_dt/>
							<engl_busi_trip_purp/>
							<engl_busi_trip_area/>
							<engl_busi_trip_frdt/>
							<engl_busi_trip_todt/>
							<dirc_incmg_posi/>
							<chce_posi_clsf/>
							<issu_clsf/>
							<aplc_seq/>
							<multiUpData/>
						</reqForm>
						<fwdData>
							<func_nm/>
						</fwdData>
						<popData>
							<emp_no/>
							<cmpy_cd/>
						</popData>
					</reqData>
					<resData>
						<resForm>
							<certi_clsf/>
							<emp_no/>
							<dept_cd/>
							<dty_cd/>
							<posi_cd/>
							<dept_nm/>
							<dty_name/>
							<posi_name/>
							<prn/>
							<in_cmpy_dt/>
							<issu_num_shet/>
							<issu_dt/>
							<issu_no/>
							<nm_korn/>
							<usag/>
							<remk/>
							<dirc_incmg_posi/>
							<dty_cd_ck/>
							<posi_cd_ck/>
							<dirc_incmg_posi_ck/>
							<seq/>
							<mode/>
							<cmpy_cd/>
							<et_in_cmpy_dt/>
							<occr_dt/>
							<prn_cnt/>
							<busi_trip_purp/>
							<busi_trip_area/>
							<busi_trip_frdt/>
							<busi_trip_todt/>
							<engl_flnm/>
							<engl_bidt/>
							<engl_dept_posi/>
							<engl_in_cmpy_dt/>
							<engl_now_dt/>
							<engl_busi_trip_purp/>
							<engl_busi_trip_area/>
							<engl_busi_trip_frdt/>
							<engl_busi_trip_todt/>
							<dirc_incmg_posi/>
							<chce_posi_clsf/>
							<issu_clsf/>
						</resForm>
						<msg/>
						<gridData>
							<record>
								<cmpy_cd/>
								<emp_no/>
								<seq/>
								<dept_cd/>
								<appmt_dt/>
								<dty_cd/>
								<posi_cd/>
								<prt_usag_dty_cd/>
								<dty_name/>
								<posi_name/>
								<prt_usag_dty_cd_name/>
								<appmt_cont/>
								<dept_name/>
								<remk/>
								<certi_clsf/>
							</record>
						</gridData>
						<tm_cnt/>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					
					function setEmpInfo(emp_no, nm_korn){
					
						model1.setValue("/root/reqData/reqForm/emp_no", emp_no);
						model1.setValue("/root/reqData/reqForm/nm_korn", nm_korn);
						model1.send("hd_affr_6010");
						//model1.copyNode("/root/reqData/reqForm","/root/tempData/record");
						model1.setValue("/root/reqData/reqForm/certi_clsf",model1.getValue("/root/reqData/reqForm/certi_clsf"));

						model1.setValue("/root/reqData/reqForm/cmpy_cd",	model1.getValue("/root/tempData/record/cmpy_cd"));
						model1.setValue("/root/reqData/reqForm/emp_no",	model1.getValue("/root/tempData/record/emp_no"));	
						model1.setValue("/root/reqData/reqForm/dept_cd",	model1.getValue("/root/tempData/record/dept_cd"));	
						model1.setValue("/root/reqData/reqForm/dty_cd",	model1.getValue("/root/tempData/record/dty_cd"));	
						model1.setValue("/root/reqData/reqForm/posi_cd",	model1.getValue("/root/tempData/record/posi_cd"));		
						model1.setValue("/root/reqData/reqForm/dept_nm",	model1.getValue("/root/tempData/record/dept_nm"));		
						model1.setValue("/root/reqData/reqForm/dty_name",model1.getValue("/root/tempData/record/dty_name"));	
						model1.setValue("/root/reqData/reqForm/posi_name",model1.getValue("/root/tempData/record/posi_name"));	
						model1.setValue("/root/reqData/reqForm/prn",model1.getValue("/root/tempData/record/prn"));	
						model1.setValue("/root/reqData/reqForm/in_cmpy_dt",model1.getValue("/root/tempData/record/in_cmpy_dt"));		
						model1.setValue("/root/reqData/reqForm/et_in_cmpy_dt", commCurDate("ymd"));				
						model1.removenode("/root/tempData");
						datagrid2.refresh();
						model1.refresh();
						rowCnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + " 건";
						
						model1.setValue("/root/resData/tm_cnt", "");
						model1.send("hd_affr_6023");
						model1.copyNode("/root/initData/comboSet/posi_cd", "/root/tempData/posi_cd");
						model1.copyNode("/root/initData/comboSet/dty_cd", "/root/tempData/dty_cd");
						model1.removenode("/root/tempData");
					}

					function posi_ck()	{
						var chk = 0;
					
						if(dty_cd_ck.value == "10") chk++;
						if(posi_cd_ck.value == "20") chk++;
						if(dirc_incmg_posi_ck.value == "30") chk++;
						if(chk >1) {
							return false;
						}else{
							return true;
						}
					}

					function loadData(seq,cmpy_cd,certi_clsf, emp_no, occr_dt, dept_cd, dty_cd, posi_cd, dept_nm, dty_name, posi_name,prn,prn_cnt, in_cmpy_dt, issu_num_shet, issu_dt , issu_no,nm_korn,usag,remk,busi_trip_purp, busi_trip_area, busi_trip_frdt, busi_trip_todt, engl_flnm, engl_bidt, engl_dept_posi, engl_in_cmpy_dt, engl_now_dt, engl_busi_trip_purp, engl_busi_trip_area, engl_busi_trip_frdt, engl_busi_trip_todt,dirc_incmg_posi,chce_posi_clsf,issu_clsf,now_dt,aplc_seq,issu_clsf_name) {
						
						//resetData("20"); 120220
						resetData(model1.getValue("/root/reqData/reqForm/certi_clsf"));
						
						re_Data(issu_clsf_name);
						
						model1.setValue("/root/reqData/reqForm/cmpy_cd",cmpy_cd);
						model1.setValue("/root/reqData/reqForm/seq",seq);	
						model1.setValue("/root/reqData/reqForm/certi_clsf",certi_clsf);	
						model1.setValue("/root/reqData/reqForm/occr_dt", occr_dt);
						model1.setValue("/root/reqData/reqForm/issu_no",issu_no);	
						model1.setValue("/root/reqData/reqForm/issu_num_shet",issu_num_shet);	
						model1.setValue("/root/reqData/reqForm/emp_no",emp_no);	
						model1.setValue("/root/reqData/reqForm/dept_cd",dept_cd);	
						model1.setValue("/root/reqData/reqForm/dty_cd",dty_cd);	
						model1.setValue("/root/reqData/reqForm/posi_cd",posi_cd);		
						model1.setValue("/root/reqData/reqForm/dept_nm",dept_nm);		
						model1.setValue("/root/reqData/reqForm/dty_name",dty_name);	
						model1.setValue("/root/reqData/reqForm/posi_name",posi_name);	
						model1.setValue("/root/reqData/reqForm/prn",prn);	
						model1.setValue("/root/reqData/reqForm/in_cmpy_dt",in_cmpy_dt);	
						model1.setValue("/root/reqData/reqForm/issu_dt",issu_dt);	
						model1.setValue("/root/reqData/reqForm/issu_no",issu_no);	
						model1.setValue("/root/reqData/reqForm/nm_korn",nm_korn);	
						model1.setValue("/root/reqData/reqForm/usag",usag);	
						model1.setValue("/root/reqData/reqForm/remk",remk);	
						model1.setValue("/root/reqData/reqForm/et_in_cmpy_dt", commCurDate("ymd"));
						model1.setValue("/root/reqData/reqForm/prn_cnt", prn_cnt);
						
						model1.setValue("/root/reqData/reqForm/busi_trip_purp",busi_trip_purp);	
						model1.setValue("/root/reqData/reqForm/busi_trip_area",busi_trip_area);	
						model1.setValue("/root/reqData/reqForm/busi_trip_frdt",busi_trip_frdt);	
						model1.setValue("/root/reqData/reqForm/busi_trip_todt",busi_trip_todt);	
						model1.setValue("/root/reqData/reqForm/engl_flnm",engl_flnm);		
						model1.setValue("/root/reqData/reqForm/engl_bidt",engl_bidt);		
						model1.setValue("/root/reqData/reqForm/engl_dept_posi",engl_dept_posi);	
						model1.setValue("/root/reqData/reqForm/engl_in_cmpy_dt",engl_in_cmpy_dt);	
						model1.setValue("/root/reqData/reqForm/engl_now_dt",engl_now_dt);		
						model1.setValue("/root/reqData/reqForm/engl_busi_trip_purp",engl_busi_trip_purp);
						model1.setValue("/root/reqData/reqForm/engl_busi_trip_area",engl_busi_trip_area);
						model1.setValue("/root/reqData/reqForm/engl_busi_trip_frdt",engl_busi_trip_frdt);
						model1.setValue("/root/reqData/reqForm/engl_busi_trip_todt",engl_busi_trip_todt);
						model1.setValue("/root/reqData/reqForm/dirc_incmg_posi",dirc_incmg_posi);
						model1.setValue("/root/reqData/reqForm/chce_posi_clsf",chce_posi_clsf);
						model1.setValue("/root/reqData/reqForm/issu_clsf",issu_clsf);
						model1.setValue("/root/reqData/reqForm/aplc_seq",aplc_seq);
						
						
						model1.send("hd_affr_6023");
						model1.copyNode("/root/resData/gridData","/root/tempData/CURLIST");
						model1.refresh();
						for(i=datagrid2.fixedRows;i<=datagrid2.rows;i++){
							datagrid2.addStatus(i,"update");
						}
						model1.copyNode("/root/initData/comboSet/posi_cd", "/root/tempData/posi_cd");
						model1.copyNode("/root/initData/comboSet/dty_cd", "/root/tempData/dty_cd");
						
						model1.refresh();	
						
						rowCnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + " 건";
					}
					
					function resetData(certi_clsf) {
						model1.reset();
						datagrid2.removeRow();
						datagrid2.refresh();
						
						model1.send("hd_affr_6023");
//						model1.copyNode("/root/resData/gridData","/root/tempData/CURLIST");
     					model1.copyNode("/root/initData/comboSet/posi_cd", "/root/tempData/posi_cd");
						model1.copyNode("/root/initData/comboSet/dty_cd", "/root/tempData/dty_cd");
						
						model1.setValue("/root/reqData/reqForm/certi_clsf",certi_clsf);	
						//alert(model1.getValue("/root/reqData/reqForm/certi_clsf"));
						model1.refresh();
						datagrid2.clearStatus();
						rowCnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + " 건";

						group1.disabled = false;
						btnG1.disabled = false;
						button1.disabled = false;
						button2.disabled = false;
						button3.disabled = false;
						button4.disabled = true;
						var rows = datagrid2.rows - 1;
						for(var i = 1; i < rows; i++){
							datagrid2.isReadOnly(i, 7) = false;
						}
					}
				
					function loadPopData(cmpyCd, empNo, appmtDt, appmtCont,deptName,posiName,dtyName,prtUsagDtyCdName,deptCd, posiCd, dtyCd, prtUsagDtyCd) {
						//datagrid2.clearStatus();
						var cmpyCdArry = cmpyCd.split("::");
						var empNoArry = empNo.split("::");
						var appmtDtArry = appmtDt.split("::");
						var appmtContArry = appmtCont.split("::");
						var deptNameArry = deptName.split("::");
						var posiNameArry = posiName.split("::");
						var dtyNameArry = dtyName.split("::");
						var prtUsagDtyCdNameArry = prtUsagDtyCdName.split("::");
						var deptCdArry = deptCd.split("::");
						var posiCdArry = posiCd.split("::");
						var dtyCdArry = dtyCd.split("::");
						var prtUsagDtyCdArry = prtUsagDtyCd.split("::");
						var dupChk = false;
						
						if (datagrid2.rows == 1)
							datagrid2.addRow(true, true);
							
						for(var i=0; i<appmtDtArry.length; i++) {
							for(var k=1; k<=datagrid2.Rows; k++) {
								if(datagrid2.valueMatrix(k, datagrid2.colRef("appmt_dt")) == appmtDtArry[i]) {
									dupChk=true
								}
							}
							
							if(dupChk==false) {
								if (datagrid2.valueMatrix(1, 1) != "") {
									datagrid2.addRow(true, true);
								}
								var nodeList = root.selectNodes("/root/resData/gridData/record");
								rowIdx = nodeList.length;
						
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/cmpy_cd", cmpyCdArry[i]);
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/emp_no", model1.getValue("/root/reqData/reqForm/emp_no"));
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/appmt_dt", appmtDtArry[i]);
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/appmt_cont", appmtContArry[i]);
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_name", deptNameArry[i]);
								//model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_name", posiNameArry[i]);
								//model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_name", dtyNameArry[i]);
								//model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/prt_usag_dty_cd_name", prtUsagDtyCdNameArry[i]);
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_cd", deptCdArry[i]);
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_cd", posiCdArry[i]);
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_cd", dtyCdArry[i]);
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/prt_usag_dty_cd", prtUsagDtyCdArry[i]);
								model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/certi_clsf", model1.getValue("/root/reqData/reqForm/certi_clsf"));
								
							}
							datagrid2.rowStatus(datagrid2.rows-1) = 3;
							dupChk = false;
						}
						datagrid2.refresh();
						model1.refresh();	
						
						rowCnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + " 건";
					}
					
					function setDept_cd(iv_dept_cd, iv_dept_nm){
						var rowIdx = datagrid2.row;
						
						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_cd",iv_dept_cd);
						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_name", iv_dept_nm);
						 datagrid2.addStatus(rowIdx, "update");
						model1.refresh();
					}
					
					function re_Data(issu_clsf_name){
						if(issu_clsf_name == "발급"){
							group1.disabled = true;
							btnG1.disabled = true;
							button1.disabled = true;
							button2.disabled = true;
							button3.disabled = true;
							button4.disabled = false;
							var rows = datagrid2.rows - 1;
							for(var i = 1; i < rows; i++){
								datagrid2.isReadOnly(i, 7) = true;
							}
						}else if(issu_clsf_name == "미발급"){
							group1.disabled = false;
							btnG1.disabled = false;
							button1.disabled = false;
							button2.disabled = false;
							button3.disabled = false;
							button4.disabled = true;
							var rows = datagrid2.rows - 1;
							for(var i = 1; i < rows; i++){
								datagrid2.isReadOnly(i, 7) = false;
							}
						}
						model1.refresh();
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					//model1.setValue("/root/reqData/reqForm/certi_clsf", "20"); 120220
					model1.setValue("/root/reqData/reqForm/certi_clsf", model1.getValue("/root/reqData/reqForm/certi_clsf"));
					rowCnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + " 건";
					button4.disabled = true;
					button4.refresh();
	
					//model1.setValue("/root/reqData/reqForm/et_in_cmpy_dt", DateDemo());
					//iv_ActionBtn.btnA3.text = "취소";
				]]>
			</script>
			<submission id="hd_info_1001" action="/hd/info/1001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="hd_com_1200" action="/hd/com/1200" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm/nm_korn" resultref="/root/tempData"/>
			<submission id="hd_affr_6011" action="/hd/affr/6011" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="hd_affr_6010" action="/hd/affr/6010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="hd_affr_6012" action="/hd/affr/6012" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="hd_affr_6023" action="/hd/affr/6023" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="hd_affr_6024" action="/hd/affr/6024" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<script type="javascript" src="/js/CIISComm.js"/>
		</model>
	</xhtml:head>
	<xhtml:body pagewidth="925" pageheight="400" guideline="2,9;1,921;2,33;">
		<button id="btnG1" class="btn02" style="left:695px; top:10px; width:51px; height:21px; ">
			<caption>발급</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var  certi_clsf = model1.getValue("/root/reqData/reqForm/certi_clsf")	//자격증구분코드
					var  emp_no = model1.getValue("/root/reqData/reqForm/emp_no"); 	//사원번호
					var nm_korn = model1.getValue("/root/reqData/reqForm/nm_korn"); 	//사원번호
					var  dept_cd = model1.getValue("/root/reqData/reqForm/dept_cd");	//부서코드
					var  dty_cd = model1.getValue("/root/reqData/reqForm/dty_cd"); 	//직급명
					var  posi_cd = model1.getValue("/root/reqData/reqForm/posi_cd"); 	//직책코드
					var  dept_nm = model1.getValue("/root/reqData/reqForm/dept_nm");	//부서명
					var  dty_name = model1.getValue("/root/reqData/reqForm/dty_name"); 	//직급명
					var  posi_name = model1.getValue("/root/reqData/reqForm/posi_name"); 	//직책명
					var  prn = model1.getValue("/root/reqData/reqForm/prn"); 	//주민등록번호
					var in_cmpy_dt = model1.getValue("/root/reqData/reqForm/in_cmpy_dt"); 	//입사일
					var issu_num_shet = model1.getValue("/root/reqData/reqForm/issu_num_shet"); 	//발급매수
					var issu_dt =  model1.getValue("/root/reqData/reqForm/issu_dt"); 	//발급일
					var issu_no=  model1.getValue("/root/reqData/reqForm/ issu_no"); 	//발급번호
					var nm_korn = model1.getValue("/root/reqData/reqForm/nm_korn"); 	//사원명
					var usag = model1.getValue("/root/reqData/reqForm/usag"); 	//용도
					var remk = model1.getValue("/root/reqData/reqForm/remk"); 	//비고					
					var cmpy_cd =model1.getValue("/root/reqData/reqForm/cmpy_cd"); 	//비고

					if (commReqCheck(group1)) { 
						if (!rowInSubmit(datagrid2)) {
							return;
						}
						
						model1.setValue("/root/reqData/reqForm/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_affr_6024");
					}
					
					window.parent.javascript.loadParentData();
					
					var issu_clsf = model1.getValue("/root/reqData/reqForm/issu_clsf");
					if (issu_clsf == "") {
						alert("발급대상을 상단의 목록에서 선택하고 다시한번 발급버튼을 누르십시오.");
						//resetData(20); //120220
						resetData(model1.getValue("/root/reqData/reqForm/certi_clsf"));
						return;
					}
					
					//저장후    수정일 : 20091123
						//button1.dispatch("onclick");
	
					if (issu_clsf == "10") {
						if (window.alert("발급하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						
						
						model1.send("hd_affr_6012");

						if(submit_completed()) {
							var iv_seq  		=   model1.getValue("/root/reqData/reqForm/seq"); 		
							var iv_emp_no  		=   model1.getValue("/root/reqData/reqForm/emp_no"); 		
							var  iv_aplc_seq  	=   model1.getValue("/root/reqData/reqForm/aplc_seq"); 		
							var iv_occr_dt  		=   model1.getValue("/root/reqData/reqForm/occr_dt"); 		
							// 오즈관련 노드 초기화..					
						 	resetOznode();					
						 						
						 	// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
					 	 	makeNodeValue("/root/oz_data/ozrName","hd/HD_AFFR_6030");
							//makeNodeValue("/root/oz_data/preview","preview"); 			//preview : 미리보기, print : 인쇄
							//makeNodeValue("/root/oz_data/printsize",""); 				//페이지용지설정(기본 A4)																				
										
						 	// odi 파라미터 설정.					
						 	makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , getProperty("ss_cmpycd") );
							makeNodeValue("/root/oz_data/odiParam/iv_seq" , iv_seq );
							makeNodeValue("/root/oz_data/odiParam/iv_emp_no" , iv_emp_no );
							makeNodeValue("/root/oz_data/odiParam/iv_aplc_seq" , iv_aplc_seq );
							makeNodeValue("/root/oz_data/odiParam/iv_occr_dt" , iv_occr_dt );
							
						 	// 레포트뷰어 호출.					
						 	openOzwin("/root/oz_data");	
						 	loadData();
							window.parent.javascript.loadParentData();
							//resetData(20); 120220
							resetData(model1.getValue("/root/reqData/reqForm/certi_clsf"));
							datagrid2.clearStatus();
						}
					}
				]]>
			</script>
		</button>
		<group id="group1" style="left:10px; top:40px; width:905px; height:78px; ">
			<caption id="caption2" class="list_cap01" style="left:0px; top:0px; width:85px; height:26px; text-align:center; ">발급번호</caption>
			<caption id="caption20" class="list_cap02" style="left:84px; top:0px; width:175px; height:26px; text-align:center; "/>
			<caption id="caption21" class="list_cap01" style="left:258px; top:0px; width:100px; height:26px; text-align:center; ">발급매수</caption>
			<caption id="caption23" class="list_cap01" style="left:493px; top:0px; width:80px; height:26px; text-align:center; ">발급일</caption>
			<caption id="caption24" class="list_cap02" style="left:357px; top:0px; width:137px; height:26px; text-align:center; "/>
			<caption id="caption25" class="list_cap02" style="left:572px; top:0px; width:333px; height:26px; text-align:center; "/>
			<caption id="caption27" class="list_cap01" style="left:0px; top:25px; width:85px; height:26px; text-align:center; ">성    명</caption>
			<caption id="caption33" class="list_cap02" style="left:84px; top:25px; width:175px; height:26px; text-align:center; "/>
			<caption id="caption49" class="list_cap02" style="left:357px; top:25px; width:548px; height:26px; text-align:center; "/>
			<caption id="caption22" class="list_cap01" style="left:258px; top:25px; width:100px; height:26px; text-align:center; ">주민등록번호</caption>
			<output id="input1" ref="/root/reqData/reqForm/issu_no" appearance="output" style="left:89px; top:4px; width:105px; height:18px; "/>
			<input id="input2" ref="/root/reqData/reqForm/issu_num_shet" class="req" maxlength="3" format="999" caption="발급매수" style="left:362px; top:4px; width:53px; height:18px; text-align:right; "/>
			<output id="input9" ref="/root/reqData/reqForm/issu_dt" format="yyyy-mm-dd" inputtype="date" disabled="false" appearance="output" style="left:577px; top:4px; width:85px; height:18px; "/>
			<input id="input3" ref="/root/reqData/reqForm/emp_no" class="req" inputtype="button" maxlength="6" format="9999999999" caption="사번" appearance="input" style="left:89px; top:29px; width:74px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[ 
						model1.setValue("/root/reqData/fwdData/func_nm", "setEmpInfo");
						//window.load("/xrw/hd/com/hd_com_1000.xrw","mdichild", "hd_com_1000", "", "/root/reqData/fwdData", "/root/reqData/fwdData");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","modal", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");

					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						/*
						if (event.keyCode == 13) {
							setEmpInfo(input2.currentText);
						}
						*/
						if (event.keyCode ==13){
							var emp_no = input3.currentText;
							model1.setValue("/root/reqData/reqForm/nm_korn", "");
							model1.setValue("/root/reqData/reqForm/emp_no", emp_no);
							model1.setValue("/root/reqData/reqForm/prn", "");
							setInfoSearchInput(emp_no, "", "", ""); // 사번, 성명, 주민번호
								
							if(model1.getValue("/root/tempData/totalcnt") != 1){
								return;
							} // 카운트
							
							model1.setValue("/root/reqData/reqForm/emp_no", model1.getValue("/root/tempData/emp_no")); // 사번
							model1.setValue("/root/reqData/reqForm/nm_korn", model1.getValue("/root/tempData/nm_korn")); // 성명
							//model1.setValue("", model1.getValue("/root/tempData/dept_cd")); // 부서코드
							//model1.setValue("/root/reqData/reqForm/dept_nm", model1.getValue("/root/tempData/dept_nm")); // 부서명
							//model1.setValue("", model1.getValue("/root/tempData/dty_cd")); // 직책코드
							//model1.setValue("/root/reqData/reqForm/dty_name", model1.getValue("/root/tempData/dty_nm")); // 직책명
							//model1.setValue("", model1.getValue("/root/tempData/posi_cd")); // 직급코드
							//model1.setValue("/root/reqData/reqForm/posi_name", model1.getValue("/root/tempData/posi_nm")); // 직급명
							
							//model1.removenode("/root/tempData");
							model1.refresh();
							
							//model1.send("hd_com_1200");
							//var cnt = model1.getValue("/root/dataSet/CURLIST/record/cnt");
							//model1.removenode("/root/dataSet");
							/*
							if(cnt == "0"){
								alert("조회 정보와 일치하는 사원이 없습니다.");
								return;
							}else if(cnt == "1"){ // 중복된 성명이 없을때
							*/
								model1.send("hd_info_1001");
								//model1.copyNode("/root/resData/resForm", "/root/tempData");
								setEmpInfo(model1.getValue("/root/tempData/emp_no"), model1.getValue("/root/tempData/nm_korn"))
								model1.removenode("/root/tempData");
								model1.removenode("/root/totalcnt");
								//model1.refresh();
							/*
							}else if(cnt != "1"){ // 성명이 한개 이상일때
								model.removeNodeset("/root/reqData/fwdData");  
								model.makeNode("/root/reqData/fwdData/func_nm");
								model.setValue("/root/reqData/fwdData/func_nm", "setEmpInfo");
								model.makeNode("/root/reqData/fwdData/nm_korn");
								model.setValue("/root/reqData/fwdData/nm_korn", nm_korn);
								window.load("/xrw/hd/com/HD_COM_1200.xrw","mdichild", "hd_com_1200", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
							}
							*/
							model1.refresh();
						}
					]]>
				</script>
				<script type="javascript" ev:event="onmaxlength">
					<![CDATA[
							var emp_no = input3.currentText;
							model1.setValue("/root/reqData/reqForm/nm_korn", "");
							model1.setValue("/root/reqData/reqForm/emp_no", emp_no);
							model1.setValue("/root/reqData/reqForm/prn", "");
							setInfoSearchInput(emp_no, "", "", ""); // 사번, 성명, 주민번호
								
							if(model1.getValue("/root/tempData/totalcnt") != 1){
								return;
							} // 카운트
							
							model1.setValue("/root/reqData/reqForm/emp_no", model1.getValue("/root/tempData/emp_no")); // 사번
							model1.setValue("/root/reqData/reqForm/nm_korn", model1.getValue("/root/tempData/nm_korn")); // 성명
							//model1.setValue("", model1.getValue("/root/tempData/dept_cd")); // 부서코드
							//model1.setValue("/root/reqData/reqForm/dept_nm", model1.getValue("/root/tempData/dept_nm")); // 부서명
							//model1.setValue("", model1.getValue("/root/tempData/dty_cd")); // 직책코드
							//model1.setValue("/root/reqData/reqForm/dty_name", model1.getValue("/root/tempData/dty_nm")); // 직책명
							//model1.setValue("", model1.getValue("/root/tempData/posi_cd")); // 직급코드
							//model1.setValue("/root/reqData/reqForm/posi_name", model1.getValue("/root/tempData/posi_nm")); // 직급명
							
							//model1.removenode("/root/tempData");
							model1.refresh();
							
							//model1.send("hd_com_1200");
							//var cnt = model1.getValue("/root/dataSet/CURLIST/record/cnt");
							//model1.removenode("/root/dataSet");
							/*
							if(cnt == "0"){
								alert("조회 정보와 일치하는 사원이 없습니다.");
								return;
							}else if(cnt == "1"){ // 중복된 성명이 없을때
							*/
								model1.send("hd_info_1001");
								//model1.copyNode("/root/resData/resForm", "/root/tempData");
								setEmpInfo(model1.getValue("/root/tempData/emp_no"), model1.getValue("/root/tempData/nm_korn"))
								model1.removenode("/root/tempData");
								model1.removenode("/root/totalcnt");
								//model1.refresh();
							/*
							}else if(cnt != "1"){ // 성명이 한개 이상일때
								model.removeNodeset("/root/reqData/fwdData");  
								model.makeNode("/root/reqData/fwdData/func_nm");
								model.setValue("/root/reqData/fwdData/func_nm", "setEmpInfo");
								model.makeNode("/root/reqData/fwdData/nm_korn");
								model.setValue("/root/reqData/fwdData/nm_korn", nm_korn);
								window.load("/xrw/hd/com/HD_COM_1200.xrw","mdichild", "hd_com_1200", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
							}
							*/
							model1.refresh();
					]]>
				</script>
			</input>
			<input id="certi_nm_korn" ref="/root/reqData/reqForm/nm_korn" class="req" imemode="hangul" maxlength="5" caption="성명" appearance="input" style="left:167px; top:29px; width:87px; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if (event.keyCode ==13){
						var nm_korn = certi_nm_korn.currentText;
						model1.setValue("/root/reqData/reqForm/nm_korn", nm_korn);
						model1.setValue("/root/reqData/reqForm/emp_no", "");
						model1.setValue("/root/reqData/reqForm/prn", "");
						model1.send("hd_com_1200");
						var cnt = model1.getValue("/root/dataSet/CURLIST/record/cnt");
						model1.removenode("/root/dataSet");
						if(cnt == "0"){
							alert(nm_korn + " 사원에 대한 정보가 없습니다.");
							return;
						}else if(cnt == "1"){ // 중복된 성명이 없을때
							model1.send("hd_info_1001");
							//model1.copyNode("/root/resData/resForm", "/root/tempData");
							setEmpInfo(model1.getValue("/root/tempData/emp_no"), model1.getValue("/root/tempData/nm_korn"))
							model1.removenode("/root/tempData");
							model1.removenode("/root/totalcnt");
							//model1.refresh();
						}else if(cnt != "1"){ // 성명이 한개 이상일때
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/func_nm");
							model.setValue("/root/reqData/fwdData/func_nm", "setEmpInfo");
							model.makeNode("/root/reqData/fwdData/nm_korn");
							model.setValue("/root/reqData/fwdData/nm_korn", nm_korn);
							window.load("/xrw/hd/com/HD_COM_1200.xrw","modal", "hd_com_1200", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						}
						//model1.refresh();
					}
					]]>
				</script>
				<caption/>
			</input>
			<output id="input31" ref="/root/reqData/reqForm/prn" class="req" format="999999-9999999" caption="주민등록번호" appearance="output" style="left:362px; top:29px; width:207px; height:18px; "/>
			<caption id="caption3" class="list_cap02" style="left:84px; top:50px; width:821px; height:26px; text-align:center; "/>
			<caption id="caption4" class="list_cap01" style="left:0px; top:50px; width:85px; height:26px; text-align:center; ">용도</caption>
			<caption id="caption6" class="list_cap01" style="left:493px; top:50px; width:80px; height:26px; text-align:center; ">비고</caption>
			<input id="input10" ref="/root/reqData/reqForm/usag" class="req" maxlength="50" caption="용도" style="left:89px; top:54px; width:391px; height:18px; "/>
			<input id="input11" ref="/root/reqData/reqForm/remk" maxlength="50" style="left:577px; top:54px; width:313px; height:18px; "/>
		</group>
		<button id="button1" class="btn02" visibility="visible" style="left:640px; top:10px; width:51px; height:21px; ">
			<caption>저장</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var  certi_clsf = model1.getValue("/root/reqData/reqForm/certi_clsf")	//자격증구분코드
					var  emp_no = model1.getValue("/root/reqData/reqForm/emp_no"); 	//사원번호
					var nm_korn = model1.getValue("/root/reqData/reqForm/nm_korn"); 	//사원번호
					var  dept_cd = model1.getValue("/root/reqData/reqForm/dept_cd");	//부서코드
					var  dty_cd = model1.getValue("/root/reqData/reqForm/dty_cd"); 	//직급명
					var  posi_cd = model1.getValue("/root/reqData/reqForm/posi_cd"); 	//직책코드
					var  dept_nm = model1.getValue("/root/reqData/reqForm/dept_nm");	//부서명
					var  dty_name = model1.getValue("/root/reqData/reqForm/dty_name"); 	//직급명
					var  posi_name = model1.getValue("/root/reqData/reqForm/posi_name"); 	//직책명
					var  prn = model1.getValue("/root/reqData/reqForm/prn"); 	//주민등록번호
					var in_cmpy_dt = model1.getValue("/root/reqData/reqForm/in_cmpy_dt"); 	//입사일
					var issu_num_shet = model1.getValue("/root/reqData/reqForm/issu_num_shet"); 	//발급매수
					var issu_dt =  model1.getValue("/root/reqData/reqForm/issu_dt"); 	//발급일
					var issu_no=  model1.getValue("/root/reqData/reqForm/ issu_no"); 	//발급번호
					var nm_korn = model1.getValue("/root/reqData/reqForm/nm_korn"); 	//사원명
					var usag = model1.getValue("/root/reqData/reqForm/usag"); 	//용도
					var remk = model1.getValue("/root/reqData/reqForm/remk"); 	//비고					
					var cmpy_cd =model1.getValue("/root/reqData/reqForm/cmpy_cd"); 	//비고

					if (commReqCheck(group1)) { 
						if (!rowInSubmit(datagrid2)) {
							return;
						}

						if (window.alert("저장하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						model1.setValue("/root/reqData/reqForm/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_affr_6024");
	
						if(submit_completed()) {
							window.parent.javascript.loadParentData();
							parent.model1.refresh();
							model1.resetInstanceNode("/root/reqData/reqForm");
							model1.resetInstanceNode("/root/resData/gridData/record");
							//opener.window.javascript.getData();
							//alert("5");
							model1.refresh();
							//resetData(20); 120220
							resetData(model1.getValue("/root/reqData/reqForm/certi_clsf"));
							datagrid2.clearStatus();
							//datagrid2.refresh();
							/*
							certi_nm_korn.disabled = true;
							
							model1.send("hd_affr_6023");
							model1.copyNode("/root/resData/gridData","/root/tempData/CURLIST");
							model1.copyNode("/root/initData/comboSet/posi_cd", "/root/tempData/posi_cd");
							model1.copyNode("/root/initData/comboSet/dty_cd", "/root/tempData/dty_cd");
							model1.refresh();	
							datagrid2.refresh();
							rowCnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + " 건";
							
							model1.setValue("/root/resData/tm_cnt", "1");
							*/
						}
					}
				]]>
			</script>
		</button>
		<import id="iv_Title" visibility="hidden" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:0px; height:0px; "/>
		<caption id="caption16" class="tit02" style="left:10px; top:130px; width:97px; height:20px; font-weight:bold; ">경력내용</caption>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData/record" scroll="auto" caption="부서^직책^직급^출력용직책^발령일자^변경내용^비고^caption2^caption1^1^2^3^4" colsep="#" colwidth="100, 100, 100, 100, 100, 230, 150, 0, 0, 0, 0, 0, 0" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:10px; top:151px; width:905px; height:130px; ">
			<col ref="dept_name" type="inputbutton"/>
			<col ref="dty_cd" type="combo">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dty_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="posi_cd" type="combo">
				<choices>
					<itemset nodeset="/root/initData/comboSet/posi_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="prt_usag_dty_cd" type="combo">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dty_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="appmt_dt" type="inputdate" format="yyyy-mm-dd"/>
			<col ref="appmt_cont" type="input" style="text-align:left; "/>
			<col ref="remk" type="input" style="text-align:left; "/>
			<col ref="seq" visibility="hidden"/>
			<col ref="dept_cd" visibility="hidden"/>
			<col ref="emp_no" visibility="hidden"/>
			<col ref="cmpy_cd" visibility="hidden"/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="certi_clsf" visibility="hidden"/>
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					var col = datagrid2.col;
					if(datagrid2.row == 0) return;			
					
					if(col == 1) {
						model1.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						//window.load("/xrw/hd/com/hd_com_1100.xrw","mdichild", "hd_com_1100", "", "/root/reqData/fwdData", "/root/reqData/fwdData");
						window.load("/xrw/hd/com/HD_COM_1100.xrw","mdichild", "hd_com_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					}
				]]>
			</script>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					rowStatus(datagrid2);
				]]>
			</script>
		</datagrid>
		<button id="button2" class="btn05" style="left:805px; top:10px; width:110px; height:21px; ">
			<caption>경력선택(팝업)</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var  cmpy_cd = model1.getValue("/root/reqData/reqForm/cmpy_cd"); 	//회사코드
					var  emp_no = model1.getValue("/root/reqData/reqForm/emp_no"); 	//사원번호
					if(emp_no != "") {
						model1.setValue("/root/reqData/popData/cmpy_cd",cmpy_cd);
						model1.setValue("/root/reqData/popData/emp_no",emp_no);
						window.load("/xrw/hd/affr/HD_AFFR_6021.xrw","modal", "hd_affr_6021", "align:center; caption:hidden;", "/root/reqData/popData",  "/root/reqData/popData");
					} else {
						alert("사번을 입력하십시오.");	
						return;
					}
				]]>
			</script>
		</button>
		<caption id="rowCnt" style="left:790px; top:280px; width:125px; height:20px; font-weight:bold; text-align:right; "/>
		<button id="button3" class="btn02" style="left:585px; top:10px; width:51px; height:21px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if (!rowDelSubmit(datagrid2)) {
						return;
					}

					if (window.alert("삭제하시겠습니까?", "확인", 1) != 1) {
						return;
					}
					model1.setValue("/root/reqData/reqForm/multiUpData", datagrid2.getUpdateData());
					model1.send("hd_affr_6024");

					if(submit_completed()) {
						window.parent.javascript.loadParentData();
						model1.resetInstanceNode("/root/reqData/reqForm");
						model1.resetInstanceNode("/root/resData/gridData/record");
						model1.refresh()
						datagrid2.clearStatus();
						/*
						certi_nm_korn.disabled = true;
						
						model1.send("hd_affr_6023");
						model1.copyNode("/root/resData/gridData","/root/tempData/CURLIST");
						model1.copyNode("/root/initData/comboSet/posi_cd", "/root/tempData/posi_cd");
						model1.copyNode("/root/initData/comboSet/dty_cd", "/root/tempData/dty_cd");
						model1.refresh();	
						datagrid2.refresh();
						rowCnt.value = "총 "+ (parseInt(datagrid2.rows)- 1) + " 건";
						
						model1.setValue("/root/resData/tm_cnt", "1");
						*/
					}
				]]>
			</script>
		</button>
		<button id="button4" class="btn02" style="left:750px; top:10px; width:51px; height:21px; ">
			<caption>재발급</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var iv_seq  		=   model1.getValue("/root/reqData/reqForm/seq"); 		
					var iv_emp_no  		=   model1.getValue("/root/reqData/reqForm/emp_no"); 		
					var iv_aplc_seq  	=   model1.getValue("/root/reqData/reqForm/aplc_seq"); 		
					var iv_occr_dt  		=   model1.getValue("/root/reqData/reqForm/occr_dt"); 		
					// 오즈관련 노드 초기화..					
				 	resetOznode();			
				 						
				 	// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
			 	 	makeNodeValue("/root/oz_data/ozrName","hd/HD_AFFR_6030");
					//makeNodeValue("/root/oz_data/preview","preview"); 			//preview : 미리보기, print : 인쇄
					//makeNodeValue("/root/oz_data/printsize",""); 				//페이지용지설정(기본 A4)																				
								
				 	// odi 파라미터 설정.					
				 	makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , getProperty("ss_cmpycd") );
					makeNodeValue("/root/oz_data/odiParam/iv_seq" , iv_seq );
					makeNodeValue("/root/oz_data/odiParam/iv_emp_no" , iv_emp_no );
					makeNodeValue("/root/oz_data/odiParam/iv_aplc_seq" , iv_aplc_seq );
					makeNodeValue("/root/oz_data/odiParam/iv_occr_dt" , iv_occr_dt );
					
				 	// 레포트뷰어 호출.					
				 	openOzwin("/root/oz_data");	
				 	//loadData();
					//resetData(20); 120220
					resetData(model1.getValue("/root/reqData/reqForm/certi_clsf"));
					window.parent.javascript.loadParentData();
					datagrid2.clearStatus();
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
