<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>해외출장신청</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<xx_proc_stat_010/>
							<xx_job_clsf_01/>
							<xx_cd_clsf_020/>
							<busi_trip_fee_burd_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</busi_trip_fee_burd_clsf>
							<natn_cd>
								<item>
									<label/>
									<value/>
								</item>
							</natn_cd>
							<!-- 선택계열의 정보를 담당 -->
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<!-- 검색조건 처리 -->
						<reqForm>
							<emp_no/>
							<nm_korn/>
							<dept_nm/>
							<dept_cd/>
							<cmpy_cd/>
							<dty_cd/>
							<dty_nm/>
							<together_clsf>10</together_clsf>
							<busi_trip_dest/>
							<busi_trip_purp/>
							<busi_trip_frdt/>
							<busi_trip_todt/>
							<busi_trip_dds/>
							<invit_instt/>
							<busi_trip_fee_burd_clsf/>
							<busi_trip_neces/>
							<aviat_fee/>
							<stay_fee/>
							<dd_fee/>
							<aviat_fee_yn/>
							<stay_fee_yn/>
							<dd_fee_yn/>
							<ceph_use_yn/>
							<posi_nm/>
							<posi_cd/>
							<natn_cd/>
							<via_area/>
							<natn_nm/>
						</reqForm>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<!-- MultiUpDate유형 사용시 처리 -->
						<searchData>
							<emp_no/>
							<nm_korn/>
							<together_clsf>10</together_clsf>
							<!--<proc_stat_clsf>10</proc_stat_clsf> 120207-->
							<proc_stat_clsf/>
						</searchData>
						<fwdData>
							<func_nm/>
						</fwdData>
						<multiUpData/>
						<multiUpData2/>
						<multiUpData3/>
						<paidhodyData>
							<paidhody_cnt/>
						</paidhodyData>
						<subSearchData>
							<cmpy_cd/>
							<occr_dt/>
							<seq/>
						</subSearchData>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<temp/>
						</resForm>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<msg/>
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<record>
								<cmpy_cd/>
								<emp_no/>
								<occr_dt/>
								<seq/>
								<with_seq/>
								<dept_cd/>
								<cd_nm/>
								<nm_korn/>
								<posi_nm/>
								<duty_dt/>
								<prsnt_tm/>
								<finish_dd_clsf/>
								<finish_tm/>
								<tot_duty_tm/>
								<proc_stat/>
								<alvc_use_dt/>
								<alvc_use_yn/>
								<alvc_use_yn_nm/>
								<hody_clsf/>
								<hody_clsf_nm/>
								<alvc_plan_dt/>
								<paidhody_cnt/>
								<proc_stat_nm/>
							</record>
						</gridData>
						<gridData2>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<record>
								<g_emp_no/>
								<g_cmpy_cd/>
								<g_occr_dt/>
								<g_seq/>
								<g_with_seq/>
								<g_dept_cd/>
								<g_flnm/>
								<g_dty_nm/>
								<g_dty_cd/>
								<g_dept_nm/>
								<g_posi_nm/>
								<g_posi_cd/>
							</record>
							<!-- datagrid2 -->
							<!-- datagrid3 -->
						</gridData2>
						<gridData3>
							<record>
								<e_cmpy_cd/>
								<e_emp_no/>
								<e_occr_dt/>
								<e_seq/>
								<e_sub_seq/>
								<e_etc_cost_ptcr/>
								<e_etc_cost/>
								<e_etc_cost_neces/>
								<e_with_seq/>
							</record>
						</gridData3>
						<gridData4>
							<record>
								<d_cmpy_cd/>
								<d_emp_no/>
								<d_occr_dt/>
								<d_seq/>
								<d_sub_seq/>
								<d_start_area/>
								<d_midl_start_dt/>
								<d_dest/>
								<d_busi_trip_cont/>
								<d_with_seq/>
							</record>
						</gridData4>
						<empData>
							<cmpy_cd/>
							<emp_no/>
							<nm_korn/>
							<dept_cd/>
							<dept_nm/>
							<dty_nm/>
							<dty_cd/>
							<posi_nm/>
							<posi_cd/>
						</empData>
						<totcnt/>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
				
					var mode = "";
				
					function DateDemo()
					{
						var s="";
						var mydate=new Date() 
						var year=mydate.getYear() 
						    if (year < 1000) 
						        year+=1900 
						
						var day=mydate.getDay() 
						var month=mydate.getMonth()+1 
						    if (month<10) 
						        month="0"+month 
						
						var daym=mydate.getDate() 
						    if (daym<10) 
						        daym="0"+daym 
						s  = year+month;
					       return(s);
					}
					
					// 동행 검색 
					function setGridEmpInfo(emp_no, nm_korn)
					{
						var n_row = datagrid2.row;
						
						model1.setValue("/root/reqData/searchData/emp_no",emp_no);
						model1.send("hd_trip_1301");
						
						model1.copyNode("/root/resData/empData","/root/tempData/trip_person/record");
						model1.removenode("root/tempData");

						var dept_cd = model1.getValue("/root/resData/empData/dept_cd");
						var dept_nm = model1.getValue("/root/resData/empData/dept_nm");
						var emp_no = model1.getValue("/root/resData/empData/emp_no");
						var nm_korn = model1.getValue("/root/resData/empData/nm_korn");
						var posi_nm = model1.getValue("/root/resData/empData/posi_nm");
						var posi_cd = model1.getValue("/root/resData/empData/posi_cd");
						var dty_nm = model1.getValue("/root/resData/empData/dty_nm");
						var dty_cd = model1.getValue("/root/resData/empData/dty_cd");
						
						var cmpy_cd = model1.getValue("/root/resData/empData/cmpy_cd");
					
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_cmpy_cd", cmpy_cd);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_dept_cd", dept_cd);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_dept_nm", dept_nm);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_emp_no", emp_no);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_flnm", nm_korn);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_posi_nm", posi_nm);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_posi_cd", posi_cd);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_dty_nm", dty_nm);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_dty_cd", dty_cd);
						
						datagrid2.refresh();
					}
					
					// 출장자 검색
					function setEmpInfo(emp_no, nm_korn)
					{
						model1.setValue("/root/reqData/searchData/emp_no", emp_no);
						model1.setValue("/root/reqData/searchData/nm_korn", nm_korn);
						
						model1.send("hd_trip_1301");
						
						model1.copyNode("/root/resData/empData","/root/tempData/trip_person/record");
						model1.removenode("root/tempData");
						
						var dept_cd = model1.getValue("/root/resData/empData/dept_cd");
						var dept_nm = model1.getValue("/root/resData/empData/dept_nm");
						var emp_no = model1.getValue("/root/resData/empData/emp_no");
						var nm_korn = model1.getValue("/root/resData/empData/nm_korn");
						var posi_nm = model1.getValue("/root/resData/empData/posi_nm");
						var posi_cd = model1.getValue("/root/resData/empData/posi_cd");
						var dty_nm = model1.getValue("/root/resData/empData/dty_nm");
						var dty_cd = model1.getValue("/root/resData/empData/dty_cd");
						
						var cmpy_cd = model1.getValue("/root/resData/empData/cmpy_cd");
						
						
						model1.setValue("/root/reqData/reqForm/cmpy_cd", cmpy_cd);
						model1.setValue("/root/reqData/reqForm/dept_cd", dept_cd);
						model1.setValue("/root/reqData/reqForm/dept_nm", dept_nm);
						model1.setValue("/root/reqData/reqForm/emp_no", emp_no);
						model1.setValue("/root/reqData/reqForm/nm_korn", nm_korn);
						model1.setValue("/root/reqData/reqForm/posi_nm", posi_nm);
						model1.setValue("/root/reqData/reqForm/posi_cd", posi_cd);
						model1.setValue("/root/reqData/reqForm/dty_nm", dty_nm);
						model1.setValue("/root/reqData/reqForm/dty_cd", dty_cd);
						
						
						model1.refresh();
					}

					function isByteLength(data, maxlen) {
					    var len = data.length;
					    for (i = 0; i < data.length; i++){
					        if (data.charCodeAt(i)  > 127){
					            len++;
					        }
					    }
					    
					    if (len > maxlen) {
					        return false;
					    } else {
					        return true;
					    }
					}	

				//근무시간 구하기
				function getDay(busi_trip_frdt, busi_trip_todt)
				{
					var busi_trip_frdt_month = (busi_trip_frdt.substr(4,1) == "0")? busi_trip_frdt.substr(5,1) :  busi_trip_frdt.substr(4,2);
					var busi_trip_todt_month = (busi_trip_todt.substr(4,1) == "0")? busi_trip_todt.substr(5,1) :  busi_trip_todt.substr(4,2);
					var busi_trip_frdt_day = (busi_trip_frdt.substr(6,1) == "0")? busi_trip_frdt.substr(7,1) :  busi_trip_frdt.substr(6,2);
					var busi_trip_todt_day = (busi_trip_todt.substr(6,1) == "0")? busi_trip_todt.substr(7,1) :  busi_trip_todt.substr(6,2);

					var busi_trip_frdt_date = new Date(busi_trip_frdt.substr(0,4),busi_trip_frdt_month,busi_trip_frdt_day);   
					var busi_trip_todt_date = new Date(busi_trip_todt.substr(0,4),busi_trip_todt_month,busi_trip_todt_day);  
					var daym = Math.floor((busi_trip_todt_date.getTime() - busi_trip_frdt_date.getTime())/(24*60*60*1000) +1);           

					if (daym < 1)  {
//						alert("날짜 선택이 잘못됐습니다");
						return 0;
					}
  						return daym;
				}									
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					if(model.getValue("/root/initData/pageInfo/pageID") == ""){
						maintitle.text = "해외출장신청";
						iv_Title.visible = false;  // 숨김
						iv_PopTitle.visible = true;  // 보임
					}else if(model.getValue("/root/initData/pageInfo/pageID") != ""){
						iv_Title.visible = true;  // 보임
						iv_PopTitle.visible = false;  // 숨김
					}
					model1.removenode("/root/resData/gridData/record[1]");
					model1.removenode("/root/resData/gridData2/record[1]");
					model1.removenode("/root/resData/gridData3/record[1]");
					model1.removenode("/root/resData/gridData4/record[1]");
				
					model1.send("hd_trip_1300");
					model1.copyNode("/root/initData/comboSet","/root/tempData");
					
					/*
					alert(model1.getValue("/root/initData/comboSet/xx_proc_stat_010"));
					alert(model1.getValue("/root/initData/comboSet/xx_job_clsf_01"));
					alert(model1.getValue("/root/initData/comboSet/xx_cd_clsf_020"));
					*/
				
					
					model.setValue("/root/reqData/searchData/proc_stat_clsf", model1.getValue("/root/initData/comboSet/xx_proc_stat_010"));
					model1.removenode("/root/tempData");
					model1.refresh();
				
					mode="I";
									
//					datagrid2.isReadOnly(1, 1, 1, 4)  =true;
//					datagrid3.isReadOnly(1, 1, 1, 3)  =true;
//					datagrid4.isReadOnly(1, 1, 1, 4)  =true;
					
					var together_clsf = combo8.value;
					
					if(together_clsf == "10") {
						button5.disabled = true;
						button6.disabled = true;
					
					}
					
					input9.disabled = true;
					input10.disabled = true;
					input12.disabled = true;
					
					input9.refresh();
					input10.refresh();
					input12.refresh();
					
									
					var emp_no = getProperty("ss_emp_no");
					var cmpy_cd = getProperty("ss_cmpycd");
					setEmpInfo(emp_no,"");
							
					model1.refresh();					
			]]>
			</script>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/se_comm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<submission id="hd_co_1000" action="/hd/co/1000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_trip_1305" action="/hd/trip/1305" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_trip_1300" action="/hd/trip/1300" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1301" action="/hd/trip/1301" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1302" action="/hd/trip/1302" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_trip_1303" action="/hd/trip/1303" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1304" action="/hd/trip/1304" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/subSearchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1307" action="/hd/trip/1307" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
		</model>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="870" guideline="1,9;" style="font-family:굴림; ">
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<import id="iv_PopTitle" src="../../../common/xrw/iv_PopTitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:37px; width:926px; height:21px; ">
			<button id="btnA1" class="btn02" visibility="hidden" style="left:475px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						
						model1.send("hd_trip_1303");
						model1.copyNode("/root/resData/gridData","/root/tempData");
						model1.removenode("/root/tempData");
						
						model1.refresh();
	
						input5.disabled = false;
						input7.disabled = false
						
							
//						datagrid2.isReadOnly(1, 1, 1, 4)  =true;
//						datagrid3.isReadOnly(1, 1, 1, 3)  =true;
//						datagrid4.isReadOnly(1, 1, 1, 4)  =true;
						
						combo1.refresh();
						mode="I";
				
					]]>
				</script>
			</button>
			<button id="button7" class="btn02" style="left:874px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
				 	if(model.getValue("/root/initData/pageInfo/pageID") != ""){
					 	viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					}else{
						window.close();
					}
					]]>
				</script>
			</button>
			<button id="button4" class="btn_grid04" visibility="hidden" style="left:550px; top:0px; width:67px; height:17px; ">
				<caption>임시저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var temp = model1.getValue("/root/resData/resForm/temp");
						
						var  busi_trip_frdt =input4.value;
						var  busi_trip_todt =input6.value;

						var getDay1;

						if(busi_trip_frdt !="" && busi_trip_todt != "") {
							getDay1 =  getDay(busi_trip_frdt, busi_trip_todt);
						}
						if(getDay1 == 0) {
							input4.value = "";
							input6.value = "";
							alert("출장 시작과 출장 종료 일자가 잘못 되었습니다");
							return false;
						}												
						// 출장목적
						/*if(!isByteLength(textarea1.value,50)) { 
							alert("허용된 글자수를 초과했습니다"); 
							textarea1.value = ""; 
							return false; 
						}*/
						// 목적지
						if(!isByteLength(input3.value,30)) { 
							alert("허용된 글자수를 초과했습니다"); 
							input3.value = ""; 
							return false; 
						}
						// 초청기관
						if(!isByteLength(input11.value,30)) { 
							alert("허용된 글자수를 초과했습니다"); 
							input11.value = ""; 
							return false; 
						}
						// 출장필요성
						if(!isByteLength(textarea2.value,50)) { 
							alert("허용된 글자수를 초과했습니다"); 
							textarea2.value = ""; 
							return false; 
						}						
							var selectedIdx = datagrid2.rows-1;
						
							model1.makeNode("/root/reqData/reqForm/mode");
							model1.setValue("/root/reqData/reqForm/mode",mode);
							
						if (!commReqCheck(group2)) {return false;}						
						if (!commReqCheck(group1)) {return false;}						
						if (!commReqCheck(group3)) {return false;}
						
							if(!commGridReqCheck("datagrid2")) return;
							if(!commGridReqCheck("datagrid4")) return;	
													 
		 					if (window.alert("저장하시겠습니까?", "확인", 1) != 1) {
								return;
							}
							
							for(var i=1;i<datagrid2.rows;i++) {
							var status = datagrid2.rowstatus(i);

								if(status == 0){
									datagrid2.addStatus(i, "update"); 
								}
							}
							
							
							for(var i=1;i<datagrid3.rows;i++) {
							if(datagrid3.rowstatus(i) != 0 ) {
								var val1 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost_ptcr");
								var val2 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost_neces");
		
								if(!isByteLength(val1,30)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost_ptcr","");
									return false;
								}
								if(!isByteLength(val2,50)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost_neces","");
									return false;
								}
	
								if(!isByteLength(val2,10)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost","");
									return false;
								}
							}								
							var status = datagrid3.rowstatus(i);

								if(status == 0){
									datagrid3.addStatus(i, "update"); 
								}
							}
							
							
							for(var i=1;i<datagrid4.rows;i++) {
							if(datagrid4.rowstatus(i) != 0 ) {
								var val1 =  model1.getValue("/root/resData/gridData4/record[" + i + "]/d_start_area");
								var val2 =  model1.getValue("/root/resData/gridData4/record[" + i + "]/d_dest");
								var val3 =  model1.getValue("/root/resData/gridData4/record[" + i + "]/d_busi_trip_cont");
		
								if(!isByteLength(val1,30)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData4/record[" + i + "]/d_start_area","");
									return false;
								}
	
								if(!isByteLength(val2,30)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData4/record[" + i + "]/d_dest","");
									return false;
								}
								if(!isByteLength(val3,50)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData4/record[" + i + "]/d_busi_trip_cont","");
									return false;
								}
							}
							var status = datagrid4.rowstatus(i);

								if(status == 0){
									datagrid4.addStatus(i, "update"); 
								}
							}
						
							model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
							model1.setValue("/root/reqData/multiUpData2", datagrid3.getUpdateData());
							model1.setValue("/root/reqData/multiUpData3", datagrid4.getUpdateData());
							model1.send("hd_trip_1302");
		
							if(submit_completed()) {
								//alert("저장되었습니다.");
								model1.reset();
								
								//datagrid1.clearStatus(); 120207 datagrid1이 없다고 에러가 나서 주석함
								datagrid2.clearStatus();
								datagrid3.clearStatus();
								datagrid4.clearStatus();
							}
					]]>
				</script>
			</button>
			<button id="button9" class="btn_grid02" visibility="hidden" style="left:662px; top:0px; width:42px; height:17px; ">
				<caption>신청</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var  busi_trip_frdt =input4.value;
						var  busi_trip_todt =input6.value;

						var getDay1;

						if(busi_trip_frdt !="" && busi_trip_todt != "") {
							getDay1 =  getDay(busi_trip_frdt, busi_trip_todt);
						}
						if(getDay1 == 0) {
							input4.value = "";
							input6.value = "";
							alert("출장 시작과 출장 종료 일자가 잘못 되었습니다");
							return false;
						}												
						// 출장목적
						/*if(!isByteLength(textarea1.value,50)) { 
							alert("허용된 글자수를 초과했습니다"); 
							textarea1.value = ""; 
							return false; 
						}*/
						// 목적지
						if(!isByteLength(input3.value,30)) { 
							alert("허용된 글자수를 초과했습니다"); 
							input3.value = ""; 
							return false; 
						}
						// 초청기관
						if(!isByteLength(input11.value,30)) { 
							alert("허용된 글자수를 초과했습니다"); 
							input11.value = ""; 
							return false; 
						}
						// 출장필요성
						if(!isByteLength(textarea2.value,50)) { 
							alert("허용된 글자수를 초과했습니다"); 
							textarea2.value = ""; 
							return false; 
						}						
						var selectedIdx = datagrid2.rows-1;
					
						model1.makeNode("/root/reqData/reqForm/mode");
						model1.setValue("/root/reqData/reqForm/mode",mode);

						if (!commReqCheck(group2)) {return false;}						
						if (!commReqCheck(group1)) {return false;}						
						if (!commReqCheck(group3)) {return false;}
						
						if(!commGridReqCheck("datagrid2")) return;
						if(!commGridReqCheck("datagrid4")) return;	
						
						//if(!isByteLength(textarea1.value,10)) { return false; }
						if(!isByteLength(input3.value,10)) { return false; }



//						var emp_no = model1.getValue("/root/reqData/reqForm/emp_no");
//
//						if(emp_no == ""){
//							alert("출장자를 입력해주세요.");
//							return;	
//						}
						 
						for(var i=1;i<datagrid2.rows;i++) {
						var status = datagrid2.rowstatus(i);

							if(status == 0){
								datagrid2.addStatus(i, "update"); 
							}
						}
						
						
						for(var i=1;i<datagrid3.rows;i++) {
							if(datagrid3.rowstatus(i) != 0 ) {						
								var val1 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost_ptcr");
								var val2 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost_neces");
		
								if(!isByteLength(val1,30)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/e_etc_cost_ptcr","");
									return false;
								}
								if(!isByteLength(val2,50)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/e_etc_cost_neces","");
									return false;
								}
	
								if(!isByteLength(val2,10)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/e_etc_cost","");
									return false;
								}
							}							
							var status = datagrid3.rowstatus(i);

							if(status == 0){
								datagrid3.addStatus(i, "update"); 
							}
						}
						
						for(var i=1;i<datagrid4.rows;i++) {
							if(datagrid4.rowstatus(i) != 0 ) {
								var val1 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/d_start_area");
								var val2 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/d_dest");
								var val3 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/d_busi_trip_cont");
		
								if(!isByteLength(val1,30)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/d_start_area","");
									return false;
								}
	
								if(!isByteLength(val2,30)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/d_dest","");
									return false;
								}
								if(!isByteLength(val3,50)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/d_busi_trip_cont","");
									return false;
								}
							}
							var status = datagrid4.rowstatus(i);

							if(status == 0){
								datagrid4.addStatus(i, "update"); 
							}
						}
							
	 					if (window.alert("신청하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						if (!rowInSubmit(datagrid2)) {
							return;
						}
						if (!rowInSubmit(datagrid3)) {
							return;
						}
						if (!rowInSubmit(datagrid4)) {
							return;
						}
						return;
						
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.setValue("/root/reqData/multiUpData2", datagrid3.getUpdateData());
						model1.setValue("/root/reqData/multiUpData3", datagrid4.getUpdateData());

							model1.send("hd_trip_1305");
		
							if(submit_completed()) {
								//alert("신청되었습니다.");
								model1.reset();

								//datagrid1.clearStatus(); 120207 datagrid1이 없다고 에러가 나서 주석함
								datagrid2.clearStatus();
								datagrid3.clearStatus();
								datagrid4.clearStatus();
							}
					]]>
				</script>
			</button>
			<button id="button10" class="btn_grid02" visibility="hidden" style="left:617px; top:0px; width:42px; height:17px; ">
				<caption>출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
					]]>
				</script>
			</button>
			<button id="button11" class="btn02" style="left:819px; top:0px; width:52px; height:21px; ">
				<caption>신청</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[				
						var  busi_trip_frdt =input4.value;
						var  busi_trip_todt =input6.value;

						var getDay1;

						if(busi_trip_frdt !="" && busi_trip_todt != "") {
							getDay1 =  getDay(busi_trip_frdt, busi_trip_todt);
						}
						if(getDay1 == 0) {
							input4.value = "";
							input6.value = "";
							alert("출장 시작과 출장 종료 일자가 잘못 되었습니다");
							return false;
						}												
						// 출장목적
						/*if(!isByteLength(textarea1.value,50)) { 
							alert("허용된 글자수를 초과했습니다"); 
							textarea1.value = ""; 
							return false; 
						}*/
						// 목적지
						/*if(!isByteLength(input3.value,30)) { 
							alert("허용된 글자수를 초과했습니다"); 
							input3.value = ""; 
							return false; 
						}
						// 초청기관
						if(!isByteLength(input11.value,30)) { 
							alert("허용된 글자수를 초과했습니다"); 
							input11.value = ""; 
							return false; 
						}
						// 출장필요성
						if(!isByteLength(textarea2.value,50)) { 
							alert("허용된 글자수를 초과했습니다"); 
							textarea2.value = ""; 
							return false; 
						}						*/
						var selectedIdx = datagrid2.rows-1;
						model1.makeNode("/root/reqData/reqForm/mode");	
						model1.setValue("/root/reqData/reqForm/mode",mode);
						if (!commReqCheck(group2)) {return false;}		
						if (!commReqCheck(group1)) {return false;}	
						if (!commReqCheck(group3)) {return false;}
						//if(!commGridReqCheck("datagrid2")) return;
						//if(!commGridReqCheck("datagrid4")) return;	
						
						//if(!isByteLength(textarea1.value,10)) { return false; }

						if(!isByteLength(input3.value,15)) { return false; }


//						var emp_no = model1.getValue("/root/reqData/reqForm/emp_no");
//
//						if(emp_no == ""){
//							alert("출장자를 입력해주세요.");
//							return;	
//						}

						for(var i=1;i<datagrid2.rows;i++) {
						var status = datagrid2.rowstatus(i);

							if(status == 0){
								datagrid2.addStatus(i, "update"); 
							}
						}
						
						
						/*for(var i=1;i<datagrid3.rows;i++) {
							if(datagrid3.rowstatus(i) != 0 ) {						
								var val1 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost_ptcr");
								var val2 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost_neces");
								var val3 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost");
		
								if(!isByteLength(val1,30)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/e_etc_cost_ptcr","");
									return false;
								}
								if(!isByteLength(val2,50)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/e_etc_cost_neces","");
									return false;
								}
	
								if(!isByteLength(val3,10)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/e_etc_cost","");
									return false;
								}
							}							
							var status = datagrid3.rowstatus(i);

							if(status == 0){
								datagrid3.addStatus(i, "update"); 
							}
						}
						
						
						for(var i=1;i<datagrid4.rows;i++) {
							if(datagrid4.rowstatus(i) != 0 ) {
								var val1 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/d_start_area");
								var val2 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/d_dest");
								var val3 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/d_busi_trip_cont");
		
								if(!isByteLength(val1,30)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/d_start_area","");
									return false;
								}
	
								if(!isByteLength(val2,30)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/d_dest","");
									return false;
								}
								if(!isByteLength(val3,50)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/d_busi_trip_cont","");
									return false;
								}
							}
							var status = datagrid4.rowstatus(i);

							if(status == 0){
								datagrid4.addStatus(i, "update"); 
							}
						}*/
	 					if (window.alert("신청하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						var dg2 = datagrid2.rows;
						var dg3 = datagrid3.rows;
						var dg4 = datagrid4.rows;
						//if(dg2 > 1){
						//	if (!rowInSubmit(datagrid2)) {
						//		return;
						//	}
						//}
						if(dg3 > 1){
							if (!rowInSubmit(datagrid3)) {
								return;
							}
						}
						//if(dg4 > 1){
						//	if (!rowInSubmit(datagrid4)) {
						//		return;
						//	}
						//}
						
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.setValue("/root/reqData/multiUpData2", datagrid3.getUpdateData());
						model1.setValue("/root/reqData/multiUpData3", datagrid4.getUpdateData());

							model1.send("hd_trip_1305");
							var ov_cmpy_cd = model1.getValue("/root/dataSet/ov_cmpy_cd");
							var ov_occr_dt = model1.getValue("/root/dataSet/ov_occr_dt");
							var ov_max_seq = model1.getValue("/root/dataSet/ov_max_seq");
							model1.setValue("/root/reqData/subSearchData/cmpy_cd", ov_cmpy_cd);
							model1.setValue("/root/reqData/subSearchData/occr_dt", ov_occr_dt);
							model1.setValue("/root/reqData/subSearchData/seq", ov_max_seq);
						
							/*model1.send("hd_trip_1304");
							model1.copyNode("/root/reqData/reqForm","/root/tempData/CURLIST/record");
							model1.copyNode("/root/resData/gridData2","/root/tempData/CURLIST2");
							model1.copyNode("/root/resData/gridData4","/root/tempData/CURLIST3");
							model1.copyNode("/root/resData/gridData3","/root/tempData/CURLIST4");
							model1.removenode("root/tempData");
							model1.refresh();*/
							if(model1.getValue("/root/dataSet/errmsg") != ""){
								model1.removenode("/root/dataSet");
								return;
							}else{
							//if(submit_completed()) {
								alert("정상적으로 처리되었습니다.");
								// 오즈관련 노드 초기화..	
								resetOznode();					
									 						
								// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
								makeNodeValue("/root/oz_data/ozrName","hd/SP_HD_TRIP_1308_P");
								makeNodeValue("/root/oz_data/preview","preview"); 			//preview : 미리보기, print : 인쇄
								makeNodeValue("/root/oz_data/printsize",""); 				//페이지용지설정(기본 A4)		
								// odi 파라미터 설정.	
								makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , ov_cmpy_cd);
								makeNodeValue("/root/oz_data/odiParam/iv_occr_dt" , ov_occr_dt);
								makeNodeValue("/root/oz_data/odiParam/iv_seq" , ov_max_seq );
						
								// 레포트뷰어 호출.					
								openOzwin("/root/oz_data");	
								
								model1.removenode("/root/dataSet");
								
								model1.reset();

								//datagrid1.clearStatus(); 120207 datagrid1이 없다고 에러가 나서 주석함
								datagrid2.clearStatus();
								datagrid3.clearStatus();
								datagrid4.clearStatus();
								
								input9.disabled = true;
								input10.disabled = true;
								input12.disabled = true;
								
								input9.refresh();
								input10.refresh();
								input12.refresh();
							//}
							}
					]]>
				</script>
			</button>
			<button id="button12" class="btn02" style="left:764px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model1.reset();

					//datagrid1.clearStatus(); 120207 datagrid1이 없다고 에러가 나서 주석함
					datagrid2.clearStatus();
					datagrid3.clearStatus();
					datagrid4.clearStatus();
					input9.disabled = true;
					input10.disabled = true;
					input12.disabled = true;
					
					input5.disabled = false;
					input7.disabled = false

					mode="I";					
					]]>
				</script>
			</button>
		</group>
		<group id="group2" style="left:10px; top:64px; width:926px; height:200px; ">
			<caption id="caption2" class="list_cap01" style="left:0px; top:20px; width:110px; height:26px; text-align:center; ">출장자</caption>
			<caption id="caption3" class="list_cap02" style="left:597px; top:20px; width:328px; height:26px; text-align:center; "/>
			<caption id="caption11" class="list_cap01" style="left:286px; top:20px; width:90px; height:26px; text-align:center; ">부서</caption>
			<caption id="caption12" class="list_cap01" style="left:522px; top:20px; width:85px; height:26px; text-align:center; ">직책</caption>
			<caption id="caption15" class="tit02" style="left:0px; top:0px; width:205px; height:20px; font-weight:bold; ">출장자</caption>
			<caption id="caption1" class="list_cap02" style="left:375px; top:20px; width:148px; height:26px; text-align:center; "/>
			<caption id="caption4" class="list_cap02" style="left:109px; top:20px; width:178px; height:26px; text-align:center; "/>
			<input id="input7" ref="/root/reqData/reqForm/nm_korn" class="req" caption="성명" style="left:198px; top:24px; width:84px; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if (event.keyCode ==13){
						var nm_korn = input7.currentText;
						model1.setValue("/root/reqData/searchData/emp_no", "");
						model1.setValue("/root/reqData/searchData/nm_korn", nm_korn);
						
						setInfoSearchInput("", nm_korn, "", "setEmpInfo"); // 사번, 성명, 주민번호
						if(model1.getValue("/root/tempData/totalcnt") != 1){
							return;
						} // 카운트
						model1.setValue("/root/reqData/reqForm/emp_no", model1.getValue("/root/tempData/emp_no")); // 사번
						model1.setValue("/root/reqData/reqForm/nm_korn", model1.getValue("/root/tempData/nm_korn")); // 성명
						model1.setValue("/root/reqData/reqForm/dept_cd", model1.getValue("/root/tempData/dept_cd")); // 부서코드
						model1.setValue("/root/reqData/reqForm/dept_nm", model1.getValue("/root/tempData/dept_nm")); // 부서명
						model1.setValue("/root/reqData/reqForm/dty_cd", model1.getValue("/root/tempData/dty_cd")); // 직책코드
						model1.setValue("/root/reqData/reqForm/dty_nm", model1.getValue("/root/tempData/dty_nm")); // 직책명
						model1.removenode("/root/tempData");
						model1.refresh();
					}
					]]>
				</script>
			</input>
			<input id="input5" ref="/root/reqData/reqForm/emp_no" class="req" inputtype="button" maxlength="6" caption="사번" style="left:113px; top:24px; width:84px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setEmpInfo");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if (event.keyCode ==13){
						var emp_no = input5.currentText;
						model1.setValue("/root/reqData/searchData/emp_no", emp_no);
						model1.setValue("/root/reqData/searchData/nm_korn", "");
						
						setInfoSearchInput(emp_no, "", "", "setEmpInfo"); // 사번, 성명, 주민번호
						if(model1.getValue("/root/tempData/totalcnt") != 1){
							return;
						} // 카운트
						model1.setValue("/root/reqData/reqForm/emp_no", model1.getValue("/root/tempData/emp_no")); // 사번
						model1.setValue("/root/reqData/reqForm/nm_korn", model1.getValue("/root/tempData/nm_korn")); // 성명
						model1.setValue("/root/reqData/reqForm/dept_cd", model1.getValue("/root/tempData/dept_cd")); // 부서코드
						model1.setValue("/root/reqData/reqForm/dept_nm", model1.getValue("/root/tempData/dept_nm")); // 부서명
						model1.setValue("/root/reqData/reqForm/dty_cd", model1.getValue("/root/tempData/dty_cd")); // 직책코드
						model1.setValue("/root/reqData/reqForm/dty_nm", model1.getValue("/root/tempData/dty_nm")); // 직책명
						model1.removenode("/root/tempData");
						model1.refresh();
					}
					]]>
				</script>
				<script type="javascript" ev:event="onmaxlength">
					<![CDATA[
						var emp_no = input5.currentText;
						model1.setValue("/root/reqData/searchData/emp_no", emp_no);
						model1.setValue("/root/reqData/searchData/nm_korn", "");
						
						setInfoSearchInput(emp_no, "", "", "setEmpInfo"); // 사번, 성명, 주민번호
						if(model1.getValue("/root/tempData/totalcnt") != 1){
							return;
						} // 카운트
						model1.setValue("/root/reqData/reqForm/emp_no", model1.getValue("/root/tempData/emp_no")); // 사번
						model1.setValue("/root/reqData/reqForm/nm_korn", model1.getValue("/root/tempData/nm_korn")); // 성명
						model1.setValue("/root/reqData/reqForm/dept_cd", model1.getValue("/root/tempData/dept_cd")); // 부서코드
						model1.setValue("/root/reqData/reqForm/dept_nm", model1.getValue("/root/tempData/dept_nm")); // 부서명
						model1.setValue("/root/reqData/reqForm/dty_cd", model1.getValue("/root/tempData/dty_cd")); // 직책코드
						model1.setValue("/root/reqData/reqForm/dty_nm", model1.getValue("/root/tempData/dty_nm")); // 직책명
						model1.removenode("/root/tempData");
						model1.refresh();
					]]>
				</script>
			</input>
			<output id="input1" ref="/root/reqData/reqForm/dept_nm" appearance="output" style="left:380px; top:24px; width:139px; height:18px; text-align:center; "/>
			<output id="input2" ref="/root/reqData/reqForm/dty_nm" appearance="output" style="left:610px; top:24px; width:139px; height:18px; text-align:center; "/>
			<datagrid id="datagrid2" nodeset="/root/resData/gridData2/record" scroll="auto" caption="사번^성명^부서^직책^caption1^caption2^caption3^caption4^caption5^caption6^caption7^caption8" colsep="#" colwidth="140, 140, 140, 140, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:0px; top:75px; width:584px; height:121px; ">
				<col ref="g_emp_no" type="inputbutton" maxlength="6" caption="사번">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setGridEmpInfo");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						]]>
					</script>
				</col>
				<col imemode="hangul" ref="g_flnm" type="input" caption="성명"/>
				<col ref="g_dept_nm"/>
				<col ref="g_dty_nm"/>
				<col ref="g_dept_cd" visibility="hidden"/>
				<col ref="g_dty_cd" visibility="hidden"/>
				<col ref="g_occr_dt" visibility="hidden"/>
				<col ref="g_seq" visibility="hidden"/>
				<col ref="g_with_seq" visibility="hidden"/>
				<col ref="g_posi_nm" visibility="hidden"/>
				<col ref="g_posi_cd" visibility="hidden"/>
				<col ref="g_cmpy_cd" visibility="hidden"/>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var row = datagrid2.row;
					var col = datagrid2.col;
					
					if(col == 1){
						var emp_no = model1.getValue("/root/resData/gridData2/record["+row+"]/g_emp_no");
						setInfoSearchInput(emp_no, "", "", "setGridEmpInfo"); // 사번, 성명, 주민번호
						if(model1.getValue("/root/tempData/totalcnt") != 1){
							model1.removenode("/root/tempData");
							return;
						} // 카운트
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_emp_no", model1.getValue("/root/tempData/emp_no")); // 사번
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_flnm", model1.getValue("/root/tempData/nm_korn")); // 성명
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_dept_cd", model1.getValue("/root/tempData/dept_cd")); // 부서코드
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_dept_nm", model1.getValue("/root/tempData/dept_nm")); // 부서명
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_posi_cd", model1.getValue("/root/tempData/posi_cd")); // 직급코드
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_posi_nm", model1.getValue("/root/tempData/posi_nm")); // 직급명
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_dty_cd", model1.getValue("/root/tempData/dty_cd")); // 직책코드
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_dty_nm", model1.getValue("/root/tempData/dty_nm")); // 직책명
						model1.removenode("/root/tempData");
					}else if(col == 2){
						var g_flnm = model1.getValue("/root/resData/gridData2/record["+row+"]/g_flnm");
						setInfoSearchInput("", g_flnm, "", "setGridEmpInfo"); // 사번, 성명, 주민번호
						if(model1.getValue("/root/tempData/totalcnt") != 1){
							model1.removenode("/root/tempData");
							return;
						} // 카운트
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_emp_no", model1.getValue("/root/tempData/emp_no")); // 사번
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_flnm", model1.getValue("/root/tempData/nm_korn")); // 성명
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_dept_cd", model1.getValue("/root/tempData/dept_cd")); // 부서코드
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_dept_nm", model1.getValue("/root/tempData/dept_nm")); // 부서명
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_posi_cd", model1.getValue("/root/tempData/posi_cd")); // 직급코드
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_posi_nm", model1.getValue("/root/tempData/posi_nm")); // 직급명
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_dty_cd", model1.getValue("/root/tempData/dty_cd")); // 직책코드
						model1.setValue("/root/resData/gridData2/record["+row+"]/g_dty_nm", model1.getValue("/root/tempData/dty_nm")); // 직책명
						model1.removenode("/root/tempData");
					}
					model1.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						rowStatus(datagrid2);
					]]>
				</script>
			</datagrid>
			<caption id="caption40" class="list_cap01" style="left:0px; top:45px; width:110px; height:26px; text-align:center; ">동행여부</caption>
			<caption id="caption5" class="list_cap02" style="left:109px; top:45px; width:816px; height:26px; text-align:center; "/>
			<button id="button5" class="btn_grid04" style="left:169px; top:49px; width:67px; height:17px; ">
				<caption>동행추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var rowCnt = datagrid2.rows;
						var selectedIdx = datagrid2.rows-1;
						var emp_no     = model1.getValue("/root/resData/gridData2/record[1]/g_emp_no");	
						if(emp_no == ""){
							if(datagrid2.isReadOnly(1,1) ==true) {
								datagrid2.isReadOnly(1, 1, 1, 4)  =false;
								datagrid2.addStatus(selectedIdx, "insert");
							} else {
								datagrid2.addRow(true, true);
							}
						}else{
							datagrid2.addRow(true, true);
						}
					]]>
				</script>
			</button>
			<button id="button6" class="btn_grid04" style="left:241px; top:49px; width:67px; height:17px; ">
				<caption>동행삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						datagrid2.addStatus(datagrid2.row, "delete");
//						model1.makeNode("/root/resData/resForm/temp");
//						model1.setValue("/root/resData/resForm/temp", "1");
				
					]]>
				</script>
			</button>
			<select1 id="combo8" ref="/root/reqData/searchData/together_clsf" appearance="minimal" style="left:114px; top:49px; width:51px; height:18px; ">
				<choices>
					<item>
						<label>없음</label>
						<value>10</value>
					</item>
					<item>
						<label>있음</label>
						<value>20</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var together_clsf = combo8.value;
					
					if(together_clsf == "10") {
						button5.disabled = true;
						button6.disabled = true;
						
					}else{
						button5.disabled = false;
						button6.disabled = false;
					}
					]]>
				</script>
			</select1>
		</group>
		<group id="group1" style="left:9px; top:258px; width:926px; height:175px; ">
			<caption id="caption16" class="list_cap02" style="left:395px; top:45px; width:530px; height:26px; text-align:center; "/>
			<caption id="caption7" class="list_cap02" style="left:109px; top:45px; width:257px; height:26px; text-align:center; "/>
			<caption id="caption13" class="list_cap01" style="left:0px; top:45px; width:110px; height:26px; text-align:center; ">출장국가</caption>
			<caption id="caption14" class="tit02" style="left:0px; top:0px; width:205px; height:20px; font-weight:bold; ">출장사항</caption>
			<caption id="caption17" class="list_cap02" style="left:89px; top:95px; width:836px; height:76px; text-align:center; "/>
			<caption id="caption8" class="list_cap01" style="left:293px; top:45px; width:110px; height:26px; text-align:center; ">상세도시</caption>
			<caption id="caption18" class="list_cap02" style="left:0px; top:20px; width:925px; height:26px; text-align:center; "/>
			<input id="input3" ref="/root/reqData/reqForm/busi_trip_dest" class="req" navindex="4" maxlength="15" caption="상세도시" style="left:407px; top:49px; width:198px; height:18px; text-align:left; "/>
			<caption id="caption19" style="left:211px; top:27px; width:25px; height:15px; text-align:center; ">~</caption>
			<input id="input4" ref="/root/reqData/reqForm/busi_trip_frdt" class="req" navindex="1" inputtype="date" format="yyyy-mm-dd" caption="출장기간" style="left:112px; top:24px; width:95px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var  busi_trip_frdt =input4.value;
						var  busi_trip_todt =input6.value;

						var getDay1;

						if(busi_trip_frdt !="" && busi_trip_todt != "") {
							getDay1 =  getDay(busi_trip_frdt, busi_trip_todt);
						}
						if(getDay1 == 0) {
							input4.value = "";
							input6.value = "";
							alert("출장 시작과 출장 종료 일자가 잘못 되었습니다");
							return false;
						}				
						if(model1.getValue("/root/reqData/reqForm/busi_trip_todt") != "" && model1.getValue("/root/reqData/reqForm/busi_trip_frdt") > model1.getValue("/root/reqData/reqForm/busi_trip_todt")){
							alert("출장시작일자가 출장종료일자보다 현재일이면 안됩니다.");
							return;
						}else if(model1.getValue("/root/reqData/reqForm/busi_trip_frdt") != "" &&  model1.getValue("/root/reqData/reqForm/busi_trip_todt") != ""){
							model1.send("hd_trip_1307");
							model1.copyNode("/root/resData/gridData4", "/root/dataSet/CURLIST");
							model1.removenode("/root/dataSet");
							datagrid4.refresh();
							for(var i = 1; i < datagrid2.rows; i++){
								datagrid4.rowStatus(i) = 1;
								datagrid4.isReadOnly(i, 1) = true;
							}
							datagrid4.refresh();
							var totcnt = datagrid4.rows;
							model1.setValue("/root/resData/totcnt", "총 " + Number(totcnt - 1) + " 일");
							model1.refresh();
						}	
					]]>
				</script>
			</input>
			<input id="input6" ref="/root/reqData/reqForm/busi_trip_todt" class="req" navindex="2" inputtype="date" format="yyyy-mm-dd" caption="출장기간" style="left:242px; top:24px; width:95px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var  busi_trip_frdt =input4.value;
						var  busi_trip_todt =input6.value;

						var getDay1;

						if(busi_trip_frdt !="" && busi_trip_todt != "") {
							getDay1 =  getDay(busi_trip_frdt, busi_trip_todt);
						}
						if(getDay1 == 0) {
							input4.value = "";
							input6.value = "";
							alert("출장 시작과 출장 종료 일자가 잘못 되었습니다");
							return false;
						}if(model1.getValue("/root/reqData/reqForm/busi_trip_todt") != "" && model1.getValue("/root/reqData/reqForm/busi_trip_frdt") > model1.getValue("/root/reqData/reqForm/busi_trip_todt")){
							alert("출장시작일자가 출장종료일자보다 현재일이면 안됩니다.");
							return;
						}else if(model1.getValue("/root/reqData/reqForm/busi_trip_frdt") != "" &&  model1.getValue("/root/reqData/reqForm/busi_trip_todt") != ""){
							model1.send("hd_trip_1307");
							model1.copyNode("/root/resData/gridData4", "/root/dataSet/CURLIST");
							model1.removenode("/root/dataSet");
							datagrid4.refresh();
							for(var i = 1; i < datagrid4.rows; i++){
								datagrid4.rowStatus(i) = 1;
								datagrid4.isReadOnly(i, 1) = true;
							}
							datagrid4.refresh();
							var totcnt = datagrid4.rows;
							model1.setValue("/root/resData/totcnt", "총 " + Number(totcnt - 1) + " 일");
							model1.refresh();
						}
					]]>
				</script>
			</input>
			<caption id="caption6" class="list_cap01" style="left:0px; top:95px; width:110px; height:76px; text-align:center; ">출장필요성</caption>
			<caption id="caption39" class="list_cap01" style="left:0px; top:20px; width:110px; height:26px; text-align:center; ">출장기간</caption>
			<caption id="caption38" class="list_cap01" style="left:0px; top:70px; width:110px; height:26px; text-align:center; ">출장목적</caption>
			<caption id="caption41" class="list_cap02" style="left:109px; top:70px; width:816px; height:26px; text-align:center; "/>
			<input id="input8" ref="/root/reqData/reqForm/busi_trip_purp" class="req" navindex="6" maxlength="25" caption="출장목적" style="left:112px; top:74px; width:807px; height:18px; text-align:left; "/>
			<input id="input13" ref="/root/reqData/reqForm/via_area" navindex="5" maxlength="15" caption="경유지" style="left:720px; top:49px; width:198px; height:18px; text-align:left; "/>
			<caption id="caption42" class="list_cap01" style="left:608px; top:45px; width:110px; height:26px; text-align:center; ">경유지</caption>
			<textarea id="textarea2" ref="/root/reqData/reqForm/busi_trip_neces" navindex="7" maxlength="25" style="left:112px; top:100px; width:807px; height:65px; text-align:left; vertical-align:top; "/>
			<input id="input14" ref="/root/reqData/reqForm/natn_nm" class="req" navindex="3" inputtype="button" caption="출장목적" style="left:112px; top:49px; width:177px; height:18px; text-align:left; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						var cd   =  "";		// model.getValue("/root/resData/resform/medi_cd");
						var cdnm =  "";		// model.getValue("/root/resData/resform/medi_cd_nm");	
							
						var resultRef1 = "/root/reqData/reqForm/natn_cd";
						var resultRef2 = "/root/reqData/reqForm/natn_nm";
						
						//showCommonCodePopup1("01", "30", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", ""); 120207
						showCommonCodePopup1(model1.getValue("/root/initData/comboSet/xx_job_clsf_01"), model1.getValue("/root/initData/comboSet/xx_cd_clsf_020"), cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");

						model.refresh();
					]]>
				</script>
			</input>
		</group>
		<group id="group3" style="left:10px; top:428px; width:926px; height:220px; ">
			<caption id="caption20" class="list_cap01" style="left:0px; top:20px; width:110px; height:26px; text-align:center; ">여비부담구분</caption>
			<caption id="caption21" class="list_cap02" style="left:385px; top:20px; width:540px; height:26px; text-align:center; "/>
			<caption id="caption23" class="list_cap01" style="left:301px; top:20px; width:85px; height:26px; text-align:center; ">초청기관</caption>
			<caption id="caption24" class="tit02" style="left:0px; top:0px; width:205px; height:20px; font-weight:bold; ">여비사항</caption>
			<caption id="caption27" class="list_cap02" style="left:109px; top:20px; width:193px; height:26px; text-align:center; "/>
			<input id="input11" ref="/root/reqData/reqForm/invit_instt" navindex="9" maxlength="15" appearance="input" style="left:390px; top:24px; width:530px; height:18px; text-align:left; "/>
			<datagrid id="datagrid3" nodeset="/root/resData/gridData3/record" scroll="auto" caption="필요경비내역^예상액^(구체적)필요성^caption1^caption2^caption3^caption4^caption5^caption6" colsep="#" colwidth="170, 100, 600, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:0px; top:95px; width:925px; height:121px; ">
				<col ref="e_etc_cost_ptcr" type="input" maxlength="15" style="text-align:left; "/>
				<col ref="e_etc_cost" type="input" format="#,###" maxlength="10" style="text-align:right; "/>
				<col ref="e_etc_cost_neces" type="input" maxlength="25" style="text-align:left; "/>
				<col ref="e_cmpy_cd" visibility="hidden"/>
				<col ref="e_emp_no" visibility="hidden"/>
				<col ref="e_occr_dt" visibility="hidden"/>
				<col ref="e_seq" visibility="hidden"/>
				<col ref="e_sub_seq" visibility="hidden"/>
				<col ref="e_with_seq" visibility="hidden"/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						rowStatus(datagrid3);
					]]>
				</script>
			</datagrid>
			<select1 id="combo2" ref="/root/reqData/reqForm/busi_trip_fee_burd_clsf" class="req" navindex="8" appearance="minimal" caption="여비부담구분" style="left:113px; top:24px; width:185px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/busi_trip_fee_burd_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
								
							
					]]>
				</script>
			</select1>
			<caption id="caption30" class="list_cap02" style="left:188px; top:45px; width:117px; height:26px; text-align:center; "/>
			<caption id="caption31" class="list_cap02" style="left:385px; top:45px; width:109px; height:26px; text-align:center; "/>
			<caption id="caption33" class="list_cap02" style="left:572px; top:45px; width:123px; height:26px; text-align:center; "/>
			<input id="input12" ref="/root/reqData/reqForm/dd_fee" maxlength="10" format="#,###" appearance="input" style="left:580px; top:49px; width:100px; height:18px; text-align:right; "/>
			<caption id="caption34" class="list_cap01" style="left:493px; top:45px; width:85px; height:26px; text-align:center; "/>
			<caption id="caption36" class="list_cap01" style="left:685px; top:45px; width:240px; height:26px; text-align:center; "/>
			<caption id="caption28" class="list_cap01" style="left:0px; top:45px; width:110px; height:26px; text-align:center; ">본사부담출장비</caption>
			<caption id="caption29" class="list_cap01" style="left:109px; top:45px; width:80px; height:26px; text-align:center; "/>
			<select id="checkbox1" ref="/root/reqData/reqForm/aviat_fee_yn" class="list_cap01" overflow="visible" appearance="full" style="left:111px; top:49px; width:70px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>항공비</label>
						<value>1</value>
					</item>
				</choices>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							aviat_fee_yn = checkbox1.value;
							if(aviat_fee_yn == "1"){
								input9.disabled = false;
							}else{
								input9.disabled = true;
								input9.value = "";
							}
					]]>
				</script>
			</select>
			<select id="checkbox3" ref="/root/reqData/reqForm/dd_fee_yn" class="list_cap01" overflow="visible" appearance="full" style="left:495px; top:49px; width:70px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>일비</label>
						<value>1</value>
					</item>
				</choices>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							dd_fee_yn = checkbox3.value;
							
							if(dd_fee_yn == "1"){
								input12.disabled = false;
							}else{
								input12.disabled = true;
								input12.value = "";
							}
					]]>
				</script>
			</select>
			<select id="checkbox4" ref="/root/reqData/reqForm/ceph_use_yn" class="list_cap01" overflow="visible" appearance="full" style="left:692px; top:49px; width:98px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>휴대폰사용</label>
						<value>1</value>
					</item>
				</choices>
			</select>
			<caption id="caption22" class="list_cap01" style="left:0px; top:70px; width:110px; height:26px; text-align:center; ">기타경비</caption>
			<input id="input9" ref="/root/reqData/reqForm/aviat_fee" maxlength="10" format="#,###" appearance="input" style="left:193px; top:49px; width:100px; height:18px; text-align:right; "/>
			<input id="input10" ref="/root/reqData/reqForm/stay_fee" maxlength="10" format="#,###" appearance="input" style="left:390px; top:49px; width:100px; height:18px; text-align:right; "/>
			<caption id="caption25" class="list_cap02" style="left:109px; top:70px; width:816px; height:26px; text-align:center; "/>
			<button id="button1" class="btn_grid03" style="left:113px; top:74px; width:53px; height:17px; ">
				<caption>행추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var rowCnt = datagrid3.rows;
						var selectedIdx = datagrid3.rows-1;
						var etc_cost_ptcr     = model1.getValue("/root/resData/gridData3/record[1]/e_etc_cost_ptcr");	
						
						if(etc_cost_ptcr == ""){
							if(datagrid3.isReadOnly(1,1) ==true) {
								datagrid3.isReadOnly(1, 1, 1, 3)  =false;
								datagrid3.addStatus(selectedIdx, "insert");
							} else {
								datagrid3.addRow(true, true);
							}
						}else{
							datagrid3.addRow(true, true);
						}
					]]>
				</script>
			</button>
			<button id="button2" class="btn_grid03" style="left:170px; top:74px; width:53px; height:17px; ">
				<caption>행삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						datagrid3.addStatus(datagrid3.row, "delete");
					]]>
				</script>
			</button>
			<caption id="caption35" style="left:536px; top:70px; width:387px; height:20px; font-weight:bold; ">* 휴대폰사용은 본지 혹인 자매지에 기사게재가 될 경우에만 가능</caption>
			<caption id="caption32" class="list_cap01" style="left:301px; top:45px; width:85px; height:26px; text-align:center; "/>
			<select id="checkbox2" ref="/root/reqData/reqForm/stay_fee_yn" class="list_cap01" overflow="visible" appearance="full" style="left:306px; top:49px; width:70px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>숙박비</label>
						<value>1</value>
					</item>
				</choices>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							stay_fee_yn = checkbox2.value;
							
							if(stay_fee_yn == "1"){
								input10.disabled = false;
							}else{
								input10.disabled = true;
								input10.value = "";
							}
					]]>
				</script>
			</select>
		</group>
		<datagrid id="datagrid4" nodeset="/root/resData/gridData4/record" scroll="auto" caption="일자^출발지^목적지^출장내용^caption2^caption3^caption4^caption1^caption5^caption6" colsep="#" colwidth="90, 200, 200, 390, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:10px; top:666px; width:925px; height:174px; ">
			<col class="req" ref="d_midl_start_dt" type="inputdate" caption="일자"/>
			<col class="req" ref="d_start_area" type="input" maxlength="15" caption="출발지" style="text-align:left; "/>
			<col class="req" ref="d_dest" type="input" maxlength="15" caption="목적지" style="text-align:left; "/>
			<col class="req" ref="d_busi_trip_cont" type="input" maxlength="25" caption="출장내용" style="text-align:left; "/>
			<col ref="d_cmpy_cd" visibility="hidden"/>
			<col ref="d_emp_no" visibility="hidden"/>
			<col ref="d_occr_dt" visibility="hidden"/>
			<col ref="d_seq" visibility="hidden"/>
			<col ref="d_sub_seq" visibility="hidden"/>
			<col ref="d_with_seq" visibility="hidden"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					rowStatus(datagrid4);
				]]>
			</script>
		</datagrid>
		<group id="group4" class="gro_btn" style="left:9px; top:646px; width:926px; height:20px; ">
			<caption id="caption37" class="tit02" style="left:2px; top:0px; width:335px; height:20px; font-weight:bold; ">상세계획</caption>
			<button id="button3" class="btn_grid03" visibility="hidden" style="left:870px; top:0px; width:53px; height:17px; ">
				<caption>행추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						var rowCnt = datagrid4.rows;
						var selectedIdx = datagrid4.rows-1;
						var midl_start_dt  = model1.getValue("/root/resData/gridData4/record[1]/d_midl_start_dt");	
						
						if(midl_start_dt == ""){
							
							if(datagrid4.isReadOnly(1,1) ==true) {
								datagrid4.isReadOnly(1, 1, 1, 4)  =false;
								datagrid4.addStatus(selectedIdx, "insert");
							} else {
								datagrid4.addRow(true, true);
							}
						}else{
							datagrid4.addRow(true, true);
						}
					
					
					]]>
				</script>
			</button>
			<button id="button8" class="btn_grid03" visibility="hidden" style="left:720px; top:0px; width:53px; height:17px; ">
				<caption>행삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						datagrid4.addStatus(datagrid4.row, "delete");
					]]>
				</script>
			</button>
		</group>
		<caption id="caption43" ref="/root/resData/totcnt" style="left:845px; top:840px; width:87px; height:20px; font-weight:bold; text-align:right; "/>
	</xhtml:body>
</xhtml:html>
