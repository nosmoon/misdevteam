<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<hd_trip_1705_m>
							<dataSet>
								<xx_proc_clsf_010/>
								<xx_proc_clsf_020/>
								<xx_proc_clsf_030/>
								<xx_proc_clsf_040/>
								<xx_rptv_posi_cd_010/>
								<xx_rptv_posi_cd_020/>
								<xx_rptv_posi_cd_030/>
								<xx_rptv_posi_cd_040/>
								<xx_pay_basi_clsf_010/>
								<xx_pay_basi_clsf_020/>
								<xx_pay_basi_clsf_030/>
								<xx_dspch_clsf_010/>
								<xx_dspch_clsf_020/>
								<xx_stay_clsf_010/>
								<xx_mode_gubun_010/>
							</dataSet>
						</hd_trip_1705_m>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<stay_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</stay_clsf>
							<!-- 선택계열의 정보를 담당 -->
							<dept_cd>
								<item/>
							</dept_cd>
							<proc_stat>
								<item/>
							</proc_stat>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<!-- 검색조건 처리 -->
						<reqForm>
							<chk1/>
						</reqForm>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<!-- MultiUpDate유형 사용시 처리 -->
						<searchData>
							<busi_trip_frdt/>
							<busi_trip_todt/>
							<emp_no/>
							<stay_clsf>ALL</stay_clsf>
							<dept_cd/>
							<dept_nm/>
						</searchData>
						<fwdData>
							<func_nm/>
						</fwdData>
						<popData>
							<emp_no/>
							<cmpy_cd/>
							<vaca_ck/>
						</popData>
						<multiUpData/>
						<mode_gubun/>
					</reqData>
					<resData>
						<empInfo>
							<cmpy_cd/>
							<emp_no/>
							<nm_korn/>
							<dept_cd/>
							<dept_nm/>
							<dty_nm/>
							<posi_nm/>
							<dty_cd/>
							<posi_cd/>
						</empInfo>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<temp/>
						</resForm>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<msg/>
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<record>
								<chkbox/>
								<dept_nm/>
								<emp_no/>
								<flnm/>
								<dty_nm/>
								<posi_nm/>
								<stay_clsf/>
								<stay_area/>
								<busi_trip_purp/>
								<busi_trip_frdt/>
								<busi_trip_todt/>
								<busi_trip_dds/>
								<dd_fee/>
								<busi_trip_fee_stot/>
								<cmpy_cd/>
								<dept_cd/>
								<dty_cd/>
								<posi_cd/>
								<occr_dt/>
								<seq/>
								<sub_seq/>
								<slip_proc_mang_dt/>
								<slip_proc_mang_seq/>
								<rptv_posi_cd/>
								<proc_clsf/>
								<proc_stat_nm/>
								<rptv_posi_nm/>
							</record>
							<!-- datagrid2 -->
							<!-- datagrid3 -->
						</gridData>
						<resPhoto type="xsd:base64Binary"/>
						<base_alon_clsf>
							<record>
								<pay_basi_clsf/>
								<dspch_clsf/>
								<base_alon/>
							</record>
						</base_alon_clsf>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					//사원 찾기 
					function setEmp_no(emp_no, nm_korn)
					{
						var n_row = datagrid2.row;
						
						model1.setValue("/root/reqData/searchData/emp_no",emp_no);
						
						model1.send("hd_trip_1701");
						model1.copyNode("/root/resData/empInfo","/root/tempData/empInfo/record");
						var dept_cd = model1.getValue("/root/resData/empInfo/dept_cd");
						var dept_nm = model1.getValue("/root/resData/empInfo/dept_nm");
						var emp_no = model1.getValue("/root/resData/empInfo/emp_no");
						var nm_korn = model1.getValue("/root/resData/empInfo/nm_korn");
						var posi_nm = model1.getValue("/root/resData/empInfo/posi_nm");
						var posi_cd = model1.getValue("/root/resData/empInfo/posi_cd");
						var dty_nm = model1.getValue("/root/resData/empInfo/dty_nm");
						var dty_cd = model1.getValue("/root/resData/empInfo/dty_cd");
						var cmpy_cd = model1.getValue("/root/resData/empInfo/cmpy_cd");
						var rptv_posi_cd = model1.getValue("/root/resData/empInfo/rptv_posi_cd");
						var rptv_posi_nm = model1.getValue("/root/resData/empInfo/rptv_posi_nm");
						var duty_area_cd = model1.getValue("/root/resData/empInfo/duty_area_cd");
						var duty_area_nm = model1.getValue("/root/resData/empInfo/duty_area_nm");
						
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/cmpy_cd", cmpy_cd);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/dept_cd", dept_cd);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/dept_nm", dept_nm);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/emp_no", emp_no);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/flnm", nm_korn);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/posi_cd", posi_cd);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/posi_nm", posi_nm);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/dty_cd", dty_cd);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/dty_nm", dty_nm);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/rptv_posi_cd", rptv_posi_cd);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/rptv_posi_nm", rptv_posi_nm);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/stay_area", duty_area_nm);
						model1.removenode("/root/tempData");
						setDay(datagrid2.row);
						datagrid2.refresh();
					}
					
					function check_reset(){
						var col = datagrid2.fixedCols;
						var rows = datagrid2.rows;
						for( i = datagrid2.fixedRows ; i <= rows ; i++){
							datagrid2.valueMatrix(i,col) = "false";
						}
						//check_all.value = "";
					}

					function isByteLength(data, maxlen) {
					    var len = data.length;
					    for (i = 0; i < data.length; i++){
					        if (data.charCodeAt(i)  > 127){
					            len++;
					        }
					    }
					    if (len > maxlen) {
					        return false;
					    } else {
					        return true;
					    }
					}

					//근무시간 구하기
					function getDay(busi_trip_frdt, busi_trip_todt)
					{
						var busi_trip_frdt_month = (busi_trip_frdt.substr(4,1) == "0")? busi_trip_frdt.substr(5,1) :  busi_trip_frdt.substr(4,2);
						var busi_trip_todt_month = (busi_trip_todt.substr(4,1) == "0")? busi_trip_todt.substr(5,1) :  busi_trip_todt.substr(4,2);
						var busi_trip_frdt_day = (busi_trip_frdt.substr(6,1) == "0")? busi_trip_frdt.substr(7,1) :  busi_trip_frdt.substr(6,2);
						var busi_trip_todt_day = (busi_trip_todt.substr(6,1) == "0")? busi_trip_todt.substr(7,1) :  busi_trip_todt.substr(6,2);
						
						var busi_trip_frdt_date = new Date(busi_trip_frdt.substr(0,4),busi_trip_frdt_month,busi_trip_frdt_day);   
						var busi_trip_todt_date = new Date(busi_trip_todt.substr(0,4),busi_trip_todt_month,busi_trip_todt_day);  
						var daym = Math.floor((busi_trip_todt_date.getTime() - busi_trip_frdt_date.getTime())/(24*60*60*1000) +1);           
						if (daym < 1)  {
							alert("날짜 선택이 잘못됐습니다");
							return 0;
						}
  						return daym;
					}			
					
					function setDept_cd(iv_dept_cd, iv_dept_nm){
						model1.setValue("/root/reqData/searchData/dept_cd", iv_dept_cd);
						model1.setValue("/root/reqData/searchData/dept_nm", iv_dept_nm);
						model1.refresh();
					}			
					
					function setDay(row){
						var now_date = new Date();
						var year = now_date.getYear();
						var month = now_date.getMonth() + 1;
						var day = now_date.getDate();    
						var month_tm = '0' + month;
						var day_tm = '0' + day;  
						if(month_tm.length == 3){
							month_tm = month_tm.substring(1, 3);
						}
						if(day_tm.length == 3){
							day_tm = day_tm.substring(1, 3);
						}
						var now_dt = year + month_tm + day_tm;
						var yyyymmdd1 = year + month_tm + "01";
						var yyyymmdd2 = year + month_tm + commLastDay(year + month_tm);
						
						/*var s="";
						var mydate=new Date() 
						var year=mydate.getYear() 
						    if (year < 1000) 
						        year+=1900 
						
						var day=mydate.getDay() 
						var month=mydate.getMonth()+1 
						    if (month<10) 
						        month="0"+month 
						
						var daym=mydate.getDate() 
						    if (daym<10) 
						        daym="0"+daym 
						s  = year + month;
						
						var yyyymmdd1 = s + "01";
						var yyyymmdd2 = s + commLastDay(s);*/
						
						model1.setValue("/root/resData/gridData/record["+row+"]/busi_trip_frdt", yyyymmdd1); // 시작일자
						model1.setValue("/root/resData/gridData/record["+row+"]/busi_trip_todt", yyyymmdd2); // 종료일자
					}						
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					model1.send("hd_co_1000");
					model1.copyNode("/root/initData/comboSet/dept_cd", "/root/dataSet/dept_cd");
					model1.removenode("/root/dataSet");
					model1.send("hd_trip_1700");
					model1.copyNode("/root/initData/comboSet/stay_clsf","/root/tempData/stay_clsf");
					model1.copyNode("/root/resData/base_alon_clsf", "/root/tempData/base_alon_clsf");
					model1.removenode("/root/tempData");
					model1.refresh();
					datagrid2.addStatus(1, "insert");	
						
					model1.send("hd_trip_1102");
					model1.copyNode("/root/initData/comboSet/proc_stat", "/root/dataSet/CURLIST1");
					model1.removenode("/root/dataSet");
					
					model1.send("hd_trip_1705_m");
					model1.refresh();
					
					/*
					alert(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_proc_clsf_010"));
					alert(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_proc_clsf_020"));
					alert(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_proc_clsf_030"));
					alert(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_proc_clsf_040"));
					alert(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_rptv_posi_cd_010"));
					alert(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_rptv_posi_cd_020"));
					alert(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_rptv_posi_cd_030"));
					alert(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_rptv_posi_cd_040"));
					alert(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_pay_basi_clsf_010"));
					alert(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_pay_basi_clsf_020"));
					alert(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_pay_basi_clsf_030"));
					alert(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_dspch_clsf_010"));
					alert(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_dspch_clsf_020"));
					alert(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_stay_clsf_010"));
					alert(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_mode_gubun_010"));
					*/
					
//					model1.removenode("/root/resData/gridData/record[1]");

					datagrid2.fixedcellcheckbox(0, datagrid2.colRef("chkbox"), false) = true;
					
//					model1.makenode("/root/resData/gridData");
//					datagrid2.removeRow();					
//					datagrid2.isReadOnly(1, 1, 1, 13)  = true;
//					datagrid2.refresh();
					model1.refresh();
					
					var now_date = new Date();
					var year = now_date.getYear();
					var month = now_date.getMonth() + 1;
					var day = now_date.getDate();    
					var month_tm = '0' + month;
					var day_tm = '0' + day;  
					if(month_tm.length == 3){
						month_tm = month_tm.substring(1, 3);
					}
					if(day_tm.length == 3){
						day_tm = day_tm.substring(1, 3);
					}
					var now_dt = year + month_tm + day_tm;
					var yyyymmdd1 = year + month_tm + "01";
					var yyyymmdd2 = year + month_tm + commLastDay(year + month_tm);
										
					busi_trip_frdt.value = yyyymmdd1; // + "0101";
					busi_trip_todt.value = yyyymmdd2; // + "1231";
					
					model1.send("hd_duty_1205");
					model1.setValue("/root/reqData/searchData/dept_cd", model1.getValue("/root/dataSet/CURLIST2/record/dept_cd"));
					model1.removenode("/root/dataSet");
					model1.refresh();
			]]>
			</script>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<submission id="hd_trip_1700" action="/hd/trip/1700" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1701" action="/hd/trip/1701" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1702" action="/hd/trip/1702" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_trip_1703" action="/hd/trip/1703" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1704" action="/hd/trip/1704" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_co_1000" action="/hd/co/1000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_duty_1205" action="/hd/duty/1205" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_trip_1102" action="/hd/trip/1102" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_trip_1109" action="/hd/trip/1109" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_trip_1705_m" action="/hd/trip/1705" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/hd_trip_1705_m/dataSet"/>
		</model>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="740" guideline="1,8;1,934;2,318;" style="font-family:굴림; ">
		<group id="group1" class="gro_btn" style="left:10px; top:95px; width:378px; height:20px; ">
			<caption id="caption5" class="tit02" style="left:2px; top:0px; width:335px; height:20px; font-weight:bold; ">파견일비내역</caption>
		</group>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData/record" caption="선택^부서^사번^성명^직책^직1급^직급^시작일자^종료일자^파견구분^파견지^파견사유^일수^일일금액^합계^진행상태^caption1^caption2^caption3^caption4^caption5^caption6^caption7^caption8^caption9^caption10^caption11" colsep="#" colwidth="50, 100, 71, 69, 66, 65, 65, 100, 100, 82, 100, 36, 50, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:10px; top:115px; width:924px; height:590px; ">
			<col checkvalue="1,0" ref="chkbox" type="checkbox"/>
			<col ref="dept_nm" style="text-align:left; "/>
			<col class="req" ref="emp_no" type="inputbutton" maxlength="6" caption="사번">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model1.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
 					//if(event.keyCode == 13){
 						var rowIdx =datagrid2.row;					
						var colIdx =datagrid2.col;					
						var empno = datagrid2.valueMatrix(rowIdx,colIdx);

 						setInfoSearchInput(empno,"","","setEmp_no");
 						if(model1.getValue("/root/tempData/totalcnt") != 1){
 							return;
 						}
 						
 						setEmp_no(model1.getValue("/root/tempData/emp_no"),"");
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/emp_no", model1.getValue("/root/tempData/emp_no"));
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/flnm", model1.getValue("/root/tempData/nm_korn"));
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_cd", model1.getValue("/root/tempData/dept_cd"));
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_nm", model1.getValue("/root/tempData/dept_nm"));
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_nm", model1.getValue("/root/tempData/posi_nm"));
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_cd", model1.getValue("/root/tempData/posi_cd"));
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_cd", model1.getValue("/root/tempData/dty_cd"));
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_nm", model1.getValue("/root/tempData/dty_nm"));

						setDay(datagrid2.row);
						 						
 						model1.refresh();
 					//}
					]]>
				</script>
			</col>
			<col class="req" ref="flnm" type="input" caption="성명">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
 					//if(event.keyCode == 13){
 						var rowIdx =datagrid2.row;					
						var colIdx =datagrid2.col;					
						var nm_korn = datagrid2.valueMatrix(rowIdx,colIdx);

 						setInfoSearchInput("",nm_korn,"","setEmp_no");
 						if(model1.getValue("/root/tempData/totalcnt") != 1){
 							return;
 						}

 						setEmp_no(model1.getValue("/root/tempData/emp_no"),""); 						
						//setInfoSearchInput(model1.getValue("/root/tempData/emp_no"),"","");
						
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/emp_no", model1.getValue("/root/tempData/emp_no"));
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/flnm", model1.getValue("/root/tempData/nm_korn"));
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_cd", model1.getValue("/root/tempData/dept_cd"));
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dept_nm", model1.getValue("/root/tempData/dept_nm"));
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_nm", model1.getValue("/root/tempData/posi_nm"));
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/posi_cd", model1.getValue("/root/tempData/posi_cd"));
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_cd", model1.getValue("/root/tempData/dty_cd"));
//						model1.setValue("/root/resData/gridData/record[" + (rowIdx) + "]/dty_nm", model1.getValue("/root/tempData/dty_nm"));
						setDay(datagrid2.row);
						 						
 						model1.refresh();
 					//}
					]]>
				</script>
			</col>
			<col ref="dty_nm" visibility="hidden"/>
			<col ref="posi_nm" visibility="hidden"/>
			<col ref="rptv_posi_nm"/>
			<col class="req" ref="busi_trip_frdt" type="inputdate" format="yyyy-mm-dd" caption="출장시작일"/>
			<col class="req" ref="busi_trip_todt" type="inputdate" format="yyyy-mm-dd" caption="출장종료일"/>
			<col class="req" ref="stay_clsf" type="combo" caption="파견구분" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/stay_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col class="req" ref="stay_area" type="input" caption="파견지" style="text-align:left; "/>
			<col ref="busi_trip_purp" type="input" visibility="hidden" style="text-align:left; "/>
			<col ref="busi_trip_dds" style="left:914px; top:20px; width:50px; height:20px; "/>
			<col ref="dd_fee" format="#,###" style="text-align:right; ">
				<script type="javascript" ev:event="onendedit">
					<![CDATA[
					var col = datagrid2.col;
					var row = datagrid2.row;
					
					var  dd_fee =model1.getValue("/root/resData/gridData/record[" + row + "]/dd_fee");
					var  busi_trip_dds =model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_dds");
						
					model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_fee_stot", parseInt(busi_trip_dds) * parseInt(dd_fee));	
						
					]]>
				</script>
			</col>
			<col ref="busi_trip_fee_stot" format="#,###" style="text-align:right; "/>
			<col ref="proc_stat_nm"/>
			<col ref="cmpy_cd" visibility="hidden"/>
			<col ref="dept_cd" visibility="hidden"/>
			<col ref="dty_cd" visibility="hidden"/>
			<col ref="posi_cd" visibility="hidden"/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="sub_seq" visibility="hidden"/>
			<col ref="slip_proc_mang_seq" visibility="hidden"/>
			<col ref="slip_proc_mang_dt" visibility="hidden"/>
			<col ref="rptv_posi_cd" visibility="hidden"/>
			<col ref="proc_clsf" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
					var row = datagrid2.row;
					if(datagrid2.fixedcellischeck(0,datagrid2.colRef("chkbox")) == true && row==0){
						for(var i=1;i<datagrid2.rows;i++) {
							var proc_stat = model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf");
							
							//if(datagrid2.valueMatrix(i, datagrid2.colRef("chkbox")) == 1 && (proc_stat != 29 && proc_stat != 36)) {
							
							
							//if(datagrid2.valueMatrix(i, datagrid2.colRef("chkbox")) == 1 && (proc_stat == 20 || proc_stat == "")) { //120207
							if(datagrid2.valueMatrix(i, datagrid2.colRef("chkbox")) == 1 && (proc_stat == model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_proc_clsf_010") || proc_stat == "")) {
								var status = datagrid2.rowstatus(i);
								
								if(status=="0" ||  status=="7"){
									datagrid2.rowstatus(i) = 2;	
								}
							}
						}
					}	
				
				 	datagrid2.refresh();

				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[
					var row = datagrid2.row;
					
					if(datagrid2.fixedcellischeck(0,datagrid2.colRef("chkbox")) == false && row==0){
						for(var i=1;i<datagrid2.rows;i++) {
							if(datagrid2.valueMatrix(i, datagrid2.colRef("chbox")) == 0) {
								var status = datagrid2.rowstatus(i); 
								if(status=="2"){
									datagrid2.rowstatus(i) = 7;	
								}
							}
						}	
						datagrid2.refresh();	
					}
					 // 각 체크박스 체크 시
					var status = datagrid2.rowstatus(row);
	
					if(datagrid2.valueMatrix(row, datagrid2.colRef("chbox")) == 0) {
						if(status=="2"){
							datagrid2.rowStatus(row) = 7;				
							datagrid2.refresh();
						}
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[	
					
					var col = datagrid2.col;
					var row = datagrid2.row;

					 if(datagrid2.col==datagrid2.colRef("busi_trip_frdt") || datagrid2.col==datagrid2.colRef("busi_trip_todt")){ //출장일수 구하는 부분
						var  busi_trip_frdt =model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_frdt");
						var  busi_trip_todt =model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_todt");
						var  dd_fee =model1.getValue("/root/resData/gridData/record[" + row + "]/dd_fee");
						
						var getDay1 ;
						
						if(busi_trip_frdt !="" && busi_trip_todt != "") {
							getDay1 =  getDay(busi_trip_frdt, busi_trip_todt);
	
							if(getDay1 == 0) {
								model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_frdt","");
								model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_todt","");
							}
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_dds",getDay1);

							busi_trip_dds = model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_dds");
							
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_fee_stot", parseInt(busi_trip_dds) * parseInt(dd_fee));	
						} else {
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_dds","");
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_fee_stot", "");	
						}
					}
					
					
					if(datagrid2.col==datagrid2.colRef("stay_clsf")) {
						var ins = document.models( 0 ).instances( 0 );

						var nodelist = ins.selectNodes( "/root/resData/base_alon_clsf/record" );
						var  rptv_posi_cd =model1.getValue("/root/resData/gridData/record[" + row + "]/rptv_posi_cd");	
						
						var  stay_clsf =model1.getValue("/root/resData/gridData/record[" + row + "]/stay_clsf");	
						var  emp_no =model1.getValue("/root/resData/gridData/record[" + row + "]/emp_no");	
						var dspch_clsf1 = "";
						var dspch_clsf2 = "";
						
						//if(rptv_posi_cd == "72"){ 120207
						if(rptv_posi_cd == model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_rptv_posi_cd_010")){
							rptv_posi_cd =model1.getValue("/root/resData/gridData/record[" + row + "]/posi_cd");	
						}
						
						if(emp_no=="") {
							alert("성명을 검색해주세요.");
							return;	
						}

						//if(parseInt(rptv_posi_cd) <= 50) { 120207
						if(Number(rptv_posi_cd) <= Number(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_rptv_posi_cd_020"))  ) {
							for(var i = 0; i < nodelist.length; i++)
							{
								var pay_basi_clsf = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/pay_basi_clsf");
								var dspch_clsf = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/dspch_clsf");
								var base_alon = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/base_alon");
								
								//if(pay_basi_clsf=="10" && dspch_clsf == "1") { 120207
								if(pay_basi_clsf==model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_pay_basi_clsf_010") && dspch_clsf == model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_dspch_clsf_010")) {
									dspch_clsf1 =  base_alon;
								}
								//if(pay_basi_clsf=="10" && dspch_clsf == "2") { 120207
								if(pay_basi_clsf==model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_pay_basi_clsf_010") && dspch_clsf == model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_dspch_clsf_020")) {
									dspch_clsf2 =  base_alon;
								}
							}
						}
						
						//if(parseInt(rptv_posi_cd) == 51) { 120207
						if(Number(rptv_posi_cd) == Number(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_rptv_posi_cd_030"))  ) {
							for(var i = 0; i < nodelist.length; i++)
							{
								var pay_basi_clsf = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/pay_basi_clsf");
								var dspch_clsf = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/dspch_clsf");
								var base_alon = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/base_alon");
								
								//if(pay_basi_clsf=="20" && dspch_clsf == "1") { 120207
								if(pay_basi_clsf==model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_pay_basi_clsf_020") && dspch_clsf == model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_dspch_clsf_010")) {
									dspch_clsf1 =  base_alon;
								}
								//if(pay_basi_clsf=="20" && dspch_clsf == "2") { 120207
								if(pay_basi_clsf==model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_pay_basi_clsf_020") && dspch_clsf == model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_dspch_clsf_020")) {
									dspch_clsf2 =  base_alon;
								}
							}
						}	

						//if(parseInt(rptv_posi_cd) >=  52) { 120207
						if(Number(rptv_posi_cd) >=  Number(model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_rptv_posi_cd_040"))  ) {
							for(var i = 0; i <= nodelist.length; i++)
							{
								var pay_basi_clsf = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/pay_basi_clsf");
								var dspch_clsf = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/dspch_clsf");
								var base_alon = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/base_alon");
								
								//if(pay_basi_clsf=="30" && dspch_clsf == "1") { 120207
								if(pay_basi_clsf==model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_pay_basi_clsf_030") && dspch_clsf == model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_dspch_clsf_010")) {
									dspch_clsf1 =  base_alon;
								}
								//if(pay_basi_clsf=="30" && dspch_clsf == "2") { 120207
								if(pay_basi_clsf==model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_pay_basi_clsf_030") && dspch_clsf == model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_dspch_clsf_020")) {
									dspch_clsf2 =  base_alon;
								}
							}
						}	
						
						//if(stay_clsf=="1"){ 120207
						if(stay_clsf==model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_stay_clsf_010")){
							model1.setValue("/root/resData/gridData/record[" + row + "]/dd_fee",dspch_clsf1);
						}else{
							model1.setValue("/root/resData/gridData/record[" + row + "]/dd_fee",dspch_clsf2);
						}
						
						
						var  busi_trip_frdt =model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_frdt");
						var  busi_trip_todt =model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_todt");
						var  dd_fee =model1.getValue("/root/resData/gridData/record[" + row + "]/dd_fee");
//						
//						if(busi_trip_frdt!="" && busi_trip_todt !=""){
//							var getDay = getDay(busi_trip_frdt, busi_trip_todt);
//							
//							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_dds",getDay);
//						
//							busi_trip_dds = model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_dds");
//							
//							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_fee_stot", parseInt(busi_trip_dds) * parseInt(dd_fee));	
//						}						
						var getDay2 ;
						
						if(busi_trip_frdt !="" && busi_trip_todt != "") {
							getDay2 =  getDay(busi_trip_frdt, busi_trip_todt);
	
							if(getDay2 == 0) {
								model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_frdt","");
								model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_todt","");
							}
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_dds",getDay2);

							busi_trip_dds = model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_dds");
							
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_fee_stot", parseInt(busi_trip_dds) * parseInt(dd_fee));	
						} else {
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_dds","");
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_fee_stot", "");	
						}						
					}


					var row =datagrid2.row;					

					if(datagrid2.col==datagrid2.colRef("chkbox")) {  
	
						if(datagrid2.valueMatrix(row, datagrid2.colRef("chkbox"))=="1"){
							datagrid2.rowStatus(row) = 2;
						}else if(datagrid2.valueMatrix(row, datagrid2.colRef("chkbox"))=="0"){
							datagrid2.rowStatus(row) = 0;
						}		
					} else {  
						if(datagrid2.rowStatus(row)=="3" ) {
							datagrid2.valueMatrix(row, datagrid2.colRef("chkbox")) = "1";
						} else {
							datagrid2.valueMatrix(row, datagrid2.colRef("chkbox")) = "1";
							datagrid2.rowStatus(row) = 2;
						}
					}				
							
					if(datagrid2.col==datagrid2.colRef("stay_area")) {
						var stay_area_val =  model1.getValue("/root/resData/gridData/record[" + row + "]/stay_area");
						if(!isByteLength(stay_area_val,20)) {
//						if(stay_area_val.length>10) {
							alert("허용된 글자수를 초과했습니다");
							model1.setValue("/root/resData/gridData/record[" + row + "]/stay_area","");
						}
					}
					if(datagrid2.col==datagrid2.colRef("busi_trip_purp")) {
						var busi_trip_purp_val =  model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_purp");
						if(!isByteLength(busi_trip_purp_val,60)) {
//						if(busi_trip_purp_val.length>30) {
							alert("허용된 글자수를 초과했습니다");
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_purp","");
						}
					}
		
				]]>
			</script>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if (datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("proc_clsf")) == "" ||
					    //datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("proc_clsf")) == "10") 120207
					    datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("proc_clsf")) == model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_proc_clsf_020"))
						rowStatus(datagrid2);
				]]>
			</script>
		</datagrid>
		<group id="group_btnG1" class="gro_btn" style="left:10px; top:95px; width:926px; height:20px; ">
			<button id="button5" class="btn_grid03" style="left:870px; top:0px; width:53px; height:17px; ">
				<caption>행추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						datagrid2.addRow(true, true);
						/*					
						var rowCnt = datagrid2.rows;
						var selectedIdx = datagrid2.rows-1;
						var emp_no     = model1.getValue("/root/resData/gridData/record[1]/emp_no");	
						
						if(emp_no == ""){
							if(datagrid2.isReadOnly(1,1) ==true) {
								datagrid2.isReadOnly(1, 1, 1, 13)  =false;
								datagrid2.addStatus(selectedIdx, "insert");
							} else {
								datagrid2.addRow(true, true);
								datagrid2.isReadOnly(rowCnt , 2)  =true;
							}
						}else{
							datagrid2.addRow(true, true);
							datagrid2.isReadOnly(rowCnt , 2)  =true;
						}
					
						model1.makeNode("/root/resData/resForm/temp");
						model1.setValue("/root/resData/resForm/temp", "1");
					      */
					]]>
				</script>
			</button>
			<!--
			<button id="button2" class="btn_grid03" style="left:804px; top:0px; width:52px; height:17px; ">
				<caption>행삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						datagrid2.addStatus(datagrid2.row, "delete");
						datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("chkbox")) = "1";						
					]]>
				</script>
			</button>
			<button id="button4" class="btn_grid03" style="left:862px; top:0px; width:52px; height:17px; ">
				<caption>행취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						datagrid2.rowStatus(datagrid2.row) = "0";
						datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("chkbox")) = "0";						

					]]>
				</script>
			</button>
-->
		</group>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:38px; width:926px; height:21px; ">
			<button id="btnA1" class="btn02" style="left:498px; top:0px; width:52px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (!rowInSubmit(datagrid2)) {
							return;
						}
						
						if(!commGridReqCheck("datagrid2"))
							return;
						 
						var i =0, var_check_row = 0, var_date_err =0 ,var_date_dup =0, var_proc_cnt =0;
						var var_proc_clsf ="";
						
						/*
						for (i = 1; i < datagrid2.rows; i++) {
			 		     	if (datagrid2.rowStatus(i) != 0) {
								var_check_row = var_check_row + 1;
								
								var_proc_clsf = datagrid2.valueMatrix(i,  datagrid2.colRef("proc_clsf"));
								if( var_proc_clsf != "" &&  (var_proc_clsf != "01" && var_proc_clsf != "10" && var_proc_clsf != "13" && var_proc_clsf != "14" && var_proc_clsf != "16"))  {
									var_proc_cnt = var_proc_cnt +1;
								}
							}
						}

				       if (var_check_row == 0) {
							alert("저장 또는 신청 확인할 데이터를 선택 후  사용하세요.");
					   		return;       
				       }	


				       if (var_proc_cnt > 0) {
							alert("저장 또는 신청 확인할 데이터를 확인 후  사용하세요. 결제가 진행된 상태입니다.");
					   		return;       
				       }	
						*/
						
						for (i=1; i<datagrid2.rows; i++) {
							var  seq =model1.getValue("/root/resData/gridData/record[" + i + "]/seq");
							var  emp_no =model1.getValue("/root/resData/gridData/record[" + i + "]/emp_no");
							var  busi_trip_frdt =model1.getValue("/root/resData/gridData/record[" + i + "]/busi_trip_frdt");
							var  busi_trip_todt =model1.getValue("/root/resData/gridData/record[" + i + "]/busi_trip_todt");
							var  dd_fee =model1.getValue("/root/resData/gridData/record[" + i + "]/dd_fee");
							var frdt1 =0 , frdt2=0, todt1=0, todt2=0;
							frdt1 = busi_trip_frdt;
							todt1 = busi_trip_todt;
							
							for(j=1;j<datagrid2.rows;j++) {
								if(emp_no == model1.getValue("/root/resData/gridData/record[" + j + "]/emp_no") &&
								   seq       != model1.getValue("/root/resData/gridData/record[" + j + "]/seq")) {
									frdt2 = model1.getValue("/root/resData/gridData/record[" + j + "]/busi_trip_frdt");
								   	todt2 = model1.getValue("/root/resData/gridData/record[" + j + "]/busi_trip_todt");
									if(frdt1  >= frdt2 && frdt1 <= todt2) {
									   	var_date_dup = var_date_dup + 1;
									   }
									if(todt1  >= frdt2 && todt1 <= todt2) {
									   	var_date_dup = var_date_dup + 1;
									   }
								}
							}
							
							var getDay1 ;
							
							if(busi_trip_frdt !="" && busi_trip_todt != "") {
								getDay1 =  getDay(busi_trip_frdt, busi_trip_todt);
							}
							if(getDay1 == 0) { 
								var_date_err = var_date_err + 1 ; 
							}
						}

						if (var_date_err > 0 ) {
							alert("선택된 데이터 중 날짜가 잘못된 데이터가 있습니다.");
							return;       
						}	
						
						/*if (var_date_dup > 0 ) {
							alert("선택된 데이터 중 중복된 데이터가 있습니다.");
							return;       
						}*/

	 					if (window.alert("저장하시겠습니까?", "확인", 1) != 1) {
							return;
						}
					
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_trip_1702");

						if(submit_completed()) {
							model1.resetInstanceNode("/root/resData/gridData/record");
							model1.refresh();
							datagrid2.addStatus(1, "insert");	
							datagrid2.clearStatus();
							button3.dispatch("onclick");
							/*
							model1.reset();
							datagrid2.addStatus(1, "insert");	
							datagrid2.clearStatus();
							*/
						}
					]]>
				</script>
			</button>
			<button id="btnA2" class="btn02" style="left:333px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.reset();
						datagrid2.addStatus(1, "insert");	
						datagrid2.isReadOnly(1, 1, 1, 1) = false;
					]]>
				</script>
			</button>
			<button id="button7" class="btn02" style="left:874px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
				 	viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					window.close();			
					]]>
				</script>
			</button>
			<button id="button1" class="btn03" style="left:553px; top:0px; width:65px; height:21px; ">
				<caption>현업등록</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						if (datagrid2.rows < 2) {
							alert("등록할 대상이 없습니다.");
							return;
						}

						if(!commGridReqCheck("datagrid2"))
							return;
						
						var i =0, var_check_row = 0, var_date_err =0 ,var_date_dup =0, var_proc_cnt =0;
						var var_proc_clsf = ""  ;

						for (i=1; i<datagrid2.rows; i++) {
				 			if (datagrid2.rowStatus(i) != 0) {
								//alert(datagrid2.rowStatus(i));
								
								var_check_row = var_check_row + 1;
								var_proc_clsf = datagrid2.valueMatrix(i,  datagrid2.colRef("proc_clsf"));
								
								var pattern = ","+var_proc_clsf+",";
								var validation  = (","+model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_proc_clsf_040")+",").indexOf(pattern)==-1;
								
								//if( var_proc_clsf != "" &&  (var_proc_clsf != "01" && var_proc_clsf != "10" && var_proc_clsf != "13" && var_proc_clsf != "14"))  { 120207
								if( var_proc_clsf != "" &&  validation)  {
									var_proc_cnt = var_proc_cnt +1;
								}								
							}
						}

						if (var_check_row == 0) {
							alert("등록할 대상이 없습니다.");
							return;       
						}	
						if (var_proc_cnt > 0) {
							alert("저장 또는 등록 처리할 데이터를 확인하십시오. 결재가 진행된 상태입니다.");
							return;       
						}
					       
						for (i=1; i<datagrid2.rows; i++) {
							var  seq =model1.getValue("/root/resData/gridData/record[" + i + "]/seq");
							var  emp_no =model1.getValue("/root/resData/gridData/record[" + i + "]/emp_no");
							var  busi_trip_frdt =model1.getValue("/root/resData/gridData/record[" + i + "]/busi_trip_frdt");
							var  busi_trip_todt =model1.getValue("/root/resData/gridData/record[" + i + "]/busi_trip_todt");
							var  dd_fee =model1.getValue("/root/resData/gridData/record[" + i + "]/dd_fee");
							var frdt1 =0 , frdt2=0, todt1=0, todt2=0;
							frdt1 = busi_trip_frdt;
							todt1 = busi_trip_todt;
							
							for(j=1;j<datagrid2.rows;j++) {
								if(emp_no == model1.getValue("/root/resData/gridData/record[" + j + "]/emp_no") &&
								   seq       != model1.getValue("/root/resData/gridData/record[" + j + "]/seq")) {
									frdt2 = model1.getValue("/root/resData/gridData/record[" + j + "]/busi_trip_frdt");
								   	todt2 = model1.getValue("/root/resData/gridData/record[" + j + "]/busi_trip_todt");
									if(frdt1  >= frdt2 && frdt1 <= todt2) {
									   	var_date_dup = var_date_dup + 1;
									   }
									if(todt1  >= frdt2 && todt1 <= todt2) {
									   	var_date_dup = var_date_dup + 1;
									   }
								}
							}
							
							var getDay1 ;
							
							if(busi_trip_frdt !="" && busi_trip_todt != "") {
								getDay1 =  getDay(busi_trip_frdt, busi_trip_todt);
							}
							if(getDay1 == 0) { 
								var_date_err = var_date_err + 1 ; 
							}
						}

						if (var_date_err > 0 ) {
							alert("선택된 데이터 중 날짜가 잘못된 데이터가 있습니다.");
							return;       
						}	
						
						/*if (var_date_dup > 0 ) {
							alert("선택된 데이터 중 중복된 데이터가 있습니다.");
							return;       
						}*/
					       					       						
	 					if (window.alert("등록하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						/*
						for(var i=1;i<datagrid2.rows;i++) {
							var status = datagrid2.rowstatus(i);

							if(status == 0){
								datagrid2.addStatus(i, "update"); 
							}
						}
						*/
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_trip_1704");
	
						if (submit_completed()) {
							model1.resetInstanceNode("/root/resData/gridData/record");
							model1.refresh();
							datagrid2.addStatus(1, "insert");	
							datagrid2.clearStatus();
							button3.dispatch("onclick");
							//alert("신청되었습니다.");
							//model1.reset();
							//datagrid2.addStatus(1, "insert");	
							//datagrid2.clearStatus();
						}
					]]>
				</script>
			</button>
			<button id="button3" class="btn02" style="left:388px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
//						datagrid2.clearStatus();
//						model1.reset();					
//						model1.removenode("/root/resData/gridData");
//						model1.makeNode("/root/resData/gridData");	
						model1.send("hd_trip_1703");
						model1.copyNode("/root/resData/gridData","/root/tempData");
						model1.removenode("/root/tempData");
						
//						for (i = 0; i < datagrid2.rows; i++) {
//	 						datagrid2.isReadOnly(1, 1, 1, 13) = false;
////							datagrid2.isReadOnly(i, 3) = true;
//						}
//						
						datagrid2.clearStatus();
						check_reset();
						gridrowcnt.value = "총 "+ model.getValue("/root/resData/gridData/totalcnt") + "건";
						datagrid2.rebuild();
						model1.refresh();
						for (i = 1; i < datagrid2.rows; i++) {
							//if (datagrid2.valueMatrix(i, datagrid2.colRef("proc_clsf")) == "16") 120207
							if (datagrid2.valueMatrix(i, datagrid2.colRef("proc_clsf")) == model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_proc_clsf_030"))
								datagrid2.isReadOnly(i, 1, i, 1) = true;
							else
								datagrid2.isReadOnly(i, 1, i, 1) = false;
						}
					]]>
				</script>
			</button>
			<button id="button6" class="btn04" style="left:784px; top:0px; width:87px; height:21px; ">
				<caption>엑셀다운로드</caption>
				<script type="javascript" ev:event="DOMActivate">
					<![CDATA[
					//excel 파일로 저장한다
					    var filePath = window.fileDialog("save", "", false, "", "xls", "Excel Files(*.xls)|*.xls");
					      
					    if(filePath != "") {
					     datagrid2.saveExcel(filePath);
					     window.exec(filePath);
					    }
					]]>
				</script>
			</button>
			<button id="button2" class="btn02" style="left:443px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (!rowDelSubmit(datagrid2)) {
							return;
						}
						/*
						for(var i = 1; i < datagrid2.rows; i++){
							if(model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf") != ""){
								datagrid2.rowStatus(i) = 0;
							}
						}
						*/
	 					if (window.alert("삭제하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_trip_1702");

						if (submit_completed()) {
							//model1.reset();
							model1.resetInstanceNode("/root/resData/gridData/record");
							model1.refresh();
							datagrid2.addStatus(1, "insert");	
							datagrid2.clearStatus();
							button3.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="button4" class="btn03" style="left:621px; top:0px; width:65px; height:21px; ">
				<caption>장표출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (datagrid2.rows < 2) {
							alert("출력할 대상이 없습니다.");
							return;
						}	
						var i =0, var_check_row = 0, var_date_err =0 ,var_date_dup =0, var_proc_cnt =0;
						var var_proc_clsf = ""  ;

						for (i=1; i<datagrid2.rows; i++) {
				 			if (datagrid2.rowStatus(i) != 0) {
								var_check_row = var_check_row + 1;
								var_proc_clsf = datagrid2.valueMatrix(i,  datagrid2.colRef("proc_clsf"));
								//if(var_proc_clsf != "20")  { 120207
								if(var_proc_clsf != model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_proc_clsf_010"))  {
									var_proc_cnt = var_proc_cnt +1;
								}								
							}
						}
						if (var_check_row == 0) {
							alert("출력할 대상이 없습니다.");
							return;       
						}	
						if (var_proc_cnt > 0) {
							alert("저장 또는 등록 처리할 데이터를 확인하십시오. 결재가 진행된 상태이거나 인사금액확정 상태가 아닙니다.");
							return;       
						}					       			       						
	 					
	 					//for (var i=1; i<datagrid2.rows; i++){
							//if (datagrid2.valueMatrix(i, datagrid2.colRef("chkbox")) == 1){
								// 20만 현업발행(16)으로 수정
								//if(model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf") == "20"){
									
									
									//model1.setValue("/root/reqData/mode_gubun", "16"); 120207
									model1.setValue("/root/reqData/mode_gubun", model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_mode_gubun_010"));
									model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
									model1.send("hd_trip_1109");
									
									
								//}
							//}
						//}	
						
						//if (submit_completed()) {
							var emp_no_list = "";
							for(var i = 1;  i< datagrid2.rows; i++) {
								var chk = datagrid2.valueMatrix(i, datagrid2.colRef("chkbox"));
								if(chk == "1") {
									emp_no_list += datagrid2.valueMatrix(i, datagrid2.colRef("emp_no")) + 
													datagrid2.valueMatrix(i, datagrid2.colRef("occr_dt")) + 
													datagrid2.valueMatrix(i, datagrid2.colRef("seq"));
										
									if(i != (datagrid2.rows-1) ){
										emp_no_list += "_";
									}
								}
							}
							
							resetOznode();												//오즈node 초기화
							makeNodeValue("/root/oz_data/ozrName","hd/SP_HD_TRIP_1710_P");	//odi 파일경로('/' root경로 제외)
							makeNodeValue("/root/oz_data/preview","preview"); 				//preview : 미리보기, print : 인쇄
							makeNodeValue("/root/oz_data/printsize","B5 (JIS)");  				 //페이지용지설정(기본 A4)
							
							//Parameter setting
							makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , getProperty("ss_cmpycd") );	
							makeNodeValue("/root/oz_data/odiParam/iv_total",emp_no_list);				
							
							openOzwin("/root/oz_data");
							
							model1.resetInstanceNode("/root/resData/gridData/record");
							model1.refresh();
							datagrid2.addStatus(1, "insert");	
							datagrid2.clearStatus();
							button3.dispatch("onclick");
						//}
					]]>
				</script>
			</button>
			<button id="button8" class="btn04" disabled="true" style="left:690px; top:0px; width:88px; height:21px; ">
				<caption>장표재출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (datagrid2.rows < 2) {
							alert("출력할 대상이 없습니다.");
							return;
						}	
						var i =0, var_check_row = 0, var_date_err =0 ,var_date_dup =0, var_proc_cnt =0;
						var var_proc_clsf = ""  ;

						for (i=1; i<datagrid2.rows; i++) {
				 			var_proc_clsf = datagrid2.valueMatrix(i,  datagrid2.colRef("proc_clsf"));
							//if(var_proc_clsf != "16")  { 120207
							if(var_proc_clsf != model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_proc_clsf_030"))  {
								var_proc_cnt = var_proc_cnt +1;
							}
						}
						if (var_proc_cnt > 0) {
							alert("진행상태를 현업발행으로 하고 조회버튼 누르세요. \n현업발행 상태가 아닌 데이터가 있습니다.");
							return;       
						}					       			       						
	 					
						var emp_no_list = "";
						for(var i = 1;  i< datagrid2.rows; i++) {
							var chk = datagrid2.valueMatrix(i, datagrid2.colRef("proc_clsf"));
							//if(chk == "16") { 120207
							if(chk == model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_proc_clsf_030")) {
								emp_no_list += datagrid2.valueMatrix(i, datagrid2.colRef("emp_no")) + 
												datagrid2.valueMatrix(i, datagrid2.colRef("occr_dt")) + 
												datagrid2.valueMatrix(i, datagrid2.colRef("seq"));
									
								if(i != (datagrid2.rows-1) ){
									emp_no_list += "_";
								}
							}
						}
						
						resetOznode();												//오즈node 초기화
						makeNodeValue("/root/oz_data/ozrName","hd/SP_HD_TRIP_1710_P");	//odi 파일경로('/' root경로 제외)
						makeNodeValue("/root/oz_data/preview","preview"); 				//preview : 미리보기, print : 인쇄
						makeNodeValue("/root/oz_data/printsize","B5 (JIS)");  				 //페이지용지설정(기본 A4)
						
						//Parameter setting
						makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , getProperty("ss_cmpycd") );	
						makeNodeValue("/root/oz_data/odiParam/iv_total",emp_no_list);				
						
						openOzwin("/root/oz_data");
						
//						model1.resetInstanceNode("/root/resData/gridData/record");
//						model1.refresh();
//						datagrid2.addStatus(1, "insert");	
//						datagrid2.clearStatus();
//						button3.dispatch("onclick");
					]]>
				</script>
			</button>
		</group>
		<group id="group_scr" class="gro_sel" style="left:10px; top:61px; width:926px; height:26px; ">
			<caption id="caption3" class="list_cap02" style="left:84px; top:0px; width:840px; height:25px; text-align:center; "/>
			<caption id="caption18" class="list_cap01" style="left:270px; top:0px; width:85px; height:25px; text-align:center; ">파견기간</caption>
			<input id="busi_trip_frdt" ref="/root/reqData/searchData/busi_trip_frdt" inputtype="date" format="yyyy-mm-dd" appearance="input" style="left:359px; top:4px; width:107px; height:18px; "/>
			<caption id="caption11" style="left:467px; top:6px; width:25px; height:15px; text-align:center; ">~</caption>
			<input id="busi_trip_todt" ref="/root/reqData/searchData/busi_trip_todt" inputtype="date" format="yyyy-mm-dd" appearance="input" style="left:491px; top:4px; width:102px; height:18px; "/>
			<select1 id="combo1" ref="/root/reqData/searchData/stay_clsf" appearance="minimal" style="left:687px; top:4px; width:125px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/proc_stat/item">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var tmp = combo1.value;
						//if (tmp = "16"){//현업발행 120207
						if (tmp = model1.getValue("/root/initData/hd_trip_1705_m/dataSet/xx_proc_clsf_030")){//현업발행
							button8.disabled = false;
						}
					]]>
				</script>
			</select1>
			<caption id="caption1" class="list_cap01" style="left:597px; top:0px; width:85px; height:25px; text-align:center; ">진행상태</caption>
			<caption id="caption2" class="list_cap01" style="left:0px; top:0px; width:85px; height:25px; text-align:center; ">부     서</caption>
			<select1 id="combo2" ref="/root/reqData/searchData/dept_cd" appearance="minimal" style="left:88px; top:4px; width:177px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dept_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
		</group>
		<caption id="gridrowcnt" style="left:835px; top:705px; width:100px; height:20px; font-weight:bold; text-align:right; "/>
	</xhtml:body>
</xhtml:html>
