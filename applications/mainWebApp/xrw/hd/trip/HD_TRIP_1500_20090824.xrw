<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<busi_trip_fee_burd_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</busi_trip_fee_burd_clsf>
							<!-- 선택계열의 정보를 담당 -->
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<!-- 검색조건 처리 -->
						<reqForm>
							<emp_no/>
							<nm_korn/>
							<dept_nm/>
							<dept_cd/>
							<cmpy_cd/>
							<dty_cd/>
							<dty_nm/>
							<together_clsf>10</together_clsf>
							<busi_trip_dest/>
							<busi_trip_purp/>
							<busi_trip_frdt/>
							<busi_trip_todt/>
							<busi_trip_dds/>
							<invit_instt/>
							<busi_trip_fee_burd_clsf/>
							<busi_trip_neces/>
							<aviat_fee/>
							<stay_fee/>
							<dd_fee/>
							<aviat_fee_yn/>
							<stay_fee_yn/>
							<dd_fee_yn/>
							<ceph_use_yn/>
							<posi_nm/>
							<posi_cd/>
							<fix_aviat_fee/>
							<adjm_aviat_fee/>
							<fix_stay_fee/>
							<adjm_stay_fee/>
							<fix_dd_fee/>
							<adjm_dd_fee/>
							<cost_fix_clsf/>
							<chk1/>
						</reqForm>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<!-- MultiUpDate유형 사용시 처리 -->
						<searchData>
							<emp_no/>
							<nm_korn/>
							<together_clsf>10</together_clsf>
							<proc_stat_clsf>10</proc_stat_clsf>
						</searchData>
						<fwdData>
							<func_nm/>
							<cmpy_cd/>
							<occr_dt/>
							<seq/>
							<emp_no/>
						</fwdData>
						<multiUpData/>
						<multiUpData2/>
						<multiUpData3/>
						<paidhodyData>
							<paidhody_cnt/>
						</paidhodyData>
						<subSearchData>
							<cmpy_cd/>
							<occr_dt/>
							<seq/>
							<with_seq/>
							<emp_no/>
						</subSearchData>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<temp/>
						</resForm>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<msg/>
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<record>
								<cmpy_cd/>
								<emp_no/>
								<occr_dt/>
								<seq/>
								<with_seq/>
								<flnm/>
								<dept_cd/>
								<dept_nm/>
								<dty_cd/>
								<dty_nm/>
								<posi_cd/>
								<posi_nm/>
								<busi_trip_purp/>
								<busi_trip_dest/>
								<busi_trip_frdt/>
								<busi_trip_todt/>
								<busi_trip_dds/>
								<invit_instt/>
								<busi_trip_fee_burd_clsf/>
								<busi_trip_fee_burd_clsf_nm/>
								<busi_trip_neces/>
								<aviat_fee/>
								<stay_fee/>
								<dd_fee/>
								<ceph_use_yn/>
								<busi_trip_fee_stot/>
								<remk/>
								<proc_stat/>
								<genl_affrs_clsf/>
								<proc_stat_nm/>
								<cost_fix_cnt/>
								<cost_cnt/>
							</record>
						</gridData>
						<gridData2>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<record>
								<g_emp_no/>
								<g_cmpy_cd/>
								<g_occr_dt/>
								<g_seq/>
								<g_with_seq/>
								<g_dept_cd/>
								<g_nm_korn/>
								<g_dty_nm/>
								<g_dty_cd/>
								<g_dept_nm/>
								<g_posi_nm/>
								<g_posi_cd/>
								<g_cost_fix_clsf/>
							</record>
							<!-- datagrid2 -->
							<!-- datagrid3 -->
						</gridData2>
						<gridData3>
							<record>
								<e_cmpy_cd/>
								<e_emp_no/>
								<e_occr_dt/>
								<e_seq/>
								<e_sub_seq/>
								<e_etc_cost_ptcr/>
								<e_etc_cost/>
								<e_etc_cost_neces/>
								<e_fix_etc_cost/>
								<e_adjm_etc_cost/>
							</record>
						</gridData3>
						<gridData4>
							<record>
								<d_cmpy_cd/>
								<d_emp_no/>
								<d_occr_dt/>
								<d_seq/>
								<d_sub_seq/>
								<d_start_area/>
								<d_midl_start_dt/>
								<d_dest/>
								<d_busi_trip_cont/>
							</record>
						</gridData4>
						<empData>
							<cmpy_cd/>
							<emp_no/>
							<nm_korn/>
							<dept_cd/>
							<dept_nm/>
							<dty_nm/>
							<dty_cd/>
							<posi_nm/>
							<posi_cd/>
						</empData>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
				
					var mode = "";
				
					function DateDemo()
					{
						var s="";
						var mydate=new Date() 
						var year=mydate.getYear() 
						    if (year < 1000) 
						        year+=1900 
						
						var day=mydate.getDay() 
						var month=mydate.getMonth()+1 
						    if (month<10) 
						        month="0"+month 
						
						var daym=mydate.getDate() 
						    if (daym<10) 
						        daym="0"+daym 
						s  = year+month;
					       return(s);
					}
					
					// 동행 검색 
					function setGridEmpInfo(emp_no, nm_korn)
					{
						var n_row = datagrid2.row;
						
						model1.setValue("/root/reqData/searchData/emp_no",emp_no);
						model1.send("hd_trip_1301");
						
						model1.copyNode("/root/resData/empData","/root/tempData/trip_person/record");

						var dept_cd = model1.getValue("/root/resData/empData/dept_cd");
						var dept_nm = model1.getValue("/root/resData/empData/dept_nm");
						var emp_no = model1.getValue("/root/resData/empData/emp_no");
						var nm_korn = model1.getValue("/root/resData/empData/nm_korn");
						var posi_nm = model1.getValue("/root/resData/empData/posi_nm");
						var posi_cd = model1.getValue("/root/resData/empData/posi_cd");
						var dty_nm = model1.getValue("/root/resData/empData/dty_nm");
						var dty_cd = model1.getValue("/root/resData/empData/dty_cd");
						
						var cmpy_cd = model1.getValue("/root/resData/empData/cmpy_cd");
						alert("n_row="+n_row);
						alert("cmpy_cd="+cmpy_cd);
					
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_cmpy_cd", cmpy_cd);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_dept_cd", dept_cd);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_dept_nm", dept_nm);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_emp_no", emp_no);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_nm_korn", nm_korn);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_posi_nm", posi_nm);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_posi_cd", posi_cd);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_dty_nm", dty_nm);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_dty_cd", dty_cd);
						
						datagrid2.refresh();
					}
					
					// 출장자 검색
					function setEmpInfo(emp_no, nm_korn)
					{
						model1.setValue("/root/reqData/searchData/emp_no", emp_no);
						model1.setValue("/root/reqData/searchData/nm_korn", nm_korn);
						
						model1.send("hd_trip_1301");
						
						model1.copyNode("/root/resData/empData","/root/tempData/trip_person/record");
						
						var dept_cd = model1.getValue("/root/resData/empData/dept_cd");
						var dept_nm = model1.getValue("/root/resData/empData/dept_nm");
						var emp_no = model1.getValue("/root/resData/empData/emp_no");
						var nm_korn = model1.getValue("/root/resData/empData/nm_korn");
						var posi_nm = model1.getValue("/root/resData/empData/posi_nm");
						var posi_cd = model1.getValue("/root/resData/empData/posi_cd");
						var dty_nm = model1.getValue("/root/resData/empData/dty_nm");
						var dty_cd = model1.getValue("/root/resData/empData/dty_cd");
						
						var cmpy_cd = model1.getValue("/root/resData/empData/cmpy_cd");
						
						
						model1.setValue("/root/reqData/reqForm/cmpy_cd", cmpy_cd);
						model1.setValue("/root/reqData/reqForm/dept_cd", dept_cd);
						model1.setValue("/root/reqData/reqForm/dept_nm", dept_nm);
						model1.setValue("/root/reqData/reqForm/emp_no", emp_no);
						model1.setValue("/root/reqData/reqForm/nm_korn", nm_korn);
						model1.setValue("/root/reqData/reqForm/posi_nm", posi_nm);
						model1.setValue("/root/reqData/reqForm/posi_cd", posi_cd);
						model1.setValue("/root/reqData/reqForm/dty_nm", dty_nm);
						model1.setValue("/root/reqData/reqForm/dty_cd", dty_cd);
						
						
						model1.refresh();
					}

					function check_reset(){
						var col = datagrid1.fixedCols;
						var rows = datagrid1.rows;
						for( i = datagrid1.fixedRows ; i <= rows ; i++){
							datagrid1.valueMatrix(i,col) = "false";
						}
						check_all.value = "";
					}					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					// 체크박스 
					datagrid1.fixedcellcheckbox(0, datagrid1.colRef("chkbox"), false) = true;
					// 체크박스 
					datagrid2.fixedcellcheckbox(0, datagrid2.colRef("g_cost_fix_clsf"), false) = true;
					
					model1.removenode("/root/resData/gridData/record[1]");
					model1.removenode("/root/resData/gridData2/record[1]");
					model1.removenode("/root/resData/gridData3/record[1]");
					model1.removenode("/root/resData/gridData4/record[1]");					

					model1.refresh();
			]]>
			</script>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<submission id="hd_co_1000" action="/hd/co/1000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_trip_1500" action="/hd/trip/1500" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1501" action="/hd/trip/1501" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/subSearchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1502" action="/hd/trip/1502" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/subSearchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1503" action="/hd/trip/1503" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_trip_1504" action="/hd/trip/1504" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
		</model>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="800" guideline="1,9;" style="font-family:굴림; ">
		<group id="group_scr" class="gro_sel" style="left:10px; top:76px; width:926px; height:26px; ">
			<caption id="caption10" class="list_cap02" style="left:104px; top:0px; width:820px; height:25px; text-align:center; "/>
			<caption id="caption9" class="list_cap01" style="left:0px; top:0px; width:105px; height:25px; text-align:center; ">작업구분</caption>
			<select1 id="combo1" ref="/root/reqData/searchData/proc_stat_clsf" appearance="minimal" style="left:111px; top:4px; width:100px; height:18px; ">
				<choices>
					<item>
						<label>신청대상</label>
						<value>10</value>
					</item>
					<item>
						<label>전체</label>
						<value>20</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
								
							
					]]>
				</script>
			</select1>
		</group>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" scroll="auto" caption="선택^부서^사번^성명^직책^직급^출발시작일자^출발종료일자^목적지^초청기관^여비부담구분^진행상태^신청보기^caption1^caption2^caption3^caption4" colsep="#" colwidth="51, 80, 70, 70, 70, 70, 90, 90, 100, 100, 120, 90, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:10px; top:135px; width:924px; height:145px; ">
			<col checkvalue="1,0" ref="chkbox" type="checkbox"/>
			<col ref="dept_nm"/>
			<col ref="emp_no"/>
			<col ref="nm_korn"/>
			<col ref="dty_nm"/>
			<col ref="posi_nm"/>
			<col ref="busi_trip_frdt" format="yyyy-mm-dd"/>
			<col ref="busi_trip_todt" format="yyyy-mm-dd"/>
			<col ref="busi_trip_purp"/>
			<col ref="invit_instt"/>
			<col ref="busi_trip_fee_burd_clsf_nm"/>
			<col ref="proc_stat_nm"/>
			<col ref="proc_stat_view" style="background-image:../../../images/btn_s_5.gif; ">
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
					datagrid2.clearStatus();
					datagrid3.clearStatus();
					datagrid4.clearStatus();

					var selectedIdx = datagrid1.row;
					var col = datagrid1.col;
					
					var cmpy_cd = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/cmpy_cd");
					var occr_dt = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/occr_dt");
					var seq = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/seq");
					var emp_no = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/emp_no");


					model.setValue("/root/reqData/fwdData/cmpy_cd", cmpy_cd);																																						
					model.setValue("/root/reqData/fwdData/occr_dt", occr_dt);
					model.setValue("/root/reqData/fwdData/seq", seq);
					model.setValue("/root/reqData/fwdData/emp_no", emp_no);
					
					window.load("/xrw/hd/trip/HD_TRIP_1510.xrw","modal","","caption:hidden;align:center;width:1000px; height:1000px;","/root/reqData/fwdData","/root/reqData/fwdData");
				]]>
				</script>
			</col>
			<col ref="cmpy_cd" visibility="hidden"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="with_seq" visibility="hidden"/>
			<col ref="occr_dt" visibility="hidden"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					
					var selectedIdx = datagrid1.row;
					var col = datagrid1.col;
					
					
//					if(col != 1 && col != 10) 
					if(datagrid1.col != datagrid1.colRef("chkbox") && datagrid1.col != datagrid1.colRef("proc_stat_view"))
					{
						var cmpy_cd = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/cmpy_cd");
						var occr_dt = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/occr_dt");
						var seq = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/seq");
						var cost_fix_cnt  = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/cost_fix_cnt");
						var cost_cnt = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/cost_cnt");
	
						model1.setValue("/root/reqData/subSearchData/cmpy_cd", cmpy_cd);
						model1.setValue("/root/reqData/subSearchData/occr_dt", occr_dt);
						model1.setValue("/root/reqData/subSearchData/seq",seq);
						
						if(cost_fix_cnt==cost_cnt){
							datagrid2.fixedcellischeck(0, datagrid2.colRef("g_cost_fix_clsf")) = true;
						}else{
							datagrid2.fixedcellischeck(0, datagrid2.colRef("g_cost_fix_clsf")) = false;
						}	
						
						model1.send("hd_trip_1502");
						
						model1.copyNode("/root/reqData/reqForm","/root/tempData/CURLIST/record");
						model1.copyNode("/root/resData/gridData2","/root/tempData/CURLIST2");
						model1.copyNode("/root/resData/gridData4","/root/tempData/CURLIST3");
						model1.copyNode("/root/resData/gridData3","/root/tempData/CURLIST4");
						model1.refresh();
	
						mode="U";
								
						for(var i=1;i<datagrid2.rows;i++) {
							datagrid2.isReadOnly(i, 1, i, 4)  =true;
						}
						
						datagrid3.isReadOnly(1, 1, 1, 3)  =false;
						datagrid4.isReadOnly(1, 1, 1, 4)  =false;
					}
			]]>
			</script>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
				var row = datagrid1.row;
				if(datagrid1.fixedcellischeck(0,datagrid1.colRef("chkbox")) == true && row==0){
					for(var i=1;i<datagrid1.rows;i++) {
						if(datagrid1.valueMatrix(i, datagrid1.colRef("chkbox")) == 1) {
							var status = datagrid1.rowstatus(i);
							
							if(status=="0" ||  status=="7"){
								datagrid1.rowstatus(i) = 2;	
							}
						}
					}
				}	
			
			 	datagrid1.refresh();

				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[
				var row = datagrid1.row;
				
				if(datagrid1.fixedcellischeck(0,datagrid1.colRef("chkbox")) == false && row==0){
					for(var i=1;i<datagrid1.rows;i++) {
						if(datagrid1.valueMatrix(i, datagrid1.colRef("chbox")) == 0) {
							var status = datagrid1.rowstatus(i); 
							if(status=="2"){
								datagrid1.rowstatus(i) = 7;	
							}
						}
					}	
					datagrid1.refresh();	
				}
				 // 각 체크박스 체크 시
				var status = datagrid1.rowstatus(row);

				if(datagrid1.valueMatrix(row, datagrid1.colRef("chbox")) == 0) {
					if(status=="2"){
						datagrid1.rowStatus(row) = 7;				
						datagrid1.refresh();
					}
				}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var row =datagrid1.row;					


				if(datagrid1.col==datagrid1.colRef("chkbox")) {  

					if(datagrid1.valueMatrix(row, datagrid1.colRef("chkbox"))=="1"){

						datagrid1.rowStatus(row) = 2;
					}else if(datagrid1.valueMatrix(row, datagrid1.colRef("chkbox"))=="0"){

						datagrid1.rowStatus(row) = 0;

					}		
				} else {
						if(datagrid1.rowStatus(row)=="3" ) {
							datagrid1.valueMatrix(row, datagrid1.colRef("chkbox")) = "1";
						} else {
							datagrid1.valueMatrix(row, datagrid1.colRef("chkbox")) = "1";
							datagrid1.rowStatus(row) = 2;
						}
				}

				datagrid1.refresh();
				]]>
			</script>
			<!--
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var row =datagrid1.row;					

				if(datagrid1.rowStatus(row)=="3") {
					datagrid1.valueMatrix(row, datagrid1.colRef("chkbox")) = "true";
				} else {
					if(datagrid1.col==datagrid1.colRef("chkbox")) {  
						if(datagrid1.valueMatrix(row, datagrid1.colRef("chkbox"))=="true"){
							datagrid1.valueMatrix(row, datagrid1.colRef("chkbox")) = "true";
							datagrid1.rowStatus(row) = 2;
						}else if(datagrid1.valueMatrix(row, datagrid1.colRef("chkbox"))=="false"){
							datagrid1.valueMatrix(row, datagrid1.colRef("chkbox")) = "false";
							datagrid1.rowStatus(row) = 0;
						}		
					} else {
						datagrid1.valueMatrix(row, datagrid1.colRef("chkbox")) = "true";
						datagrid1.rowStatus(row) = 2;
					}				
				}				
				]]>
			</script>
-->
		</datagrid>
		<group id="group_btnG1" class="gro_btn" style="left:10px; top:110px; width:926px; height:20px; ">
			<caption id="caption26" class="tit02" style="left:2px; top:0px; width:335px; height:20px; font-weight:bold; ">출장내역</caption>
			<button id="button4" class="btn_grid04" style="left:815px; top:0px; width:67px; height:17px; ">
				<caption>임시저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var temp = model1.getValue("/root/resData/resForm/temp");
					

						var selectedIdx = datagrid2.rows-1;
					
						model1.makeNode("/root/reqData/reqForm/mode");
						model1.setValue("/root/reqData/reqForm/mode",mode);
						
						if(!commGridReqCheck("datagrid2")) return;
						
						var nm_korn = model1.getValue("/root/reqData/reqForm/nm_korn");
							
							
						if(nm_korn == "") {
							alert("저장 할 데이터를 선택후 저장하십시요.");
							return;
						}
						
						 
	 					if (window.alert(nm_korn+"님의 내역을 저장하시겠습니까?", "확인", 1) != 1) {
							return;
						}

						var g_emp_no = model1.getValue("/root/resData/gridData2/record[1]/g_emp_no");
						if(g_emp_no==""){
							alert("출장내역을 선택해주세요.");
							return;
						}
						
						
						for(var i=1;i<datagrid2.rows;i++) {
							var status = datagrid2.rowstatus(i);

							if(status == 0){
								datagrid2.addStatus(i, "update"); 
							}
						}
						
						
						for(var i=1;i<datagrid3.rows;i++) {
						var status = datagrid3.rowstatus(i);

							if(status == 0){
								datagrid3.addStatus(i, "update"); 
							}
						}
						
						
						for(var i=1;i<datagrid4.rows;i++) {
						var status = datagrid4.rowstatus(i);

							if(status == 0){
								datagrid4.addStatus(i, "update"); 
							}
						}
					
					
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.setValue("/root/reqData/multiUpData2", datagrid3.getUpdateData());
						model1.setValue("/root/reqData/multiUpData3", datagrid4.getUpdateData());
						model1.send("hd_trip_1503");
	
						if(submit_completed()) {
							//alert("저장되었습니다.");
							model1.reset();
							
							datagrid1.clearStatus();
							datagrid2.clearStatus();
							datagrid3.clearStatus();
							datagrid4.clearStatus();
							
							model1.send("hd_trip_1500");
							model1.copyNode("/root/resData/gridData","/root/tempData");
							
							model1.refresh();
		
							input5.disabled = false;
							input7.disabled = false
							
								
							datagrid2.isReadOnly(1, 1, 1, 4)  =true;
							datagrid3.isReadOnly(1, 1, 1, 3)  =true;
							datagrid4.isReadOnly(1, 1, 1, 4)  =true;
							
							combo1.refresh();
							mode="I";
						}
					]]>
				</script>
			</button>
			<button id="button9" class="btn_grid02" style="left:882px; top:0px; width:42px; height:17px; ">
				<caption>신청</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							var cnt = 0;
							for(var i=1;i<datagrid1.rows;i++) {
								if(datagrid1.valueMatrix(i, datagrid1.colRef("chkbox")) == "true" ) {
									cnt ++;
								}
							}
							if (cnt == 0) { alert("신청할 내역을 선택후 신청하십시요 ."); return ; }
							
		 					if (window.alert("신청하시겠습니까?", "확인", 1) != 1) {
								return;
							}

							var cost_fix_ck = false;

							for(var i=1;i<datagrid1.rows;i++) {
								var cost_fix_cnt = model1.getValue("/root/resData/gridData/record[" + i + "]/cost_fix_cnt");
								var cost_cnt 	= model1.getValue("/root/resData/gridData/record[" + i + "]/cost_cnt");

								if(datagrid1.valueMatrix(i, datagrid1.colRef("chkbox")) == "true"  && cost_fix_cnt != cost_cnt){
									cost_fix_ck = true;
									break;
								}
							}

							if(cost_fix_ck==true){
								alert("경비확정 전체 체크를 해주세요.");
								return;	
								
							}
							
//							for(var i=1;i<datagrid1.rows;i++) {
//								var status = datagrid1.rowstatus(i);
//
//								if(status == 0){
//									datagrid1.addStatus(i, "update"); 
//								}
//							}
							
							model1.setValue("/root/reqData/multiUpData", datagrid1.getUpdateData());
							model1.send("hd_trip_1504");
							
							if(submit_completed()) {
								//alert("신청되었습니다.");
								
								model1.reset();
								
								datagrid1.clearStatus();
								datagrid2.clearStatus();
								datagrid3.clearStatus();
								datagrid4.clearStatus();
							}
					
					]]>
				</script>
			</button>
		</group>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:43px; width:926px; height:21px; ">
			<button id="btnA1" class="btn02" style="left:765px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						
						model1.send("hd_trip_1500");
						model1.copyNode("/root/resData/gridData","/root/tempData");

						//datagrid1.clearStatus();
						//check_reset();
												
						model1.refresh();
	
						input5.disabled = false;
						input7.disabled = false
						
							
						datagrid2.isReadOnly(1, 1, 1, 4)  =true;
						datagrid3.isReadOnly(1, 1, 1, 3)  =true;
						datagrid4.isReadOnly(1, 1, 1, 4)  =true;
						
						combo1.refresh();
						mode="I";
				
					]]>
				</script>
			</button>
			<button id="btnA2" class="btn02" style="left:818px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model1.reset();
					]]>
				</script>
			</button>
			<button id="button7" class="btn02" style="left:874px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
				 	viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					]]>
				</script>
			</button>
		</group>
		<group id="group2" style="left:10px; top:290px; width:454px; height:20px; ">
			<caption id="caption15" class="tit02" style="left:0px; top:0px; width:449px; height:20px; font-weight:bold; ">출장사원별 경비확정</caption>
		</group>
		<datagrid id="datagrid4" nodeset="/root/resData/gridData4/record" scroll="auto" caption="일자^출발지^목적지^출장내용^caption2^caption3^caption4^caption1^caption5^caption6" colsep="#" colwidth="100, 200, 200, 400, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:10px; top:600px; width:924px; height:145px; ">
			<col ref="d_midl_start_dt" type="inputdate"/>
			<col ref="d_start_area" type="input"/>
			<col ref="d_dest" type="input"/>
			<col ref="d_busi_trip_cont" type="input"/>
			<col ref="d_cmpy_cd" visibility="hidden"/>
			<col ref="d_emp_no" visibility="hidden"/>
			<col ref="d_occr_dt" visibility="hidden"/>
			<col ref="d_seq" visibility="hidden"/>
			<col ref="d_sub_seq" visibility="hidden"/>
			<col ref="d_with_seq" visibility="hidden"/>
		</datagrid>
		<group id="group4" class="gro_btn" style="left:10px; top:580px; width:926px; height:20px; ">
			<caption id="caption37" class="tit02" style="left:2px; top:0px; width:335px; height:20px; font-weight:bold; ">출장계획</caption>
		</group>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData2/record" scroll="auto" caption="부서^사번^성명^직책^직급^경비확정^caption1^caption2^caption3^caption4^caption5^caption6^caption7^caption8" colsep="#" colwidth="100, 61, 64, 70, 71, 75, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:10px; top:315px; width:454px; height:257px; ">
			<col ref="g_dept_nm"/>
			<col ref="g_emp_no"/>
			<col ref="g_nm_korn">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model1.setValue("/root/reqData/fwdData/func_nm", "setGridEmpInfo");
						window.load("/xrw/hd/com/hd_com_1000.xrw","mdichild", "hd_com_1000", "", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
			</col>
			<col ref="g_dty_nm"/>
			<col ref="g_posi_nm"/>
			<col checkvalue="Y,N" ref="g_cost_fix_clsf" type="checkbox"/>
			<col ref="g_dept_cd" visibility="hidden"/>
			<col ref="g_dty_cd" visibility="hidden"/>
			<col ref="g_occr_dt" visibility="hidden"/>
			<col ref="g_seq" visibility="hidden"/>
			<col ref="g_with_seq" visibility="hidden"/>
			<col ref="g_posi_nm" visibility="hidden"/>
			<col ref="g_posi_cd" visibility="hidden"/>
			<col ref="g_cmpy_cd" visibility="hidden"/>
			<script type="javascript" ev:event="onendedit">
				<![CDATA[
						
					]]>
			</script>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
					var selectedIdx = datagrid2.row;
					var col = 	datagrid2.col;
					
					if(col != 6) {
					var cmpy_cd = model1.getValue("/root/resData/gridData2/record[" + selectedIdx + "]/g_cmpy_cd");
					var occr_dt = model1.getValue("/root/resData/gridData2/record[" + selectedIdx + "]/g_occr_dt");
					var seq = model1.getValue("/root/resData/gridData2/record[" + selectedIdx + "]/g_seq");
					var with_seq = model1.getValue("/root/resData/gridData2/record[" + selectedIdx + "]/g_with_seq");
					var emp_no = model1.getValue("/root/resData/gridData2/record[" + selectedIdx + "]/g_emp_no");

					model1.setValue("/root/reqData/subSearchData/cmpy_cd", cmpy_cd);
					model1.setValue("/root/reqData/subSearchData/occr_dt", occr_dt);
					model1.setValue("/root/reqData/subSearchData/seq",seq);
					model1.setValue("/root/reqData/subSearchData/with_seq",with_seq);
					model1.setValue("/root/reqData/subSearchData/emp_no",emp_no);
					
					model1.send("hd_trip_1501");
					
					model1.copyNode("/root/reqData/reqForm","/root/tempData/CURLIST/record");
//					model1.copyNode("/root/resData/gridData2","/root/tempData/CURLIST2");
					model1.copyNode("/root/resData/gridData4","/root/tempData/CURLIST3");
					model1.copyNode("/root/resData/gridData3","/root/tempData/CURLIST4");
					model1.refresh();

					mode="U";
							
					
					for(var i=1;i<datagrid2.rows;i++) {
						datagrid2.isReadOnly(i, 1, i, 4)  =true;
					}
					
					datagrid3.isReadOnly(1, 1, 1, 3)  =false;
					datagrid4.isReadOnly(1, 1, 1, 4)  =false;
					}
				]]>
			</script>
		</datagrid>
		<group id="group5" style="left:480px; top:290px; width:449px; height:20px; ">
			<caption id="caption1" class="tit02" style="left:0px; top:0px; width:445px; height:20px; font-weight:bold; ">본사부담출장비 / 정산</caption>
		</group>
		<group id="group6" style="left:480px; top:315px; width:449px; height:135px; ">
			<caption id="caption47" class="list_cap02" style="left:149px; top:105px; width:76px; height:26px; text-align:center; "/>
			<caption id="caption3" class="list_cap02" style="left:224px; top:105px; width:224px; height:26px; text-align:center; "/>
			<caption id="caption2" class="list_cap02" style="left:0px; top:40px; width:76px; height:26px; text-align:center; "/>
			<input id="input2" ref="/root/reqData/reqForm/aviat_fee" maxlength="10" format="#,###" appearance="input" style="left:5px; top:44px; width:65px; height:18px; text-align:right; "/>
			<caption id="caption5" class="list_cap01" style="left:0px; top:0px; width:225px; height:21px; text-align:center; ">항공비</caption>
			<caption id="caption11" class="list_cap01" style="left:224px; top:0px; width:225px; height:21px; text-align:center; ">숙박비</caption>
			<caption id="caption38" class="list_cap02" style="left:74px; top:40px; width:76px; height:26px; text-align:center; "/>
			<caption id="caption39" class="list_cap02" style="left:149px; top:40px; width:76px; height:26px; text-align:center; "/>
			<caption id="caption40" class="list_cap02" style="left:224px; top:40px; width:76px; height:26px; text-align:center; "/>
			<caption id="caption41" class="list_cap02" style="left:299px; top:40px; width:76px; height:26px; text-align:center; "/>
			<caption id="caption42" class="list_cap02" style="left:373px; top:40px; width:76px; height:26px; text-align:center; "/>
			<input id="input5" ref="/root/reqData/reqForm/fix_aviat_fee" maxlength="10" format="#,###" appearance="input" style="left:79px; top:44px; width:65px; height:18px; text-align:right; "/>
			<input id="input7" ref="/root/reqData/reqForm/adjm_aviat_fee" maxlength="10" format="#,###" appearance="input" style="left:155px; top:44px; width:65px; height:18px; text-align:right; "/>
			<input id="input8" ref="/root/reqData/reqForm/stay_fee" maxlength="10" format="#,###" appearance="input" style="left:229px; top:44px; width:65px; height:18px; text-align:right; "/>
			<input id="input13" ref="/root/reqData/reqForm/fix_stay_fee" maxlength="10" format="#,###" appearance="input" style="left:304px; top:44px; width:65px; height:18px; text-align:right; "/>
			<input id="input14" ref="/root/reqData/reqForm/adjm_stay_fee" maxlength="10" format="#,###" appearance="input" style="left:377px; top:44px; width:65px; height:18px; text-align:right; "/>
			<input id="input1" ref="/root/reqData/reqForm/adjm_dd_fee" maxlength="10" format="#,###" appearance="input" style="left:155px; top:109px; width:65px; height:18px; text-align:right; "/>
			<caption id="caption43" class="list_cap01" style="left:224px; top:65px; width:225px; height:41px; text-align:center; ">휴대폰 로밍</caption>
			<caption id="caption44" class="list_cap02" style="left:0px; top:105px; width:76px; height:26px; text-align:center; "/>
			<caption id="caption45" class="list_cap01" style="left:0px; top:65px; width:225px; height:21px; text-align:center; ">일비</caption>
			<caption id="caption46" class="list_cap02" style="left:74px; top:105px; width:76px; height:26px; text-align:center; "/>
			<input id="input18" ref="/root/reqData/reqForm/dd_fee" maxlength="10" format="#,###" appearance="input" style="left:5px; top:109px; width:65px; height:18px; text-align:right; "/>
			<input id="input19" ref="/root/reqData/reqForm/fix_dd_fee" maxlength="10" format="#,###" appearance="input" style="left:79px; top:109px; width:65px; height:18px; text-align:right; "/>
			<caption id="caption4" class="list_cap01" style="left:224px; top:20px; width:76px; height:21px; text-align:center; ">신청</caption>
			<caption id="caption6" class="list_cap01" style="left:299px; top:20px; width:76px; height:21px; text-align:center; ">확정</caption>
			<caption id="caption7" class="list_cap01" style="left:373px; top:20px; width:76px; height:21px; text-align:center; ">정산</caption>
			<caption id="caption8" class="list_cap01" style="left:0px; top:20px; width:76px; height:21px; text-align:center; ">신청</caption>
			<caption id="caption12" class="list_cap01" style="left:74px; top:20px; width:76px; height:21px; text-align:center; ">확정</caption>
			<caption id="caption13" class="list_cap01" style="left:149px; top:20px; width:76px; height:21px; text-align:center; ">정산</caption>
			<caption id="caption14" class="list_cap01" style="left:74px; top:85px; width:76px; height:21px; text-align:center; ">확정</caption>
			<caption id="caption17" class="list_cap01" style="left:149px; top:85px; width:76px; height:21px; text-align:center; ">정산</caption>
			<caption id="caption20" class="list_cap01" style="left:0px; top:85px; width:76px; height:21px; text-align:center; ">신청</caption>
		</group>
		<datagrid id="datagrid3" nodeset="/root/resData/gridData3/record" scroll="auto" caption="기타필요경비내역^예상액^예상액^예상액^(구체적)필요성^caption1^caption2^caption3^caption4^caption5^caption6|기타필요경비내역^신청^확정^정산^(구체적)필요성^caption1^caption2^caption3^caption4^caption5^caption6" colsep="#" colwidth="120, 50, 50, 50, 157, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="byrow" style="left:480px; top:450px; width:450px; height:121px; ">
			<col ref="e_etc_cost_ptcr" type="input"/>
			<col ref="e_etc_cost" type="input" format="#,###" maxlength="10"/>
			<col ref="e_fix_etc_cost" type="input" format="#,###" maxlength="10" style="left:190px; top:20px; width:50px; height:20px; "/>
			<col ref="e_adjm_etc_cost" type="input" format="#,###" maxlength="10"/>
			<col ref="e_etc_cost_neces" type="input"/>
			<col ref="e_cmpy_cd" visibility="hidden"/>
			<col ref="e_emp_no" visibility="hidden"/>
			<col ref="e_occr_dt" visibility="hidden"/>
			<col ref="e_seq" visibility="hidden"/>
			<col ref="e_sub_seq" visibility="hidden"/>
			<col ref="e_with_seq" visibility="hidden"/>
		</datagrid>
	</xhtml:body>
</xhtml:html>
