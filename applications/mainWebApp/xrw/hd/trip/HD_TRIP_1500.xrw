<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<busi_trip_fee_burd_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</busi_trip_fee_burd_clsf>
							<!-- 선택계열의 정보를 담당 -->
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<!-- 검색조건 처리 -->
						<reqForm>
							<aviat_fee/>
							<stay_fee/>
							<dd_fee/>
							<ceph_use_yn/>
							<fix_aviat_fee/>
							<adjm_aviat_fee/>
							<fix_stay_fee/>
							<adjm_stay_fee/>
							<fix_dd_fee/>
							<adjm_dd_fee/>
							<invit_dds/>
							<busi_trip_dds/>
							<adpay_no/>
							<adpay_amt/>
							<expn_reso_no/>
						</reqForm>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<!-- MultiUpDate유형 사용시 처리 -->
						<searchData>
							<emp_no/>
							<nm_korn/>
							<busi_frdt/>
							<busi_todt/>
							<dept_cd/>
							<dept_nm/>
						</searchData>
						<fwdData>
							<func_nm/>
							<cmpy_cd/>
							<occr_dt/>
							<seq/>
							<emp_no/>
						</fwdData>
						<multiUpData/>
						<multiUpData2/>
						<multiUpData3/>
						<paidhodyData>
							<paidhody_cnt/>
						</paidhodyData>
						<subSearchData>
							<cmpy_cd/>
							<occr_dt/>
							<seq/>
							<with_seq/>
							<emp_no/>
						</subSearchData>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<temp/>
						</resForm>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<msg/>
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<record>
								<dept_cd/>
								<dept_nm/>
								<emp_no/>
								<flnm/>
								<dty_cd/>
								<natn_nm/>
								<busi_trip_dest/>
								<via_area/>
								<busi_trip_frdt/>
								<busi_trip_todt/>
								<invit_dds/>
								<busi_trip_dds/>
								<fix_dd_fee/>
								<fix_stay_fee/>
								<fix_aviat_fee/>
								<fix_etc_cost/>
								<fix_cost_tot/>
								<adpay_no/>
								<adpay_amt/>
								<expn_reso_no/>
								<adjm_dd_fee/>
								<adjm_stay_fee/>
								<adjm_aviat_fee/>
								<adjm_etc_cost/>
								<adjm_cost_tot/>
								<minus_cost_tot/>
								<ceph_use_yn/>
								<ceph_use_nm/>
								<cmpy_cd/>
								<occr_dt/>
								<with_seq/>
								<seq/>
								<aviat_fee/>
								<stay_fee/>
								<dd_fee/>
							</record>
						</gridData>
						<gridData2>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<record>
								<g_emp_no/>
								<g_cmpy_cd/>
								<g_occr_dt/>
								<g_seq/>
								<g_with_seq/>
								<g_dept_cd/>
								<g_nm_korn/>
								<g_dty_nm/>
								<g_dty_cd/>
								<g_dept_nm/>
								<g_posi_nm/>
								<g_posi_cd/>
								<g_cost_fix_clsf/>
							</record>
							<!-- datagrid2 -->
							<!-- datagrid3 -->
						</gridData2>
						<gridData3>
							<record>
								<e_cmpy_cd/>
								<e_emp_no/>
								<e_occr_dt/>
								<e_seq/>
								<e_sub_seq/>
								<e_etc_cost_ptcr/>
								<e_etc_cost/>
								<e_etc_cost_neces/>
								<e_fix_etc_cost/>
								<e_adjm_etc_cost/>
							</record>
						</gridData3>
						<gridData4>
							<record>
								<d_cmpy_cd/>
								<d_emp_no/>
								<d_occr_dt/>
								<d_seq/>
								<d_sub_seq/>
								<d_start_area/>
								<d_midl_start_dt/>
								<d_dest/>
								<d_busi_trip_cont/>
							</record>
						</gridData4>
						<empData>
							<cmpy_cd/>
							<emp_no/>
							<nm_korn/>
							<dept_cd/>
							<dept_nm/>
							<dty_nm/>
							<dty_cd/>
							<posi_nm/>
							<posi_cd/>
						</empData>
						<totcnt/>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					function setDept_cd(iv_dept_cd, iv_dept_nm){
						model1.setValue("/root/reqData/searchData/dept_cd", iv_dept_cd);
						model1.setValue("/root/reqData/searchData/dept_nm", iv_dept_nm);
						model1.refresh();
					}
					function setEmp_no(emp_no, nm_korn){
						model1.setValue("/root/reqData/searchData/emp_no", emp_no);
						model1.setValue("/root/reqData/searchData/nm_korn", nm_korn);
						model1.refresh();
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					var now_date = new Date();
					var year = now_date.getYear();
					var month = now_date.getMonth() + 1;
					var day = now_date.getDate();    
					var month_tm = '0' + month;
					var day_tm = '0' + day;  
					if(month_tm.length == 3){
						month_tm = month_tm.substring(1, 3);
					}
					if(day_tm.length == 3){
						day_tm = day_tm.substring(1, 3);
					}
					var now_dt_sub = year + month_tm + "01";
					var now_dt = year + month_tm + commLastDay(year + month_tm);
					model1.setValue("/root/reqData/searchData/busi_todt", now_dt);
					model1.setValue("/root/reqData/searchData/busi_frdt", now_dt_sub);
					
					model1.removenode("/root/resData/gridData/record[1]");
					model1.removenode("/root/resData/gridData3/record[1]");
					model1.removenode("/root/resData/gridData4/record[1]");
					model1.refresh();
				]]>
			</script>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<submission id="hd_co_1000" action="/hd/co/1000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_trip_1500" action="/hd/trip/1500" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1501" action="/hd/trip/1501" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/subSearchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1502" action="/hd/trip/1502" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/subSearchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1503" action="/hd/trip/1503" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_trip_1504" action="/hd/trip/1504" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_com_1103" action="/hd/com/1103" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/dept_cd" resultref="/root/tempData"/>
		</model>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="1,9;" style="font-family:굴림; ">
		<group id="group_scr" class="gro_sel" style="left:10px; top:76px; width:926px; height:26px; ">
			<caption id="caption10" class="list_cap02" style="left:104px; top:0px; width:820px; height:25px; text-align:center; "/>
			<caption id="caption9" class="list_cap01" style="left:0px; top:0px; width:105px; height:25px; text-align:center; ">출장기간</caption>
			<input id="input3" ref="/root/reqData/searchData/busi_frdt" navindex="1" inputtype="date" style="left:107px; top:4px; width:91px; height:18px; "/>
			<input id="input4" ref="/root/reqData/searchData/busi_todt" navindex="2" inputtype="date" style="left:215px; top:4px; width:91px; height:18px; "/>
			<caption id="caption29" style="left:200px; top:9px; width:13px; height:10px; ">~</caption>
			<caption id="caption16" class="list_cap01" style="left:310px; top:0px; width:105px; height:25px; text-align:center; ">부      서</caption>
			<caption id="caption18" class="list_cap01" style="left:635px; top:0px; width:105px; height:25px; text-align:center; ">사번/성명</caption>
			<input id="input6" ref="/root/reqData/searchData/dept_cd" navindex="3" inputtype="button" maxlength="6" style="left:418px; top:4px; width:85px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						window.load("/xrw/hd/com/HD_COM_1100.xrw","mdichild", "hd_com_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="onmaxlength">
					<![CDATA[
						model1.setValue("/root/reqData/searchData/dept_cd", input6.currentText);
						model1.send("hd_com_1103");
						if(model1.getValue("/root/dataSet/CURLIST/record/cnt") != "1"){
							alert("없는 부서이거나 사용중이 아닌 부서 입니다.");
							model1.setValue("/root/reqData/searchData/dept_cd", "");
							model1.setValue("/root/reqData/searchData/dept_nm", "");
							model1.removenode("/root/dataSet");
							model1.refresh();
							return;
						}
						model1.setValue("/root/reqData/searchData/dept_cd", model1.getValue("/root/dataSet/CURLIST/record/dept_cd"));
						model1.setValue("/root/reqData/searchData/dept_nm", model1.getValue("/root/dataSet/CURLIST/record/abrv_nm"));
						model1.removenode("/root/dataSet");
						model1.refresh();		
					]]>
				</script>
			</input>
			<output id="input9" ref="/root/reqData/searchData/dept_nm" style="left:506px; top:4px; width:125px; height:18px; "/>
			<input id="input10" ref="/root/reqData/searchData/emp_no" navindex="4" inputtype="button" maxlength="6" style="left:743px; top:4px; width:75px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if (event.keyCode ==13){
						var emp_no = input10.currentText;
						model1.setValue("/root/reqData/searchData/emp_no", emp_no);
						model1.setValue("/root/reqData/searchData/nm_korn", "");
						
						setInfoSearchInput(emp_no, "", "", "setEmp_no"); // 사번, 성명, 주민번호
						if(model1.getValue("/root/tempData/totalcnt") != 1){
							return;
						} // 카운트
						model1.setValue("/root/reqData/searchData/emp_no", model1.getValue("/root/tempData/emp_no")); // 사번
						model1.setValue("/root/reqData/searchData/nm_korn", model1.getValue("/root/tempData/nm_korn")); // 성명
						model1.removenode("/root/tempData");
						model1.refresh();
					}
					]]>
				</script>
				<script type="javascript" ev:event="onmaxlength">
					<![CDATA[
						var emp_no = input10.currentText;
						model1.setValue("/root/reqData/searchData/emp_no", emp_no);
						model1.setValue("/root/reqData/searchData/nm_korn", "");
						
						setInfoSearchInput(emp_no, "", "", "setEmp_no"); // 사번, 성명, 주민번호
						if(model1.getValue("/root/tempData/totalcnt") != 1){
							return;
						} // 카운트
						model1.setValue("/root/reqData/searchData/emp_no", model1.getValue("/root/tempData/emp_no")); // 사번
						model1.setValue("/root/reqData/searchData/nm_korn", model1.getValue("/root/tempData/nm_korn")); // 성명
						model1.removenode("/root/tempData");
						model1.refresh();
					]]>
				</script>
			</input>
			<input id="input11" ref="/root/reqData/searchData/nm_korn" navindex="5" style="left:820px; top:4px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if (event.keyCode ==13){
						var nm_korn = input11.currentText;
						model1.setValue("/root/reqData/searchData/emp_no", "");
						model1.setValue("/root/reqData/searchData/nm_korn", nm_korn);
						
						setInfoSearchInput("", nm_korn, "", "setEmp_no"); // 사번, 성명, 주민번호
						if(model1.getValue("/root/tempData/totalcnt") != 1){
							return;
						} // 카운트
						model1.setValue("/root/reqData/searchData/emp_no", model1.getValue("/root/tempData/emp_no")); // 사번
						model1.setValue("/root/reqData/searchData/nm_korn", model1.getValue("/root/tempData/nm_korn")); // 성명
						model1.removenode("/root/tempData");
						model1.refresh();
					}
					]]>
				</script>
			</input>
		</group>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" scroll="auto" caption="부서^사번^성명^대표직급^출장국가^출장지역^경유지^출장시작일^출장종료일^초청일수^본사일수^출장목적^확정일비^확정숙박비^확적항공료^확정기타^확정합계^선급번호^선급액^지출결의번호^정산일비^정산숙박비^정산항공료^정산기타^실체출장비&#xA;(정산계)^차액(확정계&#xA;-정산계)^휴대폰사용|부서^사번^성명^대표직급^출장국가^출장지역^경유지^출장시작일^출장종료일^초청일수^본사일수^출장목적^확정일비^확정숙박비^확적항공료^확정기타^확정합계^선급번호^선급액^지출결의번호^정산일비^정산숙박비^정산항공료^정산기타^실체출장비&#xA;(정산계)^차액(확정계&#xA;-정산계)^휴대폰사용" colsep="#" colwidth="120, 70, 70, 70, 80, 100, 100, 80, 80, 30, 30, 150, 80, 80, 80, 80, 80, 80, 80, 100, 80, 80, 80, 80, 80, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:10px; top:135px; width:924px; height:145px; ">
			<col ref="dept_nm" style="text-align:left; "/>
			<col ref="emp_no"/>
			<col ref="flnm"/>
			<col ref="dty_cd"/>
			<col ref="natn_nm" style="text-align:left; "/>
			<col ref="busi_trip_dest" style="text-align:left; "/>
			<col ref="via_area" style="text-align:left; "/>
			<col ref="busi_trip_frdt" format="yyyy-mm-dd"/>
			<col ref="busi_trip_todt" format="yyyy-mm-dd"/>
			<col ref="invit_dds"/>
			<col ref="busi_trip_dds"/>
			<col ref="busi_trip_purp" style="text-align:left; "/>
			<col ref="fix_dd_fee" format="#,###" style="text-align:right; "/>
			<col ref="fix_stay_fee" format="#,###" style="text-align:right; "/>
			<col ref="fix_aviat_fee" format="#,###" style="text-align:right; "/>
			<col ref="fix_etc_cost" format="#,###" style="text-align:right; "/>
			<col ref="fix_cost_tot" format="#,###" style="text-align:right; "/>
			<col ref="adpay_no"/>
			<col ref="adpay_amt" format="#,###" style="text-align:right; "/>
			<col ref="expn_reso_no"/>
			<col ref="adjm_dd_fee" format="#,###" style="text-align:right; "/>
			<col ref="adjm_stay_fee" format="#,###" style="text-align:right; "/>
			<col ref="adjm_aviat_fee" format="#,###" style="text-align:right; "/>
			<col ref="adjm_etc_cost" format="#,###" style="text-align:right; "/>
			<col ref="adjm_cost_tot" format="#,###" style="text-align:right; "/>
			<col ref="minus_cost_tot" format="(-)#,###" style="text-align:right; "/>
			<col ref="ceph_use_nm"/>
			<col ref="ceph_use_yn" visibility="hidden"/>
			<col ref="dept_cd" visibility="hidden"/>
			<col ref="cmpy_cd" visibility="hidden"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="with_seq" visibility="hidden"/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="aviat_fee" visibility="hidden"/>
			<col ref="stay_fee" visibility="hidden"/>
			<col ref="dd_fee" visibility="hidden"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var selectedIdx = datagrid1.row - 1;
					var col = datagrid1.col;
					
					if(col == 0){
						rowStatus(datagrid1);
					}else if(col != 0){
						datagrid1.clearStatus();
						datagrid1.rowStatus(datagrid1.row) = "2";
						
						var cmpy_cd = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/cmpy_cd");
						var occr_dt = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/occr_dt");
						var with_seq = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/with_seq");
						var seq = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/seq");
						
						model1.setValue("/root/reqData/reqForm/invit_dds", model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/invit_dds"));			// 초청일수
						model1.setValue("/root/reqData/reqForm/busi_trip_dds", model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/busi_trip_dds"));		// 본사일수
						model1.setValue("/root/reqData/reqForm/adpay_no", model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/adpay_no"));			// 선급번호
						model1.setValue("/root/reqData/reqForm/adpay_amt", model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/adpay_amt"));		// 선급액
						model1.setValue("/root/reqData/reqForm/expn_reso_no", model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/expn_reso_no"));	// 지출결의번호
						model1.setValue("/root/reqData/reqForm/ceph_use_yn", model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/ceph_use_yn")); 	// 휴대폰사용
						model1.setValue("/root/reqData/reqForm/aviat_fee", model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/aviat_fee")); 			// 항공비 신청
						model1.setValue("/root/reqData/reqForm/fix_aviat_fee", model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/fix_aviat_fee")); 		// 항공비 확정
						model1.setValue("/root/reqData/reqForm/adjm_aviat_fee", model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/adjm_aviat_fee")); 	// 항공비 정산
						model1.setValue("/root/reqData/reqForm/stay_fee", model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/stay_fee")); 			// 숙박비 신청
						model1.setValue("/root/reqData/reqForm/fix_stay_fee", model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/fix_stay_fee")); 		// 숙박비 확정
						model1.setValue("/root/reqData/reqForm/adjm_stay_fee", model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/adjm_stay_fee")); 	// 숙박비 정산
						model1.setValue("/root/reqData/reqForm/dd_fee", model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/dd_fee")); 				// 일비 신청
						model1.setValue("/root/reqData/reqForm/fix_dd_fee", model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/fix_dd_fee")); 			// 일비 확정
						model1.setValue("/root/reqData/reqForm/adjm_dd_fee", model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/adjm_dd_fee")); 		// 일비 정산
	
						model1.setValue("/root/reqData/subSearchData/cmpy_cd", cmpy_cd);
						model1.setValue("/root/reqData/subSearchData/occr_dt", occr_dt);
						model1.setValue("/root/reqData/subSearchData/with_seq",with_seq);
						model1.setValue("/root/reqData/subSearchData/seq",seq);
						
						model1.send("hd_trip_1502");
						
						model1.copyNode("/root/resData/gridData4","/root/dataSet/CURLIST3");
						model1.copyNode("/root/resData/gridData3","/root/dataSet/CURLIST4");
						model1.removenode("/root/dataSet");
								
						model1.refresh();
						for(var i=1;i<datagrid4.rows;i++) {
							datagrid4.isReadOnly(i, 1)  =true;
							datagrid4.rowStatus(i) = "2";
						}
								
						for(var i=1;i<datagrid3.rows;i++) {
							datagrid3.rowStatus(i) = "2";
						}
					}
					model1.refresh();
				]]>
			</script>
		</datagrid>
		<group id="group_btnG1" class="gro_btn" style="left:10px; top:110px; width:926px; height:20px; ">
			<caption id="caption26" class="tit02" style="left:2px; top:0px; width:335px; height:20px; font-weight:bold; ">출장내역</caption>
			<button id="button8" class="btn_grid06" style="left:85px; top:2px; width:85px; height:17px; ">
				<caption>엑셀다운로드</caption>
				<script type="javascript" ev:event="DOMActivate">
					<![CDATA[
						//excel 파일로 저장한다.
						var filePath = window.fileDialog("save", "", false, "", "xls", "Excel Files(*.xls)|*.xls");
						
						if(filePath != "") {
							datagrid1.saveExcel(filePath);
							window.exec(filePath);
						}
					]]>
				</script>
			</button>
		</group>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:43px; width:926px; height:21px; ">
			<button id="btnA1" class="btn02" style="left:655px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var fr_dt = model1.getValue("/root/reqData/searchData/busi_frdt");
						var to_dt = model1.getValue("/root/reqData/searchData/busi_todt");
						if(fr_dt == "" || to_dt == ""){
							alert("기간설정을 입력 후 조회해주세요.");
							return;
						}
						if(fr_dt.length != 8 || to_dt.length != 8){
							alert("기간설정을 정확히 입력해주세요.");
							return;
						}
						if(fr_dt > to_dt){
							alert("기간설정을 확인해 주세요.");
							return;
						}
						model1.send("hd_trip_1500");
						model1.copyNode("/root/resData/gridData","/root/dataSet/CURLIST");
						model1.removenode("/root/dataSet");
						datagrid1.clearStatus();
						datagrid3.clearStatus();
						datagrid4.clearStatus();
						
						model1.refresh();
						var totcnt = datagrid1.rows;
						model1.setValue("/root/resData/totcnt", "총 " + Number(totcnt - 2) + " 건");
						model1.refresh();
					]]>
				</script>
			</button>
			<button id="btnA2" class="btn02" style="left:600px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model1.reset();
					]]>
				</script>
			</button>
			<button id="button7" class="btn02" style="left:874px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
				 	viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					]]>
				</script>
			</button>
			<button id="button1" class="btn02" style="left:765px; top:0px; width:52px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var cnt = 0;
						for(var i=1;i<datagrid1.rows;i++) {
							if(datagrid1.rowStatus(i) == "2") {
								cnt ++;
							}
						}
						if (cnt == 0) { alert("저장할 내역을 선택후 신청하십시요 ."); return ; }
						
	 					if (window.alert("저장하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						
						var selectedIdx = datagrid1.row - 1;
						model1.setValue("/root/resData/gridData/record[" + selectedIdx + "]/invit_dds", model1.getValue("/root/reqData/reqForm/invit_dds"));			// 초청일수
						model1.setValue("/root/resData/gridData/record[" + selectedIdx + "]/busi_trip_dds", model1.getValue("/root/reqData/reqForm/busi_trip_dds"));	// 본사일수
						model1.setValue("/root/resData/gridData/record[" + selectedIdx + "]/adpay_no", model1.getValue("/root/reqData/reqForm/adpay_no"));		// 선급번호
						model1.setValue("/root/resData/gridData/record[" + selectedIdx + "]/adpay_amt", model1.getValue("/root/reqData/reqForm/adpay_amt"));		// 선급액
						model1.setValue("/root/resData/gridData/record[" + selectedIdx + "]/expn_reso_no", model1.getValue("/root/reqData/reqForm/expn_reso_no"));	// 지출결의번호
						model1.setValue("/root/resData/gridData/record[" + selectedIdx + "]/ceph_use_yn", model1.getValue("/root/reqData/reqForm/ceph_use_yn"));	// 휴대폰사용
						model1.setValue("/root/resData/gridData/record[" + selectedIdx + "]/aviat_fee", model1.getValue("/root/reqData/reqForm/aviat_fee")); 			// 항공비 신청
						model1.setValue("/root/resData/gridData/record[" + selectedIdx + "]/fix_aviat_fee", model1.getValue("/root/reqData/reqForm/fix_aviat_fee")); 	// 항공비 확정
						model1.setValue("/root/resData/gridData/record[" + selectedIdx + "]/adjm_aviat_fee", model1.getValue("/root/reqData/reqForm/adjm_aviat_fee"));	// 항공비 정산
						model1.setValue("/root/resData/gridData/record[" + selectedIdx + "]/stay_fee", model1.getValue("/root/reqData/reqForm/stay_fee")); 			// 숙박비 신청
						model1.setValue("/root/resData/gridData/record[" + selectedIdx + "]/fix_stay_fee", model1.getValue("/root/reqData/reqForm/fix_stay_fee")); 		// 숙박비 확정
						model1.setValue("/root/resData/gridData/record[" + selectedIdx + "]/adjm_stay_fee", model1.getValue("/root/reqData/reqForm/adjm_stay_fee")); 	// 숙박비 정산
						model1.setValue("/root/resData/gridData/record[" + selectedIdx + "]/dd_fee", model1.getValue("/root/reqData/reqForm/dd_fee")); 				// 일비 신청
						model1.setValue("/root/resData/gridData/record[" + selectedIdx + "]/fix_dd_fee", model1.getValue("/root/reqData/reqForm/fix_dd_fee")); 		// 일비 확정
						model1.setValue("/root/resData/gridData/record[" + selectedIdx + "]/adjm_dd_fee", model1.getValue("/root/reqData/reqForm/adjm_dd_fee")); 	// 일비 정산
						
						model1.setValue("/root/reqData/multiUpData", datagrid1.getUpdateData());
						model1.setValue("/root/reqData/multiUpData2", datagrid3.getUpdateData());
						model1.setValue("/root/reqData/multiUpData3", datagrid4.getUpdateData());
						model1.send("hd_trip_1504");
						
						if(submit_completed()) {
							model1.reset();
							
							datagrid1.clearStatus();
							datagrid3.clearStatus();
							datagrid4.clearStatus();
						}
					]]>
				</script>
			</button>
			<button id="button2" class="btn02" style="left:710px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var cnt = 0;
						for(var i=1;i<datagrid1.rows;i++) {
							if(datagrid1.rowStatus(i) == "4") {
								cnt ++;
							}
						}
						if (cnt == 0) { alert("삭제할 내역을 선택후 신청하십시요 ."); return ; }
						
	 					if (window.alert("삭제하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						model1.setValue("/root/reqData/multiUpData", datagrid1.getUpdateData());
						model1.setValue("/root/reqData/multiUpData2", datagrid3.getUpdateData());
						model1.setValue("/root/reqData/multiUpData3", datagrid4.getUpdateData());
						model1.send("hd_trip_1504");
						
						if(submit_completed()) {
							model1.reset();
							
							datagrid1.clearStatus();
							datagrid3.clearStatus();
							datagrid4.clearStatus();
						}
					]]>
				</script>
			</button>
			<button id="button3" class="btn02" style="left:820px; top:0px; width:52px; height:21px; ">
				<caption>출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						resetOznode();					
						
						var iv_cmpy_cd = model1.getValue("/root/reqData/subSearchData/cmpy_cd");
						var iv_occr_dt = model1.getValue("/root/reqData/subSearchData/occr_dt");
						var iv_seq = model1.getValue("/root/reqData/subSearchData/seq");
						
						if(iv_cmpy_cd == "" || iv_occr_dt == "" || iv_seq == ""){
							alert("출력하실 자료를 클릭 후 출력해 주세요.");
							return;
						}
							 						
						// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
						makeNodeValue("/root/oz_data/ozrName","hd/SP_HD_TRIP_1308_P");
						makeNodeValue("/root/oz_data/preview","preview"); 			//preview : 미리보기, print : 인쇄
						makeNodeValue("/root/oz_data/printsize",""); 				//페이지용지설정(기본 A4)		
						// odi 파라미터 설정.	
						makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , iv_cmpy_cd);
						makeNodeValue("/root/oz_data/odiParam/iv_occr_dt" , iv_occr_dt);
						makeNodeValue("/root/oz_data/odiParam/iv_seq" , iv_seq );
				
						// 레포트뷰어 호출.					
						openOzwin("/root/oz_data");	
						
						model1.removenode("/root/dataSet");
					]]>
				</script>
			</button>
		</group>
		<datagrid id="datagrid4" nodeset="/root/resData/gridData4/record" scroll="auto" caption="일자^출발지^목적지^출장내용^caption2^caption3^caption4^caption1^caption5^caption6" colsep="#" colwidth="100, 200, 200, 400, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:9px; top:528px; width:924px; height:192px; ">
			<col ref="d_midl_start_dt" type="inputdate"/>
			<col ref="d_start_area" type="input" maxlength="15" style="text-align:left; "/>
			<col ref="d_dest" type="input" maxlength="15" style="text-align:left; "/>
			<col ref="d_busi_trip_cont" type="input" maxlength="25" style="text-align:left; "/>
			<col ref="d_cmpy_cd" visibility="hidden"/>
			<col ref="d_emp_no" visibility="hidden"/>
			<col ref="d_occr_dt" visibility="hidden"/>
			<col ref="d_seq" visibility="hidden"/>
			<col ref="d_sub_seq" visibility="hidden"/>
			<col ref="d_with_seq" visibility="hidden"/>
		</datagrid>
		<group id="group4" class="gro_btn" style="left:9px; top:503px; width:926px; height:20px; ">
			<caption id="caption37" class="tit02" style="left:2px; top:0px; width:335px; height:20px; font-weight:bold; ">출장계획</caption>
		</group>
		<group id="group5" style="left:708px; top:282px; width:225px; height:20px; ">
			<caption id="caption1" class="tit02" style="left:0px; top:0px; width:220px; height:20px; font-weight:bold; ">본사부담출장비 / 정산</caption>
		</group>
		<group id="group6" style="left:708px; top:302px; width:225px; height:200px; ">
			<caption id="caption47" class="list_cap02" style="left:149px; top:170px; width:76px; height:26px; text-align:center; "/>
			<caption id="caption2" class="list_cap02" style="left:0px; top:40px; width:76px; height:26px; text-align:center; "/>
			<input id="input2" ref="/root/reqData/reqForm/aviat_fee" navindex="12" maxlength="10" format="#,###" appearance="input" style="left:5px; top:44px; width:65px; height:18px; text-align:right; "/>
			<caption id="caption5" class="list_cap01" style="left:0px; top:0px; width:225px; height:21px; text-align:center; ">항공비</caption>
			<caption id="caption11" class="list_cap01" style="left:0px; top:65px; width:225px; height:21px; text-align:center; ">숙박비</caption>
			<caption id="caption38" class="list_cap02" style="left:74px; top:40px; width:76px; height:26px; text-align:center; "/>
			<caption id="caption39" class="list_cap02" style="left:149px; top:40px; width:76px; height:26px; text-align:center; "/>
			<caption id="caption40" class="list_cap02" style="left:0px; top:105px; width:76px; height:26px; text-align:center; "/>
			<caption id="caption41" class="list_cap02" style="left:75px; top:105px; width:76px; height:26px; text-align:center; "/>
			<caption id="caption42" class="list_cap02" style="left:149px; top:105px; width:76px; height:26px; text-align:center; "/>
			<input id="input5" ref="/root/reqData/reqForm/fix_aviat_fee" navindex="13" maxlength="10" format="#,###" appearance="input" style="left:79px; top:44px; width:65px; height:18px; text-align:right; "/>
			<input id="input7" ref="/root/reqData/reqForm/adjm_aviat_fee" navindex="14" maxlength="10" format="#,###" appearance="input" style="left:155px; top:44px; width:65px; height:18px; text-align:right; "/>
			<input id="input8" ref="/root/reqData/reqForm/stay_fee" navindex="15" maxlength="10" format="#,###" appearance="input" style="left:5px; top:109px; width:65px; height:18px; text-align:right; "/>
			<input id="input13" ref="/root/reqData/reqForm/fix_stay_fee" navindex="16" maxlength="10" format="#,###" appearance="input" style="left:80px; top:109px; width:65px; height:18px; text-align:right; "/>
			<input id="input14" ref="/root/reqData/reqForm/adjm_stay_fee" navindex="17" maxlength="10" format="#,###" appearance="input" style="left:153px; top:109px; width:65px; height:18px; text-align:right; "/>
			<input id="input1" ref="/root/reqData/reqForm/adjm_dd_fee" navindex="20" maxlength="10" format="#,###" appearance="input" style="left:155px; top:174px; width:65px; height:18px; text-align:right; "/>
			<caption id="caption44" class="list_cap02" style="left:0px; top:170px; width:76px; height:26px; text-align:center; "/>
			<caption id="caption45" class="list_cap01" style="left:0px; top:130px; width:225px; height:21px; text-align:center; ">일비</caption>
			<caption id="caption46" class="list_cap02" style="left:74px; top:170px; width:76px; height:26px; text-align:center; "/>
			<input id="input18" ref="/root/reqData/reqForm/dd_fee" navindex="18" maxlength="10" format="#,###" appearance="input" style="left:5px; top:174px; width:65px; height:18px; text-align:right; "/>
			<input id="input19" ref="/root/reqData/reqForm/fix_dd_fee" navindex="19" maxlength="10" format="#,###" appearance="input" style="left:79px; top:174px; width:65px; height:18px; text-align:right; "/>
			<caption id="caption4" class="list_cap01" style="left:0px; top:85px; width:76px; height:21px; text-align:center; ">신청</caption>
			<caption id="caption6" class="list_cap01" style="left:75px; top:85px; width:76px; height:21px; text-align:center; ">확정</caption>
			<caption id="caption7" class="list_cap01" style="left:149px; top:85px; width:76px; height:21px; text-align:center; ">정산</caption>
			<caption id="caption8" class="list_cap01" style="left:0px; top:20px; width:76px; height:21px; text-align:center; ">신청</caption>
			<caption id="caption12" class="list_cap01" style="left:74px; top:20px; width:76px; height:21px; text-align:center; ">확정</caption>
			<caption id="caption13" class="list_cap01" style="left:149px; top:20px; width:76px; height:21px; text-align:center; ">정산</caption>
			<caption id="caption14" class="list_cap01" style="left:74px; top:150px; width:76px; height:21px; text-align:center; ">확정</caption>
			<caption id="caption17" class="list_cap01" style="left:149px; top:150px; width:76px; height:21px; text-align:center; ">정산</caption>
			<caption id="caption20" class="list_cap01" style="left:0px; top:150px; width:76px; height:21px; text-align:center; ">신청</caption>
			<select id="checkbox4" ref="/root/reqData/reqForm/ceph_use_yn" class="list_cap01" navindex="11" overflow="visible" appearance="full" style="left:1px; top:2px; width:85px; height:15px; border-style:none; ">
				<choices>
					<item>
						<label>휴대폰사용</label>
						<value>1</value>
					</item>
				</choices>
			</select>
		</group>
		<datagrid id="datagrid3" nodeset="/root/resData/gridData3/record" scroll="auto" caption="기타필요경비내역^예상액^예상액^예상액^(구체적)필요성^caption1^caption2^caption3^caption4^caption5^caption6|기타필요경비내역^신청^확정^정산^(구체적)필요성^caption1^caption2^caption3^caption4^caption5^caption6" colsep="#" colwidth="120, 70, 70, 69, 330, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="byrow" style="left:9px; top:330px; width:696px; height:170px; ">
			<col ref="e_etc_cost_ptcr" type="input" maxlength="15" style="text-align:left; "/>
			<col ref="e_etc_cost" type="input" format="#,###" maxlength="10" style="text-align:right; "/>
			<col ref="e_fix_etc_cost" type="input" format="#,###" maxlength="10" style="left:190px; top:20px; width:50px; height:20px; text-align:right; "/>
			<col ref="e_adjm_etc_cost" type="input" format="#,###" maxlength="10" style="text-align:right; "/>
			<col ref="e_etc_cost_neces" type="input" maxlength="25" style="text-align:left; "/>
			<col ref="e_cmpy_cd" visibility="hidden"/>
			<col ref="e_emp_no" visibility="hidden"/>
			<col ref="e_occr_dt" visibility="hidden"/>
			<col ref="e_seq" visibility="hidden"/>
			<col ref="e_sub_seq" visibility="hidden"/>
			<col ref="e_with_seq" visibility="hidden"/>
		</datagrid>
		<group id="group1" style="left:9px; top:303px; width:696px; height:25px; ">
			<caption id="caption21" class="list_cap02" style="left:60px; top:0px; width:46px; height:25px; text-align:center; "/>
			<caption id="caption22" class="list_cap01" style="left:0px; top:0px; width:61px; height:25px; text-align:center; ">초청일수</caption>
			<caption id="caption15" class="list_cap02" style="left:160px; top:0px; width:46px; height:25px; text-align:center; "/>
			<caption id="caption19" class="list_cap01" style="left:105px; top:0px; width:56px; height:25px; text-align:center; ">본사일수</caption>
			<caption id="caption23" class="list_cap02" style="left:265px; top:0px; width:95px; height:25px; text-align:center; "/>
			<caption id="caption24" class="list_cap01" style="left:205px; top:0px; width:61px; height:25px; text-align:center; ">선급번호</caption>
			<caption id="caption25" class="list_cap02" style="left:419px; top:0px; width:91px; height:25px; text-align:center; "/>
			<caption id="caption27" class="list_cap01" style="left:359px; top:0px; width:61px; height:25px; text-align:center; ">선급액</caption>
			<caption id="caption28" class="list_cap02" style="left:589px; top:0px; width:107px; height:25px; text-align:center; "/>
			<caption id="caption30" class="list_cap01" style="left:509px; top:0px; width:81px; height:25px; text-align:center; ">지출결의번호</caption>
			<input id="input12" ref="/root/reqData/reqForm/invit_dds" navindex="6" format="999" style="left:64px; top:4px; width:37px; height:18px; text-align:right; "/>
			<input id="input15" ref="/root/reqData/reqForm/busi_trip_dds" navindex="7" format="999" style="left:164px; top:4px; width:37px; height:18px; text-align:right; "/>
			<input id="input16" ref="/root/reqData/reqForm/adpay_no" navindex="8" maxlength="15" style="left:269px; top:4px; width:87px; height:18px; text-align:right; "/>
			<input id="input17" ref="/root/reqData/reqForm/adpay_amt" navindex="9" maxlength="9" format="#,###" style="left:423px; top:4px; width:82px; height:18px; text-align:right; "/>
			<input id="input20" ref="/root/reqData/reqForm/expn_reso_no" navindex="10" maxlength="15" style="left:593px; top:4px; width:98px; height:18px; text-align:right; "/>
		</group>
		<caption id="caption3" ref="/root/resData/totcnt" style="left:860px; top:280px; width:72px; height:20px; font-weight:bold; text-align:right; "/>
	</xhtml:body>
</xhtml:html>
