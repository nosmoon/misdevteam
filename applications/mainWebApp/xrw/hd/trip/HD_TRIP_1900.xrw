<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<dataSet/>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<stay_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</stay_clsf>
							<temp_cd1>
								<item>
									<label/>
									<value/>
								</item>
							</temp_cd1>
							<!-- 선택계열의 정보를 담당 -->
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<!-- 검색조건 처리 -->
						<reqForm>
							<chk1/>
						</reqForm>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<!-- MultiUpDate유형 사용시 처리 -->
						<searchData>
							<busi_trip_frdt/>
							<busi_trip_todt/>
							<emp_no/>
							<proc_stat/>
							<actu_slip_no/>
							<tmp_crdt_amt/>
							<titl/>
							<slip_seq/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<incmg_pers/>
							<incmg_pers_ipadd/>
							<titl2/>
							<cost_fix_yn/>
						</searchData>
						<fwdData>
							<func_nm/>
						</fwdData>
						<popData>
							<emp_no/>
							<cmpy_cd/>
							<vaca_ck/>
						</popData>
						<multiUpData/>
						<multiUpData1/>
						<mode_gubun/>
					</reqData>
					<resData>
						<empInfo>
							<cmpy_cd/>
							<emp_no/>
							<nm_korn/>
							<dept_cd/>
							<dept_nm/>
							<dty_nm/>
							<posi_nm/>
							<dty_cd/>
							<posi_cd/>
							<rptv_posi_cd/>
						</empInfo>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<temp/>
						</resForm>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<msg/>
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<record>
								<dept_nm/>
								<emp_no/>
								<flnm/>
								<dty_nm/>
								<posi_nm/>
								<stay_clsf/>
								<start_area/>
								<busi_trip_purp/>
								<busi_trip_frdt/>
								<busi_trip_todt/>
								<busi_trip_dds/>
								<dd_fee/>
								<busi_trip_fee_stot/>
								<cmpy_cd/>
								<dept_cd/>
								<dty_cd/>
								<posi_cd/>
								<occr_dt/>
								<seq/>
								<slip_proc_mang_dt/>
								<slip_proc_mang_seq/>
								<rptv_posi_cd/>
								<slip_proc_mang_seq_num/>
								<actu_slip_no/>
								<proc_clsf/>
								<proc_clsf_nm/>
								<stay_clsf_nm/>
								<titl/>
								<slip_occr_dt/>
								<slip_clsf_cd/>
								<slip_seq/>
								<titl2/>
								<cost_fix_clsf/>
								<cost_fix_clsf_chk/>
							</record>
							<!-- datagrid2 -->
							<!-- datagrid3 -->
						</gridData>
						<resPhoto type="xsd:base64Binary"/>
						<slipData>
							<record>
								<cmpy_cd/>
								<emp_no/>
								<dept_cd/>
								<flnm/>
								<tmp_dr_amt/>
								<tmp_crdt_amt/>
								<titl/>
								<slip_seq/>
								<slip_occr_dt/>
								<slip_clsf_cd/>
								<incmg_pres/>
								<incmg_pers_ipadd/>
								<proc_stat/>
								<dept_nm/>
								<titl2/>
							</record>
						</slipData>
						<base_alon_clsf>
							<record>
								<pay_basi_clsf/>
								<dspch_clsf/>
								<base_alon/>
							</record>
						</base_alon_clsf>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					//사원 찾기 
					function setEmpInfo(emp_no, nm_korn)
					{
						var n_row = datagrid2.row;
						
						model1.setValue("/root/reqData/searchData/emp_no",emp_no);
						
						model1.send("hd_trip_1701");
						model1.copyNode("/root/resData/empInfo","/root/tempData/empInfo/record");
						model1.removenode("/root/tempData");
						var dept_cd = model1.getValue("/root/resData/empInfo/dept_cd");
						var dept_nm = model1.getValue("/root/resData/empInfo/dept_nm");
						var emp_no = model1.getValue("/root/resData/empInfo/emp_no");
						var nm_korn = model1.getValue("/root/resData/empInfo/nm_korn");
						var posi_nm = model1.getValue("/root/resData/empInfo/posi_nm");
						var posi_cd = model1.getValue("/root/resData/empInfo/posi_cd");
						var dty_nm = model1.getValue("/root/resData/empInfo/dty_nm");
						var dty_cd = model1.getValue("/root/resData/empInfo/dty_cd");
						var cmpy_cd = model1.getValue("/root/resData/empInfo/cmpy_cd");
						var rptv_posi_cd = model1.getValue("/root/resData/empInfo/rptv_posi_cd");
						
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/cmpy_cd", cmpy_cd);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/dept_cd", dept_cd);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/dept_nm", dept_nm);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/emp_no", emp_no);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/nm_korn", nm_korn);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/posi_cd", posi_cd);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/posi_nm", posi_nm);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/dty_cd", dty_cd);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/dty_nm", dty_nm);
						model1.setValue("/root/resData/gridData/record[" + n_row + "]/rptv_posi_cd", rptv_posi_cd);
						
						datagrid2.refresh();
					}
						
					
					
					//현재 날짜 
					function DateDemo()
					{
						var s="";
						var mydate=new Date() 
						var year=mydate.getYear() 
						    if (year < 1000) 
						        year+=1900 
						
						var day=mydate.getDay() 
						var month=mydate.getMonth()+1 
						    if (month<10) 
						        month="0"+month 
						
						var daym=mydate.getDate() 
						    if (daym<10) 
						        daym="0"+daym 
						s  = year;
					       return(s);
					}
					
					
					    var searchFlag = false;
					     //총금액 총인원 구하기
					     function setTotal_amt_pep(){
					     	var emp_no_tmp = "xxxxxx" ,emp_no = "";	
						var s_flnm = "",dept_nm = "",titl2 = "";					     	
//					     	var row1 = datagrid1.rows;
					     	var total_amt = 0, alon_amt = 0 ;
					     	var cnt = 0;

						for (i=1; i<datagrid2.rows; i++) {                
				 		     	if (datagrid2.rowStatus(i) != 0) {
									if(cnt == 0 ) {
										s_flnm = model1.getValue("/root/resData/gridData/record[i]/flnm");
										dept_nm = model1.getValue("/root/resData/gridData/record[i]/dept_nm");
										titl2 = model1.getValue("/root/resData/gridData/record[i]/titl2");
									}

						     		alon_amt = model1.getValue("/root/resData/gridData/record["+i+"]/busi_trip_fee_stot");
						     		emp_no = model1.getValue("/root/resData/gridData/record["+i+"]/emp_no");
						     		total_amt =  Number(total_amt) + Number(alon_amt);
						     		if(emp_no_tmp != emp_no){
						     			cnt++;
						     			emp_no_tmp = emp_no;
						     		}
								}			       
						}

					     	cnt = cnt - 1;
					     	if(cnt == 0){
//					     		model1.setValue("/root/resData/slipData/record[1]/tmp_crdt_amt",total_amt);
//								model1.setValue("/root/resData/slipData/record[1]/titl",dept_nm+" "+s_flnm+" 국내여비(파견일비)");
//					     		model1.setValue("/root/resData/slipData/record[1]/titl2",titl2);
								
								model1.setValue("/root/reqData/searchData/tmp_crdt_amt",total_amt);
								model1.setValue("/root/reqData/searchData/titl",dept_nm+" "+s_flnm+" 국내여비(파견일비)");
								model1.setValue("/root/reqData/searchData/titl2",titl2);
								
					     	}else{
//					     		model1.setValue("/root/resData/slipData/record[1]/tmp_crdt_amt",total_amt);
//								model1.setValue("/root/resData/slipData/record[1]/titl",dept_nm+" "+s_flnm+" 외 "+cnt+"명 국내여비(파견일비)");
//					     		model1.setValue("/root/resData/slipData/record[1]/titl2",titl2);
								
								model1.setValue("/root/reqData/searchData/tmp_crdt_amt",total_amt);
								model1.setValue("/root/reqData/searchData/titl",dept_nm+" "+s_flnm+" 외 "+cnt+"명 국내여비(파견일비)");
								model1.setValue("/root/reqData/searchData/titl2",titl2);
								
					     	}
							model1.refresh();
					     }	

					     //전표등록시 벨류
//					     function setInsertSlipValue(){
//					     	
//					     	var total_amt = 0;
//					     	var cnt = 0;
//					     	
//							var i =0, var_check_row = 0;
//							for (i=1; i<datagrid2.rows; i++) {
//				 		     	if (datagrid2.rowStatus(i) != 0) {
//									var_check_row = var_check_row + 1;
//								}
//						    }
//			     	
//				       		if (var_check_row == 0) {
//								return;       
//					        } else {	
//							var tmp_crdt_amt = model1.getValue("/root/resData/gridData/record[1]/tmp_crdt_amt");
//							var titl = model1.getValue("/root/resData/gridData/record[1]/titl");
//							var titl2 = model1.getValue("/root/resData/gridData/record[1]/titl2");
//
//					     		model1.setValue("/root/reqData/searchData/tmp_crdt_amt",tmp_crdt_amt);
//					     		model1.setValue("/root/reqData/searchData/titl",titl);
//					     		model1.setValue("/root/reqData/searchData/titl2",titl2);
//							}
//							model1.refresh();
//					     }					     
					     
					     
					     //전표 삭제시 벨류
					     function setDeleteSlipValue(){
						 if(datagrid2.rows > 1){					     	
							var slip_seq = model1.getValue("/root/resData/gridData/record[1]/slip_seq");
							var slip_occr_dt = model1.getValue("/root/resData/gridData/record[1]/slip_occr_dt");
							var slip_clsf_cd = model1.getValue("/root/resData/gridData/record[1]/slip_clsf_cd");
//							var incmg_pers = model1.getValue("/root/resData/slipData/record[1]/incmg_pers");
//							var incmg_pers_ipadd = model1.getValue("/root/resData/slipData/record[1]/incmg_pers_ipadd");

					     		model1.setValue("/root/reqData/searchData/slip_seq",slip_seq);
					     		model1.setValue("/root/reqData/searchData/slip_occr_dt",slip_occr_dt);
					     		model1.setValue("/root/reqData/searchData/slip_clsf_cd",slip_clsf_cd);
//					     		model1.setValue("/root/reqData/searchData/incmg_pers",incmg_pers);
//					     		model1.setValue("/root/reqData/searchData/incmg_pers_ipadd",incmg_pers_ipadd);
							}
							model1.refresh();
					     }		
					     				
					function gridSearchList(){
						
						model1.send("hd_trip_1902");
						model1.copyNode("/root/resData/gridData","/root/tempData/CURLIST");
						model1.removenode("/root/tempData");
						model1.refresh();				

						if(actu_slip_no_in.value != "") {
							searchFlag = true;
						}
						
						for(var i=1 ;i< datagrid2.rows;i++){
							var proc_stat = model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf");							
							//if(proc_stat == 29 || proc_stat == 36){
							
							//if(proc_stat >= '21'){ //인사금액취소이후는 EDIT불가 //120207
							if(proc_stat >= model1.getValue("/root/initData/dataSet/xx_proc_clsf_010")){ //인사금액취소이후는 EDIT불가
								datagrid2.isReadOnly(i, 1, i, 16)  = true;		
							}else{
								datagrid2.isReadOnly(i, 1, i, 16)  = false;		
							}					
						}							
						datagrid2.clearStatus();																	
						check_reset();
						gridrowcnt.value = "[총 "+ model.getValue("/root/resData/gridData/totalcnt") + "건]";
						model1.refresh();							
					}
						
					function check_reset(){
						var col = datagrid2.fixedCols;
						var rows = datagrid2.rows;
						for( i = datagrid2.fixedRows ; i <= rows ; i++){
							datagrid2.valueMatrix(i,col) = "false";
						}
//						check_all.value = "";
					}	
																
					function isByteLength(data, maxlen) {
					    var len = data.length;
					    for (i = 0; i < data.length; i++){
					        if (data.charCodeAt(i)  > 127){
					            len++;
					        }
					    }
					    if (len > maxlen) {
					        return false;
					    } else {
					        return true;
					    }
					}
					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					model1.send("hd_trip_1900");
					model1.copyNode("/root/initData/comboSet/stay_clsf","/root/tempData/stay_clsf");
					model1.copyNode("/root/resData/base_alon_clsf", "/root/tempData/base_alon_clsf");
					model1.copyNode("/root/initData/dataSet", "/root/tempData/dataSet");
					model1.removenode("/root/tempData");
					
					/*
					alert(model1.getValue("/root/initData/dataSet/xx_proc_clsf_010"));
					alert(model1.getValue("/root/initData/dataSet/xx_proc_clsf_020"));
					alert(model1.getValue("/root/initData/dataSet/xx_proc_clsf_030"));
					alert(model1.getValue("/root/initData/dataSet/xx_proc_clsf_040"));
					alert(model1.getValue("/root/initData/dataSet/xx_proc_clsf_050"));
					alert(model1.getValue("/root/initData/dataSet/xx_proc_clsf_060"));
					alert(model1.getValue("/root/initData/dataSet/xx_proc_clsf_070"));
					alert(model1.getValue("/root/initData/dataSet/xx_rptv_posi_cd_010"));
					alert(model1.getValue("/root/initData/dataSet/xx_rptv_posi_cd_020"));
					alert(model1.getValue("/root/initData/dataSet/xx_rptv_posi_cd_030"));
					alert(model1.getValue("/root/initData/dataSet/xx_pay_basi_clsf_010"));
					alert(model1.getValue("/root/initData/dataSet/xx_pay_basi_clsf_020"));
					alert(model1.getValue("/root/initData/dataSet/xx_pay_basi_clsf_030"));
					alert(model1.getValue("/root/initData/dataSet/xx_dspch_clsf_010"));
					alert(model1.getValue("/root/initData/dataSet/xx_dspch_clsf_020"));
					alert(model1.getValue("/root/initData/dataSet/xx_stay_clsf_010"));
					alert(model1.getValue("/root/initData/dataSet/xx_mode_gubun_010"));
					*/
					
					//model1.copyNode("/root/initData/comboSet/temp_cd1", "/root/tempData/temp_cd1");
					//combo1.select(0);
					model1.send("hd_trip_1102");
					model1.copyNode("/root/initData/comboSet/temp_cd1", "/root/dataSet/CURLIST1");
					model1.removenode("/root/dataSet");

//					datagrid2.isReadOnly(1, 1, 1, 13)  = true;
					model1.removenode("/root/resData/gridData/record[1]");
					datagrid2.fixedcellcheckbox(0, datagrid2.colRef("chkbox"), false) = true;					
//					datagrid2.refresh();
					model1.refresh();
					
					var now_date = new Date();
					var year = now_date.getYear();
					var month = now_date.getMonth() + 1;
					var day = now_date.getDate();    
					var month_tm = '0' + month;
					var day_tm = '0' + day;  
					if(month_tm.length == 3){
						month_tm = month_tm.substring(1, 3);
					}
					if(day_tm.length == 3){
						day_tm = day_tm.substring(1, 3);
					}
					var now_dt = year + month_tm + day_tm;
					var yyyymmdd1 = year + month_tm + "01";
					var yyyymmdd2 = year + month_tm + commLastDay(year + month_tm);
										
					busi_trip_frdt.value = yyyymmdd1; // + "0101";
					busi_trip_todt.value = yyyymmdd2; // + "1231";
					
					//busi_trip_frdt.value = DateDemo() + "0101";
					//busi_trip_todt.value = DateDemo() + "1231";
				]]>
			</script>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<submission id="hd_trip_1701" action="/hd/trip/1701" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1704" action="/hd/trip/1704" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_trip_1900" action="/hd/trip/1900" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1901" action="/hd/trip/1901" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_trip_1902" action="/hd/trip/1902" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1903" action="/hd/trip/1903" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_trip_1904" action="/hd/trip/1904" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_trip_1905" action="/hd/trip/1905" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_trip_1102" action="/hd/trip/1102" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_trip_1109" action="/hd/trip/1109" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_trip_1105" action="/hd/trip/1105" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
		</model>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="740" guideline="1,8;1,934;2,432;" style="font-family:굴림; ">
		<group id="group1" class="gro_btn" style="left:10px; top:95px; width:926px; height:20px; ">
			<caption id="caption5" class="tit02" style="left:2px; top:0px; width:335px; height:20px; font-weight:bold; ">파견일비내역</caption>
		</group>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData/record" scroll="auto" caption="선택^부서^사번^성명^직책^직급^파견구분^파견지^파견사유^시작일자^종료일자^일수^일일금액^합계^caption1^caption2^caption3^caption4^caption5^caption6^caption7^caption8^caption9^진행상태^관리번호^전표번호" colsep="#" colwidth="50, 100, 70, 70, 70, 70, 80, 100, 140, 100, 100, 50, 60, 60, 100, 100, 100, 100, 100, 100, 100, 100, 100, 110, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:10px; top:135px; width:924px; height:570px; ">
			<col checkvalue="1,0" ref="chkbox" type="checkbox"/>
			<col ref="dept_nm" style="text-align:left; "/>
			<col ref="emp_no"/>
			<col class="req" ref="flnm"/>
			<!--
			<col ref="nm_korn" type="inputbutton">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
							model1.setValue("/root/reqData/fwdData/func_nm", "setEmpInfo");
							window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
	
						]]>
				</script>
			</col>
-->
			<col ref="dty_nm"/>
			<col ref="posi_nm"/>
			<col class="req" ref="stay_clsf" type="combo" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/stay_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col class="req" ref="stay_area" type="input" style="text-align:left; "/>
			<col ref="busi_trip_purp" type="input" caption="파견사유" style="text-align:left; "/>
			<col class="req" ref="busi_trip_frdt" type="inputdate" format="yyyy-mm-dd" caption="출장시작일"/>
			<col class="req" ref="busi_trip_todt" type="inputdate" format="yyyy-mm-dd" caption="출장종료일"/>
			<col ref="busi_trip_dds"/>
			<col ref="dd_fee" type="input" format="#,###" style="text-align:right; "/>
			<col ref="busi_trip_fee_stot" format="#,###" style="text-align:right; "/>
			<col ref="cmpy_cd" visibility="hidden"/>
			<col ref="dept_cd" visibility="hidden"/>
			<col ref="dty_cd" visibility="hidden"/>
			<col ref="posi_cd" visibility="hidden"/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="slip_proc_mang_seq" visibility="hidden"/>
			<col ref="slip_proc_mang_dt" visibility="hidden"/>
			<col ref="rptv_posi_cd" visibility="hidden"/>
			<col ref="proc_clsf_nm"/>
			<col ref="slip_proc_mang_seq_num" format="99999999-99999"/>
			<col ref="actu_slip_no" format="99999999-99-999"/>
			<col ref="stay_clsf_nm" visibility="hidden"/>
			<col ref="titl" visibility="hidden"/>
			<col ref="slip_occr_dt" visibility="hidden"/>
			<col ref="slip_clsf_cd" visibility="hidden"/>
			<col ref="slip_seq" visibility="hidden"/>
			<col ref="titl2" visibility="hidden"/>
			<col ref="proc_clsf" visibility="hidden"/>
			<col ref="cost_fix_clsf" visibility="hidden"/>
			<col ref="cost_fix_clsf_chk" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
				var row = datagrid2.row;
				if(datagrid2.fixedcellischeck(0,datagrid2.colRef("chkbox")) == true && row==0){
					for(var i=1;i<datagrid2.rows;i++) {
						var proc_stat = model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf");
						
						var pattern = ","+proc_stat+",";
						var validation  = (","+model1.getValue("/root/initData/dataSet/xx_proc_clsf_020")+",").indexOf(pattern)==-1;

						//if(datagrid2.valueMatrix(i, datagrid2.colRef("chkbox")) == 1 && (proc_stat != 29 && proc_stat != 36)) { 120207
						if(datagrid2.valueMatrix(i, datagrid2.colRef("chkbox")) == 1 && (validation)) {
							var status = datagrid2.rowstatus(i);
							
							if(status=="0" ||  status=="7"){
								datagrid2.rowstatus(i) = 2;	
							}
						}
					
					}
				}	
			
			 	datagrid2.refresh();

				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[
				var row = datagrid2.row;
				
				if(datagrid2.fixedcellischeck(0,datagrid2.colRef("chkbox")) == false && row==0){
					for(var i=1;i<datagrid2.rows;i++) {
						if(datagrid2.valueMatrix(i, datagrid2.colRef("chbox")) == 0) {
							var status = datagrid2.rowstatus(i); 
							if(status=="2"){
								datagrid2.rowstatus(i) = 7;	
							}
						}
					}	
					datagrid2.refresh();	
				}
				 // 각 체크박스 체크 시
				var status = datagrid2.rowstatus(row);

				if(datagrid2.valueMatrix(row, datagrid2.colRef("chbox")) == 0) {
					if(status=="2"){
						datagrid2.rowStatus(row) = 7;				
						datagrid2.refresh();
					}
				}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[	
					//근무시간 구하기
					function getDay(busi_trip_frdt, busi_trip_todt)
					{
						var busi_trip_frdt_month = (busi_trip_frdt.substr(4,1) == "0")? busi_trip_frdt.substr(5,1) :  busi_trip_frdt.substr(4,2);
						var busi_trip_todt_month = (busi_trip_todt.substr(4,1) == "0")? busi_trip_todt.substr(5,1) :  busi_trip_todt.substr(4,2);
						var busi_trip_frdt_day = (busi_trip_frdt.substr(6,1) == "0")? busi_trip_frdt.substr(7,1) :  busi_trip_frdt.substr(6,2);
						var busi_trip_todt_day = (busi_trip_todt.substr(6,1) == "0")? busi_trip_todt.substr(7,1) :  busi_trip_todt.substr(6,2);
						
						var busi_trip_frdt_date = new Date(busi_trip_frdt.substr(0,4),busi_trip_frdt_month,busi_trip_frdt_day);   
						var busi_trip_todt_date = new Date(busi_trip_todt.substr(0,4),busi_trip_todt_month,busi_trip_todt_day);  
						var daym = Math.floor((busi_trip_todt_date.getTime() - busi_trip_frdt_date.getTime())/(24*60*60*1000) +1);           

						if (daym < 1)  {
							alert("날짜 선택이 잘못됐습니다");
							return 0;
						}
  						return daym;
					}

					var col = datagrid2.col;
					var row = datagrid2.row;
					

					var row = datagrid2.row;

					 if(datagrid2.col==datagrid2.colRef("busi_trip_frdt") || datagrid2.col==datagrid2.colRef("busi_trip_todt")){ //출장일수 구하는 부분
						var  busi_trip_frdt =model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_frdt");
						var  busi_trip_todt =model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_todt");
						var  dd_fee =model1.getValue("/root/resData/gridData/record[" + row + "]/dd_fee");
						
						var getDay1 ;
						
						if(busi_trip_frdt !="" && busi_trip_todt != "") {
							getDay1 =  getDay(busi_trip_frdt, busi_trip_todt);
	
							if(getDay1 == 0) {
								model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_frdt","");
								model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_todt","");
							}
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_dds",getDay1);

							busi_trip_dds = model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_dds");
							
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_fee_stot", parseInt(busi_trip_dds) * parseInt(dd_fee));	
						} else {
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_dds","");
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_fee_stot", "");	
						}
					}
											
					if(datagrid2.col==datagrid2.colRef("stay_clsf")) {
						var ins = document.models( 0 ).instances( 0 );

						var nodelist = ins.selectNodes( "/root/resData/base_alon_clsf/record" );
						var  rptv_posi_cd =model1.getValue("/root/resData/gridData/record[" + row + "]/rptv_posi_cd");	
						var  stay_clsf =model1.getValue("/root/resData/gridData/record[" + row + "]/stay_clsf");	
						var  emp_no =model1.getValue("/root/resData/gridData/record[" + row + "]/emp_no");	
						var dspch_clsf1 = "";
						var dspch_clsf2 = "";
						
						if(emp_no=="") {
							alert("성명을 검색해주세요.");
							return;	
						}

						//if(parseInt(rptv_posi_cd) <= 50) { 120207
						if(Number(rptv_posi_cd) <= Number(model1.getValue("/root/initData/dataSet/xx_rptv_posi_cd_010")) ) {
							for(var i = 0; i < nodelist.length; i++)
							{
								var pay_basi_clsf = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/pay_basi_clsf");
								var dspch_clsf = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/dspch_clsf");
								var base_alon = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/base_alon");
								
								//if(pay_basi_clsf=="10" && dspch_clsf == "1") { 120207
								if(pay_basi_clsf==model1.getValue("/root/initData/dataSet/xx_pay_basi_clsf_010") && dspch_clsf == model1.getValue("/root/initData/dataSet/xx_dspch_clsf_010")) {
									dspch_clsf1 =  base_alon;
								}
								//if(pay_basi_clsf=="10" && dspch_clsf == "2") { 120207
								if(pay_basi_clsf==model1.getValue("/root/initData/dataSet/xx_pay_basi_clsf_010") && dspch_clsf == model1.getValue("/root/initData/dataSet/xx_dspch_clsf_020")) {
									dspch_clsf2 =  base_alon;
								}
							}
						}
						
						//if(parseInt(rptv_posi_cd) == 51) { 120207
						if(Number(rptv_posi_cd) == Number(model1.getValue("/root/initData/dataSet/xx_rptv_posi_cd_020"))  ) {
							for(var i = 0; i < nodelist.length; i++)
							{
								var pay_basi_clsf = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/pay_basi_clsf");
								var dspch_clsf = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/dspch_clsf");
								var base_alon = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/base_alon");
								
								//if(pay_basi_clsf=="20" && dspch_clsf == "1") { 120207
								if(pay_basi_clsf==model1.getValue("/root/initData/dataSet/xx_pay_basi_clsf_020") && dspch_clsf == model1.getValue("/root/initData/dataSet/xx_dspch_clsf_010")) {
									dspch_clsf1 =  base_alon;
								}
								//if(pay_basi_clsf=="20" && dspch_clsf == "2") { 120207
								if(pay_basi_clsf==model1.getValue("/root/initData/dataSet/xx_pay_basi_clsf_020") && dspch_clsf == model1.getValue("/root/initData/dataSet/xx_dspch_clsf_020")) {
									dspch_clsf2 =  base_alon;
								}
							}
						}	

						//if(parseInt(rptv_posi_cd) >=  52) { 120207
						if(Number(rptv_posi_cd) >=  Number(model1.getValue("/root/initData/dataSet/xx_rptv_posi_cd_030"))  ) {
							for(var i = 0; i <= nodelist.length; i++)
							{
								var pay_basi_clsf = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/pay_basi_clsf");
								var dspch_clsf = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/dspch_clsf");
								var base_alon = model1.getValue("/root/resData/base_alon_clsf/record[" + i + "]/base_alon");
								
								//if(pay_basi_clsf=="30" && dspch_clsf == "1") { 120207
								if(pay_basi_clsf==model1.getValue("/root/initData/dataSet/xx_pay_basi_clsf_030") && dspch_clsf == model1.getValue("/root/initData/dataSet/xx_dspch_clsf_010")) {
									dspch_clsf1 =  base_alon;
								}
								//if(pay_basi_clsf=="30" && dspch_clsf == "2") { 120207
								if(pay_basi_clsf==model1.getValue("/root/initData/dataSet/xx_pay_basi_clsf_030") && dspch_clsf == model1.getValue("/root/initData/dataSet/xx_dspch_clsf_020")) {
									dspch_clsf2 =  base_alon;
								}
							}
						}	
						
						//if(stay_clsf=="1"){ 120207
						if(stay_clsf==model1.getValue("/root/initData/dataSet/xx_stay_clsf_010")){
							model1.setValue("/root/resData/gridData/record[" + row + "]/dd_fee",dspch_clsf1);
						}else{
							model1.setValue("/root/resData/gridData/record[" + row + "]/dd_fee",dspch_clsf2);
						}
						
						
						var  busi_trip_frdt =model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_frdt");
						var  busi_trip_todt =model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_todt");
						var  dd_fee =model1.getValue("/root/resData/gridData/record[" + row + "]/dd_fee");

						var getDay2 ;
						
						if(busi_trip_frdt !="" && busi_trip_todt != "") {
							getDay2 =  getDay(busi_trip_frdt, busi_trip_todt);
	
							if(getDay2 == 0) {
								model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_frdt","");
								model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_todt","");
							}
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_dds",getDay2);

							busi_trip_dds = model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_dds");
							
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_fee_stot", parseInt(busi_trip_dds) * parseInt(dd_fee));	
						} else {
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_dds","");
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_fee_stot", "");	
						}	
					}

					var row =datagrid2.row;					

					if(datagrid2.col==datagrid2.colRef("chkbox")) {  
	
						if(datagrid2.valueMatrix(row, datagrid2.colRef("chkbox"))=="1"){
							datagrid2.rowStatus(row) = 2;
						}else if(datagrid2.valueMatrix(row, datagrid2.colRef("chkbox"))=="0"){
							datagrid2.rowStatus(row) = 0;
						}		
					} else {  
						if(datagrid2.rowStatus(row)=="3" ) {
							datagrid2.valueMatrix(row, datagrid2.colRef("chkbox")) = "1";
						} else {
							datagrid2.valueMatrix(row, datagrid2.colRef("chkbox")) = "1";
							datagrid2.rowStatus(row) = 2;
						}
					}	

					if(datagrid2.col==datagrid2.colRef("stay_area")) {
						var stay_area_val =  model1.getValue("/root/resData/gridData/record[" + row + "]/stay_area");
						if(!isByteLength(stay_area_val,20)) {
//						if(stay_area_val.length>10) {
							alert("허용된 글자수를 초과했습니다");
							model1.setValue("/root/resData/gridData/record[" + row + "]/stay_area","");
						}
					}
					if(datagrid2.col==datagrid2.colRef("busi_trip_purp")) {
						var busi_trip_purp_val =  model1.getValue("/root/resData/gridData/record[" + row + "]/busi_trip_purp");
						if(!isByteLength(busi_trip_purp_val,60)) {
//						if(busi_trip_purp_val.length>30) {
							alert("허용된 글자수를 초과했습니다");
							model1.setValue("/root/resData/gridData/record[" + row + "]/busi_trip_purp","");
						}
					}
					if(col == 10){
						var total = model1.getValue("/root/resData/gridData/record["+row+"]/busi_trip_dds") * model1.getValue("/root/resData/gridData/record["+row+"]/dd_fee");
						model1.setValue("/root/resData/gridData/record["+row+"]/busi_trip_fee_stot", (Math.round(total/100))*100);
						datagrid2.refresh();
					}
					if(col == 11){
						var total = model1.getValue("/root/resData/gridData/record["+row+"]/busi_trip_dds") * model1.getValue("/root/resData/gridData/record["+row+"]/dd_fee");
						model1.setValue("/root/resData/gridData/record["+row+"]/busi_trip_fee_stot", (Math.round(total/100))*100);
						datagrid2.refresh();
					}
					if(col == 13){
						var total = model1.getValue("/root/resData/gridData/record["+row+"]/busi_trip_dds") * model1.getValue("/root/resData/gridData/record["+row+"]/dd_fee");
						model1.setValue("/root/resData/gridData/record["+row+"]/busi_trip_fee_stot", (Math.round(total/100))*100);
						datagrid2.refresh();
					}
				]]>
			</script>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var row = datagrid2.row;
					
					var pattern = ","+model1.getValue("/root/resData/gridData/record["+row+"]/proc_clsf")+",";
					var validation  = (","+model1.getValue("/root/initData/dataSet/xx_proc_clsf_030")+",").indexOf(pattern)==-1;
					
					//120207
					//if(model1.getValue("/root/resData/gridData/record["+row+"]/proc_clsf") != "13" && model1.getValue("/root/resData/gridData/record["+row+"]/proc_clsf") != "21"){
					if(validation){
						//alert("현업등록취소, 인사금액확정취소 상태가 아닌 데이터는 삭제할 수 없습니다.");
						return;
					}else{
						rowStatus(datagrid2);
					}
				]]>
			</script>
		</datagrid>
		<group id="group_btnG1" class="gro_btn" style="left:10px; top:115px; width:926px; height:20px; ">
			<button id="button5" class="btn_grid03" visibility="hidden" style="left:864px; top:0px; width:53px; height:17px; ">
				<caption>행추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						var rowCnt = datagrid2.rows;
						var selectedIdx = datagrid2.rows-1;
						var emp_no     = model1.getValue("/root/resData/gridData/record[1]/emp_no");	
						
						if(emp_no == ""){
							if(datagrid2.isReadOnly(1,1) ==true) {
								datagrid2.isReadOnly(1, 1, 1, 13)  =false;
								datagrid2.addStatus(selectedIdx, "insert");
							} else {
								datagrid2.addRow(true, true);
								datagrid2.isReadOnly(rowCnt , 2)  =true;
							}
						}else{
							datagrid2.addRow(true, true);
							datagrid2.isReadOnly(rowCnt , 2)  =true;
						}
					
						model1.makeNode("/root/resData/resForm/temp");
						model1.setValue("/root/resData/resForm/temp", "1");
					
					]]>
				</script>
			</button>
			<!--
			<button id="button2" class="btn_grid03" style="left:806px; top:0px; width:52px; height:17px; ">
				<caption>행삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if(datagrid2.isReadOnly(1,1) == 1 && datagrid2.valueMatrix(1,2) == "" ) {return;}
					var selectedIdx = datagrid2.row;
					var proc_stat = model1.getValue("/root/resData/gridData/record["+ selectedIdx +"]/proc_clsf");
					if(proc_stat == '29' || proc_stat == '36'){ //전표등록일경우		
						return;
					}
					else{
						datagrid2.addStatus(selectedIdx, "delete");
						datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("chkbox")) = "true";
						model1.makeNode("/root/resData/resForm/temp");
						model1.setValue("/root/resData/resForm/temp", "1");
						
					}
				
					]]>
				</script>
			</button>
			<button id="button8" class="btn_grid03" style="left:862px; top:0px; width:52px; height:17px; ">
				<caption>행취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						datagrid2.rowStatus(datagrid2.row) = "0";
						datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("chkbox")) = "false";						
//						var firstRow = datagrid2.selectedRow(datagrid2.row);
//						var lastRow = datagrid2.selectedRow(datagrid2.selectedRows-1);
//						
//						for(var i=firstRow;i<=lastRow;i++){
//							if(datagrid2.rowStatus(i) == "1" || datagrid2.rowStatus(i) == "3"){
//								datagrid2.removeRow(i);
//								i - -;
//							}else if(datagrid2.rowStatus(i) == "4"){
//								datagrid2.rowStatus(i) = "0";
//							}else{
//								datagrid2.rowStatus(i) = "0";
//							}
//						}				
					]]>
				</script>
			</button>
-->
		</group>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:38px; width:926px; height:21px; ">
			<button id="btnA1" class="btn02" style="left:317px; top:0px; width:52px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (datagrid2.rows < 2) {
							alert("저장할 대상이 없습니다.");
							return;
						}

						var i =0, var_check_row = 0;
						for (i = 1; i < datagrid2.rows; i++) {
				 			if (datagrid2.rowStatus(i) != 0) {
								var_check_row = var_check_row + 1;
							}
						}

						if (var_check_row == 0) {
							alert("저장할 데이터를 선택하십시오.");
							return;       
						}
						
						/*
						var temp = model1.getValue("/root/resData/resForm/temp");
						
						if(temp == ""){
							alert("등록 및 삭제 하실 데이터를 입력 또는 선택하신 후 저장 해주세요.");
							return;
						}else if(temp == "1"){
							
						var selectedIdx = datagrid2.rows-1;
						*/			
						if (!commGridReqCheck("datagrid2"))
							return;
						 
	 					if (window.alert("저장하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						
						/*for (i = 1; i < datagrid2.rows; i++) {
							if (datagrid2.valueMatrix(i, datagrid2.colRef("proc_clsf")) != "10")
								datagrid2.rowStatus(i) = 0;
						}*/
						
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_trip_1901");
	
						if(submit_completed()) {
							//model1.reset();
							gridSearchList();
						}
					]]>
				</script>
			</button>
			<button id="btnA2" class="btn02" style="left:208px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model1.reset();
					datagrid2.removeRow();
					]]>
				</script>
			</button>
			<button id="button7" class="btn02" style="left:874px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
				 	viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					]]>
				</script>
			</button>
			<button id="button1" class="btn05" style="left:626px; top:0px; width:110px; height:21px; ">
				<caption>발행(전표등록)</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (datagrid2.rows < 2) {
							alert("발행(전표등록)할 대상이 없습니다.");
							return;
						}

						var i = 0, var_check_row = 0;
						
						for (i = 1; i < datagrid2.rows; i++) {
							if (datagrid2.rowStatus(i) != 0) {
								var_check_row = var_check_row + 1;
							}
							       
							var proc_stat = model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf");
							
							var pattern = ","+proc_stat+",";
							var validation  = (","+model1.getValue("/root/initData/dataSet/xx_proc_clsf_040")+",").indexOf(pattern)>-1;

							//전표 등록 체크
							//if(proc_stat == 16 || proc_stat == 28){ //120207
							if(validation){
								flag = false;
							}
						}

						if (var_check_row == 0) {
							alert("발행(전표등록)할 대상을 선택하십시오.");
							return;       
						}	
						
						for (i = 1; i < datagrid2.rows; i++) {
							var proc_clsf = model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf");
							var chkbox = datagrid2.valueMatrix(i, datagrid2.colRef("chkbox"));
							
							if (chkbox == 1){
								var pattern = ","+proc_clsf+",";
								var validation  = (","+model1.getValue("/root/initData/dataSet/xx_proc_clsf_040")+",").indexOf(pattern)==-1;
								//if (proc_clsf != 16 && proc_clsf != 28) { //120207
								if (validation) {
									alert("현업발행 처리가 되지 않은 행이 있습니다. 현업발행를 수행한 후 진행하십시오.");
									return;
								}
							}
						}
						
						if (window.alert("전표생성 하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						
						for (var i = 0; i < datagrid2.rows; i++){
							var proc_stat = model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf");	
							
							var pattern = ","+proc_stat+",";
							var validation  = (","+model1.getValue("/root/initData/dataSet/xx_proc_clsf_040")+",").indexOf(pattern)>-1;
												
							//if(proc_stat == 16  || proc_stat == 28){ 120207
							if(validation){
								if (datagrid2.rowStatus(i) == 2) {
									datagrid2.addStatus(i, "insert");	
								}
							}
						}
						
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_trip_1904");
						var actu_slip_no = model1.getValue("/root/tempData/CURLIST/record/actu_slip_no");
						model1.removenode("/root/tempData");
						datagrid2.clearStatus();		
						
						if(submit_completed()) {			
							gridSearchList()				
							
							// 오즈관련 노드 초기화..					
						 	resetOznode();					
						 						
						 	// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
						 	makeNodeValue("/root/oz_data/ozrName","hd/HD_TRIP_1906");
							makeNodeValue("/root/oz_data/preview","preview"); 			//preview : 미리보기, print : 인쇄
							//makeNodeValue("/root/oz_data/printsize",""); 				//페이지용지설정(기본 A4)																				
							makeNodeValue("/root/oz_data/printsize","B5 (JIS)");   //페이지용지설정(기본 A4)										
											
						 	// odi 파라미터 설정.					
						 	makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , getProperty("ss_cmpycd") );
							makeNodeValue("/root/oz_data/odiParam/iv_actu_slip_no" , actu_slip_no );
							makeNodeValue("/root/oz_data/odiParam/iv_busi_trip_frdt" , model.getValue("/root/reqData/searchData/busi_trip_frdt"));
							makeNodeValue("/root/oz_data/odiParam/iv_busi_trip_todt" ,model.getValue("/root/reqData/searchData/busi_trip_todt"));
							makeNodeValue("/root/oz_data/odiParam/iv_proc_stat" , model.getValue("/root/reqData/searchData/proc_stat"));
							makeNodeValue("/root/oz_data/odiParam/iv_incmg_pers" , getProperty("ss_emp_no") );
							
						 	// 레포트뷰어 호출.					
						 	openOzwin("/root/oz_data");	
						}						
					]]>
				</script>
			</button>
			<button id="button3" class="btn02" style="left:263px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						gridSearchList();
					]]>
				</script>
			</button>
			<button id="button4" class="btn03" style="left:807px; top:0px; width:65px; height:21px; ">
				<caption>발행취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
 						if(searchFlag == false || actu_slip_no_in.value == ""){
							alert("취소할 전표번호를 입력하여 조회 후 진행하십시오.");	
							return;
						}

						if (datagrid2.rows < 2) {
							alert("취소할 전표가 존재하지 않습니다.");
							return;
						}

//						var i =0, var_check_row = 0,;
//						for (i=1; i<datagrid2.rows; i++) {
//				 		     	if (datagrid2.rowStatus(i) != 0) {
//								var_check_row = var_check_row + 1;
//						       }
//						       
//							var proc_stat = model1.getValue("/root/resData/slipData/record["+i+"]/proc_stat");
//							//전표 등록 체크
//							if(proc_stat == 29 || proc_stat == 36){
//							} else {
//								flag = false;
//							}						       
//						}

//					       if (var_check_row == 0) {
//							alert("저장 또는 신청 확인할 데이터를 선택 후  사용하세요.");
//					   		return;       
//					       }	

						for (i = 1; i < datagrid2.rows; i++) {
							var proc_stat = model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf");
							
							var pattern = ","+proc_stat+",";
							var validation  = (","+model1.getValue("/root/initData/dataSet/xx_proc_clsf_020")+",").indexOf(pattern)>-1;

							//전표 등록 체크
							//if(proc_stat == 29 || proc_stat == 36){ 120207
							if(validation){
								datagrid2.addStatus(i, "update");								
							} else {
								alert("취소할 전표가 존재하지 않습니다.");
								return;
							}						       
						}					
											
//						if(datagrid1.rows == -1){
//							alert("취소할 전표가 없습니다.");
//							return;
//						}					
//						if(datagrid1.rows == 1){
//							alert("취소할 전표번호를 조회해 주세요2.");	
//							return;
//						}					
//						for(var i=1; i<datagrid1.rows;i++){
//							var proc_stat = model1.getValue("/root/resData/slipData/record["+i+"]/proc_stat");
////							var actu_slip_no = model1.getValue("/root/resData/slipData/record["+i+"]/actu_slip_no");
//							//전표 등록 체크
//							if(proc_stat == 29 || proc_stat == 36){
//							}else{
//								alert("취소할 전표번호를 조회해 주세요3.");
//								return;								
//							}
//						}
						setDeleteSlipValue();
						if (window.alert("전표를 취소하시겠습니까?", "확인", 1) != 1) {
							return;
						}

//						for(var i=0;i<datagrid2.rows;i++){
//							var proc_stat = model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf");						
//							if(proc_stat == 14  || proc_stat == 28){
////					 		     	if (datagrid2.rowStatus(i) == 2) {
//									datagrid2.addStatus(i, "update");	
////					 		     	}
//							}
//						}
						
//						for(var i=1;i<datagrid2.rows;i++) {
//							var status = datagrid2.rowstatus(i);
//
//							if(status == 2){
//								datagrid2.addStatus(i, "update"); 
//							}
//						}						
//						for(var i=0;i<datagrid2.rows;i++){ 
//							datagrid2.addStatus(i, "update");							
//						}
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_trip_1905");
//						datagrid1.clearStatus();
						datagrid2.clearStatus();
						if(submit_completed()) {
							//alert('전표취소 되었습니다.');
							//model1.reset();
							gridSearchList()						
						}						
					]]>
				</script>
			</button>
			<button id="button6" class="btn03" visibility="visible" style="left:740px; top:0px; width:65px; height:21px; ">
				<caption>장표출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							//var iv_actu_slip_no     = datagrid1.valueMatrix(1,  datagrid1.colRef("actu_slip_no"));	
							var iv_actu_slip_no     = model1.getValue("/root/reqData/searchData/actu_slip_no"); 	
							iv_busi_trip_frdt		 = model1.getValue("/root/reqData/searchData/busi_trip_frdt"); 	
							iv_busi_trip_todt 	 = model1.getValue("/root/reqData/searchData/busi_trip_todt"); 	
							iv_proc_stat 		 = model1.getValue("/root/reqData/searchData/proc_stat"); 	
							
							if(iv_busi_trip_frdt == "") {
								alert("출장기간 시작일을  입력해주세요.");
								return;
							}
							if(iv_busi_trip_todt == "") {
								alert("출장기간 종료일을  입력해주세요.");
								return;
							}
							
							if(iv_actu_slip_no == "") {
								alert("전표번호를  입력해주세요.");
								return;
							}
							
							// 오즈관련 노드 초기화..					
						 	resetOznode();					
						 						
						 	// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
						 	makeNodeValue("/root/oz_data/ozrName","hd/HD_TRIP_1906");
							makeNodeValue("/root/oz_data/preview","preview"); 	//preview : 미리보기, print : 인쇄
							//makeNodeValue("/root/oz_data/printsize"); 			//페이지용지설정(기본 A4)	
							makeNodeValue("/root/oz_data/printsize","B5 (JIS)");   //페이지용지설정(기본 A4)															
										
						 	// odi 파라미터 설정.					
						 	makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , getProperty("ss_cmpycd") );
							makeNodeValue("/root/oz_data/odiParam/iv_actu_slip_no" , iv_actu_slip_no );
							makeNodeValue("/root/oz_data/odiParam/iv_busi_trip_frdt" , iv_busi_trip_frdt );
							makeNodeValue("/root/oz_data/odiParam/iv_busi_trip_todt" , iv_busi_trip_todt );
							makeNodeValue("/root/oz_data/odiParam/iv_proc_stat" , iv_proc_stat );
							makeNodeValue("/root/oz_data/odiParam/iv_incmg_pers" , getProperty("ss_emp_no") );
							
			
						 	// 레포트뷰어 호출.					
						 	openOzwin("/root/oz_data");	
					]]>
				</script>
			</button>
			<button id="button2" class="btn02" style="left:371px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
//						var check_cnt = "";
//						for (var i=1; i<datagrid2.rows; i++){
//							if (datagrid2.valueMatrix(i, datagrid2.colRef("chkbox")) == "1"){
//								// 13, 21만 삭제 가능
//								check_cnt = "1";
//								if(model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf") != "13" && model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf") != "21"){
//									alert("현업등록취소, 인사금액확정취소 상태가 아닌 데이터는 삭제할 수 없습니다.");
//									return;
//								}
//							}
//						}
						if(!rowDelSubmit(datagrid2)){return;}
//						//return;
//						if(check_cnt != "1"){
//							alert("삭제 할 데이터를 선택해 주세요.");
//							return;
//						}
						if (window.alert("삭제하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						model1.setValue("/root/reqData/mode_gubun", "D");
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_trip_1901");
	
						if(submit_completed()) {
							//model1.reset();
							gridSearchList();
						}
					]]>
				</script>
			</button>
			<button id="button8" class="btn03" visibility="visible" style="left:425px; top:0px; width:65px; height:21px; ">
				<caption>등록취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var check_cnt = "";
						for (var i=1; i<datagrid2.rows; i++){
							if (datagrid2.valueMatrix(i, datagrid2.colRef("chkbox")) == "1"){
								// 10만 등록취소 가능
								check_cnt = "1";
								//if(model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf") != "10"){ 120207
								if(model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf") != model1.getValue("/root/initData/dataSet/xx_proc_clsf_050")){
									alert("현업등록 상태가 아닌 데이터는 등록취소할 수 없습니다.");
									return;
								}
							}
						}
						if(check_cnt != "1"){
							alert("등록취소 할 데이터를 선택해 주세요.");
							return;
						}
						if (window.alert("등록취소 하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						//model1.setValue("/root/reqData/mode_gubun", "13"); 120207
						model1.setValue("/root/reqData/mode_gubun", model1.getValue("/root/initData/dataSet/xx_mode_gubun_010"));
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_trip_1109");
						if(submit_completed()) {
							//model1.reset();
							gridSearchList();
						}	
					]]>
				</script>
			</button>
			<button id="button9" class="btn03" visibility="visible" style="left:492px; top:0px; width:65px; height:21px; ">
				<caption>금액확정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var sendFlagok = false;
	 					for(var i=1;i<datagrid2.rows;i++){
	 						var flag = datagrid2.valueMatrix(i, datagrid2.colRef("chkbox"))
	 						var proc_stat = model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf");
	 						if(flag == "1"){ sendFlagok = true;}//행체크여부
	 						//if(flag == "1" && proc_stat == "29"){ 120207
	 						if(flag == "1" && proc_stat == model1.getValue("/root/initData/dataSet/xx_proc_clsf_060")){
								alert("전표발행한 행은 금액확정 할수없습니다.");									 							
								return;
	 						}
						}
						if(sendFlagok == false){
							alert("선택된 행이 없습니다.");
							return;
						}
						if (window.alert("금액확정하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.send("hd_trip_1901");
						model1.setValue("/root/reqData/searchData/cost_fix_yn","Y");
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						datagrid1.clearStatus();
						model1.send("hd_trip_1105");
						if(submit_completed()) {
							//model1.reset();
							gridSearchList();
						}
					]]>
				</script>
			</button>
			<button id="button10" class="btn03" visibility="visible" style="left:559px; top:0px; width:65px; height:21px; ">
				<caption>확정취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var sendFlagcancel = false;
						var sendFlagblank = true;
	 					for(var i=1;i<datagrid2.rows;i++){
	 						var flag = datagrid2.valueMatrix(i, datagrid2.colRef("chkbox"));
	 						var proc_stat = model1.getValue("/root/resData/gridData/record["+i+"]/proc_clsf");
	 						var cost_fix_clsf = model1.getValue("/root/resData/gridData/record["+i+"]/cost_fix_clsf");
	 						if(flag == "1"){ sendFlagcancel = true;}//행체크여부
	 						//if(flag == "1" && proc_stat == "01" && cost_fix_clsf != "Y"){ sendFlagblank = false;}//금액확정전 확정취소  120207
	 						if(flag == "1" && proc_stat == model1.getValue("/root/initData/dataSet/xx_proc_clsf_070") && cost_fix_clsf != "Y"){ sendFlagblank = false;}//금액확정전 확정취소
	 						
	 						//if(flag == "1" && proc_stat == "10"){  120207
	 						if(flag == "1" && proc_stat == model1.getValue("/root/initData/dataSet/xx_proc_clsf_050")){
								alert("전자결재한 행은 확정취소 할수없습니다.");									 							
								return;
	 						}
	 						//if(flag == 1 && proc_stat == "29"){  120207
	 						if(flag == 1 && proc_stat == model1.getValue("/root/initData/dataSet/xx_proc_clsf_060")){
								alert("전표발행한 행은 확정취소 할수없습니다.");	
								return;
	 						}
						}					
						if(sendFlagblank == false){
							alert("금액확정 하기전 취소 할수 없습니다..");
							return;
						}
						if(sendFlagcancel == false){
							alert("선택된 행이 없습니다.");
							return;
						}
						if (window.alert("확정취소하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						model1.setValue("/root/reqData/searchData/cost_fix_yn","N");
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						datagrid1.clearStatus();
						model1.send("hd_trip_1105");
						if(submit_completed()) {
							//model1.reset();
							gridSearchList();
						}	
					]]>
				</script>
			</button>
		</group>
		<group id="group_scr" class="gro_sel" style="left:10px; top:61px; width:926px; height:26px; ">
			<caption id="caption3" class="list_cap02" style="left:84px; top:0px; width:840px; height:25px; text-align:center; "/>
			<caption id="caption18" class="list_cap01" style="left:1px; top:0px; width:85px; height:25px; text-align:center; ">파견기간</caption>
			<input id="busi_trip_frdt" ref="/root/reqData/searchData/busi_trip_frdt" inputtype="date" format="yyyy-mm-dd" appearance="input" style="left:90px; top:4px; width:107px; height:18px; "/>
			<caption id="caption11" style="left:198px; top:6px; width:25px; height:15px; text-align:center; ">~</caption>
			<input id="busi_trip_todt" ref="/root/reqData/searchData/busi_trip_todt" inputtype="date" format="yyyy-mm-dd" appearance="input" style="left:222px; top:4px; width:102px; height:18px; "/>
			<select1 id="combo1" ref="/root/reqData/searchData/proc_stat" appearance="minimal" style="left:428px; top:3px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/temp_cd1/item">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</select1>
			<caption id="caption1" class="list_cap01" style="left:340px; top:0px; width:85px; height:25px; text-align:center; ">진행상태</caption>
			<input id="actu_slip_no_in" ref="/root/reqData/searchData/actu_slip_no" navindex="4" format="99999999-99-999" style="left:638px; top:3px; width:97px; height:18px; "/>
			<caption id="caption2" class="list_cap01" style="left:545px; top:0px; width:90px; height:25px; text-align:center; ">전표번호</caption>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/slipData/record" visibility="hidden" caption="회사코드^사번^부서^이름^차변금액(개인)^대변금액(총합계)^적요1^전표관리번호^전표일련번호^전표발생일자^전표구분코드^입력자^입력자IP^진행상태^부서명^적요2" colsep="#" colwidth="63, 79, 100, 100, 100, 114, 191, 100, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:8px; top:335px; width:920px; height:110px; ">
			<col ref="cmpy_cd"/>
			<col ref="emp_no"/>
			<col ref="dept_cd"/>
			<col ref="flnm"/>
			<col ref="tmp_dr_amt" format="#,###"/>
			<col ref="tmp_crdt_amt" format="#,###"/>
			<col ref="titl"/>
			<col ref="actu_slip_no"/>
			<col ref="slip_seq"/>
			<col ref="slip_occr_dt"/>
			<col ref="slip_clsf_cd"/>
			<col ref="incmg_pers"/>
			<col ref="incmg_pers_ipadd"/>
			<col ref="proc_stat"/>
			<col ref="dept_nm"/>
			<col ref="titl2"/>
		</datagrid>
		<caption id="gridrowcnt" style="left:835px; top:705px; width:100px; height:20px; text-align:right; "/>
	</xhtml:body>
</xhtml:html>
