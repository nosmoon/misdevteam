<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>해외출장신청</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<busi_trip_fee_burd_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</busi_trip_fee_burd_clsf>
							<natn_cd>
								<item>
									<label/>
									<value/>
								</item>
							</natn_cd>
							<!-- 선택계열의 정보를 담당 -->
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<!-- 검색조건 처리 -->
						<reqForm>
							<emp_no/>
							<nm_korn/>
							<dept_nm/>
							<dept_cd/>
							<cmpy_cd/>
							<dty_cd/>
							<dty_nm/>
							<together_clsf>10</together_clsf>
							<busi_trip_dest/>
							<busi_trip_purp/>
							<busi_trip_frdt/>
							<busi_trip_todt/>
							<busi_trip_dds/>
							<invit_instt/>
							<busi_trip_fee_burd_clsf/>
							<busi_trip_neces/>
							<aviat_fee/>
							<stay_fee/>
							<dd_fee/>
							<aviat_fee_yn/>
							<stay_fee_yn/>
							<dd_fee_yn/>
							<ceph_use_yn/>
							<posi_nm/>
							<posi_cd/>
							<natn_cd/>
						</reqForm>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<!-- MultiUpDate유형 사용시 처리 -->
						<searchData>
							<emp_no/>
							<nm_korn/>
							<together_clsf>10</together_clsf>
							<proc_stat_clsf>10</proc_stat_clsf>
						</searchData>
						<fwdData>
							<func_nm/>
						</fwdData>
						<multiUpData/>
						<multiUpData2/>
						<multiUpData3/>
						<paidhodyData>
							<paidhody_cnt/>
						</paidhodyData>
						<subSearchData>
							<cmpy_cd/>
							<occr_dt/>
							<seq/>
						</subSearchData>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<temp/>
						</resForm>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<msg/>
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<record>
								<cmpy_cd/>
								<emp_no/>
								<occr_dt/>
								<seq/>
								<with_seq/>
								<dept_cd/>
								<cd_nm/>
								<nm_korn/>
								<posi_nm/>
								<duty_dt/>
								<prsnt_tm/>
								<finish_dd_clsf/>
								<finish_tm/>
								<tot_duty_tm/>
								<proc_stat/>
								<alvc_use_dt/>
								<alvc_use_yn/>
								<alvc_use_yn_nm/>
								<hody_clsf/>
								<hody_clsf_nm/>
								<alvc_plan_dt/>
								<paidhody_cnt/>
								<proc_stat_nm/>
							</record>
						</gridData>
						<gridData2>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<record>
								<g_emp_no/>
								<g_cmpy_cd/>
								<g_occr_dt/>
								<g_seq/>
								<g_with_seq/>
								<g_dept_cd/>
								<g_flnm/>
								<g_dty_nm/>
								<g_dty_cd/>
								<g_dept_nm/>
								<g_posi_nm/>
								<g_posi_cd/>
							</record>
							<!-- datagrid2 -->
							<!-- datagrid3 -->
						</gridData2>
						<gridData3>
							<record>
								<e_cmpy_cd/>
								<e_emp_no/>
								<e_occr_dt/>
								<e_seq/>
								<e_sub_seq/>
								<e_with_seq/>
								<e_etc_cost_ptcr/>
								<e_etc_cost/>
								<e_etc_cost_neces/>
							</record>
						</gridData3>
						<gridData4>
							<record>
								<d_cmpy_cd/>
								<d_emp_no/>
								<d_occr_dt/>
								<d_seq/>
								<d_sub_seq/>
								<d_with_seq/>
								<d_start_area/>
								<d_midl_start_dt/>
								<d_dest/>
								<d_busi_trip_cont/>
							</record>
						</gridData4>
						<empData>
							<cmpy_cd/>
							<emp_no/>
							<nm_korn/>
							<dept_cd/>
							<dept_nm/>
							<dty_nm/>
							<dty_cd/>
							<posi_nm/>
							<posi_cd/>
						</empData>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
				
					var mode = "";
				
					function DateDemo()
					{
						var s="";
						var mydate=new Date() 
						var year=mydate.getYear() 
						    if (year < 1000) 
						        year+=1900 
						
						var day=mydate.getDay() 
						var month=mydate.getMonth()+1 
						    if (month<10) 
						        month="0"+month 
						
						var daym=mydate.getDate() 
						    if (daym<10) 
						        daym="0"+daym 
						s  = year+month;
					       return(s);
					}
					
					// 동행 검색 
					function setGridEmpInfo(emp_no, nm_korn)
					{
						var n_row = datagrid2.row;
						
						model1.setValue("/root/reqData/searchData/emp_no",emp_no);
						model1.send("hd_trip_1301");
						
						model1.copyNode("/root/resData/empData","/root/tempData/trip_person/record");

						var dept_cd = model1.getValue("/root/resData/empData/dept_cd");
						var dept_nm = model1.getValue("/root/resData/empData/dept_nm");
						var emp_no = model1.getValue("/root/resData/empData/emp_no");
						var nm_korn = model1.getValue("/root/resData/empData/nm_korn");
						var posi_nm = model1.getValue("/root/resData/empData/posi_nm");
						var posi_cd = model1.getValue("/root/resData/empData/posi_cd");
						var dty_nm = model1.getValue("/root/resData/empData/dty_nm");
						var dty_cd = model1.getValue("/root/resData/empData/dty_cd");
						
						var cmpy_cd = model1.getValue("/root/resData/empData/cmpy_cd");
					
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_cmpy_cd", cmpy_cd);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_dept_cd", dept_cd);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_dept_nm", dept_nm);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_emp_no", emp_no);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_nm_korn", nm_korn);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_posi_nm", posi_nm);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_posi_cd", posi_cd);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_dty_nm", dty_nm);
						model1.setValue("/root/resData/gridData2/record[" + n_row + "]/g_dty_cd", dty_cd);
						
						datagrid2.refresh();
					}
					
					// 출장자 검색
					function setEmpInfo(emp_no, nm_korn)
					{
						model1.setValue("/root/reqData/searchData/emp_no", emp_no);
						model1.setValue("/root/reqData/searchData/nm_korn", nm_korn);
						
						model1.send("hd_trip_1301");
						
						model1.copyNode("/root/resData/empData","/root/tempData/trip_person/record");
						
						var dept_cd = model1.getValue("/root/resData/empData/dept_cd");
						var dept_nm = model1.getValue("/root/resData/empData/dept_nm");
						var emp_no = model1.getValue("/root/resData/empData/emp_no");
						var nm_korn = model1.getValue("/root/resData/empData/nm_korn");
						var posi_nm = model1.getValue("/root/resData/empData/posi_nm");
						var posi_cd = model1.getValue("/root/resData/empData/posi_cd");
						var dty_nm = model1.getValue("/root/resData/empData/dty_nm");
						var dty_cd = model1.getValue("/root/resData/empData/dty_cd");
						
						var cmpy_cd = model1.getValue("/root/resData/empData/cmpy_cd");
						
						
						model1.setValue("/root/reqData/reqForm/cmpy_cd", cmpy_cd);
						model1.setValue("/root/reqData/reqForm/dept_cd", dept_cd);
						model1.setValue("/root/reqData/reqForm/dept_nm", dept_nm);
						model1.setValue("/root/reqData/reqForm/emp_no", emp_no);
						model1.setValue("/root/reqData/reqForm/nm_korn", nm_korn);
						model1.setValue("/root/reqData/reqForm/posi_nm", posi_nm);
						model1.setValue("/root/reqData/reqForm/posi_cd", posi_cd);
						model1.setValue("/root/reqData/reqForm/dty_nm", dty_nm);
						model1.setValue("/root/reqData/reqForm/dty_cd", dty_cd);

						model1.refresh();
					}

					function isByteLength(data, maxlen) {
					    var len = data.length;
					    for (i = 0; i < data.length; i++){
					        if (data.charCodeAt(i)  > 127){
					            len++;
					        }
					    }
					    
					    if (len > maxlen) {
					        return false;
					    } else {
					        return true;
					    }
					}	

				//근무시간 구하기
				function getDay(busi_trip_frdt, busi_trip_todt)
				{
					var busi_trip_frdt_month = (busi_trip_frdt.substr(4,1) == "0")? busi_trip_frdt.substr(5,1) :  busi_trip_frdt.substr(4,2);
					var busi_trip_todt_month = (busi_trip_todt.substr(4,1) == "0")? busi_trip_todt.substr(5,1) :  busi_trip_todt.substr(4,2);
					var busi_trip_frdt_day = (busi_trip_frdt.substr(6,1) == "0")? busi_trip_frdt.substr(7,1) :  busi_trip_frdt.substr(6,2);
					var busi_trip_todt_day = (busi_trip_todt.substr(6,1) == "0")? busi_trip_todt.substr(7,1) :  busi_trip_todt.substr(6,2);

					var busi_trip_frdt_date = new Date(busi_trip_frdt.substr(0,4),busi_trip_frdt_month,busi_trip_frdt_day);   
					var busi_trip_todt_date = new Date(busi_trip_todt.substr(0,4),busi_trip_todt_month,busi_trip_todt_day);  
					var daym = Math.floor((busi_trip_todt_date.getTime() - busi_trip_frdt_date.getTime())/(24*60*60*1000) +1);           

					if (daym < 1)  {
//						alert("날짜 선택이 잘못됐습니다");
						return 0;
					}
  						return daym;
				}									
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					if(model.getValue("/root/initData/pageInfo/pageID") == ""){
						maintitle.text = "해외출장신청";
						iv_Title.visible = false;  // 숨김
						iv_PopTitle.visible = true;  // 보임
					}else if(model.getValue("/root/initData/pageInfo/pageID") != ""){
						iv_Title.visible = true;  // 보임
						iv_PopTitle.visible = false;  // 숨김
					}
					model1.removenode("/root/resData/gridData/record[1]");
					model1.removenode("/root/resData/gridData2/record[1]");
					model1.removenode("/root/resData/gridData3/record[1]");
					model1.removenode("/root/resData/gridData4/record[1]");
				
					model1.send("hd_trip_1300");
					model1.copyNode("/root/initData/comboSet","/root/tempData");
					model1.refresh();
				
					mode="I";
									
//					datagrid2.isReadOnly(1, 1, 1, 4)  =true;
//					datagrid3.isReadOnly(1, 1, 1, 3)  =true;
//					datagrid4.isReadOnly(1, 1, 1, 4)  =true;
					
					var together_clsf = combo8.value;
					
					if(together_clsf == "10") {
						button5.disabled = true;
						button6.disabled = true;
					
					}
					
					input9.disabled = true;
					input10.disabled = true;
					input12.disabled = true;
					
					input9.refresh();
					input10.refresh();
					input12.refresh();
					

					var emp_no = getProperty("ss_emp_no");
					var cmpy_cd = getProperty("ss_cmpycd");
					setEmpInfo(emp_no,"");
										
					model1.refresh();					
			]]>
			</script>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<submission id="hd_co_1000" action="/hd/co/1000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_trip_1300" action="/hd/trip/1300" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1301" action="/hd/trip/1301" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1402" action="/hd/trip/1402" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_trip_1405" action="/hd/trip/1405" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_trip_1304" action="/hd/trip/1304" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/subSearchData" resultref="/root/tempData"/>
			<submission id="hd_trip_1403" action="/hd/trip/1403" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
		</model>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="1000" guideline="1,9;" style="font-family:굴림; ">
		<group id="group_scr" class="gro_sel" style="left:10px; top:54px; width:916px; height:26px; ">
			<caption id="caption10" class="list_cap02" style="left:104px; top:0px; width:810px; height:25px; text-align:center; "/>
			<caption id="caption9" class="list_cap01" style="left:0px; top:0px; width:105px; height:25px; text-align:center; ">작업구분</caption>
			<select1 id="combo1" ref="/root/reqData/searchData/proc_stat_clsf" appearance="minimal" style="left:111px; top:4px; width:100px; height:18px; ">
				<choices>
					<item>
						<label>신청대상</label>
						<value>10</value>
					</item>
					<item>
						<label>전체</label>
						<value>20</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
								
					]]>
				</script>
			</select1>
		</group>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:0px; top:5px; width:926px; height:29px; "/>
		<import id="iv_PopTitle" src="../../../common/xrw/iv_PopTitleBar.xrw" style="left:0px; top:5px; width:926px; height:29px; "/>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" scroll="auto" caption="부서^사번^성명^직책^목적지^출장시작일^출장종료일^진행상태" colsep="#" colwidth="110, 110, 110, 110, 140, 110, 110, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:10px; top:94px; width:913px; height:145px; ">
			<col ref="dept_nm"/>
			<col ref="emp_no"/>
			<col ref="nm_korn"/>
			<col ref="dty_nm"/>
			<col ref="busi_trip_purp"/>
			<col ref="busi_trip_frdt" format="yyyy-mm-dd"/>
			<col ref="busi_trip_todt" format="yyyy-mm-dd"/>
			<col ref="proc_stat_nm"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					datagrid2.clearStatus();
					datagrid3.clearStatus();
					datagrid4.clearStatus();
					
					var selectedIdx = datagrid1.row;
					
					
					var cmpy_cd = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/cmpy_cd");
					var occr_dt = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/occr_dt");
					var seq = model1.getValue("/root/resData/gridData/record[" + selectedIdx + "]/seq");

					model1.setValue("/root/reqData/subSearchData/cmpy_cd", cmpy_cd);
					model1.setValue("/root/reqData/subSearchData/occr_dt", occr_dt);
					model1.setValue("/root/reqData/subSearchData/seq",seq);
					
					model1.send("hd_trip_1304");
					
					model1.copyNode("/root/reqData/reqForm","/root/tempData/CURLIST/record");
					model1.copyNode("/root/resData/gridData2","/root/tempData/CURLIST2");
					model1.copyNode("/root/resData/gridData4","/root/tempData/CURLIST3");
					model1.copyNode("/root/resData/gridData3","/root/tempData/CURLIST4");
					model1.refresh();

					mode="U";
					
					for(var i=1;i<datagrid2.rows;i++) {
						datagrid2.isReadOnly(i, 1, i, 4)  =true;
					}
					
					datagrid3.isReadOnly(1, 1, 1, 3)  =false;
					datagrid4.isReadOnly(1, 1, 1, 4)  =false;
					
					var datagrid2_rows = datagrid2.rows - 1 
					
					
					if(datagrid2_rows>0){
						combo8.select(1);
						button5.disabled = false;
						button6.disabled = false;
					}else{
						combo8.select(0);
						button5.disabled = true;
						button6.disabled = true;
					}	
					
					input5.disabled = true;
					input7.disabled = true
					
					var aviat_fee_yn = model1.getValue("/root/reqData/reqForm/aviat_fee_yn");
					var stay_fee_yn = model1.getValue("/root/reqData/reqForm/stay_fee_yn");
					var dd_fee_yn = model1.getValue("/root/reqData/reqForm/dd_fee_yn");
					
					if(aviat_fee_yn=="1"){
						input9.disabled = false;
					} else {
						input9.disabled = true;
					}
					if(stay_fee_yn=="1"){
						input10.disabled = false;
					} else {
						input10.disabled = true;
					}
					if(dd_fee_yn=="1"){
						input12.disabled = false;
					} else {
						input12.disabled = true;
					}
			]]>
			</script>
		</datagrid>
		<group id="group_btnG1" class="gro_btn" style="left:10px; top:78px; width:916px; height:20px; ">
			<caption id="caption26" class="tit02" style="left:2px; top:0px; width:335px; height:20px; font-weight:bold; ">해외출장 신청 내역</caption>
		</group>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:33px; width:916px; height:21px; ">
			<button id="btnA1" class="btn02" style="left:810px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						
						model1.send("hd_trip_1403");
						model1.copyNode("/root/resData/gridData","/root/tempData");
						
						model1.refresh();
	
						input5.disabled = false;
						input7.disabled = false
						
							
//						datagrid2.isReadOnly(1, 1, 1, 4)  =true;
//						datagrid3.isReadOnly(1, 1, 1, 3)  =true;
//						datagrid4.isReadOnly(1, 1, 1, 4)  =true;
						
						combo1.refresh();
						mode="I";
				
					]]>
				</script>
			</button>
			<button id="btnA2" class="btn02" style="left:756px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model1.reset();
					
					datagrid1.clearStatus();
					datagrid2.clearStatus();
					datagrid3.clearStatus();
					datagrid4.clearStatus();
					input9.disabled = true;
					input10.disabled = true;
					input12.disabled = true;	
					
					input5.disabled = false;
					input7.disabled = false
						
					mode="I";									
					]]>
				</script>
			</button>
			<button id="button7" class="btn02" style="left:864px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
				 	if(model.getValue("/root/initData/pageInfo/pageID") != ""){
				 	viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					}else{
						window.close();
					}
					]]>
				</script>
			</button>
		</group>
		<group id="group2" style="left:10px; top:239px; width:918px; height:195px; ">
			<button id="button4" class="btn_grid04" style="left:760px; top:0px; width:67px; height:17px; ">
				<caption>임시저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var temp = model1.getValue("/root/resData/resForm/temp");
						
						var  busi_trip_frdt =input4.value;
						var  busi_trip_todt =input6.value;

						var getDay1;

						if(busi_trip_frdt !="" && busi_trip_todt != "") {
							getDay1 =  getDay(busi_trip_frdt, busi_trip_todt);
						}
						if(getDay1 == 0) {
							input4.value = "";
							input6.value = "";
							alert("출장 시작과 출장 종료 일자가 잘못 되었습니다");
							return false;
						}												
						// 출장목적
						if(!isByteLength(textarea1.value,50)) { 
							alert("허용된 글자수를 초과했습니다"); 
							textarea1.value = ""; 
							return false; 
						}
						// 목적지
						if(!isByteLength(input3.value,30)) { 
							alert("허용된 글자수를 초과했습니다"); 
							input3.value = ""; 
							return false; 
						}
						// 초청기관
						if(!isByteLength(input11.value,30)) { 
							alert("허용된 글자수를 초과했습니다"); 
							input11.value = ""; 
							return false; 
						}
						// 출장필요성
						if(!isByteLength(textarea2.value,50)) { 
							alert("허용된 글자수를 초과했습니다"); 
							textarea2.value = ""; 
							return false; 
						}						
						var selectedIdx = datagrid2.rows-1;
					
						model1.makeNode("/root/reqData/reqForm/mode");
						model1.setValue("/root/reqData/reqForm/mode",mode);

						if (!commReqCheck(group2)) {return false;}						
						if (!commReqCheck(group1)) {return false;}						
						if (!commReqCheck(group3)) {return false;}
						
						if(!commGridReqCheck("datagrid2")) return;
						if(!commGridReqCheck("datagrid4")) return;

//						if(!isByteLength(textarea1.value,10)) { alert("허용된 글자수를 초과했습니다"); 
//							return false; }
//						if(!isByteLength(input3.value,10)) { alert("허용된 글자수를 초과했습니다"); 
//							return false; }



//						var emp_no = model1.getValue("/root/reqData/reqForm/emp_no");
//
//						if(emp_no == ""){
//							alert("출장자를 입력해주세요.");
//							return;	
//						}
						 
	 					if (window.alert("저장하시겠습니까?", "확인", 1) != 1) {
							return;
						}
					
						for(var i=1;i<datagrid2.rows;i++) {
							var status = datagrid2.rowstatus(i);

							if(status == 0){
								datagrid2.addStatus(i, "update"); 
							}
						}
						
						
						for(var i=1;i<datagrid3.rows;i++) {
							if(datagrid3.rowstatus(i) != 0 ) {
								var val1 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost_ptcr");
								var val2 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost_neces");
		
								if(!isByteLength(val1,30)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost_ptcr","");
									return false;
								}
								if(!isByteLength(val2,50)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost_neces","");
									return false;
								}
	
								if(!isByteLength(val2,10)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost","");
									return false;
								}
							}								
							var status = datagrid3.rowstatus(i);

							if(status == 0){
								datagrid3.addStatus(i, "update"); 
							}
						}
						
						
						for(var i=1;i<datagrid4.rows;i++) {
							if(datagrid4.rowstatus(i) != 0 ) {
								var val1 =  model1.getValue("/root/resData/gridData4/record[" + i + "]/d_start_area");
								var val2 =  model1.getValue("/root/resData/gridData4/record[" + i + "]/d_dest");
								var val3 =  model1.getValue("/root/resData/gridData4/record[" + i + "]/d_busi_trip_cont");
		
								if(!isByteLength(val1,30)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData4/record[" + i + "]/d_start_area","");
									return false;
								}
	
								if(!isByteLength(val2,30)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData4/record[" + i + "]/d_dest","");
									return false;
								}
								if(!isByteLength(val3,50)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData4/record[" + i + "]/d_busi_trip_cont","");
									return false;
								}
							}
							var status = datagrid4.rowstatus(i);

							if(status == 0){
								datagrid4.addStatus(i, "update"); 
							}
						}
					
					
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.setValue("/root/reqData/multiUpData2", datagrid3.getUpdateData());
						model1.setValue("/root/reqData/multiUpData3", datagrid4.getUpdateData());
						model1.send("hd_trip_1402");
	
						if(submit_completed()) {
						//	alert("저장되었습니다.");
							model1.reset();

							datagrid1.clearStatus();
							datagrid2.clearStatus();
							datagrid3.clearStatus();
							datagrid4.clearStatus();
						}
					]]>
				</script>
			</button>
			<button id="button9" class="btn_grid02" style="left:872px; top:0px; width:42px; height:17px; ">
				<caption>신청</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var  busi_trip_frdt =input4.value;
						var  busi_trip_todt =input6.value;

						var getDay1;

						if(busi_trip_frdt !="" && busi_trip_todt != "") {
							getDay1 =  getDay(busi_trip_frdt, busi_trip_todt);
						}
						if(getDay1 == 0) {
							input4.value = "";
							input6.value = "";
							alert("출장 시작과 출장 종료 일자가 잘못 되었습니다");
							return false;
						}												
						// 출장목적
						if(!isByteLength(textarea1.value,50)) { 
							alert("허용된 글자수를 초과했습니다"); 
							textarea1.value = ""; 
							return false; 
						}
						// 목적지
						if(!isByteLength(input3.value,30)) { 
							alert("허용된 글자수를 초과했습니다"); 
							input3.value = ""; 
							return false; 
						}
						// 초청기관
						if(!isByteLength(input11.value,30)) { 
							alert("허용된 글자수를 초과했습니다"); 
							input11.value = ""; 
							return false; 
						}
						// 출장필요성
						if(!isByteLength(textarea2.value,50)) { 
							alert("허용된 글자수를 초과했습니다"); 
							textarea2.value = ""; 
							return false; 
						}						
						var selectedIdx = datagrid2.rows-1;
					
						model1.makeNode("/root/reqData/reqForm/mode");
						model1.setValue("/root/reqData/reqForm/mode",mode);

						if (!commReqCheck(group2)) {return false;}						
						if (!commReqCheck(group1)) {return false;}						
						if (!commReqCheck(group3)) {return false;}
						
						if(!commGridReqCheck("datagrid2")) return;
						if(!commGridReqCheck("datagrid4")) return;	

						if(!isByteLength(textarea1.value,10)) { return false; }
						if(!isByteLength(input3.value,10)) { return false; }



//						var emp_no = model1.getValue("/root/reqData/reqForm/emp_no");
//
//						if(emp_no == ""){
//							alert("출장자를 입력해주세요.");
//							return;	
//						}
						 
						for(var i=1;i<datagrid2.rows;i++) {
						var status = datagrid2.rowstatus(i);

							if(status == 0){
								datagrid2.addStatus(i, "update"); 
							}
						}
						
						
						for(var i=1;i<datagrid3.rows;i++) {
							if(datagrid3.rowstatus(i) != 0 ) {						
								var val1 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost_ptcr");
								var val2 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/e_etc_cost_neces");
		
								if(!isByteLength(val1,30)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/e_etc_cost_ptcr","");
									return false;
								}
								if(!isByteLength(val2,50)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/e_etc_cost_neces","");
									return false;
								}
	
								if(!isByteLength(val2,10)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/e_etc_cost","");
									return false;
								}
							}							
							var status = datagrid3.rowstatus(i);

							if(status == 0){
								datagrid3.addStatus(i, "update"); 
							}
						}
						
						
						for(var i=1;i<datagrid4.rows;i++) {
							if(datagrid4.rowstatus(i) != 0 ) {
								var val1 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/d_start_area");
								var val2 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/d_dest");
								var val3 =  model1.getValue("/root/resData/gridData3/record[" + i + "]/d_busi_trip_cont");
		
								if(!isByteLength(val1,30)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/d_start_area","");
									return false;
								}
	
								if(!isByteLength(val2,30)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/d_dest","");
									return false;
								}
								if(!isByteLength(val3,50)) {
									alert("허용된 글자수를 초과했습니다");
									model1.setValue("/root/resData/gridData/record[" + i + "]/d_busi_trip_cont","");
									return false;
								}
							}
							var status = datagrid4.rowstatus(i);

							if(status == 0){
								datagrid4.addStatus(i, "update"); 
							}
						}
					
	 					if (window.alert("신청하시겠습니까?", "확인", 1) != 1) {
							return;
						}
											
						model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
						model1.setValue("/root/reqData/multiUpData2", datagrid3.getUpdateData());
						model1.setValue("/root/reqData/multiUpData3", datagrid4.getUpdateData());

						model1.send("hd_trip_1405");

						if(submit_completed()) {
							//alert("신청되었습니다.");
							model1.reset();
							
							datagrid1.clearStatus();
							datagrid2.clearStatus();
							datagrid3.clearStatus();
							datagrid4.clearStatus();
						}
					]]>
				</script>
			</button>
			<button id="button10" class="btn_grid02" style="left:827px; top:0px; width:42px; height:17px; ">
				<caption>출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						resetOznode();					
						
						var iv_cmpy_cd = model1.getValue("/root/reqData/subSearchData/cmpy_cd");
						var iv_occr_dt = model1.getValue("/root/reqData/subSearchData/occr_dt");
						var iv_seq = model1.getValue("/root/reqData/subSearchData/seq");
							 						
						// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
						makeNodeValue("/root/oz_data/ozrName","hd/SP_HD_TRIP_1308_P");
						makeNodeValue("/root/oz_data/preview","preview"); 			//preview : 미리보기, print : 인쇄
						makeNodeValue("/root/oz_data/printsize",""); 				//페이지용지설정(기본 A4)		
						// odi 파라미터 설정.	
						makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , iv_cmpy_cd);
						makeNodeValue("/root/oz_data/odiParam/iv_occr_dt" , iv_occr_dt);
						makeNodeValue("/root/oz_data/odiParam/iv_seq" , iv_seq );
				
						// 레포트뷰어 호출.					
						openOzwin("/root/oz_data");	
						
						model1.removenode("/root/dataSet");
						
						model1.reset();
					]]>
				</script>
			</button>
			<caption id="caption2" class="list_cap01" style="left:0px; top:20px; width:110px; height:26px; text-align:center; ">출장자</caption>
			<caption id="caption3" class="list_cap02" style="left:597px; top:20px; width:317px; height:26px; text-align:center; "/>
			<caption id="caption11" class="list_cap01" style="left:286px; top:20px; width:90px; height:26px; text-align:center; ">부서</caption>
			<caption id="caption12" class="list_cap01" style="left:522px; top:20px; width:85px; height:26px; text-align:center; ">직책</caption>
			<caption id="caption15" class="tit02" style="left:0px; top:0px; width:205px; height:20px; font-weight:bold; ">해외출장자</caption>
			<caption id="caption1" class="list_cap02" style="left:375px; top:20px; width:148px; height:26px; text-align:center; "/>
			<caption id="caption4" class="list_cap02" style="left:109px; top:20px; width:178px; height:26px; text-align:center; "/>
			<input id="input7" ref="/root/reqData/reqForm/nm_korn" class="req" inputtype="button" caption="출장자" appearance="input" style="left:179px; top:24px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model1.setValue("/root/reqData/fwdData/func_nm", "setEmpInfo");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");

	//					window.load("/xrw/hd/com/hd_com_1000.xrw","mdichild", "hd_com_1000", "", "/root/reqData/fwdData", "/root/reqData/fwdData");

					]]>
				</script>
			</input>
			<input id="input5" ref="/root/reqData/reqForm/emp_no" class="req" caption="사번" appearance="input" style="left:113px; top:24px; width:64px; height:18px; text-align:center; "/>
			<output id="input1" ref="/root/reqData/reqForm/dept_nm" appearance="output" style="left:380px; top:24px; width:139px; height:18px; text-align:center; "/>
			<output id="input2" ref="/root/reqData/reqForm/dty_nm" appearance="output" style="left:610px; top:24px; width:139px; height:18px; text-align:center; "/>
			<datagrid id="datagrid2" nodeset="/root/resData/gridData2/record" scroll="auto" caption="부서^사번^성명^직책^caption1^caption2^caption3^caption4^caption5^caption6^caption7^caption8" colsep="#" colwidth="140, 140, 140, 140, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:0px; top:74px; width:584px; height:121px; ">
				<col ref="g_dept_nm"/>
				<col ref="g_emp_no"/>
				<col ref="g_flnm" type="inputbutton">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						model1.setValue("/root/reqData/fwdData/func_nm", "setGridEmpInfo");
	//						window.load("/xrw/hd/com/hd_com_1000.xrw","mdichild", "hd_com_1000", "", "/root/reqData/fwdData", "/root/reqData/fwdData");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");

						]]>
					</script>
				</col>
				<col ref="g_dty_nm"/>
				<col ref="g_dept_cd" visibility="hidden"/>
				<col ref="g_dty_cd" visibility="hidden"/>
				<col ref="g_occr_dt" visibility="hidden"/>
				<col ref="g_seq" visibility="hidden"/>
				<col ref="g_with_seq" visibility="hidden"/>
				<col ref="g_posi_nm" visibility="hidden"/>
				<col ref="g_posi_cd" visibility="hidden"/>
				<col ref="g_cmpy_cd" visibility="hidden"/>
				<script type="javascript" ev:event="onendedit">
					<![CDATA[
						
					]]>
				</script>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						rowStatus(datagrid2);		
					]]>
				</script>
			</datagrid>
			<caption id="caption5" style="left:239px; top:53px; width:100px; height:20px; font-weight:bold; ">동행출장자여부</caption>
			<select1 id="combo8" ref="/root/reqData/searchData/together_clsf" appearance="minimal" style="left:338px; top:52px; width:100px; height:18px; ">
				<choices>
					<item>
						<label>없음</label>
						<value>10</value>
					</item>
					<item>
						<label>있음</label>
						<value>20</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					
					var together_clsf = combo8.value;
					
					if(together_clsf == "10") {
						button5.disabled = true;
						button6.disabled = true;
						
					}else{
						button5.disabled = false;
						button6.disabled = false;
					}
						
				
					]]>
				</script>
			</select1>
			<button id="button5" class="btn_grid04" style="left:444px; top:52px; width:67px; height:17px; ">
				<caption>동행추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var rowCnt = datagrid2.rows;
						var selectedIdx = datagrid2.rows-1;
						var emp_no     = model1.getValue("/root/resData/gridData2/record[1]/g_emp_no");	
						if(emp_no == ""){
							if(datagrid2.isReadOnly(1,1) ==true) {
								datagrid2.isReadOnly(1, 1, 1, 4)  =false;
								datagrid2.addStatus(selectedIdx, "insert");
							} else {
								datagrid2.addRow(true, true);
							}
						}else{
							datagrid2.addRow(true, true);
						}
					]]>
				</script>
			</button>
			<button id="button6" class="btn_grid04" style="left:516px; top:52px; width:67px; height:17px; ">
				<caption>동행삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						datagrid2.addStatus(datagrid2.row, "delete");
//						model1.makeNode("/root/resData/resForm/temp");
//						model1.setValue("/root/resData/resForm/temp", "1");
				
					]]>
				</script>
			</button>
		</group>
		<group id="group1" style="left:10px; top:434px; width:918px; height:100px; ">
			<caption id="caption38" class="list_cap02" style="left:664px; top:20px; width:252px; height:26px; text-align:center; "/>
			<caption id="caption7" class="list_cap02" style="left:664px; top:45px; width:252px; height:26px; text-align:center; "/>
			<caption id="caption13" class="list_cap01" style="left:558px; top:45px; width:110px; height:26px; text-align:center; ">목적지</caption>
			<caption id="caption14" class="tit02" style="left:0px; top:0px; width:205px; height:20px; font-weight:bold; ">출장사항</caption>
			<caption id="caption17" class="list_cap02" style="left:88px; top:20px; width:471px; height:76px; text-align:center; "/>
			<textarea id="textarea1" ref="/root/reqData/reqForm/busi_trip_purp" navindex="1" maxlength="25" style="left:114px; top:25px; width:440px; height:65px; text-align:left; vertical-align:top; "/>
			<caption id="caption16" class="list_cap02" style="left:664px; top:70px; width:252px; height:26px; text-align:center; "/>
			<input id="input3" ref="/root/reqData/reqForm/busi_trip_dest" class="req" navindex="3" maxlength="15" caption="목적지" style="left:670px; top:49px; width:225px; height:18px; text-align:left; "/>
			<caption id="caption19" style="left:769px; top:77px; width:25px; height:15px; text-align:center; ">~</caption>
			<input id="input4" ref="/root/reqData/reqForm/busi_trip_frdt" class="req" navindex="4" inputtype="date" format="yyyy-mm-dd" caption="출장기간" style="left:670px; top:74px; width:95px; height:18px; "/>
			<input id="input6" ref="/root/reqData/reqForm/busi_trip_todt" class="req" navindex="5" inputtype="date" format="yyyy-mm-dd" caption="출장기간" style="left:800px; top:74px; width:95px; height:18px; "/>
			<caption id="caption6" class="list_cap01" style="left:0px; top:20px; width:110px; height:76px; text-align:center; ">출장목적</caption>
			<caption id="caption18" class="list_cap01" style="left:558px; top:20px; width:110px; height:26px; text-align:center; ">출장국가</caption>
			<select1 id="combo3" ref="/root/reqData/reqForm/natn_cd" class="req" navindex="2" appearance="minimal" caption="출장국가" style="left:670px; top:25px; width:225px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/natn_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					
					var together_clsf = combo8.value;
					
					if(together_clsf == "10") {
						button5.disabled = true;
						button6.disabled = true;
						
					}else{
						button5.disabled = false;
						button6.disabled = false;
					}
						
				
					]]>
				</script>
			</select1>
			<caption id="caption8" class="list_cap01" style="left:558px; top:70px; width:110px; height:26px; text-align:center; ">출장기간</caption>
		</group>
		<group id="group3" style="left:10px; top:530px; width:918px; height:300px; ">
			<caption id="caption36" class="list_cap01" style="left:670px; top:120px; width:247px; height:26px; text-align:center; "/>
			<caption id="caption34" class="list_cap01" style="left:483px; top:120px; width:80px; height:26px; text-align:center; "/>
			<caption id="caption32" class="list_cap01" style="left:296px; top:120px; width:80px; height:26px; text-align:center; "/>
			<caption id="caption31" class="list_cap02" style="left:375px; top:120px; width:109px; height:26px; text-align:center; "/>
			<caption id="caption29" class="list_cap01" style="left:109px; top:120px; width:80px; height:26px; text-align:center; "/>
			<caption id="caption25" class="list_cap02" style="left:109px; top:45px; width:808px; height:76px; text-align:center; "/>
			<caption id="caption20" class="list_cap01" style="left:0px; top:20px; width:110px; height:26px; text-align:center; ">여비부담구분</caption>
			<caption id="caption21" class="list_cap02" style="left:385px; top:20px; width:532px; height:26px; text-align:center; "/>
			<caption id="caption23" class="list_cap01" style="left:301px; top:20px; width:85px; height:26px; text-align:center; ">초청기관</caption>
			<caption id="caption24" class="tit02" style="left:0px; top:0px; width:205px; height:20px; font-weight:bold; ">여비사항</caption>
			<caption id="caption27" class="list_cap02" style="left:109px; top:20px; width:193px; height:26px; text-align:center; "/>
			<input id="input11" ref="/root/reqData/reqForm/invit_instt" navindex="7" maxlength="15" appearance="input" style="left:390px; top:24px; width:305px; height:18px; text-align:left; "/>
			<datagrid id="datagrid3" nodeset="/root/resData/gridData3/record" scroll="auto" caption="필요경비내역^예상액^(구체적)필요성^caption1^caption2^caption3^caption4^caption5^caption6" colsep="#" colwidth="170, 170, 396, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:0px; top:179px; width:760px; height:121px; ">
				<col ref="e_etc_cost_ptcr" type="input" maxlength="15" style="text-align:left; "/>
				<col ref="e_etc_cost" type="input" format="#,###" maxlength="10"/>
				<col ref="e_etc_cost_neces" type="input" maxlength="25" style="text-align:left; "/>
				<col ref="e_cmpy_cd" visibility="hidden"/>
				<col ref="e_emp_no" visibility="hidden"/>
				<col ref="e_occr_dt" visibility="hidden"/>
				<col ref="e_seq" visibility="hidden"/>
				<col ref="e_sub_seq" visibility="hidden"/>
				<col ref="e_with_seq" visibility="hidden"/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						rowStatus(datagrid3);		
					]]>
				</script>
			</datagrid>
			<caption id="caption22" class="list_cap01" style="left:0px; top:45px; width:110px; height:76px; text-align:center; ">출장필요성</caption>
			<textarea id="textarea2" ref="/root/reqData/reqForm/busi_trip_neces" navindex="8" maxlength="25" style="left:115px; top:50px; width:780px; height:65px; text-align:left; vertical-align:top; "/>
			<caption id="caption28" class="list_cap01" style="left:0px; top:120px; width:110px; height:26px; text-align:center; ">본사부담출장비</caption>
			<caption id="caption30" class="list_cap02" style="left:188px; top:120px; width:109px; height:26px; text-align:center; "/>
			<select id="checkbox1" ref="/root/reqData/reqForm/aviat_fee_yn" class="list_cap01" overflow="visible" appearance="full" style="left:111px; top:124px; width:70px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>항공비</label>
						<value>1</value>
					</item>
				</choices>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							aviat_fee_yn = checkbox1.value;
							if(aviat_fee_yn == "1"){
								input9.disabled = false;
							}else{
								input9.disabled = true;
								input9.value = "";
							}
					]]>
				</script>
			</select>
			<input id="input9" ref="/root/reqData/reqForm/aviat_fee" maxlength="10" format="#,###" appearance="input" style="left:193px; top:124px; width:100px; height:18px; text-align:right; "/>
			<input id="input10" ref="/root/reqData/reqForm/stay_fee" maxlength="10" format="#,###" appearance="input" style="left:380px; top:124px; width:100px; height:18px; text-align:right; "/>
			<select id="checkbox2" ref="/root/reqData/reqForm/stay_fee_yn" class="list_cap01" overflow="visible" appearance="full" style="left:298px; top:124px; width:70px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>숙박비</label>
						<value>1</value>
					</item>
				</choices>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							stay_fee_yn = checkbox2.value;
							
							if(stay_fee_yn == "1"){
								input10.disabled = false;
							}else{
								input10.disabled = true;
								input10.value = "";
							}
					]]>
				</script>
			</select>
			<caption id="caption33" class="list_cap02" style="left:562px; top:120px; width:109px; height:26px; text-align:center; "/>
			<input id="input12" ref="/root/reqData/reqForm/dd_fee" maxlength="10" format="#,###" appearance="input" style="left:567px; top:124px; width:100px; height:18px; text-align:right; "/>
			<select id="checkbox3" ref="/root/reqData/reqForm/dd_fee_yn" class="list_cap01" overflow="visible" appearance="full" style="left:485px; top:124px; width:70px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>일비</label>
						<value>1</value>
					</item>
				</choices>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							dd_fee_yn = checkbox3.value;
							
							if(dd_fee_yn == "1"){
								input12.disabled = false;
							}else{
								input12.disabled = true;
								input12.value = "";
							}
					]]>
				</script>
			</select>
			<select id="checkbox4" ref="/root/reqData/reqForm/ceph_use_yn" class="list_cap01" overflow="visible" appearance="full" style="left:672px; top:124px; width:98px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>휴대폰로밍</label>
						<value>1</value>
					</item>
				</choices>
			</select>
			<caption id="caption35" class="tit02" style="left:0px; top:155px; width:205px; height:20px; font-weight:bold; ">기타</caption>
			<button id="button1" class="btn_grid03" style="left:660px; top:158px; width:52px; height:17px; ">
				<caption>행추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var rowCnt = datagrid3.rows;
						var selectedIdx = datagrid3.rows-1;
						var etc_cost_ptcr     = model1.getValue("/root/resData/gridData3/record[1]/e_etc_cost_ptcr");	
						
						if(etc_cost_ptcr == ""){
							if(datagrid3.isReadOnly(1,1) ==true) {
								datagrid3.isReadOnly(1, 1, 1, 3)  =false;
								datagrid3.addStatus(selectedIdx, "insert");
							} else {
								datagrid3.addRow(true, true);
							}
						}else{
							datagrid3.addRow(true, true);
						}
					]]>
				</script>
			</button>
			<button id="button2" class="btn_grid03" style="left:717px; top:158px; width:52px; height:17px; ">
				<caption>행삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						datagrid3.addStatus(datagrid3.row, "delete");
					]]>
				</script>
			</button>
			<select1 id="combo2" ref="/root/reqData/reqForm/busi_trip_fee_burd_clsf" class="req" navindex="6" appearance="minimal" caption="여비부담구분" style="left:116px; top:25px; width:180px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/busi_trip_fee_burd_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
								
							
					]]>
				</script>
			</select1>
		</group>
		<datagrid id="datagrid4" nodeset="/root/resData/gridData4/record" scroll="auto" caption="일자^출발지^목적지^출장내용^caption2^caption3^caption4^caption1^caption5^caption6" colsep="#" colwidth="170, 200, 200, 320, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:10px; top:850px; width:914px; height:145px; ">
			<col class="req" ref="d_midl_start_dt" type="inputdate" caption="일자"/>
			<col class="req" ref="d_start_area" type="input" maxlength="15" caption="출발지" style="text-align:left; "/>
			<col class="req" ref="d_dest" type="input" maxlength="15" caption="목적지" style="text-align:left; "/>
			<col class="req" ref="d_busi_trip_cont" type="input" maxlength="25" caption="출장내용" style="text-align:left; "/>
			<col ref="d_cmpy_cd" visibility="hidden"/>
			<col ref="d_emp_no" visibility="hidden"/>
			<col ref="d_occr_dt" visibility="hidden"/>
			<col ref="d_seq" visibility="hidden"/>
			<col ref="d_sub_seq" visibility="hidden"/>
			<col ref="d_with_seq" visibility="hidden"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					rowStatus(datagrid4);
				]]>
			</script>
		</datagrid>
		<group id="group4" class="gro_btn" style="left:9px; top:830px; width:916px; height:20px; ">
			<caption id="caption37" class="tit02" style="left:2px; top:0px; width:335px; height:20px; font-weight:bold; ">출장계획</caption>
			<button id="button3" class="btn_grid03" style="left:800px; top:0px; width:52px; height:17px; ">
				<caption>행추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						var rowCnt = datagrid4.rows;
						var selectedIdx = datagrid4.rows-1;
						var midl_start_dt  = model1.getValue("/root/resData/gridData4/record[1]/d_midl_start_dt");	
						
						if(midl_start_dt == ""){
							
							if(datagrid4.isReadOnly(1,1) ==true) {
								datagrid4.isReadOnly(1, 1, 1, 4)  =false;
								datagrid4.addStatus(selectedIdx, "insert");
							} else {
								datagrid4.addRow(true, true);
							}
						}else{
							datagrid4.addRow(true, true);
						}
					
					
					]]>
				</script>
			</button>
			<button id="button8" class="btn_grid03" style="left:857px; top:0px; width:52px; height:17px; ">
				<caption>행삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						datagrid4.addStatus(datagrid4.row, "delete");
					]]>
				</script>
			</button>
		</group>
	</xhtml:body>
</xhtml:html>
