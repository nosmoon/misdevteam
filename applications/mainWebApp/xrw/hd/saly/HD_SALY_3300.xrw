<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<!--===========================================================================-->
<!-- NAME : HD_SALY_3300.xrw                                                   -->
<!-- DESC : 급여세금 계산 작업 화면							   				   -->
<!-- VER  : v1.0                                                               -->
<!-- Copyright 2014 by CHOSUN MEDIA.                                           -->
<!-- All rights reserved.                                                      -->
<!--===========================================================================-->
<!--               변         경         사         항                         -->
<!--===========================================================================-->
<!--   DATE      AUTHOR                   DESCRIPTION(요청자 정보)             -->
<!--===========================================================================-->
<!-- 20141020    최호정    뉴스프레스 전용 개인별내역출력 버튼 신규 추가(조병구)  -->
<!--===========================================================================-->
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<hd_saly_3332_m>
							<dataSet>
								<xx_saly_no_010/>
								<xx_saly_no_020/>
								<xx_proc_clsf_010/>
								<xx_proc_clsf_020/>
								<xx_proc_clsf_030/>
								<xx_emp_no_010/>
								<xx_salary_dt/>
								<xx_pgm_path/>
								<xx_pgm_path_020/>
								<xx_pgm_path_030/>
							</dataSet>
						</hd_saly_3332_m>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<!-- 선택계열의 정보를 담당 -->
							<temp_cd1>
								<item/>
							</temp_cd1>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<searchData>
							<saly_yy/>
							<saly_no/>
							<saly_pay_dt/>
							<year_yn>N</year_yn>
							<tmp_clsf>1</tmp_clsf>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqForm>
						</reqForm>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<multiUpdate>
						</multiUpdate>
						<!-- MultiUpDate유형 사용시 처리 -->
						<fwdData>
						</fwdData>
						<popData>
							<saly_yy/>
							<saly_no/>
						</popData>
						<multiUpData/>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<msg/>
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<!-- datagrid2 -->
							<!-- datagrid3 -->
							<record>
								<job_clsf_nm/>
								<proc_stat_nm/>
								<end_dt_tm/>
							</record>
						</gridData>
						<temp/>
						<gridData2>
							<record>
								<pay_nm/>
								<pay_yy/>
							</record>
						</gridData2>
						<gridData3>
							<record>
								<slip_nm/>
								<occr_dt/>
								<occr_seq/>
								<slip_occr_dt/>
								<slip_clsf_cd/>
								<actu_slip_no/>
								<proc_clsf/>
								<proc_clsf_nm/>
							</record>
						</gridData3>
						<gridData4>
							<record>
								<yadjm/>
							</record>
						</gridData4>
						<gridData5>
							<record>
								<saly_yy/>
								<saly_no/>
								<saly_pay_dt/>
								<emp_no/>
								<flnm/>
								<dept_cd/>
								<base_saly/>
								<posi_saly/>
								<vgl_fee/>
								<week_hody_base_alon/>
								<week_hody_cmpn_alon/>
								<prvmm_mstk_saly/>
								<prvmm_mstk_alon/>
								<deci_incm_tax/>
								<deci_res_tax/>
								<np_slf_ctrb_amt/>
								<hlth_insr_fee/>
								<emp_insr_fee/>
								<cal_pay_amt/>
								<tot_pay_saly/>
								<saly_dduc_stot/>
								<adjm_deci_incm_tax/>
								<adjm_deci_res_tax/>
							</record>
						</gridData5>
					</resData>
					<tempData/>
					<oz_data/>
					<popData_326>
						<saly_yy/>
						<saly_no/>
						<saly_pay_dt/>
					</popData_326>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
				
					//급여계산 상태 
					function slipSearchList(){
						var  saly_yy = model1.getValue("/root/reqData/searchData/saly_yy"); 	// 급여년도
						var  saly_no = model1.getValue("/root/reqData/searchData/saly_no"); 	// 급여번호
						
						model1.setValue("/root/reqData/searchData/saly_yy", saly_yy);
						model1.setValue("/root/reqData/searchData/saly_no", saly_no);
						
						model1.send("hd_saly_1100");
						model1.copyNode("/root/resData/gridData", "/root/dataSet/CURLIST");
						model1.removenode("/root/dataSet");
						model1.refresh();						
					}
					//연차수당 상태 
					function slipSearchList2(){
						var  saly_yy = model1.getValue("/root/reqData/searchData/saly_yy"); 	// 급여년도
						var  saly_no = model1.getValue("/root/reqData/searchData/saly_no"); 	// 급여번호
						
						model1.setValue("/root/reqData/searchData/saly_yy", saly_yy);
						model1.setValue("/root/reqData/searchData/saly_no", saly_no);
						
						model1.send("hd_saly_3310");
						model1.copyNode("/root/resData/gridData", "/root/tempData");
						model1.removenode("/root/tempData");
						model1.refresh();						
					}
					
					//성과급,연차수당 등록상태
					function tmpState(val){
						var Rvalue = true;	
						model.setValue("/root/reqData/searchData/tmp_clsf",val);
						model1.send("hd_saly_3311");
						model1.copyNode("/root/resData/gridData2", "/root/tempData");
						model1.removenode("/root/tempData");
						model1.refresh();													
						Rvalue = model1.getValue("/root/resData/gridData2/record/pay_yy");
						if(Rvalue == '0000'){ Rvalue = false;}
						return Rvalue;
					}
					
					function slip_no_state(val){
						var  saly_yy = model1.getValue("/root/reqData/searchData/saly_yy"); 	// 급여년도
						var  saly_no = model1.getValue("/root/reqData/searchData/saly_no"); 	// 급여번호
						
						model1.setValue("/root/reqData/searchData/saly_yy", saly_yy);
						model1.setValue("/root/reqData/searchData/saly_no", saly_no);
						model.setValue("/root/reqData/searchData/tmp_clsf",val);
						
						model1.send("hd_saly_3312");
						model1.copyNode("/root/resData/gridData3", "/root/tempData");
						model1.removenode("/root/tempData");
						model1.refresh();	
						
					}
					//급여전표생성
					function slip_submit1(){
						
						slipSearchList();
						var  saly_no = model1.getValue("/root/reqData/searchData/saly_no"); 	// 급여번호
						var job_clsf_nm3 = model1.getValue("/root/resData/gridData/record[3]/job_clsf_nm");
						var proc_stat_nm3 = model1.getValue("/root/resData/gridData/record[3]/proc_stat_nm");
						var end_dt_tm3 = model1.getValue("/root/resData/gridData/record[3]/end_dt_tm");
						
						var job_clsf_nm4 = model1.getValue("/root/resData/gridData/record[4]/job_clsf_nm");
						var proc_stat_nm4 = model1.getValue("/root/resData/gridData/record[4]/proc_stat_nm");
						var end_dt_tm4 = model1.getValue("/root/resData/gridData/record[4]/end_dt_tm");
						
						var job_clsf_nm5 = model1.getValue("/root/resData/gridData/record[5]/job_clsf_nm");
						var proc_stat_nm5 = model1.getValue("/root/resData/gridData/record[5]/proc_stat_nm");
						var end_dt_tm5 = model1.getValue("/root/resData/gridData/record[5]/end_dt_tm");
						if(datagrid1.rows <= 1 ){alert("전표를 생성할수 없습니다");return;}
						
						if(job_clsf_nm3 == '급여세금작업' && proc_stat_nm3 == '진행중' && end_dt_tm3 == '' ){
							alert("급여세금작업이 필요합니다.");return;
						}
						
						if(job_clsf_nm5 == '급여마감' && proc_stat_nm5 == '작업완료' && end_dt_tm5 != ''){
							//alert("급여마감 되었습니다.");return;
						}
						
						
						if (window.alert("전표생성 하시겠습니까?", "확인", 1) != 1) {
							return;
						}					
						//if(saly_no == '02'){ 120209
						if(saly_no == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_saly_no_010")){
							model1.send("hd_saly_3304");  //2월달 급여전표생성시에만 탄다.
						}else{
							//경제아이와 그외 회사들의 전표생성 호출을 분리한다_20150416_최호정
							if(model.property("ss_cmpycd") == "334"){
								model.alert("경제아이일때만 수행");
								model1.send("hd_saly_3303_334");
							} else {
								model1.send("hd_saly_3303");
							}
							
						}
						if(submit_completed()) {
							//alert("전표생성 되었습니다.");	
							slipSearchList();
						}								
					}
					//성과급 
					function slip_submit2(){

						if(!tmpState(2)){
							var pay_nm = model1.getValue("/root/resData/gridData2/record/pay_nm");	
							alert(pay_nm+" 작업이 수행되지않았습니다.");
							return;
						} 
						slip_no_state(2);
					     var stat = model1.getValue("/root/resData/gridData3/record/proc_clsf");
					       
					     //if(stat == 'x' || stat == '28' || stat == '29' || stat == '36'){ 120209
					     if(stat == 'x' 
					     || stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_010") 
					     || stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_020")
					     || stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_030")){
					     	//if(stat == '29'){ 120209
					     	if(stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_020")){
								if (window.alert("전표가 이미생성되었습니다.\n 다시 생성하시겠습니까?", "확인", 1) != 1) {
									return;
								}					
					     	//}else if(stat == '36'){ 120209
					     	}else if(stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_030")){
								if (window.alert("경리결제취소 되었습니다 다시 생성하시겠습니까?", "확인", 1) != 1) {
									return;
								}					
					     	}
				     	}else{
				     		alert("전표를생성할수 있는 상태가 아닙니다.");return;
				     	}
						
						if (window.alert("성과급 전표생성 하시겠습니까?", "확인", 1) != 1) {
							return;
						}					

						model1.send("hd_saly_3306");

						if(submit_completed()) {
							//alert("전표생성 되었습니다.");	
						}							
						
					}
					//연차수당
					function slip_submit3(){

						if(!tmpState(3)){
							var pay_nm = model1.getValue("/root/resData/gridData2/record/pay_nm");	
							alert(pay_nm+" 작업이 수행되지않았습니다.");
							return;
						} 
		
						slipSearchList2();
						var job_clsf_nm1 = model1.getValue("/root/resData/gridData/record[1]/job_clsf_nm");
						var proc_stat_nm1 = model1.getValue("/root/resData/gridData/record[1]/proc_stat_nm");
						var end_dt_tm1 = model1.getValue("/root/resData/gridData/record[1]/end_dt_tm");
						
						var job_clsf_nm2 = model1.getValue("/root/resData/gridData/record[2]/job_clsf_nm");
						var proc_stat_nm2 = model1.getValue("/root/resData/gridData/record[2]/proc_stat_nm");
						var end_dt_tm2 = model1.getValue("/root/resData/gridData/record[2]/end_dt_tm");
						//if(datagrid1.rows <= 1 ){alert("생성된전표가  없습니다");return;}
						if(job_clsf_nm1 == '급여전표등록' && proc_stat_nm1 == '작업완료' && end_dt_tm1 != ''){
							if (window.alert("전표가 이미생성되었습니다.\n 다시 생성하시겠습니까?", "확인", 1) != 1) {
								return;
							}
						}										
						
						if(job_clsf_nm2 == '급여마감' && proc_stat_nm2 == '작업완료' && end_dt_tm2 != ''){
							alert("급여마감 되었습니다.");return;
						}										
	 
						if (window.alert("연차수당 전표생성 하시겠습니까?", "확인", 1) != 1) {
							return;
						}					

						model1.send("hd_saly_3308");

						if(submit_completed()) {
							//alert("전표생성 되었습니다.");	
							slipSearchList2();
						}							
					}					
					//급여
					function slip_cancel1(){
						slipSearchList();			
					
						var job_clsf_nm3 = model1.getValue("/root/resData/gridData/record[3]/job_clsf_nm");
						var proc_stat_nm3 = model1.getValue("/root/resData/gridData/record[3]/proc_stat_nm");
						var end_dt_tm3 = model1.getValue("/root/resData/gridData/record[3]/end_dt_tm");
						
						var job_clsf_nm4 = model1.getValue("/root/resData/gridData/record[4]/job_clsf_nm");
						var proc_stat_nm4 = model1.getValue("/root/resData/gridData/record[4]/proc_stat_nm");
						var end_dt_tm4 = model1.getValue("/root/resData/gridData/record[4]/end_dt_tm");
						
						var job_clsf_nm5 = model1.getValue("/root/resData/gridData/record[5]/job_clsf_nm");
						var proc_stat_nm5 = model1.getValue("/root/resData/gridData/record[5]/proc_stat_nm");
						var end_dt_tm5 = model1.getValue("/root/resData/gridData/record[5]/end_dt_tm");
						if(datagrid1.rows <= 1 ){alert("생성된전표가  없습니다");return;}
						if(job_clsf_nm3 == '급여세금작업' && proc_stat_nm3 == '진행중' && end_dt_tm3 == '' ){
							alert("급여세금작업이 필요합니다.");return;
						}
						
						if(job_clsf_nm4 == '급여전표등록' && proc_stat_nm4 == '진행중' && end_dt_tm4 == ''){
							alert("생성된전표가  없습니다");return;
						}					
						if(job_clsf_nm5 == '급여마감' && proc_stat_nm5 == '작업완료' && end_dt_tm5 != ''){
							//alert("급여마감 되었습니다.");return;
						}					
						if (window.alert("급여 전표취소 하시겠습니까?", "확인", 1) != 1) {
							return;
						}					
						model1.send("hd_saly_3305");
						if(submit_completed()) {
							//alert("급여 전표취소 하였습니다.");	
							slipSearchList();
						}								

					}
					//성과급
					function slip_cancel2(){
						if(!tmpState(2)){
							var pay_nm = model1.getValue("/root/resData/gridData2/record/pay_nm");	
							alert(pay_nm+" 작업이 수행되지않았습니다.");
							return;
						} 				
					     slip_no_state(2);						
					     var stat = model1.getValue("/root/resData/gridData3/record/proc_clsf");
					     //if(stat == '29' || stat == '36'){ 120209
					     if(stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_020")
					     || stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_030")){
							if (window.alert("성과급 전표취소 하시겠습니까?", "확인", 1) != 1) {
								return;
							}					
				     	}else if(stat == 'x'){
				     		alert("생성된 전표가 없습니다.");
				     		return;
			     		//}else if(stat == '28'){ 120209
			     		}else if(stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_010")){
			     			alert("이미 취소되었습니다.");
			     			return;
			     		}else{
			     			alert("전표취소 할수있는상태가 아닙니다.");	
			     		}
						model1.send("hd_saly_3307");
						if(submit_completed()) {
							//alert("성과급 전표취소 하였습니다.");	
						}								
						
					}
					//연차수당
					function slip_cancel3(){
						if(!tmpState(3)){
							var pay_nm = model1.getValue("/root/resData/gridData2/record/pay_nm");	
							alert(pay_nm+" 작업이 수행되지않았습니다.");
							return;
						} 				
//						slip_no_state(3);						
						slipSearchList2();		
					
						var job_clsf_nm1 = model1.getValue("/root/resData/gridData/record[1]/job_clsf_nm");
						var proc_stat_nm1 = model1.getValue("/root/resData/gridData/record[1]/proc_stat_nm");
						var end_dt_tm1 = model1.getValue("/root/resData/gridData/record[1]/end_dt_tm");
						
						var job_clsf_nm2 = model1.getValue("/root/resData/gridData/record[2]/job_clsf_nm");
						var proc_stat_nm2 = model1.getValue("/root/resData/gridData/record[2]/proc_stat_nm");
						var end_dt_tm2 = model1.getValue("/root/resData/gridData/record[2]/end_dt_tm");
						
						if(datagrid1.rows <= 1 ){alert("생성된전표가  없습니다");return;}
						if(job_clsf_nm1 == '급여전표등록' && proc_stat_nm1 == '진행중' && end_dt_tm1 == ''){
							alert("생성된전표가  없습니다");return;
						}					
						if(job_clsf_nm2 == '급여마감' && proc_stat_nm2 == '작업완료' && end_dt_tm2 != ''){
							alert("급여마감 되었습니다.");return;
						}					

						if (window.alert("연차수당 전표취소 하시겠습니까?", "확인", 1) != 1) {
							return;
						}					
						model1.send("hd_saly_3309");
						if(submit_completed()) {
							//alert("연차수당 전표취소 하였습니다.");	
							slipSearchList2();
						}										
						
					}
					
					function defaultLoading(){
						var now_date = new Date();
						var year = now_date.getYear();
						var month = now_date.getMonth() +1;
						var month_tm = '0' + month;
						var obj = htmldocument.SessionInfo;
						
						var pattern = ","+obj.emp_no.value+",";
						//var pattern = ","+"211141"+",";
						var validation  = (","+model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_emp_no_010")+",").indexOf(pattern)>-1;
						//alert(validation);
						//if((obj.emp_no.value== "211095" ) || (obj.emp_no.value=="211141")) 120209
						
						//뉴스프레스가 아닌 회사는 개인별내역조회 버튼을 숨긴다
						if(model.property("ss_cmpycd") == "326"){
							button20.visible = true;
						}
						
						if(validation)
						{
								button18.visible = true;
								button19.visible = true;
						}
						
						
						model1.setValue("/root/reqData/searchData/saly_yy", year);
						if(month_tm.length == 3){
							month_tm = month_tm.substring(1, 3);
							model1.setValue("/root/reqData/searchData/saly_no", month_tm);
						}else{
							model1.setValue("/root/reqData/searchData/saly_no", month_tm);
						}
						
						//var saly_dt = year + month_tm + "25" 120209
						var saly_dt = year + month_tm + model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_salary_dt");
						model1.setValue("/root/reqData/searchData/saly_pay_dt", saly_dt);

						model1.refresh();						
						
					}
					
					
										
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					model.send("hd_saly_3332_m");
					model.refresh();
					//alert(model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_pgm_path"));
					/*
					alert(model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_saly_no_010"));
					alert(model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_saly_no_020"));
					alert(model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_010"));
					alert(model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_020"));
					alert(model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_030"));
					alert(model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_emp_no_010"));
					alert(model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_salary_dt"));
					*/
				//	alert(model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_pgm_path_020"));
				//	alert(model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_pgm_path_030"));

					defaultLoading();
				]]>
			</script>
			<submission id="hd_saly_1100" action="/hd/saly/1100" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3300" action="/hd/saly/3300" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3300_334" action="/hd/saly/3300334" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3300_gysg" action="/hd/saly/33002013" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3302" action="/hd/saly/3302" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3303" action="/hd/saly/3303" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3304" action="/hd/saly/3304" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3305" action="/hd/saly/3305" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3306" action="/hd/saly/3306" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3307" action="/hd/saly/3307" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3308" action="/hd/saly/3308" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3309" action="/hd/saly/3309" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3310" action="/hd/saly/3310" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3311" action="/hd/saly/3311" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3312" action="/hd/saly/3312" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3315" action="/hd/saly/3315" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3317" action="/hd/saly/3317" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="hd_saly_3330" action="/hd/saly/3330" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_saly_3331" action="/hd/saly/3331" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="hd_saly_3332_m" action="/hd/saly/3332" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/hd_saly_3332_m/dataSet"/>
			<submission id="hd_saly_3350" action="/hd/saly/3350" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_4500" action="/hd/saly/4500" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="hd_saly_3303_334" action="/hd/saly/3303334" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
		</model>
		<script type="javascript" src="/js/CIISComm.js"/>
	</xhtml:head>
	<xhtml:body class="main" visibility="visible" pagewidth="946" pageheight="728" guideline="2,49;2,70;2,679;1,936;1,925;2,82;1,594;1,555;" style="font-family:굴림; background-image:../../images/bg_946.gif; ">
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group1" class="gro_btn" style="left:10px; top:85px; width:515px; height:77px; ">
			<caption id="caption5" class="list_cap02" style="left:89px; top:25px; width:407px; height:26px; text-align:center; "/>
			<caption id="caption10" class="list_cap02" style="left:89px; top:0px; width:407px; height:26px; text-align:center; "/>
			<caption id="caption2" class="list_cap01" style="left:0px; top:0px; width:90px; height:26px; text-align:center; ">급여년도</caption>
			<caption id="caption1" class="list_cap01" style="left:200px; top:0px; width:90px; height:26px; text-align:center; ">급여번호</caption>
			<input id="input1" ref="/root/reqData/searchData/saly_yy" navindex="1" maxlength="4" format="yyyy" appearance="input" style="left:94px; top:4px; width:100px; height:18px; text-align:center; "/>
			<script type="javascript" ev:event="onmaxlength">
				<![CDATA[
						var saly_yy = input1.currentText;
						var saly_no = input2.currentText;
						
						model1.setValue("/root/reqData/searchData/saly_yy", saly_yy);
						model1.setValue("/root/reqData/searchData/saly_no", saly_no);
					
						//var saly_dt = saly_yy + saly_no + "25" 120209
						var saly_dt = saly_yy + saly_no + model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_salary_dt");
						model1.setValue("/root/reqData/searchData/saly_pay_dt", saly_dt);
						//model1.setValue("/root/reqData/searchData/appmt_dt", saly_dt);
						
						input3.refresh();
						//input4.refresh();			
					]]>
			</script>
			<input id="input2" ref="/root/reqData/searchData/saly_no" navindex="2" maxlength="2" format="dd" appearance="input" style="left:294px; top:4px; width:60px; height:18px; text-align:center; "/>
			<script type="javascript" ev:event="onmaxlength">
				<![CDATA[
						var saly_yy = input1.currentText;
						var saly_no = input2.currentText;
						
						model1.setValue("/root/reqData/searchData/saly_yy", saly_yy);
						model1.setValue("/root/reqData/searchData/saly_no", saly_no);
					
						//var saly_dt = saly_yy + saly_no + "25" 120209
						var saly_dt = saly_yy + saly_no + model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_salary_dt");
						model1.setValue("/root/reqData/searchData/saly_pay_dt", saly_dt);
						//model1.setValue("/root/reqData/searchData/appmt_dt", saly_dt);
						
						input3.refresh();
						//input4.refresh();			
					]]>
			</script>
			<input id="input3" ref="/root/reqData/searchData/saly_pay_dt" class="req" inputtype="date" format="yyyy.mm.dd" style="left:94px; top:29px; width:100px; height:18px; "/>
			<caption id="caption6" class="list_cap01" style="left:0px; top:25px; width:90px; height:26px; text-align:center; ">급여지급일자</caption>
			<caption id="caption7" class="list_cap02" style="left:89px; top:50px; width:407px; height:26px; text-align:center; "/>
			<caption id="caption8" class="list_cap01" style="left:0px; top:50px; width:135px; height:26px; text-align:center; ">연말정산차감작업여부</caption>
			<select1 id="radio1" ref="/root/reqData/searchData/year_yn" appearance="full" cellspacing="20" cols="2" overflow="visible" style="left:145px; top:55px; width:175px; height:15px; border-style:none; ">
				<choices>
					<item>
						<label>반영안함</label>
						<value>N</value>
					</item>
					<item>
						<label>전액반영</label>
						<value>Y</value>
					</item>
				</choices>
			</select1>
			<caption id="caption3" class="list_cap01" style="left:200px; top:25px; width:90px; height:26px; text-align:center; ">구분</caption>
			<select1 id="combo1" ref="/root/reqData/searchData/tmp_clsf" appearance="minimal" style="left:295px; top:30px; width:95px; height:18px; ">
				<choices>
					<item>
						<label>급여</label>
						<value>1</value>
					</item>
					<item>
						<label>성과급(기타급여)</label>
						<value>2</value>
					</item>
					<item>
						<label>연차수당</label>
						<value>3</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var val = combo1.value;
						if(val == '1'){
							input2.disabled = false;
							defaultLoading();	
						}else if(val == '2'){
							input2.value = '';
							input2.disabled = true;
						}else if(val == '3'){
							//input2.value = '31'; 120209
							input2.value = model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_saly_no_020");
							input2.disabled = true;
						}
					
					]]>
				</script>
			</select1>
		</group>
		<caption id="caption9" class="tit02" style="left:10px; top:50px; width:205px; height:20px; font-weight:bold; ">급여세금 계산 작업</caption>
		<group id="group3" style="left:10px; top:170px; width:575px; height:25px; ">
			<button id="button1" class="btn04" style="left:71px; top:2px; width:87px; height:21px; ">
				<caption>세금계산취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.send("hd_saly_3302");
					]]>
				</script>
			</button>
			<button id="button3" class="btn03" style="left:5px; top:2px; width:65px; height:21px; ">
				<caption>세금계산</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						
						var tmp_clsf = model1.getValue("/root/reqData/searchData/tmp_clsf") ;
						
						if(tmp_clsf == "1"){ 
							var pgm_path = model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_pgm_path");
					//	alert(pgm_path);
							model1.send(pgm_path);
							
						//model1.send("hd_saly_3300");
						
						}else if(tmp_clsf == "2"){
							model1.send("hd_saly_4500");  // 성과급 
						}else if(tmp_clsf == "3"){
							//연차수당 
						}
						
					]]>
				</script>
			</button>
			<button id="button4" class="btn02" navindex="10" style="left:381px; top:2px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
				 		viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					]]>
				</script>
			</button>
			<button id="button5" class="btn04" navindex="9" crud="C" style="left:292px; top:2px; width:88px; height:21px; ">
				<caption>급여작업진행</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var  saly_yy = model1.getValue("/root/reqData/searchData/saly_yy"); 	// 급여년도
						var  saly_no = model1.getValue("/root/reqData/searchData/saly_no"); 	// 급여번호
						
						if(saly_yy != "" && saly_no != "" )
						{
							model1.setValue("/root/reqData/popData/saly_yy",saly_yy);
							model1.setValue("/root/reqData/popData/saly_no",saly_no);
							window.load("/xrw/hd/saly/HD_SALY_1100.xrw","mdichild", "hd_saly_1100", "align:center; caption:hidden;", "/root/reqData/popData", "/root/reqData/popData");
						}
						else
						{
							alert("급여년도와 급여번호를 입력한 후 조회 해주세요.");
							return;
						}
					]]>
				</script>
			</button>
			<button id="button7" class="btn03" style="left:160px; top:2px; width:64px; height:21px; ">
				<caption>전표생성</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var tmp_clsf = model1.getValue("/root/reqData/searchData/tmp_clsf");
						if(tmp_clsf == '1'){
							slip_submit1();
						}else if(tmp_clsf == '2'){
							slip_submit2();
						}else if(tmp_clsf == '3'){
							slip_submit3();
						}
				
					]]>
				</script>
			</button>
			<button id="button6" class="btn03" navindex="9" crud="C" style="left:226px; top:2px; width:64px; height:21px; ">
				<caption>전표취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var tmp_clsf = model1.getValue("/root/reqData/searchData/tmp_clsf");
						if(tmp_clsf == '1'){
							slip_cancel1();
						}else if(tmp_clsf == '2'){
							slip_cancel2();
						}else if(tmp_clsf == '3'){
							slip_cancel3();
						}
					
					]]>
				</script>
			</button>
		</group>
		<group id="group2" visibility="hidden" style="left:5px; top:255px; width:835px; height:425px; ">
			<button id="button2" class="btn05" style="left:10px; top:27px; width:110px; height:21px; ">
				<caption>전표생성(성과급)</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[

						if(!tmpState(2)){
							var pay_nm = model1.getValue("/root/resData/gridData2/record/pay_nm");	
							alert(pay_nm+" 작업이 수행되지않았습니다.");
							return;
						} 
						slip_no_state(2);
					     var stat = model1.getValue("/root/resData/gridData3/record/proc_clsf");
					     //if(stat == 'x' || stat == '28' || stat == '29' || stat == '36'){ 120209
					     if(stat == 'x' 
					     || stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_010")
					     || stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_020")
					     || stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_030")){
					     	//if(stat == '29'){ 120209
					     	if(stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_020")){
								if (window.alert("전표가 이미생성되었습니다.\n 다시 생성하시겠습니까?", "확인", 1) != 1) {
									return;
								}					
					     	//}else if(stat == '36'){ 120209
					     	}else if(stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_030")){
								if (window.alert("경리결제취소 되었습니다 다시 생성하시겠습니까?", "확인", 1) != 1) {
									return;
								}					
					     	}
				     	}else{
				     		alert("전표를생성할수 있는 상태가 아닙니다.");return;
				     	}
						
						if (window.alert("성과급 전표생성 하시겠습니까?", "확인", 1) != 1) {
							return;
						}					

						model1.send("hd_saly_3306");

						if(submit_completed()) {
							//alert("전표생성 되었습니다.");	
						}						
					]]>
				</script>
			</button>
			<button id="button8" class="btn05" navindex="9" crud="C" style="left:130px; top:27px; width:110px; height:21px; ">
				<caption>전표취소(성과급)</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(!tmpState(2)){
							var pay_nm = model1.getValue("/root/resData/gridData2/record/pay_nm");	
							alert(pay_nm+" 작업이 수행되지않았습니다.");
							return;
						} 				
					     slip_no_state(2);						
					     var stat = model1.getValue("/root/resData/gridData3/record/proc_clsf");
					     //if(stat == '29' || stat == '36'){ 120209
					     if(stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_020") || stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_030")){
							if (window.alert("전표취소 하시겠습니까?", "확인", 1) != 1) {
								return;
							}					
				     	}else if(stat == 'x'){
				     		alert("생성된 전표가 없습니다.");
				     		return;
			     		//}else if(stat == '28'){ 120209
			     		}else if(stat == model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_proc_clsf_010") ){
			     			alert("이미 취소되었습니다.");
			     			return;
			     		}else{
			     			alert("전표취소 할수있는상태가 아닙니다.");	
			     		}
						if (window.alert("전표취소 하시겠습니까?", "확인", 1) != 1) {
							return;
						}					
						model1.send("hd_saly_3307");
						if(submit_completed()) {
							//alert("전표취소 하였습니다.");	
						}							
					]]>
				</script>
			</button>
			<button id="button9" class="btn05" style="left:10px; top:62px; width:110px; height:21px; ">
				<caption>전표생성(연차수당)</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
	//					slip_no_state(3);

						if(!tmpState(3)){
							var pay_nm = model1.getValue("/root/resData/gridData2/record/pay_nm");	
							alert(pay_nm+" 작업이 수행되지않았습니다.");
							return;
						} 
		
						slipSearchList2();
						var job_clsf_nm1 = model1.getValue("/root/resData/gridData/record[1]/job_clsf_nm");
						var proc_stat_nm1 = model1.getValue("/root/resData/gridData/record[1]/proc_stat_nm");
						var end_dt_tm1 = model1.getValue("/root/resData/gridData/record[1]/end_dt_tm");
						
						var job_clsf_nm2 = model1.getValue("/root/resData/gridData/record[2]/job_clsf_nm");
						var proc_stat_nm2 = model1.getValue("/root/resData/gridData/record[2]/proc_stat_nm");
						var end_dt_tm2 = model1.getValue("/root/resData/gridData/record[2]/end_dt_tm");
						//if(datagrid1.rows <= 1 ){alert("생성된전표가  없습니다");return;}
						if(job_clsf_nm1 == '급여전표등록' && proc_stat_nm1 == '작업완료' && end_dt_tm1 != ''){
							if (window.alert("전표가 이미생성되었습니다.\n 다시 생성하시겠습니까?", "확인", 1) != 1) {
								return;
							}
						}										
						
						if(job_clsf_nm2 == '급여마감' && proc_stat_nm2 == '작업완료' && end_dt_tm2 != ''){
							alert("급여마감 되었습니다.");return;
						}										
	 
						if (window.alert("연차수당 전표생성 하시겠습니까?", "확인", 1) != 1) {
							return;
						}					

						model1.send("hd_saly_3308");

						if(submit_completed()) {
							//alert("전표생성 되었습니다.");	
							slipSearchList2();
						}						
					]]>
				</script>
			</button>
			<button id="button11" class="btn05" navindex="9" crud="C" style="left:130px; top:62px; width:110px; height:21px; ">
				<caption>전표취소(연차수당)</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(!tmpState(3)){
							var pay_nm = model1.getValue("/root/resData/gridData2/record/pay_nm");	
							alert(pay_nm+" 작업이 수행되지않았습니다.");
							return;
						} 				
//						slip_no_state(3);						
						slipSearchList2();		
					
						var job_clsf_nm1 = model1.getValue("/root/resData/gridData/record[1]/job_clsf_nm");
						var proc_stat_nm1 = model1.getValue("/root/resData/gridData/record[1]/proc_stat_nm");
						var end_dt_tm1 = model1.getValue("/root/resData/gridData/record[1]/end_dt_tm");
						
						var job_clsf_nm2 = model1.getValue("/root/resData/gridData/record[2]/job_clsf_nm");
						var proc_stat_nm2 = model1.getValue("/root/resData/gridData/record[2]/proc_stat_nm");
						var end_dt_tm2 = model1.getValue("/root/resData/gridData/record[2]/end_dt_tm");
						
						if(datagrid1.rows <= 1 ){alert("생성된전표가  없습니다");return;}
						if(job_clsf_nm1 == '급여전표등록' && proc_stat_nm1 == '진행중' && end_dt_tm1 == ''){
							alert("생성된전표가  없습니다");return;
						}					
						if(job_clsf_nm2 == '급여마감' && proc_stat_nm2 == '작업완료' && end_dt_tm2 != ''){
							alert("급여마감 되었습니다.");return;
						}					

						if (window.alert("전표취소 하시겠습니까?", "확인", 1) != 1) {
							return;
						}					
						model1.send("hd_saly_3309");
						if(submit_completed()) {
							//alert("전표취소 하였습니다.");	
							slipSearchList2();
						}							
					]]>
				</script>
			</button>
			<datagrid id="datagrid2" nodeset="/root/resData/gridData2/record" visibility="hid1den" caption="급여구분^급여년도" colsep="^" colwidth="101, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" noeset="/root/gridData/main/a" style="left:430px; top:92px; width:225px; height:120px; ">
				<col ref="pay_nm"/>
				<col ref="pay_yy"/>
			</datagrid>
			<datagrid id="datagrid3" nodeset="/root/resData/gridData3/record" visibility="hid1den" caption="급여이름^관리일자^관리번호^전표번호^상태코드^상태" colsep="^" colwidth="100, 98, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" noeset="/root/gridData/main/a" style="left:10px; top:222px; width:625px; height:122px; ">
				<col ref="slip_nm"/>
				<col ref="occr_dt"/>
				<col ref="occr_seq"/>
				<col ref="actu_slip_no" format="99999999-99-999"/>
				<col ref="proc_clsf"/>
				<col ref="proc_clsf_nm"/>
			</datagrid>
			<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" visibility="hid1den" caption="작업구분^상태^완료일시" colsep="^" colwidth="139, 100, 150" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" noeset="/root/gridData/main/a" style="left:10px; top:90px; width:415px; height:122px; ">
				<col ref="job_clsf_nm"/>
				<col ref="proc_stat_nm"/>
				<col ref="end_dt_tm"/>
			</datagrid>
			<datagrid id="datagrid4" nodeset="/root/resData/gridData4/record" visibility="hidden" caption="temp" colsep="#" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:675px; top:95px; width:100px; height:150px; ">
				<col ref="yadjm"/>
			</datagrid>
			<datagrid id="datagrid5" nodeset="/root/resData/gridData5/record" caption="급여년도^급여번호^급여지급일자^사번^성명^부서코드^기본급^직무급^야간당직비^주휴기본수당^주휴보상수당^전월과오급^전월과오수^소득세^주민세^국민연금^건강보험료^고용보험료^차인지급액^총지급급여^급여공제합계" colsep="#" colwidth="100, 98, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" tooltip="true" noeset="/root/gridData/main/a" style="left:10px; top:290px; width:765px; height:122px; ">
				<col ref="saly_yy"/>
				<col ref="saly_no"/>
				<col ref="saly_pay_dt"/>
				<col ref="emp_no"/>
				<col ref="flnm"/>
				<col ref="dept_cd"/>
				<col ref="base_saly"/>
				<col ref="posi_saly"/>
				<col ref="vgl_fee"/>
				<col ref="week_hody_base_alon"/>
				<col ref="week_hody_cmpn_alon"/>
				<col ref="prvmm_mstk_saly"/>
				<col ref="prvmm_mstk_alon"/>
				<col ref="deci_incm_tax"/>
				<col ref="deci_res_tax"/>
				<col ref="adjm_deci_incm_tax"/>
				<col ref="adjm_deci_res_tax"/>
				<col ref="np_slf_ctrb_amt"/>
				<col ref="hlth_insr_fee"/>
				<col ref="emp_insr_fee"/>
				<col ref="cal_pay_amt"/>
				<col ref="tot_pay_saly"/>
				<col ref="saly_dduc_stot"/>
				<col/>
			</datagrid>
			<datagrid id="datagrid6" nodeset="/root/resData/gridData6/record" caption="사번^급여년도^급여번호^성명^급여구분^급여지급일자^부서코드^기본급^연야급^부가급^직무급^월정급여^실지급월정급여^주휴기본수당^주휴보상수당^법정휴일기본수당^법정휴일보상수당^휴간일수당^철야연근비^부정기수당^총지급급여^비과세여부외국^비과세외국^비과세여부기자^비과세기자^비과세합계^수입급여^결정소득세^결정주민세^정산차감소득세^정산차감주민세^국민연금본인기여금^국민연금회사부담금^건강보험료^건강보험요양보험료^고용보험료^차인지급액" colsep="#" colwidth="100, 98, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" tooltip="true" noeset="/root/gridData/main/a" style="left:55px; top:290px; width:765px; height:122px; ">
				<col ref="emp_no"/>
				<col ref="saly_yy"/>
				<col ref="saly_no"/>
				<col ref="flnm"/>
				<col ref="saly_clsf"/>
				<col ref="saly_pay_dt"/>
				<col ref="dept_cd"/>
				<col ref="base_saly"/>
				<col ref="evngt_saly"/>
				<col ref="supl_saly"/>
				<col ref="posk_saly"/>
				<col ref="rgla_saly"/>
				<col ref="real_pay_rgla_saly"/>
				<col ref="week_hody_base_alon"/>
				<col ref="week_hody_cmpn_alon"/>
				<col ref="lgl_hody_base_alon"/>
				<col ref="lgl_hody_cmpn_alon"/>
				<col ref="nissu_dd_alon"/>
				<col ref="vgl_fee"/>
				<col ref="non_regu_alon_stot"/>
				<col ref="tot_pay_saly"/>
				<col ref="non_tax_yn_frnc"/>
				<col ref="non_tax_frnc"/>
				<col ref="non_tax_yn_jrnst"/>
				<col ref="non_tax_jrnst"/>
				<col ref="non_tax_stot"/>
				<col ref="impt_saly"/>
				<col ref="deci_incm_tax"/>
				<col ref="deci_res_tax"/>
				<col ref="adjm_dedu_incm_tax"/>
				<col ref="adjm_dedu_res_tax"/>
				<col ref="np_slf_ctrb_amt"/>
				<col ref="np_cmpy_burd_amt"/>
				<col ref="hlth_insr_fee"/>
				<col ref="hlth_insr_med_care_insr_fee"/>
				<col ref="emp_insr_fee"/>
				<col ref="cal_pay_amt"/>
				<col/>
			</datagrid>
		</group>
		<group id="group4" style="left:10px; top:195px; width:650px; height:25px; ">
			<button id="button12" class="btn05" navindex="9" crud="C" style="left:5px; top:2px; width:112px; height:21px; ">
				<caption>개인별내역출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(model1.getValue("/root/reqData/searchData/tmp_clsf") != "2"){
							if(model1.getValue("/root/reqData/searchData/saly_yy") == "" || 
							model1.getValue("/root/reqData/searchData/saly_no") == "" || 
							model1.getValue("/root/reqData/searchData/saly_pay_dt") == ""){
								alert("급여년도, 급여번호, 급여지급일자는 필수 입력사항입니다.");
								return;
							}
						}else if(model1.getValue("/root/reqData/searchData/tmp_clsf") == "2"){
							if(model1.getValue("/root/reqData/searchData/saly_yy") == "" || 
							model1.getValue("/root/reqData/searchData/saly_pay_dt") == ""){
								alert("급여년도, 급여지급일자는 필수 입력사항입니다.");
								return;
							}
						}
						// 오즈관련 노드 초기화..					
					 	resetOznode();					
					 						
						var pgm_path_020 = "hd/"+model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_pgm_path_020");
						
					 	// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
					 	makeNodeValue("/root/oz_data/ozrName",pgm_path_020)  //SP_HD_SALY_3313_P 
											
					 	// odi 파라미터 설정.					
					 	makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , getProperty("ss_cmpycd") );
					 	makeNodeValue("/root/oz_data/odiParam/iv_saly_yy" , model1.getValue("/root/reqData/searchData/saly_yy") );
					 	makeNodeValue("/root/oz_data/odiParam/iv_saly_no" , model1.getValue("/root/reqData/searchData/saly_no") );
					 	makeNodeValue("/root/oz_data/odiParam/iv_saly_pay_dt" , model1.getValue("/root/reqData/searchData/saly_pay_dt") );
					 						
						// 프린터로 직접출력할 경우에만 사용.. ( preview:미리보기,print:직접출력, export:파일 )					
						//makeNodeValue("/root/oz_data/preview","print"); 					
											
					 	// 레포트뷰어 호출.					
					 	openOzwin("/root/oz_data");	
					]]>
				</script>
			</button>
			<button id="button10" class="btn05" navindex="9" crud="C" style="left:120px; top:2px; width:112px; height:21px; ">
				<caption>총괄표출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(model1.getValue("/root/reqData/searchData/tmp_clsf") != "2"){
							if(model1.getValue("/root/reqData/searchData/saly_yy") == "" || 
							model1.getValue("/root/reqData/searchData/saly_no") == "" || 
							model1.getValue("/root/reqData/searchData/saly_pay_dt") == ""){
								alert("급여년도, 급여번호, 급여지급일자는 필수 입력사항입니다.");
								return;
							}
						}else if(model1.getValue("/root/reqData/searchData/tmp_clsf") == "2"){
							if(model1.getValue("/root/reqData/searchData/saly_yy") == "" || 
							model1.getValue("/root/reqData/searchData/saly_pay_dt") == ""){
								alert("급여년도, 급여지급일자는 필수 입력사항입니다.");
								return;
							}
						}
						// 오즈관련 노드 초기화..					
					 	resetOznode();					
					 	
						var pgm_path_030 = "hd/"+model.getValue("/root/initData/hd_saly_3332_m/dataSet/xx_pgm_path_030");
				 
					 	// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
					 	makeNodeValue("/root/oz_data/ozrName",pgm_path_030) //SP_HD_SALY_3314_P 
											
					 	// odi 파라미터 설정.					
					 	makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , getProperty("ss_cmpycd") );
					 	makeNodeValue("/root/oz_data/odiParam/iv_saly_yy" , model1.getValue("/root/reqData/searchData/saly_yy") );
					 	makeNodeValue("/root/oz_data/odiParam/iv_saly_no" , model1.getValue("/root/reqData/searchData/saly_no") );
					 	makeNodeValue("/root/oz_data/odiParam/iv_saly_pay_dt" , model1.getValue("/root/reqData/searchData/saly_pay_dt") );
					 						
						// 프린터로 직접출력할 경우에만 사용.. ( preview:미리보기,print:직접출력, export:파일 )					
						//makeNodeValue("/root/oz_data/preview","print"); 					
											
					 	// 레포트뷰어 호출.					
					 	openOzwin("/root/oz_data");	
					]]>
				</script>
			</button>
			<button id="button13" class="btn05" navindex="9" crud="C" style="left:235px; top:2px; width:112px; height:21px; ">
				<caption>은행TAPE생성</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(model1.getValue("/root/reqData/searchData/tmp_clsf") == "1"){
							if (window.alert("급여 은행 TAPE 작업을 시작하시겠습니까?", "확인", 1) != 1) {
								return;
							}
						}else if(model1.getValue("/root/reqData/searchData/tmp_clsf") == "2"){
							if (window.alert("성과급(기타급여) 은행 TAPE 작업을 시작하시겠습니까?", "확인", 1) != 1) {
								return;
							}
						}else if(model1.getValue("/root/reqData/searchData/tmp_clsf") == "3"){
							if (window.alert("연차수당 은행 TAPE 작업을 시작하시겠습니까?", "확인", 1) != 1) {
								return;
							}
						} else {
							return;
						}
						model1.send("hd_saly_3315");
						if(submit_completed()) {
						
							model1.send("hd_saly_3317");
							model1.copyNode("/root/resData/gridData4", "/root/dataSet/CURLIST");
							model1.removenode("/root/dataSet");
							datagrid4.autoResize = true;
							model1.refresh();
							
						
							var rows = datagrid4.rows;
							for(var i = 1; i < Number(rows); i++){
								model1.makeNode("/root/resData/gridData4/record[" + (i) + "]/yadjm");
								model1.setValue("/root/resData/gridData4/record[" + (i) + "]/yadjm", model1.getValue("/root/resData/gridData4/record[" + (i) + "]/yadjm").substring(0, Number(model1.getValue("/root/resData/gridData4/record[" + (i) + "]/yadjm").length - 1)));
							}
							
							var filename = window.fileDialog("save", ",", false, "", "txt", "*.txt");
						//	var filePath = window.fileDialog("save", "", false, "", "xls", "Excel Files(*.xls)|*.xls");

							datagrid4.saveText(filename, "\n", ",", "'", false, true);
						//	if(filePath != "") {
						//		datagrid4.saveExcel(filePath);
						//		window.exec(filePath);
						 //   }
							
							model1.reset();
							combo1.disabled = false;
						}
					]]>
				</script>
			</button>
			<button id="button14" class="btn05" navindex="9" crud="C" style="left:350px; top:2px; width:112px; height:21px; ">
				<caption>입금명세서</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						// 오즈관련 노드 초기화..					
					 	resetOznode();					
					 						
					 	// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
					 	makeNodeValue("/root/oz_data/ozrName","hd/SP_HD_SALY_3316_P")
											
					 	// odi 파라미터 설정.					
					 	makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , getProperty("ss_cmpycd") );
					 	makeNodeValue("/root/oz_data/odiParam/iv_saly_yy" , model1.getValue("/root/reqData/searchData/saly_yy") );
					 	makeNodeValue("/root/oz_data/odiParam/iv_saly_no" , model1.getValue("/root/reqData/searchData/saly_no") );
					 	makeNodeValue("/root/oz_data/odiParam/iv_saly_pay_dt" , model1.getValue("/root/reqData/searchData/saly_pay_dt") );
					 	makeNodeValue("/root/oz_data/odiParam/iv_tmp_clsf" , model1.getValue("/root/reqData/searchData/tmp_clsf") );
					 						
						// 프린터로 직접출력할 경우에만 사용.. ( preview:미리보기,print:직접출력, export:파일 )					
						//makeNodeValue("/root/oz_data/preview","print"); 					
											
					 	// 레포트뷰어 호출.					
					 	openOzwin("/root/oz_data");	
					]]>
				</script>
			</button>
			<button id="button20" class="btn07" visibility="hidden" crud="C" style="left:465px; top:2px; width:160px; height:21px; ">
				<caption>개인별내역조회(뉴스프레스)</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(model1.getValue("/root/reqData/searchData/tmp_clsf") != "2"){
							if(model1.getValue("/root/reqData/searchData/saly_yy") == "" || 
							model1.getValue("/root/reqData/searchData/saly_no") == "" || 
							model1.getValue("/root/reqData/searchData/saly_pay_dt") == ""){
								alert("급여년도, 급여번호, 급여지급일자는 필수 입력사항입니다.");
								return;
							}
						}else if(model1.getValue("/root/reqData/searchData/tmp_clsf") == "2"){
							if(model1.getValue("/root/reqData/searchData/saly_yy") == "" || 
							model1.getValue("/root/reqData/searchData/saly_pay_dt") == ""){
								alert("급여년도, 급여지급일자는 필수 입력사항입니다.");
								return;
							}
						}
						//값 셋팅
						model1.setValue("/root/popData_326/saly_yy",model1.getValue("/root/reqData/searchData/saly_yy"));
						model1.setValue("/root/popData_326/saly_no",model1.getValue("/root/reqData/searchData/saly_no"));
						model1.setValue("/root/popData_326/saly_pay_dt",model1.getValue("/root/reqData/searchData/saly_pay_dt"));
						
						window.load("/xrw/hd/saly/HD_SALY_3313_326.xrw","mdichild", "hd_saly_3313_326", "align:center; caption:hidden;", "/root/popData_326", "/root/popData_326");
					]]>
				</script>
			</button>
		</group>
		<group id="group5" style="left:10px; top:220px; width:580px; height:25px; ">
			<button id="button15" class="btn07" navindex="9" crud="C" style="left:5px; top:2px; width:160px; height:21px; ">
				<caption>단체/써클회비공제총괄표출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(model1.getValue("/root/reqData/searchData/tmp_clsf") != "2"){
							if(model1.getValue("/root/reqData/searchData/saly_yy") == "" || 
							model1.getValue("/root/reqData/searchData/saly_no") == "" || 
							model1.getValue("/root/reqData/searchData/saly_pay_dt") == ""){
								alert("급여년도, 급여번호, 급여지급일자는 필수 입력사항입니다.");
								return;
							}
						}else if(model1.getValue("/root/reqData/searchData/tmp_clsf") == "2"){
							if(model1.getValue("/root/reqData/searchData/saly_yy") == "" || 
							model1.getValue("/root/reqData/searchData/saly_pay_dt") == ""){
								alert("급여년도, 급여지급일자는 필수 입력사항입니다.");
								return;
							}
						}
						// 오즈관련 노드 초기화..					
					 	resetOznode();					
					 						
					 	// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
					 	makeNodeValue("/root/oz_data/ozrName","hd/SP_HD_SALY_3318_P")
											
					 	// odi 파라미터 설정.					
					 	makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , getProperty("ss_cmpycd") );
					 	makeNodeValue("/root/oz_data/odiParam/iv_saly_yy" , model1.getValue("/root/reqData/searchData/saly_yy") );
					 	makeNodeValue("/root/oz_data/odiParam/iv_saly_no" , model1.getValue("/root/reqData/searchData/saly_no") );
					 						
						// 프린터로 직접출력할 경우에만 사용.. ( preview:미리보기,print:직접출력, export:파일 )					
						//makeNodeValue("/root/oz_data/preview","print"); 					
											
					 	// 레포트뷰어 호출.					
					 	openOzwin("/root/oz_data");	
					]]>
				</script>
			</button>
			<button id="button16" class="btn05" navindex="9" crud="C" style="left:170px; top:2px; width:112px; height:21px; ">
				<caption>개인별연월차수당</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(model1.getValue("/root/reqData/searchData/tmp_clsf") != "2"){
							if(model1.getValue("/root/reqData/searchData/saly_yy") == ""){
								alert("급여년도는 필수 입력사항입니다.");
								return;
							}
						}else if(model1.getValue("/root/reqData/searchData/tmp_clsf") == "2"){
							if(model1.getValue("/root/reqData/searchData/saly_yy") == ""){
								alert("급여년도는 필수 입력사항입니다.");
								return;
							}
						}
						// 오즈관련 노드 초기화..					
					 	resetOznode();					
					 						
					 	// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
					 	makeNodeValue("/root/oz_data/ozrName","hd/SP_HD_SALY_3320_P")
											
					 	// odi 파라미터 설정.					
					 	makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , getProperty("ss_cmpycd") );
					 	makeNodeValue("/root/oz_data/odiParam/iv_saly_yy" , model1.getValue("/root/reqData/searchData/saly_yy") );
					 						
						// 프린터로 직접출력할 경우에만 사용.. ( preview:미리보기,print:직접출력, export:파일 )					
						//makeNodeValue("/root/oz_data/preview","print"); 					
											
					 	// 레포트뷰어 호출.					
					 	openOzwin("/root/oz_data");
					]]>
				</script>
			</button>
			<button id="button17" class="btn05" navindex="9" crud="C" style="left:285px; top:2px; width:112px; height:21px; ">
				<caption>총괄표연월차수당</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(model1.getValue("/root/reqData/searchData/tmp_clsf") != "2"){
							if(model1.getValue("/root/reqData/searchData/saly_yy") == ""){
								alert("급여년도는 필수 입력사항입니다.");
								return;
							}
						}else if(model1.getValue("/root/reqData/searchData/tmp_clsf") == "2"){
							if(model1.getValue("/root/reqData/searchData/saly_yy") == ""){
								alert("급여년도는 필수 입력사항입니다.");
								return;
							}
						}
						// 오즈관련 노드 초기화..					
					 	resetOznode();					
					 						
					 	// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
					 	makeNodeValue("/root/oz_data/ozrName","hd/SP_HD_SALY_3321_P")
											
					 	// odi 파라미터 설정.					
					 	makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd" , getProperty("ss_cmpycd") );
					 	makeNodeValue("/root/oz_data/odiParam/iv_saly_yy" , model1.getValue("/root/reqData/searchData/saly_yy") );
					 						
						// 프린터로 직접출력할 경우에만 사용.. ( preview:미리보기,print:직접출력, export:파일 )					
						//makeNodeValue("/root/oz_data/preview","print"); 					
											
					 	// 레포트뷰어 호출.					
					 	openOzwin("/root/oz_data");
					]]>
				</script>
			</button>
			<button id="button18" class="btn04" navindex="9" visibility="hidden" crud="C" style="left:399px; top:2px; width:88px; height:21px; ">
				<caption>엑셀업로드</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							var filename = window.fileDialog("open", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
							if(filename!="")
							{
								datagrid5.loadExcel(filename);
								datagrid5.mergeCells = "never";
								datagrid5.refresh();
									
								for(var i=1; i< datagrid5.rows; i++)
								{
									var status = datagrid5.rowstatus(i);
									
									if(status == "0") {
										datagrid5.addStatus(i,"insert");
									}
								}
								datagrid5.deleteRow(1);
								model1.setValue("/root/reqData/multiUpData", datagrid5.getUpdateData());
								model1.send("hd_saly_3330");
							}
							
						if(submit_completed()) {
							alert("성공하였습니다.");
						/*model1.reset();
						loadData(emp, nm, gubun);
						
						group2.disabled = false;
						datagrid2.clearStatus();*/
						}	
					]]>
				</script>
			</button>
			<button id="button19" class="btn04" navindex="9" visibility="hidden" crud="C" style="left:491px; top:2px; width:88px; height:21px; ">
				<caption>연말정산업로드</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
							var filename = window.fileDialog("open", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
							if(filename!="")
							{
								datagrid6.loadExcel(filename);
								datagrid6.mergeCells = "never";
								datagrid6.refresh();
									
								for(var i=1; i< datagrid6.rows; i++)
								{
									var status = datagrid6.rowstatus(i);
									
									if(status == "0") {
										datagrid6.addStatus(i,"insert");
									}
								}
								datagrid6.deleteRow(1);
								model1.setValue("/root/reqData/multiUpData", datagrid6.getUpdateData());
								model1.send("hd_saly_3331");
							}
							
						if(submit_completed()) {
							alert("성공하였습니다.");
						/*model1.reset();
						loadData(emp, nm, gubun);
						
						group2.disabled = false;
						datagrid2.clearStatus();*/
						}	
					]]>
				</script>
			</button>
		</group>
	</xhtml:body>
</xhtml:html>
