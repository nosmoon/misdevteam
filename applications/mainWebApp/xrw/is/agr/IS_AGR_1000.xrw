<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet_ad.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>승락서등록</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session>
						</session>
						<comboSet>
							<curlist/>
							<curlist2/>
							<curlist3/>
							<curlist4/>
							<curlist5/>
							<curlist6/>
							<curlist7/>
							<teamlist/>
							<partlist/>
							<teamlist2/>
							<partlist2/>
							<curlist11/>
							<curlist12/>
							<curlist13/>
						</comboSet>
						<pageInfo/>
					</initData>
					<reqData>
						<fwdData>
						</fwdData>
						<searchData>
							<acwr_reg_dt/>
							<acwr_reg_seq/>
							<incmg_pers/>
						</searchData>
						<reqForm>
							<flag/>
							<acwr_reg_dt/>
							<acwr_reg_seq/>
							<rvord_dt/>
							<scat_dt/>
							<rvord_type/>
							<advcs_tel_no/>
							<dlco_clsf_cd_seq/>
							<dlco_nm/>
							<advcs_cd/>
							<advcs_cd_nm/>
							<advt_nm/>
							<indt_cd/>
							<indt_cd_nm/>
							<sale_clsf/>
							<spc_sale_clsf/>
							<std_cd/>
							<std_cd_nm/>
							<sms_send_req_yn/>
							<sms_ptph_no/>
							<prof_docu_clsf/>
							<trust_letter_resn/>
							<dept_cd/>
							<sub_dept_cd/>
							<chrg_pers/>
							<chrg_pers_nm/>
							<vatclsf>010</vatclsf>
							<rtax_yn/>
							<uprc_clsf/>
							<qunt/>
							<std_uprc/>
							<uprc/>
							<suply_amt/>
							<vat_amt/>
							<tot_rvord_amt/>
							<suply_pers_erplace_cd/>
							<remk/>
							<feed_req_matt/>
							<fix_yn/>
							<isewh_yn/>
							<bnch_qty/>
							<reg_point_unrcp_pass_dds/>
							<reg_point_unrcp_amt/>
							<deal_resn/>
							<clamt_mthd/>
							<sale_dlco_li_yn/>
							<sale_dlco_li_suply_amt/>
							<sale_dlco_li_vat/>
							<sale_dlco_tot/>
							<chg_pers/>
							<chg_dt_tm/>
							<scat_qty/>
							<remain_qty/>
							<asnt_dstc_cd/>
							<asnt_dstc_nm/>
							<clamt_plan_dt/>
							<no_purc_yn/>
						</reqForm>
						<multiUpdateData1/>
						<multiUpdateData2/>
						<reqForm2/>
					</reqData>
					<reqData2>
						<searchData2>
							<scat_dt_fr/>
							<scat_dt_to/>
							<dept_cd/>
							<sub_dept_cd/>
							<chrg_pers/>
							<chrg_pers_nm/>
							<dlco_clsf_cd_seq/>
							<dlco_clsf_cd_seq_nm/>
							<advcs_cd/>
							<advcs_cd_nm/>
							<indt_cd/>
							<indt_cd_nm/>
							<sale_clsf/>
							<spc_sale_clsf/>
							<std_cd/>
							<std_cd_nm/>
							<rvord_type/>
							<advt_nm/>
						</searchData2>
					</reqData2>
					<resData>
						<resForm>
							<flag/>
							<acwr_reg_dt/>
							<acwr_reg_seq/>
							<rvord_dt/>
							<scat_dt/>
							<rvord_type/>
							<advcs_tel_no/>
							<dlco_clsf_cd_seq/>
							<dlco_nm/>
							<advcs_cd/>
							<advcs_cd_nm/>
							<advt_nm/>
							<indt_cd/>
							<indt_cd_nm/>
							<sale_clsf/>
							<spc_sale_clsf/>
							<std_cd/>
							<std_cd_nm/>
							<sms_send_req_yn/>
							<sms_ptph_no/>
							<prof_docu_clsf/>
							<trust_letter_resn/>
							<dept_cd/>
							<sub_dept_cd/>
							<chrg_pers/>
							<chrg_pers_nm/>
							<vatclsf>010</vatclsf>
							<rtax_yn/>
							<uprc_clsf/>
							<qunt/>
							<std_uprc/>
							<uprc/>
							<suply_amt/>
							<vat_amt/>
							<tot_rvord_amt/>
							<suply_pers_erplace_cd/>
							<remk/>
							<feed_req_matt/>
							<fix_yn/>
							<isewh_yn/>
							<bnch_qty/>
							<reg_point_unrcp_pass_dds/>
							<reg_point_unrcp_amt/>
							<deal_resn/>
							<clamt_mthd/>
							<sale_dlco_li_yn/>
							<sale_dlco_li_suply_amt/>
							<sale_dlco_li_vat/>
							<sale_dlco_tot/>
							<chg_pers/>
							<chg_dt_tm/>
							<scat_qty/>
							<remain_qty/>
							<asnt_dstc_cd/>
							<asnt_dstc_nm/>
							<clamt_plan_dt/>
							<xx_qty/>
							<xx_uprc/>
							<no_purc_yn/>
							<gridData1>
								<record>
									<checked/>
									<a_asnt_dstc_cd/>
									<a_asnt_dstc_cd_nm/>
									<a_dlco_clsf_cd_seq/>
									<a_dlco_nm/>
									<a_purc_clsf/>
									<a_send_qty/>
									<a_send_rate/>
									<a_qunt/>
									<a_uprc/>
									<a_purc_amt/>
									<a_trc_yn/>
									<a_send_yn/>
									<a_remk/>
									<a_purc_reg_dt/>
									<a_purc_reg_seq/>
								</record>
							</gridData1>
							<gridData2>
								<record>
									<decid_pers_nm/>
									<decid_pers_dty_cd_nm/>
									<decid_yn/>
									<proc_dt/>
									<decid_pers_dty_cd/>
								</record>
							</gridData2>
						</resForm>
						<resForm2>
							<gridData1>
								<record>
									<b_dlco_clsf_cd_seq/>
									<b_dlco_abrv_nm/>
									<b_dlco_nm/>
									<b_asnt_dstc_cd/>
									<b_asnt_dstc_cd_nm/>
									<b_send_qty/>
								</record>
							</gridData1>
						</resForm2>
					</resData>
					<resData2>
						<resForm2>
							<gridData1>
								<record>
									<scat_dt/>
									<dlco_nm/>
									<advcs_cd_nm/>
									<advt_nm/>
									<indt_cd_nm/>
									<suply_amt/>
									<vat_amt/>
									<tot_rvord_amt/>
									<vatclsf_nm/>
									<std_cd_nm/>
									<sale_clsf_nm/>
									<spc_sale_clsf_nm/>
									<clamt_mthd_nm/>
									<fix_yn/>
									<chrg_pers/>
									<dept_cd_nm/>
									<acwr_reg_dt/>
									<acwr_reg_seq/>
									<qunt/>
									<uprc/>
								</record>
							</gridData1>
						</resForm2>
					</resData2>
					<tempData>
						<keyDat/>
					</tempData>
					<msgData/>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				datagrid1.removeRow();
				datagrid1.clearStatus();
				/**탭1(등록)**/
				makeTeamSearch(
								   "is_agr_1000_m"
								  , "/is/agr/1000"
								  , "/root/reqData"  
		                          , "/root/initData/comboSet"
								  , "team_combo2"
								  , "part_combo2"
								  );
				/**탭2(현황)**/
				/*				
				makeTeamSearch2(
								   "is_agr_1000_m"
								  , "/is/agr/1000"
								  , "/root/reqData"  
		                           			  , "/root/initData/comboSet"
								  , "team_combo2"
								  , "part_combo2"
								  );
				*/
				inp_chrg_pers.value    = getProperty("ss_emp_no");
				inp_chrg_pers_nm.value = getProperty("ss_emp_nm");
				model.setValue("/root/reqData/searchData/acwr_reg_dt", getCurrentDate());					
				model.setValue("/root/reqData2/searchData2/scat_dt_fr", dateAdd("d", -5, getCurrentDate()));
				model.setValue("/root/reqData2/searchData2/scat_dt_to", getCurrentDate());
				model.setValue("/root/resData/resForm/rvord_dt", getCurrentDate());	/**수주일자20120722수정**/
				
				inp_acwr_reg_dt.refresh();
				inp_scat_dt_fr.refresh();
				inp_scat_dt_to.refresh();
				input27.refresh();
				
				/**제작의뢰서등록 버튼활성화 회사코드 322 버튼 보여줌 시작**/
				/*
				if(getProperty("ss_cmpycd") == "322"){
					button10.visible = true;
				}
				*/
				/**제작의뢰서등록 버튼활성화 회사코드 322 버튼 보여줌 종료**/
				
				setMenu_srch(inp_chrg_pers.value, inp_chrg_pers_nm.value);
				
				datagrid1.fixedcellcheckbox(0, datagrid1.colRef("checked"), false) = true;	/**체크박스 전체**/
				
				model.refresh();				
				]]>
			</script>
			<submission id="is_agr_1000_m" action="/is/agr/1000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/comboSet/is_agr_1000_m/dataSet"/>
			<submission id="is_agr_1010_s" action="/is/agr/1010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm"/>
			<submission id="is_agr_1015_a" action="/is/agr/1015" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/msgData"/>
			<submission id="is_agr_1030_l" action="/is/agr/1030" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/resData/resForm2"/>
			<submission id="is_agr_1031_s" action="/is/agr/1031" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData"/>
			<submission id="is_agr_1032_s" action="/is/agr/1032" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData"/>
			<submission id="is_agr_1040_l" action="/is/agr/1040" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData2/searchData2" resultref="/root/resData2/resForm2"/>
			<submission id="is_com_1200_s" action="/is/com/1200" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData"/>
			<submission id="is_com_1201_s" action="/is/com/1201" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData"/>
			<submission id="is_com_1202_s" action="/is/com/1202" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData"/>
			<submission id="fc_co_8000_s" action="/fc/co8000/8000" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/resData/resform2/dataSet"/>
			<submission id="hd_com_1002" action="/hd/com/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript" src="/js/se_comm.js"/>
		<script type="javascript">
			<![CDATA[
			/**탭1. 콤보박스 환경설정한다. **/
			function makeTeamSearch(submitId, action, ref, resultref, teamCombo, partCombo){

				modelSendNoMake(submitId, action, ref, resultref);
				if(!submit_completed()) return;
				
				var teamEvent = 'selectTeam("' + resultref + '", "' + teamCombo + '", "' + partCombo + '");';
				//var partEvent = 'selectPart("' + resultref + '", "' + teamCombo + '", "' + partCombo + '", "' + areaCombo + '");';
				//teamEvent = teamEvent + partEvent;
			
				eval(teamCombo + ".attribute('xforms-select') = '" + teamEvent + "'");
				//eval(partCombo + ".attribute('xforms-select') = '" + partEvent + "'");
				
				//makeComboGubun("", resultref + "/curlist", "record", "cdnm", "cd");	//탭1.수주형태 콤보
				combo1.select(0);
				//makeComboGubun("", resultref + "/curlist2", "record", "cdnm", "cd");	//탭1.매출구분 콤보
				combo6.select(0);
				makeComboGubun("", resultref + "/curlist3", "record", "cdnm", "cd")	//탭1.특집매출구분 콤보 
				makeComboGubun(resultref + "/curlist4", "record", "cdnm", "cd");	//탭1.증빙서류구분 콤보 
				radio2.select(0);
				makeComboGubun(resultref + "/curlist5", "record", "cdnm", "cd");	//탭1.부가세 콤보
				radio1.select(0);
				//makeComboGubun("", resultref + "/curlist6", "record", "cdnm", "cd");	//탭1.수금구분 콤보
				combo3.select(1);
				//makeComboGubun("", resultref + "/curlist7", "record", "cdnm", "cd");	//탭1.단가구분 콤보
				combo4.select(1);
				makeComboGubun("", resultref + "/teamlist", "record", "dept_nm", "dept_cd");
				makeComboGubun("", resultref + "/partlist_temp", "record", "dept_nm", "dept_cd");


				makeComboGubun("A", resultref + "/curlist11", "record", "cdnm", "cd");		//탭2.수주형태 콤보
				makeComboGubun("A", resultref + "/curlist12", "record", "cdnm", "cd");		//탭2.매출구분 콤보
				makeComboGubun("A", resultref + "/curlist13", "record", "cdnm", "cd")		//탭2.특집매출구분 콤보 
				makeComboGubun("A", resultref + "/teamlist2", "record", "dept_nm", "dept_cd"); //탭2.팀
				makeComboGubun("A", resultref + "/partlist2", "record", "dept_nm", "dept_cd");  	//탭2.파트


			
				selectTeam(resultref, teamCombo, partCombo);
				//selectPart(resultref, teamCombo, partCombo, areaCombo); 보류
				model.refresh();
			    //eval(teamCombo + ".select(0)");
			}
			
			/** 팀이 선택되면 파트의 값을 변경한다. **/
			function selectTeam(resultref, teamCombo, partCombo){
				var key        = eval(teamCombo + ".value");
				var arr        = instance1.selectSingleNode(resultref + "/partlist_temp/record"); 

				if(arr == null){
					var len = null;
				}else{
					var len = arr.length;
				}
			
				var val, record, dept_cd, dept_nm, node2, node3;
				var node = resultref + "/partlist2";
				var nodeTemp = resultref + "/partlist_temp";
				var index = 1;
				model.removeNodeset(node);
			
			//alert('part='+len);	
			//alert('dept_cd='+model.getValue(nodeTemp + "/record/dept_cd"));
			//alert('dept_nm='+model.getValue(nodeTemp + "/record/dept_nm"));
			
				if(len==0){
					val          = model.getValue(nodeTemp + "/record/supr_dept_cd");
					if ( key == val || key == "" ){
							model.makeNode(node + "/record[" + 1 + "]");
							model.makeNode(node + "/record[" + 1 + "]/dept_cd");
							model.makeNode(node + "/record[" + 1 + "]/dept_nm");
							
							model.setValue(node + "/record[" + 1 + "]/dept_cd", model.getValue(nodeTemp + "/record/dept_cd"));
							model.setValue(node + "/record[" + 1 + "]/dept_nm", model.getValue(nodeTemp + "/record/dept_nm"));
					}
				}else if(len > 1){
					for ( var i = 1 ; i <= len ; i++ ){
						val          = model.getValue(nodeTemp + "/record[" + i + "]/supr_dept_cd");
						if ( key == val || key == "" ){
								model.makeNode(node + "/record[" + index + "]");
								model.makeNode(node + "/record[" + index + "]/dept_cd");
								model.makeNode(node + "/record[" + index + "]/dept_nm");
								
								model.setValue(node + "/record[" + index + "]/dept_cd", model.getValue(nodeTemp + "/record[" + i + "]/dept_cd"));
								model.setValue(node + "/record[" + index + "]/dept_nm", model.getValue(nodeTemp + "/record[" + i + "]/dept_nm"));
								
								index++;
				
						}
					}
				}
				
				model.refresh();
				makeComboGubun("A", resultref + "/partlist2", "record", "dept_nm", "dept_cd");
				
				eval(partCombo + ".select(0)");
			}
			
			/** 탭2.콤보박스 환경설정한다. **/
			/*
			function makeTeamSearch2(submitId, action, ref, resultref, teamCombo, partCombo){

				modelSendNoMake(submitId, action, ref, resultref);
				if(!submit_completed()) return;
				
				var teamEvent = 'selectTeam2("' + resultref + '", "' + teamCombo + '", "' + partCombo + '");';
				//var partEvent = 'selectPart("' + resultref + '", "' + teamCombo + '", "' + partCombo + '", "' + areaCombo + '");';
				//teamEvent = teamEvent + partEvent;
			
				eval(teamCombo + ".attribute('xforms-select') = '" + teamEvent + "'");
				//eval(partCombo + ".attribute('xforms-select') = '" + partEvent + "'");
				
				makeComboGubun("A", resultref + "/curlist11", "record", "cdnm", "cd");	//수주형태 콤보
				makeComboGubun("A", resultref + "/curlist12", "record", "cdnm", "cd");	//매출구분 콤보
				makeComboGubun("A", resultref + "/curlist13", "record", "cdnm", "cd")		//특집매출구분 콤보 
				makeComboGubun("A", resultref + "/teamlist2", "record", "dept_nm", "dept_cd"); //팀
				makeComboGubun("A", resultref + "/partlist2", "record", "dept_nm", "dept_cd");  //파트

			
				selectTeam2(resultref, teamCombo, partCombo);
				//selectPart(resultref, teamCombo, partCombo, areaCombo); 보류
				model.refresh();
			    //eval(teamCombo + ".select(0)");
			}
			*/
			/** 팀이 선택되면 파트의 값을 변경한다. **/
			/*
			function selectTeam2(resultref, teamCombo, partCombo){
				var key        = eval(teamCombo + ".value");
				var arr        = instance1.selectSingleNode(resultref + "/partlist_temp/record"); 

				if(arr == null){
					var len = null;
				}else{
					var len = arr.length;
				}
			
				var val, record, dept_cd, dept_nm, node2, node3;
				var node = resultref + "/partlist2";
				var nodeTemp = resultref + "/partlist_temp";
				var index = 1;
				model.removeNodeset(node);
			
			//alert('part='+len);	
			//alert('dept_cd='+model.getValue(nodeTemp + "/record/dept_cd"));
			//alert('dept_nm='+model.getValue(nodeTemp + "/record/dept_nm"));
			
				if(len==0){
					val          = model.getValue(nodeTemp + "/record/supr_dept_cd");
					if ( key == val || key == "" ){
							model.makeNode(node + "/record[" + 1 + "]");
							model.makeNode(node + "/record[" + 1 + "]/dept_cd");
							model.makeNode(node + "/record[" + 1 + "]/dept_nm");
							
							model.setValue(node + "/record[" + 1 + "]/dept_cd", model.getValue(nodeTemp + "/record/dept_cd"));
							model.setValue(node + "/record[" + 1 + "]/dept_nm", model.getValue(nodeTemp + "/record/dept_nm"));
					}
				}else if(len > 1){
					for ( var i = 1 ; i <= len ; i++ ){
						val          = model.getValue(nodeTemp + "/record[" + i + "]/supr_dept_cd");
						if ( key == val || key == "" ){
								model.makeNode(node + "/record[" + index + "]");
								model.makeNode(node + "/record[" + index + "]/dept_cd");
								model.makeNode(node + "/record[" + index + "]/dept_nm");
								
								model.setValue(node + "/record[" + index + "]/dept_cd", model.getValue(nodeTemp + "/record[" + i + "]/dept_cd"));
								model.setValue(node + "/record[" + index + "]/dept_nm", model.getValue(nodeTemp + "/record[" + i + "]/dept_nm"));
								
								index++;
				
						}
					}
				}
				
				model.refresh();
				makeComboGubun("A", resultref + "/partlist2", "record", "dept_nm", "dept_cd");
				
				eval(partCombo + ".select(0)");
			}
			*/
			
			
			
			/**탭1(등록).거래처 팝업**/
			function setDlcoInfo(menu_id, menu_nm){
				model.setValue("/root/resData/resForm/dlco_clsf_cd_seq", menu_id);
				model.setValue("/root/resData/resForm/dlco_nm", menu_nm);
				
				/**거래처 코드로 미수금액, 미수경과일수 셋팅 시작**/
				model.makeNode("/root/tempData/reg_point_unrcp_pass_dds");
				model.makeNode("/root/tempData/reg_point_unrcp_amt");
				model.send("is_agr_1031_s");
				
				var reg_point_unrcp_amt = model.getValue("/root/tempData/reg_point_unrcp_amt");
				var reg_point_unrcp_pass_dds = model.getValue("/root/tempData/reg_point_unrcp_pass_dds");
				
				if(reg_point_unrcp_amt != "" &&  reg_point_unrcp_pass_dds != ""){
					model.setValue("/root/resData/resForm/reg_point_unrcp_amt", reg_point_unrcp_amt); //미수금액 셋팅
					model.setValue("/root/resData/resForm/reg_point_unrcp_pass_dds", reg_point_unrcp_pass_dds); //미수경과일수
				}else{
					model.setValue("/root/resData/resForm/reg_point_unrcp_amt", ""); //미수금액 셋팅
					model.setValue("/root/resData/resForm/reg_point_unrcp_pass_dds", ""); //미수경과일수
				}
				/**거래처 코드로 미수금액, 미수경과일수 셋팅 종료**/
				
				//menu_id.refresh();
				//menu_nm.refresh();
				model.refresh();	
			}
			
			/**탭2(현황).거래처 팝업**/
			function setDlcoInfo2(menu_id, menu_nm){
				model.setValue("/root/reqData2/searchData2/dlco_clsf_cd_seq", menu_id);
				model.setValue("/root/reqData2/searchData2/dlco_clsf_cd_seq_nm", menu_nm);
											
				//menu_id.refresh();
				//menu_nm.refresh();
				model.refresh();	
			}
				
			/**탭1(등록).데이터그리드 거래처 팝업**/
			function dg_setDlcoInfo(menu_id, menu_nm_1, menu_nm_2, menu_nm_3, menu_nm_4){
				datagrid1.valueMatrix(datagrid1.row, 2) = menu_nm_2;	/**구역코드**/
				datagrid1.valueMatrix(datagrid1.row, 3) = menu_nm_3;	/**구역명**/
				
				datagrid1.valueMatrix(datagrid1.row, 4) = menu_id;		/**거래처코드**/
				datagrid1.valueMatrix(datagrid1.row, 5) = menu_nm_1;	/**거래처명**/
				
				datagrid1.valueMatrix(datagrid1.row, 7) = menu_nm_4;	/**발송부수**/
				datagrid1.addStatus(datagrid1.row, "update");  //상태 변경
				
				model.refresh();	
			}	
				
						
			/**탭1(등록).광고주 팝업**/
			function setAdDlcoInfo(menu_id, menu_nm1, menu_nm2){
				model.setValue("/root/resData/resForm/advcs_cd", menu_id);
				model.setValue("/root/resData/resForm/advcs_cd_nm", menu_nm1);
			 
				if(menu_nm2 != ""){
					model.setValue("/root/resData/resForm/sms_send_req_yn", "Y");	/**SMS휴대폰체크박스 20120726**/
				}else{
					model.setValue("/root/resData/resForm/sms_send_req_yn", "");	/**SMS휴대폰체크박스 20120726**/
				}
				
				model.setValue("/root/resData/resForm/sms_ptph_no", menu_nm2);	/**SMS휴대폰번호 20120726**/
								
				/**거래처 코드로 업종코드, 업종명 셋팅 시작**/
				model.removeNodeset("/root/reqData/fwdData");  
				model.makeNode("/root/reqData/fwdData/advcs_cd");
				model.setValue("/root/reqData/fwdData/advcs_cd", inp_advcs_cd.value);
				
				model.send("is_com_1201_s");				
				var indt_cd = model.getValue("/root/tempData/record/indt_cd");
				var indt_cd_nm = model.getValue("/root/tempData/record/indt_cd_nm");
			
				if(indt_cd != "" &&  indt_cd_nm != ""){
					model.setValue("/root/resData/resForm/indt_cd", indt_cd); //업종코드
					model.setValue("/root/resData/resForm/indt_cd_nm", indt_cd_nm); //업종명
				}else{
					model.setValue("/root/resData/resForm/indt_cd", ""); //업종코드
					model.setValue("/root/resData/resForm/indt_cd_nm", ""); //업종명
				}
				/**거래처 코드로 업종코드, 업종명 셋팅 종료**/
								
				//menu_id.refresh();
				//menu_nm.refresh();
				model.refresh();	
			}
			
			/**탭2(현황).광고주 팝업**/
			function setAdDlcoInfo2(menu_id, menu_nm){
				model.setValue("/root/reqData2/searchData2/advcs_cd", menu_id);
				model.setValue("/root/reqData2/searchData2/advcs_cd_nm", menu_nm);
											
				//menu_id.refresh();
				//menu_nm.refresh();
				model.refresh();	
			}
			
			/**탭1(등록).담당자 팝업**/
			function setMenu_srch(menu_id, menu_nm){		
				model.setValue("/root/resData/resForm/chrg_pers", menu_id);
				model.setValue("/root/resData/resForm/chrg_pers_nm", menu_nm);
				
				/**담당자 선택시 팀,파트 셋팅 시작**/
				model.removeNodeset("/root/reqData/fwdData");  
				model.makeNode("/root/reqData/fwdData/chrg_pers");
				model.setValue("/root/reqData/fwdData/chrg_pers", inp_chrg_pers.value);
				
				model.send("is_com_1202_s");				
				var dept_cd = model.getValue("/root/tempData/record/dept_cd");
				var sub_dept_cd = model.getValue("/root/tempData/record/sub_dept_cd");
				
				
				if(dept_cd != "" || sub_dept_cd != ""){
					model.setValue("/root/resData/resForm/dept_cd", dept_cd); //팀
					model.setValue("/root/resData/resForm/sub_dept_cd", sub_dept_cd); //파트
				}else{
					model.setValue("/root/resData/resForm/dept_cd", ""); //팀
					model.setValue("/root/resData/resForm/sub_dept_cd", ""); //파트
				}				
				/**담당자 선택시 팀,파트 셋팅 종료**/							
				//menu_id.refresh();
				//menu_nm.refresh();
				model.refresh();	
			}	
			
			/**탭2(현황).담당자 팝업**/
			function setMenu_srch2(menu_id, menu_nm){		
				model.setValue("/root/reqData2/searchData2/chrg_pers", menu_id);
				model.setValue("/root/reqData2/searchData2/chrg_pers_nm", menu_nm);
											
				//menu_id.refresh();
				//menu_nm.refresh();
				model.refresh();	
			}
			
			/**휴대폰 형식체크**/
			function check_ptph_no(){
				var value = model.getValue("/root/resData/resForm/sms_ptph_no");
				if ( value != "" && value != "--"){
					var reg = /^\d{3}-\d{3,4}-\d{4}$/;					
					if ( !reg.test(value) ){
						commAlert("휴대폰번호 형식이 틀립니다.(ex.010-9999-9999)");
					}
				}
			}
			/**전화번호 형식체크**/
			function check_tel_no(){
				var value = model.getValue("/root/resData/resForm/sms_ptph_no");
				if ( value != "" && value != "--"){
					var reg = /^\d{2,3}-\d{3,4}-\d{4}$/;					
					if ( !reg.test(value) ){
						commAlert("전화번호 형식이 틀립니다.(ex.02-9999-9999)");						
					}
				}
			}

			/**배포내역엑셀다운로드**/
			function calc_baepo_sum(){
				var sum_amt = 0;
				for(i=1; i<datagrid1.rows; i++){
					if(datagrid1.valueMatrix(i,datagrid1.colRef("a_qunt")) != ""){
						sum_amt += eval(datagrid1.valueMatrix(i,datagrid1.colRef("a_qunt")));
					}
				}
				model.setValue("/root/resData/resForm/scat_qty", sum_amt);
				
				
				//잔량 = 수량 - 배포수량
				var qunt = eval(model.getValue("/root/resData/resForm/qunt")); //수량
				var remain_qty = 0;
				
				remain_qty = qunt - sum_amt;
				
				model.setValue("/root/resData/resForm/remain_qty", remain_qty);
				model.refresh();
			}
			
			/**배포내역서출력**/
			function goReport(gubun){
				
				var cmpy_cd = model.property("ss_cmpycd");				
				 				
				var acwr_reg_dt      = model.getValue("/root/reqData/searchData/acwr_reg_dt");
				var acwr_reg_seq     = model.getValue("/root/reqData/searchData/acwr_reg_seq");
				
				if( acwr_reg_dt == null || acwr_reg_seq == null ){
					alert("출력대상을 선택하세요.");
					return;
				}
				
				
				makeNodeValue("/root/oz_data/ozrName", "is/SP_IS_AGR_1050_P");
						
				makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd"			, cmpy_cd);
				makeNodeValue("/root/oz_data/odiParam/iv_acwr_reg_dt"		, acwr_reg_dt);
				makeNodeValue("/root/oz_data/odiParam/iv_acwr_reg_seq"		, acwr_reg_seq);
				
				openOzwin("/root/oz_data");
			}
			function calc_ji_rate(){
					//datagrid1.refresh();
						var sum_a_send_qty = 0;
						var checked = "";
						for(i=1; i<datagrid1.rows; i++){
							checked  = datagrid1.valueMatrix(i, datagrid1.colRef("checked"));
							
							if(datagrid1.valueMatrix(i,datagrid1.colRef("a_send_qty")) != "" && checked =="Y"){
								sum_a_send_qty += eval(datagrid1.valueMatrix(i,datagrid1.colRef("a_send_qty")));
							}							
							
						}
						
						var tot_qunt = model.getValue("/root/resData/resForm/qunt");
						var j_reate  = 0;
						if (sum_a_send_qty != 0){
							j_reate = Math.round(100*eval(tot_qunt)/sum_a_send_qty,2);	
						}
						
						model.setValue("/root/resData/resForm/xx_qty", j_reate);				
						model.refresh();
			}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="1,7;1,935;2,865;2,89;2,712;" style="font-family:돋움; font-size:12px; ">
		<button id="btnQry" class="btn02" crud="R" style="left:602px; top:40px; width:52px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[				
				if(switch1.selectedIndex==0){
					if( trim(inp_acwr_reg_dt.value) == "" || trim(inp_acwr_reg_seq.value) == "" ){
						alert("조회할 승낙서번호를(일자,번호) 입력하세요.");
						return;
					}
					model.send("is_agr_1010_s");					
				}else{
					model.send("is_agr_1040_l");
				}
				//model.setValue("/root/resData/resForm/flag", "U");
				for(i=1; i<datagrid1.rows; i++){
				datagrid1.valueMatrix(i, datagrid1.colRef("checked")) = "N";
				}							
				//datagrid1.fixedcellcheckbox(0, datagrid1.colRef("checked"), false) = false;		
						
				]]>
			</script>
		</button>
		<button id="btnIns" class="btn02" crud="C" style="left:658px; top:40px; width:52px; height:18px; ">
			<caption>저장</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var val = 0;
				
				var qunt = eval(model.getValue("/root/resData/resForm/qunt")); //수량
				var scat_qty = eval(model.getValue("/root/resData/resForm/scat_qty")); //배포수량
				
				if(scat_qty > qunt){
					alert("배포수량이 수주수량을 초과하였습니다.") ;
					return;
				}
						
				if(datagrid1.rows <= 1){
					val = window.alert("배포내역 입력없이 저장하시겠습니까?", "확인", 1) ;
					model.setValue("/root/resData/resForm/no_purc_yn", "Y");
				}else{
					model.setValue("/root/resData/resForm/no_purc_yn", "N");
				}
				
				// 1은 확인 2는 취소
				if ( val == 2 ){
					return;
				}
				
				/**필수 입력 항목체크 시작**/
				if(model.getValue("/root/resData/resForm/scat_dt") == ""){
					alert("배포일자를 입력하세요.");
					return;
				}
				
				if(model.getValue("/root/resData/resForm/dlco_clsf_cd_seq") == ""){
					alert("거래처를 입력하세요.");
					return;
				}
				
				if(model.getValue("/root/resData/resForm/rvord_dt") == ""){
					alert("수주일자를 입력하세요.");
					return;
				}
				
				if(model.getValue("/root/resData/resForm/advcs_cd") == ""){
					alert("광고주를 입력하세요.");
					return;
				}
				
//				if(model.getValue("/root/resData/resForm/advt_nm") == ""){
//					alert("광고명을 입력하세요.");
//					return;
//				}
				
				if(model.getValue("/root/resData/resForm/indt_cd") == ""){
					alert("업종을 입력하세요.");
					return;
				}	
				
				if(model.getValue("/root/resData/resForm/sale_clsf") == ""){
					alert("매출구분을 입력하세요.");
					return;
				}	
				
				if(model.getValue("/root/resData/resForm/chrg_pers") == ""){
					alert("담당자를 입력하세요.");
					return;
				}	
				
				if(model.getValue("/root/resData/resForm/uprc_clsf") == ""){
					alert("단가구분을 입력하세요.");
					return;
				}
				if(model.getValue("/root/resData/resForm/std_cd") == ""){
					alert("규격을 입력하세요.");
					return;
				}
				if(model.getValue("/root/resData/resForm/rvord_type") == ""){
					alert("수주형태를 입력하세요.");
					return;
				}
				if(model.getValue("/root/resData/resForm/qunt") == ""){
					alert("수량을 입력하세요.");
					return;
				}
				if(model.getValue("/root/resData/resForm/uprc") == ""){
					alert("수주단가를 입력하세요.");
					return;
				}
				if(model.getValue("/root/resData/resForm/suply_amt") == ""){
					alert("수주금액을 입력하세요.");
					return;
				}
				if(model.getValue("/root/resData/resForm/clamt_mthd") == ""){
					alert("수금방법을 입력하세요.");
					return;
				}
				if(model.getValue("/root/resData/resForm/clamt_plan_dt") == ""){
					alert("수금예정일자를 입력하세요.");
					return;
				}

				/**필수 입력 항목체크 종료**/
				
				
				var flag = model.getValue("/root/resData/resForm/flag");
				
				if(flag == "U"){
					model.setValue("/root/resData/resForm/flag", "U");
				}else{
					model.setValue("/root/resData/resForm/flag", "I");
				}	
			
				
				model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");		
								
				model.setValue("/root/reqData/multiUpdateData1", datagrid1.getUpdateData());

				
				model.send("is_agr_1015_a");
				
						
				if( submit_completed() ){
					model.setValue("/root/reqData/searchData/acwr_reg_dt", model.getValue("/root/msgData/acwr_reg_dt"));
					model.setValue("/root/reqData/searchData/acwr_reg_seq", model.getValue("/root/msgData/acwr_reg_seq"));
					
					model.send("is_agr_1010_s");
				}			
				]]>
			</script>
		</button>
		<button id="btnUpd" class="btn02" crud="U" style="left:714px; top:40px; width:52px; height:18px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var acwr_reg_dt = model.getValue("/root/resData/resForm/acwr_reg_dt");		/**승낙서일자**/
				var acwr_reg_seq = model.getValue("/root/resData/resForm/acwr_reg_seq");	/**승낙서순번**/
				
				if(acwr_reg_dt == "" && acwr_reg_seq == ""){
					alert("삭제할 건 없습니다.");
					return;
				}else{
					var val = window.alert("삭제하시겠습니까?", "확인", 1) ;
					// 1은 확인 2는 취소
					if ( val == 2 ){
						return;
					}
					
					model.setValue("/root/resData/resForm/flag", "D");						
					model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");		
									
					model.setValue("/root/reqData/multiUpdateData1", datagrid1.getUpdateData());
					
					model.send("is_agr_1015_a");				
							
					model.reset();
				}					
				]]>
			</script>
		</button>
		<button id="btnInit" class="btn02" crud="R" style="left:490px; top:40px; width:52px; height:18px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.reset();
				bool2.value = "N";
				]]>
			</script>
		</button>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<button id="btnClose" class="btn02" style="left:882px; top:40px; width:50px; height:18px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
				]]>
			</script>
		</button>
		<switch id="switch1" class="gro_sel" style="left:10px; top:82px; width:926px; height:637px; ">
			<case id="case1" selected="true" style="left:0px; top:0px; width:924px; height:635px; ">
				<caption id="caption71" class="list_cap02" style="left:214px; top:203px; width:62px; height:26px; "/>
				<caption id="caption28" class="list_cap02" style="left:69px; top:203px; width:93px; height:26px; "/>
				<caption id="caption38" class="list_cap02" style="left:161px; top:203px; width:55px; height:26px; "/>
				<caption id="caption49" class="list_cap02" style="left:275px; top:203px; width:78px; height:26px; "/>
				<caption id="caption26" class="list_cap02" style="left:5px; top:203px; width:65px; height:26px; "/>
				<caption id="caption58" class="list_cap02" style="left:632px; top:203px; width:115px; height:26px; "/>
				<caption id="caption69" class="list_cap02" style="left:745px; top:203px; width:101px; height:26px; "/>
				<caption id="caption67" class="list_cap02" style="left:427px; top:203px; width:115px; height:26px; "/>
				<caption id="caption55" class="list_cap02" style="left:352px; top:203px; width:76px; height:26px; "/>
				<caption id="caption66" class="list_cap02" style="left:541px; top:203px; width:93px; height:26px; "/>
				<caption id="caption70" class="list_cap02" style="left:845px; top:203px; width:76px; height:26px; "/>
				<caption id="caption14" class="list_cap02" style="left:5px; top:180px; width:916px; height:26px; "/>
				<caption id="caption36" class="list_cap02" style="left:5px; top:253px; width:916px; height:26px; "/>
				<caption id="caption32" class="list_cap02" style="left:5px; top:228px; width:916px; height:26px; "/>
				<caption id="caption54" class="list_cap02" style="left:5px; top:278px; width:916px; height:26px; "/>
				<caption id="caption9" class="list_cap02" style="left:5px; top:80px; width:614px; height:26px; "/>
				<caption id="caption13" class="list_cap02" style="left:5px; top:155px; width:916px; height:26px; "/>
				<caption id="caption3" class="list_cap02" style="left:5px; top:55px; width:614px; height:26px; "/>
				<caption id="caption2" class="list_cap02" style="left:5px; top:30px; width:614px; height:26px; "/>
				<caption id="caption11" class="list_cap02" style="left:5px; top:130px; width:916px; height:26px; "/>
				<caption id="caption10" class="list_cap02" style="left:5px; top:105px; width:916px; height:26px; "/>
				<caption id="caption74" class="list_cap02" style="left:5px; top:5px; width:614px; height:26px; "/>
				<button id="button1" class="btn_grid03" crud="R" style="left:760px; top:315px; width:53px; height:17px; ">
					<caption>행추가</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						addRow(datagrid1);
						/**행추가시 매출구분의 선택값을로 매입항목을 셋팅 시작**/
						var sale_clsf = model.getValue("/root/resData/resForm/sale_clsf");
						datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("a_purc_clsf")) =  sale_clsf;
						model.refresh();	
						/**행추가시 매출구분의 선택값을로 매입항목을 셋팅 종료**/
						]]>
					</script>
				</button>
				<button id="button3" class="btn_grid03" crud="R" style="left:817px; top:315px; width:53px; height:17px; ">
					<caption>행삭제</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						deleteRow(datagrid1);
						]]>
					</script>
				</button>
				<button id="button2" class="btn_grid02" crud="R" style="left:874px; top:315px; width:43px; height:17px; ">
					<caption>취소</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						cancelRow(datagrid1);
						]]>
					</script>
				</button>
				<datagrid id="datagrid1" nodeset="/root/resData/resForm/gridData1/record" caption="전체^구역코드^구역명^거래처코드^거래처명^매입항목^발송부수^배정율^매입수량^매입단가^매입금액^이관^발송^비고^a_purc_reg_dt^a_purc_reg_seq" colsep="#" colwidth="48, 65, 90, 85, 120, 100, 70, 53, 70, 70, 100, 35, 35, 154, 100, 100" mergecellsfixedcols="byrowrec" mergecellsfixedrows="byrowrec" rowheader="update" rowsep="|" selectionmode="byrow" style="left:5px; top:340px; width:915px; height:285px; text-align:center; ">
					<col checkvalue="Y,N" ref="checked" type="checkbox"/>
					<col ref="a_asnt_dstc_cd" type="inputbutton"/>
					<col ref="a_asnt_dstc_cd_nm" style="text-align:left; "/>
					<col ref="a_dlco_clsf_cd_seq" type="inputbutton"/>
					<col ref="a_dlco_nm" style="text-align:left; "/>
					<col ref="a_purc_clsf" type="combo">
						<choices>
							<itemset nodeset="/root/initData/comboSet/curlist2/record">
								<label ref="cdnm"/>
								<value ref="cd"/>
							</itemset>
						</choices>
					</col>
					<col ref="a_send_qty" format="#,###" style="text-align:right; "/>
					<col ref="a_send_rate" format="(-)#,###.99" style="text-align:right; "/>
					<col ref="a_qunt" type="input" format="#,##0" style="text-align:right; "/>
					<col ref="a_uprc" type="input" format="(-)#,###.99" style="text-align:right; "/>
					<col disabled="true" ref="a_purc_amt" type="input" format="#,###" style="text-align:right; background-color:#c0c0c0; "/>
					<col checkvalue="Y,N" ref="a_trc_yn" type="checkbox"/>
					<col checkvalue="Y,N" disabled="true" ref="a_send_yn" type="checkbox"/>
					<col imemode="hangul" ref="a_remk" type="input" style="text-align:left; "/>
					<col ref="a_purc_reg_dt" visibility="hidden"/>
					<col ref="a_purc_reg_seq" visibility="hidden"/>
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						/**구역팝업**/
						if(datagrid1.col == datagrid1.colRef("a_asnt_dstc_cd")){
							var dataIndex 	=	getSelectedRecordIndex(datagrid1);
					
							var resultRef1 =  "/root/resData/resForm/gridData1/record["+dataIndex+"]/a_asnt_dstc_cd";
							var resultRef2 =  "/root/resData/resForm/gridData1/record["+dataIndex+"]/a_asnt_dstc_cd_nm";
						
							showCommonCodePopup1("13", "04", "", "", "", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
							
							if(model.getValue("/root/resData/resForm/gridData1/record["+dataIndex+"]/a_asnt_dstc_cd") != ""){
								
								datagrid1.addStatus(datagrid1.row, "update");
								model.refresh();
							}							
						}
						
						/**거래처팝업**/
						if(datagrid1.col == datagrid1.colRef("a_dlco_clsf_cd_seq")){
							model.makeNode("/root/reqData/fwdData/func_nm");
							model.setValue("/root/reqData/fwdData/func_nm", "dg_setDlcoInfo");//팝업에서 함수호출명 
								
							window.load("/xrw/is/com/IS_COM_1110.xrw"
										,"mdichild"
										, "is_com_1110"
										, "align:center; caption:hidden;width:645px; height:480px;"
										, "/root/reqData/fwdData"
										, "/root/reqData/fwdData");
						}
						
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[						
						/**매입수량 입력전에 수량부터 입력함**/
						if(model.getValue("/root/resData/resForm/qunt") == ""){
							alert("수량을 먼저 입력하세요");
							for(i=1; i<datagrid1.rows; i++){
								datagrid1.valueMatrix(i,datagrid1.colRef("a_qunt")) = "";
							}
							return;
						}
						
						var row = datagrid1.row;

						//매입수량 sum하여 배포수량으로 셋팅
						var sum_amt = 0;
						for(i=1; i<datagrid1.rows; i++){
							if(datagrid1.valueMatrix(i,datagrid1.colRef("a_qunt")) != ""){
								sum_amt += eval(datagrid1.valueMatrix(i,datagrid1.colRef("a_qunt")));
							}
	
						}
						model.setValue("/root/resData/resForm/scat_qty", sum_amt);
						
						
						//잔량 = 수량 - 배포수량
						var qunt = eval(model.getValue("/root/resData/resForm/qunt")); //수량
						var remain_qty = 0;
						
						remain_qty = qunt - sum_amt;
						
						model.setValue("/root/resData/resForm/remain_qty", remain_qty);
						model.refresh();
												
						
						/**매입금액=매입수량+매입단가**/
						if(datagrid1.col>=datagrid1.colRef("a_qunt") && datagrid1.col<=datagrid1.colRef("a_uprc")){
							var a_purc_amt = 0;
							var a_qunt = Number(datagrid1.valueMatrix(row, datagrid1.colRef("a_qunt")));
							var a_uprc = Number(datagrid1.valueMatrix(row, datagrid1.colRef("a_uprc")));
													
							a_purc_amt	=	a_qunt * a_uprc;
							
							datagrid1.valueMatrix(row, datagrid1.colRef("a_purc_amt")) = a_purc_amt;
							
							datagrid1.refresh();	
						}
						
						/**배정율 구하기 ((매입수량/발송부수)*100)**/
						if(datagrid1.col == datagrid1.colRef("a_qunt")){
							
							var a_qunt = Number(datagrid1.valueMatrix(row, datagrid1.colRef("a_qunt")));	/**매입수량**/
							var a_send_qty = Number(datagrid1.valueMatrix(row, datagrid1.colRef("a_send_qty")));	/**발송부수**/
							
							if(a_send_qty != 0 && a_qunt != 0){
								datagrid1.valueMatrix(row, datagrid1.colRef("a_send_rate")) = (a_qunt/a_send_qty)*100;
							}else{
								datagrid1.valueMatrix(row, datagrid1.colRef("a_send_rate")) = 0;
							}
							datagrid1.refresh();	
						}
						]]>
					</script>
					<script type="javascript" ev:event="xforms-select">
						<![CDATA[
						   
						   var row = datagrid1.row;
						   if(row==0){
								for(i=1; i<datagrid1.rows; i++){
								datagrid1.valueMatrix(i, datagrid1.colRef("checked")) = "Y";
								}							
							}
						
							calc_ji_rate();

						]]>
					</script>
					<script type="javascript" ev:event="xforms-deselect">
						<![CDATA[
						   var row = datagrid1.row;
						   if(row==0){
								for(i=1; i<datagrid1.rows; i++){
								datagrid1.valueMatrix(i, datagrid1.colRef("checked")) = "N";
								}							
							}						
							calc_ji_rate();					
						]]>
					</script>
				</datagrid>
				<datagrid id="datagrid2" nodeset="/root/resData/resForm/gridData2/record" caption="결재자^직위^결재^결재시간" colsep="#" colwidth="64, 54, 43, 121" mergecellsfixedrows="bycolrec" rowsep="|" style="left:620px; top:5px; width:301px; height:99px; ">
					<col ref="decid_pers_nm"/>
					<col ref="decid_pers_dty_cd_nm"/>
					<col ref="decid_yn"/>
					<col ref="proc_dt"/>
				</datagrid>
				<datagrid id="datagrid5" nodeset="/root/resData/resForm2/gridData1/record" visibility="hidden" caption="거래처코드^b_dlco_abrv_nm^거래처명^구역코드^구역코드명^발송부수" colsep="#" colwidth="82, 100, 77, 83, 82, 100" mergecellsfixedrows="bycolrec" rowsep="|" style="left:390px; top:460px; width:505px; height:155px; ">
					<col ref="b_dlco_clsf_cd_seq"/>
					<col ref="b_dlco_abrv_nm"/>
					<col ref="b_dlco_nm"/>
					<col ref="b_asnt_dstc_cd"/>
					<col ref="b_asnt_dstc_cd_nm"/>
					<col ref="b_send_qty"/>
				</datagrid>
				<select id="checkbox1" ref="/root/resData/resForm/rtax_yn" navindex="200" overflow="visible" appearance="full" style="left:10px; top:208px; width:55px; height:15px; border-style:none; ">
					<choices>
						<item>
							<label>미발행</label>
							<value>Y</value>
						</item>
					</choices>
				</select>
				<caption id="caption20" class="list_cap03" style="left:5px; top:105px; width:99px; height:26px; text-align:center; ">증빙서류</caption>
				<caption id="caption31" class="list_cap03" style="left:5px; top:130px; width:99px; height:26px; text-align:center; ">특기사항</caption>
				<caption id="caption1" class="list_cap01" style="left:5px; top:5px; width:99px; height:26px; text-align:center; ">승낙서번호</caption>
				<bool id="bool2" disabled="true" navindex="140" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/fix_yn" style="left:720px; top:135px; width:26px; height:20px; background-image:#uncheck; "/>
				<caption id="caption21" class="list_cap03" style="left:355px; top:105px; width:99px; height:26px; text-align:center; ">신탁서사유</caption>
				<input id="input33" ref="/root/resData/resForm/uprc" class="req" navindex="250" format="(-)#,###.99" style="left:352px; top:207px; width:76px; height:20px; text-align:right; ">
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						var qunt = model.getValue("/root/resData/resForm/qunt");
						var uprc = model.getValue("/root/resData/resForm/uprc");
						
						if(qunt != "" && uprc != ""){
							/**010:별도 020:포함**/
							if(model.getValue("/root/resData/resForm/vatclsf") == "010"){
								var sum = eval(qunt) * eval(uprc);		//수주금액 = 수량 * 단가
								var sum2 = (eval(qunt) * eval(uprc))/10	//부가세 = (수량 * 단가) /10
								var sum3 = sum + sum2;				//합계 = 수주금액 + 부가세									
								
								model.setValue("/root/resData/resForm/suply_amt", sum);	//수주금액
								model.setValue("/root/resData/resForm/vat_amt", sum2);		//부가세
								model.setValue("/root/resData/resForm/tot_rvord_amt", sum3);	//합계								
							}else{
								var sum = (eval(qunt) * eval(uprc)); 		//합계 = 수량 * 단가
								var sum2 = sum - Math.floor(sum / 11);  	//수주금액 = 합계 - (합계/11)
								var sum3 = sum - sum2; 				//부가세 = 합계 - 수주금액	
								
								model.setValue("/root/resData/resForm/tot_rvord_amt",sum);	//합계
								model.setValue("/root/resData/resForm/suply_amt", sum2);	//수주금액
								model.setValue("/root/resData/resForm/vat_amt", sum3);		//부가세
							}
						}else{
							model.setValue("/root/resData/resForm/tot_rvord_amt","");
							model.setValue("/root/resData/resForm/suply_amt","");
							model.setValue("/root/resData/resForm/vat_amt" ,"");
						}
						model.refresh();
						]]>
					</script>
				</input>
				<select1 id="combo1" ref="/root/resData/resForm/rvord_type" class="req" navindex="150" appearance="minimal" style="left:848px; top:133px; width:67px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/curlist/record">
							<label ref="cdnm"/>
							<value ref="cd"/>
						</itemset>
					</choices>
				</select1>
				<caption id="caption22" class="list_cap03" style="left:5px; top:278px; width:99px; height:26px; text-align:center; ">담당자</caption>
				<caption id="caption33" class="list_cap03" style="left:632px; top:180px; width:115px; height:26px; text-align:center; ">합계</caption>
				<caption id="caption23" class="list_cap03" style="left:355px; top:30px; width:99px; height:26px; text-align:center; ">수주일자</caption>
				<caption id="caption34" class="list_cap03" style="left:427px; top:180px; width:115px; height:26px; text-align:center; ">수주금액</caption>
				<input id="input13" ref="/root/resData/resForm/suply_amt" class="req" navindex="270" format="(-)#,###" style="left:427px; top:207px; width:115px; height:20px; text-align:right; "/>
				<caption id="caption35" class="list_cap03" style="left:541px; top:180px; width:93px; height:26px; text-align:center; ">부가세</caption>
				<input id="input14" ref="/root/resData/resForm/tot_rvord_amt" navindex="290" format="(-)#,###" style="left:632px; top:207px; width:115px; height:20px; text-align:right; "/>
				<caption id="caption5" class="list_cap03" style="left:5px; top:30px; width:99px; height:26px; text-align:center; ">거래처</caption>
				<select1 id="radio1" ref="/root/resData/resForm/vatclsf" navindex="210" appearance="full" cols="3" overflow="visible" row="1" style="left:72px; top:208px; width:87px; height:20px; border-style:none; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/curlist5/record">
							<label ref="cdnm"/>
							<value ref="cd"/>
						</itemset>
					</choices>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						var qunt = model.getValue("/root/resData/resForm/qunt");
						var uprc = model.getValue("/root/resData/resForm/uprc");
						
						if(qunt == "" || uprc == ""){
							alert("수량또는 단가를 입력하세요");	
							return;
						}
						
						/**010:별도 020:포함**/
						if(model.getValue("/root/resData/resForm/vatclsf") == "010"){
							var sum = eval(qunt) * eval(uprc);		//수주금액 = 수량 * 단가
							var sum2 = (eval(qunt) * eval(uprc))/10	//부가세 = (수량 * 단가) /10
							var sum3 = sum + sum2;				//합계 = 수주금액 + 부가세							
							
							model.setValue("/root/resData/resForm/suply_amt", sum);	//수주금액
							model.setValue("/root/resData/resForm/vat_amt", sum2);		//부가세
							model.setValue("/root/resData/resForm/tot_rvord_amt", sum3);	//합계
						}else{
							var sum = (eval(qunt) * eval(uprc)); //합계 = 수량 * 단가
							var sum2 = sum - Math.floor(sum / 11);  //수주금액 = 합계 - (합계/11)
							var sum3 = sum - sum2; //부가세 = 합계 - 수주금액
							
							model.setValue("/root/resData/resForm/tot_rvord_amt",sum);	//합계
							model.setValue("/root/resData/resForm/suply_amt", sum2);	//수주금액
							model.setValue("/root/resData/resForm/vat_amt", sum3);		//부가세
						}
						model.refresh();
						]]>
					</script>
				</select1>
				<select1 id="combo4" ref="/root/resData/resForm/uprc_clsf" class="req" navindex="220" appearance="minimal" style="left:161px; top:207px; width:53px; height:20px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/curlist7/record">
							<label ref="cdnm"/>
							<value ref="cd"/>
						</itemset>
					</choices>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						/**단가구분 선택시 표준단가,단가 셋팅 시작**/
						model.makeNode("/root/tempData/std_uprc");
						model.send("is_agr_1032_s");
						var std_uprc = model.getValue("/root/tempData/std_uprc");
						model.setValue("/root/resData/resForm/std_uprc", std_uprc);	//표준단가
						model.setValue("/root/resData/resForm/uprc", std_uprc);		//단가
						model.refresh();
						/**단가구분 선택시 표준단가,단가 셋팅 종료**/						
						]]>
					</script>
				</select1>
				<input id="input27" ref="/root/resData/resForm/rvord_dt" class="req" navindex="50" inputtype="date" style="left:460px; top:35px; width:100px; height:18px; "/>
				<caption id="caption48" class="list_cap03" style="left:745px; top:130px; width:99px; height:26px; text-align:center; ">수주형태</caption>
				<input id="input1" ref="/root/resData/resForm/remk" navindex="130" imemode="hangul" style="left:110px; top:134px; width:504px; height:18px; text-align:left; "/>
				<input id="inp_acwr_reg_dt" ref="/root/reqData/searchData/acwr_reg_dt" class="req" navindex="10" inputtype="date" caption="승낙서번호(일자)" style="left:110px; top:9px; width:85px; height:18px; "/>
				<caption id="caption27" class="list_cap03" style="left:845px; top:180px; width:76px; height:26px; text-align:center; ">수금방법</caption>
				<input id="input4" ref="/root/resData/resForm/trust_letter_resn" navindex="120" imemode="hangul" style="left:460px; top:109px; width:446px; height:18px; text-align:left; "/>
				<input id="inp_acwr_reg_seq" ref="/root/reqData/searchData/acwr_reg_seq" class="req" navindex="20" format="9999" caption="승낙서번호" style="left:200px; top:9px; width:50px; height:18px; ">
					<script type="javascript" ev:event="DOMFocusOut">
						<![CDATA[
						var acwr_reg_seq = inp_acwr_reg_seq.currentText;					
						model.setValue("/root/reqData/searchData/acwr_reg_seq", lpad(acwr_reg_seq, 4, "0"));
						inp_acwr_reg_seq.refresh();								
						]]>
					</script>
				</input>
				<caption id="caption7" class="list_cap03" style="left:420px; top:228px; width:99px; height:26px; text-align:center; ">거래사유</caption>
				<caption id="caption8" class="list_cap03" style="left:745px; top:180px; width:101px; height:26px; text-align:center; ">계산서발행금액</caption>
				<input id="input26" ref="/root/resData/resForm/deal_resn" navindex="330" imemode="hangul" style="left:525px; top:232px; width:380px; height:18px; text-align:left; "/>
				<caption id="caption15" style="left:15px; top:313px; width:35px; height:20px; font-weight:bold; ">구역</caption>
				<input id="input41" ref="/root/resData/resForm/reg_point_unrcp_pass_dds" disabled="true" navindex="320" format="(-)#,###" style="left:335px; top:232px; width:75px; height:18px; text-align:right; "/>
				<caption id="caption6" class="list_cap03" style="left:5px; top:80px; width:99px; height:26px; text-align:center; ">광고명</caption>
				<caption id="caption17" class="list_cap03" style="left:5px; top:55px; width:99px; height:26px; text-align:center; ">광고주</caption>
				<caption id="caption18" class="list_cap03" style="left:355px; top:80px; width:99px; height:26px; text-align:center; ">업종</caption>
				<caption id="caption19" class="list_cap03" style="left:355px; top:55px; width:99px; height:26px; text-align:center; ">SMS휴대폰</caption>
				<input id="input44" ref="/root/resData/resForm/sms_ptph_no" navindex="80" maxlength="14" style="left:485px; top:60px; width:125px; height:18px; text-align:left; ">
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						check_ptph_no();
						]]>
					</script>
				</input>
				<caption id="caption56" class="list_cap03" style="left:232px; top:253px; width:99px; height:26px; text-align:center; ">삽지요청사항</caption>
				<caption id="caption57" class="list_cap03" style="left:5px; top:253px; width:99px; height:26px; text-align:center; ">IS입고(덩이부수)</caption>
				<caption id="caption59" class="list_cap03" style="left:69px; top:180px; width:93px; height:26px; text-align:center; ">VAT구분</caption>
				<caption id="caption60" class="list_cap03" style="left:275px; top:180px; width:78px; height:26px; text-align:center; ">수량</caption>
				<caption id="caption61" class="list_cap03" style="left:352px; top:180px; width:76px; height:26px; text-align:center; ">단가</caption>
				<caption id="caption30" class="list_cap03" style="left:5px; top:155px; width:99px; height:26px; text-align:center; ">매출/특집항목</caption>
				<caption id="caption63" class="list_cap03" style="left:355px; top:155px; width:99px; height:26px; text-align:center; ">규격</caption>
				<select1 id="combo6" ref="/root/resData/resForm/sale_clsf" class="req" navindex="160" appearance="minimal" style="left:110px; top:159px; width:120px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/curlist2/record">
							<label ref="cdnm"/>
							<value ref="cd"/>
						</itemset>
					</choices>
				</select1>
				<input id="inp_qunt" ref="/root/resData/resForm/qunt" class="req" navindex="240" format="(-)#,###" style="left:275px; top:207px; width:78px; height:20px; text-align:right; ">
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						var qunt = model.getValue("/root/resData/resForm/qunt");
						var uprc = model.getValue("/root/resData/resForm/uprc");
						
						if(qunt != "" && uprc != ""){
							/**010:별도 020:포함**/
							if(model.getValue("/root/resData/resForm/vatclsf") == "010"){
								var sum = eval(qunt) * eval(uprc);		//수주금액 = 수량 * 단가
								var sum2 = (eval(qunt) * eval(uprc))/10	//부가세 = (수량 * 단가) /10
								var sum3 = sum + sum2;				//합계 = 수주금액 + 부가세		
								
								model.setValue("/root/resData/resForm/suply_amt", sum);	//수주금액
								model.setValue("/root/resData/resForm/vat_amt", sum2);		//부가
								model.setValue("/root/resData/resForm/tot_rvord_amt", sum3);	//합계								
							}else{
								var sum = (eval(qunt) * eval(uprc)); 		//합계 = 수량 * 단가
								var sum2 = sum - Math.floor(sum / 11);  	//수주금액 = 합계 - (합계/11)
								var sum3 = sum - sum2; 				//부가세 = 합계 - 수주금액	
								
								model.setValue("/root/resData/resForm/tot_rvord_amt",sum);	//합계
								model.setValue("/root/resData/resForm/suply_amt", sum2);	//수주금액
								model.setValue("/root/resData/resForm/vat_amt", sum3);		//부가세								
							}
						}else{
							model.setValue("/root/resData/resForm/tot_rvord_amt","");
							model.setValue("/root/resData/resForm/suply_amt","");
							model.setValue("/root/resData/resForm/vat_amt" ,"");
						}
						model.refresh();
						]]>
					</script>
				</input>
				<input id="input49" ref="/root/resData/resForm/vat_amt" navindex="280" format="(-)#,###" style="left:541px; top:207px; width:93px; height:20px; text-align:right; "/>
				<bool id="bool3" navindex="340" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/isewh_yn" style="left:105px; top:255px; width:26px; height:20px; background-image:#uncheck; "/>
				<input id="input50" ref="/root/resData/resForm/bnch_qty" navindex="350" format="(-)#,###" style="left:130px; top:257px; width:100px; height:18px; text-align:right; "/>
				<input id="input51" ref="/root/resData/resForm/feed_req_matt" navindex="400" imemode="hangul" style="left:335px; top:257px; width:570px; height:18px; text-align:left; "/>
				<caption id="caption4" class="list_cap03" style="left:355px; top:5px; width:99px; height:26px; text-align:center; ">배포일자</caption>
				<input id="input52" ref="/root/resData/resForm/scat_dt" class="req" navindex="30" inputtype="date" style="left:460px; top:10px; width:100px; height:18px; "/>
				<bool id="bool1" navindex="70" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/sms_send_req_yn" style="left:460px; top:60px; width:26px; height:20px; background-image:#uncheck; "/>
				<input id="inp_advcs_cd" ref="/root/resData/resForm/advcs_cd" class="req" navindex="60" inputtype="button" format="999999" style="left:110px; top:60px; width:70px; height:18px; ">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setAdDlcoInfo");//팝업에서 함수호출명 
						
						window.load("../com/IS_COM_1000.xrw"
						                  ,"mdichild"
						                  , "is_com_1000"
						                  , "width:645px; height:480px; align:center; caption:hidden;"
						                  , "/root/reqData/fwdData"
						                  , "/root/reqData/fwdData");
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						if (inp_advcs_cd.value.length == 6) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/advcs_cd");
							model.setValue("/root/reqData/fwdData/advcs_cd", inp_advcs_cd.value);
							model.send("is_com_1201_s");
									
							if (model.getValue("/root/tempData/record/advcs_cd") != "") {
								inp_advcs_cd_nm.value = model.getValue("/root/tempData/record/advcs_nm");
								
								/**거래처 코드로 업종코드, 업종명 셋팅 시작**/
								model.send("is_com_1201_s");				
								var indt_cd = model.getValue("/root/tempData/record/indt_cd");
								var indt_cd_nm = model.getValue("/root/tempData/record/indt_cd_nm");
								var sms_ptph_no = model.getValue("/root/tempData/record/sms_ptph_no");
							
								if(indt_cd != "" &&  indt_cd_nm != ""){
									model.setValue("/root/resData/resForm/indt_cd", indt_cd); //업종코드
									model.setValue("/root/resData/resForm/indt_cd_nm", indt_cd_nm); //업종명
									
									if(sms_ptph_no != ""){
										model.setValue("/root/resData/resForm/sms_send_req_yn", "Y"); 		//체크박스
									}else{
										model.setValue("/root/resData/resForm/sms_send_req_yn", ""); 		//체크박스
									}
									model.setValue("/root/resData/resForm/sms_ptph_no", sms_ptph_no); 	//sms휴대폰번호 
								}else{
									model.setValue("/root/resData/resForm/indt_cd", ""); //업종코드
									model.setValue("/root/resData/resForm/indt_cd_nm", ""); //업종명
									
									model.setValue("/root/resData/resForm/sms_send_req_yn", ""); 		//체크박스
									model.setValue("/root/resData/resForm/sms_ptph_no", ""); 	//sms휴대폰번호 
								}
								/**거래처 코드로 업종코드, 업종명 셋팅 종료**/								
							}else {
								inp_advcs_cd_nm.value = "";
								inp_advcs_cd.value = "";
								bool1.value = "";
								input44.value = "";
							}
						}else {
							inp_advcs_cd_nm.value = "";
							inp_advcs_cd.value = "";
							bool1.value = "";
							input44.value = "";
						}
						model.refresh();
						]]>
					</script>
				</input>
				<input id="inp_advcs_cd_nm" ref="/root/resData/resForm/advcs_cd_nm" class="req" style="left:185px; top:60px; width:164px; height:18px; "/>
				<input id="inp_indt_cd" ref="/root/resData/resForm/indt_cd" class="req" navindex="100" inputtype="button" format="9999" style="left:460px; top:85px; width:50px; height:18px; ">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						var cd   =  "";
						var cdnm =  "";
											
						var resultRef1 = "/root/resData/resForm/indt_cd";
						var resultRef2 = "root/resData/resForm/indt_cd_nm";
						
						showCommonCodePopup1("13", "53", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
						
						model.refresh();
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						if(inp_indt_cd.value.length == 4 ){
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/job_clsf");
							model.makeNode("/root/reqData/fwdData/cd_clsf");
							model.makeNode("/root/reqData/fwdData/cd");
							model.setValue("/root/reqData/fwdData/job_clsf", "13");
							model.setValue("/root/reqData/fwdData/cd_clsf", "53");
							model.setValue("/root/reqData/fwdData/cd", inp_indt_cd.value);							
							model.removeNodeset("/root/resData/resform2/dataSet/CURLIST1/record"); 
							model.makeNode("/root/resData/resform2/dataSet/CURLIST1/record/cd");
							model.makeNode("/root/resData/resform2/dataSet/CURLIST1/record/cdnm");							
							model.send("fc_co_8000_s");
							if (model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cd").Trim() != "") {
								inp_indt_cd_nm.value = model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cdnm");
							}else{
								inp_indt_cd.value = "";
								inp_indt_cd_nm.value = "";
							}					
						}else {
							inp_indt_cd.value = "";
							inp_indt_cd_nm.value = "";
						}	
						]]>
					</script>
				</input>
				<input id="inp_indt_cd_nm" ref="/root/resData/resForm/indt_cd_nm" class="req" style="left:515px; top:85px; width:95px; height:18px; "/>
				<input id="inp_std_cd" ref="/root/resData/resForm/std_cd" class="req" navindex="180" inputtype="button" format="999" style="left:460px; top:159px; width:57px; height:18px; ">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						var cd   =  "";
						var cdnm =  "";
											
						var resultRef1 = "/root/resData/resForm/std_cd";
						var resultRef2 = "/root/resData/resForm/std_cd_nm";
						
						showCommonCodePopup1("13", "50", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
						
						
						/**단가구분 선택시 표준단가,단가 셋팅 시작**/
						model.makeNode("/root/tempData/std_uprc");
						model.send("is_agr_1032_s");
						var std_uprc = model.getValue("/root/tempData/std_uprc");
						model.setValue("/root/resData/resForm/std_uprc", std_uprc);	//표준단가
						model.setValue("/root/resData/resForm/uprc", std_uprc);		//단가
						/**단가구분 선택시 표준단가,단가 셋팅 종료**/	
						
						model.refresh();
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						if(inp_std_cd.value.length == 3 ){
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/job_clsf");
							model.makeNode("/root/reqData/fwdData/cd_clsf");
							model.makeNode("/root/reqData/fwdData/cd");
							model.setValue("/root/reqData/fwdData/job_clsf", "13");
							model.setValue("/root/reqData/fwdData/cd_clsf", "50");
							model.setValue("/root/reqData/fwdData/cd", inp_std_cd.value);							
							model.removeNodeset("/root/resData/resform2/dataSet/CURLIST1/record"); 
							model.makeNode("/root/resData/resform2/dataSet/CURLIST1/record/cd");
							model.makeNode("/root/resData/resform2/dataSet/CURLIST1/record/cdnm");							
							model.send("fc_co_8000_s");
							if (model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cd").Trim() != "") {
								inp_std_cd_nm.value = model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cdnm");
								
								/**단가구분 선택시 표준단가,단가 셋팅 시작**/
								model.makeNode("/root/tempData/std_uprc");
								model.send("is_agr_1032_s");
								var std_uprc = model.getValue("/root/tempData/std_uprc");
								model.setValue("/root/resData/resForm/std_uprc", std_uprc);	//표준단가
								model.setValue("/root/resData/resForm/uprc", std_uprc);		//단가
								/**단가구분 선택시 표준단가,단가 셋팅 종료**/	
							}else{
								inp_std_cd.value = "";
								inp_std_cd_nm.value = "";
							}					
						}else {
							inp_std_cd.value = "";
							inp_std_cd_nm.value = "";
						}
						model.refresh();
						]]>
					</script>
				</input>
				<input id="inp_std_cd_nm" ref="/root/resData/resForm/std_cd_nm" class="req" style="left:520px; top:159px; width:95px; height:18px; "/>
				<caption id="caption64" class="list_cap03" style="left:5px; top:180px; width:65px; height:26px; text-align:center; ">계산서</caption>
				<caption id="caption65" class="list_cap03" style="left:161px; top:180px; width:55px; height:26px; text-align:center; ">단가구분</caption>
				<input id="input46" ref="/root/resData/resForm/sale_dlco_li_suply_amt" editable="false" format="(-)#,###" style="left:745px; top:207px; width:101px; height:20px; text-align:right; "/>
				<input id="input47" ref="/root/resData/resForm/advt_nm" navindex="90" style="left:110px; top:85px; width:240px; height:18px; "/>
				<select1 id="combo5" ref="/root/resData/resForm/spc_sale_clsf" navindex="170" appearance="minimal" style="left:235px; top:159px; width:115px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/curlist3/record">
							<label ref="cdnm"/>
							<value ref="cd"/>
						</itemset>
					</choices>
				</select1>
				<select1 id="radio2" ref="/root/resData/resForm/prof_docu_clsf" navindex="110" appearance="full" cols="4" rows="1" overflow="visible" style="left:110px; top:110px; width:200px; height:20px; border-style:none; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/curlist4/record">
							<label ref="cdnm"/>
							<value ref="cd"/>
						</itemset>
					</choices>
				</select1>
				<caption id="caption62" class="list_cap03" style="left:5px; top:228px; width:99px; height:26px; text-align:center; ">미수금액</caption>
				<caption id="caption68" class="list_cap03" style="left:232px; top:228px; width:99px; height:26px; text-align:center; ">미수경과일수</caption>
				<select1 id="combo3" ref="/root/resData/resForm/clamt_mthd" class="req" navindex="300" appearance="minimal" style="left:845px; top:207px; width:76px; height:20px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/curlist6/record">
							<label ref="cdnm"/>
							<value ref="cd"/>
						</itemset>
					</choices>
				</select1>
				<caption id="caption25" class="list_cap03" style="left:520px; top:278px; width:106px; height:26px; text-align:center; ">배포수량/잔량</caption>
				<input id="input6" ref="/root/resData/resForm/scat_qty" disabled="true" format="(-)#,###" style="left:630px; top:282px; width:90px; height:18px; text-align:right; ">
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						 
						var qunt = eval(model.getValue("/root/resData/resForm/qunt")); //수량
						var scat_qty = eval(model.getValue("/root/resData/resForm/scat_qty")); //배포수량
						var remain_qty = 0;
						
						remain_qty = qunt - scat_qty;
						
						model.setValue("/root/resData/resForm/remain_qty", remain_qty);
						model.refresh();
						]]>
					</script>
				</input>
				<input id="inp_remain_qty" ref="/root/resData/resForm/remain_qty" disabled="true" format="(-)#,###" style="left:743px; top:282px; width:90px; height:18px; text-align:right; "/>
				<input id="input19" ref="/root/resData/resForm/reg_point_unrcp_amt" disabled="true" navindex="310" format="#,###" style="left:108px; top:233px; width:122px; height:18px; text-align:right; "/>
				<caption id="caption12" class="list_cap03" style="left:620px; top:130px; width:99px; height:26px; text-align:center; ">확정여부</caption>
				<caption id="caption53" class="list_cap03" style="left:214px; top:180px; width:62px; height:26px; text-align:center; ">표준단가</caption>
				<input id="input31" ref="/root/resData/resForm/std_uprc" disabled="true" navindex="230" format="(-)#,###.99" style="left:215px; top:207px; width:61px; height:20px; text-align:right; "/>
				<caption id="caption72" style="left:721px; top:282px; width:15px; height:20px; ">/</caption>
				<input id="inp_dlco_clsf_cd_seq" ref="/root/resData/resForm/dlco_clsf_cd_seq" class="req" navindex="40" inputtype="button" style="left:110px; top:35px; width:85px; height:18px; ">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[				
							model.makeNode("/root/reqData/fwdData/func_nm");
							model.setValue("/root/reqData/fwdData/func_nm", "setDlcoInfo");//팝업에서 함수호출명 
										
							window.load("/xrw/is/com/IS_COM_1100.xrw"
										,"mdichild"
										, "is_com_1100"
										, "align:center; caption:hidden;width:645px; height:480px;"
										, "/root/reqData/fwdData"
										, "/root/reqData/fwdData");
							]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						if (inp_dlco_clsf_cd_seq.value.length == 9) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dlco_clsf_cd_seq");
							model.setValue("/root/reqData/fwdData/dlco_clsf_cd_seq", inp_dlco_clsf_cd_seq.value);
							model.send("is_com_1200_s");
									
							if (model.getValue("/root/tempData/record/dlco_clsf_cd_seq") != "") {
								inp_dlco_nm.value = model.getValue("/root/tempData/record/dlco_nm");
								
								/**거래처 코드로 미수금액, 미수경과일수 셋팅 시작**/
								model.makeNode("/root/tempData/reg_point_unrcp_pass_dds");
								model.makeNode("/root/tempData/reg_point_unrcp_amt");
								model.send("is_agr_1031_s");
								
								var reg_point_unrcp_amt = model.getValue("/root/tempData/reg_point_unrcp_amt");
								var reg_point_unrcp_pass_dds = model.getValue("/root/tempData/reg_point_unrcp_pass_dds");
								
								if(reg_point_unrcp_amt != "" &&  reg_point_unrcp_pass_dds != ""){
									model.setValue("/root/resData/resForm/reg_point_unrcp_amt", reg_point_unrcp_amt); //미수금액 셋팅
									model.setValue("/root/resData/resForm/reg_point_unrcp_pass_dds", reg_point_unrcp_pass_dds); //미수경과일수
								}else{
									model.setValue("/root/resData/resForm/reg_point_unrcp_amt", ""); //미수금액 셋팅
									model.setValue("/root/resData/resForm/reg_point_unrcp_pass_dds", ""); //미수경과일수
								}
								/**거래처 코드로 미수금액, 미수경과일수 셋팅 종료**/
							}else {
								inp_dlco_nm.value = "";
								inp_dlco_clsf_cd_seq.value = "";
							}
						}else {
							inp_dlco_nm.value = "";
							inp_dlco_clsf_cd_seq.value = "";
						}
						model.refresh();			
						]]>
					</script>
				</input>
				<input id="inp_dlco_nm" ref="/root/resData/resForm/dlco_nm" class="req" imemode="hangul" style="left:199px; top:35px; width:150px; height:18px; "/>
				<input id="inp_asnt_dstc_cd" ref="/root/resData/resForm/asnt_dstc_cd" navindex="440" inputtype="button" format="99999" style="left:49px; top:315px; width:65px; height:18px; ">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						var cd   =  "";
						var cdnm =  "";
						var sale_clsf = model.getValue("/root/resData/resForm/sale_clsf");
																
						var resultRef1 = "/root/resData/resForm/asnt_dstc_cd";
						var resultRef2 = "/root/resData/resForm/asnt_dstc_nm";
						
						showCommonCodePopup1("13", "04", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
						
						model.send("is_agr_1030_l");
						
						var q  = 0;
						var exist  = 0;
						var cur_row = 0;
						for(j=1; j<datagrid5.rows;j++){
							var b_dlco_clsf_cd_seq = datagrid5.valueMatrix(j,datagrid5.colRef("b_dlco_clsf_cd_seq"));
							var b_dlco_abrv_nm = datagrid5.valueMatrix(j,datagrid5.colRef("b_dlco_abrv_nm"));
							var b_dlco_nm = datagrid5.valueMatrix(j,datagrid5.colRef("b_dlco_nm"));
							var b_asnt_dstc_cd = datagrid5.valueMatrix(j,datagrid5.colRef("b_asnt_dstc_cd"));
							var b_asnt_dstc_cd_nm = datagrid5.valueMatrix(j,datagrid5.colRef("b_asnt_dstc_cd_nm"));
							var b_send_qty = datagrid5.valueMatrix(j,datagrid5.colRef("b_send_qty"));
							q  = datagrid1.rows;
							exist  = 0;
							for(i=1; i< q;i++){						
								var a_dlco_clsf_cd_seq = datagrid1.valueMatrix(i,datagrid1.colRef("a_dlco_clsf_cd_seq"));
								
								
								if(a_dlco_clsf_cd_seq == b_dlco_clsf_cd_seq){
									exist  = exist + 1;
								}	
							}
							if (exist == 0){
								addRow(datagrid1);
								cur_row  = datagrid1.rows - 1;
								//alert(cur_row);
								datagrid1.valueMatrix(cur_row,datagrid1.colRef("a_asnt_dstc_cd")) = b_asnt_dstc_cd;			//구역코드
								datagrid1.valueMatrix(cur_row,datagrid1.colRef("a_asnt_dstc_cd_nm")) = b_asnt_dstc_cd_nm;	//구역명
								datagrid1.valueMatrix(cur_row,datagrid1.colRef("a_dlco_clsf_cd_seq")) = b_dlco_clsf_cd_seq;	//거래처코드
								datagrid1.valueMatrix(cur_row,datagrid1.colRef("a_dlco_nm")) = b_dlco_abrv_nm;					//거래처명	
								datagrid1.valueMatrix(cur_row,datagrid1.colRef("a_send_qty")) = b_send_qty;					//발송부수 	
								datagrid1.valueMatrix(cur_row,datagrid1.colRef("a_purc_clsf")) =  sale_clsf;	
								datagrid1.addStatus(cur_row, "insert");	
							}
						}						
						model.refresh();
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						if(inp_asnt_dstc_cd.value.length == 5 ){
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/job_clsf");
							model.makeNode("/root/reqData/fwdData/cd_clsf");
							model.makeNode("/root/reqData/fwdData/cd");
							model.setValue("/root/reqData/fwdData/job_clsf", "13");
							model.setValue("/root/reqData/fwdData/cd_clsf", "04");
							model.setValue("/root/reqData/fwdData/cd", inp_asnt_dstc_cd.value);
							model.removeNodeset("/root/resData/resform2/dataSet/CURLIST1/record"); 
							model.makeNode("/root/resData/resform2/dataSet/CURLIST1/record/cd");
							model.makeNode("/root/resData/resform2/dataSet/CURLIST1/record/cdnm");
							model.send("fc_co_8000_s");
							if (model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cd").Trim() != "") {
								inp_asnt_dstc_nm.value = model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cdnm");
								
								
								model.send("is_agr_1030_l");
								
								var q  = 0;
								var exist  = 0;
								var cur_row = 0;
								for(j=1; j<datagrid5.rows;j++){
									var sale_clsf = model.getValue("/root/resData/resForm/sale_clsf");
									var b_dlco_clsf_cd_seq = datagrid5.valueMatrix(j,datagrid5.colRef("b_dlco_clsf_cd_seq"));
									var b_dlco_abrv_nm = datagrid5.valueMatrix(j,datagrid5.colRef("b_dlco_abrv_nm"));
									var b_dlco_nm = datagrid5.valueMatrix(j,datagrid5.colRef("b_dlco_nm"));
									var b_asnt_dstc_cd = datagrid5.valueMatrix(j,datagrid5.colRef("b_asnt_dstc_cd"));
									var b_asnt_dstc_cd_nm = datagrid5.valueMatrix(j,datagrid5.colRef("b_asnt_dstc_cd_nm"));
									var b_send_qty = datagrid5.valueMatrix(j,datagrid5.colRef("b_send_qty"));
									q  = datagrid1.rows;
									exist  = 0;
									for(i=1; i<q; i++){
										var a_dlco_clsf_cd_seq = datagrid1.valueMatrix(i,datagrid1.colRef("a_dlco_clsf_cd_seq"));
										
										if(a_dlco_clsf_cd_seq == b_dlco_clsf_cd_seq){
											exist  = exist + 1;
										}	
									}
									if (exist == 0){
										addRow(datagrid1);
										cur_row  = datagrid1.rows - 1;
										//alert(cur_row);
										datagrid1.valueMatrix(cur_row,datagrid1.colRef("a_asnt_dstc_cd")) = b_asnt_dstc_cd;			//구역코드
										datagrid1.valueMatrix(cur_row,datagrid1.colRef("a_asnt_dstc_cd_nm")) = b_asnt_dstc_cd_nm;	//구역명
										datagrid1.valueMatrix(cur_row,datagrid1.colRef("a_dlco_clsf_cd_seq")) = b_dlco_clsf_cd_seq;	//거래처코드
										datagrid1.valueMatrix(cur_row,datagrid1.colRef("a_dlco_nm")) = b_dlco_nm;					//거래처명	
										datagrid1.valueMatrix(cur_row,datagrid1.colRef("a_purc_clsf")) =  sale_clsf;	
										datagrid1.valueMatrix(cur_row,datagrid1.colRef("a_send_qty")) =  b_send_qty;	
										datagrid1.addStatus(cur_row, "insert");	
									}
								}						
								
							}else{
								inp_asnt_dstc_cd.value = "";
								inp_asnt_dstc_nm.value = "";
							}					
						}else {
							inp_asnt_dstc_cd.value = "";
							inp_asnt_dstc_nm.value = "";
						}				
						]]>
					</script>
				</input>
				<input id="inp_asnt_dstc_nm" ref="/root/resData/resForm/asnt_dstc_nm" imemode="hangul" style="left:118px; top:315px; width:90px; height:18px; text-align:left; "/>
				<input id="inp_chrg_pers" ref="/root/resData/resForm/chrg_pers" disabled="true" navindex="430" inputtype="button" format="999999" style="left:365px; top:282px; width:67px; height:18px; ">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setMenu_srch");//팝업에서 함수호출명 
						
						
						window.load("/xrw/hd/com/HD_COM_1000.xrw"
									,"mdichild"
									, "hd_com_1000"
									, "align:center; caption:hidden;width:460px; height:400px;"
									, "/root/reqData/fwdData"
									, "/root/reqData/fwdData");				
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						if (inp_chrg_pers.value.length == 6) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/emp_no");
							model.setValue("/root/reqData/fwdData/emp_no", inp_chrg_pers.value);
							model.send("hd_com_1002");
							
							if (model.getValue("/root/tempData/record/emp_no") != "") {
								inp_chrg_pers_nm.value = model.getValue("/root/tempData/record/nm_korn");
								
								/**담당자 선택시 팀,파트 셋팅 시작**/
								model.makeNode("/root/reqData/fwdData/chrg_pers");
								model.setValue("/root/reqData/fwdData/chrg_pers", inp_chrg_pers.value);
								
								model.send("is_com_1202_s");				
								var dept_cd = model.getValue("/root/tempData/record/dept_cd");
								var sub_dept_cd = model.getValue("/root/tempData/record/sub_dept_cd");
								
								
								if(dept_cd != "" || sub_dept_cd != ""){
									model.setValue("/root/resData/resForm/dept_cd", dept_cd); //팀
									model.setValue("/root/resData/resForm/sub_dept_cd", sub_dept_cd); //파트
								}else{
									model.setValue("/root/resData/resForm/dept_cd", ""); //팀
									model.setValue("/root/resData/resForm/sub_dept_cd", ""); //파트
								}				
								/**담당자 선택시 팀,파트 셋팅 종료**/	
								
							}else {
								inp_chrg_pers.value = "";
								inp_chrg_pers_nm.value = "";
							}
						}else {
							inp_chrg_pers.value = "";
							inp_chrg_pers_nm.value = "";
						}
						model.refresh();				
						]]>
					</script>
				</input>
				<input id="inp_chrg_pers_nm" ref="/root/resData/resForm/chrg_pers_nm" disabled="true" imemode="hangul" style="left:437px; top:282px; width:70px; height:18px; "/>
				<select1 id="part_combo" ref="/root/resData/resForm/sub_dept_cd" disabled="false" navindex="420" appearance="minimal" style="left:230px; top:282px; width:120px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/partlist_temp/record">
							<label ref="dept_nm"/>
							<value ref="dept_cd"/>
						</itemset>
					</choices>
				</select1>
				<select1 id="team_combo" ref="/root/resData/resForm/dept_cd" disabled="false" navindex="410" appearance="minimal" style="left:108px; top:282px; width:120px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/teamlist/record">
							<label ref="dept_nm"/>
							<value ref="dept_cd"/>
						</itemset>
					</choices>
				</select1>
				<caption id="caption73" style="left:220px; top:313px; width:70px; height:20px; font-weight:bold; ">부수지정</caption>
				<caption id="caption75" style="left:359px; top:313px; width:15px; height:20px; font-weight:bold; ">%</caption>
				<caption id="caption76" style="left:440px; top:313px; width:65px; height:20px; font-weight:bold; ">매입단가</caption>
				<input id="input2" ref="/root/resData/resForm/xx_qty" navindex="450" format="#,###" style="left:280px; top:315px; width:75px; height:18px; text-align:right; "/>
				<input id="input3" ref="/root/resData/resForm/xx_uprc" navindex="460" format="#,###.99" style="left:500px; top:315px; width:90px; height:18px; text-align:right; "/>
				<button id="button8" class="btn02" crud="R" style="left:379px; top:312px; width:52px; height:21px; ">
					<caption>부수적용</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						var xx_t_qty = model.getValue("/root/resData/resForm/xx_qty");
 
						if(xx_t_qty =="" ){
								commAlert("값을 입력 후 부수적용하세요. ");
								return;
						}
						var xx_qty = eval(model.getValue("/root/resData/resForm/xx_qty")) / 100;			
						
						
						for(i=1; i<datagrid1.rows; i++){	
							var checked = datagrid1.valueMatrix(i, datagrid1.colRef("checked"));
							var a_send_qty = datagrid1.valueMatrix(i, datagrid1.colRef("a_send_qty"));
							var calc_a_qunt = 0;
							var a_send_rate = 0;
							if(checked == "Y"){
								
								var num1 = Math.floor((eval(a_send_qty) * xx_qty) / 1000);								
								//var num2 = (eval(a_send_qty) * xx_qty) % 1000;
								var num2 = Math.floor((eval(a_send_qty) * xx_qty) % 1000);
								
								
								//alert(eval(a_send_qty)+"   *    "+xx_qty);
								
								


								if(num2 >= 0 && num2 < 250){
									//alert("250보다 작네"+num1+"000");//000									
									calc_a_qunt = num1 * 1000 ;
								}else if(num2 >= 250 && num2 < 750){
									//alert("750보다 작네"+num1+"500");//500									
									calc_a_qunt = num1 * 1000 + 500;
								}else{
									//alert("750보다 크다"+num1+"0000");//0000									
									calc_a_qunt = num1 * 1000 + 1000;
								}

								datagrid1.valueMatrix(i, datagrid1.colRef("a_qunt")) = eval(calc_a_qunt);
								
								/**배정율**/
								var a_qunt = calc_a_qunt;	/**매입수량**/
								var a_send_qty = eval(datagrid1.valueMatrix(i, datagrid1.colRef("a_send_qty")));	/**발송부수**/
								
								if(a_send_qty==0){
									a_send_rate = 0;
								}else{
									a_send_rate = Math.round((a_qunt/a_send_qty)*100*100)/100;
								}
								datagrid1.valueMatrix(i, datagrid1.colRef("a_send_rate")) = a_send_rate
								/**매입금액**/
								var a_purc_amt = 0;
								var a_uprc = Number(datagrid1.valueMatrix(i, datagrid1.colRef("a_uprc")));	/**매입단가**/
															
								a_purc_amt	=	a_qunt * a_uprc;
								
								datagrid1.valueMatrix(i, datagrid1.colRef("a_purc_amt")) = a_purc_amt;
								
								}
						}
						datagrid1.refresh();
						calc_baepo_sum();
						]]>
					</script>
				</button>
				<button id="button9" class="btn02" crud="R" style="left:592px; top:315px; width:52px; height:21px; ">
					<caption>단가적용</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						var xx_uprc = 0;
						if(model.getValue("/root/resData/resForm/xx_uprc")==""){
							xx_uprc = 0;							
						}else{
						    xx_uprc = eval(model.getValue("/root/resData/resForm/xx_uprc"));	
						}
						
						for(i=1; i<datagrid1.rows; i++){	
							var checked = datagrid1.valueMatrix(i, datagrid1.colRef("checked"));
							if(checked == "Y"){
								datagrid1.valueMatrix(i, datagrid1.colRef("a_uprc")) = xx_uprc;
								
								datagrid1.valueMatrix(i, datagrid1.colRef("a_purc_amt")) = datagrid1.valueMatrix(i, datagrid1.colRef("a_qunt")) * xx_uprc;
							}
						}
						]]>
					</script>
				</button>
				<caption id="caption77" class="list_cap03" style="left:620px; top:155px; width:99px; height:26px; text-align:center; ">수금예정일자</caption>
				<input id="input5" ref="/root/resData/resForm/clamt_plan_dt" class="req" navindex="190" inputtype="date" style="left:725px; top:159px; width:100px; height:18px; "/>
				<button id="button12" class="btn02" crud="C" style="left:650px; top:315px; width:50px; height:21px; ">
					<caption>엑셀</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
				var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
				if(filename!=""){
					datagrid1.saveExcel(filename, "sheetname: 지국별배포내역");
				}						
				]]>
					</script>
				</button>
				<button id="button13" class="btn02" crud="C" style="left:706px; top:315px; width:50px; height:21px; ">
					<caption>인쇄</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						goReport("P");
						]]>
					</script>
				</button>
			</case>
			<case id="case2">
				<caption id="caption52" class="list_cap02" style="left:5px; top:32px; width:915px; height:28px; "/>
				<caption id="caption51" class="list_cap02" style="left:5px; top:5px; width:915px; height:28px; "/>
				<datagrid id="datagrid3" nodeset="/root/resData2/resForm2/gridData1/record" caption="배포일자^거래처^광고주^광고명^업종^수주수량^수주단가^공급가액^부가세액^총수주금액^VAT^규격^매출구분^특집매출구분^수금방법^확정^담당자^담당부서^acwr_reg_dt^acwr_reg_seq^은행^계좌번호^예금주" colsep="^" colwidth="70, 166, 166, 117, 135, 72, 55, 78, 65, 79, 37, 50, 60, 80, 60, 44, 49, 88, 100, 100" explorerbar="sort" extendlastcol="scroll" frozencols="3" mergecellsfixedcols="byrowrec" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:5px; top:100px; width:915px; height:525px; ">
					<col ref="scat_dt" format="yyyy-mm-dd"/>
					<col ref="dlco_nm" style="text-align:left; "/>
					<col ref="advcs_cd_nm" style="text-align:left; "/>
					<col ref="advt_nm" style="text-align:left; "/>
					<col ref="indt_cd_nm" style="text-align:left; "/>
					<col ref="qunt" format="(-)#,###" style="text-align:right; "/>
					<col ref="uprc" format="(-)#,###.99" style="text-align:right; "/>
					<col ref="suply_amt" format="(-)#,###" style="text-align:right; "/>
					<col ref="vat_amt" format="(-)#,###" style="text-align:right; "/>
					<col ref="tot_rvord_amt" format="(-)#,###" style="text-align:right; "/>
					<col checkvalue="Y,N" disabled="true" ref="vatclsf_nm" type="checkbox"/>
					<col ref="std_cd_nm" style="text-align:left; "/>
					<col ref="sale_clsf_nm" style="text-align:left; "/>
					<col ref="spc_sale_clsf_nm" style="text-align:left; "/>
					<col ref="clamt_mthd_nm" style="text-align:left; "/>
					<col ref="fix_yn"/>
					<col ref="chrg_pers" style="text-align:left; "/>
					<col ref="dept_cd_nm" style="text-align:left; "/>
					<col ref="acwr_reg_dt" visibility="hidden"/>
					<col ref="acwr_reg_seq" visibility="hidden"/>
					<script type="javascript" ev:event="ondblclick">
						<![CDATA[
						var rownum = datagrid3.row;
					
						/* 타이틀을 클릭한 경우 그냥 리턴 */
						if ( rownum <= 0 ) {
							return;
						}
						
						if (!datagrid3.isCell(event.target)) return;
						
						var acwr_reg_dt = datagrid3.valueMatrix(datagrid3.row,datagrid3.colRef("acwr_reg_dt"));
						var acwr_reg_seq = datagrid3.valueMatrix(datagrid3.row,datagrid3.colRef("acwr_reg_seq"));
						
						if(acwr_reg_dt == "" && acwr_reg_seq == ""){
							return;
						}
						
						model.setValue("/root/reqData/searchData/acwr_reg_dt", acwr_reg_dt);
						model.setValue("/root/reqData/searchData/acwr_reg_seq", acwr_reg_seq);
						
						model.toggle("case1");
						button11.selected="true" ;	
						model.send("is_agr_1010_s");
						
						model.refresh();
						]]>
					</script>
				</datagrid>
				<caption id="caption16" class="list_cap02" style="left:5px; top:59px; width:915px; height:28px; "/>
				<caption id="caption50" class="list_cap01" style="left:698px; top:59px; width:70px; height:28px; ">업종</caption>
				<input id="inp_chrg_pers2" ref="/root/reqData2/searchData2/chrg_pers" inputtype="button" format="999999" style="left:772px; top:10px; width:60px; height:18px; ">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setMenu_srch2");//팝업에서 함수호출명 
						
						
						window.load("/xrw/hd/com/HD_COM_1000.xrw"
									,"mdichild"
									, "hd_com_1000"
									, "align:center; caption:hidden;width:460px; height:400px;"
									, "/root/reqData/fwdData"
									, "/root/reqData/fwdData");	
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						if (inp_chrg_pers2.value.length == 6) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/emp_no");
							model.setValue("/root/reqData/fwdData/emp_no", inp_chrg_pers2.value);
							model.send("hd_com_1002");
							
							if (model.getValue("/root/tempData/record/emp_no") != "") {
								inp_chrg_pers_nm2.value = model.getValue("/root/tempData/record/nm_korn");
							}else {
								inp_chrg_pers2.value = "";
								inp_chrg_pers_nm2.value = "";
							}
						}else {
							inp_chrg_pers2.value = "";
							inp_chrg_pers_nm2.value = "";
						}						
						]]>
					</script>
				</input>
				<input id="inp_chrg_pers_nm2" ref="/root/reqData2/searchData2/chrg_pers_nm" style="left:839px; top:10px; width:71px; height:18px; text-align:left; "/>
				<caption id="caption40" class="list_cap01" style="left:5px; top:32px; width:70px; height:28px; ">거래처</caption>
				<caption id="caption41" class="list_cap01" style="left:310px; top:32px; width:70px; height:28px; ">매출구분</caption>
				<caption id="caption42" style="left:168px; top:12px; width:15px; height:17px; ">~</caption>
				<input id="inp_indt_cd2" ref="/root/reqData2/searchData2/indt_cd" inputtype="button" format="9999" style="left:772px; top:63px; width:50px; height:18px; ">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						var cd   =  "";
						var cdnm =  "";
											
						var resultRef1 = "/root/reqData2/searchData2/indt_cd";
						var resultRef2 = "/root/reqData2/searchData2/indt_cd_nm";
						
						showCommonCodePopup1("13", "53", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
						
						model.refresh();					
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						if(inp_indt_cd2.value.length == 4 ){
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/job_clsf");
							model.makeNode("/root/reqData/fwdData/cd_clsf");
							model.makeNode("/root/reqData/fwdData/cd");
							model.setValue("/root/reqData/fwdData/job_clsf", "13");
							model.setValue("/root/reqData/fwdData/cd_clsf", "53");
							model.setValue("/root/reqData/fwdData/cd", inp_indt_cd2.value);							
							model.removeNodeset("/root/resData/resform2/dataSet/CURLIST1/record"); 
							model.makeNode("/root/resData/resform2/dataSet/CURLIST1/record/cd");
							model.makeNode("/root/resData/resform2/dataSet/CURLIST1/record/cdnm");							
							model.send("fc_co_8000_s");
							if (model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cd").Trim() != "") {
								inp_indt_cd_nm2.value = model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cdnm");
							}else{
								inp_indt_cd2.value = "";
								inp_indt_cd_nm2.value = "";
							}					
						}else {
							inp_indt_cd2.value = "";
							inp_indt_cd_nm2.value = "";
						}							
						]]>
					</script>
				</input>
				<input id="inp_indt_cd_nm2" ref="/root/reqData2/searchData2/indt_cd_nm" style="left:828px; top:63px; width:81px; height:18px; text-align:left; "/>
				<caption id="caption43" class="list_cap01" style="left:510px; top:32px; width:70px; height:28px; ">특수매출</caption>
				<caption id="caption44" class="list_cap01" style="left:698px; top:5px; width:70px; height:28px; ">담당자</caption>
				<caption id="caption45" class="list_cap01" style="left:5px; top:5px; width:70px; height:28px; ">배포일자</caption>
				<caption id="caption24" class="list_cap01" style="left:698px; top:32px; width:70px; height:28px; ">확정여부</caption>
				<caption id="caption46" class="list_cap01" style="left:310px; top:5px; width:70px; height:28px; ">팀</caption>
				<caption id="caption47" class="list_cap01" style="left:510px; top:59px; width:70px; height:28px; ">규격</caption>
				<input id="inp_scat_dt_to" ref="/root/reqData2/searchData2/scat_dt_to" inputtype="date" format="yyyy-mm-dd" style="left:184px; top:11px; width:85px; height:18px; "/>
				<caption id="caption37" class="list_cap01" style="left:5px; top:59px; width:70px; height:28px; ">광고주</caption>
				<select1 id="combo10" ref="/root/reqData2/searchData2/sale_clsf" appearance="minimal" style="left:384px; top:37px; width:120px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/curlist12/record">
							<label ref="cdnm"/>
							<value ref="cd"/>
						</itemset>
					</choices>
				</select1>
				<input id="inp_scat_dt_fr" ref="/root/reqData2/searchData2/scat_dt_fr" inputtype="date" format="yyyy-mm-dd" style="left:79px; top:11px; width:85px; height:18px; "/>
				<input id="input39" ref="/root/reqData2/searchData2/advt_nm" style="left:384px; top:64px; width:120px; height:18px; text-align:left; "/>
				<input id="inp_advcs_cd2" ref="/root/reqData2/searchData2/advcs_cd" inputtype="button" style="left:79px; top:64px; width:80px; height:18px; ">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setAdDlcoInfo2");//팝업에서 함수호출명 
						
						window.load("../com/IS_COM_1000.xrw"
						                  ,"mdichild"
						                  , "is_com_1000"
						                  , "width:645px; height:480px; align:center; caption:hidden;"
						                  , "/root/reqData/fwdData"
						                  , "/root/reqData/fwdData");
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						if (inp_advcs_cd2.value.length == 6) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/advcs_cd");
							model.setValue("/root/reqData/fwdData/advcs_cd", inp_advcs_cd2.value);
							model.send("is_com_1201_s");
									
							if (model.getValue("/root/tempData/record/advcs_cd") != "") {
								inp_advcs_cd_nm2.value = model.getValue("/root/tempData/record/advcs_nm");
							}else {
								inp_advcs_cd_nm2.value = "";
								inp_advcs_cd2.value = "";
							}
						}else {
							inp_advcs_cd_nm2.value = "";
							inp_advcs_cd2.value = "";
						}
						model.refresh();
						]]>
					</script>
				</input>
				<input id="inp_advcs_cd_nm2" ref="/root/reqData2/searchData2/advcs_cd_nm" style="left:164px; top:64px; width:142px; height:18px; "/>
				<select1 id="combo11" ref="/root/reqData2/searchData2/spc_sale_clsf" appearance="minimal" style="left:584px; top:34px; width:110px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/curlist13/record">
							<label ref="cdnm"/>
							<value ref="cd"/>
						</itemset>
					</choices>
				</select1>
				<caption id="caption29" class="list_cap01" style="left:510px; top:5px; width:70px; height:28px; ">파트</caption>
				<caption id="caption39" class="list_cap01" style="left:310px; top:59px; width:70px; height:28px; ">광고명</caption>
				<input id="inp_dlco_clsf_cd_seq2" ref="/root/reqData2/searchData2/dlco_clsf_cd_seq" inputtype="button" maxlength="9" style="left:79px; top:37px; width:85px; height:18px; ">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDlcoInfo2");//팝업에서 함수호출명 
									
						window.load("/xrw/is/com/IS_COM_1100.xrw"
									,"mdichild"
									, "is_com_1100"
									, "align:center; caption:hidden;width:645px; height:480px;"
									, "/root/reqData/fwdData"
									, "/root/reqData/fwdData");
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						if (inp_dlco_clsf_cd_seq2.value.length == 9) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dlco_clsf_cd_seq");
							model.setValue("/root/reqData/fwdData/dlco_clsf_cd_seq", inp_dlco_clsf_cd_seq2.value);
							model.send("is_com_1200_s");
									
							if (model.getValue("/root/tempData/record/dlco_clsf_cd_seq") != "") {
								inp_dlco_clsf_cd_seq_nm2.value = model.getValue("/root/tempData/record/dlco_nm");
							}else {
								inp_dlco_clsf_cd_seq2.value = "";
								inp_dlco_clsf_cd_seq_nm2.value = "";
							}
						}else {
							inp_dlco_clsf_cd_seq2.value = "";
							inp_dlco_clsf_cd_seq_nm2.value = "";
						}							
						]]>
					</script>
				</input>
				<input id="inp_dlco_clsf_cd_seq_nm2" ref="/root/reqData2/searchData2/dlco_clsf_cd_seq_nm" style="left:169px; top:37px; width:137px; height:18px; "/>
				<select1 id="combo12" ref="/root/reqData2/searchData2/rvord_type" appearance="minimal" style="left:772px; top:35px; width:93px; height:18px; ">
					<choices>
						<item>
							<label/>
							<value/>
						</item>
						<item>
							<label>Y</label>
							<value>Y</value>
						</item>
						<item>
							<label>N</label>
							<value>N</value>
						</item>
					</choices>
				</select1>
				<select1 id="team_combo2" ref="/root/reqData2/searchData2/dept_cd" appearance="minimal" style="left:384px; top:10px; width:120px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/teamlist2/record">
							<label ref="dept_nm"/>
							<value ref="dept_cd"/>
						</itemset>
					</choices>
				</select1>
				<input id="inp_std_cd2" ref="/root/reqData2/searchData2/std_cd" inputtype="button" format="999" style="left:585px; top:64px; width:50px; height:18px; ">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						var cd   =  "";
						var cdnm =  "";
											
						var resultRef1 = "/root/reqData2/searchData2/std_cd";
						var resultRef2 = "/root/reqData2/searchData2/std_cd_nm";
						
						showCommonCodePopup1("13", "50", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
						
						model.refresh();
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						if(inp_std_cd2.value.length == 3 ){
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/job_clsf");
							model.makeNode("/root/reqData/fwdData/cd_clsf");
							model.makeNode("/root/reqData/fwdData/cd");
							model.setValue("/root/reqData/fwdData/job_clsf", "13");
							model.setValue("/root/reqData/fwdData/cd_clsf", "50");
							model.setValue("/root/reqData/fwdData/cd", inp_std_cd2.value);							
							model.removeNodeset("/root/resData/resform2/dataSet/CURLIST1/record"); 
							model.makeNode("/root/resData/resform2/dataSet/CURLIST1/record/cd");
							model.makeNode("/root/resData/resform2/dataSet/CURLIST1/record/cdnm");							
							model.send("fc_co_8000_s");
							if (model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cd").Trim() != "") {
								inp_std_cd_nm2.value = model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cdnm");
							}else{
								inp_std_cd2.value = "";
								inp_std_cd_nm2.value = "";
							}					
						}else {
							inp_std_cd2.value = "";
							inp_std_cd_nm2.value = "";
						}	
						]]>
					</script>
				</input>
				<input id="inp_std_cd_nm2" ref="/root/reqData2/searchData2/std_cd_nm" style="left:637px; top:64px; width:56px; height:18px; text-align:left; "/>
				<select1 id="part_combo2" ref="/root/reqData2/searchData2/sub_dept_cd" appearance="minimal" style="left:584px; top:10px; width:110px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/partlist2/record">
							<label ref="dept_nm"/>
							<value ref="dept_cd"/>
						</itemset>
					</choices>
				</select1>
			</case>
		</switch>
		<button id="button7" class="btn02" crud="R" style="left:546px; top:40px; width:52px; height:18px; ">
			<caption>복사입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var acwr_reg_dt = model.getValue("/root/resData/resForm/acwr_reg_dt");		/**승낙서일자**/
				var acwr_reg_seq = model.getValue("/root/resData/resForm/acwr_reg_seq");	/**승낙서순번**/
				
				var ss_emp_no = getProperty("ss_emp_no");
				var ss_emp_nm = getProperty("ss_emp_nm");
				
				if(acwr_reg_dt == "" && acwr_reg_seq == ""){
					alert("조회후 복사가능합니다.");
					return;
				}else{
					model.setValue("/root/reqData/searchData/acwr_reg_dt","");	/**승낙서 일자 초기화**/
					model.setValue("/root/reqData/searchData/acwr_reg_seq","");	/**승낙서 순번 초기화**/
					
					model.setValue("/root/resData/resForm/chrg_pers", ss_emp_no);
					model.setValue("/root/resData/resForm/chrg_pers_nm", ss_emp_nm);
					
					model.setValue("/root/resData/resForm/flag", "I");	/**모드 변경(I)**/
					
					/**매입정보 데이터 그리드 모드변경(I)**/
					for(i=1; i<datagrid1.rows;i++){
						datagrid1.addStatus(i, "insert");	
						
						/**발송여부는 초기화**/							
						datagrid1.valueMatrix(i, datagrid1.colRef("a_send_yn")) = "N";
						/**선택 초기화**/
						datagrid1.valueMatrix(i, datagrid1.colRef("checked")) = "N";						
					}
					
					/**결재정보 데이터그리드 리셋**/	
					for(var i=datagrid2.rows; i>1; i--){ 
						model.destroy("/root/resData/datagrid2/record["+i+"]");
						datagrid2.removeRow(false);						
						datagrid2.addStatus(datagrid2.row, "");  //상태 변경
					}
					setMenu_srch(inp_chrg_pers.value, inp_chrg_pers_nm.value);
					
					model.refresh();
				}	
				]]>
			</script>
		</button>
		<button id="button5" class="btn02" crud="R" style="left:770px; top:40px; width:52px; height:18px; ">
			<caption>승인처리</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var acwr_reg_dt = model.getValue("/root/resData/resForm/acwr_reg_dt");		/**승낙서일자**/
				var acwr_reg_seq = model.getValue("/root/resData/resForm/acwr_reg_seq");	/**승낙서순번**/
				
				if(acwr_reg_dt == "" && acwr_reg_seq == ""){
					alert("조회후 승인처기가 가능합니다.");
					return;
				}else{
					model.setValue("/root/resData/resForm/flag", "A");	/**모드 변경(결재: A)**/
										
					model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");		
					model.setValue("/root/reqData/multiUpdateData1", datagrid1.getUpdateData());			
						
					model.send("is_agr_1015_a");
							
					if( submit_completed() ){
						model.setValue("/root/reqData/searchData/acwr_reg_dt", model.getValue("/root/msgData/acwr_reg_dt"));
						model.setValue("/root/reqData/searchData/acwr_reg_seq", model.getValue("/root/msgData/acwr_reg_seq"));
						
						model.send("is_agr_1010_s");
					}
					model.refresh();
				}		
				]]>
			</script>
		</button>
		<button id="button4" class="btn02" crud="R" style="left:826px; top:40px; width:52px; height:18px; ">
			<caption>승인취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var acwr_reg_dt = model.getValue("/root/resData/resForm/acwr_reg_dt");		/**승낙서일자**/
				var acwr_reg_seq = model.getValue("/root/resData/resForm/acwr_reg_seq");	/**승낙서순번**/
				
				if(acwr_reg_dt == "" && acwr_reg_seq == ""){
					alert("조회후 승인취소가 가능합니다.");
					return;
				}else{
					model.setValue("/root/resData/resForm/flag", "C");	/**모드 변경(결재취소: C)**/
										
					model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");		
					model.setValue("/root/reqData/multiUpdateData1", datagrid1.getUpdateData());			
						
					model.send("is_agr_1015_a");
							
					if( submit_completed() ){
						model.setValue("/root/reqData/searchData/acwr_reg_dt", model.getValue("/root/msgData/acwr_reg_dt"));
						model.setValue("/root/reqData/searchData/acwr_reg_seq", model.getValue("/root/msgData/acwr_reg_seq"));
						
						model.send("is_agr_1010_s");
					}
					model.refresh();
				}
				]]>
			</script>
		</button>
		<button id="button6" class="tab06" group="tab" crud="R" style="left:115px; top:60px; width:105px; height:23px; ">
			<caption>현황</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case2");				
				]]>
			</script>
		</button>
		<button id="button11" class="tab06" group="tab" selected="true" crud="R" style="left:10px; top:60px; width:105px; height:23px; ">
			<caption>등록</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case1");					
				]]>
			</script>
		</button>
		<button id="button10" class="btn05" crud="R" style="left:355px; top:40px; width:110px; height:21px; ">
			<caption>제작의뢰서등록</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				
				
				var acwr_reg_dt = model.getValue("/root/resData/resForm/acwr_reg_dt");
				var acwr_reg_seq = model.getValue("/root/resData/resForm/acwr_reg_seq");
				
				if( acwr_reg_dt == "" && acwr_reg_seq == ""){
					return;	
				}
				
				model.property(KEY_ACWR_REG_DT)  = acwr_reg_dt;
				model.property(KEY_ACWR_REG_SEQ)  = acwr_reg_seq;
				
				viewer("mainFrame").window.javaScript.onLoadPage2("IS_AGR_2700");
				
				
				
				
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
