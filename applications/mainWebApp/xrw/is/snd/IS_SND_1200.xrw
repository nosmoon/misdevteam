<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet_ad.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>전단발송처리</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<is_snd_1200_m>
								<dataSet>
									<CURLIST1>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURLIST1>
								</dataSet>
							</is_snd_1200_m>
							<is_snd_1200_m>
								<dataSet>
									<CURLIST2>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURLIST2>
								</dataSet>
							</is_snd_1200_m>
							<is_snd_1200_m>
								<dataSet>
									<CURLIST3>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURLIST3>
								</dataSet>
							</is_snd_1200_m>
						</comboSet>
						<pageInfo/>
					</initData>
					<reqData>
						<fwdData/>
						<searchData>
							<scat_dt_fr/>
							<scat_dt_to/>
							<wh_cd/>
						</searchData>
						<reqForm>
							<wh_cd2/>
							<send_dt/>
							<send_seq/>
							<sendclsf/>
							<send_atic_no/>
							<send_atic_nm/>
							<cntc_plac/>
							<send_fee/>
							<start_tm/>
							<end_tm/>
							<serv_ref/>
							<flag/>
						</reqForm>
						<multiUpdateData1/>
						<multiUpdateData2/>
						<multiUpdateData3/>
						<multiUpdateData4/>
						<multiUpdateData5/>
					</reqData>
					<resData>
						<resForm>
							<wh_cd2/>
							<send_dt/>
							<send_seq/>
							<sendclsf/>
							<send_atic_no/>
							<send_atic_nm/>
							<cntc_plac/>
							<send_fee/>
							<start_tm/>
							<end_tm/>
							<serv_ref/>
							<flag/>
						</resForm>
						<gridData1>
							<record>
								<cd/>
								<cdnm/>
								<cd_abrv_nm/>
								<cdnm_cd/>
								<cdabrvnm_cd/>
							</record>
						</gridData1>
						<gridData2>
							<record>
								<checked/>
								<asnt_dstc_cd_nm/>
								<cmpy_cd_nm/>
								<cmpy_cd/>
								<asnt_dstc_cd/>
							</record>
						</gridData2>
						<gridData3>
							<record>
								<checked/>
								<advt_nm/>
								<advcs_cd_nm/>
								<acwr_reg_seq/>
								<acwr_reg_dt_seq/>
								<std_cd_nm/>
								<bnch_qty/>
								<cmpy_cd_nm/>
								<cmpy_cd/>
								<advcs_cd/>
								<std_cd/>
								<acwr_reg_dt/>
								<scat_dt/>
							</record>
						</gridData3>
						<gridData4>
							<record>
								<checked/>
								<purc_dlco_no/>
								<asnt_dstc_cd_nm/>
								<purc_dlco_nm/>
								<cmpy_cd_nm/>
								<cmpy_cd/>
								<asnt_dstc_cd/>
							</record>
						</gridData4>
						<gridData5>
							<record>
								<send_cmpy_cd/>
								<advcs_cd/>
								<advcs_cd_nm/>
								<advt_nm/>
								<std_cd/>
								<std_cd_nm/>
								<scat_dt/>
								<bnch_qty/>
								<qunt/>
								<bnch_qunt/>
								<asnt_dstc_cd/>
								<asnt_dstc_cd_nm/>
								<purc_dlco_no/>
								<purc_dlco_nm/>
								<dstc_seqo/>
								<cmpy_cd_nm/>
								<dept_cd/>
								<sub_dept_cd/>
								<chrg_pers/>
								<chrg_pers_nm/>
								<acwr_reg_dt/>
								<acwr_reg_seq/>
								<purc_reg_dt/>
								<purc_reg_seq/>
								<group_cnt/>
								<group_order/>
								<wh_cd2/>
								<send_dt/>
								<send_seq/>
								<send_atic_no/>
								<send_atic_nm/>
								<sendclsf/>
								<serv_ref/>
								<cntc_plac/>
								<send_fee/>
								<start_tm/>
								<end_tm/>
								<remk/>
								<acwr_reg_seq1/>
							</record>
						</gridData5>
						<gridData6>
							<record>
								<asnt_dstc_cd_nm/>
								<scat_dt/>
								<advcs_cd_nm/>
								<bnch_qunt/>
								<std_cd_nm/>
								<qunt/>
								<acwr_reg_dt_seq/>
								<bnch_qty/>
								<cmpy_cd_nm/>
							</record>
						</gridData6>
					</resData>
					<tempData>
						<keyData/>
					</tempData>
					<msgData/>
				</root>
			</instance>
			<submission id="is_snd_1200_m" action="/is/snd/1200" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/comboSet/is_snd_1200_m/dataSet"/>
			<submission id="is_snd_1210_l" action="/is/snd/1210" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/resData/gridData1/record"/>
			<submission id="is_snd_1220_l" action="/is/snd/1220" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData2/record"/>
			<submission id="is_snd_1230_l" action="/is/snd/1230" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/resData/gridData3/record"/>
			<submission id="is_snd_1240_l" action="/is/snd/1240" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/resData/gridData4/record"/>
			<submission id="is_snd_1250_l" action="/is/snd/1250" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/resData/gridData5/record"/>
			<submission id="is_snd_1255_l" action="/is/snd/1255" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/resData/gridData6/record"/>
			<submission id="is_snd_1260_a" action="/is/snd/1260" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/msgData"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				model.setValue("/root/reqData/searchData/scat_dt_fr", getCurrentDate().substr(0,6)+"01");	
				model.setValue("/root/reqData/searchData/scat_dt_to", getCurrentDate());	
				
				
				model.send("is_snd_1200_m");	
				//makeComboGubun("A","/root/initData/comboSet/is_snd_1200_m/dataSet/CURLIST1","record","cdnm", "cd"); 
				model.send("is_snd_1210_l");	
				
				datagrid2.fixedcellcheckbox(0, datagrid2.colRef("checked"), false) = true;
				datagrid3.fixedcellcheckbox(0, datagrid3.colRef("checked"), false) = true;
				datagrid4.fixedcellcheckbox(0, datagrid4.colRef("checked"), false) = true;
				
				switch1.selectedIndex = 0;
				
				combo7.select(0);
				combo1.select(0);
				
				model.refresh();
				]]>
			</script>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
			/**발송기사 번호, 명, 연락처**/
			function setAticNm(menu_id, menu_nm, menu_nm2){
				model.setValue("/root/resData/resForm/send_atic_no", menu_id);
				model.setValue("/root/resData/resForm/send_atic_nm", menu_nm);
				model.setValue("/root/resData/resForm/cntc_plac", menu_nm2);

				model.refresh();
			}
				
			function goReport(gubun){
						
				// 오즈관련 노드 초기화..					
				resetOznode();					
									
				// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
				makeNodeValue("/root/oz_data/ozrName", "is/SP_IS_SND_1270_P");									
							
				var root			= "/root/resData/resForm/";
				
				var wh_cd      		= model.getValue(	root + "/wh_cd2");
				var send_dt      	= model.getValue(	root + "/send_dt");
				var send_seq	  	= model.getValue(	root + "/send_seq");
				
				makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd"			,model.property("ss_cmpycd"));		
				makeNodeValue("/root/oz_data/odiParam/iv_wh_cd"				, wh_cd);	
				makeNodeValue("/root/oz_data/odiParam/iv_send_dt"			, send_dt);	
				makeNodeValue("/root/oz_data/odiParam/iv_send_seq"			, send_seq);	
							
				// 레포트뷰어 호출.					
				openOzwin("/root/oz_data");	
			}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="1,9;1,935;2,61;2,71;2,699;2,137;" style="font-family:굴림; ">
		<caption id="caption6" tyle="left:15px; top:180px; width:940px; height:0px;" style="left:0px; top:10px; width:0px; height:0px; ">caption6</caption>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<button id="button1" class="btn02" crud="R" style="left:828px; top:40px; width:50px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.reset();
				datagrid2.fixedcellischeck(0, datagrid2.colRef("checked")) = false;
				datagrid3.fixedcellischeck(0, datagrid3.colRef("checked")) = false;
				datagrid4.fixedcellischeck(0, datagrid4.colRef("checked")) = false;
				]]>
			</script>
		</button>
		<button id="btnClose" class="btn02" style="left:882px; top:40px; width:50px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[				
				viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));								
				]]>
			</script>
		</button>
		<switch id="switch1" class="gro_sel" style="left:11px; top:100px; width:925px; height:549px; ">
			<case id="case1" style="left:0px; top:0px; width:925px; height:529px; ">
				<caption id="caption3" class="list_cap02" style="left:5px; top:5px; width:910px; height:28px; "/>
				<caption id="caption9" class="list_cap01" style="left:5px; top:5px; width:85px; height:28px; ">배포일자</caption>
				<datagrid id="datagrid1" nodeset="/root/resData/gridData1/record" caption="규격^덩이당부수^cd" colsep="#" colwidth="100, 100, 100" mergecellsfixedrows="bycolrec" rowheight="25" rowsep="|" style="left:5px; top:60px; width:203px; height:455px; ">
					<col ref="cdnm"/>
					<col ref="cdnm_cd" type="input" format="#,###" style="text-align:right; "/>
					<col ref="cd"/>
				</datagrid>
				<datagrid id="datagrid2" nodeset="/root/resData/gridData2/record" caption="^구역^회사구분^cmpy_cd^asnt_dstc_cd" colsep="#" colwidth="30, 150, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowheight="25" rowsep="|" style="left:210px; top:60px; width:700px; height:455px; ">
					<col checkvalue="Y,N" ref="checked" type="checkbox"/>
					<col ref="asnt_dstc_cd_nm" style="text-align:left; "/>
					<col ref="cmpy_cd_nm"/>
					<col ref="cmpy_cd" visibility="hidden"/>
					<col ref="asnt_dstc_cd" visibility="hidden"/>
					<script type="javascript" ev:event="xforms-select">
						<![CDATA[
						var row = datagrid2.row;
						var col = datagrid2.col;
						
						if(row >= datagrid2.fixedRows){ 
		//데이타 영역 선택시					   
							datagrid2.valueMatrix(row, datagrid2.colRef("checked")) = "Y";
						}else{
		//헤더 일괄선택시 				
							for(var i=datagrid2.fixedRows;i<datagrid2.rows; i++){ 
								datagrid2.addStatus(i, "update");
							}		
						}
						]]>
					</script>
				</datagrid>
				<caption id="caption2" class="list_cap01" style="left:335px; top:5px; width:85px; height:28px; ">물류센터</caption>
				<select1 id="combo7" ref="/root/reqData/searchData/wh_cd" navindex="9" appearance="minimal" style="left:425px; top:10px; width:95px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/is_snd_1200_m/dataSet/CURLIST1/record">
							<label ref="cdnm"/>
							<value ref="cd"/>
						</itemset>
					</choices>
				</select1>
				<input id="input28" ref="/root/reqData/searchData/scat_dt_fr" navindex="43" inputtype="date" style="left:95px; top:10px; width:100px; height:18px; "/>
				<caption id="caption42" style="left:204px; top:12px; width:15px; height:17px; ">~</caption>
				<input id="input1" ref="/root/reqData/searchData/scat_dt_to" navindex="43" inputtype="date" style="left:225px; top:10px; width:100px; height:18px; "/>
				<button id="button10" class="btn02" crud="R" style="left:855px; top:10px; width:50px; height:18px; ">
					<caption>다음단계</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[	
						var selected1 = 0;
						for(var i=datagrid2.fixedRows; i<datagrid2.rows; i++) {
							if(datagrid2.valueMatrix(i, datagrid2.colRef("checked")) == 'Y'){
								selected1++;
								datagrid2.addStatus(i, "update");
							}else{
								datagrid2.removeStatus(i, "update");
							}
						}							
						if(selected1 == 0){
							alert("구역을 선택하세요.");
							return;
						}
						
						model.toggle("case2");												
						button6.selected = true;
						
						for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
							datagrid1.addStatus(i, "update");  //상태 변경
						}
						model.setValue("/root/reqData/multiUpdateData1", datagrid1.getUpdateData());
						model.setValue("/root/reqData/multiUpdateData2", datagrid2.getUpdateData());
						model.send("is_snd_1230_l");
						datagrid3.fixedcellischeck(0, datagrid3.colRef("checked")) = false;
						]]>
					</script>
				</button>
				<button id="button11" class="btn02" crud="R" style="left:800px; top:10px; width:50px; height:18px; ">
					<caption>조회</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						model.send("is_snd_1220_l");
						datagrid2.fixedcellischeck(0, datagrid2.colRef("checked")) = false;

						]]>
					</script>
				</button>
				<caption id="caption13" class="tit02" style="left:5px; top:38px; width:180px; height:20px; ">규격별 덩이당 부수 정보</caption>
			</case>
			<case id="case2">
				<caption id="caption5" class="list_cap02" style="left:5px; top:5px; width:910px; height:28px; "/>
				<button id="button13" class="btn02" crud="R" style="left:855px; top:10px; width:50px; height:18px; ">
					<caption>다음단계</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						var selected1 = 0;
						for(var i=datagrid3.fixedRows; i<datagrid3.rows; i++) {
							if(datagrid3.valueMatrix(i, datagrid3.colRef("checked")) == 'Y'){
								selected1++;
								datagrid3.addStatus(i, "update");
							}else{
								datagrid3.removeStatus(i, "update");
							}
						}	
						
						if(selected1 == 0){
							alert("광고업체를 선택하세요.");
							return;
						}
						
						for(var i=datagrid2.fixedRows; i<datagrid2.rows; i++) {
							if(datagrid2.valueMatrix(i, datagrid2.colRef("checked")) == 'Y'){
								datagrid2.addStatus(i, "update");
						    }else{
								datagrid2.removeStatus(i, "update");
							}
						}	
					

						
						model.toggle("case3");												
						button3.selected = true;
						
						for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
							datagrid1.addStatus(i, "update");  //상태 변경
						}
						model.setValue("/root/reqData/multiUpdateData1", datagrid1.getUpdateData());
						model.setValue("/root/reqData/multiUpdateData2", datagrid2.getUpdateData());
						model.setValue("/root/reqData/multiUpdateData3", datagrid3.getUpdateData());
						model.send("is_snd_1240_l");
						datagrid4.fixedcellischeck(0, datagrid4.colRef("checked")) = false;
						]]>
					</script>
				</button>
				<button id="button14" class="btn02" crud="R" style="left:800px; top:10px; width:50px; height:18px; ">
					<caption>이전단계</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						model.toggle("case1");
						
						button2.selected = true;										
						]]>
					</script>
				</button>
				<datagrid id="datagrid3" nodeset="/root/resData/gridData3/record" caption="^광고주^광고명^전단코드^승낙서번호^규격^덩이당부수^회사구분^cmpy_cd^acwr_reg_dt" colsep="#" colwidth="30, 150, 100, 60, 100, 60, 80, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowheight="25" rowsep="|" style="left:5px; top:40px; width:910px; height:475px; ">
					<col checkvalue="Y,N" ref="checked" type="checkbox"/>
					<col ref="advcs_cd_nm" style="text-align:left; "/>
					<col ref="advt_nm" style="text-align:left; "/>
					<col ref="acwr_reg_seq" visibility="hidden"/>
					<col ref="acwr_reg_dt_seq"/>
					<col ref="std_cd_nm"/>
					<col ref="bnch_qty" type="input"/>
					<col ref="cmpy_cd_nm"/>
					<col ref="cmpy_cd" visibility="hidden"/>
					<col ref="acwr_reg_dt" visibility="hidden"/>
					<script type="javascript" ev:event="xforms-select">
						<![CDATA[
					var row = datagrid3.row;
					var col = datagrid3.col;
					
					if(row >= datagrid3.fixedRows){ 
	//데이타 영역 선택시					   
						datagrid3.valueMatrix(row, datagrid3.colRef("checked")) = "Y";
					}else{
	//헤더 일괄선택시 				
						for(var i=datagrid3.fixedRows;i<datagrid3.rows; i++){ 
							datagrid3.addStatus(i, "update");
						}		
					}
					]]>
					</script>
				</datagrid>
			</case>
			<case id="case3" selected="true">
				<datagrid id="datagrid4" nodeset="/root/resData/gridData4/record" caption="^지국코드^구역^지국^회사구분^cmpy_cd^asnt_dstc_cd" colsep="#" colwidth="30, 100, 120, 150, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowheight="25" rowsep="|" style="left:5px; top:40px; width:910px; height:475px; ">
					<col checkvalue="Y,N" ref="checked" type="checkbox"/>
					<col ref="purc_dlco_no"/>
					<col ref="asnt_dstc_cd_nm"/>
					<col ref="purc_dlco_nm"/>
					<col ref="cmpy_cd_nm"/>
					<col ref="cmpy_cd" visibility="hidden"/>
					<col ref="asnt_dstc_cd" visibility="hidden"/>
					<script type="javascript" ev:event="xforms-select">
						<![CDATA[
					var row = datagrid4.row;
					var col = datagrid4.col;
					
					if(row >= datagrid4.fixedRows){ 
	//데이타 영역 선택시					   
						datagrid4.valueMatrix(row, datagrid4.colRef("checked")) = "Y";
					}else{
	//헤더 일괄선택시 				
						for(var i=datagrid4.fixedRows;i<datagrid4.rows; i++){ 
							datagrid4.addStatus(i, "update");
						}		
					}
					]]>
					</script>
				</datagrid>
				<caption id="caption1" class="list_cap02" style="left:5px; top:5px; width:910px; height:28px; "/>
				<button id="button5" class="btn02" crud="R" style="left:855px; top:10px; width:50px; height:18px; ">
					<caption>다음단계</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						var selected1 = 0;
						for(var i=datagrid4.fixedRows; i<datagrid4.rows; i++) {
							if(datagrid4.valueMatrix(i, datagrid4.colRef("checked")) == 'Y'){
								selected1++;
								datagrid4.addStatus(i, "update");
							}else{
								datagrid4.removeStatus(i, "update");
							}
						}							
						if(selected1 == 0){
							alert("지국을 선택하세요.");
							return;
						}

						for(var i=datagrid2.fixedRows; i<datagrid2.rows; i++) {
							if(datagrid2.valueMatrix(i, datagrid2.colRef("checked")) == 'Y'){
								datagrid2.addStatus(i, "update");
						    }else{
								datagrid2.removeStatus(i, "update");
							}
						}	
						for(var i=datagrid3.fixedRows; i<datagrid3.rows; i++) {
							if(datagrid3.valueMatrix(i, datagrid3.colRef("checked")) == 'Y'){
								datagrid3.addStatus(i, "update");
						    }else{
								datagrid3.removeStatus(i, "update");
							}
						}	
						
						model.toggle("case4");												
						button9.selected = true;
						
						for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
							datagrid1.addStatus(i, "update");  //상태 변경
						}
						model.setValue("/root/reqData/multiUpdateData1", datagrid1.getUpdateData());
						model.setValue("/root/reqData/multiUpdateData2", datagrid2.getUpdateData());
						model.setValue("/root/reqData/multiUpdateData3", datagrid3.getUpdateData());
						model.setValue("/root/reqData/multiUpdateData4", datagrid4.getUpdateData());
						model.send("is_snd_1250_l");	
						model.send("is_snd_1255_l");									
						
						
						for(var i=datagrid5.fixedRows;i<datagrid5.rows;i++){
							datagrid5.addStatus(i, "update");  //상태 변경
						}
						
						var wh_cd2 = model.getValue("/root/reqData/searchData/wh_cd");
						var send_dt = model.getValue("/root/resData/gridData5/record/send_dt");
				        var start_tm = model.getValue("/root/resData/gridData5/record/start_tm"); 
						
						model.setValue("/root/resData/resForm/wh_cd2", wh_cd2);
						model.setValue("/root/resData/resForm/send_dt", send_dt);
						model.setValue("/root/resData/resForm/start_tm", start_tm);
						
						model.refresh();
						]]>
					</script>
				</button>
				<button id="button7" class="btn02" crud="R" style="left:800px; top:10px; width:50px; height:18px; ">
					<caption>이전단계</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						model.toggle("case2");
						
						button6.selected = true;											
						]]>
					</script>
				</button>
			</case>
			<case id="case4">
				<caption id="caption8" class="list_cap02" style="left:5px; top:59px; width:910px; height:28px; "/>
				<datagrid id="datagrid5" nodeset="/root/resData/gridData5/record" visibility="visible" caption="구역^지국^배포일자^광고주^덩이^규격^부수^담당자^지국코드^승낙서번호^승낙서번호1^덩이당부수^회사구분^send_cmpy_cd^advcs_cd^std_cd^asnt_dstc_cd^dstc_seqo^dept_cd^sub_dept_cd^chrg_pers^acwr_reg_dt^purc_reg_dt^purc_reg_seq^advt_nm^group_cnt^group_order" colsep="#" colwidth="80, 130, 80, 130, 50, 70, 70, 70, 80, 127, 0, 70, 80, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowheight="25" rowsep="|" style="left:5px; top:120px; width:910px; height:150px; ">
					<col ref="asnt_dstc_cd_nm" style="text-align:left; "/>
					<col ref="purc_dlco_nm" purc_dlco_nmstyle="text-align:left;"/>
					<col ref="scat_dt" format="yyyy-mm-dd"/>
					<col ref="advcs_cd_nm" style="text-align:left; "/>
					<col ref="bnch_qunt"/>
					<col ref="std_cd_nm"/>
					<col ref="qunt" format="#,###" style="text-align:right; "/>
					<col ref="chrg_pers_nm"/>
					<col ref="purc_dlco_no"/>
					<col ref="acwr_reg_seq1"/>
					<col ref="acwr_reg_seq"/>
					<col ref="bnch_qty" format="#,###" style="text-align:right; "/>
					<col ref="cmpy_cd_nm"/>
					<col ref="send_cmpy_cd" visibility="hidden"/>
					<col ref="advcs_cd" visibility="hidden"/>
					<col ref="std_cd" visibility="hidden"/>
					<col ref="asnt_dstc_cd" visibility="hidden"/>
					<col ref="dstc_seqo" visibility="hidden"/>
					<col ref="dept_cd" visibility="hidden"/>
					<col ref="sub_dept_cd" visibility="hidden"/>
					<col ref="chrg_pers" visibility="hidden"/>
					<col ref="acwr_reg_dt" visibility="hidden"/>
					<col ref="purc_reg_dt" visibility="hidden"/>
					<col ref="purc_reg_seq" visibility="hidden"/>
					<col ref="advt_nm" visibility="hidden"/>
					<col ref="group_cnt" visibility="hidden"/>
					<col ref="group_order" visibility="hidden"/>
				</datagrid>
				<caption id="caption7" class="list_cap02" style="left:5px; top:5px; width:910px; height:28px; "/>
				<button id="button15" class="btn02" crud="R" style="left:855px; top:10px; width:50px; height:21px; ">
					<caption>발송취소</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						var val = window.alert("발송취소하시겠습니까?", "확인", 1) ;
						// 1은 확인 2는 취소
						if (val == 2 ){
							return;
						}
						
						model.setValue("/root/resData/resForm/flag", "D");
						model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");
						model.setValue("/root/reqData/multiUpdateData5", datagrid5.getUpdateData());
						
						model.send("is_snd_1260_a");	
						
						
						if( submit_completed() ){
							/*
							model.setValue("/root/resData/resForm/wh_cd2", "");
							model.setValue("/root/resData/resForm/send_dt", "");
							model.setValue("/root/resData/resForm/send_seq", "");
							model.setValue("/root/resData/resForm/sendclsf", "");
							model.setValue("/root/resData/resForm/send_atic_no", "");
							model.setValue("/root/resData/resForm/send_atic_nm", "");
							model.setValue("/root/resData/resForm/cntc_plac", "");
							model.setValue("/root/resData/resForm/send_fee", "")
							model.setValue("/root/resData/resForm/start_tm", "");
							model.setValue("/root/resData/resForm/end_tm", "");
							model.setValue("/root/resData/resForm/serv_ref", "");

							model.setValue("/root/reqData/reqForm/wh_cd2", "");
							model.setValue("/root/reqData/reqForm/send_dt", "");
							model.setValue("/root/reqData/reqForm/send_seq", "");
							
							for(var i=datagrid5.rows; i>1; i--){ 
						 		model.destroy("/root/resData/datagrid5/record["+i+"]");
								datagrid5.removeRow(false);
								model.refresh();
						 	}
						 	
						 	for(var i=datagrid6.rows; i>1; i--){ 
						 		model.destroy("/root/resData/gridData6/record["+i+"]");
								datagrid6.removeRow(false);
								model.refresh();
						 	}
							*/							
						 	model.reset();
						}										
						model.refresh();								
						]]>
					</script>
				</button>
				<datagrid id="datagrid6" nodeset="/root/resData/gridData6/record" caption="구역^배포일자^광고주^덩이^규격^부수^승낙서번호^덩이당부수^도착일자^도착시간^회사구분" colsep="^" colwidth="90, 80, 169, 50, 50, 70, 100, 70, 80, 80, 80" mergecellsfixedrows="bycolrec" rowheader="seq" rowheight="25" rowsep="|" style="left:5px; top:300px; width:910px; height:240px; ">
					<col ref="asnt_dstc_cd_nm" visibility="hidden" style="text-align:left; "/>
					<col ref="scat_dt" format="yyyy-mm-dd"/>
					<col ref="advcs_cd_nm" style="text-align:left; "/>
					<col ref="bnch_qunt"/>
					<col ref="std_cd_nm"/>
					<col ref="qunt" format="#,###" style="text-align:right; "/>
					<col ref="acwr_reg_dt_seq" visibility="hidden"/>
					<col ref="bnch_qty" format="#,###" style="text-align:right; "/>
					<col/>
					<col/>
					<col ref="cmpy_cd_nm"/>
				</datagrid>
				<button id="button8" class="btn02" crud="R" style="left:800px; top:10px; width:50px; height:21px; ">
					<caption>발송처리</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						/**필수 항목**/
						var wh_cd1 = model.getValue("/root/reqData/searchData/wh_cd");
						var wh_cd2 = model.getValue("/root/resData/resForm/wh_cd2");
						
						if(wh_cd1 != wh_cd2){
							alert("1단계-구역의 물류센터와 발생내역의 물류센터가 일치해야합니다.");
							return;
						}
						
						if(model.getValue("/root/resData/resForm/sendclsf") == "1" && model.getValue("/root/resData/resForm/send_atic_no") == ""){
							alert("발송기사번호를 입력하세요.");
							return;
						}
						if(model.getValue("/root/resData/resForm/sendclsf") == "2" && model.getValue("/root/resData/resForm/send_atic_nm") == ""){
							alert("발송기사명을 입력하세요.");
							return;
						}
						
						var val = window.alert("발송처리하시겠습니까?", "확인", 1) ;
						// 1은 확인 2는 취소
						if (val == 2 ){
							return;
						}
						
											
						model.setValue("/root/resData/resForm/flag", "I");
						model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");
						model.setValue("/root/reqData/multiUpdateData5", datagrid5.getUpdateData());
						
						model.send("is_snd_1260_a");	
						
						
						if( submit_completed() ){
							model.setValue("/root/resData/resForm/send_seq", model.getValue("/root/msgData/send_seq"));
						
							for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
								datagrid1.addStatus(i, "update");  //상태 변경
							}
							model.setValue("/root/reqData/multiUpdateData1", datagrid1.getUpdateData());
							model.setValue("/root/reqData/multiUpdateData2", datagrid2.getUpdateData());
							model.setValue("/root/reqData/multiUpdateData3", datagrid3.getUpdateData());
							model.setValue("/root/reqData/multiUpdateData4", datagrid4.getUpdateData());
							
							//model.setValue("/root/resData/resForm/flag", "I");
							model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");
							model.send("is_snd_1250_l");	
							model.send("is_snd_1255_l");		
						}	
						model.refresh();									
						]]>
					</script>
				</button>
				<caption id="caption70" class="list_cap02" style="left:5px; top:32px; width:910px; height:28px; "/>
				<caption id="caption41" class="list_cap03" style="left:5px; top:32px; width:93px; height:28px; text-align:center; ">발송기사</caption>
				<input id="input33" ref="/root/resData/resForm/send_fee" format="#,###" style="left:345px; top:64px; width:125px; height:18px; text-align:right; "/>
				<caption id="caption10" class="list_cap03" style="left:475px; top:59px; width:93px; height:28px; text-align:center; ">출발시간</caption>
				<caption id="caption11" class="list_cap03" style="left:695px; top:59px; width:93px; height:28px; text-align:center; ">종료시간</caption>
				<caption id="caption12" class="list_cap03" style="left:5px; top:59px; width:93px; height:28px; text-align:center; ">연락처</caption>
				<input id="inp_indt_cd" ref="/root/resData/resForm/send_atic_no" inputtype="button" format="9999" style="left:165px; top:36px; width:75px; height:18px; ">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setAticNm");//팝업에서 함수호출명 
									
						window.load("/xrw/is/com/IS_COM_1700.xrw"
									,"mdichild"
									, "is_com_1700"
									, "align:center; caption:hidden;width:765; height:455;px;"
									, "/root/reqData/fwdData"
									, "/root/reqData/fwdData");
						]]>
					</script>
				</input>
				<caption id="caption14" class="list_cap03" style="left:250px; top:59px; width:93px; height:28px; text-align:center; ">발송비</caption>
				<input id="input16" ref="/root/resData/resForm/cntc_plac" navindex="21" style="left:100px; top:64px; width:145px; height:18px; text-align:left; "/>
				<input id="input2" ref="/root/resData/resForm/send_atic_nm" navindex="21" style="left:245px; top:37px; width:125px; height:18px; text-align:left; "/>
				<input id="input3" ref="/root/resData/resForm/end_tm" format="hh:nn" style="left:790px; top:64px; width:120px; height:18px; text-align:left; "/>
				<input id="input4" ref="/root/resData/resForm/start_tm" navindex="21" format="hh:nn" style="left:570px; top:64px; width:120px; height:18px; text-align:left; "/>
				<caption id="caption15" class="list_cap03" style="left:5px; top:5px; width:93px; height:28px; text-align:center; ">발송번호</caption>
				<input id="input5" ref="/root/resData/resForm/send_dt" inputtype="date" style="left:190px; top:8px; width:94px; height:20px; "/>
				<input id="inp_send_seq" ref="/root/resData/resForm/send_seq" format="9999" style="left:287px; top:8px; width:50px; height:20px; ">
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						var send_seq = inp_send_seq.currentText;					
						model.setValue("/root/resData/resForm/send_seq", lpad(send_seq, 4, "0"));
						model.refresh();			
						]]>
					</script>
				</input>
				<button id="button12" class="btn02" crud="R" style="left:345px; top:8px; width:50px; height:21px; ">
					<caption>조회</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
							datagrid1.addStatus(i, "update");  //상태 변경
						}
						model.setValue("/root/reqData/multiUpdateData1", datagrid1.getUpdateData());
						model.setValue("/root/reqData/multiUpdateData2", datagrid2.getUpdateData());
						model.setValue("/root/reqData/multiUpdateData3", datagrid3.getUpdateData());
						model.setValue("/root/reqData/multiUpdateData4", datagrid4.getUpdateData());
						
						//model.setValue("/root/resData/resForm/flag", "I");
						model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");
						model.send("is_snd_1250_l");	
						model.send("is_snd_1255_l");		
						
						
						var wh_cd2 = model.getValue("/root/resData/gridData5/record/wh_cd2");
						var send_dt = model.getValue("/root/resData/gridData5/record/send_dt");
						var send_seq = model.getValue("/root/resData/gridData5/record/send_seq");
						var send_atic_no = model.getValue("/root/resData/gridData5/record/send_atic_no");
						var send_atic_nm = model.getValue("/root/resData/gridData5/record/send_atic_nm");
						var sendclsf = model.getValue("/root/resData/gridData5/record/sendclsf");
						var serv_ref = model.getValue("/root/resData/gridData5/record/serv_ref");
						var cntc_plac = model.getValue("/root/resData/gridData5/record/cntc_plac");
						var send_fee = model.getValue("/root/resData/gridData5/record/send_fee");
						var start_tm = model.getValue("/root/resData/gridData5/record/start_tm");
						var end_tm = model.getValue("/root/resData/gridData5/record/end_tm");
						var remk = model.getValue("/root/resData/gridData5/record/remk");
						
						
						model.setValue("/root/resData/resForm/wh_cd2", wh_cd2);
						model.setValue("/root/resData/resForm/send_dt", send_dt);
						model.setValue("/root/resData/resForm/send_seq", send_seq);
						model.setValue("/root/resData/resForm/send_atic_no", send_atic_no);
						model.setValue("/root/resData/resForm/send_atic_nm", send_atic_nm);
						model.setValue("/root/resData/resForm/sendclsf", sendclsf);
						model.setValue("/root/resData/resForm/serv_ref", serv_ref);
						model.setValue("/root/resData/resForm/cntc_plac", cntc_plac);
						model.setValue("/root/resData/resForm/send_fee", send_fee);
						model.setValue("/root/resData/resForm/start_tm", start_tm);
						model.setValue("/root/resData/resForm/end_tm", end_tm);
						
						
						model.refresh();										
						]]>
					</script>
				</button>
				<button id="button4" class="btn02" crud="R" style="left:400px; top:8px; width:50px; height:21px; ">
					<caption>인쇄</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						goReport("P");
						]]>
					</script>
				</button>
				<caption id="caption18" class="list_cap03" style="left:475px; top:32px; width:93px; height:28px; text-align:center; ">용역참조</caption>
				<input id="input7" ref="/root/resData/resForm/serv_ref" navindex="21" style="left:570px; top:37px; width:215px; height:18px; text-align:left; "/>
				<select1 id="combo1" ref="/root/resData/resForm/sendclsf" appearance="minimal" style="left:100px; top:36px; width:60px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/is_snd_1200_m/dataSet/CURLIST2/record">
							<label ref="cdnm"/>
							<value ref="cd"/>
						</itemset>
					</choices>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						if(model.getValue("/root/resData/resForm/sendclsf") == "1"){
							inp_indt_cd.disabled = false;
							
							model.setValue("/root/resData/resForm/send_atic_no", "");
							model.setValue("/root/resData/resForm/send_atic_nm", "");
							model.setValue("/root/resData/resForm/cntc_plac", "");
						}else{
							inp_indt_cd.disabled = true;
							
							model.setValue("/root/resData/resForm/send_atic_no", "");
							model.setValue("/root/resData/resForm/send_atic_nm", "");
							model.setValue("/root/resData/resForm/cntc_plac", "");
						}
						model.refresh();
						]]>
					</script>
				</select1>
				<select1 id="combo2" ref="/root/resData/resForm/wh_cd2" appearance="minimal" style="left:100px; top:8px; width:85px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/is_snd_1200_m/dataSet/CURLIST3/record">
							<label ref="cdnm"/>
							<value ref="cd"/>
						</itemset>
					</choices>
				</select1>
				<caption id="caption4" class="tit02" style="left:5px; top:98px; width:180px; height:20px; ">지국별</caption>
				<caption id="caption19" class="tit02" style="left:5px; top:278px; width:180px; height:20px; ">광고주별</caption>
			</case>
		</switch>
		<button id="button2" class="tab06" group="tab" selected="true" crud="R" style="left:11px; top:79px; width:105px; height:23px; ">
			<caption>1단계-구역</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case1");					
				]]>
			</script>
		</button>
		<button id="button6" class="tab06" group="tab" crud="R" style="left:116px; top:79px; width:105px; height:23px; ">
			<caption>2단계-광고업체</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case2");
				]]>
			</script>
		</button>
		<button id="button3" class="tab06" group="tab" crud="R" style="left:221px; top:79px; width:105px; height:23px; ">
			<caption>3단계-지국</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case3");
				]]>
			</script>
		</button>
		<button id="button9" class="tab06" group="tab" crud="R" style="left:326px; top:79px; width:105px; height:23px; ">
			<caption>발송내역</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[		
				model.toggle("case4");
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
