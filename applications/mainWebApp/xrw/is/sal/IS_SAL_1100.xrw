<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet_ad.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>매입세금계산서입력</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<teamlist/>
							<partlist/>
							<curlist1/>
							<curlist2/>
							<curlist3/>
							<curlist4/>
						</comboSet>
						<pageInfo/>
						<hndl_nm/>
					</initData>
					<reqData>
						<fwdData>
							<slip_clsf_cd2/>
							<slip_occr_dt2/>
							<slip_seq2/>
						</fwdData>
						<searchData>
							<purc_frdt/>
							<purc_todt/>
							<dt_clsf>01</dt_clsf>
							<dlco_clsf_cd_seq/>
							<advt_nm/>
							<dept_cd/>
							<sub_dept_cd/>
							<chrg_pers/>
							<chrg_pers_nm/>
						</searchData>
						<reqForm>
							<slip_clsf_cd/>
							<slip_occr_dt/>
							<slip_seq/>
							<prof_type_cd/>
							<hndl_clsf>2</hndl_clsf>
							<dlco_clsf_cd_seq/>
							<dlco_nm/>
							<make_dt/>
							<suply_amt/>
							<vat_amt/>
							<tot_amt/>
							<medi_cd/>
							<del_resn/>
							<erplace_cd/>
							<ern/>
							<addr/>
							<deal_clsf/>
							<presi_nm/>
							<bizcond/>
							<item/>
							<tot_suply_amt/>
							<tot_vat_amt/>
							<tot_fee/>
							<tot_fee_vat/>
							<tot_fee_amt/>
							<pay_clsf/>
							<canc_yn/>
							<multiUpdateData/>
							<pubc_frdt/>
							<pubc_todt/>
							<medi_cd/>
							<email_id/>
							<elec_tax_comp_cd/>
							<semuro_no/>
							<checked/>
						</reqForm>
						<multiUpdateData1/>
					</reqData>
					<resData>
						<resForm>
							<slip_clsf_cd/>
							<slip_occr_dt/>
							<slip_seq/>
							<prof_type_cd/>
							<hndl_clsf>2</hndl_clsf>
							<dlco_clsf_cd_seq/>
							<dlco_nm/>
							<make_dt/>
							<suply_amt/>
							<vat_amt/>
							<tot_amt/>
							<medi_cd/>
							<del_resn/>
							<erplace_cd/>
							<ern/>
							<addr/>
							<deal_clsf/>
							<presi_nm/>
							<bizcond/>
							<item/>
							<tot_suply_amt/>
							<tot_vat_amt/>
							<tot_fee/>
							<tot_fee_vat/>
							<tot_fee_amt/>
							<pay_clsf/>
							<canc_yn/>
							<multiUpdateData/>
							<pubc_frdt/>
							<pubc_todt/>
							<medi_cd/>
							<email_id/>
							<elec_tax_comp_cd/>
							<semuro_no/>
							<gridData>
								<record>
									<checked/>
									<acwr_reg_dt_seq/>
									<purc_clsf_nm/>
									<purc_dt/>
									<uprc/>
									<qunt/>
									<purc_amt/>
									<remk/>
									<purc_reg_dt/>
									<purc_reg_seq/>
									<acwr_reg_dt/>
									<acwr_reg_seq/>
									<purc_clsf/>
									<trc_yn/>
									<send_yn/>
									<adjm_yn/>
									<purc_adjm_reg_dt/>
									<purc_adjm_reg_seq/>
									<adjm_yn/>
								</record>
							</gridData>
						</resForm>
					</resData>
					<tempData>
						<keyData/>
					</tempData>
					<msgData/>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				//model.send("is_sal_1100_m");
				//makeComboGubun("","/root/initData/comboSet/is_sal_1100_m/dataSet/CURLIST3","record","cdnm_cd", "cd");		/**세금계산선번호(전표구분) 콤보**/
				//makeComboGubun("","/root/initData/comboSet/is_sal_1100_m/dataSet/CURLIST2","record","cdnm", "cd");			/**전자세금계산서업체 콤보**/
				//makeComboGubun("","/root/initData/comboSet/is_sal_1100_m/dataSet/CURLIST4","record","cdnm", "cd");	/**사업장 콤보**/
				//
				//cb_slip_clsf_cd.select(0);
				//cb_dt_clsf.select(2);
				var curDate = getCurrentDate();
				model.setValue("/root/reqData/searchData/purc_frdt", curDate);	/**배포기간**/
				model.setValue("/root/reqData/searchData/purc_todt",  curDate);	/**배포기간**/
				model.setValue("/root/resData/resForm/slip_occr_dt", curDate);	/**세금계산서번호일자**/
				var todt = dateAdd("m", -1, curDate).substring(0,6)+ "" + commLastDay(curDate);  /**당일의 전월 말일**/
			
				model.setValue("/root/resData/resForm/make_dt", todt);	 /**작성일자**/
				
								
				
				makeTeamSearch(
							   "is_sal_1100_m"
							  , "/is/sal/1100"
							  , "/root/reqData"  
	                          , "/root/initData/comboSet"
							  , "team_combo"
							  , "part_combo"
							  );
				
			
				model.refresh();
				
 
				]]>
			</script>
			<submission id="is_sal_1100_m" action="/is/sal/1100" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/comboSet/is_sal_1100_m/dataSet"/>
			<submission id="is_sal_1110_l" action="/is/sal/1110" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm/gridData/record"/>
			<submission id="is_sal_1120_a" action="/is/sal/1120" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/msgData"/>
			<submission id="is_sal_1122_a" action="/is/sal/1122" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/msgData"/>
			<submission id="is_sal_1130_s" action="/is/sal/1130" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/resData/resForm"/>
			<submission id="is_sal_1030_s" action="/is/sal/1030" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/tempData"/>
			<submission id="is_com_1200_s" action="/is/com/1200" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData"/>
			<submission id="hd_com_1002" action="/hd/com/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript" src="/js/se_comm.js"/>
		<script type="javascript">
			<![CDATA[
			/**탭1. 콤보박스 환경설정한다. **/
			function makeTeamSearch(submitId, action, ref, resultref, teamCombo, partCombo){

				modelSendNoMake(submitId, action, ref, resultref);
				if(!submit_completed()) return;
				
				var teamEvent = 'selectTeam("' + resultref + '", "' + teamCombo + '", "' + partCombo + '");';
				//var partEvent = 'selectPart("' + resultref + '", "' + teamCombo + '", "' + partCombo + '", "' + areaCombo + '");';
				//teamEvent = teamEvent + partEvent;
			
				eval(teamCombo + ".attribute('xforms-select') = '" + teamEvent + "'");
				//eval(partCombo + ".attribute('xforms-select') = '" + partEvent + "'");,,
	
				makeComboGubun("A", resultref + "/teamlist", "record", "dept_nm", "dept_cd");
				makeComboGubun("A", resultref + "/partlist", "record", "dept_nm", "dept_cd");
				//makeComboGubun("", resultref + "/curlist3", "record", "cdnm_cd", "cd");

				//makeComboGubun("", resultref + "/curlist4", "record", "cdnm_cd", "cd");
				 makeComboGubun("", resultref + "/curlist2", "record", "cdnm", "cd");
				  
				selectTeam(resultref, teamCombo, partCombo);
				cb_slip_clsf_cd.select(0);
				cmb_elec_tax_comp_cd.select(0);
				combo1.select(0);
				//selectPart(resultref, teamCombo, partCombo, areaCombo); 보류
				model.refresh();
			    //eval(teamCombo + ".select(0)");
				
			}
			
			/** 팀이 선택되면 파트의 값을 변경한다. **/
			function selectTeam(resultref, teamCombo, partCombo){
				var key        = eval(teamCombo + ".value");
				var arr        = instance1.selectSingleNode(resultref + "/partlist_temp/record"); 

				if(arr == null){
					var len = null;
				}else{
					var len = arr.length;
				}
			
				var val, record, dept_cd, dept_nm, node2, node3;
				var node = resultref + "/partlist";
				var nodeTemp = resultref + "/partlist_temp";
				var index = 1;
				model.removeNodeset(node);
			
			//alert('part='+len);	
			//alert('dept_cd='+model.getValue(nodeTemp + "/record/dept_cd"));
			//alert('dept_nm='+model.getValue(nodeTemp + "/record/dept_nm"));
			
				if(len==0){
					val          = model.getValue(nodeTemp + "/record/supr_dept_cd");
					if ( key == val || key == "" ){
							model.makeNode(node + "/record[" + 1 + "]");
							model.makeNode(node + "/record[" + 1 + "]/dept_cd");
							model.makeNode(node + "/record[" + 1 + "]/dept_nm");
							
							model.setValue(node + "/record[" + 1 + "]/dept_cd", model.getValue(nodeTemp + "/record/dept_cd"));
							model.setValue(node + "/record[" + 1 + "]/dept_nm", model.getValue(nodeTemp + "/record/dept_nm"));
					}
				}else if(len > 1){
					for ( var i = 1 ; i <= len ; i++ ){
						val          = model.getValue(nodeTemp + "/record[" + i + "]/supr_dept_cd");
						if ( key == val || key == "" ){
								model.makeNode(node + "/record[" + index + "]");
								model.makeNode(node + "/record[" + index + "]/dept_cd");
								model.makeNode(node + "/record[" + index + "]/dept_nm");
								
								model.setValue(node + "/record[" + index + "]/dept_cd", model.getValue(nodeTemp + "/record[" + i + "]/dept_cd"));
								model.setValue(node + "/record[" + index + "]/dept_nm", model.getValue(nodeTemp + "/record[" + i + "]/dept_nm"));
								
								index++;
				
						}
					}
				}
				
				model.refresh();
				makeComboGubun("A", resultref + "/partlist", "record", "dept_nm", "dept_cd");
				
				eval(partCombo + ".select(0)");
			}
			
			
			
			
			
			
			
			/**거래처 팝업**/
			function setDlcoInfo(menu_id, menu_nm){
				model.setValue("/root/resData/resForm/dlco_clsf_cd_seq", menu_id);
				model.setValue("/root/resData/resForm/dlco_nm", menu_nm);

				/**등록번호, 법인명, 상호(법인명 풀명), 성명, 사업장주소, 업태, 종목**/
				model.send("is_sal_1030_s");
				
				var ern = model.getValue("/root/tempData/ern");					/**등록번호**/
				var addr = model.getValue("/root/tempData/addr");					/*사업장주소**/
				var corp_clsf = model.getValue("/root/tempData/corp_clsf");			/**거래구분**/
				var presi_nm = model.getValue("/root/tempData/presi_nm");			/*성명**/
				var bizcond = model.getValue("/root/tempData/bizcond");				/*업태**/
				var item = model.getValue("/root/tempData/item");					/*종목**/
				
				model.setValue("/root/resData/resForm/ern", ern);
				model.setValue("/root/resData/resForm/addr", addr);
				model.setValue("/root/resData/resForm/deal_clsf", corp_clsf);
				model.setValue("/root/resData/resForm/presi_nm", presi_nm);
				model.setValue("/root/resData/resForm/bizcond", bizcond);
				model.setValue("/root/resData/resForm/item", item);
				
				model.refresh();	
			}
			
			/**거래처 담당자 팝업**/
			function setEmailInfo(email){
				model.setValue("/root/resData/resForm/email_id", email);
				
				model.refresh();
			}	
			
			function setMenu_srch(menu_id, menu_nm){		
				model.setValue("/root/reqData/searchData/chrg_pers", menu_id);
				model.setValue("/root/reqData/searchData/chrg_pers_nm", menu_nm);
				
				model.refresh();	
			}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="756" guideline="1,10;1,936;2,59;2,70;" style="font-family:굴림; ">
		<group id="grp_detail" style="left:10px; top:65px; width:930px; height:185px; ">
			<caption id="caption7" class="list_cap02" style="left:0px; top:155px; width:926px; height:26px; "/>
			<caption id="caption4" class="list_cap02" style="left:0px; top:130px; width:926px; height:26px; "/>
			<caption id="caption8" class="list_cap02" style="left:0px; top:105px; width:926px; height:26px; "/>
			<caption id="caption2" class="list_cap02" style="left:0px; top:80px; width:926px; height:26px; "/>
			<caption id="caption3" class="list_cap02" style="left:0px; top:55px; width:926px; height:26px; "/>
			<caption id="caption1" class="list_cap02" style="left:0px; top:30px; width:926px; height:26px; "/>
			<caption id="caption9" class="list_cap02" style="left:0px; top:5px; width:926px; height:26px; "/>
			<input id="inp_dlco_clsf_cd_seq" ref="/root/resData/resForm/dlco_clsf_cd_seq" class="req" navindex="5" autonext="false" inputtype="button" style="left:108px; top:34px; width:82px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[				
					model.makeNode("/root/reqData/fwdData/func_nm");
					model.setValue("/root/reqData/fwdData/func_nm", "setDlcoInfo");//팝업에서 함수호출명 
								
					window.load("/xrw/is/com/IS_COM_1100.xrw"
								,"mdichild"
								, "is_com_1100"
								, "align:center; caption:hidden;width:645px; height:480px;"
								, "/root/reqData/fwdData"
								, "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if (inp_dlco_clsf_cd_seq.value.length == 9) {
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/dlco_clsf_cd_seq");
						model.setValue("/root/reqData/fwdData/dlco_clsf_cd_seq", inp_dlco_clsf_cd_seq.value);
						model.send("is_com_1200_s");
								
						if (model.getValue("/root/tempData/record/dlco_clsf_cd_seq") != "") {
							inp_dlco_nm.value = model.getValue("/root/tempData/record/dlco_nm");
							
							var menu_id = inp_dlco_clsf_cd_seq.value;
							var menu_nm = inp_dlco_nm.value;
							setDlcoInfo(menu_id, menu_nm);
							
						}else {
							inp_dlco_nm.value = "";
							inp_dlco_clsf_cd_seq.value = "";
						}
					}else {
						inp_dlco_nm.value = "";
						inp_dlco_clsf_cd_seq.value = "";
					}
					model.refresh();			
					]]>
				</script>
			</input>
			<output id="output4" ref="/root/resData/resForm/item" appearance="output" style="left:754px; top:84px; width:165px; height:18px; word-wrap:none; "/>
			<output id="out_tot_fee" ref="/root/resData/resForm/tot_fee" format="(-)#,###" appearance="output" style="left:754px; top:109px; width:80px; height:18px; text-align:right; "/>
			<input id="inp_suply_amt" ref="/root/resData/resForm/suply_amt" class="req" navindex="8" format="#,###" caption="공급가액" appearance="input" style="left:108px; top:84px; width:115px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var suply_amt = Number(model.getValue("/root/resData/resForm/suply_amt"));		
					if(suply_amt > 0){
						var vat_amt	=	Math.round(suply_amt / 10);
						model.setValue("/root/resData/resForm/vat_amt", vat_amt);
						inp_vat_amt.refresh();
						
						model.setValue("/root/resData/resForm/tot_amt", suply_amt + Math.round(suply_amt / 10));
						inp_tot_amt.refresh();
					}
					]]>
				</script>
			</input>
			<output id="input8" ref="/root/resData/resForm/tot_suply_amt" format="#,###" appearance="output" style="left:493px; top:109px; width:145px; height:18px; text-align:right; "/>
			<output id="input9" ref="/root/resData/resForm/tot_vat_amt" format="#,###" appearance="output" style="left:493px; top:134px; width:145px; height:18px; text-align:right; "/>
			<output id="output6" ref="/root/resData/resForm/pay_clsf" appearance="output" style="left:493px; top:159px; width:145px; height:18px; "/>
			<input id="inp_slip_occr_dt" ref="/root/resData/resForm/slip_occr_dt" class="req" navindex="2" inputtype="date" format="yyyy-mm-dd" caption="세금계산서번호" style="left:228px; top:9px; width:90px; height:18px; "/>
			<output id="output7" ref="/root/resData/resForm/canc_yn" appearance="output" style="left:754px; top:160px; width:35px; height:18px; "/>
			<caption id="caption20" class="list_cap03" style="left:0px; top:5px; width:105px; height:26px; ">
				<![CDATA[세금계산서번호]]>
				<script type="javascript" ev:event="ondblclick">
					<![CDATA[
						if( cb_slip_clsf_cd.disabled == true )	cb_slip_clsf_cd.disabled = false;
						else							cb_slip_clsf_cd.disabled = true;
					]]>
				</script>
			</caption>
			<input id="inp_slip_seq" ref="/root/resData/resForm/slip_seq" navindex="3" format="9999" style="left:322px; top:9px; width:30px; height:18px; ">
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
				var slip_seq = model.getValue("/root/resData/resForm/slip_seq");
				if(slip_seq != ""){
					model.setValue("/root/resData/resForm/slip_seq", lpad(slip_seq, 4, "0"));
					inp_slip_seq.refresh();	
				}					
				]]>
				</script>
			</input>
			<caption id="caption10" class="list_cap03" style="left:399px; top:80px; width:90px; height:26px; ">업 태</caption>
			<input id="inp_vat_amt" ref="/root/resData/resForm/vat_amt" class="req" navindex="9" format="#,###" caption="세액" appearance="input" style="left:108px; top:109px; width:115px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[

					var vat_amt 		= Number(model.getValue("/root/resData/resForm/vat_amt"));		

					var suply_amt	= Number(model.getValue("/root/resData/resForm/suply_amt"));	
						
					model.setValue("/root/resData/resForm/tot_amt", suply_amt + vat_amt);
					inp_tot_amt.refresh();

					]]>
				</script>
			</input>
			<caption id="caption22" class="list_cap03" style="left:399px; top:55px; width:90px; height:26px; ">거래구분</caption>
			<caption id="caption11" class="list_cap03" style="left:399px; top:5px; width:90px; height:26px; ">사업자번호</caption>
			<caption id="caption23" class="list_cap03" style="left:399px; top:155px; width:90px; height:26px; ">지불구분</caption>
			<select1 id="cb_slip_clsf_cd" ref="/root/resData/resForm/slip_clsf_cd" class="req" disabled="true" navindex="1" appearance="minimal" caption="세금계산서번호" style="left:108px; top:9px; width:115px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/curlist3/record">
						<label ref="cdnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</select1>
			<input id="input13" ref="/root/resData/resForm/del_resn" navindex="10" imemode="hangul" appearance="input" style="left:108px; top:134px; width:287px; height:18px; "/>
			<caption id="caption12" class="list_cap03" style="left:644px; top:80px; width:105px; height:26px; ">종 목</caption>
			<output id="out_tot_fee_vat" ref="/root/resData/resForm/tot_fee_vat" format="#,###" appearance="output" style="left:754px; top:134px; width:75px; height:18px; text-align:right; "/>
			<caption id="caption24" class="list_cap03" style="left:644px; top:55px; width:105px; height:26px; ">대표자</caption>
			<caption id="caption13" class="list_cap03" style="left:0px; top:80px; width:105px; height:26px; ">공급가액</caption>
			<caption id="caption25" class="list_cap03" style="left:0px; top:130px; width:105px; height:26px; ">삭제사유</caption>
			<caption id="caption14" class="list_cap03" style="left:399px; top:30px; width:90px; height:26px; ">주 소</caption>
			<caption id="caption26" class="list_cap03" style="left:0px; top:55px; width:105px; height:26px; ">작성일자</caption>
			<input id="inp_make_dt" ref="/root/resData/resForm/make_dt" class="req" navindex="7" inputtype="date" format="yyyy-mm-dd" caption="작성일자" style="left:108px; top:59px; width:95px; height:18px; "/>
			<caption id="caption27" class="list_cap03" style="left:644px; top:155px; width:105px; height:26px; ">취소여부</caption>
			<input id="input2" ref="/root/resData/resForm/ern" appearance="input" style="left:493px; top:9px; width:145px; height:18px; "/>
			<caption id="caption16" class="list_cap03" style="left:399px; top:105px; width:90px; height:51px; ">입수총액</caption>
			<output id="input3" ref="/root/resData/resForm/deal_clsf" appearance="output" style="left:493px; top:59px; width:145px; height:18px; "/>
			<caption id="caption17" class="list_cap03" style="left:644px; top:105px; width:105px; height:51px; ">매입금액</caption>
			<output id="output1" ref="/root/resData/resForm/presi_nm" appearance="output" style="left:754px; top:59px; width:165px; height:18px; "/>
			<caption id="caption18" class="list_cap03" style="left:0px; top:30px; width:105px; height:26px; ">거래처</caption>
			<input id="inp_dlco_nm" ref="/root/resData/resForm/dlco_nm" class="req" imemode="hangul" style="left:197px; top:34px; width:198px; height:18px; "/>
			<output id="output2" ref="/root/resData/resForm/addr" appearance="output" style="left:493px; top:34px; width:425px; height:18px; "/>
			<caption id="caption19" class="list_cap03" style="left:0px; top:105px; width:105px; height:26px; ">세 액</caption>
			<output id="output3" ref="/root/resData/resForm/bizcond" appearance="output" style="left:493px; top:84px; width:145px; height:18px; word-wrap:none; "/>
			<output id="output8" ref="/root/resData/resForm/prof_type_cd" visibility="hidden" style="left:652px; top:10px; width:25px; height:18px; "/>
			<output id="out_tot_fee_amt" ref="/root/resData/resForm/tot_fee_amt" format="#,###" appearance="output" style="left:838px; top:134px; width:80px; height:18px; text-align:right; "/>
			<output id="inp_tot_amt" ref="/root/resData/resForm/tot_amt" format="#,###" caption="세액" appearance="output" style="left:233px; top:109px; width:115px; height:18px; text-align:right; "/>
			<button id="button22" style="left:357px; top:9px; width:18px; height:18px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
				<caption>+</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var slip_occr_dt 	= model.getValue("/root/resData/resForm/slip_occr_dt");
					var slip_seq		= Number(model.getValue("/root/resData/resForm/slip_seq"));
					
					slip_seq++;
					
					model.setValue("/root/resData/resForm/slip_seq", lpad(""+slip_seq, 4, "0"));
					inp_slip_seq.refresh();
					
					//loadData();					
					]]>
				</script>
			</button>
			<button id="button23" style="left:377px; top:9px; width:18px; height:18px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
				<caption>-</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var slip_occr_dt	= model.getValue("/root/resData/resForm/slip_occr_dt");
					var slip_seq		= Number(model.getValue("/root/resData/resForm/slip_seq"));
					
					if(slip_seq	==	1)	return;
					else		slip_seq--;
					
					model.setValue("/root/resData/resForm/slip_seq", lpad(""+slip_seq, 4, "0"));
					inp_slip_seq.refresh();
									
					//loadData();					
					]]>
				</script>
			</button>
			<caption id="caption15" class="list_cap03" style="left:0px; top:155px; width:105px; height:26px; ">사업장</caption>
		</group>
		<caption id="caption29" class="list_cap02" style="left:10px; top:250px; width:926px; height:26px; "/>
		<caption id="caption6" tyle="left:15px; top:180px; width:940px; height:0px;" style="left:0px; top:10px; width:0px; height:0px; ">caption6</caption>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<button id="btnQry" class="btn02" crud="R" style="left:463px; top:40px; width:52px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var slip_clsf_cd =  model.getValue("/root/resData/resForm/slip_clsf_cd");
				var slip_occr_dt =  model.getValue("/root/resData/resForm/slip_occr_dt");
				var slip_seq =  model.getValue("/root/resData/resForm/slip_seq");
				/**필수입력항목 체크 시작**/
				if(slip_clsf_cd == ""){
					alert("세금계산서(구분)를 입력하세요.");
					return;
				}
				if(slip_occr_dt == ""){
					alert("세금계산서(일자)를 입력하세요.");
					return;
				}
				if(slip_seq == ""){
					alert("세금계산서(순번)를 입력하세요.");
					return;
				}
				/**필수입력항목 체크 종료**/
				model.setValue("/root/reqData/fwdData/slip_clsf_cd2", slip_clsf_cd);
				model.setValue("/root/reqData/fwdData/slip_occr_dt2", slip_occr_dt);
				model.setValue("/root/reqData/fwdData/slip_seq2", slip_seq);
				
				model.send("is_sal_1130_s");
				
				var	_bgcolor	= "#FFFF99";
				for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
					var adjm_yn = datagrid1.valueMatrix(i, datagrid1.colRef("adjm_yn"));
					if(adjm_yn == "Y"){
						datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = true;
						datagrid1.rowstyle(i, "data", "background-color") = _bgcolor;
					}else{
						datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = false;
						datagrid1.rowstyle(i, "data", "background-color") = "#FFFFFF";
					}
				}
				model.refresh();				
				]]>
			</script>
		</button>
		<button id="btnIns" class="btn02" crud="C" style="left:521px; top:40px; width:52px; height:21px; ">
			<caption>입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var val = window.alert("입력하시겠습니까?", "확인", 1) ;
				// 1은 확인 2는 취소
				if ( val == 2 ){
					return;
				}
				/**필수 입력 항목체크 시작**/
				if(model.getValue("/root/resData/resForm/slip_clsf_cd") == ""){
					alert("*세금계산서번호(구분)를 입력하세요.");
					return;
				}
				if(model.getValue("/root/resData/resForm/slip_occr_dt") == ""){
					alert("*세금계산서번호(일자)를 입력하세요.");
					return;
				}
				if(model.getValue("/root/resData/resForm/dlco_clsf_cd_seq") == ""){
					alert("*거래처코드를 입력하세요.");
					return;
				}
				if(model.getValue("/root/resData/resForm/dlco_nm") == ""){
					alert("*거래처명을 입력하세요.");
					return;
				}
				if(model.getValue("/root/resData/resForm/make_dt") == ""){
					alert("*작성일자를 입력하세요.");
					return;
				}
				if(model.getValue("/root/resData/resForm/suply_amt") == ""){
					alert("*공급가액을 입력하세요.");
					return;
				}
				if(model.getValue("/root/resData/resForm/vat_amt") == ""){
					alert("*세액을 입력하세요.");
					return;
				}
				if(model.getValue("/root/resData/resForm/erplace_cd") == ""){
					alert("*사업장을 입력하세요.");
					return;
				}
				if(model.getValue("/root/resData/resForm/email_id") == ""){
					alert("*E-Mail을 입력하세요.");
					return;
				}
				if(model.getValue("/root/reqData/searchData/purc_frdt") == ""){
					alert("*배포기간(시작)을 입력하세요.");
					return;
				}
				if(model.getValue("/root/reqData/searchData/purc_todt") == ""){
					alert("*배포기간(종료)을 입력하세요.");
					return;
				}
				/**필수 입력 항목체크 종료**/
				
				model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");		
				model.setValue("/root/reqData/multiUpdateData1", datagrid1.getUpdateData());
				
				model.send("is_sal_1120_a");
										
				if( submit_completed() ){
					model.setValue("/root/reqData/fwdData/slip_clsf_cd2", model.getValue("/root/msgData/slip_clsf_cd"));
					model.setValue("/root/reqData/fwdData/slip_occr_dt2", model.getValue("/root/msgData/slip_occr_dt"));
					model.setValue("/root/reqData/fwdData/slip_seq2", model.getValue("/root/msgData/slip_seq"));
					
					model.send("is_sal_1130_s");
					
					var	_bgcolor	= "#FFFF99";
					for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
						var adjm_yn = datagrid1.valueMatrix(i, datagrid1.colRef("adjm_yn"));
						if(adjm_yn == "Y"){
							datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = true;
							datagrid1.rowstyle(i, "data", "background-color") = _bgcolor;
						}else{
							datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = false;
							datagrid1.rowstyle(i, "data", "background-color") = "#FFFFFF";
						}
					}
					model.refresh();	
				}
				]]>
			</script>
		</button>
		<button id="btnCancel" class="btn02" crud="D" style="left:577px; top:40px; width:50px; height:21px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				var canc_yn = model.getValue("/root/resData/resForm/canc_yn");
				if(canc_yn == "Y"){
					alert("이미 취소된 세금계산서입니다.");
					return;
				}
				var val = window.alert("취소하시겠습니까?", "확인", 1) ;
				// 1은 확인 2는 취소
				if ( val == 2 ){
					return;
				}
				
				model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");		
				model.setValue("/root/reqData/multiUpdateData1", datagrid1.getUpdateData());
				
				model.send("is_sal_1122_a");				
						
				if( submit_completed() ){
					model.setValue("/root/reqData/fwdData/slip_clsf_cd2", model.getValue("/root/msgData/slip_clsf_cd"));
					model.setValue("/root/reqData/fwdData/slip_occr_dt2", model.getValue("/root/msgData/slip_occr_dt"));
					model.setValue("/root/reqData/fwdData/slip_seq2", model.getValue("/root/msgData/slip_seq"));
					
					model.send("is_sal_1130_s");
				}				
				]]>
			</script>
		</button>
		<button id="btnInit" class="btn02" crud="R" style="left:635px; top:40px; width:50px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.reset();
				inp_dlco_clsf_cd_seq.disabled= false;
				inp_dlco_nm.disabled= false;
				
				/**데이터그리드 리셋**/	
				for(var i=datagrid1.rows; i>1; i--){ 
			 		model.destroy("/root/resData/gridData/record["+i+"]");
					datagrid1.removeRow(false);
			 	}
			 	addRow(datagrid1);
			 	datagrid1.clearStatus();
				]]>
			</script>
		</button>
		<button id="btnDlco" class="btn04" crud="R" style="left:693px; top:40px; width:89px; height:21px; ">
			<caption>공통거래처</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				regDlcoInfo();
				var if_dlco_no = model.property("IF_DLCO_NO");				
				
				if(if_dlco_no != ""){
					
					model.setValue("/root/resData/resForm/dlco_no", if_dlco_no);
					inp_dlco_no.refresh();	
									
					setTrustInfo();
					
				}
								
				]]>
			</script>
		</button>
		<caption id="caption28" class="list_cap02" style="left:10px; top:307px; width:926px; height:28px; "/>
		<button id="button4" class="btn03" style="left:869px; top:281px; width:67px; height:18px; ">
			<caption>일괄선택</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var _selected_all = false;
				
				_selected_all = !_selected_all;
				var tot_fee_amt = 0;	
				
				for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){						
					if(_selected_all){
						datagrid1.valueMatrix(i, datagrid1.colRef("checked"))	= "Y";	
						datagrid1.addStatus(i, "update");
					}else{
						datagrid1.valueMatrix(i, datagrid1.colRef("checked"))	= "N";
						datagrid1.removeStatus(i, "update");
					}
				}

				var tot_fee_amt = 0;
				
				for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
					var checked      = datagrid1.valueMatrix(i, datagrid1.colRef("checked"));
					var purc_amt     = Number(datagrid1.valueMatrix(i, datagrid1.colRef("purc_amt")));
					
					if(checked == "Y"){
						tot_fee_amt  += purc_amt;
					}
				}
				
				var tot_fee	= Math.floor(tot_fee_amt * 0.1); /**부가세**/
				
				model.setValue("/root/resData/resForm/vat_amt", tot_fee);
				model.setValue("/root/resData/resForm/suply_amt", tot_fee_amt);
				model.setValue("/root/resData/resForm/tot_amt", tot_fee+tot_fee_amt);
				inp_suply_amt.refresh();
				inp_vat_amt.refresh();
				inp_tot_amt.refresh();
				
				datagrid1.refresh();	
				]]>
			</script>
		</button>
		<button id="btnQry2" class="btn03" crud="R" style="left:794px; top:281px; width:67px; height:18px; ">
			<caption>배포조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[				
				var tot_isamt = 0;
				var tot_feeamt = 0;
				
				var dlco_clsf_cd_seq = model.getValue("/root/resData/resForm/dlco_clsf_cd_seq");
				if(dlco_clsf_cd_seq == ""){
					alert("거래처를 조회하세요.");
					return;
				}			
				
				if(!commReqCheck(srch_group)){
					return;
				}					

				model.setValue("/root/reqData/searchData/dlco_clsf_cd_seq", dlco_clsf_cd_seq);
				
				inp_dlco_clsf_cd_seq.disabled= true;
				inp_dlco_nm.disabled= true;
				
				model.send("is_sal_1110_l");
				
				var	_bgcolor	= "#FFFF99";
				for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
					var adjm_yn = datagrid1.valueMatrix(i, datagrid1.colRef("adjm_yn"));
					if(adjm_yn == "Y"){
						datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = true;
						datagrid1.rowstyle(i, "data", "background-color") = _bgcolor;
					}else{
						datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = false;
						datagrid1.rowstyle(i, "data", "background-color") = "#FFFFFF";
					}
				}
				model.refresh();	
				
				/*
				for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
					var purc_stmt_issu_yn = datagrid1.valueMatrix(i, datagrid1.colRef("purc_stmt_issu_yn"));
					if(purc_stmt_issu_yn == "Y"){
						datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = true;
						datagrid1.rowstyle(i, "data", "background-color") = _bgcolor;
						tot_isamt += Number(datagrid1.valueMatrix(i, datagrid1.colRef("fee")));
					}
					else{
						datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = false;
						datagrid1.rowstyle(i, "data", "background-color") = "#FFFFFF";
					}
					tot_feeamt += Number(datagrid1.valueMatrix(i, datagrid1.colRef("fee")));
				}
				
				//입수총액, 대행료 총액 Setting
				var isamt		=	Math.round(tot_isamt * (10/11));
				var isamt_vat 	=	Math.round(tot_isamt * (1/11));
				
				var feeamt		=	Math.round(tot_feeamt * (10/11));
				var feeamt_vat	=	Math.round(tot_feeamt * (1/11));				

				// 입수총액
				model.setValue("/root/resData/resForm/tot_suply_amt", isamt);
				model.setValue("/root/resData/resForm/tot_vat_amt", isamt_vat);
				input8.refresh();
				input9.refresh();
				
				// 대행료총액
				model.setValue("/root/resData/resForm/tot_fee", feeamt);
				model.setValue("/root/resData/resForm/tot_fee_vat", feeamt_vat);
				model.setValue("/root/resData/resForm/tot_fee_amt", tot_feeamt);
				out_tot_fee.refresh();
				out_tot_fee_vat.refresh();
				out_tot_fee_amt.refresh();
				*/
				]]>
			</script>
		</button>
		<caption id="caption30" class="list_cap01" style="left:10px; top:307px; width:105px; height:28px; ">배포기간</caption>
		<datagrid id="datagrid1" nodeset="/root/resData/resForm/gridData/record" caption="구분^승낙서번호^매입항목^배포일자^매입수량^매입단가^매입금액^비고^purc_reg_dt^purc_reg_seq^adjm_yn" colsep="#" colwidth="40, 90, 80, 80, 60, 80, 80, 100, 100, 100, 100" explorerbar="sort" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:10px; top:370px; width:926px; height:362px; ">
			<col checkvalue="Y,N" ref="checked" type="checkbox"/>
			<col ref="acwr_reg_dt_seq"/>
			<col ref="purc_clsf_nm" style="text-align:left; "/>
			<col ref="purc_dt" format="yyyy-mm-dd"/>
			<col ref="uprc" format="(-)#,###.99" style="text-align:right; "/>
			<col ref="qunt" format="#,###" style="text-align:right; "/>
			<col ref="purc_amt" format="#,###" style="text-align:right; "/>
			<col ref="remk" style="text-align:left; "/>
			<col ref="purc_reg_dt" visibility="hidden"/>
			<col ref="purc_reg_seq" visibility="hidden"/>
			<col ref="adjm_yn" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[							
				var row = datagrid1.row;										
				var tot_fee_amt = 0;
				
				for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
					var checked      = datagrid1.valueMatrix(i, datagrid1.colRef("checked"));
					var purc_amt     = Number(datagrid1.valueMatrix(i, datagrid1.colRef("purc_amt")));
					
					if(checked == "Y"){
						tot_fee_amt  += purc_amt;
					}
				}
				
				var tot_fee	= Math.floor(tot_fee_amt * 0.1); /**부가세**/
				
				model.setValue("/root/resData/resForm/vat_amt", tot_fee);
				model.setValue("/root/resData/resForm/suply_amt", tot_fee_amt);
				model.setValue("/root/resData/resForm/tot_amt", tot_fee+tot_fee_amt);
				inp_suply_amt.refresh();
				inp_vat_amt.refresh();
				inp_tot_amt.refresh();
												
				datagrid1.addStatus(row, "update");		
				datagrid1.refresh();				
				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[
				var row = datagrid1.row;
				var tot_fee_amt	= 0;
				
				for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
					var checked      = datagrid1.valueMatrix(i, datagrid1.colRef("checked"));
					var purc_amt     = Number(datagrid1.valueMatrix(i, datagrid1.colRef("purc_amt")));
					
					if(checked == "Y"){
						tot_fee_amt  += purc_amt;	
					}
				}
				
				var tot_fee	= Math.floor(tot_fee_amt * 0.1); /**부가세**/
				
				model.setValue("/root/resData/resForm/vat_amt", tot_fee);
				model.setValue("/root/resData/resForm/suply_amt", tot_fee_amt);
				model.setValue("/root/resData/resForm/tot_amt", tot_fee+tot_fee_amt);
				inp_suply_amt.refresh();
				inp_vat_amt.refresh();
				
				//datagrid1.removeStatus(row, "update");				
				datagrid1.rowstatus(row) = 0;

				datagrid1.refresh();
				]]>
			</script>
		</datagrid>
		<button id="btnClose" class="btn02" style="left:883px; top:40px; width:50px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if(window.type=="mdi"){
					viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
				}else{
					window.close();
				}
								
				]]>
			</script>
		</button>
		<button id="btnTax" class="btn04" disabled="true" visibility="hidden" crud="R" style="left:788px; top:40px; width:89px; height:21px; ">
			<caption>전자세금계산서</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				alert("세무로 매입세금계산서 조회화면 팝업연결");								
				]]>
			</script>
		</button>
		<group id="srch_group" style="left:116px; top:306px; width:284px; height:25px; ">
			<caption id="caption31" style="left:95px; top:3px; width:15px; height:17px; text-align:center; ">~</caption>
			<select1 id="cb_dt_clsf" ref="/root/reqData/searchData/dt_clsf" appearance="minimal" style="left:210px; top:5px; width:67px; height:20px; ">
				<choices>
					<item>
						<label>당일</label>
						<value>01</value>
					</item>
					<item>
						<label>당월</label>
						<value>02</value>
					</item>
					<item>
						<label>전월</label>
						<value>03</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[					
					var currentdt = getCurrentDate();
					var currentmt = getCurrentMonth();				
								
					var dt_clsf = model.getValue("/root/reqData/searchData/dt_clsf"); //선택한 콤보박스 값..
									
					if(dt_clsf == "01"){  
						var frdt = dateAdd("d", 0, currentdt);	//당일
						var todt = dateAdd("d",0, currentdt);	//당일
						
						model.setValue("/root/reqData/searchData/purc_frdt", frdt); 
						model.setValue("/root/reqData/searchData/purc_todt", todt); 
					}else if(dt_clsf == "02"){
						var frdt = currentdt.substring(0,6)+"01"; //당월의 1일부터
						var todt = dateAdd("d",0, currentdt);	//당월의 현재일 
						
						model.setValue("/root/reqData/searchData/purc_frdt", frdt); 
						model.setValue("/root/reqData/searchData/purc_todt", todt); 
					}else if(dt_clsf == "03") {
						var frdt = dateAdd("m", -1, currentmt+"01");
						var pre_month = frdt.substring(0,6);
						var todt = pre_month+commLastDay(pre_month); 	//전월의 말일 
						
						model.setValue("/root/reqData/searchData/purc_frdt", frdt); 
						model.setValue("/root/reqData/searchData/purc_todt", todt);
					}
					
					model.refresh();
					]]>
				</script>
			</select1>
			<input id="inp_purc_frdt" ref="/root/reqData/searchData/purc_frdt" class="req" navindex="11" inputtype="date" format="yyyy-mm-dd" caption="게재기간" style="left:5px; top:5px; width:85px; height:18px; "/>
			<input id="inp_purc_todt" ref="/root/reqData/searchData/purc_todt" class="req" navindex="12" inputtype="date" format="yyyy-mm-dd" caption="게재기간" style="left:115px; top:5px; width:90px; height:18px; "/>
		</group>
		<caption id="cpt_semuro_no" class="list_cap03" style="left:655px; top:250px; width:105px; height:26px; ">승인번호</caption>
		<caption id="cpt_electaxcompcd" class="list_cap03" style="left:326px; top:250px; width:150px; height:26px; ">전자세금계산서업체</caption>
		<caption id="cpt_email" class="list_cap03" style="left:10px; top:250px; width:105px; height:26px; ">E-Mail</caption>
		<input id="inp_semuro_no" ref="/root/resData/resForm/semuro_no" appearance="input" style="left:765px; top:254px; width:160px; height:18px; text-align:left; "/>
		<select1 id="cmb_elec_tax_comp_cd" ref="/root/resData/resForm/elec_tax_comp_cd" navindex="1" appearance="minimal" caption="매체구분" style="left:482px; top:254px; width:165px; height:18px; text-align:left; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/curlist2/record">
					<label ref="cdnm"/>
					<value ref="cd"/>
				</itemset>
			</choices>
		</select1>
		<select1 id="combo1" ref="/root/resData/resForm/erplace_cd" class="req" appearance="minimal" style="left:119px; top:223px; width:221px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/curlist4/record">
					<label ref="cdnm"/>
					<value ref="cd"/>
				</itemset>
			</choices>
		</select1>
		<input id="input11" ref="/root/resData/resForm/email_id" class="req" inputtype="button" style="left:119px; top:254px; width:196px; height:18px; text-align:left; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[				
				var dlco_clsf_cd_seq = model.getValue("/root/resData/resForm/dlco_clsf_cd_seq");
				var dlco_nm = model.getValue("/root/resData/resForm/dlco_nm");
				
				if(dlco_clsf_cd_seq == ""){
					alert("거래처를 입력하세요.");
					return;
				}else{
					model.makeNode("/root/reqData/fwdData/func_nm");
					model.makeNode("/root/reqData/fwdData/demand_dlco_no");	/**거래처코드**/
					model.makeNode("/root/reqData/fwdData/demand_dlco_nm");		/**거래처코드명**/
					model.setValue("/root/reqData/fwdData/func_nm", "setEmailInfo");//팝업에서 함수호출명 
					model.setValue("/root/reqData/fwdData/demand_dlco_no", dlco_clsf_cd_seq);	//팝업에서거래처코드 호출명 
					model.setValue("/root/reqData/fwdData/demand_dlco_nm", dlco_nm);				//팝업에서거래처코드 호출명 
								
					window.load("/xrw/is/com/IS_COM_1400.xrw"
								,"mdichild"
								, "is_com_1100"
								, "align:center; caption:hidden;width:645px; height:480px;"
								, "/root/reqData/fwdData"
								, "/root/reqData/fwdData");
				}
				]]>
			</script>
		</input>
		<caption id="caption5" class="list_cap01" style="left:445px; top:307px; width:105px; height:28px; ">광고명</caption>
		<caption id="caption32" class="list_cap02" style="left:10px; top:334px; width:926px; height:28px; "/>
		<caption id="caption33" class="list_cap01" style="left:10px; top:334px; width:105px; height:28px; ">팀</caption>
		<caption id="caption34" class="list_cap01" style="left:245px; top:334px; width:105px; height:28px; ">파트</caption>
		<caption id="caption21" class="list_cap01" style="left:635px; top:334px; width:105px; height:28px; ">담당자</caption>
		<input id="input1" ref="/root/reqData/searchData/advt_nm" appearance="input" style="left:555px; top:312px; width:370px; height:18px; text-align:left; "/>
		<select1 id="team_combo" ref="/root/reqData/searchData/dept_cd" appearance="minimal" style="left:120px; top:339px; width:120px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/teamlist/record">
					<label ref="dept_nm"/>
					<value ref="dept_cd"/>
				</itemset>
			</choices>
		</select1>
		<select1 id="part_combo" ref="/root/reqData/searchData/sub_dept_cd" appearance="minimal" style="left:355px; top:339px; width:120px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/partlist/record">
					<label ref="dept_nm"/>
					<value ref="dept_cd"/>
				</itemset>
			</choices>
		</select1>
		<input id="inp_chrg_pers" ref="/root/reqData/searchData/chrg_pers" inputtype="button" format="999999" style="left:745px; top:339px; width:70px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					model.makeNode("/root/reqData/fwdData/func_nm");
					model.setValue("/root/reqData/fwdData/func_nm", "setMenu_srch");//팝업에서 함수호출명 
					
					
					window.load("/xrw/hd/com/HD_COM_1000.xrw"
								,"mdichild"
								, "hd_com_1000"
								, "align:center; caption:hidden;width:460px; height:400px;"
								, "/root/reqData/fwdData"
								, "/root/reqData/fwdData");	
					]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				if (inp_chrg_pers.value.length == 6) {
					model.removeNodeset("/root/reqData/fwdData");  
					model.makeNode("/root/reqData/fwdData/emp_no");
					model.setValue("/root/reqData/fwdData/emp_no", inp_chrg_pers.value);
					model.send("hd_com_1002");
					
					if (model.getValue("/root/tempData/record/emp_no") != "") {
						inp_chrg_pers_nm.value = model.getValue("/root/tempData/record/nm_korn");
					}else {
						inp_chrg_pers.value = "";
						inp_chrg_pers_nm.value = "";
					}
				}else {
					inp_chrg_pers.value = "";
					inp_chrg_pers_nm.value = "";
				}						
				]]>
			</script>
		</input>
		<input id="inp_chrg_pers_nm" ref="/root/reqData/searchData/chrg_pers_nm" style="left:822px; top:339px; width:71px; height:18px; text-align:left; "/>
	</xhtml:body>
</xhtml:html>
