<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<pageInfo/>
						<comboSet>
							<unit>
								<item>
									<label/>
									<value/>
								</item>
							</unit>
							<temp>
								<item>
									<label/>
									<value/>
								</item>
							</temp>
						</comboSet>
						<gubun/>
					</initData>
					<resData>
						<gridData>
							<record>
							</record>
						</gridData>
						<resForm>
							<send_dt/>
							<make_pers/>
							<incmg_dt_tm/>
							<rept_matt/>
							<make_pers_nm/>
							<gubun/>
						</resForm>
						<gridData2>
							<record>
								<d_0/>
								<d_1/>
								<d_2/>
								<d_3/>
								<d_4/>
								<d_6/>
								<d_7/>
								<d_8/>
								<d_9/>
								<d_10/>
								<d_11/>
								<d_12/>
								<d_13/>
								<d_14/>
								<d_15/>
								<d_16/>
								<d_17/>
								<d_18/>
								<d_19/>
								<d_20/>
								<d_21/>
								<d_22/>
								<d_23/>
								<d_24/>
								<d_25/>
								<d_26/>
								<d_27/>
								<d_28/>
								<d_29/>
								<d_30/>
								<d_31/>
								<d_32/>
							</record>
						</gridData2>
						<gridData3>
							<x_list/>
							<y_list/>
							<a_list>
								<record/>
							</a_list>
							<ns_info>
								<record/>
							</ns_info>
						</gridData3>
					</resData>
					<reqData>
						<searchData>
							<issu_yymm/>
							<issu_dt/>
							<send_dt/>
							<pr_dt/>
							<f_pr_dt/>
							<send_clsf/>
							<medi_cd/>
						</searchData>
						<fwdData>
							<func_nm/>
						</fwdData>
						<reqForm>
							<multiUpData3/>
							<issu_dt/>
							<weth/>
							<ser_no/>
							<side1_atic/>
							<issu_pcnt/>
							<clr_pcnt/>
							<bk_pcnt/>
							<pcnt/>
							<gubun/>
							<multiUpData5/>
							<rept_matt/>
							<medi_cd/>
							<clos_clsf/>
							<multiUpData2/>
							<send_medi_cd/>
							<ecnt_clsf/>
						</reqForm>
					</reqData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
					function stripHTMLtag(string) {
						var objStrip = new RegExp();
						var retVal = "";
						//objStrip		= /[<head][^>]*[>]/gi;
						//objStrip		= /\\\\/gi
						//retVal = string.replace(objStrip, "");
						//objStrip		= /<style>.*.<\/style>]/gi;
						
						//retVal = string.replace(objStrip, "");
						objStrip		= /[<][^>]*[>]/gi;
						retVal = string.replace(objStrip, "");
						return retVal;
					}


					function InitPage(){
						var objWin = browser1.document.parentWindow;
						model.reset();
						model.setValue("/root/resData/resForm/gubun", "I");
						datagrid2.rows = 2;
						objWin.clearText();
					}
					
					function resetIssuSize(){
						datagrid1.allStyle("data", "background-color") = "#FFFFFF";
						
						for(var i=datagrid1.fixedRows; i<datagrid1.rows; i++){
							for(var j=datagrid1.fixedCols; j<datagrid1.cols+2; j++){
								if(j%3 == 0){
									datagrid1.cellstyle("background-color", i, j) = "#FFFFCC";
								}
								datagrid1.colWidth(j) = 30;
								if (j%3 ==2){
									if (datagrid1.valueMatrix(i,j) == "1"){
										//alert("...");
										datagrid1.cellstyle("background-color", i, (j -2)) = "#FF00FF";
									}
									//alert(datagrid1.valueMatrix(i,j));
								}
							}
						}
					}
					
					function InitGridData(){
						//model1.removenode("/root/resData/gridRef/col");
						//model1.destroy("/root/resData/gridRef/col");
						//model1.makeNode("/root/resData/gridRef/col");
						//alert(datagrid2.cols);
						if (datagrid2.cols > 1) {
							for(var i=0; i<datagrid2.cols + 2; i++){
								datagrid2.removeColumn();
								//.removeColumn();
							}
						}
						if (datagrid2.cols > 0) {
							for(var i=0; i<datagrid2.cols + 2; i++){
								datagrid2.removeColumn();
							}
						}
						if (datagrid2.cols > 0) {
							for(var i=0; i<datagrid2.cols + 2; i++){
								datagrid2.removeColumn();
							}
						}
						
						if (datagrid2.cols > 0) {
							for(var i=0; i<datagrid2.cols + 2; i++){
								datagrid2.removeColumn();
							}
						}
						
						model1.destroy("/root/resData/gridData2");
						model1.makeNode("/root/resData/gridData2");
						model1.makeNode("/root/resData/gridData2/record");
						//datagrid2.removeRow();
//						if (datagrid2.rows > 1){
//							for(var i = 0 ; i < datagrid2.rows + 1; i++){
//								datagrid2.removeRow();
//							}
//						}
						
//						if (datagrid2.rows > 1){
//							for(var i = 0 ; i < datagrid2.rows + 1; i++){
//								datagrid2.removeRow();
//							}
//						}
						datagrid2.caption = "";
						datagrid2.refresh();
					}
					
					function progressBarStart_send() {
					    var windowWidth = window.width; 
					    var windowHeight = window.height; 
					
					    var leftpos = windowWidth / 2 - 100;
					    var toppos = windowHeight / 2 - 150;
					    toppos = toppos + 100;
					    var flashUrl = model.property("ss_domainnm")+"/images/progress.swf";
					    body.createChild("xforms:object", "id:bar; clsid:{d27cdb6e-ae6d-11cf-96b8-444553540000}; Movie:"+ flashUrl +"; WMode:transparent; left:"+leftpos+"; top:"+toppos+";  width:150; height:150; "); 
					    //body.createChild("xforms:img", "id:bar; src:/images/error_08.gif; left:"+leftpos+"; top:"+toppos+";  width:"+width+"; height:"+height+"; background-stretch:stretch; "); 
					}
					
					
					 /**
					 * @function    : progressBarEnd()
					 * @access      : public
					 * @description : progressBarEnd
					 * @sig         : 
					 * @param       : 
					 * @return      : 
					 */
					function progressBarEnd_send()
					{
					    if(document.controls("bar") == null) return;
					    body.removeChild("bar");
					}
										
					function makeGridData_bak(){
						//alert(datagrid2.cols);
						var nodeList_x = instance1.selectNodes("/root/resData/gridData3/x_list/ecnt");
						var nodeList_a = instance1.selectNodes("/root/resData/gridData3/a_list/record");
						var nodeList_y = instance1.selectNodes("/root/resData/gridData3/y_list/record");
						var nodeList_d = instance1.selectNodes("/root/resData/gridData3/x_list_cnt/cnt");
						var nodeList_bs = instance1.selectNodes("/root/resData/gridData3/bs_info/record");
						
						var x_count	= model.getValue("/root/resData/gridData3/x_list_cnt/cnt");
						var rowCount	= 0;
						var colCount 	= 0;
						var medi_clsf 	= "";
						var hVal	= "";
						
						if (nodeList_a.length == 0){
							return;
						}
						datagrid2.addColumn("ref:remk; ");
						datagrid2.caption = "구분";
						datagrid2.colWidth(0) = 80;
						datagrid2.addColumn("ref:d_1; visibility:hidden; ");
						datagrid2.caption += "^공장";
						datagrid2.colWidth(1) = 80;
						//datagrid2.colHidden(1) = true;
						datagrid2.addColumn("ref:d_2; type:input;");
						datagrid2.caption += "^당직자";
						datagrid2.colWidth(2) = 60;
						var header_1 = datagrid2.caption;
						var colCount = 3;

						//alert("nodeList_x=" + nodeList_x.length);
						for (var i=0; i<nodeList_x.length; i++){
							
							var refNode = "";
							var subNode = nodeList_x.item(i).value;
							if (hVal == ""){
								hVal = subNode;
							} else {
								hVal += "^" + subNode;
							}
							refNode = "d_" + (i + 3);
							if (i % 4 == 3){
								//alert(refNode);
								datagrid2.addColumn("ref:" + refNode + "; visibility:hidden;");
							} else {
								datagrid2.addColumn("ref:" + refNode + "; format:hh:nn; type:input; ");
							}
							//datagrid2.colWidth(i) = 60;
						}
						
						
						for (var i=0; i<nodeList_y.length; i++){
							var check_val = false;
							var nodeList_ns = instance1.selectNodes("/root/resData/gridData3/ns_info/record");
							var fac = nodeList_y.item(i).getElementsByTagName("cd").item(0).value;
							//alert("fac=" + fac + "\nnodeList_ns.length=" + nodeList_ns.length);
							for (var ii=0; ii<nodeList_ns.length; ii++){
								if (fac == nodeList_ns.item(ii).getElementsByTagName("fac_clsf").item(0).value){
									check_val = true;
								}
							}
							if (nodeList_ns.length == 0){
								model.makeNode("/root/resData/gridData3/ns_info/record[1]/fac_clsf");
								model.makeNode("/root/resData/gridData3/ns_info/record[1]/chrg_pers");
								model.makeNode("/root/resData/gridData3/ns_info/record[1]/fst_route");
								model.makeNode("/root/resData/gridData3/ns_info/record[1]/fst_route_tm");
								model.makeNode("/root/resData/gridData3/ns_info/record[1]/last_route");
								model.makeNode("/root/resData/gridData3/ns_info/record[1]/last_route_tm");
								model.setValue("/root/resData/gridData3/ns_info/record[1]/fac_clsf", fac);
							} else {
								if (!check_val){
									model.makeNode("/root/resData/gridData3/ns_info/record[" + (nodeList_ns.length + 1) + "]/fac_clsf");
									model.makeNode("/root/resData/gridData3/ns_info/record[" + (nodeList_ns.length + 1) + "]/chrg_pers");
									model.makeNode("/root/resData/gridData3/ns_info/record[" + (nodeList_ns.length + 1) + "]/fst_route");
									model.makeNode("/root/resData/gridData3/ns_info/record[" + (nodeList_ns.length + 1) + "]/fst_route_tm");
									model.makeNode("/root/resData/gridData3/ns_info/record[" + (nodeList_ns.length + 1) + "]/last_route");
									model.makeNode("/root/resData/gridData3/ns_info/record[" + (nodeList_ns.length + 1) + "]/last_route_tm");
									model.setValue("/root/resData/gridData3/ns_info/record[" + (nodeList_ns.length + 1) + "]/fac_clsf", fac);
								}
							}
						}
						
						for (var i=0; i<nodeList_bs.length; i++){
							var fst_route_tm = nodeList_bs.item(i).getElementsByTagName("jbbalcha").item(0).value;
							var fst_route = nodeList_bs.item(i).getElementsByTagName("jbbalcha_jbcode").item(0).value;
							var last_route_tm = nodeList_bs.item(i).getElementsByTagName("jbdotime").item(0).value;
							var last_route = nodeList_bs.item(i).getElementsByTagName("jbdotime_jbcode").item(0).value;
							var fac = nodeList_bs.item(i).getElementsByTagName("jbincode").item(0).value;
							var nodeList_ns = instance1.selectNodes("/root/resData/gridData3/ns_info/record");
							
							for (var ii=0; ii<nodeList_ns.length; ii++){
								if (fac == nodeList_ns.item(ii).getElementsByTagName("fac_clsf").item(0).value){
									model.setValue("/root/resData/gridData3/ns_info/record[" + (ii + 1) + "]/fst_route", fst_route);
									model.setValue("/root/resData/gridData3/ns_info/record[" + (ii + 1) + "]/fst_route_tm", fst_route_tm);
									model.setValue("/root/resData/gridData3/ns_info/record[" + (ii + 1) + "]/last_route", last_route);
									model.setValue("/root/resData/gridData3/ns_info/record[" + (ii + 1) + "]/last_route_tm", last_route_tm);
								}
							}
						}
						hVal += "^발송현황^발송현황^발송현황^발송현황";
						var nextCount = (eval(x_count) * 4) + 3;
						//alert(x_count);
						datagrid2.addColumn("ref:d_" + nextCount + "; type:input");
						datagrid2.addColumn("ref:d_" + (nextCount + 1) + "; format:hh:nn; type:input");
						datagrid2.addColumn("ref:d_" + (nextCount + 2) + "; type:input");
						datagrid2.addColumn("ref:d_" + (nextCount + 3) + "; format:hh:nn; type:input");
						
						//datagrid2.addColumn("ref:d_2; ");
						//datagrid2.caption += "^당직자";
						//datagrid2.colWidth(2) = 60;
						//발송현황 정보가 여기에 나와야 한다.
						
						var col_cnt = (nodeList_x.length / 4);
						var mid_header = "";
						for (var i=0; i< col_cnt; i++){
							if (i==0){
								mid_header = "전송^시쇄^종쇄^판수";
							} else {
								mid_header += "^전송^시쇄^종쇄^판수";
							}
						}
						mid_header += "^첫출발노선^첫출발노선^최종노선^최종노선";
						var total_header = header_1 + "^" + hVal + "|" + header_1 + "^" + mid_header;
						datagrid2.caption = total_header;
						
						model.copyNode("/root/resData/gridData2", "/root/resData/gridData3/d_data");
						
						
						
						for(var i=0; i<datagrid2.cols; i++){
							if (i==0){
								datagrid2.colWidth(i) = 80;
							} else {
								datagrid2.colWidth(i) = 60;
							}
						}
						
						for (var i=0; i<nodeList_a.length; i++){
							if (!(nodeList_a.item(i).getElementsByTagName("prt_bgn_tm").item(0).value == "" && nodeList_a.item(i).getElementsByTagName("prt_end_tm").item(0).value == "" && nodeList_a.item(i).getElementsByTagName("off_plat_tm").item(0).value == "")){
								datagrid3.rowStatus(i+1) = 1;
							}
						}
						datagrid2.refresh();
						//alert(datagrid2.caption);
					}
					]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				//오늘 날짜 불러오기
				input1.value = commCurDate("ym");
				//input1.value = "200905";
				model.setValue("/root/reqData/searchData/medi_cd", "110");
				combo1.refresh();
				//var emp_no = getProperty("ss_emp_no");
				//var emp_nm = getProperty("ss_emp_nm");
				/*
				model.setValue("/root/resData/resForm/make_pers", emp_no);
				model.setValue("/root/resData/resForm/make_pers_nm", emp_nm);
				
				model1.setValue("/root/reqData/searchData/send_dt",commCurDate());
				model1.send("pr_sendmg_1020");
				
				model1.copyNode("/root/resData/gridData2","/root/tempData/gridData2");
				
				datagrid2.refresh();
				
				for(i=1; i<datagrid2.rows;i++){
					datagrid2.rowStatus(i) = 1;
				
				}
				model1.refresh();
				*/
			]]>
			</script>
			<submission id="pr_sendmg_1010" action="/mt/sendmg/1010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="pr_sendmg_1020" action="/mt/sendmg/1020" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData2/record"/>
			<submission id="pr_sendmg_1021" action="/mt/sendmg/1021" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData3"/>
			<submission id="pr_sendmg_1030" action="/mt/sendmg/1030" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpData" resultref="/root/tempData"/>
			<submission id="pr_sendmg_1040" action="/mt/sendmg/1040" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="pr_sendmg_1050" action="/mt/sendmg/1050" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="pr_sendmg_1001" action="/mt/sendmg/1001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="pr_sendmg_1002" action="/mt/sendmg/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData3"/>
			<submission id="pr_sendmg_1000" action="/mt/sendmg/1000" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData2/record"/>
		</model>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/TFCommon.js"/>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728">
		<group id="group6" class="gro_sel" style="left:10px; top:116px; width:425px; height:244px; ">
			<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" class="nobg" caption="일^일^일^월^월^월^화^화^화^수^수^수^목^목^목^금^금^금^토^토^토^토" colsep="^" colwidth="32, 32, 10, 32, 35, 10, 32, 32, 10, 32, 32, 10, 32, 32, 10, 32, 32, 10, 32, 32, 10" dataheight="30" defaultrows="6" mergecellsfixedcols="byrowrec" mergecellsfixedrows="bycolrec" rowheight="30" rowsep="|" selectionmode="free" style="left:0px; top:0px; width:425px; height:212px; ">
				<col ref="sun"/>
				<col ref="sun_cnt" style="text-align:center; "/>
				<col ref="sun_dt" visibility="hidden"/>
				<col ref="mon"/>
				<col ref="mon_cnt" style="text-align:center; "/>
				<col ref="mon_dt" visibility="hidden"/>
				<col ref="tue"/>
				<col ref="tue_cnt" style="text-align:center; "/>
				<col ref="tue_dt" visibility="hidden"/>
				<col ref="wed"/>
				<col ref="wed_cnt" style="text-align:center; "/>
				<col ref="wed_dt" visibility="hidden"/>
				<col ref="thr"/>
				<col ref="thr_cnt" style="text-align:center; "/>
				<col ref="thr_dt" visibility="hidden"/>
				<col ref="fri"/>
				<col ref="fri_cnt" style="text-align:center; "/>
				<col ref="fri_dt" visibility="hidden"/>
				<col ref="sat"/>
				<col ref="sat_cnt" style="text-align:center; "/>
				<col ref="sat_dt" visibility="hidden"/>
				<script type="javascript" ev:event="ondblclick">
					<![CDATA[	
					datagrid2.row = 2;			
					var objWin = browser1.document.parentWindow;
					var row = datagrid1.mouseRow;
					var col = datagrid1.mouseCol;
					var cont	= "";
					
					var cnt_col = 0;
					if(col%3 == 1) cnt_col = col + 1;
					else cnt_col = col + 2;
					
					if(col%3 == 1) col = col-1;
					
					var temp_dt  = datagrid1.valueMatrix(row, col);
					var exist_yn  = datagrid1.valueMatrix(row, cnt_col);
					
					if(temp_dt != '0' && temp_dt < 10) temp_dt = "0" + temp_dt;
					
					var issu_dt = model.getValue("/root/reqData/searchData/issu_yymm") + temp_dt;
					//alert(issu_dt);
					model.setValue("/root/reqData/searchData/issu_dt", issu_dt);
					
					model.removenode("/root/resData/gridData3/a_list");
					model.makeNode("/root/resData/gridData3/a_list");
					model.makeNode("/root/resData/gridData3/a_list/record");
					datagrid3.refresh();
					
					model.removenode("/root/resData/gridData3/ns_info");
					model.makeNode("/root/resData/gridData3/ns_info");
					model.makeNode("/root/resData/gridData3/ns_info/record");
					datagrid5.refresh();
					
					model.send("pr_sendmg_1000", true);
					model.send("pr_sendmg_1002");

					model.setValue("/root/reqData/reqForm/issu_dt", issu_dt);
					model.setValue("/root/reqData/reqForm/medi_cd", model.getValue("/root/reqData/searchData/medi_cd"));
					model.setValue("/root/reqData/reqForm/weth", model.getValue("/root/resData/gridData3/send_info/record/weth"));
					model.setValue("/root/reqData/reqForm/ser_no", model.getValue("/root/resData/gridData3/send_info/record/ser_no"));
					model.setValue("/root/reqData/reqForm/side1_atic", model.getValue("/root/resData/gridData3/send_info/record/side1_atic"));
					model.setValue("/root/reqData/reqForm/issu_pcnt", model.getValue("/root/resData/gridData3/send_info/record/issu_pcnt"));
					model.setValue("/root/reqData/reqForm/rept_matt", model.getValue("/root/resData/gridData3/send_info/record/rept_matt"));
					model.setValue("/root/reqData/reqForm/pcnt", model.getValue("/root/resData/gridData3/send_info/record/clr_pcnt") + "/" + model.getValue("/root/resData/gridData3/send_info/record/bk_pcnt"));
					
					model.setValue("/root/reqData/reqForm/clos_clsf", model.getValue("/root/resData/gridData3/clos_clsf/val"));
					model.setValue("/root/reqData/reqForm/ecnt_clsf", model.getValue("/root/resData/gridData3/ecnt_clsf/val"));
					
					// 조회를 했으니깐 수정모드이지만, 등록하기 위해서는 반드시 조회를 해야하기 때문에...
					if (exist_yn == "1" ){
						model.setValue("/root/resData/resForm/gubun", "U");
					} else {
						model.setValue("/root/resData/resForm/gubun", "I");
					}
					datagrid2.allStyle("data", "background-color") = "#FFFFFF";
					
					for (var i=0; i<datagrid2.cols - 4; i++){
						if ((i + 3) % 5==1){
							datagrid2.colStyle(i, "data", "background-color") = "#339966";
						}
					}

					//#00ff00
					input5.refresh();
					input6.refresh();
					input7.refresh();
					input8.refresh();
					input3.refresh();
					input2.refresh();
					
					objWin.clearText();
					cont	= model.getValue("/root/reqData/reqForm/rept_matt");
					
					cont = cont.replace(/&gt;/gi, '>');
					cont = cont.replace(/&lt;/gi, '<');
					cont	= cont.replace(/&nbsp;/gi, ' ');
					
					objWin.putText(cont);
					
					group2.refresh();
					//group5.refresh();
					
					//datagrid3.refresh();
					//datagrid5.refresh();
				]]>
				</script>
			</datagrid>
		</group>
		<group id="group3" style="left:10px; top:45px; width:925px; height:21px; ">
			<button id="button3" class="btn02" style="left:725px; top:0px; width:50px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="DOMActivate">
					<![CDATA[
					InitPage();
					]]>
				</script>
			</button>
			<button id="button4" class="btn02" style="left:875px; top:0px; width:50px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					      viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					     ]]>
				</script>
			</button>
			<button id="button5" class="btn02" style="left:615px; top:0px; width:50px; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var issu_yymm = model.getValue("/root/reqData/searchData/issu_yymm");
					var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");
					
					if (model.getValue("/root/resData/resForm/gubun") == "U"){
						alert("현재 상태는 수정만 가능합니다.");
						return;
					}
					
       				if ((commReqCheck(group2))) {
       					if(model1.getValue("/root/reqData/reqForm/issu_dt")==""){
       						alert("일자를 입력하여 주세요");
       						return;
       					}
       					var  objWin = browser1.document.parentWindow;
						model.setValue("/root/reqData/reqForm/rept_matt", objWin.getText());
       					var cont = model.getValue("/root/reqData/reqForm/rept_matt");
       					//alert(cont);
       					cont = stripHTMLtag(cont);
       					//alert(cont);
       					//return;

						if(cont == ""){
							alert("보고사항을 등록해주십시오.");
							return;
						}
						if (window.alert("입력하시겠습니까?", "확인", 1) == 1) {
							
							model1.setValue("/root/reqData/reqForm/gubun","I");
							model1.setValue("/root/reqData/reqForm/multiUpData2", datagrid2.getUpdateData());
							//model1.setValue("/root/reqData/reqForm/multiUpData5", datagrid5.getUpdateData());
							
							model1.send("pr_sendmg_1010");
							
							/*
							if(datagrid2.rows!=1){
								for(i=0; i<datagrid2.rows-1;i++){
									var fac_clsf=datagrid2.valueMatrix(i+1,2).substr(0,2);
									model1.setValue("/root/resData/gridData2/record["+(i+1)+"]/prt_plac_clsf",fac_clsf);
								}
								
		      					model1.setValue("/root/reqData/multiUpData", datagrid2.getUpdateData());
		      					      
								model1.send("pr_sendmg_1030");   
							}
							*/
							if(submit_completed()) {
								//InitGridData();
								model1.reset();
								model.setValue("/root/reqData/searchData/issu_yymm", issu_yymm);
								model.setValue("/root/reqData/searchData/medi_cd", medi_cd);
								
								model1.send("pr_sendmg_1001");
								model1.copyNode("/root/resData/gridData","/root/tempData/gridData");
								datagrid1.refresh();
								resetIssuSize();
							}
						}
					}
				]]>
				</script>
			</button>
			<button id="button7" class="btn02" style="left:560px; top:0px; width:50px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var issu_yymm		= model1.getValue("/root/reqData/searchData/issu_yymm");
					if(issu_yymm == ""){
						alert("발행년월을 입력하세요");
						return;
					}
					
					model1.send("pr_sendmg_1001");
					model1.copyNode("/root/resData/gridData","/root/tempData/gridData");
					model1.setValue("/root/reqData/reqForm/send_medi_cd", model1.getValue("/root/tempData/send_medi_cd"));
					
					datagrid1.refresh();
					resetIssuSize();
					datagrid2.row = 1;
					
					]]>
				</script>
			</button>
			<button id="button1" class="btn02" style="left:670px; top:0px; width:50px; height:21px; ">
				<caption>수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var issu_yymm = model.getValue("/root/reqData/searchData/issu_yymm");
					var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");
					
					if (model.getValue("/root/resData/resForm/gubun") == "I"){
						alert("현재 상태는 입력만 가능합니다.");
						return;
					}
					
					if (model.getValue("/root/reqData/reqForm/clos_clsf") == "02"){
						alert("이미 제작일지에서 마감을 처리한 공장이 있기 때문에 수정할 수 없습니다.");
						return;
					}
					
					if ((commReqCheck(group2))) {
						if(model1.getValue("/root/reqData/reqForm/issu_dt")==""){
       						alert("일자를 입력하여 주세요");
       						return;
       					}
       					var  objWin = browser1.document.parentWindow;
						model.setValue("/root/reqData/reqForm/rept_matt", objWin.getText());
       					var cont = model.getValue("/root/reqData/reqForm/rept_matt");

						if(cont == ""){
							alert("보고사항을 등록해주십시오.");
							return;
						}
						if (window.alert("수정하시겠습니까?", "확인", 1) == 1) {
							model1.setValue("/root/reqData/reqForm/gubun","U");

							model1.setValue("/root/reqData/reqForm/multiUpData2", datagrid2.getUpdateData());
							//model1.setValue("/root/reqData/reqForm/multiUpData5", datagrid5.getUpdateData());
							model1.send("pr_sendmg_1010");
							
							if(submit_completed()) {
								
								model1.reset();
								model.setValue("/root/reqData/searchData/issu_yymm", issu_yymm);
								model.setValue("/root/reqData/searchData/medi_cd", medi_cd);
								
								model1.send("pr_sendmg_1001");
								model1.copyNode("/root/resData/gridData","/root/tempData/gridData");
								datagrid1.refresh();
								resetIssuSize();
						     }
						}
					}
				]]>
				</script>
			</button>
			<!--
			<button id="button2" class="btn02" style="left:533px; top:0px; width:50px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if (model.getValue("/root/resData/resForm/gubun") == "I"){
						alert("현재 상태에서는 삭제가 불가능합니다.");
						return;
					}
					if (model.getValue("/root/reqData/reqForm/clos_clsf") == "02"){
						alert("이미 제작일지에서 마감을 처리한 공장이 있기 때문에 수정할 수 없습니다.");
						return;
					}
					if (window.alert("삭제하시겠습니까?", "확인", 1) == 1) {
						model1.makeNode("/root/resData/resForm/gubun");
						model1.setValue("/root/resData/resForm/gubun","D");
						
						model1.send("pr_sendmg_1010");
          
						if(submit_completed()) {
					            	model1.reset();
					       	}
					}
				]]>
				</script>
			</button>
			-->
			<button id="button6" class="btn04" style="left:780px; top:0px; width:90px; height:21px; ">
				<caption>발송정보 생성</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if (window.alert("발송정보를 조회해서 생성하시겠습니까?", "확인", 1) == 1) {
						
						var pr_dt = model.getValue("/root/reqData/searchData/issu_dt");
						if (pr_dt == ""){
							alert("발송조회할 날짜를 선택해주십시오.");
							return;
						}
						
						if (model.getValue("/root/reqData/reqForm/ecnt_clsf") == "N"){
							alert(pr_dt.substr(0,4) +"년 " + pr_dt.substr(4,2) +"월 " + pr_dt.substr(6,2) +"일에 대한 판매 판수정보가 없습니다. 발송정보를 조회할 수 없습니다.");
							return;
						}
						
						/*	발송관제시스템를 호출해서 분공장 데이터 추출요청 이벤트 발생*/
						
						//progressBarStart_send();
						//alert(pr_dt);
						//var rtn = object1.BtnSendMsg(pr_dt,"220.73.135.81", "12501");
						var rtn = object1.BtnSendMsg(pr_dt,"220.73.135.220", "12501");

						if( rtn == 'SUCC'){
						}else {
							if (rtn.substring(0,1) == "E"){
								if (window.alert(rtn + "입니다. 계속하시겠습니까?", "확인", 1) != 1) {
									return;
								}
							} else {
								alert( rtn );
								//progressBarEnd_send();
								return;
							}
						}
						//progressBarEnd_send();
						
						
						model.setValue("/root/reqData/searchData/pr_dt", pr_dt.substring(2, 8));
						model1.send("pr_sendmg_1040");
						
						if(submit_completed()) {
							model.setValue("/root/reqData/searchData/pr_dt", pr_dt);
							model1.send("pr_sendmg_1050");
							
							if(submit_completed()) {
								
								model.send("pr_sendmg_1020");
								
								if(submit_completed()) {
									datagrid2.refresh();
									datagrid2.allStyle("data", "background-color") = "#FFFFFF";
									for (var i=2; i<datagrid2.rows; i++ ){
										datagrid2.rowStatus(i) = 1;
									}
								}
							}
				       	}
					}
					
					
					
					
					
					
					/*
					group4.visible = true;
					button9.text= "발송정보 생성";
					model.setValue("/root/reqData/searchData/f_pr_dt", model.getValue("/root/reqData/searchData/issu_dt"));
					input4.refresh();
					model.setValue("/root/reqData/searchData/send_clsf", "01");
					*/
				]]>
				</script>
			</button>
			<!--
			<button id="button8" class="btn04" style="left:783px; top:0px; width:86px; height:21px; ">
				<caption>발송 조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					//	등록하기위해서 발송을 조회한다.
					if (model.getValue("/root/resData/resForm/gubun") == "U"){
						alert("기존에 등록한 발송내역정보가 존재합니다.");
						return;
					} else {
						model.setValue("/root/resData/resForm/gubun", "I");
					}
					
					model.send("pr_sendmg_1020");
					datagrid2.refresh();
					
					var nodeList_a = instance1.selectNodes("/root/resData/gridData3/a_list/record");
					
					var ecnt_col 	= 0;
					var cur_row	= 0;
					var col_length = datagrid2.cols;
					for (var i=2; i<datagrid2.rows; i++ ){
						datagrid2.rowStatus(i) = 1;
					}
					
					group5.refresh();
					datagrid3.refresh();
					datagrid5.refresh();
				]]>
				</script>
			</button>
			-->
		</group>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group7" style="left:10px; top:75px; width:925px; height:35px; ">
			<caption id="caption42" class="list_cap02" style="left:99px; top:0px; width:826px; height:24px; text-align:center; "/>
			<caption id="caption37" class="list_cap01" style="left:0px; top:0px; width:100px; height:24px; text-align:center; ">발행년월</caption>
			<input id="input1" ref="/root/reqData/searchData/issu_yymm" navindex="1" format="yyyy-mm" style="left:105px; top:3px; width:90px; height:18px; background-color:#ffffcc; "/>
			<caption id="caption3" class="list_cap01" style="left:445px; top:0px; width:100px; height:24px; text-align:center; ">매체</caption>
			<select1 id="combo1" ref="/root/reqData/searchData/medi_cd" appearance="minimal" style="left:550px; top:3px; width:100px; height:18px; ">
				<choices>
					<item>
						<label>110 본지</label>
						<value>110</value>
					</item>
					<item>
						<label>130 소년</label>
						<value>130</value>
					</item>
				</choices>
			</select1>
		</group>
		<group id="group2" class="gro_sel" style="left:442px; top:116px; width:493px; height:251px; ">
			<!--220.73.135.220:7777
			<textarea id="textarea1" ref="/root/resData/resForm/rept_matt" style="left:0px; top:25px; width:490px; height:183px; vertical-align:top; "/>
			-->
			<browser id="browser1" src="http://eip.chosun.com/crm_editor.jsp" style="left:0px; top:24px; width:493px; height:226px; padding:0; "/>
			<caption id="caption1" class="list_cap01" style="left:0px; top:0px; width:493px; height:24px; text-align:center; ">보고사항</caption>
		</group>
		<group id="group5" style="left:10px; top:375px; width:925px; height:350px; ">
			<datagrid id="datagrid2" nodeset="/root/resData/gridData2/record" caption="구분^공장^담당자^10판^10판^10판^11판^11판^11판^12판^50판^발송현황^발송현황^발송현황" colsep="#" colwidth="60, 60, 64, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60" datatype="delimeter" mergecellsfixedrows="bycolrec" rowsep="|" selectionmode="free" style="left:0px; top:55px; width:925px; height:245px; ">
				<col ref="d_0"/>
				<col ref="d_1"/>
				<col/>
				<col ref="d_2"/>
				<col ref="d_3"/>
				<col ref="d_4"/>
				<col ref="d_5"/>
				<col ref="d_6"/>
				<col ref="d_7"/>
				<col ref="d_8"/>
				<col ref="d_9"/>
				<col ref="d_14"/>
				<col ref="d_15"/>
				<col ref="d_16"/>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var col = datagrid2.col;
					var row = datagrid2.row;
					var col_length = datagrid2.cols;
					var bgn_tm = "";
					var end_tm = "";
					var check_val	= false;
					
					if (col_length - 4 > col){
						if ((col - 4) % 5 == 0){
							bgn_tm = datagrid2.valueMatrix(row, col);
							end_tm = datagrid2.valueMatrix(row, col + 1);
							if (end_tm == ""){
								check_val = true;
							} else {
								if (bgn_tm >= end_tm){
									if (bgn_tm.substring(0,1) != "0" && end_tm.substring(0,1) == "0"){
										check_val = true;
									} else {
										check_val = false;
									}
								} else {
									check_val = true;
								}
							}
							if (!check_val){
								alert("시쇄시간이 종쇄시간보다 같거나 클 수 없습니다.");
								datagrid2.col = col -1;
								datagrid2.row = row;
								return;
							}
						}
						
						if ((col - 4) % 5 == 1){
							bgn_tm = datagrid2.valueMatrix(row, col -1);
							end_tm = datagrid2.valueMatrix(row, col);
							
							if (bgn_tm == ""){
								check_val = true;
							} else {
								if (bgn_tm >= end_tm){
									if (bgn_tm.substring(0,1) != "0" && end_tm.substring(0,1) == "0"){
										check_val = true;
									} else {
										check_val = false;
									}
								} else {
									check_val = true;
								}
							}
							if (!check_val){
								alert("시쇄시간이 종쇄시간보다 같거나 클 수 없습니다.");
								datagrid2.col = col -1;
								datagrid2.row = row;
								return;
							}
						}
					}
					]]>
				</script>
			</datagrid>
			<caption id="caption9" class="list_cap02" style="left:79px; top:0px; width:846px; height:24px; text-align:center; "/>
			<caption id="caption4" class="list_cap01" style="left:380px; top:0px; width:80px; height:24px; text-align:center; ">지령</caption>
			<input id="input3" ref="/root/reqData/reqForm/ser_no" style="left:465px; top:3px; width:100px; height:18px; text-align:left; "/>
			<input id="input5" ref="/root/reqData/reqForm/issu_dt" inputtype="date" format="yyyy-mm-dd" style="left:85px; top:3px; width:95px; height:18px; text-align:left; "/>
			<caption id="caption8" class="list_cap01" style="left:189px; top:0px; width:80px; height:24px; text-align:center; ">날씨</caption>
			<input id="input6" ref="/root/reqData/reqForm/weth" style="left:275px; top:3px; width:100px; height:18px; text-align:left; "/>
			<caption id="caption10" class="list_cap01" style="left:0px; top:0px; width:80px; height:24px; text-align:center; ">발행일자</caption>
			<caption id="caption11" class="list_cap01" style="left:0px; top:23px; width:80px; height:24px; text-align:center; ">1면 TOP</caption>
			<caption id="caption12" class="list_cap02" style="left:79px; top:23px; width:846px; height:24px; text-align:center; "/>
			<caption id="caption2" class="list_cap01" style="left:570px; top:0px; width:80px; height:24px; text-align:center; ">면수</caption>
			<caption id="caption7" class="list_cap01" style="left:745px; top:0px; width:82px; height:24px; text-align:center; ">칼라/흑백</caption>
			<input id="input2" ref="/root/reqData/reqForm/issu_pcnt" style="left:655px; top:3px; width:80px; height:18px; "/>
			<input id="input7" ref="/root/reqData/reqForm/pcnt" style="left:830px; top:3px; width:90px; height:18px; "/>
			<input id="input8" ref="/root/reqData/reqForm/side1_atic" style="left:85px; top:26px; width:480px; height:18px; text-align:left; "/>
			<datagrid id="datagrid3" nodeset="/root/resData/gridData3/a_list/record" visibility="hidden" caption="매체^공장^판수^시쇄^종쇄^전송" colsep="#" colwidth="50, 50, 50, 50, 50, 50" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:35px; top:220px; width:350px; height:130px; ">
				<col ref="medi_cd"/>
				<col ref="prt_plac_clsf"/>
				<col ref="ecnt"/>
				<col ref="prt_bgn_tm"/>
				<col ref="prt_end_tm"/>
				<col ref="off_plat_tm"/>
			</datagrid>
			<datagrid id="datagrid5" nodeset="/root/resData/gridData3/ns_info/record" visibility="hidden" caption="공장^담당자^최초노선^최초시각^최종노선^최종시각" colsep="#" colwidth="50, 50, 57, 66, 60, 60" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:535px; top:225px; width:370px; height:125px; ">
				<col ref="fac_clsf"/>
				<col ref="chrg_pers"/>
				<col ref="fst_route"/>
				<col ref="fst_route_tm"/>
				<col ref="last_route"/>
				<col ref="last_route_tm"/>
			</datagrid>
			<object id="object1" clsid="{BD113CEB-7291-4410-A3F4-ECF046BD541D}" visibility="hidden" style="left:450px; top:310px; width:25px; height:20px; "/>
			<!--
			<object classid="CLSID:BD113CEB-7291-4410-A3F4-ECF046BD541D" codebase="MISMAT_SOCKET.CAB#version=1,0,0,1" width="300" height="330" id="test">
			-->
		</group>
		<!--
		<group id="group4" visibility="hidden" style="left:220px; top:555px; width:450px; height:150px; background-color:#ffffff; border-width:1px; border-style:solid; ">
			<caption id="caption5" class="list_cap01" style="left:6px; top:30px; width:94px; height:24px; text-align:center; ">인쇄일자</caption>
			<caption id="caption6" class="list_cap02" style="left:99px; top:30px; width:342px; height:24px; text-align:center; "/>
			<input id="input4" ref="/root/reqData/searchData/f_pr_dt" navindex="12" inputtype="date" format="yyyy-mm-dd" style="left:105px; top:33px; width:100px; height:18px; "/>
			<button id="button9" class="btn04" style="left:297px; top:5px; width:86px; height:21px; ">
				<caption>발송/제작 데이터 생성</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var send_clsf = model.getValue("/root/reqData/searchData/send_clsf");
						if (send_clsf == "01"){
							if (window.alert("발송정보를 조회해서 생성하시겠습니까?", "확인", 1) == 1) {
								var pr_dt = model.getValue("/root/reqData/searchData/f_pr_dt");
								//alert(pr_dt.substring(2, 8));
								model.setValue("/root/reqData/searchData/pr_dt", pr_dt.substring(2, 8));
								model1.send("pr_sendmg_1040");
								if(submit_completed()) {
									alert("발송정보가 생성되었습니다.발송조회를 클릭해서 발송데이터를 구성해주십시오.");
									group4.visible = false;
									return;
						       	}
						       	model.setValue("/root/reqData/searchData/pr_dt", pr_dt);
						       	model1.send("pr_sendmg_1050");
						       	if(submit_completed()) {
						       		alert("발송정보가 생성되었습니다.발송조회를 클릭해서 발송데이터를 구성해주십시오.");
									group4.visible = false;
									return;
						       	}
							}
						}
					]]>
				</script>
			</button>
			<button id="button10" class="btn02" style="left:389px; top:4px; width:52px; height:21px; ">
				<caption>닫기</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						group4.visible = false;
					]]>
				</script>
			</button>
		</group>
		-->
	</xhtml:body>
</xhtml:html>
