<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/TFCommon.js"/>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						<comboSet>
							<fac_clsf>
								<item>
									<value/>
									<label/>
								</item>
							</fac_clsf>
							<medi_cd>
								<item>
									<value/>
									<label/>
								</item>
							</medi_cd>
							<sect_cd>
								<item>
									<value/>
									<label/>
								</item>
							</sect_cd>
							<pap_std>
								<item>
									<value/>
									<label/>
								</item>
							</pap_std>
							<oth_medi>
								<item>
									<value>610</value>
									<label>외간</label>
								</item>
							</oth_medi>
							<oth_medi_2>
								<item/>
							</oth_medi_2>
							<oth_medi_1>
								<item/>
							</oth_medi_1>
							<dual_out_clsf>
								<item/>
							</dual_out_clsf>
							<duty_ovt_prt_yn>
								<item>
									<label>Y</label>
									<value>Y</value>
								</item>
								<item>
									<label>N</label>
									<value>N</value>
								</item>
							</duty_ovt_prt_yn>
							<prt_clsf>
								<item/>
							</prt_clsf>
							<fac_clsf_2>
								<item/>
							</fac_clsf_2>
							<papcmpy_cd>
								<item/>
							</papcmpy_cd>
							<issu_qty>
								<item/>
							</issu_qty>
						</comboSet>
						<gubun/>
						<loadCombo/>
						<clos_clsf/>
						<clos_clsf_nm/>
						<uprc_yn/>
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<searchDetail>
							<issu_dt/>
							<fac_clsf/>
							<uprc_yn/>
							<occr_dt/>
							<seq/>
						</searchDetail>
						<!-- 검색조건 처리 -->
						<formData/>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<multiUpData/>
						<!-- MultiUpDate유형 사용시 처리 -->
						<searchData>
							<medi_cd/>
							<mang_cd_3/>
							<fac_clsf/>
							<sect_cd/>
							<prt_dt/>
							<issu_dt/>
							<uprc_yn/>
						</searchData>
						<fwdData>
							<func_nm/>
							<comboSet>
								<fac_clsf>
									<item>
										<value/>
										<label/>
									</item>
								</fac_clsf>
							</comboSet>
							<issu_dt/>
							<prt_dt/>
							<fac_clsf/>
							<issu_pcnt/>
							<clr_pcnt/>
							<medi_cd/>
							<sect_cd/>
							<occr_dt/>
							<seq/>
						</fwdData>
						<reqForm>
							<multiUpData1/>
							<multiUpData2/>
							<issu_dt/>
							<fac_clsf/>
							<clos_clsf/>
							<clos_clsf_nm/>
							<clos_dt/>
							<multiUpData3/>
							<issu_qty/>
						</reqForm>
						<searchData2>
							<issu_dt/>
							<clos_yn/>
						</searchData2>
						<searchData3>
							<issu_dt/>
							<fac_clsf/>
							<medi_cd/>
							<sect_cd/>
						</searchData3>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<formData/>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<errCode/>
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<errMsg/>
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<gridData>
							<record>
								<issu_dt/>
								<fac_clsf/>
								<medi_cd/>
								<sect_cd/>
								<pap_std/>
								<issu_pcnt/>
								<clr_pcnt/>
								<bw_pcnt/>
								<slip_qty/>
								<is_cnt_ex_yn/>
								<is_qty_inc_yn/>
								<add_prt_seq/>
								<dual_out_clsf/>
								<duty_ovt_prt_yn/>
								<remk/>
								<cmpy_cd/>
								<occr_dt/>
								<seq/>
								<prt_dt/>
								<clos_clsf/>
							</record>
						</gridData>
						<gridData1>
							<record>
								<issu_dt/>
								<fac_clsf/>
								<medi_cd/>
								<sect_cd/>
								<pap_std/>
								<issu_pcnt/>
								<clr_pcnt/>
								<bw_pcnt/>
								<slip_qty/>
								<is_cnt_ex_yn/>
								<is_qty_inc_yn/>
								<remk/>
								<cmpy_cd/>
								<occr_dt/>
								<seq/>
								<prt_dt/>
								<hdqt_paper_clsf/>
								<clos_clsf/>
							</record>
						</gridData1>
						<gridData2>
							<record>
								<issu_dt/>
								<prt_dt/>
								<fac_clsf/>
								<medi_cd/>
								<sect_cd/>
								<prt_clsf/>
								<issu_pcnt/>
								<clr_pcnt/>
								<papcmpy_cd/>
							</record>
						</gridData2>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[
				function initBody() {
					model1.copyNode("/root/initData/pageInfo",parent.root.initData.pageInfo);
					model.setValue("/root/reqData/searchData/issu_dt", commCurDate("ymd"));
					model.setValue("/root/reqData/searchData/prt_dt", commCurDate("ymd"));
					initCombo();
					
					//button12.disabled=true;
					//button13.disabled=true;
					model.removenode("/root/resData/gridData/record");
					model.removenode("/root/resData/gridData1/record");
					model.removenode("/root/resData/gridData2/record");
					
					datagrid1.refresh();
					datagrid2.refresh();
					datagrid3.refresh();
					
					//button17.disabled = true;
					//datagrid1.isReadOnly(1, 1, 1, 18)  = true;
					//datagrid2.isReadOnly(1, 1, 1, 10)  = true;
				}
				
				function initCombo(){
					var add_prt_arr = new Array();
					var tm_yn_arr = new Array();
					model1.send("pr_prtexec_5050");
					model1.copyNode("/root/initData/comboSet/fac_clsf","/root/tempData/fac_clsf");
					model1.copyNode("/root/initData/comboSet/fac_clsf_2","/root/tempData/fac_clsf");
					model1.copyNode("/root/initData/comboSet/medi_cd","/root/tempData/medi_cd");
					model1.copyNode("/root/initData/comboSet/pap_std","/root/tempData/pap_std");
					model1.copyNode("/root/initData/comboSet/sect_cd","/root/tempData/sect_cd");
					model1.copyNode("/root/initData/comboSet/oth_medi_1","/root/tempData/oth_medi_1");
					model1.copyNode("/root/initData/comboSet/oth_medi_2","/root/tempData/oth_medi_2");
					model1.copyNode("/root/initData/comboSet/dual_out_clsf","/root/tempData/dual_out_clsf");
					model1.copyNode("/root/initData/comboSet/prt_clsf","/root/tempData/prt_clsf");
					model1.copyNode("/root/initData/comboSet/papcmpy_cd","/root/tempData/papcmpy_cd");
					model1.setValue("/root/initData/uprc_yn", model.getValue("/root/tempData/uprc_yn"));
					
					add_prt_arr[0] = new makeVal();
					add_prt_arr[0].setMakeVal("", "");
					add_prt_arr[1] = new makeVal();
					add_prt_arr[1].setMakeVal("001 합쇄", "001");
					add_prt_arr[2] = new makeVal();
					add_prt_arr[2].setMakeVal("002 합쇄", "002");
					add_prt_arr[3] = new makeVal();
					add_prt_arr[3].setMakeVal("003 합쇄", "003");
					add_prt_arr[4] = new makeVal();
					add_prt_arr[4].setMakeVal("004 합쇄", "004");
					add_prt_arr[5] = new makeVal();
					add_prt_arr[5].setMakeVal("005 합쇄", "005");
					
					tm_yn_arr[0] = new makeVal();
					tm_yn_arr[0].setMakeVal("Y 시간내", "Y");
					tm_yn_arr[1] = new makeVal();
					tm_yn_arr[1].setMakeVal("N 시간외", "N");
					
					for (var i=0; i<add_prt_arr.length; i++){
						model.makeNode("/root/initData/comboSet/add_prt_seq/item[" + (i + 1) + "]/label");
						model.makeNode("/root/initData/comboSet/add_prt_seq/item[" + (i + 1) + "]/value");
						model1.setValue("/root/initData/comboSet/add_prt_seq/item[" + (i + 1) + "]/label", add_prt_arr[i].label);
						model1.setValue("/root/initData/comboSet/add_prt_seq/item[" + (i + 1) + "]/value", add_prt_arr[i].value);
					}
					
					for (var i=0; i<tm_yn_arr.length; i++){
						model.makeNode("/root/initData/comboSet/tm_in_yn/item[" + (i + 1) + "]/label");
						model.makeNode("/root/initData/comboSet/tm_in_yn/item[" + (i + 1) + "]/value");
						model1.setValue("/root/initData/comboSet/tm_in_yn/item[" + (i + 1) + "]/label", tm_yn_arr[i].label);
						model1.setValue("/root/initData/comboSet/tm_in_yn/item[" + (i + 1) + "]/value", tm_yn_arr[i].value);
					}
					
					var nodeList = instance1.selectNodes("/root/initData/comboSet/fac_clsf_2/item");
					//alert(nodeList.length);
					if (nodeList.length > 1){
						model1.removenode("/root/initData/comboSet/fac_clsf_2/item[1]");
					}
					
					
					model1.refresh();
					combo1.select(0);
				}
				
				function makeVal(){
					this.label = "";
					this.value = "";
					this.setMakeVal = setMakeVal;
				}
					
				function setMakeVal(iLabel, iValue){
					this.label = iLabel;
					this.value = iValue;
				}
				
				//행입력
				function addRow1() {
					var rowCnt      = 0;
					var selectedIdx = datagrid1.rows - 1;
					var issu_dt     = model1.getValue("/root/resData/gridData/record[1]/issu_dt");
					
					if(issu_dt=="") {
						rowCnt = datagrid1.rows;
						
						if(rowCnt > 1) {
							datagrid1.isReadOnly(1, 1, 1, 18)  = false;
							datagrid1.addStatus(selectedIdx, "insert");
							model1.setValue("/root/resData/gridData/record[1]/issu_dt", commCurDate("ymd"));
							return false;
							
						} else {
							datagrid1.addRow(true, true);
							return true;
						}
					}else{				
						datagrid1.addRow(true, true);
						return true;
					}
				}
				
				//	콤보 필터링
				function cellchanged() {
					var gridID = datagrid1;
					var nodeSet =  "/root/resData/gridData/record";
					var nodeName = "medi_cd";
					var comboNodeSet_1 = "/root/initData/comboSet/sect_cd";
					var comboNodeSet_2 = "/root/initData/comboSet/oth_medi_1";
					var nodeSetName = "item";
					var srcColIdx = 4;
					var targetColIdx = 6;
					
					if ( gridID.col == srcColIdx && gridID.row >= gridID.fixedRows ){
						var row = gridID.row - gridID.fixedRows+1;
						var idx = model.getValue(nodeSet+"["+row+"]/"+nodeName);

						//alert(idx);
						if ( idx == "610" )	{//첫번째 콤보에 선택한 아이템이 있을 때만 두번째 콤보 데이터 필터링
							gridID.cellComboNodeset(datagrid1.row, targetColIdx) =  comboNodeSet_2 + "/"+nodeSetName;
						} else {
							gridID.cellComboNodeset(datagrid1.row, targetColIdx) =  comboNodeSet_1 + "/"+nodeSetName;
						}
					}
				}
				
				//	콤보 필터링
				function cellchanged2() {
					var gridID = datagrid3;
					var nodeSet =  "/root/resData/gridData2/record";
					var nodeName = "medi_cd";
					var comboNodeSet_1 = "/root/initData/comboSet/sect_cd";
					var comboNodeSet_2 = "/root/initData/comboSet/oth_medi_1";
					var nodeSetName = "item";
					var srcColIdx = 4;
					var targetColIdx = 5;
					
					if ( gridID.col == srcColIdx && gridID.row >= gridID.fixedRows ){
						var row = gridID.row - gridID.fixedRows+1;
						var idx = model.getValue(nodeSet+"["+row+"]/"+nodeName);

						//alert(idx);
						if ( idx == "610" )	{//첫번째 콤보에 선택한 아이템이 있을 때만 두번째 콤보 데이터 필터링
							gridID.cellComboNodeset(datagrid3.row, targetColIdx) =  comboNodeSet_2 + "/"+nodeSetName;
						} else {
							gridID.cellComboNodeset(datagrid3.row, targetColIdx) =  comboNodeSet_1 + "/"+nodeSetName;
						}
					}
				}
				
				//행입력
				function addRow2() {
					var rowCnt      = 0;
					var selectedIdx = datagrid2.rows - 1;
					var issu_dt     = model1.getValue("/root/resData/gridData1/record[1]/issu_dt");	
					
					if(issu_dt=="") {
						rowCnt = datagrid2.rows;
						
						if(rowCnt > 1) {
							datagrid2.isReadOnly(1, 1, 1, 10)  = false;
							datagrid2.addStatus(selectedIdx, "insert");
							model1.setValue("/root/resData/gridData1/record[1]/issu_dt", commCurDate("ymd"));
							return false;
							
						} else {
							datagrid2.addRow(true, true);
							return true;
						}
					}else{				
						datagrid2.addRow(true, true);
						return true;
					}
				}
				
				//행입력
				function addRow3() {
					var rowCnt      = 0;
					var selectedIdx = datagrid3.rows - 1;
					var issu_dt     = model1.getValue("/root/resData/gridData2/record[1]/prt_dt");	
					
					if(issu_dt=="") {
						rowCnt = datagrid3.rows;
						
						if(rowCnt > 1) {
							datagrid3.isReadOnly(1, 1, 1, 10)  = false;
							datagrid3.addStatus(selectedIdx, "insert");
							model1.setValue("/root/resData/gridData2/record[1]/prt_dt", commCurDate("ymd"));
							return false;
							
						} else {
							datagrid3.addRow(true, true);
							return true;
						}
					}else{				
						datagrid3.addRow(true, true);
						return true;
					}
				}
				
				function setprt_no(prt_dt,fac_clsf){
					model1.setValue("/root/reqData/searchDetail/issu_dt",prt_dt);
					model1.setValue("/root/reqData/searchDetail/fac_clsf",fac_clsf);
					model1.setValue("/root/initData/gubun","I");
					//판매정보 조회
					datagrid1.isReadOnly(1, 1, 1, 18)  = false;
					model1.send("pr_prtexec_5060");
					model1.copyNode("/root/resData/gridData","/root/tempData/gridData");
					
					model1.refresh();
					for(i=1; i<datagrid1.rows; i++){
						datagrid1.rowStatus(i)=1;
					}
				}
			]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				initBody();
				]]>
			</script>
			<submission id="pr_prtexec_5011" action="/mt/prtexec/5011" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchDetail" resultref="/root/tempData"/>
			<submission id="mt_papord_4001_m" action="/mt/papord/4001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mang_cd_3" resultref="/root/tempData"/>
			<submission id="pr_prtexec_5000" action="/mt/prtexec/5000" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="pr_prtexec_5020" action="/mt/prtexec/5020" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="pr_prtexec_5030" action="/mt/prtexec/5030" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="pr_prtexec_5031" action="/mt/prtexec/5031" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="pr_prtexec_5032" action="/mt/prtexec/5032" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="pr_prtexec_5040" action="/mt/prtexec/5040" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="pr_prtexec_5050" action="/mt/prtexec/5050" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="pr_prtexec_5060" action="/mt/prtexec/5060" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchDetail" resultref="/root/tempData"/>
			<submission id="pr_prtexec_5070" action="/mt/prtexec/5070" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="pr_prtexec_5090" action="/mt/prtexec/5090" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/double" resultref="/root/tempData"/>
			<submission id="pr_prtexec_5021" action="/mt/prtexec/5021" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData2" resultref="/root/tempData"/>
			<submission id="pr_prtexec_5022" action="/mt/prtexec/5022" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData2" resultref="/root/tempData"/>
			<submission id="pr_prtexec_5080" action="/mt/prtexec/5080" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData3" resultref="/root/tempData"/>
		</model>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728">
		<group id="group2" class="gro_sel" style="left:10px; top:72px; width:926px; height:49px; ">
			<caption id="caption4" class="list_cap01" style="left:0px; top:0px; width:115px; height:24px; text-align:center; ">발행일자</caption>
			<caption id="caption5" class="list_cap02" style="left:114px; top:0px; width:811px; height:24px; text-align:center; "/>
			<caption id="caption36" class="list_cap02" style="left:114px; top:23px; width:811px; height:24px; text-align:center; "/>
			<caption id="caption6" class="list_cap01" style="left:596px; top:0px; width:115px; height:24px; text-align:center; ">공     장</caption>
			<caption id="caption8" class="list_cap01" style="left:298px; top:23px; width:115px; height:24px; text-align:center; ">섹     션</caption>
			<caption id="caption33" class="list_cap01" style="left:298px; top:0px; width:115px; height:24px; text-align:center; ">인쇄일자</caption>
			<caption id="caption35" class="list_cap01" style="left:0px; top:23px; width:115px; height:24px; text-align:center; ">매     체</caption>
			<caption id="caption45" class="list_cap02" style="left:596px; top:23px; width:330px; height:24px; text-align:center; "/>
			<input id="input1" ref="/root/reqData/searchData/issu_dt" inputtype="date" style="left:120px; top:3px; width:110px; height:18px; background-color:#ffffcc; ">
				<script type="javascript" ev:event="onkeyup">
					<![CDATA[
						var issu_dt = input1.currentText;
						issu_dt = issu_dt.replace(/-/ig, "");
						model.setValue("/root/reqData/searchData/prt_dt", issu_dt);
						input2.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var issu_dt = input1.currentText;
						issu_dt = issu_dt.replace(/-/ig, "");
						model.setValue("/root/reqData/searchData/prt_dt", issu_dt);
						input2.refresh();
					]]>
				</script>
			</input>
			<input id="input2" ref="/root/reqData/searchData/prt_dt" inputtype="date" style="left:418px; top:3px; width:110px; height:18px; "/>
			<select1 id="combo1" ref="/root/reqData/searchData/fac_clsf" appearance="minimal" style="left:715px; top:3px; width:110px; height:18px; background-color:#ffffcc; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fac_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<select1 id="combo2" ref="/root/reqData/searchData/medi_cd" appearance="minimal" style="left:120px; top:26px; width:173px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/medi_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
//					model1.setValue("/root/reqData/searchData/mang_cd_3",combo2.value);
//					model1.send("mt_papord_4001_m");
//					model1.copyNode("/root/initData/comboSet/sect_cd","/root/tempData/sect_cd");
//					model1.refresh();
//					]]>
				</script>
			</select1>
			<select1 id="combo3" ref="/root/reqData/searchData/sect_cd" appearance="minimal" style="left:418px; top:26px; width:173px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/sect_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<caption id="caption3" class="list_cap01" style="left:596px; top:23px; width:115px; height:24px; text-align:center; ">마감상태</caption>
			<output id="output1" ref="/root/reqData/reqForm/clos_clsf_nm" style="left:715px; top:26px; width:90px; height:18px; "/>
			<output id="output2" ref="/root/reqData/reqForm/clos_dt" format="yyyy-mm-dd" style="left:810px; top:26px; width:110px; height:18px; "/>
		</group>
		<group id="group3" class="gro_btn" style="left:10px; top:45px; width:926px; height:21px; ">
			<button id="btnA4" class="btn02" crud="R" style="left:874px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
			viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));		
					]]>
				</script>
			</button>
			<button id="button4" class="btn02" crud="C" style="left:475px; top:0px; width:50px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (model.getValue("/root/initData/uprc_yn") != "Y"){
							if (model.getValue("/root/reqData/reqForm/clos_clsf") != "00"){
								alert("마감된 정보는 수정할 수 없습니다.");
								return;
							}
						}
						if(!commGridReqCheck("datagrid1")) return;
						if(!commGridReqCheck("datagrid2")) return;
						if(!commGridReqCheck("datagrid3")) return;
						
						//매체별일괄조정 데이터와 일치하도록 메세지 출력. 2012-11-13. 김성미
						for(i=1; i<datagrid1.rows; i++){
							
							if (datagrid1.rowStatus(i)==4) {
								alert("삭제 시에는 부재료출고의 매체별일괄조정 데이터를 함께 반영하시기 바랍니다.");
							}
							
						}
					   	
						if (window.alert("저장하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						model1.setValue("/root/reqData/reqForm/multiUpData1", datagrid1.getUpdateData());
						model1.setValue("/root/reqData/reqForm/multiUpData2", datagrid2.getUpdateData());
						model1.setValue("/root/reqData/reqForm/multiUpData3", datagrid3.getUpdateData());
						
						model1.send("pr_prtexec_5070");
						
						if(submit_completed()) {
							alert("저장되었습니다.");
							model.setValue("/root/reqData/searchData/prt_dt", "");
							input2.refresh();
							
							button8.dispatch("onclick");
							
							datagrid1.clearStatus();
							datagrid2.clearStatus();
							datagrid3.clearStatus();
							model.setValue("/root/reqData/reqForm/multiUpData1", "");
							model.setValue("/root/reqData/reqForm/multiUpData2", "");
							model.setValue("/root/reqData/reqForm/multiUpData3", "");
						}
					]]>
				</script>
			</button>
			<button id="button5" class="btn02" crud="R" style="left:819px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model1.reset();
					datagrid1.clearStatus();
					initBody();
					//button12.disabled=true;
					//button13.disabled=true;
					]]>
				</script>
			</button>
			<button id="button6" class="btn04" crud="A" style="left:81px; top:0px; width:89px; height:21px; ">
				<caption>판매정보 조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if (model.getValue("/root/initData/uprc_yn") != "Y"){
						if (model.getValue("/root/initData/gubun") != "U"){
							alert("판매정보를 조회하기 이전에 발행일자, 공장에 대한 정보 조회를 먼저 하시기 바랍니다.");
							return;
						}
						
						if (model.getValue("/root/reqData/searchData/fac_clsf") != "ALL"){
							if (model.getValue("/root/reqData/reqForm/clos_clsf") != "00"){
								alert("마감된 정보는 판매정보를 조회할 수 없습니다.");
								return;
							}
						}
					}
					var prt_dt = model.getValue("/root/reqData/searchData/prt_dt");
					var issu_dt = model.getValue("/root/reqData/searchData/issu_dt");
					var fac_clsf = model.getValue("/root/reqData/searchData/fac_clsf");
					
					model1.setValue("/root/reqData/searchDetail/issu_dt",issu_dt);
					model1.setValue("/root/reqData/searchDetail/fac_clsf",fac_clsf);
					model1.setValue("/root/reqData/searchDetail/uprc_yn", model.getValue("/root/initData/uprc_yn"));
					
					model1.setValue("/root/initData/gubun","I");
					
					model1.send("pr_prtexec_5060");
					model1.copyNode("/root/resData/gridData","/root/tempData/gridData");
					
					model1.refresh();

					datagrid1.allStyle("data", "background-color") = "#FFFFFF";
					for(i=1; i<datagrid1.rows; i++){
						if (datagrid1.valueMatrix(i, 4) == "110"){
							if (datagrid1.valueMatrix(i, 6) == "0100"){
								datagrid1.valueMatrix(i, 7) = "01";
							} else if (datagrid1.valueMatrix(i, 6) == "0200"){
								datagrid1.valueMatrix(i, 7) = "11";
							} else {
								datagrid1.valueMatrix(i, 7) = "21";
							}
						} else {
							datagrid1.valueMatrix(i, 7) = "01";
						}
						
						if (datagrid1.valueMatrix(i, 22) == 'N'){
							datagrid1.cellstyle("background-color", i, 12) = "#FFAAFF";
						}
						datagrid1.rowStatus(i)=1;
					}
					
					//model1.setValue("/root/reqData/fwdData/func_nm", "setprt_no");
					//model1.copyNode("/root/reqData/fwdData/comboSet/fac_clsf","/root/initData/comboSet/fac_clsf");
					//window.load("/xrw/pr/prtexec/PR_PRTEXEC_5010.xrw","mdichild", "pop1", "left:300; top:150; width:410px; height:220px;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
			</button>
			<button id="button8" class="btn02" crud="R" style="left:29px; top:0px; width:50px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var prt_dt	= model1.getValue("/root/reqData/searchData/prt_dt");
					var issu_dt	= model1.getValue("/root/reqData/searchData/issu_dt");
					var fac		= model1.getValue("/root/reqData/searchData/fac_clsf");
					//alert(issu_dt + "\n" + fac);
					if (issu_dt =="" || fac == ""){
						alert("발행일자,공장은 필수 입력입니다.");
						return;
					}
					
					//전체발행내역조회
					model1.send("pr_prtexec_5000");
					datagrid1.isReadOnly(1, 1, 1, 18)  = false;
					datagrid2.isReadOnly(1, 1, 1, 10)  = false;
					//model1.removenode("/root/resData/gridData/record");
					//model1.removenode("/root/resData/gridData1/record");
					
					//button17.disabled = false;
					
					datagrid1.clearStatus();
					datagrid2.clearStatus();
					datagrid3.clearStatus();
					datagrid3.refresh();
					datagrid2.refresh();
					datagrid1.refresh();
					
					model1.copyNode("/root/resData/gridData","/root/tempData/gridData1");
					model1.copyNode("/root/resData/gridData1","/root/tempData/gridData2");
					model1.copyNode("/root/resData/gridData2","/root/tempData/gridData3");
					model1.copyNode("/root/initData/comboSet/issu_qty","/root/tempData/gridData4");
					combo4.refresh();
					datagrid3.refresh();
					datagrid2.refresh();
					datagrid1.refresh();
					combo4.select(1);
					
					if (fac != 'ALL'){
						model1.setValue("/root/reqData/reqForm/clos_clsf",model.getValue("/root/tempData/clos_clsf"));
						model1.setValue("/root/reqData/reqForm/clos_clsf_nm",model.getValue("/root/tempData/clos_clsf_nm"));
						model1.setValue("/root/reqData/reqForm/clos_dt", issu_dt);
						output1.refresh();
						output2.refresh();
						
						if (model1.getValue("/root/reqData/reqForm/clos_clsf") != "00"){
							datagrid1.isReadOnly(1, 1, datagrid1.rows -1, datagrid1.cols -1) = true;
							datagrid2.isReadOnly(1, 1, datagrid2.rows -1, datagrid2.cols -1) = true;
						} else {
							datagrid1.isReadOnly(1, 1, datagrid1.rows -1, datagrid1.cols -1) = false;
							datagrid2.isReadOnly(1, 1, datagrid2.rows -1, datagrid2.cols -1) = false;
						}
					}
					
					var comboNodeSet_1 = "/root/initData/comboSet/sect_cd";
					var comboNodeSet_2 = "/root/initData/comboSet/oth_medi_1";
					
					datagrid1.allStyle("data", "background-color") = "#FFFFFF";
					for (var i=1; i<datagrid1.rows; i++){
						if (datagrid1.valueMatrix(i, 4) == "610"){
							datagrid1.cellComboNodeset(i, 6) =  comboNodeSet_2 + "/item";
						} else {
							datagrid1.cellComboNodeset(i, 6) =  comboNodeSet_1 + "/item";
						}
						if (datagrid1.valueMatrix(i, datagrid1.colRef("chg_yn")) == "N"){
							datagrid1.cellstyle("background-color", i, 12) = "#FFAAFF";
						}
					}
					
					//입력된 데이터는 섹션부분까지 수정할 수 없음. 삭제하여 다시 등록. 2012-11-12. 김성미.
//					if(datagrid1.valueMatrix(1, datagrid1.colRef("slip_qty")) != "0")
//					{
						datagrid1.isReadOnly(1,1,datagrid1.rows - 1,6) = true;
//					}
					
					model.setValue("/root/initData/gubun", "U");
					]]>
				</script>
			</button>
			<button id="button1" class="btn02" crud="C" style="left:528px; top:0px; width:50px; height:21px; ">
				<caption>공장마감</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var issu_dt	= model.getValue("/root/reqData/searchData/issu_dt");
						var prt_dt	= model.getValue("/root/reqData/searchData/prt_dt");
						var fac_clsf	= model.getValue("/root/reqData/searchData/fac_clsf");
						
						if(!commGridReqCheck("datagrid2")) return;
						
						if(model1.getValue("/root/initData/gubun") !="U"){
							alert("조회를 먼저 하셔야합니다.");
							return;
						}
						if (fac_clsf == "ALL"){
							alert("전체공장별로 조회하면 마감을 처리할 수 없습니다.");
							return;
						}
						if (window.alert("마감하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						model.setValue("/root/reqData/reqForm/issu_dt", 	issu_dt);
						model.setValue("/root/reqData/reqForm/fac_clsf", 	fac_clsf);
						
						model.send("pr_prtexec_5020");
						
						if(submit_completed()) {
							alert("정상적으로 마감처리되었습니다.");
							model.reset();
							
							
							model.setValue("/root/reqData/searchData/prt_dt", prt_dt);
							model.setValue("/root/reqData/searchData/issu_dt", issu_dt);
							model.setValue("/root/reqData/searchData/fac_clsf", fac_clsf);
							
							button8.dispatch("onclick");
							/*
							model1.send("pr_prtexec_5000");
							
							model1.copyNode("/root/resData/gridData","/root/tempData/gridData1");
							model1.copyNode("/root/resData/gridData1","/root/tempData/gridData2");
							datagrid2.refresh();
							datagrid1.refresh();
							
							datagrid1.isReadOnly(1, 1, datagrid2.rows, 20)  = true;
							datagrid2.isReadOnly(1, 1, datagrid1.rows, 15)  = true;
							model.setValue("/root/initData/gubun", "U");
							*/
						}
						/*
						for(i=1; i<datagrid1.rows;i++){
							datagrid1.rowStatus(i) = 2;
							model1.setValue("/root/resData/gridData/record["+ (i) +"]/clos_clsf","1");
						}
						for(i=1; i<datagrid2.rows; i++){
							datagrid2.rowStatus(i)=2;
							model1.setValue("/root/resData/gridData1/record[" + (i) + "]/clos_clsf","1");
						}
					  	model1.setValue("/root/reqData/multiUpData1", datagrid1.getUpdateData());
						model1.setValue("/root/reqData/multiUpData2", datagrid2.getUpdateData());
					    //   return;
						model1.send("pr_prtexec_5030");
						
						if(submit_completed()) {		
							datagrid1.clearStatus();
					 		datagrid2.clearStatus();
						}
						*/
					]]>
				</script>
			</button>
			<!--
			<button id="button2" class="btn04" style="left:474px; top:0px; width:89px; height:21px; ">
				<caption>전표부수 변경</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
				                       for(i=1; i<datagrid1.rows; i++){
							datagrid1.isReadOnly(i,9)=false;
						}
					]]>
				</script>
			</button>
			-->
			<button id="button2" class="btn04" crud="C" style="left:582px; top:0px; width:89px; height:21px; ">
				<caption>공장마감 취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var issu_dt	= model.getValue("/root/reqData/searchData/issu_dt");
						var prt_dt	= model.getValue("/root/reqData/searchData/prt_dt");
						var fac_clsf	= model.getValue("/root/reqData/searchData/fac_clsf");
						
						if(!commGridReqCheck("datagrid2")) return;
						if(model1.getValue("/root/initData/gubun") !="U"){
					 		alert("조회를 먼저 하셔야합니다.");
							return;
						}
						if (fac_clsf == "ALL"){
							alert("전체공장별로 조회하면 마감을 처리할 수 없습니다.");
							return;
						}
						if (window.alert("마감 취소 하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						model.setValue("/root/reqData/reqForm/issu_dt", 	issu_dt);
						model.setValue("/root/reqData/reqForm/fac_clsf", 	fac_clsf);
						
						model.send("pr_prtexec_5030");
						
						if(submit_completed()) {		
							alert("정상적으로 마감취소 되었습니다.");
							model.reset();
							
							model.setValue("/root/reqData/searchData/prt_dt", prt_dt);
							model.setValue("/root/reqData/searchData/issu_dt", issu_dt);
							model.setValue("/root/reqData/searchData/fac_clsf", fac_clsf);
							
							button8.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="button10" class="btn02" crud="A" style="left:674px; top:0px; width:50px; height:21px; ">
				<caption>자재마감</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var issu_dt	= model.getValue("/root/reqData/searchData/issu_dt");
						var prt_dt	= model.getValue("/root/reqData/searchData/prt_dt");
						var fac_clsf	= model.getValue("/root/reqData/searchData/fac_clsf");
						
						if(!commGridReqCheck("datagrid2")) return;
						if(model1.getValue("/root/initData/gubun") !="U"){
					 		alert("조회를 먼저 하셔야합니다.");
							return;
						}
						if (window.alert("마감하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						model.setValue("/root/reqData/reqForm/issu_dt", 	issu_dt);
						model.setValue("/root/reqData/reqForm/fac_clsf", 	fac_clsf);
						
						model.send("pr_prtexec_5031");
						
						if(submit_completed()) {		
							alert("정상적으로 마감처리되었습니다.");
							model.reset();
							
							model.setValue("/root/reqData/searchData/prt_dt", prt_dt);
							model.setValue("/root/reqData/searchData/issu_dt", issu_dt);
							model.setValue("/root/reqData/searchData/fac_clsf", fac_clsf);
							
							button8.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="button11" class="btn04" crud="A" style="left:727px; top:0px; width:89px; height:21px; ">
				<caption>자재마감 취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var issu_dt	= model.getValue("/root/reqData/searchData/issu_dt");
						var prt_dt	= model.getValue("/root/reqData/searchData/prt_dt");
						var fac_clsf	= model.getValue("/root/reqData/searchData/fac_clsf");
						
						if(!commGridReqCheck("datagrid2")) return;
						if(model1.getValue("/root/initData/gubun") !="U"){
					 		alert("조회를 먼저 하셔야합니다.");
							return;
						}
						if (window.alert("마감하시겠습니까?", "확인", 1) != 1) {
							return;
						}
						model.setValue("/root/reqData/reqForm/issu_dt", 	issu_dt);
						model.setValue("/root/reqData/reqForm/fac_clsf", 	fac_clsf);
						
						model.send("pr_prtexec_5032");
						
						if(submit_completed()) {		
							alert("정상적으로 마감처리되었습니다.");
							model.reset();
							
							model.setValue("/root/reqData/searchData/prt_dt", prt_dt);
							model.setValue("/root/reqData/searchData/issu_dt", issu_dt);
							model.setValue("/root/reqData/searchData/fac_clsf", fac_clsf);
							
							button8.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="button14" class="btn03" crud="A" style="left:173px; top:0px; width:67px; height:21px; ">
				<caption>참고사항</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model.setValue("/root/reqData/fwdData/issu_dt", model.getValue("/root/reqData/searchData/issu_dt"));
					model.setValue("/root/reqData/fwdData/prt_dt", model.getValue("/root/reqData/searchData/prt_dt"));
					
					window.load(
							"/xrw/pr/prtexec/PR_PRTEXEC_5010.xrw", 
							"modal", 
							"", 
							"left:30px; top:200px; width:655px; height:520; align:center; caption:hidden;"
							,"/root/reqData/fwdData"
							,"/root/reqData/fwdData"
						);
					]]>
				</script>
			</button>
			<button id="button16" class="btn04" crud="A" style="left:383px; top:0px; width:89px; height:21px; ">
				<caption>부수변경이력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var cell			= datagrid1.selectedCells;
					if(cell.length < 1){
						alert("select a Cell");
						return;
					}
					var col			= cell.item(0).col;
					var row			= cell.item(0).row;					
					
					model.setValue("/root/reqData/fwdData/issu_dt", datagrid1.valueMatrix(row, datagrid1.colRef("issu_dt")));
					model.setValue("/root/reqData/fwdData/prt_dt", datagrid1.valueMatrix(row, datagrid1.colRef("prt_dt")));
					model.setValue("/root/reqData/fwdData/fac_clsf", datagrid1.valueMatrix(row, datagrid1.colRef("fac_clsf")));
					model.setValue("/root/reqData/fwdData/medi_cd", datagrid1.valueMatrix(row, datagrid1.colRef("medi_cd")));
					model.setValue("/root/reqData/fwdData/sect_cd", datagrid1.valueMatrix(row, datagrid1.colRef("sect_cd")));
					model.setValue("/root/reqData/fwdData/issu_pcnt", datagrid1.valueMatrix(row, datagrid1.colRef("issu_pcnt")));
					model.setValue("/root/reqData/fwdData/clr_pcnt", datagrid1.valueMatrix(row, datagrid1.colRef("clr_pcnt")));
					
					window.load("/xrw/pr/prtexec/PR_PRTEXEC_5020.xrw"
						, "modal" 
						, ""
						, "left:100; top:100; width:720; height:450; align:center;sysmenu:hidden; min:hidden; max:hidden; resize:false; caption:hidden;"
						, "/root/reqData/fwdData"
						, "/root/reqData/fwdData"
					);
					]]>
				</script>
			</button>
			<button id="button18" class="btn03" crud="C" style="left:243px; top:0px; width:67px; height:21px; ">
				<caption>매체별자재</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var row		= datagrid1.row;
					var occr_dt	= datagrid1.valueMatrix(row, datagrid1.colRef("occr_dt"));
					var seq		= datagrid1.valueMatrix(row, datagrid1.colRef("seq"));
					
					if (occr_dt == "" || seq == ""){
						window.alert("본지 및 본사용지 사용 외간에서 발행한 매체섹션정보를 먼저 클릭해주십시오.");
						return;
					}
					model.setValue("/root/reqData/fwdData/occr_dt",	occr_dt);
					model.setValue("/root/reqData/fwdData/seq", 		seq);
					
					window.load("/xrw/pr/prtexec/PR_PRTEXEC_5040.xrw"
						, "modal" 
						, ""
						, "left:100; top:100; width:870; height:300; align:center;sysmenu:hidden; min:hidden; max:hidden; resize:false; caption:hidden;"
						, "/root/reqData/fwdData"
						, "/root/reqData/fwdData"
					);
					]]>
				</script>
			</button>
			<button id="button17" class="btn03" crud="C" style="left:313px; top:0px; width:67px; height:21px; ">
				<caption>외간사용량</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model.setValue("/root/reqData/fwdData/issu_dt", model.getValue("/root/reqData/searchData/issu_dt"));
					model.setValue("/root/reqData/fwdData/prt_dt", model.getValue("/root/reqData/searchData/prt_dt"));
					
					window.load("/xrw/mt/papinout/MT_PAPINOUT_3100.xrw"
						, "modal" 
						, ""
						, "left:100; top:100; width:946; height:450; align:center;sysmenu:hidden; min:hidden; max:hidden; resize:false; caption:hidden;"
						, "/root/reqData/fwdData"
						, "/root/reqData/fwdData"
					);
					]]>
				</script>
			</button>
		</group>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group1" style="left:10px; top:125px; width:925px; height:280px; ">
			<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" caption="발행일자^인쇄일자^공장구분^매체^섹션^섹션^인쇄구분^규격^발행면^칼라^흑백^전표부수^면수제외여부^부수포함여부^합쇄^양출구분^시간외^참고사항^caption1^caption3^caption4^caption2^caption5^caption6^caption7^caption8" colsep="#" colwidth="84, 84, 80, 110, 58, 120, 100, 40, 50, 40, 40, 60, 80, 72, 45, 70, 45, 174, 100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:0px; top:25px; width:925px; height:255px; ">
				<col class="req" ref="issu_dt" type="inputdate" format="yyyy-mm-dd" caption="발행일자" style="text-align:left; "/>
				<col class="req" ref="prt_dt" type="inputdate" format="yyyy-mm-dd" caption="인쇄일자" style="text-align:left; "/>
				<col class="req" ref="fac_clsf" type="combo" caption="공장구분" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/fac_clsf_2/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col class="req" ref="medi_cd" type="combo" caption="매체" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/medi_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="sect_nm" type="input" visibility="hidden"/>
				<col class="req" ref="sect_cd" type="combo" caption="섹션" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/sect_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col class="req" ref="prt_clsf" type="combo" caption="인쇄구분" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/prt_clsf/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col class="req" ref="pap_std" type="combo" maxlength="1" caption="규격" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/pap_std/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col class="req" ref="issu_pcnt" type="input" format="#,###" caption="발행면수" style="text-align:right; "/>
				<col class="req" ref="clr_pcnt" type="input" format="#,###" caption="칼라면수" style="text-align:right; "/>
				<col class="req" ref="bw_pcnt" type="input" format="#,###" caption="흑백면수" style="text-align:right; "/>
				<col class="req" ref="slip_qty" type="input" format="#,###" caption="전표부수" style="text-align:right; "/>
				<col editmode="inputsearch" ref="is_cnt_ex_yn" type="combo" maxlength="1">
					<choices>
						<item>
							<label>Y</label>
							<value>Y</value>
						</item>
						<item>
							<label>N</label>
							<value>N</value>
						</item>
					</choices>
				</col>
				<col editmode="inputsearch" ref="is_qty_inc_yn" type="combo" maxlength="1">
					<choices>
						<item>
							<label>Y</label>
							<value>Y</value>
						</item>
						<item>
							<label>N</label>
							<value>N</value>
						</item>
					</choices>
				</col>
				<col editmode="inputsearch" ref="add_prt_seq" type="combo">
					<choices>
						<itemset nodeset="/root/initData/comboSet/add_prt_seq/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col editmode="inputsearch" ref="dual_out_clsf" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/dual_out_clsf/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col editmode="inputsearch" ref="duty_ovt_prt_yn" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/duty_ovt_prt_yn/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="remk" type="input" style="text-align:left; "/>
				<col ref="clos_clsf" visibility="hidden"/>
				<col ref="seq" visibility="hidden"/>
				<col ref="occr_dt" visibility="hidden"/>
				<col ref="chg_yn" visibility="hidden"/>
				<col ref="gnr_qty" visibility="hidden"/>
				<col ref="spsl_qty" visibility="hidden"/>
				<col ref="gnr_add_qty" visibility="hidden"/>
				<col ref="spsl_add_qty" visibility="hidden"/>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var cell			= datagrid1.selectedCells;
					if(cell.length < 1){
						alert("select a Cell");
						return;
					}
					var col			= cell.item(0).col;
					var row			= cell.item(0).row;
					
					cellchanged();
					
					if (datagrid1.col== 10 || datagrid1.col== 11) {
						if (datagrid1.valueMatrix(row, 9) == ""){
							alert("발행면수를 먼저 입력해주십시오.");
							return;
						}
						if (datagrid1.col== 10 ) {
							if (datagrid1.valueMatrix(row, 10) == "") datagrid1.valueMatrix(row, 10) = "0";

							if (datagrid1.valueMatrix(row, 9) == ""){
								datagrid1.valueMatrix(row, 11) = eval(datagrid1.valueMatrix(row, 10));
							} else {
								datagrid1.valueMatrix(row, 11) = eval(datagrid1.valueMatrix(row, 9)) - eval(datagrid1.valueMatrix(row, 10));
							}
						}
						if (datagrid1.col== 11 ) {
							if (datagrid1.valueMatrix(row, 11) == "") datagrid1.valueMatrix(row, 11) = "0";
							
							if (datagrid1.valueMatrix(row, 9) == ""){
								datagrid1.valueMatrix(row, 10) = eval(datagrid1.valueMatrix(row, 11));
							} else {
								datagrid1.valueMatrix(row, 10) = eval(datagrid1.valueMatrix(row, 9)) - eval(datagrid1.valueMatrix(row, 11));
							}
						}
						
						if (datagrid1.valueMatrix(row, 10) != "" && datagrid1.valueMatrix(row, 11) != ""){
							if (eval(datagrid1.valueMatrix(row, 9)) != eval(datagrid1.valueMatrix(row, 10))  + eval(datagrid1.valueMatrix(row, 11))){
								alert("발행면수가 컬러면수 흑백면수의 합과 일치하지 않습니다.");
								return;
							}
						}
					}
					if (datagrid1.col== 9) {
						if (datagrid1.valueMatrix(row, 10) != "" && datagrid1.valueMatrix(row, 11) == ""){
							if (eval(datagrid1.valueMatrix(row, 9)) != eval(datagrid1.valueMatrix(row, 10))  + eval(datagrid1.valueMatrix(row, 11))){
								alert("발행면수가 컬러면수 흑백면수의 합과 일치하지 않습니다.");
								return;
							}
						}
					}
					
					if (datagrid1.col == 7) {
						var issu_dt	= datagrid1.valueMatrix(row, 1);
						var prt_dt	= datagrid1.valueMatrix(row, 2);
						var fac_clsf	= datagrid1.valueMatrix(row, 3);
						var medi_cd	= datagrid1.valueMatrix(row, 4);
						var sect_cd	= datagrid1.valueMatrix(row, 6);
						var prt_clsf	= datagrid1.valueMatrix(row, 7);
						
						for (var i=1; i<datagrid1.rows; i++){
							if (row != i){
								if (datagrid1.valueMatrix(i, 1) == issu_dt && datagrid1.valueMatrix(i, 2) == prt_dt && datagrid1.valueMatrix(i, 3) == fac_clsf && datagrid1.valueMatrix(i, 4) == medi_cd && datagrid1.valueMatrix(i, 6) == sect_cd && datagrid1.valueMatrix(i, 7) == prt_clsf){
									alert("동일한 일자의 공장, 매체, 섹션에 같은 인쇄구분이 있을 수 없습니다.");
									return;
								} 
							}
						}
					}
					/*면수제외여부 체크시 인쇄구분 42로 셋팅하던거 없앰 20100413 황우주과장 요청
					if (datagrid1.col == 13) {
						if (datagrid1.valueMatrix(row, 13) == "Y"){
							datagrid1.valueMatrix(row, 7) = String(eval(datagrid1.valueMatrix(row, 7)) + 1).GetZeroString(2);
						}
					}
					*/
					if (datagrid1.col == 4) {
						if (datagrid1.valueMatrix(row, 4) != "110"){
							datagrid1.valueMatrix(row, 7) = "01";
						}
						if (datagrid1.valueMatrix(row, 4) != "110" && datagrid1.valueMatrix(row, 4) != "610"){
							datagrid1.valueMatrix(row, 6) = "0100";
						}
					}
					
					if (datagrid1.col == 6) {
						if (datagrid1.valueMatrix(row, 4) == "110"){
							if (datagrid1.valueMatrix(row, 6) == "0100"){
								datagrid1.valueMatrix(row, 7) = "01";
							} else if (datagrid1.valueMatrix(row, 6) == "0200"){
								datagrid1.valueMatrix(row, 7) = "11";
							} else {
								datagrid1.valueMatrix(row, 7) = "21";
							}
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="ondblclick">
					<![CDATA[
					var cell			= datagrid1.selectedCells;
					if(cell.length < 1){
						alert("select a Cell");
						return;
					}
					var col			= cell.item(0).col;
					var row			= cell.item(0).row;
					
					if (col == 12){
						if (datagrid1.valueMatrix(row, 22) == 'N') {
							if (datagrid1.valueMatrix(row, 18) == ""){
								datagrid1.valueMatrix(row, 18) = "일반부수:" + datagrid1.valueMatrix(row, 23) + " 특판부수:" + datagrid1.valueMatrix(row, 24) + " 추가부수:" + datagrid1.valueMatrix(row, 25) + " 특판추가부수:" + datagrid1.valueMatrix(row, 26);
							} else {
								//datagrid1.valueMatrix(row, 18) = datagrid1.valueMatrix(row, 18) + " 일반부수:" + datagrid1.valueMatrix(row, 23) + " 특판부수:" + datagrid1.valueMatrix(row, 24) + " 추가부수:" + datagrid1.valueMatrix(row, 25) + " 특판추가부수:" + datagrid1.valueMatrix(row, 26);
							
							}
							//if (window.alert("전표부수가 변경된 부분이 있습니다.참고사항을 등록하시겠습니까?", "확인", 1) == 1) {
							//datagrid1.hint = "전표부수가 변경된 부분이 있습니다.참고사항을 등록하십시오.";
							//alert("전표부수가 변경된 부분이 있습니다.참고사항을 등록하십시오.");
							//}
						}
					}
					]]>
				</script>
				<hint/>
			</datagrid>
			<button id="button3" class="btn_grid03" crud="C" style="left:811px; top:5px; width:52px; height:17px; ">
				<caption>행입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var issu_dt	= model.getValue("/root/reqData/searchData/issu_dt");
					var prt_dt	= model.getValue("/root/reqData/searchData/prt_dt");
					var fac_clsf	= model.getValue("/root/reqData/searchData/fac_clsf");
					
					var iSelectedRow = 0;
					if(addRow1()) {
						iSelectedRow = datagrid1.row;
						model1.setValue("/root/resData/gridData/record["+iSelectedRow+"]/issu_dt", issu_dt);
						model1.setValue("/root/resData/gridData/record["+iSelectedRow+"]/prt_dt", prt_dt);
						model1.setValue("/root/resData/gridData/record["+iSelectedRow+"]/fac_clsf", fac_clsf);
						model1.setValue("/root/resData/gridData/record["+iSelectedRow+"]/pap_std", 'L');
						model1.setValue("/root/resData/gridData/record["+iSelectedRow+"]/dual_out_clsf", '02');
						model1.setValue("/root/resData/gridData/record["+iSelectedRow+"]/duty_ovt_prt_yn", 'Y');
					}
					/*
				        datagrid2.addRow(true, true);	
						
					var hdqt_paper_clsf=	model1.getValue("/root/resData/gridData1/record/hdqt_paper_clsf");
					//var fac_clsf=     model1.getValue("/root/reqData/searchData/fac_clsf");
				       if(hdqt_paper_clsf==""){
				       	hdqt_paper_clsf="04";
				       }
				      
				       	model1.makeNode("/root/resData/gridData1/record["+datagrid2.row+"]/hdqt_paper_clsf")
					model1.setValue("/root/resData/gridData1/record["+datagrid2.row+"]/hdqt_paper_clsf",hdqt_paper_clsf);
				//       model1.setValue("/root/resData/gridData/record["+datagrid1.row+"]/fac_clsf",fac_clsf);
						model1.makeNode("/root/resData/resForm/temp");						
						model1.setValue("/root/resData/resForm/temp", "1"); 
						model1.refresh();
				     */
 					]]>
				</script>
			</button>
			<button id="button7" class="btn_grid03" crud="C" style="left:871px; top:5px; width:52px; height:17px; ">
				<caption>행삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.makeNode("/root/resData/resForm/temp");						
						model1.setValue("/root/resData/resForm/temp", "1"); 
						
						var rowValue = datagrid1.valueMatrix(datagrid1.row, 1);
						
						model.setValue("/root/reqData/searchData3/issu_dt", datagrid1.valueMatrix(datagrid1.row, datagrid1.colRef("issu_dt")));
						model.setValue("/root/reqData/searchData3/fac_clsf", datagrid1.valueMatrix(datagrid1.row, datagrid1.colRef("fac_clsf")));
						model.setValue("/root/reqData/searchData3/medi_cd", datagrid1.valueMatrix(datagrid1.row, datagrid1.colRef("medi_cd")));
						model.setValue("/root/reqData/searchData3/sect_cd", datagrid1.valueMatrix(datagrid1.row, datagrid1.colRef("sect_cd")));
						
						//행삭제시 부재료출고매체를 체크하도록 추가 2013.12.12. 김성미. (황우주 과장 요청)
						model.send("pr_prtexec_5080");
						if(submit_completed()) {		
							
							//alert(rowValue);
							//datagrid1.deleteRow(datagrid1.row);
							rowValue = datagrid1.rowStatus(datagrid1.row);
							//alert(rowValue);
							if(rowValue != "1"){ // 번호가 있으면 빨간색 표시
								datagrid1.addStatus(datagrid1.row, "delete");
								
							}else{ // 번호가 없으면 행삭제
								
								datagrid1.deleteRow(datagrid1.row);
							}
						}
						
					]]>
				</script>
			</button>
			<caption id="caption1" class="list_cap01" style="left:0px; top:0px; width:195px; height:24px; text-align:center; ">본지 및 본사용지 사용 외간</caption>
			<!--
			<button id="button17" class="btn_grid03" crud="C" style="left:700px; top:5px; width:110px; height:17px; background-image:../../../images/btn_s_8.gif; ">
				<caption>전표부수 변경확인</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var cell			= datagrid1.selectedCells;
					if(cell.length < 1){
						alert("select a Cell");
						return;
					}
					var col			= cell.item(0).col;
					var row			= cell.item(0).row;
					
					if (datagrid1.valueMatrix(row, datagrid1.colRef("chg_yn")) == "Y") {
						alert("판매 전표부수에 대한 정보가 저장된 정보와 다르지 않습니다. ");
						return;
					}
					model1.setValue("/root/reqData/searchDetail/occr_dt", datagrid1.valueMatrix(row, datagrid1.colRef("occr_dt")));
					model1.setValue("/root/reqData/searchDetail/seq", datagrid1.valueMatrix(row, datagrid1.colRef("seq")));
					
					model.send("pr_prtexec_5011");
					
					if(submit_completed()) {
						alert("저장되었습니다.");
						model.setValue("/root/reqData/searchData/prt_dt", "");
						input2.refresh();
							
						button8.dispatch("onclick");
							
						datagrid1.clearStatus();
					}
 					]]>
				</script>
			</button>
			-->
			<button id="button19" class="btn_grid03" crud="A" style="left:695px; top:5px; width:110px; height:17px; background-image:../../../images/btn_s_8.gif; ">
				<caption>발송일지 조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if (model.getValue("/root/reqData/searchData/issu_dt") == ""){
						alert("조회하고자하는 발행일자를 입력해주십시오.");
						return;
					}
					model.setValue("/root/reqData/fwdData/issu_dt", model.getValue("/root/reqData/searchData/issu_dt"));
					
					window.load("/xrw/pr/prtexec/PR_PRTEXEC_5030.xrw"
						, "modal" 
						, ""
						, "left:100; top:100; width:720; height:450; align:center;sysmenu:hidden; min:hidden; max:hidden; resize:false; caption:hidden;"
						, "/root/reqData/fwdData"
						, "/root/reqData/fwdData"
					);
 					]]>
				</script>
			</button>
			<button id="button20" class="btn_grid03" crud="A" style="left:630px; top:5px; width:61px; height:17px; background-image:../../../images/btn_s_8.gif; ">
				<caption>면수확인</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if (model.getValue("/root/reqData/searchData/issu_dt") == ""){
						alert("조회하고자하는 발행일자를 입력해주십시오.");
						return;
					}
					
					model.setValue("/root/reqData/searchData2/issu_dt", model.getValue("/root/reqData/searchData/issu_dt"));
					model.send("pr_prtexec_5021");
					
					//var cho;
					var msg = model.getValue("/root/tempData/pcnt_compare");
					var clos_yn =  model.getValue("/root/tempData/clos_yn");
					
					//model.setValue(msg, "/root/tempData/pcnt_compare");
					//model.setValue(clos_yn, "/root/tempData/clos_yn");
					alert(msg);
					alert("마감여부 : " + clos_yn);
					/*
					if (window.alert("마감취소하시겠습니까?" ,"조선일보MIS", 1) =! 1) {
							return;
					} 
					*/
					var clos_order;
					if (clos_yn == "N") {
						clos_order = window.alert("마감하시겠습니까?" ,"조선일보MIS", 1);
						
						if(clos_order == "1") {
							model.setValue("/root/reqData/searchData2/clos_yn", clos_yn);
							model.send("pr_prtexec_5022");
						} else {
							return;
						}
					} else {
						clos_order = window.alert("마감취소하시겠습니다?" ,"조선일보MIS", 1);
						
						if(clos_order == "1") {
							model.setValue("/root/reqData/searchData2/clos_yn", clos_yn);
							model.send("pr_prtexec_5022");
						} else {
							return;
						}
					}
					
					
						/*
					if (clos_yn == "N" ) {
						if (window.alert("마감취소하시겠습니까?" ,"조선일보MIS", 1) =! 1) {
							return;
						} else {
							alert("마감");
						}
					}else {
						if (window.alert(" 마감취소하시겠습니까?" ,"조선일보MIS", 1) =! 1) {
							return;
						} else {
							alert("마감취소");
						}
					}				    
					*/
 					]]>
				</script>
			</button>
		</group>
		<group id="group4" style="left:10px; top:535px; width:925px; height:145px; ">
			<datagrid id="datagrid2" nodeset="/root/resData/gridData1/record" caption="발행일자^인쇄일자^공장구분^매체^섹션^인쇄구분^규격^발행면^칼라^흑백^전표부수^면수제외여부^부수포함여부^참고사항^caption1^caption2^caption3^caption5^caption4" colsep="#" colwidth="90, 90, 110, 110, 120, 120, 50, 50, 45, 45, 70, 90, 90, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:0px; top:25px; width:925px; height:120px; ">
				<col class="req" ref="issu_dt" type="inputdate" format="yyyy-mm-dd" style="left:20px; top:20px; width:100px; height:20px; "/>
				<col class="req" ref="prt_dt" type="inputdate"/>
				<col class="req" ref="fac_clsf" type="combo" maxlength="2" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/fac_clsf_2/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col id="medi_cd_2" class="req" ref="medi_cd" type="combo" maxlength="3" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/oth_medi/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col class="req" ref="sect_cd" type="combo" maxlength="4" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/oth_medi_2/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col class="req" ref="prt_clsf" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/prt_clsf/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col class="req" ref="pap_std" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/pap_std/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col class="req" ref="issu_pcnt" type="input" maxlength="3" style="text-align:right; "/>
				<col class="req" ref="clr_pcnt" type="input" maxlength="2" style="text-align:right; "/>
				<col class="req" ref="bw_pcnt" type="input" maxlength="2" style="text-align:right; "/>
				<col class="req" ref="slip_qty" type="input" format="#,###" maxlength="10" style="text-align:right; "/>
				<col editmode="inputsearch" ref="is_cnt_ex_yn" type="combo" maxlength="1">
					<choices>
						<item>
							<label>Y</label>
							<value>Y</value>
						</item>
						<item>
							<label>N</label>
							<value>N</value>
						</item>
					</choices>
				</col>
				<col editmode="inputsearch" ref="is_qty_inc_yn" type="combo" maxlength="1">
					<choices>
						<item>
							<label>Y</label>
							<value>Y</value>
						</item>
						<item>
							<label>N</label>
							<value>N</value>
						</item>
					</choices>
				</col>
				<col ref="remk" type="input"/>
				<col ref="hdqt_paper_clsf" visibility="hidden"/>
				<col ref="seq" visibility="hidden"/>
				<col ref="occr_dt" visibility="hidden"/>
				<col ref="clos_clsf" visibility="hidden"/>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var cell			= datagrid2.selectedCells;
					if(cell.length < 1){
						alert("select a Cell");
						return;
					}
					var col			= cell.item(0).col;
					var row			= cell.item(0).row;
					
					if (datagrid2.col== 9 || datagrid2.col== 10) {
						if (datagrid2.valueMatrix(row, 8) == ""){
							alert("발행면수를 먼저 입력해주십시오.");
							return;
						}
						if (datagrid2.col== 9 ) {
							datagrid2.valueMatrix(row, 10) = eval(datagrid2.valueMatrix(row, 8)) - eval(datagrid2.valueMatrix(row, 9));
						}
						if (datagrid2.col== 10 ) {
							datagrid2.valueMatrix(row, 9) = eval(datagrid2.valueMatrix(row, 8)) - eval(datagrid2.valueMatrix(row, 10));
						}
						
						if (eval(datagrid2.valueMatrix(row, 8)) != eval(datagrid2.valueMatrix(row, 9))  + eval(datagrid2.valueMatrix(row, 10))){
							alert("발행면수가 컬러면수 흑백면수의 합과 일치하지 않습니다.");
							return;
						}
					}
					if (datagrid2.col== 8) {
						if (datagrid2.valueMatrix(row, 9) != "" && datagrid2.valueMatrix(row, 10) == ""){
							if (eval(datagrid2.valueMatrix(row, 8)) != eval(datagrid2.valueMatrix(row, 9))  + eval(datagrid2.valueMatrix(row, 10))){
								alert("발행면수가 컬러면수 흑백면수의 합과 일치하지 않습니다.");
								return;
							}
						}
					}
										
					if (datagrid2.col == 5) {
						datagrid2.valueMatrix(row, 6) = "01";
					}
					
					
					]]>
				</script>
			</datagrid>
			<button id="button12" class="btn_grid03" crud="C" style="left:811px; top:5px; width:52px; height:17px; ">
				<caption>행입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var issu_dt = model.getValue("/root/reqData/searchData/issu_dt");
					var prt_dt = model.getValue("/root/reqData/searchData/prt_dt");
					var fac_clsf	= model.getValue("/root/reqData/searchData/fac_clsf");
					
					var iSelectedRow = 0;
					
					if(addRow2()) {
						iSelectedRow = datagrid2.row;
						model1.setValue("/root/resData/gridData1/record["+iSelectedRow+"]/issu_dt", issu_dt);
						model1.setValue("/root/resData/gridData1/record["+iSelectedRow+"]/prt_dt", prt_dt);
						model1.setValue("/root/resData/gridData1/record["+iSelectedRow+"]/fac_clsf", fac_clsf);
						model1.setValue("/root/resData/gridData1/record["+iSelectedRow+"]/pap_std", 'L');
						model1.setValue("/root/resData/gridData1/record["+iSelectedRow+"]/medi_cd", '610');
						//model1.setValue("/root/resData/gridData1/record["+iSelectedRow+"]/dual_out_clsf", '02');
						//model1.setValue("/root/resData/gridData1/record["+iSelectedRow+"]/duty_ovt_prt_yn", 'Y');
					}
					
					
					/*
					var iSelectedRow = 0;
					if(addRow2()) {
						iSelectedRow = datagrid2.row;
						model1.setValue("/root/resData/gridData1/record["+iSelectedRow+"]/issu_dt", getCurrentDate());
						//medi_cd_2.select(1);
						
						model1.setValue("/root/resData/gridData1/record["+iSelectedRow+"]/medi_cd", "621");
					}
					
					
					datagrid2.addRow(true, true);	
						
					var hdqt_paper_clsf=	model1.getValue("/root/resData/gridData1/record/hdqt_paper_clsf");
					//var fac_clsf=     model1.getValue("/root/reqData/searchData/fac_clsf");
				       if(hdqt_paper_clsf==""){
				       	hdqt_paper_clsf="04";
				       }
				      
				       	model1.makeNode("/root/resData/gridData1/record["+datagrid2.row+"]/hdqt_paper_clsf")
					model1.setValue("/root/resData/gridData1/record["+datagrid2.row+"]/hdqt_paper_clsf",hdqt_paper_clsf);
				//       model1.setValue("/root/resData/gridData/record["+datagrid1.row+"]/fac_clsf",fac_clsf);
						model1.makeNode("/root/resData/resForm/temp");						
						model1.setValue("/root/resData/resForm/temp", "1"); 
						model1.refresh();
				     */
 					]]>
				</script>
			</button>
			<button id="button13" class="btn_grid03" crud="C" style="left:871px; top:5px; width:52px; height:17px; ">
				<caption>행삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.makeNode("/root/resData/resForm/temp");						
						model1.setValue("/root/resData/resForm/temp", "1"); 
						
						var rowValue = datagrid2.valuematrix(datagrid2.row, 1);						
						
						if(rowValue != ""){ // 번호가 있으면 빨간색 표시
							
							datagrid2.addStatus(datagrid2.row, "delete");	
							
						}else{ // 번호가 없으면 행삭제
							
							datagrid2.deleteRow(datagrid2.row);
						}
					]]>
				</script>
			</button>
			<caption id="caption2" class="list_cap01" style="left:0px; top:0px; width:195px; height:24px; text-align:center; ">외부 용지 사용 외간</caption>
		</group>
		<group id="group5" style="left:10px; top:410px; width:925px; height:120px; ">
			<caption id="caption7" class="list_cap01" style="left:0px; top:0px; width:195px; height:24px; text-align:center; ">선인쇄</caption>
			<datagrid id="datagrid3" nodeset="/root/resData/gridData2/record" caption="발행일자^인쇄일자^공장구분^매체^섹션^인쇄구분^규격^제지사^발행면^칼라^흑백^전표부수^면수제외여부^부수포함여부^참고사항^caption1^caption2^caption3^caption5^caption4" colsep="#" colwidth="84, 84, 80, 100, 110, 100, 40, 110, 50, 40, 40, 65, 90, 90, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="free" style="left:0px; top:25px; width:925px; height:95px; ">
				<col class="req" ref="issu_dt" type="inputdate" format="yyyy-mm-dd" style="left:20px; top:20px; width:100px; height:20px; "/>
				<col class="req" ref="prt_dt" type="inputdate"/>
				<col class="req" ref="fac_clsf" type="combo" maxlength="2" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/fac_clsf_2/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col id="col1" class="req" ref="medi_cd" type="combo" maxlength="3" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/medi_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col class="req" ref="sect_cd" type="combo" editmode="search" maxlength="4" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/sect_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col class="req" ref="prt_clsf" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/prt_clsf/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col class="req" ref="pap_std" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/pap_std/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col class="req" ref="papcmpy_cd" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/papcmpy_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col class="req" ref="issu_pcnt" type="input" maxlength="3" style="text-align:right; "/>
				<col class="req" ref="clr_pcnt" type="input" maxlength="2" style="text-align:right; "/>
				<col class="req" ref="bw_pcnt" type="input" maxlength="2" style="text-align:right; "/>
				<col class="req" ref="slip_qty" type="input" format="#,###" maxlength="10" style="text-align:right; "/>
				<col editmode="inputsearch" ref="is_cnt_ex_yn" type="combo" maxlength="1">
					<choices>
						<item>
							<label>Y</label>
							<value>Y</value>
						</item>
						<item>
							<label>N</label>
							<value>N</value>
						</item>
					</choices>
				</col>
				<col editmode="inputsearch" ref="is_qty_inc_yn" type="combo" maxlength="1">
					<choices>
						<item>
							<label>Y</label>
							<value>Y</value>
						</item>
						<item>
							<label>N</label>
							<value>N</value>
						</item>
					</choices>
				</col>
				<col ref="remk" type="input"/>
				<col ref="hdqt_paper_clsf" visibility="hidden"/>
				<col ref="seq" visibility="hidden"/>
				<col ref="occr_dt" visibility="hidden"/>
				<col ref="clos_clsf" visibility="hidden"/>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var cell			= datagrid3.selectedCells;
					if(cell.length < 1){
						alert("select a Cell");
						return;
					}
					var col			= cell.item(0).col;
					var row			= cell.item(0).row;
					
					cellchanged2();
					
					if (datagrid3.col == 1) {
						if (datagrid3.valueMatrix(row, 1) <= datagrid3.valueMatrix(row, 2)) {
							alert("발행일자는 인쇄일자 이후의 일자를 입력해야 합니다.");
							datagrid3.valueMatrix(row, 1) = "";
							return;
						}
					}
					
					if (datagrid3.col== 10 || datagrid3.col== 11) {
						if (datagrid3.valueMatrix(row, 9) == ""){
							alert("발행면수를 먼저 입력해주십시오.");
							return;
						}
						if (datagrid3.col== 9 ) {
							datagrid3.valueMatrix(row, 10) = eval(datagrid3.valueMatrix(row, 9)) - eval(datagrid3.valueMatrix(row, 11));
						}
						if (datagrid3.col== 10 ) {
							datagrid3.valueMatrix(row, 11) = eval(datagrid3.valueMatrix(row, 9)) - eval(datagrid3.valueMatrix(row, 10));
						}
						
						if (eval(datagrid3.valueMatrix(row, 9)) != eval(datagrid3.valueMatrix(row, 10))  + eval(datagrid3.valueMatrix(row, 11))){
							alert("발행면수가 컬러면수 흑백면수의 합과 일치하지 않습니다.");
							return;
						}
					}
					if (datagrid3.col== 9) {
						if (datagrid3.valueMatrix(row, 10) != "" && datagrid3.valueMatrix(row, 11) == ""){
							if (eval(datagrid3.valueMatrix(row, 9)) != eval(datagrid3.valueMatrix(row, 10))  + eval(datagrid3.valueMatrix(row, 11))){
								alert("발행면수가 컬러면수 흑백면수의 합과 일치하지 않습니다.");
								return;
							}
						}
					}
					if (datagrid3.col == 4) {
						if (datagrid3.valueMatrix(row, 4) != "110"){
							datagrid3.valueMatrix(row, 6) = "01";
						}
						if (datagrid3.valueMatrix(row, 4) != "110" && datagrid3.valueMatrix(row, 4) != "610"){
							datagrid3.valueMatrix(row, 5) = "0100";
						}
					}
					
					if (datagrid3.col == 6) {
						if (datagrid3.valueMatrix(row, 4) == "110"){
							if (datagrid3.valueMatrix(row, 5) == "0100"){
								datagrid3.valueMatrix(row, 6) = "01";
							} else if (datagrid3.valueMatrix(row, 6) == "0200"){
								datagrid3.valueMatrix(row, 6) = "11";
							} else {
								datagrid3.valueMatrix(row, 6) = "21";
							}
						} else if (datagrid3.valueMatrix(row, 4) == "610"){
							datagrid3.valueMatrix(row,6) = "01";
						}
					}
					
					]]>
				</script>
			</datagrid>
			<button id="button9" class="btn_grid03" crud="C" style="left:811px; top:5px; width:52px; height:17px; ">
				<caption>행입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var issu_dt = model.getValue("/root/reqData/searchData/issu_dt");
					if(model.getValue("/root/reqData/searchData/issu_dt") == '') {
						alert("발행일자를 입력해주세요");
						return;
					}
					var prt_dt = model.getValue("/root/reqData/searchData/issu_dt");
					//var prt_dt = commCurDate("ymd");
					//var prt_dt = model1.getValue("/root/reqData/searchData/issu_dt");
					
					var fac_clsf	= model.getValue("/root/reqData/searchData/fac_clsf");
					
					var iSelectedRow = 0;
					
					if(addRow3()) {
						iSelectedRow = datagrid3.row;
						model1.setValue("/root/resData/gridData2/record["+iSelectedRow+"]/prt_dt", prt_dt);
						datagrid3.isReadOnly(iSelectedRow, 2, iSelectedRow, 2) = true;
						model1.setValue("/root/resData/gridData2/record["+iSelectedRow+"]/fac_clsf", fac_clsf);
						model1.setValue("/root/resData/gridData2/record["+iSelectedRow+"]/pap_std", 'L');
						//model1.setValue("/root/resData/gridData1/record["+iSelectedRow+"]/dual_out_clsf", '02');
						//model1.setValue("/root/resData/gridData1/record["+iSelectedRow+"]/duty_ovt_prt_yn", 'Y');
					}
					
					
					/*
					var iSelectedRow = 0;
					if(addRow2()) {
						iSelectedRow = datagrid2.row;
						model1.setValue("/root/resData/gridData1/record["+iSelectedRow+"]/issu_dt", getCurrentDate());
						//medi_cd_2.select(1);
						
						model1.setValue("/root/resData/gridData1/record["+iSelectedRow+"]/medi_cd", "621");
					}
					
					
					datagrid2.addRow(true, true);	
						
					var hdqt_paper_clsf=	model1.getValue("/root/resData/gridData1/record/hdqt_paper_clsf");
					//var fac_clsf=     model1.getValue("/root/reqData/searchData/fac_clsf");
				       if(hdqt_paper_clsf==""){
				       	hdqt_paper_clsf="04";
				       }
				      
				       	model1.makeNode("/root/resData/gridData1/record["+datagrid2.row+"]/hdqt_paper_clsf")
					model1.setValue("/root/resData/gridData1/record["+datagrid2.row+"]/hdqt_paper_clsf",hdqt_paper_clsf);
				//       model1.setValue("/root/resData/gridData/record["+datagrid1.row+"]/fac_clsf",fac_clsf);
						model1.makeNode("/root/resData/resForm/temp");						
						model1.setValue("/root/resData/resForm/temp", "1"); 
						model1.refresh();
				     */
 					]]>
				</script>
			</button>
			<button id="button15" class="btn_grid03" crud="C" style="left:871px; top:5px; width:52px; height:17px; ">
				<caption>행삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.makeNode("/root/resData/resForm/temp");						
						model1.setValue("/root/resData/resForm/temp", "1"); 
						
						var rowValue = datagrid3.valuematrix(datagrid3.row, 1);
						
						if(rowValue != ""){ // 번호가 있으면 빨간색 표시
							
							datagrid3.addStatus(datagrid3.row, "delete");
							
						}else{ // 번호가 없으면 행삭제
							
							datagrid3.deleteRow(datagrid3.row);
						}
					]]>
				</script>
			</button>
		</group>
		<select1 id="combo4" ref="/root/reqData/reqForm/issu_qty" appearance="minimal" style="left:750px; top:685px; width:185px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/issu_qty/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
	</xhtml:body>
</xhtml:html>
