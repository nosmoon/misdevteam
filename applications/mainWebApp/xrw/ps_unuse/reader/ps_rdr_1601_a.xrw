<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="/css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<mcCombo>
								<item>
									<label/>
									<value/>
								</item>
							</mcCombo>
							<moCombo>
								<item>
									<label/>
									<value/>
								</item>
							</moCombo>
							<cashCombo>
								<item>
									<label/>
									<value/>
								</item>
							</cashCombo>
							<branchCombo>
								<item>
									<label/>
									<value/>
								</item>
							</branchCombo>
							<moCombo2>
								<item>
									<label/>
									<value/>
								</item>
							</moCombo2>
							<errCombo>
								<item>
									<label/>
									<value/>
								</item>
							</errCombo>
							<mcCombo2>
								<item>
									<label/>
									<value/>
								</item>
							</mcCombo2>
							<cashCombo2>
								<item>
									<label/>
									<value/>
								</item>
							</cashCombo2>
						</comboSet>
						<pageInfo/>
					</initData>
					<reqData>
						<fwdData/>
						<searchData/>
						<reqform>
							<search_form>
								<hd_prn1/>
								<sh_dtlsprocstat/>
								<pageno/>
								<pagesize/>
								<sh_apl_nm/>
								<js_fn_nm/>
								<hd_apl_nm/>
								<hd_medicd/>
								<search_type/>
								<sh_aplcdt_to/>
								<hd_dtlsprocstat/>
								<hd_phone2/>
								<sh_medicd/>
								<sh_prn2/>
								<sh_phone1/>
								<hd_phone1/>
								<hd_rdr_nm/>
								<hd_cashrcptstat/>
								<hd_aplcdt_to/>
								<sh_aplcdt_fr/>
								<sh_prn1/>
								<hd_dtlsprocclsf/>
								<sh_rdr_nm/>
								<sh_rdr_no/>
								<sh_phone3/>
								<hd_phone3/>
								<hd_rdr_no/>
								<hd_prn2/>
								<sh_phone2/>
								<hd_aplcdt_fr/>
								<sh_cashrcptstat/>
							</search_form>
							<grad_form>
								<aplcdt2/>
								<medicd3/>
								<rdr_no3/>
								<aplcno2/>
								<aplcdt1/>
								<bocd0/>
								<dtlsprocstat0/>
								<medicd0/>
								<aplcno1/>
								<chkseq0/>
								<grad_check0/>
								<aplcdt0/>
								<rdr_no0/>
								<dtlsprocstat4/>
								<rdr_no4/>
								<chkseq1/>
								<onlmembseq3/>
								<aplcno0/>
								<aplcno3/>
								<rdr_no2/>
								<bocd1/>
								<cashrcptstat4/>
								<aplcdt3/>
								<onlmembseq1/>
								<dtlsprocstat2/>
								<bocd4/>
								<chkseq4/>
								<onlmembseq0/>
								<chkseq3/>
								<listcnt/>
								<medicd4/>
								<bocd3/>
								<onlmembseq2/>
								<aplcno4/>
								<bocd2/>
								<rdr_no1/>
								<chkseq2/>
								<dtlsprocstat1/>
								<medicd1/>
								<aplcdt4/>
								<onlmembseq4/>
								<dtlsprocstat3/>
								<medicd2/>
								<errresncd0/>
								<errresncd1/>
								<errresncd2/>
								<errresncd3/>
								<errresncd4/>
								<grad_check1/>
								<grad_check2/>
								<grad_check3/>
								<grad_check4/>
								<rdrgrad0/>
								<rdrgrad1/>
								<rdrgrad2/>
								<rdrgrad3/>
								<rdrgrad4/>
								<cashrcptstat0/>
								<cashrcptstat1/>
								<cashrcptstat2/>
								<cashrcptstat3/>
							</grad_form>
							<mpsearch_form>
								<bocd_p/>
								<medicd_p/>
								<rdr_no_p/>
							</mpsearch_form>
							<search_form2>
								<sh_phone1/>
								<hd_rownum/>
								<hd_phone1/>
								<hd_searnm/>
								<pageno/>
								<pagesize/>
								<sh_phone3/>
								<hd_phone3/>
								<sh_searcd/>
								<js_fn_nm/>
								<hd_searcd/>
								<hd_medicd/>
								<sh_phone2/>
								<sh_searnm/>
								<hd_phone2/>
								<sh_medicd/>
							</search_form2>
							<temp_form>
								<grid_index/>
							</temp_form>
						</reqform>
						<multiUpDate/>
					</reqData>
					<resData>
						<resform/>
						<gridData>
							<listGrid>
								<record>
									<regdt/>
									<regno/>
									<rdr_no/>
									<medicd/>
									<medinm/>
									<fstsubsdt/>
									<dtlsprocstat/>
									<dtlsprocstatnm/>
									<errresncd/>
									<errresncdnm/>
									<bocd/>
									<bonm/>
									<id/>
									<entr_no/>
									<memb_nm_korn/>
									<rdrnm/>
									<prn/>
									<email/>
									<ceph_no_1/>
									<ceph_no_2/>
									<zip/>
									<addr/>
									<dtlsaddr/>
									<home_tel_no/>
									<subspersrshpcd/>
									<memb_kind_cd/>
									<procdt/>
									<recnm/>
									<recdt/>
									<recprn/>
									<recstat/>
									<cashstatnm/>
									<suspdt/>
									<mblefrdt/>
									<mbleexpydt/>
									<mblestatcd/>
									<mblenonrsmgcd/>
									<rnum/>
								</record>
							</listGrid>
							<detailGrid>
								<record>
									<rdr_no/>
									<onlmembid/>
									<onlmembseq/>
									<rdrnm/>
									<prn/>
									<email/>
									<rdrgrad/>
									<subsdt/>
									<suspdt/>
									<medicd/>
									<medinm/>
									<termsubsno/>
									<bocd/>
									<bonm/>
									<aplcdt/>
									<subsfrser_no/>
									<substoser_no/>
									<rdrtel_no1/>
									<rdrtel_no2/>
									<rdrtel_no3/>
									<rdrptph_no1/>
									<rdrptph_no2/>
									<rdrptph_no3/>
									<rdroffinm/>
									<rdroffitel_no1/>
									<rdroffitel_no2/>
									<rdroffitel_no3/>
									<dlvzip/>
									<dlvaddr/>
									<dlvdtlsaddr/>
									<rnum/>
								</record>
							</detailGrid>
						</gridData>
						<MsgData/>
					</resData>
					<tempData>
						<keyData/>
					</tempData>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					init();
				]]>
			</script>
			<submission id="PID1601subInit" action="/ps/reader/1601" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData/initTemp"/>
			<submission id="PID1606search" action="/ps/reader/1606" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqform/search_form" resultref="/root/tempData/dataTemp"/>
			<submission id="PID1621search" action="/ps/reader/1621" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqform/search_form2" resultref="/root/tempData/dataTemp"/>
			<submission id="PID1611save" action="/ps/reader/1611" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqform/grad_form" resultref="/root/tempData/dataTemp"/>
		</model>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/CRMComm.js"/>
		<script type="javascript" src="/js/common.js"/>
		<script type="javascript">
			<![CDATA[			
				function init()
				{
					model.send("PID1601subInit", false);
					
					PID1601multilinegrid1.fixedcellcheckbox(0, PID1601multilinegrid1.colRef("check"),1, true) = true;

					//model.setValue("/root/reqData/reqform/search_form/records_per_page", model.getValue("/root/tempData/initTemp/recordPerPage"));
					model.setValue("/root/reqData/reqform/search_form/pageno", "1");

					//model.setValue("/root/reqData/reqform/search_form/pagesize", model.getValue("/root/tempData/initTemp/showRecCnt"));
					model.setValue("/root/reqData/reqform/search_form/pagesize", "5");
					model.setValue("/root/reqData/reqform/search_form/js_fn_nm", "list_search");
					
					model.setValue("/root/reqData/reqform/grad_form/listcnt", model.getValue("/root/tempData/initTemp/showRecCnt"));
					
					model.setValue("/root/reqData/reqform/search_form/sh_aplcdt_fr", model.getValue("/root/tempData/initTemp/defaultFrom"));
					model.setValue("/root/reqData/reqform/search_form/sh_aplcdt_to", model.getValue("/root/tempData/initTemp/defaultTo"));

					model.copyNode("/root/initData/comboSet/mcCombo", "/root/tempData/initTemp/mcCombo");
					model.copyNode("/root/initData/comboSet/moCombo", "/root/tempData/initTemp/moCombo");
					model.copyNode("/root/initData/comboSet/cashCombo", "/root/tempData/initTemp/cashCombo");
					model.copyNode("/root/initData/comboSet/branchCombo", "/root/tempData/initTemp/branchCombo");
					model.copyNode("/root/initData/comboSet/moCombo2", "/root/tempData/initTemp/moCombo2");
					model.copyNode("/root/initData/comboSet/errCombo", "/root/tempData/initTemp/errCombo");
					model.copyNode("/root/initData/comboSet/mcCombo2", "/root/tempData/initTemp/mcCombo2");

					model.removenode("/root/tempData/initTemp");
					
					model.refresh();
					PID1601combo1.select(0);
					PID1601combo2.select(0);
					PID1601combo3.select(0);
					PID1601combo4.select(0);
					PID1601combo8.select(0);
				}
				
				function search(flag)
				{        
					if(!commValidate(PID1601group_scr))
						return;
					
        				modelCopyValue("/root/reqData/reqform/search_form/hd_aplcdt_fr", "/root/reqData/reqform/search_form/sh_aplcdt_fr");
        				modelCopyValue("/root/reqData/reqform/search_form/hd_aplcdt_to", "/root/reqData/reqform/search_form/sh_aplcdt_to");
        				modelCopyValue("/root/reqData/reqform/search_form/hd_medicd", "/root/reqData/reqform/search_form/sh_medicd");
        				modelCopyValue("/root/reqData/reqform/search_form/hd_rdr_no", "/root/reqData/reqform/search_form/sh_rdr_no");
        				modelCopyValue("/root/reqData/reqform/search_form/hd_apl_nm", "/root/reqData/reqform/search_form/sh_apl_nm");
        				modelCopyValue("/root/reqData/reqform/search_form/hd_rdr_nm", "/root/reqData/reqform/search_form/sh_rdr_nm");
        				modelCopyValue("/root/reqData/reqform/search_form/hd_prn1", "/root/reqData/reqform/search_form/sh_prn1");
        				modelCopyValue("/root/reqData/reqform/search_form/hd_prn2", "/root/reqData/reqform/search_form/sh_prn2");
        				modelCopyValue("/root/reqData/reqform/search_form/hd_phone1", "/root/reqData/reqform/search_form/sh_phone1");
        				modelCopyValue("/root/reqData/reqform/search_form/hd_phone2", "/root/reqData/reqform/search_form/sh_phone2");
        				modelCopyValue("/root/reqData/reqform/search_form/hd_phone3", "/root/reqData/reqform/search_form/sh_phone3");
        				modelCopyValue("/root/reqData/reqform/search_form/hd_dtlsprocstat", "/root/reqData/reqform/search_form/sh_dtlsprocstat");
        				modelCopyValue("/root/reqData/reqform/search_form/hd_cashrcptstat", "/root/reqData/reqform/search_form/sh_cashrcptstat");
        									
					model.setValue("/root/reqData/reqform/search_form/search_type", flag);
										
					if(flag == 'M') {
						model.setValue("/root/reqData/reqform/search_form/sh_cashrcptstat", "");
						PID1601combo8.disabled = true;
						PID1601combo2.disabled = false;
						PID1601combo2.select(0);
					 } else if(flag == 'C') {
					 	PID1601combo2.disabled = true;
					 	PID1601combo8.disabled = false;
					 	PID1601combo8.select(0);
						model.setValue("/root/reqData/reqform/search_form/sh_dtlsprocstat", "");
					 }
					 					 					
					remakeNode("/root/tempData/dataTemp");
										
					model.send("PID1606search", false);
					
					model.copyNode("/root/initData/comboSet/branchCombo", "/root/tempData/dataTemp/branchCombo");
					model.copyNode("/root/initData/comboSet/moCombo2", "/root/tempData/dataTemp/moCombo2");
					model.copyNode("/root/initData/comboSet/errCombo", "/root/tempData/dataTemp/errCombo");
					model.copyNode("/root/initData/comboSet/cashCombo2", "/root/tempData/dataTemp/cashCombo2");
										
				       model.copyNode("/root/resData/gridData/listGrid", "/root/tempData/dataTemp/listGrid");
				       
					model.removenode("/root/tempData/dataTemp");

					if(instance1.selectNodes("/root/resData/gridData/listGrid/record/regdt").length == 0)
						model.alert("검색결과가 없습니다.");

					/*for(var i=2; i<PID1601multilinegrid1.rows; i++) {
						//PID1601multilinegrid1.textMatrix(PID1601multilinegrid1.row, PID1601multilinegrid1.colRef("bocd"))
						PID1601multilinegrid1.colDisabled(6) = true;
					}*/
															
					PID1601multilinegrid1.rebuild();
					model.refresh();
					
					/*alert(PID1601multilinegrid1.textMatrix(0, PID1601multilinegrid1.colRef("regdt")));
					alert(PID1601multilinegrid1.textMatrix(1, PID1601multilinegrid1.colRef("regdt")));
					alert(PID1601multilinegrid1.textMatrix(2, PID1601multilinegrid1.colRef("regdt")));
					alert(PID1601multilinegrid1.textMatrix(3, PID1601multilinegrid1.colRef("regdt")));
					alert(PID1601multilinegrid1.textMatrix(4, PID1601multilinegrid1.colRef("regdt")));*/
					
					//PID1601multilinegrid1.cellattribute("disabled", 2, PID1601multilinegrid1.colRef("bocd"), "", "") = true;
					
					//gridCellAttribute(PID1601multilinegrid1, "disabled", true, 2, "bocd", "", "");
					//PID1601combo2.disable
					//gridCellAttribute("PID1601multilinegrid1", "disabled", true, "4", "8", "", "");
					
					
					//PID1601multilinegrid1.colDisabled
					//for(var i=4; i<PID1601multilinegrid1.rows; i++) {
						//PID1601multilinegrid1.colDisabled(PID1601multilinegrid1.colRef("bocd")) = true;
	//				gridCellAttribute("PID1601multilinegrid1", disabled, true, 5, 8);
					//}
				}
										
				function onClickGridCell(flag)
				{
					model.setValue("/root/reqData/reqform/search_form2/pageno", "1");
					model.setValue("/root/reqData/reqform/search_form2/pagesize", "10");
					model.setValue("/root/reqData/reqform/search_form2/js_fn_nm", "list_search");
					
					if(flag == 1) {
						model.setValue("/root/reqData/reqform/search_form2/sh_searnm", PID1601multilinegrid1.textMatrix(PID1601multilinegrid1.row, PID1601multilinegrid1.colRef("memb_nm_korn")));
					} else if (flag == 2) {
						model.setValue("/root/reqData/reqform/search_form2/sh_searnm", PID1601multilinegrid1.textMatrix(PID1601multilinegrid1.row, PID1601multilinegrid1.colRef("rdrnm")));
					}				
					
					if(PID1601multilinegrid1.valueMatrix(PID1601multilinegrid1.row, PID1601multilinegrid1.colRef("medicd")) == "")
					{
						return;
					}
					
					model.setValue("/root/reqData/reqform/search_form2/sh_medicd", PID1601multilinegrid1.valueMatrix(PID1601multilinegrid1.row, PID1601multilinegrid1.colRef("medicd")));
					model.setValue("/root/reqData/reqform/search_form2/hd_rownum", PID1601multilinegrid1.valueMatrix(PID1601multilinegrid1.row, PID1601multilinegrid1.colRef("INDEX")));
					model.setValue("/root/reqData/reqform/search_form2/sh_searcd", "NM");
					model.setValue("/root/reqData/reqform/search_form2/sh_phone1", "");
					model.setValue("/root/reqData/reqform/search_form2/sh_phone2", "");
					model.setValue("/root/reqData/reqform/search_form2/sh_phone3", "");
					
					remakeNode("/root/tempData/dataTemp");
					model.send("PID1621search", false);

				       model.copyNode("/root/resData/gridData/detailGrid", "/root/tempData/dataTemp/detailGrid");
				 
					model.removenode("/root/tempData/dataTemp");
					
					model.refresh();
					PID1601multilinegrid2.rebuild();					
				}
				
				function detailSearch()
				{
					var rownum = model.getValue("/root/reqData/reqform/search_form2/hd_rownum");
					var searcd = model.getValue("/root/reqData/reqform/search_form2/sh_searcd");
					var searnm = model.getValue("/root/reqData/reqform/search_form2/sh_searnm");
					var medicd = model.getValue("/root/reqData/reqform/search_form2/sh_medicd");
					var phone1 = model.getValue("/root/reqData/reqform/search_form2/sh_phone1");
					var phone2 = model.getValue("/root/reqData/reqform/search_form2/sh_phone2");
					var phone3 = model.getValue("/root/reqData/reqform/search_form2/sh_phone3");
					
					if(rownum == null || rownum =="") {
						alert("독자선택후 검색하세요");
						return;
					}
					
					model.setValue("/root/reqData/reqform/search_form2/hd_searcd", searcd);
					model.setValue("/root/reqData/reqform/search_form2/hd_searnm", searnm);
					//model.setValue("/root/reqData/reqform/search_form2/hd_medicd", medicd);
					model.setValue("/root/reqData/reqform/search_form2/hd_phone1", phone1);
					model.setValue("/root/reqData/reqform/search_form2/hd_phone2", phone2);
					model.setValue("/root/reqData/reqform/search_form2/hd_phone3", phone3);
							
					if((searnm == null ||searnm == "") &&
					   (phone1 == null || phone1 == "") &&
					   (phone2 == null || phone2 == "") &&
					   (phone3 == null || phone3 == "")) {
						alert("검색어나 전화번호 둘중하나는 필수 입니다.");
						return;
					}
												
					model.setValue("/root/reqData/reqform/search_form2/pageno", "1");
					model.setValue("/root/reqData/reqform/search_form2/pagesize", "10");
					model.setValue("/root/reqData/reqform/search_form2/js_fn_nm", "list_search");
					
					remakeNode("/root/tempData/dataTemp");
					model.send("PID1621search", false);

				       model.copyNode("/root/resData/gridData/detailGrid", "/root/tempData/dataTemp/detailGrid");
				 
					model.removenode("/root/tempData/dataTemp");
					
					if(instance1.selectNodes("/root/resData/gridData/detailGrid/record/aplcdt").length == 0)
						model.alert("검색결과가 없습니다.");

					PID1601multilinegrid2.rebuild();					
				}
				
				function onDetailGridClick()
				{
					if(PID1601multilinegrid2.valueMatrix(PID1601multilinegrid2.row, PID1601multilinegrid2.colRef("rdr_no")) == "")
					{
						return;
					}
					
					var multiIndex = model.getValue("/root/reqData/reqform/search_form2/hd_rownum");
					
					PID1601multilinegrid1.valuematrix(parseInt(multiIndex)+2,1) = "Y";
					PID1601multilinegrid1.textmatrix(parseInt(multiIndex)+2,10) = PID1601multilinegrid2.valueMatrix(PID1601multilinegrid2.row, PID1601multilinegrid2.colRef("rdr_no"));
					PID1601multilinegrid1.valuematrix(parseInt(multiIndex)+2,8) = PID1601multilinegrid2.valueMatrix(PID1601multilinegrid2.row, PID1601multilinegrid2.colRef("bocd"));
				}
				
				function save1()
				{
					for(var i=2; i<PID1601multilinegrid1.rows; i++) {
						
						var post = i - 2;
						var temp_rdr_no = "/root/reqData/reqform/grad_form/rdr_no" + post;
						
						if(PID1601multilinegrid1.valueMatrix(i,PID1601multilinegrid1.colRef("check")) == "Y" ) {	
						
						
							var post = i - 2;
						
							var temp_onlmembseq = "/root/reqData/reqform/grad_form/onlmembseq" + post;
							var temp_aplcdt = "/root/reqData/reqform/grad_form/aplcdt" + post;
							var temp_aplcno = "/root/reqData/reqform/grad_form/aplcno" + post;
							var temp_chkseq = "/root/reqData/reqform/grad_form/chkseq" + post;
							var temp_grad_check = "/root/reqData/reqform/grad_form/grad_check" + post;
							var temp_bocd = "/root/reqData/reqform/grad_form/bocd" + post;
						       var temp_medicd = "/root/reqData/reqform/grad_form/medicd" + post;
						       var temp_rdr_no = "/root/reqData/reqform/grad_form/rdr_no" + post;
						       var temp_rdrgrad = "/root/reqData/reqform/grad_form/rdrgrad" + post;
						       var temp_dtlsprocstat = "/root/reqData/reqform/grad_form/dtlsprocstat" + post;
						       var temp_errresncd = "/root/reqData/reqform/grad_form/errresncd" + post;
						       var temp_cashrcptstat = "/root/reqData/reqform/grad_form/cashrcptstat" + post;
						       var temp_errresncd = "/root/reqData/reqform/grad_form/errresncd" + post;
						    					       
						       model.setValue(temp_onlmembseq, PID1601multilinegrid1.valueMatrix(i, PID1601multilinegrid1.colRef("entr_no")));
						       model.setValue(temp_aplcdt, PID1601multilinegrid1.valueMatrix(i, PID1601multilinegrid1.colRef("regdt")));
						       model.setValue(temp_aplcno, PID1601multilinegrid1.valueMatrix(i, PID1601multilinegrid1.colRef("regno")));
						       model.setValue(temp_chkseq, i);
						       //model.setValue(temp_grad_check, PID1601multilinegrid1.valueMatrix(i, PID1601multilinegrid1.colRef("grad_check")));
						       model.setValue(temp_grad_check, "SEL");
						       model.setValue(temp_bocd, PID1601multilinegrid1.valueMatrix(i, PID1601multilinegrid1.colRef("bocd")));
						       model.setValue(temp_medicd, PID1601multilinegrid1.valueMatrix(i, PID1601multilinegrid1.colRef("medicd")));
						       //model.setValue(temp_rdr_no, PID1601multilinegrid1.valueMatrix(i, PID1601multilinegrid1.colRef("rdr_no")));
						       model.setValue(temp_rdrgrad, PID1601multilinegrid1.valueMatrix(i, PID1601multilinegrid1.colRef("memb_kind_cd")));
						       model.setValue(temp_dtlsprocstat, PID1601multilinegrid1.valueMatrix(i, PID1601multilinegrid1.colRef("dtlsprocstat")));
						       model.setValue(temp_cashrcptstat, PID1601multilinegrid1.valueMatrix(i, PID1601multilinegrid1.colRef("recstat")));
						       //model.setValue(temp_errresncd, PID1601multilinegrid1.valueMatrix(i, PID1601multilinegrid1.colRef("errresncd")));
					       					       
					       
							model.setValue(temp_rdr_no, PID1601multilinegrid1.valueMatrix(i, PID1601multilinegrid1.colRef("rdr_no")));			
						       //alert(PID1601multilinegrid1.valueMatrix(i,PID1601multilinegrid1.colRef("rdr_no")));
					    		if(PID1601multilinegrid1.valueMatrix(i,PID1601multilinegrid1.colRef("dtlsprocstat")) =='30' && PID1601multilinegrid1.valueMatrix(i,PID1601multilinegrid1.colRef("errresncd")) == '') {
						    		alert("독자미확인시에는 오류사유를 선택하셔야 합니다.");
								return;
					    		}
						}
					}
					
					if(model.alert("저장하시겠습니까?", "", 4) == "6") {
						model.send("PID1611save", false);
						
						if(!submit_completed())
							return;
							
						search();
					}
				}				
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" idprefix="PID1601" style="font-family:굴림; ">
		<import id="iv_Title" src="../common/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="grpCommonBtn" class="gro_btn" style="left:10px; top:45px; width:926px; height:21px; ">
			<button id="btnClose" class="btn02" style="left:874px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						close();
					]]>
				</script>
			</button>
		</group>
		<group id="PID1601group_scr" class="gro_sel" style="left:10px; top:70px; width:926px; height:78px; ">
			<caption id="PID1601caption21" class="list_cap02" style="left:803px; top:0px; width:123px; height:25px; "/>
			<caption id="PID1601caption4" class="list_cap02" style="left:79px; top:24px; width:230px; height:25px; "/>
			<caption id="PID1601caption14" class="list_cap01" style="left:308px; top:0px; width:80px; height:25px; ">신청매체</caption>
			<caption id="PID1601caption15" class="list_cap01" style="left:0px; top:0px; width:80px; height:25px; ">신청일자</caption>
			<caption id="PID1601caption20" class="list_cap02" style="left:79px; top:0px; width:230px; height:25px; "/>
			<caption id="PID1601caption8" class="list_cap01" style="left:526px; top:0px; width:80px; height:25px; ">독자번호</caption>
			<caption id="PID1601caption1" class="list_cap02" style="left:387px; top:0px; width:140px; height:25px; "/>
			<caption id="PID1601caption5" class="list_cap02" style="left:605px; top:0px; width:120px; height:25px; "/>
			<caption id="PID1601caption43" class="list_cap02" style="left:387px; top:24px; width:140px; height:25px; "/>
			<caption id="PID1601caption44" class="list_cap02" style="left:605px; top:24px; width:321px; height:25px; "/>
			<caption id="PID1601caption46" class="list_cap01" style="left:308px; top:24px; width:80px; height:25px; ">전화/휴대폰</caption>
			<caption id="PID1601caption47" class="list_cap01" style="left:0px; top:24px; width:80px; height:25px; ">주민번호</caption>
			<caption id="PID1601caption48" class="list_cap01" style="left:526px; top:24px; width:80px; height:25px; ">구독자명</caption>
			<caption id="PID1601caption49" class="list_cap02" style="left:387px; top:53px; width:539px; height:25px; "/>
			<caption id="PID1601caption51" class="list_cap01" style="left:308px; top:53px; width:80px; height:25px; ">현금영수증</caption>
			<caption id="PID1601caption52" class="list_cap02" style="left:79px; top:53px; width:230px; height:25px; "/>
			<caption id="PID1601caption53" class="list_cap01" style="left:0px; top:53px; width:80px; height:25px; ">모플회원</caption>
			<input id="PID1601input1" ref="/root/reqData/reqform/search_form/sh_aplcdt_fr" class="req" inputtype="date" format="yyyy-mm-dd" dataType="datefrom" caption="신청일자" setHandler="true" relid="PID1601input2" style="left:83px; top:4px; width:100px; height:18px; "/>
			<input id="PID1601input2" ref="/root/reqData/reqform/search_form/sh_aplcdt_to" class="req" inputtype="date" format="yyyy-mm-dd" dataType="dateto" caption="신청일자" setHandler="true" relid="PID1601input1" style="left:205px; top:4px; width:100px; height:18px; "/>
			<select1 id="PID1601combo1" ref="/root/reqData/reqform/search_form/sh_medicd" appearance="minimal" style="left:391px; top:4px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/mcCombo/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<input id="PID1601input9" ref="/root/reqData/reqform/search_form/sh_rdr_no" style="left:610px; top:4px; width:100px; height:18px; "/>
			<input id="PID1601input11" ref="/root/reqData/reqform/search_form/sh_apl_nm" style="left:808px; top:4px; width:100px; height:18px; "/>
			<input id="PID1601input13" ref="/root/reqData/reqform/search_form/sh_prn1" format="999999" style="left:84px; top:28px; width:100px; height:18px; "/>
			<input id="PID1601input14" ref="/root/reqData/reqform/search_form/sh_prn2" format="9999999" style="left:189px; top:28px; width:100px; height:18px; "/>
			<input id="PID1601input6" ref="/root/reqData/reqform/search_form/sh_phone1" format="999" style="left:391px; top:28px; width:40px; height:18px; "/>
			<input id="PID1601input7" ref="/root/reqData/reqform/search_form/sh_phone2" format="9999" style="left:436px; top:28px; width:40px; height:18px; "/>
			<input id="PID1601input8" ref="/root/reqData/reqform/search_form/sh_phone3" format="9999" style="left:482px; top:28px; width:40px; height:18px; "/>
			<input id="PID1601input10" ref="/root/reqData/reqform/search_form/sh_rdr_nm" style="left:610px; top:28px; width:100px; height:18px; "/>
			<select1 id="PID1601combo2" ref="/root/reqData/reqform/search_form/sh_dtlsprocstat" appearance="minimal" style="left:83px; top:57px; width:75px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/moCombo/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<button id="PID1601button3" class="btn_grid02" style="left:162px; top:58px; width:42px; height:17px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						search("M");
					]]>
				</script>
			</button>
			<select1 id="PID1601combo8" ref="/root/reqData/reqform/search_form/sh_cashrcptstat" appearance="minimal" style="left:391px; top:57px; width:75px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/cashCombo/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<button id="PID1601button4" class="btn_grid02" style="left:470px; top:58px; width:42px; height:17px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						search("C");
					]]>
				</script>
			</button>
			<caption id="PID1601caption10" style="left:184px; top:4px; width:20px; height:20px; text-align:center; ">-</caption>
			<caption id="PID1601caption24" class="list_cap01" style="left:724px; top:0px; width:80px; height:25px; ">신청자명</caption>
		</group>
		<!--<group id="PID1601group2" style="left:10px; top:440px; width:926px; height:25px; ">
			<iviewer id="PID1601paging" src="../common/iv_common_paging.xrw" style="left:0px; top:0px; width:926px; height:25px; "/>
		</group>-->
		<group id="PID1601group1" style="left:10px; top:430px; width:926px; height:25px; ">
			<caption id="PID1601caption45" class="list_cap03" style="left:0px; top:0px; width:926px; height:25px; text-align:left; ">독자비교검색</caption>
		</group>
		<group id="PID1601group3" style="left:10px; top:155px; width:926px; height:25px; ">
			<caption id="PID1601caption57" class="list_cap03" style="left:0px; top:0px; width:926px; height:25px; text-align:left; ">독자우대가입신청목록</caption>
			<button id="PID1601button7" class="btn_grid02" style="left:880px; top:4px; width:43px; height:17px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						save1();
					]]>
				</script>
			</button>
		</group>
		<multilinegrid id="PID1601multilinegrid1" nodeset="/root/resData/gridData/listGrid/record" caption="^^^신청일자^신청자^구독자^회원아이디^지사^매체^독자번호^모플회원^오류사유^처리일자^현금영수증|^전화/휴대폰^전화/휴대폰^전화/휴대폰^전화/휴대폰^전화/휴대폰^주민번호^이메일^이메일^주소^주소^주소^주소^주소" colsep="^" colwidth="23, 0, 0, 80, 65, 65, 90, 100, 75, 75, 80, 80, 80, 80" ellipsis="true" rowheader="update" rowsep="|" tooltip="true" selectionmode="free" mergecellsfixedrows="bycolrec" style="left:10px; top:180px; width:926px; height:245px; ">
			<row>
				<col checkvalue="Y,N" ref="check" rowspan="2" type="checkbox"/>
				<col ref="INDEX"/>
				<col ref="medicd"/>
				<col ref="regdt" format="yyyy/mm/dd" style="text-align:center; "/>
				<col ref="memb_nm_korn" style="text-align:center; cursor:hand; ">
					<script type="javascript" ev:event="ondblclick">
						<![CDATA[
						if(event.button == 1)
						{
							if(PID1601multilinegrid1.mouseCol>PID1601multilinegrid1.fixedCols-1 && PID1601multilinegrid1.mouseRow>PID1601multilinegrid1.fixedRows-1)
						       {
								onClickGridCell(1);
						       }
						}				
					]]>
					</script>
				</col>
				<col ref="rdrnm" style="text-align:center; cursor:hand; ">
					<script type="javascript" ev:event="ondblclick">
						<![CDATA[
						if(event.button == 1)
						{
							if(PID1601multilinegrid1.mouseCol>PID1601multilinegrid1.fixedCols-1 && PID1601multilinegrid1.mouseRow>PID1601multilinegrid1.fixedRows-1)
						       {
								onClickGridCell(2);
						       }
						}				
					]]>
					</script>
				</col>
				<col ref="id" style="text-align:center; "/>
				<col ref="bocd" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/branchCombo/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="medinm" style="text-align:center; "/>
				<col ref="rdr_no" type="input" style="text-align:center; "/>
				<col ref="dtlsprocstat" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/moCombo2/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="errresncd" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/errCombo/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="procdt" format="yyyy/mm/dd" style="text-align:center; "/>
				<col ref="recstat" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/cashCombo2/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="entr_no" visibility="hidden"/>
				<col ref="grad_check" visibility="hidden"/>
				<col ref="regno" visibility="hidden"/>
			</row>
			<row>
				<col colspan="5" ref="tel_detail" style="text-align:center; "/>
				<col ref="prn" style="text-align:center; "/>
				<col colspan="2" ref="email" style="text-align:left; "/>
				<col colspan="5" ref="addr_detail" style="text-align:left; "/>
			</row>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
					if(PID1601multilinegrid1.col == 1 && PID1601multilinegrid1.row == 0) {
						for(var i=2; i<PID1601multilinegrid1.rows; i++) {
							PID1601multilinegrid1.valueMatrix(i,PID1601multilinegrid1.colRef("check")) = "Y";
						}
					}					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[
					if(PID1601multilinegrid1.col == 1 && PID1601multilinegrid1.row == 0) {
						for(var i=2; i<PID1601multilinegrid1.rows; i++) {
							PID1601multilinegrid1.valueMatrix(i,PID1601multilinegrid1.colRef("check")) = "N";
						}
					}
				]]>
			</script>
		</multilinegrid>
		<group id="PID1601group4" class="gro_sel" style="left:10px; top:455px; width:926px; height:25px; ">
			<caption id="PID1601caption3" class="list_cap01" style="left:0px; top:0px; width:926px; height:25px; "/>
			<select1 id="PID1601combo3" ref="/root/reqData/reqform/search_form2/sh_searcd" appearance="minimal" style="left:5px; top:4px; width:90px; height:18px; ">
				<choices>
					<item>
						<label>독자명</label>
						<value>NM</value>
					</item>
					<item>
						<label>독자번호</label>
						<value>NO</value>
					</item>
					<item>
						<label>주민번호</label>
						<value>PR</value>
					</item>
					<item>
						<label>이메일</label>
						<value>ML</value>
					</item>
				</choices>
			</select1>
			<input id="PID1601input3" ref="/root/reqData/reqform/search_form2/sh_searnm" style="left:98px; top:4px; width:130px; height:18px; "/>
			<caption id="PID1601caption2" style="left:235px; top:5px; width:35px; height:20px; ">매체</caption>
			<select1 id="PID1601combo4" ref="/root/reqData/reqform/search_form2/sh_medicd" appearance="minimal" style="left:265px; top:4px; width:90px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/mcCombo2/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<caption id="PID1601caption6" style="left:370px; top:5px; width:70px; height:20px; ">전화/휴대폰</caption>
			<input id="PID1601input4" ref="/root/reqData/reqform/search_form2/sh_phone1" format="999" style="left:439px; top:4px; width:40px; height:18px; "/>
			<input id="PID1601input5" ref="/root/reqData/reqform/search_form2/sh_phone2" format="9999" style="left:485px; top:4px; width:40px; height:18px; "/>
			<input id="PID1601input12" ref="/root/reqData/reqform/search_form2/sh_phone3" format="9999" style="left:530px; top:4px; width:40px; height:18px; "/>
			<button id="PID1601button2" class="btn_grid02" style="left:880px; top:4px; width:42px; height:17px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						detailSearch();
					]]>
				</script>
			</button>
		</group>
		<!--<group id="PID1601group5" style="left:10px; top:690px; width:926px; height:25px; ">
			<iviewer id="PID1601iviewer1" src="../common/iv_common_paging.xrw" style="left:0px; top:0px; width:926px; height:25px; "/>
		</group>-->
		<multilinegrid id="PID1601multilinegrid2" nodeset="/root/resData/gridData/detailGrid/record" caption="구독일자^지사^독자번호^독자명^회원아이디^등급^매체^구독호수^주민번호|전화/휴대폰^전화/휴대폰^전화/휴대폰^이메일^이메일^주소^주소^주소^주소" colsep="^" colwidth="95, 100, 95, 95, 100, 100, 100, 100, 100" ellipsis="true" rowheader="seq" rowsep="|" tooltip="true" selectionmode="free" mergecellsfixedrows="bycolrec" style="left:10px; top:480px; width:926px; height:235px; ">
			<row>
				<col ref="aplcdt"/>
				<col ref="bonm"/>
				<col ref="rdr_no"/>
				<col ref="rdrnm"/>
				<col ref="onlmembid"/>
				<col ref="rdrgrad"/>
				<col ref="medinm"/>
				<col ref="subsfrser_no_detail"/>
				<col ref="prn"/>
				<col ref="bocd" visibility="hidden"/>
			</row>
			<row>
				<col colspan="3" ref="phone_detail"/>
				<col colspan="2" ref="email"/>
				<col colspan="4" ref="dlvaddr_detail"/>
			</row>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					if(event.button == 1)
					{
						if(PID1601multilinegrid2.mouseCol>PID1601multilinegrid2.fixedCols-1 && PID1601multilinegrid2.mouseRow>PID1601multilinegrid2.fixedRows-1)
					       {
							onDetailGridClick();
					       }
					}				
				]]>
			</script>
		</multilinegrid>
	</xhtml:body>
</xhtml:html>
