<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>받을어음어음교체(FC_FUNC_1090)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<!-- 저장소 -->
					<initData>
						<session>
						</session>
						<comboSet>
							<dataSet>
								<CUR_CARD_CD>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</CUR_CARD_CD>
								<CUR_DLCO_CLSF_CD>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</CUR_DLCO_CLSF_CD>
								<CUR_NOTE_CLSF_CD>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</CUR_NOTE_CLSF_CD>
								<CUR_ISS_CD>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</CUR_ISS_CD>
								<CUR_FREX_CD>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</CUR_FREX_CD>
								<CUR_DEPS_CD>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</CUR_DEPS_CD>
							</dataSet>
						</comboSet>
						<pageInfo/>
					</initData>
					<reqData>
						<fwdData/>
						<search>
							<mtry_dt/>
							<dlco_clsf_cd/>
							<dlco_cd/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<slip_no/>
							<repl_dt/>
						</search>
						<reqform>
							<stat_dt/>
							<dlco_clsf_cd/>
							<dlco_cd/>
							<pch_compnm/>
							<rmks1/>
							<jobamt/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<repl_amt/>
							<slip_no/>
						</reqform>
						<multiUpDate>
							<stat_dt/>
							<dlco_clsf_cd/>
							<dlco_cd/>
							<pch_compnm/>
							<rmks1/>
							<jobamt/>
							<multiUpdateData5/>
							<multiUpdateData2/>
							<multiUpdateData4/>
							<multiUpdateData1/>
							<multiUpdateData3/>
						</multiUpDate>
					</reqData>
					<resData>
						<gridData>
							<fc_func_1091_l>
								<dataSet>
									<CURLIST>
										<record>
											<b_note_clsf_cd_nm/>
											<b_nbn_no/>
											<b_pch_cymd1to/>
											<b_rcpay_amt/>
											<b_issu_pers_nm/>
											<b_dlco_clsf_cd_nm/>
											<b_pay_plac_cd_nm/>
											<b_now_note_stat_cd_nm/>
											<b_bank_cd/>
											<b_note_no/>
											<b_note_seq/>
											<b_dlco_clsf_cd/>
											<b_dlco_cd/>
											<b_pay_plac_cd/>
											<b_now_note_stat_cd/>
											<b_note_clsf_cd/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_func_1091_l>
							<fc_func_1093_l>
								<dataSet>
									<CURLIST>
										<record>
											<a_nbn_no/>
											<a_note_clsf_cd/>
											<a_note_amt/>
											<a_comp_dt/>
											<a_mtry_dt/>
											<a_issu_cmpy_clsf_cd/>
											<a_issu_pers_nm/>
											<a_bank_cd_nm/>
											<a_note_no/>
											<a_note_seq/>
											<a_bank_cd/>
											<a_rcpm_acct/>
											<a_sale_aprv_no/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_func_1093_l>
							<fc_func_1094_l>
								<dataSet>
									<CURLIST>
										<record>
											<p_repl_amt/>
											<p_budg_cd/>
											<p_deps_clsf_cd/>
											<p_deps_dt/>
											<p_frex_cd/>
											<p_exrate/>
											<p_frex_amt/>
											<p_trufnd_slip_clsf/>
											<p_trufnd_slip_no/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_func_1094_l>
							<fc_func_1097_l>
								<dataSet>
									<CURLIST>
										<record>
											<slip_occr_dt/>
											<slip_clsf_cd/>
											<slip_seq/>
											<slip_no/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_func_1097_l>
							<fc_func_1094_l_l>
								<dataSet>
									<CURLIST>
										<record>
											<p_repl_amt/>
											<p_budg_cd/>
											<p_deps_clsf_cd/>
											<p_deps_dt/>
											<p_frex_cd/>
											<p_exrate/>
											<p_frex_amt/>
											<p_trufnd_slip_clsf/>
											<p_trufnd_slip_no/>
											<biz_reg_no/>
											<bank_id/>
											<acct_num/>
											<tran_date_seq/>
											<current_clsf/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_func_1094_l_l>
							<cashamtList>
								<recode>
									<cashamt/>
									<c_budg_cd/>
									<c_deps_clsf_cd/>
									<c_deps_dt/>
									<c_frex_cd/>
									<c_exrate/>
									<c_frex_amt/>
									<c_trufnd_slip_clsf/>
									<c_trufnd_slip_no/>
								</recode>
							</cashamtList>
							<trufnd_slip_no_l>
								<recode>
									<repl_amt/>
									<budg_cd/>
									<trufnd_slip_clsf/>
									<trufnd_slip_no/>
									<y_deps_clsf_cd/>
									<y_deps_dt/>
									<y_frex_cd/>
									<y_exrate/>
									<y_frex_amt/>
								</recode>
							</trufnd_slip_no_l>
							<fc_func_1095_i>
								<dataSet>
									<CURLIST>
										<record>
											<slip_occr_dt/>
											<slip_clsf_cd/>
											<slip_seq/>
											<slip_no/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_func_1095_i>
						</gridData>
						<msg/>
						<resform>
							<totalsum/>
						</resform>
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<keyData/>
						<dlco_nm/>
						<jobiicr/>
						<old_note_amt/>
						<new_note_amt_sum/>
						<note_no/>
						<note_clsf_cd/>
						<bank_cd/>
						<bank_nm/>
						<note_amt/>
						<comp_dt/>
						<mtry_dt/>
						<issu_cmpy_clsf_cd/>
						<issu_pers_nm/>
						<sale_aprv_no/>
						<rcpm_acct/>
					</tempData>
				</root>
			</instance>
			<submission id="fc_func_1090_m" action="/fc/func1000/1090" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/search" resultref="/root/initData/comboSet/dataSet"/>
			<submission id="fc_func_1091_l" action="/fc/func1000/1091" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/search" resultref="/root/resData/gridData/fc_func_1091_l/dataSet"/>
			<submission id="fc_func_1092_l" action="/fc/func1000/1092" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/search" resultref="/root/resData/gridData/fc_func_1091_l/dataSet"/>
			<submission id="fc_func_1093_l" action="/fc/func1000/1093" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/search" resultref="/root/resData/gridData/fc_func_1093_l/dataSet"/>
			<submission id="fc_func_1094_l" action="/fc/func1000/1094" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/search" resultref="/root/resData/gridData/fc_func_1094_l/dataSet"/>
			<submission id="fc_func_1097_l" action="/fc/func1000/1097" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/search" resultref="/root/resData/gridData/fc_func_1097_l/dataSet"/>
			<submission id="fc_func_1095_i" action="/fc/func1000/1095" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/multiUpDate" resultref="/root/resData/gridData/fc_func_1095_i/dataSet"/>
			<submission id="fc_func_1096_d" action="/fc/func1000/1096" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/reqform" resultref="/root/resData/msg"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					set_default(datagrid1,datagrid2,datagrid3,datagrid4,datagrid5);
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				
					btn_insert.disabled = false;
					btn_delete.disabled = false;
//					datagrid1.addStatus(1,"insert");
//					datagrid2.addStatus(1,"insert");
//					datagrid3.addStatus(1,"insert");
//					datagrid4.addStatus(1,"insert");
//					datagrid5.addStatus(1,"insert");
					for (i=1; i<6; i++){
//						datagrid5.addRow(false);
						datagrid2.addRow(false);
						datagrid4.addRow(false);
//						datagrid3.addRow(false);
					}
					datagrid5.addRow(false);
					btn_tinsert.disabled = false;
					btn_tupdate.disabled = false;
					btn_tdelete.disabled = false;
					
					model.send("fc_func_1090_m");
					btn_case1.dispatch("onclick");
					
					model.refresh();
				]]>
			</script>
		</model>
		<script type="javascript" src="../../../js/TFCommon.js"/>
		<script type="javascript" src="../../../js/CIISComm.js"/>
		<script type="javascript" src="../../../js/fcmc_common.js"/>
		<script type="javascript">
			<![CDATA[
				var	_oth_clsf = "1";
				
				 function send_fc_func_1091_l(){
					old_note_amt.value = "";
					if (!check_reqItem(srch_repl_dt,"trim","focus","교체일은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(srch_dlco_clsf_cd,"trim","focus","거래처구분은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(srch_dlco_cd,"trim","focus","거래처코드은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(srch_mtry_dt,"trim","focus","만기일은(는) 필수입력항목입니다.")) {return false;}
					model.send("fc_func_1091_l");
					totalcnt = model.getValue("/root/resData/gridData/fc_func_1091_l/dataSet/CURLIST/totalcnt");
					if (totalcnt == 0) {
						reset_model(true);
						show_message("검색결과가 없습니다.");
					}
					btn_tinsert.disabled = false;
					btn_tupdate.disabled = false;
					btn_tdelete.disabled = false;
				}
				 function send_fc_func_1092_l(){
				 	if (!check_reqItem(srch_repl_dt,"trim","focus","교체일은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(srch_slip_no,"trim","focus","전표번호은(는) 필수입력항목입니다.")) {return false;}
					var slipno = srch_slip_no.value;
					 var slip_occr_dt = slipno.substr(0,8);
					 var slip_clsf_cd = slipno.substr(9,2);
					 var slip_seq = slipno.substr(12,3);
//					 alert(slip_occr_dt+"-"+slip_clsf_cd+"-"+slip_seq);
					 set_refvalue("/root/reqData/search/slip_occr_dt",slip_occr_dt);
	 				 set_refvalue("/root/reqData/search/slip_clsf_cd",slip_clsf_cd);
					 set_refvalue("/root/reqData/search/slip_seq",slip_seq);
					
//					return;
					model.send("fc_func_1092_l");
					totalcnt = model.getValue("/root/resData/gridData/fc_func_1091_l/dataSet/CURLIST/totalcnt");
					if (totalcnt == 0) {
						reset_model(true);
						show_message("검색결과가 없습니다.");
					}
					btn_tinsert.disabled = true;
					btn_tupdate.disabled = true;
					btn_tdelete.disabled = true;
					
					model.send("fc_func_1093_l");	
					model.send("fc_func_1094_l");	

					var budg_cd = "";
					var a = 1;
					var b = 1;
					var c = 1;
//					var datacnt = model.getXPathValue("count(/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record)");
					var datacnt = get_refvalue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/totalcnt");

					for(var i=1;i<=datacnt;i++){
						budg_cd = model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_budg_cd");
						budg_cd = budg_cd.substr(0,4);

//						alert(budg_cd);
						if(budg_cd == "0011"){
							set_refvalue("/root/resData/gridData/cashamtList/recode["+a+"]/cashamt",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_repl_amt"));
							set_refvalue("/root/resData/gridData/cashamtList/recode["+a+"]/c_budg_cd",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_budg_cd"));
							set_refvalue("/root/resData/gridData/cashamtList/recode["+a+"]/c_deps_clsf_cd",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_deps_clsf_cd"));
							set_refvalue("/root/resData/gridData/cashamtList/recode["+a+"]/c_deps_dt",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_deps_dt"));
							set_refvalue("/root/resData/gridData/cashamtList/recode["+a+"]/c_frex_cd",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_frex_cd"));
							set_refvalue("/root/resData/gridData/cashamtList/recode["+a+"]/c_exrate",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_exrate"));
							set_refvalue("/root/resData/gridData/cashamtList/recode["+a+"]/c_frex_amt",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_frex_amt"));
							set_refvalue("/root/resData/gridData/cashamtList/recode["+a+"]/c_trufnd_slip_clsf",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_trufnd_slip_clsf"));
							set_refvalue("/root/resData/gridData/cashamtList/recode["+a+"]/c_trufnd_slip_no",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_trufnd_slip_no"));
							datagrid5.refresh();
							a = a + 1;
						}
						if(budg_cd=="0114" || budg_cd=="0173"){
//							alert("budg_cd : "+"   b : "+b);
							set_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+b+"]/p_repl_amt",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_repl_amt"));
							set_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+b+"]/p_budg_cd",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_budg_cd"));
							set_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+b+"]/p_deps_clsf_cd",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_deps_clsf_cd"));
							set_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+b+"]/p_deps_dt",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_deps_dt"));
							set_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+b+"]/p_frex_cd",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_frex_cd"));
							set_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+b+"]/p_exrate",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_exrate"));
							set_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+b+"]/p_frex_amt",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_frex_amt"));
							set_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+b+"]/p_trufnd_slip_clsf",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_trufnd_slip_clsf"));
							set_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+b+"]/p_trufnd_slip_no",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_trufnd_slip_no"));
							b = b+1;
							model.refresh();
						}
						if(budg_cd=="4631" || budg_cd=="4664" || budg_cd=="4561"){
							set_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+c+"]/repl_amt",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_repl_amt"));
							set_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+c+"]/budg_cd",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_budg_cd"));
							set_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+c+"]/y_deps_clsf_cd",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_deps_clsf_cd"));
							set_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+c+"]/y_deps_dt",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_deps_dt"));
							set_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+c+"]/y_frex_cd",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_frex_cd"));
							set_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+c+"]/y_exrate",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_exrate"));
							set_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+c+"]/y_frex_amt",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_frex_amt"));
							set_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+c+"]/trufnd_slip_clsf",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_trufnd_slip_clsf"));
							set_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+c+"]/trufnd_slip_no",model.getValue("/root/resData/gridData/fc_func_1094_l/dataSet/CURLIST/record["+i+"]/p_trufnd_slip_no"));
							c = c+1;
						}
						model.refresh();
					}
				}
				function open_fc_acct_1180(p_where,p_mode,p_title,p_readonly,p_to) {
					var need_popup = true;
					var rcvs_flag = false;
					
					p_where = p_where.toUpperCase();
					
					if (!check_reqItem(srch_dlco_clsf_cd,"none","focus","거래처검색은 거래처구분을 선택 후 조회 할 수 있습니다.")) {return rcvs_flag};
					
					//검색조건이 모두 충족하지 않으면 종료한다.
					if (p_where == "FOCUS" && (srch_dlco_clsf_cd.value.Trim() == "" || srch_dlco_cd.value.Trim() == "")) {
						dlco_nm.value	= "";
						return rcvs_flag;
					}
					
					var popid = "fc_acct_1180";
					var subid = "fc_acct_1181_l";
	
					set_popup_send_data(popid		,"mode"			,p_mode			);
					set_popup_send_data(popid		,"title"			,p_title			);
					set_popup_send_data(popid		,"readonly"		,p_readonly		);
					set_popup_send_data(popid		,"clsf_cd"			,srch_dlco_clsf_cd.value	);
					set_popup_send_data(popid		,"cd_f"			,srch_dlco_cd.value		);
					set_popup_send_data(popid		,"cd_t"			,srch_dlco_cd.value		);
	//				set_popup_send_data(popid		,"cd_abrv_nm"		,dlco_cd.value		);
	//				set_popup_send_data(popid		,"cd_abrv_nm"		,""				);
	
					//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
					if (p_where == "FOCUS") {
						//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
						//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
						model.removenode(get_popup_rcvs_ref(popid));
						//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
						model.makeNode(get_popup_rcvs_ref(popid));
						
						//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
						send_submission(
								"auto_" + subid
							,	get_popup_send_ref(popid)
							,	get_popup_rcvs_ref(subid) + "/dataSet"
							,	"/fc/acct1000/1181"
							,	"urlencoded-post"
							,	"application/x-www-form-urlencoded"
						);
						
						totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
				
						if (totalcnt == 1) {
							//데이터가 1건이고 focus out에서 호출한 경우
							//데이터를 설정하고 나간다.
	
	//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
	//						return;
							need_popup = false;
							rcvs_flag = true;
						}
						else if (totalcnt == 0) {
							show_message("거래처코드의 검색결과가 없습니다.");
	//						return;
							need_popup = false;	
							rcvs_flag = false;
						}
						else {
							//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
							//만약 1건 이상인 경우 popup을 호출해 달라고 하면
							//return을 지우면 됨
							//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
							//return;
							need_popup = true;
						}
					}
					
					//그외 버튼인 경우는 계속 진행
					if (need_popup) {
						rcvs_flag = open_popup(popid,"640");
					}
	
					//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
					//다시 조회 하기 쉽도록 하고
					if (get_popup_rcvs_data(popid,"clsf_cd") != "")			srch_dlco_clsf_cd.value		=	get_popup_rcvs_data(popid,"clsf_cd");
					if (get_popup_rcvs_data(popid,"cd") != "")				srch_dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
					//그외의 값은 지워지도록 한다.
					dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					
					reset_popup_send_data(popid);
					
					return rcvs_flag;
				}
				function reset_model(p_save) {
					var temp_srch_repl_dt = srch_repl_dt.value;
					var temp_srch_slip_no = srch_slip_no.value;
					var temp_srch_dlco_clsf_cd = srch_dlco_clsf_cd.value;
					var temp_srch_dlco_cd = srch_dlco_cd.value;
					var temp_dlco_nm = dlco_nm.value;
					var temp_srch_mtry_dt = srch_mtry_dt.value;
					
					model.reset();
					
					if (p_save) {
						srch_repl_dt.value = temp_srch_repl_dt;
						srch_slip_no.value = temp_srch_slip_no;
						srch_dlco_clsf_cd.value = temp_srch_dlco_clsf_cd;
						srch_dlco_cd.value = temp_srch_dlco_cd;
						dlco_nm.value = temp_dlco_nm;
						srch_mtry_dt.value = temp_srch_mtry_dt;
					}
				}
				function gridClick(grow){
					var woldnoteamtsum = 0;
					var wnewnoteamtsum = 0;
					
					
					if(old_note_amt.value==""){
						woldnoteamtsum = 0;
					}else{
						woldnoteamtsum = Number(old_note_amt.value);
					}
					if(grow==0){
						return false;
					}
					if(datagrid1.rowStatus(grow)=="2"){
						datagrid1.removeStatus(grow,"update");
						if(new_note_amt_sum.value==""){
							wnewnoteamtsum = 0;
						}else{
							wnewnoteamtsum = Number(new_note_amt_sum.value);
						}
						if(get_refvalue("/root/resData/gridData/fc_func_1091_l/dataSet/CURLIST/record["+grow+"]/b_rcpay_amt") != ""){
							woldnoteamtsum = woldnoteamtsum - Number(get_refvalue("/root/resData/gridData/fc_func_1091_l/dataSet/CURLIST/record["+grow+"]/b_rcpay_amt"));
						}
						if(woldnoteamtsum < wnewnoteamtsum){
							show_message(" 입력 항목의 범위가 맞지 않습니다. [구어음합계:신어음합계]");
							return false;
						}
						old_note_amt.value = woldnoteamtsum;
					}else{
						datagrid1.addStatus(grow,"update");
						if(get_refvalue("/root/resData/gridData/fc_func_1091_l/dataSet/CURLIST/record["+grow+"]/b_rcpay_amt") != ""){
							woldnoteamtsum = woldnoteamtsum + Number(get_refvalue("/root/resData/gridData/fc_func_1091_l/dataSet/CURLIST/record["+grow+"]/b_rcpay_amt"));
						}
						old_note_amt.value = woldnoteamtsum;
					}
					
				}
				function gridClick3(grow){
//					if(grow== 0 || grow == -1){
//						return false;
//					}
//					alert(grow);
					if(grow != 0){
						set_refvalue("/root/tempData/note_no",get_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_note_no"));
						set_refvalue("/root/tempData/note_clsf_cd",get_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_note_clsf_cd"));
						set_refvalue("/root/tempData/bank_cd",get_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_bank_cd"));
						set_refvalue("/root/tempData/bank_nm",get_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_bank_cd_nm"));
						set_refvalue("/root/tempData/note_amt",get_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_note_amt"));
						set_refvalue("/root/tempData/comp_dt",get_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_comp_dt"));
						set_refvalue("/root/tempData/mtry_dt",get_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_mtry_dt"));
						set_refvalue("/root/tempData/issu_cmpy_clsf_cd",get_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_issu_cmpy_clsf_cd"));
						set_refvalue("/root/tempData/issu_pers_nm",get_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_issu_pers_nm"));
						set_refvalue("/root/tempData/rcpm_acct",get_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_rcpm_acct"));
						set_refvalue("/root/tempData/sale_aprv_no",get_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_sale_aprv_no"));
						model1.refresh();
					}else{
						set_refvalue("/root/tempData/note_no","");
						set_refvalue("/root/tempData/note_clsf_cd","");
						set_refvalue("/root/tempData/bank_cd","");
						set_refvalue("/root/tempData/bank_nm","");
						set_refvalue("/root/tempData/note_amt","");
						set_refvalue("/root/tempData/comp_dt","");
						set_refvalue("/root/tempData/mtry_dt","");
						set_refvalue("/root/tempData/issu_cmpy_clsf_cd","");
						set_refvalue("/root/tempData/issu_pers_nm","");
						set_refvalue("/root/tempData/rcpm_acct","");
						set_refvalue("/root/tempData/sale_aprv_no","");
						model1.refresh();
					}
				}
				function send_fc_func_1095_i(){
					
					if (!check_reqItem(srch_repl_dt,"trim","focus","교체일은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(srch_dlco_clsf_cd,"trim","focus","거래처구분은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(srch_dlco_cd,"trim","focus","거래처코드은(는) 필수입력항목입니다.")) {return false;}
					
					var sumamt = 0;
					var tempamt = 0;
					var cashcnt = model.getXPathValue("count(/root/resData/gridData/cashamtList/recode)");
					var trufndcnt = model.getXPathValue("count(/root/resData/gridData/trufnd_slip_no_l/recode)");
					
					if(new_note_amt_sum.value !=""){
						sumamt = Number(sumamt) + Number(new_note_amt_sum.value);
					}
//					alert("신어음  : "+sumamt);
					if(get_refvalue("/root/resData/gridData/cashamtList/recode[1]/cashamt") !=""){
						for(var i = datagrid3.fixedRows;i<=cashcnt;i++){
							sumamt = Number(sumamt) + Number(get_refvalue("/root/resData/gridData/cashamtList/recode["+i+"]/cashamt"));
						}
					}
//					alert("현금  : "+sumamt);
					var yegeumamt = 0;
					for(var i = datagrid2.fixedRows;i<datagrid2.rows;i++){
						yegeumamt = Number(yegeumamt) + Number(get_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+i+"]/p_repl_amt"));
					}
					sumamt = Number(sumamt) + Number(yegeumamt);
//					alert("예금  : "+sumamt);
					if(get_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode[1]/repl_amt") != ""){
						for(var i = datagrid4.fixedRows;i<datagrid4.rows;i++){
							sumamt = Number(sumamt) + Number(get_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+i+"]/repl_amt"));
						}
					}
//					alert("예수금  : "+sumamt);
					if(old_note_amt.value !=""){
						tempamt = Number(old_note_amt.value);
					}else{
						tempamt = 0;
					}
				    	if(get_refvalue("/root/resData/gridData/cashamtList/recode[1]/cashamt") == ""){
				    		set_refvalue("/root/resData/gridData/cashamtList/recode[1]/cashamt","0");
				   	}
				    	if(get_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode[1]/repl_amt") == ""){
				    		set_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode[1]/repl_amt","0");
				    	} 
				    	var icashamt = 0;
				    	for(var i = 1;i<datagrid5.rows;i++){
				    		if(get_refvalue("/root/resData/gridData/cashamtList/recode["+i+"]/cashamt") ==""){
				    			icashamt = 0;
				    		}
				    		if(get_refvalue("/root/resData/gridData/cashamtList/recode["+i+"]/cashamt") !=""){
				    			icashamt = Number(icashamt) + Number(get_refvalue("/root/resData/gridData/cashamtList/recode["+i+"]/cashamt"));
				    		}
				    	}
				    	var iyegeumamt = 0;
				    	for(var i = 1;i<datagrid2.rows;i++){
				    		if(get_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+i+"]/p_repl_amt") ==""){
				    			iyegeumamt = 0;
				    		}
				    		if(get_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+i+"]/p_repl_amt") !=""){
				    			iyegeumamt = Number(iyegeumamt) + Number(get_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+i+"]/p_repl_amt"));
				    		}
				    	}
				    	var itrufndamt = 0;
				    	for(var i = 1;i<datagrid4.rows;i++){
				    		if(get_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+i+"]/repl_amt") ==""){
				    			itrufndamt = 0;
				    		}
				    		if(get_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+i+"]/repl_amt") !=""){
				    			itrufndamt = Number(itrufndamt) + Number(get_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+i+"]/repl_amt"));
				    		}
				    	}
//				    	alert("icashamt  : "+ icashamt+"       iyegeumamt  : "+iyegeumamt+"       itrufndamt  :  "+itrufndamt);
				    	if(jobiicr.value == "1" && icashamt == 0 && iyegeumamt == 0 && itrufndamt == 0 && tempamt != sumamt){
				    	
				    	}else{
//				    		alert("tempamt : "+tempamt+"        sumamt : "+sumamt);
				    		if(tempamt != sumamt){
				    			show_message(" 입력 데이타가 범위를 초과하였습니다. [금액 상이]");
				    			return false;
				    		}
				    	}
//				    	return;
				    	if(yegeumamt != 0){
				    		del_datagrid_reqdata_empty(datagrid2);
				    		var tempamt = 0;
				    		for(var i = datagrid2.fixedRows;i<datagrid2.rows;i++){
				    			tempamt = get_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+i+"]/p_repl_amt");
				    			if(tempamt != 0 || tempamt != ""){
					    			if(get_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+i+"]/p_deps_dt")==""){
				    					show_message("예금일자은(는) 필수입력 항목입니다.");
				    					return false;
				    				}
				    				if(get_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+i+"]/p_repl_amt")==""){
				    					show_message("입금금액은(는) 필수입력 항목입니다.");
				    					return false;
				    				}
				    				if(get_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+i+"]/p_budg_cd")==""){
				    					show_message("예금예산은(는) 필수입력 항목입니다.");
				    					return false;
				    				}
				    				if(get_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+i+"]/p_deps_clsf_cd")==""){
				    					show_message("예금의 관리구분은(는) 필수입력 항목입니다.");
				    					return false;
				    				}
					    			if(get_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+i+"]/p_budg_cd")=="0173"){
					    				if(get_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+i+"]/p_frex_cd")==""){
					    					show_message("예금예산이 외화예금일 경우 외화구분은 필수입력 항목입니다.");
					    					return false;
					    				}
					    				if(get_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+i+"]/p_exrate")==""){
					    					show_message("예금예산이 외화예금일 경우 환율은 필수입력 항목입니다.");
					    					return false;
					    				}	
					    				if(get_refvalue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+i+"]/p_frcr_amt")==""){
					    					show_message("예금예산이 외화예금일 경우 외화금액은 필수입력 항목입니다.");
					    					return false;
					    				}
					    			}
				    			}
				    		}
				    	}
					var tempamt = 0;
					for(var i = datagrid4.fixedRows;i<= trufndcnt;i++){
						tempamt = get_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode[" + i + "]/repl_amt");
						if(tempamt != "" && tempamt != 0){
//							alert(tempamt);
							if(get_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+i+"]/budg_cd")==""){
			    					show_message("예수금예산은(는) 필수입력 항목입니다.");
			    					return false;
			    				}
			    				
			    				if(get_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+i+"]/trufnd_slip_clsf")==""){
			    					show_message("예수금전표구분은(는) 필수입력 항목입니다.");
			    					return false;
			    				}
			    				
			    				if(get_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+i+"]/trufnd_slip_no")==""){
			    					show_message("예수금전표번호은(는) 필수입력 항목입니다.");
			    					return false;
			    				}
						}
					}
					 if(Number(new_note_amt_sum.value) > Number(old_note_amt.value) && jobiicr.value == ""){
					 	show_message("신어음액이 구어음액보다 큽니다.. 잡이익처리건이면 잡이익처리에 check하시오");
					 	return false;
					 }
					 if(new_note_amt_sum.value > old_note_amt.value && jobiicr.value == "1"){
					 	set_refvalue("/root/reqData/multiUpDate/jobamt",Number(new_note_amt_sum.value)-Number(old_note_amt.value));
					 }else{
					 	set_refvalue("/root/reqData/multiUpDate/jobamt","0");
					 }
					 var datagrid1cnt = 0;
					 for(var i = datagrid1.fixedRows;i<datagrid1.rows;i++){
					 	if(datagrid1.rowStatus(i)=="2"){
					 		if(get_refvalue("/root/resData/gridData/fc_func_1091_l/dataSet/CURLIST/record["+i+"]/b_now_note_stat_cd") !="00" && 
					 		   get_refvalue("/root/resData/gridData/fc_func_1091_l/dataSet/CURLIST/record["+i+"]/b_now_note_stat_cd") !="02"){
					 			show_message("입력할 수 없는 자료입니다");
			    					return false;
					 		}
					 		datagrid1cnt = datagrid1cnt + 1;
					 	}
					 }
					 if(datagrid1cnt == 0){
					 	show_message("처리할 자료가 없습니다. [구어음]");
			    			return false;
					 }
					 if(get_refvalue("/root/resData/gridData/cashamtList/recode[1]/cashamt") !=""){
					 	set_refvalue("/root/resData/gridData/cashamtList/recode[1]/c_budg_cd","001100");
					 }
					 del_datagrid_reqdata_empty(datagrid5);
					 del_datagrid_reqdata_empty(datagrid2);
					 del_datagrid_reqdata_empty(datagrid4);
					 set_refvalue("/root/reqData/multiUpDate/stat_dt",srch_repl_dt.value);
					 set_refvalue("/root/reqData/multiUpDate/dlco_clsf_cd",srch_dlco_clsf_cd.value);
					 set_refvalue("/root/reqData/multiUpDate/dlco_cd",srch_dlco_cd.value);
					 set_refvalue("/root/reqData/multiUpDate/pch_compnm",dlco_nm.value);
					 set_refvalue("/root/reqData/multiUpDate/rmks1",rmks1.value);
					 set_refvalue("/root/reqData/multiUpDate/multiUpdateData1","");
					 set_refvalue("/root/reqData/multiUpDate/multiUpdateData3","");
					 set_refvalue("/root/reqData/multiUpDate/multiUpdateData5","");
					 set_refvalue("/root/reqData/multiUpDate/multiUpdateData2","");
					 set_refvalue("/root/reqData/multiUpDate/multiUpdateData4","");
//					 datagrid3.refresh();
					 remove_refnode("/root/reqData/multiUpDate/multiUpdateData3");
//					 alert(datagrid3.getUpdateData());
					 set_refvalue("/root/reqData/multiUpDate/multiUpdateData1",datagrid1.getUpdateData());
					 set_refvalue("/root/reqData/multiUpDate/multiUpdateData3",datagrid3.getUpdateData("update"));
					 set_refvalue("/root/reqData/multiUpDate/multiUpdateData5",datagrid5.getUpdateData());
					 set_refvalue("/root/reqData/multiUpDate/multiUpdateData2",datagrid2.getUpdateData());
					 set_refvalue("/root/reqData/multiUpDate/multiUpdateData4",datagrid4.getUpdateData());

					if (show_message("저장하시겠습니까?","삭제 확인",MB_YESNO) != IDYES) {
						return false;
					}					 
					model.send("fc_func_1095_i");
					return check_submit_completed("저장되었습니다.","");
				}
				function send_fc_func_1096_d(){

					if (!check_reqItem(srch_repl_dt,"trim","focus","교체일은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(srch_slip_no,"trim","focus","전표번호은(는) 필수입력항목입니다.")) {return false;}
					 var srchslipno	= trim(srch_slip_no.value);
					 set_refvalue("/root/reqData/reqform/stat_dt",srch_repl_dt.value);
					 set_refvalue("/root/reqData/reqform/slip_occr_dt",srchslipno.substr(0,8));
	 				 set_refvalue("/root/reqData/reqform/slip_clsf_cd",srchslipno.substr(9,2));
					 set_refvalue("/root/reqData/reqform/slip_seq",srchslipno.substr(12,3));
//					 return;

					if (show_message("삭제하시겠습니까?","삭제 확인",MB_YESNO) != IDYES) {
						return false;
					}
					 model.send("fc_func_1096_d");
					 return check_submit_completed("삭제되었습니다.","");	
					 
				}
				function tempinsert(){
					var WOLDEEAMTSUM = 0;
					var WNEWEEAMTSUM = 0;
					var noteno = note_no.value;
					var grow = datagrid3.rows;
					new_note_amt_sum.value == "";
//					WNEWEEAMTSUM = 0;
					if(grow == 0){
						grow = 1;
					}
					if(noteno.substr(0,4) != "1061" && get_refvalue("/root/initData/comboSet/dataSet/CUR_NOTE_CLSF_CD/record/cd") != "1061"){
						if (!check_reqItem(note_no,"trim","focus","어음번호은(는) 필수입력항목입니다.")) {return false;}
					}
					if (!check_reqItem(note_clsf_cd,"trim","focus","어음구분은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(note_no,"trim","focus","은행코드은(는) 필수입력항목입니다.")) {return false;}
					if(noteno.substr(0,4) != "1061" && get_refvalue("/root/initData/comboSet/dataSet/CUR_NOTE_CLSF_CD/record/cd") != "1061"){
						for(var i = datagrid3.fixedRows;i<datagrid3.rows;i++){
							if(get_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+i+"]/a_note_no")==note_no.value &&get_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+i+"]/a_bank_cd")==bank_cd.value){
								show_message("입력 항목의 범위가 맞지 않습니다. [어음번호 중복]");
								return false;
							}
						}
					}
					if (!check_reqItem(note_no,"trim","focus","어음금액은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(bank_cd,"trim","focus","은행코드은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(comp_dt,"trim","focus","기산일은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(mtry_dt,"trim","focus","만기일은(는) 필수입력항목입니다.")) {return false;}
					if(comp_dt.value > mtry_dt.value){
						show_message("시작일자는 종료일자를 초과할 수 없습니다.");
						return false;
					}
					if (!check_reqItem(issu_cmpy_clsf_cd,"trim","focus","발행사은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(issu_pers_nm,"trim","focus","발행자은(는) 필수입력항목입니다.")) {return false;}
					if(old_note_amt.value == ""){
						WOLDEEAMTSUM = 0;
					}else{
						WOLDEEAMTSUM = old_note_amt.value;
					}
					if(new_note_amt_sum.value == ""){
						WNEWEEAMTSUM = 0;
					}else{
						WNEWEEAMTSUM = new_note_amt_sum.value;
					}
					WNEWEEAMTSUM = Number(WNEWEEAMTSUM) + Number(note_amt.value);
					if(Number(WNEWEEAMTSUM) > Number(WOLDEEAMTSUM) && jobiicr.value == ""){
						show_message("입력 항목의 범위가 맞지 않습니다. [어음금액]");
						return false;
					}
					new_note_amt_sum.value = WNEWEEAMTSUM;
					datagrid3.addRow();
					if(noteno.substr(0,4) != "1061" && get_refvalue("/root/initData/comboSet/dataSet/CUR_NOTE_CLSF_CD/record/cd") != "1061"){
						set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_nbn_no",note_no.value + "-"+bank_cd.value+" ");
					}else{
						set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_nbn_no","CARDCARD" + "-"+bank_cd.value+" ");
					}
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_note_clsf_cd",note_clsf_cd.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_comp_dt",comp_dt.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_mtry_dt",mtry_dt.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_issu_cmpy_clsf_cd",issu_cmpy_clsf_cd.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_issu_pers_nm",issu_pers_nm.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_bank_cd",bank_cd.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_note_amt",note_amt.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_note_no",note_no.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_bank_cd_nm",bank_nm.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_rcpm_acct",rcpm_acct.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_sale_aprv_no",sale_aprv_no.value);
					datagrid3.rowStatus(grow) = "2";
//					alert(grow);
					datagrid3.refresh();
				}
				function tempupdate(){
					var WOLDEEAMTSUM = 0;
					var WNEWEEAMTSUM = 0;
					var noteno = note_no.value;
					var grow = datagrid3.row;
					if(datagrid3.row == 0){
						show_message("처리할 자료가 없습니다");
						return false;
					}
					if(noteno.substr(0,4) != "1061" && get_refvalue("/root/initData/comboSet/dataSet/CUR_NOTE_CLSF_CD/record/cd") != "1061"){
						if (!check_reqItem(note_no,"trim","focus","어음번호은(는) 필수입력항목입니다.")) {return false;}
					}
					if (!check_reqItem(note_clsf_cd,"trim","focus","어음구분은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(bank_cd,"trim","focus","은행코드은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(note_amt,"trim","focus","어음금액은(는) 필수입력항목입니다.")) {return false;}
//					if (!check_reqItem(note_no,"trim","focus","은행코드은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(comp_dt,"trim","focus","기산일은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(mtry_dt,"trim","focus","만기일은(는) 필수입력항목입니다.")) {return false;}
					if(comp_dt.value > mtry_dt.value){
						show_message("시작일자는 종료일자를 초과할 수 없습니다.");
						return false;
					}
					if (!check_reqItem(issu_cmpy_clsf_cd,"trim","focus","발행사은(는) 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(issu_pers_nm,"trim","focus","발행자은(는) 필수입력항목입니다.")) {return false;}
					if(old_note_amt.value == ""){
						WOLDEEAMTSUM = 0;
					}else{
						WOLDEEAMTSUM = Number(old_note_amt.value);
					}
					if(new_note_amt_sum.value == ""){
						WNEWEEAMTSUM = 0;
					}else{
						WNEWEEAMTSUM = Number(new_note_amt_sum.value);
					}
					WNEWEEAMTSUM = Number(WNEWEEAMTSUM) - Number(get_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_note_amt"));
					WNEWEEAMTSUM = Number(WNEWEEAMTSUM) + Number(note_amt.value);
					if(Number(WNEWEEAMTSUM) > Number(WOLDEEAMTSUM) && jobiicr.value == ""){
						show_message("입력 항목의 범위가 맞지 않습니다. [어음금액]");
						return false;
					}
					new_note_amt_sum.value = WNEWEEAMTSUM;
					
					if(noteno.substr(0,4) != "1061" && get_refvalue("/root/initData/comboSet/dataSet/CUR_NOTE_CLSF_CD/record/cd") != "1061"){
						set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_nbn_no",note_no.value + "-"+bank_cd.value+" ");
					}else{
						set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_nbn_no","CARDCARD" + "-"+bank_cd.value+" ");
					}
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_note_clsf_cd",note_clsf_cd.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_comp_dt",comp_dt.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_mtry_dt",mtry_dt.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_issu_cmpy_clsf_cd",issu_cmpy_clsf_cd.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_issu_pers_nm",issu_pers_nm.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_bank_cd_nm",bank_nm.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_rcpm_acct",rcpm_acct.value);
					set_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+grow+"]/a_sale_aprv_no",sale_aprv_no.value);
					datagrid3.addStatus(grow,"update");
					datagrid3.refresh();
				}
				function tempdelete(){
					var WOLDEEAMTSUM = 0;
					var WNEWEEAMTSUM = 0;
//					alert(datagrid3.row);
					if(datagrid3.row == 0){
						show_message("처리할 자료가 없습니다");
						return false;
					}
					if(new_note_amt_sum.value == ""){
						WNEWEEAMTSUM = 0;
					}else{
						WNEWEEAMTSUM = new_note_amt_sum.value;
					}
					if(old_note_amt.value == ""){
						WOLDEEAMTSUM = 0;
					}else{
						WOLDEEAMTSUM = old_note_amt.value;
					}
					WNEWEEAMTSUM = Number(WNEWEEAMTSUM) - Number(get_refvalue("/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record["+datagrid3.row+"]/a_note_amt"));
					new_note_amt_sum.value = WNEWEEAMTSUM;
					datagrid3.deleteRow(datagrid3.row);
					datagrid3.refresh();
					var grow = datagrid1.row;
					if(datagrid3.rows-1 > grow){
						grow = grow -1;
					}
					gridClick3(grow);
					
				}
				function open_fc_acct_1180_b(p_where,p_mode,p_title,p_readonly) {
					var need_popup = true;
					
					//검색조건이 모두 충족하지 않으면 종료한다.
					if (p_where == "FOCUS" && (dlco_clsf_cd.value.Trim() == "" || dlco_cd.value.Trim() == "")) {
						dlco_nm.value	= "";
						return;
					}
					
					p_where = p_where.toUpperCase();
					
					var popid = "fc_acct_1180";
					var subid = "fc_acct_1181_l";
	
					set_popup_send_data(popid		,"mode"			,p_mode			);
					set_popup_send_data(popid		,"title"			,p_title			);
					set_popup_send_data(popid		,"readonly"		,p_readonly		);
					set_popup_send_data(popid		,"clsf_cd"			,"95");
					set_popup_send_data(popid		,"cd_f"			,bank_cd.value		);
					set_popup_send_data(popid		,"cd_t"			,bank_cd.value		);
//					set_popup_send_data(popid		,"cd_abrv_nm"		,bank_cd.value		);
	
					//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
					if (p_where == "FOCUS") {
						//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
						//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
						model.removenode(get_popup_rcvs_ref(popid));
						//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
						model.makeNode(get_popup_rcvs_ref(popid));
						
						//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
						send_submission(
								"auto_" + subid
							,	get_popup_send_ref(popid)
							,	get_popup_rcvs_ref(subid) + "/dataSet"
							,	"/fc/acct1000/1181"
							,	"urlencoded-post"
							,	"application/x-www-form-urlencoded"
						);
						
						totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
				
						if (totalcnt == 1) {
							//데이터가 1건이고 focus out에서 호출한 경우
							//데이터를 설정하고 나간다.
	
	//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
	//						return;
							need_popup = false;
						}
						else if (totalcnt == 0) {
							show_message("[거래처코드]의 검색결과가 없습니다.");
	//						return;
							need_popup = false;						
						}
						else {
							//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
							//만약 1건 이상인 경우 popup을 호출해 달라고 하면
							//return을 지우면 됨
							//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
							//return;
							need_popup = true;
						}
					}
					
					//그외 버튼인 경우는 계속 진행
					if (need_popup) {
						open_popup(popid,"640");
					}
	
					//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
					//다시 조회 하기 쉽도록 하고
//					if (get_popup_rcvs_data(popid,"clsf_cd") != "")			dlco_clsf_cd.value		=	get_popup_rcvs_data(popid,"clsf_cd");
					if (get_popup_rcvs_data(popid,"cd") != "")				bank_cd.value			=	get_popup_rcvs_data(popid,"cd");
					//그외의 값은 지워지도록 한다.
					bank_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
				}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="2,34;2,39;2,40;2,50;2,68;2,79;2,80;2,366;2,377;2,376;2,393;2,408;2,409;1,936;1,927;1,925;" style="font-family:굴림; ">
		<group id="group_line" class="gro_line" style="left:10px; top:133px; width:926px; height:5px; "/>
		<group id="group_tit" class="gro_tit2" style="left:10px; top:153px; width:926px; height:25px; ">
			<caption id="subtitle" class="tit02" style="left:0px; top:0px; width:926px; height:25px; ">구어음</caption>
		</group>
		<group id="group_btnG1" class="gro_btn" style="left:10px; top:396px; width:926px; height:17px; ">
			<button id="btnG1" class="btn_grid02" style="left:747px; top:0px; width:42px; height:17px; ">
				<caption>가나</caption>
			</button>
			<button id="btnG2" class="btn_grid03" style="left:794px; top:0px; width:53px; height:17px; ">
				<caption>가나다</caption>
			</button>
			<button id="btnG3" class="btn_grid04" style="left:852px; top:0px; width:64px; height:17px; ">
				<caption>가나다라</caption>
			</button>
		</group>
		<group id="group_scr" class="gro_sel" style="left:10px; top:50px; width:926px; height:76px; ">
			<caption id="caption5" class="list_cap02" style="left:119px; top:0px; width:807px; height:26px; text-align:center; "/>
			<caption id="caption4" class="list_cap02" style="left:119px; top:25px; width:807px; height:26px; text-align:center; "/>
			<caption id="caption1" class="list_cap02" style="left:119px; top:50px; width:807px; height:26px; text-align:center; "/>
			<caption id="caption25" class="list_cap03" style="left:0px; top:0px; width:120px; height:26px; text-align:center; ">교체일</caption>
			<input id="srch_repl_dt" ref="/root/reqData/search/repl_dt" class="req_100" navindex="1" inputtype="date" caption="교체일" style="left:124px; top:3px; width:100px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						model.send("fc_func_1097_l");
						model.refresh();
						
					]]>
				</script>
			</input>
			<caption id="caption26" class="list_cap03" style="left:534px; top:0px; width:120px; height:26px; text-align:center; ">전표번호</caption>
			<select1 id="srch_slip_no" ref="/root/reqData/search/slip_no" class="req_120" navindex="2" appearance="minimal" caption="전표번호" style="left:658px; top:3px; width:120px; height:18px; ">
				<choices>
					<itemset nodeset="/root/resData/gridData/fc_func_1097_l/dataSet/CURLIST/record">
						<label ref="slip_no"/>
						<value ref="slip_no"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						send_fc_func_1092_l();	
					]]>
				</script>
			</select1>
			<caption id="caption6" class="list_cap03" style="left:0px; top:25px; width:120px; height:26px; text-align:center; ">거래처</caption>
			<select1 id="srch_dlco_clsf_cd" ref="/root/reqData/search/dlco_clsf_cd" class="req_100" navindex="3" appearance="minimal" caption="거래처구분" style="left:124px; top:29px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet">
						<label ref="CUR_DLCO_CLSF_CD/record/cd_nm"/>
						<value ref="CUR_DLCO_CLSF_CD/record/cd"/>
					</itemset>
				</choices>
			</select1>
			<input id="srch_dlco_cd" ref="/root/reqData/search/dlco_cd" class="req_100" navindex="4" inputtype="button" caption="거래처코드" style="left:230px; top:29px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					if (open_fc_acct_1180("button","s","","0")) {
						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					}
					else {
						//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if (open_fc_acct_1180("focus","s","","0")) {
						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					}
					else {
						//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
			</input>
			<input id="dlco_nm" ref="/root/tempData/dlco_nm" class="input_150" navindex="-1" editable="false" inputtype="input" style="left:335px; top:29px; width:150px; height:18px; "/>
			<caption id="caption32" class="list_cap03" style="left:534px; top:25px; width:120px; height:26px; text-align:center; ">만기일</caption>
			<input id="srch_mtry_dt" ref="/root/reqData/search/mtry_dt" class="req_120" navindex="6" inputtype="date" caption="만기일" style="left:658px; top:29px; width:120px; height:18px; "/>
			<caption id="caption29" class="list_cap03" style="left:0px; top:50px; width:120px; height:26px; text-align:center; ">적요</caption>
			<input id="rmks1" ref="/root/reqData/multiUpDate/rmks1" navindex="7" style="left:124px; top:54px; width:280px; height:18px; "/>
			<select id="jobiicr" ref="/root/tempData/jobiicr" navindex="8" overflow="visible" appearance="full" style="left:415px; top:54px; width:100px; height:18px; color:#0000ff; border-style:none; ">
				<choices>
					<item>
						<label>잡이익처리</label>
						<value>1</value>
					</item>
				</choices>
			</select>
			<caption id="caption28" class="list_cap03" style="left:534px; top:50px; width:120px; height:26px; text-align:center; ">교체액</caption>
			<input id="old_note_amt" ref="/root/tempData/old_note_amt" class="input_150" navindex="-1" editable="false" inputtype="input" format="#,###" style="left:658px; top:54px; width:150px; height:18px; text-align:right; "/>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/fc_func_1091_l/dataSet/CURLIST/record" caption="어음구분^어음번호^만기일^어음금액^발행자^거래처^지급지^어음상태^caption1^caption2^caption3^caption4^caption5^caption6^caption7^caption8" colsep="#" colwidth="110, 110, 110, 110, 110, 110, 110, 110, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:10px; top:176px; width:923px; height:245px; ">
			<col ref="b_note_clsf_cd_nm"/>
			<col ref="b_nbn_no"/>
			<col ref="b_pch_cymd1to" format="yyyy-mm-dd"/>
			<col ref="b_rcpay_amt" format="#,###" style="text-align:right; "/>
			<col ref="b_issu_pers_nm"/>
			<col ref="b_dlco_clsf_cd_nm"/>
			<col ref="b_pay_plac_cd_nm"/>
			<col ref="b_now_note_stat_cd_nm"/>
			<col ref="b_bank_cd" visibility="hidden"/>
			<col ref="b_note_no" visibility="hidden"/>
			<col ref="b_note_seq" visibility="hidden"/>
			<col ref="b_dlco_clsf_cd" visibility="hidden"/>
			<col ref="b_dlco_cd" visibility="hidden"/>
			<col ref="b_pay_plac_cd" visibility="hidden"/>
			<col ref="b_now_note_stat_cd" visibility="hidden"/>
			<col ref="b_note_clsf_cd" visibility="hidden"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					_oth_clsf = "1";
					
					gridClick(datagrid1.row);
				]]>
			</script>
		</datagrid>
		<group id="group3" style="left:10px; top:423px; width:928px; height:243px; ">
			<switch id="switch2" style="left:0px; top:40px; width:923px; height:195px; ">
				<case id="case1">
					<caption id="caption34" class="list_cap02" style="left:319px; top:149px; width:256px; height:25px; text-align:center; "/>
					<caption id="caption31" class="list_cap02" style="left:699px; top:120px; width:206px; height:25px; text-align:center; "/>
					<caption id="caption7" class="list_cap02" style="left:319px; top:92px; width:256px; height:25px; text-align:center; "/>
					<caption id="caption13" class="list_cap02" style="left:319px; top:7px; width:256px; height:25px; text-align:center; "/>
					<caption id="caption17" class="list_cap02" style="left:319px; top:63px; width:256px; height:25px; text-align:center; "/>
					<caption id="caption23" class="list_cap02" style="left:699px; top:63px; width:206px; height:25px; text-align:center; "/>
					<datagrid id="datagrid3" nodeset="/root/resData/gridData/fc_func_1093_l/dataSet/CURLIST/record" caption="어음번호^어음구분코드^어음금액^기산일^만기일^발행사코드^발행자명^I^caption1^caption2^caption3^caption4^caption5" colsep="#" colwidth="162, 78, 64, 70, 59, 67, 73, 33, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:10px; top:6px; width:185px; height:167px; ">
						<col ref="a_nbn_no"/>
						<col ref="a_note_clsf_cd" visibility="hidden"/>
						<col ref="a_note_amt" visibility="hidden"/>
						<col ref="a_comp_dt" visibility="hidden"/>
						<col ref="a_mtry_dt" visibility="hidden"/>
						<col ref="a_issu_cmpy_clsf_cd" visibility="hidden"/>
						<col ref="a_issu_pers_nm" visibility="hidden"/>
						<col ref="a_bank_cd_nm" visibility="hidden"/>
						<col ref="a_note_no" visibility="hidden"/>
						<col ref="a_note_seq" visibility="hidden"/>
						<col ref="a_bank_cd" visibility="hidden"/>
						<col ref="a_rcpm_acct" visibility="hidden"/>
						<col ref="a_sale_aprv_no" visibility="hidden"/>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
//								gridClick3(datagrid3.row);	
							]]>
						</script>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
								_oth_clsf = "3";
								
								gridClick3(datagrid3.row);
							]]>
						</script>
					</datagrid>
					<input id="note_no" ref="/root/tempData/note_no" class="req_140" navindex="10" maxlength="8" style="left:324px; top:11px; width:70px; height:18px; "/>
					<caption id="caption12" class="list_cap02" style="left:319px; top:35px; width:256px; height:25px; text-align:center; "/>
					<caption id="caption15" class="list_cap03" style="left:200px; top:35px; width:120px; height:25px; text-align:center; ">은행코드</caption>
					<caption id="caption16" class="list_cap03" style="left:200px; top:7px; width:120px; height:25px; text-align:center; ">어음번호</caption>
					<caption id="caption18" class="list_cap03" style="left:200px; top:63px; width:120px; height:25px; text-align:center; ">기산일</caption>
					<caption id="caption19" class="list_cap02" style="left:699px; top:35px; width:206px; height:25px; text-align:center; "/>
					<caption id="caption20" class="list_cap02" style="left:699px; top:7px; width:206px; height:25px; text-align:center; "/>
					<caption id="caption21" class="list_cap03" style="left:580px; top:35px; width:120px; height:25px; text-align:center; ">어음금액</caption>
					<caption id="caption22" class="list_cap03" style="left:580px; top:7px; width:120px; height:25px; text-align:center; ">어음구분</caption>
					<caption id="caption24" class="list_cap03" style="left:580px; top:63px; width:120px; height:25px; text-align:center; ">만기일</caption>
					<caption id="caption8" class="list_cap03" style="left:200px; top:92px; width:120px; height:25px; text-align:center; ">발행사</caption>
					<caption id="caption9" class="list_cap02" style="left:319px; top:120px; width:256px; height:25px; text-align:center; "/>
					<caption id="caption10" class="list_cap03" style="left:200px; top:120px; width:120px; height:25px; text-align:center; ">어음</caption>
					<input id="bank_cd" ref="/root/tempData/bank_cd" class="req_80" navindex="12" inputtype="button" style="left:324px; top:38px; width:80px; height:18px; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								open_fc_acct_1180_b("button","s","","1");
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								open_fc_acct_1180_b("focus","s","","1");
							]]>
						</script>
					</input>
					<input id="comp_dt" ref="/root/tempData/comp_dt" class="req_140" navindex="15" inputtype="date" style="left:324px; top:67px; width:140px; height:18px; "/>
					<caption id="caption11" class="list_cap02" style="left:699px; top:92px; width:206px; height:25px; text-align:center; "/>
					<caption id="caption30" class="list_cap03" style="left:580px; top:92px; width:120px; height:25px; text-align:center; ">발행자</caption>
					<select1 id="issu_cmpy_clsf_cd" ref="/root/tempData/issu_cmpy_clsf_cd" class="req_140" navindex="17" appearance="minimal" style="left:324px; top:95px; width:140px; height:18px; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/dataSet">
								<label ref="CUR_ISS_CD/record/cd_nm"/>
								<value ref="CUR_ISS_CD/record/cd"/>
							</itemset>
						</choices>
					</select1>
					<select1 id="note_clsf_cd" ref="/root/tempData/note_clsf_cd" class="req_140" navindex="11" appearance="minimal" style="left:705px; top:10px; width:190px; height:18px; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/dataSet/CUR_NOTE_CLSF_CD/record">
								<label ref="cd_nm"/>
								<value ref="cd"/>
							</itemset>
						</choices>
					</select1>
					<input id="note_amt" ref="/root/tempData/note_amt" class="req_140" navindex="14" format="#,###" style="left:705px; top:38px; width:155px; height:18px; text-align:right; "/>
					<input id="mtry_dt" ref="/root/tempData/mtry_dt" class="req_140" navindex="16" inputtype="date" style="left:705px; top:67px; width:100px; height:18px; "/>
					<input id="issu_pers_nm" ref="/root/tempData/issu_pers_nm" class="req_140" navindex="18" style="left:705px; top:95px; width:155px; height:18px; "/>
					<button id="btn_tinsert" class="btn02" crud="C" style="left:745px; top:165px; width:52px; height:21px; ">
						<caption>임시입력</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
								tempinsert();
							]]>
						</script>
					</button>
					<button id="btn_tupdate" class="btn02" crud="U" style="left:800px; top:165px; width:52px; height:21px; ">
						<caption>임시수정</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
								tempupdate();
							]]>
						</script>
					</button>
					<button id="btn_tdelete" class="btn02" crud="D" style="left:855px; top:165px; width:52px; height:21px; ">
						<caption>임시삭제</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
								tempdelete();
							]]>
						</script>
					</button>
					<caption id="caption14" class="list_cap03" style="left:580px; top:120px; width:120px; height:25px; text-align:center; ">매출승인번호</caption>
					<input id="sale_aprv_no" ref="/root/tempData/sale_aprv_no" class="req_140" navindex="19" style="left:705px; top:123px; width:100px; height:18px; "/>
					<input id="bank_nm" ref="/root/tempData/bank_nm" class="input_150" navindex="-1" editable="false" inputtype="input" style="left:410px; top:38px; width:150px; height:18px; "/>
					<input id="new_note_amt_sum" ref="/root/tempData/new_note_amt_sum" class="input_150" navindex="-1" editable="false" inputtype="input" format="#,###" style="left:324px; top:123px; width:150px; height:18px; text-align:right; "/>
					<caption id="caption33" class="list_cap03" style="left:200px; top:149px; width:120px; height:25px; text-align:center; ">입금구분</caption>
					<select1 id="rcpm_acct" ref="/root/tempData/rcpm_acct" class="req_140" navindex="20" appearance="minimal" style="left:324px; top:152px; width:140px; height:18px; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/dataSet/CUR_CARD_CD/record">
								<label ref="cd_nm"/>
								<value ref="cd"/>
							</itemset>
						</choices>
					</select1>
				</case>
				<case id="case2">
					<datagrid id="datagrid5" nodeset="/root/resData/gridData/cashamtList/recode" caption="현금액^caption1^caption2^caption4^caption7^caption6^caption5^caption3^caption8" colsep="^" colwidth="205, 100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:245px; top:20px; width:310px; height:150px; ">
						<col class="req" ref="cashamt" type="input" format="#,###" style="text-align:right; "/>
						<col ref="c_budg_cd" visibility="hidden"/>
						<col ref="c_deps_clsf_cd" visibility="hidden"/>
						<col ref="c_deps_dt" visibility="hidden"/>
						<col ref="c_frex_cd" visibility="hidden"/>
						<col ref="c_exrate" visibility="hidden"/>
						<col ref="c_frex_amt" visibility="hidden"/>
						<col ref="c_trufnd_slip_clsf" visibility="hidden"/>
						<col ref="c_trufnd_slip_no" visibility="hidden"/>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
							_oth_clsf = "5";
							]]>
						</script>
					</datagrid>
				</case>
				<case id="case3" selected="true">
					<datagrid id="datagrid2" nodeset="/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record" caption="예금액^예금예산^예금구분^예금일^외환코드^적용환율^외화금액^p_trufnd_slip_clsf^p_trufnd_slip_no^acct_mang_no^biz_reg_no^bank_id^acct_num^tran_date_seq^current_clsf" colsep="#" colwidth="110, 130, 130, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:30px; top:5px; width:860px; height:125px; ">
						<col class="req" ref="p_repl_amt" type="input" format="#,###" style="text-align:right; ">
							<![CDATA[]]>
						</col>
						<col class="req" ref="p_budg_cd" type="combo">
							<choices>
								<item>
									<label/>
									<value/>
								</item>
								<item>
									<label>011400 보통예금</label>
									<value>011400</value>
								</item>
								<item>
									<label>017300 외화예금</label>
									<value>017300</value>
								</item>
							</choices>
						</col>
						<col class="req" ref="p_deps_clsf_cd" type="combo">
							<choices>
								<itemset nodeset="/root/initData/comboSet/dataSet">
									<label ref="CUR_DEPS_CD/record/cd_nm"/>
									<value ref="CUR_DEPS_CD/record/cd"/>
								</itemset>
							</choices>
						</col>
						<col class="req" ref="p_deps_dt" type="inputdate"/>
						<col ref="p_frex_cd" type="combo">
							<choices>
								<itemset nodeset="/root/initData/comboSet/dataSet">
									<label ref="CUR_FREX_CD/record/cd_nm"/>
									<value ref="CUR_FREX_CD/record/cd"/>
								</itemset>
							</choices>
						</col>
						<col ref="p_exrate" type="input"/>
						<col ref="p_frex_amt" type="input" format="#,###" style="text-align:right; "/>
						<col ref="p_trufnd_slip_clsf" visibility="hidden"/>
						<col ref="p_trufnd_slip_no" visibility="hidden"/>
						<col ref="acct_mang_no" visibility="hidden"/>
						<col ref="biz_reg_no" visibility="hidden"/>
						<col ref="bank_id" visibility="hidden"/>
						<col ref="acct_num" visibility="hidden"/>
						<col ref="tran_date_seq" visibility="hidden"/>
						<col ref="current_clsf" visibility="hidden"/>
						<script type="javascript" ev:event="ondblclick">
							<![CDATA[
							    if (-1 != event.target.lastIndexOf("scroll.thumb")) {
							      return;
							     }     
							
							     var grid = eval(event.currentTarget);
							     var rowid = grid.row;
							     var colid = grid.col;
							     
							     if (rowid < grid.fixedRows || colid < grid.fixedCols) {
							      return;
							     }

				  				var dataIndex = datagrid2.row; // getSelectedRecordIndex(datagrid1);
								if(dataIndex > 0){
									
									var acct_mang_no = model.getValue("/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+dataIndex+"]/p_deps_clsf_cd");

				  					model.makeNode("/root/reqData/fwdData/acct_mang_no_ref");	
				  					model.setValue("/root/reqData/fwdData/acct_mang_no_ref", "/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+dataIndex+"]/p_deps_clsf_cd");
//				  					model.makeNode("/root/reqData/fwdData/acct_mang_nm_ref");	
//				  					model.setValue("/root/reqData/fwdData/acct_mang_nm_ref", "/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+dataIndex+"]/p_deps_clsf_cd");
				  					model.makeNode("/root/reqData/fwdData/tran_amt_ref");	
				  					model.setValue("/root/reqData/fwdData/tran_amt_ref", "/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+dataIndex+"]/p_repl_amt");
//				  					model.makeNode("/root/reqData/fwdData/tran_content_ref");	
//				  					model.setValue("/root/reqData/fwdData/tran_content_ref", "/root/resData/gridData/gridData2/dataSet/CURLIST1/record["+dataIndex+"]/g1_rcpm_pers_nm");		
				  					model.makeNode("/root/reqData/fwdData/acct_tonghwa_ref");	
				  					model.setValue("/root/reqData/fwdData/acct_tonghwa_ref", "/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+dataIndex+"]/p_frex_cd");
				  					model.makeNode("/root/reqData/fwdData/frex_amt_ref");	
				  					model.setValue("/root/reqData/fwdData/frex_amt_ref", "/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+dataIndex+"]/p_frex_amt");
				  							
									loadRcpmDtlsPop("H1"
									                ,""
									                ,"/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+dataIndex+"]/biz_reg_no"
									                ,"/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+dataIndex+"]/bank_id"
									                ,"/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+dataIndex+"]/acct_num"
									                ,"/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+dataIndex+"]/p_deps_dt"
									                ,"/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+dataIndex+"]/tran_date_seq"
									                ,"/root/resData/gridData/fc_func_1094_l_l/dataSet/CURLIST/record["+dataIndex+"]/current_clsf"
												   ,"/root/reqData/fwdData"); 
									
									
									
									var pre_biz_reg_no 	=	"";
									var pre_bank_id		=	"";
									var pre_acct_num		=	"";
									var pre_p_deps_dt		=	"";
									var pre_tran_date_seq	=	"";
									var pre_current_clsf	=	"";
//									alert(datagrid1.fixedRows);
									for(var i=datagrid2.fixedRows; i<datagrid2.rows;i++){
										
										var biz_reg_no 	    =	datagrid2.valueMatrix(i, datagrid2.colRef("biz_reg_no"));
										var bank_id	    =	datagrid2.valueMatrix(i, datagrid2.colRef("bank_id"));
										var acct_num	    =	datagrid2.valueMatrix(i, datagrid2.colRef("acct_num"));
										var p_deps_dt	    =	datagrid2.valueMatrix(i, datagrid2.colRef("p_deps_dt"));
										var tran_date_seq  =	datagrid2.valueMatrix(i, datagrid2.colRef("tran_date_seq"));
										var current_clsf	    =	datagrid2.valueMatrix(i, datagrid2.colRef("current_clsf"));					
										
										if(pre_biz_reg_no != ""){
											if(pre_biz_reg_no 	== 	biz_reg_no &&
											   pre_bank_id		==	bank_id &&
											   pre_acct_num	==	acct_num &&
											   pre_p_deps_dt	==	p_deps_dt &&
											   pre_tran_date_seq	==	tran_date_seq &&
											   pre_current_clsf	==	current_clsf){
											   	
											   	show_message("같은 입금계좌내역이 있습니다.");
											   	datagrid2.deleteRow(i);
											   	datagrid2.insertRow(i);
											   	return;
											}
										}
										
										pre_biz_reg_no 	    =	biz_reg_no;    
										pre_bank_id	    =	bank_id;		    
										pre_acct_num	    =	acct_num;	    
										pre_p_deps_dt	    =	p_deps_dt;	    
										pre_tran_date_seq =	tran_date_seq;
										pre_current_clsf	    =	current_clsf;				
									}							   
									
									datagrid2.refresh();
								   
								}							
							]]>
						</script>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
							_oth_clsf = "2";
							]]>
						</script>
					</datagrid>
				</case>
				<case id="case4">
					<datagrid id="datagrid4" nodeset="/root/resData/gridData/trufnd_slip_no_l/recode" caption="예수금액^예산코드^예수금 NO^예수금전표번호^caption1^caption2^caption3^caption4^caption5" colsep="^" colwidth="164, 143, 143, 196, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:30px; top:15px; width:685px; height:140px; ">
						<col class="req" ref="repl_amt" type="input" format="#,###" style="text-align:right; "/>
						<col class="req" ref="budg_cd" type="combo">
							<choices>
								<item>
									<label/>
									<value/>
								</item>
								<item>
									<label>463100 예수금대체</label>
									<value>463100</value>
								</item>
								<item>
									<label>466400 예수금기타</label>
									<value>466400</value>
								</item>
								<item>
									<label>456100 예수금대체(광고)</label>
									<value>456100</value>
								</item>
							</choices>
						</col>
						<col class="req" ref="trufnd_slip_clsf"/>
						<col class="req" ref="trufnd_slip_no" type="inputbutton" format="99999999-99-9999-99"/>
						<col ref="y_deps_clsf_cd" visibility="hidden"/>
						<col ref="y_deps_dt" visibility="hidden"/>
						<col ref="y_frex_cd" visibility="hidden"/>
						<col ref="y_exrate" visibility="hidden"/>
						<col ref="y_frex_amt" visibility="hidden"/>
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								model.property("FC_ACCT_2500_popup_clsf")  = "Y";
								model.property("FC_ACCT_2500_srch_occr_slip_clsf")  = "92";
							
								viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2500");
								
//									alert(model.property("FC_ACCT_2500_srch_occr_slip_clsf"));
								if(model.property("FC_ACCT_2500_occr_slip") != ""){
									datagrid4.valueMatrix(datagrid4.row,3) = model.property("FC_ACCT_2500_srch_occr_slip_clsf");
								}
								datagrid4.valueMatrix(datagrid4.row,4) = model.property("FC_ACCT_2500_occr_slip").ReplaceString("-", "");
								
								model.property("FC_ACCT_2500_occr_slip") = "";
								model.property("FC_ACCT_2500_srch_occr_slip_clsf") = "";						
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								if(datagrid4.colRef("trufnd_slip_no")== "4"){
									if(get_refvalue("/root/resData/gridData/trufnd_slip_no_l/recode["+datagrid4.row+"]/trufnd_slip_no")==""){
										datagrid4.valueMatrix(datagrid4.row,3) = "";
										datagrid4.refresh();
									}
								}						
							]]>
						</script>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
							_oth_clsf = "4";
							]]>
						</script>
					</datagrid>
				</case>
			</switch>
			<button id="btn_case1" group="1" style="left:0px; top:20px; width:231px; height:20px; text-align:center; vertical-align:middle; background-color:#c0c0c0; border-style:solid; ">
				<caption>신어음</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case1");	
					]]>
				</script>
			</button>
			<button id="btn_case2" group="1" style="left:231px; top:20px; width:231px; height:20px; text-align:center; vertical-align:middle; background-color:#c0c0c0; border-style:solid; ">
				<caption>현금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case2");		
					]]>
				</script>
			</button>
			<button id="btn_case3" group="1" style="left:461px; top:20px; width:231px; height:20px; text-align:center; vertical-align:middle; background-color:#c0c0c0; border-style:solid; ">
				<caption>예금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case3");		
					]]>
				</script>
			</button>
			<button id="btn_case4" group="1" style="left:691px; top:20px; width:232px; height:20px; text-align:center; vertical-align:middle; background-color:#c0c0c0; border-style:solid; ">
				<caption>예수금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case4");		
					]]>
				</script>
			</button>
		</group>
		<group id="group1" style="left:10px; top:710px; width:925px; height:35px; ">
			<button id="btn_select" class="btn02" crud="R" style="left:5px; top:5px; width:52px; height:21px; ">
				<caption>대상조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_fc_func_1091_l();
					]]>
				</script>
			</button>
			<button id="btn_select2" class="btn02" crud="R" style="left:60px; top:5px; width:52px; height:21px; ">
				<caption>내역조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_fc_func_1092_l();
					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" crud="C" style="left:115px; top:5px; width:52px; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (send_fc_func_1095_i()){
							var slipno = trim(get_refvalue("/root/resData/gridData/fc_func_1095_i/dataSet/CURLIST/record/slip_no"));
							srch_slip_no.value = slipno;
							btn_select2.dispatch("onclick");	
						}
					]]>
				</script>
			</button>
			<button id="btn_delete" class="btn02" crud="D" style="left:170px; top:5px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (send_fc_func_1096_d()) {
							reset_model(true); 
							srch_slip_no.value = ""; 
							btn_select.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="btn_reset" class="btn02" style="left:225px; top:5px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.reset();	
						datagrid2.clearStatus();	
					]]>
				</script>
			</button>
			<button id="btn_print" class="btn02" crud="R" style="left:280px; top:5px; width:52px; height:21px; ">
				<caption>전표출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var ch_no = get_refvalue(srch_slip_no);
					if(ch_no == ""){
						show_message("전표번호가 없습니다.");
						return false;
					}
					// 글로벌변수 셋팅
					if(ch_no.length == 13){
						model.property("FC_ACCT_2260_slip_occr_dt")  = ch_no.substring(0, 8);			// 발생일자
						model.property("FC_ACCT_2260_slip_clsf_cd")  = ch_no.substring(8, 10);			// 전표구분
						model.property("FC_ACCT_2260_slip_seqfr") = ch_no.substring(10, 13);			// 일련번호 from
						model.property("FC_ACCT_2260_slip_seqto") = ch_no.substring(10, 13);			// 일련번호 to
						model.property("FC_ACCT_2260_slip_radio1") = "";			// 출력구분
						model.property("FC_ACCT_2260_popup_flag")  = "Y";
					}else{
						model.property("FC_ACCT_2260_slip_occr_dt")  = ch_no.substring(0, 8);			// 발생일자
						model.property("FC_ACCT_2260_slip_clsf_cd")  = ch_no.substring(9, 11);			// 전표구분
						model.property("FC_ACCT_2260_slip_seqfr") = ch_no.substring(12, 15);			// 일련번호 from
						model.property("FC_ACCT_2260_slip_seqto") = ch_no.substring(12, 15);			// 일련번호 to
						model.property("FC_ACCT_2260_slip_radio1") = "";			// 출력구분
						model.property("FC_ACCT_2260_popup_flag")  = "Y";
					}
					
					// 화면호출
					//viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2260", "modal", "align:center; caption:hidden; width:650px; height:480px;");
					viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2260");	
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" style="left:335px; top:5px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					if(_oth_clsf == "2"){			
						grid = datagrid2;
					}
					if(_oth_clsf == "3"){			
						grid = datagrid3;
					}
					if(_oth_clsf == "4"){			
						grid = datagrid4;
					}
					if(_oth_clsf == "5"){			
						grid = datagrid5;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
					]]>
				</script>
			</button>
			<button id="btnColse" class="btn02" style="left:390px; top:5px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose(); 		
					]]>
				</script>
			</button>
		</group>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:0px; top:0px; width:926px; height:29px; "/>
	</xhtml:body>
</xhtml:html>
