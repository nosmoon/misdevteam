<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<hndl_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</hndl_clsf>
							<medi_cd>
								<item>
									<label/>
									<value/>
								</item>
							</medi_cd>
							<issu_cmpy_clsf_cd>
								<item>
									<label/>
									<value/>
								</item>
							</issu_cmpy_clsf_cd>
							<depo_job_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</depo_job_clsf>
							<note_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</note_clsf>
							<prercpm_medi_cd>
								<item>
									<label/>
									<value/>
								</item>
							</prercpm_medi_cd>
							<budg_cd_l_001>
								<item>
									<label/>
									<value/>
								</item>
							</budg_cd_l_001>
							<budg_cd_l_002>
								<item>
									<label/>
									<value/>
								</item>
							</budg_cd_l_002>
						</comboSet>
						<pageInfo/>
						<lbl_btn>조회</lbl_btn>
						<xx>
							<xx_note_clsf_cd_001/>
							<xx_note_clsf_cd_002/>
							<xx_note_clsf_cd_003/>
							<xx_note_clsf_cd_004/>
							<xx_note_clsf_cd_005/>
							<xx_job_clsf_02/>
							<xx_cd_clsf_006/>
							<xx_medi_cd_001/>
							<xx_medi_cd_002/>
							<xx_cd_clsf_007/>
						</xx>
					</initData>
					<reqData>
						<fwdData>
						</fwdData>
						<searchData>
						</searchData>
						<reqForm>
						</reqForm>
					</reqData>
					<resData>
						<resForm>
							<occr_dt/>
							<slip_clsf/>
							<seq/>
							<rcpm_shet_no/>
							<self_cmpy_yn>N</self_cmpy_yn>
							<rcpm_acct/>
							<rcpm_acct_nm/>
							<rcpm_plac_clsf/>
							<dlco_no/>
							<dlco_nm/>
							<medi_cd/>
							<sale_aprv_no/>
							<cash_amt/>
							<fee_amt/>
							<advt_tot_amt/>
							<rcpm_tot_amt/>
							<multiUpdateData1/>
							<multiUpdateData2/>
							<multiUpdateData3/>
							<multiUpdateData4/>
							<multiUpdateData5/>
							<multiUpdateData6/>
							<multiUpdateData7/>
							<multiUpdateData8/>
							<dept_cd>540130</dept_cd>
							<dept_nm>광고관리파트</dept_nm>
							<mchrg_pers/>
							<mchrg_pers_nm/>
							<clos_yn>마감여부</clos_yn>
							<amt_01/>
							<amt_02/>
							<amt_03/>
							<amt_04/>
							<amt_05/>
							<amt_06/>
							<amt_07/>
							<amt_08/>
							<amt_09/>
							<amt_10/>
							<amt_11/>
							<pre_seq/>
							<next_seq/>
						</resForm>
						<gridData1>
							<record>
								<note_no/>
								<bank_cd/>
								<bank_nm/>
								<note_clsf_cd/>
								<comp_dt/>
								<mtry_dt/>
								<note_amt/>
								<sale_dscn_amt/>
								<issu_cmpy_clsf_cd/>
								<issu_pers_nm/>
								<occr_dt/>
								<slip_clsf/>
								<seq/>
								<subseq/>
								<elec_note_key/>
							</record>
						</gridData1>
						<gridData2>
							<record>
								<acct_mang_no/>
								<acct_mang_nm/>
								<rmtt_dt/>
								<amt/>
								<rmtt_coms/>
								<acct_tonghwa/>
								<frex_amt/>
								<rmtt_plac/>
								<occr_dt/>
								<slip_clsf/>
								<seq/>
								<subseq/>
								<biz_reg_no/>
								<bank_id/>
								<acct_num/>
								<tran_date_seq/>
								<current_clsf/>
							</record>
						</gridData2>
						<gridData3>
							<record>
								<checked/>
								<medi_nm/>
								<amt/>
								<occr_amt/>
								<rcpm_slip_no/>
								<occr_dt/>
								<slip_clsf/>
								<seq/>
								<subseq/>
								<medi_cd/>
							</record>
						</gridData3>
						<gridData4>
							<record>
								<checked/>
								<swit_dlco_nm/>
								<amt/>
								<rcpm_slip_no/>
								<occr_dt/>
								<slip_clsf/>
								<seq/>
								<subseq/>
								<budg_cd/>
								<swit_dlco/>
							</record>
						</gridData4>
						<gridData5>
							<record>
								<checked/>
								<budg_cd/>
								<amt/>
								<occr_amt/>
								<rcpm_slip_no/>
								<occr_dt/>
								<slip_clsf/>
								<seq/>
								<subseq/>
							</record>
						</gridData5>
						<gridData6>
							<record>
								<medi_cd/>
								<amt/>
								<occr_dt/>
								<slip_clsf/>
								<seq/>
								<subseq/>
							</record>
						</gridData6>
						<gridData7>
							<record>
								<depo_job_clsf/>
								<amt/>
								<swit_dlco/>
								<swit_dlco_nm/>
								<occr_dt/>
								<slip_clsf/>
								<seq/>
								<subseq/>
							</record>
						</gridData7>
						<gridData8>
							<record>
								<budg_cd/>
								<amt/>
								<occr_dt/>
								<slip_clsf/>
								<seq/>
								<subseq/>
							</record>
						</gridData8>
					</resData>
					<tempData>
						<keyData/>
					</tempData>
					<msgData/>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[

					model.send("ad_dep_1000_m");
					//환경변수
					model.setValue("/root/initData/xx/xx_note_clsf_cd_001"		,  model.getValue("/root/tempData/xx_note_clsf_cd_001"));
					model.setValue("/root/initData/xx/xx_note_clsf_cd_002"		, model.getValue( "/root/tempData/xx_note_clsf_cd_002"));
					model.setValue("/root/initData/xx/xx_note_clsf_cd_003"		, model.getValue( "/root/tempData/xx_note_clsf_cd_003"));
					model.setValue("/root/initData/xx/xx_note_clsf_cd_004"		, model.getValue( "/root/tempData/xx_note_clsf_cd_004"));
					model.setValue("/root/initData/xx/xx_note_clsf_cd_005"		, model.getValue( "/root/tempData/xx_note_clsf_cd_005"));
					model.setValue("/root/initData/xx/xx_job_clsf_02"		,  model.getValue("/root/tempData/xx_job_clsf_02"));					
					model.setValue("/root/initData/xx/xx_cd_clsf_006"		, model.getValue( "/root/tempData/xx_cd_clsf_006"));	
					model.setValue("/root/initData/xx/xx_medi_cd_001"		, model.getValue( "/root/tempData/xx_medi_cd_001"));	
					model.setValue("/root/initData/xx/xx_medi_cd_002"		, model.getValue( "/root/tempData/xx_medi_cd_002"));	
					model.setValue("/root/initData/xx/xx_cd_clsf_007"		, model.getValue( "/root/tempData/xx_cd_clsf_007"));	
																									
					model.copyNode("/root/initData/comboSet/hndl_clsf"		, "/root/tempData/hndl_clsf");
					model.copyNode("/root/initData/comboSet/medi_cd"		, "/root/tempData/medi_cd");
					model.copyNode("/root/initData/comboSet/issu_cmpy_clsf_cd", "/root/tempData/issu_cmpy_clsf_cd");
					model.copyNode("/root/initData/comboSet/depo_job_clsf"	, "/root/tempData/depo_job_clsf");
					model.copyNode("/root/initData/comboSet/note_clsf"		, "/root/tempData/note_clsf");
					model.copyNode("/root/initData/comboSet/prercpm_medi_cd"	, "/root/tempData/prercpm_medi_cd");
					
					model.copyNode("/root/initData/comboSet/budg_cd_l_001"	, "/root/tempData/budg_cd_l_001");
					model.copyNode("/root/initData/comboSet/budg_cd_l_002"	, "/root/tempData/budg_cd_l_002");
															
					model.setValue("/root/resData/resForm/slip_clsf"			, model.getValue("/root/tempData/slip_clsf"));
					
					makeComboGubun("", "/root/initData/comboSet/issu_cmpy_clsf_cd"		, "item", "label", "value");
					makeComboGubun("", "/root/initData/comboSet/depo_job_clsf"			, "item", "label", "value");
	
					model.setValue("/root/resData/resForm/mchrg_pers"	, model.property("ss_emp_no"));
					model.setValue("/root/resData/resForm/mchrg_pers_nm"	, model.property("ss_emp_nm"));
					
					model.refresh();
					
	//				model.send("ad_dep_1010_s");
					
					initPage();
				
				]]>
			</script>
			<submission id="ad_dep_1000_m" action="/ad/dep/1000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="ad_dep_1010_s" action="/ad/dep/1010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/resData"/>
			<submission id="ad_dep_1011_l" action="/ad/dep/1011" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/resData/gridData3"/>
			<submission id="ad_dep_1012_l" action="/ad/dep/1012" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/resData/gridData4"/>
			<submission id="ad_dep_1013_l" action="/ad/dep/1013" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/resData/gridData5"/>
			<submission id="ad_dep_1020_a" action="/ad/dep/1020" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/msgData"/>
			<submission id="ad_dep_1040_a" action="/ad/dep/1040" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/msgData"/>
			<submission id="ad_dep_1030_a" action="/ad/dep/1030" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/msgData"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
			var	_01_changed = false;	//어음
			var	_02_changed = false;	//계좌입금
			var	_03_changed = false;	//현금
			var	_04_changed = false; //선수금대체
			var	_05_changed = false; //대행료대체
			var	_06_changed = false; //예수금대체
			var	_07_changed = false; //기타대체
			var	_08_changed = false; //선수금
			var	_09_changed = false; //예수금
			var	_10_changed = false; //기타입금
			
			function initChangedValue(){
				_01_changed = false;	//어음    
				_02_changed = false;	//계좌입금
				_03_changed = false;	//현금    
				_04_changed = false; //선수금대체 
				_05_changed = false; //대행료대체 
				_06_changed = false; //예수금대체 
				_07_changed = false; //기타대체   
				_08_changed = false; //선수금     
				_09_changed = false; //예수금     
				_10_changed = false; //기타입금
			}
			
			function initVariables(){					
			}
			var _mode;
			
			function setMode(mode){
				_mode = mode;
				
				if(_mode == "INSERT"){
					model.setValue("/root/initData/lbl_btn", "조회");	
				}else if(_mode == "UPDATE"){
					model.setValue("/root/initData/lbl_btn", "삭제");
				}
						
				btn_sub1.refresh();		
				btn_sub2.refresh();		
				btn_sub3.refresh();
					
				initVariables();										
				
			}
			
			function initPage(){					
				
				var occr_dt   = model.property(KEY_OCCR_DT);
				var slip_clsf = model.property(KEY_SLIP_CLSF);
				var seq       = model.property(KEY_SEQ);
				
				if(occr_dt != "" && slip_clsf != "" && seq != ""){
					
					model.setValue("/root/resData/resForm/occr_dt", occr_dt);
					model.setValue("/root/resData/resForm/slip_clsf", slip_clsf);
					model.setValue("/root/resData/resForm/seq", seq);
					inp_occr_dt.refresh();
					inp_slip_clsf.refresh();
					inp_seq.refresh();
					
					loadRcpm();
					
					model.property(KEY_OCCR_DT)	=	"";
					model.property(KEY_SLIP_CLSF)	=	"";
					model.property(KEY_SEQ)		=	"";
					
				}else{
					var occr_dt = getCurrentDate();
					model.setValue("/root/resData/resForm/occr_dt", occr_dt);
					inp_occr_dt.refresh();
					setMode("INSERT");		
					
					cb_medi_cd.select(0);
					cb_rcpm_plac_clsf.select(0);										
				}
			}
			function check_qry(){
				
				var seq = model.getValue("/root/reqData/seq");
				if(trim(seq) == ""){
					alert("일련번호를 입력하세요.");
					return false;
				}
				
				return true;
			}
			function check_subqry(){
				
				var dlco_no = model.getValue("/root/resData/resForm/dlco_no");
				var dlco_nm = model.getValue("/root/resData/resForm/dlco_nm");
				
				if(trim(dlco_no) == "" || trim(dlco_nm) == ""){
					alert("거래처코드가 없습니다.");
					return false;
				}
				return true;
			}
			
			function checkInsert(){

				if(_mode	== "UPDATE"){
					
					var _02_cnt = 0;
					for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
						if(Number(datagrid2.valueMatrix(i, datagrid2.colRef("amt"))) > 0){
							_02_cnt++;
						}
					}
					
					if(_02_cnt > 0){
						if(!_02_changed){
							alert("통장입금이 존재합니다. 삭제 후 처리하세요.");
							return; 
						}
					}
					/* 선수금대체가 있는 전표를 조회 입력할 경우에는 */
					var _04_cnt 		= 0;
					var _readOnly 	= 0;
					for(var i=datagrid3.fixedRows;i<datagrid3.rows;i++){
						if(Number(datagrid3.valueMatrix(i, datagrid3.colRef("amt"))) > 0){
							_04_cnt++;
						}
						if(datagrid3.isReadOnly(i,datagrid3.colRef("checked"))){
							_readOnly++;
						}
					}
					
					if(_04_cnt > 0){
						if(!_04_changed || _readOnly > 0){
							alert("선수금대체가 존재합니다. 삭제 후 처리하세요.");
							return; 
						}
					}
					
					var _06_cnt = 0;
					for(var i=datagrid4.fixedRows;i<datagrid4.rows;i++){
						if(Number(datagrid4.valueMatrix(i, datagrid4.colRef("amt"))) > 0){
							_06_cnt++;
						}
					}
					if(_06_cnt > 0){
						if(!_06_changed){
							alert("예수금대체가 존재합니다. 삭제 후 처리하세요.");
							return; 
						}
					}
					
					var _07_cnt = 0;
					for(var i=datagrid5.fixedRows;i<datagrid5.rows;i++){
						if(Number(datagrid5.valueMatrix(i, datagrid5.colRef("amt"))) > 0){
							_07_cnt++;
						}
					}
					if(_07_cnt > 0){
						if(!_07_changed){
							alert("기타대체가 존재합니다. 삭제 후 처리하세요.");
							return; 
						}
					}
					
				}				

				var rcpm_tot_amt =  model.getValue("/root/resData/resForm/rcpm_tot_amt");
				
				if(rcpm_tot_amt == 0){
					alert("입금액이 없습니다.");
					return false;
				}
				
				var xx_note_clsf_cd_001 = model.getValue("/root/initData/xx/xx_note_clsf_cd_001");
				var xx_note_clsf_cd_002 = model.getValue("/root/initData/xx/xx_note_clsf_cd_002");
				var xx_note_clsf_cd_003 = model.getValue("/root/initData/xx/xx_note_clsf_cd_003");
				
				for(var i=datagrid1.fixedRows; i<datagrid1.rows;i++){
					var note_clsf_cd = model.getValue("/root/resData/gridData1/record["+i+"]/note_clsf_cd");
					var note_no      = model.getValue("/root/resData/gridData1/record["+i+"]/note_no");

//					if(note_clsf_cd == '1061' || note_clsf_cd == '1071' || note_clsf_cd == '1081'){
					if(note_clsf_cd == xx_note_clsf_cd_001 || note_clsf_cd == xx_note_clsf_cd_002 || note_clsf_cd == xx_note_clsf_cd_003){	
						if(note_no != ""){
							alert("구매카드는 어음번호가 자동으로 생성됩니다.");
							model.setValue("/root/resData/gridData1/record["+i+"]/note_no", "");
							return false;
						}
					}
				}
				
				return true;
			}
			
			function gridReqCheck(gridID){
				
				var reqclass = "";
				var reqcaption = "";
				var grid;
				
			   	if( typeof gridID == 'string' ) grid = document.controls(gridID);
			   	else grid = gridID;
			
			    	var strid = grid.attribute("id");
				var rowcnt = grid.rows;
				var colcnt = grid.cols;
				//2009.09.24 KBS - 표지어음(1010), 양도성예금증서(1015)일 경우 할인금액은 필수임.
				var eoeumgb = "";
				
				for(var i=grid.fixedRows ; i< rowcnt ; i++){
	
					var amt	=	0;
					
					if(strid == "datagrid1"){
						amt = Number(datagrid1.valueMatrix(i, datagrid1.colRef("note_amt")));
					}else if(strid == "datagrid2"){
						amt = Number(datagrid2.valueMatrix(i, datagrid2.colRef("amt")));
					}else if(strid == "datagrid6"){
						amt = Number(datagrid6.valueMatrix(i, datagrid6.colRef("amt")));
					}else if(strid == "datagrid7"){
						amt = Number(datagrid7.valueMatrix(i, datagrid7.colRef("amt")));
					}else if(strid == "datagrid8"){
						amt = Number(datagrid8.valueMatrix(i, datagrid8.colRef("amt")));
					}
										
					rstatus = grid.rowStatus(i);
					
					var xx_note_clsf_cd_004 = model.getValue("/root/initData/xx/xx_note_clsf_cd_004");
					var xx_note_clsf_cd_005 = model.getValue("/root/initData/xx/xx_note_clsf_cd_005");
					
					//2009.09.24 KBS - 표지어음(1010), 양도성예금증서(1015)일 경우 할인금액은 필수임.
					eoeumgb = grid.valueMatrix(i, grid.colRef("note_clsf_cd"));
//					if( (eoeumgb == xx_note_clsf_cd_004) || (eoeumgb == xx_note_clsf_cd_005) ){
					if( (eoeumgb == "1010") || (eoeumgb == "1015") ){
						if( grid.valueMatrix(i, grid.colRef("sale_dscn_amt")) == "" ){
							commMsgBox(grid.colAttribute(grid.colRef("sale_dscn_amt"), "caption") + "은(는) 필수입력항목입니다.");
							model.setFocus(strid);
							grid.row = i;
							grid.col = grid.colRef("sale_dscn_amt");
							grid.editCell();
							return false;
						}
					}
						
					if((rstatus!=0) && (rstatus!=5) && (rstatus!=7)){
						
						if(amt > 0){		
						
							for(var j=grid.fixedCols ; j< colcnt ; j++){
							
								reqclass = grid.colAttribute(j, "class");													
								if(rstatus != 0 && reqclass == "req" && grid.valueMatrix(i,j) == ""){
		 			                 		commMsgBox(grid.colAttribute(j, "caption") + "은(는) 필수입력항목입니다.");
									model.setFocus(strid);
									grid.row = i;
									grid.col = j;
									grid.editCell();
									return false;
								}		
							}
						}
					}
				}
			    return true;
			}
						
			var	_pop_clsf	=	"1";			

			function setDlcoInfo(dlco_no, dlco_nm){
				
				if(_pop_clsf	==	"7"){
					datagrid7.valueMatrix(datagrid7.row,datagrid7.colRef("swit_dlco")) 		= dlco_no;
					datagrid7.valueMatrix(datagrid7.row,datagrid7.colRef("swit_dlco_nm")) 	= dlco_nm;
					datagrid7.refresh();
					
				}else{				
					model.setValue("/root/resData/resForm/dlco_no", dlco_no);
					model.setValue("/root/resData/resForm/dlco_nm", dlco_nm);					
					inp_dlco_no.refresh();
					inp_dlco_nm.refresh();		
				}
							
			}
			
			function checkUpdate(){			    				
				

				if(_mode == "INSERT"){
					alert("수정할 전표를 먼저 조회하세요.");
					return false;
				}

				return true;
			}
			
			
			function checkDelete(){
				
				if(_mode == "INSERT"){
					alert("삭제할 전표를 먼저 조회하세요.");
					return false;
				}
				return true;
			}
			
			function loadRcpm(){
				model.send("ad_dep_1010_s");	
				if(submit_completed()){
					var rcpm_tot_amt = Number(model.getValue("/root/resData/resForm/rcpm_tot_amt"));
					if(rcpm_tot_amt == 0){
//						alert("입금정보가 없습니다.");
						return;
					}			
											
					for(var i=datagrid3.fixedRows; i<datagrid3.rows; i++){	
						var checked = model.getValue("/root/resData/gridData3/record["+i+"]/checked");
						if(checked == "Y"){
							datagrid3.isReadOnly(i, datagrid3.colRef("checked")) = true;
							datagrid3.isReadOnly(i, datagrid3.colRef("amt")) = true;
						}
					}						
					for(var i=datagrid4.fixedRows; i<datagrid4.rows; i++){	
						var checked = model.getValue("/root/resData/gridData4/record["+i+"]/checked");
						if(checked == "Y"){
							datagrid4.isReadOnly(i, datagrid4.colRef("checked")) = true;
						}
					}						
					for(var i=datagrid5.fixedRows; i<datagrid5.rows; i++){	
						var checked = model.getValue("/root/resData/gridData5/record["+i+"]/checked");
						if(checked == "Y"){
							datagrid5.isReadOnly(i, datagrid5.colRef("checked")) = true;
							datagrid5.isReadOnly(i, datagrid5.colRef("amt")) = true;
						}
					}						
					
					datagrid1.row= 0;
					datagrid2.row= 0;
					datagrid3.row= 0;
					datagrid4.row= 0;
					datagrid5.row= 0;
					datagrid6.row= 0;
					datagrid7.row= 0;
					datagrid8.row= 0;
					
					var rcpm_tot_amt = Number(model.getValue("/root/resData/resForm/rcpm_tot_amt"));
					//if(rcpm_tot_amt > 0){
					if(rcpm_tot_amt != 0){//20130523 김상훈 (-)금액 처리하기위해서
						setMode("UPDATE");
					}
					
					var clos_yn	=	model.getValue("/root/resData/resForm/clos_yn");
					if(clos_yn	==	"Y"){
//						btn_ins.disabled = true;
						btn_upd.disabled = true;
						btn_del.disabled = true;
					}else{
//						btn_ins.disabled = false;
						btn_upd.disabled = false;
						btn_del.disabled = false;
					}
				}	
				initChangedValue();	
			}
			
			function makeUpdateData(){
//어음내역				
				for(var i=datagrid1.fixedRows; i<datagrid1.rows;i++){
					if(datagrid1.rowStatus(i) == 0 && Number(model.getValue("/root/resData/gridData1/record["+i+"]/note_amt")) > 0){
						datagrid1.addStatus(i, "update");
					}
				}
//통장입금				
				for(var i=datagrid2.fixedRows; i<datagrid2.rows;i++){
					if(datagrid2.rowStatus(i) == 0 && Number(model.getValue("/root/resData/gridData2/record["+i+"]/amt")) > 0){
						datagrid2.addStatus(i, "update");
					}
				}
//선수금대체		
				for(var i=datagrid3.fixedRows; i<datagrid3.rows;i++){
					if( Number(model.getValue("/root/resData/gridData3/record["+i+"]/amt")) != 0 ){
						if(datagrid3.rowStatus(i) == "0"){
							datagrid3.addStatus(i, "update");
						}
					}
				}		
//예수금대체		
				for(var i=datagrid4.fixedRows; i<datagrid4.rows;i++){
					if(Number(model.getValue("/root/resData/gridData4/record["+i+"]/amt")) > 0){
						if(datagrid4.rowStatus(i) == "0"){
							datagrid4.addStatus(i, "update");
						}
					}
				}
//기타입금대체		
				for(var i=datagrid5.fixedRows; i<datagrid5.rows;i++){
					if(Number(model.getValue("/root/resData/gridData5/record["+i+"]/amt")) > 0){
						if(datagrid5.rowStatus(i) == "0"){
							datagrid5.addStatus(i, "update");
						}
					}
				}	
// 선수금				
				for(var i=datagrid6.fixedRows; i<datagrid6.rows;i++){
					if(datagrid6.rowStatus(i) == 0 && Number(model.getValue("/root/resData/gridData6/record["+i+"]/amt")) > 0){
						datagrid6.addStatus(i, "update");
					}
					if(datagrid6.rowStatus(i) == 4){
						datagrid6.rowStatus(i)	= "0";
					}
				}			
// 예수금				
				for(var i=datagrid7.fixedRows; i<datagrid7.rows;i++){
					if(datagrid7.rowStatus(i) == 0 && Number(model.getValue("/root/resData/gridData7/record["+i+"]/amt")) > 0){
						datagrid7.addStatus(i, "update");
					}
					if(datagrid7.rowStatus(i) == 4){
						datagrid7.rowStatus(i)	= "0";
					}
				}			
// 기타입금				
				for(var i=datagrid8.fixedRows; i<datagrid8.rows;i++){
					if(datagrid8.rowStatus(i) == 0 && Number(model.getValue("/root/resData/gridData8/record["+i+"]/amt")) > 0){
						datagrid8.addStatus(i, "update");
					}
					if(datagrid8.rowStatus(i) == 4){
						datagrid8.rowStatus(i)	= "0";
					}
				}				
			}
			
			function makeInsertData(){
//어음내역				
				for(var i=datagrid1.fixedRows; i<datagrid1.rows;i++){
					if(datagrid1.rowStatus(i) == 0 && Number(model.getValue("/root/resData/gridData1/record["+i+"]/note_amt")) > 0){
						datagrid1.addStatus(i, "update");
					}
				}
//통장입금				
				if(_02_changed){
					for(var i=datagrid2.fixedRows; i<datagrid2.rows;i++){
						if(datagrid2.rowStatus(i) == 0 && Number(model.getValue("/root/resData/gridData2/record["+i+"]/amt")) > 0){
							datagrid2.addStatus(i, "update");
						}
					}
				}
//선수금대체		
				if(_05_changed){
					for(var i=datagrid3.fixedRows; i<datagrid3.rows;i++){
						if(Number(model.getValue("/root/resData/gridData3/record["+i+"]/amt")) != 0){
							if(datagrid3.rowStatus(i) == "0"){
								datagrid3.addStatus(i, "update");
							}
						}
					}		
				}
//예수금대체		
				if(_06_changed){
					for(var i=datagrid4.fixedRows; i<datagrid4.rows;i++){
						if(Number(model.getValue("/root/resData/gridData4/record["+i+"]/amt")) > 0){
							if(datagrid4.rowStatus(i) == "0"){
								datagrid4.addStatus(i, "update");
							}
						}
					}
				}
//기타입금대체		
				if(_07_changed){
					for(var i=datagrid5.fixedRows; i<datagrid5.rows;i++){
						if(Number(model.getValue("/root/resData/gridData5/record["+i+"]/amt")) > 0){
							if(datagrid5.rowStatus(i) == "0"){
								datagrid5.addStatus(i, "update");
							}
						}
					}	
				}
// 선수금				
				if(_08_changed){
					for(var i=datagrid6.fixedRows; i<datagrid6.rows;i++){
						var	subseq	=	datagrid6.valueMatrix(i, datagrid6.colRef("subseq"));
						if(subseq == "" && Number(model.getValue("/root/resData/gridData6/record["+i+"]/amt")) > 0){
							datagrid6.addStatus(i, "update");
						}
					}			
				}
// 예수금				
				if(_09_changed){
					for(var i=datagrid7.fixedRows; i<datagrid7.rows;i++){
						var	subseq	=	datagrid7.valueMatrix(i, datagrid7.colRef("subseq"));						
						if(subseq == "" && Number(model.getValue("/root/resData/gridData7/record["+i+"]/amt")) > 0){
							datagrid7.addStatus(i, "update");
						}
					}			
				}
// 기타입금				
				if(_10_changed){
					for(var i=datagrid8.fixedRows; i<datagrid8.rows;i++){
						var	subseq	=	datagrid8.valueMatrix(i, datagrid8.colRef("subseq"));	
						if(subseq == "" && Number(model.getValue("/root/resData/gridData8/record["+i+"]/amt")) > 0){
							datagrid8.addStatus(i, "update");
						}
					}				
				}
			}			
			
			function sum(){					
					
				var _amt_01 = Number(model.getValue("/root/resData/resForm/amt_01"));	
				var _amt_02 = Number(model.getValue("/root/resData/resForm/amt_02"));	
				var _amt_03 = Number(model.getValue("/root/resData/resForm/amt_03"));	
				var _amt_04 = Number(model.getValue("/root/resData/resForm/amt_04"));	
				var _amt_05 = Number(model.getValue("/root/resData/resForm/amt_05"));	
				var _amt_06 = Number(model.getValue("/root/resData/resForm/amt_06"));	
				var _amt_07 = Number(model.getValue("/root/resData/resForm/amt_07"));	
				var _amt_08 = Number(model.getValue("/root/resData/resForm/amt_08"));	
				var _amt_09 = Number(model.getValue("/root/resData/resForm/amt_09"));	
				var _amt_10 = Number(model.getValue("/root/resData/resForm/amt_10"));	
				var _amt_11 = Number(model.getValue("/root/resData/resForm/amt_11"));	
												
				var rcpm_tot_amt  = 0;
				rcpm_tot_amt		+= _amt_01;
				rcpm_tot_amt		+= _amt_02;
				rcpm_tot_amt		+= _amt_03;
				rcpm_tot_amt		+= _amt_04;
				rcpm_tot_amt		+= _amt_05;
				rcpm_tot_amt		+= _amt_06;
				rcpm_tot_amt		+= _amt_07;
				rcpm_tot_amt		+= _amt_11;
				
				var advt_tot_amt  = rcpm_tot_amt - _amt_08 - _amt_09 - _amt_10;
				
				model.setValue("/root/resData/resForm/advt_tot_amt", advt_tot_amt);	
				out_advt_tot_amt.refresh();					
				model.setValue("/root/resData/resForm/rcpm_tot_amt", rcpm_tot_amt);	
				out_rcpm_tot_amt.refresh();	
			}
			
			function findAcctMangNm(acct_mang_no){
				
				if(trim(acct_mang_no) == ""){
					datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("acct_mang_nm")) = "";
					datagrid2.refresh();
					return;
				}
				
				var xx_job_clsf_02  = model.getValue("/root/initData/xx/xx_job_clsf_02");
				var xx_cd_clsf_006 = model.getValue("/root/initData/xx/xx_cd_clsf_006");
				
				makeNodeValue("/root/tempData/searchData/action", "9006");
				makeNodeValue("/root/tempData/searchData/job_clsf", xx_job_clsf_02);
				makeNodeValue("/root/tempData/searchData/cd_clsf", xx_cd_clsf_006);
				
				makeNodeValue("/root/tempData/searchData/srch_cd", acct_mang_no);
				modelSendNoMake("ad_co_9000_s", "/ad/common/9000", "/root/tempData/searchData", "/root/tempData");
			
				datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("acct_mang_no")) =  model.getValue("/root/tempData/srch_cd");
				datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("acct_mang_nm")) =  model.getValue("/root/tempData/srch_nm");
				
				datagrid2.refresh();
				
			}


			var	_event_source	=	"";
			var _event_target		=	"";
			
			function oncopy(){
				_event_source	=	event.currentTarget;
				
				var tempClip = "";
				if(_event_source	==	"datagrid1"){
					
					var firstRow = datagrid1.selectedRow(0);
					var lastRow  = datagrid1.selectedRow(datagrid1.selectedRows-1);				
					for(var i=firstRow;i<=lastRow;i++){
						for(var j=datagrid1.colRef("note_no");j<=datagrid1.colRef("issu_pers_nm");j++){
							tempClip += datagrid1.valueMatrix(datagrid1.row, j);
							tempClip += "\t";
						}
						if(i<lastRow){
							tempClip += "\n";
						}
					}
				}
				window.clipBoardData = tempClip;
				event.stopPropagation();
			}
			
			function onpaste(){

				_event_target	=	event.currentTarget;
				
				var data = window.clipBoardData;
				if(data != ""){
					if(_event_target == "datagrid1"){
						var selectedRow 	= datagrid1.row;
						var arrdata0 	= data.split("\n");	
						for(var i=0;i<arrdata0.length;i++){
							var arrdata 	= arrdata0[i].split("\t");	
							for(var j=0; j<arrdata.length; j++){
								datagrid1.valueMatrix(selectedRow + i,j+1) = arrdata[j];
							}
							datagrid1.addStatus(selectedRow + i, "update");
						}

						var _amt_01	= 0;
						for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
							_amt_01	+=	Number(model.getValue("/root/resData/gridData1/record["+i+"]/note_amt"));
						}
						model.setValue("/root/resData/resForm/amt_01", _amt_01);
						sum();
					}
				}
				datagrid1.refresh();
				event.stopPropagation();
			}			
						
		]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="1,10;1,936;2,59;2,69;2,97;2,124;2,132;2,138;2,151;" style="font-family:굴림; ">
		<caption id="caption15" class="list_cap02" style="left:10px; top:713px; width:926px; height:26px; "/>
		<caption id="caption14" class="list_cap02" style="left:10px; top:688px; width:926px; height:26px; "/>
		<caption id="caption1" class="list_cap02" style="left:10px; top:97px; width:926px; height:28px; "/>
		<caption id="caption12" class="list_cap02" style="left:10px; top:70px; width:926px; height:28px; "/>
		<caption id="caption4" class="list_cap01" style="left:10px; top:70px; width:90px; height:28px; ">전표번호</caption>
		<caption id="caption6" tyle="left:15px; top:180px; width:940px; height:0px;" style="left:0px; top:10px; width:0px; height:0px; ">caption6</caption>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<caption id="caption2" class="list_cap01" style="left:10px; top:97px; width:90px; height:28px; ">입금처구분</caption>
		<button id="btn_ins" class="btn02" crud="C" style="left:579px; top:40px; width:50px; height:21px; ">
			<caption>입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
			

				if(validateReq()){
					if(checkInsert()){

						if(!gridReqCheck("datagrid1")) return;
						if(!gridReqCheck("datagrid2")) return;
						if(!gridReqCheck("datagrid6")) return;
						if(!gridReqCheck("datagrid7")) return;
						if(!gridReqCheck("datagrid8")) return;
											
						if(windowConfirm("입력하시겠습니까?")){		
/*						
							if(_mode == "UPDATE"){
								makeInsertData();					
							}
*/							
							model.setValue("/root/resData/resForm/multiUpdateData1", datagrid1.getUpdateData());
							model.setValue("/root/resData/resForm/multiUpdateData2", datagrid2.getUpdateData());
							model.setValue("/root/resData/resForm/multiUpdateData3", datagrid3.getUpdateData());
							model.setValue("/root/resData/resForm/multiUpdateData4", datagrid4.getUpdateData());
							model.setValue("/root/resData/resForm/multiUpdateData5", datagrid5.getUpdateData());
							model.setValue("/root/resData/resForm/multiUpdateData6", datagrid6.getUpdateData());
							model.setValue("/root/resData/resForm/multiUpdateData7", datagrid7.getUpdateData());
							model.setValue("/root/resData/resForm/multiUpdateData8", datagrid8.getUpdateData());
							
							model.send("ad_dep_1020_a");
							if(submit_completed()){
								model.setValue("/root/resData/resForm/seq", model.getValue("/root/msgData/seq"));
								inp_seq.refresh();
								
								loadRcpm();
							}
						}
					}
				}
				]]>
			</script>
		</button>
		<button id="btn_del" class="btn02" crud="D" style="left:697px; top:40px; width:50px; height:21px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
/*				
				if(_mode != "UPDATE"){
					alert("수정모드가 아닙니다.");
					return;
				}
*/				
				if(checkDelete()){
					if(windowConfirm("삭제하시겠습니까?")){
						model.send("ad_dep_1040_a");
						if(submit_completed()){
//							setMode("INSERT");
//							loadRcpm();
							model.reset();
							initPage();
						}
					}
				}
				
				]]>
			</script>
		</button>
		<button id="btnReset" class="btn02" crud="R" style="left:756px; top:40px; width:50px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				var	occr_dt			=	model.getValue("/root/resData/resForm/occr_dt");
				var	rcpm_plac_clsf		=	model.getValue("/root/resData/resForm/rcpm_plac_clsf");
				var	medi_cd			=	model.getValue("/root/resData/resForm/medi_cd");
				var	slip_clsf			=	model.getValue("/root/resData/resForm/slip_clsf");
				
				model.reset();
				
				model.setValue("/root/resData/resForm/occr_dt", occr_dt);
				model.setValue("/root/resData/resForm/rcpm_plac_clsf", rcpm_plac_clsf);
				model.setValue("/root/resData/resForm/medi_cd", medi_cd);
				model.setValue("/root/resData/resForm/slip_clsf", slip_clsf);
				model.setValue("/root/resData/resForm/mchrg_pers", model.property("ss_emp_no"));
				model.setValue("/root/resData/resForm/mchrg_pers_nm", model.property("ss_emp_nm"));
				
				inp_occr_dt.refresh();
				cb_rcpm_plac_clsf.refresh();
				inp_dlco_no.refresh();
				inp_dlco_nm.refresh();
				cb_medi_cd.refresh();
				inp_slip_clsf.refresh();
				inp_mchrg_pers.refresh();
				inp_mchrg_pers_nm.refresh();
				
				
//				btn_ins.disabled = false;
				btn_upd.disabled = false;
				btn_del.disabled = false;
						
				setMode("INSERT");			
				
				initChangedValue();
					
				]]>
			</script>
		</button>
		<button id="btn_qry" class="btn02" crud="R" style="left:520px; top:40px; width:50px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if(commReqCheck("grp_slip_no")){
					loadRcpm();
				}				
				]]>
			</script>
		</button>
		<button id="btn_upd" class="btn02" crud="U" style="left:638px; top:40px; width:50px; height:21px; ">
			<caption>수정</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						
				if(checkUpdate()){
					if(validateReq()){
						
						if(!gridReqCheck("datagrid1")) return;
						if(!gridReqCheck("datagrid2")) return;
						if(!gridReqCheck("datagrid6")) return;
						if(!gridReqCheck("datagrid7")) return;
						if(!gridReqCheck("datagrid8")) return;
						
						if(windowConfirm("수정하시겠습니까?")){						

							makeUpdateData();
														
							model.setValue("/root/resData/resForm/multiUpdateData1", datagrid1.getUpdateData());
							model.setValue("/root/resData/resForm/multiUpdateData2", datagrid2.getUpdateData());
							model.setValue("/root/resData/resForm/multiUpdateData3", datagrid3.getUpdateData());
							model.setValue("/root/resData/resForm/multiUpdateData4", datagrid4.getUpdateData());
							model.setValue("/root/resData/resForm/multiUpdateData5", datagrid5.getUpdateData());
							model.setValue("/root/resData/resForm/multiUpdateData6", datagrid6.getUpdateData());
							model.setValue("/root/resData/resForm/multiUpdateData7", datagrid7.getUpdateData());
							model.setValue("/root/resData/resForm/multiUpdateData8", datagrid8.getUpdateData());
							
							model.send("ad_dep_1030_a");
							if(submit_completed()){
								loadRcpm();
							}
						}
					}
				}				
				]]>
			</script>
		</button>
		<caption id="caption10" class="list_cap01" style="left:457px; top:70px; width:70px; height:28px; ">자사여부</caption>
		<caption id="caption5" class="list_cap01" style="left:312px; top:70px; width:80px; height:28px; ">입금표번호</caption>
		<caption id="caption7" class="list_cap01" style="left:657px; top:70px; width:80px; height:28px; ">입금계좌</caption>
		<select1 id="combo5" ref="/root/resData/resForm/self_cmpy_yn" class="req" navindex="4" appearance="minimal" caption="자사여부" style="left:533px; top:75px; width:115px; height:18px; ">
			<choices>
				<item>
					<label>Y</label>
					<value>Y</value>
				</item>
				<item>
					<label>N</label>
					<value>N</value>
				</item>
			</choices>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				]]>
			</script>
		</select1>
		<input id="inp_rcpm_shet_no" ref="/root/resData/resForm/rcpm_shet_no" navindex="3" style="left:398px; top:75px; width:55px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var	rcpm_shet_no = inp_rcpm_shet_no.currentText;

				if(rcpm_shet_no	!=	"" && rcpm_shet_no != "0"){
					rcpm_shet_no = lpad(rcpm_shet_no, 7, "0")
				}
				if(rcpm_shet_no == "0"){
					rcpm_shet_no	=	"";
				}
				model.setValue("/root/resData/resForm/rcpm_shet_no", rcpm_shet_no);
				inp_rcpm_shet_no.refresh();
				
				]]>
			</script>
		</input>
		<output id="out_rcpm_acct_nm" ref="/root/resData/resForm/rcpm_acct_nm" navindex="6" style="left:791px; top:75px; width:126px; height:18px; "/>
		<input id="inp_rcpm_acct_no" ref="/root/resData/resForm/rcpm_acct" navindex="5" style="left:742px; top:75px; width:44px; height:18px; ">
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
				var xx_job_clsf_02  = model.getValue("/root/initData/xx/xx_job_clsf_02");
				var xx_cd_clsf_006 = model.getValue("/root/initData/xx/xx_cd_clsf_006");
				
				commonSubmission("9006", inp_rcpm_acct_no.currentText, inp_rcpm_acct_no, out_rcpm_acct_nm, xx_job_clsf_02, xx_cd_clsf_006);	
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				
				]]>
			</script>
		</input>
		<input id="inp_dlco_no" ref="/root/resData/resForm/dlco_no" class="req" navindex="8" autonext="false" maxlength="8" format="99999999" caption="입금처" style="left:209px; top:102px; width:55px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var dlco_no = inp_dlco_no.currentText;
				model.setValue("/root/resData/resForm/dlco_no", lpad(dlco_no, 8, "0"));
				inp_dlco_no.refresh();
				
				commonSubmission("9004", inp_dlco_no.currentText, inp_dlco_no, inp_dlco_nm);	
				
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode== "13"){
					var dlco_no = inp_dlco_no.currentText;
					model.setValue("/root/resData/resForm/dlco_no", lpad(dlco_no, 8, "0"));
					inp_dlco_no.refresh();
					
					commonSubmission("9004", inp_dlco_no.currentText, inp_dlco_no, inp_dlco_nm);					
				}
				]]>
			</script>
		</input>
		<input id="input22" ref="/root/resData/resForm/sale_aprv_no" navindex="11" style="left:742px; top:102px; width:131px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
				]]>
			</script>
		</input>
		<caption id="caption3" class="list_cap01" style="left:457px; top:97px; width:70px; height:28px; ">매체구분</caption>
		<select1 id="cb_medi_cd" ref="/root/resData/resForm/medi_cd" class="req" navindex="10" appearance="minimal" caption="매체구분" style="left:533px; top:102px; width:115px; height:18px; text-align:left; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/medi_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var medi_cd = cb_medi_cd.value;
				
				var xx_medi_cd_001 = model.getValue("/root/initData/xx/xx_medi_cd_001");
				var xx_medi_cd_002 = model.getValue("/root/initData/xx/xx_medi_cd_002");

				if( medi_cd >= xx_medi_cd_001  && medi_cd < xx_medi_cd_002) //출판인 경우
//				if( medi_cd >= "200"  && medi_cd < "300") //출판인 경우
				//if( medi_cd == "200" ) //신문인 경우
				{
					model.setValue("/root/resData/resForm/slip_clsf", "27");
					/*
					inp_dept_cd.value		=	"000315";
					inp_dept_nm.value		=	"생활미디어";
					inp_mchrg_pers.value	=	"000315";
					inp_mchrg_pers_nm.value	=	"생활미디어";
					inp_dept_cd.refresh();
					inp_dept_nm.refresh();
					inp_mchrg_pers.refresh();
					inp_mchrg_pers_nm.refresh();
					inp_dept_cd.disabled			=	true;
					inp_dept_nm.disabled		=	true;
					inp_mchrg_pers.disabled		=	true;
					inp_mchrg_pers_nm.disabled	=	true;
					*/
					inp_dept_cd.disabled			=	false;
					inp_dept_nm.disabled		=	false;
					inp_mchrg_pers.disabled		=	false;
					inp_mchrg_pers_nm.disabled	=	false;					
				}
				else if(medi_cd == "350")
				{
					model.setValue("/root/resData/resForm/slip_clsf", "19");
					inp_dept_cd.disabled			=	false;
					inp_dept_nm.disabled		=	false;
					inp_mchrg_pers.disabled		=	false;
					inp_mchrg_pers_nm.disabled	=	false;
					//부서 변경하기
					var dept_cd = model.property("ss_deptcd");
					if(dept_cd != "" && dept_cd != "S20000"){
						commonSubmission("9007", dept_cd, inp_dept_cd, inp_dept_nm);
					}
				}
				else //if(medi_cd < "200")
				{
					model.setValue("/root/resData/resForm/slip_clsf", "17");
					inp_dept_cd.disabled			=	false;
					inp_dept_nm.disabled		=	false;
					inp_mchrg_pers.disabled		=	false;
					inp_mchrg_pers_nm.disabled	=	false;
				}
				inp_slip_clsf.refresh();
				]]>
			</script>
		</select1>
		<select1 id="cb_rcpm_plac_clsf" ref="/root/resData/resForm/rcpm_plac_clsf" class="req" navindex="7" appearance="minimal" caption="입금처구분" style="left:104px; top:102px; width:100px; height:18px; text-align:left; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/hndl_clsf/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				]]>
			</script>
		</select1>
		<input id="inp_dlco_nm" ref="/root/resData/resForm/dlco_nm" class="req" navindex="9" imemode="hangul" inputtype="button" caption="입금처" style="left:268px; top:102px; width:180px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				var rcpm_plac_clsf = model.getValue("/root/resData/resForm/rcpm_plac_clsf");
				_pop_clsf	=	"1";
				if(rcpm_plac_clsf == "1" || rcpm_plac_clsf == "3" ){
					showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText);	
				}else if(rcpm_plac_clsf == "2"){
					showAdvcsSearchPopup("", "", "Y", "", "", inp_dlco_nm.currentText);	
				}else if(rcpm_plac_clsf == "4") {
					showAdvcsSearchPopup("", "", "", "Y", "", inp_dlco_nm.currentText);	
				}else if(rcpm_plac_clsf == "5") {
					showAdvcsSearchPopup("", "", "", "", "Y", inp_dlco_nm.currentText);	
				}
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode== "13"){
					var rcpm_plac_clsf = model.getValue("/root/resData/resForm/rcpm_plac_clsf");
					_pop_clsf	=	"1";
					if(rcpm_plac_clsf == "1" || rcpm_plac_clsf == "3" ){
						findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
					}else if(rcpm_plac_clsf == "2"){
						findDlcoNoByName("2", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
					}else if(rcpm_plac_clsf == "4") {
						findDlcoNoByName("4", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
					}else if(rcpm_plac_clsf == "5") {
						findDlcoNoByName("4", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
					}
				}					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var rcpm_plac_clsf = model.getValue("/root/resData/resForm/rcpm_plac_clsf");
				_pop_clsf	=	"1";
				if(rcpm_plac_clsf == "1" || rcpm_plac_clsf == "3" ){
					findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
				}else if(rcpm_plac_clsf == "2"){
					findDlcoNoByName("2", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
				}else if(rcpm_plac_clsf == "4") {
					findDlcoNoByName("4", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
				}else if(rcpm_plac_clsf == "5") {
					findDlcoNoByName("4", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
				}				
				
				]]>
			</script>
		</input>
		<caption id="caption28" class="list_cap01" style="left:657px; top:97px; width:80px; height:28px; ">승인번호</caption>
		<datagrid id="datagrid3" nodeset="/root/resData/gridData3/record" caption="선택^매 체^대체액^선수금^입금전표번호^발생일자^전표구분^순번^SUB순번^MEDI_CD" colsep="#" colwidth="35, 100, 90, 90, 163, 59, 53, 45, 54, 100" defaultrows="6" extendlastcol="scroll" mergecellsfixedcols="byrowrec" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="byrow" style="left:10px; top:446px; width:535px; height:62px; ">
			<col checkvalue="Y,N" ref="checked" type="checkbox"/>
			<col ref="medi_nm"/>
			<col ref="amt" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="occr_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="rcpm_slip_no" format="99999999-99-9999-999"/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="slip_clsf" visibility="hidden"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="subseq" visibility="hidden"/>
			<col ref="medi_cd" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				_04_changed = true;
				var occr_amt	= Number(datagrid3.valueMatrix(datagrid3.row, datagrid3.colRef("occr_amt")));
				var amt 		= Number(datagrid3.valueMatrix(datagrid3.row, datagrid3.colRef("amt")));
				if(amt > occr_amt){
					alert("대체액이 잔액보다 클 수 없습니다.");
					datagrid3.valueMatrix(datagrid3.row, datagrid3.colRef("amt")) = "";	
					datagrid2.rowStatus(datagrid3.row) = "0";
					datagrid3.refresh();
				}
				
				datagrid3.valueMatrix(datagrid3.row, datagrid3.colRef("checked")) = "Y";
				
				var indx = getSelectedRecordIndex(datagrid3);
				var _amt_04	= Number(model.getValue("/root/resData/resForm/amt_04"));				
				_amt_04 += Number(model.getValue("/root/resData/gridData3/record["+indx+"]/amt"));				
				model.setValue("/root/resData/resForm/amt_04", _amt_04);				
				sum();				
				
				]]>
			</script>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
				
				var indx = getSelectedRecordIndex(datagrid3);
				var _amt_04	= Number(model.getValue("/root/resData/resForm/amt_04"));				
				_amt_04 += Number(model.getValue("/root/resData/gridData3/record["+indx+"]/amt"));				
				model.setValue("/root/resData/resForm/amt_04", _amt_04);				
				sum();
				
				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[
				
				var indx = getSelectedRecordIndex(datagrid3);
				var _amt_04	= Number(model.getValue("/root/resData/resForm/amt_04"));
				
				_amt_04 -= Number(model.getValue("/root/resData/gridData3/record["+indx+"]/amt"));
				
				model.setValue("/root/resData/resForm/amt_04", _amt_04);
				
				sum();
				
				]]>
			</script>
		</datagrid>
		<datagrid id="datagrid6" nodeset="/root/resData/gridData6/record" caption="매체^금액^발생일자^전표구분^순번^SUB순번" colsep="#" colwidth="128, 117, 100, 100, 100, 100" mergecellsfixedcols="byrowrec" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="byrow" style="left:562px; top:446px; width:375px; height:62px; ">
			<col class="req" ref="medi_cd" type="combo" caption="매체" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/prercpm_medi_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col class="req" ref="amt" type="input" format="(-)#,###" caption="금액" style="text-align:right; "/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="slip_clsf" visibility="hidden"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="subseq" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					if(datagrid6.col == datagrid6.colRef("amt")){
						var _amt_08	= 0;
						for(var i=datagrid6.fixedRows;i<datagrid6.rows;i++){
							_amt_08	+=	Number(model.getValue("/root/resData/gridData6/record["+i+"]/amt"));
						}
						model.setValue("/root/resData/resForm/amt_08", _amt_08);												
						sum();	
					}	
					_08_changed = true;			
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == 13){
					if(datagrid6.col== datagrid6.colRef("amt")){
						datagrid6.addRow();
					}
				}
				]]>
			</script>
		</datagrid>
		<input id="input8" ref="/root/resData/resForm/cash_amt" format="(-)#,###" style="left:777px; top:340px; width:140px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[	
				model.setValue("/root/resData/resForm/amt_03", model.getValue("/root/resData/resForm/cash_amt"));
				sum();
				
				_03_changed = true;
				]]>
			</script>
		</input>
		<datagrid id="datagrid7" nodeset="/root/resData/gridData7/record" caption="업무구분^금액^전환거래처^전환거래처^발생일자^전표구분^순번^SUB순번" colsep="#" colwidth="107, 85, 59, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedcols="bycolrec" mergecellsfixedrows="byrowrec" rowheader="update" rowsep="|" selectionmode="byrow" style="left:562px; top:534px; width:375px; height:62px; ">
			<col class="req" ref="depo_job_clsf" type="combo" caption="업무구분" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/depo_job_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col class="req" ref="amt" type="input" format="(-)#,###" caption="금액" style="text-align:right; "/>
			<col class="req" ref="swit_dlco" type="input" caption="전환거래처" style="text-align:left; "/>
			<col class="req" ref="swit_dlco_nm" type="input" caption="전환거래처" style="text-align:left; "/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="slip_clsf" visibility="hidden"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="subseq" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					if(datagrid7.col == datagrid7.colRef("amt")){
						
						datagrid7.valueMatrix(datagrid7.row, datagrid7.colRef("swit_dlco_nm")) = model.getValue("/root/resData/resForm/dlco_nm");
						datagrid7.valueMatrix(datagrid7.row, datagrid7.colRef("swit_dlco")) = model.getValue("/root/resData/resForm/dlco_no");
						
						var _amt_09	= 0;
						for(var i=datagrid7.fixedRows;i<datagrid7.rows;i++){
							_amt_09	+=	Number(model.getValue("/root/resData/gridData7/record["+i+"]/amt"));
						}
						model.setValue("/root/resData/resForm/amt_09", _amt_09);												
						sum();	
					}	
					if(datagrid7.col == datagrid7.colRef("swit_dlco")){
						var dataIndex = getSelectedRecordIndex(datagrid7);
						var swit_dlco   = 	datagrid7.valueMatrix(datagrid7.row, datagrid7.colRef("swit_dlco"));
						if(swit_dlco == ""){
							datagrid7.valueMatrix(datagrid7.row, datagrid7.colRef("swit_dlco_nm"))	=	"";
						}else{
							swit_dlco		 = 	lpad(swit_dlco, 8, "0");
							datagrid7.valueMatrix(datagrid7.row, datagrid7.colRef("swit_dlco"))	=	swit_dlco;
							commonSubmissionWithXRef("9004", swit_dlco ,  "/root/resData/gridData7/record["+dataIndex+"]/swit_dlco", "/root/resData/gridData7/record["+dataIndex+"]/swit_dlco_nm");
						}
					}					
					if(datagrid7.col == datagrid7.colRef("swit_dlco_nm")){
						var dataIndex = getSelectedRecordIndex(datagrid7);
						var swit_dlco_nm	   = model.getValue("/root/resData/gridData7/record["+dataIndex+"]/swit_dlco_nm");						
						if(swit_dlco_nm == ""){
							datagrid7.valueMatrix(datagrid7.row, datagrid7.colRef("swit_dlco"))	=	"";
						}else{
							_pop_clsf	=	"7";
							findDlcoNoByNameWithRef("1", swit_dlco_nm, "/root/resData/gridData7/record["+dataIndex+"]/swit_dlco", "/root/resData/gridData7/record["+dataIndex+"]/swit_dlco_nm");
						}
					}
					_09_changed = true;
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[

				if(event.keyCode == 13){
					if(datagrid7.col== datagrid7.colRef("swit_dlco_nm")){
						datagrid7.addRow();
					}
				}				
				]]>
			</script>
		</datagrid>
		<input id="input9" ref="/root/resData/resForm/fee_amt" format="(-)#,###" style="left:777px; top:380px; width:140px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				model.setValue("/root/resData/resForm/amt_05", model.getValue("/root/resData/resForm/fee_amt"));
				sum();
				
				_05_changed = true;
				]]>
			</script>
		</input>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData2/record" caption="계좌번호^계좌번호^송금일자^금액^송금수수료^통화^외환금액^송금처^발생일자^전표구분^순번^SUB순번^biz_reg_no^bank_id^acct_num^tran_date_seq^current_clsf" colsep="#" colwidth="70, 169, 75, 80, 80, 40, 80, 80, 50, 50, 50, 50, 100, 100, 100, 100, 100" mergecellsfixedcols="byrowrec" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="byrow" style="left:10px; top:339px; width:745px; height:82px; ">
			<col class="req" ref="acct_mang_no" type="input" format="9999" caption="관리계좌번호"/>
			<col class="req" editable="false" ref="acct_mang_nm" type="inputbutton" caption="관리계좌번호" style="text-align:left; word-wrap:none; "/>
			<col class="req" ref="rmtt_dt" type="input" format="yyyy-mm-dd" caption="송금일자"/>
			<col class="req" ref="amt" type="input" format="(-)#,###" caption="거래금액" style="text-align:right; "/>
			<col ref="rmtt_coms" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="acct_tonghwa"/>
			<col ref="frex_amt" type="input" format="(-)#,###.99" style="text-align:right; "/>
			<col class="req" ref="rmtt_plac" type="input" caption="송금처" style="text-align:left; word-wrap:none; "/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="slip_clsf" visibility="hidden"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="subseq" visibility="hidden"/>
			<col ref="biz_reg_no" visibility="hidden"/>
			<col ref="bank_id" visibility="hidden"/>
			<col ref="acct_num" visibility="hidden"/>
			<col ref="tran_date_seq" visibility="hidden"/>
			<col ref="current_clsf" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[					
					if(datagrid2.col == datagrid2.colRef("amt")){

						var current_clsf = datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("current_clsf"));
						
						var _amt_02	= 0;
						for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
							_amt_02	+=	Number(model.getValue("/root/resData/gridData2/record["+i+"]/amt"));
						}
						model.setValue("/root/resData/resForm/amt_02", _amt_02);												
						sum();	

						
						var	amt	=	Number(datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("amt")));
						if(amt > 0){
							var	dlco_nm	=	model.getValue("/root/resData/resForm/dlco_nm");
							datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("rmtt_plac")) = dlco_nm;
						}else{
							datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("rmtt_plac")) = "";
						}
						datagrid2.refresh();
												
					}								
					if(datagrid2.col == datagrid2.colRef("rmtt_coms")){
						var _amt_11	= 0;
						for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
							_amt_11	+=	Number(model.getValue("/root/resData/gridData2/record["+i+"]/rmtt_coms"));
						}
						model.setValue("/root/resData/resForm/amt_11", _amt_11);						
						sum();
					}
					if(datagrid2.col == datagrid2.colRef("acct_mang_no")){
						var acct_mang_no = datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("acct_mang_no"));
						findAcctMangNm(acct_mang_no);
						
						datagrid2.col = datagrid2.colRef("acct_mang_nm");
						datagrid2.editCell();						
					}
					_02_changed = true;
				]]>
			</script>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[

				]]>
			</script>
			<script type="javascript" ev:event="onstartedit">
				<![CDATA[
/*				
					if(datagrid2.col == datagrid2.colRef("amt")){
						var current_clsf = datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("current_clsf"));
						if(current_clsf == "D"){
							alert("원화입금액은 수정할 수 없습니다.");
						}
					}				
					*/
				]]>
			</script>
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				if(datagrid2.col==datagrid2.colRef("acct_mang_no")){
					
					var indx = getSelectedRecordIndex(datagrid2);
					var cd   =  model.getValue("/root/resData/gridData2/record["+indx+"]/acct_mang_no");
					var cdnm =  model.getValue("/root/resData/gridData2/record["+indx+"]/acct_mang_nm");	
						
					var resultRef1 = "/root/resData/gridData2/record["+indx+"]/acct_mang_no";
					var resultRef2 = "/root/resData/gridData2/record["+indx+"]/acct_mang_nm";
					
					var xx_job_clsf_02 = model.getValue("/root/initData/xx/xx_job_clsf_02");//02
					var xx_cd_clsf_006 = model.getValue("/root/initData/xx/xx_cd_clsf_001");//68
					
					showCommonCodePopup1(xx_job_clsf_02, xx_cd_clsf_006, cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");					
				}
				if(datagrid2.col==datagrid2.colRef("acct_mang_nm")){
					var dataIndex = getSelectedRecordIndex(datagrid2);
					var acct_mang_no = model.getValue("/root/resData/gridData2/record["+dataIndex+"]/acct_mang_no");

  					makeNodeValue("/root/reqData/fwdData/acct_mang_no_ref"	,"/root/resData/gridData2/record["+dataIndex+"]/acct_mang_no");		
  					makeNodeValue("/root/reqData/fwdData/acct_mang_nm_ref"	,"/root/resData/gridData2/record["+dataIndex+"]/acct_mang_nm");	  					
  					makeNodeValue("/root/reqData/fwdData/tran_amt_ref"		,"/root/resData/gridData2/record["+dataIndex+"]/amt");
  					makeNodeValue("/root/reqData/fwdData/tran_content_ref"	,"/root/resData/gridData2/record["+dataIndex+"]/rmtt_plac");		
  					makeNodeValue("/root/reqData/fwdData/acct_tonghwa_ref"	,"/root/resData/gridData2/record["+dataIndex+"]/acct_tonghwa");	
  					makeNodeValue("/root/reqData/fwdData/frex_amt_ref"		,"/root/resData/gridData2/record["+dataIndex+"]/frex_amt");			
  							
					var 	system_clsf	=	"A1";
					var	slip_clsf	=	model.getValue("/root/resData/resForm/slip_clsf");
					if(slip_clsf		==	"27"){
						system_clsf	=	"A2";
					}
					  							
					loadRcpmDtlsPop(system_clsf
					                ,""
					                ,"/root/resData/gridData2/record["+dataIndex+"]/biz_reg_no"
					                ,"/root/resData/gridData2/record["+dataIndex+"]/bank_id"
					                ,"/root/resData/gridData2/record["+dataIndex+"]/acct_num"
					                ,"/root/resData/gridData2/record["+dataIndex+"]/rmtt_dt"
					                ,"/root/resData/gridData2/record["+dataIndex+"]/tran_date_seq"
					                ,"/root/resData/gridData2/record["+dataIndex+"]/current_clsf"
								   ,"/root/reqData/fwdData"); 
					
					var pre_biz_reg_no 	=	"";
					var pre_bank_id		=	"";
					var pre_acct_num		=	"";
					var pre_rmtt_dt		=	"";
					var pre_tran_date_seq	=	"";
					var pre_current_clsf	=	"";
					
					for(var i=datagrid2.fixedRows; i<datagrid2.rows;i++){
						
						var biz_reg_no 	    =	datagrid2.valueMatrix(i, datagrid2.colRef("biz_reg_no"));
						var bank_id		    =	datagrid2.valueMatrix(i, datagrid2.colRef("bank_id"));
						var acct_num	    		=	datagrid2.valueMatrix(i, datagrid2.colRef("acct_num"));
						var rmtt_dt		    =	datagrid2.valueMatrix(i, datagrid2.colRef("rmtt_dt"));
						var tran_date_seq		=	datagrid2.valueMatrix(i, datagrid2.colRef("tran_date_seq"));
						var current_clsf		=	datagrid2.valueMatrix(i, datagrid2.colRef("current_clsf"));					
						
						if(pre_biz_reg_no != ""){
							if(pre_biz_reg_no 	== 	biz_reg_no &&
							   pre_bank_id		==	bank_id &&
							   pre_acct_num		==	acct_num &&
							   pre_rmtt_dt		==	rmtt_dt &&
							   pre_tran_date_seq	==	tran_date_seq &&
							   pre_current_clsf	==	current_clsf){
							   	
							   	alert("같은 입금계좌내역이 있습니다.");
							   	datagrid2.deleteRow(i);
							   	return;
							}
						}
						
						pre_biz_reg_no 	    =	biz_reg_no;    
						pre_bank_id		    =	bank_id;		    
						pre_acct_num			=	acct_num;	    
						pre_rmtt_dt		    =	rmtt_dt;	    
						pre_tran_date_seq		=	tran_date_seq;
						pre_current_clsf		=	current_clsf;				
					}							   
					var acct_mang_nm = datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("acct_mang_nm"));
					if(acct_mang_nm.indexOf(" ")  != -1){
						acct_mang_nm = acct_mang_nm.substring(acct_mang_nm.indexOf(" ")+1);
						datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("acct_mang_nm"))	=	acct_mang_nm;
					}
					
					datagrid2.refresh();
								   
					var amt 		= datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("amt"));
					var frex_amt = datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("frex_amt"));
					
					if(amt != "" || frex_amt != ""){
						datagrid2.addStatus(datagrid2.row,"update");	
						var _amt_02	= 0;
						for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
							_amt_02	+=	Number(model.getValue("/root/resData/gridData2/record["+i+"]/amt"));
						}
						model.setValue("/root/resData/resForm/amt_02", _amt_02);												
						sum();								
					}										   
					
				}
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == 13){
					if(datagrid2.col == datagrid2.colRef("rmtt_plac")){
						datagrid2.addRow();
					}
				}
				]]>
			</script>
		</datagrid>
		<datagrid id="datagrid8" nodeset="/root/resData/gridData8/record" caption="예산코드^금액^발생일자^전표구분^순번^SUB순번" colsep="#" colwidth="126, 115, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedcols="bycolrec" mergecellsfixedrows="byrowrec" rowheader="update" rowsep="|" selectionmode="byrow" style="left:562px; top:622px; width:375px; height:62px; ">
			<col class="req" ref="budg_cd" type="combo" caption="예산코드" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/budg_cd_l_001/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col class="req" ref="amt" type="input" format="(-)#,###" caption="금액" style="text-align:right; "/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="slip_clsf" visibility="hidden"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="subseq" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[	
					if(datagrid8.col == datagrid8.colRef("amt")){
						var _amt_10	= 0;
						for(var i=datagrid8.fixedRows;i<datagrid8.rows;i++){
							_amt_10	+=	Number(model.getValue("/root/resData/gridData8/record["+i+"]/amt"));
						}
						model.setValue("/root/resData/resForm/amt_10", _amt_10);												
						sum();	
					}	
					_10_changed = true;
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == 13){
					if(datagrid8.col==datagrid8.colRef("amt")){
						datagrid8.addRow();
					}
				}
				]]>
			</script>
		</datagrid>
		<datagrid id="datagrid5" nodeset="/root/resData/gridData5/record" caption="선택^예산코드^대체액^기타입금^입금전표번호^발생일자^전표구분^순번^SUB순번" colsep="#" colwidth="35, 128, 164, 164, 50, 50, 50, 50, 50" defaultrows="3" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="byrow" style="left:10px; top:622px; width:535px; height:62px; ">
			<col checkvalue="Y,N" ref="checked" type="checkbox"/>
			<col class="req" ref="budg_cd" type="combo" caption="예산코드" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/budg_cd_l_002/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="amt" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="occr_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="rcpm_slip_no" visibility="hidden" format="99999999-99-9999-999"/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="slip_clsf" visibility="hidden"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="subseq" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[

				var indx 	= getSelectedRecordIndex(datagrid5);
				var _amt_07 	= Number(model.getValue("/root/resData/resForm/amt_07"));				
				_amt_07 	   += Number(model.getValue("/root/resData/gridData5/record["+indx+"]/amt"));				
				model.setValue("/root/resData/resForm/amt_07", _amt_07);				
				sum();
								
				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[

				var indx 	= getSelectedRecordIndex(datagrid5);
				var _amt_07 	= Number(model.getValue("/root/resData/resForm/amt_07"));				
				_amt_07 	   -= Number(model.getValue("/root/resData/gridData5/record["+indx+"]/amt"));				
				model.setValue("/root/resData/resForm/amt_07", _amt_07);				
				sum();
								
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					_07_changed = true;
					var occr_amt	= Number(datagrid5.valueMatrix(datagrid5.row, datagrid5.colRef("occr_amt")));
					var amt 		= Number(datagrid5.valueMatrix(datagrid5.row, datagrid5.colRef("amt")));
					var budg_cd	= Number(datagrid5.valueMatrix(datagrid5.row, datagrid5.colRef("budg_cd")));
//					alert(budg_cd);
					if(amt > occr_amt && budg_cd <= 488800){
						alert("대체액이 잔액보다 클 수 없습니다.");
						datagrid5.valueMatrix(datagrid5.row, datagrid5.colRef("amt")) = "";	
//						datagrid2.rowStatus(datagrid5.row) = "0";
						datagrid5.refresh();
					}
					
					datagrid5.valueMatrix(datagrid5.row, datagrid5.colRef("checked")) = "Y";
					
					var indx = getSelectedRecordIndex(datagrid5);
					var _amt_07	= Number(model.getValue("/root/resData/resForm/amt_07"));
					_amt_07 += Number(model.getValue("/root/resData/gridData5/record["+indx+"]/amt"));				
					model.setValue("/root/resData/resForm/amt_07", _amt_07);
					sum();				
				]]>
			</script>
		</datagrid>
		<datagrid id="datagrid4" nodeset="/root/resData/gridData4/record" caption="선택^전환거래처^금 액^입금전표번호^발생일자^전표구분^순번^SUB순번^예산코드^ SWIT_DLCO" colsep="#" colwidth="36, 191, 101, 164, 53, 54, 47, 55, 100, 100" defaultrows="3" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="byrow" style="left:10px; top:534px; width:535px; height:62px; ">
			<col checkvalue="Y,N" ref="checked" type="checkbox"/>
			<col ref="swit_dlco_nm"/>
			<col ref="amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="rcpm_slip_no" format="99999999-99-9999-999"/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="slip_clsf" visibility="hidden"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="subseq" visibility="hidden"/>
			<col ref="budg_cd" visibility="hidden"/>
			<col ref="swit_dlco" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[

				var indx = getSelectedRecordIndex(datagrid4);
				var _amt_06	= Number(model.getValue("/root/resData/resForm/amt_06"));				
				_amt_06 += Number(model.getValue("/root/resData/gridData4/record["+indx+"]/amt"));				
				model.setValue("/root/resData/resForm/amt_06", _amt_06);				
				sum();
								
				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[

				var indx = getSelectedRecordIndex(datagrid4);
				var _amt_06	= Number(model.getValue("/root/resData/resForm/amt_06"));				
				_amt_06 -= Number(model.getValue("/root/resData/gridData4/record["+indx+"]/amt"));				
				model.setValue("/root/resData/resForm/amt_06", _amt_06);				
				sum();
								
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				_06_changed = true;
				]]>
			</script>
		</datagrid>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData1/record" caption="어음번호^은행^은행^구분^발행일자^만기일자^어음금액^할인금액^사업자구분^발행자^발생일자^전표구분^순번^SUB순번" colsep="#" colwidth="70, 50, 120, 125, 85, 85, 90, 90, 75, 76, 50, 51, 50, 50" mergecellsfixedcols="byrowrec" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="byrow" style="left:10px; top:152px; width:926px; height:162px; ">
			<col ref="note_no" type="input" maxlength="8" caption="어음번호"/>
			<col class="req" ref="bank_cd" type="input" maxlength="6" caption="은행"/>
			<col class="req" ref="bank_nm" type="inputbutton" caption="은행" style="text-align:left; word-wrap:none; "/>
			<col class="req" editmode="search" ref="note_clsf_cd" type="combo" caption="구분" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/note_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="comp_dt" type="inputdate" format="yyyy-mm-dd" caption="발행일자"/>
			<col class="req" ref="mtry_dt" type="inputdate" format="yyyy-mm-dd" caption="만기일자"/>
			<col class="req" ref="note_amt" type="input" format="(-)#,###" caption="어음금액" style="text-align:right; "/>
			<col ref="sale_dscn_amt" type="input" format="(-)#,###" caption="할인금액" style="text-align:right; "/>
			<col editmode="search" ref="issu_cmpy_clsf_cd" type="combo" style="text-align:left; ">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>0 법인</label>
						<value>0</value>
					</item>
					<item>
						<label>9 개인</label>
						<value>9</value>
					</item>
				</choices>
			</col>
			<col class="req" ref="issu_pers_nm" type="input" caption="발행자" style="text-align:left; "/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="slip_clsf" visibility="hidden"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="subseq" visibility="hidden"/>
			<col ref="elec_note_key" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var col = datagrid1.col;
					var dataIndex	= getSelectedRecordIndex(datagrid1);
					if(col == datagrid1.colRef("bank_cd")){						
						var bank_cd = model.getValue("/root/resData/gridData1/record["+dataIndex+"]/bank_cd");
						
						var xx_job_clsf_02 = model.getValue("root/initData/xx/xx_job_clsf_02");//02
						var xx_cd_clsf_007 = model.getValue("root/initData/xx/xx_cd_clsf_007");//71
						
						if(bank_cd != ""){
							sendNoXPathSubmission("9006", bank_cd, xx_job_clsf_02, xx_cd_clsf_007);
							if(submit_completed()){
								if(model.getValue("/root/tempData/srch_nm") !== ""){
									model.setValue("/root/resData/gridData1/record["+dataIndex+"]/bank_nm", model.getValue("/root/tempData/srch_nm"));
								}					
										
								datagrid1.col = datagrid1.colRef("bank_nm");
								datagrid1.editCell();			
							}					 
						}							
					}
					else if(col == datagrid1.colRef("note_clsf_cd")){
						var dataIndex	= getSelectedRecordIndex(datagrid1);
						var note_clsf_cd=  model.getValue("/root/resData/gridData1/record["+dataIndex+"]/note_clsf_cd");

						var xx_note_clsf_cd_001 = model.getValue("/root/initData/xx/xx_note_clsf_cd_001");//1061
						var xx_note_clsf_cd_002 = model.getValue("/root/initData/xx/xx_note_clsf_cd_002");//1071
						var xx_note_clsf_cd_003 = model.getValue("/root/initData/xx/xx_note_clsf_cd_003");//1081
	
						if( note_clsf_cd == xx_note_clsf_cd_001 || note_clsf_cd == xx_note_clsf_cd_002 || note_clsf_cd == xx_note_clsf_cd_003 )
						{

							makeNodeValue("/root/reqData/fwdData/rcpm_acct"		,model.getValue("/root/resData/resForm/rcpm_acct"));		
							makeNodeValue("/root/reqData/fwdData/rcpm_acct_nm"	,model.getValue("/root/resData/resForm/rcpm_acct_nm"));
							makeNodeValue("/root/reqData/fwdData/sale_aprv_no"	,model.getValue("/root/resData/resForm/sale_aprv_no"));
							
							makeNodeValue("/root/reqData/fwdData/bank_cd"		,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/bank_cd"));
							makeNodeValue("/root/reqData/fwdData/bank_nm"		,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/bank_nm"));
							makeNodeValue("/root/reqData/fwdData/note_clsf_cd"	,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/note_clsf_cd"));
							makeNodeValue("/root/reqData/fwdData/comp_dt"		,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/comp_dt"));	
							makeNodeValue("/root/reqData/fwdData/mtry_dt"		,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/mtry_dt"));
							makeNodeValue("/root/reqData/fwdData/note_amt"		,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/note_amt"));
							makeNodeValue("/root/reqData/fwdData/issu_cmpy_clsf_cd"	,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/issu_cmpy_clsf_cd"));
							makeNodeValue("/root/reqData/fwdData/issu_pers_nm"	,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/issu_pers_nm"));
							makeNodeValue("/root/reqData/fwdData/sys_clsf"		,"A1");
							makeNodeValue("/root/reqData/fwdData/elec_note_key"	,"");
							
							window.load("/xrw/ad/co/AD_CO_1600.xrw"
										, "modal"
										, ""
										, "align:center; left:100; top:100; width:770; height:490; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
										,"/root/reqData/fwdData"
										,"/root/reqData/fwdData"
							);
							
							model.setValue("/root/resData/resForm/rcpm_acct"		, model.getValue("/root/reqData/fwdData/rcpm_acct"));
							model.setValue("/root/resData/resForm/rcpm_acct_nm"	, model.getValue("/root/reqData/fwdData/rcpm_acct_nm"));
							model.setValue("/root/resData/resForm/sale_aprv_no"	, model.getValue("/root/reqData/fwdData/sale_aprv_no"));
							model.setValue("/root/resData/gridData1/record["+dataIndex+"]/bank_cd"		, model.getValue("/root/reqData/fwdData/bank_cd"));
							model.setValue("/root/resData/gridData1/record["+dataIndex+"]/bank_nm"		, model.getValue("/root/reqData/fwdData/bank_nm"));
							model.setValue("/root/resData/gridData1/record["+dataIndex+"]/note_clsf_cd"	, model.getValue("/root/reqData/fwdData/note_clsf_cd"));
							model.setValue("/root/resData/gridData1/record["+dataIndex+"]/comp_dt"		, model.getValue("/root/reqData/fwdData/comp_dt"));
							model.setValue("/root/resData/gridData1/record["+dataIndex+"]/mtry_dt"		, model.getValue("/root/reqData/fwdData/mtry_dt"));
							model.setValue("/root/resData/gridData1/record["+dataIndex+"]/note_amt"	, model.getValue("/root/reqData/fwdData/note_amt"));
							model.setValue("/root/resData/gridData1/record["+dataIndex+"]/issu_cmpy_clsf_cd"		, model.getValue("/root/reqData/fwdData/issu_cmpy_clsf_cd"));
							model.setValue("/root/resData/gridData1/record["+dataIndex+"]/issu_pers_nm"			, model.getValue("/root/reqData/fwdData/issu_pers_nm"));
							model.setValue("/root/resData/gridData1/record["+dataIndex+"]/elec_note_key"		, model.getValue("/root/reqData/fwdData/elec_note_key"));
							
							model.refresh();
						}					
					}
					else if(col == datagrid1.colRef("note_amt")){
						var sale_dscn_amt = model.getValue("/root/resData/gridData1/record["+dataIndex+"]/sale_dscn_amt");
						if(sale_dscn_amt == ""){
							model.setValue("/root/resData/gridData1/record["+dataIndex+"]/sale_dscn_amt","0");
						}
					}
					var _amt_01	= 0;
					for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
						_amt_01	+=	Number(model.getValue("/root/resData/gridData1/record["+i+"]/note_amt"));
					}
					model.setValue("/root/resData/resForm/amt_01", _amt_01);
					sum();
					_01_changed = true;		
					
					
				]]>
			</script>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
				
				if(datagrid1.row < datagrid1.fixedRows) 	return;
				
				var col = datagrid1.col;
				if(col == datagrid1.colRef("bank_cd")){
					
					var indx = getSelectedRecordIndex(datagrid1);
					var cd   =  model.getValue("/root/resData/gridData1/record["+indx+"]/bank_cd");
					var cdnm =  model.getValue("/root/resData/gridData1/record["+indx+"]/bank_nm");	
						
					var resultRef1 = "/root/resData/gridData1/record["+indx+"]/bank_cd";
					var resultRef2 = "/root/resData/gridData1/record["+indx+"]/bank_nm";
					
					showCommonCodePopup1("02", "71", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");					

				}
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[

				if(event.keyCode == "13"){
					var col = datagrid1.col;
					if(col == datagrid1.colRef("bank_nm") || col == datagrid1.colRef("bank_cd")){
						
						var indx = getSelectedRecordIndex(datagrid1);
						var cd   =  model.getValue("/root/resData/gridData1/record["+indx+"]/bank_cd");
						var cdnm =  model.getValue("/root/resData/gridData1/record["+indx+"]/bank_nm");	
							
						var resultRef1 = "/root/resData/gridData1/record["+indx+"]/bank_cd";
						var resultRef2 = "/root/resData/gridData1/record["+indx+"]/bank_nm";
						var xx_job_clsf_02 = model.getValue("root/initData/xx/xx_job_clsf_02");//02
						var xx_cd_clsf_007 = model.getValue("root/initData/xx/xx_cd_clsf_007");//71
						
						showCommonCodePopup1(xx_job_clsf_02, xx_cd_clsf_007, cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");					
	
					}				
					if(col == datagrid1.colRef("issu_pers_nm")){
						datagrid1.addRow();
					}
				}
				]]>
			</script>
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					var dataIndex	= getSelectedRecordIndex(datagrid1);
					var note_clsf_cd=  model.getValue("/root/resData/gridData1/record["+dataIndex+"]/note_clsf_cd");

					var xx_note_clsf_cd_001 = model.getValue("/root/initData/xx/xx_note_clsf_cd_001");//1061
					var xx_note_clsf_cd_002 = model.getValue("/root/initData/xx/xx_note_clsf_cd_002");//1071
					var xx_note_clsf_cd_003 = model.getValue("/root/initData/xx/xx_note_clsf_cd_003");//1081

					if( note_clsf_cd == xx_note_clsf_cd_001 || note_clsf_cd == xx_note_clsf_cd_002 || note_clsf_cd == xx_note_clsf_cd_003 )
					{

	  					makeNodeValue("/root/reqData/fwdData/rcpm_acct"		,model.getValue("/root/resData/resForm/rcpm_acct"));		
	  					makeNodeValue("/root/reqData/fwdData/rcpm_acct_nm"	,model.getValue("/root/resData/resForm/rcpm_acct_nm"));
	  					makeNodeValue("/root/reqData/fwdData/sale_aprv_no"	,model.getValue("/root/resData/resForm/sale_aprv_no"));
	  					
	  					makeNodeValue("/root/reqData/fwdData/bank_cd"		,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/bank_cd"));
	  					makeNodeValue("/root/reqData/fwdData/bank_nm"		,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/bank_nm"));
	  					makeNodeValue("/root/reqData/fwdData/note_clsf_cd"	,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/note_clsf_cd"));
	  					makeNodeValue("/root/reqData/fwdData/comp_dt"		,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/comp_dt"));	
	  					makeNodeValue("/root/reqData/fwdData/mtry_dt"		,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/mtry_dt"));
	  					makeNodeValue("/root/reqData/fwdData/note_amt"		,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/note_amt"));
	  					makeNodeValue("/root/reqData/fwdData/issu_cmpy_clsf_cd"	,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/issu_cmpy_clsf_cd"));
	  					makeNodeValue("/root/reqData/fwdData/issu_pers_nm"	,model.getValue("/root/resData/gridData1/record["+dataIndex+"]/issu_pers_nm"));
	  					makeNodeValue("/root/reqData/fwdData/sys_clsf"		,"A1");
	  					makeNodeValue("/root/reqData/fwdData/elec_note_key"	,"");
	  					
	  					window.load("/xrw/ad/co/AD_CO_1600.xrw"
									, "modal"
									, ""
									, "align:center; left:100; top:100; width:770; height:490; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
									,"/root/reqData/fwdData"
									,"/root/reqData/fwdData"
						);
						
						model.setValue("/root/resData/resForm/rcpm_acct"		, model.getValue("/root/reqData/fwdData/rcpm_acct"));
						model.setValue("/root/resData/resForm/rcpm_acct_nm"	, model.getValue("/root/reqData/fwdData/rcpm_acct_nm"));
						model.setValue("/root/resData/resForm/sale_aprv_no"	, model.getValue("/root/reqData/fwdData/sale_aprv_no"));
						model.setValue("/root/resData/gridData1/record["+dataIndex+"]/bank_cd"		, model.getValue("/root/reqData/fwdData/bank_cd"));
						model.setValue("/root/resData/gridData1/record["+dataIndex+"]/bank_nm"		, model.getValue("/root/reqData/fwdData/bank_nm"));
						model.setValue("/root/resData/gridData1/record["+dataIndex+"]/note_clsf_cd"	, model.getValue("/root/reqData/fwdData/note_clsf_cd"));
						model.setValue("/root/resData/gridData1/record["+dataIndex+"]/comp_dt"		, model.getValue("/root/reqData/fwdData/comp_dt"));
						model.setValue("/root/resData/gridData1/record["+dataIndex+"]/mtry_dt"		, model.getValue("/root/reqData/fwdData/mtry_dt"));
						model.setValue("/root/resData/gridData1/record["+dataIndex+"]/note_amt"	, model.getValue("/root/reqData/fwdData/note_amt"));
						model.setValue("/root/resData/gridData1/record["+dataIndex+"]/issu_cmpy_clsf_cd"		, model.getValue("/root/reqData/fwdData/issu_cmpy_clsf_cd"));
						model.setValue("/root/resData/gridData1/record["+dataIndex+"]/issu_pers_nm"			, model.getValue("/root/reqData/fwdData/issu_pers_nm"));
						model.setValue("/root/resData/gridData1/record["+dataIndex+"]/elec_note_key"		, model.getValue("/root/reqData/fwdData/elec_note_key"));
						
						model.refresh();
						
						var _amt_01	= 0;
						for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
							_amt_01	+=	Number(model.getValue("/root/resData/gridData1/record["+i+"]/note_amt"));
						}
						model.setValue("/root/resData/resForm/amt_01", _amt_01);
						sum();
					}
					else	return;
				]]>
			</script>
		</datagrid>
		<caption id="caption20" class="list_cap03" style="left:10px; top:713px; width:100px; height:26px; text-align:center; ">관리담당</caption>
		<caption id="caption21" class="list_cap03" style="left:379px; top:713px; width:100px; height:26px; text-align:center; ">입금총액</caption>
		<caption id="caption22" class="list_cap03" style="left:379px; top:688px; width:100px; height:26px; text-align:center; ">광고료총액</caption>
		<input id="inp_dept_cd" ref="/root/resData/resForm/dept_cd" class="req" caption="부서" style="left:116px; top:692px; width:55px; height:18px; ">
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				
				commonSubmission("9007", inp_dept_cd.currentText, inp_dept_cd, inp_dept_nm);
				
				
				]]>
			</script>
		</input>
		<input id="inp_dept_nm" ref="/root/resData/resForm/dept_nm" class="req" imemode="hangul" inputtype="button" caption="부서" style="left:175px; top:692px; width:135px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				searchDept("setDept", "/root/resData/resForm/dept_cd", "/root/resData/resForm/dept_nm");
				]]>
			</script>
		</input>
		<input id="inp_mchrg_pers" ref="/root/resData/resForm/mchrg_pers" class="req" maxlength="10" caption="관리담당" style="left:116px; top:717px; width:55px; height:18px; ">
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				commonSubmission("9005", inp_mchrg_pers.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);
				var mchrg_pers = model.getValue("/root/resData/resForm/mchrg_pers");
				if(mchrg_pers != ""){
					findDept(mchrg_pers, inp_dept_cd, inp_dept_nm);
				}
				]]>
			</script>
		</input>
		<input id="inp_mchrg_pers_nm" ref="/root/resData/resForm/mchrg_pers_nm" class="req" imemode="hangul" inputtype="button" caption="관리담당" style="left:175px; top:717px; width:135px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				searchEmpno("setMchrgPers", "/root/resData/resForm/mchrg_pers", "/root/resData/resForm/mchrg_pers_nm");	
				var mchrg_pers = model.getValue("/root/resData/resForm/mchrg_pers");
				if(mchrg_pers != ""){
					findDept(mchrg_pers, inp_dept_cd, inp_dept_nm);
				}	
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);		
					var mchrg_pers = model.getValue("/root/resData/resForm/mchrg_pers");
					if(mchrg_pers != ""){
						findDept(mchrg_pers, inp_dept_cd, inp_dept_nm);
					}			
				}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);		
				var mchrg_pers = model.getValue("/root/resData/resForm/mchrg_pers");
				if(mchrg_pers != ""){
					findDept(mchrg_pers, inp_dept_cd, inp_dept_nm);
				}	
				]]>
			</script>
		</input>
		<output id="out_advt_tot_amt" ref="/root/resData/resForm/advt_tot_amt" format="(-)#,###" appearance="output" style="left:485px; top:692px; width:110px; height:18px; text-align:right; "/>
		<output id="out_rcpm_tot_amt" ref="/root/resData/resForm/rcpm_tot_amt" format="(-)#,###" appearance="output" style="left:485px; top:717px; width:110px; height:18px; text-align:right; "/>
		<caption id="caption19" class="list_cap03" style="left:10px; top:688px; width:100px; height:26px; text-align:center; ">부 서</caption>
		<button id="btn_setoff" class="btn03" crud="R" style="left:815px; top:40px; width:65px; height:21px; ">
			<caption>게재상계</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				var rcpm_tot_amt =  Number(model.getValue("/root/resData/resForm/rcpm_tot_amt"));
				if(rcpm_tot_amt == 0){
					alert("입금정보가 없습니다.");
					return;
				}
				
				model.removenode("/root/fwdData");
				
				model.makeNode("/root/reqData/fwdData/occr_dt");
				model.setValue("/root/reqData/fwdData/occr_dt", model.getValue("/root/resData/resForm/occr_dt"));
				
				model.makeNode("/root/reqData/fwdData/slip_clsf");
				model.setValue("/root/reqData/fwdData/slip_clsf", model.getValue("/root/resData/resForm/slip_clsf"));
				
				model.makeNode("/root/reqData/fwdData/seq");
				model.setValue("/root/reqData/fwdData/seq", model.getValue("/root/resData/resForm/seq"));

				window.load("./AD_DEP_1050.xrw"
				             ,"modal"
				             ,""
				             ,"align:center;width:950;height:728;caption:hidden;"
				             ,"/root/resData/resForm"
				             ,"/root/reqData/fwdData"
				             );				
				             
//				window.load("./AD_DEP_1001.xrw");
				]]>
			</script>
		</button>
		<button id="btnClose" class="btn02" style="left:887px; top:40px; width:50px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				if(window.type=="mdi"){
					viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
				}else{
					window.close();
				}
				
				]]>
			</script>
		</button>
		<caption id="subtitle" class="tit02" style="left:10px; top:319px; width:130px; height:20px; ">통장입금</caption>
		<caption id="caption16" class="tit02" style="left:562px; top:426px; width:130px; height:20px; ">선수금</caption>
		<caption id="caption17" class="tit02" style="left:562px; top:512px; width:130px; height:20px; ">예수금</caption>
		<caption id="caption18" class="tit02" style="left:562px; top:599px; width:130px; height:20px; ">기타입금</caption>
		<caption id="caption23" class="tit02" style="left:10px; top:512px; width:130px; height:20px; ">예수금대체</caption>
		<caption id="caption24" class="tit02" style="left:10px; top:599px; width:130px; height:20px; ">기타입금대체</caption>
		<caption id="caption25" class="tit02" style="left:10px; top:426px; width:130px; height:20px; ">선수금대체</caption>
		<caption id="caption11" class="tit02" style="left:777px; top:320px; width:130px; height:20px; ">현 금</caption>
		<caption id="caption13" class="tit02" style="left:777px; top:361px; width:130px; height:20px; ">대행료대체</caption>
		<group id="grp_slip_no" style="left:104px; top:72px; width:165px; height:25px; ">
			<input id="inp_seq" ref="/root/resData/resForm/seq" class="req" navindex="2" maxlength="4" format="9999" caption="순번" style="left:127px; top:3px; width:35px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
					var seq = model.getValue("/root/resData/resForm/seq");
					if(seq != ""){
						model.setValue("/root/resData/resForm/seq", lpad(seq, 4, "0"));
						inp_seq.refresh();	
					}
				]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keyCode == "13"){						
						var seq	=	inp_seq.currentText;						
						model.setValue("/root/resData/resForm/seq", lpad(seq, 4, "0"));
						inp_seq.refresh();
						
						if(commReqCheck("grp_slip_no")){
							loadRcpm();
						}				
					}		
					]]>
				</script>
			</input>
			<input id="inp_occr_dt" ref="/root/resData/resForm/occr_dt" class="req" navindex="1" inputtype="date" format="yyyy-mm-dd" style="left:0px; top:3px; width:90px; height:18px; text-align:center; "/>
			<caption id="caption26" style="left:115px; top:4px; width:15px; height:17px; text-align:center; ">-</caption>
			<caption id="caption27" style="left:85px; top:4px; width:15px; height:17px; text-align:center; ">-</caption>
			<input id="inp_slip_clsf" ref="/root/resData/resForm/slip_clsf" class="req" editable="false" style="left:97px; top:3px; width:20px; height:18px; "/>
		</group>
		<button id="btn_sub1" class="btn_grid02" crud="C" style="left:455px; top:427px; width:42px; height:17px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				var row = datagrid3.row;
				
				if(row < datagrid3.fixedRows)	return;
				
				for(var j=0;j<datagrid3.cols;j++){
					datagrid3.valueMatrix(row, j) = "";
				}
				datagrid3.refresh();

				var	_amt_04	=	0;
				for(var i=datagrid3.fixedRows; i<datagrid3.rows; i++){
					var amt	=	Number(datagrid3.valueMatrix(i, datagrid3.colRef("amt")));
					_amt_04	+=	amt;
				}
				model.setValue("/root/resData/resForm/amt_04", _amt_04);
				sum();		
				
				_04_changed = true;			
				
				]]>
			</script>
		</button>
		<button id="btn_sub2" class="btn_grid02" crud="C" style="left:455px; top:514px; width:42px; height:17px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				var row = datagrid4.row;
				
				if(row < datagrid4.fixedRows)	return;
				
				for(var j=0;j<datagrid4.cols;j++){
					datagrid4.valueMatrix(row, j) = "";
				}
				datagrid4.refresh();			

				var	_amt_06	=	0;
				for(var i=datagrid4.fixedRows; i<datagrid4.rows; i++){
					var amt	=	Number(datagrid4.valueMatrix(i, datagrid4.colRef("amt")));
					_amt_06	+=	amt;
				}
				model.setValue("/root/resData/resForm/amt_06", _amt_06);
				sum();		
				
				_06_changed = true;				
		
				]]>
			</script>
		</button>
		<button id="btn_sub3" class="btn_grid02" crud="C" style="left:455px; top:602px; width:42px; height:17px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				var row = datagrid5.row;
				
				if(row < datagrid5.fixedRows)	return;
				
				for(var j=0;j<datagrid5.cols;j++){
					datagrid5.valueMatrix(row, j) = "";
				}
				datagrid5.refresh();		

				var	_amt_07	=	0;
				for(var i=datagrid5.fixedRows; i<datagrid5.rows; i++){
					var amt	=	Number(datagrid5.valueMatrix(i, datagrid5.colRef("amt")));
					_amt_07	+=	amt;
				}
				model.setValue("/root/resData/resForm/amt_07", _amt_07);
				sum();	
							
				_07_changed = true;	
				
				]]>
			</script>
		</button>
		<button id="button1" class="btn_grid03" crud="C" style="left:592px; top:318px; width:54px; height:17px; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				addRow(datagrid2);
				]]>
			</script>
		</button>
		<button id="button2" class="btn_grid03" crud="C" style="left:651px; top:318px; width:54px; height:17px; ">
			<caption>행삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var row = datagrid2.row;
				
				if(row < datagrid2.fixedRows)	return;
				
				for(var j=0; j<datagrid2.cols;j++){
					datagrid2.valueMatrix(row, j) = "";
				}
				datagrid2.refresh();

				var	_amt_02	=	0;
				for(var i=datagrid2.fixedRows; i<datagrid2.rows; i++){
					var amt	=	Number(datagrid2.valueMatrix(i, datagrid2.colRef("amt")));
					_amt_02	+=	amt;
				}
				model.setValue("/root/resData/resForm/amt_02", _amt_02);
				sum();
								
				_02_changed = true;	
				
				]]>
			</script>
		</button>
		<button id="button3" class="btn_grid02" crud="C" style="left:710px; top:318px; width:44px; height:17px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[				
				cancelRow(datagrid2);
				
				]]>
			</script>
		</button>
		<button id="button4" class="btn_grid02" crud="R" style="left:410px; top:427px; width:42px; height:17px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				for(var i=datagrid3.fixedRows; i<datagrid3.rows;i++){
					datagrid3.isReadOnly(i, datagrid3.colRef("checked")) = false;
					datagrid3.isReadOnly(i, datagrid3.colRef("amt")) = false;
				}
				var dlco_no = model.getValue("/root/resData/resForm/dlco_no");
				if(dlco_no == ""){
					alert("입금처를 조회하세요.");
					return;
				}
				model.send("ad_dep_1011_l");
				]]>
			</script>
		</button>
		<button id="button5" class="btn_grid02" crud="R" style="left:410px; top:514px; width:42px; height:17px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var dlco_no = model.getValue("/root/resData/resForm/dlco_no");
					if(dlco_no == ""){
						alert("입금처를 조회하세요.");
						return;
					}
											
					model.send("ad_dep_1012_l");
				]]>
			</script>
		</button>
		<button id="button6" class="btn_grid02" crud="R" style="left:410px; top:602px; width:42px; height:17px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var dlco_no = model.getValue("/root/resData/resForm/dlco_no");
					if(dlco_no == ""){
						alert("입금처를 조회하세요.");
						return;
					}
											
					model.send("ad_dep_1013_l");
				]]>
			</script>
		</button>
		<button id="button7" class="btn_grid02" crud="C" style="left:500px; top:427px; width:42px; height:17px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					cancelRow(datagrid3);		
					
					var indx = getSelectedRecordIndex(datagrid3);
					var _amt_04	= Number(model.getValue("/root/resData/resForm/amt_04"));				
					_amt_04 += Number(model.getValue("/root/resData/gridData3/record["+indx+"]/amt"));				
					model.setValue("/root/resData/resForm/amt_04", _amt_04);				
					sum();
									
				]]>
			</script>
		</button>
		<button id="button8" class="btn_grid02" crud="C" style="left:500px; top:514px; width:42px; height:17px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					cancelRow(datagrid4);

					var indx = getSelectedRecordIndex(datagrid4);
					var _amt_06	= Number(model.getValue("/root/resData/resForm/amt_06"));				
					_amt_06 += Number(model.getValue("/root/resData/gridData4/record["+indx+"]/amt"));				
					model.setValue("/root/resData/resForm/amt_06", _amt_06);				
					sum();
									
				]]>
			</script>
		</button>
		<button id="button9" class="btn_grid02" crud="C" style="left:500px; top:602px; width:42px; height:17px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				cancelRow(datagrid5);

				var indx 	= getSelectedRecordIndex(datagrid5);
				var _amt_07 	= Number(model.getValue("/root/resData/resForm/amt_07"));				
				_amt_07 	   += Number(model.getValue("/root/resData/gridData5/record["+indx+"]/amt"));				
				model.setValue("/root/resData/resForm/amt_07", _amt_07);				
				sum();
								
				]]>
			</script>
		</button>
		<button id="button10" class="btn_grid03" crud="R" style="left:775px; top:427px; width:54px; height:17px; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				addRow(datagrid6);
				]]>
			</script>
		</button>
		<button id="button11" class="btn_grid03" crud="R" style="left:834px; top:427px; width:54px; height:17px; ">
			<caption>행삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var row = datagrid6.row;
				
				if(row < datagrid6.fixedRows)	return;
				
				for(var j=0; j<datagrid6.cols;j++){
					datagrid6.valueMatrix(row, j) = "";
				}
				datagrid6.refresh();

				var	_amt_08	=	0;
				for(var i=datagrid6.fixedRows; i<datagrid6.rows; i++){
					var amt	=	Number(datagrid6.valueMatrix(i, datagrid6.colRef("amt")));
					_amt_08	+=	amt;
				}
				model.setValue("/root/resData/resForm/amt_08", _amt_08);
				sum();	
							
				_08_changed = true;	
					
				]]>
			</script>
		</button>
		<button id="button12" class="btn_grid02" crud="R" style="left:893px; top:427px; width:44px; height:17px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[				
				cancelRow(datagrid6);
				
				]]>
			</script>
		</button>
		<button id="button13" class="btn_grid03" crud="C" style="left:775px; top:515px; width:54px; height:17px; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				addRow(datagrid7);
				]]>
			</script>
		</button>
		<button id="button14" class="btn_grid03" crud="C" style="left:834px; top:515px; width:54px; height:17px; ">
			<caption>행삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var row = datagrid7.row;
				
				if(row < datagrid7.fixedRows)	return;;
				
				for(var j=0; j<datagrid7.cols;j++){
					datagrid7.valueMatrix(row, j) = "";
				}
				datagrid7.refresh();
				
				var	_amt_09	=	0;
				for(var i=datagrid7.fixedRows; i<datagrid7.rows; i++){
					var amt	=	Number(datagrid7.valueMatrix(i, datagrid7.colRef("amt")));
					_amt_09	+=	amt;
				}
				model.setValue("/root/resData/resForm/amt_09", _amt_09);
				sum();	
				
				_09_changed = true;	
								
				]]>
			</script>
		</button>
		<button id="button15" class="btn_grid02" crud="C" style="left:893px; top:515px; width:44px; height:17px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[				
				cancelRow(datagrid7);
				
				]]>
			</script>
		</button>
		<button id="button16" class="btn_grid02" crud="C" style="left:893px; top:602px; width:44px; height:17px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[				
				cancelRow(datagrid8);
				
				]]>
			</script>
		</button>
		<button id="button17" class="btn_grid03" crud="C" style="left:775px; top:602px; width:54px; height:17px; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				addRow(datagrid8);
				]]>
			</script>
		</button>
		<button id="button18" class="btn_grid03" crud="C" style="left:834px; top:602px; width:54px; height:17px; ">
			<caption>행삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var row = datagrid8.row;
				
				if(row < datagrid8.fixedRows)	return;
				
				for(var j=0; j<datagrid8.cols;j++){
					datagrid8.valueMatrix(row, j) = "";
				}
				datagrid8.refresh();

				var	_amt_10	=	0;
				for(var i=datagrid8.fixedRows; i<datagrid8.rows; i++){
					var amt	=	Number(datagrid8.valueMatrix(i, datagrid8.colRef("amt")));
					_amt_10	+=	amt;
				}
				model.setValue("/root/resData/resForm/amt_10", _amt_10);
				sum();	
							
				_10_changed = true;	
					
				]]>
			</script>
		</button>
		<button id="button19" class="btn_grid03" crud="C" style="left:775px; top:131px; width:54px; height:17px; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				addRow(datagrid1);
				]]>
			</script>
		</button>
		<button id="button20" class="btn_grid03" crud="C" style="left:834px; top:131px; width:54px; height:17px; ">
			<caption>행삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				var row = datagrid1.row;
				
				if(row < datagrid1.fixedRows)	return;
				
				for(var j=0; j<datagrid1.cols;j++){
					datagrid1.valueMatrix(row, j) = "";
				}
				
				datagrid1.refresh();
				
				var	_amt_01	=	0;
				for(var i=datagrid1.fixedRows; i<datagrid1.rows; i++){
					var note_amt	=	Number(datagrid1.valueMatrix(i, datagrid1.colRef("note_amt")));
					_amt_01	+=	note_amt;
				}
				model.setValue("/root/resData/resForm/amt_01", _amt_01);
				sum();
				
				_01_changed = true;	
				
				]]>
			</script>
		</button>
		<button id="button21" class="btn_grid02" crud="C" style="left:893px; top:131px; width:44px; height:17px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[				
				cancelRow(datagrid1);
				
				]]>
			</script>
		</button>
		<button id="button22" style="left:272px; top:75px; width:18px; height:18px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
			<caption>+</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				var seq_clsf	= 	model.getValue("/root/resData/resForm/seq_clsf");
				var next_seq	= 	model.getValue("/root/resData/resForm/next_seq");
				
				if(seq_clsf	== "L"){
					alert("마지막 번호입니다.");
					return;
				}
				if(next_seq	==	""){
					return;
				}
				
				model.setValue("/root/resData/resForm/seq", next_seq);
				inp_seq.refresh();
				loadRcpm();
								
				
				]]>
			</script>
		</button>
		<button id="button23" style="left:292px; top:75px; width:18px; height:18px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
			<caption>-</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[


				var seq_clsf	= 	model.getValue("/root/resData/resForm/seq_clsf");
				var pre_seq	= 	model.getValue("/root/resData/resForm/pre_seq");
				
				if(seq_clsf	== "F"){
					alert("첫번째 번호입니다.");
					return;
				}
				if(pre_seq	==	""){
					return;
				}
				
				model.setValue("/root/resData/resForm/seq", pre_seq);
				inp_seq.refresh();
				loadRcpm();
				
				]]>
			</script>
		</button>
		<output id="output1" ref="/root/resData/resForm/clos_yn" visibility="hidden" style="left:415px; top:42px; width:90px; height:18px; "/>
		<caption id="caption8" class="tit02" style="left:10px; top:131px; width:130px; height:20px; ">어음</caption>
		<output id="output2" ref="/root/resData/resForm/pre_seq" visibility="hidden" style="left:250px; top:42px; width:60px; height:18px; "/>
		<output id="output3" ref="/root/resData/resForm/next_seq" visibility="hidden" style="left:320px; top:42px; width:60px; height:18px; "/>
	</xhtml:body>
</xhtml:html>
