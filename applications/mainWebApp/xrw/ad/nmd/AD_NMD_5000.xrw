<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<medi_cd>
								<item>
									<label/>
									<value/>
								</item>
							</medi_cd>
							<prof_type_cd>
								<item>
									<label/>
									<value/>
								</item>
							</prof_type_cd>
							<medi_cd2>
								<item>
									<label/>
									<value/>
								</item>
							</medi_cd2>
							<prof_type_cd2>
								<item>
									<label/>
									<value/>
								</item>
							</prof_type_cd2>
							<re_issu_resn_cd>
								<item>
									<label/>
									<value/>
								</item>
							</re_issu_resn_cd>
							<hndl_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</hndl_clsf>
							<elec_tax_comp_cd>
								<item>
									<label/>
									<value/>
								</item>
							</elec_tax_comp_cd>
							<cb_slip_clsf_cd>
								<item>
									<label/>
									<value/>
								</item>
							</cb_slip_clsf_cd>
						</comboSet>
						<pageInfo/>
						<hndl_nm/>
					</initData>
					<reqData>
						<fwdData/>
						<searchData>
							<medi_cd/>
							<srch_type/>
							<frdt/>
							<todt/>
							<dt_clsf>01</dt_clsf>
							<dlco_no/>
							<dlco_nm/>
							<agn/>
							<agn_nm/>
							<dlco_clsf_cd>2</dlco_clsf_cd>
						</searchData>
					</reqData>
					<resData>
						<resForm>
							<prof_type_cd/>
							<!--<slip_clsf_cd>16</slip_clsf_cd>2012.01.19-->
							<slip_clsf_cd/>
							<slip_occr_dt/>
							<slip_seq/>
							<setoff_yn/>
							<canc_yn/>
							<suply_ern/>
							<suply_dlco_nm/>
							<suply_presi_nm/>
							<suply_addr/>
							<suply_bizcond/>
							<suply_item/>
							<demand_ern/>
							<demand_dlco_no/>
							<demand_dlco_nm/>
							<demand_presi_nm/>
							<demand_addr/>
							<demand_bizcond/>
							<demand_item/>
							<trust_ern/>
							<trust_dlco_no/>
							<trust_dlco_nm/>
							<trust_presi_nm/>
							<trust_addr/>
							<trust_bizcond/>
							<trust_item/>
							<make_dt/>
							<suply_amt/>
							<vat_amt/>
							<tot_amt/>
							<multiUpdateData/>
							<medi_cd/>
							<hndl_clsf>2</hndl_clsf>
							<issu_tms/>
							<re_issu_resn_cd/>
							<tax_item/>
							<email_id/>
							<elec_tax_comp_cd/>
							<semuro_no/>
							<upload_yn>N</upload_yn>
							<upload_dlco_no/>
							<upload_agn_no/>
							<upload_elec_tax_comp_cd/>
							<upload_email_id/>
							<upload_semuro_no/>
							<upload_suply_amt/>
							<upload_vat_amt/>
							<upload_make_dt/>
						</resForm>
						<gridData>
							<record>
								<checked/>
								<medi_nm/>
								<pubc_dt/>
								<pubc_slip_no/>
								<dlco_no/>
								<dlco_nm/>
								<advt_fee/>
								<vat/>
								<agn_nm/>
								<agn/>
								<sale_stmt_issu_yn/>
							</record>
						</gridData>
					</resData>
					<reqData2>
						<fwdData/>
						<searchData>
							<medi_cd/>
							<srch_type/>
							<frdt/>
							<todt/>
							<dt_clsf>01</dt_clsf>
							<dlco_clsf_cd/>
							<dlco_no/>
							<dlco_nm/>
							<hndl_clsf>1</hndl_clsf>
							<chrg_pers/>
							<chrg_pers_nm/>
							<advt_clas1/>
							<advt_clas2/>
							<user_id/>
						</searchData>
					</reqData2>
					<reqData3>
						<fwdData/>
						<searchData>
							<medi_cd/>
							<srch_type/>
							<frdt/>
							<todt/>
							<dt_clsf>01</dt_clsf>
							<dlco_no/>
							<dlco_nm/>
							<agn/>
							<agn_nm/>
							<hndl_clsf>4</hndl_clsf>
							<advt_clas1/>
							<advt_clas2/>
						</searchData>
					</reqData3>
					<resData2>
						<resForm>
							<prof_type_cd/>
							<!--<slip_clsf_cd>16</slip_clsf_cd>2012.01.19-->
							<slip_clsf_cd/>
							<slip_occr_dt/>
							<slip_seq/>
							<re_issu_resn_cd/>
							<issu_tms/>
							<canc_yn/>
							<suply_ern/>
							<suply_dlco_nm/>
							<suply_presi_nm/>
							<suply_addr/>
							<suply_bizcond/>
							<suply_item/>
							<demand_ern/>
							<demand_dlco_no/>
							<demand_dlco_nm/>
							<demand_presi_nm/>
							<demand_addr/>
							<demand_bizcond/>
							<demand_item/>
							<make_dt/>
							<!--<tax_item>조선일보광고료</tax_item>2012.01.19-->
							<tax_item/>
							<suply_amt/>
							<vat_amt/>
							<tot_amt/>
							<multiUpdateData/>
							<medi_cd/>
							<hndl_clsf>1</hndl_clsf>
							<dlco_clsf_cd/>
							<email_id/>
							<elec_tax_comp_cd/>
							<semuro_no/>
							<demand_biz_plc/>
							<remk/>
							<make_dt2/>
						</resForm>
						<gridData>
							<record>
								<checked/>
								<medi_nm/>
								<pubc_dt/>
								<pubc_slip_no/>
								<dlco_no/>
								<dlco_nm/>
								<advt_fee/>
								<vat/>
								<sale_stmt_issu_yn/>
							</record>
						</gridData>
					</resData2>
					<resData3>
						<resForm>
							<prof_type_cd/>
							<slip_clsf_cd/>
							<slip_occr_dt/>
							<slip_seq/>
							<re_issu_resn_cd/>
							<issu_tms/>
							<canc_yn/>
							<suply_ern/>
							<suply_dlco_nm/>
							<suply_presi_nm/>
							<suply_addr/>
							<suply_bizcond/>
							<suply_item/>
							<demand_ern/>
							<demand_dlco_no/>
							<demand_dlco_nm/>
							<demand_presi_nm/>
							<demand_addr/>
							<demand_bizcond/>
							<demand_item/>
							<trust_ern/>
							<trust_dlco_no/>
							<trust_dlco_nm/>
							<trust_presi_nm/>
							<trust_addr/>
							<trust_bizcond/>
							<trust_item/>
							<make_dt/>
							<!--<tax_item>조선일보광고료</tax_item>2012.01.19-->
							<tax_item/>
							<suply_amt/>
							<vat_amt/>
							<tot_amt/>
							<multiUpdateData/>
							<medi_cd/>
							<hndl_clsf>4</hndl_clsf>
							<dlco_clsf_cd/>
							<email_id/>
							<elec_tax_comp_cd/>
							<semuro_no/>
						</resForm>
						<gridData>
							<record>
								<checked/>
								<medi_nm/>
								<pubc_dt/>
								<pubc_slip_no/>
								<dlco_no/>
								<dlco_nm/>
								<advt_fee/>
								<vat/>
								<agn_nm/>
								<agn/>
								<sale_stmt_issu_yn/>
							</record>
						</gridData>
					</resData3>
					<tempData>
						<keyData/>
					</tempData>
					<msgData/>
					<tmp_semuro_no/>
				</root>
			</instance>
			<submission id="ad_nmd_5000_m" action="/ad/nmd/5000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					model.send("ad_nmd_5000_m");
					
					model.copyNode("/root/initData/comboSet/medi_cd", "/root/tempData/medi_cd");
					model.copyNode("/root/initData/comboSet/prof_type_cd", "/root/tempData/prof_type_cd");
					model.copyNode("/root/initData/comboSet/medi_cd2", "/root/tempData/medi_cd");
					model.copyNode("/root/initData/comboSet/prof_type_cd2", "/root/tempData/prof_type_cd");
					model.copyNode("/root/initData/comboSet/re_issu_resn_cd", "/root/tempData/re_issu_resn_cd");
					model.copyNode("/root/initData/comboSet/hndl_clsf", "/root/tempData/hndl_clsf");
					model.copyNode("/root/initData/comboSet/elec_tax_comp_cd",	"/root/tempData/elec_tax_comp_cd");
					model.copyNode("/root/initData/comboSet/cb_slip_clsf_cd",	"/root/tempData/cb_slip_clsf_cd"); //2012.01.19
					//20120216 김상훈 품목체크
					var tax_item = model.getValue("/root/tampData/xx_tax_item");
					if(tax_item == ""){
						tax_item = "디지털초판판매료";
					}
					model.setValue("/root/resData2/resForm/tax_item",  tax_item); //2012.01.20
					model.setValue("/root/resData3/resForm/tax_item",  tax_item); //2012.01.20
					
					
					makeComboGubun("", "/root/initData/comboSet/re_issu_resn_cd", "item", "label", "value");
					makeComboGubun("", "/root/initData/comboSet/elec_tax_comp_cd", "item", "label", "value");
					
					model.setValue("/root/resData/resForm/suply_ern", model.getValue("/root/tempData/ern"));
					model.setValue("/root/resData/resForm/suply_dlco_nm", model.getValue("/root/tempData/dlco_nm"));
					model.setValue("/root/resData/resForm/suply_presi_nm", model.getValue("/root/tempData/presi_nm"));
					model.setValue("/root/resData/resForm/suply_addr", model.getValue("/root/tempData/addr"));
					model.setValue("/root/resData/resForm/suply_bizcond", model.getValue("/root/tempData/bizcond"));
					model.setValue("/root/resData/resForm/suply_item", model.getValue("/root/tempData/item"));
					
					model.setValue("/root/resData2/resForm/suply_ern", model.getValue("/root/tempData/ern"));
					model.setValue("/root/resData2/resForm/suply_dlco_nm", model.getValue("/root/tempData/dlco_nm"));
					model.setValue("/root/resData2/resForm/suply_presi_nm", model.getValue("/root/tempData/presi_nm"));
					model.setValue("/root/resData2/resForm/suply_addr", model.getValue("/root/tempData/addr"));
					model.setValue("/root/resData2/resForm/suply_bizcond", model.getValue("/root/tempData/bizcond"));
					model.setValue("/root/resData2/resForm/suply_item", model.getValue("/root/tempData/item"));
					
					
					model.setValue("/root/resData3/resForm/suply_ern", model.getValue("/root/tempData/ern"));
					model.setValue("/root/resData3/resForm/suply_dlco_nm", model.getValue("/root/tempData/dlco_nm"));
					model.setValue("/root/resData3/resForm/suply_presi_nm", model.getValue("/root/tempData/presi_nm"));
					model.setValue("/root/resData3/resForm/suply_addr", model.getValue("/root/tempData/addr"));
					model.setValue("/root/resData3/resForm/suply_bizcond", model.getValue("/root/tempData/bizcond"));
					model.setValue("/root/resData3/resForm/suply_item", model.getValue("/root/tempData/item"));
					
					
					model.removeNodeset("/root/resData/gridData/record");
					model.removeNodeset("/root/resData2/gridData/record");
					model.removeNodeset("/root/resData3/gridData/record");
					
					datagrid1.fixedcellcheckbox(0, datagrid1.colRef("checked"), false) = true;	
					datagrid2.fixedcellcheckbox(0, datagrid2.colRef("checked"), false) = true;	
					datagrid3.fixedcellcheckbox(0, datagrid3.colRef("checked"), false) = true;	
	
					model.refresh();
					
					initPage(); 

					//위수탁세금계산서 업로드 화면전환
					var tax_key_elec_tax_comp_cd		= model.property(KEY_ELEC_TAX_COMP_CD);
					var tax_key_approve_id			= model.property(KEY_APPROVE_ID);
					var tax_key_email				= model.property(KEY_EMAIL);
					var tax_key_dlco_no				= model.property(KEY_DLCO_NO);
					var tax_key_agn_no				= model.property(KEY_AGN);
					var tax_key_suply_amt			= model.property(KEY_SUPLY_AMT);
					var tax_key_vat_amt				= model.property(KEY_VAT_AMT);
					var tax_key_make_dt				= model.property(KEY_MAKE_DT);
//					alert(tax_key_elec_tax_comp_cd);
					if( tax_key_elec_tax_comp_cd != "" )
					{
						model.setValue("/root/reqData/searchData/dlco_no"			, tax_key_dlco_no);
						model.setValue("/root/reqData/searchData/agn"			, tax_key_agn_no);
						model.refresh();

						//광고주명 조회
						commonSubmission("9004", tax_key_dlco_no, inp_dlco_no, inp_dlco_nm);
						setDemandInfo(tax_key_dlco_no);
						
						//대행사명 조회
						setTrustInfo();
						
						//게재조회
						loadPubc();
						
						//전자세금계산서업체
						model.setValue("/root/resData/resForm/elec_tax_comp_cd"	, tax_key_elec_tax_comp_cd);
						model.setValue("/root/resData/resForm/email_id"			, tax_key_email);
						model.setValue("/root/resData/resForm/semuro_no"			, tax_key_approve_id);
						model.setValue("/root/resData/resForm/make_dt"			, tax_key_make_dt);
//						cmb_elec_tax_comp_cd.value = tax_key_elec_tax_comp_cd;
						model.setValue("/root/resData/resForm/upload_yn"			, "Y");
						model.setValue("/root/resData/resForm/upload_dlco_no"		, tax_key_dlco_no);
						model.setValue("/root/resData/resForm/upload_agn_no"		, tax_key_agn_no);
						model.setValue("/root/resData/resForm/upload_elec_tax_comp_cd"		, tax_key_elec_tax_comp_cd);
						model.setValue("/root/resData/resForm/upload_email_id"		, tax_key_email);
						model.setValue("/root/resData/resForm/upload_semuro_no"	, tax_key_approve_id);
						model.setValue("/root/resData/resForm/upload_make_dt"		, tax_key_make_dt);
						model.setValue("/root/resData/resForm/upload_suply_amt"	, tax_key_suply_amt);
						model.setValue("/root/resData/resForm/upload_vat_amt"		, tax_key_vat_amt);
												
						model.property(KEY_ELEC_TAX_COMP_CD)	= "";
						model.property(KEY_APPROVE_ID)			= "";
						model.property(KEY_EMAIL)				= "";
						model.property(KEY_DLCO_NO)			= "";
						model.property(KEY_AGN)				= "";
						model.property(KEY_SUPLY_AMT)			= "";
						model.property(KEY_VAT_AMT)			= "";
						model.property(KEY_MAKE_DT)			= "";
					}
					else
					{
						//model.setValue("/root/resData/resForm/upload_yn"			, "N");
					}
					
					model.refresh();
				]]>
			</script>
			<submission id="ad_nmd_5010_l" action="/ad/nmd/5010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData"/>
			<submission id="ad_nmd_5011_s" action="/ad/nmd/5011" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="ad_nmd_5012_s" action="/ad/nmd/5012" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="ad_nmd_5020_a" action="/ad/nmd/5020" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/msgData"/>
			<submission id="ad_nmd_5021_a" action="/ad/nmd/5021" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/msgData"/>
			<submission id="ad_nmd_5022_a" action="/ad/nmd/5022" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/msgData"/>
			<submission id="ad_nmd_5023_a" action="/ad/nmd/5023" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/msgData"/>
			<submission id="ad_nmd_5030_s" action="/ad/nmd/5030" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/resData"/>
			<submission id="ad_nmd_5040_a" action="/ad/nmd/5040" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData2/resForm" resultref="/root/msgData"/>
			<submission id="ad_nmd_5041_a" action="/ad/nmd/5041" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData2/resForm" resultref="/root/msgData"/>
			<submission id="ad_nmd_5070_a" action="/ad/nmd/5070" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData3/resForm" resultref="/root/msgData"/>
			<submission id="ad_nmd_5071_a" action="/ad/nmd/5071" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData3/resForm" resultref="/root/msgData"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
						
			var	_bgcolor	= "#FFFF99";
			
			function initPage(){				

				cb_medi_cd.select(0);
				cb_medi_cd2.select(0);
				cb_medi_cd3.select(0);

				cb_prof_type_cd.select(0);
				cb_prof_type_cd2.select(0);
				cb_prof_type_cd3.select(0);

				cb_slip_clsf_cd.select(0);
				cb_slip_clsf_cd2.select(0);
				cb_slip_clsf_cd3.select(0);

				cb_dlco_clsf_cd.select(0);
				
				var cur_date	=	getCurrentDate();
				
				var frdt =  	dateAdd("m", -1, getCurrentMonth() +"01");
				var yymm = 	frdt.substring(0,6);
				var todt = 	yymm	 + commLastDay(yymm); 	//전월의 말일 

				
				model.setValue("/root/reqData/searchData/frdt", frdt);	
				model.setValue("/root/reqData/searchData/todt", todt);	
				
				
				var frdt =  	getCurrentMonth() +"01";
				var todt = 	cur_date; 	
				
				model.setValue("/root/reqData2/searchData/frdt", frdt);	
				model.setValue("/root/reqData2/searchData/todt", todt);					
				
				inp_frdt.refresh();					
				inp_todt.refresh();
				
				cb_dt_clsf1.value	 = "03";//전월
				
				inp_frdt2.refresh();					
				inp_todt2.refresh();
				
				cb_dt_clsf2.value	 = "02"; //당월
				
				var frdt =  	getCurrentMonth() +"01";
				var todt = 	cur_date; 	
				
				model.setValue("/root/reqData3/searchData/frdt", frdt);	
				model.setValue("/root/reqData3/searchData/todt", todt);	
				
				inp_frdt3.refresh();					
				inp_todt3.refresh();
				
				cb_dt_clsf3.value	 = "02";//당월
				//(-)세금계산서 작성일자 
				inp_make_dt21.visible = false;
				cap_make_dt21.visible = false;								

				if(!check_pop_mode()){
				//alert("check_pop_mode=true");
					model.setValue("/root/resData/resForm/slip_occr_dt", cur_date);
					inp_slip_occr_dt.refresh();
					
					model.setValue("/root/resData2/resForm/slip_occr_dt", cur_date);
					inp_slip_occr_dt2.refresh();
					
					model.setValue("/root/resData3/resForm/slip_occr_dt", cur_date);
					inp_slip_occr_dt3.refresh();
					
					var	make_dt	=	cur_date.substring(0,6) + "" + commLastDay(cur_date);
					
					model.setValue("/root/resData/resForm/make_dt",make_dt);
					inp_make_dt.refresh();
					
					var	make_dt2	=	cur_date.substring(0,6) + "" + commLastDay(cur_date);
					model.setValue("/root/resData2/resForm/make_dt",make_dt2);
					inp_make_dt2.refresh();					
					
					var	make_dt3	=	cur_date.substring(0,6) + "" + commLastDay(cur_date);
					model.setValue("/root/resData3/resForm/make_dt",make_dt3);
					inp_make_dt3.refresh();					
					
					setMode(INSERT_MODE);
					
					model.toggle("case2");
				}
				else
				{//alert("check_pop_mode=false");
					model.setValue("/root/resData2/resForm/slip_occr_dt", cur_date);
					inp_slip_occr_dt2.refresh();
					
					var	make_dt2	=	cur_date.substring(0,6) + "" + commLastDay(cur_date);
					model.setValue("/root/resData2/resForm/make_dt",make_dt2);
					inp_make_dt2.refresh();		
					
					setMode(INSERT_MODE);
					
					model.toggle("case2");					
				}
				
			}
			
			function check_pop_mode(){
				var prof_type_cd = model.property(KEY_PROF_TYPE_CD);
				var slip_clsf_cd = model.property(KEY_SLIP_CLSF_CD);
				var slip_occr_dt = model.property(KEY_SLIP_OCCR_DT);
				var slip_seq     = model.property(KEY_SLIP_SEQ);
				var dlco_clsf_cd = model.property(KEY_DLCO_CLSF_CD);	

				if(slip_clsf_cd != "" && slip_occr_dt != "" && slip_seq != ""){
					
					btn_case1.selected = false;
					btn_case2.selected = false;
					
					//if(dlco_clsf_cd == "16" || dlco_clsf_cd == "19" ){ //위수탁 ,광고지사발행분	//2012.01.18				
					var orgStr = model.getValue("/root/tempData/xx_dlco_clsf_cd");
					if(instr_yn(orgStr, dlco_clsf_cd)){
						model.setValue("/root/resData/resForm/prof_type_cd", prof_type_cd);
						model.setValue("/root/resData/resForm/slip_clsf_cd", slip_clsf_cd);
						model.setValue("/root/resData/resForm/slip_occr_dt", slip_occr_dt);
						model.setValue("/root/resData/resForm/slip_seq",     slip_seq);
						
						cb_prof_type_cd.refresh();
						cb_slip_clsf_cd.refresh();
						inp_slip_occr_dt.refresh();
						inp_slip_seq.refresh();
						
						model.toggle("case2");
						
						btn_case1.selected = true;
						
					
					}
					else  {//직거래
						model.setValue("/root/resData2/resForm/prof_type_cd", prof_type_cd);
						model.setValue("/root/resData2/resForm/slip_clsf_cd", slip_clsf_cd);
						model.setValue("/root/resData2/resForm/slip_occr_dt", slip_occr_dt);
						model.setValue("/root/resData2/resForm/slip_seq",     slip_seq);
						
						model.toggle("case2");
						
						cb_prof_type_cd2.refresh();
						cb_slip_clsf_cd2.refresh();
						inp_slip_occr_dt2.refresh();
						inp_slip_seq2.refresh();
						
						btn_case2.selected = true;
					}
					
					setMode(UPDATE_MODE);
					
					loadData();
					
					model.property(KEY_PROF_TYPE_CD)  = "";
					model.property(KEY_SLIP_CLSF_CD)  = "";
					model.property(KEY_SLIP_OCCR_DT)  = "";	
					model.property(KEY_SLIP_SEQ)      = "";	
					model.property(KEY_DLCO_CLSF_CD)  = "";						
					
					return true;
				}
				
				return false;
			}

			function setDlcoInfo(dlco_no, dlco_nm){
				
				var gnr_advcs_yn = model.getValue("/root/reqData/fwdData/gnr_advcs_yn");
				var agn_yn       = model.getValue("/root/reqData/fwdData/agn_yn");
				var advt_bo_yn   = model.getValue("/root/reqData/fwdData/advt_bo_yn");
				
				if(gnr_advcs_yn == "Y"){			
					if(switch1.selectedIndex == 0){	
						model.setValue("/root/reqData/searchData/dlco_no", dlco_no);
						model.setValue("/root/reqData/searchData/dlco_nm", dlco_nm);
						inp_dlco_no.refresh();
						inp_dlco_nm.refresh();
			//			setDemandInfo();	
					}else if(switch1.selectedIndex == 1){					
						model.setValue("/root/reqData2/searchData/dlco_no", dlco_no);
						model.setValue("/root/reqData2/searchData/dlco_nm", dlco_nm);
						inp_dlco_no2.refresh();
						inp_dlco_nm2.refresh();
						setDemandInfo2();							
					}else if(switch1.selectedIndex == 2){					
						model.setValue("/root/reqData3/searchData/dlco_no", dlco_no);
						model.setValue("/root/reqData3/searchData/dlco_nm", dlco_nm);
						inp_dlco_no3.refresh();
						inp_dlco_nm3.refresh();				
					}	
						
				} else if(agn_yn == "Y" || advt_bo_yn == "Y"){		
					
					if(switch1.selectedIndex == 0){																		
						model.setValue("/root/reqData/searchData/agn", dlco_no);
						model.setValue("/root/reqData/searchData/agn_nm", dlco_nm);	
						
						inp_agn.refresh();
						inp_agn_nm.refresh();
					
						setTrustInfo();
					}else if(switch1.selectedIndex == 2){																		
						model.setValue("/root/reqData3/searchData/agn", dlco_no);
						model.setValue("/root/reqData3/searchData/agn_nm", dlco_nm);	
						
						inp_hndl_plac_cd.refresh();
						inp_hndl_plac_nm.refresh();
					
						setBoTrustInfo();
					}
				}			
			}		
			
			function clearDemandInfo()
			{			
				model.setValue("/root/resData/resForm/demand_ern", "");
				model.setValue("/root/resData/resForm/demand_dlco_no", "");
				model.setValue("/root/resData/resForm/demand_dlco_nm", "");
				model.setValue("/root/resData/resForm/demand_presi_nm", "");
				model.setValue("/root/resData/resForm/demand_addr", "");
				model.setValue("/root/resData/resForm/demand_bizcond", "");
				model.setValue("/root/resData/resForm/demand_item", "");	
				model.setValue("/root/reqData/searchData/dlco_nm", "");
				
				model.setValue("/root/resData/resForm/elec_tax_comp_cd", "");	
				model.setValue("/root/resData/resForm/email_id", "");	
				
				model.refresh();
			}
			function clearDemandInfo2()
			{			
				model.setValue("/root/resData2/resForm/demand_ern", "");
				model.setValue("/root/resData2/resForm/demand_dlco_no", "");
				model.setValue("/root/resData2/resForm/demand_dlco_nm", "");
				model.setValue("/root/resData2/resForm/demand_presi_nm", "");
				model.setValue("/root/resData2/resForm/demand_addr", "");
				model.setValue("/root/resData2/resForm/demand_bizcond", "");
				model.setValue("/root/resData2/resForm/demand_item", "");	
				model.setValue("/root/reqData2/searchData/dlco_nm", "");
				
				model.setValue("/root/resData2/resForm/elec_tax_comp_cd", "");	
				model.setValue("/root/resData2/resForm/email_id", "");	
				model.setValue("/root/resData/resForm/elec_tax_comp_cd", "");	
				model.setValue("/root/resData/resForm/email_id", "");	
				
				model.refresh();
			}
			function clearDemandInfo3()
			{			
				model.setValue("/root/resData3/resForm/demand_ern", "");
				model.setValue("/root/resData3/resForm/demand_dlco_no", "");
				model.setValue("/root/resData3/resForm/demand_dlco_nm", "");
				model.setValue("/root/resData3/resForm/demand_presi_nm", "");
				model.setValue("/root/resData3/resForm/demand_addr", "");
				model.setValue("/root/resData3/resForm/demand_bizcond", "");
				model.setValue("/root/resData3/resForm/demand_item", "");	
				model.setValue("/root/reqData3/searchData/dlco_nm", "");
				
				model.setValue("/root/resData3/resForm/elec_tax_comp_cd", "");	
				model.setValue("/root/resData3/resForm/email_id", "");	
				model.setValue("/root/resData/resForm/elec_tax_comp_cd", "");	
				model.setValue("/root/resData/resForm/email_id", "");	
				
				model.refresh();
			}
			
			function setDemandInfo(dlco_no)
			{
				if( dlco_no == "" )
				{
					clearDemandInfo();
					return;
				}

				var demand_dlco_no = model.getValue("/root/resData/resForm/demand_dlco_no");
				if( demand_dlco_no != "" && demand_dlco_no == dlco_no )		return;
					
				makeNodeValue("/root/tempData2/dlco_no", lpad(dlco_no, 8, "0"));
					
				modelSendNoMake("ad_nmd_5011_s", "/ad/nmd/5011", "/root/tempData2", "/root/tempData");
				
				if( submit_completed() )
				{	
					model.setValue("/root/resData/resForm/demand_ern"		, model.getValue("/root/tempData/ern"));
					model.setValue("/root/resData/resForm/demand_dlco_no"	, model.getValue("/root/tempData/dlco_no"));
					model.setValue("/root/resData/resForm/demand_dlco_nm"	, model.getValue("/root/tempData/dlco_nm"));
					model.setValue("/root/resData/resForm/demand_presi_nm"	, model.getValue("/root/tempData/presi_nm"));
					model.setValue("/root/resData/resForm/demand_addr"		, model.getValue("/root/tempData/addr"));
					model.setValue("/root/resData/resForm/demand_bizcond"	, model.getValue("/root/tempData/bizcond"));
					model.setValue("/root/resData/resForm/demand_item"		, model.getValue("/root/tempData/item"));	
//					model.setValue("/root/reqData/searchData/dlco_nm", model.getValue("/root/tempData/dlco_nm"));
					model.setValue("/root/resData/resForm/elec_tax_comp_cd"	, model.getValue("/root/tempData/elec_tax_comp_cd"));	
					model.setValue("/root/resData/resForm/email_id"			, model.getValue("/root/tempData/email_id"));	
					
					model.refresh();							
				}
				else
				{
					clearDemandInfo();
				}
			}
			function setDemandInfo3(dlco_no)
			{
				if( dlco_no == "" )
				{
					clearDemandInfo3();
					return;
				}

				var	demand_dlco_no = model.getValue("/root/resData3/resForm/demand_dlco_no");
				if(demand_dlco_no != "" && demand_dlco_no == dlco_no)		return;
					
				makeNodeValue("/root/tempData2/dlco_no", lpad(dlco_no, 8, "0"));
					
				modelSendNoMake("ad_nmd_5011_s", "/ad/nmd/5011", "/root/tempData2", "/root/tempData");
				
				if( submit_completed() )
				{
					model.setValue("/root/resData3/resForm/demand_ern", model.getValue("/root/tempData/ern"));
					model.setValue("/root/resData3/resForm/demand_dlco_no", model.getValue("/root/tempData/dlco_no"));
					model.setValue("/root/resData3/resForm/demand_dlco_nm", model.getValue("/root/tempData/dlco_nm"));
					model.setValue("/root/resData3/resForm/demand_presi_nm", model.getValue("/root/tempData/presi_nm"));
					model.setValue("/root/resData3/resForm/demand_addr", model.getValue("/root/tempData/addr"));
					model.setValue("/root/resData3/resForm/demand_bizcond", model.getValue("/root/tempData/bizcond"));
					model.setValue("/root/resData3/resForm/demand_item", model.getValue("/root/tempData/item"));	
//					model.setValue("/root/reqData/searchData/dlco_nm", model.getValue("/root/tempData/dlco_nm"));
					model.setValue("/root/resData3/resForm/elec_tax_comp_cd"	, model.getValue("/root/tempData/elec_tax_comp_cd"));	
					model.setValue("/root/resData3/resForm/email_id"			, model.getValue("/root/tempData/email_id"));	
					model.setValue("/root/resData/resForm/elec_tax_comp_cd"	, model.getValue("/root/tempData/elec_tax_comp_cd"));	
					model.setValue("/root/resData/resForm/email_id"			, model.getValue("/root/tempData/email_id"));	
					
					model.refresh();							
				}
				else
				{
					clearDemandInfo3();
				}	
			}
			
			function setDemandInfo2()
			{	
				var dlco_no = inp_dlco_no2.currentText;
				
				if( dlco_no == "" )
				{
					clearDemandInfo2();
					return;
				}
				
				var	demand_dlco_no = model.getValue("/root/resData2/resForm/demand_dlco_no");
				if(demand_dlco_no != "" && demand_dlco_no == dlco_no)		return;
				
				model.setValue("/root/reqData2/searchData/dlco_no", lpad(dlco_no, 8, "0"));
					
				modelSendNoMake("ad_nmd_5011_s", "/ad/nmd/5011", "/root/reqData2/searchData", "/root/tempData");
				
				if( submit_completed() )
				{
					model.setValue("/root/resData2/resForm/demand_ern", model.getValue("/root/tempData/ern"));
					model.setValue("/root/resData2/resForm/demand_dlco_no", model.getValue("/root/tempData/dlco_no"));
					model.setValue("/root/resData2/resForm/demand_dlco_nm", model.getValue("/root/tempData/dlco_nm"));
					model.setValue("/root/resData2/resForm/demand_presi_nm", model.getValue("/root/tempData/presi_nm"));
					model.setValue("/root/resData2/resForm/demand_addr", model.getValue("/root/tempData/addr"));
					model.setValue("/root/resData2/resForm/demand_bizcond", model.getValue("/root/tempData/bizcond"));
					model.setValue("/root/resData2/resForm/demand_item", model.getValue("/root/tempData/item"));	
					model.setValue("/root/reqData2/searchData/dlco_nm", model.getValue("/root/tempData/dlco_nm"));

					model.setValue("/root/resData2/resForm/elec_tax_comp_cd"	, model.getValue("/root/tempData/elec_tax_comp_cd"));	
					model.setValue("/root/resData2/resForm/email_id"			, model.getValue("/root/tempData/email_id"));	
					model.setValue("/root/resData/resForm/elec_tax_comp_cd"	, model.getValue("/root/tempData/elec_tax_comp_cd"));	
					model.setValue("/root/resData/resForm/email_id"			, model.getValue("/root/tempData/email_id"));	
					
					model.refresh();							
				}
				else
				{
					clearDemandInfo2();
				}
			}
			function setDemandInfo3()
			{	
				var dlco_no = inp_dlco_no3.currentText;
				if( dlco_no == "" )
				{
					clearDemandInfo3();
					return;
				}
				
				var	demand_dlco_no = model.getValue("/root/resData3/resForm/demand_dlco_no");
				if(demand_dlco_no != "" && demand_dlco_no == dlco_no)		return;
				
				model.setValue("/root/reqData3/searchData/dlco_no", lpad(dlco_no, 8, "0"));
					
				modelSendNoMake("ad_nmd_5011_s", "/ad/nmd/5011", "/root/reqData3/searchData", "/root/tempData");
				
				if( submit_completed() )
				{
					model.setValue("/root/resData3/resForm/demand_ern", model.getValue("/root/tempData/ern"));
					model.setValue("/root/resData3/resForm/demand_dlco_no", model.getValue("/root/tempData/dlco_no"));
					model.setValue("/root/resData3/resForm/demand_dlco_nm", model.getValue("/root/tempData/dlco_nm"));
					model.setValue("/root/resData3/resForm/demand_presi_nm", model.getValue("/root/tempData/presi_nm"));
					model.setValue("/root/resData3/resForm/demand_addr", model.getValue("/root/tempData/addr"));
					model.setValue("/root/resData3/resForm/demand_bizcond", model.getValue("/root/tempData/bizcond"));
					model.setValue("/root/resData3/resForm/demand_item", model.getValue("/root/tempData/item"));	
					model.setValue("/root/reqData3/searchData/dlco_nm", model.getValue("/root/tempData/dlco_nm"));
					
					model.setValue("/root/resData3/resForm/elec_tax_comp_cd"	, model.getValue("/root/tempData/elec_tax_comp_cd"));	
					model.setValue("/root/resData3/resForm/email_id"			, model.getValue("/root/tempData/email_id"));	
					model.setValue("/root/resData/resForm/elec_tax_comp_cd"	, model.getValue("/root/tempData/elec_tax_comp_cd"));	
					model.setValue("/root/resData/resForm/email_id"			, model.getValue("/root/tempData/email_id"));	
					
					model.refresh();							
				}
				else
				{
					clearDemandInfo3();
				}
			}		
			
									
			function clearTrustInfo(){

				model.setValue("/root/resData/resForm/trust_ern",  "");
				model.setValue("/root/resData/resForm/trust_dlco_no", "");
				model.setValue("/root/resData/resForm/trust_dlco_nm", "");
				model.setValue("/root/resData/resForm/trust_presi_nm", "");
				model.setValue("/root/resData/resForm/trust_addr", "");
				model.setValue("/root/resData/resForm/trust_bizcond", "");
				model.setValue("/root/resData/resForm/trust_item", "");	
				model.setValue("/root/reqData/searchData/agn_nm", "");
				
				model.refresh();											
			}
			function clearBoTrustInfo(){

				model.setValue("/root/resData3/resForm/trust_ern",  "");
				model.setValue("/root/resData3/resForm/trust_dlco_no", "");
				model.setValue("/root/resData3/resForm/trust_dlco_nm", "");
				model.setValue("/root/resData3/resForm/trust_presi_nm", "");
				model.setValue("/root/resData3/resForm/trust_addr", "");
				model.setValue("/root/resData3/resForm/trust_bizcond", "");
				model.setValue("/root/resData3/resForm/trust_item", "");	
				model.setValue("/root/reqData3/searchData/agn_nm", "");
				
				model.refresh();											
			}
			
			function setTrustInfo(){
				
				var agn = inp_agn.currentText;
				if(agn == ""){
					clearTrustInfo();
					return;
				}

				var	trust_dlco_no = model.getValue("/root/resData/resForm/trust_dlco_no");
				if(trust_dlco_no != "" && trust_dlco_no == agn)		return;
				
				model.setValue("/root/reqData/searchData/agn", lpad(agn, 8, "0"));
				inp_agn.refresh();
				
				model.send("ad_nmd_5012_s");
				if(submit_completed()){	
					model.setValue("/root/resData/resForm/trust_ern", model.getValue("/root/tempData/ern"));
					model.setValue("/root/resData/resForm/trust_dlco_no", model.getValue("/root/tempData/dlco_no"));
					model.setValue("/root/resData/resForm/trust_dlco_nm", model.getValue("/root/tempData/dlco_nm"));
					model.setValue("/root/resData/resForm/trust_presi_nm", model.getValue("/root/tempData/presi_nm"));
					model.setValue("/root/resData/resForm/trust_addr", model.getValue("/root/tempData/addr"));
					model.setValue("/root/resData/resForm/trust_bizcond", model.getValue("/root/tempData/bizcond"));
					model.setValue("/root/resData/resForm/trust_item", model.getValue("/root/tempData/item"));	
					model.setValue("/root/reqData/searchData/agn_nm", model.getValue("/root/tempData/dlco_nm"));	
					
					model.refresh();							
				}				
			}
			function setTrustInfo2(agn){
				
				var trust_dlco_no = model.getValue("/root/resData/resForm/trust_dlco_no");
				if(trust_dlco_no != "" && trust_dlco_no == agn)		return;
				
				model.setValue("/root/reqData/searchData/agn", agn);
				inp_agn.refresh();
				
				model.send("ad_nmd_5012_s");
				if(submit_completed()){	
					model.setValue("/root/resData/resForm/trust_ern", model.getValue("/root/tempData/ern"));
					model.setValue("/root/resData/resForm/trust_dlco_no", model.getValue("/root/tempData/dlco_no"));
					model.setValue("/root/resData/resForm/trust_dlco_nm", model.getValue("/root/tempData/dlco_nm"));
					model.setValue("/root/resData/resForm/trust_presi_nm", model.getValue("/root/tempData/presi_nm"));
					model.setValue("/root/resData/resForm/trust_addr", model.getValue("/root/tempData/addr"));
					model.setValue("/root/resData/resForm/trust_bizcond", model.getValue("/root/tempData/bizcond"));
					model.setValue("/root/resData/resForm/trust_item", model.getValue("/root/tempData/item"));	
					model.setValue("/root/reqData/searchData/agn_nm", model.getValue("/root/tempData/dlco_nm"));
					
					model.refresh();							
				}				
			}

			function setBoTrustInfo(){
				
				var hndl_plac_cd = inp_hndl_plac_cd.currentText;
				
				if(hndl_plac_cd == ""){
					clearBoTrustInfo();
					return;
				}

				var	trust_dlco_no = model.getValue("/root/resData3/resForm/trust_dlco_no");
				if(trust_dlco_no != "" && trust_dlco_no == hndl_plac_cd)		return;
				
				model.setValue("/root/reqData3/searchData/agn", lpad(hndl_plac_cd, 8, "0"));
				inp_hndl_plac_cd.refresh();

				model.copyNode("/root/reqData/searchData", "/root/reqData3/searchData");
				model.send("ad_nmd_5012_s");
				
				if(submit_completed()){	
					model.setValue("/root/resData3/resForm/trust_ern", model.getValue("/root/tempData/ern"));
					model.setValue("/root/resData3/resForm/trust_dlco_no", model.getValue("/root/tempData/dlco_no"));
					model.setValue("/root/resData3/resForm/trust_dlco_nm", model.getValue("/root/tempData/dlco_nm"));
					model.setValue("/root/resData3/resForm/trust_presi_nm", model.getValue("/root/tempData/presi_nm"));
					model.setValue("/root/resData3/resForm/trust_addr", model.getValue("/root/tempData/addr"));
					model.setValue("/root/resData3/resForm/trust_bizcond", model.getValue("/root/tempData/bizcond"));
					model.setValue("/root/resData3/resForm/trust_item", model.getValue("/root/tempData/item"));	
					model.setValue("/root/reqData3/searchData/agn_nm", model.getValue("/root/tempData/dlco_nm"));	
					
					model.refresh();							
				}				
			}
			
			// 수탁자 정보체크
			function setBoTrustInfo2(hndl_plac_cd){
				
				var trust_dlco_no = model.getValue("/root/resData3/resForm/trust_dlco_no");
				if(trust_dlco_no != "" && trust_dlco_no == hndl_plac_cd)		return;
				
				model.setValue("/root/reqData3/searchData/agn", hndl_plac_cd);
				inp_hndl_plac_cd.refresh();
				
				model.copyNode("/root/reqData/searchData", "/root/reqData3/searchData");
				
				model.send("ad_nmd_5012_s");
				if(submit_completed()){	
					model.setValue("/root/resData3/resForm/trust_ern", model.getValue("/root/tempData/ern"));
					model.setValue("/root/resData3/resForm/trust_dlco_no", model.getValue("/root/tempData/dlco_no"));
					model.setValue("/root/resData3/resForm/trust_dlco_nm", model.getValue("/root/tempData/dlco_nm"));
					model.setValue("/root/resData3/resForm/trust_presi_nm", model.getValue("/root/tempData/presi_nm"));
					model.setValue("/root/resData3/resForm/trust_addr", model.getValue("/root/tempData/addr"));
					model.setValue("/root/resData3/resForm/trust_bizcond", model.getValue("/root/tempData/bizcond"));
					model.setValue("/root/resData3/resForm/trust_item", model.getValue("/root/tempData/item"));	
					model.setValue("/root/reqData3/searchData/agn_nm", model.getValue("/root/tempData/dlco_nm"));
					
					model.refresh();							
				}				
			}			
			var _mode;
			function getMode(){
				return _mode;
			}
			function clear(){
				
				if(switch1.selectedIndex == 0){
					model.setValue("/root/resData/resForm/slip_seq", "");	
					model.setValue("/root/resData/resForm/suply_amt", "");	
					model.setValue("/root/resData/resForm/vat_amt", "");		
					model.setValue("/root/resData/resForm/tot_amt", "");		
					model.setValue("/root/resData/resForm/setoff_yn", "");		
					model.setValue("/root/resData/resForm/canc_yn", "");	
					
					var upload_yn	=	model.getValue("/root/resData/resForm/upload_yn");
					if( upload_yn != "Y" )
					{					
						var	cur_date	=	model.getValue("/root/reqData/searchData/todt");
						var	make_dt	=	cur_date.substring(0,6) + "" + commLastDay(cur_date);
						model.setValue("/root/resData/resForm/make_dt", make_dt);
					}
/*					
					model.setValue("/root/resData/resForm/demand_ern", "");
					model.setValue("/root/resData/resForm/demand_dlco_no", "");
					model.setValue("/root/resData/resForm/demand_dlco_nm", "");
					model.setValue("/root/resData/resForm/demand_presi_nm", "");
					model.setValue("/root/resData/resForm/demand_addr", "");
					model.setValue("/root/resData/resForm/demand_bizcond", "");
					model.setValue("/root/resData/resForm/demand_item", "");
					model.setValue("/root/resData/resForm/trust_ern", "");
					model.setValue("/root/resData/resForm/trust_dlco_no", "");
					model.setValue("/root/resData/resForm/trust_dlco_nm", "");
					model.setValue("/root/resData/resForm/trust_presi_nm", "");
					model.setValue("/root/resData/resForm/trust_addr", "");
					model.setValue("/root/resData/resForm/trust_bizcond", "");
					model.setValue("/root/resData/resForm/trust_item", "");						
*/					
					
				}else if(switch1.selectedIndex == 1){
					model.setValue("/root/resData2/resForm/slip_seq", "");	
					model.setValue("/root/resData2/resForm/suply_amt", "");	
					model.setValue("/root/resData2/resForm/vat_amt", "");		
					model.setValue("/root/resData2/resForm/tot_amt", "");		
					//20120216 김상훈 품목체크
					var tax_item = model.getValue("/root/tampData/xx_tax_item");
					if(tax_item == ""){
						tax_item = "디지털초판판매료";
					}					
					model.setValue("/root/resData2/resForm/tax_item", tax_item);	
					model.setValue("/root/resData2/resForm/canc_yn", "");
					model.setValue("/root/resData2/resForm/re_issu_resn_cd", "");
					model.setValue("/root/resData2/resForm/issu_tms", "");		
					var	cur_date	=	model.getValue("/root/reqData2/searchData/todt");
					var	make_dt	=	cur_date.substring(0,6) + "" + commLastDay(cur_date);
					model.setValue("/root/resData2/resForm/make_dt", make_dt);						
/*					
					model.setValue("/root/resData2/resForm/demand_ern", "");
					model.setValue("/root/resData2/resForm/demand_dlco_no", "");
					model.setValue("/root/resData2/resForm/demand_dlco_nm", "");
					model.setValue("/root/resData2/resForm/demand_presi_nm", "");
					model.setValue("/root/resData2/resForm/demand_addr", "");
					model.setValue("/root/resData2/resForm/demand_bizcond", "");
					model.setValue("/root/resData2/resForm/demand_item", "");
*/		
				}else if(switch1.selectedIndex == 2){
					model.setValue("/root/resData3/resForm/slip_seq", "");	
					model.setValue("/root/resData3/resForm/suply_amt", "");	
					model.setValue("/root/resData3/resForm/vat_amt", "");		
					model.setValue("/root/resData3/resForm/tot_amt", "");		
					//20120216 김상훈 품목체크
					var tax_item = model.getValue("/root/tampData/xx_tax_item");
					if(tax_item == ""){
						tax_item = "디지털초판판매료";
					}						
					model.setValue("/root/resData3/resForm/tax_item", tax_item);					
					model.setValue("/root/resData3/resForm/canc_yn", "");
					model.setValue("/root/resData3/resForm/re_issu_resn_cd", "");
					model.setValue("/root/resData3/resForm/issu_tms", "");	
					var	cur_date	=	model.getValue("/root/reqData3/searchData/todt");
					var	make_dt	=	cur_date.substring(0,6) + "" + commLastDay(cur_date);
					model.setValue("/root/resData3/resForm/make_dt", make_dt);
/*					
					model.setValue("/root/resData2/resForm/demand_ern", "");
					model.setValue("/root/resData2/resForm/demand_dlco_no", "");
					model.setValue("/root/resData2/resForm/demand_dlco_nm", "");
					model.setValue("/root/resData2/resForm/demand_presi_nm", "");
					model.setValue("/root/resData2/resForm/demand_addr", "");
					model.setValue("/root/resData2/resForm/demand_bizcond", "");
					model.setValue("/root/resData2/resForm/demand_item", "");
*/		
				}
				model.refresh();
			}
			function setMode(mode){
				_mode = mode;
				if(switch1.selectedIndex == 0){
					if(mode == INSERT_MODE){
						cb_prof_type_cd.disabled 		= false;
//						cb_slip_clsf_cd.disabled 		= false;
						inp_slip_occr_dt.disabled 	= false;
						inp_slip_seq.disabled 		= false;		
						inp_make_dt.disabled 			= false;
						clear();	
					}else if(mode == UPDATE_MODE){
						cb_prof_type_cd.disabled 		= true;
						cb_slip_clsf_cd.disabled 		= true;
						inp_slip_occr_dt.disabled 	= true;
						inp_slip_seq.disabled 		= true;
						inp_make_dt.disabled 			= true;
					}
				}else if(switch1.selectedIndex == 1){
					if(mode == INSERT_MODE){
						cb_prof_type_cd2.disabled = false;
//						cb_slip_clsf_cd2.disabled = false;
						inp_slip_occr_dt2.disabled = false;
						inp_slip_seq2.disabled = false;		
						clear();		
						inp_make_dt2.disabled = false;	
					}else if(mode == UPDATE_MODE){
						cb_prof_type_cd2.disabled = true;
						cb_slip_clsf_cd2.disabled = true;
						inp_slip_occr_dt2.disabled = true;
						inp_slip_seq2.disabled = true;
						inp_make_dt2.disabled = true;
					}					
				}else if(switch1.selectedIndex == 2){
					if(mode == INSERT_MODE){
						cb_prof_type_cd3.disabled = false;
//						cb_slip_clsf_cd3.disabled = false;
						inp_slip_occr_dt3.disabled = false;
						inp_slip_seq3.disabled = false;		
						clear();		
						inp_make_dt3.disabled = false;	
					}else if(mode == UPDATE_MODE){
						cb_prof_type_cd3.disabled = true;
						cb_slip_clsf_cd3.disabled = true;
						inp_slip_occr_dt3.disabled = true;
						inp_slip_seq3.disabled = true;
						inp_make_dt3.disabled = true;
					}					
				}
			}
			function resetSuplyAmt(){

				if(switch1.selectedIndex == 0){
					
					var suply_amt = 0;
					var vat_amt   = 0;
				
					for(var i=datagrid1.fixedRows; i<datagrid1.rows; i++){
						
						var checked = datagrid1.valueMatrix(i, datagrid1.colRef("checked"));//model.getValue("/root/resData/gridData/record["+i+"]/checked");
						if(checked == "Y"){
							var advt_fee = Number(datagrid1.valueMatrix(i, datagrid1.colRef("advt_fee")));//Number(model.getValue("/root/resData/gridData/record["+i+"]/advt_fee"));	
							var vat      = Number(datagrid1.valueMatrix(i, datagrid1.colRef("vat")));//Number(model.getValue("/root/resData/gridData/record["+i+"]/vat"));	
							
							suply_amt += advt_fee;
							vat_amt   += vat;
							
							datagrid1.addStatus(i, "update");
						}
					}
					model.setValue("/root/resData/resForm/suply_amt", suply_amt);
					model.setValue("/root/resData/resForm/vat_amt", vat_amt);
					model.setValue("/root/resData/resForm/tot_amt", (suply_amt + vat_amt));
					
					out_suply_amt.refresh();
					out_vat_amt.refresh();
					out_tot_amt.refresh();
					
				}else if(switch1.selectedIndex == 1){

					var suply_amt = 0;
					var vat_amt   = 0;									
					
					for(var i=datagrid2.fixedRows; i<datagrid2.rows; i++){
						var checked = datagrid2.valueMatrix(i, datagrid2.colRef("checked"));//model.getValue("/root/resData2/gridData/record["+i+"]/checked");
						if(checked == "Y"){
							var advt_fee = Number(datagrid2.valueMatrix(i, datagrid2.colRef("advt_fee")));//Number(model.getValue("/root/resData2/gridData/record["+i+"]/advt_fee"));	
							var vat      = Number(datagrid2.valueMatrix(i, datagrid2.colRef("vat")));//Number(model.getValue("/root/resData2/gridData/record["+i+"]/vat"));	
							suply_amt 	+= advt_fee;
							vat_amt   	+= vat;
							
							datagrid2.addStatus(i, "update");
						}
					}
					model.setValue("/root/resData2/resForm/suply_amt", suply_amt);
					model.setValue("/root/resData2/resForm/vat_amt", 	vat_amt);
					model.setValue("/root/resData2/resForm/tot_amt", 	(suply_amt + vat_amt));
					
					out_suply_amt2.refresh();
					out_vat_amt2.refresh();
					out_tot_amt2.refresh();
					

					var make_dt	=	"";
					for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
						var checked	=	datagrid2.valueMatrix(i, datagrid2.colRef("checked"));
						var pubc_dt	=	datagrid2.valueMatrix(i, datagrid2.colRef("pubc_dt"));
						if(checked  == "Y"){
							if(pubc_dt	>	make_dt){
								make_dt	= pubc_dt;
							}				
						}
					}	
					datagrid1.refresh();
					
					model.setValue("/root/resData2/resForm/make_dt", make_dt);
					inp_make_dt2.refresh();
									
					
				}else if(switch1.selectedIndex == 2){
					
					var suply_amt = 0;
					var vat_amt   = 0;
				
					for(var i=datagrid3.fixedRows; i<datagrid3.rows; i++){
						
						var checked = datagrid3.valueMatrix(i, datagrid3.colRef("checked"));//model.getValue("/root/resData/gridData/record["+i+"]/checked");
						if(checked == "Y"){
							var advt_fee = Number(datagrid3.valueMatrix(i, datagrid3.colRef("advt_fee")));//Number(model.getValue("/root/resData/gridData/record["+i+"]/advt_fee"));	
							var vat      = Number(datagrid3.valueMatrix(i, datagrid3.colRef("vat")));//Number(model.getValue("/root/resData/gridData/record["+i+"]/vat"));	
							
							suply_amt += advt_fee;
							vat_amt   += vat;
							
							datagrid3.addStatus(i, "update");
						}
					}
					model.setValue("/root/resData3/resForm/suply_amt", suply_amt);
					model.setValue("/root/resData3/resForm/vat_amt", vat_amt);
					model.setValue("/root/resData3/resForm/tot_amt", (suply_amt + vat_amt));
					
					out_suply_amt3.refresh();
					out_vat_amt3.refresh();
					out_tot_amt3.refresh();
					
				}
			}
			
			function loadData(){

				if(switch1.selectedIndex == 0){
					makeNodeValue("/root/resData/resForm/hndl_clsf", "2");
					modelSendNoMake("ad_nmd_5030_s", "/ad/nmd/5030", "/root/resData/resForm", "/root/resData");
					if(submit_completed()){
						var chk_cnt = Number(model.getValue("/root/resData/resForm/chk_cnt"));
						var canc_yn = model.getValue("/root/resData/resForm/canc_yn");
						if(chk_cnt == 0){
//							alert(" 검색결과가 없습니다.");
						}else if(canc_yn != 'Y') {
							setMode(UPDATE_MODE);
						}

						for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
							var sale_stmt_issu_yn = datagrid1.valueMatrix(i, datagrid1.colRef("sale_stmt_issu_yn"));
							if(sale_stmt_issu_yn == "Y"){
								datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = true;
								datagrid1.rowstyle(i, "data", "background-color") = _bgcolor;
							}else{
								datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = false;
								datagrid1.rowstyle(i, "data", "background-color") = "#FFFFFF";
							}
						}
					}
					var temp = model.getValue("/root/resData/resForm/semuro_no");
					model.setValue("/root/tmp_semuro_no",temp);				
				}else if(switch1.selectedIndex == 1){
					//(-)세금계산서 작성일자 
					inp_make_dt21.visible = false;
					cap_make_dt21.visible = false;						
					
					makeNodeValue("/root/resData2/resForm/hndl_clsf", "1");
					modelSendNoMake("ad_nmd_5030_s", "/ad/nmd/5030", "/root/resData2/resForm", "/root/resData2");
					if(submit_completed()){
						
						var chk_cnt = Number(model.getValue("/root/resData2/resForm/chk_cnt"));  //??
						var canc_yn = model.getValue("/root/resData2/resForm/canc_yn");
						
						if(chk_cnt == 0){
//							alert(" 검색결과가 없습니다.");
						}else if(canc_yn != 'Y') {
							setMode(UPDATE_MODE);
						}


						for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
							var sale_stmt_issu_yn = datagrid2.valueMatrix(i, datagrid2.colRef("sale_stmt_issu_yn"));
							if(sale_stmt_issu_yn == "Y"){
								datagrid2.isReadOnly(i, datagrid2.colRef("checked")) = true;
								datagrid2.rowstyle(i, "data", "background-color") = _bgcolor;
							}else{
								datagrid2.isReadOnly(i, datagrid2.colRef("checked")) = false;
								datagrid2.rowstyle(i, "data", "background-color") = "#FFFFFF";
							}
						}
						
						model.setValue("/root/resData/resForm/email_id"			,model.getValue("/root/resData2/resForm/email_id"));
						model.setValue("/root/resData/resForm/elec_tax_comp_cd"	,model.getValue("/root/resData2/resForm/elec_tax_comp_cd"));
						model.setValue("/root/resData/resForm/semuro_no"			,model.getValue("/root/resData2/resForm/semuro_no"));
					}	
				}else if(switch1.selectedIndex == 2){

					makeNodeValue("/root/resData/resForm/hndl_clsf", "4");
					modelSendNoMake("ad_nmd_5030_s", "/ad/nmd/5030", "/root/resData3/resForm", "/root/resData3");
					if(submit_completed()){
						var chk_cnt = Number(model.getValue("/root/resData3/resForm/chk_cnt"));
						var canc_yn = model.getValue("/root/resData3/resForm/canc_yn");
						if(chk_cnt == 0){
//							alert(" 검색결과가 없습니다.");
						}else if(canc_yn != 'Y') {
							setMode(UPDATE_MODE);
						}

						for(var i=datagrid3.fixedRows;i<datagrid3.rows;i++){
							var sale_stmt_issu_yn = datagrid3.valueMatrix(i, datagrid3.colRef("sale_stmt_issu_yn"));
							if(sale_stmt_issu_yn == "Y"){
								datagrid3.isReadOnly(i, datagrid3.colRef("checked")) = true;
								datagrid3.rowstyle(i, "data", "background-color") = _bgcolor;
							}else{
								datagrid3.isReadOnly(i, datagrid3.colRef("checked")) = false;
								datagrid3.rowstyle(i, "data", "background-color") = "#FFFFFF";
							}
						}
						model.setValue("/root/resData/resForm/email_id"			,model.getValue("/root/resData3/resForm/email_id"));
						model.setValue("/root/resData/resForm/elec_tax_comp_cd"	,model.getValue("/root/resData3/resForm/elec_tax_comp_cd"));
						model.setValue("/root/resData/resForm/semuro_no"			,model.getValue("/root/resData3/resForm/semuro_no"));
					}				
				}
				
				inp_email.refresh();
				cmb_elec_tax_comp_cd.refresh();
				inp_semuro_no.refresh();
				var temp = model.getValue("/root/resData3/resForm/semuro_no");
				model.setValue("/root/tmp_semuro_no",temp);			
			}
			function check_issu(){

				var tot_amt = Number(model.getValue("/root/resData/resForm/tot_amt"));
				if(tot_amt == 0){
					alert("상계할 게재를 선택하세요.");
					return false;
				}

				var hndl_clsf = model.getValue("/root/resData/resForm/hndl_clsf");
				if(hndl_clsf	== "4"){
					var issu_tms = Number(model.getValue("/root/resData/resForm/issu_tms"));
					
					if(issu_tms >= 1){
						var re_issu_resn_cd = model.getValue("/root/resData/resForm/re_issu_resn_cd");
						if(re_issu_resn_cd == ""){
							alert("재발행시는 사유코드를 입력하세요.");
							return false;
						}
					}				
				}

				return true;
			}
			function check_issu2(){
				
				var	canc_yn		=	model.getValue("/root/resData2/resForm/canc_yn");
				if(canc_yn == "Y"){
					alert("취소된 세금계산서입니다.");
					return false;
				}
				
				var prof_type_cd = 	model.getValue("/root/resData2/resForm/prof_type_cd");
//				if(prof_type_cd != "33"){					
					var tot_amt = Number(model.getValue("/root/resData2/resForm/tot_amt"));
					if(tot_amt == 0){
						alert("상계할 게재를 선택하세요.");
						return false;
					}
		//		}
				
				var issu_tms = Number(model.getValue("/root/resData2/resForm/issu_tms"));
				
				if(issu_tms >= 1){
					var re_issu_resn_cd = model.getValue("/root/resData2/resForm/re_issu_resn_cd");
					if(re_issu_resn_cd == ""){
						alert("재발행시는 사유코드를 입력하세요.");
						return false;
					}
				}
								
				return true;
			}

			function check_issu3(){

				var	canc_yn		=	model.getValue("/root/resData3/resForm/canc_yn");
				if(canc_yn == "Y"){
					alert("취소된 세금계산서입니다.");
					return false;
				}
				
				
				var prof_type_cd = model.getValue("/root/resData3/resForm/prof_type_cd");
//				if(prof_type_cd != "33"){					
					var tot_amt = Number(model.getValue("/root/resData3/resForm/tot_amt"));
					if(tot_amt == 0){
						alert("상계할 게재를 선택하세요.");
						return false;
					}
		//		}
				
				var issu_tms = Number(model.getValue("/root/resData3/resForm/issu_tms"));
				
				if(issu_tms >= 1){
					var re_issu_resn_cd = model.getValue("/root/resData3/resForm/re_issu_resn_cd");
					if(re_issu_resn_cd == ""){
						alert("재발행시는 사유코드를 입력하세요.");
						return false;
					}
				}
								
				return true;
			}	
			
			function check_issu4(){
				
				var	canc_yn		=	model.getValue("/root/resData2/resForm/canc_yn");
				if(canc_yn == "Y"){
					alert("취소된 세금계산서입니다.");
					return false;
				}
				
				var prof_type_cd = 	model.getValue("/root/resData2/resForm/prof_type_cd");
//				if(prof_type_cd != "33"){					
					var tot_amt = Number(model.getValue("/root/resData2/resForm/tot_amt"));
					if(tot_amt == 0){
						alert("세금계산서 조회 먼저하세요.");
						return false;
					}
		//		}
				
				var issu_tms = Number(model.getValue("/root/resData2/resForm/issu_tms"));
				
				if(issu_tms < 1){
					alert("발행된 세금계산서에 한에서만 마이너스 계산서가 발행됩니다.");
					return false;
				}
				
				var semurono = model.getValue("/root/resData/resForm/semuro_no");
				if(semurono == "NONE" || semurono == ""){
					alert("승인번호가 있는 세금계산서만 가능합니다.")
					return false;
				}
									
				return true;
			}
			
			function check_issu5(){
				
				var	canc_yn		=	model.getValue("/root/resData/resForm/canc_yn");
				if(canc_yn == "Y"){
					alert("취소된 세금계산서입니다.");
					return false;
				}
				
				var prof_type_cd = 	model.getValue("/root/resData/resForm/prof_type_cd");
//				if(prof_type_cd != "33"){					
					var tot_amt = Number(model.getValue("/root/resData/resForm/tot_amt"));
					if(tot_amt == 0){
						alert("세금계산서 조회 먼저하세요.");
						return false;
					}
		//		}
				
				var issu_tms = Number(model.getValue("/root/resData/resForm/issu_tms"));
				
				if(issu_tms < 1){
					alert("발행된 세금계산서에 한에서만 마이너스 계산서가 발행됩니다.");
					return false;
				}
				
				var semurono = model.getValue("/root/resData/resForm/semuro_no");
				if(semurono == "NONE" || semurono == ""){
					alert("승인번호가 있는 세금계산서만 가능합니다.")
					return false;
				}
									
				return true;
			}
				
			function check_issu6(){
				
				var	canc_yn		=	model.getValue("/root/resData3/resForm/canc_yn");
				if(canc_yn == "Y"){
					alert("취소된 세금계산서입니다.");
					return false;
				}
				
				var prof_type_cd = 	model.getValue("/root/resData3/resForm/prof_type_cd");
//				if(prof_type_cd != "33"){					
					var tot_amt = Number(model.getValue("/root/resData3/resForm/tot_amt"));
					if(tot_amt == 0){
						alert("세금계산서 조회 먼저하세요.");
						return false;
					}
		//		}
				
				var issu_tms = Number(model.getValue("/root/resData3/resForm/issu_tms"));
				
				if(issu_tms < 1){
					alert("발행된 세금계산서에 한에서만 마이너스 계산서가 발행됩니다.");
					return false;
				}
				
				var semurono = model.getValue("/root/resData/resForm/semuro_no");
				if(semurono == "NONE" || semurono == ""){
					alert("승인번호가 있는 세금계산서만 가능합니다.")
					return false;
				}
									
				return true;
			}
													
			function goReport(gubun){
					
				// 오즈관련 노드 초기화..					
				resetOznode();					
									
				// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
				makeNodeValue("/root/oz_data/ozrName","fcmc/SP_FC_ACCT_2181_P")							
				
				var root			=	"";
				var	prof_type_cd	=	"";
				var	slip_clsf_cd	=	"";
				var	slip_seq		=	"";
				
				if(switch1.selectedIndex == 2){
				//광고지사
					root				= "/root/resData3/resForm";
					
					prof_type_cd		= model.getValue(	root + "/prof_type_cd");
					slip_clsf_cd		= model.getValue(	root + "/slip_clsf_cd");
					slip_occr_dt		= model.getValue(	root + "/slip_occr_dt");
					slip_seq			= model.getValue(	root + "/slip_seq");
					
				}else if(switch1.selectedIndex == 1){
				//직거래												
					root				= "/root/resData2/resForm";
					
					prof_type_cd		= model.getValue(	root + "/prof_type_cd");
					slip_clsf_cd		= model.getValue(	root + "/slip_clsf_cd");
					slip_occr_dt		= model.getValue(	root + "/slip_occr_dt");
					slip_seq		= model.getValue(	root + "/slip_seq");
					
				}
								
				if ( slip_occr_dt == "" ){
					commAlert("일자가 없습니다.");
					return;
				}	
				if ( slip_seq == "" ){
					commAlert("일련번호가 없습니다.");
					return;
				}
		
				makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd"				, model.property("ss_cmpycd"));	 //2012.01.18				
				makeNodeValue("/root/oz_data/odiParam/iv_prof_type_cd"			, prof_type_cd);
				makeNodeValue("/root/oz_data/odiParam/iv_slip_clsf_cd"			, slip_clsf_cd);
				makeNodeValue("/root/oz_data/odiParam/iv_slip_occr_dt"			, slip_occr_dt);
				makeNodeValue("/root/oz_data/odiParam/iv_slip_seq_fr"				, slip_seq);
				makeNodeValue("/root/oz_data/odiParam/iv_slip_seq_to"				, slip_seq);
				
			
				// 레포트뷰어 호출.					
				openOzwin("/root/oz_data");	
			}
			
				function loadPubc()
				{
					if( switch1.selectedIndex == 0 )
					{
						if( commReqCheck("srch_group") )
						{
							var dlco_no 	= model.getValue("/root/reqData/searchData/dlco_no");
							var agn     	= model.getValue("/root/reqData/searchData/agn");
							if( dlco_no == "" && agn == "" )
							{
								alert("광고주 또는 대행사를 입력하세요.");
								return;
							}

							modelSendNoMake("ad_nmd_5010_l", "/ad/nmd/5010", "/root/reqData/searchData", "/root/resData/gridData");							
							if( submit_completed() )
							{
								for( var i=datagrid1.fixedRows;i<datagrid1.rows;i++ )
								{
									var sale_stmt_issu_yn = datagrid1.valueMatrix(i, datagrid1.colRef("sale_stmt_issu_yn"));
									if( sale_stmt_issu_yn == "Y" )
									{
										datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = true;
										datagrid1.rowstyle(i, "data", "background-color") 	= _bgcolor;
									}
									else
									{
										datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = false;
										datagrid1.rowstyle(i, "data", "background-color") 	= "#FFFFFF";
									}
								}
							}
							clear();					
						}
					}
					else if( switch1.selectedIndex == 1 )
					{
						if( commReqCheck("srch_group2") )
						{
							var dlco_no = model.getValue("/root/reqData/searchData/dlco_no");
							modelSendNoMake("ad_nmd_5050_l", "/ad/nmd/5050", "/root/reqData2/searchData", "/root/resData2/gridData");
							if( submit_completed() )
							{
								for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++)
								{
									var sale_stmt_issu_yn = datagrid2.valueMatrix(i, datagrid2.colRef("sale_stmt_issu_yn"));
									if( sale_stmt_issu_yn == "Y" )
									{
										datagrid2.isReadOnly(i, datagrid2.colRef("checked")) = true;
										datagrid2.rowstyle(i, "data", "background-color")	= _bgcolor;
									}
									else
									{
										datagrid2.isReadOnly(i, datagrid2.colRef("checked")) = false;
										datagrid2.rowstyle(i, "data", "background-color") 	= "#FFFFFF";
									}
								}
							}
							clear();					
						}
					}
					else if( switch1.selectedIndex == 2 )
					{
						if( commReqCheck("srch_group3") )
						{
							var dlco_no 	= model.getValue("/root/reqData3/searchData/dlco_no");
							var agn     	= model.getValue("/root/reqData3/searchData/agn");
							if( dlco_no == "" && agn == "" )
							{
								alert("광고주 또는 광고지사를 입력하세요.");
								return;
							}
							
							modelSendNoMake("ad_nmd_5060_l", "/ad/nmd/5060", "/root/reqData3/searchData", "/root/resData3/gridData");
							if( submit_completed() )
							{
								for( var i=datagrid3.fixedRows;i<datagrid3.rows;i++ )
								{
									var sale_stmt_issu_yn = datagrid3.valueMatrix(i, datagrid3.colRef("sale_stmt_issu_yn"));
									if( sale_stmt_issu_yn == "Y" )
									{
										datagrid3.isReadOnly(i, datagrid3.colRef("checked")) = true;
										datagrid3.rowstyle(i, "data", "background-color") 	= _bgcolor;
									}
									else
									{
										datagrid3.isReadOnly(i, datagrid3.colRef("checked")) = false;
										datagrid3.rowstyle(i, "data", "background-color") 	= "#FFFFFF";
									}
								}
							}
							clear();					
						}				
					}
					setMode(INSERT_MODE);
				}
			
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="1,936;2,70;2,93;2,164;" style="font-family:굴림; font-size:8pt; ">
		<caption id="caption23" class="list_cap02" style="left:10px; top:690px; width:926px; height:26px; "/>
		<switch id="switch1" style="left:10px; top:92px; width:926px; height:580px; ">
			<case id="case1" disabled="true" style="left:0px; top:0px; width:926px; height:628px; ">
				<caption id="caption24" class="list_cap02" style="left:5px; top:545px; width:445px; height:26px; "/>
				<caption id="caption59" class="list_cap02" style="left:490px; top:495px; width:430px; height:26px; "/>
				<caption id="caption58" class="list_cap02" style="left:490px; top:470px; width:430px; height:26px; "/>
				<caption id="caption60" class="list_cap02" style="left:490px; top:520px; width:430px; height:26px; "/>
				<caption id="caption101" class="list_cap02" style="left:490px; top:360px; width:430px; height:26px; "/>
				<caption id="caption103" class="list_cap02" style="left:490px; top:410px; width:430px; height:26px; "/>
				<caption id="caption102" class="list_cap02" style="left:490px; top:385px; width:430px; height:26px; "/>
				<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" caption="선택^매체^게재일자^전표번호^광고주코드^광고주^광고료^부가세^대행사^대행사코드^sale_stmt_issu_yn" colsep="#" colwidth="50, 77, 100, 147, 83, 131, 90, 90, 71, 50, 100" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:5px; top:70px; width:915px; height:240px; ">
					<col checkvalue="Y,N" ref="checked" type="checkbox"/>
					<col ref="medi_nm" style="text-align:left; "/>
					<col ref="pubc_dt" format="yyyy-mm-dd" style="text-align:center; "/>
					<col ref="pubc_slip_no" format="999-99999999-9999" style="text-align:center; "/>
					<col ref="dlco_no"/>
					<col ref="dlco_nm" style="text-align:left; "/>
					<col ref="advt_fee" format="#,###" style="text-align:right; "/>
					<col ref="vat" format="#,###" style="text-align:right; "/>
					<col ref="agn_nm" style="text-align:left; "/>
					<col ref="agn" visibility="hidden"/>
					<col ref="sale_stmt_issu_yn" visibility="hidden"/>
					<script type="javascript" ev:event="xforms-select">
						<![CDATA[
						var row = datagrid1.row;
						
						if(isDataRegion(datagrid1)){
							
							var selected_dlco_no =	datagrid1.valueMatrix(row, datagrid1.colRef("dlco_no"));
							
							for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
								var checked 				= datagrid1.valueMatrix(i, datagrid1.colRef("checked"));
								if(checked == "Y"){//alert("rowStatus1::"+datagrid1.rowStatus(datagrid1.row));
									var dlco_no = datagrid1.valueMatrix(i, datagrid1.colRef("dlco_no"));
									if(selected_dlco_no != dlco_no){
										alert("같은 광고주를 선택해야 합니다.");
									 	datagrid1.valueMatrix(row, datagrid1.colRef("checked")) = "N";
									 	datagrid1.rowStatus(row) = "0";
									 	datagrid1.refresh();
										return;
									}
								}
							}
						 	
							var agn = datagrid1.valueMatrix(datagrid1.row, datagrid1.colRef("agn"));//model.getValue("/root/resData/gridData/record["+row+"]/agn");							
							
							if(agn != ""){
								setTrustInfo2(agn);							
							}
							
							var dlco_no 	= datagrid1.valueMatrix(datagrid1.row, datagrid1.colRef("dlco_no"));//model.getValue("/root/resData/gridData/record["+row+"]/dlco_no");	
							var dlco_nm	= datagrid1.valueMatrix(datagrid1.row, datagrid1.colRef("dlco_nm"));//model.getValue("/root/resData/gridData/record["+row+"]/dlco_nm");		
							
//							model.setValue("/root/reqData/searchData/dlco_no", dlco_no);				
//							model.setValue("/root/reqData/searchData/dlco_nm", dlco_nm);	
							
//							inp_dlco_no.refresh();			
//							inp_dlco_nm.refresh();		
							
							setDemandInfo(dlco_no);
							
							resetSuplyAmt();
							
							datagrid1.addStatus(row, "update");
							
							datagrid1.refresh();
						}else{
							
							if(datagrid1.rows == datagrid1.fixedRows){
								alert("선택할 대상이 없습니다. 게재조회를 먼저하세요.");								
								datagrid1.fixedcellischeck(0, datagrid1.colRef("checked")) = false;
								return;
							}
							
							var	pre_dlco_no = "";
							for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
								var dlco_no = datagrid1.valueMatrix(i, datagrid1.colRef("dlco_no"));

								if(pre_dlco_no != "" && pre_dlco_no != dlco_no){
									alert("같은 광고주를 선택해야 합니다.");
									for(var j=datagrid1.fixedRows;j<datagrid1.rows;j++){
									 	datagrid1.valueMatrix(j, datagrid1.colRef("checked")) = "N";		
									 	datagrid1.rowStatus(j) = "0";
									}
								 	
									datagrid1.fixedcellischeck(0, datagrid1.colRef("checked")) = false;
									break;
								}
								pre_dlco_no = dlco_no;
							}
							

							for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
								var sale_stmt_issu_yn = datagrid1.valueMatrix(i, datagrid1.colRef("sale_stmt_issu_yn"));
								if(sale_stmt_issu_yn	==	"Y"){
								 	datagrid1.valueMatrix(i, datagrid1.colRef("checked")) = "N";		
								 	datagrid1.rowStatus(i) = "0";
								}
							}

						 	datagrid1.refresh();
							setDemandInfo(pre_dlco_no);
							
							resetSuplyAmt();
						}
						
						// 작성일자 수정
						var upload_yn	=	model.getValue("/root/resData/resForm/upload_yn");
						if( upload_yn != "Y" )
						{
							var checked_cnt	=	0;			
							var max_pubc_dt	=	"";
							var make_dt		=	model.getValue("/root/resData/resForm/make_dt");
							for( var i=datagrid1.fixedRows;i<datagrid1.rows;i++ )
							{
								var checked	=	datagrid1.valueMatrix(i, datagrid1.colRef("checked"));
								var pubc_dt	=	datagrid1.valueMatrix(i, datagrid1.colRef("pubc_dt"));
								
								if( checked == "Y" )
								{
									if( pubc_dt	 > max_pubc_dt )
									{
										max_pubc_dt	=	pubc_dt;
									}
									checked_cnt++;
								}
							}
								
							if( checked_cnt > 1 )
							{
								max_pubc_dt = max_pubc_dt.substring(0,6) + "" + commLastDay(max_pubc_dt);
							}
	
							model.setValue("/root/resData/resForm/make_dt", max_pubc_dt);
							inp_make_dt.refresh();
						}

						]]>
					</script>
					<script type="javascript" ev:event="xforms-deselect">
						<![CDATA[
												
						resetSuplyAmt();
						//alert("rowStatus2::"+datagrid1.rowStatus(datagrid1.row));
						datagrid1.rowStatus(datagrid1.row) =  "0";
							
						datagrid1.refresh();

						var upload_yn	=	model.getValue("/root/resData/resForm/upload_yn");
						if( upload_yn != "Y" )
						{
							var checked_cnt		=	0;
							var 	make_dt			=	model.getValue("/root/resData/resForm/make_dt");
							var	max_pubc_dt		=	"";
							for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
								var checked	=	datagrid1.valueMatrix(i, datagrid1.colRef("checked"));
								var pubc_dt	=	datagrid1.valueMatrix(i, datagrid1.colRef("pubc_dt"));
								
								if(checked == "Y"){
									if(pubc_dt	>	max_pubc_dt){
										max_pubc_dt	=	pubc_dt;
										checked_cnt++;
									}
								}
							}		
	
							if(checked_cnt > 1){
								max_pubc_dt = max_pubc_dt.substring(0,6) + "" + commLastDay(max_pubc_dt);
							}						
	
							model.setValue("/root/resData/resForm/make_dt", max_pubc_dt);
							inp_make_dt.refresh();	
						}					
									
						]]>
					</script>
				</datagrid>
				<caption id="caption86" class="list_cap02" style="left:5px; top:325px; width:915px; height:26px; "/>
				<input id="inp_slip_seq" ref="/root/resData/resForm/slip_seq" navindex="12" format="9999" style="left:449px; top:329px; width:30px; height:18px; ">
					<script type="javascript" ev:event="DOMFocusOut">
						<![CDATA[
						var slip_seq = model.getValue("/root/resData/resForm/slip_seq");
						if(slip_seq != ""){
							model.setValue("/root/resData/resForm/slip_seq", lpad(slip_seq, 4, "0"));
							inp_slip_seq.refresh();	
						}						
						]]>
					</script>
				</input>
				<caption id="caption87" class="list_cap03" style="left:5px; top:325px; width:120px; height:26px; ">
					<![CDATA[세금계산서번호]]>
					<script type="javascript" ev:event="ondblclick">
						<![CDATA[
							if( cb_slip_clsf_cd.disabled == true ) 		cb_slip_clsf_cd.disabled = false;
							else								cb_slip_clsf_cd.disabled = true;
							if( cb_slip_clsf_cd2.disabled == true ) 	cb_slip_clsf_cd2.disabled = false;
							else								cb_slip_clsf_cd2.disabled = true;
							if( cb_slip_clsf_cd3.disabled == true ) 	cb_slip_clsf_cd3.disabled = false;
							else								cb_slip_clsf_cd3.disabled = true;
							
							//업로드 데이터
							if( oup_upload_dlco_no.visible == true )
							{
								oup_upload_dlco_no.visible = false;
								oup_upload_agn_no.visible = false;
								oup_upload_elec_tax_comp_cd.visible = false;
								oup_upload_email_id.visible = false;
								oup_upload_semuro_no.visible = false;
							}
							else
							{
								oup_upload_dlco_no.visible = true;
								oup_upload_agn_no.visible = true;
								oup_upload_elec_tax_comp_cd.visible = true;
								oup_upload_email_id.visible = true;
								oup_upload_semuro_no.visible = true;
							}
							
						]]>
					</script>
				</caption>
				<caption id="caption88" class="list_cap03" style="left:806px; top:325px; width:80px; height:26px; ">취소여부</caption>
				<caption id="caption89" class="list_cap03" style="left:685px; top:325px; width:80px; height:26px; ">상계여부</caption>
				<select1 id="cb_prof_type_cd" ref="/root/resData/resForm/prof_type_cd" navindex="9" appearance="minimal" style="left:129px; top:329px; width:130px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/prof_type_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<select1 id="cb_slip_clsf_cd" ref="/root/resData/resForm/slip_clsf_cd" disabled="true" navindex="10" appearance="minimal" style="left:264px; top:329px; width:80px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/cb_slip_clsf_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<input id="inp_slip_occr_dt" ref="/root/resData/resForm/slip_occr_dt" navindex="11" inputtype="date" format="yyyy-mm-dd" style="left:354px; top:329px; width:90px; height:18px; "/>
				<caption id="caption33" class="list_cap02" style="left:5px; top:360px; width:26px; height:97px; "/>
				<caption id="caption35" class="list_cap03" style="left:5px; top:360px; width:26px; height:101px; ">
					<![CDATA[공

급

자]]>
				</caption>
				<caption id="caption36" class="list_cap02" style="left:29px; top:360px; width:420px; height:26px; "/>
				<caption id="caption90" class="list_cap02" style="left:29px; top:385px; width:420px; height:26px; "/>
				<caption id="caption91" class="list_cap02" style="left:29px; top:410px; width:420px; height:26px; "/>
				<caption id="caption92" class="list_cap02" style="left:29px; top:435px; width:420px; height:26px; "/>
				<output id="output23" ref="/root/resData/resForm/suply_ern" style="left:127px; top:364px; width:140px; height:18px; "/>
				<caption id="caption93" class="list_cap03" style="left:29px; top:360px; width:95px; height:26px; ">등록번호</caption>
				<caption id="caption94" class="list_cap03" style="left:29px; top:385px; width:95px; height:26px; ">상호(법인명)</caption>
				<caption id="caption95" class="list_cap03" style="left:29px; top:410px; width:95px; height:26px; ">사업장 소재지</caption>
				<caption id="caption96" class="list_cap03" style="left:29px; top:435px; width:95px; height:26px; ">업  태</caption>
				<output id="output24" ref="/root/resData/resForm/suply_dlco_nm" style="left:127px; top:389px; width:140px; height:18px; "/>
				<output id="output62" ref="/root/resData/resForm/suply_presi_nm" style="left:328px; top:389px; width:115px; height:18px; "/>
				<caption id="caption97" class="list_cap03" style="left:270px; top:385px; width:55px; height:26px; ">성명</caption>
				<caption id="caption98" class="list_cap03" style="left:270px; top:435px; width:55px; height:26px; ">종목</caption>
				<output id="output63" ref="/root/resData/resForm/suply_addr" style="left:127px; top:414px; width:316px; height:18px; "/>
				<output id="output64" ref="/root/resData/resForm/suply_bizcond" style="left:127px; top:439px; width:140px; height:18px; "/>
				<output id="output65" ref="/root/resData/resForm/suply_item" style="left:328px; top:439px; width:115px; height:18px; "/>
				<output id="output31" ref="/root/resData/resForm/demand_addr" style="left:583px; top:414px; width:333px; height:18px; "/>
				<caption id="caption49" class="list_cap02" style="left:490px; top:435px; width:430px; height:26px; "/>
				<output id="output32" ref="/root/resData/resForm/demand_bizcond" style="left:583px; top:439px; width:140px; height:18px; word-wrap:none; "/>
				<caption id="caption50" class="list_cap03" style="left:485px; top:360px; width:95px; height:26px; ">등록번호</caption>
				<output id="output33" ref="/root/resData/resForm/demand_item" style="left:786px; top:439px; width:130px; height:18px; word-wrap:none; "/>
				<caption id="caption51" class="list_cap03" style="left:485px; top:385px; width:95px; height:26px; ">상호(법인명)</caption>
				<caption id="caption52" class="list_cap03" style="left:485px; top:410px; width:95px; height:26px; ">사업장 주소</caption>
				<caption id="caption53" class="list_cap03" style="left:485px; top:435px; width:95px; height:26px; ">업  태</caption>
				<output id="output34" ref="/root/resData/resForm/demand_ern" style="left:583px; top:364px; width:140px; height:18px; "/>
				<caption id="caption54" class="list_cap03" style="left:726px; top:385px; width:55px; height:26px; ">성명</caption>
				<output id="output35" ref="/root/resData/resForm/demand_dlco_nm" style="left:583px; top:389px; width:140px; height:18px; "/>
				<caption id="caption55" class="list_cap03" style="left:726px; top:435px; width:55px; height:26px; ">종목</caption>
				<caption id="caption99" class="list_cap02" style="left:461px; top:360px; width:26px; height:97px; "/>
				<caption id="caption100" class="list_cap03" style="left:461px; top:360px; width:26px; height:101px; ">
					<![CDATA[공
급
받
는
자]]>
				</caption>
				<output id="output36" ref="/root/resData/resForm/demand_presi_nm" style="left:786px; top:389px; width:130px; height:18px; "/>
				<output id="output25" ref="/root/resData/resForm/trust_addr" style="left:583px; top:524px; width:333px; height:18px; "/>
				<caption id="caption42" class="list_cap02" style="left:490px; top:545px; width:430px; height:26px; "/>
				<output id="output26" ref="/root/resData/resForm/trust_bizcond" style="left:583px; top:549px; width:140px; height:18px; word-wrap:none; "/>
				<caption id="caption43" class="list_cap03" style="left:485px; top:470px; width:95px; height:26px; ">등록번호</caption>
				<output id="output27" ref="/root/resData/resForm/trust_item" style="left:786px; top:549px; width:130px; height:18px; word-wrap:none; "/>
				<caption id="caption44" class="list_cap03" style="left:485px; top:495px; width:95px; height:26px; ">상호(법인명)</caption>
				<caption id="caption45" class="list_cap03" style="left:485px; top:520px; width:95px; height:26px; ">사업장 주소</caption>
				<caption id="caption46" class="list_cap03" style="left:485px; top:545px; width:95px; height:26px; ">업  태</caption>
				<output id="output28" ref="/root/resData/resForm/trust_ern" style="left:583px; top:474px; width:140px; height:18px; "/>
				<caption id="caption47" class="list_cap03" style="left:726px; top:495px; width:55px; height:26px; ">성명</caption>
				<output id="output29" ref="/root/resData/resForm/trust_dlco_nm" style="left:583px; top:499px; width:140px; height:18px; word-wrap:none; "/>
				<caption id="caption48" class="list_cap03" style="left:726px; top:545px; width:55px; height:26px; ">종목</caption>
				<caption id="caption56" class="list_cap02" style="left:461px; top:470px; width:26px; height:97px; "/>
				<caption id="caption57" class="list_cap03" style="left:461px; top:470px; width:26px; height:101px; ">
					<![CDATA[수

탁

자]]>
				</caption>
				<output id="output30" ref="/root/resData/resForm/trust_presi_nm" style="left:786px; top:499px; width:130px; height:18px; "/>
				<caption id="caption1" class="list_cap02" style="left:5px; top:470px; width:445px; height:26px; "/>
				<caption id="caption3" class="list_cap02" style="left:5px; top:495px; width:445px; height:26px; "/>
				<caption id="caption4" class="list_cap02" style="left:5px; top:520px; width:445px; height:26px; "/>
				<output id="out_vat_amt" ref="/root/resData/resForm/vat_amt" format="(-)#,###" appearance="output" style="left:328px; top:499px; width:110px; height:18px; text-align:right; "/>
				<input id="inp_make_dt" ref="/root/resData/resForm/make_dt" class="req" navindex="13" inputtype="date" format="yyyy-mm-dd" caption="작성일자" appearance="input" style="left:127px; top:474px; width:95px; height:18px; text-align:center; "/>
				<output id="out_suply_amt" ref="/root/resData/resForm/suply_amt" format="(-)#,###" appearance="output" style="left:127px; top:499px; width:140px; height:18px; text-align:right; "/>
				<output id="out_tot_amt" ref="/root/resData/resForm/tot_amt" format="(-)#,###" appearance="output" style="left:127px; top:524px; width:140px; height:18px; text-align:right; "/>
				<caption id="caption5" class="list_cap03" style="left:5px; top:470px; width:120px; height:26px; ">작성일자</caption>
				<caption id="caption7" class="list_cap03" style="left:5px; top:495px; width:120px; height:26px; ">공급가액</caption>
				<caption id="caption8" class="list_cap03" style="left:270px; top:495px; width:55px; height:26px; ">세액</caption>
				<caption id="caption9" class="list_cap03" style="left:5px; top:520px; width:120px; height:26px; ">합계</caption>
				<group id="srch_group" style="left:0px; top:5px; width:926px; height:65px; ">
					<caption id="caption2" class="list_cap02" style="left:5px; top:5px; width:915px; height:28px; "/>
					<caption id="caption85" class="list_cap02" style="left:5px; top:32px; width:915px; height:28px; "/>
					<input id="inp_frdt" ref="/root/reqData/searchData/frdt" class="req" navindex="2" inputtype="date" format="yyyy-mm-dd" caption="게재기간" style="left:549px; top:10px; width:85px; height:18px; text-align:center; "/>
					<input id="inp_todt" ref="/root/reqData/searchData/todt" class="req" navindex="3" inputtype="date" format="yyyy-mm-dd" caption="게재기간" style="left:659px; top:10px; width:90px; height:18px; text-align:center; "/>
					<caption id="caption40" style="left:639px; top:11px; width:15px; height:17px; text-align:center; ">~</caption>
					<caption id="caption41" class="list_cap01" style="left:5px; top:32px; width:85px; height:28px; ">광고주</caption>
					<input id="inp_dlco_no" ref="/root/reqData/searchData/dlco_no" navindex="5" autonext="false" format="99999999" caption="광고주" style="left:94px; top:37px; width:55px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								var dlco_no = inp_dlco_no.currentText;
								model.setValue("/root/reqData/searchData/dlco_no", lpad(dlco_no, 8, "0"));
								inp_dlco_no.refresh();
								commonSubmission("9004", inp_dlco_no.currentText, inp_dlco_no, inp_dlco_nm);	
								
								setDemandInfo(inp_dlco_no.currentText);
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
								if( event.keyCode == "13" )
								{
									var dlco_no = inp_dlco_no.currentText;
									model.setValue("/root/reqData/searchData/dlco_no", lpad(dlco_no, 8, "0"));
									inp_dlco_no.refresh();
									commonSubmission("9004", inp_dlco_no.currentText, inp_dlco_no, inp_dlco_nm);	
									
									setDemandInfo(inp_dlco_no.currentText);
								}
							]]>
						</script>
					</input>
					<input id="inp_dlco_nm" ref="/root/reqData/searchData/dlco_nm" navindex="6" imemode="hangul" inputtype="button" caption="광고주" style="left:154px; top:37px; width:200px; height:18px; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText);
								setDemandInfo(inp_dlco_no.currentText);
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
								if( event.keyCode == "13" )
								{
									findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
									var chk_cnt = Number(model.getValue("/root/tempData/resData/chk_cnt"));
									if( chk_cnt == 1 )
									{
										setDemandInfo(inp_dlco_no.currentText);
									}
									else if( chk_cnt == 0 )
									{
										clearDemandInfo();
									}
//									else
//									{
//										showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText);
//									}
								}						
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
								var chk_cnt = Number(model.getValue("/root/tempData/resData/chk_cnt"));
								if( chk_cnt == 1 )
								{
									setDemandInfo(inp_dlco_no.currentText);
								}
								else if( chk_cnt == 0 )
								{
									clearDemandInfo();
								}
							]]>
						</script>
					</input>
					<input id="inp_agn_nm" ref="/root/reqData/searchData/agn_nm" navindex="8" imemode="hangul" inputtype="button" caption="대행사" style="left:609px; top:37px; width:200px; height:18px; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								showAdvcsSearchPopup("", "", "Y", "", "", inp_agn_nm.currentText); 						
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
								if(event.keyCode == "13"){
	//								showAdvcsSearchPopup("", "", "Y", "", "", inp_agn_nm.currentText); 	
									findDlcoNoByName("2", inp_agn_nm.currentText, inp_agn, inp_agn_nm);	
									var chk_cnt = Number(model.getValue("/root/tempData/resData/chk_cnt"));
									if(chk_cnt == 1)
									{
										setTrustInfo();
									}					
								}																			
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							findDlcoNoByName("2", inp_agn_nm.currentText, inp_agn, inp_agn_nm);
							var chk_cnt = Number(model.getValue("/root/tempData/resData/chk_cnt"));
							if(chk_cnt == 1){
								setTrustInfo();
							}
							]]>
						</script>
					</input>
					<input id="inp_agn" ref="/root/reqData/searchData/agn" navindex="7" autonext="false" format="99999999" caption="대행사" style="left:549px; top:37px; width:55px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							setTrustInfo();								
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode == "13"){
								setTrustInfo();	
							}
							]]>
						</script>
					</input>
					<caption id="caption37" class="list_cap01" style="left:459px; top:32px; width:85px; height:28px; ">대행사</caption>
					<caption id="caption38" class="list_cap01" style="left:5px; top:5px; width:85px; height:28px; ">매체구분</caption>
					<caption id="caption39" class="list_cap01" style="left:459px; top:5px; width:85px; height:28px; ">게재기간</caption>
					<select1 id="cb_medi_cd" ref="/root/reqData/searchData/medi_cd" class="req" navindex="1" appearance="minimal" caption="매체구분" style="left:93px; top:10px; width:110px; height:18px; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/medi_cd/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								cb_slip_clsf_cd.select(0); //2012.01.19
								cb_slip_clsf_cd.refresh(); //2012.01.19
							]]>
						</script>
					</select1>
					<select1 id="cb_dt_clsf1" ref="/root/reqData/searchData/dt_clsf" navindex="4" appearance="minimal" style="left:755px; top:10px; width:67px; height:18px; ">
						<choices>
							<item>
								<label>당일</label>
								<value>01</value>
							</item>
							<item>
								<label>당월</label>
								<value>02</value>
							</item>
							<item>
								<label>전월</label>
								<value>03</value>
							</item>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
					
							var currentdt = getCurrentDate();
							var currentmt = getCurrentMonth();				
										
							var dt_clsf = model.getValue("/root/reqData/searchData/dt_clsf"); //선택한 콤보박스 값..
											
							if(dt_clsf == "01"){  
								var frdt = dateAdd("d", 0, currentdt);	//당일
								var todt = dateAdd("d",0, currentdt);	//당일
								
								model.setValue("/root/reqData/searchData/frdt", frdt); 
								model.setValue("/root/reqData/searchData/todt", todt); 
							}else if(dt_clsf == "02"){
								var frdt = currentdt.substring(0,6)+"01"; //당월의 1일부터
								var todt = dateAdd("d",0, currentdt);	//당월의 현재일 
								
								model.setValue("/root/reqData/searchData/frdt", frdt); 
								model.setValue("/root/reqData/searchData/todt", todt); 
							}else if(dt_clsf == "03") {
								var frdt = dateAdd("m", -1, currentmt+"01");
								var pre_month = frdt.substring(0,6);
								var todt = pre_month+commLastDay(pre_month); 	//전월의 말일 
								
								model.setValue("/root/reqData/searchData/frdt", frdt); 
								model.setValue("/root/reqData/searchData/todt", todt);
							}	
							//alert(model.getValue("/root/resData/upload_yn"));
							if( model.getValue("/root/resData/resForm/upload_yn") != "Y" )
							{
								var	make_dt	=	todt.substring(0,6) + "" + commLastDay(todt);							
								model.setValue("/root/resData/resForm/make_dt",make_dt);
								inp_make_dt.refresh();
							}
							
							model.refresh();
							
						]]>
						</script>
					</select1>
					<output id="oup_upload_dlco_no" ref="/root/resData/resForm/upload_dlco_no" navindex="5" visibility="hidden" format="99999999" caption="광고주" autonext="false" appearance="output" style="left:380px; top:37px; width:55px; height:18px; text-align:center; "/>
					<output id="oup_upload_agn_no" ref="/root/resData/resForm/upload_agn_no" navindex="5" visibility="hidden" format="99999999" caption="광고주" autonext="false" appearance="output" style="left:840px; top:37px; width:55px; height:18px; text-align:center; "/>
				</group>
				<output id="output1" ref="/root/resData/resForm/demand_dlco_no" visibility="hidden" style="left:733px; top:364px; width:100px; height:18px; "/>
				<output id="output2" ref="/root/resData/resForm/trust_dlco_no" visibility="hidden" style="left:735px; top:474px; width:100px; height:18px; "/>
				<output id="output17" ref="/root/resData/resForm/setoff_yn" style="left:771px; top:329px; width:25px; height:18px; text-align:center; "/>
				<output id="output18" ref="/root/resData/resForm/canc_yn" style="left:890px; top:329px; width:25px; height:18px; text-align:center; "/>
				<caption id="cpt_upload_suply_amt" class="list_cap03" style="left:5px; top:545px; width:120px; height:26px; ">반입 공급가액</caption>
				<output id="opt_upload_suply_amt" ref="/root/resData/resForm/upload_suply_amt" format="(-)#,###" appearance="output" style="left:127px; top:549px; width:140px; height:18px; text-align:right; "/>
				<caption id="cpt_upload_vat_amt" class="list_cap03" style="left:270px; top:545px; width:55px; height:26px; ">세액</caption>
				<output id="opt_upload_vat_amt" ref="/root/resData/resForm/upload_vat_amt" format="(-)#,###" appearance="output" style="left:328px; top:549px; width:110px; height:18px; text-align:right; "/>
				<caption id="cpt_upload_yn" class="list_cap03" visibility="hidden" style="left:560px; top:325px; width:80px; height:26px; ">반입여부</caption>
				<output id="opt_upload_yn" ref="/root/resData/resForm/upload_yn" visibility="hidden" style="left:646px; top:329px; width:25px; height:18px; text-align:center; "/>
				<caption id="cpt_upload_make_dt" class="list_cap03" style="left:225px; top:470px; width:120px; height:26px; ">반입작성일자</caption>
				<input id="inp_upload_make_dt" ref="/root/resData/resForm/upload_make_dt" class="req" disabled="true" navindex="13" visibility="visible" inputtype="date" format="yyyy-mm-dd" caption="작성일자" appearance="input" style="left:348px; top:474px; width:95px; height:18px; text-align:center; "/>
			</case>
			<case id="case2" selected="true" style="left:0px; top:0px; width:926px; height:628px; ">
				<caption id="caption68" class="list_cap02" style="left:29px; top:385px; width:420px; height:26px; "/>
				<caption id="caption67" class="list_cap02" style="left:490px; top:435px; width:430px; height:26px; "/>
				<caption id="caption66" class="list_cap02" style="left:29px; top:360px; width:420px; height:26px; "/>
				<caption id="caption71" class="list_cap02" style="left:29px; top:410px; width:420px; height:26px; "/>
				<caption id="caption70" class="list_cap02" style="left:490px; top:360px; width:430px; height:26px; "/>
				<caption id="caption76" class="list_cap02" style="left:5px; top:325px; width:915px; height:26px; "/>
				<datagrid id="datagrid2" nodeset="/root/resData2/gridData/record" caption="선택^매체^게재일자^전표번호^광고주코드^광고주^광고료^부가세^sale_stmt_issu_yn" colsep="#" colwidth="50, 77, 100, 147, 135, 186, 90, 90, 100" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:5px; top:70px; width:915px; height:240px; ">
					<col checkvalue="Y,N" ref="checked" type="checkbox"/>
					<col ref="medi_nm" style="text-align:left; "/>
					<col ref="pubc_dt" format="yyyy-mm-dd"/>
					<col ref="pubc_slip_no" format="999-99999999-9999" style="text-align:center; "/>
					<col ref="dlco_no"/>
					<col ref="dlco_nm" style="text-align:left; "/>
					<col ref="advt_fee" format="#,###" style="text-align:right; "/>
					<col ref="vat" format="#,###" style="text-align:right; "/>
					<col ref="sale_stmt_issu_yn" visibility="hidden"/>
					<script type="javascript" ev:event="xforms-select">
						<![CDATA[
						
						if(isDataRegion(datagrid2)){
							
							var selected_dlco_no =	datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("dlco_no"));
							
							for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
								var checked = datagrid2.valueMatrix(i, datagrid2.colRef("checked"));
								if(checked == "Y"){
									var dlco_no = datagrid2.valueMatrix(i, datagrid2.colRef("dlco_no"));
									if(selected_dlco_no != dlco_no){
										alert("같은 광고주를 선택해야 합니다.");
									 	datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("checked")) = "N";
										datagrid2.rowStatus(datagrid2.row) = "0";
										datagrid2.refresh();
										return;
									}
								}
							}
											

							var	pubc_dt	=	datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("pubc_dt"));
							
							for(var i=datagrid2.fixedRows; i<datagrid2.rows; i++){
								var	checked		=	datagrid2.valueMatrix(i, datagrid2.colRef("checked"));
								var tmp_pubc_dt	= 	datagrid2.valueMatrix(i, datagrid2.colRef("pubc_dt"));
//								if(checked == "Y"){
//									if(pubc_dt.substring(0,6) != tmp_pubc_dt.substring(0,6)){
//										alert("다른 달을 선택할 수 없습니다. = " + pubc_dt + ", " + tmp_pubc_dt);
//										datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("checked")) = "N";
//										datagrid2.rowStatus(datagrid2.row) = "0";
//										datagrid2.refresh();
//										return;
//									}	
//								}
							}
							
//							var agn = model.getValue("/root/resData2/gridData/record["+row+"]/agn");
						
//							setTrustInfo2(agn);
						
							resetSuplyAmt();
							
							datagrid2.addStatus(datagrid2.row, "update");
							
							datagrid2.refresh();
						}else{
							
							if(datagrid2.rows == datagrid2.fixedRows){
								alert("선택할 대상이 없습니다. 게재조회를 먼저하세요.");								
								datagrid2.fixedcellischeck(0, datagrid2.colRef("checked")) = false;
								return;
							}
							
							var	pre_pubc_dt	=	"";
							var	pre_dlco_no 	= 	"";
							for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
								var dlco_no 	= 	datagrid2.valueMatrix(i, datagrid2.colRef("dlco_no"));
								var	pubc_dt	=	datagrid2.valueMatrix(i, datagrid2.colRef("pubc_dt"));
								if(pre_dlco_no != "" && pre_dlco_no != dlco_no){
									alert("같은 광고주를 선택해야 합니다.");
									for(var j=datagrid2.fixedRows;j<datagrid2.rows;j++){
									 	datagrid2.valueMatrix(j, datagrid2.colRef("checked")) = "N";		
									 	datagrid2.rowStatus(j) = "0";
									}
								 	
									datagrid2.fixedcellischeck(0, datagrid2.colRef("checked")) = false;
									return;
								}
								
								var	pubc_dt	=	datagrid2.valueMatrix(i, datagrid2.colRef("pubc_dt"));
//								if(pre_pubc_dt != "" && pre_pubc_dt.substring(0,6) != pubc_dt.substring(0,6)){
//									alert("다른 달을 선택할 수 없습니다.");
//									for(var j=datagrid2.fixedRows;j<datagrid2.rows;j++){
//									 	datagrid2.valueMatrix(j, datagrid2.colRef("checked")) = "N";		
//									 	datagrid2.rowStatus(j) = "0";
//									}
//								 	
//									datagrid2.fixedcellischeck(0, datagrid2.colRef("checked")) = false;
//									return;
//								}
								
								pre_dlco_no = dlco_no;
								pre_pubc_dt = pubc_dt;
							}
							
							for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
								var sale_stmt_issu_yn 	= 	datagrid2.valueMatrix(i, datagrid2.colRef("sale_stmt_issu_yn"));
								if(sale_stmt_issu_yn == "Y"){
								 	datagrid2.valueMatrix(i, datagrid2.colRef("checked")) = "N";		
								 	datagrid2.rowStatus(i) = "0";
								}
							}
							datagrid2.refresh();
							
							resetSuplyAmt();
						}

							
						var checked_cnt		=	0;
						var 	make_dt			=	model.getValue("/root/resData2/resForm/make_dt");
						var	max_pubc_dt		=	"";
						for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
							var checked	=	datagrid2.valueMatrix(i, datagrid2.colRef("checked"));
							var pubc_dt	=	datagrid2.valueMatrix(i, datagrid2.colRef("pubc_dt"));
							
							if(checked == "Y"){
								if(pubc_dt	>	max_pubc_dt){
									max_pubc_dt	=	pubc_dt;
								}
								checked_cnt++;
							}
						}						
						
//						var	pubc_yymm = max_pubc_dt.substring(0,6);
//						max_pubc_dt   = pubc_yymm + commLastDay(pubc_yymm);

						if(checked_cnt > 1){
							max_pubc_dt = max_pubc_dt.substring(0,6) + "" + commLastDay(max_pubc_dt);
						}
						
						model.setValue("/root/resData2/resForm/make_dt", max_pubc_dt);
						inp_make_dt2.refresh();								
																					
						
						]]>
					</script>
					<script type="javascript" ev:event="xforms-deselect">
						<![CDATA[
							datagrid2.removeStatus(datagrid2.row,"update");
						
							resetSuplyAmt();
							
							datagrid2.refresh();
							
							var checked_cnt		=	0;
							var 	make_dt			=	model.getValue("/root/resData2/resForm/make_dt");
							var	max_pubc_dt		=	"";
							for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
								var checked	=	datagrid2.valueMatrix(i, datagrid2.colRef("checked"));
								var pubc_dt	=	datagrid2.valueMatrix(i, datagrid2.colRef("pubc_dt"));
								
								if(checked == "Y"){
									if(pubc_dt	>	max_pubc_dt){
										max_pubc_dt	=	pubc_dt;
									}
									checked_cnt++;
								}
							}					
/*						
							var	pubc_yymm = max_pubc_dt.substring(0,6);
							max_pubc_dt = pubc_yymm + commLastDay(pubc_yymm);
*/								

							if(checked_cnt > 1){
								max_pubc_dt = max_pubc_dt.substring(0,6) + "" + commLastDay(max_pubc_dt);
							}
														
							model.setValue("/root/resData2/resForm/make_dt", max_pubc_dt);
							inp_make_dt2.refresh();								
													
														
						]]>
					</script>
				</datagrid>
				<input id="inp_slip_occr_dt2" ref="/root/resData2/resForm/slip_occr_dt" navindex="10" inputtype="date" style="left:349px; top:329px; width:90px; height:18px; "/>
				<caption id="caption73" class="list_cap03" style="left:5px; top:325px; width:120px; height:26px; ">세금계산서번호</caption>
				<caption id="caption74" class="list_cap03" style="left:726px; top:325px; width:55px; height:26px; ">취소여부</caption>
				<caption id="caption75" class="list_cap03" style="left:486px; top:325px; width:95px; height:26px; ">수정사유</caption>
				<select1 id="cb_prof_type_cd2" ref="/root/resData2/resForm/prof_type_cd" navindex="8" appearance="minimal" style="left:129px; top:329px; width:130px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/prof_type_cd2/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<select1 id="cb_slip_clsf_cd2" ref="/root/resData2/resForm/slip_clsf_cd" disabled="true" navindex="9" appearance="minimal" style="left:264px; top:329px; width:80px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/cb_slip_clsf_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<input id="inp_slip_seq2" ref="/root/resData2/resForm/slip_seq" navindex="11" format="9999" style="left:444px; top:329px; width:35px; height:18px; ">
					<script type="javascript" ev:event="DOMFocusOut">
						<![CDATA[
						var slip_seq = model.getValue("/root/resData2/resForm/slip_seq");
						if(slip_seq != ""){
							model.setValue("/root/resData2/resForm/slip_seq", lpad(slip_seq, 4, "0"));
							inp_slip_seq2.refresh();	
						}									
						]]>
					</script>
				</input>
				<select1 id="combo12" ref="/root/resData2/resForm/re_issu_resn_cd" navindex="12" appearance="minimal" style="left:583px; top:329px; width:135px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/re_issu_resn_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						var resn_cd = model.getValue("/root/resData2/resForm/re_issu_resn_cd");
						var make_dt = model.getValue("/root/resData2/resForm/make_dt");
						model.makeNode("/root/resData2/resForm/remk");
						model.makeNode("/root/resData2/resForm/make_dt2");
						model.setValue("/root/resData2/resForm/make_dt2",getCurrentDate());
						//(-)세금계산서 작성일자 초기값 세팅 
						if(resn_cd == "01"){//기재사항의 착오/정정 ==> 작성일:당초 세금계산서 작성일
							inp_make_dt21.visible = false;
							cap_make_dt21.visible = false;
						}
					    else if(resn_cd == "02"){//공급가액 변동 ==> 작성일:변동 사유 발생일,비고:당초 세금계산서 교부일
							inp_make_dt21.visible = true;
							cap_make_dt21.visible = true;
							model.setValue("/root/resData2/resForm/remk",make_dt);
							model.setValue("/root/resData2/resForm/make_dt2",make_dt);
							model.refresh();
							//model.setValue("/root/resData2/resForm/make_dt",getCurrentDate());
						}
						else if(resn_cd == "03"){//환입 ==> 작성일:환입된날,비고:당초 세금계산서 작성일
							inp_make_dt21.visible = true;
							cap_make_dt21.visible = true;
							model.setValue("/root/resData2/resForm/remk",make_dt);
							model.setValue("/root/resData2/resForm/make_dt2",make_dt);
							model.refresh();
						}
						else if(resn_cd == "04"){//계약의 해제 ==> 작성일:계약해제일,비고:계약해제일
							inp_make_dt21.visible = true;
							cap_make_dt21.visible = true;
							model.setValue("/root/resData2/resForm/remk",make_dt);
							model.setValue("/root/resData2/resForm/make_dt2",make_dt);
							model.refresh();
						}
						else if(resn_cd == "05"){//내국신용장사후개설 ==> 작성일:당초 세금계산서 작성일,비고:내국신용장개설일
							inp_make_dt21.visible = false;
							cap_make_dt21.visible = false;
						}
						
						]]>
					</script>
				</select1>
				<output id="output5" ref="/root/resData2/resForm/issu_tms" style="left:880px; top:329px; width:35px; height:18px; text-align:center; "/>
				<caption id="caption77" class="list_cap03" style="left:820px; top:325px; width:55px; height:26px; ">발행회수</caption>
				<caption id="caption12" class="list_cap02" style="left:490px; top:385px; width:430px; height:26px; "/>
				<caption id="caption15" class="list_cap02" style="left:29px; top:435px; width:420px; height:26px; "/>
				<output id="output6" ref="/root/resData2/resForm/suply_addr" style="left:127px; top:414px; width:318px; height:18px; "/>
				<caption id="caption16" class="list_cap02" style="left:490px; top:410px; width:430px; height:26px; "/>
				<caption id="caption17" class="list_cap03" style="left:29px; top:360px; width:95px; height:26px; ">등록번호</caption>
				<output id="output7" ref="/root/resData2/resForm/suply_bizcond" style="left:127px; top:439px; width:140px; height:18px; "/>
				<output id="output8" ref="/root/resData2/resForm/demand_addr" style="left:583px; top:414px; width:332px; height:18px; "/>
				<caption id="caption18" class="list_cap03" style="left:29px; top:385px; width:95px; height:26px; ">상호(법인명)</caption>
				<output id="output9" ref="/root/resData2/resForm/suply_item" style="left:330px; top:439px; width:115px; height:18px; "/>
				<output id="output10" ref="/root/resData2/resForm/demand_bizcond" style="left:583px; top:439px; width:140px; height:18px; word-wrap:none; "/>
				<caption id="caption19" class="list_cap03" style="left:485px; top:360px; width:95px; height:26px; ">등록번호</caption>
				<caption id="caption20" class="list_cap03" style="left:29px; top:410px; width:95px; height:26px; ">사업장 소재지</caption>
				<output id="output11" ref="/root/resData2/resForm/demand_item" style="left:786px; top:439px; width:130px; height:18px; word-wrap:none; "/>
				<caption id="caption26" class="list_cap03" style="left:485px; top:385px; width:95px; height:26px; ">상호(법인명)</caption>
				<output id="output12" ref="/root/resData2/resForm/suply_ern" style="left:127px; top:364px; width:140px; height:18px; text-align:left; "/>
				<caption id="caption27" class="list_cap03" style="left:29px; top:435px; width:95px; height:26px; ">업  태</caption>
				<caption id="caption28" class="list_cap03" style="left:485px; top:410px; width:95px; height:26px; ">사업장 주소</caption>
				<output id="output13" ref="/root/resData2/resForm/demand_ern" style="left:583px; top:364px; width:140px; height:18px; text-align:left; "/>
				<output id="output14" ref="/root/resData2/resForm/suply_dlco_nm" style="left:127px; top:389px; width:140px; height:18px; "/>
				<caption id="caption29" class="list_cap03" style="left:270px; top:385px; width:55px; height:26px; ">성명</caption>
				<caption id="caption30" class="list_cap03" style="left:485px; top:435px; width:95px; height:26px; ">업  태</caption>
				<output id="output15" ref="/root/resData2/resForm/demand_dlco_nm" style="left:583px; top:389px; width:140px; height:18px; word-wrap:none; "/>
				<caption id="caption31" class="list_cap03" style="left:270px; top:435px; width:55px; height:26px; ">종목</caption>
				<caption id="caption32" class="list_cap03" style="left:726px; top:385px; width:55px; height:26px; ">성명</caption>
				<output id="output16" ref="/root/resData2/resForm/demand_presi_nm" style="left:786px; top:389px; width:130px; height:18px; word-wrap:none; "/>
				<caption id="caption34" class="list_cap02" style="left:5px; top:360px; width:26px; height:97px; "/>
				<caption id="caption63" class="list_cap03" style="left:726px; top:435px; width:55px; height:26px; ">종목</caption>
				<caption id="caption64" class="list_cap02" style="left:461px; top:360px; width:26px; height:97px; "/>
				<caption id="caption65" class="list_cap03" style="left:5px; top:360px; width:26px; height:101px; ">
					<![CDATA[공

급

자]]>
				</caption>
				<caption id="caption69" class="list_cap03" style="left:461px; top:360px; width:26px; height:101px; ">
					<![CDATA[공
급
받
는
자]]>
				</caption>
				<output id="output20" ref="/root/resData2/resForm/suply_presi_nm" style="left:330px; top:389px; width:115px; height:18px; "/>
				<caption id="caption109" class="list_cap02" style="left:5px; top:470px; width:445px; height:26px; "/>
				<caption id="caption110" class="list_cap02" style="left:5px; top:520px; width:445px; height:26px; "/>
				<caption id="caption111" class="list_cap02" style="left:5px; top:545px; width:445px; height:26px; "/>
				<caption id="caption112" class="list_cap03" style="left:5px; top:470px; width:120px; height:26px; ">작성일자</caption>
				<caption id="caption113" class="list_cap03" style="left:5px; top:520px; width:120px; height:26px; ">공급가액</caption>
				<input id="inp_make_dt2" ref="/root/resData2/resForm/make_dt" class="req" navindex="13" inputtype="date" format="yyyy-mm-dd" appearance="input" style="left:127px; top:474px; width:100px; height:18px; text-align:center; "/>
				<caption id="caption114" class="list_cap03" style="left:270px; top:520px; width:55px; height:26px; ">세액</caption>
				<output id="out_vat_amt2" ref="/root/resData2/resForm/vat_amt" format="(-)#,###" appearance="output" style="left:330px; top:524px; width:115px; height:18px; text-align:right; "/>
				<caption id="caption115" class="list_cap03" style="left:5px; top:545px; width:120px; height:26px; ">합계</caption>
				<output id="out_suply_amt2" ref="/root/resData2/resForm/suply_amt" format="(-)#,###" appearance="output" style="left:127px; top:524px; width:140px; height:18px; text-align:right; "/>
				<output id="out_tot_amt2" ref="/root/resData2/resForm/tot_amt" format="(-)#,###" appearance="output" style="left:127px; top:549px; width:140px; height:18px; text-align:right; "/>
				<caption id="caption116" class="list_cap02" style="left:5px; top:495px; width:445px; height:26px; "/>
				<caption id="caption117" class="list_cap03" style="left:5px; top:495px; width:120px; height:26px; ">품목</caption>
				<input id="inp_tax_item" ref="/root/resData2/resForm/tax_item" navindex="14" imemode="hangul" style="left:127px; top:499px; width:138px; height:18px; "/>
				<output id="output3" ref="/root/resData2/resForm/demand_dlco_no" visibility="hidden" style="left:435px; top:475px; width:10px; height:18px; "/>
				<group id="srch_group2" style="left:5px; top:10px; width:916px; height:55px; ">
					<caption id="caption11" class="list_cap02" style="left:0px; top:27px; width:915px; height:28px; "/>
					<input id="input1" ref="/root/reqData2/searchData/user_id" navindex="6" visibility="hidden" autonext="false" imemode="hangul" style="left:309px; top:32px; width:241px; height:18px; text-align:left; "/>
					<caption id="caption72" class="list_cap01" visibility="hidden" style="left:219px; top:27px; width:85px; height:28px; ">아이디</caption>
					<caption id="caption10" class="list_cap02" style="left:0px; top:0px; width:915px; height:28px; "/>
					<caption id="caption61" style="left:399px; top:6px; width:15px; height:17px; text-align:center; ">~</caption>
					<caption id="caption62" class="list_cap01" style="left:219px; top:27px; width:85px; height:28px; ">광고주</caption>
					<input id="inp_frdt2" ref="/root/reqData2/searchData/frdt" class="req" navindex="2" inputtype="date" caption="게재기간" style="left:309px; top:5px; width:85px; height:18px; text-align:center; "/>
					<input id="inp_dlco_no2" ref="/root/reqData2/searchData/dlco_no" navindex="6" autonext="false" format="99999999" caption="광고주" style="left:309px; top:32px; width:55px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								setDemandInfo2();								
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
								if(event.keyCode == "13")
								{
									setDemandInfo2();	
								}
							]]>
						</script>
					</input>
					<input id="inp_todt2" ref="/root/reqData2/searchData/todt" class="req" navindex="3" inputtype="date" format="yyyy-mm-dd" caption="게재기간" style="left:419px; top:5px; width:90px; height:18px; text-align:center; "/>
					<input id="inp_dlco_nm2" ref="/root/reqData2/searchData/dlco_nm" navindex="7" imemode="hangul" inputtype="button" caption="광고주" style="left:373px; top:32px; width:200px; height:18px; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm2.currentText); 
								setDemandInfo2();
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
								if( event.keyCode == "13" )
								{
									findDlcoNoByName("1", inp_dlco_nm2.currentText, inp_dlco_no2, inp_dlco_nm2);
	/*								
									var dlco_clsf = model.getValue("/root/reqData2/searchData/dlco_clsf_cd");
									if(dlco_clsf == "1" || dlco_clsf == "3"){
										findDlcoNoByName("1", inp_dlco_nm2.currentText, inp_dlco_no2, inp_dlco_nm2);
									}else{
										findDlcoNoByName("4", inp_dlco_nm2.currentText, inp_dlco_no2, inp_dlco_nm2);
									}
	*/								
									var chk_cnt = Number(model.getValue("/root/tempData/resData/chk_cnt"));
									if( chk_cnt == 1 )
									{
										setDemandInfo2();
									}
									else if( chk_cnt == 0 )
									{
										clearDemandInfo2();
									}
//									else
//									{
//										showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm2.currentText);
//									}
								}
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								findDlcoNoByName("1", inp_dlco_nm2.currentText, inp_dlco_no2, inp_dlco_nm2);
/*								
								var dlco_clsf = model.getValue("/root/reqData2/searchData/dlco_clsf_cd");
								if(dlco_clsf == "1" || dlco_clsf == "3"){
									findDlcoNoByName("1", inp_dlco_nm2.currentText, inp_dlco_no2, inp_dlco_nm2);
								}else{
									findDlcoNoByName("4", inp_dlco_nm2.currentText, inp_dlco_no2, inp_dlco_nm2);
								}
*/								
								var chk_cnt = Number(model.getValue("/root/tempData/resData/chk_cnt"));
								if( chk_cnt == 1 )
								{
									setDemandInfo2();
								}
								else if( chk_cnt == 0 )
								{
									clearDemandInfo2();
								}						
							]]>
						</script>
					</input>
					<caption id="caption13" class="list_cap01" style="left:0px; top:0px; width:85px; height:28px; ">매체구분</caption>
					<caption id="caption14" class="list_cap01" style="left:219px; top:0px; width:85px; height:28px; ">게재기간</caption>
					<select1 id="cb_medi_cd2" ref="/root/reqData2/searchData/medi_cd" class="req" navindex="1" appearance="minimal" caption="매체구분" style="left:88px; top:5px; width:110px; height:18px; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/medi_cd2/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								cb_slip_clsf_cd2.select(0); //2012.01.19
								cb_slip_clsf_cd2.refresh(); //2012.01.19
							]]>
						</script>
					</select1>
					<caption id="caption21" class="list_cap01" style="left:0px; top:27px; width:85px; height:28px; ">거래처구분</caption>
					<select1 id="cb_dlco_clsf_cd" ref="/root/reqData2/searchData/hndl_clsf" class="req" navindex="5" appearance="minimal" caption="거래처구분" style="left:88px; top:32px; width:110px; height:18px; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/hndl_clsf/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							var hndl_clsf = model.getValue("/root/reqData2/searchData/hndl_clsf");
							if(hndl_clsf == "10"){
								caption72.visible = true;
								input1.visible = true;
								caption62.visible = false;
								inp_dlco_no2.visible = false;
								inp_dlco_nm2.visible = false;
							}else{
								caption72.visible = false;
								input1.visible = false;
								caption62.visible = true;
								inp_dlco_no2.visible = true;
								inp_dlco_nm2.visible = true;
							}
							]]>
						</script>
					</select1>
					<select1 id="cb_dt_clsf2" ref="/root/reqData2/searchData/dt_clsf" navindex="4" appearance="minimal" style="left:513px; top:5px; width:67px; height:18px; ">
						<choices>
							<item>
								<label>당일</label>
								<value>01</value>
							</item>
							<item>
								<label>당월</label>
								<value>02</value>
							</item>
							<item>
								<label>전월</label>
								<value>03</value>
							</item>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
					
					var currentdt = getCurrentDate();
					var currentmt = getCurrentMonth();				
								
					var dt_clsf = model.getValue("/root/reqData2/searchData/dt_clsf"); //선택한 콤보박스 값..
									
					if(dt_clsf == "01"){  
						var frdt = dateAdd("d", 0, currentdt);	//당일
						var todt = dateAdd("d",0, currentdt);	//당일
						
						model.setValue("/root/reqData2/searchData/frdt", frdt); 
						model.setValue("/root/reqData2/searchData/todt", todt); 
					}else if(dt_clsf == "02"){
						var frdt = currentdt.substring(0,6)+"01"; //당월의 1일부터
						var todt = dateAdd("d",0, currentdt);	//당월의 현재일 
						
						model.setValue("/root/reqData2/searchData/frdt", frdt); 
						model.setValue("/root/reqData2/searchData/todt", todt); 
					}else if(dt_clsf == "03") {
						var frdt = dateAdd("m", -1, currentmt+"01");
						var pre_month = frdt.substring(0,6);
						var todt = pre_month+commLastDay(pre_month); 	//전월의 말일 
						
						model.setValue("/root/reqData2/searchData/frdt", frdt); 
						model.setValue("/root/reqData2/searchData/todt", todt);
					}	
				
					var	make_dt	=	todt.substring(0,6) + "" + commLastDay(todt);
					
					model.setValue("/root/resData2/resForm/make_dt",make_dt);
					inp_make_dt2.refresh();
					
					model.refresh();
					
				]]>
						</script>
					</select1>
					<caption id="caption22" class="list_cap01" style="left:585px; top:27px; width:85px; height:28px; ">관리담당</caption>
					<input id="inp_mchrg_pers" ref="/root/reqData2/searchData/chrg_pers" imemode="disabled" style="left:674px; top:32px; width:65px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							commonSubmission("9005", inp_mchrg_pers.currentText,  inp_mchrg_pers, inp_mchrg_pers_nm);				
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode == "13"){
								commonSubmission("9005", inp_mchrg_pers.currentText,  inp_mchrg_pers, inp_mchrg_pers_nm);	
							}
							]]>
						</script>
					</input>
					<input id="inp_mchrg_pers_nm" ref="/root/reqData2/searchData/chrg_pers_nm" imemode="hangul" inputtype="button" style="left:742px; top:32px; width:90px; height:18px; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
							searchEmpno("setMchrgPers", "/root/reqData2/searchData/chrg_pers", "/root/reqData2/searchData/chrg_pers_nm");
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[							
							if(event.keyCode == "13"){
								findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);
							}		
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);
							]]>
						</script>
					</input>
					<select id="checkbox1" ref="/root/reqData2/searchData/advt_clas1" overflow="visible" appearance="full" style="left:595px; top:6px; width:65px; height:15px; border-style:none; ">
						<choices>
							<item>
								<label>행광고</label>
								<value>Y</value>
							</item>
						</choices>
					</select>
					<select id="checkbox2" ref="/root/reqData2/searchData/advt_clas2" overflow="visible" appearance="full" style="left:665px; top:6px; width:65px; height:15px; border-style:none; ">
						<choices>
							<item>
								<label>일반광고</label>
								<value>Y</value>
							</item>
						</choices>
					</select>
				</group>
				<output id="output4" ref="/root/resData2/resForm/canc_yn" style="left:788px; top:329px; width:25px; height:18px; text-align:center; "/>
				<caption id="caption25" class="list_cap03" style="left:726px; top:360px; width:55px; height:26px; ">종사업장</caption>
				<input id="inp_biz_plc" ref="/root/resData2/resForm/demand_biz_plc" format="9999" style="left:785px; top:364px; width:130px; height:18px; "/>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
						var biz_plc_cd = model.getValue("/root/resData2/resForm/demand_biz_plc");
						if(biz_plc_cd != ""){
							model.setValue("/root/resData2/resForm/demand_biz_plc", lpad(biz_plc_cd, 4, "0"));
							inp_biz_plc.refresh();	
						}									
						]]>
				</script>
				<input id="inp_remk" ref="/root/resData2/resForm/remk" style="left:330px; top:499px; width:115px; height:18px; "/>
				<input id="inp_make_dt21" ref="/root/resData2/resForm/make_dt2" class="req" navindex="14" inputtype="date" format="yyyy-mm-dd" appearance="input" style="left:331px; top:474px; width:100px; height:18px; text-align:center; "/>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var resn_cd = model.getValue("/root/resData2/resForm/re_issu_resn_cd");
						var make_dt = model.getValue("/root/resData2/resForm/make_dt");
						if(resn_cd == "04"){//계약의 해제 ==> 작성일:계약해제일,비고:계약해제일
							model.setValue("/root/resData2/resForm/remk",make_dt);
						}
						else if(resn_cd == "05"){//내국신용장사후개설 ==> 작성일:당초 세금계산서 작성일,비고:내국신용장개설일
						}
						
						]]>
				</script>
				<caption id="cap_make_dt21" class="list_cap03" style="left:270px; top:470px; width:55px; height:26px; ">(-)일자</caption>
				<caption id="caption143" class="list_cap03" style="left:270px; top:495px; width:55px; height:26px; ">비고</caption>
			</case>
			<case id="case3" disabled="true" style="left:0px; top:0px; width:926px; height:628px; ">
				<caption id="caption155" class="list_cap02" style="left:490px; top:495px; width:430px; height:26px; "/>
				<caption id="caption153" class="list_cap02" style="left:490px; top:470px; width:430px; height:26px; "/>
				<caption id="caption163" class="list_cap02" style="left:490px; top:360px; width:430px; height:26px; "/>
				<caption id="caption79" class="list_cap02" style="left:490px; top:385px; width:430px; height:26px; "/>
				<caption id="caption82" class="list_cap02" style="left:490px; top:520px; width:430px; height:26px; "/>
				<caption id="caption125" class="list_cap02" style="left:490px; top:545px; width:430px; height:26px; "/>
				<caption id="caption81" class="list_cap02" style="left:490px; top:410px; width:430px; height:26px; "/>
				<caption id="caption157" class="list_cap02" style="left:490px; top:435px; width:430px; height:26px; "/>
				<caption id="caption145" class="list_cap02" style="left:5px; top:545px; width:445px; height:26px; "/>
				<caption id="caption152" class="list_cap02" style="left:29px; top:360px; width:420px; height:26px; "/>
				<caption id="caption162" class="list_cap02" style="left:29px; top:410px; width:420px; height:26px; "/>
				<caption id="caption140" class="list_cap02" style="left:5px; top:520px; width:445px; height:26px; "/>
				<caption id="caption161" class="list_cap02" style="left:29px; top:385px; width:420px; height:26px; "/>
				<caption id="caption78" class="list_cap02" style="left:29px; top:435px; width:420px; height:26px; "/>
				<caption id="caption129" class="list_cap02" style="left:5px; top:470px; width:445px; height:26px; "/>
				<caption id="caption128" class="list_cap02" style="left:5px; top:325px; width:915px; height:26px; "/>
				<caption id="caption104" class="list_cap02" style="left:5px; top:495px; width:445px; height:26px; "/>
				<input id="inp_make_dt3" ref="/root/resData3/resForm/make_dt" class="req" navindex="13" inputtype="date" format="yyyy-mm-dd" caption="작성일자" appearance="input" style="left:127px; top:474px; width:95px; height:18px; text-align:center; "/>
				<output id="output21" ref="/root/resData3/resForm/trust_presi_nm" style="left:786px; top:499px; width:130px; height:18px; "/>
				<output id="output22" ref="/root/resData3/resForm/suply_addr" style="left:127px; top:414px; width:316px; height:18px; "/>
				<output id="output37" ref="/root/resData3/resForm/demand_addr" style="left:583px; top:414px; width:333px; height:18px; "/>
				<output id="output38" ref="/root/resData3/resForm/suply_bizcond" style="left:127px; top:439px; width:140px; height:18px; "/>
				<caption id="caption80" class="list_cap03" style="left:29px; top:360px; width:95px; height:26px; ">등록번호</caption>
				<output id="out_vat_amt3" ref="/root/resData3/resForm/vat_amt" format="(-)#,###" appearance="output" style="left:328px; top:524px; width:115px; height:18px; text-align:right; "/>
				<caption id="caption83" class="list_cap03" style="left:485px; top:360px; width:95px; height:26px; ">등록번호</caption>
				<output id="output40" ref="/root/resData3/resForm/demand_bizcond" style="left:583px; top:439px; width:140px; height:18px; word-wrap:none; "/>
				<output id="output41" ref="/root/resData3/resForm/suply_item" style="left:328px; top:439px; width:115px; height:18px; "/>
				<caption id="caption84" class="list_cap03" style="left:29px; top:385px; width:95px; height:26px; ">상호(법인명)</caption>
				<group id="srch_group3" style="left:0px; top:5px; width:926px; height:65px; ">
					<caption id="caption105" class="list_cap02" style="left:5px; top:5px; width:915px; height:28px; "/>
					<caption id="caption106" class="list_cap02" style="left:5px; top:32px; width:915px; height:28px; "/>
					<input id="inp_frdt3" ref="/root/reqData3/searchData/frdt" class="req" navindex="2" inputtype="date" format="yyyy-mm-dd" caption="게재기간" style="left:469px; top:10px; width:85px; height:18px; text-align:center; "/>
					<input id="inp_todt3" ref="/root/reqData3/searchData/todt" class="req" navindex="3" inputtype="date" format="yyyy-mm-dd" caption="게재기간" style="left:579px; top:10px; width:90px; height:18px; text-align:center; "/>
					<caption id="caption107" style="left:559px; top:11px; width:15px; height:17px; text-align:center; ">~</caption>
					<caption id="caption108" class="list_cap01" style="left:5px; top:32px; width:85px; height:28px; ">광고주</caption>
					<input id="inp_dlco_no3" ref="/root/reqData3/searchData/dlco_no" navindex="5" autonext="false" format="99999999" caption="광고주" style="left:94px; top:37px; width:55px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								var dlco_no = inp_dlco_no3.currentText;
								model.setValue("/root/reqData3/searchData/dlco_no", lpad(dlco_no, 8, "0"));
								inp_dlco_no3.refresh();
								
								commonSubmission("9004", inp_dlco_no3.currentText, inp_dlco_no3, inp_dlco_nm3);	
								
								setDemandInfo3(dlco_no);
							
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
								if( event.keyCode == "13" )
								{
									var dlco_no = inp_dlco_no3.currentText;
									model.setValue("/root/reqData3/searchData/dlco_no", lpad(dlco_no, 8, "0"));
									inp_dlco_no3.refresh();
									
									commonSubmission("9004", inp_dlco_no3.currentText, inp_dlco_no3, inp_dlco_nm3);	
									
									setDemandInfo3(dlco_no);	
								}
							]]>
						</script>
					</input>
					<input id="inp_dlco_nm3" ref="/root/reqData3/searchData/dlco_nm" navindex="6" imemode="hangul" inputtype="button" caption="광고주" style="left:154px; top:37px; width:200px; height:18px; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm3.currentText); 
								setDemandInfo3(inp_dlco_no3.currentText);					
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
								if( event.keyCode == "13" )
								{
									findDlcoNoByName("1", inp_dlco_nm3.currentText, inp_dlco_no3, inp_dlco_nm3);
									var chk_cnt = Number(model.getValue("/root/tempData/resData/chk_cnt"));
									if( chk_cnt == 1 )
									{
										setDemandInfo3(inp_dlco_no3.currentText);
									}
									else if( chk_cnt == 0 )
									{
										clearDemandInfo3();
									}
	//								showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText); 					
								}						
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								findDlcoNoByName("1", inp_dlco_nm3.currentText, inp_dlco_no3, inp_dlco_nm3);
								var chk_cnt = Number(model.getValue("/root/tempData/resData/chk_cnt"));
								if( chk_cnt == 1 )
								{
									setDemandInfo3(inp_dlco_no3.currentText);
								}
								else if( chk_cnt == 0 )
								{
									clearDemandInfo3();
								}
							]]>
						</script>
					</input>
					<input id="inp_hndl_plac_nm" ref="/root/reqData3/searchData/agn_nm" navindex="8" imemode="hangul" inputtype="button" caption="대행사" style="left:529px; top:37px; width:200px; height:18px; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								showAdvcsSearchPopup("", "", "", "Y", "", inp_hndl_plac_nm.currentText); 						
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode == "13"){
//								showAdvcsSearchPopup("", "", "Y", "", "", inp_agn_nm.currentText); 	
								findDlcoNoByName("4", inp_hndl_plac_nm.currentText, inp_hndl_plac_cd, inp_hndl_plac_nm);	
								var chk_cnt = Number(model.getValue("/root/tempData/resData/chk_cnt"));
								if(chk_cnt == 1){
									setBoTrustInfo();
								}					
							}																			
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							findDlcoNoByName("4", inp_hndl_plac_nm.currentText, inp_hndl_plac_cd, inp_hndl_plac_nm);
							var chk_cnt = Number(model.getValue("/root/tempData/resData/chk_cnt"));
							if(chk_cnt == 1){
								setBoTrustInfo();
							}
							]]>
						</script>
					</input>
					<input id="inp_hndl_plac_cd" ref="/root/reqData3/searchData/agn" navindex="7" autonext="false" format="99999999" caption="대행사" style="left:469px; top:37px; width:55px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							setBoTrustInfo();								
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode == "13"){
								setBoTrustInfo();	
							}
							]]>
						</script>
					</input>
					<caption id="caption118" class="list_cap01" style="left:379px; top:32px; width:85px; height:28px; ">광고지사</caption>
					<caption id="caption119" class="list_cap01" style="left:5px; top:5px; width:85px; height:28px; ">매체구분</caption>
					<caption id="caption120" class="list_cap01" style="left:379px; top:5px; width:85px; height:28px; ">게재기간</caption>
					<select1 id="cb_medi_cd3" ref="/root/reqData3/searchData/medi_cd" class="req" navindex="1" appearance="minimal" caption="매체구분" style="left:93px; top:10px; width:110px; height:18px; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/medi_cd/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								if( cb_medi_cd3.value == "350" ){
									cb_slip_clsf_cd3.select(1); //2012.01.19
									cb_slip_clsf_cd3.refresh(); //2012.01.19
								}else{
									cb_slip_clsf_cd3.select(0); //2012.01.19
									cb_slip_clsf_cd3.refresh(); //2012.01.19
								}
							]]>
						</script>
					</select1>
					<select1 id="cb_dt_clsf3" ref="/root/reqData3/searchData/dt_clsf" navindex="4" appearance="minimal" style="left:675px; top:10px; width:67px; height:18px; ">
						<choices>
							<item>
								<label>당일</label>
								<value>01</value>
							</item>
							<item>
								<label>당월</label>
								<value>02</value>
							</item>
							<item>
								<label>전월</label>
								<value>03</value>
							</item>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
					
							var currentdt = getCurrentDate();
							var currentmt = getCurrentMonth();				
										
							var dt_clsf = model.getValue("/root/reqData3/searchData/dt_clsf"); //선택한 콤보박스 값..
											
							if(dt_clsf == "01"){  
								var frdt = dateAdd("d", 0, currentdt);	//당일
								var todt = dateAdd("d",0, currentdt);	//당일
								
								model.setValue("/root/reqData3/searchData/frdt", frdt); 
								model.setValue("/root/reqData3/searchData/todt", todt); 
							}else if(dt_clsf == "02"){
								var frdt = currentdt.substring(0,6)+"01"; //당월의 1일부터
								var todt = dateAdd("d",0, currentdt);	//당월의 현재일 
								
								model.setValue("/root/reqData3/searchData/frdt", frdt); 
								model.setValue("/root/reqData3/searchData/todt", todt); 
							}else if(dt_clsf == "03") {
								var frdt 		= dateAdd("m", -1, currentmt+"01");
								var pre_month 	= frdt.substring(0,6);
								var todt 		= pre_month+commLastDay(pre_month); 	//전월의 말일 
								
								model.setValue("/root/reqData3/searchData/frdt", frdt); 
								model.setValue("/root/reqData3/searchData/todt", todt);
							}	
							
							var	make_dt	=	todt.substring(0,6) + "" + commLastDay(todt);
							
							model.setValue("/root/resData3/resForm/make_dt",make_dt);
							inp_make_dt3.refresh();
							
							model.refresh();
							
						]]>
						</script>
					</select1>
					<select id="checkbox3" ref="/root/reqData3/searchData/advt_clas1" overflow="visible" appearance="full" style="left:748px; top:37px; width:65px; height:15px; border-style:none; ">
						<choices>
							<item>
								<label>행광고</label>
								<value>Y</value>
							</item>
						</choices>
					</select>
					<select id="checkbox4" ref="/root/reqData3/searchData/advt_clas2" overflow="visible" appearance="full" style="left:818px; top:37px; width:65px; height:15px; border-style:none; ">
						<choices>
							<item>
								<label>일반광고</label>
								<value>Y</value>
							</item>
						</choices>
					</select>
				</group>
				<output id="out_tot_amt3" ref="/root/resData3/resForm/tot_amt" format="(-)#,###" appearance="output" style="left:127px; top:549px; width:140px; height:18px; text-align:right; "/>
				<caption id="caption121" class="list_cap03" style="left:485px; top:385px; width:95px; height:26px; ">상호(법인명)</caption>
				<output id="output43" ref="/root/resData3/resForm/demand_item" style="left:786px; top:439px; width:130px; height:18px; word-wrap:none; "/>
				<caption id="caption122" class="list_cap03" style="left:29px; top:410px; width:95px; height:26px; ">사업장 소재지</caption>
				<input id="inp_slip_occr_dt3" ref="/root/resData3/resForm/slip_occr_dt" navindex="11" inputtype="date" format="yyyy-mm-dd" style="left:354px; top:329px; width:90px; height:18px; "/>
				<output id="output44" ref="/root/resData3/resForm/demand_ern" style="left:583px; top:364px; width:140px; height:18px; "/>
				<caption id="caption123" class="list_cap03" style="left:485px; top:410px; width:95px; height:26px; ">사업장 주소</caption>
				<caption id="caption124" class="list_cap03" style="left:29px; top:435px; width:95px; height:26px; ">업  태</caption>
				<output id="output45" ref="/root/resData3/resForm/suply_ern" style="left:127px; top:364px; width:140px; height:18px; "/>
				<output id="output46" ref="/root/resData3/resForm/demand_dlco_nm" style="left:583px; top:389px; width:140px; height:18px; "/>
				<caption id="caption126" class="list_cap03" style="left:485px; top:435px; width:95px; height:26px; ">업  태</caption>
				<caption id="caption127" class="list_cap03" style="left:270px; top:385px; width:55px; height:26px; ">성명</caption>
				<output id="output47" ref="/root/resData3/resForm/suply_dlco_nm" style="left:127px; top:389px; width:140px; height:18px; "/>
				<select1 id="cb_prof_type_cd3" ref="/root/resData3/resForm/prof_type_cd" navindex="9" appearance="minimal" style="left:129px; top:329px; width:130px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/prof_type_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<caption id="caption130" class="list_cap03" style="left:485px; top:470px; width:95px; height:26px; ">등록번호</caption>
				<output id="output48" ref="/root/resData3/resForm/trust_addr" style="left:583px; top:524px; width:333px; height:18px; "/>
				<output id="output49" ref="/root/resData3/resForm/demand_presi_nm" style="left:786px; top:389px; width:130px; height:18px; "/>
				<caption id="caption131" class="list_cap03" style="left:726px; top:385px; width:55px; height:26px; ">성명</caption>
				<caption id="caption132" class="list_cap03" style="left:270px; top:435px; width:55px; height:26px; ">종목</caption>
				<caption id="caption133" class="list_cap03" style="left:5px; top:325px; width:120px; height:26px; ">세금계산서번호</caption>
				<input id="inp_slip_seq3" ref="/root/resData3/resForm/slip_seq" navindex="12" format="9999" style="left:449px; top:329px; width:30px; height:18px; ">
					<script type="javascript" ev:event="DOMFocusOut">
						<![CDATA[
						var slip_seq = model.getValue("/root/resData3/resForm/slip_seq");
						if(slip_seq != ""){
							model.setValue("/root/resData3/resForm/slip_seq", lpad(slip_seq, 4, "0"));
							inp_slip_seq3.refresh();	
						}						
						]]>
					</script>
				</input>
				<caption id="caption134" class="list_cap03" style="left:485px; top:495px; width:95px; height:26px; ">상호(법인명)</caption>
				<output id="output50" ref="/root/resData3/resForm/trust_bizcond" style="left:583px; top:549px; width:140px; height:18px; word-wrap:none; "/>
				<caption id="caption135" class="list_cap02" style="left:461px; top:360px; width:26px; height:97px; "/>
				<caption id="caption136" class="list_cap03" style="left:726px; top:435px; width:55px; height:26px; ">종목</caption>
				<caption id="caption137" class="list_cap02" style="left:5px; top:360px; width:26px; height:97px; "/>
				<caption id="caption138" class="list_cap03" style="left:820px; top:325px; width:65px; height:26px; ">취소여부</caption>
				<select1 id="combo7" ref="/root/resData3/resForm/re_issu_resn_cd" navindex="12" appearance="minimal" style="left:583px; top:329px; width:130px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/re_issu_resn_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<caption id="caption139" class="list_cap03" style="left:715px; top:325px; width:65px; height:26px; ">발행횟수</caption>
				<caption id="caption141" class="list_cap02" style="left:461px; top:470px; width:26px; height:97px; "/>
				<caption id="caption142" class="list_cap03" style="left:485px; top:520px; width:95px; height:26px; ">사업장 주소</caption>
				<output id="output51" ref="/root/resData3/resForm/trust_item" style="left:786px; top:549px; width:130px; height:18px; word-wrap:none; "/>
				<select1 id="cb_slip_clsf_cd3" ref="/root/resData3/resForm/slip_clsf_cd" disabled="true" navindex="10" appearance="minimal" style="left:264px; top:329px; width:80px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/cb_slip_clsf_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<caption id="caption144" class="list_cap03" style="left:500px; top:325px; width:80px; height:26px; ">재발행사유</caption>
				<caption id="caption146" class="list_cap03" style="left:461px; top:470px; width:26px; height:101px; ">
					<![CDATA[수

탁

자]]>
				</caption>
				<output id="output53" ref="/root/resData3/resForm/trust_ern" style="left:583px; top:474px; width:140px; height:18px; "/>
				<caption id="caption147" class="list_cap03" style="left:485px; top:545px; width:95px; height:26px; ">업  태</caption>
				<caption id="caption148" class="list_cap03" style="left:5px; top:360px; width:26px; height:101px; ">
					<![CDATA[공

급

자]]>
				</caption>
				<caption id="caption149" class="list_cap03" style="left:5px; top:495px; width:120px; height:26px; ">품목</caption>
				<output id="output54" ref="/root/resData3/resForm/canc_yn" style="left:889px; top:329px; width:25px; height:18px; "/>
				<caption id="caption150" class="list_cap03" style="left:5px; top:470px; width:120px; height:26px; ">작성일자</caption>
				<output id="output55" ref="/root/resData3/resForm/trust_dlco_nm" style="left:583px; top:499px; width:140px; height:18px; word-wrap:none; "/>
				<caption id="caption151" class="list_cap03" style="left:726px; top:495px; width:55px; height:26px; ">성명</caption>
				<input id="input11" ref="/root/resData3/resForm/tax_item" navindex="14" imemode="hangul" style="left:127px; top:499px; width:318px; height:18px; "/>
				<output id="output56" ref="/root/resData3/resForm/issu_tms" style="left:784px; top:329px; width:25px; height:18px; text-align:right; "/>
				<caption id="caption154" class="list_cap03" style="left:726px; top:545px; width:55px; height:26px; ">종목</caption>
				<caption id="caption156" class="list_cap03" style="left:5px; top:520px; width:120px; height:26px; ">공급가액</caption>
				<caption id="caption158" class="list_cap03" style="left:270px; top:520px; width:55px; height:26px; ">세액</caption>
				<output id="out_suply_amt3" ref="/root/resData3/resForm/suply_amt" format="(-)#,###" appearance="output" style="left:127px; top:524px; width:140px; height:18px; text-align:right; "/>
				<output id="output58" ref="/root/resData3/resForm/demand_dlco_no" visibility="hidden" style="left:733px; top:364px; width:100px; height:18px; "/>
				<caption id="caption159" class="list_cap03" style="left:5px; top:545px; width:120px; height:26px; ">합계</caption>
				<output id="output59" ref="/root/resData3/resForm/trust_dlco_no" visibility="hidden" style="left:735px; top:474px; width:100px; height:18px; "/>
				<caption id="caption160" class="list_cap03" style="left:461px; top:360px; width:26px; height:101px; ">
					<![CDATA[공
급
받
는
자]]>
				</caption>
				<output id="output60" ref="/root/resData3/resForm/suply_presi_nm" style="left:328px; top:389px; width:115px; height:18px; "/>
				<datagrid id="datagrid3" nodeset="/root/resData3/gridData/record" caption="선택^매체^게재일자^전표번호^광고주코드^광고주^광고료^부가세^지사^AGN^sale_stmt_issu_yn^sale_stmt_issu_yn" colsep="#" colwidth="50, 77, 100, 147, 83, 131, 90, 90, 71, 50, 100, 100" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:5px; top:70px; width:915px; height:240px; ">
					<col checkvalue="Y,N" ref="checked" type="checkbox"/>
					<col ref="medi_nm" style="text-align:left; "/>
					<col ref="pubc_dt" format="yyyy-mm-dd" style="text-align:center; "/>
					<col ref="pubc_slip_no" format="999-99999999-9999" style="text-align:center; "/>
					<col ref="dlco_no"/>
					<col ref="dlco_nm" style="text-align:left; "/>
					<col ref="advt_fee" format="#,###" style="text-align:right; "/>
					<col ref="vat" format="#,###" style="text-align:right; "/>
					<col ref="agn_nm" style="text-align:left; "/>
					<col ref="agn" visibility="hidden"/>
					<col ref="sale_stmt_issu_yn" visibility="hidden"/>
					<col ref="sale_stmt_issu_yn" visibility="hidden"/>
					<script type="javascript" ev:event="xforms-select">
						<![CDATA[
						var row = datagrid3.row;
						
						if(isDataRegion(datagrid3)){
							
							var selected_dlco_no =	datagrid3.valueMatrix(row, datagrid3.colRef("dlco_no"));
							
							// 1. 동일한 광고주 체크. START
							for(var i=datagrid3.fixedRows;i<datagrid3.rows;i++){
								var checked 				= datagrid3.valueMatrix(i, datagrid3.colRef("checked"));
								if(checked == "Y"){
									var dlco_no = datagrid3.valueMatrix(i, datagrid3.colRef("dlco_no"));
									if(selected_dlco_no != dlco_no){
										alert("같은 광고주를 선택해야 합니다.");
									 	datagrid3.valueMatrix(row, datagrid3.colRef("checked")) = "N";
									 	datagrid3.rowStatus(row) = "0";
									 	datagrid3.refresh();
										return;
									}
								}
							}
							// 동일한 광고주 체크. END
						 	
							var hndl_plac_cd = datagrid3.valueMatrix(datagrid3.row, datagrid3.colRef("agn"));//model.getValue("/root/resData/gridData/record["+row+"]/agn");							
							
							if(hndl_plac_cd != ""){
								setBoTrustInfo2(hndl_plac_cd);							
							}
							
							var dlco_no 	= datagrid3.valueMatrix(datagrid3.row, datagrid3.colRef("dlco_no"));//model.getValue("/root/resData/gridData/record["+row+"]/dlco_no");	
							var dlco_nm	= datagrid3.valueMatrix(datagrid3.row, datagrid3.colRef("dlco_nm"));//model.getValue("/root/resData/gridData/record["+row+"]/dlco_nm");		
							
//							model.setValue("/root/reqData/searchData/dlco_no", dlco_no);				
//							model.setValue("/root/reqData/searchData/dlco_nm", dlco_nm);	
							
//							inp_dlco_no.refresh();			
//							inp_dlco_nm.refresh();		
							
							setDemandInfo3(dlco_no);
							
							resetSuplyAmt();
							
							datagrid3.addStatus(row, "update");
							
							datagrid3.refresh();
						}else{
							
							if(datagrid3.rows == datagrid3.fixedRows){
								alert("선택할 대상이 없습니다. 게재조회를 먼저하세요.");								
								datagrid3.fixedcellischeck(0, datagrid3.colRef("checked")) = false;
								return;
							}
							
							var	pre_dlco_no = "";
							for(var i=datagrid3.fixedRows;i<datagrid3.rows;i++){
								var dlco_no = datagrid3.valueMatrix(i, datagrid3.colRef("dlco_no"));

								if(pre_dlco_no != "" && pre_dlco_no != dlco_no){
									alert("같은 광고주를 선택해야 합니다.");
									for(var j=datagrid3.fixedRows;j<datagrid3.rows;j++){
									 	datagrid3.valueMatrix(j, datagrid3.colRef("checked")) = "N";		
									 	datagrid3.rowStatus(j) = "0";
									}
								 	
									datagrid3.fixedcellischeck(0, datagrid3.colRef("checked")) = false;
									break;
								}
								pre_dlco_no = dlco_no;
							}
							

							for(var i=datagrid3.fixedRows;i<datagrid3.rows;i++){
								var sale_stmt_issu_yn = datagrid3.valueMatrix(i, datagrid3.colRef("sale_stmt_issu_yn"));
								if(sale_stmt_issu_yn	==	"Y"){
								 	datagrid3.valueMatrix(i, datagrid3.colRef("checked")) = "N";		
								 	datagrid3.rowStatus(i) = "0";
								}
							}

						 	datagrid3.refresh();
							setDemandInfo3(pre_dlco_no);
							
							resetSuplyAmt();
						}

						var	checked_cnt		=	0;
						var 	make_dt			=	model.getValue("/root/resData3/resForm/make_dt");
						var	max_pubc_dt		=	"";
						for(var i=datagrid3.fixedRows;i<datagrid3.rows;i++){
							var checked	=	datagrid3.valueMatrix(i, datagrid3.colRef("checked"));
							var pubc_dt	=	datagrid3.valueMatrix(i, datagrid3.colRef("pubc_dt"));
							
							if(checked == "Y"){
								if(pubc_dt	>	max_pubc_dt){
									max_pubc_dt	=	pubc_dt;
								}
								checked_cnt++;
							}
						}						
						
/*						
						var	pubc_yymm = max_pubc_dt.substring(0,6);
						max_pubc_dt   = pubc_yymm + commLastDay(pubc_yymm);
*/						
						if(checked_cnt > 1){
							max_pubc_dt = max_pubc_dt.substring(0,6) + "" + commLastDay(max_pubc_dt);
						}
												
						model.setValue("/root/resData3/resForm/make_dt", max_pubc_dt);
						inp_make_dt3.refresh();

						]]>
					</script>
					<script type="javascript" ev:event="xforms-deselect">
						<![CDATA[
												
						resetSuplyAmt();
						
						datagrid3.rowStatus(datagrid3.row) =  "0";
							
						datagrid3.refresh();

						var checked_cnt		=	0;
						var 	make_dt			=	model.getValue("/root/resData3/resForm/make_dt");
						var	max_pubc_dt		=	"";
						for(var i=datagrid3.fixedRows;i<datagrid3.rows;i++){
							var checked	=	datagrid3.valueMatrix(i, datagrid3.colRef("checked"));
							var pubc_dt	=	datagrid3.valueMatrix(i, datagrid3.colRef("pubc_dt"));
							
							if(checked == "Y"){
								if(pubc_dt	>	max_pubc_dt){
									max_pubc_dt	=	pubc_dt;
								}
								checked_cnt++;
							}
						}		

						if(checked_cnt > 1){
							max_pubc_dt = max_pubc_dt.substring(0,6) + "" + commLastDay(max_pubc_dt);
						}						
						
															
						model.setValue("/root/resData3/resForm/make_dt", max_pubc_dt);
						inp_make_dt3.refresh();						
									
						]]>
					</script>
				</datagrid>
			</case>
		</switch>
		<caption id="caption6" tyle="left:15px; top:180px; width:940px; height:0px;" style="left:0px; top:10px; width:0px; height:0px; ">caption6</caption>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<button id="button15" class="btn02" crud="R" style="left:538px; top:40px; width:50px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.reset();
				setMode(INSERT_MODE);
				]]>
			</script>
		</button>
		<button id="button16" class="btn04" crud="R" style="left:702px; top:40px; width:89px; height:21px; ">
			<caption>공통거래처</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				regDlcoInfo();
				
				var if_dlco_no = model.property("IF_DLCO_NO");				
				
				if(if_dlco_no != ""){
/*					
					model.setValue("/root/resData/resForm/dlco_no", if_dlco_no);
					inp_dlco_no.refresh();	
									
					setTrustInfo();
*/												
				}				
				]]>
			</script>
		</button>
		<button id="button11" class="btn02" crud="C" style="left:482px; top:40px; width:52px; height:21px; ">
			<caption>발행</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var slip_clsf_cd = model.getValue("/root/resData/resForm/slip_clsf_cd");
//					if( slip_clsf_cd != "16" )
//					{
//						alert("신문 계산서만 발행가능합니다.");
//						return;
//					}
					
					if( switch1.selectedIndex == 0 )
					{
						if( check_issu() )
						{
							//대행사 위수탁 세금계산서만 
							var slip_seq	=	model.getValue("/root/resData/resForm/slip_seq");
							if( slip_seq != "" )
							{
								alert("이미 발행된 세금계산서입니다.");
								return;
							}
							
							var trust_dlco_no	= model.getValue("/root/resData/resForm/trust_dlco_no");
							if( trust_dlco_no	== "" )
							{
								alert("수탁자가 없습니다. 발행할 수 없습니다.");	
								return;
							}
							
							//업로드 데이터 체크
							var upload_yn			= model.getValue("/root/resData/resForm/upload_yn");
							if( upload_yn == "Y" )
							{
								var upload_dlco_no		= model.getValue("/root/resData/resForm/upload_dlco_no");
								var upload_agn_no		= model.getValue("/root/resData/resForm/upload_agn_no");
								var upload_elec_tax_comp_cd	= model.getValue("/root/resData/resForm/upload_elec_tax_comp_cd");
								var upload_email_id		= model.getValue("/root/resData/resForm/upload_email_id");
								var upload_semuro_no	= model.getValue("/root/resData/resForm/upload_semuro_no");
								var upload_make_dt		= model.getValue("/root/resData/resForm/upload_make_dt");
								var upload_suply_amt	= model.getValue("/root/resData/resForm/upload_suply_amt");
								var upload_vat_amt		= model.getValue("/root/resData/resForm/upload_vat_amt");

								var dlco_no			= model.getValue("/root/reqData/searchData/dlco_no");
								var agn_no			= model.getValue("/root/reqData/searchData/agn");
								var elec_tax_comp_cd	= model.getValue("/root/resData/resForm/elec_tax_comp_cd");
								var email_id			= model.getValue("/root/resData/resForm/email_id");
								var semuro_no			= model.getValue("/root/resData/resForm/semuro_no");
								var make_dt			= model.getValue("/root/resData/resForm/make_dt");
								var suply_amt			= model.getValue("/root/resData/resForm/suply_amt");
								var vat_amt			= model.getValue("/root/resData/resForm/vat_amt");
								
								if( upload_dlco_no != dlco_no )
								{
									alert("광고주가 일치하지 않습니다.");
									return;
								}
								if( upload_agn_no != agn_no )
								{
									alert("대행사가 일치하지 않습니다.");
									return;
								}
								if( upload_elec_tax_comp_cd != elec_tax_comp_cd )
								{
									alert("전자계산서업체가 일치하지 않습니다.");
									return;
								}
								if( upload_email_id != email_id )
								{
									alert("이메일주소가 일치하지 않습니다.");
									return;
								}
								if( upload_make_dt != make_dt )
								{
									alert("작성일자가 일치하지 않습니다.");
									return;
								}
								if( upload_semuro_no != semuro_no )
								{
									alert("승인번호가 일치하지 않습니다.");
									return;
								}
								
								if( upload_suply_amt != suply_amt )
								{
									alert("공급가액이 일치하지 않습니다.");
									return;
								}
								if( upload_vat_amt != vat_amt )
								{
									alert("세액이 일치하지 않습니다.");
									return;
								}
							}
							
													
							if( windowConfirm("발행하시겠습니까?") )
							{
								model.setValue("/root/resData/resForm/medi_cd", model.getValue("/root/reqData/searchData/medi_cd"));
								model.setValue("/root/resData/resForm/multiUpdateData", datagrid1.getUpdateData());
								
								model.send("ad_nmd_5020_a");
								
								if(submit_completed()){
									var slip_seq 	= model.getValue("/root/msgData/slip_seq");
									var slip_occr_dt = model.getValue("/root/msgData/slip_occr_dt");
									
									model.setValue("/root/resData/resForm/slip_seq", slip_seq);
									model.setValue("/root/resData/resForm/slip_occr_dt", slip_occr_dt);
									inp_slip_seq.refresh();
									inp_slip_occr_dt.refresh();
									
									loadData();
								}
							}
						}
					}else if(switch1.selectedIndex == 1){
						
						if(check_issu2()){						
							
							var prof_type_cd = model.getValue("/root/resData/resForm/prof_type_cd");
							//if(prof_type_cd == "33"){ //2012.01.18
							var orgStr = model.getValue("/root/tempData/xx_prof_type_cd");
							if(instr_yn(orgStr, prof_type_cd)){
								alert("영세율 자료입니다. 게재상계가 필요 없습니다.");
							}
	
							var 	issu_tms			=	Number(model.getValue("/root/resData2/resForm/issu_tms"));
							if(issu_tms == 0){
								var 	make_dt			=	model.getValue("/root/resData2/resForm/make_dt");
								var	max_pubc_dt		=	"";
								
								for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
									var checked	=	datagrid2.valueMatrix(i, datagrid2.colRef("checked"));
									var pubc_dt	=	datagrid2.valueMatrix(i, datagrid2.colRef("pubc_dt"));
									
									if(checked == "Y"){
										if(pubc_dt	>	max_pubc_dt){
											max_pubc_dt	=	pubc_dt;
										}
									}
								}

//								if(make_dt > max_pubc_dt){
//									if(make_dt.substring(0,6) != max_pubc_dt.substring(0,6) ){
//										alert("게재월과 세금계산서 작성월이 다릅니다.");
//										model.setFocus("inp_make_dt2");
//										return;
//									}
//								}					
							}					
							//품목체크 20120216 김상훈
							var tax_item = model.getValue("/root/resData2/resForm/tax_item");
							if(tax_item == ""){
								model.setValue("/root/resData2/resForm/tax_item","디지털초판판매료");
							}
								
							if(windowConfirm("발행하시겠습니까?")){
								var dlco_clsf_cd = model.getValue("/root/reqData2/searchData/dlco_clsf_cd");
								makeNodeValue("/root/resData2/resForm/dlco_clsf_cd", dlco_clsf_cd);
								//거래처구분이 아이디인 경우 dlco_no = id
								if(dlco_clsf_cd == "10"){
									model.setValue("/root/resData2/resForm/demand_dlco_no",model.getValue("/root/reqData2/searchData/user_id"));
								}
								model.setValue("/root/resData2/resForm/medi_cd", model.getValue("/root/reqData2/searchData/medi_cd"));
								model.setValue("/root/resData2/resForm/multiUpdateData", datagrid2.getUpdateData());
								
								model.setValue("/root/resData2/resForm/email_id"			, inp_email.currentText);
								model.setValue("/root/resData2/resForm/elec_tax_comp_cd"	, cmb_elec_tax_comp_cd.value);
								model.setValue("/root/resData2/resForm/semuro_no"		, inp_semuro_no.currentText);
								
								model.send("ad_nmd_5040_a");
								
								if(submit_completed()){
									var slip_seq 		= model.getValue("/root/msgData/slip_seq");
									var slip_occr_dt 		= model.getValue("/root/msgData/slip_occr_dt");
									model.setValue("/root/resData2/resForm/slip_seq", slip_seq);
									model.setValue("/root/resData2/resForm/slip_occr_dt", slip_occr_dt);
									inp_slip_seq2.refresh();
									inp_slip_occr_dt2.refresh();
									loadData();
					
									if(submit_completed()){
										var issu_tms = Number(model.getValue("/root/resData2/resForm/issu_tms"));
	//									if(issu_tms <= 1){
											goReport("P");	
	//									}
									}
								}
							}			
						}	
					}else if(switch1.selectedIndex == 2){
						
						if(check_issu3()){						
							
							var prof_type_cd = model.getValue("/root/resData3/resForm/prof_type_cd");
							//if(prof_type_cd == "33"){ //2012.01.18
							var orgStr = model.getValue("/root/tempData/xx_prof_type_cd");
							if(instr_yn(orgStr, prof_type_cd)){
								alert("영세율 자료입니다. 게재상계가 필요 없습니다.");
							}
							
							var trust_dlco_no	= model.getValue("/root/resData3/resForm/trust_dlco_no");
							
							if(trust_dlco_no	==	""){
								alert("수탁자가 없습니다. 발행할 수 없습니다.");	
								return;
							}
	
							var 	issu_tms			=	Number(model.getValue("/root/resData3/resForm/issu_tms"));
							if(issu_tms == 0){
								var 	make_dt			=	model.getValue("/root/resData3/resForm/make_dt");
								var	max_pubc_dt		=	"";
								for(var i=datagrid3.fixedRows;i<datagrid3.rows;i++){
									var checked	=	datagrid3.valueMatrix(i, datagrid3.colRef("checked"));
									var pubc_dt	=	datagrid3.valueMatrix(i, datagrid3.colRef("pubc_dt"));
									
									if(checked == "Y"){
										if(pubc_dt	>	max_pubc_dt){
											max_pubc_dt	=	pubc_dt;
										}
									}
								}
								
								if(make_dt > max_pubc_dt){
									if(make_dt.substring(0,6) != max_pubc_dt.substring(0,6)){
										alert("게재월과 세금계산서 작성월이 다릅니다.");
										model.setFocus("inp_make_dt3");
										return;
									}
								}					
							}
							//품목체크 20120216 김상훈
							var tax_item = model.getValue("/root/resData3/resForm/tax_item");
							if(tax_item == ""){
								model.setValue("/root/resData3/resForm/tax_item","디지털초판판매료");
							}
														
							if(windowConfirm("발행하시겠습니까?")){
								
								makeNodeValue("/root/resData3/resForm/hndl_clsf", "4")
								model.setValue("/root/resData3/resForm/medi_cd", model.getValue("/root/reqData3/searchData/medi_cd"));
								model.setValue("/root/resData3/resForm/multiUpdateData", datagrid3.getUpdateData());
								
								model.setValue("/root/resData3/resForm/email_id"			, inp_email.currentText);
								model.setValue("/root/resData3/resForm/elec_tax_comp_cd"	, cmb_elec_tax_comp_cd.value);
								model.setValue("/root/resData3/resForm/semuro_no"		, inp_semuro_no.currentText);
								
								model.send("ad_nmd_5070_a");
								
								if(submit_completed()){
									var slip_seq 		= model.getValue("/root/msgData/slip_seq");
									var slip_occr_dt 		= model.getValue("/root/msgData/slip_occr_dt");
									model.setValue("/root/resData3/resForm/slip_seq", slip_seq);
									model.setValue("/root/resData3/resForm/slip_occr_dt", slip_occr_dt);
									inp_slip_seq3.refresh();
									inp_slip_occr_dt3.refresh();
									loadData();
					
									if(submit_completed()){
										var issu_tms = Number(model.getValue("/root/resData3/resForm/issu_tms"));
	//									if(issu_tms <= 1){
											goReport("P");	
	//									}
									}
								}
							}			
						}	
					}
				
				]]>
			</script>
		</button>
		<button id="button12" class="btn02" crud="D" style="left:592px; top:40px; width:52px; height:21px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[				
						
				var	canc_yn	=	"";
				if(switch1.selectedIndex == 0){
					//위수탁
					canc_yn	=	model.getValue("/root/resData/resForm/canc_yn");
				}else if(switch1.selectedIndex == 1){
					//직거래
					canc_yn	=	model.getValue("/root/resData2/resForm/canc_yn");
				}if(switch1.selectedIndex == 2){
					//광고지사
					canc_yn	=	model.getValue("/root/resData3/resForm/canc_yn");
				}
						
				if(canc_yn == "Y"){
					alert("이미 취소된 세금계산서입니다.");
					return;
				}
				if(getMode() != UPDATE_MODE){
					alert("취소할 세금계산서를 조회하세요.");
					return;
				}
					
				if(switch1.selectedIndex == 0){			
				
					if(windowConfirm("취소하시겠습니까?")){
						model.setValue("/root/resData/resForm/medi_cd", model.getValue("/root/reqData/searchData/medi_cd"));
						model.setValue("/root/resData/resForm/multiUpdateData", datagrid1.getUpdateData());
						
						modelSendNoMake("ad_nmd_5022_a", "/ad/nmd/5022", "/root/resData/resForm", "/root/msgData");
						if(submit_completed()){
							setMode(INSERT_MODE);
							loadData();
						}
					}
				}else if(switch1.selectedIndex == 1){
					
					if(windowConfirm("취소하시겠습니까?")){
						model.setValue("/root/resData2/resForm/medi_cd", model.getValue("/root/reqData2/searchData/medi_cd"));
						model.setValue("/root/resData2/resForm/multiUpdateData", datagrid2.getUpdateData());
						modelSendNoMake("ad_nmd_5022_a", "/ad/nmd/5022", "/root/resData2/resForm", "/root/msgData");
						if(submit_completed()){
							setMode(INSERT_MODE);
							loadData();
							setDemandInfo2();
						}
					}						
				}else if(switch1.selectedIndex == 2){			
				
					if(windowConfirm("취소하시겠습니까?")){
						model.setValue("/root/resData3/resForm/medi_cd", model.getValue("/root/reqData3/searchData/medi_cd"));
						model.setValue("/root/resData3/resForm/multiUpdateData", datagrid3.getUpdateData());
						
						modelSendNoMake("ad_nmd_5022_a", "/ad/nmd/5022", "/root/resData3/resForm", "/root/msgData");
						if(submit_completed()){
							setMode(INSERT_MODE);
							loadData();
						}
					}
				}
				
				]]>
			</script>
		</button>
		<button id="btn_case2" class="tab04" visibility="hidden" group="tab" style="left:88px; top:70px; width:78px; height:23px; ">
			<caption>직거래</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.toggle("case2");	
					model.reset();		
					setMode(INSERT_MODE);	
				]]>
			</script>
		</button>
		<button id="btnClose" class="btn02" style="left:886px; top:40px; width:50px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if(window.type=="mdi"){
					viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
				}else{
					window.close();
				}
								
				]]>
			</script>
		</button>
		<button id="button1" class="btn03" crud="R" style="left:414px; top:40px; width:65px; height:21px; ">
			<caption>게재조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[	
				
				if(switch1.selectedIndex == 0){
					
					if(commReqCheck("srch_group")){
						var dlco_no = model.getValue("/root/reqData/searchData/dlco_no");
						var agn     = model.getValue("/root/reqData/searchData/agn");
						
						if(dlco_no == "" && agn == "" ){
							alert("광고주 또는 대행사 회원 아이디를 입력하세요.");
							return;
						}
						modelSendNoMake("ad_nmd_5010_l", "/ad/nmd/5010", "/root/reqData/searchData", "/root/resData/gridData");	
						
						if(submit_completed()){
							for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
								var sale_stmt_issu_yn = datagrid1.valueMatrix(i, datagrid1.colRef("sale_stmt_issu_yn"));
								if(sale_stmt_issu_yn == "Y"){
									datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = true;
									datagrid1.rowstyle(i, "data", "background-color") = _bgcolor;
								}else{
									datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = false;
									datagrid1.rowstyle(i, "data", "background-color") = "#FFFFFF";
								}
							}
						}
						
						clear();					
					}
				}else if(switch1.selectedIndex == 1){

					if(commReqCheck("srch_group2")){
						
						var dlco_no = model.getValue("/root/reqData2/searchData/dlco_no");
						var id      = model.getValue("/root/reqData2/searchData/user_id");
						if(dlco_no == "" && id       == "" ){
							alert("광고주 또는 회원 아이디를 입력하세요.");
							return;
						}						
						modelSendNoMake("ad_nmd_5050_l", "/ad/nmd/5050", "/root/reqData2/searchData", "/root/resData2/gridData");
						
						if(submit_completed()){
							for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
								var sale_stmt_issu_yn = datagrid2.valueMatrix(i, datagrid2.colRef("sale_stmt_issu_yn"));
								if(sale_stmt_issu_yn == "Y"){
									datagrid2.isReadOnly(i, datagrid2.colRef("checked")) = true;
									datagrid2.rowstyle(i, "data", "background-color") = _bgcolor;
								}else{
									datagrid2.isReadOnly(i, datagrid2.colRef("checked")) = false;
									datagrid2.rowstyle(i, "data", "background-color") = "#FFFFFF";
								}
							}
						}
						
						clear();					
					}					
					
				}else if(switch1.selectedIndex == 2){

					if(commReqCheck("srch_group3")){

						var dlco_no = model.getValue("/root/reqData3/searchData/dlco_no");
						var agn     = model.getValue("/root/reqData3/searchData/agn");
						
						if(dlco_no == "" && agn == ""){
							alert("광고주 또는 광고지사를 입력하세요.");
							return;
						}						
						
						var dlco_no = model.getValue("/root/reqData3/searchData/dlco_no");
						
						modelSendNoMake("ad_nmd_5060_l", "/ad/nmd/5060", "/root/reqData3/searchData", "/root/resData3/gridData");
						
						if(submit_completed()){
							for(var i=datagrid3.fixedRows;i<datagrid3.rows;i++){
								var sale_stmt_issu_yn = datagrid3.valueMatrix(i, datagrid3.colRef("sale_stmt_issu_yn"));
								if(sale_stmt_issu_yn == "Y"){
									datagrid3.isReadOnly(i, datagrid3.colRef("checked")) = true;
									datagrid3.rowstyle(i, "data", "background-color") = _bgcolor;
								}else{
									datagrid3.isReadOnly(i, datagrid3.colRef("checked")) = false;
									datagrid3.rowstyle(i, "data", "background-color") = "#FFFFFF";
								}
							}
						}
						
						clear();					
					}				
				}
				setMode(INSERT_MODE);
				]]>
			</script>
		</button>
		<button id="button2" class="btn02" crud="R" style="left:359px; top:40px; width:52px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[	
				
				if(switch1.selectedIndex == 0){
					var slip_seq = model.getValue("/root/resData/resForm/slip_seq");
					if(slip_seq == ""){
						alert("일련번호를 입력하세요."); 
						model.setFocus("inp_slip_seq");
						return;
					}
				}else if(switch1.selectedIndex == 1){
					var slip_seq = model.getValue("/root/resData2/resForm/slip_seq");
					if(slip_seq == ""){
						alert("일련번호를 입력하세요."); 
						model.setFocus("inp_slip_seq2");
						return;
					}				
				}else if(switch1.selectedIndex == 2){
					var slip_seq = model.getValue("/root/resData3/resForm/slip_seq");
					if(slip_seq == ""){
						alert("일련번호를 입력하세요."); 
						model.setFocus("inp_slip_seq3");
						return;
					}				
				}	
									
				loadData();
				]]>
			</script>
		</button>
		<button id="btn_case1" class="tab04" visibility="hidden" group="tab" selected="true" style="left:10px; top:70px; width:78px; height:23px; ">
			<caption>위수탁</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.toggle("case1");		
					model.reset();
					setMode(INSERT_MODE);
				]]>
			</script>
		</button>
		<button id="button6" class="btn04" disabled="true" visibility="hidden" crud="R" style="left:794px; top:40px; width:89px; height:21px; ">
			<caption>전자세금계산서</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				alert("세무로 매출세금계산서 전송화면 팝업연결");								
				]]>
			</script>
		</button>
		<button id="button3" class="tab04" visibility="hidden" group="tab" style="left:166px; top:70px; width:78px; height:23px; ">
			<caption>광고지사</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.toggle("case3");	
					model.reset();		
					setMode(INSERT_MODE);	
				]]>
			</script>
		</button>
		<caption id="cpt_semuro_no" class="list_cap03" style="left:660px; top:690px; width:80px; height:26px; ">승인번호</caption>
		<input id="inp_email" ref="/root/resData/resForm/email_id" appearance="input" style="left:105px; top:694px; width:195px; height:18px; text-align:left; "/>
		<caption id="cpt_electaxcompcd" class="list_cap03" style="left:310px; top:690px; width:150px; height:26px; ">전자세금계산서업체</caption>
		<caption id="cpt_email" class="list_cap03" style="left:15px; top:690px; width:80px; height:26px; ">E-Mail</caption>
		<select1 id="cmb_elec_tax_comp_cd" ref="/root/resData/resForm/elec_tax_comp_cd" navindex="1" appearance="minimal" caption="매체구분" style="left:470px; top:694px; width:175px; height:18px; text-align:left; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/elec_tax_comp_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<input id="inp_semuro_no" ref="/root/resData/resForm/semuro_no" appearance="input" style="left:745px; top:694px; width:180px; height:18px; text-align:left; "/>
		<caption id="cpt_elec_tax" style="left:10px; top:670px; width:926px; height:20px; font-family:굴림; font-size:8pt; font-weight:bold; ">* 전자세금계산서 입력항목</caption>
		<output id="oup_upload_email_id" ref="/root/resData/resForm/upload_email_id" visibility="hidden" appearance="output" style="left:200px; top:672px; width:195px; height:18px; text-align:left; "/>
		<output id="oup_upload_elec_tax_comp_cd" ref="/root/resData/resForm/upload_elec_tax_comp_cd" visibility="hidden" appearance="output" style="left:410px; top:672px; width:195px; height:18px; text-align:left; "/>
		<output id="oup_upload_semuro_no" ref="/root/resData/resForm/upload_semuro_no" visibility="hidden" appearance="output" style="left:620px; top:672px; width:195px; height:18px; text-align:left; "/>
		<button id="button4" class="btn02" crud="C" style="left:647px; top:40px; width:52px; height:21px; ">
			<caption>(-)발행</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var slip_clsf_cd = model.getValue("/root/resData/resForm/slip_clsf_cd");
//					if( slip_clsf_cd != "16" )
//					{
//						alert("신문 계산서만 발행가능합니다.");
//						return;
//					}
					/*if(switch1.selectedindex == 0 || switch1.selectedindex == 2){
						alert("마이너스 계산서 발행은 직거래만 가능합니다.");
						return;
					}*/
					if( switch1.selectedIndex == 0 )
					{
						if( check_issu5() )
						{	
							var pre_semuro = model.getValue("/root/tmp_semuro_no");
							var nxt_semuro = model.getValue("/root/resData/resForm/semuro_no");
							if(pre_semuro == nxt_semuro){
								alert("(-)발행된 승인번호를 입력해주세요.");
								return;
							}
							if( windowConfirm("발행하시겠습니까?") )
							{
								model.setValue("/root/resData/resForm/medi_cd", model.getValue("/root/reqData/searchData/medi_cd"));
								model.setValue("/root/resData/resForm/multiUpdateData", datagrid1.getUpdateData());
								
								model.send("ad_nmd_5023_a");
								
								if(submit_completed()){
									var slip_seq 	= model.getValue("/root/msgData/slip_seq");
									var slip_occr_dt = model.getValue("/root/msgData/slip_occr_dt");
									
									model.setValue("/root/resData/resForm/slip_seq", slip_seq);
									model.setValue("/root/resData/resForm/slip_occr_dt", slip_occr_dt);
									inp_slip_seq.refresh();
									inp_slip_occr_dt.refresh();
									
									loadData();
								}
							}
						}
					}else if(switch1.selectedIndex == 1){
						var resn_cd = model.getValue("/root/resData2/resForm/re_issu_resn_cd");
						if(resn_cd == ""){
							alert("수정사유는 필수항목입니다.선택해주세요");
							return;
						}
						if(check_issu4()){	
							//cheking
							/*
							for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
							 	datagrid2.valueMatrix(i, datagrid2.colRef("checked")) = "Y";
								datagrid2.rowStatus(i) = "2";
								datagrid2.fixedcellischeck(i, datagrid2.colRef("checked")) = false;
								//alert("pubc_slip_no ::"+datagrid2.valueMatrix(i, datagrid2.colRef("pubc_slip_no")));
							}											
							//return;
							*/
							var prof_type_cd = model.getValue("/root/resData/resForm/prof_type_cd");
							//if(prof_type_cd == "33"){ //2012.01.18
							var orgStr = model.getValue("/root/tempData/xx_prof_type_cd");
							if(instr_yn(orgStr, prof_type_cd)){
								alert("영세율 자료입니다. 게재상계가 필요 없습니다.");
							}
							
							//(-)세금계산서 작성일자 수정사유코드에 따라 변경함
							var make_dt  = model.getValue("/root/resData2/resForm/make_dt");
							var make_dt2 = model.getValue("/root/resData2/resForm/make_dt2");
							var resn_cd  = model.getValue("/root/resData2/resForm/re_issu_resn_cd");
							if(resn_cd == "02"){//공급가액 변동 ==> 작성일:변동 사유 발생일,비고:당초 세금계산서 교부일
								if(windowConfirm("(-)세금계산서 작성일자는 변동 사유 발생일입니다.계속하시겠습니까?")){
									//model.setValue("/root/resData2/resForm/make_dt",make_dt2);
								}else{
									return;
								}
							}
							else if(resn_cd == "03"){//환입 ==> 작성일:환입된날,비고:당초 세금계산서 작성일
								if(windowConfirm("(-)세금계산서 작성일자는 환입된 날입니다.계속하시겠습니까?")){
									//model.setValue("/root/resData2/resForm/make_dt",make_dt2);
								}else{
									return;
								}
								
							}
							else if(resn_cd == "04"){//계약의 해제 ==> 작성일:계약해제일,비고:계약해제일
								if(windowConfirm("(-)세금계산서 작성일자는 계약 해제일입니다.계속하시겠습니까?")){
									//model.setValue("/root/resData2/resForm/make_dt",make_dt2);
								}else{
									return;
								}
							}
							
							var 	issu_tms			=	Number(model.getValue("/root/resData2/resForm/issu_tms"));
							if(issu_tms != 0){
								var 	make_dt			=	model.getValue("/root/resData2/resForm/make_dt");
								var	max_pubc_dt		=	"";
								for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
									var checked	=	datagrid2.valueMatrix(i, datagrid2.colRef("sale_stmt_issu_yn"));
									var pubc_dt	=	datagrid2.valueMatrix(i, datagrid2.colRef("pubc_dt"));
									
									if(checked == "Y"){
										if(pubc_dt	>	max_pubc_dt){
											max_pubc_dt	=	pubc_dt;
										}
									}
								}
								
//								if(make_dt > max_pubc_dt){
//									if(make_dt.substring(0,6) != max_pubc_dt.substring(0,6)){
//										alert("게재월과 세금계산서 작성월이 다릅니다.");
//										model.setFocus("inp_make_dt2");
//										return;
//									}
//								}					
							}			
							//품목체크 20120216 김상훈
							var tax_item = model.getValue("/root/resData2/resForm/tax_item");
							if(tax_item == ""){
								model.setValue("/root/resData2/resForm/tax_item","디지털초판판매료");
							}
							
							if(windowConfirm("발행하시겠습니까?")){
								makeNodeValue("/root/resData2/resForm/dlco_clsf_cd", model.getValue("/root/reqData2/searchData/dlco_clsf_cd"));
								model.setValue("/root/resData2/resForm/medi_cd", model.getValue("/root/reqData2/searchData/medi_cd"));
								model.setValue("/root/resData2/resForm/multiUpdateData", datagrid2.getUpdateData());
								
								model.setValue("/root/resData2/resForm/email_id"			, inp_email.currentText);
								model.setValue("/root/resData2/resForm/elec_tax_comp_cd"	, cmb_elec_tax_comp_cd.value);
								model.setValue("/root/resData2/resForm/semuro_no"		, inp_semuro_no.currentText);

								model.send("ad_nmd_5041_a");
								
								if(submit_completed()){
									var slip_seq 		= model.getValue("/root/msgData/slip_seq");
									var slip_occr_dt 		= model.getValue("/root/msgData/slip_occr_dt");
									model.setValue("/root/resData2/resForm/slip_seq", slip_seq);
									model.setValue("/root/resData2/resForm/slip_occr_dt", slip_occr_dt);
									inp_slip_seq2.refresh();
									inp_slip_occr_dt2.refresh();
									loadData();
					
									if(submit_completed()){
										var issu_tms = Number(model.getValue("/root/resData2/resForm/issu_tms"));
	//									if(issu_tms <= 1){
											goReport("P");	
	//									}
									}
								}
							}			
						}	
					}else if(switch1.selectedIndex == 2){
						
						if(check_issu6()){						
							
							var prof_type_cd = model.getValue("/root/resData3/resForm/prof_type_cd");
							//if(prof_type_cd == "33"){ //2012.01.18
							var orgStr = model.getValue("/root/tempData/xx_prof_type_cd");
							if(instr_yn(orgStr, prof_type_cd)){
								alert("영세율 자료입니다. 게재상계가 필요 없습니다.");
							}

							var 	issu_tms			=	Number(model.getValue("/root/resData3/resForm/issu_tms"));
							if(issu_tms != 0){
								var 	make_dt			=	model.getValue("/root/resData3/resForm/make_dt");
								var	max_pubc_dt		=	"";
								for(var i=datagrid3.fixedRows;i<datagrid3.rows;i++){
									var checked	=	datagrid3.valueMatrix(i, datagrid3.colRef("sale_stmt_issu_yn"));
									var pubc_dt	=	datagrid3.valueMatrix(i, datagrid3.colRef("pubc_dt"));
									
									if(checked == "Y"){
										if(pubc_dt	>	max_pubc_dt){
											max_pubc_dt	=	pubc_dt;
										}
									}
								}
								
								if(make_dt > max_pubc_dt){
									if(make_dt.substring(0,6) != max_pubc_dt.substring(0,6)){
										alert("게재월과 세금계산서 작성월이 다릅니다.");
										model.setFocus("inp_make_dt3");
										return;
									}
								}					
							}
							//품목체크 20120216 김상훈
							var tax_item = model.getValue("/root/resData3/resForm/tax_item");
							if(tax_item == ""){
								model.setValue("/root/resData3/resForm/tax_item","디지털초판판매료");
							}
							var pre_semuro = model.getValue("/root/tmp_semuro_no");
							var nxt_semuro = inp_semuro_no.currentText;//model.getValue("/root/resData/resForm/semuro_no");
							if(pre_semuro == nxt_semuro){
								alert("(-)발행된 승인번호를 입력해주세요3.");
								return;
							}							
							if(windowConfirm("발행하시겠습니까?")){
								
								makeNodeValue("/root/resData3/resForm/hndl_clsf", "4")
								model.setValue("/root/resData3/resForm/medi_cd", model.getValue("/root/reqData3/searchData/medi_cd"));
								model.setValue("/root/resData3/resForm/multiUpdateData", datagrid3.getUpdateData());
								
								model.setValue("/root/resData3/resForm/email_id"			, inp_email.currentText);
								model.setValue("/root/resData3/resForm/elec_tax_comp_cd"	, cmb_elec_tax_comp_cd.value);
								model.setValue("/root/resData3/resForm/semuro_no"		, inp_semuro_no.currentText);
								
								model.send("ad_nmd_5071_a");
								
								if(submit_completed()){
									var slip_seq 		= model.getValue("/root/msgData/slip_seq");
									var slip_occr_dt 		= model.getValue("/root/msgData/slip_occr_dt");
									model.setValue("/root/resData3/resForm/slip_seq", slip_seq);
									model.setValue("/root/resData3/resForm/slip_occr_dt", slip_occr_dt);
									inp_slip_seq3.refresh();
									inp_slip_occr_dt3.refresh();
									loadData();
					
									if(submit_completed()){
										var issu_tms = Number(model.getValue("/root/resData3/resForm/issu_tms"));
	//									if(issu_tms <= 1){
											goReport("P");	
	//									}
									}
								}
							}			
						}	
					}				
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
