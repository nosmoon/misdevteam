<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<pageInfo/>
						<hndl_nm/>
						<comboSet>
							<hndl_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</hndl_clsf>
							<advt_clas>
								<item>
									<label/>
									<value/>
								</item>
							</advt_clas>
							<chro_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</chro_clsf>
							<pubc_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</pubc_clsf>
							<grp_cmpy_cd>
								<item>
									<label/>
									<value/>
								</item>
							</grp_cmpy_cd>
							<mony_kind>
								<item>
									<label/>
									<value/>
								</item>
							</mony_kind>
							<edt_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</edt_clsf>
							<appndx_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</appndx_clsf>
							<upd_resn>
								<item>
									<label/>
									<value/>
								</item>
							</upd_resn>
							<medi_cd>
								<item>
									<label/>
									<value/>
								</item>
							</medi_cd>
							<hp_edt_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</hp_edt_clsf>
							<std_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</std_clsf>
							<pubc_prd>
								<item>
									<label/>
									<value/>
								</item>
							</pubc_prd>
							<nwsp_side_type>
								<item>
									<label/>
									<value/>
								</item>
							</nwsp_side_type>
							<dtls_medi_cd>
								<item>
									<label/>
									<value/>
								</item>
							</dtls_medi_cd>
							<dtnb_medi_cd>
								<item>
									<label/>
									<value/>
								</item>
							</dtnb_medi_cd>
						</comboSet>
					</initData>
					<reqData>
						<fwdData>
						</fwdData>
						<searchData>
							<pubc_occr_dt/>
							<pubc_occr_seq/>
							<search_dt/>
							<medi_cd/>
							<preng_occr_dt/>
							<preng_occr_seq/>
							<proc_dt/>
							<proc_seq/>
						</searchData>
						<reqForm>
						</reqForm>
						<multiUpdateData/>
					</reqData>
					<resData>
						<resForm>
							<proc_dt/>
							<proc_seq/>
							<pubc_occr_seq/>
							<pubc_occr_dt/>
							<medi_cd/>
							<hndl_clsf/>
							<dlco_no/>
							<dlco_nm/>
							<advt_cont/>
							<sect_nm/>
							<cm/>
							<dn/>
							<uprc/>
							<advt_fee/>
							<vat/>
							<pubc_tot_amt/>
							<agn/>
							<agn_nm/>
							<fee_rate/>
							<fee/>
							<hndl_plac_cd/>
							<hndl_plac_nm/>
							<coms_rate/>
							<coms/>
							<advt_clas/>
							<indt_clsf/>
							<indt_clsf_nm/>
							<mony_kind/>
							<chro_clsf/>
							<type_clsf/>
							<type_clsf_nm/>
							<exrate/>
							<pubc_clsf/>
							<appndx_clsf/>
							<frex_cntr_amt/>
							<edt_clsf/>
							<grp_cmpy_cd/>
							<real_rate/>
							<tot_rate/>
							<net_rate/>
							<sel_rate>R</sel_rate>
							<slcrg_pers/>
							<slcrg_pers_nm/>
							<dept_cd/>
							<dept_nm/>
							<mchrg_pers/>
							<mchrg_pers_nm/>
							<rtax_yn/>
							<upd_resn/>
							<govern_advt_yn/>
							<upd_cont/>
							<tabl_yn/>
							<remk/>
							<pubc_dt/>
							<pre_pubc_slip_no/>
							<pre_pubc_slip_no_crte_dt/>
							<upd_yn/>
							<div_yn/>
							<clos_stat/>
							<clamt_stat/>
							<sale_stmt_issu_yn/>
							<purc_stmt_issu_yn/>
							<purc_stmt_issu_yn2/>
							<elec_tax_stmt_yn/>
							<pubc_side/>
							<preng_occr_dt/>
							<preng_occr_seq/>
							<std_clsf/>
							<pubc_prd/>
							<pubc_frdt/>
							<pubc_todt/>
							<hp_edt_clsf/>
							<brdg_advt_yn/>
							<seq_clsf>순번</seq_clsf>
							<nwsp_advt_yn/>
							<nwsp_side_type/>
							<dtls_medi_cd/>
							<dtnb_medi_cd/>
							<print_dt/>
							<pre_issu_yn/>
							<asist_pers/>
							<asist_pers_nm/>
							<brt_cd/>
							<multiUpdateData/>
							<pre_day_issu/>
						</resForm>
						<gridData1>
							<record>
								<sect_nm/>
								<dlco_nm/>
								<dn_cm/>
								<slcrg_pers_nm/>
								<preng_occr_dt/>
								<preng_occr_seq/>
							</record>
						</gridData1>
						<gridData2>
							<record>
								<sect_nm/>
								<dlco_nm/>
								<dn_cm/>
								<slcrg_pers_nm/>
								<pubc_occr_dt/>
								<pubc_occr_seq/>
								<pre_preng_yn/>
							</record>
						</gridData2>
						<gridData3>
							<record>
								<bus_plc/>
								<bus_clsf/>
								<bus_seq/>
							</record>
						</gridData3>
					</resData>
					<tempData>
						<keyData/>
					</tempData>
					<msgData/>
					<box_vis/>
				</root>
			</instance>
			<submission id="ad_pub_1000_m" action="/ad/pub/1000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="ad_pub_1010_s" action="/ad/pub/1010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm"/>
			<submission id="ad_pub_1020_l" action="/ad/pub/1020" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData1"/>
			<submission id="ad_pub_1025_s" action="/ad/pub/1025" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm"/>
			<submission id="ad_pub_1030_l" action="/ad/pub/1030" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData2"/>
			<submission id="ad_pub_1035_s" action="/ad/pub/1035" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm"/>
			<submission id="ad_pub_1050_a" action="/ad/pub/1050" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/msgData"/>
			<script type="javascript" ev:event="xforms-model-construct">
				<![CDATA[
					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					//initPage();	
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					model.send("ad_pub_1000_m");
					model.copyNode("/root/initData/comboSet", "/root/tempData");	
					// 본지 및 공통
					makeComboGubun("", "/root/initData/comboSet/grp_cmpy_cd"		, "item", "label", "value");
					makeComboGubun("", "/root/initData/comboSet/appndx_clsf"		, "item", "label", "value");
					makeComboGubun("", "/root/initData/comboSet/upd_resn"		, "item", "label", "value");
					makeComboGubun("", "/root/initData/comboSet/nwsp_side_type"	, "item", "label", "value");
					// 행복플러스 
					makeComboGubun("", "/root/initData/comboSet/hp_edt_clsf"		, "item", "label", "value");
					// 뉴미디어
					makeComboGubun("", "/root/initData/comboSet/std_clsf"			, "item", "label", "value");
					makeComboGubun("", "/root/initData/comboSet/pubc_prd"		, "item", "label", "value");

					model.refresh();
					initPage();	
					var name = model.property("ss_emp_no");
					if (name == "212529" || name == "215023") {
						btn_updpubc.disabled = true;
						btn_upd.disabled = true;
					}		
					
					//box_vis("out");
					
				]]>
			</script>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
				//전역변수 지면섹션
				var _sect_nm = ""; 
				// 관리항목
				var g_work_clsf = 	"";
				var g_medi_cd 	=	"";
				var g_proc_dt	=	"";
				var g_proc_seq	=	"";
				var g_pubc_dt	=	"";		
				// 광고료 , 부가세
				var g_advt_fee	=	0;
				var g_vat		=	0;
				
				function box_vis (chk)
				{
					
					if (chk == "out")
					{
					
							inp_dn.visible = false;
							inp_cm.visible = false;
							inp_uprc.visible = false;
							inp_advt_fee.visible = false;
							inp_vat.visible = false;
							inp_pubc_tot_amt.visible = false;
							inp_fee_rate.visible = false;
							inp_fee.visible = false;
							inp_coms_rate.visible = false;
							inp_coms.visible = false;
												
							oup_dn.visible = true;
							oup_cm.visible = true;
							oup_uprc.visible = true;
							oup_advt_fee.visible = true;
							oup_vat.visible = true;
							oup_pubc_tot_amt.visible = true;
							oup_fee_rate.visible = true;
							oup_fee.visible = true;
							oup_coms_rate.visible = true;
							oup_coms.visible = true;
						
					
					model.setValue("/root/box_vis", "out");
					}
					else 
					{						
						inp_dn.visible = true;
						inp_cm.visible = true;
						inp_uprc.visible = true;
						inp_advt_fee.visible = true;
						inp_vat.visible = true;
						inp_pubc_tot_amt.visible = true;
						inp_fee_rate.visible = true;
						inp_fee.visible = true;
						inp_coms_rate.visible = true;
						inp_coms.visible = true;
											
						oup_dn.visible = false;
						oup_cm.visible = false;
						oup_uprc.visible = false;
						oup_advt_fee.visible = false;
						oup_vat.visible = false;
						oup_pubc_tot_amt.visible = false;
						oup_fee_rate.visible = false;
						oup_fee.visible = false;
						oup_coms_rate.visible = false;
						oup_coms.visible = false;
						
					
					model.setValue("/root/box_vis", "in");
					}
				}
				
				function ButtonSet()
				{
					if( cmb_medi_cd.value == "350" )
					{
						btn_ins.disabled = false;
						btn_approve.disabled = true;
					}
					else if( cmb_medi_cd.value == "550" )
					{
						btn_ins.disabled = false;
						btn_approve.disabled = true;
					}					
					else if( cmb_medi_cd.value == "560" )
					{
						btn_ins.disabled = false;
						btn_approve.disabled = true;
					}
					else if( cmb_medi_cd.value == "150" )
					{
						btn_ins.disabled = false;
						btn_approve.disabled = true;
					}						
					else
					{
						btn_approve.disabled = false;
						if( cmb_hndl_clsf.value == "9" )		btn_ins.disabled = false;
						else							btn_ins.disabled = true;
					}
				}
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	매체 코드 변경에 따른 화면전환.
				/////////////////////////////////////////////////////////////////////
				function changeOnMediCd()
				{
					var medi_cd = model.getValue("/root/resData/resForm/medi_cd");

					if( medi_cd == "170" )
					{
						sw_add.visible = true;
						gr_issu.visible  = false;
						gr_nbiz.visible  = true;
						gr_bus.visible  = false;
						gr_nmd.visible = false;						
						cmb_dtls_medi_cd.visible = false;
						cmb_dtnb_medi_cd.visible = false;
						oup_advt_fee.visible = true;
						inp_advt_fee.visible = false;
						inp_fee_rate.visible = false;
						oup_fee_rate.visible = true;
						model.toggle("case3");
					}
					else if( medi_cd == "180"  )
					{
						sw_add.visible = true;
						gr_issu.visible  = false;
						gr_nbiz.visible  = true;
						gr_bus.visible  = false;
						gr_nmd.visible = false;								
						cmb_dtls_medi_cd.visible = true;
						cmb_dtnb_medi_cd.visible = false;
						oup_advt_fee.visible = true;
						inp_advt_fee.visible = false;
						inp_fee_rate.visible = false;
						oup_fee_rate.visible = true;
						model.toggle("case4");
					}
					else if( medi_cd == "350" )
					{
						sw_add.visible = true;
						gr_issu.visible  = false;
						//gr_nbiz.visible  = true;
						gr_nbiz.visible  = false;
						gr_bus.visible  = false;
						gr_nmd.visible = true;						
						cmb_dtls_medi_cd.visible = true;
						cmb_dtnb_medi_cd.visible = false;
						oup_advt_fee.visible = false;
						inp_advt_fee.visible = true;
						inp_fee_rate.visible = true;
						oup_fee_rate.visible = false;
						btn_row_add.visible = false;
						model.toggle("case4");
						//box_vis("in");
					}
					else if( medi_cd == "190" )
					{
						sw_add.visible = true;
						gr_issu.visible  = true;
						gr_nbiz.visible  = true;
						gr_bus.visible  = false;
						gr_nmd.visible = false;							
						cmb_dtls_medi_cd.visible = false;
						cmb_dtnb_medi_cd.visible = false;
						oup_advt_fee.visible = true;
						inp_advt_fee.visible = false;
						inp_fee_rate.visible = false;
						oup_fee_rate.visible = true;
						model.toggle("case5");
					}else if(medi_cd == "500"){
						sw_add.visible = true;
						gr_issu.visible  = false;
						gr_nbiz.visible  = false;
						gr_bus.visible  = false;
						gr_nmd.visible = false;							
						cmb_dtnb_medi_cd.visible = false;
						cmb_dtls_medi_cd.visible = false;
						oup_advt_fee.visible = true;
						inp_advt_fee.visible = false;
						inp_fee_rate.visible = false;
						oup_fee_rate.visible = true;
						model.toggle("case6");
					}else if(medi_cd == "540"){
						sw_add.visible = true;
						gr_issu.visible  = false;
						gr_nbiz.visible  = false;
						gr_bus.visible  = true;
						gr_nmd.visible = false;							
						btn_row_add.visible = true;
						cmb_dtnb_medi_cd.visible = false;
						cmb_dtls_medi_cd.visible = false;
						oup_advt_fee.visible = true;
						inp_advt_fee.visible = false;
						inp_fee_rate.visible = false;
						oup_fee_rate.visible = true;
						model.toggle("case6");
					}else if(medi_cd == "530"){
						sw_add.visible = true;
						gr_issu.visible  = false;
						gr_nbiz.visible  = false;
						gr_bus.visible  = false;
						gr_nmd.visible = false;							
						btn_row_add.visible = false;
						cmb_dtnb_medi_cd.visible = false;
						cmb_dtls_medi_cd.visible = false;
						oup_advt_fee.visible = true;
						inp_advt_fee.visible = false;
						inp_fee_rate.visible = false;
						oup_fee_rate.visible = true;
						model.toggle("case6");
					}else if(medi_cd == "550"){
						sw_add.visible = true;
						gr_issu.visible  = false;
						gr_nbiz.visible  = false;
						gr_bus.visible  = false;
						gr_nmd.visible = false;							
						btn_row_add.visible = false;
						cmb_dtnb_medi_cd.visible = false;
						cmb_dtls_medi_cd.visible = false;
						oup_advt_fee.visible = false;
						inp_advt_fee.visible = true;
						inp_fee_rate.visible = true;
						oup_fee_rate.visible = false;
						model.toggle("case6");
					}
					else if (medi_cd == "560"){
						sw_add.visible = true;
						gr_issu.visible  = false;
						gr_nbiz.visible  = false;
						gr_bus.visible  = false;
						gr_nmd.visible = false;							
						btn_row_add.visible = false;
						cmb_dtnb_medi_cd.visible = false;
						cmb_dtls_medi_cd.visible = false;
						oup_advt_fee.visible = false;
						inp_advt_fee.visible = true;
						inp_fee_rate.visible = true;
						oup_fee_rate.visible = false;
						model.toggle("case6");
					}
					else
					{
						sw_add.visible = false;
						gr_issu.visible  = true;
						gr_nbiz.visible  = true;	
						gr_bus.visible  = false;	
						gr_nmd.visible = false;							
						cmb_dtnb_medi_cd.visible = false;
						cmb_dtls_medi_cd.visible = false;
//						oup_advt_fee.visible = false;
//						inp_advt_fee.visible = true;
//						inp_fee_rate.visible = true;
//						oup_fee_rate.visible = false;
					}
					ButtonSet();
				}
				
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	속성값으로 키값이 저장되면 상세조회 함.
				//		키값이 없으면 화면 초기화
				/////////////////////////////////////////////////////////////////////
				function initPage()
				{
					var cur_date = dateAdd( "d", 0, getCurrentDate() );
					// 1. 키값 셋팅후 상세조회..
					if( model.property(KEY_MEDI_CD) != "" && model.property(KEY_PROC_DT) != "" && model.property(KEY_PROC_SEQ) != "" )
					{
						model.setValue("/root/resData/resForm/medi_cd"	, model.property(KEY_MEDI_CD));
						model.setValue("/root/resData/resForm/proc_dt"	, model.property(KEY_PROC_DT));
						model.setValue("/root/resData/resForm/proc_seq"	, model.property(KEY_PROC_SEQ));
						model.property(KEY_MEDI_CD) 	= "";
						model.property(KEY_PROC_DT) 	= "";
						model.property(KEY_PROC_SEQ) 	= "";
						
						loadData();
					}
					else
					{
						model.resetInstanceNode("/root/resData/resForm");
						
						cmb_medi_cd.select(0);
						cmb_hndl_clsf.select(0);
						cmb_advt_clas.select(0);
						cmb_pubc_clsf.select(0);
						cmb_chro_clsf.value 	=	"2";
						cmb_mony_kind.value	= 	"KRW";
						cmb_edt_clsf.select(0);

						if( inp_proc_dt.value == "" || inp_pubc_dt.value == "" )
						{
							model.setValue("/root/reqData/searchData/search_dt"	, cur_date);
							model.setValue("/root/resData/resForm/pubc_dt"		, cur_date);
							model.setValue("/root/resData/resForm/proc_dt"		, cur_date);
							model.setValue("/root/resData/resForm/print_dt"		, cur_date);
						}

						inp_pubc_dt.disabled		= false
						gr_issu.visible 			= true;
						
						model.refresh();
						
						if( sw_list.selectedIndex == 0 )		loadPreng();
						else							loadPubc();
						
						//전역변수 지면섹션
						_sect_nm 		= ""; 
						// Key
						g_work_clsf	= "";
						g_medi_cd 	= "";
						g_proc_dt		= "";
						g_proc_seq	= "";		
						g_pubc_dt		= "";		
						// 광고료 , 부가세
						g_advt_fee		= "";
						g_vat			= "";
						DisplaySet();
					}
					
					changeOnMediCd();
					
				}
				
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	예약승인 조회.
				/////////////////////////////////////////////////////////////////////
				function loadPreng(){	
					btn_preng.selected = true;		
					model.toggle("case1");	
					model.setValue("/root/reqData/searchData/medi_cd", model.getValue("/root/resData/resForm/medi_cd"));
					model.send("ad_pub_1020_l");
				}
				
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	게재실적 조회.
				/////////////////////////////////////////////////////////////////////
				function loadPubc(){	
					btn_pubc.selected = true;
					model.toggle("case2");
					model.setValue("/root/reqData/searchData/medi_cd", model.getValue("/root/resData/resForm/medi_cd"));
					//busInit();//뉴비즈 버스승강장 초기화
					model.send("ad_pub_1030_l");
					// 그리드 색깔 표시.
					for( var i=dg_pubc.fixedRows;i<dg_pubc.rows;i++ ){
						var pre_preng_yn	=	dg_pubc.valueMatrix(i, dg_pubc.colRef("pre_preng_yn"));
						if( pre_preng_yn == "Y" ){
							dg_pubc.cellstyle("background-color", i, dg_pubc.colRef("sect_nm"), i, dg_pubc.colRef("sect_nm")) = "#FFF000";
						}
						else{
							dg_pubc.cellstyle("background-color", i, dg_pubc.colRef("sect_nm"), i, dg_pubc.colRef("sect_nm")) = "#FFFFFF";
						}
					}
					dg_pubc.refresh();
				}
				
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	세팅된 전역변수 표시.
				//		
				/////////////////////////////////////////////////////////////////////
				function DisplaySet()
				{
					otp_pubc_slip_no.value = g_work_clsf + "-" + g_medi_cd + "-" + g_proc_dt  + "-" + g_proc_seq;
					otp_pubc_slip_no.refresh();
				}				
				
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	게재전표 조회.
				//		조회 후에는 최초게재일자를 수정할 수 없도록 비활성화 시켜야 함.
				/////////////////////////////////////////////////////////////////////
				function loadDataSet()
				{
					var cur_date 	= dateAdd( "d", 0, getCurrentDate() );
					var clos_stat	= model.getValue("/root/resData/resForm/clos_stat");
					g_work_clsf	= "S";
					g_medi_cd	= model.getValue("/root/resData/resForm/medi_cd");
					g_proc_dt		= model.getValue("/root/resData/resForm/proc_dt");
					g_proc_seq	= model.getValue("/root/resData/resForm/proc_seq");
					g_pubc_dt		= model.getValue("/root/resData/resForm/pubc_dt");
					g_advt_fee		= model.getValue("/root/resData/resForm/advt_fee");
					g_vat			= model.getValue("/root/resData/resForm/vat");
					g_pubc_dt		= model.getValue("/root/resData/resForm/pubc_dt");
					
					model.makeNode("/root/resData/resForm/multiUpdateData");
					
					//inp_search_dt.value =  g_pubc_dt;
					//inp_search_dt.refresh();

					//if( cur_date == g_pubc_dt && cur_date ==  g_proc_dt ){
					//if( trim(clos_stat) == "" || trim(clos_stat) == "마감취소"){
					// 일단 최초게재일 수정은 무조건 막자.
					//inp_pubc_dt.disabled 	= true;
					//}
					//else{
					//	inp_pubc_dt.disabled = true;
					//}
					DisplaySet();
					ButtonSet();
				}
				
				function loadData()
				{
					var medi_cd   	= model.getValue("/root/resData/resForm/medi_cd");
					var proc_dt    	= model.getValue("/root/resData/resForm/proc_dt");
					var proc_seq 	= model.getValue("/root/resData/resForm/proc_seq");
					
					if( medi_cd == "" ||proc_dt == "" || proc_seq == "" )
					{
						alert("게재전표번호를 입력하세요.");
						model.reset();
						initPage();
						return;
					}
					else
					{
						model.setValue("/root/reqData/searchData/medi_cd"	, medi_cd);
						model.setValue("/root/reqData/searchData/proc_dt"		, proc_dt);
						model.setValue("/root/reqData/searchData/proc_seq"	, proc_seq);
						
						busInit();//뉴비즈 버스승강장 초기화
						
						model.send("ad_pub_1010_s");
						if( submit_completed() )
						{	
							loadDataSet();
							box_vis("out");
						}
						else
						{
							model.reset();
							initPage();
						}
					}				
				}
				
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	거래처에 관련된 기본정보를 링크함.
				//		그룹사, 영업담당(부서), 관리담당
				/////////////////////////////////////////////////////////////////////
				function setChrgInfo()
				{
					if( cmb_medi_cd.value == "350" )		return;
					modelSendNoMake("ad_co_9007_s", "/ad/common/9007", "/root/resData/resForm", "/root/tempData");	
					if( submit_completed() ){
						model.setValue("/root/resData/resForm/grp_cmpy_cd"	, model.getValue("/root/tempData/grp_cmpy_cd"));
						
						if( model.getValue("/root/resData/resForm/slcrg_pers") == "" ){
							model.setValue("/root/resData/resForm/slcrg_pers"		, model.getValue("/root/tempData/slcrg_pers"));
							model.setValue("/root/resData/resForm/slcrg_pers_nm"	, model.getValue("/root/tempData/slcrg_pers_nm"));
						}
//						if( model.getValue("/root/resData/resForm/slcrg_pers_nm") == "" ){
//							model.setValue("/root/resData/resForm/slcrg_pers_nm"	, model.getValue("/root/tempData/slcrg_pers_nm"));
//						}
						if( model.getValue("/root/resData/resForm/dept_cd") == "" ){
							model.setValue("/root/resData/resForm/dept_cd"		, model.getValue("/root/tempData/dept_cd"));
							model.setValue("/root/resData/resForm/dept_nm"		, model.getValue("/root/tempData/dept_nm"));
						}
//						if( model.getValue("/root/resData/resForm/dept_nm") == "" ){
//							model.setValue("/root/resData/resForm/dept_nm"		, model.getValue("/root/tempData/dept_nm"));
//						}
						if( model.getValue("/root/resData/resForm/mchrg_pers") == "" ){
							model.setValue("/root/resData/resForm/mchrg_pers"	, model.getValue("/root/tempData/mchrg_pers"));
							model.setValue("/root/resData/resForm/mchrg_pers_nm"	, model.getValue("/root/tempData/mchrg_pers_nm"));
						}
//						if( model.getValue("/root/resData/resForm/mchrg_pers_nm") == "" ){
//							model.setValue("/root/resData/resForm/mchrg_pers_nm"	, model.getValue("/root/tempData/mchrg_pers_nm"));
//						}
						if( model.getValue("/root/resData/resForm/indt_clsf") == "" ){
							model.setValue("/root/resData/resForm/indt_clsf"		, model.getValue("/root/tempData/indt_cd"));
							model.setValue("/root/resData/resForm/indt_clsf_nm"	, model.getValue("/root/tempData/indt_nm"));
						}
						if( model.getValue("/root/resData/resForm/type_clsf") == "" ){
							model.setValue("/root/resData/resForm/type_clsf"		, model.getValue("/root/tempData/type_cd"));
							model.setValue("/root/resData/resForm/type_clsf_nm"	, model.getValue("/root/tempData/type_nm"));
						}
						model.refresh();
					}
				}
				
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	거래처에 관련된 기본정보를 링크함.
				//		그룹사, 영업담당(부서), 관리담당
				/////////////////////////////////////////////////////////////////////
				function setMchrgInfo()
				{
					if( cmb_medi_cd.value == "350" )		return;
					var dlco_no	=	"";
					var hndl_clsf	=	model.getValue("/root/resData/resForm/hndl_clsf");
					
					if( hndl_clsf == "2" ){
						dlco_no	=	model.getValue("/root/resData/resForm/agn");
					}
					else if( hndl_clsf == "4" ){
						dlco_no	=	model.getValue("/root/resData/resForm/agn");
						if( dlco_no == "" )	dlco_no	=	model.getValue("/root/resData/resForm/hndl_plac_cd");
					}
					else{
						return;
					}
					
					makeNodeValue("/root/tempData/dlco_no", dlco_no);
					modelSendNoMake("ad_co_9007_s", "/ad/common/9007", "/root/tempData", "/root/tempData");	
					if( submit_completed() ){
						model.setValue("/root/resData/resForm/mchrg_pers"		, model.getValue("/root/tempData/mchrg_pers"));
						model.setValue("/root/resData/resForm/mchrg_pers_nm"		, model.getValue("/root/tempData/mchrg_pers_nm"));
						model.refresh();
					}
				}
			
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	거래처 조회.
				//		현재 사용 안함. js이용함.
				/////////////////////////////////////////////////////////////////////
				function setDlcoInfo(dlco_no, dlco_nm){
					var gnr_advcs_yn = model.getValue("/root/reqData/fwdData/gnr_advcs_yn");
					var agn_yn       = model.getValue("/root/reqData/fwdData/agn_yn");
					var advt_bo_yn   = model.getValue("/root/reqData/fwdData/advt_bo_yn");
					var bo_bof_yn    = model.getValue("/root/reqData/fwdData/bo_bof_yn");
					
					if( gnr_advcs_yn == "Y" ){									
						model.setValue("/root/resData/resForm/dlco_no"	, dlco_no);
						model.setValue("/root/resData/resForm/dlco_nm"	, dlco_nm);					
						inp_dlco_no.refresh();
						inp_dlco_nm.refresh();	
						setChrgInfo();				
					}
					else if(agn_yn == "Y"){									
						model.setValue("/root/resData/resForm/agn"		, dlco_no);
						model.setValue("/root/resData/resForm/agn_nm"	, dlco_nm);					
						inp_agn.refresh();
						inp_agn_nm.refresh();				
					}
					else if(advt_bo_yn == "Y" || bo_bof_yn == "Y"){									
						model.setValue("/root/resData/resForm/hndl_plac_cd"	, dlco_no);
						model.setValue("/root/resData/resForm/hndl_plac_nm"	, dlco_nm);					
						inp_hndl_plac_cd.refresh();
						inp_hndl_plac_nm.refresh();				
					}					
				}
				
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	정부광고 거래처 조회.
				//		생활미디어-하드코딩
				/////////////////////////////////////////////////////////////////////
				function setGovernAdvtYn(){
					var agn = model.getValue("/root/resData/resForm/agn");
					if( agn == "00038157" || agn == "10000319" ){
						model.setValue("/root/resData/resForm/govern_advt_yn", "Y");
					}
					else{
						model.setValue("/root/resData/resForm/govern_advt_yn", "N");
					}
					boo_govern_advt_yn.refresh();
				}
				
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	예약전표 조회.
				//		
				/////////////////////////////////////////////////////////////////////
				function selectPubcPreng(preng_occr_dt, preng_occr_seq){
					model.setValue("/root/reqData/searchData/preng_occr_dt"	, preng_occr_dt);
					model.setValue("/root/reqData/searchData/preng_occr_seq"	, preng_occr_seq);
					model.send("ad_res_1210_s");
					model.refresh();
				}
				
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	게재전표 조회.
				//		
				/////////////////////////////////////////////////////////////////////
				function selectPubc(pubc_occr_dt, pubc_occr_seq){
					model.setValue("/root/reqData/searchData/pubc_occr_dt"		, pubc_occr_dt);
					model.setValue("/root/reqData/searchData/pubc_occr_seq"	, pubc_occr_seq);
					model.send("ad_res_1260_s");
					model.refresh();
				}
				
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	업종구분 셋
				//		
				/////////////////////////////////////////////////////////////////////
				function setIndt(indt_clsf, indt_clsf_nm){
					model.setValue("/root/resData/resForm/indt_clsf"		, indt_clsf);
					model.setValue("/root/resData/resForm/indt_clsf_nm"	, indt_clsf_nm);
					inp_indt_clsf.refresh();	
					inp_indt_clsf_nm.refresh();
				}		
			
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	유형구분 셋
				//		
				/////////////////////////////////////////////////////////////////////
				function setType(type_clsf, type_clsf_nm){
					model.setValue("/root/resData/resForm/type_clsf"		, type_clsf);
					model.setValue("/root/resData/resForm/type_clsf_nm"	, type_clsf_nm);
					inp_type_clsf.refresh();	
					inp_type_clsf_nm.refresh();
				}
			
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	면 조회.
				//		매체, 게재일자, 면으로 단, CM, 색도를 조회함.
				/////////////////////////////////////////////////////////////////////
				function setIssuInfo()
				{
					upperCase(inp_sect_nm);
					var sect_nm 	=  model.getValue("/root/resData/resForm/sect_nm");
					var medi_cd 	=  model.getValue("/root/resData/resForm/medi_cd");
					var pubc_dt 	=  model.getValue("/root/resData/resForm/pubc_dt");
					if( sect_nm != "" && pubc_dt != "" )
					{
						sect_nm = sect_nm.toUpperCase();
						//if( sect_nm == _sect_nm ) 	return;
						
						model.setValue("/root/resData/resForm/sect_nm", sect_nm);
						inp_sect_nm.refresh();
						
						model.makeNode("/root/reqData/searchData/sect_nm");
						model.setValue("/root/reqData/searchData/sect_nm", 		sect_nm);
						model.setValue("/root/reqData/searchData/medi_cd", 		medi_cd);
						model.setValue("/root/reqData/searchData/preng_occr_dt", 	pubc_dt);
						modelSendNoMake("ad_co_9003_s", "/ad/common/9003", "/root/reqData/searchData", "/root/tempData");	
					
						if( medi_cd != "110" )
						{
							model.setValue("/root/resData/resForm/dn", 	model.getValue("/root/tempData/dn"));
							model.setValue("/root/resData/resForm/cm", 	model.getValue("/root/tempData/cm"));
						}
						//  결과셋
						//if( model.getValue("/root/resData/resForm/dn") == ""  && model.getValue("/root/resData/resForm/cm") == "" ){
						//model.setValue("/root/resData/resForm/dn", 	model.getValue("/root/tempData/dn"));
						//model.setValue("/root/resData/resForm/cm", 	model.getValue("/root/tempData/cm"));
						//}
						model.setValue("/root/resData/resForm/chro_clsf", 		model.getValue("/root/tempData/chro_clsf"));
						model.setValue("/root/resData/resForm/pubc_side", 	model.getValue("/root/tempData/issu_side"));
						if( model.getValue("/root/tempData/issu_side") == "" )
						{
							alert("해당면이 없습니다.");
							model.setValue("/root/resData/resForm/sect_nm", "");
						}
						model.refresh();
						
						_sect_nm = sect_nm;
					}								
				}
				
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	입력, 수정시 게재정보 체크
				//		2010.03.29  KBS - 단위별로 체크하도록 수정
				/////////////////////////////////////////////////////////////////////
				function chkForm(){
					var medi_cd 	= model.getValue("/root/resData/resForm/medi_cd");
					var pubc_side 	= model.getValue("/root/resData/resForm/pubc_side");
					var dn 		= Number(model.getValue("/root/resData/resForm/dn"));
					var cm 		= Number(model.getValue("/root/resData/resForm/cm"));
					switch( medi_cd ){
					case "150":
						if( pubc_side == "" ){
							alert("게재등록을 할 수 없는 면수입니다.\n\r월별발행면수를 확인하세요.");
							model.setFocus("inp_sect_nm");
							return false;
						}
						
						if( Math.abs(dn) > 15 ){
							alert("게재크기가 허용범위를 초과하였습니다.");
							model.setFocus("inp_dn");
							return false;
						}
					break;
					case "170":
					break;
					case "180":
					break;
					case "350":
					break;
					case "500":
					break;
					case "540":
					break;
					case "530":
					break;	
					case "560":
					break;	
					case "550":
					break;	
					default:
						if( pubc_side == "" ){
							alert("게재등록을 할 수 없는 면수입니다.\n\r월별발행면수를 확인하세요.");
							model.setFocus("inp_sect_nm");
							return false;
						}
						
						if( Math.abs(dn) > 15 && Math.abs(cm) > 37 ){
							alert("게재크기가 허용범위를 초과하였습니다.");
							model.setFocus("inp_dn");
							return false;
						}
					break;
					}
					
					return true;
				}
				
				function chkDate()
				{
					if( !commGhkCal("/root/resData/resForm/pubc_dt") )
					{
						alert("게재일자가 올바른 날짜가 아닙니다.");
						model.setFocus("inp_pubc_dt");
						return false;
					}
					if( !commGhkCal("/root/resData/resForm/proc_dt") )
					{
						alert("전표일자가 올바른 날짜가 아닙니다.");
						model.setFocus("inp_proc_dt");
						return false;
					}
					return true;
				}
				
				function chkDlco()
				{
					var dlco_no  		= model.getValue("/root/resData/resForm/dlco_no");			//광고주
					var hndl_clsf 		= model.getValue("/root/resData/resForm/hndl_clsf");		//취급구분
					var agn 			= model.getValue("/root/resData/resForm/agn");			//대행사
					var agn_nm		= model.getValue("/root/resData/resForm/agn_nm");
					var hndl_plac_cd 	= model.getValue("/root/resData/resForm/hndl_plac_cd");		//취급처
					var hndl_plac_nm 	= model.getValue("/root/resData/resForm/hndl_plac_nm");	
					// 조선일보사 - 하드코딩
					if( dlco_no == "00040020" )
					{
						if( hndl_clsf != '9' )
						{
							alert("광고주가 조선일보사이면 취급구분이 (9 자사광고) 이어야 합니다. 취급구분을 확인하십시요.");
							model.setFocus("cmb_hndl_clsf");
							return false;
						}
					}

					switch( hndl_clsf )
					{
					case "1":
					{
						if( agn != "" || agn_nm != "" )
						{
							alert("취급구분이 광고주일 경우 대행사를 입력할 수 없습니다. 대행사를 확인하십시요.");
							model.setFocus("inp_agn_nm");
							return false;
						}
						if( hndl_plac_cd != "" || hndl_plac_nm != "" )
						{
							alert("취급구분이 광고주일 경우 취급처를 입력할 수 없습니다. 취급처를 확인하십시요.");
							model.setFocus("inp_hndl_plac_nm");
							return false;
						}
					}
					break;
					case "2":
					{
						if( agn == "" || agn_nm == "" )
						{
							alert("취급구분이 대행사일 경우 대행사는 필수 입력사항입니다.");
							model.setFocus("inp_agn_nm");
							return false;
						}		
						if(hndl_plac_cd != "" || hndl_plac_nm != "" )
						{
							alert("취급처구분이 대행사일 경우 취급처를 입력할 수 없습니다. 취급처를 확인하십시요.");
							model.setFocus("inp_hndl_plac_nm");
							return false;
						}
					}
					break;
					case "3":
					{
						if( agn != "" || agn_nm != "" )
						{
							alert("취급구분이 직입일 경우 대행사를 입력할 수 없습니다. 대행사를 확인하십시요.");
							model.setFocus("inp_agn_nm");
							return false;
						}
						if( hndl_plac_cd != "" || hndl_plac_nm != "" )
						{
							alert("취급구분이 직입일 경우 취급처를 입력할 수 없습니다. 취급처를 확인하십시요.");
							model.setFocus("inp_hndl_plac_nm");
							return false;
						}
					}
					break;
					case "4":
					{
						if( hndl_plac_cd == "" || hndl_plac_nm == "" )
						{
							alert("취급구분이 광고지사일 경우 취급처는 필수 입력사항입니다.");
							model.setFocus("inp_hndl_plac_nm");
							return false;
						}
					}
					break;
					case "5":
					{
						if( hndl_plac_cd == "" || hndl_plac_nm == "" )
						{
							alert("취급구분이 지사지국일 경우 취급처는 필수 입력사항입니다.");
							model.setFocus("inp_hndl_plac_nm");
							return false;
						}
					}
					break;
					case "7":
					{
						if( hndl_plac_cd == "" || hndl_plac_nm == "" )
						{
							alert("취급구분이 해외지사일 경우 취급처는 필수 입력사항입니다.");
							model.setFocus("inp_hndl_plac_nm");
							return false;
						}
					}
					break;
					case "9":
					{
						if( agn != "" || agn_nm != "" )
						{
							alert("취급구분이 자사광고일 경우 대행사를 입력할 수 없습니다. 대행사를 확인하십시요.");
							model.setFocus("inp_agn_nm");
							return false;
						}
						if( hndl_plac_cd != "" || hndl_plac_nm != "" )
						{
							alert("취급구분이 자사광고일 경우 취급처를 입력할 수 없습니다. 취급처를 확인하십시요.");
							model.setFocus("inp_hndl_plac_nm");
							return false;
						}
					}
					break;
					default:
					break;
					}

					return true;
				}
				
				function chkAmount(){
					//화폐종류가 원화가 아닐경우 환율과 외화게재액을 반드시 입력한다.
					var mony_kind 		= 	model.getValue("/root/resData/resForm/mony_kind");
					var exrate			=	model.getValue("/root/resData/resForm/exrate");	
					var frex_cntr_amt	=	model.getValue("/root/resData/resForm/frex_cntr_amt");
					var advt_fee		=	model.getValue("/root/resData/resForm/advt_fee");
					var vat			=	model.getValue("/root/resData/resForm/vat");
					var rtax_yn 		= 	model.getValue("/root/resData/resForm/rtax_yn");	//면세여부
					var pubc_tot_amt	= 	model.getValue("/root/resData/resForm/pubc_tot_amt");
					
					var dn			=	model.getValue("/root/resData/resForm/dn");
					var cm			=	model.getValue("/root/resData/resForm/cm");
					var uprc			=	model.getValue("/root/resData/resForm/uprc");
					
					var ocha			=	0;
					
					if( mony_kind == "KRW" )
					{
						if( Number(frex_cntr_amt) != 0 )
						{
							alert("한국화폐일 경우 외화게재액을 입력할 수 없습니다.");
							model.setFocus("inp_frex_cntr_amt");
							return false;
						}
						else
						{
							if( rtax_yn == "Y" )
							{
								if( vat != 0 )
								{
									alert("면세일 경우 부가세를 입력할 수 없습니다.");
									model.setFocus("inp_vat");
									return false;
								}
								else
								{
									if( advt_fee != pubc_tot_amt )
									{
										alert("면세광고일 경우 광고료와 게재총액이 일치하여야 합니다.");
										return false;
									}
								}
							}
							else
							{
								ocha = Math.abs(Math.round(advt_fee*0.1-vat));
								if( ocha > 100 )
								{
									alert("부가세의 오차는 100원을 초과할 수 없습니다.");
									model.setFocus("inp_vat");
									return false;
								}
							}
							
							if( Number(advt_fee) + Number(vat) != Number(pubc_tot_amt) )
							{
								alert("광고료와 부가세 합이 게재총액과 다릅니다.");
								alert(Number(advt_fee) + Number(vat));
								return false;
							}
						}
					}
					else
					{
						if( Number(exrate) == 0 )
						{
							alert("환율정보가 없습니다. 회계팀에 문의하세요.");
							model.setFocus("cmb_mony_kind");
							return false;
						}
						else if( Number(frex_cntr_amt) == 0 )
						{
							alert("외화게재일 경우 외화게재액은 필수 입력사항입니다.");
							model.setFocus("inp_frex_cntr_amt");
							return false;
						}
						else if( rtax_yn != "Y" || vat != 0 )
						{
							alert("외화게재일 경우 면세여부를 체크하세요.");
							return;
						}
						else
						{
							ocha = Math.abs(Math.round(advt_fee - frex_cntr_amt*exrate));
							if( ocha > 1000 )
							{
								alert("외화게재액과 광고료의 차이가 1,000원을 초과할 수 없습니다.");
								model.setFocus("inp_advt_fee");
							}
						}
					}
					
					// 단가*게재크기 = 광고료 체크 - 300원차이 기준 0.49999*555 = 277.499
					// 단가체크 = 555크기일때 300원이므로 300*cm*dm/555 계산식으로 함.
					var uprc_value = Math.round(300*dn*cm/555);
					ocha = Math.abs(Math.round(advt_fee-(dn*cm*uprc)));
/*수정시 단가 체크는 무의미하다고 함 황일록 요청사항
					if( ocha > uprc_value && cmb_medi_cd.value != "350" )
					{
						alert("단가와 광고료의 오차가 " + uprc_value + "원을 초과할 수 없습니다.");
						model.setFocus("inp_uprc");
						return false;
					}
*/					
					return true;
				}
				
				function chkFee()
				{
					var medi_cd 		= model.getValue("/root/resData/resForm/medi_cd");
					var edt_clsf		= model.getValue("/root/resData/resForm/edt_clsf");
					// 대행료
					var agn 			= model.getValue("/root/resData/resForm/agn");			//대행사					
					var fee  			= Number(model.getValue("/root/resData/resForm/fee"));
					var fee_rate 		= Number(model.getValue("/root/resData/resForm/fee_rate"));
					// 수수료
					var hndl_plac_cd 	= model.getValue("/root/resData/resForm/hndl_plac_cd");		//취급처
					var coms		 	= Number(model.getValue("/root/resData/resForm/coms"));
					var coms_rate 		= Number(model.getValue("/root/resData/resForm/coms_rate"));
					// 금액 오차 체크
					var vat			= Number(model.getValue("/root/resData/resForm/vat"));
					var pubc_tot_amt	= Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));
					var tot_agent		= 0;
					var tot_coms		= 0;
					var ocha			= 0;
					var rate            = 0;
					
					// 1. 대행료 체크
					if( agn == "" )
					{
						if( fee != 0 || fee_rate != 0 )
						{
							alert("대행사가 없을 경우 대행료를 입력할 수 없습니다.");
							model.setFocus("inp_fee_rate");
							return false;
						}
					}
					else
					{
						if( fee == 0 || fee_rate == 0 )
						{
							//alert("대행사가 있을 경우 대행료는 필수 입력사항 입니다.");
							//model.setFocus("inp_fee_rate");
							//return false;
							//if( windowConfirm("해당 게재를 대행료 선공제건으로 입력하시겠습니까?") == false )
							if( windowConfirm("해당 게재가 대행료를 기입하지 않은 상태입니다.\n\r입력하시겠습니까?") == false )
							{
								return false;
							}
						}
						else
						{
							if( medi_cd == "190" )
							{	// 행복플러스 -26.4 ~ +26.4
							    //20120710 김상훈 요율 변경
								/*
								if( fee_rate < -26.4 || fee_rate > 26.4 )
								{
									alert("행복플러스의 대행료율 범위는 | 26.4% | 입니다.");
									model.setFocus("inp_fee_rate");
									return false;
								}
								*/
								//20130705 김상훈 요율 변경
								if( fee_rate < -20 || fee_rate > 20 )
								{
									alert("행복플러스의 대행료율 범위는 | 20% | 입니다.");
									model.setFocus("inp_fee_rate");
									return false;
								}								
							}else if( medi_cd == "350" )
							{	//2012.12.12 김상훈 뉴미디어 대행료율 별도 운영함 
								if( fee_rate < -80 || fee_rate > 80 )
								{
									alert("뉴미디어의 대행료율 범위는 | 80% | 입니다.");
									model.setFocus("inp_fee_rate");
									return false;
								}								
							}
							else
							{			
								if( edt_clsf == "2" )
								{			// 지방판 -25 ~ +25
									if( fee_rate < -25 || fee_rate > 25 )
									{
										alert("지방판의 대행료율 범위는 | 25% | 입니다.");
										model.setFocus("inp_fee_rate");
										return false;
									}
								}
								else
								{
									// 그 외 -15 ~ +15
									if( fee_rate < -15 || fee_rate >15 )
									{
										alert("대행료율 범위는 | 15% | 입니다.");
										model.setFocus("inp_fee_rate");
										return false;
									}
								}
							}
						}
					}			
					
					// 2. 수수료 체크
					if( hndl_plac_cd == "" )
					{
						if( coms != 0 || coms_rate != 0 )
						{
							alert("취급처가 없을 경우 수수료를 입력할 수 없습니다.");
							model.setFocus("inp_coms_rate");
							return false;
						}
					}
					else
					{
						if( coms == 0 || coms_rate == 0 )
						{
							//alert("취급처가 있을 경우 수수료는 필수 입력사항 입니다.");
							//model.setFocus("inp_coms_rate");
							//return false;
							if( windowConfirm("해당 게재가 수수료를 기입하지 않은 상태입니다.\n\r입력하시겠습니까?") == false )
							{
								return false;
							}
						}
						else
						{
							if( medi_cd == "130" )
							{					// 소년 -30 ~ +30
								if( coms_rate < -30 || coms_rate > 30 )
								{
									alert("소년의 수수료율 범위는 | 30% | 입니다.");
									model.setFocus("inp_coms_rate");
									return false;
								}
							}
							else if( medi_cd == "190" )
							{				// 행복플러스 -26.4 ~ +26.4
							//20120710 김상훈 수수료율 26.4에서 24로 수정
							//20130705 김상훈 요율 변경 24에서 20으로 수정 
								if( coms_rate < -20 || coms_rate > 20 )
								{
									alert("행복플러스의 수수료율 범위는 | 20% | 입니다.");
									model.setFocus("inp_coms_rate");
									return false;
								}
							}
							else
							{
								if( edt_clsf == "2" )
								{							// 지방판 -25 ~ +25
									if( coms_rate < -25 || coms_rate > 25 )
									{
										alert("지방판의 수수료율 범위는 | 25% | 입니다.");
										model.setFocus("inp_coms_rate");
										return false;
									}
								}
								else
								{					
									if( coms_rate < -20 || coms_rate > 20 )
									{	// 그 외 -20 ~ +20
										alert("수수료율 범위는 | 20% | 입니다.");
										model.setFocus("inp_coms_rate");
										return false;
									}
								}
								
							}
						}
					}
					//행복플러스는 대행사와 지사가 같이 있는 경우가 있음
					//그럴 경우 두개의 요율 합이 24를 넘을면 안됨
					//20120710 김상훈
					//20130705 김상훈 24에서 20으로 수정함 
					if(agn != "" && hndl_plac_cd != "")
					{
						if(medi_cd == "190"){
							rate = fee_rate + coms_rate;
							if(rate < -20 || rate > 20 )
							{
								alert("수수료율 합의 범위는 | 20% | 입니다.");
								model.setFocus("inp_fee_rate");
								return false;							
							}
						}
					}
					// 3. 대행수수료 오차 체크
					// 대행료율:수수료율이 7:8 or 8:7일 땐 각각 7.5로 계산해서 오차판단
					// 해당 내용은 7.5 소숫점 적용으로 해결함. 단, 과거의 데이터를 위하여 소스는 남겨둠.
					if( (fee_rate == 7 && coms_rate == 8) ||  (fee_rate == 8 && coms_rate == 7) ){	// 7.5로 각각 계산
						if( vat == 0 )
						{	// VAT=0 이면 게재총액 = 게재총액 * 1.1
							tot_agent	= Math.round(pubc_tot_amt * 1.1 * 7.5 / 100);
							tot_coms 	= tot_agent;
						}
						else
						{
							tot_agent 	= Math.round(pubc_tot_amt * 7.5 / 100);
							tot_coms	= tot_agent;
						}
					}
					else
					{
						if( vat == 0 )
						{
							tot_agent 	= Math.round(pubc_tot_amt * 1.1 * fee_rate / 100);
							tot_coms	= Math.round(pubc_tot_amt * 1.1 * coms_rate / 100);
						}
						else
						{
							tot_agent 	= Math.round(pubc_tot_amt * fee_rate / 100);
							tot_coms	= Math.round(pubc_tot_amt * coms_rate / 100);
						}		
					}			
					// 오차 = 입력대행료 - 요율계산대행료
		            		ocha = Math.abs(fee - tot_agent);
		            		// 대행료 오차가 게재총액 0.5%보다 크면 경고
		            		if( ocha > Math.abs(Math.round(pubc_tot_amt * 0.5 / 100)) )
		            		{
		            			alert("대행료의 오차가 게재총액의 0.5%를 초과했습니다.\n\r입력하시려면 회계팀에 문의하십시오.");
		            			model.setFocus("inp_fee_rate");
		               		return false;
		            		}
		            		
		            		ocha = Math.abs(coms - tot_coms);
		            		if( ocha > Math.abs(Math.round(pubc_tot_amt * 0.5/100)) )
		            		{
		            			alert("수수료의 오차가 게재총액의 0.5%를 초과했습니다.\n\r입력하시려면 회계팀에 문의하십시오.");
		            			model.setFocus("inp_coms_rate");
		               		return false;
		            		}	
		            		return true;
				}
				
				function chkVat(){
					var rtax_yn = model.getValue("/root/resData/resForm/rtax_yn");	//면세여부					
					if( rtax_yn == "Y" ){
						if( vat != 0 ){
							alert("면세일 경우 부가세를 입력할 수 없습니다.");
							model.setFocus("inp_vat");
							return false;
						}
					}
					return true;
				}
				
				function checkAll(){
					// 1. 면 및 단 체크
					if( chkForm() == false )	return false;
					
					// 2. 날짜 체크
					if( chkDate() == false )	return false;
					
					// 3. 취급처 체크
					if( chkDlco() == false )	return false;
					
					// 4. 화폐종류 및 금액 체크
					if( chkAmount() == false )	return false;
					
					// 5. 대행료 및 수수료 체크
					if( chkFee() == false )	return false;
					
					return true;
				}
				
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	게재액 재계산
				// 인자 : 	in_gijun - U, A, V, T
				/////////////////////////////////////////////////////////////////////
				function recalculate(in_gijun){
					var pubc_tot_amt	=	Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));				
					var advt_fee 		=	Number(model.getValue("/root/resData/resForm/advt_fee"));					
					var vat 			=	Number(model.getValue("/root/resData/resForm/vat"));				
					var uprc			=	Number(model.getValue("/root/resData/resForm/uprc"));					
					var dn			=	Number(model.getValue("/root/resData/resForm/dn"));				
					var cm			=	Number(model.getValue("/root/resData/resForm/cm"));
					var fee_rate		=	Number(model.getValue("/root/resData/resForm/fee_rate"));
					var fee			=	Number(model.getValue("/root/resData/resForm/fee"));
					var coms_rate		=	Number(model.getValue("/root/resData/resForm/coms_rate"));
					var coms			=	Number(model.getValue("/root/resData/resForm/coms"));
					var rtax_yn		=	model.getValue("/root/resData/resForm/rtax_yn");

					// 1. 기초 금액 계산
					switch( in_gijun ){
					case "U":	//단가
						if( uprc * dn * cm == 0 ){
							advt_fee		= 0;
							vat			= 0;
							pubc_tot_amt	= 0;
						}
						else{
							advt_fee		= 	Math.round(uprc * dn * cm);
							if( rtax_yn == "Y" )	vat = 0;
							else				vat = Math.round(uprc * dn * cm / 10);
							pubc_tot_amt	= advt_fee + vat;
						}
						model.setValue("/root/resData/resForm/advt_fee"		, advt_fee);
						model.setValue("/root/resData/resForm/vat"			, vat);
						model.setValue("/root/resData/resForm/pubc_tot_amt"	, pubc_tot_amt);
					break;
					case "A":	//광고료
						if( advt_fee == 0 ){
							uprc			= 0;
							vat			= 0;
							pubc_tot_amt	= 0;
						}
						else{
							if( dn * cm == 0 )	uprc 	= 0;
							else				uprc	= Math.round(advt_fee/(dn*cm));
							if( rtax_yn == "Y" )	vat = 0;
							else				vat = Math.round(advt_fee/10);
							pubc_tot_amt	= advt_fee + vat;
						}
						model.setValue("/root/resData/resForm/uprc"			, uprc);
						model.setValue("/root/resData/resForm/vat"			, vat);
						model.setValue("/root/resData/resForm/pubc_tot_amt"	, pubc_tot_amt);
					break;
					case "V":	//부가세
						if( vat == 0 ){
							advt_fee		= 0;
							uprc			= 0;
							pubc_tot_amt	= 0;
						}
						else{
							advt_fee		= Math.round(vat*10);
							pubc_tot_amt	= advt_fee + vat;
							if( dn * cm == 0 )	uprc	= 0;
							else				uprc	= Math.round(vat * 10 / (dn * cm));
						}
						model.setValue("/root/resData/resForm/advt_fee"		, advt_fee);
						model.setValue("/root/resData/resForm/pubc_tot_amt"	, pubc_tot_amt);
						model.setValue("/root/resData/resForm/uprc"			, uprc);
					break;
					case "T":	//게재총액
						if( pubc_tot_amt == 0 )
						{
							advt_fee		= 0;
							vat			= 0;
							uprc			= 0;
						}
						else
						{
							if( rtax_yn == "Y" )
							{
								advt_fee	= pubc_tot_amt;
								vat		= 0;
							}
							else
							{
								advt_fee	= Math.round(pubc_tot_amt * 10 / 11);
								vat		= Math.round(pubc_tot_amt * 1 / 11);
							}
							if( dn * cm == 0 )	uprc = 0;
							else				uprc	= Math.round(pubc_tot_amt * 10 / 11 / (dn * cm));
						}
						model.setValue("/root/resData/resForm/advt_fee"		, advt_fee);
						model.setValue("/root/resData/resForm/vat"			, vat);
						model.setValue("/root/resData/resForm/uprc"			, uprc);
					break;
					default:	// 단가 기준으로 갑시다.
						recalculate("U");
					break;
					}

					// 2. 대행수수료 계산 - 기초 계산값이 바뀌므로 대행수수료를 재계산하여 준다.
					//					기준은 요율로 한다.
					if( fee_rate == 0 )
					{
						fee = 0;
					}
					else
					{
						if( vat == 0 )
						{
							fee = Math.round(pubc_tot_amt * 1.1 * fee_rate / 100);
						}
						else
						{
							fee = Math.round(pubc_tot_amt * fee_rate / 100);
						}
					}
					
					if( coms_rate == 0 )
					{
						coms = 0;
					}
					else
					{
						if( vat == 0 )
						{
							coms = Math.round(pubc_tot_amt * 1.1 * coms_rate / 100);
						}
						else
						{
							coms = Math.round(pubc_tot_amt * coms_rate / 100);
						}
					}
					model.setValue("/root/resData/resForm/fee"	, fee);
					model.setValue("/root/resData/resForm/coms"	, coms);
					
					// 3. 계산된 금액 리플레쉬~					
					inp_uprc.refresh();
					inp_advt_fee.refresh();
					inp_vat.refresh();
					inp_pubc_tot_amt.refresh();
					inp_fee.refresh();
					inp_coms.refresh();
					
					g_advt_fee	= advt_fee;
					g_vat		= vat;
				}
				
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	환율정보로 광고료 계산
				//
				/////////////////////////////////////////////////////////////////////
				function ExchangeAdvtFee(){
					var exrate			=	Number(model.getValue("/root/resData/resForm/exrate"));
					var frex_cntr_amt	=	Number(model.getValue("/root/resData/resForm/frex_cntr_amt"));
					var advt_fee		=	Math.round( exrate * frex_cntr_amt );
					
					if( advt_fee == 0 ){
						alert("외화게재액과 환율을 잘못 입력하셨습니다.");
						return;
					}
					else{					
						model.setValue("/root/resData/resForm/advt_fee", advt_fee);
						inp_advt_fee.refresh();
						recalculate("A");
					}
				}
				
				/////////////////////////////////////////////////////////////////////
				// 기능 : 	장표출력
				//
				/////////////////////////////////////////////////////////////////////
				function goReport(gubun){
					// 오즈관련 노드 초기화..					
					resetOznode();
					// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
					makeNodeValue("/root/oz_data/ozrName", "ad/SP_AD_PUB_1010_P");			
					makeNodeValue("/root/oz_data/conParam/uv_summary");											
								
					var root		= "/root/resData/resForm";
					var medi_cd    	= model.getValue(	root + "/medi_cd");
					var proc_dt      	= model.getValue(	root + "/proc_dt");
					var proc_seq    	= model.getValue(	root + "/proc_seq");
					var print_dt	= model.getValue(	root + "/print_dt");
					
					if( proc_dt == "" ){
						commAlert("게재일자가 없습니다.");
						return;
					}			
					if( proc_seq == "" ){
						commAlert("게재순번이 없습니다.");
						return;
					}	
					if( print_dt == ""  ){
						commAlert("발행일자가 없습니다.");
						return;
					}				
			
					makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd"		, model.property("ss_cmpycd"));					
					makeNodeValue("/root/oz_data/odiParam/iv_medi_cd"		, medi_cd);					
					makeNodeValue("/root/oz_data/odiParam/iv_proc_dt"		, proc_dt);	
					makeNodeValue("/root/oz_data/odiParam/iv_proc_seq"		, proc_seq);	
					makeNodeValue("/root/oz_data/odiParam/iv_issu_dt"		, print_dt);	
					// 레포트뷰어 호출.					
					openOzwin("/root/oz_data");	
				}
				function busInit(){
					var medi_cd = model.getValue("/root/resData/resForm/medi_cd");
					if(medi_cd == "540"){
						model.removeNodeset("/root/resData/gridData3");
						model.refresh();
					}
				}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="756" guideline="1,8;2,58;" style="font-family:굴림; ">
		<caption id="caption63" class="list_cap02" style="left:9px; top:365px; width:602px; height:26px; "/>
		<caption id="caption62" class="list_cap02" style="left:9px; top:340px; width:602px; height:26px; "/>
		<caption id="caption61" class="list_cap02" style="left:9px; top:315px; width:602px; height:26px; "/>
		<caption id="caption60" class="list_cap02" style="left:9px; top:290px; width:602px; height:26px; "/>
		<group id="gr_bus" visibility="hidden" style="left:9px; top:291px; width:245px; height:104px; ">
			<caption id="caption1" style="left:1px; top:0px; width:88px; height:100px; text-align:center; background-color:#e0e2f0; ">버스승강장</caption>
			<datagrid id="gd_bus" nodeset="/root/resData/gridData3/record" caption="위치^구분^순번" colsep="#" colwidth="60,60,10" extendlastcol="scroll" mergecellsfixedcols="bycolrec" mergecellsfixedrows="byrowrec" rowsep="|" selectionmode="byrow" colheight="25" style="left:89px; top:0px; width:132px; height:100px; text-align:center; ">
				<col ref="bus_plc" type="input" caption="위치" style="text-align:left; "/>
				<col ref="bus_clsf" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/dtnb_medi_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="bus_seq" visibility="hidden"/>
			</datagrid>
		</group>
		<button id="btn_row_add" class="btn_grid03" crud="R" style="left:28px; top:355px; width:65px; height:21px; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						if(gd_bus.rows != 0){
							gd_bus.addStatus(1, "update");
						}
						//part_cd.attribute("editable") = "true";
						gd_bus.addRow();		
					]]>
			</script>
		</button>
		<group id="gr_nmd" style="left:9px; top:290px; width:251px; height:80px; ">
			<caption id="cpt_pubc_clsf_nmd" class="list_cap03" style="left:0px; top:0px; width:90px; height:26px; text-align:center; ">게재구분</caption>
			<select1 id="cmb_pubc_clsf_nmd" ref="/root/resData/resForm/pubc_clsf" class="req" navindex="26" appearance="minimal" caption="게재구분" style="left:94px; top:4px; width:123px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/pubc_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
		</group>
		<group id="gr_nbiz" style="left:8px; top:290px; width:240px; height:100px; ">
			<caption id="cpt_advt_clas" class="list_cap03" style="left:1px; top:0px; width:90px; height:26px; text-align:center; ">광고분류</caption>
			<select1 id="cmb_advt_clas" ref="/root/resData/resForm/advt_clas" class="req" navindex="24" appearance="minimal" caption="광고분류" style="left:94px; top:4px; width:123px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/advt_clas/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<caption id="cpt_chro_clsf" class="list_cap03" style="left:1px; top:25px; width:90px; height:26px; text-align:center; ">색도구분</caption>
			<select1 id="cmb_chro_clsf" ref="/root/resData/resForm/chro_clsf" class="req" navindex="25" appearance="minimal" caption="색도구분" style="left:94px; top:29px; width:123px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/chro_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<caption id="cpt_pubc_clsf" class="list_cap03" style="left:1px; top:50px; width:90px; height:26px; text-align:center; ">게재구분</caption>
			<select1 id="cmb_pubc_clsf" ref="/root/resData/resForm/pubc_clsf" class="req" navindex="26" appearance="minimal" caption="게재구분" style="left:94px; top:54px; width:123px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/pubc_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<caption id="cpt_edt_clsf" class="list_cap03" style="left:1px; top:75px; width:90px; height:26px; text-align:center; ">판구분</caption>
			<select1 id="cmb_edt_clsf" ref="/root/resData/resForm/edt_clsf" class="req" navindex="27" appearance="minimal" caption="판구분" style="left:94px; top:79px; width:123px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/edt_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
		</group>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<caption id="caption56" class="list_cap02" style="left:9px; top:465px; width:602px; height:26px; "/>
		<caption id="caption54" class="list_cap02" style="left:9px; top:440px; width:602px; height:26px; "/>
		<caption id="caption2" class="list_cap02" style="left:9px; top:145px; width:602px; height:26px; "/>
		<caption id="caption68" class="list_cap02" style="left:9px; top:95px; width:602px; height:26px; "/>
		<caption id="caption67" class="list_cap02" style="left:9px; top:490px; width:602px; height:26px; "/>
		<caption id="caption73" class="list_cap02" style="left:9px; top:633px; width:602px; height:26px; "/>
		<caption id="caption72" class="list_cap02" style="left:9px; top:608px; width:602px; height:26px; "/>
		<caption id="caption71" class="list_cap02" style="left:9px; top:583px; width:602px; height:26px; "/>
		<caption id="caption70" class="list_cap02" style="left:9px; top:558px; width:602px; height:26px; "/>
		<caption id="caption69" class="list_cap02" style="left:9px; top:515px; width:602px; height:40px; "/>
		<caption id="caption8" class="list_cap02" style="left:9px; top:265px; width:602px; height:26px; "/>
		<caption id="caption59" class="list_cap02" style="left:9px; top:240px; width:602px; height:26px; "/>
		<caption id="caption35" class="list_cap02" style="left:9px; top:120px; width:602px; height:26px; "/>
		<caption id="caption57" class="list_cap02" style="left:9px; top:170px; width:602px; height:26px; "/>
		<caption id="caption44" class="list_cap02" style="left:9px; top:70px; width:602px; height:26px; "/>
		<caption id="caption64" class="list_cap02" style="left:9px; top:390px; width:602px; height:26px; "/>
		<caption id="caption66" class="list_cap02" style="left:9px; top:415px; width:602px; height:26px; "/>
		<group id="gr_print" visibility="hidden" style="left:683px; top:75px; width:252px; height:50px; background-color:#ffffff; border-color:#aec9e9; border-style:solid; ">
			<caption id="caption96" class="list_cap02" style="left:5px; top:11px; width:159px; height:26px; "/>
			<caption id="cap_print" class="list_cap03" style="left:4px; top:11px; width:60px; height:26px; ">발행일자</caption>
			<input id="inp_print_dt" ref="/root/resData/resForm/print_dt" class="req" inputtype="date" format="yyyy-mm-dd" caption="발행일자" appearance="input" style="left:67px; top:15px; width:92px; height:18px; "/>
			<button id="btn_print" class="btn02" crud="R" style="left:179px; top:14px; width:55px; height:20px; ">
				<caption>인쇄</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[					
						goReport("P");	
					]]>
				</script>
			</button>
		</group>
		<button id="btn_sel" class="btn02" crud="R" style="left:306px; top:40px; width:50px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					loadData();
				]]>
			</script>
		</button>
		<button id="btn_ins" class="btn02" disabled="true" crud="C" style="left:452px; top:40px; width:50px; height:21px; ">
			<caption>입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if( checkAll() == false )		return;
					var upd_resn	= model.getValue("/root/resData/resForm/upd_resn");
					var upd_cont	= model.getValue("/root/resData/resForm/upd_cont");
					
					var medi_cd     = model.getValue("/root/resData/resForm/medi_cd");
					//if(medi_cd = "540"){
						model.makeNode("/root/resData/resForm/multiUpdateData");
						for( i=gd_bus.fixedRows;i<gd_bus.rows; i++ )
						{
							gd_bus.addStatus(i, "update");
						}					
						//alert(gd_bus.getUpdateData());					
						model.setValue("/root/resData/resForm/multiUpdateData"	,gd_bus.getUpdateData());
						//alert(model.getValue("/root/resData/resForm/multiUpdateData"));
					//}
					// 필수입력사항 체크
					if( validateReq() == false )		return;
					// 게재데이터 오류사항 체크
					if( checkAll() == false )		return;
					// 등록
					// 등록처리에서는 수정사유/수정내용만 체크한다.
					if( upd_resn != "" || upd_cont  != "" ){
						alert("새로입력 하실 경우 수정사유와 수정내용은 입력할 수 없습니다.");
						return;
					}
					else{
						if( instance1.selectSingleNode("/root/resData/resForm/flag") == null ){
							model.makeNode("/root/resData/resForm/flag");
						}
						model.setValue("/root/resData/resForm/flag", "I");

						model.send("ad_pub_1050_a");
						if( submit_completed() ){																						
							model.setValue("/root/resData/resForm/proc_seq", model.getValue("/root/msgData/proc_seq"));
							inp_proc_seq.refresh();
							loadData();
							if( sw_list.selectedIndex == 0 )		loadPreng();
							else							loadPubc();
							g_work_clsf = "I";
							DisplaySet();
						}
					}
				]]>
			</script>
		</button>
		<button id="btn_upd" class="btn02" crud="U" style="left:508px; top:40px; width:50px; height:21px; ">
			<caption>수정</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var chk_vis = model.getValue("/root/box_vis");
					if (chk_vis == "out"){
						alert("내용 수정 후 다시 수정버튼을 클릭해주세요.");
						box_vis("in");
						return;
					}				

					var medi_cd			= model.getValue("/root/resData/resForm/medi_cd");
					var proc_dt			= model.getValue("/root/resData/resForm/proc_dt");
					var proc_seq			= model.getValue("/root/resData/resForm/proc_seq");
					var pubc_dt			= model.getValue("/root/resData/resForm/pubc_dt");
					var upd_yn			= model.getValue("/root/resData/resForm/upd_yn");
					var div_yn				= model.getValue("/root/resData/resForm/div_yn");
					var sale_stmt_issu_yn 	= model.getValue("/root/resData/resForm/sale_stmt_issu_yn");
					var purc_stmt_issu_yn	= model.getValue("/root/resData/resForm/purc_stmt_issu_yn");
					var purc_stmt_issu_yn2	= model.getValue("/root/resData/resForm/purc_stmt_issu_yn2");
					var clos_stat			= model.getValue("/root/resData/resForm/clos_stat");
					var clamt_stat			= model.getValue("/root/resData/resForm/clamt_stat");
					var upd_resn			= model.getValue("/root/resData/resForm/upd_resn");
					var upd_cont			= model.getValue("/root/resData/resForm/upd_cont");
					
					//alert(gd_bus.getUpdateData());
					//alert(model.getValue("/root/resData/resForm/multiUpdateData"));
					//if(medi_cd = "540"){
						model.setValue("/root/resData/resForm/multiUpdateData"	,gd_bus.getUpdateData());
					//}
					// 필수입력사항 체크
					if( validateReq() == false )		return;
					// 게재데이터 오류사항 체크
					if( checkAll() == false )		return;
					// 수정
					// 1. 전표번호 상태 체크
					if( g_work_clsf != "S" && g_work_clsf != "I" && g_work_clsf != "U" )
					{
						alert("전표번호 상태가 수정할 수 없는 상태입니다.\n\r전표번호를 재조회 후 수정하세요.");
						return;
					}
					
					// 2. 전표번호 변경여부 체크
					if( g_medi_cd != medi_cd || g_proc_dt != proc_dt || g_proc_seq != proc_seq || g_pubc_dt != pubc_dt )
					{
						alert("전표번호가 변경되었습니다.\n\r전표번호를 재조회 후 수정하세요.");
						return;
					}

					// 3. 수정여부 체크
					// 4. 마감상태 체크
					if( upd_yn != "N" || div_yn != "N" || (clos_stat == "마감" && trim(clos_stat) != "") )
					{
						alert("마감 또는 수정된 전표는 실적에 관련된 항목을 제외하고 수정이 가능합니다.\n\rMIS팀에 문의하세요.");
						return;
					}
					// 5. 계산서발행여부 체크
					// 6. 수금상태 체크
					if( sale_stmt_issu_yn != "N" || purc_stmt_issu_yn != "N" || purc_stmt_issu_yn2 != "N" || ( clamt_stat != "미수" && trim(clamt_stat) != "" ) )
					{
						alert("계산서 또는 입금된 전표는 실적에 관련된 항목을 제외하고 수정이 가능합니다.\n\rMIS팀에 문의하세요.");
						return;
					}
					// 7. 수정사유 및 수정내용 체크
					if( upd_resn == "9" )
					{
						if( trim(upd_cont) == "" )
						{
							alert("수정사유가 기타일 경우 수정내용은 필수 입력사항입니다.");
							return;
						}
					}
					else
					{
						if( proc_dt != pubc_dt )
						{
							alert("전표일자와 게재일자가 다를 경우 수정사항을 [9 기타]로 작성하여야 합니다.");
							return;
						}
					}

					if( instance1.selectSingleNode("/root/resData/resForm/flag" ) == null )
					{
						model.makeNode("/root/resData/resForm/flag");
					}
					model.setValue("/root/resData/resForm/flag", "U");
					
					model.send("ad_pub_1050_a");
					if( submit_completed() )
					{
						loadData();
						if( sw_list.selectedIndex == 0 )		loadPreng();
						else							loadPubc();
						g_work_clsf = "U";
						DisplaySet();
					}
				]]>
			</script>
		</button>
		<button id="btn_del" class="btn02" crud="D" style="left:564px; top:40px; width:50px; height:21px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var medi_cd			= 	model.getValue("/root/resData/resForm/medi_cd");
					var proc_dt			= 	model.getValue("/root/resData/resForm/proc_dt");
					var proc_seq			= 	model.getValue("/root/resData/resForm/proc_seq");
					var pubc_dt			= 	model.getValue("/root/resData/resForm/pubc_dt");
					var upd_yn			= 	model.getValue("/root/resData/resForm/upd_yn");
					var div_yn				=	model.getValue("/root/resData/resForm/div_yn");
					var sale_stmt_issu_yn 	= 	model.getValue("/root/resData/resForm/sale_stmt_issu_yn");
					var purc_stmt_issu_yn	= 	model.getValue("/root/resData/resForm/purc_stmt_issu_yn");
					var purc_stmt_issu_yn2	= 	model.getValue("/root/resData/resForm/purc_stmt_issu_yn2");
					var clos_stat			= 	model.getValue("/root/resData/resForm/clos_stat");
					var clamt_stat			=	model.getValue("/root/resData/resForm/clamt_stat");
					
					model.setValue("/root/resData/resForm/multiUpdateData"	,gd_bus.getUpdateData());
					
					// 삭제
					// 1. 전표상태 체크
					if( g_work_clsf != "S" )
					{
						alert("전표번호 조회 후 삭제하세요.");
						return;
					}
					// 2. 전표번호 체크
					if( g_medi_cd != medi_cd || g_proc_dt != proc_dt || g_proc_seq != proc_seq || g_pubc_dt != pubc_dt )
					{
						alert("전표번호가 변경 되었습니다.\n\r전표번호 조회 후 삭제하세요.");
						return;
					}
					// 3. 수정여부 체크
					if( upd_yn != "N" )
					{
						alert("이 전표는 수정된 전표입니다.\n\r수정전표를 먼저 삭제하세요.");
						return;
					}
					if( div_yn != "N" )
					{
						alert("이 전표는 분할된 전표입니다.\n\r분할전표 창에서 삭제하세요.");
						return;
					}
					// 4. 마감여부 체크
					if( clos_stat == "마감" && trim(clos_stat) != "" )
					{
						alert("이 전표는 마감된 전표입니다.\n\r마감취소를 실행 후 삭제하세요.");
						return;
					}
					// 5. 계산서 발행 여부 체크
					if( sale_stmt_issu_yn != "N" || purc_stmt_issu_yn != "N" || purc_stmt_issu_yn2 != "N" )
					{
						alert("이 전표는 계산서가 발행된 전표입니다.\n\r계산서 발행을 취소한 후 삭제하세요.");
						return;
					}
					// 6. 수금상태 체크
					if( clamt_stat != "미수" && trim(clamt_stat) != "" )
					{
						alert("이 전표는 입금이 상계된 전표입니다.\n\r입금을 취소한 후 삭제하세요.");
						return;
					}
					// 7. 삭제는 확인 질문
					if( windowConfirm("삭제하시겠습니까?") )
					{
						if( instance1.selectSingleNode("/root/resData/resForm/flag") == null )
						{
							model.makeNode("/root/resData/resForm/flag");
						}					
						model.setValue("/root/resData/resForm/flag", "D");
						model.send("ad_pub_1050_a");
						if( submit_completed() )
						{
							model.reset();
							initPage();
							if( sw_list.selectedIndex == 0 )		loadPreng();
							else							loadPubc();
							g_work_clsf = "D";
							DisplaySet();
						}
					}				
				]]>
			</script>
		</button>
		<button id="btn_updpubc" class="btn04" crud="C" style="left:620px; top:40px; width:88px; height:21px; ">
			<caption>수정전표생성</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var chk_vis = model.getValue("/root/box_vis");
					if (chk_vis == "out"){
						alert("내용 수정 후 다시 수정버튼을 클릭해주세요.");
						box_vis("in");
						return;
					}	
					var medi_cd			= model.getValue("/root/resData/resForm/medi_cd");
					var proc_dt			= model.getValue("/root/resData/resForm/proc_dt");
					var proc_seq			= model.getValue("/root/resData/resForm/proc_seq");
					var pubc_dt			= model.getValue("/root/resData/resForm/pubc_dt");
					var upd_yn			= model.getValue("/root/resData/resForm/upd_yn");
					var div_yn				= model.getValue("/root/resData/resForm/div_yn");
					var sale_stmt_issu_yn 	= model.getValue("/root/resData/resForm/sale_stmt_issu_yn");
					var purc_stmt_issu_yn	= model.getValue("/root/resData/resForm/purc_stmt_issu_yn");
					var purc_stmt_issu_yn2	= model.getValue("/root/resData/resForm/purc_stmt_issu_yn2");
					var clos_stat			= model.getValue("/root/resData/resForm/clos_stat");
					var clam_stat			= model.getValue("/root/resData/resForm/clamt_stat");
					var upd_resn			= model.getValue("/root/resData/resForm/upd_resn");
					var upd_cont			= model.getValue("/root/resData/resForm/upd_cont");
						
					model.makeNode("/root/resData/resForm/multiUpdateData");
					//alert(gd_bus.fixedRows+"::"+gd_bus.rows);
					for( i=gd_bus.fixedRows;i<gd_bus.rows; i++ )
					{//alert(i);
						gd_bus.addStatus(i, "update");
					}	
					model.setValue("/root/resData/resForm/multiUpdateData"	,gd_bus.getUpdateData());
					
					// 필수입력사항 체크
					if( validateReq() == false )		return;
					// 게재데이터 오류 체크
					if( checkAll() == false )		return;
					
					// 수정전표생성 - 기본 로직은 삭제와 동일하나 마감체크는 디비에서 월마감으로 함.
					// 1. 전표상태 체크
					if( g_work_clsf != "S" ){
						alert("전표번호 조회 후 생성하세요.");
						return;
					}
					// 2. 전표번호 체크
					if( g_medi_cd != medi_cd || g_proc_seq != proc_seq || g_pubc_dt != pubc_dt ){
						alert("전표번호가 변경 되었습니다.\n\r전표번호 조회 후 생성하세요.");
						return;
					}
					// 3. 수정여부 체크
					if( upd_yn != "N" ){
						alert("이 전표는 수정된 전표입니다.\n\r최종전표로 생성하세요.");
						return;
					}
					if( div_yn != "N" ){
						alert("이 전표는 분할된 전표입니다.\n\r최종 전표로 생성하세요.");
						return;
					}
					// 4. 마감여부 체크
					if( clos_stat != "마감" && trim(clos_stat) != "" )
					{
						alert("이 전표는 마감된 전표가 아닙니다.\n\r수정을 실행하세요.");
						return;
					}
					// 4. 계산서 발행 여부 체크
					if( sale_stmt_issu_yn != "N" || purc_stmt_issu_yn != "N" || purc_stmt_issu_yn2 != "N" )
					{
						alert("이 전표는 계산서가 발행된 전표입니다.\n\r계산서 발행을 취소한 후 생성하세요.");
						return;
					}
					// 6. 수금상태 체크
					if( clam_stat != "미수" && trim(clam_stat) != "" ){
						alert("이 전표는 입금이 상계된 전표입니다.\n\r입금을 취소한 후 생성하세요.");
						return;
					}
					//7. 수정사유 체크
					if( upd_resn == "" ){
						alert("수정전표 생성시 수정사유는 필수 입력사항입니다.");
						return;
					}
					else{
						if( upd_resn == "9" && trim(upd_cont) == "" ){
							alert("수정사유가 기타일 경우 수정내용은 필수 입력사항입니다.");
							return;
						}
					}
					
					// 8. 확인질문
					if( windowConfirm("수정전표를 생성하시겠습니까?") ){
						if( instance1.selectSingleNode("/root/resData/resForm/flag") == null ){
							model.makeNode("/root/resData/resForm/flag");
						}					
						model.setValue("/root/resData/resForm/flag", "A");
						model.send("ad_pub_1050_a");
						if( submit_completed() ){
							model.setValue("/root/resData/resForm/proc_seq", model.getValue("/root/msgData/proc_seq"));
							inp_proc_seq.refresh();
							loadData();
							if( sw_list.selectedIndex == 0 )		loadPreng();
							else							loadPubc();
							g_work_clsf = "A";
							DisplaySet();
						}
					}							
				]]>
			</script>
		</button>
		<button id="btn_init" class="btn02" crud="R" style="left:714px; top:40px; width:50px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.reset();
					initPage();
				]]>
			</script>
		</button>
		<button id="btn_close" class="btn02" style="left:886px; top:40px; width:50px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if( window.type == "mdi" ){
						viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					}
					else{													
						window.close();
					}
				]]>
			</script>
		</button>
		<button id="btn_dealprt" class="btn05" visibility="hidden" crud="P" style="left:770px; top:40px; width:110px; height:21px; ">
			<caption>거래명세표출력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					//goReport("P");
					if ( gr_print.visible == true ){
						gr_print.visible = false;
					}
					else{
						gr_print.visible = true;
					}
				]]>
			</script>
		</button>
		<button id="btn_preng" class="tab04" group="tab" selected="true" select.background-image="../../../images/tep-T4.gif" crud="R" style="left:620px; top:70px; width:78px; height:23px; background-image:../../../images/tep1-T4.gif; ">
			<caption>예약승인</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					loadPreng();
				]]>
			</script>
		</button>
		<button id="btn_pubc" class="tab04" group="tab" select.background-image="../../../images/tep-T4.gif" crud="R" style="left:698px; top:70px; width:78px; height:23px; background-image:../../../images/tep1-T4.gif; ">
			<caption>게재실적</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					loadPubc();
				]]>
			</script>
		</button>
		<caption id="cpt_medi_cd" class="list_cap03" style="left:9px; top:70px; width:90px; height:26px; text-align:center; ">
			<![CDATA[매체구분]]>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					inp_passwd.visible = true;
				]]>
			</script>
		</caption>
		<select1 id="cmb_medi_cd" ref="/root/resData/resForm/medi_cd" class="req" navindex="1" appearance="minimal" style="left:102px; top:74px; width:100px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/medi_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
					changeOnMediCd();
				]]>
			</script>
		</select1>
		<input id="inp_passwd" accesskey="ctrl+f1" visibility="hidden" imemode="disabled" maxlength="8" appearance="input" style="left:540px; top:99px; width:60px; height:18px; ">
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode== 13 ){
						if( inp_passwd.currentText == "SavE" ){
							inp_exrate.disabled 		= false;
						}
						else{
							inp_exrate.disabled 		= true;
						}
						inp_passwd.visible = false;
					}
				]]>
			</script>
		</input>
		<caption id="cpt_pubc_slip_no" class="list_cap03" style="left:9px; top:95px; width:90px; height:26px; ">게재전표</caption>
		<input id="inp_proc_dt" ref="/root/resData/resForm/proc_dt" class="req" navindex="2" inputtype="date" format="yyyy-mm-dd" caption="게재전표일자" style="left:102px; top:99px; width:90px; height:18px; "/>
		<caption id="cpt_dash" style="left:192px; top:99px; width:15px; height:20px; text-align:center; ">-</caption>
		<input id="inp_pubc_dt" ref="/root/resData/resForm/pubc_dt" class="req" navindex="4" inputtype="date" format="yyyy-mm-dd" caption="게재일자" appearance="input" style="left:404px; top:99px; width:90px; height:18px; border-style:solid; "/>
		<input id="inp_proc_seq" ref="/root/resData/resForm/proc_seq" navindex="3" maxlength="4" format="9999" appearance="input" style="left:208px; top:99px; width:35px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[					
					if( event.keyCode == 13 ){						
						var proc_seq = inp_proc_seq.currentText;
						if( proc_seq != "" ){
							model.setValue("/root/resData/resForm/proc_seq", lpad(proc_seq, 4, "0"));
							inp_proc_seq.refresh();	
						}
						loadData();
					}
				]]>
			</script>
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
					var proc_seq = model.getValue("/root/resData/resForm/proc_seq");
					if( proc_seq != "" ){
						model.setValue("/root/resData/resForm/proc_seq", lpad(proc_seq, 4, "0"));
						inp_proc_seq.refresh();	
					}
				]]>
			</script>
		</input>
		<button id="btn_prev" style="left:267px; top:99px; width:18px; height:18px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
			<caption>-</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var proc_dt 		= model.getValue("/root/resData/resForm/proc_dt");
					var proc_seq		= Number(model.getValue("/root/resData/resForm/proc_seq"));
					var seq_clsf		= model.getValue("/root/resData/resForm/seq_clsf");
					
					if( seq_clsf == "F" ){
						alert("첫번째 번호입니다.");
						return;
					}
									
					if( proc_seq <= 1 ) 	proc_seq = 1;
					else			     	proc_seq--;					
					model.setValue("/root/resData/resForm/proc_seq", lpad(""+proc_seq, 4, "0"));
					inp_proc_seq.refresh();
									
					loadData();
				]]>
			</script>
		</button>
		<button id="btn_next" style="left:247px; top:99px; width:18px; height:18px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
			<caption>+</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var proc_dt 		= model.getValue("/root/resData/resForm/proc_dt");
					var proc_seq		= Number(model.getValue("/root/resData/resForm/proc_seq"));
					var seq_clsf		= model.getValue("/root/resData/resForm/seq_clsf");
					
					if( seq_clsf == "L" ){
						alert("마지막 번호입니다.");
						return;
					}
					
					if( proc_seq >= 9999 )	proc_seq = 9999;
					else					proc_seq++;
					model.setValue("/root/resData/resForm/proc_seq", lpad(""+proc_seq, 4, "0"));
					inp_proc_seq.refresh();
					
					loadData();
				]]>
			</script>
		</button>
		<caption id="cpt_pubc_dt" class="list_cap03" style="left:330px; top:95px; width:70px; height:26px; text-align:center; ">게재일자</caption>
		<caption id="cpt_reg_no" class="list_cap03" visibility="visible" style="left:330px; top:70px; width:70px; height:26px; ">등록번호</caption>
		<output id="otp_pubc_occr_dt" ref="/root/resData/resForm/pubc_occr_dt" visibility="visible" format="yyyy-mm-dd" style="left:449px; top:74px; width:70px; height:18px; text-align:center; "/>
		<output id="otp_pubc_occr_seq" ref="/root/resData/resForm/pubc_occr_seq" visibility="visible" format="9999" appearance="output" maxlength="4" style="left:524px; top:74px; width:35px; height:18px; text-align:center; "/>
		<output id="otp_seq_clsf" ref="/root/resData/resForm/seq_clsf" visibility="visible" style="left:565px; top:74px; width:40px; height:18px; "/>
		<caption id="cpt_hndl_clsf" class="list_cap03" style="left:9px; top:120px; width:90px; height:26px; text-align:center; ">취급구분</caption>
		<select1 id="cmb_hndl_clsf" ref="/root/resData/resForm/hndl_clsf" class="req" navindex="5" appearance="minimal" caption="취급구분" style="left:102px; top:124px; width:90px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/hndl_clsf/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[					
					var medi_cd = model.getValue("/root/resData/resForm/medi_cd");
					var hndl_clsf = model.getValue("/root/resData/resForm/hndl_clsf");
//					if (medi_cd == "350"){
//						if(hndl_clsf == "2"){
//							inp_fee_rate.visible = true;
//							oup_fee_rate.visible = false;
//						}else{
//							inp_fee_rate.visible = false;
//							oup_fee_rate.visible = true;
//						}
//					}else{
//						inp_fee_rate.visible = false;
//						oup_fee_rate.visible = true;
//					}
					//recalculate("A");
					//model.refresh();
					//자사광고일 경우에만 입력버튼 활성화	
					ButtonSet();
									
					model.setValue("/root/resData/resForm/agn"			,"");
					model.setValue("/root/resData/resForm/agn_nm"		,"");				
					model.setValue("/root/resData/resForm/fee_rate"		,"");
					model.setValue("/root/resData/resForm/fee"			,"");				
					model.setValue("/root/resData/resForm/hndl_plac_cd"	,"");
					model.setValue("/root/resData/resForm/hndl_plac_nm"	,"");
					model.setValue("/root/resData/resForm/coms_rate"		,"");
					model.setValue("/root/resData/resForm/coms"			,"");
						
					inp_agn.refresh();
					inp_agn_nm.refresh();
					inp_fee_rate.refresh();
					inp_fee.refresh();				
					inp_hndl_plac_cd.refresh();	
					inp_hndl_plac_nm.refresh();
					inp_coms_rate.refresh();
					inp_coms.refresh();
				]]>
			</script>
		</select1>
		<caption id="cpt_dlco" class="list_cap03" style="left:9px; top:145px; width:90px; height:26px; text-align:center; ">광고주</caption>
		<input id="inp_dlco_no" ref="/root/resData/resForm/dlco_no" class="req" navindex="6" autonext="false" maxlength="8" format="99999999" appearance="input" style="left:102px; top:149px; width:55px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var dlco_no = inp_dlco_no.currentText;
					model.setValue("/root/resData/resForm/dlco_no", lpad(dlco_no, 8, "0"));
					inp_dlco_no.refresh();
					commonSubmission("9004", inp_dlco_no.currentText, inp_dlco_no, inp_dlco_nm);	
					setChrgInfo();
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode== 13 ){
						var dlco_no = inp_dlco_no.currentText;
						model.setValue("/root/resData/resForm/dlco_no", lpad(dlco_no, 8, "0"));
						inp_dlco_no.refresh();
						commonSubmission("9004", inp_dlco_no.currentText, inp_dlco_no, inp_dlco_nm);	
						setChrgInfo();
					}
				]]>
			</script>
		</input>
		<input id="inp_dlco_nm" ref="/root/resData/resForm/dlco_nm" class="req" navindex="7" imemode="hangul" inputtype="button" caption="광고주" style="left:162px; top:149px; width:242px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					// AD_CO_1200 XRW CALL
					showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText);
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode== 13 ){
						// ad_co_9008_s DB CALL
						findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
						setChrgInfo();
					}								
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
					setChrgInfo();
				]]>
			</script>
		</input>
		<caption id="cpt_advt_cont" class="list_cap03" style="left:9px; top:170px; width:90px; height:26px; text-align:center; ">광고내용</caption>
		<input id="inp_advt_cont" ref="/root/resData/resForm/advt_cont" navindex="8" imemode="hangul" caption="광고내용" style="left:102px; top:174px; width:430px; height:18px; "/>
		<caption id="cpt_agn" class="list_cap03" style="left:9px; top:240px; width:90px; height:26px; text-align:center; ">대행사</caption>
		<input id="inp_agn" ref="/root/resData/resForm/agn" navindex="16" autonext="false" maxlength="8" format="99999999" appearance="input" style="left:102px; top:244px; width:55px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var agn = inp_agn.currentText;
					
					if( agn == "" ){
						model.setValue("/root/resData/resForm/agn","");
						model.setValue("/root/resData/resForm/agn_nm","");
						model.setValue("/root/resData/resForm/fee_rate","");
						model.setValue("/root/resData/resForm/fee","");
						inp_agn.refresh();
						inp_agn_nm.refresh();
						inp_fee_rate.refresh();
						inp_fee.refresh();						
					}
					else{
						model.setValue("/root/resData/resForm/agn", lpad(agn, 8, "0"));
						inp_agn.refresh();
						commonSubmission("9004", inp_agn.currentText, inp_agn, inp_agn_nm);			
						setMchrgInfo();	
						setGovernAdvtYn();
					}
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == 13 ){
						var agn = inp_agn.currentText;
					
						if( agn == "" ){
							model.setValue("/root/resData/resForm/agn","");
							model.setValue("/root/resData/resForm/agn_nm","");
							model.setValue("/root/resData/resForm/fee_rate","");
							model.setValue("/root/resData/resForm/fee","");
							inp_agn.refresh();
							inp_agn_nm.refresh();
							inp_fee_rate.refresh();
							inp_fee.refresh();						
						}
						else{
							model.setValue("/root/resData/resForm/agn", lpad(agn, 8, "0"));
							inp_agn.refresh();
							commonSubmission("9004", inp_agn.currentText, inp_agn, inp_agn_nm);			
							setMchrgInfo();	
							setGovernAdvtYn();
						}
					}
				]]>
			</script>
		</input>
		<input id="inp_agn_nm" ref="/root/resData/resForm/agn_nm" navindex="17" imemode="hangul" inputtype="button" style="left:160px; top:244px; width:145px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					showAdvcsSearchPopup("", "", "Y", "", "", inp_agn_nm.currentText);		
					setMchrgInfo();		
					setGovernAdvtYn();	
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					findDlcoNoByName("2", inp_agn_nm.currentText, inp_agn, inp_agn_nm);	
					setMchrgInfo();		
					setGovernAdvtYn();	
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode== 13 ){
						findDlcoNoByName("2", inp_agn_nm.currentText, inp_agn, inp_agn_nm);	
						setMchrgInfo();			
						setGovernAdvtYn();
					}
				]]>
			</script>
		</input>
		<caption id="cpt_hndl_plac" class="list_cap03" style="left:9px; top:265px; width:90px; height:26px; text-align:center; ">취급처</caption>
		<input id="inp_hndl_plac_cd" ref="/root/resData/resForm/hndl_plac_cd" navindex="20" autonext="false" maxlength="8" format="99999999" appearance="input" style="left:102px; top:269px; width:55px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var hndl_plac_cd = inp_hndl_plac_cd.currentText;
					if( hndl_plac_cd == "" ){
						model.setValue("/root/resData/resForm/hndl_plac_cd"	,"");
						model.setValue("/root/resData/resForm/hndl_plac_nm"	,"");
						model.setValue("/root/resData/resForm/coms_rate"		,"");
						model.setValue("/root/resData/resForm/coms"			,"");
						inp_hndl_plac_cd.refresh();
						inp_hndl_plac_nm.refresh();
						inp_coms_rate.refresh();
						inp_coms.refresh();						
					}
					else{
						model.setValue("/root/resData/resForm/hndl_plac_cd", lpad(hndl_plac_cd, 8, "0"));
						inp_hndl_plac_cd.refresh();
						commonSubmission("9004", inp_hndl_plac_cd.currentText, inp_hndl_plac_cd, inp_hndl_plac_nm);		
						setMchrgInfo();	
					}
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					var hndl_plac_cd = inp_hndl_plac_cd.currentText;
					
					if( event.keyCode== 13 ){
						if( hndl_plac_cd == "" ){
							model.setValue("/root/resData/resForm/hndl_plac_cd"	,"");
							model.setValue("/root/resData/resForm/hndl_plac_nm"	,"");
							model.setValue("/root/resData/resForm/coms_rate"		,"");
							model.setValue("/root/resData/resForm/coms"			,"");
							inp_hndl_plac_cd.refresh();
							inp_hndl_plac_nm.refresh();
							inp_coms_rate.refresh();
							inp_coms.refresh();						
						}
						else{
							model.setValue("/root/resData/resForm/hndl_plac_cd", lpad(hndl_plac_cd, 8, "0"));
							inp_hndl_plac_cd.refresh();
							commonSubmission("9004", inp_hndl_plac_cd.currentText, inp_hndl_plac_cd, inp_hndl_plac_nm);		
							setMchrgInfo();	
						}
					}
				]]>
			</script>
		</input>
		<input id="inp_hndl_plac_nm" ref="/root/resData/resForm/hndl_plac_nm" navindex="21" imemode="hangul" inputtype="button" style="left:160px; top:269px; width:145px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					// AD_CO_1200 XRW CALL
					showAdvcsSearchPopup("", "", "", "Y", "Y", inp_hndl_plac_nm.currentText);		
					setMchrgInfo();											
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode== 13 ){
						findDlcoNoByName("4", inp_hndl_plac_nm.currentText, inp_hndl_plac_cd, inp_hndl_plac_nm);	
						setMchrgInfo();	
					}							
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					findDlcoNoByName("4", inp_hndl_plac_nm.currentText, inp_hndl_plac_cd, inp_hndl_plac_nm);	
					setMchrgInfo();
				]]>
			</script>
		</input>
		<caption id="cpt_advt_fee" class="list_cap03" style="left:282px; top:195px; width:110px; height:26px; text-align:center; ">광고료</caption>
		<output id="oup_advt_fee" ref="/root/resData/resForm/advt_fee" class="req" navindex="13" format="(-)#,###" caption="광고료" appearance="output" style="left:282px; top:220px; width:110px; height:18px; text-align:right; "/>
		<input id="inp_advt_fee" ref="/root/resData/resForm/advt_fee" class="req" navindex="13" format="(-)#,###" caption="광고료" style="left:282px; top:220px; width:110px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var cur_advt_fee = Number(inp_advt_fee.currentText.ReplaceString(",",""));
					if( Math.abs(g_advt_fee - cur_advt_fee) > 9 ){
						model.setValue("/root/resData/resForm/advt_fee", cur_advt_fee);
						recalculate("A");
						model.refresh();
					}
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				
					if( event.keyCode == 13 ){
						var cur_advt_fee = Number(inp_advt_fee.currentText.ReplaceString(",", ""));
						if( Math.abs(g_advt_fee - cur_advt_fee) > 9 ){
							model.setValue("/root/resData/resForm/advt_fee", cur_advt_fee);
							recalculate("A");
							model.refresh();
						}
					}
				]]>
			</script>
		</input>
		<caption id="cpt_vat" class="list_cap03" style="left:391px; top:195px; width:110px; height:26px; text-align:center; ">부가세</caption>
		<output id="oup_vat" ref="/root/resData/resForm/vat" class="req" navindex="14" format="(-)#,###" caption="부가세" appearance="output" style="left:391px; top:220px; width:110px; height:18px; text-align:right; "/>
		<input id="inp_vat" ref="/root/resData/resForm/vat" class="req" navindex="14" format="(-)#,###" caption="부가세" appearance="output" style="left:391px; top:220px; width:110px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var cur_vat = Number(inp_vat.currentText.ReplaceString(",", ""));
					if( Math.abs(g_vat - cur_vat) > 9 ){
						model.setValue("/root/resData/resForm/vat", cur_vat);
						recalculate("V");
					}
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == 13 ){
						var cur_vat = Number(inp_vat.currentText.ReplaceString(",", ""));
						if( Math.abs(g_vat - cur_vat) > 9 ){
							model.setValue("/root/resData/resForm/vat", cur_vat);
							recalculate("V");
						}
					}
				]]>
			</script>
		</input>
		<caption id="cpt_pubc_tot_amt" class="list_cap03" style="left:500px; top:195px; width:111px; height:26px; text-align:center; ">게재총액</caption>
		<output id="oup_pubc_tot_amt" ref="/root/resData/resForm/pubc_tot_amt" class="req" navindex="15" format="(-)#,###" caption="게재총액" appearance="output" style="left:500px; top:220px; width:111px; height:18px; text-align:right; "/>
		<input id="inp_pubc_tot_amt" ref="/root/resData/resForm/pubc_tot_amt" class="req" navindex="15" format="(-)#,###" caption="게재총액" appearance="output" style="left:500px; top:220px; width:111px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					recalculate("T");
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == 13 )
					{
						var cur_amt = inp_pubc_tot_amt.currentText.ReplaceString(",", "");
						model.setValue("/root/resData/resForm/pubc_tot_amt", cur_amt);
						recalculate("T");
					}
				]]>
			</script>
		</input>
		<caption id="cpt_fee_rate" class="list_cap03" style="left:311px; top:240px; width:70px; height:26px; text-align:center; ">대행료율</caption>
		<output id="oup_fee_rate" ref="/root/resData/resForm/fee_rate" navindex="18" format="##.#" appearance="output" style="left:384px; top:244px; width:50px; height:18px; text-align:right; "/>
		<input id="inp_fee_rate" ref="/root/resData/resForm/fee_rate" navindex="18" format="##.#" style="left:384px; top:244px; width:50px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
					// 면세일 경우가 있으므로 광고료에 10% 추가하여 요율을 적용함.
					var advt_fee 	= 	Number(model.getValue("/root/resData/resForm/advt_fee"));					
					var fee_rate    	= 	Number(model.getValue("/root/resData/resForm/fee_rate"));
					var fee		=	Math.round( advt_fee * 1.1 * fee_rate / 100 );
					
					model.setValue("/root/resData/resForm/fee", fee);
					inp_fee.refresh();
					oup_fee.refresh();
				]]>
			</script>
		</input>
		<caption id="cpt_fee" class="list_cap03" style="left:439px; top:240px; width:80px; height:26px; text-align:center; ">대행료</caption>
		<output id="oup_fee" ref="/root/resData/resForm/fee" navindex="19" format="(-)#,###" appearance="output" validateformat="false" style="left:524px; top:244px; width:80px; height:18px; text-align:right; "/>
		<input id="inp_fee" ref="/root/resData/resForm/fee" navindex="19" format="(-)#,###" validateformat="false" appearance="output" style="left:524px; top:244px; width:80px; height:18px; text-align:right; "/>
		<caption id="cpt_coms_rate" class="list_cap03" style="left:311px; top:265px; width:70px; height:26px; text-align:center; ">수수료율</caption>
		<output id="oup_coms_rate" ref="/root/resData/resForm/coms_rate" navindex="22" format="##.#" appearance="output" style="left:384px; top:269px; width:50px; height:18px; text-align:right; "/>
		<input id="inp_coms_rate" ref="/root/resData/resForm/coms_rate" navindex="22" format="##.#" appearance="output" style="left:384px; top:269px; width:50px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
					// 면세일 경우가 있으므로 광고료에 10% 추가하여 요율을 적용함.
					var advt_fee 	= 	Number(model.getValue("/root/resData/resForm/advt_fee"));					
					var coms_rate 	= 	Number(model.getValue("/root/resData/resForm/coms_rate"));					
					var coms		=	Math.round( advt_fee * 1.1 * coms_rate / 100 );
					
					model.setValue("/root/resData/resForm/coms", coms);
					inp_coms.refresh();
				]]>
			</script>
		</input>
		<caption id="cpt_coms" class="list_cap03" style="left:439px; top:265px; width:80px; height:26px; text-align:center; ">수수료</caption>
		<output id="oup_coms" ref="/root/resData/resForm/coms" navindex="23" format="(-)#,###" appearance="output" style="left:524px; top:269px; width:80px; height:18px; text-align:right; "/>
		<input id="inp_coms" ref="/root/resData/resForm/coms" navindex="23" format="(-)#,###" appearance="output" style="left:524px; top:269px; width:80px; height:18px; text-align:right; "/>
		<caption id="cpt_indt_clsf" class="list_cap03" style="left:229px; top:290px; width:80px; height:26px; text-align:center; ">업종구분</caption>
		<input id="inp_indt_clsf" ref="/root/resData/resForm/indt_clsf" class="req" navindex="28" appearance="input" style="left:314px; top:294px; width:25px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					commonSubmission("9009", inp_indt_clsf.currentText,  inp_indt_clsf, inp_indt_clsf_nm);		
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == 13 ){
						commonSubmission("9009", inp_indt_clsf.currentText,  inp_indt_clsf, inp_indt_clsf_nm);	
					}
				]]>
			</script>
		</input>
		<input id="inp_indt_clsf_nm" ref="/root/resData/resForm/indt_clsf_nm" class="req" navindex="29" imemode="hangul" inputtype="button" caption="업종구분" crud="R" style="left:343px; top:294px; width:90px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					// AD_CO_1000 XRW CALL
					showIndtClsfPopup();
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					// ad_co_9008_s DB CALL
					findIndtClsfByName(inp_indt_clsf_nm.currentText, inp_indt_clsf, inp_indt_clsf_nm);
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == 13 ){
						findIndtClsfByName(inp_indt_clsf_nm.currentText, inp_indt_clsf, inp_indt_clsf_nm);
					}
				]]>
			</script>
		</input>
		<caption id="cpt_type_clsf" class="list_cap03" style="left:229px; top:315px; width:80px; height:26px; text-align:center; ">유형구분</caption>
		<input id="inp_type_clsf" ref="/root/resData/resForm/type_clsf" class="req" navindex="30" appearance="input" style="left:314px; top:319px; width:25px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					commonSubmission("9010", inp_type_clsf.currentText,  inp_type_clsf, inp_type_clsf_nm);	
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if(event.keyCode == 13 ){
						commonSubmission("9010", inp_type_clsf.currentText,  inp_type_clsf, inp_type_clsf_nm);	
					}
				]]>
			</script>
		</input>
		<input id="inp_type_clsf_nm" ref="/root/resData/resForm/type_clsf_nm" class="req" navindex="31" imemode="hangul" inputtype="button" caption="유형구분" crud="R" style="left:343px; top:319px; width:90px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					// AD_CO_1100 XRW CALL
					showTypeClsfPopup();
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					// ad_co_9008_s DB CALL
					if( event.keyCode == 13 ){
						findTypeClsfByName(inp_type_clsf_nm.currentText, inp_type_clsf, inp_type_clsf_nm);
					}					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					findTypeClsfByName(inp_type_clsf_nm.currentText, inp_type_clsf, inp_type_clsf_nm);
				]]>
			</script>
		</input>
		<caption id="cpt_appndx_clsf" class="list_cap03" style="left:229px; top:340px; width:80px; height:26px; text-align:center; ">부록구분</caption>
		<select1 id="cmb_appndx_clsf" ref="/root/resData/resForm/appndx_clsf" navindex="32" appearance="minimal" style="left:314px; top:344px; width:120px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/appndx_clsf/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="cpt_grp_cmpy_cd" class="list_cap03" style="left:229px; top:365px; width:80px; height:26px; text-align:center; ">그룹사</caption>
		<select1 id="cmb_grp_cmpy_cd" ref="/root/resData/resForm/grp_cmpy_cd" navindex="33" appearance="minimal" style="left:314px; top:369px; width:120px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/grp_cmpy_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="cpt_mony_kind" class="list_cap03" style="left:439px; top:290px; width:80px; height:26px; text-align:center; ">화폐종류</caption>
		<select1 id="cmb_mony_kind" ref="/root/resData/resForm/mony_kind" navindex="34" appearance="minimal" style="left:524px; top:294px; width:80px; height:18px; text-align:left; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/mony_kind/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
					var mony_kind 	= model.getValue("/root/resData/resForm/mony_kind");
					var pubc_dt	= model.getValue("/root/resData/resForm/pubc_dt");	
					
					if( mony_kind == "KRW" ){
						model.setValue("/root/resData/resForm/exrate"		, "");
						model.setValue("/root/resData/resForm/frex_cntr_amt"	, "");
						inp_exrate.refresh();
						inp_frex_cntr_amt.refresh();
						return;
					}
					else
					{
						makeNodeValue("/root/reqData/searchData/mony_kind"		, mony_kind);
						makeNodeValue("/root/reqData/searchData/preng_occr_dt"	, pubc_dt);
						modelSendNoMake("ad_co_9001_s", "/ad/common/9001", "/root/reqData/searchData", "/root/tempData");
						if( submit_completed() ){
							model.setValue("/root/resData/resForm/exrate", model.getValue("/root/tempData/exrate"));
							inp_exrate.refresh();
							ExchangeAdvtFee();
						}
						else
						{
							model.setValue("/root/resData/resForm/exrate", "");
							out_exrate.refresh();
						}
					}
				]]>
			</script>
		</select1>
		<caption id="cpt_exrate" class="list_cap03" style="left:439px; top:315px; width:80px; height:26px; text-align:center; ">환율</caption>
		<input id="inp_exrate" ref="/root/resData/resForm/exrate" disabled="true" editable="true" appearance="input" style="left:524px; top:319px; width:80px; height:18px; text-align:right; border-style:solid; "/>
		<caption id="cpt_frex_cntr_amt" class="list_cap03" style="left:439px; top:340px; width:80px; height:26px; text-align:center; ">외화게재액</caption>
		<input id="inp_frex_cntr_amt" ref="/root/resData/resForm/frex_cntr_amt" navindex="35" format="#,###.99" style="left:524px; top:344px; width:80px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					ExchangeAdvtFee();
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == 13 )			ExchangeAdvtFee();
				]]>
			</script>
		</input>
		<caption id="cpt_real_rate" class="list_cap03" style="left:439px; top:365px; width:80px; height:26px; text-align:center; ">실제요율</caption>
		<input id="inp_real_rate" ref="/root/resData/resForm/real_rate" navindex="36" appearance="input" style="left:526px; top:369px; width:55px; height:18px; text-align:right; "/>
		<caption id="cpt_tot_rate" class="list_cap03" style="left:439px; top:390px; width:80px; height:26px; text-align:center; ">총요율</caption>
		<input id="inp_tot_rate" ref="/root/resData/resForm/tot_rate" navindex="37" appearance="input" style="left:526px; top:394px; width:55px; height:18px; text-align:right; "/>
		<caption id="cpt_net_rate" class="list_cap03" style="left:439px; top:415px; width:80px; height:26px; text-align:center; ">NET요율</caption>
		<input id="inp_net_rate" ref="/root/resData/resForm/net_rate" navindex="38" appearance="input" style="left:526px; top:419px; width:55px; height:18px; text-align:right; "/>
		<select1 id="rdo_rate" ref="/root/resData/resForm/sel_rate" appearance="full" cols="1" rows="3" vcellspacing="8" overflow="visible" style="left:585px; top:366px; width:20px; height:71px; border-style:none; ">
			<choices>
				<item>
					<label/>
					<value>R</value>
				</item>
				<item>
					<label/>
					<value>T</value>
				</item>
				<item>
					<label/>
					<value>N</value>
				</item>
			</choices>
		</select1>
		<caption id="cpt_rtax_yn" class="list_cap03" style="left:309px; top:390px; width:100px; height:26px; text-align:center; ">면세여부</caption>
		<bool id="boo_rtax_yn" navindex="44" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/rtax_yn" style="left:414px; top:393px; width:20px; height:20px; background-image:#uncheck; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					recalculate("A");
				]]>
			</script>
		</bool>
		<caption id="cpt_govern_advt_yn" class="list_cap03" style="left:309px; top:415px; width:100px; height:26px; text-align:center; ">정부광고여부</caption>
		<bool id="boo_govern_advt_yn" navindex="45" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/govern_advt_yn" style="left:414px; top:420px; width:20px; height:20px; background-image:#uncheck; "/>
		<caption id="cpt_tabl_yn" class="list_cap03" style="left:309px; top:440px; width:100px; height:26px; text-align:center; ">타블로이드여부</caption>
		<bool id="boo_tabl_yn" navindex="46" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/tabl_yn" style="left:414px; top:445px; width:20px; height:20px; background-image:#uncheck; "/>
		<caption id="cpt_brdg_advt_yn" class="list_cap03" style="left:309px; top:465px; width:100px; height:26px; text-align:center; ">브릿지광고여부</caption>
		<bool id="boo_brdg_advt_yn" navindex="47" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/brdg_advt_yn" style="left:414px; top:470px; width:20px; height:20px; background-image:#uncheck; "/>
		<caption id="cpt_nwsp_type_yn" class="list_cap03" style="left:439px; top:440px; width:80px; height:26px; text-align:center; ">협찬광고</caption>
		<bool id="boo_spon_advt_yn" navindex="51" visibility="hidden" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/nwsp_advt_yn" style="left:524px; top:445px; width:20px; height:20px; background-image:#uncheck; "/>
		<select1 id="cmb_nwsp_side_type" ref="/root/resData/resForm/nwsp_side_type" navindex="39" appearance="minimal" style="left:525px; top:445px; width:80px; height:18px; text-align:left; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/nwsp_side_type/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
					var spon_type = model.getValue("/root/resData/resForm/nwsp_side_type");
					if( trim(spon_type) == "" ) {
						boo_spon_advt_yn.value = "N";
					}
					else{
						boo_spon_advt_yn.value = "Y";
					}			
				]]>
			</script>
		</select1>
		<caption id="cpt_nwsp_side_type" class="list_cap03" visibility="hidden" style="left:439px; top:465px; width:80px; height:26px; text-align:center; ">지면형태</caption>
		<caption id="cpt_slcrg" class="list_cap03" style="left:9px; top:390px; width:90px; height:26px; text-align:center; ">영업담당</caption>
		<input id="inp_slcrg_pers" ref="/root/resData/resForm/slcrg_pers" class="req" navindex="40" caption="영업담당" appearance="input" style="left:102px; top:394px; width:70px; height:18px; text-align:left; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					commonSubmission("9005", inp_slcrg_pers.currentText,  inp_slcrg_pers, inp_slcrg_pers_nm);	
					var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
					if( emp_no != "" ){
						findDept(emp_no, otp_dept_cd, otp_dept_nm);
					}
					else{
						otp_dept_cd.value 	= "";
						otp_dept_nm.value 	= "";
					}
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == 13 ){
						commonSubmission("9005", inp_slcrg_pers.currentText,  inp_slcrg_pers, inp_slcrg_pers_nm);		
						var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
						if( emp_no != "" ){
							findDept(emp_no, otp_dept_cd, otp_dept_nm);
						}
						else{
							otp_dept_cd.value	= "";
							otp_dept_nm.value	= "";
						}
					}
				]]>
			</script>
		</input>
		<input id="inp_slcrg_pers_nm" ref="/root/resData/resForm/slcrg_pers_nm" class="req" navindex="41" imemode="hangul" inputtype="button" caption="영업담당" crud="R" style="left:177px; top:394px; width:128px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					// HD_COM_1000 XRW CALL
					searchEmpno("setSlcrgPers", "/root/resData/resForm/slcrg_pers", "/root/resData/resForm/slcrg_pers_nm");
					var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
					
					if( emp_no != "" ){
						// ad_co_9009_s DB CALL
						findDept(emp_no, otp_dept_cd, otp_dept_nm);
					}
					else{
						otp_dept_cd.value	= "";
						otp_dept_nm.value	= "";
					}
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == 13 ){
						findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm.currentText, inp_slcrg_pers, inp_slcrg_pers_nm);		
	
						var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
						if( emp_no != "" ){
							findDept(emp_no, otp_dept_cd, otp_dept_nm);
						}
						else{
							otp_dept_cd.value	= "";
							otp_dept_nm.value	= "";
						}
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm.currentText, inp_slcrg_pers, inp_slcrg_pers_nm);
	
					var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
					if( emp_no != "" ){
						findDept(emp_no, otp_dept_cd, otp_dept_nm);
					}
					else{
						otp_dept_cd.value	= "";
						otp_dept_nm.value	= "";
					}
				]]>
			</script>
		</input>
		<caption id="cpt_dept" class="list_cap03" style="left:9px; top:415px; width:90px; height:26px; text-align:center; ">영업부서</caption>
		<output id="otp_dept_cd" ref="/root/resData/resForm/dept_cd" appearance="output" style="left:102px; top:419px; width:70px; height:18px; text-align:left; border-style:solid; "/>
		<output id="otp_dept_nm" ref="/root/resData/resForm/dept_nm" style="left:177px; top:419px; width:128px; height:18px; border-style:solid; "/>
		<caption id="cpt_mchrg" class="list_cap03" style="left:9px; top:440px; width:90px; height:26px; text-align:center; ">관리담당</caption>
		<input id="inp_mchrg_pers" ref="/root/resData/resForm/mchrg_pers" class="req" navindex="42" caption="관리담당" appearance="input" style="left:102px; top:444px; width:70px; height:18px; text-align:left; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					commonSubmission("9005", inp_mchrg_pers.currentText,  inp_mchrg_pers, inp_mchrg_pers_nm);					
				]]>
			</script>
			<script type="javascript" ev:event="onkeydown">
				<![CDATA[
					if( event.keyCode == 13 ){
						commonSubmission("9005", inp_mchrg_pers.currentText,  inp_mchrg_pers, inp_mchrg_pers_nm);	
					}
				]]>
			</script>
		</input>
		<input id="inp_mchrg_pers_nm" ref="/root/resData/resForm/mchrg_pers_nm" class="req" navindex="43" imemode="hangul" inputtype="button" crud="R" style="left:177px; top:444px; width:128px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					searchEmpno("setMchrgPers", "/root/resData/resForm/mchrg_pers", "/root/resData/resForm/mchrg_pers_nm");
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == 13 ){
						findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);
					}					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);
				]]>
			</script>
		</input>
		<caption id="cpt_upd_resn" class="list_cap03" style="left:9px; top:465px; width:90px; height:26px; text-align:center; ">수정사유</caption>
		<select1 id="cmb_upd_resn" ref="/root/resData/resForm/upd_resn" navindex="48" appearance="minimal" style="left:102px; top:469px; width:123px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/upd_resn/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="cpt_upd_cont" class="list_cap03" style="left:9px; top:490px; width:90px; height:26px; text-align:center; ">수정내용</caption>
		<input id="inp_upd_cont" ref="/root/resData/resForm/upd_cont" navindex="49" style="left:102px; top:494px; width:505px; height:18px; "/>
		<caption id="cpt_remk" class="list_cap03" style="left:9px; top:515px; width:90px; height:40px; text-align:center; ">비고</caption>
		<textarea id="txa_remk" ref="/root/resData/resForm/remk" navindex="50" style="left:102px; top:519px; width:505px; height:33px; vertical-align:top; padding:2; "/>
		<caption id="cpt_pre_pubc_slip_no" class="list_cap03" style="left:9px; top:558px; width:100px; height:26px; text-align:center; ">
			<![CDATA[피수정게재전표]]>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					var pre_pubc_slip_no = model.getValue("/root/resData/resForm/pre_pubc_slip_no");
					if( pre_pubc_slip_no.length == 15 )
					{
						var medi_cd	= pre_pubc_slip_no.substr(0,3);
						var proc_dt	= pre_pubc_slip_no.substr(3, 8);
						var proc_seq	= pre_pubc_slip_no.substr(11);
						model.property(KEY_MEDI_CD) 	= medi_cd;
						model.property(KEY_PROC_DT) 	= proc_dt;
						model.property(KEY_PROC_SEQ) 	= proc_seq;
						
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("AD_PUB_1000");
					}
				]]>
			</script>
			<script type="javascript" ev:event="onmouseover">
				<![CDATA[
					cpt_pre_pubc_slip_no.attribute("cursor") 		= "hand";
					cpt_pre_pubc_slip_no.attribute("font-weight") 	= "bold";					
				]]>
			</script>
			<script type="javascript" ev:event="onmouseout">
				<![CDATA[				
					cpt_pre_pubc_slip_no.attribute("cursor") 		= "";
					cpt_pre_pubc_slip_no.attribute("font-weight") 	= "";
				]]>
			</script>
		</caption>
		<output id="otp_pre_pubc_slip_no" ref="/root/resData/resForm/pre_pubc_slip_no" format="999-99999999-9999" style="left:112px; top:562px; width:155px; height:18px; text-align:left; border-style:solid; "/>
		<caption id="cpt_chg_dt" class="list_cap03" style="left:9px; top:583px; width:100px; height:26px; text-align:center; ">수정일시</caption>
		<output id="otp_chg_dt" ref="/root/resData/resForm/pre_pubc_slip_no_crte_dt" style="left:112px; top:587px; width:155px; height:18px; text-align:center; border-style:solid; "/>
		<caption id="cpt_clos_stat" class="list_cap03" style="left:9px; top:608px; width:100px; height:26px; text-align:center; ">마감상태</caption>
		<output id="otp_clos_stat" ref="/root/resData/resForm/clos_stat" style="left:113px; top:612px; width:100px; height:18px; "/>
		<caption id="cpt_clamt_stat" class="list_cap03" style="left:9px; top:633px; width:100px; height:26px; text-align:center; ">수금상태</caption>
		<output id="otp_clamt_stat" ref="/root/resData/resForm/clamt_stat" style="left:113px; top:637px; width:100px; height:18px; "/>
		<caption id="cpt_sale_stmt_issu_yn" class="list_cap03" style="left:309px; top:583px; width:126px; height:26px; text-align:center; ">매출계산서발행여부</caption>
		<bool id="boo_sale_stmt_issu_yn" disabled="true" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/sale_stmt_issu_yn" style="left:435px; top:587px; width:20px; height:20px; background-image:#uncheck; "/>
		<caption id="cpt_purc_stmt_issu_yn" class="list_cap03" style="left:309px; top:608px; width:126px; height:26px; text-align:center; ">매입계산서발행여부</caption>
		<bool id="boo_purc_stmt_issu_yn" disabled="true" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/purc_stmt_issu_yn" style="left:497px; top:612px; width:20px; height:20px; background-image:#uncheck; "/>
		<caption id="cpt_elec_tax_stmt_yn" class="list_cap03" style="left:309px; top:633px; width:126px; height:26px; text-align:center; ">전자계산서발행여부</caption>
		<bool id="boo_elec_tax_stmt_yn" disabled="true" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/elec_tax_stmt_yn" style="left:435px; top:637px; width:20px; height:20px; background-image:#uncheck; "/>
		<select id="ckb_upd_yn" ref="/root/resData/resForm/upd_yn" disabled="true" overflow="visible" appearance="full" cols="2" style="left:270px; top:562px; width:75px; height:15px; border-style:none; ">
			<choices>
				<item>
					<label>수정여부</label>
					<value>Y</value>
				</item>
			</choices>
		</select>
		<input id="inp_search_dt" ref="/root/reqData/searchData/search_dt" inputtype="date" format="yyyy-mm-dd" style="left:845px; top:73px; width:90px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					if( sw_list.selectedIndex == 0 )	loadPreng();
					else						loadPubc();
				]]>
			</script>
		</input>
		<select id="checkbox2" ref="/root/resData/resForm/div_yn" disabled="true" overflow="visible" appearance="full" cols="2" style="left:350px; top:562px; width:75px; height:15px; border-style:none; ">
			<choices>
				<item>
					<label>분할여부</label>
					<value>Y</value>
				</item>
			</choices>
		</select>
		<!-- switch control -->
		<switch id="sw_list" style="left:620px; top:92px; width:315px; height:612px; ">
			<case id="case1" selected="true">
				<datagrid id="dg_preng" nodeset="/root/resData/gridData1/record" caption="면^광고주^크기^영업담당^예약발생일자^예약발생순번" colsep="^" colwidth="40, 110, 60, 55, 100, 100" explorerbar="sort" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:2px; top:2px; width:309px; height:605px; ">
					<col ref="sect_nm"/>
					<col ref="dlco_nm" style="text-align:left; word-wrap:none; "/>
					<col ref="dn_cm"/>
					<col ref="slcrg_pers_nm" style="text-align:left; "/>
					<col ref="preng_occr_dt" visibility="hidden"/>
					<col ref="preng_occr_seq" visibility="hidden"/>
					<script type="javascript" ev:event="ondblclick">
						<![CDATA[
							var row 	= dg_preng.mouseRow;
							var col 	= dg_preng.mouseCol;
							
							if( !isDataRegion(dg_preng) ) 		return;
							if( row > dg_preng.rows ) 			return;
							if( row < dg_preng.fixedRows ) 	return;
							
							var preng_occr_dt  	= dg_preng.valueMatrix(row, dg_preng.colRef("preng_occr_dt"));													
							var preng_occr_seq 	= dg_preng.valueMatrix(row, dg_preng.colRef("preng_occr_seq"));
							//alert(preng_occr_seq);
							model.setValue("/root/reqData/searchData/preng_occr_dt", preng_occr_dt);
							model.setValue("/root/reqData/searchData/preng_occr_seq", preng_occr_seq);
							busInit();//뉴비즈 버스승강장 초기화
							model.send("ad_pub_1025_s", true);							
							setGovernAdvtYn();
							ButtonSet();
						]]>
					</script>
				</datagrid>
			</case>
			<case id="case2">
				<datagrid id="dg_pubc" nodeset="/root/resData/gridData2/record" caption="면^광고주^크기^영업담당^게재발생일자^게재발생순번^PRE_PRENG_YN" colsep="^" colwidth="40, 110, 60, 55, 100, 100, 100" explorerbar="sort" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:2px; top:2px; width:309px; height:605px; ">
					<col ref="sect_nm"/>
					<col ref="dlco_nm" style="text-align:left; word-wrap:none; "/>
					<col ref="dn_cm"/>
					<col ref="slcrg_pers_nm" style="text-align:left; "/>
					<col ref="pubc_occr_dt" visibility="hidden"/>
					<col ref="pubc_occr_seq" visibility="hidden"/>
					<col ref="pre_preng_yn" visibility="hidden"/>
					<script type="javascript" ev:event="ondblclick">
						<![CDATA[
							var row 	= dg_pubc.mouseRow;
							var col 	= dg_pubc.mouseCol;

							if( !isDataRegion(dg_pubc) ) 	return;
							if( row > dg_pubc.rows ) 		return;
							if( row < dg_pubc.fixedRows ) 	return;
							
							var pubc_occr_dt  	= dg_pubc.valueMatrix(row, dg_pubc.colRef("pubc_occr_dt"));													
							var pubc_occr_seq 	= dg_pubc.valueMatrix(row, dg_pubc.colRef("pubc_occr_seq"));		
							
							model.setValue("/root/reqData/searchData/pubc_occr_dt", pubc_occr_dt);
							model.setValue("/root/reqData/searchData/pubc_occr_seq", pubc_occr_seq);
							
							busInit();
							
							model.send("ad_pub_1035_s", true);		
							if(submit_completed()){
								loadDataSet();
								changeOnMediCd();
							}
						]]>
					</script>
				</datagrid>
			</case>
		</switch>
		<group id="gr_issu" style="left:8px; top:195px; width:310px; height:45px; ">
			<input id="inp_sect_nm" ref="/root/resData/resForm/sect_nm" class="req" navindex="9" imemode="disabled" caption="면" style="left:1px; top:25px; width:60px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						// 자동 면조회 되지 않도록 요청. - 박해진氏
						if( event.keyCode == 13 )		setIssuInfo();
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						setIssuInfo();
					]]>
				</script>
			</input>
			<caption id="cpt_pubc_side" class="list_cap03" style="left:1px; top:0px; width:60px; height:26px; text-align:center; ">면</caption>
			<output id="otp_pubc_side" ref="/root/resData/resForm/pubc_side" visibility="hidden" style="left:20px; top:25px; width:35px; height:18px; "/>
			<caption id="cpt_cm" class="list_cap03" style="left:119px; top:0px; width:60px; height:26px; text-align:center; ">CM</caption>
			<output id="oup_cm" ref="/root/resData/resForm/cm" class="req" navindex="11" format="#,###.9" appearance="output" style="left:119px; top:25px; width:60px; height:18px; text-align:center; "/>
			<input id="inp_cm" ref="/root/resData/resForm/cm" class="req" navindex="11" format="#,###.9" appearance="output" style="left:119px; top:25px; width:60px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						recalculate("U");
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if( event.keyCode == 13 )
						{
							model.setValue("/root/resData/resForm/cm", inp_cm.currentText.ReplaceString(",", ""));
							recalculate("U");
						}
					]]>
				</script>
			</input>
			<caption id="cpt_dn" class="list_cap03" style="left:60px; top:0px; width:60px; height:26px; text-align:center; ">단</caption>
			<output id="oup_dn" ref="/root/resData/resForm/dn" class="req" navindex="10" format="#,###.9" appearance="output" style="left:60px; top:25px; width:60px; height:18px; text-align:center; "/>
			<input id="inp_dn" ref="/root/resData/resForm/dn" class="req" navindex="10" format="#,###.9" appearance="output" style="left:60px; top:25px; width:60px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						model.setValue("/root/resData/resForm/dn", inp_dn.currentText.ReplaceString(",", ""));
						recalculate("U");
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if( event.keyCode == 13 )
						{
							model.setValue("/root/resData/resForm/dn", inp_dn.currentText.ReplaceString(",", ""));
							recalculate("U");
						}
					]]>
				</script>
			</input>
			<caption id="cpt_uprc" class="list_cap03" style="left:178px; top:0px; width:97px; height:26px; text-align:center; ">단가</caption>
			<output id="oup_uprc" ref="/root/resData/resForm/uprc" class="req" navindex="12" format="(-)#,###" caption="단가" appearance="output" style="left:178px; top:25px; width:97px; height:18px; text-align:right; "/>
			<input id="inp_uprc" ref="/root/resData/resForm/uprc" class="req" navindex="12" format="(-)#,###" caption="단가" appearance="output" style="left:178px; top:25px; width:97px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						recalculate("U");
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if( event.keyCode == 13 )
						{
							model.setValue("/root/resData/resForm/uprc", inp_uprc.currentText.ReplaceString(",", ""));
							recalculate("U");
						}
					]]>
				</script>
			</input>
		</group>
		<switch id="sw_add" visibility="hidden" style="left:9px; top:663px; width:605px; height:82px; border-color:transparent; border-left-color:transparent; border-top-color:transparent; border-right-color:transparent; border-bottom-color:transparent; border-style:none; ">
			<case id="case3" selected="true">
				<caption id="caption80" class="list_cap02" style="left:0px; top:25px; width:602px; height:26px; "/>
				<caption id="caption58" class="list_cap02" style="left:0px; top:0px; width:602px; height:26px; "/>
				<caption id="cpt_std_clsf" class="list_cap03" style="left:0px; top:0px; width:100px; height:26px; text-align:center; ">규격구분</caption>
				<input id="inp_std_clsf" ref="/root/resData/resForm/std_clsf" navindex="52" format="999" style="left:103px; top:4px; width:30px; height:18px; text-align:right; "/>
				<caption id="caption77" style="left:141px; top:4px; width:31px; height:20px; ">Page</caption>
				<caption id="cpt_pubc_prd" class="list_cap03" style="left:301px; top:0px; width:125px; height:26px; text-align:center; ">게재기간</caption>
				<select1 id="cmb_pubc_prd" ref="/root/resData/resForm/pubc_prd" appearance="minimal" style="left:429px; top:4px; width:70px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/pubc_prd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<caption id="cpt_pubc_frdt" class="list_cap03" style="left:0px; top:25px; width:100px; height:26px; text-align:center; ">게재시작일자</caption>
				<input id="inp_pubc_frdt" ref="/root/resData/resForm/pubc_frdt" inputtype="date" format="yyyy-mm-dd" style="left:103px; top:29px; width:100px; height:18px; "/>
				<caption id="cpt_pubc_todt" class="list_cap03" style="left:301px; top:25px; width:125px; height:26px; text-align:center; ">게재종료일자</caption>
				<input id="inp_pubc_todt" ref="/root/resData/resForm/pubc_todt" inputtype="date" format="yyyy-mm-dd" style="left:429px; top:29px; width:100px; height:18px; "/>
			</case>
			<case id="case4">
				<caption id="caption85" class="list_cap02" style="left:0px; top:0px; width:602px; height:26px; "/>
				<caption id="caption87" class="list_cap02" style="left:0px; top:25px; width:602px; height:26px; "/>
				<caption id="cpt_std_clsf_180" class="list_cap03" style="left:0px; top:0px; width:100px; height:26px; text-align:center; ">규격구분</caption>
				<select1 id="combo1" ref="/root/resData/resForm/std_clsf" appearance="minimal" style="left:103px; top:4px; width:100px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/std_clsf/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<caption id="cpt_pubc_prd_180" class="list_cap03" style="left:301px; top:0px; width:125px; height:26px; text-align:center; ">게재기간</caption>
				<select1 id="cmb_pubc_prd_180" ref="/root/resData/resForm/pubc_prd" appearance="minimal" style="left:429px; top:4px; width:70px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/pubc_prd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<caption id="cpt_pubc_frdt_180" class="list_cap03" style="left:0px; top:25px; width:100px; height:26px; text-align:center; ">게재시작일자</caption>
				<input id="inp_pubc_frdt_180" ref="/root/resData/resForm/pubc_frdt" inputtype="date" format="yyyy-mm-dd" style="left:103px; top:29px; width:100px; height:18px; "/>
				<caption id="cpt_pubc_todt_180" class="list_cap03" style="left:301px; top:25px; width:125px; height:26px; text-align:center; ">게재종료일자</caption>
				<input id="inp_pubc_todt_180" ref="/root/resData/resForm/pubc_todt" inputtype="date" format="yyyy-mm-dd" style="left:429px; top:29px; width:100px; height:18px; "/>
			</case>
			<case id="case5">
				<caption id="caption89" class="list_cap02" style="left:0px; top:0px; width:602px; height:26px; "/>
				<caption id="caption90" class="list_cap03" style="left:0px; top:0px; width:100px; height:26px; text-align:center; ">배포판구분</caption>
				<select1 id="cmb_hp_edt_clsf" ref="/root/resData/resForm/hp_edt_clsf" appearance="minimal" style="left:103px; top:4px; width:100px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/hp_edt_clsf/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
			</case>
			<case id="case6">
				<caption id="caption3" class="list_cap02" style="left:0px; top:0px; width:602px; height:26px; "/>
				<caption id="caption4" class="list_cap02" style="left:0px; top:25px; width:602px; height:26px; "/>
				<caption id="caption5" class="list_cap03" style="left:0px; top:0px; width:100px; height:26px; text-align:center; ">규격구분</caption>
				<select1 id="combo2" ref="/root/resData/resForm/std_clsf" appearance="minimal" style="left:103px; top:4px; width:100px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/std_clsf/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<caption id="caption6" class="list_cap03" style="left:301px; top:0px; width:125px; height:26px; text-align:center; ">게재기간</caption>
				<select1 id="combo3" ref="/root/resData/resForm/pubc_prd" appearance="minimal" style="left:429px; top:4px; width:70px; height:18px; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/pubc_prd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<caption id="caption7" class="list_cap03" style="left:0px; top:25px; width:100px; height:26px; text-align:center; ">게재시작일자</caption>
				<input id="input1" ref="/root/resData/resForm/pubc_frdt" inputtype="date" format="yyyy-mm-dd" style="left:103px; top:29px; width:100px; height:18px; "/>
				<caption id="caption9" class="list_cap03" style="left:301px; top:25px; width:125px; height:26px; text-align:center; ">게재종료일자</caption>
				<input id="input2" ref="/root/resData/resForm/pubc_todt" inputtype="date" format="yyyy-mm-dd" style="left:429px; top:29px; width:100px; height:18px; "/>
				<caption id="caption13" class="list_cap02" style="left:0px; top:50px; width:602px; height:26px; "/>
				<caption id="caption14" class="list_cap03" style="left:0px; top:50px; width:100px; height:26px; text-align:center; ">어시스트</caption>
				<input id="inp_asist_pers" ref="/root/resData/resForm/asist_pers" navindex="42" caption="어시스트" appearance="input" style="left:105px; top:55px; width:70px; height:18px; text-align:left; ">
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
					commonSubmission("9005", inp_asist_pers.currentText,  inp_asist_pers, inp_asist_pers_nm);					
				]]>
					</script>
					<script type="javascript" ev:event="onkeydown">
						<![CDATA[
					if( event.keyCode == 13 ){
						commonSubmission("9005", inp_asist_pers.currentText,  inp_asist_pers, inp_asist_pers_nm);	
					}
				]]>
					</script>
				</input>
				<input id="inp_asist_pers_nm" ref="/root/resData/resForm/asist_pers_nm" navindex="43" imemode="hangul" inputtype="button" crud="R" style="left:180px; top:55px; width:118px; height:18px; ">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
					searchEmpno("setAsistPers", "/root/resData/resForm/asist_pers", "/root/resData/resForm/asist_pers_nm");
				]]>
					</script>
					<script type="javascript" ev:event="onkeypress">
						<![CDATA[
					if( event.keyCode == 13 ){
						findEmpNoByName("setAsistPers", inp_asist_pers_nm.currentText, inp_asist_pers, inp_asist_pers_nm);
					}					
				]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
					findEmpNoByName("setAsistPers", inp_asist_pers_nm.currentText, inp_asist_pers, inp_asist_pers_nm);
				]]>
					</script>
				</input>
			</case>
		</switch>
		<output id="otp_pubc_medi_cd" ref="/root/resData/resForm/medi_cd" style="left:405px; top:74px; width:40px; height:18px; "/>
		<caption id="caption10" class="list_cap03" style="left:330px; top:120px; width:70px; height:26px; text-align:center; ">전표번호</caption>
		<output id="otp_pubc_slip_no" visibility="visible" style="left:405px; top:124px; width:155px; height:18px; text-align:center; "/>
		<button id="btn_approve" class="btn02" crud="C" style="left:377px; top:40px; width:50px; height:21px; ">
			<caption>승인</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[			
					var upd_resn		= model.getValue("/root/resData/resForm/upd_resn");
					var upd_cont		= model.getValue("/root/resData/resForm/upd_cont");
					var preng_occr_dt 	= model.getValue("/root/resData/resForm/preng_occr_dt");
					var preng_occr_seq 	= model.getValue("/root/resData/resForm/preng_occr_seq");
					var medi_cd = model.getValue("/root/resData/resForm/medi_cd");
					
					//if(medi_cd = "540"){
						model.makeNode("/root/resData/resForm/multiUpdateData");
						//alert(gd_bus.fixedRows+"::"+gd_bus.rows);
						for( i=gd_bus.fixedRows;i<gd_bus.rows; i++ )
						{//alert(i);
							gd_bus.addStatus(i, "update");
						}					
						//alert(gd_bus.getUpdateData());					
						model.setValue("/root/resData/resForm/multiUpdateData"	,gd_bus.getUpdateData());
						//alert(model.getValue("/root/resData/resForm/multiUpdateData"));
						//return;
						//alert("1:"+preng_occr_seq);
					//}
					// 필수입력사항 체크
					if( validateReq() == false )		return;
					// 게재데이터 오류사항 체크
					if( checkAll() == false )		return;
					
					// 예약전표번호 체크
					if( preng_occr_dt == "" && preng_occr_seq == "" )
					{
						alert("승인 하실 경우 예약승인으로 조회한 전표만 가능합니다.");
						return;
					}
					
					// 등록
					// 등록처리에서는 수정사유/수정내용만 체크한다.
					if( upd_resn != "" || upd_cont  != "" )
					{
						alert("승인 하실 경우 수정사유와 수정내용은 입력할 수 없습니다.");
						return;
					}
					else
					{
						if( instance1.selectSingleNode("/root/resData/resForm/flag") == null )
						{
							model.makeNode("/root/resData/resForm/flag");
						}
						model.setValue("/root/resData/resForm/flag", "I");
						model.send("ad_pub_1050_a");
						if( submit_completed() )
						{
							model.setValue("/root/resData/resForm/proc_seq", model.getValue("/root/msgData/proc_seq"));
							inp_proc_seq.refresh();
							loadData();
							if( sw_list.selectedIndex == 0 )		loadPreng();
							else							loadPubc();
							g_work_clsf = "I";
							DisplaySet();
						}
					}
				]]>
			</script>
		</button>
		<caption id="caption11" class="list_cap03" style="left:521px; top:608px; width:60px; height:26px; text-align:center; ">지사</caption>
		<caption id="caption12" class="list_cap03" style="left:434px; top:608px; width:60px; height:26px; text-align:center; ">대행사</caption>
		<bool id="boo_purc_stmt_issu_yn2" disabled="true" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/purc_stmt_issu_yn2" style="left:585px; top:612px; width:20px; height:20px; background-image:#uncheck; "/>
		<select1 id="cmb_dtls_medi_cd" ref="/root/resData/resForm/dtls_medi_cd" navindex="1" visibility="hidden" appearance="minimal" style="left:208px; top:74px; width:120px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/dtls_medi_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<select1 id="cmb_dtnb_medi_cd" ref="/root/resData/resForm/dtnb_medi_cd" navindex="1" visibility="hidden" appearance="minimal" style="left:208px; top:74px; width:120px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/dtnb_medi_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="caption16" class="list_cap03" style="left:439px; top:465px; width:80px; height:26px; text-align:center; ">선발행여부</caption>
		<bool id="pre_issu_yn" navindex="47" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/pre_issu_yn" style="left:522px; top:470px; width:20px; height:20px; background-image:#uncheck; "/>
		<caption id="caption15" class="list_cap03" style="left:434px; top:558px; width:85px; height:26px; text-align:center; ">선일자 발행</caption>
		<bool id="pre_day_issu" navindex="47" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/pre_day_issu" style="left:522px; top:563px; width:20px; height:20px; background-image:#uncheck; "/>
	</xhtml:body>
</xhtml:html>
