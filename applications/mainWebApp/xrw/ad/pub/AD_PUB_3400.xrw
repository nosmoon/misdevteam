<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
						</comboSet>
						<pageInfo/>
						<hndl_nm/>
					</initData>
					<codeData>
						<brnd_cd>
							<item>
								<label/>
								<value/>
							</item>
						</brnd_cd>
						<spl_dlco>
							<item>
								<label/>
								<value/>
							</item>
						</spl_dlco>
					</codeData>
					<reqData>
						<fwdData>
						</fwdData>
						<searchData>
							<proc_dt/>
							<proc_seq/>
							<medi_cd/>
							<arow/>
						</searchData>
						<reqForm>
						</reqForm>
						<multiUpdateData/>
					</reqData>
					<resData>
						<resForm>
							<proc_dt/>
							<proc_seq/>
							<podr_occr_seq/>
							<podr_occr_dt/>
							<podr_dt/>
							<medi_cd/>
							<dlco_no/>
							<dlco_nm/>
							<expct_amt/>
							<slcrg_pers/>
							<slcrg_pers_nm/>
							<dept_cd/>
							<dept_nm/>
							<mchrg_pers/>
							<mchrg_pers_nm/>
							<pre_podr_slip_no/>
							<pre_podr_slip_no_crte_dt/>
							<upd_yn/>
							<clos_stat/>
							<flag/>
							<seq_clsf/>
							<multiUpdateData/>
							<multiUpdateData2/>
						</resForm>
						<gridData1>
							<record>
								<select/>
								<upd_select/>
								<arow/>
								<spl_dlco/>
								<brnd_cd/>
								<item_nm/>
								<podr_cnt/>
								<podr_uprc/>
								<podr_amt/>
								<exct_yn/>
								<misu_amt/>
								<occr_dt/>
								<occr_seq/>
								<clamt_stat/>
								<uprc_fee/>
								<mms_uprc/>
								<mms_cnt/>
								<mms_fee/>
								<mms_vat/>
								<expct_amt/>
							</record>
						</gridData1>
						<gridData2>
							<record>
								<select/>
								<exct_dt/>
								<exct_seq/>
								<spl_dlco/>
								<brnd_cd/>
								<item_nm/>
								<fee_rate/>
								<fee/>
								<fee_vat/>
								<tot_fee/>
								<exct_uprc/>
								<exct_cnt/>
								<exct_amt/>
								<cntrct_yn/>
								<clos_stat/>
								<sale_stmt_issu_yn/>
								<easy_yn/>
								<easy_amt/>
								<podr_slip_no/>
								<sale_amt/>
								<uprc_fee/>
							</record>
						</gridData2>
					</resData>
					<tempData>
						<keyData/>
					</tempData>
					<msgData/>
					<col_hdn>true</col_hdn>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				model.send("ad_pub_3400_m");	
				
				model.copyNode("/root/codeData/brnd_cd", "/root/tempData/brnd_cd");
				model.copyNode("/root/codeData/spl_dlco", "/root/tempData/spl_dlco");

				model.refresh();
	
				initPage();
				]]>
			</script>
			<submission id="ad_pub_3400_m" action="/ad/pub/3400" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="ad_pub_3410_l" action="/ad/pub/3410" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/tempData"/>
			<submission id="ad_pub_3420_a" action="/ad/pub/3420" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/msgData"/>
			<submission id="ad_pub_3430_a" action="/ad/pub/3430" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/msgData"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
				function initPage()
				{
					var cur_date = dateAdd( "d", 0, getCurrentDate() );		
					// 1. 키값 셋팅후 조회..
					if( model.property(KEY_MEDI_CD) != "" && model.property(KEY_PROC_DT) != "" && model.property(KEY_PROC_SEQ) != "" )
					{
						model.setValue("/root/resData/resForm/medi_cd"	, model.property(KEY_MEDI_CD));
						model.setValue("/root/resData/resForm/proc_dt"	, model.property(KEY_PROC_DT));
						model.setValue("/root/resData/resForm/proc_seq"	, model.property(KEY_PROC_SEQ));
						model.property(KEY_MEDI_CD) 	= "";
						model.property(KEY_PROC_DT) 	= "";
						model.property(KEY_PROC_SEQ) 	= "";
						
						loadData();
					}else{
						model.setValue("/root/resData/resForm/proc_dt", cur_date); 
						model.setValue("/root/resData/resForm/podr_dt", cur_date);
						datagrid1.fixedcellcheckbox(0, datagrid1.colRef("select")) = true;
						datagrid2.fixedcellcheckbox(0, datagrid2.colRef("select")) = true;
						cmb_medi_cd.select(0);
					}
				}
				function loadData()
				{
					var medi_cd   	= model.getValue("/root/resData/resForm/medi_cd");
					var proc_dt    	= model.getValue("/root/resData/resForm/proc_dt");
					var proc_seq 	= model.getValue("/root/resData/resForm/proc_seq");
					
					if( medi_cd == "" ||proc_dt == "" || proc_seq == "" )
					{
						alert("발주전표번호를 입력하세요.");
						model.reset();
						initPage();
						return;
					}
					else
					{
						model.setValue("/root/reqData/searchData/medi_cd"	, medi_cd);
						model.setValue("/root/reqData/searchData/proc_dt"		, proc_dt);
						model.setValue("/root/reqData/searchData/proc_seq"	, proc_seq);

						model.removeNodeset("/root/tempData");
						model.makeNode("/root/tempData");
						
						model.send("ad_pub_3410_l");
						if( submit_completed() )
						{	
							model.copyNode("/root/resData","/root/tempData");
							
							var medi_cd   	= model.getValue("/root/resData/resForm/medi_cd");
							var proc_dt    	= model.getValue("/root/resData/resForm/proc_dt");
							var proc_seq 	= model.getValue("/root/resData/resForm/proc_seq");
							var podr_slip_no = medi_cd + "-" + proc_dt + "-" + proc_seq;
							otp_podr_slip_no.value = podr_slip_no;
							
							//정산여부 = "Y"=>정산완료,"S"=>정산처리중
							for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
								var exct_yn   = datagrid1.valueMatrix(i,datagrid1.colRef("exct_yn"));
								if(exct_yn == "Y"){
									datagrid1.isReadOnly(i,datagrid1.colRef("select")) = true;
								}else{
									datagrid1.isReadOnly(i,datagrid1.colRef("select")) = false;
								}
							}
							model.setValue("/root/reqData/searchData/arow","");
							model.refresh();
						}
						else
						{
							model.reset();
							initPage();
						}
					}				
				}
				function setDlcoInfo(dlco_no, dlco_nm){
						model.setValue("/root/resData/resForm/dlco_no"	, dlco_no);
						model.setValue("/root/resData/resForm/dlco_nm"	, dlco_nm);					
						inp_dlco_no.refresh();
						inp_dlco_nm.refresh();	
						setChrgInfo();				
				}	
				function setChrgInfo()
				{
					modelSendNoMake("ad_co_9007_s", "/ad/common/9007", "/root/resData/resForm", "/root/tempData");	
					if( submit_completed() ){
						
						if( model.getValue("/root/resData/resForm/slcrg_pers") == "" ){
							model.setValue("/root/resData/resForm/slcrg_pers"		, model.getValue("/root/tempData/slcrg_pers"));
							model.setValue("/root/resData/resForm/slcrg_pers_nm"	, model.getValue("/root/tempData/slcrg_pers_nm"));
						}
						if( model.getValue("/root/resData/resForm/dept_cd") == "" ){
							model.setValue("/root/resData/resForm/dept_cd"		, model.getValue("/root/tempData/dept_cd"));
							model.setValue("/root/resData/resForm/dept_nm"		, model.getValue("/root/tempData/dept_nm"));
						}
						if( model.getValue("/root/resData/resForm/mchrg_pers") == "" ){
							model.setValue("/root/resData/resForm/mchrg_pers"	, model.getValue("/root/tempData/mchrg_pers"));
							model.setValue("/root/resData/resForm/mchrg_pers_nm"	, model.getValue("/root/tempData/mchrg_pers_nm"));
						}
						model.refresh();
					}
				}
				
				function col_hdn(val)
				{
					if(val == "true"){//행을 숨김
						model.setValue("/root/col_hdn","true");
						datagrid1.colHidden(2) = true;
					}else{//숨긴행을 보여줌
						model.setValue("/root/col_hdn","false");
						datagrid1.colHidden(2) = false;
					}
				}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="756" guideline="1,10;1,936;2,56;2,70;2,95;" style="font-family:굴림; ">
		<caption id="caption2" class="list_cap02" style="left:10px; top:120px; width:927px; height:26px; "/>
		<caption id="caption1" class="list_cap02" style="left:10px; top:95px; width:927px; height:26px; "/>
		<caption id="caption12" class="list_cap02" style="left:10px; top:70px; width:927px; height:26px; "/>
		<caption id="caption6" tyle="left:15px; top:180px; width:940px; height:0px;" style="left:0px; top:10px; width:0px; height:0px; ">caption6</caption>
		<group id="group_line" class="gro_line" style="left:10px; top:180px; width:927px; height:5px; "/>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<button id="button1" class="btn02" crud="R" style="left:833px; top:40px; width:50px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				model.reset();
				
				]]>
			</script>
		</button>
		<button id="button3" class="btn02" crud="R" style="left:519px; top:40px; width:50px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					loadData();			
				]]>
			</script>
		</button>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData1/record" caption="^수정^행번호^구입처^브랜드^상품명^발주수량^발주단가^발주금액^단가수수료^미수액^MMS단가^MMS개수^MMS발송비^MMS부가세^정산^발행일자^발행순번^입금상태^예상매출액" colsep="#" colwidth="25, 40, 50, 110, 100, 150, 80, 100, 110, 70, 100, 80,80,100, 100,50, 30, 30, 30, 70" explorerbar="sort" frozencols="5" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="bycol" style="left:9px; top:213px; width:927px; height:195px; ">
			<col checkvalue="Y,N" ref="select" type="checkbox"/>
			<col checkvalue="Y,N" ref="upd_select" type="checkbox" visibility="hidden"/>
			<col ref="arow"/>
			<col class="req" ref="spl_dlco" type="combo" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/codeData/spl_dlco/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="brnd_cd" type="combo" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/codeData/brnd_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="item_nm" type="input" style="text-align:left; word-wrap:none; "/>
			<col class="req" ref="podr_cnt" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="podr_uprc" type="input" format="(-)#,###" style="text-align:right; "/>
			<col class="req" ref="podr_amt" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="uprc_fee" type="input" format="(-)#,###.99" style="text-align:right; "/>
			<col ref="misu_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="mms_uprc" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="mms_cnt" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="mms_fee" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="mms_vat" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="exct_yn" visibility="hidden"/>
			<col ref="occr_dt" visibility="hidden"/>
			<col ref="occr_seq" visibility="hidden"/>
			<col ref="clamt_stat" visibility="hidden"/>
			<col ref="expct_amt" type="input" visibility="hidden" format="#,###" style="text-align:right; "/>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
				var row = datagrid1.mouseRow;
				var col = datagrid1.mouseCol;

				if(row <  datagrid1.fixedRows){ //헤더 일괄선택시 		
					for(var i=datagrid1.fixedRows;i<datagrid1.rows; i++){ 
						var check_ok = false;
						for(var j=datagrid1.colRef("arow"); j<datagrid1.cols;j++){
							if(datagrid1.valueMatrix(i, j) != ""){
								check_ok = true;
								break;
							}
						}
						
						if(check_ok == true){
							datagrid1.addStatus(i, "update");
						}
						else{
							datagrid1.valueMatrix(i, datagrid1.colRef("select")) = "N";
							datagrid1.removeStatus(i, "update");
						}
					}		
				}
				else{					
					var check_ok = false;
					for(var j=datagrid1.colRef("arow"); j<datagrid1.cols;j++){
						if(datagrid1.valueMatrix(datagrid1.row, j) != ""){
							check_ok = true;
							break;
						}
					}
					if (check_ok == true ){
						datagrid1.addStatus(datagrid1.row, "update");
					}
					else{
						datagrid1.valueMatrix(datagrid1.row, datagrid1.colRef("select")) = "N";
						datagrid1.removeStatus(datagrid1.row, "update");
					}
				}
				
				datagrid1.refresh();
							
				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[
				if(datagrid1.row <  datagrid1.fixedRows){ //헤더 일괄선택시 		
					for(var i=datagrid1.fixedRows;i<datagrid1.rows; i++){ 
						datagrid1.valueMatrix(i, datagrid1.colRef("select")) = "N";
						datagrid1.removeStatus(i, "update");
					}		
				}else{
					datagrid1.removeStatus(datagrid1.row, "update");
				}
				datagrid1.refresh();
				
				
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var col = datagrid1.col;
					var podr_cnt = Number(datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("podr_cnt")));
					var podr_uprc = Number(datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("podr_uprc")));
					var podr_amt = Number(datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("podr_amt")));					
					var uprc_fee = Number(datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("uprc_fee")));	
					var expct_amt = Number(model.getValue("/root/resData/resForm/expct_amt"));
					var mms_uprc  = Number(datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("mms_uprc")));	
					var mms_cnt  = Number(datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("mms_cnt")));	
					
					if(col == datagrid1.colRef("podr_cnt") || col == datagrid1.colRef("podr_uprc")||col == datagrid1.colRef("uprc_fee")){
						if(podr_uprc != 0 && podr_cnt != 0 ){
							var amt = podr_cnt * podr_uprc;
							datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("podr_amt")) = amt;
						}
						if(uprc_fee != 0 && podr_cnt != 0 ){
							var amt = podr_cnt * uprc_fee;
							model.setValue("/root/resData/resForm/expct_amt",expct_amt + amt);
						}						
					}
					if(col == datagrid1.colRef("mms_uprc") || col == datagrid1.colRef("mms_cnt") || col == datagrid1.colRef("mms_fee") || col == datagrid1.colRef("mms_vat")){
						if(podr_uprc != 0 && podr_cnt != 0 ){
							alert("발주금액이 존재하는 행에서는 MMS수수료를 사용할수 없습니다. 새로운 행에 입력해 주세요.");
							datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("mms_uprc")) = "";
							datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("mms_cnt")) = "";
							datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("mms_fee")) = "";
							datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("mms_vat")) = "";
							return;
						}
						if(mms_uprc != 0 && mms_cnt != 0 ){
							var amt = mms_uprc * mms_cnt;
							datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("mms_fee")) = amt;
							model.setValue("/root/resData/resForm/expct_amt",expct_amt + amt);
						}						
					}					
				]]>
			</script>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var exct_yn   = datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("exct_yn"));
					var arow      = datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("arow"));
					if(datagrid1.col == datagrid1.colRef("arow")){
						model.setValue("/root/reqData/searchData/arow",arow);
						model.refresh();						
					}
				]]>
			</script>
		</datagrid>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData2/record" caption="^발행^정산일자^순번^구입처^브랜드^상품명^교환개수^교환단가^교환금액^요율^수수료^부가세^총수수료^낙전수입^매출^계약서^마감^낙전^발주번호^단가수수료" colsep="#" colwidth="25, 30, 70, 40, 90, 90, 100, 55, 75, 90, 45, 75, 75, 75, 90, 80, 50,  30, 30, 50,50" explorerbar="sort" frozencols="7" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="bycol" style="left:10px; top:453px; width:926px; height:280px; ">
			<col checkvalue="Y,N" ref="select" type="checkbox"/>
			<col ref="sale_stmt_issu_yn"/>
			<col ref="exct_dt" type="input" format="yyyy-mm-dd"/>
			<col ref="exct_seq"/>
			<col ref="spl_dlco" type="combo" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/codeData/spl_dlco/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="brnd_cd" type="combo" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/codeData/brnd_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="item_nm" style="text-align:left; word-wrap:none; "/>
			<col ref="exct_cnt" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="exct_uprc" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="exct_amt" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="fee_rate" type="input" format="(-)#,###.##" style="text-align:right; "/>
			<col ref="fee" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="fee_vat" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="tot_fee" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="easy_amt" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="sale_amt" type="input" format="(-)#,###" style="text-align:right; "/>
			<col checkvalue="Y,N" ref="cntrct_yn" type="checkbox"/>
			<col ref="clos_stat" visibility="hidden"/>
			<col ref="easy_yn" visibility="hidden"/>
			<col ref="podr_slip_no" visibility="hidden"/>
			<col ref="uprc_fee" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
				var row = datagrid2.mouseRow;
				var col = datagrid2.mouseCol;
				
				if(row <  datagrid2.fixedRows){ //헤더 일괄선택시 		
					for(var i=datagrid2.fixedRows;i<datagrid2.rows; i++){ 
						var check_ok = false;
						for(var j=datagrid2.colRef("exct_seq"); j<datagrid2.cols;j++){
							if(datagrid2.valueMatrix(i, j) != ""){
								check_ok = true;
								break;
							}
						}
						
						if(check_ok == true){
							datagrid2.addStatus(i, "update");
						}
						else{
							datagrid2.valueMatrix(i, datagrid2.colRef("select")) = "N";
							datagrid2.removeStatus(i, "update");
						}
					}		
				}
				else{					
					var check_ok = false;
					for(var j=datagrid2.colRef("exct_seq"); j<datagrid2.cols;j++){
						if(datagrid2.valueMatrix(datagrid2.row, j) != ""){
							check_ok = true;
							break;
						}
					}
					if (check_ok == true ){
						datagrid2.addStatus(datagrid2.row, "update");
					}
					else{
						datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("select")) = "N";
						datagrid2.removeStatus(datagrid2.row, "update");
					}
				}
				
				datagrid2.refresh();
							
				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[
				if(datagrid2.row <  datagrid2.fixedRows){ //헤더 일괄선택시 		
					for(var i=datagrid2.fixedRows;i<datagrid2.rows; i++){ 
						datagrid2.valueMatrix(i, datagrid2.colRef("select")) = "N";
						datagrid2.removeStatus(i, "update");
					}		
				}else{
					datagrid2.removeStatus(datagrid2.row, "update");
				}
				datagrid2.refresh();
				
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var col = datagrid2.col;
					var exct_cnt = Number(datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("exct_cnt")));
					var exct_uprc = Number(datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("exct_uprc")));
					var exct_amt = Number(datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("exct_amt")));					
					var easy_amt = Number(datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("easy_amt")));	
					var uprc_fee = Number(datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("uprc_fee")));	

					if(col == datagrid2.colRef("exct_cnt") || col == datagrid2.colRef("exct_uprc")){
						if(exct_cnt != 0 && uprc_fee != 0){
							var tot_fee  = exct_cnt * uprc_fee;
							var fee      = Math.round(tot_fee * 10 / 11);
							var fee_vat	 = Math.round(tot_fee * 1 / 11);
							datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("tot_fee")) = tot_fee;
							datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("fee"))     = fee;
							datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("fee_vat")) = fee_vat;
						}						
						if(exct_uprc != 0 && exct_cnt != 0 ){
							var amt = exct_cnt * exct_uprc;
							datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("exct_amt")) = amt;
							exct_amt = Number(amt);
							var tot_fee = Number(datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("tot_fee")));
							if(exct_amt !=0 && tot_fee != 0 ){
								var fee_rate = ((tot_fee / exct_amt) * 100);
								var rate_round = fn_round(Number(fee_rate), 2);
								datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("fee_rate")) = rate_round;
							}
						}
					}
					if(col == datagrid2.colRef("easy_amt")){
						if(easy_amt != 0 ){
							var fee = 0;
							datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("easy_yn")) = "Y";
							for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
								fee = Number(fee) + Number(datagrid2.valueMatrix(i,datagrid2.colRef("fee")));
							}
							if(easy_amt !=0 && fee != 0 ){
								var sale_amt = Number(fee) + Number(easy_amt);
								datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("sale_amt")) = sale_amt;
							}							
						}else{
							datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("easy_yn")) = "N";
							datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("sale_amt")) = 0;
						}
					}
					if(col == datagrid2.colRef("tot_fee")){
						var tot_fee  = Number(datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("tot_fee")));
						var fee      = Math.round(tot_fee * 10 / 11);
						var fee_vat	 = Math.round(tot_fee * 1 / 11);
						datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("fee"))     = fee;
						datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("fee_vat")) = fee_vat;
						if(exct_amt !=0 && tot_fee != 0 ){
							var fee_rate = ((tot_fee / exct_amt) * 100);
							var rate_round = fn_round(Number(fee_rate), 2);
							datagrid2.valueMatrix(datagrid2.row,datagrid2.colRef("fee_rate")) = rate_round;
						}
					}					
				]]>
			</script>
		</datagrid>
		<caption id="caption3" class="tit02" style="left:12px; top:432px; width:121px; height:20px; ">정산처리</caption>
		<button id="btnClose" class="btn02" style="left:887px; top:40px; width:50px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
				
				]]>
			</script>
		</button>
		<input id="inp_proc_dt" ref="/root/resData/resForm/proc_dt" class="req" navindex="2" inputtype="date" format="yyyy-mm-dd" caption="게재전표일자" style="left:104px; top:99px; width:90px; height:18px; "/>
		<button id="btn_prev" style="left:271px; top:99px; width:18px; height:18px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
			<caption>-</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var proc_dt 		= model.getValue("/root/resData/resForm/proc_dt");
					var proc_seq		= Number(model.getValue("/root/resData/resForm/proc_seq"));
					var seq_clsf		= model.getValue("/root/resData/resForm/seq_clsf");
					
					if( seq_clsf == "F" ){
						alert("첫번째 번호입니다.");
						return;
					}
									
					if( proc_seq <= 1 ) 	proc_seq = 1;
					else			     	proc_seq--;					
					model.setValue("/root/resData/resForm/proc_seq", lpad(""+proc_seq, 4, "0"));
					inp_proc_seq.refresh();
									
					loadData();
				]]>
			</script>
		</button>
		<button id="btn_next" style="left:251px; top:99px; width:18px; height:18px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
			<caption>+</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var proc_dt 		= model.getValue("/root/resData/resForm/proc_dt");
					var proc_seq		= Number(model.getValue("/root/resData/resForm/proc_seq"));
					var seq_clsf		= model.getValue("/root/resData/resForm/seq_clsf");
					
					if( seq_clsf == "L" ){
						alert("마지막 번호입니다.");
						return;
					}
					
					if( proc_seq >= 9999 )	proc_seq = 9999;
					else					proc_seq++;
					model.setValue("/root/resData/resForm/proc_seq", lpad(""+proc_seq, 4, "0"));
					inp_proc_seq.refresh();
					
					loadData();
				]]>
			</script>
		</button>
		<caption id="cpt_pubc_dt" class="list_cap03" style="left:314px; top:95px; width:90px; height:26px; text-align:center; ">발주일자</caption>
		<input id="inp_proc_seq" ref="/root/resData/resForm/proc_seq" navindex="3" maxlength="4" format="9999" appearance="input" style="left:212px; top:99px; width:35px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[					
					if( event.keyCode == 13 ){						
						var proc_seq = inp_proc_seq.currentText;
						if( proc_seq != "" ){
							model.setValue("/root/resData/resForm/proc_seq", lpad(proc_seq, 4, "0"));
							inp_proc_seq.refresh();	
						}
						loadData();
					}
				]]>
			</script>
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
					var proc_seq = model.getValue("/root/resData/resForm/proc_seq");
					if( proc_seq != "" ){
						model.setValue("/root/resData/resForm/proc_seq", lpad(proc_seq, 4, "0"));
						inp_proc_seq.refresh();	
					}
				]]>
			</script>
		</input>
		<input id="inp_podr_dt" ref="/root/resData/resForm/podr_dt" class="req" navindex="4" inputtype="date" format="yyyy-mm-dd" caption="게재일자" appearance="input" style="left:407px; top:99px; width:90px; height:18px; border-style:solid; "/>
		<caption id="cpt_dash" style="left:196px; top:99px; width:15px; height:20px; text-align:center; ">-</caption>
		<caption id="cpt_pubc_slip_no" class="list_cap03" style="left:10px; top:95px; width:90px; height:26px; ">발주전표</caption>
		<caption id="cpt_medi_cd" class="list_cap03" style="left:10px; top:70px; width:90px; height:26px; text-align:center; ">
			<![CDATA[매체구분]]>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					inp_passwd.visible = true;
				]]>
			</script>
		</caption>
		<select1 id="cmb_medi_cd" ref="/root/resData/resForm/medi_cd" class="req" navindex="1" appearance="minimal" style="left:104px; top:74px; width:140px; height:18px; ">
			<choices>
				<item>
					<label>570 모바일상품권</label>
					<value>570</value>
				</item>
			</choices>
		</select1>
		<input id="inp_dlco_no" ref="/root/resData/resForm/dlco_no" class="req" navindex="6" autonext="false" maxlength="8" format="99999999" appearance="input" style="left:103px; top:124px; width:55px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var dlco_no = inp_dlco_no.currentText;
					model.setValue("/root/resData/resForm/dlco_no", lpad(dlco_no, 8, "0"));
					inp_dlco_no.refresh();
					commonSubmission("9004", inp_dlco_no.currentText, inp_dlco_no, inp_dlco_nm);	
					setChrgInfo();
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode== 13 ){
						var dlco_no = inp_dlco_no.currentText;
						model.setValue("/root/resData/resForm/dlco_no", lpad(dlco_no, 8, "0"));
						inp_dlco_no.refresh();
						commonSubmission("9004", inp_dlco_no.currentText, inp_dlco_no, inp_dlco_nm);	
						setChrgInfo();
					}
				]]>
			</script>
		</input>
		<input id="inp_dlco_nm" ref="/root/resData/resForm/dlco_nm" class="req" navindex="7" imemode="hangul" inputtype="button" caption="광고주" style="left:163px; top:124px; width:142px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					// AD_CO_1200 XRW CALL
					showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText);
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode== 13 ){
						// ad_co_9008_s DB CALL
						findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
						setChrgInfo();
					}								
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
					setChrgInfo();
				]]>
			</script>
		</input>
		<caption id="cpt_dlco" class="list_cap03" style="left:10px; top:120px; width:90px; height:26px; text-align:center; ">발주처</caption>
		<caption id="caption10" class="list_cap03" style="left:620px; top:95px; width:90px; height:26px; text-align:center; ">전표번호</caption>
		<output id="otp_podr_slip_no" visibility="visible" style="left:713px; top:99px; width:155px; height:18px; text-align:center; "/>
		<caption id="caption4" class="list_cap02" style="left:10px; top:145px; width:927px; height:26px; "/>
		<input id="inp_slcrg_pers_nm" ref="/root/resData/resForm/slcrg_pers_nm" class="req" navindex="41" imemode="hangul" inputtype="button" caption="영업담당" crud="R" style="left:178px; top:149px; width:128px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					// HD_COM_1000 XRW CALL
					searchEmpno("setSlcrgPers", "/root/resData/resForm/slcrg_pers", "/root/resData/resForm/slcrg_pers_nm");
					var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
					
					if( emp_no != "" ){
						// ad_co_9009_s DB CALL
						findDept(emp_no, otp_dept_cd, otp_dept_nm);
					}
					else{
						otp_dept_cd.value	= "";
						otp_dept_nm.value	= "";
					}
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == 13 ){
						findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm.currentText, inp_slcrg_pers, inp_slcrg_pers_nm);		
	
						var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
						if( emp_no != "" ){
							findDept(emp_no, otp_dept_cd, otp_dept_nm);
						}
						else{
							otp_dept_cd.value	= "";
							otp_dept_nm.value	= "";
						}
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm.currentText, inp_slcrg_pers, inp_slcrg_pers_nm);
	
					var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
					if( emp_no != "" ){
						findDept(emp_no, otp_dept_cd, otp_dept_nm);
					}
					else{
						otp_dept_cd.value	= "";
						otp_dept_nm.value	= "";
					}
				]]>
			</script>
		</input>
		<input id="inp_slcrg_pers" ref="/root/resData/resForm/slcrg_pers" class="req" navindex="40" caption="영업담당" appearance="input" style="left:103px; top:149px; width:70px; height:18px; text-align:left; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					commonSubmission("9005", inp_slcrg_pers.currentText,  inp_slcrg_pers, inp_slcrg_pers_nm);	
					var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
					if( emp_no != "" ){
						findDept(emp_no, otp_dept_cd, otp_dept_nm);
					}
					else{
						otp_dept_cd.value 	= "";
						otp_dept_nm.value 	= "";
					}
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == 13 ){
						commonSubmission("9005", inp_slcrg_pers.currentText,  inp_slcrg_pers, inp_slcrg_pers_nm);		
						var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
						if( emp_no != "" ){
							findDept(emp_no, otp_dept_cd, otp_dept_nm);
						}
						else{
							otp_dept_cd.value	= "";
							otp_dept_nm.value	= "";
						}
					}
				]]>
			</script>
		</input>
		<caption id="cpt_slcrg" class="list_cap03" style="left:10px; top:145px; width:90px; height:26px; text-align:center; ">영업담당</caption>
		<caption id="cpt_dept" class="list_cap03" style="left:314px; top:145px; width:90px; height:26px; text-align:center; ">영업부서</caption>
		<output id="otp_dept_nm" ref="/root/resData/resForm/dept_nm" style="left:482px; top:149px; width:128px; height:18px; border-style:solid; "/>
		<output id="otp_dept_cd" ref="/root/resData/resForm/dept_cd" appearance="output" style="left:407px; top:149px; width:70px; height:18px; text-align:left; border-style:solid; "/>
		<input id="inp_mchrg_pers" ref="/root/resData/resForm/mchrg_pers" class="req" navindex="42" caption="관리담당" appearance="input" style="left:713px; top:149px; width:70px; height:18px; text-align:left; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					commonSubmission("9005", inp_mchrg_pers.currentText,  inp_mchrg_pers, inp_mchrg_pers_nm);					
				]]>
			</script>
			<script type="javascript" ev:event="onkeydown">
				<![CDATA[
					if( event.keyCode == 13 ){
						commonSubmission("9005", inp_mchrg_pers.currentText,  inp_mchrg_pers, inp_mchrg_pers_nm);	
					}
				]]>
			</script>
		</input>
		<caption id="cpt_mchrg" class="list_cap03" style="left:620px; top:145px; width:90px; height:26px; text-align:center; ">관리담당</caption>
		<input id="inp_mchrg_pers_nm" ref="/root/resData/resForm/mchrg_pers_nm" class="req" navindex="43" imemode="hangul" inputtype="button" crud="R" style="left:788px; top:149px; width:128px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					searchEmpno("setMchrgPers", "/root/resData/resForm/mchrg_pers", "/root/resData/resForm/mchrg_pers_nm");
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == 13 ){
						findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);
					}					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);
				]]>
			</script>
		</input>
		<caption id="cpt_fee" class="list_cap03" style="left:620px; top:120px; width:90px; height:26px; text-align:center; ">예상매출금액</caption>
		<input id="inp_expct_amt" ref="/root/resData/resForm/expct_amt" navindex="19" format="(-)#,###" validateformat="false" appearance="output" style="left:713px; top:124px; width:152px; height:18px; text-align:right; "/>
		<button id="button6" class="btn_grid03" visibility="hidden" crud="R" style="left:835px; top:435px; width:53px; height:17px; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var grid = datagrid2;
					
					grid.addRow();
					
					grid.row 	= grid.rows;
					grid.col 	= 1;
					
					grid.refresh();
				]]>
			</script>
		</button>
		<button id="button7" class="btn_grid02" visibility="hidden" crud="R" style="left:889px; top:435px; width:43px; height:17px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var grid 		= 	datagrid2;
					var firstRow 	= 	grid.row;
					var lastRow  	= 	grid.selectedRow(grid.selectedRows-1);				
					
					for( var i=firstRow; i<=lastRow; i++ )
					{
						grid.removeRow(i);
					}
				]]>
			</script>
		</button>
		<button id="button2" class="btn_grid03" crud="R" style="left:836px; top:190px; width:53px; height:17px; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var grid = datagrid1;
					
					grid.addRow();
					
					grid.row 	= grid.rows;
					grid.col 	= 1;
					
					grid.refresh();
				]]>
			</script>
		</button>
		<button id="button4" class="btn_grid02" crud="R" style="left:890px; top:190px; width:43px; height:17px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var grid 		= 	datagrid1;
					var firstRow 	= 	grid.row;
					var lastRow  	= 	grid.selectedRow(grid.selectedRows-1);				
					
					for( var i=firstRow; i<=lastRow; i++ )
					{
						grid.removeRow(i);
					}
				]]>
			</script>
		</button>
		<button id="btn_upd" class="btn02" crud="U" style="left:628px; top:40px; width:50px; height:21px; ">
			<caption>수정</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var chk = 0;
					//체크박스 확인
					for(var i=datagrid1.fixedRows;i<datagrid1.rows; i++){ 
						var select = datagrid1.valueMatrix(i,datagrid1.colRef("select"));
						if(select != "N"){
							datagrid1.addStatus(i,"update");
							chk = chk + 1;
						}
					}				
						
					if(chk == 0){
						alert("수정할 발주전표를 선택해주세요.");
						return;
					}						
					
					var medi_cd			= model.getValue("/root/resData/resForm/medi_cd");
					var proc_dt			= model.getValue("/root/resData/resForm/proc_dt");
					var proc_seq			= model.getValue("/root/resData/resForm/proc_seq");
					var podr_dt			= model.getValue("/root/resData/resForm/podr_dt");
					var upd_yn			= model.getValue("/root/resData/resForm/upd_yn");
					var exct_yn				= model.getValue("/root/resData/resForm/exct_yn");
					var sale_stmt_issu_yn 	= "";//model.getValue("/root/resData/resForm/sale_stmt_issu_yn");
					var clos_stat			= model.getValue("/root/resData/resForm/clos_stat");
					var clamt_stat			= "";//model.getValue("/root/resData/resForm/clamt_stat");
	
					model.setValue("/root/resData/resForm/multiUpdateData"	,datagrid1.getUpdateData());

					// 필수입력사항 체크
					if( validateReq() == false )		return;
					// 4. 마감상태 체크
					if( upd_yn != "N" || (clos_stat == "마감" && trim(clos_stat) != "") )
					{
						alert("마감 또는 수정된 전표는 실적에 관련된 항목을 제외하고 수정이 가능합니다.\n\rMIS팀에 문의하세요.");
						return;
					}
					
					for(var i=datagrid1.fixedRows;i<datagrid1.rows; i++){ 
						sale_stmt_issu_yn = datagrid1.valueMatrix(i,datagrid1.colRef("sale_stmt_issu_yn"));
						clamt_stat = datagrid1.valueMatrix(i,datagrid1.colRef("clamt_stat"));
						// 5. 계산서발행여부 체크
						// 6. 수금상태 체크
						if( ( clamt_stat != "미수" && trim(clamt_stat) != "" ) )
						{
							alert("입금된 전표는 실적에 관련된 항목을 제외하고 수정이 가능합니다.\n\rMIS팀에 문의하세요."+clamt_stat+".");
							return;
						}
//						else
//						{
//							if( proc_dt != podr_dt )
//							{
//								alert("전표일자와 발주일자가 다를 경우 수정사항을 [9 기타]로 작성하여야 합니다.");
//								return;
//							}
//						}
					}
					if( instance1.selectSingleNode("/root/resData/resForm/flag" ) == null )
					{
						model.makeNode("/root/resData/resForm/flag");
					}
					model.setValue("/root/resData/resForm/flag", "U");
					model.send("ad_pub_3420_a");
					if( submit_completed() )
					{
						loadData();
					}
				]]>
			</script>
		</button>
		<button id="btn_del" class="btn02" crud="D" style="left:684px; top:40px; width:50px; height:21px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var chk = 0;
					//체크박스 확인
					for(var i=datagrid1.fixedRows;i<datagrid1.rows; i++){ 
						var select = datagrid1.valueMatrix(i,datagrid1.colRef("select"));
						if(select != "N"){
							datagrid1.addStatus(i,"update");
							chk = chk + 1;
						}
					}				
						
					if(chk == 0){
						alert("삭제할 발주전표를 선택해주세요.");
						return;
					}					
					
					var medi_cd			= 	model.getValue("/root/resData/resForm/medi_cd");
					var proc_dt			= 	model.getValue("/root/resData/resForm/proc_dt");
					var proc_seq			= 	model.getValue("/root/resData/resForm/proc_seq");
					var podr_dt			= 	model.getValue("/root/resData/resForm/podr_dt");
					var upd_yn			= 	model.getValue("/root/resData/resForm/upd_yn");
					var exct_yn				=	model.getValue("/root/resData/resForm/exct_yn");
					var sale_stmt_issu_yn 	= 	model.getValue("/root/resData/resForm/sale_stmt_issu_yn");
					var clos_stat			= 	model.getValue("/root/resData/resForm/clos_stat");
					var clamt_stat			=	model.getValue("/root/resData/resForm/clamt_stat");
					var pre_podr_slip_no	=	model.getValue("/root/resData/resForm/pre_podr_slip_no");
					
					model.setValue("/root/resData/resForm/multiUpdateData"	,datagrid1.getUpdateData());
					
					// 삭제
					// 3. 수정여부 체크
					if( upd_yn != "N" )
					{
						alert("이 전표는 수정된 전표입니다.\n\r수정전표를 먼저 삭제하세요.");
						return;
					}
					// 4. 마감여부 체크
					if( clos_stat == "마감" && trim(clos_stat) != "" )
					{
						alert("이 전표는 마감된 전표입니다.\n\r마감취소를 실행 후 삭제하세요.");
						return;
					}
					for(var i=datagrid1.fixedRows;i<datagrid1.rows; i++){ 	
						exct_yn = datagrid1.valueMatrix(i,datagrid1.colRef("exct_yn"));
						sale_stmt_issu_yn = datagrid1.valueMatrix(i,datagrid1.colRef("sale_stmt_issu_yn"));
						clamt_stat = datagrid1.valueMatrix(i,datagrid1.colRef("clamt_stat"));
						//alert(exct_yn);
						if(pre_podr_slip_no == ""){
							if( exct_yn != "N")
							{
								alert("이 전표는 정산된 전표입니다.");
								return;
							}					
							// 5. 계산서 발행 여부 체크
							if( sale_stmt_issu_yn != "N" && trim(sale_stmt_issu_yn) != "" )
							{
								alert("이 전표는 계산서가 발행된 전표입니다.\n\r계산서 발행을 취소한 후 삭제하세요.");
								return;
							}
							// 6. 수금상태 체크
							if( clamt_stat != "미수" && trim(clamt_stat) != "" )
							{
								alert("이 전표는 입금이 상계된 전표입니다.\n\r입금을 취소한 후 삭제하세요.");
								return;
							}
						}
					}
					// 7. 삭제는 확인 질문
					if( windowConfirm("삭제하시겠습니까?") )
					{
						if( instance1.selectSingleNode("/root/resData/resForm/flag") == null )
						{
							model.makeNode("/root/resData/resForm/flag");
						}					
						model.setValue("/root/resData/resForm/flag", "D");
						model.send("ad_pub_3420_a");
						if( submit_completed() )
						{
							model.reset();
							initPage();
						}
					}				
				]]>
			</script>
		</button>
		<button id="btn_ins" class="btn02" crud="C" style="left:572px; top:40px; width:50px; height:21px; ">
			<caption>입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					//체크박스 확인
					for(var i=datagrid1.fixedRows;i<datagrid1.rows; i++){ 
						var select = datagrid1.valueMatrix(i,datagrid1.colRef("select"));
						if(select != "N"){
							datagrid1.addStatus(i,"update");
						}
					}
					model.setValue("/root/resData/resForm/multiUpdateData"	,datagrid1.getUpdateData());
					// 필수입력사항 체크
					if( validateReq() == false )		return;
					// 등록
					else{
						if( instance1.selectSingleNode("/root/resData/resForm/flag") == null ){
							model.makeNode("/root/resData/resForm/flag");
						}
						model.setValue("/root/resData/resForm/flag", "I");

						model.send("ad_pub_3420_a");
						if( submit_completed() ){	
							model.setValue("/root/resData/resForm/proc_seq", model.getValue("/root/msgData/proc_seq"));
							inp_proc_seq.refresh();
							loadData();
						}
					}
				]]>
			</script>
		</button>
		<button id="button5" class="btn03" crud="R" style="left:755px; top:186px; width:65px; height:21px; ">
			<caption>정산하기</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var medi_cd			= 	model.getValue("/root/resData/resForm/medi_cd");
				var proc_dt			= 	model.getValue("/root/resData/resForm/proc_dt");
				var proc_seq		= 	model.getValue("/root/resData/resForm/proc_seq");				
			    var podr_slip_no1 = otp_podr_slip_no.label;
				var podr_slip_no2 = "";
				var rows = 0;				
				datagrid2.clearStatus();
				
				if(podr_slip_no1 != ""){
					for(var i=datagrid1.fixedRows;i<datagrid1.rows; i++){ 
						var select_yn = datagrid1.valueMatrix(i,datagrid1.colRef("select"));
						var arow      = datagrid1.valueMatrix(i,datagrid1.colRef("arow"));
						var exct_yn   = datagrid1.valueMatrix(i,datagrid1.colRef("exct_yn"));
						var uprc_fee   = datagrid1.valueMatrix(i,datagrid1.colRef("uprc_fee"));
						podr_slip_no2 = medi_cd+ proc_dt + proc_seq + arow;
						if(select_yn == "Y"){
							if(exct_yn == "Y"){
								alert("이미 정산 완료된 발주전표가 있습니다. 다시 확인해 주세요.");
								datagrid1.valueMatrix(i,datagrid1.colRef("select")) = "N";
								return;
							}
							else{
								//체크된 row를 datagrid2에 set해줌
								//빈행이 있는지 확인
								for(var j=datagrid2.fixedRows;j<datagrid2.rows; j++){ 
									var spl_dlco = datagrid2.valueMatrix(j,datagrid2.colRef("spl_dlco"));
									var brnd_cd = datagrid2.valueMatrix(j,datagrid2.colRef("brnd_cd"));
									var item_nm = datagrid2.valueMatrix(j,datagrid2.colRef("item_nm"));
									
									if(spl_dlco == "" && brnd_cd == "" && item_nm == ""){
										rows++;
									}
								}
								if(rows == 0 ){
									datagrid2.addRow();
									rows++;
								}

								for(var k=j;k<datagrid2.rows; k++){ 
									var spl_dlco = datagrid2.valueMatrix(k,datagrid2.colRef("spl_dlco"));
									var brnd_cd = datagrid2.valueMatrix(k,datagrid2.colRef("brnd_cd"));
									var item_nm = datagrid2.valueMatrix(k,datagrid2.colRef("item_nm"));
									
									if(spl_dlco == "" && brnd_cd == "" && item_nm == ""){
										//datagrid1의 값을 datagrid2로 
										datagrid2.valueMatrix(k,datagrid2.colRef("select")) = "Y"
										datagrid2.addStatus(k,"update");
										datagrid2.valueMatrix(k,datagrid2.colRef("spl_dlco")) = datagrid1.valueMatrix(i,datagrid1.colRef("spl_dlco"));
										datagrid2.valueMatrix(k,datagrid2.colRef("brnd_cd")) = datagrid1.valueMatrix(i,datagrid1.colRef("brnd_cd"));
										datagrid2.valueMatrix(k,datagrid2.colRef("item_nm")) = datagrid1.valueMatrix(i,datagrid1.colRef("item_nm"));
										datagrid2.valueMatrix(k,datagrid2.colRef("podr_slip_no")) = podr_slip_no2;
										datagrid2.valueMatrix(k,datagrid2.colRef("uprc_fee")) = uprc_fee;
									}
								}
								//datagrid1 체크 해제
								//datagrid1.valueMatrix(i,datagrid1.colRef("select")) = "N";
								//datagrid1.removeStatus(i,"update");
							}
						}
					}
				}else{
					alert("조회된 발주전표가 없습니다.");
					return;
				}
				]]>
			</script>
		</button>
		<button id="button8" class="btn03" crud="U" style="left:677px; top:430px; width:65px; height:21px; ">
			<caption>정산수정</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					//발주전표번호 확인
					var podr_slip_no = otp_podr_slip_no.label;
					
					if(podr_slip_no == ""){
						alert("발주전표 조회 먼저 하십시요.");
						return;
					}
					model.setValue("/root/resData/resForm/multiUpdateData2"	,datagrid2.getUpdateData());

					// 필수입력사항 체크
					if( validateReq() == false )		return;
					
					//datagrid2 체크
					for(var i=datagrid2.fixedRows;i<datagrid2.rows; i++){ 
						var stat = datagrid2.rowStatus(i);
						if(stat == 2){
							//마감
							var clos_stat = datagrid2.valueMatrix(i,datagrid2.colRef("clos_stat"));
							if(clos_stat == "마감" && trim(clos_stat) != "" ){
								alert("마감된 정산전표는 정산 수정할 수 없습니다.");
								return;
							}
							//계산서발행
							var tax_yn = datagrid2.valueMatrix(i,datagrid2.colRef("sale_stmt_issu_yn"));
							if(tax_yn == "Y" || tax_yn == "A"){
								alert("세금계산서가 발행된 정산전표는 수정할 수 없습니다.");
								return;
							}
							//낙전수입 확인
						    var easy_yn = datagrid2.valueMatrix(i,datagrid2.colRef("easy_yn"));
							
							var fee_rate = datagrid2.valueMatrix(i,datagrid2.colRef("fee_rate"));
							var fee = datagrid2.valueMatrix(i,datagrid2.colRef("fee"));
							var fee_vat = datagrid2.valueMatrix(i,datagrid2.colRef("fee_vat"));
							var tot_fee = datagrid2.valueMatrix(i,datagrid2.colRef("tot_fee"));
							var exct_cnt = datagrid2.valueMatrix(i,datagrid2.colRef("exct_cnt"));
							var exct_uprc = datagrid2.valueMatrix(i,datagrid2.colRef("exct_uprc"));
							var exct_amt = datagrid2.valueMatrix(i,datagrid2.colRef("exct_amt"));							
							//alert(exct_uprc);
							if(exct_uprc != ""){
								//일반 정산인 경우 요율, 수수료, 교환단가, 교환개수,교환금액은 필수
								if(fee_rate == ""){
									alert("수수료율은 필수 항목입니다.");
									return;
								}								
								if(fee == ""){
									alert("수수료는 필수 항목입니다.");
									return;
								}
								if(fee_vat == ""){
									alert("수수료 부가세는 필수 항목입니다.");
									return;
								}
								if(tot_fee == ""){
									alert("총수수료는 필수 항목입니다.");
									return;
								}
								if(exct_cnt == ""){
									alert("교환개수는 필수 항목입니다.");
									return;
								}
								if(exct_uprc == ""){
									alert("교환단가는 필수 항목입니다.");
									return;
								}
								if(exct_amt == ""){
									alert("교환금액는 필수 항목입니다.");
									return;
								}
							}
							else{
								if(easy_yn == "Y"){
									//낙전수입인 경우는 낙전금액만 필수
									var easy_amt = datagrid2.valueMatrix(i,datagrid2.colRef("easy_amt"));
									if(easy_amt == ""){
										alert("낙전수입은 필수 항목입니다.");
										return;
									}
									//교환단가가 없는 경우 묶여서 입력한것이기 때문에 필수항목 축소시킴
									if(exct_uprc != ""){
										if(fee == ""){
											alert("수수료는 필수 항목입니다.");
											return;
										}
										if(fee_vat == ""){
											alert("수수료 부가세는 필수 항목입니다.");
											return;
										}
										if(tot_fee == ""){
											alert("총수수료는 필수 항목입니다.");
											return;
										}
										if(exct_cnt == ""){
											alert("교환개수는 필수 항목입니다.2");
											return;
										}
										if(exct_amt == ""){
											alert("교환금액는 필수 항목입니다.");
											return;
										}
									}									
								}	
							}
						}
					}					
					if( instance1.selectSingleNode("/root/resData/resForm/flag" ) == null )
					{
						model.makeNode("/root/resData/resForm/flag");
					}
					model.setValue("/root/resData/resForm/flag", "U");
					model.send("ad_pub_3430_a");
					if( submit_completed() )
					{
						loadData();
					}
				]]>
			</script>
		</button>
		<button id="button9" class="btn03" crud="D" style="left:743px; top:430px; width:65px; height:21px; ">
			<caption>정산삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					//발주전표번호 확인
					var podr_slip_no = otp_podr_slip_no.label;
					
					if(podr_slip_no == ""){
						alert("발주전표 조회 먼저 하십시요.");
						return;
					}
					model.setValue("/root/resData/resForm/multiUpdateData2"	,datagrid2.getUpdateData());

					// 필수입력사항 체크
					if( validateReq() == false )		return;
					
					//datagrid2 체크
					for(var i=datagrid2.fixedRows;i<datagrid2.rows; i++){ 
						var stat = datagrid2.rowStatus(i);
						if(stat == 2){
							//마감
							var clos_stat = datagrid2.valueMatrix(i,datagrid2.colRef("clos_stat"));
							if(clos_stat == "마감" && trim(clos_stat) != "" ){
								alert("마감된 정산전표는 정산 삭제할 수 없습니다.");
								return;
							}
							//계산서발행
							var tax_yn = datagrid2.valueMatrix(i,datagrid2.colRef("sale_stmt_issu_yn"));
							if(tax_yn == "Y" || tax_yn == "A"){
								alert("세금계산서가 발행된 정산전표는 삭제할 수 없습니다.");
								return;
							}
						}
					}	
					// 7. 삭제는 확인 질문
					if( windowConfirm("삭제하시겠습니까?") )
					{
						if( instance1.selectSingleNode("/root/resData/resForm/flag") == null )
						{
							model.makeNode("/root/resData/resForm/flag");
						}					
						model.setValue("/root/resData/resForm/flag", "D");
						model.send("ad_pub_3430_a");
						if( submit_completed() )
						{
							//model.reset();
							//initPage();
							loadData();
						}
					}				
				]]>
			</script>
		</button>
		<button id="button10" class="btn03" crud="C" style="left:610px; top:430px; width:65px; height:21px; ">
			<caption>정산입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					//발주전표번호 확인
					var podr_slip_no = otp_podr_slip_no.label;

					if(podr_slip_no == ""){
						alert("발주전표 조회 먼저 하십시요.");
						return;
					}
					model.setValue("/root/resData/resForm/multiUpdateData2"	,datagrid2.getUpdateData());
					// 필수입력사항 체크=>resForm 체크
					if( validateReq() == false )		return;
					//datagrid2 체크
					for(var i=datagrid2.fixedRows;i<datagrid2.rows; i++){ 
						var stat = datagrid2.rowStatus(i);
						if(stat == 2){
							//마감
							var clos_stat = datagrid2.valueMatrix(i,datagrid2.colRef("clos_stat"));
							if(clos_stat == "마감" && trim(clos_stat) != "" ){
								alert("마감된 정산전표는 정산입력할 수 없습니다.");
								return;
							}
							//등록확인
							var exct_dt = datagrid2.valueMatrix(i,datagrid2.colRef("exct_dt"));
							var exct_seq = datagrid2.valueMatrix(i,datagrid2.colRef("exct_seq"));
							if(exct_dt != "" && exct_seq != ""){
								alert("이미 등록된 전표입니다.");
								return;
							}
							//낙전수입 확인
						    var easy_yn = datagrid2.valueMatrix(i,datagrid2.colRef("easy_yn"));
							
							var fee_rate = datagrid2.valueMatrix(i,datagrid2.colRef("fee_rate"));
							var fee = datagrid2.valueMatrix(i,datagrid2.colRef("fee"));
							var fee_vat = datagrid2.valueMatrix(i,datagrid2.colRef("fee_vat"));
							var tot_fee = datagrid2.valueMatrix(i,datagrid2.colRef("tot_fee"));
							var exct_cnt = datagrid2.valueMatrix(i,datagrid2.colRef("exct_cnt"));
							var exct_uprc = datagrid2.valueMatrix(i,datagrid2.colRef("exct_uprc"));
							var exct_amt = datagrid2.valueMatrix(i,datagrid2.colRef("exct_amt"));							
							
							if(exct_uprc != ""){
								//일반 정산인 경우 요율, 수수료, 교환단가, 교환개수,교환금액은 필수
								if(fee_rate == ""){
									alert("수수료율은 필수 항목입니다.");
									return;
								}								
								if(fee == ""){
									alert("수수료는 필수 항목입니다.");
									return;
								}
								if(fee_vat == ""){
									alert("수수료 부가세는 필수 항목입니다.");
									return;
								}
								if(tot_fee == ""){
									alert("총수수료는 필수 항목입니다.");
									return;
								}
								if(exct_cnt == ""){
									alert("교환개수는 필수 항목입니다.");
									return;
								}
								if(exct_uprc == ""){
									alert("교환단가는 필수 항목입니다.");
									return;
								}
								if(exct_amt == ""){
									alert("교환금액는 필수 항목입니다.");
									return;
								}
							}
							else{
								if(easy_yn == "Y"){
									//낙전수입인 경우는 낙전금액만 필수
									var easy_amt = datagrid2.valueMatrix(i,datagrid2.colRef("easy_amt"));
									if(easy_amt == ""){
										alert("낙전수입은 필수 항목입니다.");
										return;
									}
									//교환단가가 없는 경우 묶여서 입력한것이기 때문에 필수항목 축소시킴
									if(exct_uprc != ""){
										if(fee == ""){
											alert("수수료는 필수 항목입니다.");
											return;
										}
										if(fee_vat == ""){
											alert("수수료 부가세는 필수 항목입니다.");
											return;
										}
										if(tot_fee == ""){
											alert("총수수료는 필수 항목입니다.");
											return;
										}
										if(exct_cnt == ""){
											alert("교환개수는 필수 항목입니다.");
											return;
										}
										if(exct_amt == ""){
											alert("교환금액는 필수 항목입니다.");
											return;
										}
									}									
								}	
							}
						}
					}
					// 등록
					if( instance1.selectSingleNode("/root/resData/resForm/flag") == null ){
						model.makeNode("/root/resData/resForm/flag");
					}
					model.setValue("/root/resData/resForm/flag", "I");
					model.send("ad_pub_3430_a");
					if( submit_completed() ){	
						loadData();
					}
				]]>
			</script>
		</button>
		<caption id="caption5" class="list_cap03" style="left:314px; top:120px; width:90px; height:26px; text-align:center; ">피수정전표</caption>
		<output id="output1" ref="/root/resData/resForm/pre_podr_slip_no" style="left:407px; top:124px; width:133px; height:18px; border-style:solid; "/>
		<select id="checkbox1" ref="/root/resData/resForm/upd_yn" disabled="true" overflow="visible" appearance="full" style="left:545px; top:124px; width:67px; height:17px; border-style:none; ">
			<choices>
				<item>
					<label>수정여부</label>
					<value>Y</value>
				</item>
			</choices>
		</select>
		<button id="btn_updpubc" class="btn04" crud="C" style="left:739px; top:40px; width:88px; height:21px; ">
			<caption>수정전표생성</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var chk_hdn = model.getValue("/root/col_hdn");
					if (chk_hdn == "true"){
						alert("수정할 행 선택 후 다시 수정전표생성 버튼을 클릭해주세요.");
						col_hdn("false");
						return;
					}				
					var chk = 0;
					//체크박스 확인
					for(var i=datagrid1.fixedRows;i<datagrid1.rows; i++){ 
						var upd_select = datagrid1.valueMatrix(i,datagrid1.colRef("upd_select"));
						if(upd_select != "N"){
							datagrid1.addStatus(i,"update");
							chk = chk + 1;
						}
					}				
						
					if(chk == 0){
						alert("수정전표 생성할 발주전표를 선택해주세요.");
						return;
					}					
					
					var medi_cd			= 	model.getValue("/root/resData/resForm/medi_cd");
					var proc_dt			= 	model.getValue("/root/resData/resForm/proc_dt");
					var proc_seq			= 	model.getValue("/root/resData/resForm/proc_seq");
					var podr_dt			= 	model.getValue("/root/resData/resForm/podr_dt");
					var upd_yn			= 	model.getValue("/root/resData/resForm/upd_yn");
					var exct_yn				=	model.getValue("/root/resData/resForm/exct_yn");
					var sale_stmt_issu_yn 	= 	model.getValue("/root/resData/resForm/sale_stmt_issu_yn");
					var clos_stat			= 	model.getValue("/root/resData/resForm/clos_stat");
					var clamt_stat			=	model.getValue("/root/resData/resForm/clamt_stat");
					
					model.setValue("/root/resData/resForm/multiUpdateData"	,datagrid1.getUpdateData());
					
					// 4. 마감여부 체크
					if( clos_stat != "마감" && trim(clos_stat) == "" )
					{
						alert("이 전표는 마감 전 전표입니다.\n\r수정하세요.");
						return;
					}
					for(var i=datagrid1.fixedRows;i<datagrid1.rows; i++){ 	
						exct_yn = datagrid1.valueMatrix(i,datagrid1.colRef("exct_yn"));
						sale_stmt_issu_yn = datagrid1.valueMatrix(i,datagrid1.colRef("sale_stmt_issu_yn"));
						clamt_stat = datagrid1.valueMatrix(i,datagrid1.colRef("clamt_stat"));
				
						// 5. 계산서 발행 여부 체크
						if( sale_stmt_issu_yn != "N" && trim(sale_stmt_issu_yn) != "" )
						{
							alert("이 전표는 계산서가 발행된 전표입니다.\n\r계산서 발행을 취소한 후 삭제하세요.");
							return;
						}
						// 6. 수금상태 체크
//						if( clamt_stat != "미수" && trim(clamt_stat) != "" )
//						{
//							alert("이 전표는 입금이 상계된 전표입니다.\n\r입금을 취소한 후 삭제하세요.");
//							return;
//						}
					}
					// 7. 확인 질문
					if( windowConfirm("수정전표를 발행하시겠습니까?") )
					{
						if( instance1.selectSingleNode("/root/resData/resForm/flag") == null )
						{
							model.makeNode("/root/resData/resForm/flag");
						}					
						model.setValue("/root/resData/resForm/flag", "A");
						model.send("ad_pub_3420_a");
						if( submit_completed() )
						{
							col_hdn("true");
							model.setValue("/root/resData/resForm/proc_seq", model.getValue("/root/msgData/proc_seq"));
							inp_proc_seq.refresh();
							loadData();
						}
					}				
				]]>
			</script>
		</button>
		<button id="button11" class="btn03" crud="R" style="left:685px; top:186px; width:65px; height:21px; ">
			<caption>상태변경</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					//체크박스 확인
					var arow = model.getValue("/root/reqData/searchData/arow");
					var exct_yn = "";
					if(arow == ""){
						alert("상태변경할 행을 먼저 선택해주세요.");
						return;
					}else{
						for(var i=datagrid1.fixedRows;i<datagrid1.rows; i++){ 
							var check = datagrid1.valueMatrix(i,datagrid1.colRef("arow"));
							if(check == arow){
								exct_yn   = datagrid1.valueMatrix(i,datagrid1.colRef("exct_yn"));
								datagrid1.addStatus(i,"update");
							}
						}
					}
					model.setValue("/root/resData/resForm/multiUpdateData"	,datagrid1.getUpdateData());
					// 필수입력사항 체크
					if( validateReq() == false )		return;
					// 등록
					else{
						if(windowConfirm("수정하시겠습니까?")){	
							if( instance1.selectSingleNode("/root/resData/resForm/flag") == null ){
								model.makeNode("/root/resData/resForm/flag");
							}
							//Y=>S,S=>Y
							if(exct_yn == "Y"){
								model.setValue("/root/resData/resForm/flag", "S");
							}else{
								model.setValue("/root/resData/resForm/flag", "Y");
							}
							model.send("ad_pub_3420_a");
							if( submit_completed() ){	
								model.setValue("/root/resData/resForm/proc_seq", model.getValue("/root/msgData/proc_seq"));
								inp_proc_seq.refresh();
								loadData();
							}
						}
					}
				]]>
			</script>
		</button>
		<button id="button12" class="btn02" crud="D" style="left:629px; top:186px; width:50px; height:21px; ">
			<caption>행삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var chk = 0;
					//체크박스 확인
					for(var i=datagrid1.fixedRows;i<datagrid1.rows; i++){ 
						var select = datagrid1.valueMatrix(i,datagrid1.colRef("select"));
						if(select != "N"){
							datagrid1.addStatus(i,"update");
							chk = chk + 1;
						}
					}				
						
					if(chk == 0){
						alert("삭제할 발주전표를 선택해주세요.");
						return;
					}					
					
					var medi_cd			= 	model.getValue("/root/resData/resForm/medi_cd");
					var proc_dt			= 	model.getValue("/root/resData/resForm/proc_dt");
					var proc_seq			= 	model.getValue("/root/resData/resForm/proc_seq");
					var podr_dt			= 	model.getValue("/root/resData/resForm/podr_dt");
					var upd_yn			= 	model.getValue("/root/resData/resForm/upd_yn");
					var exct_yn				=	model.getValue("/root/resData/resForm/exct_yn");
					var sale_stmt_issu_yn 	= 	model.getValue("/root/resData/resForm/sale_stmt_issu_yn");
					var clos_stat			= 	model.getValue("/root/resData/resForm/clos_stat");
					var clamt_stat			=	model.getValue("/root/resData/resForm/clamt_stat");
					
					model.setValue("/root/resData/resForm/multiUpdateData"	,datagrid1.getUpdateData());
					
					// 삭제
					// 3. 수정여부 체크
					if( upd_yn != "N" )
					{
						alert("이 전표는 수정된 전표입니다.\n\r수정전표를 먼저 삭제하세요.");
						return;
					}
					// 4. 마감여부 체크
					if( clos_stat == "마감" && trim(clos_stat) != "" )
					{
						alert("이 전표는 마감된 전표입니다.\n\r마감취소를 실행 후 삭제하세요.");
						return;
					}
					
					for(var i=datagrid1.fixedRows;i<datagrid1.rows; i++){ 	
						var select = datagrid1.valueMatrix(i,datagrid1.colRef("select"));
						if(select != "N"){					
							exct_yn = datagrid1.valueMatrix(i,datagrid1.colRef("exct_yn"));
							sale_stmt_issu_yn = datagrid1.valueMatrix(i,datagrid1.colRef("sale_stmt_issu_yn"));
							clamt_stat = datagrid1.valueMatrix(i,datagrid1.colRef("clamt_stat"));
							//alert(exct_yn);
							if( exct_yn != "N")
							{
								alert("이 전표는 정산된 전표입니다.");
								return;
							}					
							// 5. 계산서 발행 여부 체크
							if( sale_stmt_issu_yn != "N" && trim(sale_stmt_issu_yn) != "" )
							{
								alert("이 전표는 계산서가 발행된 전표입니다.\n\r계산서 발행을 취소한 후 삭제하세요.");
								return;
							}
							// 6. 수금상태 체크
							if( clamt_stat != "미수" && trim(clamt_stat) != "" )
							{
								alert("이 전표는 입금이 상계된 전표입니다.\n\r입금을 취소한 후 삭제하세요.");
								return;
							}
						}	
					}
					// 7. 삭제는 확인 질문
					if( windowConfirm("삭제하시겠습니까?") )
					{
						if( instance1.selectSingleNode("/root/resData/resForm/flag") == null )
						{
							model.makeNode("/root/resData/resForm/flag");
						}					
						model.setValue("/root/resData/resForm/flag", "D");
						model.send("ad_pub_3420_a");
						if( submit_completed() )
						{
							model.setValue("/root/resData/resForm/proc_seq", model.getValue("/root/msgData/proc_seq"));
							inp_proc_seq.refresh();
							loadData();
						}
					}				
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
