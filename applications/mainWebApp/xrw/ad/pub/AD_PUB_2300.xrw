<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
						</comboSet>
						<pageInfo/>
						<hndl_nm/>
					</initData>
					<codeData>
						<medi_cd>
							<item>
								<label/>
								<value/>
							</item>
						</medi_cd>
						<hndl_clsf>
							<item>
								<label/>
								<value/>
							</item>
						</hndl_clsf>
						<indt_clsf>
							<item>
								<label/>
								<value/>
							</item>
						</indt_clsf>
						<indt_clsf2>
							<item>
								<label/>
								<value/>
							</item>
						</indt_clsf2>
						<std_clsf>
							<item>
								<label/>
								<value/>
							</item>
						</std_clsf>
						<pubc_clsf>
							<item>
								<label/>
								<value/>
							</item>
						</pubc_clsf>
						<chro_clsf>
							<item>
								<label/>
								<value/>
							</item>
						</chro_clsf>
						<grp_cmpy_cd>
							<item>
								<label/>
								<value/>
							</item>
						</grp_cmpy_cd>
						<nwsp_type_clsf>
							<item>
								<label/>
								<value/>
							</item>
						</nwsp_type_clsf>
						<indt_clsf_2>
							<item>
								<label/>
								<value/>
							</item>
						</indt_clsf_2>
						<indt_clsf2_2>
							<item>
								<label/>
								<value/>
							</item>
						</indt_clsf2_2>
					</codeData>
					<reqData>
						<fwdData/>
						<searchData>
							<medi_cd/>
							<select_dt>01</select_dt>
							<frdt/>
							<todt/>
							<dtoption>01</dtoption>
							<hndl_clsf/>
							<dlco_no/>
							<dlco_nm/>
							<slcrg_pers/>
							<slcrg_pers_nm/>
							<pre_issu_yn>N</pre_issu_yn>
							<type_no/>
						</searchData>
						<reqForm>
						</reqForm>
						<multiUpdateData/>
						<searchData2>
							<nwsp_type_clsf/>
							<select_dt>01</select_dt>
							<frdt/>
							<todt/>
							<dtoption>01</dtoption>
							<notaxrate_data_yn/>
							<chro_clsf/>
							<medi_cd/>
							<indt_clsf/>
							<indt_clsf2/>
							<std_clsf/>
							<advt_cont/>
							<grp_cmpy_cd/>
							<sale_stmt_issu_yn/>
							<dlco_nm/>
							<fradvt_fee/>
							<toadvt_fee/>
							<frvat/>
							<tovat/>
							<frtot_rcpm_amt/>
							<totot_rcpm_amt/>
							<frtot_misu_amt/>
							<totot_misu_amt/>
							<elec_tax_stmt_yn/>
						</searchData2>
						<pubc_dt/>
					</reqData>
					<resData>
						<resForm>
							<tot_pubc_amt/>
							<tot_vat_amt/>
							<tot_misu_amt/>
							<tot_fee_amt/>
							<tot_pubc/>
						</resForm>
						<resForm2>
							<tot_adv_amt/>
							<tot_fee_amt/>
							<tot_vat_amt/>
							<tot_misu_amt/>
							<tot_pubc/>
							<tot_adv_amt2/>
							<tot_fee_amt2/>
							<tot_vat_amt2/>
							<tot_misu_amt2/>
							<tot_pubc2/>
						</resForm2>
						<gridData>
							<record>
								<sale_stmt_issu_yn/>
								<pubc_dt/>
								<pubc_slip_no/>
								<medi_nm/>
								<sect/>
								<publ_std/>
								<issu_ser_no/>
								<slcrg_nm/>
								<mchrg_nm/>
								<dlco_nm/>
								<agn/>
								<advt_fee/>
								<vat/>
								<tot_rcpm_amt/>
								<misu_tot_amt/>
								<fee/>
								<tax_clsf/>
								<patr_chrg_info/>
								<tax_email/>
								<advt_clsf/>
							</record>
							<record2>
								<sale_stmt_issu_yn/>
								<pubc_dt/>
								<pubc_slip_no/>
								<medi_nm/>
								<publ_std/>
								<issu_ser_no/>
								<slcrg_nm/>
								<mchrg_nm/>
								<dlco_nm/>
								<agn/>
								<advt_fee/>
								<vat/>
								<tot_rcpm_amt/>
								<misu_tot_amt/>
								<fee/>
								<tax_clsf/>
								<notaxrate_data_get_dt/>
								<exrate/>
								<mony_kind/>
								<frex_cntr_amt/>
								<patr_chrg_info/>
								<tax_email/>
								<advt_clsf/>
							</record2>
						</gridData>
						<gd_upload>
							<record>
								<medi_cd/>
								<hndl_clsf/>
								<dlco_no/>
								<dlco_nm/>
								<advt_cont/>
								<page/>
								<issu_ser_no/>
								<publ_std/>
								<advt_fee/>
								<vat/>
								<agn/>
								<agn_nm/>
								<fee_rate/>
								<fee/>
								<fee_vat/>
								<advt_clsf/>
								<tax_clsf/>
								<pre_issu_yn/>
								<remk/>
								<slcrg_pers/>
								<mchrg_pers/>
							</record>
						</gd_upload>
					</resData>
					<tempData>
						<keyData>
							<medi_cd/>
							<pubc_occr_dt/>
							<pubc_occr_seq/>
						</keyData>
					</tempData>
					<msgData/>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				
				var currentdt = getCurrentDate();
				var frdt = dateAdd("d", 0, currentdt);	//현재일자
				var todt = dateAdd("d",0, currentdt);	//현재일자
				
				model.setValue("/root/reqData/searchData/frdt", frdt);   //기본조회
				model.setValue("/root/reqData/searchData/todt", todt);  //기본조회			
				
				model.setValue("/root/reqData/searchData2/frdt", frdt);   //상세조회
				model.setValue("/root/reqData/searchData2/todt", todt);  //상세조회
				
				model.send("ad_pub_2300_m");	
				
				model.copyNode("/root/codeData/medi_cd", "/root/tempData/medi_cd");
				model.copyNode("/root/codeData/hndl_clsf", "/root/tempData/hndl_clsf");
				model.copyNode("/root/codeData/indt_clsf", "/root/tempData/indt_clsf");
				model.copyNode("/root/codeData/indt_clsf2", "/root/tempData/indt_clsf2");
				model.copyNode("/root/codeData/indt_clsf_2", "/root/tempData/indt_clsf");
				model.copyNode("/root/codeData/indt_clsf2_2", "/root/tempData/indt_clsf2");
				model.copyNode("/root/codeData/std_clsf", "/root/tempData/std_clsf");	
				model.copyNode("/root/codeData/chro_clsf", "/root/tempData/chro_clsf");
				model.copyNode("/root/codeData/grp_cmpy_cd", "/root/tempData/grp_cmpy_cd");
				model.copyNode("/root/codeData/nwsp_type_clsf", "/root/tempData/nwsp_type_clsf");
				
				makeComboGubun("A", "/root/codeData/grp_cmpy_cd", "item", "label", "value");
				
//				var indt_clsf = cb_indt_clsf.value; 
//				var nodeList = instance1.selectNodes("/root/tempData/indt_clsf2/item[pcode='" + indt_clsf + "']");
//				
//				model.removenode("/root/codeData/indt_clsf2");
//				model.makeNode("/root/codeData/indt_clsf2");
//				var trgNode = instance1.selectSingleNode("/root/codeData/indt_clsf2");
//				for (var i = 0; i < nodeList.length; i++) {
//					var node = nodeList.item(i);	
//					trgNode.appendChild(node);
//				}
//				
//				cb_indt_clsf.refresh();		
//										
//
//				var indt_clsf_2 = cb_indt_clsf_2.value; 
//				var nodeList = instance1.selectNodes("/root/tempData/indt_clsf2/item[pcode='" + indt_clsf + "']");
//				
//				model.removenode("/root/codeData/indt_clsf2_2");
//				model.makeNode("/root/codeData/indt_clsf2_2");
//				var trgNode = instance1.selectSingleNode("/root/codeData/indt_clsf2_2");
//				for (var i = 0; i < nodeList.length; i++) {
//					var node = nodeList.item(i);	
//					trgNode.appendChild(node);
//				}
//				
//				cb_indt_clsf_2.refresh();		
										
				model.refresh();
				
				initPage();	
					
				switch1.selectedIndex = 0;
									
				]]>
			</script>
			<submission id="ad_pub_2300_m" action="/ad/pub/2300" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/resData"/>
			<submission id="ad_pub_2310_l" action="/ad/pub/2310" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData"/>
			<submission id="ad_pub_2311_l" action="/ad/pub/2311" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData2" resultref="/root/resData"/>
			<submission id="ad_pub_2313_a" action="/ad/pub/2313" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/msgData"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
			var UPLOAD_HEADER_MAX 	= 21;

			var visible_grp_detail_search = false;
			
			function initPage(){
				cd_medi_cd.select(0);  
				cd_medi_cd.refresh();	
				
				cd_medi_cd2.select(0);  
				cd_medi_cd2.refresh();	
				
				cb_pre_issu_yn.select(0);
				cb_pre_issu_yn.refresh();
				cb_dt_clsf.select(0);
				cb_dt_clsf.refresh();
			}
			
			function setDlcoInfo(dlco_no, dlco_nm){
				
				model.setValue("/root/reqData/searchData/dlco_no", dlco_no);
				model.setValue("/root/reqData/searchData/dlco_nm", dlco_nm);					
				inp_dlco_no.refresh();
				inp_dlco_nm.refresh();
			}	
			
			function goReport(gubun){
					
					// 오즈관련 노드 초기화..					
					resetOznode();					
					
					var type = model.getValue("/root/reqData/searchData/type_no");
					var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");
					var frdt = model.getValue("/root/reqData/searchData/frdt");
					var todt = model.getValue("/root/reqData/searchData/todt");
							
					if(type == "1"){//광고 게재표			
						if(frdt == "" || todt == ""){
							alert("게재기간을 입력해 주세요!");
						}else{
							// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)	
							makeNodeValue("/root/oz_data/ozrName", "ad/SP_AD_PUB_2312_P");				
						
							makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd", model.property("ss_cmpycd"));	//테스트는 고정   model.property("ss_cmpycd")
							makeNodeValue("/root/oz_data/odiParam/iv_medi_cd",  medi_cd);
							makeNodeValue("/root/oz_data/odiParam/iv_from_dt", frdt);
							makeNodeValue("/root/oz_data/odiParam/iv_to_dt", todt);
							makeNodeValue("/root/oz_data/odiParam/iv_pers",  model.property("ss_emp_no"));
													
							// 레포트뷰어 호출.					
							openOzwin("/root/oz_data");								
						}
					}
				}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="1,10;1,936;2,60;2,70;2,93;2,98;" style="font-family:굴림; ">
		<switch id="switch1" class="gro_sel" style="left:10px; top:92px; width:927px; height:622px; ">
			<case id="case1" selected="true">
				<input id="input6" ref="/root/resData/resForm/tot_misu_amt" visibility="hidden" editable="false" format="#,###" style="left:461px; top:554px; width:88px; height:18px; text-align:right; "/>
				<caption id="caption39" class="list_cap03" visibility="hidden" style="left:394px; top:550px; width:60px; height:26px; ">미수액</caption>
				<datagrid id="datagrid1" nodeset="/root/resData/gridData/record" caption="계산서^게재일^전표번호^매체^광고분류^쪽수^규격^호수^영업담당^관리담당^광고내용^광고주^광고료^부가세^대행사^대행요율^대행료^계산서구분^발행구분^hidden_pubc_slip_no" colsep="^" colwidth="60, 70, 90, 80, 70, 60, 70, 90, 60, 60,100, 130, 100, 90, 100, 80, 100, 80,80,50" explorerbar="sort" frozencols="5" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:5px; top:74px; width:915px; height:465px; ">
					<col ref="sale_stmt_issu_yn"/>
					<col ref="pubc_dt" format="yyyy-mm-dd"/>
					<col ref="pubc_slip_no" format="99999999-9999"/>
					<col ref="medi_nm"/>
					<col ref="advt_clsf"/>
					<col ref="sect"/>
					<col ref="publ_std"/>
					<col ref="issu_ser_no"/>
					<col ref="slcrg_nm"/>
					<col ref="mchrg_nm"/>
					<col ref="advt_cont" style="text-align:left; "/>
					<col ref="dlco_nm" style="text-align:left; word-wrap:none; "/>
					<col ref="advt_fee" format="#,###" style="text-align:right; "/>
					<col ref="vat" format="#,###" style="text-align:right; "/>
					<col ref="agn" style="text-align:left; word-wrap:none; "/>
					<col ref="fee_rate" format="#,###" style="text-align:right; "/>
					<col ref="fee" format="#,###" style="text-align:right; "/>
					<col ref="tax_clsf"/>
					<col ref="pre_issu_yn"/>
					<col ref="hidden_pubc_slip_no" visibility="hidden"/>
					<script type="javascript" ev:event="ondblclick">
						<![CDATA[			
						
						if(!isDataRegion(datagrid1)) return;
									
						var row = datagrid1.row;
						
						if(row >= datagrid1.fixedRows){
							//var pubc_slip_no = model.getValue("/root/resData/gridData/record["+row+"]/pubc_slip_no");
							var pubc_slip_no 	=  datagrid1.valueMatrix(datagrid1.row, datagrid1.colRef("hidden_pubc_slip_no"));
							windowLoadPublPubc2(pubc_slip_no);
						}						
						]]>
					</script>
				</datagrid>
				<caption id="caption4" class="list_cap02" style="left:5px; top:5px; width:915px; height:28px; "/>
				<input id="input21" ref="/root/reqData/searchData/todt" class="req" navindex="4" inputtype="date" format="yyyy-mm" style="left:636px; top:11px; width:70px; height:18px; "/>
				<caption id="caption34" style="left:613px; top:14px; width:15px; height:17px; ">~</caption>
				<select1 id="cb_dt_clsf" ref="/root/reqData/searchData/dtoption" navindex="5" appearance="minimal" style="left:713px; top:11px; width:67px; height:18px; ">
					<choices>
						<item>
							<label>당월</label>
							<value>02</value>
						</item>
						<item>
							<label>전월</label>
							<value>03</value>
						</item>
						<item>
							<label>년간</label>
							<value>04</value>
						</item>
					</choices>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						var currentdt = getCurrentDate();
						var currentmt = getCurrentMonth();				
									
						var dt_clsf = model.getValue("/root/reqData/searchData/dtoption"); //선택한 콤보박스 값..
										
						if(dt_clsf == "02"){
							var frdt = currentdt.substring(0,6); //당월
							var todt = currentdt.substring(0,6);	//당월
							
							model.setValue("/root/reqData/searchData/frdt", frdt); 
							model.setValue("/root/reqData/searchData/todt", todt); 
						}else if(dt_clsf == "03") {
							var frdt = dateAdd("m", -1, currentmt);
							var todt = dateAdd("m", -1, currentmt); 
							
							model.setValue("/root/reqData/searchData/frdt", frdt); 
							model.setValue("/root/reqData/searchData/todt", todt);
						}else if(dt_clsf == "04") {
							var frdt =  currentmt.substring(0,4)+"01";
							var todt =  currentmt;
							
							model.setValue("/root/reqData/searchData/frdt", frdt); 
							model.setValue("/root/reqData/searchData/todt", todt);
						}	
					
						model.refresh();
						
					]]>
					</script>
				</select1>
				<select1 id="cd_medi_cd" ref="/root/reqData/searchData/medi_cd" navindex="1" appearance="minimal" style="left:87px; top:10px; width:100px; height:18px; ">
					<choices>
						<itemset nodeset="/root/codeData/medi_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<input id="input2" ref="/root/reqData/searchData/frdt" class="req" navindex="3" inputtype="date" format="yyyy-mm" style="left:536px; top:11px; width:70px; height:18px; "/>
				<caption id="caption7" class="list_cap01" style="left:5px; top:5px; width:80px; height:28px; ">매체구분</caption>
				<caption id="caption8" class="list_cap01" style="left:373px; top:5px; width:60px; height:28px; ">게재기간</caption>
				<caption id="caption11" class="list_cap02" style="left:5px; top:32px; width:915px; height:28px; "/>
				<caption id="caption54" class="list_cap01" style="left:5px; top:32px; width:80px; height:28px; ">거래처구분</caption>
				<input id="inp_dlco_no" ref="/root/reqData/searchData/dlco_no" navindex="7" autonext="false" format="99999999" style="left:179px; top:37px; width:55px; height:18px; ">
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						var dlco_no = inp_dlco_no.currentText;
						model.setValue("/root/reqData/searchData/dlco_no", lpad(dlco_no, 8, "0"));
						inp_dlco_no.refresh();
				
						commonSubmission("9004", inp_dlco_no.currentText,  inp_dlco_no, inp_dlco_nm);
						]]>
					</script>
					<script type="javascript" ev:event="onkeypress">
						<![CDATA[
						if(event.keyCode== "13"){
							var dlco_no = inp_dlco_no.currentText;
							model.setValue("/root/reqData/searchData/dlco_no", lpad(dlco_no, 8, "0"));
							inp_dlco_no.refresh();
					
							commonSubmission("9004", inp_dlco_no.currentText,  inp_dlco_no, inp_dlco_nm);						
						}
						]]>
					</script>
				</input>
				<input id="inp_dlco_nm" ref="/root/reqData/searchData/dlco_nm" navindex="8" imemode="hangul" inputtype="button" style="left:240px; top:37px; width:125px; height:18px; ">
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[						
						var dlco_clsf = model.getValue("/root/reqData/searchData/hndl_clsf");
						if(dlco_clsf == "1" || dlco_clsf == "3"){
							showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText);
						}else if(dlco_clsf == "2"){
							showAdvcsSearchPopup("", "", "Y", "", "", inp_dlco_nm.currentText);
						}else if(dlco_clsf == "4"){
							showAdvcsSearchPopup("", "", "", "Y", "", inp_dlco_nm.currentText);
						}else if(dlco_clsf == "5"){
							showAdvcsSearchPopup("", "", "", "", "Y", inp_dlco_nm.currentText);
						}else if(dlco_clsf == "6"){
							showAdvcsSearchPopup("", "", "", "Y", "Y", inp_dlco_nm.currentText);
						}else if(dlco_clsf == "7"){	
							showAdvcsSearchPopup("", "", "", "", "Y", inp_dlco_nm.currentText);
						}else if(dlco_clsf == "9"){
							showAdvcsSearchPopup("", "", "", "Y", "Y", inp_dlco_nm.currentText);
						}else{
							showAdvcsSearchPopup("Y", "Y", "Y", "Y", "Y", inp_dlco_nm.currentText);
						}
						]]>
					</script>
					<script type="javascript" ev:event="onkeypress">
						<![CDATA[						
						if(event.keyCode== "13"){
							var dlco_clsf = model.getValue("/root/reqData/searchData/hndl_clsf");
							if(dlco_clsf == "1" || dlco_clsf == "3"){
								findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
							}else if(dlco_clsf == "2"){
								findDlcoNoByName("2", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
							}else if(dlco_clsf == "4" || dlco_clsf == "5" || dlco_clsf == "6" || dlco_clsf == "7" || dlco_clsf == "9"){
								findDlcoNoByName("4", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
							}else{
								findDlcoNoByName("", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
							}
						}
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
							var dlco_clsf = model.getValue("/root/reqData/searchData/hndl_clsf");
							if(dlco_clsf == "1" || dlco_clsf == "3"){
								findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
							}else if(dlco_clsf == "2"){
								findDlcoNoByName("2", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
							}else if(dlco_clsf == "4" || dlco_clsf == "5" || dlco_clsf == "6" || dlco_clsf == "7" || dlco_clsf == "9"){
								findDlcoNoByName("4", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
							}else{
								findDlcoNoByName("", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
							}						
						]]>
					</script>
				</input>
				<caption id="caption12" class="list_cap01" style="left:373px; top:32px; width:60px; height:28px; ">영업담당</caption>
				<select1 id="combo11" ref="/root/reqData/searchData/hndl_clsf" navindex="6" appearance="minimal" style="left:87px; top:37px; width:85px; height:18px; ">
					<choices>
						<itemset nodeset="/root/codeData/hndl_clsf/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						
						var hndl_clsf = model.getValue("/root/reqData/searchData/hndl_clsf");

					        
					        if(hndl_clsf == ""){
					        		model.setValue("/root/reqData/searchData/dlco_no", "");
					        		model.setValue("/root/reqData/searchData/dlco_nm", "");
					        		inp_dlco_no.refresh();
					        		inp_dlco_nm.refresh();
					        }
											        
											
						]]>
					</script>
				</select1>
				<caption id="caption37" class="list_cap02" style="left:70px; top:550px; width:850px; height:26px; "/>
				<input id="input7" ref="/root/resData/resForm/tot_pubc" editable="false" format="#,###" style="left:790px; top:554px; width:88px; height:18px; text-align:right; "/>
				<input id="input8" ref="/root/resData/resForm/tot_vat_amt" editable="false" format="#,###" style="left:349px; top:554px; width:88px; height:18px; text-align:right; "/>
				<input id="input9" ref="/root/resData/resForm/tot_pubc_amt" editable="false" format="#,###" style="left:135px; top:554px; width:88px; height:18px; text-align:right; "/>
				<caption id="caption10" class="list_cap03" style="left:721px; top:550px; width:60px; height:26px; ">게재량</caption>
				<caption id="caption3" class="list_cap03" style="left:506px; top:550px; width:60px; height:26px; ">대행료</caption>
				<input id="input1" ref="/root/resData/resForm/tot_fee_amt" editable="false" format="#,###" style="left:575px; top:554px; width:88px; height:18px; text-align:right; "/>
				<caption id="caption36" class="list_cap03" style="left:70px; top:550px; width:60px; height:26px; ">게재액</caption>
				<caption id="caption38" class="list_cap03" style="left:281px; top:550px; width:60px; height:26px; ">부가세</caption>
				<select1 id="combo12" ref="/root/reqData/searchData/select_dt" navindex="2" appearance="minimal" style="left:444px; top:10px; width:85px; height:18px; ">
					<choices>
						<item>
							<label>게재일자</label>
							<value>01</value>
						</item>
						<item>
							<label>처리일자</label>
							<value>02</value>
						</item>
						<item>
							<label>발생일자</label>
							<value>03</value>
						</item>
					</choices>
				</select1>
				<caption id="caption5" class="tit02" style="left:4px; top:552px; width:65px; height:20px; font-size:11pxpt; ">조회기간</caption>
				<input id="inp_slcrg_pers_nm" ref="/root/reqData/searchData/slcrg_pers_nm" navindex="10" imemode="hangul" inputtype="button" style="left:508px; top:37px; width:90px; height:18px; ">
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm.currentText, inp_slcrg_pers, inp_slcrg_pers_nm);		
						]]>
					</script>
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						
						searchEmpno("setSlcrgPers", "/root/reqData/searchData/slcrg_pers", "/root/reqData/searchData/slcrg_pers_nm");
						]]>
					</script>
					<script type="javascript" ev:event="onkeypress">
						<![CDATA[
						if(event.keyCode == 13){
							findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm.currentText, inp_slcrg_pers, inp_slcrg_pers_nm);		
						}				
						]]>
					</script>
				</input>
				<input id="inp_slcrg_pers" ref="/root/reqData/searchData/slcrg_pers" navindex="9" style="left:443px; top:37px; width:60px; height:18px; ">
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[						
						commonSubmission("9005", inp_slcrg_pers.currentText,  inp_slcrg_pers, inp_slcrg_pers_nm);	
						]]>
					</script>
				</input>
				<caption id="caption1" class="list_cap01" style="left:620px; top:32px; width:60px; height:28px; ">선발행</caption>
				<select1 id="cb_pre_issu_yn" ref="/root/reqData/searchData/pre_issu_yn" navindex="11" appearance="minimal" style="left:688px; top:37px; width:92px; height:18px; ">
					<choices>
						<item>
							<label>선발행제외</label>
							<value>01</value>
						</item>
						<item>
							<label>선발행포함</label>
							<value>02</value>
						</item>
					</choices>
				</select1>
				<datagrid id="dg_upload" nodeset="/root/resData/gd_upload/record" visibility="hidden" scroll="both" caption="매체^취급처구분^광고주^광고주명^광고내용^쪽수^발행호수^규격^광고료^광고부가세^대행사^대행사명^대행요율^대행료^대행부가세^협찬광고^계산서^발행구분^비고^영업^관리" colsep="#" colwidth="60, 60, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80" explorerbar="sort" extendlastcol="scroll" mergecellsfixedcols="bycolrec" mergecellsfixedrows="byrowrec" rowheader="update" rowsep="|" selectionmode="byrow" style="left:10px; top:325px; width:300px; height:70px; ">
					<col ref="medi_cd"/>
					<col ref="hndl_clsf"/>
					<col ref="dlco_no"/>
					<col ref="dlco_nm"/>
					<col ref="advt_cont"/>
					<col ref="page"/>
					<col ref="issu_ser_no"/>
					<col ref="publ_std"/>
					<col ref="advt_fee"/>
					<col ref="vat"/>
					<col ref="agn"/>
					<col ref="agn_nm"/>
					<col ref="fee_rate"/>
					<col ref="fee"/>
					<col ref="fee_vat"/>
					<col ref="advt_clsf"/>
					<col ref="tax_clsf"/>
					<col ref="pre_issu_yn"/>
					<col ref="remk"/>
					<col ref="slcrg_pers"/>
					<col ref="mchrg_pers"/>
				</datagrid>
			</case>
			<case id="case2" style="left:0px; top:0px; width:962px; height:620px; ">
				<input id="input17" ref="/root/resData/resForm2/tot_misu_amt" visibility="hidden" editable="false" format="#,###" style="left:625px; top:554px; width:88px; height:18px; text-align:right; "/>
				<caption id="caption25" class="list_cap03" visibility="hidden" style="left:556px; top:550px; width:60px; height:26px; ">미수액</caption>
				<caption id="caption35" class="list_cap03" visibility="hidden" style="left:556px; top:580px; width:60px; height:26px; ">미수액</caption>
				<input id="input11" ref="/root/resData/resForm2/tot_misu_amt2" visibility="hidden" editable="false" format="#,###" style="left:625px; top:584px; width:88px; height:18px; text-align:right; "/>
				<datagrid id="datagrid2" nodeset="/root/resData/gridData/record2" caption="계산서발행^게재일^전표번호^매체^광고분류^규격^호수^영업담당^관리담당^상대담당^광고주^대행사^광고료^부가세^입금총액^미수총액^대행료^이메일^계산서구분^증빙일자^환율^화폐종류^외환계약액^hidden_pubc_slip_no" colsep="^" colwidth="70, 70, 120, 50, 70, 70, 60, 60, 60,100, 130, 130, 80, 70, 80, 79, 80,100, 80, 70, 80, 70, 80, 50" explorerbar="sort" frozencols="4" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:5px; top:100px; width:915px; height:439px; ">
					<col ref="sale_stmt_issu_yn"/>
					<col ref="pubc_dt" format="yyyy-mm-dd"/>
					<col ref="pubc_slip_no" format="99999999-9999"/>
					<col ref="medi_nm"/>
					<col ref="advt_clsf"/>
					<col ref="publ_std" visibility="hidden"/>
					<col ref="issu_ser_no" visibility="hidden"/>
					<col ref="slcrg_nm"/>
					<col ref="mchrg_nm"/>
					<col ref="patr_chrg_info" style="text-align:left; "/>
					<col ref="dlco_nm" style="text-align:left; word-wrap:none; "/>
					<col ref="agn" style="text-align:left; word-wrap:none; "/>
					<col ref="advt_fee" format="#,###" style="text-align:right; "/>
					<col ref="vat" format="#,###" style="text-align:left; "/>
					<col ref="tot_rcpm_amt" format="yyyy-mm-dd" style="text-align:left; "/>
					<col ref="misu_tot_amt" format="#,###" style="text-align:right; "/>
					<col ref="fee" format="#,###" style="text-align:right; "/>
					<col ref="tax_email"/>
					<col ref="tax_clsf"/>
					<col ref="notaxrate_data_get_dt" format="yyyy-mm-dd"/>
					<col ref="exrate" format="#,###.####" style="text-align:right; "/>
					<col ref="mony_kind"/>
					<col ref="frex_cntr_amt" format="#,###" style="text-align:right; "/>
					<col ref="hidden_pubc_slip_no" visibility="hidden"/>
					<script type="javascript" ev:event="ondblclick">
						<![CDATA[	
						
						if(!isDataRegion(datagrid2)) return;
											
						var row = datagrid2.row;
						
						if(row >= datagrid2.fixedRows){							
							var pubc_slip_no = datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("pubc_slip_no"))
							windowLoadPublPubc2(pubc_slip_no);
						}
						
						]]>
					</script>
				</datagrid>
				<caption id="caption46" class="list_cap02" style="left:70px; top:550px; width:850px; height:26px; "/>
				<caption id="caption33" class="list_cap02" style="left:70px; top:580px; width:850px; height:26px; "/>
				<input id="input3" ref="/root/resData/resForm2/tot_pubc" editable="false" format="#,###" style="left:790px; top:554px; width:88px; height:18px; text-align:right; "/>
				<input id="input4" ref="/root/resData/resForm2/tot_vat_amt" editable="false" format="#,###" style="left:581px; top:554px; width:88px; height:18px; text-align:right; "/>
				<input id="input5" ref="/root/resData/resForm2/tot_adv_amt" editable="false" format="#,###" style="left:135px; top:554px; width:88px; height:18px; text-align:right; "/>
				<caption id="caption15" class="list_cap03" style="left:70px; top:550px; width:60px; height:26px; ">광고료</caption>
				<caption id="caption16" class="list_cap03" style="left:721px; top:550px; width:60px; height:26px; ">게재량</caption>
				<caption id="caption23" class="list_cap03" style="left:291px; top:550px; width:60px; height:26px; ">대행료</caption>
				<caption id="caption24" class="list_cap03" style="left:514px; top:550px; width:60px; height:26px; ">부가세</caption>
				<input id="input16" ref="/root/resData/resForm2/tot_fee_amt" editable="false" format="#,###" style="left:359px; top:554px; width:88px; height:18px; text-align:right; "/>
				<caption id="caption44" class="list_cap02" style="left:5px; top:5px; width:915px; height:28px; "/>
				<caption id="caption2" class="list_cap02" style="left:5px; top:32px; width:915px; height:28px; "/>
				<caption id="caption26" class="list_cap02" style="left:5px; top:59px; width:915px; height:28px; "/>
				<select id="checkbox3" ref="/root/reqData/searchData2/notaxrate_data_yn" navindex="21" overflow="visible" appearance="full" style="left:846px; top:12px; width:56px; height:15px; border-style:none; ">
					<choices>
						<item>
							<label>영세율</label>
							<value>checkbox1</value>
						</item>
					</choices>
				</select>
				<input id="input18" ref="/root/reqData/searchData2/frdt" class="req" navindex="17" inputtype="date" format="yyyy-mm-dd" style="left:374px; top:10px; width:85px; height:18px; "/>
				<input id="input19" ref="/root/reqData/searchData2/todt" class="req" navindex="18" inputtype="date" format="yyyy-mm-dd" style="left:479px; top:10px; width:85px; height:18px; "/>
				<caption id="caption27" class="list_cap01" style="left:209px; top:5px; width:78px; height:28px; ">게재기간</caption>
				<select1 id="combo9" ref="/root/reqData/searchData2/nwsp_type_clsf" navindex="15" appearance="minimal" style="left:290px; top:37px; width:115px; height:18px; ">
					<choices>
						<itemset nodeset="/root/codeData/nwsp_type_clsf/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<caption id="caption28" class="list_cap01" style="left:209px; top:32px; width:78px; height:28px; ">지종구분</caption>
				<select1 id="radio3" ref="/root/reqData/searchData2/dtoption" navindex="20" appearance="full" cols="3" overflow="visible" style="left:588px; top:12px; width:255px; height:15px; border-style:none; ">
					<choices>
						<item>
							<label>당일</label>
							<value>01</value>
						</item>
						<item>
							<label>당월(1일~현재)</label>
							<value>02</value>
						</item>
						<item>
							<label>전월(1일~말일)</label>
							<value>03</value>
						</item>
					</choices>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						
						var currentdt = getCurrentDate();
						var currentmt = getCurrentMonth();				
									
						var dtoption = model.getValue("/root/reqData/searchData2/dtoption"); //선택한 라디오 값..
										
						if(dtoption == "01"){  
							var frdt = dateAdd("d", 0, currentdt);	//당일
							var todt = dateAdd("d",0, currentdt);	//당일
							
							model.setValue("/root/reqData/searchData2/frdt", frdt); 
							model.setValue("/root/reqData/searchData2/todt", todt); 
						}else if(dtoption == "02"){
							var frdt = currentdt.substring(0,6)+"01"; //당월의 1일부터
							var todt = dateAdd("d",0, currentdt);	//당월의 현재일 
							
							model.setValue("/root/reqData/searchData2/frdt", frdt); 
							model.setValue("/root/reqData/searchData2/todt", todt); 
						}else if(dtoption == "03") {
							var frdt =  currentmt - 1+"01";  //전월의 1일부터
							var yymm = currentmt - 1+"";  //전월의 년월
							var todt = yymm+commLastDay(yymm); 	//전월의 말일 
							
							model.setValue("/root/reqData/searchData2/frdt", frdt); 
							model.setValue("/root/reqData/searchData2/todt", todt);
						}	
						model.refresh();
						
						]]>
					</script>
				</select1>
				<caption id="caption29" style="left:463px; top:13px; width:15px; height:17px; ">~</caption>
				<caption id="caption20" class="list_cap01" style="left:593px; top:32px; width:80px; height:28px; ">업종</caption>
				<select1 id="cd_medi_cd2" ref="/root/reqData/searchData2/medi_cd" navindex="25" appearance="minimal" style="left:87px; top:10px; width:115px; height:18px; ">
					<choices>
						<itemset nodeset="/root/codeData/medi_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<select1 id="combo6" ref="/root/reqData/searchData2/chro_clsf" navindex="24" appearance="minimal" style="left:87px; top:37px; width:115px; height:18px; ">
					<choices>
						<itemset nodeset="/root/codeData/chro_clsf/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<caption id="caption17" class="list_cap01" style="left:5px; top:5px; width:78px; height:28px; ">매체구분</caption>
				<caption id="caption19" class="list_cap01" style="left:5px; top:32px; width:78px; height:28px; ">색도</caption>
				<button id="button2" class="btn03" crud="R" style="left:688px; top:63px; width:65px; height:21px; ">
					<caption>상세검색</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						       visible_grp_detail_search = !visible_grp_detail_search;	
							grp_detail_search.visible = visible_grp_detail_search;									
						]]>
					</script>
				</button>
				<caption id="caption21" class="list_cap01" style="left:413px; top:59px; width:80px; height:28px; ">그룹사</caption>
				<caption id="caption22" class="list_cap01" style="left:5px; top:59px; width:78px; height:28px; ">광고내용</caption>
				<input id="input14" ref="/root/reqData/searchData2/advt_cont" navindex="28" imemode="hangul" style="left:87px; top:64px; width:290px; height:18px; "/>
				<select1 id="combo7" ref="/root/reqData/searchData2/grp_cmpy_cd" navindex="29" appearance="minimal" style="left:498px; top:64px; width:180px; height:18px; ">
					<choices>
						<itemset nodeset="/root/codeData/grp_cmpy_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<select1 id="combo10" ref="/root/reqData/searchData2/std_clsf" navindex="27" appearance="minimal" style="left:498px; top:37px; width:85px; height:18px; ">
					<choices>
						<itemset nodeset="/root/codeData/std_clsf/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
				<caption id="caption14" class="list_cap01" style="left:413px; top:32px; width:80px; height:28px; ">규격</caption>
				<select1 id="cb_indt_clsf_2" ref="/root/reqData/searchData2/indt_clsf" navindex="26" appearance="minimal" style="left:678px; top:37px; width:95px; height:18px; ">
					<choices>
						<itemset nodeset="/root/codeData/indt_clsf_2/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
					<script type="javascript" ev:event="xforms-select">
						<![CDATA[


				var indt_clsf_2 = cb_indt_clsf_2.value; 
				if(indt_clsf_2 != ""){
					var nodeList = instance1.selectNodes("/root/tempData/indt_clsf2/item[pcode='" + indt_clsf_2 + "']");
					
					model.removenode("/root/codeData/indt_clsf2_2");
					model.makeNode("/root/codeData/indt_clsf2_2");
					var trgNode = instance1.selectSingleNode("/root/codeData/indt_clsf2_2");
					for (var i = 0; i < nodeList.length; i++) {
						var node = nodeList.item(i);	
						trgNode.appendChild(node);
					}
				}else{
					model.removenode("/root/codeData/indt_clsf2_2");
					model.setValue("/root/reqData/searchData/indt_clsf2_2", "");
				}
				
				cb_indt_clsf2_2.refresh();	
										
						]]>
					</script>
				</select1>
				<select1 id="combo14" ref="/root/reqData/searchData2/select_dt" navindex="16" appearance="minimal" style="left:290px; top:10px; width:75px; height:18px; ">
					<choices>
						<item>
							<label>게재일자</label>
							<value>01</value>
						</item>
						<item>
							<label>처리일자</label>
							<value>02</value>
						</item>
						<item>
							<label>발생일자</label>
							<value>03</value>
						</item>
					</choices>
				</select1>
				<caption id="caption75" class="tit02" style="left:4px; top:552px; width:65px; height:20px; font-size:11pxpt; ">조회기간</caption>
				<caption id="caption9" class="tit02" style="left:4px; top:582px; width:65px; height:20px; font-size:11pxpt; ">전년동기</caption>
				<caption id="caption31" class="list_cap03" style="left:291px; top:580px; width:60px; height:26px; ">대행료</caption>
				<caption id="caption32" class="list_cap03" style="left:514px; top:580px; width:60px; height:26px; ">부가세</caption>
				<input id="input10" ref="/root/resData/resForm2/tot_fee_amt2" editable="false" format="#,###" style="left:359px; top:584px; width:88px; height:18px; text-align:right; "/>
				<caption id="caption40" class="list_cap03" style="left:70px; top:580px; width:60px; height:26px; ">광고료</caption>
				<caption id="caption41" class="list_cap03" style="left:721px; top:580px; width:60px; height:26px; ">게재량</caption>
				<input id="input12" ref="/root/resData/resForm2/tot_pubc2" editable="false" format="#,###" style="left:790px; top:584px; width:88px; height:18px; text-align:right; "/>
				<input id="input13" ref="/root/resData/resForm2/tot_vat_amt2" editable="false" format="#,###" style="left:581px; top:584px; width:88px; height:18px; text-align:right; "/>
				<input id="input15" ref="/root/resData/resForm2/tot_adv_amt2" editable="false" format="#,###" style="left:135px; top:584px; width:88px; height:18px; text-align:right; "/>
				<group id="grp_detail_search" visibility="hidden" style="left:565px; top:86px; width:355px; height:192px; background-color:#ffffff; border-color:#99ccff; border-style:solid; ">
					<caption id="caption62" class="list_cap02" style="left:0px; top:162px; width:353px; height:28px; "/>
					<caption id="caption55" class="list_cap02" style="left:0px; top:0px; width:353px; height:28px; "/>
					<caption id="caption45" class="list_cap02" style="left:0px; top:27px; width:353px; height:28px; "/>
					<caption id="caption47" class="list_cap02" style="left:0px; top:81px; width:353px; height:28px; "/>
					<caption id="caption48" class="list_cap02" style="left:0px; top:135px; width:353px; height:28px; "/>
					<caption id="caption49" class="list_cap02" style="left:0px; top:54px; width:353px; height:28px; "/>
					<caption id="caption50" class="list_cap02" style="left:0px; top:108px; width:353px; height:28px; "/>
					<caption id="caption51" class="list_cap01" style="left:0px; top:0px; width:131px; height:28px; ">세금계산서발행여부</caption>
					<caption id="caption53" class="list_cap01" style="left:0px; top:27px; width:131px; height:28px; ">광고주</caption>
					<caption id="caption57" class="list_cap01" style="left:0px; top:54px; width:131px; height:28px; ">광고료</caption>
					<caption id="caption58" class="list_cap01" style="left:0px; top:81px; width:131px; height:28px; ">부가세</caption>
					<caption id="caption59" class="list_cap01" style="left:0px; top:108px; width:131px; height:28px; ">입금총액</caption>
					<caption id="caption60" class="list_cap01" style="left:0px; top:135px; width:131px; height:28px; ">미수총액</caption>
					<caption id="caption61" class="list_cap01" style="left:0px; top:162px; width:131px; height:28px; ">전자세금계산서</caption>
					<input id="input20" ref="/root/reqData/searchData2/dlco_nm" navindex="32" style="left:137px; top:32px; width:205px; height:18px; ">
						<hint>
							<![CDATA[광고주명1,광고주명2,광고주명3, ]]>
						</hint>
					</input>
					<caption id="caption63" style="left:232px; top:59px; width:15px; height:20px; text-align:center; ">~</caption>
					<input id="input23" ref="/root/reqData/searchData2/fradvt_fee" navindex="34" format="#,###" style="left:137px; top:59px; width:85px; height:18px; text-align:right; "/>
					<input id="input24" ref="/root/reqData/searchData2/toadvt_fee" navindex="35" format="#,###" style="left:257px; top:59px; width:85px; height:18px; text-align:right; "/>
					<caption id="caption64" style="left:232px; top:87px; width:15px; height:20px; text-align:center; ">~</caption>
					<input id="input25" ref="/root/reqData/searchData2/frvat" navindex="36" format="#,###" style="left:137px; top:87px; width:85px; height:18px; text-align:right; "/>
					<input id="input26" ref="/root/reqData/searchData2/tovat" navindex="37" format="#,###" style="left:257px; top:87px; width:85px; height:18px; text-align:right; "/>
					<caption id="caption65" style="left:232px; top:113px; width:15px; height:20px; text-align:center; ">~</caption>
					<caption id="caption66" style="left:232px; top:140px; width:15px; height:20px; text-align:center; ">~</caption>
					<input id="input27" ref="/root/reqData/searchData2/frtot_rcpm_amt" navindex="38" format="#,###" style="left:137px; top:113px; width:85px; height:18px; text-align:right; "/>
					<input id="input28" ref="/root/reqData/searchData2/totot_rcpm_amt" navindex="39" format="#,###" style="left:257px; top:113px; width:85px; height:18px; text-align:right; "/>
					<input id="input29" ref="/root/reqData/searchData2/frtot_misu_amt" navindex="40" format="#,###" style="left:137px; top:140px; width:85px; height:18px; text-align:right; "/>
					<input id="input30" ref="/root/reqData/searchData2/totot_misu_amt" navindex="41" format="#,###" style="left:257px; top:140px; width:85px; height:18px; text-align:right; "/>
					<select id="checkbox7" ref="/root/reqData/searchData2/sale_stmt_issu_yn" navindex="30" overflow="visible" appearance="full" style="left:137px; top:7px; width:15px; height:15px; border-style:none; ">
						<choices>
							<item>
								<label/>
								<value>Y</value>
							</item>
						</choices>
					</select>
					<select id="checkbox8" ref="/root/reqData/searchData2/elec_tax_stmt_yn" navindex="42" overflow="visible" appearance="full" style="left:137px; top:170px; width:15px; height:15px; border-style:none; ">
						<choices>
							<item>
								<label/>
								<value>Y</value>
							</item>
						</choices>
					</select>
				</group>
				<select1 id="cb_indt_clsf2_2" ref="/root/reqData/searchData2/indt_clsf2" navindex="5" appearance="minimal" style="left:778px; top:37px; width:115px; height:18px; ">
					<choices>
						<itemset nodeset="/root/codeData/indt_clsf2_2/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</select1>
			</case>
		</switch>
		<caption id="caption6" tyle="left:15px; top:180px; width:940px; height:0px;" style="left:0px; top:10px; width:0px; height:0px; ">caption6</caption>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<button id="button6" class="btn04" crud="R" style="left:727px; top:40px; width:88px; height:21px; ">
			<caption>게재전표상세</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
					var iSel = switch1.selectedIndex;
				
					if(iSel == 0){
						var row = datagrid1.row;					
						var pubc_slip_no 	=  datagrid1.valueMatrix(datagrid1.row, datagrid1.colRef("hidden_pubc_slip_no"));
						windowLoadPublPubc2(pubc_slip_no);
					}else if(iSel == 1){ 
						var row = datagrid2.row;
						var pubc_slip_no 	=  datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("hidden_pubc_slip_no"));
						windowLoadPublPubc2(pubc_slip_no);
					}					
				
				]]>
			</script>
		</button>
		<button id="button7" class="btn02" crud="R" style="left:572px; top:40px; width:52px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				model.reset();
				
				var iSel = switch1.selectedIndex;
				
				if(iSel == 0){
					//model.resetInstanceNode("/root/reqData/searchData");					
				}else if(iSel == 1){ 
				      //model.resetInstanceNode("/root/reqData/searchData2");
				}
				
				]]>
			</script>
		</button>
		<button id="button9" class="btn02" crud="R" style="left:512px; top:40px; width:52px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				var iSel = switch1.selectedIndex;
				
				if(iSel == 0){
					model1.send("ad_pub_2310_l");	
				}else if(iSel == 1){ 
				       model1.send("ad_pub_2311_l");   
				       grp_detail_search.visible = "false";
				       visible_grp_detail_search = !visible_grp_detail_search;	
				}		
				
				]]>
			</script>
		</button>
		<button id="button1" class="tab06" group="tab" crud="R" style="left:115px; top:70px; width:105px; height:23px; ">
			<caption>상세조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case2");
				]]>
			</script>
		</button>
		<button id="button10" class="tab06" group="tab" selected="true" crud="R" style="left:10px; top:70px; width:105px; height:23px; ">
			<caption>기본조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case1");
				]]>
			</script>
		</button>
		<button id="btnClose" class="btn02" style="left:885px; top:40px; width:50px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
				
				]]>
			</script>
		</button>
		<button id="button3" class="btn02" style="left:825px; top:40px; width:52px; height:21px; ">
			<caption>엑셀</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				var iSel = switch1.selectedIndex;
				
				var sheet = "";
				
				if(iSel == 0){
					sheet = "기본정보";
				}else{
					sheet = "상세정보";
				}
				
				var filename = window.fileDialog("save", ",", false, "(출판광고)거래내역_"+sheet, "xls", "Excel File(*.xls)|*.xls");
				if(filename!=""){
					if(iSel == 0){
						datagrid1.saveExcel(filename, "sheetname:(출판광고)거래내역 기본정보;");
					}else{
						datagrid2.saveExcel(filename, "sheetname: (출판광고)거래내역 상세정보;");
					}
				}				
				
				]]>
			</script>
		</button>
		<button id="btn_rpt1" class="btn04" crud="P" style="left:631px; top:40px; width:88px; height:21px; ">
			<caption>광고 게재표</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var type_no = "1";
				model.setValue("/root/reqData/searchData/type_no",type_no);
				//var chk = model.getValue("/root/reqData/searchData/type_no");
				//alert(chk);
				goReport("P");
				]]>
			</script>
		</button>
		<button id="btn_upload" class="btn04" crud="C" style="left:420px; top:40px; width:80px; height:21px; ">
			<caption>전표업로드</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var i;
					var headName;
					var filename = window.fileDialog("open", ",", false, "", "xls*", "Excel File(*.xls*)|*.xls*");
					if( filename!="" )
					{
						model.removeNodeset("/root/resData/gd_upload");
						
						dg_upload.loadExcel(filename, 1, true); 
						
						// 헤더체크
						//alert(dg_upload.cols);
						for( i=1; i<=dg_upload.cols-1; i++ )
						{
							if( i > UPLOAD_HEADER_MAX )
							{
								alert("반입하시려는 항목이 초과하였습니다.");
								return;
							}
						}
						
						
						for( i=dg_upload.fixedRows+1;i<dg_upload.rows; i++ )
						{
							dg_upload.addStatus(i, "insert");
						}
//						model.setValue("/root/reqData/flag","E");
						if( !isDataGridUpdated(dg_upload) )
						{
							alert("저장할 내역이 없습니다.");
							return;
						}
						
						if( commGridReqCheck(dg_upload) )
						{
							if( window.alert("저장하시겠습니까?", "확인", 1) == 1 )
							{
								model.setValue("/root/reqData/multiUpdateData", dg_upload.getUpdateData());
								model.setValue("/root/reqData/pubc_dt",model.getValue("/root/reqData/searchData/todt"));
								model.send("ad_pub_2313_a");
								if( submit_completed() ){
									var iSel = switch1.selectedIndex;
									
									if(iSel == 0){
										model1.send("ad_pub_2310_l");	
									}else if(iSel == 1){ 
										   model1.send("ad_pub_2311_l");   
										   grp_detail_search.visible = "false";
										   visible_grp_detail_search = !visible_grp_detail_search;	
									}									
								}
							}
						}	
					}	
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
