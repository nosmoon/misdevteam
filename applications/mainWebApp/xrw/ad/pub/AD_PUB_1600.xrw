<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<pageInfo/>
						<hndl_nm/>
						<comboSet>
							<hndl_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</hndl_clsf>
							<nwsp_type_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</nwsp_type_clsf>
							<chro_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</chro_clsf>
							<book_appndx_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</book_appndx_clsf>
							<mony_kind>
								<item>
									<label/>
									<value/>
								</item>
							</mony_kind>
							<upd_resn>
								<item>
									<label/>
									<value/>
								</item>
							</upd_resn>
							<medi_cd>
								<item>
									<label/>
									<value/>
								</item>
							</medi_cd>
							<publ_std>
								<item>
									<label/>
									<value/>
								</item>
							</publ_std>
						</comboSet>
					</initData>
					<reqData>
						<fwdData/>
						<searchData>
							<pubc_occr_dt/>
							<pubc_occr_seq/>
							<search_dt/>
							<medi_cd/>
							<preng_occr_dt/>
							<preng_occr_seq/>
							<proc_dt/>
							<proc_seq/>
						</searchData>
						<reqForm>
						</reqForm>
						<multiUpdateData/>
					</reqData>
					<resData>
						<resForm>
							<medi_cd/>
							<proc_dt/>
							<proc_seq/>
							<pubc_occr_seq/>
							<pubc_occr_dt/>
							<hndl_clsf/>
							<dlco_no/>
							<dlco_nm/>
							<advt_cont/>
							<issu_ser_no/>
							<publ_std/>
							<advt_fee/>
							<vat/>
							<pubc_tot_amt/>
							<agn/>
							<agn_nm/>
							<fee_rate/>
							<fee/>
							<hndl_plac_cd/>
							<hndl_plac_nm/>
							<coms_rate/>
							<coms/>
							<indt_clsf/>
							<indt_clsf_nm/>
							<mony_kind/>
							<type_clsf/>
							<type_clsf_nm/>
							<exrate/>
							<chro_clsf/>
							<frex_cntr_amt/>
							<nwsp_type_clsf/>
							<book_appndx_clsf/>
							<real_rate/>
							<tot_rate/>
							<net_rate/>
							<sel_rate>R</sel_rate>
							<slcrg_pers/>
							<slcrg_pers_nm/>
							<dept_cd/>
							<dept_nm/>
							<mchrg_pers/>
							<mchrg_pers_nm/>
							<rtax_yn/>
							<govern_advt_yn/>
							<advcs_offr_yn/>
							<upd_resn/>
							<upd_cont/>
							<remk/>
							<pubc_dt/>
							<pre_pubc_slip_no/>
							<pre_pubc_slip_no_crte_dt/>
							<upd_yn/>
							<div_yn/>
							<clos_stat/>
							<clamt_stat/>
							<sale_stmt_issu_yn/>
							<purc_stmt_issu_yn/>
							<elec_tax_stmt_yn/>
							<pubc_side/>
							<preng_occr_dt/>
							<preng_occr_seq/>
							<tax_email/>
							<tax_clsf/>
							<patr_chrg_info/>
							<advt_clsf/>
						</resForm>
						<gridData1>
							<record>
								<pubc_side/>
								<dlco_nm/>
								<publ_std/>
								<slcrg_pers_nm/>
								<preng_occr_dt/>
								<preng_occr_seq/>
							</record>
						</gridData1>
						<gridData2>
							<record>
								<pubc_side/>
								<dlco_nm/>
								<publ_std/>
								<slcrg_pers_nm/>
								<pubc_occr_dt/>
								<pubc_occr_seq/>
							</record>
						</gridData2>
					</resData>
					<tempData>
						<keyData/>
					</tempData>
					<msgData/>
				</root>
			</instance>
			<submission id="ad_pub_1600_m" action="/ad/pub/1600" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				var cmpy_cd = model.property("ss_cmpycd");
				if(cmpy_cd == "326"){
						cp_tax_clsf_1.visible = true;
						cp_tax_clsf_2.visible = true;
						cp_tax_clsf_4.visible = true;
						rdo_tax_clsf.visible  = true;
				}				
				model.send("ad_pub_1600_m");
				
				model.copyNode("/root/initData/comboSet/hndl_clsf", "/root/tempData/hndl_clsf");
				model.copyNode("/root/initData/comboSet/nwsp_type_clsf", "/root/tempData/nwsp_type_clsf");
				model.copyNode("/root/initData/comboSet/chro_clsf", "/root/tempData/chro_clsf");
				model.copyNode("/root/initData/comboSet/book_appndx_clsf", "/root/tempData/book_appndx_clsf");
				model.copyNode("/root/initData/comboSet/mony_kind", "/root/tempData/mony_kind");
				model.copyNode("/root/initData/comboSet/upd_resn", "/root/tempData/upd_resn");	
				model.copyNode("/root/initData/comboSet/medi_cd", "/root/tempData/medi_cd");	
				model.copyNode("/root/initData/comboSet/publ_std", "/root/tempData/publ_std");	
				
				makeComboGubun("", "/root/initData/comboSet/upd_resn", "item", "label", "value");
				
				model.refresh();
				
				initPage();					
				
				switch1.selectedIndex=0;
				
				//inp_slcrg_pers.value 	= 	"000315";
				//inp_slcrg_pers_nm.value	=	"생활미디어";
				//out_dept_cd.value		=	"000315";
				//out_dept_nm.value		=	"뉴스매거진";
				//inp_mchrg_pers.value	=	"000315";
				//inp_mchrg_pers_nm.value	=	"생활미디어";
				
				inp_slcrg_pers.refresh();
				inp_slcrg_pers_nm.refresh();
				out_dept_cd.refresh();
				out_dept_nm.refresh();
				inp_mchrg_pers.refresh();
				inp_mchrg_pers_nm.refresh();
																											
				]]>
			</script>
			<submission id="ad_pub_1620_l" action="/ad/pub/1620" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData1"/>
			<submission id="ad_pub_1625_s" action="/ad/pub/1625" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm"/>
			<submission id="ad_pub_1650_a" action="/ad/pub/1650" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/msgData"/>
			<submission id="ad_pub_1630_l" action="/ad/pub/1630" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData2"/>
			<submission id="ad_pub_1635_s" action="/ad/pub/1635" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm"/>
			<submission id="ad_pub_1610_s" action="/ad/pub/1610" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
			
			function initPage(){
				//뉴스프레스만 계산서 이메일 보여줌
//				var cmpy_cd = model.property("ss_cmpycd");
//				if(cmpy_cd == "326"){
//					cp_tax_email.visible = true;
//					ip_tax_email.visible = true;
//				}
				//키값 셋팅후 상세조회..
				if( model.property(KEY_MEDI_CD) != "" && model.property(KEY_PROC_DT) != "" && model.property(KEY_PROC_SEQ) != ""){
					
					model.setValue("/root/reqData/searchData/medi_cd", model.property(KEY_MEDI_CD));
					model.setValue("/root/reqData/searchData/proc_dt", model.property(KEY_PROC_DT));
					model.setValue("/root/reqData/searchData/proc_seq", model.property(KEY_PROC_SEQ));

					model.send("ad_pub_1610_s");
					
					if(submit_completed()){
						
//						changeOnMediCd();
						model.setValue("/root/reqData/searchData/search_dt", model.getValue("/root/resData/resForm/proc_dt"));
						inp_search_dt.refresh();
					//팝업으로 조회 된 게재데이타 키값 삭제
						model.property(KEY_MEDI_CD) = "";
						model.property(KEY_PROC_DT) = "";
						model.property(KEY_PROC_SEQ) = "";						
					}
					
				}else{
/*																									
					btn_upd.disabled = true;															
					btn_del.disabled = true;
*/													
					cb_medi_cd.select(0);  
					cb_medi_cd.refresh();	
					
					cb_mony_kind.value= "KRW";
					cb_hndl_clsf.select(0);
					
					cb_chro_clsf.select(0);
					cb_nwsp_type_clsf.select(0);
					cb_book_appndx_clsf.select(0);
					
					var cur_date = dateAdd("d", -1, getCurrentDate());
					
					model.setValue("/root/reqData/searchData/search_dt", cur_date);
					inp_search_dt.refresh();
					model.setValue("/root/resData/resForm/pubc_dt", cur_date);
					inp_pubc_dt.refresh();				
					model.setValue("/root/resData/resForm/proc_dt", cur_date);
					inp_proc_dt.refresh();
													
					loadPreng();
				}				
				
			}
			
			function loadPreng(){	
				btn_preng.selected = true;		
				model.toggle("case1");	
				model.setValue("/root/reqData/searchData/medi_cd", model.getValue("/root/resData/resForm/medi_cd"));
				model.send("ad_pub_1620_l");
			}
			function loadPubc(){	
				btn_pubc.selected = true;
				model.toggle("case2");
				model.setValue("/root/reqData/searchData/medi_cd", model.getValue("/root/resData/resForm/medi_cd"));
				model.send("ad_pub_1630_l");
			}
			
			var _sect_nm = ""; //전역변수 지면섹션
			
			function setDlcoInfo(dlco_no, dlco_nm){
				
				var gnr_advcs_yn = model.getValue("/root/reqData/fwdData/gnr_advcs_yn");
				var agn_yn       = model.getValue("/root/reqData/fwdData/agn_yn");
				var advt_bo_yn   = model.getValue("/root/reqData/fwdData/advt_bo_yn");
				var bo_bof_yn    = model.getValue("/root/reqData/fwdData/bo_bof_yn");
				
				if(gnr_advcs_yn == "Y"){									
					model.setValue("/root/resData/resForm/dlco_no", dlco_no);
					model.setValue("/root/resData/resForm/dlco_nm", dlco_nm);					
					inp_dlco_no.refresh();
					inp_dlco_nm.refresh();					
				}else if(agn_yn == "Y"){									
					model.setValue("/root/resData/resForm/agn", dlco_no);
					model.setValue("/root/resData/resForm/agn_nm", dlco_nm);					
					inp_agn.refresh();
					inp_agn_nm.refresh();				
				}else if(advt_bo_yn == "Y" || bo_bof_yn == "Y"){									
					model.setValue("/root/resData/resForm/hndl_plac_cd", dlco_no);
					model.setValue("/root/resData/resForm/hndl_plac_nm", dlco_nm);					
					inp_hndl_plac_cd.refresh();
					inp_hndl_plac_nm.refresh();				
				}					
			}
			function selectPubcPreng(preng_occr_dt, preng_occr_seq){
				model.setValue("/root/reqData/searchData/preng_occr_dt", preng_occr_dt);
				model.setValue("/root/reqData/searchData/preng_occr_seq", preng_occr_seq);
				
				model.send("ad_res_1210_s");
				model.refresh();
			}
			
			function selectPubc(pubc_occr_dt, pubc_occr_seq){
				model.setValue("/root/reqData/searchData/pubc_occr_dt", pubc_occr_dt);
				model.setValue("/root/reqData/searchData/pubc_occr_seq", pubc_occr_seq);
				
				model.send("ad_res_1260_s");
				model.refresh();
			}

			function setIndt(indt_clsf, indt_clsf_nm){
				model.setValue("/root/resData/resForm/indt_clsf", indt_clsf);
				model.setValue("/root/resData/resForm/indt_clsf_nm", indt_clsf_nm);
				
				inp_indt_clsf.refresh();	
				inp_indt_clsf_nm.refresh();			
				
			}		
			
			function setType(type_clsf, type_clsf_nm){
				model.setValue("/root/resData/resForm/type_clsf", type_clsf);
				model.setValue("/root/resData/resForm/type_clsf_nm", type_clsf_nm);
				
				inp_type_clsf.refresh();	
				inp_type_clsf_nm.refresh();			
				
			}			
			
			function setIssuInfo(){

				var sect_nm =  model.getValue("/root/resData/resForm/sect_nm");
				var medi_cd =  model.getValue("/root/resData/resForm/medi_cd");
				var pubc_dt =  model.getValue("/root/resData/resForm/pubc_dt");

				if(sect_nm != "" && pubc_dt != ""){
					
					sect_nm = sect_nm.toUpperCase();
					
					if(sect_nm == _sect_nm) return;
					
					
					model.setValue("/root/resData/resForm/sect_nm", sect_nm);
					inp_sect_nm.refresh();
					
					model.makeNode("/root/reqData/searchData/sect_nm");
					model.setValue("/root/reqData/searchData/sect_nm", sect_nm);
					
					model.setValue("/root/reqData/searchData/medi_cd", medi_cd);
					model.setValue("/root/reqData/searchData/preng_occr_dt", pubc_dt);
					
					
					modelSendNoMake("ad_co_9003_s", "/ad/common/9003", "/root/reqData/searchData", "/root/tempData");	
//					model.send("ad_co_9003_s");
					
					model.setValue("/root/resData/resForm/cm", model.getValue("/root/tempData/cm"));
					model.setValue("/root/resData/resForm/dn", model.getValue("/root/tempData/dn"));
//						model.setValue("/root/resData/resForm/chro_clsf", model.getValue("/root/tempData/chro_clsf"));
//						model.setValue("/root/resData/resForm/chro_clsf_nm", model.getValue("/root/tempData/chro_clsf_nm"));
//						model.setValue("/root/resData/resForm/tabl_yn", model.getValue("/root/tempData/tabl_yn"));
					model.setValue("/root/resData/resForm/pubc_side", model.getValue("/root/tempData/issu_side"));
					
					if(model.getValue("/root/tempData/issu_side") == ""){
						alert("해당면이 없습니다.");
						model.setValue("/root/resData/resForm/sect_nm", "");
					}
					
					
					model.refresh();
					
					_sect_nm = sect_nm;
				}								
			}
			
			function checkAll(){
				
				var pubc_side = model.getValue("/root/resData/resForm/pubc_side");
				var cmpy_cd = model.property("ss_cmpycd");
				if(pubc_side == "" && cmpy_cd != "326"){
					alert("게재등록을 할 수 없는 면수입니다.[0]");
					return false;
				}
								
				var medi_cd  		= model.getValue("/root/resData/resForm/medi_cd");//매체
				var dlco_no  		= model.getValue("/root/resData/resForm/dlco_no");//광고주
				var hndl_clsf 		= model.getValue("/root/resData/resForm/hndl_clsf");//취급구분
				var agn 			= model.getValue("/root/resData/resForm/agn");//대행사
				var hndl_plac_cd 	= model.getValue("/root/resData/resForm/hndl_plac_cd");//취급처
				
				if(dlco_no ==	"00040020"){
					if(hndl_clsf != '9'){
						alert("광고주가 조선일보사이면 취급구분이 9 자사광고이어야 합니다. 취급구분을 확인하십시요.[1]");
						return false;
					}				
				}						
				if(hndl_clsf == "1" || hndl_clsf == "9"){//광고주 , 자사광고
					if(agn != "" || hndl_plac_cd != ""){
						alert("[1]대행사 또는 거래처가 잘못됐습니다.[2]");
						return false;
					}
				}else if(hndl_clsf == "2"){//대행사
					if(agn == "" || hndl_plac_cd != ""){
						alert("[2]대행사 또는 취급처가 잘못됐습니다.[3]");
						return false;
					}					
				}else if(hndl_clsf == "4" || hndl_clsf == "5" || hndl_clsf == "7"){	
					if(hndl_plac_cd == ""){
						alert("[3]취급처가 잘못됐습니다.[4]");
						return false;
					}					
				}
				
				//화폐종류가 원화가 아닐경우 환율과 외화게재액을 반드시 입력한다.
				var mony_kind = model.getValue("/root/resData/resForm/mony_kind");
				if(mony_kind != "KRW"){
					if(Number(model.getValue("/root/resData/resForm/frex_cntr_amt") )== 0){
						alert("외화게재금액을 입력하세요.[5]");
						return false;
					}
				}
				
				var fee_rate = Number(model.getValue("/root/resData/resForm/fee_rate"));
				var fee  	      = Number(model.getValue("/root/resData/resForm/fee"));					
									
				if(agn != ""){	
				/*	
					if(fee_rate == 0 || fee == 0){
						alert("대행료를 입력하세요.[6]");
						return false;
					}else{
						if(medi_cd == "19") {//행복플러스
							if(fee_rate < 0 && fee_rate > 26.4){
								alert("행복플러스의 대행료율 범위는  대행료율 <= 26.4.[7]");						
								return false;
							}
						}else{
							if(fee_rate < 0 || fee_rate > 15){
								alert("대행료율의 범위는  대행료율 <= 15.[8]");						
								return false;
							}							
						}
					}
				*/					
				}else{					
					if(fee_rate != 0 && fee != 0){
						alert("대행사가 없을 경우 대행료를 부과할 수 없습니다.[9]");
						return false;
					}
				}			
				if(hndl_plac_cd != ""){
					var coms_rate = Number(model.getValue("/root/resData/resForm/coms_rate"));
					var coms		 = Number(model.getValue("/root/resData/resForm/coms"));
/*
					if(coms_rate == 0 || coms == 0){
						alert("수수료를 입력하세요.[10]");
						return false;
					}
*/					
				}			

	//대행료는 (총게재액 * 요율 / 100) 값과 100 이상의 오차가 발생하면 안된다.
	//VAT=0이면 게재총액 =게재총액 * 1.1
        			var vat = Number(model.getValue("/root/resData/resForm/vat"));
        			var pubc_tot_amt = Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));
        			var AgentTotal = 0;//요율계산대행료
        			
				if((fee_rate == 7 && coms_rate == 8) ||  (fee_rate == 8 && coms_rate == 7)){
			        //대행료율:수수료율이 7:8 or 8:7일 땐 각각 7.5로 계산해서 오차판단
			        //7.5로 각각 계산				
			            if(vat == 0){
			                AgentTotal = pubc_tot_amt * 1.1 * 7.5 / 100;
			            }else{
			                AgentTotal = pubc_tot_amt * 7.5 / 100
			            }
				}else{
			             if(vat == 0){
			                AgentTotal = pubc_tot_amt * 1.1 * fee_rate / 100
			            }else{
			                AgentTotal = pubc_tot_amt * fee_rate / 100
			            }		
				}			

		            //오차=입력대행료 - 요율계산대행료
		            	var  ocha = Math.abs(fee - AgentTotal)        
		        
		            //대행료 오차가 게재총액 0.5%보다 크면 경고
		            	if(ocha > ( pubc_tot_amt/ 200)){
		               	alert("대행료의 오차가 게재총액의 0.5%를 초과했습니다.\n\r입력하시려면 경리부(5924)에 연락하십시오.[11]");
		               	return false;
		           	}			
		           	
		           	//수수료율에 대행료율 더해주기. 오차계산땐 대행료율 뺌
				var tmp_coms_rate = coms_rate + fee_rate
				//수수료율 : 소년:max30 게재구분=9 -> max25, 나머지 max15
			    	if(hndl_plac_cd !=""){
/*			    		
			    		if(medi_cd == "13"){  //소년
			    			if(tmp_coms_rate < 0 || tmp_coms_rate > 30){
			                      		alert("0 <= 수수료율 + 대행료율 <= 30).[12]");
			                      		return false;
			    			}
			    		}else if(medi_cd == "19"){ //행복플러스
			    			if(tmp_coms_rate < 0 || tmp_coms_rate > 26.4){
			    				alert("( 0 <= 수수료율 + 대행료율 <= 26.4).[13]");
			    				return false;
			    			}
			    		}else{
			    			var edi_clsf = model.getValue("/root/resData/resForm/edt_clsf");
			    			if(edi_clsf == "9"){//지방판
			    				if(tmp_coms_rate < 0 || tmp_coms_rate > 25){
			    					alert("( 0 <= 수수료율 + 대행료율 <= 25).[14]");
			    					return false;
			    				}
			    			}else{
			    				if(tmp_coms_rate < 0 || tmp_coms_rate > 15){
			    					alert("( 0 <= 수수료율 + 대행료율 <= 15).[15]");
			    					return false;
			    				}
			    			}
			    		}
*/			    		
			    	}     	
							
				//수수료율 오차 계산 (앞에서 더해진 대행료율 빼기)
				var tmp_coms_rate = coms_rate - fee_rate;
				var ssTotal		  = 0;//오차계산용총액기억용
				// (총게재액 * 요율 / 100) 값과 100 이상의 오차가 발생하면 안된다.
				//VAT=0이면 게재총액 =게재총액 * 1.1		
				var advt_fee = Number(model.getValue("/root/resData/resForm/advt_fee"));	        
			        if((fee_rate == 7 && coms_rate == 8) || (fee_rate == 8 && coms_rate == 7)){
			        //대행료율:수수료율이 7:8 or 8:7일 땐 각각 7.5로 계산해서 오차판단
			        //7.5로 각각 계산
			        	if(vat == 0){
				       		ssTotal = advt_fee * 1.1 * 7.5 / 100;
				     	}else{
				     		ssTotal = pubc_tot_amt * 7.5 / 100;
				       }
			        }else{
					if(vat == 0){
						ssTotal = advt_fee * 1.1 * tmp_coms_rate / 100;
					}else{
						ssTotal = pubc_tot_amt * tmp_coms_rate / 100;
					}
			        }

			        //ssTotal은 요율로 게산한 수수료
			        var ocha = Math.round(coms_rate) - ssTotal;
			        //수수료오차가 게재총액의 0.5%보다 크면			        
			        if(Math.abs(ocha) > (pubc_tot_amt / 200)){
			           	alert("수수료의 오차가 게재총액의 0.5%를 초과했습니다.\n\r입력하시려면 경리부(5924)에 연락하십시오.[16]");
			           	return false;
			        }	        		        
			        
				//부가세와, 광고료(<>게재총액)의 10%의 차이가 100원 안넘게하기.
				        //부가세 0체크
				        //면세광고가 아니면				        
			        var rtax_yn = model.getValue("/root/resData/resForm/rtax_yn");
			        
			        if(rtax_yn == "N"){			        	
			        	ocha = (advt_fee * 0.1) - vat;			        	
			        	if(ocha < -100 || ocha > 100){
			        		alert("(부가세와 광고료/10 의 오차가 100초과).[17]");
			        		return false;
			        	}
			        }
			        
			        if(mony_kind != "KRW"){
			        	var frex_cntr_amt = Number(model.getValue("/root/resData/resForm/frex_cntr_amt"));
			        	var exrate = Number(model.getValue("/root/resData/resForm/exrate"));
			        	var tmp_amt = Math.abs(avdt_fee - (frex_cntr_amt * exrate));
			        	if(tmp_amt > 1000){
			        		alert("외화게재액과 광고료의 차이가 1,000원 이상입니다.[18]");
			        		return false;
			        	}
			        }
			        
			        if(rtax_yn == "Y"){
			        	if(vat > 0){
			        		alert("부가세가 정확히 입력되지 않았습니다. 면세여부를 확인하여 주십시오.[19]");
			        		return false;
			        	}
			        }
			        
				return true;
			}
			
			
			function goReport(gubun){
					
				// 오즈관련 노드 초기화..					
				resetOznode();					
									
				// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
				makeNodeValue("/root/oz_data/ozrName", "ad/SP_AD_PUB_1610_P");									
							
				var root			= "/root/resData/resForm";
				
				var medi_cd    	= model.getValue(	root + "/medi_cd");
				var proc_dt      	= model.getValue(	root + "/proc_dt");
				var proc_seq    	= model.getValue(	root + "/proc_seq");
				
				if ( proc_dt == "" ){
					commAlert("게재일자가 없습니다.");
					return;
				}			
				if ( proc_seq == "" ){
					commAlert("게재순번이 없습니다.");
					return;
				}						
		
				makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd",model.property("ss_cmpycd"));			
				makeNodeValue("/root/oz_data/odiParam/iv_medi_cd"		, medi_cd);					
				makeNodeValue("/root/oz_data/odiParam/iv_proc_dt"		, proc_dt);	
				makeNodeValue("/root/oz_data/odiParam/iv_proc_seq"		, proc_seq);	
			
				// 레포트뷰어 호출.					
				openOzwin("/root/oz_data");	
			}
			

			function recalculate(advt_fee_yn, vat_yn, pubc_tot_amt_yn){
				
				var pubc_tot_amt	=	Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));				
				var advt_fee 	=	Number(model.getValue("/root/resData/resForm/advt_fee"));					
				var vat 			=	Number(model.getValue("/root/resData/resForm/vat"));				

				if(advt_fee_yn	==	"Y"){
					vat	=	advt_fee / 10;
					pubc_tot_amt	=	advt_fee + vat;
				}else if(vat_yn == "Y"){
					advt_fee		=	Math.round(vat * 10);
					pubc_tot_amt	=	advt_fee + vat;					
				}else if(pubc_tot_amt_yn == "Y"){
					advt_fee		=	Math.round((pubc_tot_amt * 10) / 11);
					vat			=	Math.round((pubc_tot_amt * 1) / 11);					
				}
				
				var fee_rate	=	Number(model.getValue("/root/resData/resForm/fee_rate"));
				if(fee_rate > 0){
					var fee = Math.round(pubc_tot_amt * (fee_rate/100));
					model.setValue("/root/resData/resForm/fee", fee);
					inp_fee.refresh();
				}
				var coms_rate	=	Number(model.getValue("/root/resData/resForm/coms_rate"));
				if(coms_rate > 0){
					var coms = Math.round(pubc_tot_amt * (coms_rate/100));
					model.setValue("/root/resData/resForm/coms", coms);
					inp_coms.refresh();
				}
								
				model.setValue("/root/resData/resForm/advt_fee", advt_fee);
				model.setValue("/root/resData/resForm/vat", vat);
				model.setValue("/root/resData/resForm/pubc_tot_amt", pubc_tot_amt);	
								
				inp_advt_fee.refresh();
				inp_vat.refresh();
				inp_pubc_tot_amt.refresh();
				
			}					
			
			function loadData(){
				
				var medi_cd   = model.getValue("/root/resData/resForm/medi_cd");
				var proc_dt    = model.getValue("/root/resData/resForm/proc_dt");
				var proc_seq = model.getValue("/root/resData/resForm/proc_seq");
				if(proc_dt == "" || proc_seq == ""){
					alert("게재전표번호를 입력하세요.");
					return;
				}else{
					
					model.setValue("/root/reqData/searchData/medi_cd", medi_cd);
					model.setValue("/root/reqData/searchData/proc_dt", proc_dt);
					model.setValue("/root/reqData/searchData/proc_seq", proc_seq);
					model.send("ad_pub_1610_s");
					
					if(submit_completed()){						
						if(model.getValue("/root/resData/resForm/advt_cont") == ""){
//							alert("조회결과가 없습니다.");
						}else{
/*
							btn_ins.disabled 		= false;								
							btn_upd.disabled 		= false;															
							btn_del.disabled	 	= false;
							btn_updpubc.disabled	= false;		
*/							
							cb_medi_cd.disabled 		= true;
												
						}
					}
				}				
			}
		]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="1,9;1,936;2,60;2,70;2,703;" style="font-family:굴림; background-image:../../../images/bg_946.gif; ">
		<caption id="caption63" class="list_cap02" style="left:9px; top:395px; width:602px; height:26px; "/>
		<caption id="caption38" class="list_cap02" style="left:9px; top:170px; width:602px; height:26px; "/>
		<caption id="caption68" class="list_cap02" style="left:9px; top:95px; width:602px; height:26px; "/>
		<caption id="caption67" class="list_cap02" style="left:9px; top:520px; width:602px; height:26px; "/>
		<caption id="caption54" class="list_cap02" style="left:9px; top:470px; width:602px; height:26px; "/>
		<caption id="caption56" class="list_cap02" style="left:9px; top:495px; width:602px; height:26px; "/>
		<caption id="caption73" class="list_cap02" style="left:9px; top:659px; width:602px; height:26px; "/>
		<caption id="caption72" class="list_cap02" style="left:9px; top:634px; width:602px; height:26px; "/>
		<caption id="caption71" class="list_cap02" style="left:9px; top:609px; width:602px; height:26px; "/>
		<caption id="caption70" class="list_cap02" style="left:9px; top:584px; width:602px; height:26px; "/>
		<caption id="caption69" class="list_cap02" style="left:9px; top:545px; width:602px; height:40px; "/>
		<caption id="caption62" class="list_cap02" style="left:9px; top:370px; width:602px; height:26px; "/>
		<caption id="caption8" class="list_cap02" style="left:9px; top:295px; width:602px; height:26px; "/>
		<caption id="caption59" class="list_cap02" style="left:9px; top:270px; width:602px; height:26px; "/>
		<caption id="caption61" class="list_cap02" style="left:9px; top:345px; width:602px; height:26px; "/>
		<caption id="caption60" class="list_cap02" style="left:9px; top:320px; width:602px; height:26px; "/>
		<caption id="caption35" class="list_cap02" style="left:9px; top:145px; width:602px; height:26px; "/>
		<caption id="caption57" class="list_cap02" style="left:9px; top:195px; width:602px; height:26px; "/>
		<caption id="caption6" tyle="left:15px; top:180px; width:940px; height:0px;" style="left:0px; top:10px; width:0px; height:0px; ">caption6</caption>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<caption id="caption44" class="list_cap02" style="left:9px; top:70px; width:602px; height:26px; "/>
		<button id="btn_ins" class="btn02" crud="C" style="left:451px; top:40px; width:50px; height:21px; ">
			<caption>입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if(validateReq()){
					
					if(checkAll()){						
					
						if(windowConfirm("입력하시겠습니까?")){
							makeNodeValue("/root/resData/resForm/flag", "I");
							model.send("ad_pub_1650_a");
							if(submit_completed()){
								model.setValue("/root/resData/resForm/proc_seq", model.getValue("/root/msgData/proc_seq"));
								inp_proc_seq.refresh();			
								if(switch1.selectedIndex == 0){													
									loadPreng();
								}else{
									loadPubc();
								}
								loadData();
							}
						}
					}
				}
				]]>
			</script>
		</button>
		<button id="btn_del" class="btn02" crud="D" style="left:563px; top:40px; width:50px; height:21px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				if(window.alert("삭제하시겠습니까?", "확인", 1) == 1) {
					if(instance1.selectSingleNode("/root/resData/resForm/flag") == null){
						model.makeNode("/root/resData/resForm/flag");
					}					
					model.setValue("/root/resData/resForm/flag", "D");
					model.send("ad_pub_1650_a");
					if(submit_completed()){
						loadPubc();
					}
				}				
				]]>
			</script>
		</button>
		<button id="button3" class="btn02" crud="R" style="left:713px; top:40px; width:50px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.reset();
//2009.11.20 KBS - 출판광고 생활미디어 고정
				//inp_slcrg_pers.value 	= 	"000315";
				//inp_slcrg_pers_nm.value	=	"생활미디어";
				out_dept_cd.value		=	"000315";
				out_dept_nm.value		=	"뉴스매거진";
				//inp_mchrg_pers.value	=	"000315";
				//inp_mchrg_pers_nm.value	=	"생활미디어";
				
				inp_slcrg_pers.refresh();
				inp_slcrg_pers_nm.refresh();
				out_dept_cd.refresh();
				out_dept_nm.refresh();
				inp_mchrg_pers.refresh();
				inp_mchrg_pers_nm.refresh();
				
				]]>
			</script>
		</button>
		<button id="button4" class="btn05" visibility="hidden" crud="P" style="left:769px; top:40px; width:110px; height:21px; ">
			<caption>거래명세표출력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					goReport("P");	
				]]>
			</script>
		</button>
		<button id="btn_upd" class="btn02" crud="U" style="left:507px; top:40px; width:50px; height:21px; ">
			<caption>수정</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				if(validateReq()){					
					if(checkAll()){
						if(window.alert("수정하시겠습니까?", "확인", 1) == 1) {
							if(instance1.selectSingleNode("/root/resData/resForm/flag") == null){
								model.makeNode("/root/resData/resForm/flag");
							}					
							model.setValue("/root/resData/resForm/flag", "U");
							model.send("ad_pub_1650_a");
							if(submit_completed()){
								//loadPreng();
							}
						}
					}
				}				
				]]>
			</script>
		</button>
		<button id="btn_updpubc" class="btn04" crud="C" style="left:619px; top:40px; width:88px; height:21px; ">
			<caption>수정전표생성</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				if(validateReq()){					
					if(checkAll()){

						var	upd_resn	=	model.getValue("/root/resData/resForm/upd_resn");
						if(upd_resn == ""){
							alert("수정사유를 선택하세요.");
							return;
						}else{
							if(upd_resn == "9"){
								var	upd_cont	=	model.getValue("/root/resData/resForm/upd_cont");
								if(upd_cont	== ""){
									alert("기타 선택시 수정내용을 입력해야 합니다.");
									return;
								}
							}
						}
												
						if(windowConfirm("수정전표를 생성하시겠습니까?")) {
							if(instance1.selectSingleNode("/root/resData/resForm/flag") == null){
								model.makeNode("/root/resData/resForm/flag");
							}					
							model.setValue("/root/resData/resForm/flag", "A");
							model.send("ad_pub_1650_a");
							if(submit_completed()){
								model.setValue("/root/resData/resForm/proc_seq", model.getValue("/root/msgData/proc_seq"));
								inp_proc_seq.refresh();		
								if(switch1.selectedIndex == 0){													
									loadPreng();
								}else{
									loadPubc();
								}
								loadData();
							}
						}
					}
				}							
				]]>
			</script>
		</button>
		<caption id="caption50" class="list_cap03" style="left:500px; top:220px; width:111px; height:26px; text-align:center; ">게재총액</caption>
		<input id="inp_coms_rate" ref="/root/resData/resForm/coms_rate" navindex="21" format="##.#" style="left:383px; top:299px; width:50px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[


					var pubc_tot_amt = 	Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));
					var coms_rate  	= 	Number(model.getValue("/root/resData/resForm/coms_rate"));
					
					var coms			=	pubc_tot_amt * (coms_rate /100);
					
					model.setValue("/root/resData/resForm/coms", coms);
					inp_coms.refresh();
									
				]]>
			</script>
		</input>
		<input id="inp_pubc_tot_amt" ref="/root/resData/resForm/pubc_tot_amt" class="req" navindex="14" format="#,###" appearance="input" style="left:500px; top:245px; width:111px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				recalculate("", "", "Y");
				]]>
			</script>
		</input>
		<caption id="caption51" class="list_cap03" style="left:311px; top:270px; width:70px; height:26px; text-align:center; ">대행료율</caption>
		<select id="checkbox1" ref="/root/resData/resForm/upd_yn" disabled="true" navindex="45" overflow="visible" appearance="full" cols="2" style="left:270px; top:588px; width:75px; height:15px; border-style:none; ">
			<choices>
				<item>
					<label>수정여부</label>
					<value>Y</value>
				</item>
			</choices>
		</select>
		<input id="inp_fee" ref="/root/resData/resForm/fee" navindex="18" format="#,###" style="left:524px; top:274px; width:80px; height:18px; text-align:right; "/>
		<caption id="caption52" class="list_cap03" style="left:439px; top:270px; width:80px; height:26px; text-align:center; ">대행료</caption>
		<caption id="caption41" class="list_cap03" style="left:9px; top:170px; width:90px; height:26px; text-align:center; ">광고주</caption>
		<output id="output12" ref="/root/resData/resForm/pre_pubc_slip_no" format="999-99999999-9999" style="left:112px; top:588px; width:155px; height:18px; text-align:left; border-style:solid; "/>
		<input id="inp_type_clsf_nm" ref="/root/resData/resForm/type_clsf_nm" navindex="27" imemode="hangul" inputtype="button" caption="유형구분" crud="R" style="left:138px; top:349px; width:165px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					window.load("/xrw/ad/co/AD_CO_1100.xrw", "modal", "", "align:center; width:650; height:520; sysmenu:visible; min:visible; max:true; resize:true; caption:visible;")
				]]>
			</script>
		</input>
		<caption id="caption53" class="list_cap03" style="left:9px; top:609px; width:100px; height:26px; text-align:center; ">수정일시</caption>
		<input id="inp_fee_rate" ref="/root/resData/resForm/fee_rate" navindex="17" format="##.#" style="left:383px; top:274px; width:50px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[

					var pubc_tot_amt = 	Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));
					var fee_rate     = 	Number(model.getValue("/root/resData/resForm/fee_rate"));
					
					var fee			=	pubc_tot_amt * (fee_rate /100);
					
					model.setValue("/root/resData/resForm/fee", fee);
					inp_fee.refresh();	
									
				]]>
			</script>
		</input>
		<caption id="caption42" class="list_cap03" style="left:9px; top:295px; width:90px; height:26px; text-align:center; ">취급처</caption>
		<input id="inp_coms" ref="/root/resData/resForm/coms" navindex="22" format="#,###" style="left:524px; top:299px; width:80px; height:18px; text-align:right; "/>
		<caption id="caption20" class="list_cap03" style="left:311px; top:320px; width:100px; height:26px; text-align:center; ">화폐종류</caption>
		<caption id="caption31" class="list_cap03" style="left:9px; top:345px; width:90px; height:26px; text-align:center; ">유형구분</caption>
		<caption id="caption43" class="list_cap03" style="left:9px; top:270px; width:90px; height:26px; text-align:center; ">대행사</caption>
		<caption id="caption1" class="list_cap03" style="left:449px; top:395px; width:80px; height:26px; text-align:center; ">본책부록</caption>
		<caption id="caption21" class="list_cap03" style="left:311px; top:345px; width:100px; height:26px; text-align:center; ">환율</caption>
		<caption id="caption32" class="list_cap03" style="left:9px; top:320px; width:90px; height:26px; text-align:center; ">업종구분</caption>
		<input id="inp_sect_nm" ref="/root/resData/resForm/pubc_side" navindex="9" caption="면" style="left:9px; top:245px; width:60px; height:18px; text-align:center; "/>
		<caption id="caption3" class="list_cap03" style="left:9px; top:220px; width:60px; height:26px; text-align:center; ">면</caption>
		<caption id="caption11" class="list_cap03" style="left:311px; top:295px; width:70px; height:26px; text-align:center; ">수수료율</caption>
		<select1 id="cb_book_appndx_clsf" ref="/root/resData/resForm/book_appndx_clsf" navindex="31" appearance="minimal" style="left:534px; top:399px; width:71px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/book_appndx_clsf/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="caption22" class="list_cap03" style="left:311px; top:370px; width:100px; height:26px; text-align:center; ">외화계약액</caption>
		<caption id="caption23" class="list_cap03" style="left:9px; top:195px; width:90px; height:26px; text-align:center; ">광고내용</caption>
		<input id="input24" ref="/root/resData/resForm/issu_ser_no" navindex="10" caption="호수" appearance="input" style="left:68px; top:245px; width:86px; height:18px; text-align:center; "/>
		<caption id="caption45" class="list_cap03" style="left:68px; top:220px; width:86px; height:26px; text-align:center; ">호수</caption>
		<caption id="caption12" class="list_cap03" style="left:439px; top:295px; width:80px; height:26px; text-align:center; ">수수료</caption>
		<bool id="bool10" disabled="true" navindex="48" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/purc_stmt_issu_yn" style="left:435px; top:638px; width:20px; height:20px; background-image:#uncheck; "/>
		<caption id="caption46" class="list_cap03" style="left:153px; top:220px; width:130px; height:26px; text-align:center; ">규격</caption>
		<input id="inp_dlco_nm" ref="/root/resData/resForm/dlco_nm" class="req" navindex="7" imemode="hangul" inputtype="button" caption="광고주" style="left:162px; top:174px; width:167px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText);			
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode== "13"){
					findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
				}								
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
				]]>
			</script>
		</input>
		<caption id="caption5" class="list_cap03" style="left:9px; top:145px; width:90px; height:26px; text-align:center; ">취급구분</caption>
		<caption id="caption24" class="list_cap03" style="left:9px; top:545px; width:90px; height:40px; text-align:center; ">비고</caption>
		<bool id="bool11" disabled="true" navindex="49" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/elec_tax_stmt_yn" style="left:435px; top:663px; width:20px; height:20px; background-image:#uncheck; "/>
		<caption id="caption36" class="list_cap03" style="left:9px; top:584px; width:100px; height:26px; text-align:center; ">
			<![CDATA[피수정게재전표]]>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					var pre_pubc_slip_no = model.getValue("/root/resData/resForm/pre_pubc_slip_no");
					if(pre_pubc_slip_no != ""){
						
						var medi_cd	= pre_pubc_slip_no.substr(0,3);
						var proc_dt		= pre_pubc_slip_no.substr(3, 8);
						var proc_seq	= pre_pubc_slip_no.substr(11);
						
						model.setValue("/root/reqData/searchData/medi_cd", medi_cd);
						model.setValue("/root/reqData/searchData/proc_dt", proc_dt);
						model.setValue("/root/reqData/searchData/proc_seq", proc_seq);
						
						model.send("ad_pub_1610_s");
					}
					]]>
			</script>
		</caption>
		<caption id="caption14" class="list_cap03" style="left:9px; top:370px; width:90px; height:26px; text-align:center; ">색도구분</caption>
		<input id="input15" ref="/root/resData/resForm/frex_cntr_amt" navindex="29" format="#,###.99" style="left:415px; top:374px; width:80px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[

				var mony_kind = model.getValue("/root/resData/resForm/mony_kind");
				if(mony_kind != "KRW"){
					var exrate			=	Number(model.getValue("/root/resData/resForm/exrate"));
					var	frex_cntr_amt	=	Number(model.getValue("/root/resData/resForm/frex_cntr_amt"));
					
					var advt_fee			=	fn_round(exrate * frex_cntr_amt, 0);
					
					model.setValue("/root/resData/resForm/advt_fee", advt_fee);
					inp_advt_fee.refresh();
					
					recalculate("Y", "", "");
				}
								
				]]>
			</script>
		</input>
		<caption id="caption25" class="list_cap03" style="left:9px; top:634px; width:100px; height:26px; text-align:center; ">마감상태</caption>
		<caption id="caption26" class="list_cap03" style="left:309px; top:609px; width:125px; height:26px; text-align:center; ">매출계산서발행여부</caption>
		<caption id="caption48" class="list_cap03" style="left:282px; top:220px; width:110px; height:26px; text-align:center; ">광고료</caption>
		<caption id="caption27" class="list_cap03" style="left:309px; top:659px; width:125px; height:26px; text-align:center; ">전자계산서발행여부</caption>
		<textarea id="textarea1" ref="/root/resData/resForm/remk" navindex="44" imemode="hangul" style="left:102px; top:549px; width:505px; height:33px; vertical-align:top; padding:2; "/>
		<input id="inp_advt_fee" ref="/root/resData/resForm/advt_fee" class="req" navindex="12" format="#,###" caption="광고료" style="left:282px; top:245px; width:110px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				recalculate("Y", "", "");
				]]>
			</script>
		</input>
		<caption id="caption49" class="list_cap03" style="left:391px; top:220px; width:110px; height:26px; text-align:center; ">부가세</caption>
		<select1 id="cb_hndl_clsf" ref="/root/resData/resForm/hndl_clsf" class="req" navindex="5" appearance="minimal" caption="취급구분" style="left:102px; top:149px; width:90px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/hndl_clsf/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<bool id="bool9" disabled="true" navindex="47" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/sale_stmt_issu_yn" style="left:435px; top:613px; width:20px; height:20px; background-image:#uncheck; "/>
		<caption id="caption39" class="list_cap03" style="left:309px; top:634px; width:125px; height:26px; text-align:center; ">매입계산서발행여부</caption>
		<input id="input18" ref="/root/resData/resForm/advt_cont" class="req" navindex="8" imemode="hangul" caption="광고내용" style="left:102px; top:199px; width:430px; height:18px; "/>
		<caption id="caption9" class="list_cap03" style="left:9px; top:70px; width:90px; height:26px; text-align:center; ">매체구분</caption>
		<input id="inp_vat" ref="/root/resData/resForm/vat" class="req" navindex="13" format="#,###" caption="부가세" style="left:390px; top:245px; width:111px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
				recalculate("", "Y", "");
				]]>
			</script>
		</input>
		<caption id="caption28" class="list_cap03" style="left:9px; top:659px; width:100px; height:26px; text-align:center; ">수금상태</caption>
		<select1 id="cb_mony_kind" ref="/root/resData/resForm/mony_kind" navindex="25" appearance="minimal" style="left:415px; top:324px; width:80px; height:18px; text-align:left; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/mony_kind/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[


				var mony_kind = model.getValue("/root/resData/resForm/mony_kind");
				makeNodeValue("/root/reqData/searchData/mony_kind", mony_kind);
				makeNodeValue("/root/reqData/searchData/preng_occr_dt", model.getValue("/root/resData/resForm/pubc_dt"));
				
				if(mony_kind == "KRW"){
					model.setValue("/root/resData/resForm/exrate", "");
					out_exrate.refresh();
					model.setValue("/root/resData/resForm/frex_cntr_amt", "");
					inp_frex_cntr_amt.refresh();
					return;
				}
				
				modelSendNoMake("ad_co_9001_s", "/ad/common/9001", "/root/reqData/searchData", "/root/tempData");	
//				model.send("ad_co_9001_s");
				if(submit_completed()){
					model.setValue("/root/resData/resForm/exrate", model.getValue("/root/tempData/exrate"));
					out_exrate.refresh();

					var exrate			=	Number(model.getValue("/root/resData/resForm/exrate"));
					var	frex_cntr_amt	=	Number(model.getValue("/root/resData/resForm/frex_cntr_amt"));
					
					var advt_fee			=	fn_round(exrate * frex_cntr_amt, 0);
					
					model.setValue("/root/resData/resForm/advt_fee", advt_fee);
					inp_advt_fee.refresh();
					
					recalculate("Y", "", "");
					
				}
				
				]]>
			</script>
		</select1>
		<input id="out_exrate" ref="/root/resData/resForm/exrate" editable="false" appearance="input" style="left:415px; top:349px; width:80px; height:18px; text-align:right; border-style:solid; "/>
		<input id="inp_indt_clsf_nm" ref="/root/resData/resForm/indt_clsf_nm" navindex="24" imemode="hangul" inputtype="button" caption="업종구분" crud="R" style="left:138px; top:324px; width:165px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					window.load("/xrw/ad/co/AD_CO_1000.xrw", "modal", "", "align:center; width:650; height:520; sysmenu:visible; min:visible; max:true; resize:true; caption:visible;")
				]]>
			</script>
		</input>
		<input id="inp_dlco_no" ref="/root/resData/resForm/dlco_no" class="req" navindex="6" autonext="false" maxlength="8" format="99999999" appearance="input" style="left:102px; top:174px; width:55px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var dlco_no = inp_dlco_no.currentText;
					model.setValue("/root/resData/resForm/dlco_no", lpad(dlco_no, 8, "0"));
					inp_dlco_no.refresh();
					
					commonSubmission("9004", inp_dlco_no.currentText, inp_dlco_no, inp_dlco_nm);	
				
				]]>
			</script>
		</input>
		<caption id="caption64" class="list_cap02" style="left:9px; top:420px; width:602px; height:26px; "/>
		<caption id="caption66" class="list_cap02" style="left:9px; top:445px; width:602px; height:26px; "/>
		<caption id="caption4" class="list_cap03" style="left:449px; top:420px; width:80px; height:26px; text-align:center; ">실제요율</caption>
		<input id="input1" ref="/root/resData/resForm/real_rate" navindex="35" format="##.####" appearance="input" style="left:535px; top:424px; width:45px; height:18px; text-align:right; "/>
		<caption id="caption7" class="list_cap03" style="left:449px; top:445px; width:80px; height:26px; text-align:center; ">총요율</caption>
		<caption id="caption17" class="list_cap03" style="left:9px; top:420px; width:90px; height:26px; text-align:center; ">영업담당</caption>
		<input id="input3" ref="/root/resData/resForm/tot_rate" format="##.####" appearance="input" style="left:535px; top:449px; width:45px; height:18px; text-align:right; "/>
		<caption id="caption18" class="list_cap03" style="left:449px; top:470px; width:80px; height:26px; text-align:center; ">NET요율</caption>
		<input id="input4" ref="/root/resData/resForm/net_rate" navindex="40" format="##.####" appearance="input" style="left:535px; top:474px; width:45px; height:18px; text-align:right; "/>
		<caption id="caption19" class="list_cap03" style="left:9px; top:445px; width:90px; height:26px; text-align:center; ">영업부서</caption>
		<caption id="caption30" class="list_cap03" style="left:311px; top:420px; width:100px; height:26px; text-align:center; ">면세여부</caption>
		<bool id="bool1" navindex="34" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/rtax_yn" style="left:413px; top:424px; width:20px; height:20px; background-image:#uncheck; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[

				var rtax_yn = model.getValue("/root/resData/resForm/rtax_yn");
				if(rtax_yn == "Y"){
					var advt_fee	= Number(model.getValue("/root/resData/resForm/advt_fee"));
					model.setValue("/root/resData/resForm/vat", "0");
					model.setValue("/root/resData/resForm/pubc_tot_amt", advt_fee);
					inp_vat.refresh();
					inp_pubc_tot_amt.refresh();
//					recalculate("", "", "Y", "");	
				}else{
					var advt_fee	= Number(model.getValue("/root/resData/resForm/advt_fee"));
					var vat   	= advt_fee / 10;//Number(model.getValue("/root/resData/resForm/vat"));					
					model.setValue("/root/resData/resForm/vat", vat);
					model.setValue("/root/resData/resForm/pubc_tot_amt", advt_fee  + vat);
					inp_vat.refresh(); 
					inp_pubc_tot_amt.refresh();
//					recalculate("", "", "Y", "");	
				}				
				]]>
			</script>
		</bool>
		<bool id="bool2" navindex="28" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/govern_advt_yn" style="left:413px; top:449px; width:20px; height:20px; background-image:#uncheck; "/>
		<caption id="caption33" class="list_cap03" style="left:311px; top:445px; width:100px; height:26px; text-align:center; ">정부광고여부</caption>
		<bool id="bool3" navindex="39" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/advcs_offr_yn" style="left:413px; top:474px; width:20px; height:20px; background-image:#uncheck; "/>
		<caption id="caption34" class="list_cap03" style="left:9px; top:470px; width:90px; height:26px; text-align:center; ">관리담당</caption>
		<caption id="caption37" class="list_cap03" style="left:311px; top:470px; width:100px; height:26px; text-align:center; ">광고주제공여부</caption>
		<button id="btn_preng" class="tab04" group="tab" selected="true" select.background-image="../../../images/tep-T4.gif" crud="R" style="left:620px; top:70px; width:78px; height:23px; background-image:../../../images/tep1-T4.gif; ">
			<caption>예약승인</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					loadPreng();
				]]>
			</script>
		</button>
		<button id="btn_pubc" class="tab04" group="tab" select.background-image="../../../images/tep-T4.gif" crud="R" style="left:698px; top:70px; width:78px; height:23px; background-image:../../../images/tep1-T4.gif; ">
			<caption>게재실적</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					loadPubc();
				]]>
			</script>
		</button>
		<input id="inp_search_dt" ref="/root/reqData/searchData/search_dt" inputtype="date" format="yyyy-mm-dd" crud="R" style="left:845px; top:73px; width:90px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				model.setValue("/root/reqData/searchData/medi_cd", model.getValue("/root/resData/resForm/medi_cd"));
				model.send("ad_pub_1620_l");
				if( switch1.selectedIndex == "0" ){
					loadPreng();
				}
				else{
					loadPubc();
				}
				]]>
			</script>
		</input>
		<switch id="switch1" style="left:620px; top:92px; width:315px; height:612px; ">
			<case id="case1" selected="true">
				<datagrid id="datagrid1" nodeset="/root/resData/gridData1/record" caption="면^광고주^규격^영업담당^예약발생일자^예약발생순번" colsep="^" colwidth="40, 110, 60, 78, 100, 100" explorerbar="sort" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:2px; top:2px; width:309px; height:605px; ">
					<col ref="pubc_side"/>
					<col ref="dlco_nm" style="text-align:left; "/>
					<col ref="publ_std"/>
					<col ref="slcrg_pers_nm" style="text-align:left; "/>
					<col ref="preng_occr_dt" visibility="hidden"/>
					<col ref="preng_occr_seq" visibility="hidden"/>
					<script type="javascript" ev:event="ondblclick">
						<![CDATA[
						
						if(!isDataRegion(datagrid1)) return;
/*						
						var row = datagrid1.mouseRow;
						var col = datagrid1.mouseCol;
						
						if(row > datagrid1.rows) return;
						if(row < datagrid1.fixedRows) return;
*/						
						var preng_occr_dt  = datagrid1.valueMatrix(datagrid1.row, datagrid1.colRef("preng_occr_dt"));													
						var preng_occr_seq = datagrid1.valueMatrix(datagrid1.row, datagrid1.colRef("preng_occr_seq"));		
						
						model.setValue("/root/reqData/searchData/preng_occr_dt", preng_occr_dt);
						model.setValue("/root/reqData/searchData/preng_occr_seq", preng_occr_seq);
						
						model.send("ad_pub_1625_s");		
						
						cb_medi_cd.disabled 		= true;
/*						
						btn_ins.disabled = false;																				
						btn_upd.disabled = true;															
						btn_del.disabled = true;
*/						
						]]>
					</script>
				</datagrid>
			</case>
			<case id="case2">
				<datagrid id="datagrid2" nodeset="/root/resData/gridData2/record" caption="면^광고주^규격^영업담당^게재발생일자^게재발생순번" colsep="^" colwidth="40, 110, 60, 61, 100, 100" explorerbar="sort" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:2px; top:2px; width:309px; height:605px; word-wrap:none; ">
					<col ref="pubc_side"/>
					<col ref="dlco_nm" style="text-align:left; word-wrap:none; "/>
					<col ref="publ_std"/>
					<col ref="slcrg_pers_nm" style="text-align:left; "/>
					<col ref="pubc_occr_dt" visibility="hidden"/>
					<col ref="pubc_occr_seq" visibility="hidden"/>
					<script type="javascript" ev:event="ondblclick">
						<![CDATA[
							if(!isDataRegion(datagrid2)) return;

							var pubc_occr_dt  = datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("pubc_occr_dt"));													
							var pubc_occr_seq = datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("pubc_occr_seq"));		
							
							model.setValue("/root/reqData/searchData/pubc_occr_dt", pubc_occr_dt);
							model.setValue("/root/reqData/searchData/pubc_occr_seq", pubc_occr_seq);
							
							model.send("ad_pub_1635_s");		
							cb_medi_cd.disabled 		= true;
										
						]]>
					</script>
				</datagrid>
			</case>
		</switch>
		<input id="inp_hndl_plac_nm" ref="/root/resData/resForm/hndl_plac_nm" navindex="20" imemode="hangul" inputtype="button" crud="R" style="left:160px; top:299px; width:145px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[

				showAdvcsSearchPopup("", "", "", "Y", "Y", inp_hndl_plac_nm.currentText);									
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode== "13"){
					findDlcoNoByName("4", inp_hndl_plac_nm.currentText, inp_hndl_plac_cd, inp_hndl_plac_nm);
				}							
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				findDlcoNoByName("4", inp_hndl_plac_nm.currentText, inp_hndl_plac_cd, inp_hndl_plac_nm);
				]]>
			</script>
		</input>
		<input id="inp_hndl_plac_cd" ref="/root/resData/resForm/hndl_plac_cd" navindex="19" autonext="false" maxlength="8" format="99999999" appearance="input" style="left:102px; top:299px; width:55px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var hndl_plac_cd = inp_hndl_plac_cd.currentText;
					model.setValue("/root/resData/resForm/hndl_plac_cd", lpad(hndl_plac_cd, 8, "0"));
					inp_hndl_plac_cd.refresh()			
					
					commonSubmission("9004", inp_hndl_plac_cd.currentText, inp_hndl_plac_cd, inp_hndl_plac_nm);	
				
				]]>
			</script>
		</input>
		<input id="inp_agn_nm" ref="/root/resData/resForm/agn_nm" navindex="16" imemode="hangul" inputtype="button" crud="R" style="left:160px; top:274px; width:145px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				showAdvcsSearchPopup("", "", "Y", "", "", inp_agn_nm.currentText);		
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode== "13"){
					findDlcoNoByName("2", inp_agn_nm.currentText, inp_agn, inp_agn_nm);
				}								
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				findDlcoNoByName("2", inp_agn_nm.currentText, inp_agn, inp_agn_nm);
				]]>
			</script>
		</input>
		<input id="inp_agn" ref="/root/resData/resForm/agn" navindex="15" autonext="false" maxlength="8" format="99999999" appearance="input" style="left:102px; top:274px; width:55px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var agn = inp_agn.currentText; 
					model.setValue("/root/resData/resForm/agn",  lpad(agn, 8, "0"));
					inp_agn.refresh();			
					
					commonSubmission("9004", inp_agn.currentText, inp_agn, inp_agn_nm);	
				
				]]>
			</script>
		</input>
		<input id="inp_slcrg_pers_nm" ref="/root/resData/resForm/slcrg_pers_nm" class="req" navindex="33" editable="false" imemode="hangul" inputtype="button" caption="영업담당" crud="R" style="left:177px; top:424px; width:123px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				
				searchEmpno("setSlcrgPers", "/root/resData/resForm/slcrg_pers", "/root/resData/resForm/slcrg_pers_nm");
				var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
				if(emp_no != ""){
					findDept(emp_no, out_dept_cd, out_dept_nm);
				}	
											
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				
				if(event.keyCode == "13"){
					findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm.currentText, inp_slcrg_pers, inp_slcrg_pers_nm);		
					var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
					if(emp_no != ""){
						findDept(emp_no, out_dept_cd, out_dept_nm);
					}															
				}
				
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					
					findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm.currentText, inp_slcrg_pers, inp_slcrg_pers_nm);	
					var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
					if(emp_no != ""){
						findDept(emp_no, out_dept_cd, out_dept_nm);
					}	
														
				]]>
			</script>
		</input>
		<input id="inp_slcrg_pers" ref="/root/resData/resForm/slcrg_pers" class="req" navindex="32" editable="false" appearance="input" style="left:102px; top:424px; width:70px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				
				commonSubmission("9005", inp_slcrg_pers.currentText,  inp_slcrg_pers, inp_slcrg_pers_nm);	
				var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
				if(emp_no != ""){
					findDept(emp_no, out_dept_cd, out_dept_nm);
				}				
				
				]]>
			</script>
		</input>
		<select1 id="cb_chro_clsf" ref="/root/resData/resForm/chro_clsf" navindex="28" appearance="minimal" caption="색도구분" style="left:102px; top:374px; width:123px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/chro_clsf/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<input id="inp_mchrg_pers_nm" ref="/root/resData/resForm/mchrg_pers_nm" class="req" navindex="38" editable="false" imemode="hangul" inputtype="button" style="left:177px; top:474px; width:123px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				searchEmpno("setMchrgPers", "/root/resData/resForm/mchrg_pers", "/root/resData/resForm/mchrg_pers_nm");		
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[

				if(event.keyCode == "13"){
					findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);
				}							
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);
				]]>
			</script>
		</input>
		<input id="inp_mchrg_pers" ref="/root/resData/resForm/mchrg_pers" class="req" navindex="37" editable="false" caption="관리담당" appearance="input" style="left:102px; top:474px; width:70px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				commonSubmission("9005", inp_mchrg_pers.currentText,  inp_mchrg_pers, inp_mchrg_pers_nm);		
				
				]]>
			</script>
		</input>
		<output id="out_dept_nm" ref="/root/resData/resForm/dept_nm" style="left:177px; top:449px; width:123px; height:18px; border-style:solid; "/>
		<output id="out_dept_cd" ref="/root/resData/resForm/dept_cd" appearance="output" style="left:102px; top:449px; width:70px; height:18px; text-align:center; border-style:solid; "/>
		<output id="output15" ref="/root/resData/resForm/pre_pubc_slip_no_crte_dt" style="left:112px; top:613px; width:155px; height:18px; text-align:center; border-style:solid; "/>
		<select id="checkbox2" ref="/root/resData/resForm/div_yn" disabled="true" navindex="46" overflow="visible" appearance="full" cols="2" style="left:350px; top:588px; width:75px; height:15px; border-style:none; ">
			<choices>
				<item>
					<label>분할여부</label>
					<value>Y</value>
				</item>
			</choices>
		</select>
		<select1 id="cb_medi_cd" ref="/root/resData/resForm/medi_cd" class="req" navindex="1" appearance="minimal" style="left:102px; top:74px; width:103px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/medi_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<input id="inp_indt_clsf" ref="/root/resData/resForm/indt_clsf" navindex="23" appearance="input" style="left:102px; top:324px; width:30px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				commonSubmission("9009", inp_indt_clsf.currentText,  inp_indt_clsf, inp_indt_clsf_nm);		
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					commonSubmission("9009", inp_indt_clsf.currentText,  inp_indt_clsf, inp_indt_clsf_nm);		
				}
				]]>
			</script>
		</input>
		<input id="inp_type_clsf" ref="/root/resData/resForm/type_clsf" navindex="26" appearance="input" style="left:102px; top:349px; width:30px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				commonSubmission("9010", inp_type_clsf.currentText,  inp_type_clsf, inp_type_clsf_nm);	
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					commonSubmission("9010", inp_type_clsf.currentText,  inp_type_clsf, inp_type_clsf_nm);	
				}
				]]>
			</script>
		</input>
		<caption id="caption74" class="list_cap03" style="left:9px; top:495px; width:90px; height:26px; text-align:center; ">수정사유</caption>
		<select1 id="combo5" ref="/root/resData/resForm/upd_resn" navindex="41" appearance="minimal" style="left:102px; top:499px; width:123px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/upd_resn/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<input id="input2" ref="/root/resData/resForm/upd_cont" navindex="43" imemode="hangul" style="left:102px; top:524px; width:204px; height:18px; "/>
		<caption id="caption65" class="list_cap03" style="left:9px; top:520px; width:90px; height:26px; text-align:center; ">수정내용</caption>
		<caption id="caption10" style="left:192px; top:99px; width:15px; height:20px; text-align:center; ">-</caption>
		<caption id="caption29" class="list_cap03" style="left:9px; top:95px; width:90px; height:26px; ">게재전표</caption>
		<input id="inp_proc_dt" ref="/root/resData/resForm/proc_dt" class="req" navindex="2" inputtype="date" format="yyyy-mm-dd" caption="게재전표일자" style="left:102px; top:99px; width:90px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[

				if(!cb_medi_cd.disabled){
					var	proc_dt	=	model.getValue("/root/resData/resForm/proc_dt");
					model.setValue("/root/resData/resForm/pubc_dt", proc_dt);
					inp_pubc_dt.refresh();
				}
								
				]]>
			</script>
		</input>
		<output id="output5" ref="/root/resData/resForm/pubc_occr_seq" visibility="hidden" format="9999" appearance="output" maxlength="4" style="left:542px; top:99px; width:35px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
					var pubc_occr_seq = model.getValue("/root/resData/resForm/pubc_occr_seq");
					if(pubc_occr_seq != ""){
						model.setValue("/root/resData/resForm/pubc_occr_seq", lpad(pubc_occr_seq, 4, "0"));
						inp_pubc_occr_seq.refresh();	
					}
				]]>
			</script>
		</output>
		<caption id="caption2" class="list_cap02" style="left:9px; top:120px; width:602px; height:26px; "/>
		<input id="inp_pubc_dt" ref="/root/resData/resForm/pubc_dt" class="req" navindex="4" inputtype="date" format="yyyy-mm-dd" caption="게재일자" appearance="input" style="left:102px; top:124px; width:90px; height:18px; border-style:solid; "/>
		<caption id="caption75" class="list_cap03" style="left:9px; top:120px; width:90px; height:26px; text-align:center; ">게재일자</caption>
		<select1 id="combo6" ref="/root/resData/resForm/publ_std" navindex="11" appearance="minimal" editmode="search" caption="규격" style="left:153px; top:245px; width:130px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/publ_std/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="caption13" class="list_cap03" style="left:9px; top:395px; width:90px; height:26px; text-align:center; ">지종구분</caption>
		<select1 id="cb_nwsp_type_clsf" ref="/root/resData/resForm/nwsp_type_clsf" navindex="30" appearance="minimal" style="left:102px; top:399px; width:123px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/nwsp_type_clsf/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<button id="btnClose" class="btn02" style="left:885px; top:40px; width:50px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
				]]>
			</script>
		</button>
		<caption id="caption15" class="list_cap03" visibility="hidden" style="left:364px; top:95px; width:108px; height:26px; ">게재등록번호</caption>
		<input id="inp_proc_seq" ref="/root/resData/resForm/proc_seq" navindex="3" maxlength="4" format="9999" appearance="input" style="left:208px; top:99px; width:35px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
					var proc_seq = model.getValue("/root/resData/resForm/proc_seq");
					if(proc_seq != ""){
						model.setValue("/root/resData/resForm/proc_seq", lpad(proc_seq, 4, "0"));
						inp_proc_seq.refresh();	
					}
				]]>
			</script>
		</input>
		<button id="button1" class="btn02" crud="R" style="left:395px; top:40px; width:50px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				loadData();
				
				]]>
			</script>
		</button>
		<output id="output6" ref="/root/resData/resForm/pubc_occr_dt" visibility="hidden" format="yyyy-mm-dd" style="left:474px; top:99px; width:65px; height:18px; text-align:center; "/>
		<select1 id="radio1" ref="/root/resData/resForm/sel_rate" navindex="36" appearance="full" cols="1" rows="3" vcellspacing="8" overflow="visible" style="left:585px; top:422px; width:20px; height:71px; border-style:none; ">
			<choices>
				<item>
					<label/>
					<value>R</value>
				</item>
				<item>
					<label/>
					<value>T</value>
				</item>
				<item>
					<label/>
					<value>N</value>
				</item>
			</choices>
		</select1>
		<output id="output4" ref="/root/resData/resForm/clos_stat" style="left:112px; top:638px; width:100px; height:18px; "/>
		<output id="output1" ref="/root/resData/resForm/clamt_stat" style="left:112px; top:663px; width:100px; height:18px; "/>
		<button id="button22" style="left:247px; top:99px; width:18px; height:18px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
			<caption>+</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				var proc_dt 		= model.getValue("/root/resData/resForm/proc_dt");
				var proc_seq		= Number(model.getValue("/root/resData/resForm/proc_seq"));
				
				proc_seq++;
				
				model.setValue("/root/resData/resForm/proc_seq", lpad(""+proc_seq, 4, "0"));
				inp_proc_seq.refresh();
				
				loadData();
				
				]]>
			</script>
		</button>
		<button id="button23" style="left:267px; top:99px; width:18px; height:18px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
			<caption>-</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				var proc_dt 		= model.getValue("/root/resData/resForm/proc_dt");
				var proc_seq		= Number(model.getValue("/root/resData/resForm/proc_seq"));
				
				if(proc_seq	==	1)	return;
				
				if(proc_seq == 0) proc_seq = 1;
				else			     proc_seq--;
				
				model.setValue("/root/resData/resForm/proc_seq", lpad(""+proc_seq, 4, "0"));
				inp_proc_seq.refresh();
								
				loadData();
				
				]]>
			</script>
		</button>
		<caption id="cp_tax_email" class="list_cap03" style="left:311px; top:495px; width:100px; height:26px; text-align:center; ">계산서이메일</caption>
		<input id="ip_tax_email" ref="/root/resData/resForm/tax_email" navindex="42" style="left:415px; top:499px; width:191px; height:18px; "/>
		<caption id="cp_tax_clsf_1" class="list_cap03" visibility="hidden" style="left:475px; top:609px; width:54px; height:26px; ">광고주</caption>
		<caption id="cp_tax_clsf_2" class="list_cap03" visibility="hidden" style="left:475px; top:634px; width:54px; height:26px; ">대행사</caption>
		<caption id="cp_tax_clsf_4" class="list_cap03" visibility="hidden" style="left:475px; top:659px; width:54px; height:26px; ">위수탁</caption>
		<select1 id="rdo_tax_clsf" ref="/root/resData/resForm/tax_clsf" visibility="hidden" appearance="full" cols="1" rows="3" vcellspacing="8" overflow="visible" style="left:545px; top:611px; width:20px; height:71px; border-style:none; ">
			<choices>
				<item>
					<label/>
					<value>1</value>
				</item>
				<item>
					<label/>
					<value>2</value>
				</item>
				<item>
					<label/>
					<value>4</value>
				</item>
			</choices>
		</select1>
		<input id="inp_patr_chrg_info" ref="/root/resData/resForm/patr_chrg_info" navindex="42" style="left:415px; top:524px; width:191px; height:18px; "/>
		<caption id="caption16" class="list_cap03" style="left:311px; top:520px; width:100px; height:26px; text-align:center; ">상대담당정보</caption>
		<caption id="caption40" class="list_cap03" style="left:311px; top:395px; width:100px; height:26px; text-align:center; ">협찬여부</caption>
		<bool id="bl_advt_clsf" navindex="34" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/advt_clsf" style="left:413px; top:399px; width:20px; height:20px; background-image:#uncheck; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[

				var rtax_yn = model.getValue("/root/resData/resForm/rtax_yn");
				if(rtax_yn == "Y"){
					var advt_fee	= Number(model.getValue("/root/resData/resForm/advt_fee"));
					model.setValue("/root/resData/resForm/vat", "0");
					model.setValue("/root/resData/resForm/pubc_tot_amt", advt_fee);
					inp_vat.refresh();
					inp_pubc_tot_amt.refresh();
//					recalculate("", "", "Y", "");	
				}else{
					var advt_fee	= Number(model.getValue("/root/resData/resForm/advt_fee"));
					var vat   	= advt_fee / 10;//Number(model.getValue("/root/resData/resForm/vat"));					
					model.setValue("/root/resData/resForm/vat", vat);
					model.setValue("/root/resData/resForm/pubc_tot_amt", advt_fee  + vat);
					inp_vat.refresh(); 
					inp_pubc_tot_amt.refresh();
//					recalculate("", "", "Y", "");	
				}				
				]]>
			</script>
		</bool>
	</xhtml:body>
</xhtml:html>
