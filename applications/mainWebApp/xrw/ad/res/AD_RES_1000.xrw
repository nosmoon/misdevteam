<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<sect_clsf_cd>
								<item>
									<label/>
									<value/>
									<pcode/>
								</item>
							</sect_clsf_cd>
							<sect_nm_cd>
								<item>
									<label/>
									<value/>
									<pcode/>
								</item>
							</sect_nm_cd>
							<sect_clsf_cd1>
								<item>
									<label/>
									<value/>
									<pcode/>
								</item>
							</sect_clsf_cd1>
							<sect_nm_cd1>
								<item>
									<label/>
									<value/>
									<pcode/>
								</item>
							</sect_nm_cd1>
							<sect_clsf_cd2>
								<item>
									<label/>
									<value/>
									<pcode/>
								</item>
							</sect_clsf_cd2>
							<sect_nm_cd2>
								<item>
									<label/>
									<value/>
									<pcode/>
								</item>
							</sect_nm_cd2>
							<sect_clsf_cd3>
								<item>
									<label/>
									<value/>
									<pcode/>
								</item>
							</sect_clsf_cd3>
							<sect_nm_cd3>
								<item>
									<label/>
									<value/>
									<pcode/>
								</item>
							</sect_nm_cd3>
							<sect_clsf_cd4>
								<item>
									<label/>
									<value/>
									<pcode/>
								</item>
							</sect_clsf_cd4>
							<sect_nm_cd4>
								<item>
									<label/>
									<value/>
									<pcode/>
								</item>
							</sect_nm_cd4>
							<sect_clsf_cd5>
								<item>
									<label/>
									<value/>
									<pcode/>
								</item>
							</sect_clsf_cd5>
							<sect_nm_cd5>
								<item>
									<label/>
									<value/>
									<pcode/>
								</item>
							</sect_nm_cd5>
							<edt_clsf>
								<item>
									<label/>
									<value/>
									<pcode/>
								</item>
							</edt_clsf>
						</comboSet>
						<pageInfo/>
					</initData>
					<reqData>
						<fwdData/>
						<searchData>
							<issu_yymm/>
							<medi_cd>110</medi_cd>
							<pcnt_clos_yn/>
						</searchData>
						<reqForm/>
						<multiUpdateData/>
					</reqData>
					<resData>
						<resForm/>
						<gridData1>
							<record>
								<sun/>
								<sun_cnt/>
								<sun_pcnt_clos_yn/>
								<sun_clos_yn/>
								<mon/>
								<mon_cnt/>
								<mon_pcnt_clos_yn/>
								<mon_clos_yn/>
								<tue/>
								<tue_cnt/>
								<tue_pcnt_clos_yn/>
								<tue_clos_yn/>
								<wed/>
								<wed_cnt/>
								<wed_pcnt_clos_yn/>
								<wed_clos_yn/>
								<thr/>
								<thr_cnt/>
								<thr_pcnt_clos_yn/>
								<thr_clos_yn/>
								<fri/>
								<fri_cnt/>
								<fri_pcnt_clos_yn/>
								<fri_clos_yn/>
								<sat/>
								<sat_cnt/>
								<sat_pcnt_clos_yn/>
								<sat_clos_yn/>
							</record>
						</gridData1>
						<gridData2>
							<record>
								<sect_clas_cd/>
								<sect_nm_cd/>
								<edt_clsf/>
								<sect_cd/>
								<bgn_side/>
								<end_side/>
								<issu_size/>
								<issu_cnt/>
								<tabl_clsf/>
								<pre_sect_clas_cd/>
								<pre_sect_nm_cd/>
							</record>
							<preng_cnt>예약건수</preng_cnt>
						</gridData2>
						<gridData3>
							<record>
								<wkdy/>
								<wkdy_nm/>
								<issu_size/>
								<sect_clas_cd1/>
								<sect_nm_cd1/>
								<sect_cd1/>
								<bgn_side1/>
								<end_side1/>
								<sect_clas_cd2/>
								<sect_nm_cd2/>
								<sect_cd2/>
								<bgn_side2/>
								<end_side2/>
								<sect_clas_cd3/>
								<sect_nm_cd3/>
								<sect_cd3/>
								<bgn_side3/>
								<end_side3/>
								<sect_clas_cd4/>
								<sect_nm_cd4/>
								<sect_cd4/>
								<bgn_side4/>
								<end_side4/>
								<sect_clas_cd5/>
								<sect_nm_cd5/>
								<sect_cd5/>
								<bgn_side5/>
								<end_side5/>
							</record>
						</gridData3>
						<gridData4>
							<record>
								<wkdy/>
								<wkdy_nm/>
								<issu_size/>
								<bgn_side1/>
								<end_side1/>
								<bgn_side2/>
								<end_side2/>
								<bgn_side3/>
								<end_side3/>
								<bgn_side4/>
								<end_side4/>
								<bgn_side5/>
								<end_side5/>
							</record>
						</gridData4>
					</resData>
					<tempData>
						<keyData/>
					</tempData>
					<msgData/>
				</root>
			</instance>
			<submission id="ad_res_1000_m" action="/ad/res/1000" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData1"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[				
								
		       		datagrid1.focusColor = "#00CCFF";		    
			    
				model.setValue("/root/reqData/searchData/issu_yymm", getCurrentMonth());
				inp_issu_yymm.refresh();
				
				model.send("ad_res_1000_m");
				
				model.copyNode("/root/initData/comboSet/sect_clsf_cd", "/root/resData/sect_clsf_cd");
				model.copyNode("/root/initData/comboSet/sect_nm_cd", "/root/resData/sect_nm_cd");
				model.copyNode("/root/initData/comboSet/sect_clsf_cd1", "/root/resData/sect_clsf_cd1");
				model.copyNode("/root/initData/comboSet/sect_nm_cd1", "/root/resData/sect_nm_cd1");
				model.copyNode("/root/initData/comboSet/sect_clsf_cd2", "/root/resData/sect_clsf_cd2");
				model.copyNode("/root/initData/comboSet/sect_nm_cd2", "/root/resData/sect_nm_cd2");
				model.copyNode("/root/initData/comboSet/sect_clsf_cd3", "/root/resData/sect_clsf_cd3");
				model.copyNode("/root/initData/comboSet/sect_nm_cd3", "/root/resData/sect_nm_cd3");
				model.copyNode("/root/initData/comboSet/sect_clsf_cd4", "/root/resData/sect_clsf_cd4");
				model.copyNode("/root/initData/comboSet/sect_nm_cd4", "/root/resData/sect_nm_cd4");
				model.copyNode("/root/initData/comboSet/sect_clsf_cd5", "/root/resData/sect_clsf_cd5");
				model.copyNode("/root/initData/comboSet/sect_nm_cd5", "/root/resData/sect_nm_cd5");
				model.copyNode("/root/initData/comboSet/edt_clsf", "/root/resData/edt_clsf");
								
				model.send("ad_res_1020_l");
				
				for(var i=datagrid4.fixedRows;i<datagrid4.rows; i++){	
					var sect_clas_cd = model1.getValue("/root/resData/gridData3/record["+i+"]/sect_clas_cd1"); 
					datagrid4.cellComboNodeset(i, 5) = "/root/initData/comboSet/sect_nm_cd1/item[pcode='" + sect_clas_cd + "']";
					
					var sect_clas_cd = model1.getValue("/root/resData/gridData3/record["+i+"]/sect_clas_cd2"); 
					datagrid4.cellComboNodeset(i, 10) = "/root/initData/comboSet/sect_nm_cd2/item[pcode='" + sect_clas_cd + "']";
					
					var sect_clas_cd = model1.getValue("/root/resData/gridData3/record["+i+"]/sect_clas_cd3"); 
					datagrid4.cellComboNodeset(i, 15) = "/root/initData/comboSet/sect_nm_cd3/item[pcode='" + sect_clas_cd + "']";
					
					var sect_clas_cd = model1.getValue("/root/resData/gridData3/record["+i+"]/sect_clas_cd4"); 
					datagrid4.cellComboNodeset(i, 20) = "/root/initData/comboSet/sect_nm_cd4/item[pcode='" + sect_clas_cd + "']";
					
					var sect_clas_cd = model1.getValue("/root/resData/gridData3/record["+i+"]/sect_clas_cd5"); 
					datagrid4.cellComboNodeset(i, 25) = "/root/initData/comboSet/sect_nm_cd5/item[pcode='" + sect_clas_cd + "']";
				}
								
				resetIssuSize();
				
				
				
				]]>
			</script>
			<submission id="ad_res_1020_l" action="/ad/res/1020" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData3"/>
			<submission id="ad_res_1030_i" action="/ad/res/1030" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/msgData"/>
			<submission id="ad_res_1010_s" action="/ad/res/1010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData2"/>
			<submission id="ad_res_1040_a" action="/ad/res/1040" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/msgData"/>
			<submission id="ad_res_1050_u" action="/ad/res/1050" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/msgData"/>
			<submission id="ad_res_1060_u" action="/ad/res/1060" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/msgData"/>
			<submission id="ad_res_1025_l" action="/ad/res/1025" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData4"/>
			<submission id="ad_res_1065_u" action="/ad/res/1065" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/msgData"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[	
			function loadData(){
				
				if(!commGhkMonth("/root/reqData/searchData/issu_yymm")){
					alert("올바른 날짜가 아닙니다.");
					return;
				}

				if(instance1.selectSingleNode("/root/reqData/searchData/issu_dt") != null){
					model.setValue("/root/reqData/searchData/issu_dt", "");
				}  
				
				model.send("ad_res_1000_m");				
				model.send("ad_res_1010_s");

				resetIssuSize();				
										
			}
			function resetIssuSize(){
				
				datagrid1.allStyle("data", "background-color") = "#FFFFFF";
				
				for(var i=datagrid1.fixedRows; i<datagrid1.rows; i++){
					for(var j=datagrid1.fixedCols; j<datagrid1.cols; j++){
						if(j%4 == 0){
							datagrid1.cellstyle("background-color", i, j) = "#FFFFCC";	
							var pcnt_clos_yn = datagrid1.valueMatrix(i,j+2);
							var pubc_clos_yn = datagrid1.valueMatrix(i,j+3);
							if(pcnt_clos_yn == 'Y'){
								datagrid1.cellstyle("background-color", i, j+1) = "#66CC33";		
							}				
							if(pubc_clos_yn == 'Y'){
								datagrid1.cellstyle("background-color", i, j) = "#FFCC00";		
							}				
						}						
					}
				}		
				
				for(var i=0; i<7-datagrid1.rows; i++){
					datagrid1.addRow();
				}
								
			}
			
			function	checkSection(datagrid){
				
				if(datagrid.rows - datagrid.fixedRows > 8){
					alert("섹션은 최대 8개까지 가능합니다.");
					return;
				}				

				// 분류체크
				for(var i=datagrid.fixedRows; i<datagrid.rows; i++){
					var sect_nm_cd	= datagrid.valueMatrix(i, datagrid.colRef("sect_nm_cd"));
					var sect_cd		= datagrid.valueMatrix(i, datagrid.colRef("sect_cd"));
					
					if(datagrid.rowStatus(i) == "4") continue;
					
					for(var j=datagrid.fixedRows; j<datagrid.rows; j++){
						if(i != j){
							
							if(datagrid.rowStatus(j) == "4") continue;
							
							var other_sect_nm_cd		= datagrid.valueMatrix(j, datagrid.colRef("sect_nm_cd"));
							var other_sect_cd			= datagrid.valueMatrix(j, datagrid.colRef("sect_cd"));						
//							if(sect_nm_cd == other_sect_nm_cd){
//								alert("같은 섹션명이 있습니다. 저장할 수 없습니다.");
//								return false;
//							}				
							if(sect_cd == other_sect_cd){
								alert("같은 섹션이 있습니다. 저장할 수 없습니다.");
								return false;
							}
						}							
					}
				}
				
				return true;
			}
		]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="1,10;1,936;2,61;2,71;2,126;2,105;2,115;2,120;" style="font-family:굴림; ">
		<caption id="caption12" class="list_cap02" style="left:10px; top:71px; width:926px; height:28px; "/>
		<caption id="caption6" tyle="left:15px; top:180px; width:940px; height:0px;" style="left:0px; top:10px; width:0px; height:0px; ">caption6</caption>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group_line" class="gro_line" style="left:10px; top:108px; width:926px; height:5px; "/>
		<button id="button4" class="btn02" crud="R" style="left:375px; top:40px; width:50px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[			
					if(validateReq()){
						loadData();
					}
								
				]]>
			</script>
		</button>
		<caption id="caption7" class="list_cap01" style="left:10px; top:71px; width:85px; height:28px; ">발행년월</caption>
		<button id="button1" class="btn02" crud="R" style="left:486px; top:40px; width:50px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.reset();
				]]>
			</script>
		</button>
		<button id="button3" class="btn03" crud="C" style="left:541px; top:40px; width:66px; height:21px; ">
			<caption>초기값생성</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if(window.alert("초기값 생성을 합니다. 계속하시겠습니까?", "확인", 1) == 1){
					var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");  
					model.send("ad_res_1030_i");
					if(submit_completed()){
						loadData();
					}
				}
				]]>
			</script>
		</button>
		<button id="button11" class="btn02" crud="C" style="left:431px; top:40px; width:50px; height:21px; ">
			<caption>저장</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				var issu_dt = model.getValue("/root/reqData/searchData/issu_dt");
				
				// 1. 발행일자 체크
				if( issu_dt == "" ){
					alert("발행일자를 선택하세요.");
					return;
				}
				
				// 2. 섹션값 수정여부 체크
				if( !isDataGridUpdated(datagrid2) ){
					alert("저장할 내역이 없습니다.");
					return;
				}
				
				// 3. 섹션항목 체크 (datagrid2)				
				var	medi_cd	=	model.getValue("/root/reqData/searchData/medi_cd");
				if(medi_cd	==	"110"){
					if(!commGridReqCheck("datagrid2")){
						return;
					}
					if(!checkSection(datagrid2, medi_cd)){
						return;
					}
				}
				else{
					for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
						if(datagrid2.rowStatus(i)	!=	0){
							var	bgn_side	=	datagrid2.valueMatrix(i, datagrid2.colRef("bgn_side"));
							var	end_side	=	datagrid2.valueMatrix(i, datagrid2.colRef("end_side"));
							
							if(bgn_side	==	""	||	end_side	==	""){
								alert("시작면과 끝면은 필수입력 사항입니다.");
								return;
							}
							//20170728 판구분 추가로 체크추가함
							var edt_clsf = datagrid2.valueMatrix(i,datagrid2.colRef("edt_clsf"));
							if(edt_clsf == ""){
								alert("판구분은 필수입력 사항입니다.");
								return;
							}
						}
					}
				}

				// 4. 배정광고 체크
				var msg			=	"";
				var preng_cnt	= 	Number(model.getValue("/root/resData/gridData2/preng_cnt"));
				if( preng_cnt > 0 ){
					msg	+=	"해당일자로 배정된 광고가 존재합니다!"
					msg	+=	"\n\n";
					msg	+=	"진행하실 경우 기존 배정된 광고는 모두 대기광고로 전환됩니다.";	
					msg	+=	"\n\n";
				}
				
				// 5. 내역저장 - AD_RES_1040A
				if(windowConfirm(msg + issu_dt +" 섹션별 면수내역을 저장하시겠습니까?")){
					
					var multiUpdateData = datagrid2.getUpdateData();
					
					model.makeNode("/root/reqData/searchData/multiUpdateData");
					model.setValue("/root/reqData/searchData/multiUpdateData", multiUpdateData);
					
					model.send("ad_res_1040_a");
					if(submit_completed()){
						loadData();
					}
						
//					if(submit_completed()){
//						model.send("ad_res_1000_m");
//						if(submit_completed()){
//						model.send("ad_res_1010_s");
//						}
//					}
				}
				
				
				]]>
			</script>
		</button>
		<button id="button12" class="btn03" crud="A" style="left:610px; top:40px; width:63px; height:21px; ">
			<caption>면수마감</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				var issu_dt = model.getValue("/root/reqData/searchData/issu_dt");
				
				if(issu_dt == ""){
					window.alert("발행일자를 선택하세요.");
					return;
				}
				if(datagrid2.rows <= datagrid2.fixedRows){
					alert("해당일자의 면수가 없습니다.");
					return;
				}
				if(window.alert("면수마감을 하시겠습니까?", "확인", 1) == 1){
					model.setValue("/root/reqData/searchData/pcnt_clos_yn", "Y");									
					model.send("ad_res_1050_u");				
									
					if(submit_completed()){
						model.send("ad_res_1000_m");					
						resetIssuSize();
					}			
				}
				
				]]>
			</script>
		</button>
		<caption id="caption2" class="list_cap01" style="left:202px; top:71px; width:85px; height:28px; ">매체구분</caption>
		<select1 id="combo2" ref="/root/reqData/searchData/medi_cd" navindex="2" appearance="minimal" style="left:290px; top:76px; width:150px; height:18px; ">
			<choices>
				<item>
					<label>110 본지</label>
					<value>110</value>
				</item>
				<item>
					<label>120 위크앤드</label>
					<value>120</value>
				</item>
				<item>
					<label>130 소년</label>
					<value>130</value>
				</item>
				<item>
					<label>150 SPS</label>
					<value>150</value>
				</item>
				<item>
					<label>190 행복플러스</label>
					<value>190</value>
				</item>
			</choices>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[					
						var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");		
						if(medi_cd == "110"){
							model.toggle("case1");							
							loadData();							
							model.send("ad_res_1020_l");
						}
						else {
							
							model.toggle("case2");							
							loadData();							
							model.send("ad_res_1025_l");							
						}
					]]>
			</script>
		</select1>
		<button id="button5" class="btn05" crud="R" style="left:767px; top:40px; width:110px; height:21px; ">
			<caption>면별광고단수입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				var row = datagrid1.row;
				var col = datagrid1.col;
			
				if(col%4 == 1) col = col-1;
				
				var temp_dt  = datagrid1.valueMatrix(row, col);
				if(temp_dt == ""){
					alert("발행일자를 선택하세요.");
					return;
				}
				
				if(temp_dt != '0' && temp_dt < 10) temp_dt = "0" + temp_dt;
				
				var issu_dt = model.getValue("/root/reqData/searchData/issu_yymm") + temp_dt;
					
				model.property(KEY_ISSU_DT) = issu_dt;

				viewer("mainFrame").window.javaScript.onLoadPage2("AD_RES_1100");
					
				]]>
			</script>
		</button>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData1/record" class="nobg" caption="일^일^일^일^월^월^월^월^화^화^화^화^수^수^수^수^목^목^목^목^금^금^금^금^토^토^토^토" colsep="^" colwidth="35, 35, 14, 13, 35, 35, 17, 14, 35, 35, 14, 11, 35, 35, 14, 12, 35, 35, 12, 13, 35, 35, 15, 16, 35, 35, 20, 18" dataheight="30" defaultrows="6" mergecellsfixedcols="byrowrec" mergecellsfixedrows="bycolrec" rowheight="30" rowsep="|" selectionmode="free" style="left:10px; top:150px; width:490px; height:212px; ">
			<col ref="sun"/>
			<col ref="sun_cnt" style="text-align:center; "/>
			<col ref="sun_pcnt_clos_yn" visibility="hidden"/>
			<col ref="sun_clos_yn" visibility="hidden"/>
			<col ref="mon"/>
			<col ref="mon_cnt" style="text-align:center; "/>
			<col ref="mon_pcnt_clos_yn" visibility="hidden"/>
			<col ref="mon_clos_yn" visibility="hidden"/>
			<col ref="tue"/>
			<col ref="tue_cnt" style="text-align:center; "/>
			<col ref="tue_pcnt_clos_yn" visibility="hidden"/>
			<col ref="tue_clos_yn" visibility="hidden"/>
			<col ref="wed"/>
			<col ref="wed_cnt" style="text-align:center; "/>
			<col ref="wed_pcnt_clos_yn" visibility="hidden"/>
			<col ref="wed_clos_yn" visibility="hidden"/>
			<col ref="thr"/>
			<col ref="thr_cnt" style="text-align:center; "/>
			<col ref="thr_pcnt_clos_yn" visibility="hidden"/>
			<col ref="thr_clos_yn" visibility="hidden"/>
			<col ref="fri"/>
			<col ref="fri_cnt" style="text-align:center; "/>
			<col ref="fri_pcnt_clos_yn" visibility="hidden"/>
			<col ref="fri_clos_yn" visibility="hidden"/>
			<col ref="sat"/>
			<col ref="sat_cnt" style="text-align:center; "/>
			<col ref="sat_pcnt_clos_yn" visibility="hidden"/>
			<col ref="sat_clos_yn" visibility="hidden"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[				
					
					var row = datagrid1.mouseRow;
					var col = datagrid1.mouseCol;
				
					if(col%4 == 1) col = col-1;
					
					var temp_dt  = datagrid1.valueMatrix(row, col);
					if(temp_dt != '0' && temp_dt < 10) temp_dt = "0" + temp_dt;
					
					var issu_dt = model.getValue("/root/reqData/searchData/issu_yymm") + temp_dt;
					
					model.makeNode("/root/reqData/searchData/issu_dt");
					model.setValue("/root/reqData/searchData/issu_dt", issu_dt);					
				
					model.send("ad_res_1010_s");

					if(submit_completed()){
						
						for(var i=datagrid2.fixedRows;i<datagrid2.rows; i++){
							var sect_clas_cd = model1.getValue("/root/resData/gridData2/record["+i+"]/sect_clas_cd");
							datagrid2.cellComboNodeset(i, 2) = "/root/initData/comboSet/sect_nm_cd/item[pcode='" + sect_clas_cd + "']";
						}
/*						
						datagrid2.colDisabled (datagrid2.colRef("sect_clas_cd")) = true;
						datagrid2.colDisabled (datagrid2.colRef("sect_nm_cd"))   = true;
*/						
					}
					
				]]>
			</script>
		</datagrid>
		<caption id="subtitle" class="tit02" style="left:10px; top:129px; width:130px; height:20px; ">월별발행 면수내역</caption>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData2/record" caption="분류^섹션명^판구분^섹션^시작^끝^면수^부수^T/B^pre_sect_clas_cd^pre_sect_nm_cd" colsep="#" colwidth="90, 100, 80, 30, 30, 30, 35, 60, 25, 100, 100" mergecellsfixedcols="byrowrec" mergecellsfixedrows="bycolrec" rowheader="update" rowheight="30" rowsep="|" selectionmode="byrow" style="left:505px; top:150px; width:433px; height:212px; ">
			<col class="req" ref="sect_clas_cd" type="combo" caption="분류" style="text-align:left; word-wrap:none; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/sect_clsf_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col class="req" ref="sect_nm_cd" type="combo" caption="섹션명" style="text-align:left; word-wrap:none; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/sect_nm_cd/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col class="req" ref="edt_clsf" type="combo" caption="판구분명" style="text-align:left; word-wrap:none; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/edt_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col class="req" imemode="alpha" ref="sect_cd" type="input" caption="섹션"/>
			<col class="req" ref="bgn_side" type="input" caption="시작"/>
			<col class="req" ref="end_side" type="input" caption="끝"/>
			<col ref="issu_size"/>
			<col ref="issu_cnt" type="input" format="#,###" style="text-align:right; "/>
			<col checkvalue="Y,N" ref="tabl_clsf" type="checkbox"/>
			<col ref="pre_sect_clas_cd" visibility="hidden"/>
			<col ref="pre_sect_nm_cd" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var row = datagrid2.row;
					var col = datagrid2.col;
					
					
					if(col == datagrid2.colRef("bgn_side") || col == datagrid2.colRef("end_side")){ 
					//면수내역의 시작,끝이 변할 경우..면수 자동계산

						var bgn_side = Number(datagrid2.valueMatrix(row, datagrid2.colRef("bgn_side")));
						var end_side = Number(datagrid2.valueMatrix(row, datagrid2.colRef("end_side")));		
									
						var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");
						if(medi_cd == "110"){									
							if(col == datagrid2.colRef("bgn_side")){// 끝이 변할 경우에...4배수만 가능하게
								if(bgn_side % 4 != 1){
									alert("시작면수는 4의 배수에 1이 큰수가 되어야 합니다.\n(ex) 1, 5, 9...");
									datagrid2.valueMatrix(row, col) = "";
									bgn_side = 0;
									return;
								}
							}	
							if(col == datagrid2.colRef("end_side")){// 끝이 변할 경우에...4배수만 가능하게
								if(end_side % 4 != 0){
									alert("면수는 4의 배수가 되어야 합니다.");
									datagrid2.valueMatrix(row, col) = "";
									end_side = 0;
									return;
								}
							}
						}
						
						datagrid2.valueMatrix(row, datagrid2.colRef("issu_size")) = end_side - bgn_side + 1;
					}
					else if(datagrid2.col == datagrid2.colRef("sect_cd")){
						
						var sect_cd	=	datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("sect_cd"));
						sect_cd	=	sect_cd.toUpperCase();
						datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("sect_cd")) = sect_cd; 
					}
					
					datagrid2.refresh();
					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[

					var row = datagrid2.row;
					var col = datagrid2.col;
					
					var sect_clas_cd = datagrid2.valueMatrix(row,col);
					
					if(col == 1){  
						datagrid2.cellComboNodeset(row, col+1) = "/root/initData/comboSet/sect_nm_cd/item[pcode='" + sect_clas_cd + "']";
					}
					
				]]>
			</script>
		</datagrid>
		<caption id="caption1" class="tit02" style="left:505px; top:129px; width:130px; height:20px; ">섹션별 면수내역</caption>
		<switch id="switch1" style="left:10px; top:392px; width:926px; height:253px; ">
			<case id="case1" selected="true">
				<datagrid id="datagrid4" nodeset="/root/resData/gridData3/record" caption="wkdy^요일^총면수^분류1^섹션명1^섹션^시작^끝^분류2^섹션명2^섹션^시작^끝^분류3^섹션명3^섹션^시작^끝^분류4^섹션명4^섹션^시작^끝^분류5^섹션명5^섹션^시작^끝" colsep="#" colwidth="53, 35, 45, 90, 110, 35, 35, 35, 90, 110, 35, 35, 35, 90, 110, 35, 35, 35, 90, 110, 35, 35, 35, 90, 110, 35, 35, 35" mergecellsfixedcols="byrowrec" mergecellsfixedrows="bycolrec" rowheader="update" rowheight="30" rowsep="|" style="left:5px; top:5px; width:916px; height:205px; ">
					<col ref="wkdy" visibility="hidden"/>
					<col ref="wkdy_nm"/>
					<col ref="issu_size"/>
					<col ref="sect_clas_cd1" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/sect_clsf_cd1/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col ref="sect_nm_cd1" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/sect_nm_cd1/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col imemode="disabled" ref="sect_cd1" type="input" _chartype="upper"/>
					<col ref="bgn_side1" type="input" format="#,###"/>
					<col ref="end_side1" type="input" format="#,###"/>
					<col ref="sect_clas_cd2" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/sect_clsf_cd2/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col ref="sect_nm_cd2" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/sect_nm_cd2/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col imemode="disabled" ref="sect_cd2" type="input" _chartype="upper"/>
					<col ref="bgn_side2" type="input" format="#,###"/>
					<col ref="end_side2" type="input" format="#,###"/>
					<col ref="sect_clas_cd3" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/sect_clsf_cd3/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col ref="sect_nm_cd3" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/sect_nm_cd3/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col imemode="disabled" ref="sect_cd3" type="input"/>
					<col ref="bgn_side3" type="input" format="#,###"/>
					<col ref="end_side3" type="input" format="#,###"/>
					<col ref="sect_clas_cd4" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/sect_clsf_cd4/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col ref="sect_nm_cd4" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/sect_nm_cd4/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col imemode="disabled" ref="sect_cd4" type="input"/>
					<col ref="bgn_side4" type="input" format="#,###"/>
					<col ref="end_side4" type="input" format="#,###"/>
					<col ref="sect_clas_cd5" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/sect_clsf_cd5/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col ref="sect_nm_cd5" type="combo" style="text-align:left; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/sect_nm_cd5/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</col>
					<col imemode="disabled" ref="sect_cd5" type="input"/>
					<col ref="bgn_side5" type="input" format="#,###"/>
					<col ref="end_side5" type="input" format="#,###"/>
					<script type="javascript" ev:event="xforms-select">
						<![CDATA[
							
							var row = datagrid4.row;
							var col = datagrid4.col;
							
							var sect_clas_cd = datagrid4.valueMatrix(row,col);							
							
							if(col == 4){
								datagrid4.cellComboNodeset(row, col+1) = "/root/initData/comboSet/sect_nm_cd1/item[pcode='" + sect_clas_cd + "']";								 							
							}else if(col == 9){
								datagrid4.cellComboNodeset(row, col+1) = "/root/initData/comboSet/sect_nm_cd2/item[pcode='" + sect_clas_cd + "']";
							}else if(col == 14){ 
								datagrid4.cellComboNodeset(row, col+1) = "/root/initData/comboSet/sect_nm_cd3/item[pcode='" + sect_clas_cd + "']";
							}else if(col == 19){
								datagrid4.cellComboNodeset(row, col+1) = "/root/initData/comboSet/sect_nm_cd4/item[pcode='" + sect_clas_cd + "']";
							}else if(col == 24){ 
								datagrid4.cellComboNodeset(row, col+1) = "/root/initData/comboSet/sect_nm_cd5/item[pcode='" + sect_clas_cd + "']";
							}
							
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						
						var row		= 	datagrid4.row;
						var col		=	datagrid4.col;
							
						if(datagrid4.col == datagrid4.colRef("bgn_side1") ||
						   datagrid4.col == datagrid4.colRef("bgn_side2") ||						   
						   datagrid4.col == datagrid4.colRef("bgn_side3") ||						   
						   datagrid4.col == datagrid4.colRef("bgn_side4") ||						   
						   datagrid4.col == datagrid4.colRef("bgn_side5")
						){							
							var bgn_side = 	0;
							
							if(datagrid4.col == datagrid4.colRef("bgn_side1")){
								bgn_side = Number(datagrid4.valueMatrix(row, datagrid4.colRef("bgn_side1")));
							}
							if(datagrid4.col == datagrid4.colRef("bgn_side2")){
								bgn_side = Number(datagrid4.valueMatrix(row, datagrid4.colRef("bgn_side2")));
							}
							if(datagrid4.col == datagrid4.colRef("bgn_side3")){
								bgn_side = Number(datagrid4.valueMatrix(row, datagrid4.colRef("bgn_side3")));
							}
							if(datagrid4.col == datagrid4.colRef("bgn_side4")){
								bgn_side = Number(datagrid4.valueMatrix(row, datagrid4.colRef("bgn_side4")));
							}
							if(datagrid4.col == datagrid4.colRef("bgn_side5")){
								bgn_side = Number(datagrid4.valueMatrix(row, datagrid4.colRef("bgn_side5")));
							}
							
							if(bgn_side % 4 != 1){
								alert("시작면수는 4의 배수에 1이 큰수가 되어야 합니다.\n(ex) 1, 5, 9...");
								datagrid4.valueMatrix(row, col) = "";
								bgn_side = 0;
								return;
							}
						}			

						if(datagrid4.col == datagrid4.colRef("end_side1") ||
						   datagrid4.col == datagrid4.colRef("end_side2") ||						   
						   datagrid4.col == datagrid4.colRef("end_side3") ||						   
						   datagrid4.col == datagrid4.colRef("end_side4") ||						   
						   datagrid4.col == datagrid4.colRef("end_side5")
						){							
							var end_side = 	0;
							
							if(datagrid4.col == datagrid4.colRef("end_side1")){
								end_side = Number(datagrid4.valueMatrix(row, datagrid4.colRef("end_side1")));
							}
							if(datagrid4.col == datagrid4.colRef("end_side2")){
								end_side = Number(datagrid4.valueMatrix(row, datagrid4.colRef("end_side2")));
							}
							if(datagrid4.col == datagrid4.colRef("end_side3")){
								end_side = Number(datagrid4.valueMatrix(row, datagrid4.colRef("end_side3")));
							}
							if(datagrid4.col == datagrid4.colRef("end_side4")){
								end_side = Number(datagrid4.valueMatrix(row, datagrid4.colRef("end_side4")));
							}
							if(datagrid4.col == datagrid4.colRef("end_side5")){
								end_side = Number(datagrid4.valueMatrix(row, datagrid4.colRef("end_side5")));
							}
							
							if(end_side % 4 != 0){
								alert("면수는 4의 배수가 되어야 합니다.");
								datagrid4.valueMatrix(row, col) = "";
								end_side = 0;
								return;
							}
						}						
									
/*	섹션코드 대문자로 변환 */
						if(datagrid4.col == datagrid4.colRef("sect_cd1") ||
						   datagrid4.col == datagrid4.colRef("sect_cd2") ||						   
						   datagrid4.col == datagrid4.colRef("sect_cd3") ||						   
						   datagrid4.col == datagrid4.colRef("sect_cd4") ||						   
						   datagrid4.col == datagrid4.colRef("sect_cd5")
						){
							var currentText = datagrid4.valueMatrix(row, col);							
							datagrid4.valueMatrix(row, col) = currentText.toUpperCase();
							datagrid4.refresh();							
						}							
						]]>
					</script>
				</datagrid>
			</case>
			<case id="case2">
				<datagrid id="grid_issu" nodeset="/root/resData/gridData4/record" caption="wkdy^요일^총면수^시작_1^끝_1^시작_2^끝_2^시작_3^끝_3^시작_4^끝_4^시작_5^끝_5" colsep="#" colwidth="23, 70, 70, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50" rowheader="seq" rowheight="30" rowsep="|" style="left:5px; top:5px; width:684px; height:205px; ">
					<col ref="wkdy" visibility="hidden"/>
					<col ref="wkdy_nm"/>
					<col ref="issu_size"/>
					<col ref="bgn_side1" type="input"/>
					<col ref="end_side1" type="input"/>
					<col ref="bgn_side2" type="input"/>
					<col ref="end_side2" type="input"/>
					<col ref="bgn_side3" type="input"/>
					<col ref="end_side3" type="input"/>
					<col ref="bgn_side4" type="input"/>
					<col ref="end_side4" type="input"/>
					<col ref="bgn_side5" type="input"/>
					<col ref="end_side5" type="input"/>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						var row = grid_issu.row;
						var col  = grid_issu.col;
						var bgn_side = "";
						var end_side = "";
						
						if( combo2.value == "150" ){
							bgn_side = 1;
							if( col == grid_issu.colRef("bgn_side1") ){	
								bgn_side = Number( grid_issu.valueMatrix(row, grid_issu.colRef("bgn_side1")) );
							}
							
							if( col == grid_issu.colRef("bgn_side2") ){	
								bgn_side = Number( grid_issu.valueMatrix(row, grid_issu.colRef("bgn_side2")) );
							}
							
							if( col == grid_issu.colRef("bgn_side3") ){	
								bgn_side = Number( grid_issu.valueMatrix(row, grid_issu.colRef("bgn_side3")) );
							}
							
							if( col == grid_issu.colRef("bgn_side4") ){	
								bgn_side = Number( grid_issu.valueMatrix(row, grid_issu.colRef("bgn_side4")) );
							}
							
							if( col == grid_issu.colRef("bgn_side5") ){	
								bgn_side = Number( grid_issu.valueMatrix(row, grid_issu.colRef("bgn_side5")) );
							}
							
							if( bgn_side != 1 ){
								alert("시작면수는 1이 되어야 합니다.");
								grid_issu.valueMatrix(row, col) = "";
								bgn_side = 1;
								return;
							}
						}
						else
						{
							bgn_side = 1;
							end_side = 4;
							if( col == grid_issu.colRef("bgn_side1") ){	
								bgn_side = Number( grid_issu.valueMatrix(row, grid_issu.colRef("bgn_side1")) );
							}
							
							if( col == grid_issu.colRef("bgn_side2") ){	
								bgn_side = Number( grid_issu.valueMatrix(row, grid_issu.colRef("bgn_side2")) );
							}
							
							if( col == grid_issu.colRef("bgn_side3") ){	
								bgn_side = Number( grid_issu.valueMatrix(row, grid_issu.colRef("bgn_side3")) );
							}
							
							if( col == grid_issu.colRef("bgn_side4") ){	
								bgn_side = Number( grid_issu.valueMatrix(row, grid_issu.colRef("bgn_side4")) );
							}
							
							if( col == grid_issu.colRef("bgn_side5") ){	
								bgn_side = Number( grid_issu.valueMatrix(row, grid_issu.colRef("bgn_side5")) );								
							}						
							
							if( col == grid_issu.colRef("end_side1") ){	
								end_side = Number( grid_issu.valueMatrix(row, grid_issu.colRef("end_side1")) );
							}
							
							if( col == grid_issu.colRef("end_side2") ){	
								end_side = Number( grid_issu.valueMatrix(row, grid_issu.colRef("end_side2")) );
							}
							
							if( col == grid_issu.colRef("end_side3") ){	
								end_side = Number( grid_issu.valueMatrix(row, grid_issu.colRef("end_side3")) );
							}
							
							if( col == grid_issu.colRef("end_side4") ){	
								end_side = Number( grid_issu.valueMatrix(row, grid_issu.colRef("end_side4")) );
							}
							
							if( col == grid_issu.colRef("end_side5") ){	
								end_side = Number( grid_issu.valueMatrix(row, grid_issu.colRef("end_side5")) );
							}						

							if( bgn_side%4 != 1 ){
								alert("시작면수는 4의 배수에 1이 큰수가 되어야 합니다.\n(ex) 1, 5, 9...");
								grid_issu.valueMatrix(row,col) = "";
								bgn_side = 1;
								return;
							}
							
							if( end_side%4 != 0 ){
								alert("끝 면수는 4의 배수가 되어야 합니다.");
								grid_issu.valueMatrix(row,col) = "";
								end_side = 4;
								return;
							}
						}

/*			
						var row = grid_issu.row;
						var col = grid_issu.col;					
						
						if( col == 3 || col == 4 ){ //면수내역의 시작,끝이 변할 경우..면수 자동계산	
							var bgn_side = grid_issu.valueMatrix(row, 3);
							var end_side = grid_issu.valueMatrix(row, 4);									
							var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");
							if(medi_cd == "110"){										
								if(col == 3){// 끝이 변할 경우에...4배수만 가능하게
									if(bgn_side % 4 != 1){
										alert("시작면수는 4의 배수에 1이 큰수가 되어야 합니다.\n(ex) 1, 5, 9...");
										return;
									}
								}	
								if(col == 4){// 끝이 변할 경우에...4배수만 가능하게
									if(end_side % 4 != 0){
										alert("면수는 4의 배수가 되어야 합니다.");
										return;
									}
								}
							}								
							grid_issu.valueMatrix(row,5) = end_side - bgn_side + 1;
							grid_issu.refresh();
						}		
*/						
						]]>
					</script>
				</datagrid>
			</case>
		</switch>
		<caption id="caption3" class="tit02" style="left:10px; top:369px; width:175px; height:20px; ">발행면 및 면별단수 초기값</caption>
		<input id="inp_issu_yymm" ref="/root/reqData/searchData/issu_yymm" class="req" navindex="1" format="yyyy-mm" caption="발행년월" style="left:98px; top:76px; width:55px; height:18px; text-align:left; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				loadData();		
				]]>
			</script>
		</input>
		<button id="button2" class="btn03" crud="C" style="left:870px; top:369px; width:66px; height:21px; ">
			<caption>초기값변경</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					
					if(windowConfirm("초기값을 변경하시겠습니까?")){
						
						var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");
						var multiUpdateData = "";
						if(medi_cd == "110"){
							
							for(var i=datagrid4.fixedRows;i<datagrid4.rows;i++){
								for(var j=datagrid4.fixedCols;j<datagrid4.cols;j += 5){
									var s_sect_cd = datagrid4.valueMatrix(i, j);
									for(var k=datagrid4.fixedCols;k<datagrid4.cols;k+= 5){
										var t_sect_cd = datagrid4.valueMatrix(i,k);
										if(j != k){
											if(s_sect_cd != "" && t_sect_cd != "" && s_sect_cd == t_sect_cd){
												var wkdy_nm = datagrid4.valueMatrix(i,datagrid4.colRef("wkdy_nm"));
												alert(wkdy_nm + "요일에 같은 섹션코드가 있습니다. 초기값을 변경할 수 없습니다.");
												return;
											}
										}
									}
								}
							}
							
							multiUpdateData = datagrid4.getUpdateData();
						
							model.setValue("/root/reqData/multiUpdateData", multiUpdateData);							
							model.send("ad_res_1060_u");	
							if(submit_completed()){
								model.send("ad_res_1020_l");			
							}
										
						}
						else{	
							multiUpdateData = grid_issu.getUpdateData();
							model.setValue("/root/reqData/multiUpdateData", multiUpdateData);							
							model.send("ad_res_1065_u");		
//							if(submit_completed()){
								model.send("ad_res_1025_l");			
//							}					
						}
						loadData();
					}						
				]]>
			</script>
		</button>
		<button id="button6" class="btn04" crud="A" style="left:676px; top:40px; width:88px; height:21px; ">
			<caption>면수마감취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				var issu_dt = model.getValue("/root/reqData/searchData/issu_dt");
				
				if(issu_dt == ""){
					window.alert("발행일자를 선택하세요.");
					return;
				}
				
				if(window.alert("면수마감을 취소하시겠습니까?", "확인", 1) == 1){
					model.setValue("/root/reqData/searchData/pcnt_clos_yn", "N");									
					model.send("ad_res_1050_u");								
									
					if(submit_completed()){
						model.send("ad_res_1000_m");
						resetIssuSize();					
					}			
				}
				
				]]>
			</script>
		</button>
		<button id="btnClose" class="btn02" style="left:883px; top:40px; width:50px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
								
				]]>
			</script>
		</button>
		<button id="btnG2" class="btn_grid03" crud="C" style="left:775px; top:130px; width:53px; height:17px; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				addRow(datagrid2);
				]]>
			</script>
		</button>
		<button id="button13" class="btn_grid03" crud="C" style="left:835px; top:130px; width:53px; height:17px; ">
			<caption>행삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				deleteRow(datagrid2);
				]]>
			</script>
		</button>
		<button id="button7" class="btn_grid02" crud="C" style="left:893px; top:130px; width:43px; height:17px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				cancelRow(datagrid2);
				
				]]>
			</script>
		</button>
		<output id="output1" ref="/root/resData/gridData2/preng_cnt" visibility="hidden" style="left:655px; top:130px; width:100px; height:18px; "/>
		<button id="button22" style="left:157px; top:76px; width:18px; height:18px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
			<caption>+</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				var issu_yymm = dateAdd("m", +1, model.getValue("/root/reqData/searchData/issu_yymm") + "01");
				model.setValue("/root/reqData/searchData/issu_yymm", issu_yymm.substring(0,6));
				loadData();
				
				]]>
			</script>
		</button>
		<button id="button23" style="left:177px; top:76px; width:18px; height:18px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
			<caption>-</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				var issu_yymm = dateAdd("m", -1, model.getValue("/root/reqData/searchData/issu_yymm") + "01");
				model.setValue("/root/reqData/searchData/issu_yymm", issu_yymm.substring(0,6));
				loadData();
				
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
