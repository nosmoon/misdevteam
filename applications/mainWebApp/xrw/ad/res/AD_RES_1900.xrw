<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="/css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<pageInfo/>
						<cap_fee_rate>대행료율</cap_fee_rate>
						<cap_fee>대행료</cap_fee>
						<cap_fee_rate2>대행료율</cap_fee_rate2>
						<cap_fee2>대행료</cap_fee2>
					</initData>
					<codeData>
						<medi_clsf>
							<item>
								<label/>
								<value/>
							</item>
						</medi_clsf>
						<slcrg_pers>
							<item>
								<label/>
								<value/>
							</item>
						</slcrg_pers>
						<medi_clsf2>
							<item>
								<label/>
								<value/>
							</item>
						</medi_clsf2>
						<slcrg_pers2>
							<item>
								<label/>
								<value/>
							</item>
						</slcrg_pers2>
					</codeData>
					<reqData>
						<searchData>
							<medi_cd/>
							<frdt/>
							<todt/>
							<slcrg_pers/>
							<slcrg_pers_nm/>
							<dlco_no/>
							<dlco_nm/>
						</searchData>
						<multiUpdateData/>
					</reqData>
					<resData>
						<gridData>
							<curlist1>
								<record>
									<preng_occr_dt/>
									<dlco_nm/>
									<advt_fee/>
									<vat/>
									<agn_nm/>
									<coms_rate/>
									<coms/>
									<slcrg_pers_nm/>
									<medi_cd/>
									<preng_occr_seq/>
									<dlco_no/>
									<agn/>
									<slcrg_pers/>
									<coms_vat/>
								</record>
							</curlist1>
							<curlist2>
								<record>
									<preng_occr_dt/>
									<dlco_nm/>
									<advt_fee/>
									<vat/>
									<coms_rate/>
									<coms/>
									<pubc_side/>
									<dn/>
									<cm/>
									<agn_nm/>
									<slcrg_pers_nm/>
									<medi_cd/>
									<preng_occr_seq/>
									<dlco_no/>
									<agn/>
									<slcrg_pers/>
									<coms_vat/>
								</record>
							</curlist2>
							<curlist3>
								<record>
									<sun/>
									<sun_yn/>
									<mon/>
									<mon_yn/>
									<tue/>
									<tue_yn/>
									<wed/>
									<wed_yn/>
									<thr/>
									<thr_yn/>
									<fri/>
									<fri_yn/>
									<sat/>
									<sat_yn/>
								</record>
							</curlist3>
						</gridData>
						<resForm>
							<medi_cd>170</medi_cd>
							<frdt/>
							<todt/>
							<dlco_no/>
							<dlco_nm/>
							<advt_fee/>
							<vat/>
							<rtax_yn/>
							<fee_rate/>
							<fee/>
							<slcrg_pers/>
							<slcrg_pers_nm/>
							<mchrg_pers/>
							<mchrg_pers_nm/>
							<hndl_clsf>1</hndl_clsf>
							<agn/>
							<agn_nm/>
							<remk/>
							<fee_vat/>
						</resForm>
						<resForm2>
							<medi_cd/>
							<frdt/>
							<todt/>
							<day1/>
							<day2/>
							<day3/>
							<day4/>
							<day5/>
							<day6/>
							<day7/>
							<dlco_no/>
							<dlco_nm/>
							<advt_fee/>
							<vat/>
							<fee_rate/>
							<sect/>
							<dn/>
							<cm/>
							<hndl_clsf>1</hndl_clsf>
							<agn/>
							<agn_nm/>
							<slcrg_pers/>
							<mchrg_pers/>
							<remk/>
							<slcrg_pers_nm/>
							<mchrg_pers_nm/>
							<fee/>
							<fee_vat/>
							<rtax_yn/>
							<yymm/>
							<multiUpdateData/>
						</resForm2>
					</resData>
					<temp2Data>
						<flag/>
					</temp2Data>
					<msgData/>
					<tempDate/>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				
				var currentmt = getCurrentMonth();
				var currentdt = getCurrentDate();
							
				model.setValue("/root/reqData/searchData/frdt",currentmt.substring(0,4)+"01");	//게재기간
				model.setValue("/root/reqData/searchData/todt",currentmt);	                      //게재기간
				
				model.setValue("/root/resData/resForm2/frdt", dateAdd("d", 1, getCurrentDate()));	//기사중광고 계약기간	
				model.setValue("/root/resData/resForm2/todt", dateAdd("d", 1, getCurrentDate()));	//기사중광고 계약기간
			 				 				
				model.send("ad_res_1900_m");	
				model.copyNode("/root/codeData/medi_clsf", "/root/tempData/medi_clsf");
		//		model.copyNode("/root/codeData/slcrg_pers", "/root/tempData/slcrg_pers");
				model.copyNode("/root/codeData/medi_clsf2", "/root/tempData/medi_clsf2");
//				model.copyNode("/root/codeData/slcrg_pers2", "/root/tempData/slcrg_pers2");

				model.removeNodeset("/root/resData/gridData/curlist1/record");
				model.removeNodeset("/root/resData/gridData/curlist2/record");
				
				model.refresh();
				
				model.setValue("/root/resData/resForm2/yymm", getCurrentMonth());

				loadCalendar();
					
				initPage();		
				
				switch1.selectedIndex = 0;
					
				]]>
			</script>
			<submission id="ad_res_1900_m" action="/ad/res/1900" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="ad_res_1910_l" action="/ad/res/1910" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/resData/gridData/curlist1"/>
			<submission id="ad_res_1911_l" action="/ad/res/1911" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/resData/gridData/curlist2"/>
			<submission id="ad_res_1920_i" action="/ad/res/1920" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm" resultref="/root/msgData"/>
			<submission id="ad_res_1921_i" action="/ad/res/1921" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm2" resultref="/root/msgData"/>
			<submission id="ad_res_1930_a" action="/ad/res/1930" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/msgData"/>
			<submission id="ad_res_1940_l" action="/ad/res/1940" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resForm2" resultref="/root/resData/gridData/curlist3"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
			
			function initPage(){
					cb_medi_cd.select(0);
			}	
			
			function setDlcoInfo(dlco_no, dlco_nm){
				
				var gnr_advcs_yn = model.getValue("/root/reqData/fwdData/gnr_advcs_yn");  //광고주 
				var agn_yn       = model.getValue("/root/reqData/fwdData/agn_yn");	//대행사 
				
				var iSel = switch1.selectedIndex; //탭 인덱스
				
				if(gnr_advcs_yn == "Y"){	
					if(model.property("pop_seq") == "1"){
						model.setValue("/root/reqData/searchData/dlco_no", dlco_no);
						model.setValue("/root/reqData/searchData/dlco_nm", dlco_nm);					
						inp_dlco_no.refresh();
						inp_dlco_nm.refresh();
					}
						
					if(iSel == "0"){ //첫번째 탭의 광고주
						if(model.property("pop_seq") == "2"){
							datagrid4.valueMatrix(datagrid4.row, 3) = dlco_no;
							datagrid4.valueMatrix(datagrid4.row, 4) = dlco_nm;
							datagrid4.addStatus(datagrid4.row, "update");  //상태 변경
						}else if(model.property("pop_seq") == "4"){
							model.setValue("/root/resData/resForm/dlco_no", dlco_no);
							model.setValue("/root/resData/resForm/dlco_nm", dlco_nm);					
							inp_dlco_no2.refresh();
							inp_dlco_nm2.refresh();
						}
					}else if(iSel == "1"){ //두번째 탭의 광고주
						 if(model.property("pop_seq") == "2"){
							datagrid2.valueMatrix(datagrid2.row, 3) = dlco_no;
							datagrid2.valueMatrix(datagrid2.row, 4) = dlco_nm;
							datagrid2.addStatus(datagrid2.row, "update");  //상태 변경
						}else if(model.property("pop_seq") == "4"){
							model.setValue("/root/resData/resForm2/dlco_no", dlco_no);
							model.setValue("/root/resData/resForm2/dlco_nm", dlco_nm);					
							inp_dlco_no3.refresh();
							inp_dlco_nm3.refresh();
						}
					}						
				}else if(agn_yn == "Y"){
					if(iSel == "0"){ //첫번째 탭의 대생사 
						if(model.property("pop_seq") == "3"){
							datagrid4.valueMatrix(datagrid4.row, datagrid4.colRef("agn")) = dlco_no;
							datagrid4.valueMatrix(datagrid4.row, datagrid4.colRef("agn_nm")) = dlco_nm;
							datagrid4.addStatus(datagrid4.row, "update");  //상태 변경
//							datagrid4.refresh();
						}else if(model.property("pop_seq") == "5"){
							model.setValue("/root/resData/resForm/agn", dlco_no);
							model.setValue("/root/resData/resForm/agn_nm", dlco_nm);					
							inp_agn_no.refresh();
							inp_agn_nm.refresh();
						}
					}else if(iSel == "1"){//두번째 탭의 대생사 
						if(model.property("pop_seq") == "3"){
							datagrid2.valueMatrix(datagrid2.row, 11) = dlco_no;
							datagrid2.valueMatrix(datagrid2.row, 12) = dlco_nm;
							datagrid2.addStatus(datagrid2.row, "update");  //상태 변경
						}else if(model.property("pop_seq") == "5"){
							model.setValue("/root/resData/resForm2/agn", dlco_no);
							model.setValue("/root/resData/resForm2/agn_nm", dlco_nm);					
							inp_agn_no2.refresh();
							inp_agn_nm2.refresh();
						}	
					}				
				}				
			}	
			function loadList(){

				var iSel = switch1.selectedIndex;
				
				if(iSel == 0){
					model1.send("ad_res_1910_l");							
				}else if(iSel == 1){
					model.send("ad_res_1911_l");
				}				
			}
			
			function setSlcrgPers2(emp_no, emp_nm){	
				model.setValue(_emp_no_ref, emp_no);
				model.setValue(_emp_nm_ref, emp_nm);	
			}				

			function setChrgInfo(){
				if(model.property("pop_chrg") ==  "1"){
					modelSendNoMake("ad_co_9007_s", "/ad/common/9007", "/root/resData/resForm", "/root/tempData");	
					if(submit_completed()){
                        	model.setValue("/root/resData/resForm/slcrg_pers", 		model.getValue("/root/tempData/slcrg_pers"));
                        	model.setValue("/root/resData/resForm/slcrg_pers_nm", 	model.getValue("/root/tempData/slcrg_pers_nm"));
                        	model.setValue("/root/resData/resForm/mchrg_pers", 		model.getValue("/root/tempData/mchrg_pers"));
                        	model.setValue("/root/resData/resForm/mchrg_pers_nm", 	model.getValue("/root/tempData/mchrg_pers_nm"));
                        	inp_slcrg_pers.refresh();
                        	inp_slcrg_pers_nm.refresh();
                        	inp_mchrg_pers.refresh();
                        	inp_mchrg_pers_nm.refresh();
					}
				}else if(model.property("pop_chrg") ==  "2"){
					modelSendNoMake("ad_co_9007_s", "/ad/common/9007", "/root/resData/resForm2", "/root/tempData");	
					if(submit_completed()){
                        	model.setValue("/root/resData/resForm2/slcrg_pers", 		model.getValue("/root/tempData/slcrg_pers"));
                        	model.setValue("/root/resData/resForm2/slcrg_pers_nm", 	model.getValue("/root/tempData/slcrg_pers_nm"));
                        	model.setValue("/root/resData/resForm2/mchrg_pers", 		model.getValue("/root/tempData/mchrg_pers"));
                        	model.setValue("/root/resData/resForm2/mchrg_pers_nm", 	model.getValue("/root/tempData/mchrg_pers_nm"));
                        	inp_slcrg_pers2.refresh();
                        	inp_slcrg_pers_nm2.refresh();
                        	inp_mchrg_pers2.refresh();
                        	inp_mchrg_pers_nm2.refresh();
					}
				}
			}			
			function loadCalendar(){
				var i, j;
					
				for( i=datagrid3.fixedRows; i<datagrid3.rows; i++ ){					
					for( j=datagrid3.fixedCols; j<datagrid3.cols; j++ ){
						datagrid3.isReadOnly(i,j) = false;
					}
				}
				
				model.send("ad_res_1940_l");
								
				for( i=datagrid3.fixedRows; i<datagrid3.rows; i++){
					
					for( j=datagrid3.fixedCols; j<datagrid3.cols; j++){
						if(j%2 == 1){
							var dd = datagrid3.valueMatrix(i, j-1);
							if(dd != ""){
								var bgcolor = "#FFFFCC";
								if(j-1 == datagrid3.colRef("sun"))		bgcolor = "#FFCC00";
								else if(j-1==datagrid3.colRef("sat"))	bgcolor = "#CCFFFF";
								
								datagrid3.cellstyle("background-color", i, j-1, i, j-1) = bgcolor;
							}
							else{
								datagrid3.isReadOnly(i,j) = true; 
							}
						}
					}
				}
												
			}
			
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="756" guideline="1,11;1,935;2,60;2,70;2,98;2,105;2,110;2,120;2,142;" style="font-family:굴림; ">
		<switch id="switch1" class="gro_sel" style="left:11px; top:142px; width:927px; height:598px; ">
			<case id="case1" selected="true">
				<datagrid id="datagrid4" nodeset="/root/resData/gridData/curlist1/record" caption="게재일자^광고주^광고료^부가세^취급처^수수료율^수수료^영업담당^MEDI_CD^SEQ^DLCO_NO^AGN^SLCRG_PERS^COMS_VAT" colsep="#" colwidth="80, 190, 100, 100, 120, 100, 100, 90, 30, 30, 35, 35, 46, 10" explorerbar="sort" rowheader="update" rowsep="|" selectionmode="byrow" style="left:5px; top:5px; width:916px; height:434px; ">
					<col ref="preng_occr_dt" format="yyyy-mm-dd"/>
					<col ref="dlco_nm" type="inputbutton" style="text-align:left; word-wrap:none; "/>
					<col ref="advt_fee" type="input" format="#,###" style="text-align:right; "/>
					<col ref="vat" type="input" format="#,###" style="text-align:right; "/>
					<col ref="agn_nm" type="inputbutton" style="text-align:left; word-wrap:none; "/>
					<col ref="coms_rate" type="input" format="99" style="text-align:right; "/>
					<col ref="coms" type="input" format="#,###" style="text-align:right; "/>
					<col ref="slcrg_pers_nm" type="input" style="text-align:left; "/>
					<col ref="medi_cd" visibility="hidden"/>
					<col ref="preng_occr_seq" visibility="hidden"/>
					<col ref="dlco_no" visibility="hidden"/>
					<col ref="agn" visibility="hidden"/>
					<col ref="slcrg_pers" visibility="hidden"/>
					<col ref="coms_vat" visibility="hidden"/>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
					
						var dataIndex = getSelectedRecordIndex(datagrid4);
						if (datagrid4.col == datagrid4.colRef("dlco_nm")){
							model.property("pop_seq") =  "2";
							var dlco_nm   = datagrid4.valueMatrix(datagrid4.row, datagrid4.colRef("dlco_nm"));
							findDlcoNoByNameWithRef("1"
							                       ,dlco_nm
							                       ,"/root/resData/gridData/curlist1/record["+dataIndex+"]/dlco_no"
							                       ,"/root/resData/gridData/curlist1/record["+dataIndex+"]/dlco_nm");				
							                       
						}else if(datagrid4.col == datagrid4.colRef("agn_nm")){
							model.property("pop_seq") =  "3";
							var agn_nm   = datagrid4.valueMatrix(datagrid4.row, datagrid4.colRef("agn_nm"));
							findDlcoNoByNameWithRef("24"
							                       ,agn_nm
							                       ,"/root/resData/gridData/curlist1/record["+dataIndex+"]/agn"
							                       ,"/root/resData/gridData/curlist1/record["+dataIndex+"]/agn_nm");	
						}else if(datagrid4.col == datagrid4.colRef("slcrg_pers_nm")){
							var slcrg_pers_nm = datagrid4.valueMatrix(datagrid4.row, datagrid4.colRef("slcrg_pers_nm"));
							findEmpNoByNameWithRef("setSlcrgPers2", slcrg_pers_nm, "/root/resData/gridData/curlist1/record["+dataIndex+"]/slcrg_pers", "/root/resData/gridData/curlist1/record["+dataIndex+"]/slcrg_pers_nm");
							
							if(submit_completed()){
								if(model.getValue("/root/resData/gridData/curlist1/record["+dataIndex+"]/slcrg_pers") == ""){
									datagrid4.valueMatrix(datagrid4.row, datagrid4.colRef("slcrg_pers_nm")) = "";
								}
							}
							
						}
						datagrid4.refresh();
						]]>
					</script>
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[	
						var dataIndex = getSelectedRecordIndex(datagrid4);
						if (datagrid4.col == datagrid4.colRef("dlco_nm")){	
							var dlco_nm   = datagrid4.valueMatrix(datagrid4.row, datagrid4.colRef("dlco_nm"));				
							model.property("pop_seq") =  "2";							
							showAdvcsSearchPopup("Y", "Y", "", "", "", dlco_nm); 
						}else if(datagrid4.col == datagrid4.colRef("agn_nm")){
							var agn_nm   = datagrid4.valueMatrix(datagrid4.row, datagrid4.colRef("agn_nm"));				
							model.property("pop_seq") =  "3";							
							showAdvcsSearchPopup("", "", "Y", "", "", agn_nm);
						}
						]]>
					</script>
					<script type="javascript" ev:event="DOMFocusOut">
						<![CDATA[
						var dataIndex = getSelectedRecordIndex(datagrid4);
						if(datagrid4.col == datagrid4.colRef("advt_fee")){
							var advt_fee = Number(model.getValue("/root/resData/gridData/curlist1/record["+dataIndex+"]/advt_fee"));
							model.setValue("/root/resData/gridData/curlist1/record["+dataIndex+"]/vat", Math.round(advt_fee/10));
						}else if(datagrid4.col == datagrid4.colRef("coms_rate")){
							var advt_fee 	= Number(model.getValue("/root/resData/gridData/curlist1/record["+dataIndex+"]/advt_fee"));
							var vat 	 		= Number(model.getValue("/root/resData/gridData/curlist1/record["+dataIndex+"]/vat"));
							var coms_rate	= Number(model.getValue("/root/resData/gridData/curlist1/record["+dataIndex+"]/coms_rate"));
							model.setValue("/root/resData/gridData/curlist1/record["+dataIndex+"]/coms", Math.round((advt_fee+vat)*coms_rate/100));
							model.setValue("/root/resData/gridData/curlist1/record["+dataIndex+"]/coms_vat", Math.round(vat*(coms_rate/100)));
						}							
						]]>
					</script>
				</datagrid>
				<group id="group1" style="left:5px; top:461px; width:916px; height:129px; ">
					<caption id="caption50" class="list_cap02" style="left:0px; top:75px; width:916px; height:26px; "/>
					<caption id="caption34" class="list_cap02" style="left:0px; top:50px; width:916px; height:26px; "/>
					<caption id="caption5" class="list_cap02" style="left:0px; top:25px; width:916px; height:26px; "/>
					<caption id="caption8" class="list_cap02" style="left:0px; top:0px; width:916px; height:26px; "/>
					<input id="inp_mchrg_pers" ref="/root/resData/resForm/mchrg_pers" navindex="23" style="left:371px; top:79px; width:70px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							commonSubmission("9005", inp_mchrg_pers.currentText,  inp_mchrg_pers, inp_mchrg_pers_nm);				
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode== "13"){
								commonSubmission("9005", inp_mchrg_pers.currentText,  inp_mchrg_pers, inp_mchrg_pers_nm);	
							}
							]]>
						</script>
					</input>
					<input id="inp_vat" ref="/root/resData/resForm/vat" class="req" navindex="14" format="#,###" caption="부가세" style="left:371px; top:29px; width:100px; height:18px; text-align:right; "/>
					<caption id="caption40" class="list_cap03" style="left:270px; top:75px; width:95px; height:26px; ">관리담당</caption>
					<input id="inp_dlco_nm2" ref="/root/resData/resForm/dlco_nm" class="req" navindex="12" inputtype="button" caption="광고주" style="left:720px; top:4px; width:160px; height:18px; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
							model.property("pop_seq") =  "4";
							model.property("pop_chrg") =  "1";
							showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm2.currentText); 
							setChrgInfo();
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[							
							if(event.keyCode== "13"){
								model.property("pop_seq")  =  "4";
								model.property("pop_chrg") =  "1";
								findDlcoNoByName("1", inp_dlco_nm2.currentText, inp_dlco_no2, inp_dlco_nm2);
								setChrgInfo();
							}							
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[							
							model.property("pop_seq") =  "4";
							model.property("pop_chrg") =  "1";
							findDlcoNoByName("1", inp_dlco_nm2.currentText, inp_dlco_no2, inp_dlco_nm2);
							setChrgInfo();
							]]>
						</script>
					</input>
					<input id="inp_agn_nm" ref="/root/resData/resForm/agn_nm" navindex="18" inputtype="button" caption="대행사" crud="R" style="left:255px; top:54px; width:160px; height:18px; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[						
							var hndl_clsf = model.getValue("/root/resData/resForm/hndl_clsf");
							model.property("pop_seq") =  "5";
							if(hndl_clsf == "2"){
								showAdvcsSearchPopup("", "", "Y", "", "", inp_agn_nm.currentText); 							
							}else{
								showAdvcsSearchPopup("", "", "", "Y", "Y", inp_agn_nm.currentText); 							
							}
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							model.property("pop_seq") =  "5";
							var hndl_clsf = model.getValue("/root/resData/resForm/hndl_clsf");
							
							if(hndl_clsf == "2"){
								findDlcoNoByName("2", inp_agn_nm.currentText, inp_agn_no, inp_agn_nm);
							}else{
								findDlcoNoByName("4", inp_agn_nm.currentText, inp_agn_no, inp_agn_nm);
							}
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode== "13"){
								model.property("pop_seq") =  "5";
								var hndl_clsf = model.getValue("/root/resData/resForm/hndl_clsf");
								
								if(hndl_clsf == "2"){
									findDlcoNoByName("2", inp_agn_nm.currentText, inp_agn_no, inp_agn_nm);
								}else{
									findDlcoNoByName("4", inp_agn_nm.currentText, inp_agn_no, inp_agn_nm);
								}
							}
							]]>
						</script>
					</input>
					<caption id="caption11" class="list_cap03" style="left:0px; top:0px; width:95px; height:26px; ">매체구분</caption>
					<input id="inp_agn_no" ref="/root/resData/resForm/agn" navindex="17" caption="대행사" style="left:195px; top:54px; width:55px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[							
							var agn_no = inp_agn_no.currentText;
							model.setValue("/root/resData/resForm/agn", lpad(agn_no, 8, "0"));
							inp_agn_no.refresh();
						
							commonSubmission("9004", inp_agn_no.currentText,  inp_agn_no, inp_agn_nm);							
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode== "13"){
								var agn_no = inp_agn_no.currentText;
								model.setValue("/root/resData/resForm/agn", lpad(agn_no, 8, "0"));
								inp_agn_no.refresh();
							
								commonSubmission("9004", inp_agn_no.currentText,  inp_agn_no, inp_agn_nm);								
							}
							]]>
						</script>
					</input>
					<caption id="caption13" class="list_cap03" style="left:270px; top:0px; width:95px; height:26px; ">예약기간</caption>
					<select1 id="combo3" ref="/root/resData/resForm/medi_cd" class="req" navindex="8" appearance="minimal" caption="매체구분" style="left:100px; top:4px; width:120px; height:18px; ">
						<choices>
							<item>
								<label>170 아이리더</label>
								<value>170</value>
							</item>
							<item>
								<label>180 모바일뉴스</label>
								<value>180</value>
							</item>
						</choices>
					</select1>
					<caption id="caption24" class="list_cap03" style="left:0px; top:75px; width:95px; height:26px; ">영업담당</caption>
					<caption id="caption14" style="left:445px; top:5px; width:15px; height:17px; ">~</caption>
					<caption id="caption15" class="list_cap02" style="left:0px; top:100px; width:916px; height:26px; "/>
					<caption id="caption16" class="list_cap03" style="left:0px; top:100px; width:149px; height:26px; ">거래처담당 및 기타사항</caption>
					<input id="input3" ref="/root/resData/resForm/remk" navindex="25" style="left:153px; top:104px; width:739px; height:18px; "/>
					<input id="input4" ref="/root/resData/resForm/advt_fee" class="req" navindex="13" format="#,###" caption="월광고료" style="left:100px; top:29px; width:100px; height:18px; text-align:right; ">
						<script type="javascript" ev:event="DOMFocusOut">
							<![CDATA[
							var 	advt_fee = Number(model.getValue("/root/resData/resForm/advt_fee"));	
							model.setValue("/root/resData/resForm/vat", Math.round(advt_fee/10));
							inp_vat.refresh();							
							]]>
						</script>
					</input>
					<input id="input5" ref="/root/resData/resForm/todt" class="req" navindex="10" format="yyyy-mm" caption="계약기간" crud="R" style="left:461px; top:4px; width:70px; height:18px; "/>
					<caption id="caption9" class="list_cap03" style="left:560px; top:0px; width:95px; height:26px; ">광고주</caption>
					<caption id="caption18" class="list_cap03" style="left:0px; top:25px; width:95px; height:26px; ">월광고료</caption>
					<input id="inp_dlco_no2" ref="/root/resData/resForm/dlco_no" class="req" navindex="11" caption="광고주" style="left:660px; top:4px; width:55px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							var dlco_no = inp_dlco_no2.currentText;
							model.setValue("/root/resData/resForm/dlco_no", lpad(dlco_no, 8, "0"));
							inp_dlco_no2.refresh();
							
							model.property("pop_chrg") =  "1";
							commonSubmission("9004",  inp_dlco_no2.currentText,  inp_dlco_no2, inp_dlco_nm2);
							setChrgInfo();
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode== "13"){
								var dlco_no = inp_dlco_no2.currentText;
								model.setValue("/root/resData/resForm/dlco_no", lpad(dlco_no, 8, "0"));
								inp_dlco_no2.refresh();
								
								model.property("pop_chrg") =  "1";
								commonSubmission("9004",  inp_dlco_no2.currentText,  inp_dlco_no2, inp_dlco_nm2);	
								setChrgInfo();							
							}
							]]>
						</script>
					</input>
					<caption id="caption19" class="list_cap03" style="left:270px; top:25px; width:95px; height:26px; ">부가세</caption>
					<input id="input10" ref="/root/resData/resForm/frdt" class="req" navindex="9" format="yyyy-mm" caption="계약기간" crud="R" style="left:371px; top:4px; width:70px; height:18px; "/>
					<input id="inp_slcrg_pers" ref="/root/resData/resForm/slcrg_pers" navindex="21" style="left:100px; top:79px; width:70px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							commonSubmission("9005", inp_slcrg_pers.currentText,  inp_slcrg_pers, inp_slcrg_pers_nm);							
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode== "13"){
								commonSubmission("9005", inp_slcrg_pers.currentText,  inp_slcrg_pers, inp_slcrg_pers_nm);	
							}
							]]>
						</script>
					</input>
					<bool id="bool1" navindex="15" checkvalue="Y,N" ref="/root/resData/resForm/rtax_yn" style="left:495px; top:28px; width:25px; height:20px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							var rtax_yn = model.getValue("/root/resData/resForm/rtax_yn");	
							if(rtax_yn == "Y"){
								model.setValue("/root/resData/resForm/vat", "");
								inp_vat.refresh();
							}					
							]]>
						</script>
					</bool>
					<caption id="caption30" style="left:521px; top:28px; width:60px; height:20px; ">면세여부</caption>
					<input id="inp_slcrg_pers_nm" ref="/root/resData/resForm/slcrg_pers_nm" navindex="22" imemode="hangul" inputtype="button" style="left:176px; top:79px; width:85px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm.currentText, inp_slcrg_pers, inp_slcrg_pers_nm);
							]]>
						</script>
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
							searchEmpno("setSlcrgPers", "/root/resData/resForm/slcrg_pers", "/root/resData/resForm/slcrg_pers_nm");
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode== "13"){
								findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm.currentText, inp_slcrg_pers, inp_slcrg_pers_nm);
							}
							]]>
						</script>
					</input>
					<input id="inp_mchrg_pers_nm" ref="/root/resData/resForm/mchrg_pers_nm" navindex="24" imemode="hangul" inputtype="button" style="left:446px; top:79px; width:85px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);
							]]>
						</script>
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
							searchEmpno("setMchrgPers", "/root/resData/resForm/mchrg_pers", "/root/resData/resForm/mchrg_pers_nm");	
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode== "13"){
								findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);
							}
							]]>
						</script>
					</input>
					<caption id="caption32" class="list_cap03" style="left:0px; top:50px; width:95px; height:26px; ">취급처</caption>
					<caption id="cap_fee" ref="/root/initData/cap_fee" class="list_cap03" style="left:710px; top:50px; width:95px; height:26px; ">대행료</caption>
					<caption id="cap_fee_rate" ref="/root/initData/cap_fee_rate" class="list_cap03" style="left:560px; top:50px; width:95px; height:26px; ">대행료율</caption>
					<input id="inp_fee" ref="/root/resData/resForm/fee" class="req" navindex="20" format="#,###" caption="수수료율" style="left:810px; top:54px; width:100px; height:18px; "/>
					<input id="input21" ref="/root/resData/resForm/fee_rate" class="req" navindex="19" maxlength="2" format="yyyy-mm-dd" caption="수수료율" style="left:660px; top:54px; width:45px; height:18px; text-align:right; ">
						<script type="javascript" ev:event="DOMFocusOut">
							<![CDATA[
							var advt_fee = Number(model.getValue("/root/resData/resForm/advt_fee"));		
							var vat    	= Number(model.getValue("/root/resData/resForm/vat"));			
							var fee_rate	= Number(model.getValue("/root/resData/resForm/fee_rate"));	
							
							var fee      = (advt_fee + vat) * 	fee_rate/100;
							var fee_vat  = vat * (fee_rate/100);
							
							model.setValue("/root/resData/resForm/fee", fee);				
							model.setValue("/root/resData/resForm/fee_vat", fee_vat);				
							inp_fee.refresh();
							
							]]>
						</script>
					</input>
					<select1 id="combo1" ref="/root/resData/resForm/hndl_clsf" class="req" navindex="16" appearance="minimal" style="left:100px; top:53px; width:90px; height:18px; ">
						<choices>
							<item>
								<label>1 광고주</label>
								<value>1</value>
							</item>
							<item>
								<label>2 대행사</label>
								<value>2</value>
							</item>
							<item>
								<label>4 광고지사</label>
								<value>4</value>
							</item>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							var hndl_clsf = model.getValue("/root/resData/resForm/hndl_clsf");	
							if(hndl_clsf == "4"){								
								model.setValue("/root/initData/cap_fee_rate","수수료율");
								model.setValue("/root/initData/cap_fee","수수료");
							}else{
								model.setValue("/root/initData/cap_fee_rate","대행료율");
								model.setValue("/root/initData/cap_fee","대행료");							
							}
							cap_fee_rate.refresh();
							cap_fee.refresh();
							
							]]>
						</script>
					</select1>
				</group>
			</case>
			<case id="case2">
				<datagrid id="datagrid2" nodeset="/root/resData/gridData/curlist2/record" caption="게재일자^광고주^광고료^부가세^수수료율^수수료^면^단^CM^취급처^영업담당^SLCRG_PERS^MEDI_CD^SEQ^DLCO_NO^AGN^COMS_VAT" colsep="#" colwidth="80, 130, 90, 90, 60, 90, 40, 40, 40, 120, 90, 100, 40, 40, 35, 35,10" explorerbar="sort" extendlastcol="scroll" rowheader="update" rowsep="|" selectionmode="byrow" style="left:5px; top:5px; width:916px; height:349px; ">
					<col ref="preng_occr_dt" format="yyyy-mm-dd"/>
					<col ref="dlco_nm" type="inputbutton" style="text-align:left; word-wrap:none; "/>
					<col ref="advt_fee" type="input" format="#,###" style="text-align:right; "/>
					<col ref="vat" type="input" format="#,###" style="text-align:right; "/>
					<col ref="coms_rate" type="input" format="99" style="text-align:right; "/>
					<col ref="coms" type="input" format="#,###" style="text-align:right; "/>
					<col ref="pubc_side"/>
					<col ref="dn"/>
					<col ref="cm"/>
					<col ref="agn_nm" type="inputbutton" style="text-align:left; word-wrap:none; "/>
					<col ref="slcrg_pers_nm" type="input" style="text-align:left; "/>
					<col ref="medi_cd" visibility="hidden"/>
					<col ref="preng_occr_seq" visibility="hidden"/>
					<col ref="dlco_no" visibility="hidden"/>
					<col ref="agn" visibility="hidden"/>
					<col ref="slcrg_pers" visibility="hidden"/>
					<col ref="coms_vat" visibility="hidden"/>
					<script type="javascript" ev:event="onbuttonclick">
						<![CDATA[
						if (datagrid2.col == datagrid2.colRef("dlco_nm")){	
							var dlco_nm   = datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("dlco_nm"));				
							model.property("pop_seq") =  "2";							
							showAdvcsSearchPopup("Y", "Y", "", "", "", dlco_nm); 
						}else if(datagrid2.col == datagrid2.colRef("agn_nm")){
							var agn_nm   = datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("agn_nm"));				
							model.property("pop_seq") =  "3";							
							showAdvcsSearchPopup("", "", "Y", "", "", agn_nm);
						}
												
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
								
						var dataIndex = getSelectedRecordIndex(datagrid2);
						if (datagrid2.col == datagrid2.colRef("dlco_nm")){
							model.property("pop_seq") =  "2";					
							var dlco_nm   = datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("dlco_nm"));
							findDlcoNoByNameWithRef("1"
							                       ,dlco_nm
							                       ,"/root/resData/gridData/curlist2/record["+dataIndex+"]/dlco_no"
							                       ,"/root/resData/gridData/curlist2/record["+dataIndex+"]/dlco_nm");	
							
						}else if(datagrid2.col == datagrid2.colRef("agn_nm")){
							model.property("pop_seq") =  "3";					
							var agn_nm   = datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("agn_nm"));
							findDlcoNoByNameWithRef("24"
							                       ,agn_nm
							                       ,"/root/resData/gridData/curlist2/record["+dataIndex+"]/agn"
							                       ,"/root/resData/gridData/curlist2/record["+dataIndex+"]/agn_nm");	
						}else if(datagrid2.col == datagrid2.colRef("slcrg_pers_nm")){
							var slcrg_pers_nm = datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("slcrg_pers_nm"));
							findEmpNoByNameWithRef("setSlcrgPers2", slcrg_pers_nm, "/root/resData/gridData/curlist2/record["+dataIndex+"]/slcrg_pers", "/root/resData/gridData/curlist2/record["+dataIndex+"]/slcrg_pers_nm");

							if(model.getValue("/root/resData/gridData/curlist2/record["+dataIndex+"]/slcrg_pers") == ""){
								datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("slcrg_pers_nm")) = "";
							}		
												
						}													   
						
						datagrid2.refresh();
															
						]]>
					</script>
					<script type="javascript" ev:event="DOMFocusOut">
						<![CDATA[

						var dataIndex = getSelectedRecordIndex(datagrid2);
						if(datagrid2.col == datagrid2.colRef("advt_fee")){
							var advt_fee = Number(model.getValue("/root/resData/gridData/curlist2/record["+dataIndex+"]/advt_fee"));
							model.setValue("/root/resData/gridData/curlist2/record["+dataIndex+"]/vat", Math.round(advt_fee/10));
						}else if(datagrid2.col == datagrid2.colRef("coms_rate")){
							var advt_fee 	= Number(model.getValue("/root/resData/gridData/curlist2/record["+dataIndex+"]/advt_fee"));
							var vat 	 		= Number(model.getValue("/root/resData/gridData/curlist2/record["+dataIndex+"]/vat"));
							var coms_rate	= Number(model.getValue("/root/resData/gridData/curlist2/record["+dataIndex+"]/coms_rate"));
							model.setValue("/root/resData/gridData/curlist2/record["+dataIndex+"]/coms", Math.round((advt_fee+vat)*coms_rate/100));
							model.setValue("/root/resData/gridData/curlist2/record["+dataIndex+"]/coms_vat", Math.round(vat*(coms_rate/100)));
						}			
												
						]]>
					</script>
				</datagrid>
				<group id="group2" style="left:0px; top:361px; width:921px; height:234px; ">
					<caption id="caption28" class="list_cap02" style="left:5px; top:130px; width:505px; height:26px; "/>
					<caption id="caption20" class="list_cap02" style="left:5px; top:180px; width:505px; height:51px; "/>
					<caption id="caption7" class="list_cap02" style="left:5px; top:30px; width:505px; height:26px; "/>
					<caption id="caption27" class="list_cap02" style="left:5px; top:105px; width:505px; height:26px; "/>
					<caption id="caption45" class="list_cap02" style="left:5px; top:155px; width:505px; height:26px; "/>
					<caption id="caption21" class="list_cap02" style="left:5px; top:5px; width:505px; height:26px; "/>
					<input id="input31" ref="/root/resData/resForm2/dlco_nm" inputtype="button" style="left:140px; top:34px; width:160px; height:18px; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
						
							model.property("pop_seq") =  "3";
							
							model.removeNodeset("/root/reqData/fwdData");
							model.makeNode("/root/reqData/fwdData/gnr_advcs_yn");
							model.setValue("/root/reqData/fwdData/gnr_advcs_yn", "Y");
							
							window.load("/xrw/ad/co/ad_co_1200.xrw"
										, "modal"
										, ""
										, "left:100; top:100; width:650; height:520; sysmenu:visible; min:visible; max:true; resize:true; caption:visible;"
										,"/root/reqData/fwdData"
										,"/root/req/fwdData"
							);
			
							]]>
						</script>
					</input>
					<input id="inp_agn_nm2" ref="/root/resData/resForm2/agn_nm" navindex="35" inputtype="button" caption="대행사" crud="R" style="left:220px; top:109px; width:120px; height:18px; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[						
							model.property("pop_seq") =  "5";
							var hndl_clsf = model.getValue("/root/resData/resForm2/hndl_clsf");
							if(hndl_clsf == "2"){
								showAdvcsSearchPopup("", "", "Y", "", "", inp_agn_nm2.currentText);
							}else{
								showAdvcsSearchPopup("", "", "", "Y", "Y", inp_agn_nm2.currentText);
							}
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode== "13"){
								model.property("pop_seq") =  "5";
								
								var hndl_clsf = model.getValue("/root/resData/resForm2/hndl_clsf");
								if(hndl_clsf == "2"){
									findDlcoNoByName("2", inp_agn_nm2.currentText, inp_agn_no2, inp_agn_nm2);
								}else{
									findDlcoNoByName("4", inp_agn_nm2.currentText, inp_agn_no2, inp_agn_nm2);
								}
							}
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[							
								model.property("pop_seq") =  "5";
								var hndl_clsf = model.getValue("/root/resData/resForm2/hndl_clsf");
								if(hndl_clsf == "2"){
									findDlcoNoByName("2", inp_agn_nm2.currentText, inp_agn_no2, inp_agn_nm2);
								}else{
									findDlcoNoByName("4", inp_agn_nm2.currentText, inp_agn_no2, inp_agn_nm2);
								}
							]]>
						</script>
					</input>
					<caption id="caption42" class="list_cap03" style="left:5px; top:5px; width:70px; height:26px; ">매체구분</caption>
					<caption id="caption43" class="list_cap03" style="left:5px; top:30px; width:70px; height:26px; ">광고주</caption>
					<caption id="caption44" class="list_cap03" style="left:250px; top:155px; width:70px; height:26px; ">관리담당</caption>
					<input id="input23" ref="/root/resData/resForm2/dlco_no" style="left:80px; top:34px; width:55px; height:18px; "/>
					<select1 id="cb_medi_cd" ref="/root/resData/resForm2/medi_cd" class="req" navindex="26" appearance="minimal" caption="매체구분" style="left:80px; top:9px; width:120px; height:18px; ">
						<choices>
							<itemset nodeset="/root/codeData/medi_clsf2/item">
								<label ref="label"/>
								<value ref="value"/>
							</itemset>
						</choices>
					</select1>
					<input id="input35" ref="/root/resData/resForm2/dlco_nm" class="req" inputtype="button" caption="광고주" style="left:140px; top:34px; width:160px; height:18px; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
						
							model.property("pop_seq") =  "3";
							
							model.removeNodeset("/root/reqData/fwdData");
							model.makeNode("/root/reqData/fwdData/gnr_advcs_yn");
							model.setValue("/root/reqData/fwdData/gnr_advcs_yn", "Y");
							
							window.load("/xrw/ad/co/ad_co_1200.xrw"
										, "modal"
										, ""
										, "left:100; top:100; width:650; height:520; sysmenu:visible; min:visible; max:true; resize:true; caption:visible;"
										,"/root/reqData/fwdData"
										,"/root/reqData/fwdData"
							);
		
							]]>
						</script>
					</input>
					<input id="inp_sect_nm" ref="/root/resData/resForm2/sect" class="req" navindex="29" imemode="disabled" caption="면" style="left:5px; top:81px; width:70px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="onkeyup">
							<![CDATA[
							upperCase(inp_sect_nm);
							]]>
						</script>
					</input>
					<caption id="caption23" class="list_cap03" style="left:291px; top:55px; width:80px; height:26px; ">부가세</caption>
					<input id="input36" ref="/root/resData/resForm2/dlco_no" class="req" caption="광고주" style="left:80px; top:34px; width:55px; height:18px; "/>
					<input id="input25" ref="/root/resData/resForm2/dn" class="req" navindex="30" imemode="disabled" caption="단" style="left:74px; top:81px; width:70px; height:18px; text-align:center; "/>
					<caption id="caption35" class="list_cap03" style="left:212px; top:55px; width:80px; height:26px; ">광고료</caption>
					<input id="inp_dlco_nm3" ref="/root/resData/resForm2/dlco_nm" class="req" navindex="28" inputtype="button" caption="광고주" crud="R" style="left:140px; top:34px; width:160px; height:18px; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[					
							model.property("pop_seq") 	=  "4";
							model.property("pop_chrg") 	=  "2";
							showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm3.currentText); 
							setChrgInfo();
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode== "13"){
								model.property("pop_seq") 	=  "4";
								model.property("pop_chrg") 	=  "2";
								findDlcoNoByName("1", inp_dlco_nm3.currentText, inp_dlco_no3, inp_dlco_nm3);
								setChrgInfo();
							}					
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							model.property("pop_seq") 	=  "4";
							model.property("pop_chrg") 	=  "2";
							findDlcoNoByName("1", inp_dlco_nm3.currentText, inp_dlco_no3, inp_dlco_nm3);
							setChrgInfo();
							]]>
						</script>
					</input>
					<caption id="caption36" class="list_cap03" style="left:143px; top:55px; width:70px; height:26px; ">CM</caption>
					<input id="inp_dlco_no3" ref="/root/resData/resForm2/dlco_no" class="req" navindex="27" caption="광고주" style="left:80px; top:34px; width:55px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							var dlco_no3 = inp_dlco_no3.currentText;
							model.setValue("/root/resData/resForm2/dlco_no", lpad(dlco_no3, 8, "0"));
							inp_dlco_no3.refresh();
							model.property("pop_chrg") =  "2";
							commonSubmission("9004", inp_dlco_no3.currentText,  inp_dlco_no3, inp_dlco_nm3);		
							setChrgInfo();						
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode== "13"){
								var dlco_no3 = inp_dlco_no3.currentText;
								model.setValue("/root/resData/resForm2/dlco_no", lpad(dlco_no3, 8, "0"));
								inp_dlco_no3.refresh();
					
								model.property("pop_chrg") =  "2";
								commonSubmission("9004", inp_dlco_no3.currentText,  inp_dlco_no3, inp_dlco_nm3);		
								setChrgInfo();					
							}
							]]>
						</script>
					</input>
					<caption id="caption37" class="list_cap03" style="left:5px; top:55px; width:70px; height:26px; ">면</caption>
					<input id="inp_vat2" ref="/root/resData/resForm2/vat" class="req" navindex="33" format="#,###" caption="부가세" style="left:291px; top:81px; width:80px; height:18px; text-align:right; "/>
					<caption id="caption38" class="list_cap03" style="left:5px; top:155px; width:70px; height:26px; ">영업담당</caption>
					<input id="input18" ref="/root/resData/resForm2/advt_fee" class="req" navindex="32" format="#,###" caption="광고료" style="left:212px; top:81px; width:80px; height:18px; text-align:right; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							var 	advt_fee = Number(model.getValue("/root/resData/resForm2/advt_fee"));	
							model.setValue("/root/resData/resForm2/vat", Math.round(advt_fee/10));
							inp_vat2.refresh();							
							]]>
						</script>
						<script type="javascript" ev:event="DOMFocusOut">
							<![CDATA[
							var 	advt_fee = Number(model.getValue("/root/resData/resForm2/advt_fee"));	
							model.setValue("/root/resData/resForm2/vat", Math.round(advt_fee/10));
							inp_vat2.refresh();						
							]]>
						</script>
					</input>
					<caption id="caption39" class="list_cap03" style="left:74px; top:55px; width:70px; height:26px; ">단</caption>
					<input id="input19" ref="/root/resData/resForm2/cm" class="req" navindex="31" imemode="disabled" caption="CM" style="left:143px; top:81px; width:70px; height:18px; text-align:center; "/>
					<input id="inp_agn_no2" ref="/root/resData/resForm2/agn" navindex="34" caption="대행사" style="left:158px; top:109px; width:55px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							var agn_no2 = inp_agn_no2.currentText;
							model.setValue("/root/resData/resForm2/agn", lpad(agn_no2, 8, "0"));
							inp_agn_no2.refresh();
				
							commonSubmission("9004", inp_agn_no2.currentText,  inp_agn_no2, inp_agn_nm2);								
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode== "13"){
								var agn_no2 = inp_agn_no2.currentText;
								model.setValue("/root/resData/resForm2/agn", lpad(agn_no2, 8, "0"));
								inp_agn_no2.refresh();
					
								commonSubmission("9004", inp_agn_no2.currentText,  inp_agn_no2, inp_agn_nm2);		
							}	
							]]>
						</script>
					</input>
					<caption id="caption29" class="list_cap03" style="left:5px; top:105px; width:70px; height:26px; ">취급처</caption>
					<input id="inp_slcrg_pers_nm2" ref="/root/resData/resForm2/slcrg_pers_nm" class="req" navindex="39" imemode="hangul" inputtype="button" caption="영업담당" style="left:158px; top:159px; width:85px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm2.currentText, inp_slcrg_pers2, inp_slcrg_pers_nm2);
							]]>
						</script>
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
							searchEmpno("setSlcrgPers", "/root/resData/resForm2/slcrg_pers", "/root/resData/resForm2/slcrg_pers_nm");
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode== "13"){
								findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm2.currentText, inp_slcrg_pers2, inp_slcrg_pers_nm2);
							}
							]]>
						</script>
					</input>
					<input id="inp_slcrg_pers2" ref="/root/resData/resForm2/slcrg_pers" class="req" navindex="38" caption="영업담당" style="left:79px; top:159px; width:75px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							commonSubmission("9005", inp_slcrg_pers2.currentText,  inp_slcrg_pers2, inp_slcrg_pers_nm2);							
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode== "13"){
								commonSubmission("9005", inp_slcrg_pers2.currentText,  inp_slcrg_pers2, inp_slcrg_pers_nm2);
							}
							]]>
						</script>
					</input>
					<input id="inp_mchrg_pers2" ref="/root/resData/resForm2/mchrg_pers" class="req" navindex="40" caption="관리담당" style="left:324px; top:159px; width:75px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							commonSubmission("9005", inp_mchrg_pers2.currentText,  inp_mchrg_pers2, inp_mchrg_pers_nm2);				
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode== "13"){
								commonSubmission("9005", inp_mchrg_pers2.currentText,  inp_mchrg_pers2, inp_mchrg_pers_nm2);		
							}
							]]>
						</script>
					</input>
					<input id="inp_mchrg_pers_nm2" ref="/root/resData/resForm2/mchrg_pers_nm" class="req" navindex="41" imemode="hangul" inputtype="button" caption="관리담당" style="left:404px; top:159px; width:85px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm2.currentText, inp_mchrg_pers2, inp_mchrg_pers_nm2);
							]]>
						</script>
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
							searchEmpno("setMchrgPers", "/root/resData/resForm2/mchrg_pers", "/root/resData/resForm2/mchrg_pers_nm");	
							]]>
						</script>
						<script type="javascript" ev:event="onkeypress">
							<![CDATA[
							if(event.keyCode== "13"){
								findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm2.currentText, inp_mchrg_pers2, inp_mchrg_pers_nm2);
							}
							]]>
						</script>
					</input>
					<select1 id="combo2" ref="/root/resData/resForm2/hndl_clsf" class="req" appearance="minimal" caption="취급처구분" style="left:79px; top:109px; width:75px; height:18px; ">
						<choices>
							<item>
								<label>1 광고주</label>
								<value>1</value>
							</item>
							<item>
								<label>2 대행사</label>
								<value>2</value>
							</item>
							<item>
								<label>4 지사</label>
								<value>4</value>
							</item>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[

							var hndl_clsf = model.getValue("/root/resData/resForm2/hndl_clsf");	
							if(hndl_clsf == "4"){
								model.setValue("/root/initData/cap_fee_rate2","수수료율");
								model.setValue("/root/initData/cap_fee2","수수료");
							}else{
								model.setValue("/root/initData/cap_fee_rate2","대행료율");
								model.setValue("/root/initData/cap_fee2","대행료");							
							}
							cap_fee_rate2.refresh();
							cap_fee2.refresh();
														
							]]>
						</script>
					</select1>
					<caption id="caption17" style="left:405px; top:58px; width:60px; height:20px; ">면세여부</caption>
					<bool id="bool2" navindex="40" checkvalue="Y,N" ref="/root/resData/resForm2/rtax_yn" style="left:379px; top:58px; width:25px; height:20px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							var rtax_yn = model.getValue("/root/resData/resForm2/rtax_yn");	
							if(rtax_yn == "Y"){
								model.setValue("/root/resData/resForm2/vat", "");
								inp_vat2.refresh();
							}else{
								var advt_fee	=	Number(model.getValue("/root/resData/resForm2/advt_fee"));
								var	vat		=	advt_fee/10;
								model.setValue("/root/resData/resForm2/vat", vat);
								inp_vat2.refresh();								
							}			
							]]>
						</script>
					</bool>
					<caption id="caption25" class="list_cap03" style="left:5px; top:180px; width:70px; height:51px; ">
						<![CDATA[거래처담당 
및 
기타사항]]>
					</caption>
					<textarea id="textarea1" ref="/root/resData/resForm2/remk" navindex="42" style="left:78px; top:185px; width:427px; height:40px; padding:2; "/>
					<datagrid id="datagrid3" nodeset="/root/resData/gridData/curlist3/record" caption="일^일^월^월^화^화^수^수^목^목^금^금^토^토" colsep="#" colwidth="28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28" dataheight="28" defaultrows="7" mergecellsfixedrows="bycolrec" rowheight="28" rowsep="|" style="left:520px; top:32px; width:395px; height:198px; ">
						<col ref="sun"/>
						<col checkvalue="Y,N" ref="sun_yn" type="checkbox"/>
						<col ref="mon"/>
						<col checkvalue="Y,N" ref="mon_yn" type="checkbox"/>
						<col ref="tue"/>
						<col checkvalue="Y,N" ref="tue_yn" type="checkbox"/>
						<col ref="wed"/>
						<col checkvalue="Y,N" ref="wed_yn" type="checkbox"/>
						<col ref="thr"/>
						<col checkvalue="Y,N" ref="thr_yn" type="checkbox"/>
						<col ref="fri"/>
						<col checkvalue="Y,N" ref="fri_yn" type="checkbox"/>
						<col ref="sat"/>
						<col checkvalue="Y,N" ref="sat_yn" type="checkbox"/>
					</datagrid>
					<caption id="cap_fee2" ref="/root/initData/cap_fee2" class="list_cap03" style="left:250px; top:130px; width:70px; height:26px; ">수수료</caption>
					<input id="input6" ref="/root/resData/resForm2/fee_rate" class="req" navindex="36" format="#,###" caption="대행료율" style="left:79px; top:134px; width:35px; height:18px; text-align:right; ">
						<script type="javascript" ev:event="DOMFocusOut">
							<![CDATA[
							var advt_fee = Number(model.getValue("/root/resData/resForm2/advt_fee"));		
							var vat    	= Number(model.getValue("/root/resData/resForm2/vat"));			
							var fee_rate	= Number(model.getValue("/root/resData/resForm2/fee_rate"));	
							
							var fee      = (advt_fee + vat) * 	fee_rate/100;
							var fee_vat  = vat * (fee_rate/100);
							model.setValue("/root/resData/resForm2/fee", fee);				
							model.setValue("/root/resData/resForm2/fee_vat", fee_vat);				
							inp_fee2.refresh();						
							]]>
						</script>
					</input>
					<caption id="cap_fee_rate2" ref="/root/initData/cap_fee_rate2" class="list_cap03" style="left:5px; top:130px; width:70px; height:26px; ">수수료율</caption>
					<input id="inp_fee2" ref="/root/resData/resForm2/fee" class="req" navindex="37" format="#,###" caption="대행료" style="left:325px; top:134px; width:70px; height:18px; text-align:right; "/>
					<button id="button4" class="btn_nav_prev" style="left:520px; top:10px; width:21px; height:17px; ">
						<caption/>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
							var yymm = dateAdd("m", -1, model.getValue("/root/resData/resForm2/yymm") + "01");
							model.setValue("/root/resData/resForm2/yymm", yymm.substring(0,6));
							loadCalendar();
				
							]]>
						</script>
					</button>
					<button id="button5" class="btn_nav_next" style="left:624px; top:10px; width:21px; height:17px; ">
						<caption/>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
							var yymm = dateAdd("m", 1, model.getValue("/root/resData/resForm2/yymm") + "01");
							model.setValue("/root/resData/resForm2/yymm", yymm.substring(0,6));
							loadCalendar();
							]]>
						</script>
					</button>
					<input id="inp_clos_yymm" ref="/root/resData/resForm2/yymm" inputtype="date" format="yyyy-mm" appearance="input" style="left:545px; top:10px; width:75px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
				loadData();
				]]>
						</script>
					</input>
				</group>
			</case>
		</switch>
		<caption id="caption6" tyle="left:15px; top:180px; width:940px; height:0px;" style="left:0px; top:10px; width:0px; height:0px; ">caption6</caption>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<caption id="caption12" class="list_cap02" style="left:10px; top:70px; width:927px; height:28px; "/>
		<caption id="caption4" class="list_cap01" style="left:10px; top:70px; width:75px; height:28px; ">매체구분</caption>
		<group id="group_line" class="gro_line" style="left:10px; top:105px; width:927px; height:5px; "/>
		<button id="button1" class="btn02" crud="D" style="left:631px; top:40px; width:52px; height:21px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				var iSel = switch1.selectedIndex;
				
				if(iSel == 0){
					deleteRow(datagrid4);
				}else if(iSel == 1){
					deleteRow(datagrid2);
				}
					
				]]>
			</script>
		</button>
		<button id="button17" class="btn02" crud="R" style="left:498px; top:40px; width:52px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				if(validateReq()){
					loadList();
				}
									
				]]>
			</script>
		</button>
		<button id="button3" class="btn03" crud="C" style="left:558px; top:40px; width:65px; height:21px; ">
			<caption>예약입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				var iSel = switch1.selectedIndex;
				
				if(iSel == 0){	
					if(commReqCheck("group1")){
						if(windowConfirm("예약등록하시겠습니까?")){
							model.send("ad_res_1920_i");
							if(submit_completed()){
								loadList();
							}
						}
					}
				}else if(iSel == 1){ 
					
					if(commReqCheck("group2")){
						
						var canGo = false;
						for(var i=datagrid3.fixedRows;i<datagrid3.rows;i++){
							for(var j=datagrid3.fixedCols;j<datagrid3.cols;j++){
								if(datagrid3.valueMatrix(i, j) == "Y"){
									canGo = true;
									break;
								}
							}
						}
						
						if(!canGo){
							alert("예약일을 선택하세요.");
							return;
						}
							
						if(windowConfirm("예약등록하시겠습니까?")){
							model.setValue("/root/resData/resForm2/multiUpdateData", datagrid3.getUpdateData());
							model.send("ad_res_1921_i");
							if(submit_completed()){
								loadList();
							}
						}
					}  
				}	
					
				]]>
			</script>
		</button>
		<button id="button19" class="btn03" crud="U" style="left:691px; top:40px; width:65px; height:21px; ">
			<caption>저장/수정</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					
				var iSel = switch1.selectedIndex;
													
				if(iSel == 0){
					if(!isDataGridUpdated(datagrid4)){
						alert("저장할 내역이 없습니다.");
						return;
					}
					if(windowConfirm("저장하시겠습니까?")){
						model.setValue("/root/reqData/multiUpdateData",datagrid4.getUpdateData());					
						model.send("ad_res_1930_a");	
						if(submit_completed()){
							loadList();
						}					
					}
				}else if(iSel == 1){ 
				
					if(!isDataGridUpdated(datagrid2)){
						alert("저장할 내역이 없습니다.");
						return;
					}
					if(windowConfirm("저장하시겠습니까?")){
						model.setValue("/root/reqData/multiUpdateData",datagrid2.getUpdateData());
						model.send("ad_res_1930_a");	
						if(submit_completed()){
							loadList();
						}	
					}			
				}
				
										
				]]>
			</script>
		</button>
		<button id="button8" class="btn02" crud="R" style="left:764px; top:40px; width:52px; height:21px; ">
			<caption>엑셀</caption>
			<script type="javascript" ev:event="DOMActivate">
				<![CDATA[
				
				var iSel = switch1.selectedIndex;
				
				var sheet = "";
				
				if(iSel == 0){
					sheet = "월정광고";
				}else{
					sheet = "기사중광고";
				}
								
				var filename = window.fileDialog("save", ",", false, "장기예약광고입력_"+sheet, "xls", "Excel File(*.xls)|*.xls");
				
				if(filename!=""){
					if(iSel == 0){
						datagrid4.saveExcel(filename, "sheetname: 월정광고;");
					}else{
						datagrid2.saveExcel(filename, "sheetname: 기사중광고;");
					}
				}
				
				]]>
			</script>
		</button>
		<caption id="caption1" class="list_cap01" style="left:208px; top:70px; width:75px; height:28px; ">게재기간</caption>
		<caption id="caption2" class="list_cap01" style="left:448px; top:70px; width:75px; height:28px; ">영업담당</caption>
		<caption id="caption3" class="list_cap01" style="left:670px; top:70px; width:75px; height:28px; ">광고주</caption>
		<input id="input8" ref="/root/reqData/searchData/todt" class="req" navindex="3" format="yyyy-mm" caption="게재기간" style="left:377px; top:75px; width:65px; height:18px; "/>
		<select1 id="combo6" ref="/root/reqData/searchData/medi_cd" navindex="1" appearance="minimal" style="left:88px; top:75px; width:115px; height:18px; ">
			<choices>
				<itemset nodeset="/root/codeData/medi_clsf/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="caption10" style="left:358px; top:75px; width:15px; height:20px; ">~</caption>
		<input id="inp_dlco_nm" ref="/root/reqData/searchData/dlco_nm" navindex="7" inputtype="button" style="left:815px; top:75px; width:115px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				model.property("pop_seq") =  "1";				
				showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText); 
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode== "13"){
					model.property("pop_seq") =  "1";
					findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);					
				}	
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				model.property("pop_seq") =  "1";
				findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);	
				]]>
			</script>
		</input>
		<input id="input9" ref="/root/reqData/searchData/frdt" class="req" navindex="2" format="yyyy-mm" caption="게재기간" style="left:287px; top:75px; width:65px; height:18px; "/>
		<input id="inp_dlco_no" ref="/root/reqData/searchData/dlco_no" navindex="6" style="left:750px; top:75px; width:60px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var dlco_no = inp_dlco_no.currentText;
				model.setValue("/root/reqData/searchData/dlco_no", lpad(dlco_no, 8, "0"));
				inp_dlco_no.refresh();
				
				commonSubmission("9004", inp_dlco_no.currentText,  inp_dlco_no, inp_dlco_nm);		
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode== "13"){
					var dlco_no = inp_dlco_no.currentText;
					model.setValue("/root/reqData/searchData/dlco_no", lpad(dlco_no, 8, "0"));
					inp_dlco_no.refresh();
					
					commonSubmission("9004", inp_dlco_no.currentText,  inp_dlco_no, inp_dlco_nm);					
				}
				]]>
			</script>
		</input>
		<button id="button16" class="tab06" group="tab" crud="R" style="left:116px; top:120px; width:105px; height:23px; ">
			<caption>기사중광고</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[				
				model.toggle("case2");
				]]>
			</script>
		</button>
		<button id="button10" class="tab06" group="tab" selected="true" crud="R" style="left:11px; top:120px; width:105px; height:23px; ">
			<caption>월정광고</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case1");
				]]>
			</script>
		</button>
		<button id="btnClose" class="btn02" style="left:884px; top:40px; width:52px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[					
 				viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));					
				]]>
			</script>
		</button>
		<input id="inp_srch_slcrg_pers_nm" ref="/root/reqData/searchData/slcrg_pers_nm" navindex="5" imemode="hangul" inputtype="button" caption="영업담당" crud="R" style="left:586px; top:75px; width:81px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				searchEmpno("setSlcrgPers", "/root/reqData/searchData/slcrg_pers", "/root/reqData/searchData/slcrg_pers_nm");
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					findEmpNoByName("setSlcrgPers", inp_srch_slcrg_pers_nm.currentText, inp_srch_slcrg_pers, inp_srch_slcrg_pers_nm);
				}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					findEmpNoByName("setSlcrgPers", inp_srch_slcrg_pers_nm.currentText, inp_srch_slcrg_pers, inp_srch_slcrg_pers_nm);
				]]>
			</script>
		</input>
		<input id="inp_srch_slcrg_pers" ref="/root/reqData/searchData/slcrg_pers" navindex="4" maxlength="10" style="left:525px; top:75px; width:55px; height:18px; ">
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					commonSubmission("9005", inp_srch_slcrg_pers.currentText,  inp_srch_slcrg_pers, inp_srch_slcrg_pers_nm);
				}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				commonSubmission("9005", inp_srch_slcrg_pers.currentText,  inp_srch_slcrg_pers, inp_srch_slcrg_pers_nm);	
				]]>
			</script>
		</input>
		<button id="button2" class="btn02" crud="R" style="left:824px; top:40px; width:52px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="DOMActivate">
				<![CDATA[
				model.reset();
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
