<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>게재예정표</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<slcrg_pers>
								<item>
									<label/>
									<value/>
								</item>
							</slcrg_pers>
						</comboSet>
						<pageInfo/>
						<cap_lbl>대기광고</cap_lbl>
					</initData>
					<reqData>
						<fwdData>
							<dlco_clsf/>
							<dlco_nm/>
						</fwdData>
						<searchData/>
						<multiUpdateData/>
						<medi_cd>110</medi_cd>
						<pubc_dt/>
						<pubc_clsf>0</pubc_clsf>
						<clos_clsf/>
						<preng_clos_yn/>
						<unasin_uprc/>
					</reqData>
					<resData>
						<resForm>
						</resForm>
						<gridData1>
							<sect_nm/>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<chro_clsf/>
								<bw_clr_yn/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
							</record>
						</gridData1>
						<gridData2>
							<sect_nm/>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<chro_clsf/>
								<bw_clr_yn/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
							</record>
						</gridData2>
						<gridData3>
							<sect_nm/>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<chro_clsf/>
								<bw_clr_yn/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
							</record>
						</gridData3>
						<gridData4>
							<sect_nm/>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<chro_clsf/>
								<bw_clr_yn/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
							</record>
						</gridData4>
						<gridData5>
							<sect_nm/>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<chro_clsf/>
								<bw_clr_yn/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
							</record>
						</gridData5>
						<gridData6>
							<sect_nm/>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<chro_clsf/>
								<bw_clr_yn/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
							</record>
						</gridData6>
						<gridData7>
							<sect_nm/>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<chro_clsf/>
								<bw_clr_yn/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
							</record>
						</gridData7>
						<gridData8>
							<sect_nm/>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<chro_clsf/>
								<bw_clr_yn/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
							</record>
						</gridData8>
						<preng_clos_yn/>
						<asum_shet_aprv_yn/>
						<tot_side_cnt/>
						<tot_dn_cnt/>
						<advs_ocpy_rate/>
						<unasin_uprc/>
						<avg_uprc/>
						<tot_advt_fee/>
						<sumGridData1>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn/>
							</record>
						</sumGridData1>
						<sumGridData2>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn/>
							</record>
						</sumGridData2>
						<sumGridData3>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn/>
							</record>
						</sumGridData3>
						<sumGridData4>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn/>
							</record>
						</sumGridData4>
						<sumGridData5>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn/>
							</record>
						</sumGridData5>
						<sumGridData6>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn/>
							</record>
						</sumGridData6>
						<sumGridData7>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn/>
							</record>
						</sumGridData7>
						<sumGridData8>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn/>
							</record>
						</sumGridData8>
						<sect_cnt/>
						<show_uprc/>
						<out_tot_advt_fee/>
						<ex_tot_advt_fee/>
					</resData>
					<tempData>
						<keyData/>
					</tempData>
					<msgData/>
					<resData1>
						<gridData>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<chro_clsf/>
								<bw_clr_yn/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
							</record>
						</gridData>
						<sumGridData>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers_nm/>
								<agn/>
							</record>
						</sumGridData>
						<gridData1>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<chro_clsf/>
								<bw_clr_yn/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
							</record>
						</gridData1>
						<sumGridData1>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers_nm/>
								<agn/>
							</record>
						</sumGridData1>
						<gridData2>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<chro_clsf/>
								<bw_clr_yn/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
							</record>
						</gridData2>
						<sumGridData2>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers_nm/>
								<agn/>
							</record>
						</sumGridData2>
					</resData1>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				
					window.left  = 0;
					window.top  = 0;
					window.width = "1024";
					window.height= "690";
					var pubc_dt = dateAdd("d", 1, getCurrentDate());
					
					if(model.property("PUB_1400_PUBC_DT") != ""){
						pubc_dt	=	model.property("PUB_1400_PUBC_DT");
						model.property("PUB_1400_PUBC_DT")	= "";
					}
					
					model.setValue("/root/reqData/pubc_dt", pubc_dt);
					inp_pubc_dt.refresh();
					
					model.send("ad_res_1400_m");
					
					model.copyNode("/root/initData/comboSet/slcrg_pers", "/root/tempData/slcrg_pers");
					
					loadData();
					
					
				]]>
			</script>
			<submission id="ad_res_1400_m" action="/ad/res/1400" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="ad_res_1410_l" action="/ad/res/1410" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/resData"/>
			<submission id="ad_res_1420_l" action="/ad/res/1420" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/resData1"/>
			<submission id="ad_res_1430_u" action="/ad/res/1430" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/msgData"/>
			<submission id="ad_res_1440_u" action="/ad/res/1440" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/msgData"/>
			<submission id="ad_co_9002_s" action="/ad/common/9002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData/dlco_nm" resultref="/root/msgData"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
				var	_pubc_clsf_idx		=	0;
				var _pubc_clsfs 	= new Array("0", "2", "9");

				function initVariables(){
					_pubc_clsf_idx		=	0;
				 	var _drag_start = false;
				 	var _drag_mode  = false;
			 						
					model.setValue("/root/reqData/pubc_clsf", _pubc_clsfs[_pubc_clsf_idx]);
					
					for(var i=1; i<=8; i++){			
						document.controls("group"+i).visible = false;
					}
					
					group1_1.visible = false;
					group1_2.visible = false;
				}
				
				function redrawDatagrid(){

					var bg_color = "#ccffcc";
					var bg_color2 = "#ccffff";
					var side_indx = 0;
					
					var sect_cnt = model.getValue("/root/resData/sect_cnt");
					
					for(var n=1; n<=sect_cnt; n++){		
						var datagrid    = document.controls("dg_sect" + n);
						
						datagrid.row = 0;
						datagrid.col = 1;
						
						for(var i=datagrid.fixedRows; i<datagrid.rows; i++){
							datagrid.cellstyle("background-color", i, datagrid.colRef("sect")) 	= "#FFFFFF";	
							datagrid.cellstyle("background-color", i, datagrid.colRef("dn")) 	= "#FFFFFF";	
						}
						
//						datagrid.allStyle("data", "background-color") = "#FFFFFF";
						
						for(var i=datagrid.fixedRows; i<datagrid.rows; i++){
							var chro_clsf = datagrid.valueMatrix(i,datagrid.colRef("bw_clr_yn"));
							var dn		 = Number(datagrid.valueMatrix(i, datagrid.colRef("dn")));
							if(chro_clsf == "1"){
								datagrid.cellstyle("background-color", i, datagrid.colRef("sect")) 	= bg_color;		
								datagrid.cellstyle("background-color", i, datagrid.colRef("dn")) 	= bg_color;		
							}
							if(chro_clsf == "2"){
								datagrid.cellstyle("background-color", i, datagrid.colRef("sect")) 	= bg_color;		
							}
							if(dn == 0){
								datagrid.cellstyle("background-color", i, datagrid.colRef("dn")) 	= "#FFF000";		
							}
						}	
					}
					
					var tmp_sect_cnt = 0;
					
					if(sect_cnt < 5) 
						tmp_sect_cnt = sect_cnt
					else
						tmp_sect_cnt = 5;
						
					var gap        	=	10;
					var height     	= 	666/tmp_sect_cnt;
			      	var tmp_top    	= 	0;
					var tmp_height 	= 	0;		
						
					var last_top		=	0;
					var last_height	=	0;					
								
					for(var i=1; i<=tmp_sect_cnt; i++){		
						var group    = document.controls("group" + i);
						group.visible = true;
						
						if(i == 1){
							var datagrid = document.controls("dg_sect0");
							var sum_grid = document.controls("sum_sect0");
						}else{
							var datagrid = document.controls("dg_sect" + i);
							var sum_grid = document.controls("sum_sect" + i);
						}					
						
						//var sum_grid = document.controls("sum_sect" + i);
						
						var left   = group.currentStyle.left;
						var top    = group.currentStyle.top;
						var width  = group.currentStyle.width;
						
						top = 95 + (i-1) * height;
						
						group.attribute("top")    = top + "px";
						group.attribute("height") = height + "px";
						
						datagrid.attribute("height") = height - 50; 
						datagrid.attribute("width")  = width; 
						
						
						tmp_top    = datagrid.currentStyle.top;
						tmp_height = datagrid.currentStyle.height - 21;
						
						sum_grid.attribute("top") = tmp_top + tmp_height;
						
						last_top		=	sum_grid.currentStyle.top;
						last_height	=	sum_grid.currentStyle.height;
						
						group.refresh();
						datagrid.refresh();
						sum_grid.refresh();
						
											
					}
					
					for(var i=6; i<=sect_cnt; i++){		
						var group    = document.controls("group" + i);
						group.visible = true;
						
						var datagrid = document.controls("dg_sect" + i);
						
						var sum_grid = document.controls("sum_sect" + i);
						
						var left   = group.currentStyle.left;
						var top    = group.currentStyle.top;
						var width  = group.currentStyle.width;
						
						top = last_top + 10 + (i-1) * height;
						
						group.attribute("top")    = top + "px";
						group.attribute("height") = height + "px";
						
						datagrid.attribute("height") = height - 50; 
						datagrid.attribute("width")  = width; 
						
						
						tmp_top    = datagrid.currentStyle.top;
						tmp_height = datagrid.currentStyle.height - 21;
						
						sum_grid.attribute("top") = tmp_top + tmp_height;
						
						group.refresh();
						datagrid.refresh();
						sum_grid.refresh();
						
											
					}					

				}
				
				function loadData(){				
									
					if(validateReq()){	
						model.setValue("/root/reqData/unasin_uprc", model.getValue("/root/resData/unasin_uprc"));					
											
						model.send("ad_res_1410_l");
						model.send("ad_res_1420_l");
						
						model.refresh();
	
						redrawDatagrid();
						if(model.getValue("/root/resData/tot_side_cnt") == ""){
							alert("검색결과가 없습니다.");
						}
					}
					
				}
				
				function setDlcoInfo(dlco_no, dlco_nm, dlco_clsf){
					
					model.setValue(_dlco_no_ref, dlco_no);
					model.setValue(_dlco_nm_ref, dlco_nm);
					model.setValue(_dlco_clsf_ref, dlco_clsf);
					
					model.refresh();
/*					
					dg_sect1.valueMatrix(dg_sect1.row, dg_sect1.colRef("agn"))  	= dlco_no;
					dg_sect1.valueMatrix(dg_sect1.row, dg_sect1.colRef("agn_nm")) 	= dlco_nm;
*/					
				}
				function ondragstart(){
 				}
				function ondrop(){				
			 	}
			 	function onmousedown(){								 		
			 	}
			 	function onmouseup(){		 		
			 	}
			 	function calcuateAdvtFee(datagrid){
			 		
			 		var dn = Number(datagrid.valueMatrix(datagrid.row, datagrid.colRef("dn")));
			 		var cm = Number(datagrid.valueMatrix(datagrid.row, datagrid.colRef("cm")));
			 		
					if(datagrid.col == datagrid.colRef("uprc")){
						var uprc     = Number(datagrid.valueMatrix(datagrid.row, datagrid.colRef("uprc")));
						var advt_fee = uprc * dn * cm;
						
						datagrid.valueMatrix(datagrid.row, datagrid.colRef("advt_fee")) = advt_fee;
						datagrid.refresh();
						
					}else if(datagrid.col == datagrid.colRef("advt_fee")){
						var advt_fee	= Number(datagrid.valueMatrix(datagrid.row, datagrid.colRef("advt_fee")));
						var uprc     = Math.round(advt_fee /(dn * cm));
						
						datagrid.valueMatrix(datagrid.row, datagrid.colRef("uprc")) = uprc;
						datagrid.refresh();
						
					}
			 	}
			 	
			 	var _drag_start = false;
			 	var _drag_mode  = false;
			 	
			 	function on_mouse_down(id){

					_drag_start 	= 	true;
					_drag_mode	=	false;

					var datagrid = document.controls(id);													
					if (datagrid.isCell(event.target)){
						if(datagrid.mouseCol>= datagrid.colRef("sect") && datagrid.mouseCol <= datagrid.colRef("chro_clsf_nm")){
							
							var advt_cont	=	datagrid.valueMatrix(datagrid.row, datagrid.colRef("advt_cont"));
							if(advt_cont == "")	return;
							
							model.property("source_datagrid") = id;		
							model.property("preng_occr_seq")  = datagrid.valueMatrix(datagrid.mouseRow, datagrid.colRef("preng_occr_seq"));
							model.property("advt_cont")       = datagrid.valueMatrix(datagrid.mouseRow, datagrid.colRef("advt_cont"));
							model.property("source_row") 		= parseInt(datagrid.mouseRow);
							_drag_start 	= 	true;
							_drag_mode	=	false;
						}
					}
			 	}
			 	
			 	function on_mouse_down_for_waiting(id){
			 		
					_drag_start 	= 	true;
					_drag_mode	=	false;

			 		
					var datagrid = document.controls(id);													
					if (datagrid.isCell(event.target)){
//						if(datagrid.col>= datagrid.colRef("sect") && datagrid.col <= datagrid.colRef("agn_nm")){
/*							
							var advt_cont	=	datagrid.valueMatrix(datagrid.row, datagrid.colRef("advt_cont"));
							if(advt_cont == "")	{
								_drag_start 	= 	false;
								_drag_mode	=	false;
								return;
							}
*/							
							model.property("source_datagrid") = id;		
							model.property("preng_occr_seq")  = datagrid.valueMatrix(datagrid.mouseRow, datagrid.colRef("preng_occr_seq"));
							model.property("advt_cont")       = datagrid.valueMatrix(datagrid.mouseRow, datagrid.colRef("advt_cont"));
							model.property("source_row") 		= parseInt(datagrid.mouseRow);
							_drag_start 	= 	true;
							_drag_mode	=	false;
		//				}
					}
			 	}
			 	
			/**
			 * 그리드의 필수입력 확인
			 * param : gridID(그리드 ID 문자열)
			 * 그리드 세팅사항 : 일반 input항목과 마찬가지로 그리드의 컬럼에 class="req" 및 caption="컬럼명" 세팅
			 * 실행예 : if(!commGridReqCheck("datagrid1")) return;
			 */ 
			function gridReqCheck(gridID){
				
				var reqclass = "";
				var reqcaption = "";
				var grid;
			    if( typeof gridID == 'string' ) grid = document.controls(gridID);
			    else grid = gridID;
			
			    var strid = grid.attribute("id");
				var rowcnt = grid.rows;
				var colcnt = grid.cols;
				
				for(var i=grid.fixedRows ; i< rowcnt ; i++){
					rstatus = grid.rowStatus(i);
					
					for(var j=grid.fixedCols ; j< colcnt ; j++){
					
						reqclass = grid.colAttribute(j, "class");
						if(rstatus == 2 && reqclass == "req" && grid.valueMatrix(i,j) == ""){
			                commMsgBox(grid.colAttribute(j, "caption") + "은(는) 필수입력항목입니다.");
							model.setFocus(strid);
							grid.row = i;
							grid.col = j;
							grid.editCell();
							return false;
						}		
					}
					var advt_cont = grid.valueMatrix(i,grid.colRef("advt_cont"));
					var uprc = grid.valueMatrix(i,grid.colRef("uprc"));
					var advt_fee = grid.valueMatrix(i,grid.colRef("advt_fee"));
					if(advt_cont != "" || uprc != "" || advt_fee != ""){
						grid.rowStatus(i) = 2;
						grid.refresh();
					}
				}
			    return true;
			}		
			
			function recalculate(){
				
				var out_advt_fee		=	Number(model.getValue("/root/resData/out_tot_advt_fee"));
				var ex_advt_fee		=	Number(model.getValue("/root/resData/ex_tot_advt_fee"));
				var	tot_advt_fee 	= 	out_advt_fee + ex_advt_fee;

				var unasin_uprc		=	Number(model.getValue("/root/resData/unasin_uprc"));

				for(var k=1;k<=8;k++){	
					var datagrid = document.controls("dg_sect" + k);	
					
					for(var i=datagrid.fixedRows; i<datagrid.rows;i++){
						
						var advt_fee = Number(datagrid.valueMatrix(i, datagrid.colRef("advt_fee")));
						var dn 		= Number(datagrid.valueMatrix(i, datagrid.colRef("dn")));
						var cm 		= Number(datagrid.valueMatrix(i, datagrid.colRef("cm")));
						var uprc		= Number(datagrid.valueMatrix(i, datagrid.colRef("uprc")));
						
						if(advt_fee != 0){
							tot_advt_fee += advt_fee;
						}else{
							tot_advt_fee += Math.round(dn * cm * unasin_uprc);
						}
					}
				}
				
				model.setValue("/root/resData/tot_advt_fee", tot_advt_fee);
				out_tot_advt_fee.refresh();
/*				
				
				for(var k=1;k<=8;k++){	
					var sum_total = 0;
					
					var datagrid = document.controls("dg_sect" + k);	
					
					for(var i=datagrid.fixedRows; i<datagrid.rows;i++){
						
						var advt_fee = Number(datagrid.valueMatrix(i, datagrid.colRef("advt_fee")));
						var dn 		= Number(datagrid.valueMatrix(i, datagrid.colRef("dn")));
						var cm 		= Number(datagrid.valueMatrix(i, datagrid.colRef("cm")));
						var uprc		= Number(datagrid.valueMatrix(i, datagrid.colRef("uprc")));
						
						if(advt_fee != 0){
							sum_total += advt_fee;
						}else{
							sum_total += Math.round(dn * cm * unasin_uprc);
						}
					}

					var sum_datagrid = document.controls("sum_sect" + k);	
					for(var i=sum_datagrid.fixedRows; i<sum_datagrid.rows; i++){
						sum_datagrid.valueMatrix(i, sum_datagrid.colRef("advt_fee")) = sum_total;
					}
					sum_datagrid.refresh();

				}
*/				
			}
			
			function on_mouse_up(id){
				
				var datagrid = document.controls(id);	
				
				if(!datagrid.isCell(event.target) || !_drag_mode){
					_drag_start = false;
					_drag_mode  = false;		
					 return;
				}
			 		
				var preng_occr_seq = model.property("preng_occr_seq");	
				var advt_cont      = model.property("advt_cont");	
				if(advt_cont == ""){
					window.alert("옮길 데이타가 없습니다. 위치를 확인하십시요.");
					_drag_start = false;
					_drag_mode  = false;
					return;
				}	
								
				var source_datagrid	= model.property("source_datagrid");
				var source_row 		= model.property("source_row");
				
				var source_ctr  		= document.controls(source_datagrid);	
				var target_ctr  		= document.controls(id);			
				var target_row 		= target_ctr.mouseRow;				
					
				var changable_column  = target_ctr.colRef("chro_clsf_nm");//광고내용부터 데이타 변경
				
				var advt_cont = target_ctr.valueMatrix(target_row, target_ctr.colRef("advt_cont"));					
				if(advt_cont != ""){
					window.alert("이미 지정되어 있는 면수입니다. 위치를 확인하십시요.");
					_drag_start = false;
					_drag_mode  = false;
					return;
				}				
								
				var target_cm = target_ctr.valueMatrix(target_row, target_ctr.colRef("cm"));
				var target_dn = target_ctr.valueMatrix(target_row, target_ctr.colRef("dn"));
				var	target_chro_clsf	= target_ctr.valueMatrix(target_row, target_ctr.colRef("bw_clr_yn"));

				var source_cm = source_ctr.valueMatrix(source_row, source_ctr.colRef("cm"));
				var source_dn = source_ctr.valueMatrix(source_row, source_ctr.colRef("dn"));
				var	source_chro_clsf	= source_ctr.valueMatrix(source_row, source_ctr.colRef("chro_clsf"));
				
				if(target_cm != source_cm){
					alert("옮길 CM은 같아야 합니다. 위치를 확인하세요");
					_drag_start = false;
					_drag_mode  = false;
					return;
				}
				
				if(target_dn != source_dn){
					alert("옮길 단은 같아야 합니다. 위치를 확인하세요");
					_drag_start = false;
					_drag_mode  = false;
					return;
				}				
				
/*
				if(target_chro_clsf >= "1") 	target_chro_clsf =	"1";
				if(source_chro_clsf >= "1")	source_chro_clsf	=	"1";
				
				alert(target_chro_clsf + " <= " + source_chro_clsf);
				
				if(target_chro_clsf != source_chro_clsf){
					alert("옮길 색도는 같아야 합니다. 위치를 확인하세요");
					_drag_start = false;
					_drag_mode  = false;
					return;
				}				
*/
				if(source_ctr == target_ctr){	 //같은 그리드에서 위치이동할 경우	
					if(target_row >= target_ctr.fixedRows){
						for(var i=changable_column; i<=target_ctr.colRef("preng_occr_seq"); i++){
							var temp = source_ctr.valueMatrix(target_row, i);
							
							target_ctr.valueMatrix(target_row, i) = source_ctr.valueMatrix(source_row, i);
							source_ctr.valueMatrix(source_row, i) = temp;						
						}					
					}
				}else{//다른 섹션에서 이동할 경우				
					if(target_row >= target_ctr.fixedRows){
						for(var i=changable_column; i<=target_ctr.colRef("preng_occr_seq"); i++){
							
							target_ctr.valueMatrix(target_row, i) = source_ctr.valueMatrix(source_row, i);
						}
						if(source_datagrid == "dg_sect0"){
							for(var i=1; i<=source_ctr.colRef("preng_occr_seq"); i++){
								source_ctr.valueMatrix(source_row, i) = "";
							}		
						}else{
							for(var i=changable_column; i<=source_ctr.colRef("preng_occr_seq"); i++){
								//if(i == source_ctr.colRef("chro_clsf")) continue;
								source_ctr.valueMatrix(source_row, i) = "";
							}		
						}
					}				
				}

				//source_ctr.rowStatus(source_row) = "4";//"delete";
				//target_ctr.rowStatus(target_row) = "2";//"update";	
				source_ctr.addStatus(source_row,"delete");
				target_ctr.addStatus(target_row,"update");
				source_ctr.refresh();
				target_ctr.refresh();
				
				_drag_start = false;
				_drag_mode  = false;
				
				recalculate();
												
			}	 	
			
	
			function on_mouse_up_for_waiting(id){
				
				var datagrid = document.controls(id);	
				if (!datagrid.isCell(event.target)) return;
				
				if(!_drag_mode){
					_drag_start = false;
					_drag_mode  = false;		
					 return;
				}
			 		
				var preng_occr_seq = model.property("preng_occr_seq");	
				var advt_cont      = model.property("advt_cont");	
				if(advt_cont == ""){
					window.alert("옮길 데이타가 없습니다. 위치를 확인하십시요.");
					_drag_start = false;
					_drag_mode  = false;
					return;
				}	
								
				var source_datagrid	= model.property("source_datagrid");
				var source_row 		= model.property("source_row");
				
				var source_ctr  		= document.controls(source_datagrid);	
				var target_ctr  		= document.controls(id);			
				var target_row 		= target_ctr.mouseRow;				
					
				var changable_column  = target_ctr.colRef("chro_clsf_nm");//광고내용부터 데이타 변경
				
				var advt_cont = target_ctr.valueMatrix(target_row, target_ctr.colRef("advt_cont"));					
				if(advt_cont != ""){
					window.alert("이미 지정되어 있는 면수입니다. 위치를 확인하십시요.");
					_drag_start = false;
					_drag_mode  = false;
					return;
				}				
								
				var target_cm = target_ctr.valueMatrix(target_row, target_ctr.colRef("cm"));
				var target_dn = target_ctr.valueMatrix(target_row, target_ctr.colRef("dn"));

				var source_cm = source_ctr.valueMatrix(source_row, source_ctr.colRef("cm"));
				var source_dn = source_ctr.valueMatrix(source_row, source_ctr.colRef("dn"));
/*				
				if(target_cm != source_cm){
					alert("옮길 CM은 같아야 합니다. 위치를 확인하세요");
					_drag_start = false;
					_drag_mode  = false;
					return;
				}
				
				if(target_dn != source_dn){
					alert("옮길 단은 같아야 합니다. 위치를 확인하세요");
					_drag_start = false;
					_drag_mode  = false;
					return;
				}				
*/			
				if(target_row >= target_ctr.fixedRows){
					for(var i=1; i<=target_ctr.cols; i++){
						target_ctr.valueMatrix(target_row, i) = source_ctr.valueMatrix(source_row, i);
					}
					
					if(source_ctr == target_ctr){
						for(var i=1; i<=target_ctr.cols; i++){
							source_ctr.valueMatrix(source_row, i) = "";
						}				
					}else{
						for(var i=changable_column; i<source_ctr.colRef("preng_occr_seq"); i++){
//							if(i == source_ctr.colRef("chro_clsf")) continue;
							source_ctr.valueMatrix(source_row, i) = "";
						}				
					}
				}

				//source_ctr.rowStatus(source_row) = "4";//"delete";
				source_ctr.removeStatus(source_row,"update");
				target_ctr.rowStatus(target_row) = "2";//"update";				
				source_ctr.refresh();
				target_ctr.refresh();
				
				_drag_start = false;
				_drag_mode  = false;
											
											
				recalculate();	
			}	 				
			
			function goReport(gubun, show_uprc){
				// 오즈관련 노드 초기화..					
				resetOznode();													
							
				var root			= "/root/reqData/";
				var root2            	= "/root/resData/";
											
				var pubc_dt		= model.getValue(root + "/pubc_dt");
				var unasin_uprc     	= model.getValue(root2 + "/unasin_uprc"); 
				var avg_uprc     	= model.getValue(root2 + "/avg_uprc"); 
				var tot_advt_fee        	= model.getValue(root2 + "/tot_advt_fee");
			
				if ( pubc_dt == "" ){
					commAlert("게재일자가 없습니다.");
					return;
				}								
				var dept_cd = model.property("ss_deptcd").substring(0,2);
				var emp_no  = model.property("ss_emp_no").substring(0,2);
				
				if (dept_cd == "36" || emp_no == "it"){
					makeNodeValue("/root/oz_data/childCount","1");	
				}
				// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
				makeNodeValue("/root/oz_data/ozrName", "ad/SP_AD_RES_1410_P");	
				
				makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd",model.property("ss_cmpycd"));	
				makeNodeValue("/root/oz_data/odiParam/iv_pubc_dt"		, pubc_dt	);					
				makeNodeValue("/root/oz_data/odiParam/iv_unasin_uprc"	, unasin_uprc);	
				makeNodeValue("/root/oz_data/odiParam/iv_avg_uprc"		, avg_uprc);	
				makeNodeValue("/root/oz_data/odiParam/iv_tot_advt_fee"		, tot_advt_fee);	
				makeNodeValue("/root/oz_data/odiParam/iv_show_uprc"		, show_uprc);	//단가보여주시 여부

				if (dept_cd == "36" || emp_no == "it"){
					makeNodeValue("/root/oz_data/child1/ozrName", "ad/SP_AD_RES_1411_P");	
					
					makeNodeValue("/root/oz_data/child1/odiParam/iv_cmpy_cd",model.property("ss_cmpycd"));	
					makeNodeValue("/root/oz_data/child1/odiParam/iv_pubc_dt"		, pubc_dt	);					
					makeNodeValue("/root/oz_data/child1/odiParam/iv_unasin_uprc"	, unasin_uprc);	
					makeNodeValue("/root/oz_data/child1/odiParam/iv_avg_uprc"		, avg_uprc);	
					makeNodeValue("/root/oz_data/child1/odiParam/iv_tot_advt_fee"		, tot_advt_fee);	
					makeNodeValue("/root/oz_data/child1/odiParam/iv_show_uprc"		, show_uprc);	//단가보여주시 여부
				}
			
				// 레포트뷰어 호출.					
				openOzwin("/root/oz_data");	
			}
			
			
			var _dlco_no_ref;
			var _dlco_nm_ref;
			var _dlco_clsf_ref;
			

			function findDlcoNo(dlco_clsf, dlco_nm, dlco_no_ref, dlco_nm_ref, dlco_clsf_ref){
				
				if(trim(srch_nm) == ""){
					model.setValue(ctrl_cd_ref, "");
					model.setValue(dlco_nm_ref, "");
					model.setValue(dlco_clsf_ref, "");
					return;
				}
				
				_dlco_no_ref 	= dlco_no_ref;
				_dlco_nm_ref 	= dlco_nm_ref;
				_dlco_clsf_ref 	= dlco_clsf_ref;
				
				makeNodeValue("/root/tempData/searchData/action", "9004");
				makeNodeValue("/root/tempData/searchData/dlco_clsf", dlco_clsf);
				makeNodeValue("/root/tempData/searchData/srch_nm", dlco_nm);
				
				modelSendNoMake("ad_co_9008_s", "/ad/common/9008", "/root/tempData/searchData", "/root/tempData/resData");
				
				var chk_cnt = Number(model.getValue("/root/tempData/resData/chk_cnt"));
				
				if(chk_cnt > 1){
					if(dlco_clsf == "1"){
						showAdvcsSearchPopup("Y", "Y", "", "", "", dlco_nm); 
					}else if(dlco_clsf == "2"){
						showAdvcsSearchPopup("", "", "Y", "", "", dlco_nm); 
					}else if(dlco_clsf == "4"){
						showAdvcsSearchPopup("", "", "", "Y", "Y", srch_nm); 
					}else if(dlco_clsf == "24"){
						showAdvcsSearchPopup("", "", "Y", "Y", "Y", dlco_nm); 
					}else{
						showAdvcsSearchPopup("Y", "Y", "Y", "Y", "Y", dlco_nm); 
					}
				}else{	
					var srch_cd = model.getValue("/root/tempData/resData/srch_cd");
					var srch_nm = model.getValue("/root/tempData/resData/srch_nm");
					var dlco_clsf = model.getValue("/root/tempData/resData/dlco_clsf");
					if(srch_cd == ""){
						srch_nm 		= "";
						dlco_clsf 	= "";
					}
					model.setValue(dlco_no_ref, srch_cd);
					model.setValue(dlco_nm_ref, srch_nm);	
					model.setValue(dlco_clsf_ref, dlco_clsf);	
				}
			}
						
			 	
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main_max" pagewidth="1024" pageheight="1200" guideline="1,10;2,822;1,1024;2,768;2,96;1,509;2,762;" style="font-family:굴림; ">
		<datagrid id="sum_sect1" nodeset="/root/resData/sumGridData1/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 100, 50, 68, 87" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:5px; top:711px; width:490px; height:42px; font-family:굴림,arial; font-size:8pt; ">
			<col ref="lbl"/>
			<col ref="dn" style="text-align:right; "/>
			<col ref="chro_clsf_nm"/>
			<col ref="advt_cont"/>
			<col ref="uprc" format="#,###" style="text-align:right; "/>
			<col ref="advt_fee" format="#,###" style="text-align:right; "/>
			<col ref="slcrg_pers"/>
		</datagrid>
		<output id="output2" ref="/root/resData/ex_tot_advt_fee" visibility="hidden" style="left:275px; top:790px; width:100px; height:18px; "/>
		<output id="output1" ref="/root/resData/out_tot_advt_fee" visibility="hidden" style="left:170px; top:790px; width:100px; height:18px; "/>
		<datagrid id="dg_sect1" nodeset="/root/resData/gridData1/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^CHRO_CLSF^BW_CLR_YN^SEQ^ISSU_SIDE^SECT_CD^SECT_SEQ" colsep="#" colwidth="30, 30, 30, 35, 100, 50, 68, 65, 59, 24, 35, 100, 100, 29, 40, 28, 34" rowsep="|" style="left:5px; top:115px; width:490px; height:617px; font-family:굴림,arial; font-size:8pt; cursor:hand; ">
			<col ref="sect" style="text-align:center; "/>
			<col ref="dn" style="text-align:right; "/>
			<col ref="cm" style="text-align:right; "/>
			<col ref="chro_clsf_nm"/>
			<col class="req" imemode="hangul" ref="advt_cont" type="input" caption="광고내용" style="text-align:left; word-wrap:none; "/>
			<col class="req" ref="uprc" type="input" format="#,###" caption="단가" style="text-align:right; "/>
			<col class="req" ref="advt_fee" type="input" format="#,###" caption="광고료" style="text-align:right; "/>
			<col ref="slcrg_pers" type="combo" caption="영업담당" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="agn_nm" type="input" caption="취급처" style="text-align:left; word-wrap:none; "/>
			<col ref="agn" visibility="hidden"/>
			<col ref="dlco_clsf" visibility="hidden"/>
			<col ref="chro_clsf" visibility="hidden"/>
			<col ref="bw_clr_yn" visibility="hidden"/>
			<col ref="preng_occr_seq" visibility="hidden"/>
			<col ref="issu_side" visibility="hidden"/>
			<col ref="sect_cd" visibility="hidden"/>
			<col ref="sect_seq" visibility="hidden"/>
			<script type="javascript" ev:event="onmousedown">
				<![CDATA[				
				on_mouse_down(event.currentTarget);
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var datagrid = dg_sect1;
				if(datagrid.col == datagrid.colRef("uprc") || datagrid.col == datagrid.colRef("advt_fee")){
					calcuateAdvtFee(datagrid);
				}else if(datagrid.col == datagrid.colRef("agn_nm")){
										
					var row 		= datagrid.row;
					var agn_nm   = datagrid.valueMatrix(row, datagrid.colRef("agn_nm"));
					
					var dataIndex = getSelectedRecordIndex(datagrid);
					if(agn_nm != ""){
						findDlcoNo("24", agn_nm, "/root/resData/gridData1/record["+dataIndex+"]/agn", "/root/resData/gridData1/record["+dataIndex+"]/agn_nm", "/root/resData/gridData1/record["+dataIndex+"]/dlco_clsf");
					}else{
						model.setValue("/root/resData/gridData1/record["+dataIndex+"]/agn", "");
					}		
					datagrid.refresh();
				}
					//값 변경 row 상태값 변경
					//dg_sect1.addStatus(dg_sect1.row,"update");	
					//dg_sect1.refresh();
				]]>
			</script>
			<script type="javascript" ev:event="onmousemove">
				<![CDATA[
				if(_drag_start){			
					_drag_mode = true;			
				}
				]]>
			</script>
			<script type="javascript" ev:event="onmouseup">
				<![CDATA[
				on_mouse_up(event.currentTarget);
				]]>
			</script>
			<script type="javascript" ev:event="onstartedit">
				<![CDATA[
				
				var row = dg_sect1.row;
				var col = dg_sect1.col;
				
				var	dn = Number(dg_sect1.valueMatrix(row, dg_sect1.colRef("dn")));
				var	cm = Number(dg_sect1.valueMatrix(row, dg_sect1.colRef("cm")));
				
				if(dn == 0 || cm == 0){
					if(col == dg_sect1.colRef("advt_cont")){
						
					}
				}
				]]>
			</script>
		</datagrid>
		<caption id="caption15" ref="/root/reqData/preng_occr_dt" class="list_cap02" style="left:6px; top:41px; width:660px; height:26px; "/>
		<caption id="caption16" class="list_cap02" style="left:201px; top:66px; width:465px; height:26px; "/>
		<caption id="caption17" class="list_cap01" style="left:5px; top:41px; width:60px; height:26px; ">게재일자</caption>
		<input id="inp_pubc_dt" ref="/root/reqData/pubc_dt" class="req" inputtype="date" format="yyyy-mm-dd" caption="게재일자" style="left:70px; top:45px; width:85px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[	

			    initVariables();
			    loadData();		
			    					
				]]>
			</script>
		</input>
		<caption id="caption18" class="list_cap01" style="left:520px; top:41px; width:65px; height:26px; ">광고점유율</caption>
		<caption id="caption19" class="list_cap01" style="left:290px; top:41px; width:65px; height:26px; ">총광고면수</caption>
		<output id="input9" ref="/root/resData/tot_dn_cnt" appearance="output" style="left:473px; top:45px; width:45px; height:18px; text-align:right; "/>
		<caption id="caption20" class="list_cap01" style="left:405px; top:41px; width:65px; height:26px; ">총광고단수</caption>
		<output id="input10" ref="/root/resData/tot_side_cnt" appearance="output" style="left:358px; top:45px; width:45px; height:18px; text-align:right; "/>
		<output id="out_preng_clos_yn" ref="/root/resData/preng_clos_yn" style="left:268px; top:45px; width:20px; height:18px; text-align:center; "/>
		<caption id="caption21" class="list_cap01" style="left:200px; top:41px; width:65px; height:26px; ">예약마감</caption>
		<output id="input11" ref="/root/resData/advs_ocpy_rate" appearance="output" style="left:588px; top:46px; width:75px; height:18px; text-align:right; "/>
		<output id="input12" ref="/root/resData/avg_uprc" format="#,###" appearance="output" style="left:473px; top:70px; width:45px; height:18px; text-align:right; "/>
		<output id="out_tot_advt_fee" ref="/root/resData/tot_advt_fee" format="#,###" appearance="output" style="left:588px; top:70px; width:75px; height:18px; text-align:right; "/>
		<caption id="caption22" class="list_cap01" style="left:290px; top:66px; width:65px; height:26px; ">미배정단가</caption>
		<caption id="caption23" class="list_cap01" style="left:405px; top:66px; width:65px; height:26px; ">평균단가</caption>
		<caption id="caption24" class="list_cap01" style="left:520px; top:66px; width:65px; height:26px; ">예상게재액</caption>
		<caption id="caption25" class="list_cap01" style="left:200px; top:66px; width:65px; height:26px; ">추정표승인</caption>
		<output id="out_asum_shet_aprv_yn" ref="/root/resData/asum_shet_aprv_yn" style="left:268px; top:70px; width:20px; height:18px; text-align:center; "/>
		<input id="input14" ref="/root/resData/unasin_uprc" format="#,###" style="left:358px; top:70px; width:45px; height:18px; text-align:right; "/>
		<button id="button9" class="btn04" crud="R" style="left:670px; top:45px; width:90px; height:21px; ">
			<caption>대기/기사/지방</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				if(_pubc_clsf_idx == 0){
					if(isDataGridUpdated(dg_sect0)){
						alert("대기광고의 면배정이 있습니다. 저장 후 조회하시기 바랍니다.");
						return;
					}
				}
				
				if(_pubc_clsf_idx == 2){
					_pubc_clsf_idx	=	0;
				}else{
					_pubc_clsf_idx++;
				}
				
				var left   	= group1.currentStyle.left;
				var top    	= group1.currentStyle.top;
				var width  	= group1.currentStyle.width;
				var	height	= group1.currentStyle.height;
				
				var dg_left   	= dg_sect0.currentStyle.left;
				var dg_top    	= dg_sect0.currentStyle.top;
				var dg_width  	= dg_sect0.currentStyle.width;
				var	dg_height	= dg_sect0.currentStyle.height;
				
				var sum_left   	= sum_sect1.currentStyle.left;
				var sum_top    	= sum_sect1.currentStyle.top;
				var sum_width  	= sum_sect1.currentStyle.width;
				var	sum_height	= sum_sect1.currentStyle.height;
						
				if(_pubc_clsf_idx	 ==	0){
					group1.visible 	= true;
					group1_1.visible = false;
					group1_2.visible = false;
					
					group1.attribute("left") 		= left;
					group1.attribute("top")		= top;
					group1.attribute("width") 	= width;
					group1.attribute("height") 	= height;
					
					dg_sect0.attribute("left") 	= dg_left;
					dg_sect0.attribute("top")		= dg_top;
					dg_sect0.attribute("width") 	= dg_width;
					dg_sect0.attribute("height") 	= dg_height;
					
					sum_sect1.attribute("left") 	= sum_left;
					sum_sect1.attribute("top")	= sum_top;
					sum_sect1.attribute("width") 	= sum_width;
					sum_sect1.attribute("height")	= sum_height;
					
				}else if(_pubc_clsf_idx	 ==	1){
					group1.visible 	= false;
					group1_1.visible = true;
					group1_2.visible = false;

					group1_1.attribute("left") 	= left;
					group1_1.attribute("top")		= top;
					group1_1.attribute("width") 	= width;
					group1_1.attribute("height") 	= height;

					dg_sect0_1.attribute("left") 		= dg_left;
					dg_sect0_1.attribute("top")		= dg_top;
					dg_sect0_1.attribute("width") 	= dg_width;
					dg_sect0_1.attribute("height") 	= dg_height;
					
					sum_dg_sect0_1.attribute("left") 	= sum_left;
					sum_dg_sect0_1.attribute("top")	= sum_top;
					sum_dg_sect0_1.attribute("width") 	= sum_width;
					sum_dg_sect0_1.attribute("height")	= sum_height;					
										
				}else if(_pubc_clsf_idx	 ==	2){
					group1.visible 	= false;
					group1_1.visible = false;
					group1_2.visible = true;
					
					group1_2.attribute("left") 	= left;
					group1_2.attribute("top")		= top;
					group1_2.attribute("width") 	= width;
					group1_2.attribute("height") 	= height;
					
					dg_sect0_2.attribute("left") 		= dg_left;
					dg_sect0_2.attribute("top")		= dg_top;
					dg_sect0_2.attribute("width") 	= dg_width;
					dg_sect0_2.attribute("height") 	= dg_height;
					
					sum_dg_sect0_2.attribute("left") 	= sum_left;
					sum_dg_sect0_2.attribute("top")	= sum_top;
					sum_dg_sect0_2.attribute("width") 	= sum_width;
					sum_dg_sect0_2.attribute("height")	= sum_height;	
				}
				
				
				model.setValue("/root/reqData/pubc_clsf", _pubc_clsfs[_pubc_clsf_idx]);
				model.send("ad_res_1420_l");
				
				]]>
			</script>
		</button>
		<button id="button10" class="btn02" crud="P" style="left:761px; top:45px; width:50px; height:21px; ">
			<caption>인쇄</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var show_uprc = model.getValue("/root/resData/show_uprc");
				
				goReport("P",show_uprc );	
				]]>
			</script>
		</button>
		<button id="button12" class="btn02" crud="A" style="left:947px; top:45px; width:52px; height:21px; ">
			<caption>저장</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				if(!gridReqCheck("dg_sect1"))					return;
				if(!gridReqCheck("dg_sect2"))					return;
				if(!gridReqCheck("dg_sect3"))					return;
				if(!gridReqCheck("dg_sect4"))					return;
				if(!gridReqCheck("dg_sect5"))					return;
				if(!gridReqCheck("dg_sect6"))					return;
				if(!gridReqCheck("dg_sect7"))					return;
				if(!gridReqCheck("dg_sect8"))					return;
				

				if(windowConfirm("저장하시겠습니까?")){
									
					makeNodeValue("/root/reqData/unasin_uprc", model.getValue("/root/resData/unasin_uprc"));
					
					makeNodeValue("/root/reqData/multiUpdateData0", dg_sect0.getUpdateData());
					makeNodeValue("/root/reqData/multiUpdateData1", dg_sect1.getUpdateData());
					makeNodeValue("/root/reqData/multiUpdateData2", dg_sect2.getUpdateData());
					makeNodeValue("/root/reqData/multiUpdateData3", dg_sect3.getUpdateData());
					makeNodeValue("/root/reqData/multiUpdateData4", dg_sect4.getUpdateData());
					makeNodeValue("/root/reqData/multiUpdateData5", dg_sect5.getUpdateData());
					makeNodeValue("/root/reqData/multiUpdateData6", dg_sect6.getUpdateData());
					makeNodeValue("/root/reqData/multiUpdateData7", dg_sect7.getUpdateData());
					makeNodeValue("/root/reqData/multiUpdateData8", dg_sect8.getUpdateData());
					
					model.send("ad_res_1430_u");
					
					if(submit_completed()){
						loadData();		
					}
				}					
				
				]]>
			</script>
		</button>
		<button id="button13" class="btn04" crud="A" style="left:670px; top:69px; width:90px; height:21px; ">
			<caption>예약마감</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if(windowConfirm("예약마감을 하시겠습니까?")){
					model.setValue("/root/reqData/clos_clsf", "1");
					model.setValue("/root/reqData/preng_clos_yn", "Y");
					model.send("ad_res_1440_u");
					
					if(submit_completed()){
						model.setValue("/root/resData/preng_clos_yn", "Y");
						out_preng_clos_yn.refresh();
					}						
				}
				]]>
			</script>
		</button>
		<button id="button14" class="btn04" crud="A" style="left:761px; top:69px; width:95px; height:21px; ">
			<caption>마감취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				if(windowConfirm("예약마감취소를 하시겠습니까?")){
					model.setValue("/root/reqData/clos_clsf", "1");
					model.setValue("/root/reqData/preng_clos_yn", "N");
					model.send("ad_res_1440_u");
					
					if(submit_completed()){
						model.setValue("/root/resData/preng_clos_yn", "N");
						out_preng_clos_yn.refresh();
					}						
				}
				
				]]>
			</script>
		</button>
		<button id="button15" class="btn02" crud="R" style="left:144px; top:71px; width:52px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				    initVariables();
				    loadData();		
				]]>
			</script>
		</button>
		<button id="button16" class="btn04" crud="A" style="left:858px; top:68px; width:90px; height:21px; ">
			<caption>추정표승인</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				if( isDataGridUpdated(dg_sect0) ||
					isDataGridUpdated(dg_sect1) ||
					isDataGridUpdated(dg_sect2) ||
					isDataGridUpdated(dg_sect3) ||
					isDataGridUpdated(dg_sect4) ||
					isDataGridUpdated(dg_sect5) ||
					isDataGridUpdated(dg_sect6) ||
					isDataGridUpdated(dg_sect7) ||
					isDataGridUpdated(dg_sect8)
				) {
					alert("수정된 내역이 있습니다. 저장을 먼저 하시기 바랍니다.");
					return;
				}
				
				
				if(windowConfirm("광고액추정표 데이타가 만들어 집니다. 추정표승인을 하시겠습니까?")){
					model.setValue("/root/reqData/clos_clsf", "2");
					model.send("ad_res_1440_u");	
					
					if(submit_completed()){
						model.setValue("/root/resData/asum_shet_aprv_yn", "Y");
						out_asum_shet_aprv_yn.refresh();
					}											
				}			
				]]>
			</script>
		</button>
		<caption id="caption2" ref="/root/resData/gridData1/sect_nm" class="tit02" style="left:5px; top:94px; width:182px; height:20px; ">S1</caption>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar_1024.xrw" style="left:5px; top:5px; width:995px; height:34px; "/>
		<button id="button1" class="btn04" crud="R" style="left:858px; top:45px; width:90px; height:21px; ">
			<caption>광고액추정표</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					
					var pubc_dt = model.getValue("/root/reqData/pubc_dt");
					model.property("res_2000_pubc_dt") = pubc_dt;
					
					viewer("mainFrame").window.javaScript.onLoadPage2("AD_RES_2000");
				]]>
			</script>
		</button>
		<group id="group2" visibility="hidden" style="left:499px; top:180px; width:500px; height:85px; ">
			<datagrid id="sum_sect2" nodeset="/root/resData/sumGridData2/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 90, 55, 68, 70" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:41px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="lbl"/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont"/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col ref="slcrg_pers"/>
			</datagrid>
			<datagrid id="dg_sect2" nodeset="/root/resData/gridData2/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^CHRO_CLSF^BW_CLR_YN^SEQ^ISSU_SIDE^SECT_CD^SECT_SEQ" colsep="#" colwidth="30, 30, 30, 35, 90, 55, 68, 65, 24, 35, 26, 100, 100, 30, 25, 30, 26" rowsep="|" style="left:0px; top:20px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="sect" style="text-align:center; "/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="cm" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col class="req" imemode="hangul" ref="advt_cont" type="input" caption="광고내용" style="text-align:left; word-wrap:none; "/>
				<col class="req" ref="uprc" type="input" format="#,###" caption="단가" style="text-align:right; "/>
				<col class="req" ref="advt_fee" type="input" format="#,###" caption="광고료" style="text-align:right; "/>
				<col ref="slcrg_pers" type="combo" caption="영업담당" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="agn_nm" type="input" caption="취급처" style="text-align:left; word-wrap:none; "/>
				<col ref="agn" visibility="hidden"/>
				<col ref="dlco_clsf" visibility="hidden"/>
				<col ref="chro_clsf" visibility="hidden"/>
				<col ref="bw_clr_yn" visibility="hidden"/>
				<col ref="preng_occr_seq" visibility="hidden"/>
				<col ref="issu_side" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<col ref="sect_seq" visibility="hidden"/>
				<script type="javascript" ev:event="onmousedown">
					<![CDATA[					
					on_mouse_down(event.currentTarget);
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
				var datagrid = dg_sect2;
				if(datagrid.col == datagrid.colRef("uprc") || datagrid.col == datagrid.colRef("advt_fee")){
					calcuateAdvtFee(datagrid);
				}else if(datagrid.col == datagrid.colRef("agn_nm")){
										
					var row 		= datagrid.row;
					var agn_nm   = datagrid.valueMatrix(row, datagrid.colRef("agn_nm"));
					
					if(agn_nm != ""){
						var dataIndex = getSelectedRecordIndex(datagrid);
						findDlcoNo("24", agn_nm, "/root/resData/gridData2/record["+dataIndex+"]/agn", "/root/resData/gridData2/record["+dataIndex+"]/agn_nm", "/root/resData/gridData2/record["+dataIndex+"]/dlco_clsf");
					}		
				}
					//값 변경 row 상태값 변경
					//dg_sect2.addStatus(dg_sect2.row,"update");
					//dg_sect2.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="onmousemove">
					<![CDATA[

				if(_drag_start){			
					_drag_mode = true;			
				}					
					]]>
				</script>
				<script type="javascript" ev:event="onmouseup">
					<![CDATA[
					on_mouse_up(event.currentTarget);
					]]>
				</script>
			</datagrid>
			<caption id="caption7" ref="/root/resData/gridData2/sect_nm" class="tit02" style="left:0px; top:0px; width:182px; height:20px; ">S2</caption>
		</group>
		<group id="group1" visibility="hidden" style="left:500px; top:95px; width:500px; height:85px; ">
			<datagrid id="sum_sect0" nodeset="/root/resData1/sumGridData/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 90, 55, 68, 70" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:41px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="lbl"/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont"/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col ref="slcrg_pers_nm"/>
			</datagrid>
			<datagrid id="dg_sect0" nodeset="/root/resData1/gridData/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^CHRO_CLSF^BW_CLR_YN^SEQ^ISSU_SIDE^SECT_CD" colsep="#" colwidth="30, 30, 30, 35, 90, 55, 68, 65, 40, 35, 40, 100, 100, 40, 40, 40" rowsep="|" style="left:0px; top:20px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; cursor:hand; ">
				<col ref="sect" style="text-align:left; "/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="cm" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont" style="text-align:left; word-wrap:none; "/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col disabled="true" ref="slcrg_pers" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="agn_nm" style="text-align:left; word-wrap:none; "/>
				<col ref="agn" visibility="hidden"/>
				<col ref="dlco_clsf" visibility="hidden"/>
				<col ref="chro_clsf" visibility="hidden"/>
				<col ref="bw_clr_yn" visibility="hidden"/>
				<col ref="preng_occr_seq" visibility="hidden"/>
				<col ref="issu_side" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<script type="javascript" ev:event="onmousedown">
					<![CDATA[
					on_mouse_down_for_waiting(event.currentTarget);
					]]>
				</script>
				<script type="javascript" ev:event="onmousemove">
					<![CDATA[
					if(_drag_start){			
						_drag_mode = true;			
					}							
					]]>
				</script>
				<script type="javascript" ev:event="onmouseup">
					<![CDATA[
					on_mouse_up_for_waiting(event.currentTarget);		
					]]>
				</script>
			</datagrid>
			<caption id="cap_lbl" class="tit02" style="left:0px; top:0px; width:182px; height:20px; ">대기광고</caption>
		</group>
		<group id="group3" visibility="hidden" style="left:499px; top:265px; width:500px; height:85px; ">
			<datagrid id="sum_sect3" nodeset="/root/resData/sumGridData3/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 90, 55, 68, 70" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:40px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="lbl"/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont"/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col ref="slcrg_pers"/>
			</datagrid>
			<datagrid id="dg_sect3" nodeset="/root/resData/gridData3/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^CHRO_CLSF^BW_CLR_YN^SEQ^ISSU_SIDE^SECT_CD^SECT_SEQ" colsep="#" colwidth="30, 30, 30, 35, 90, 55, 68, 65, 65, 30, 35, 100, 100, 30, 30, 30, 30" rowsep="|" style="left:0px; top:19px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="sect" style="text-align:center; "/>
				<col ref="dn" style="text-align:center; "/>
				<col ref="cm" style="text-align:center; "/>
				<col ref="chro_clsf_nm"/>
				<col class="req" imemode="hangul" ref="advt_cont" type="input" caption="광고내용" style="text-align:left; word-wrap:none; "/>
				<col class="req" ref="uprc" type="input" format="#,###" caption="단가" style="text-align:right; "/>
				<col class="req" ref="advt_fee" type="input" format="#,###" caption="광고료" style="text-align:right; "/>
				<col ref="slcrg_pers" type="combo" caption="영업담당" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="agn_nm" type="input" caption="취급처" style="text-align:left; word-wrap:none; "/>
				<col ref="agn" visibility="hidden"/>
				<col ref="dlco_clsf" visibility="hidden"/>
				<col ref="chro_clsf" visibility="hidden"/>
				<col ref="bw_clr_yn" visibility="hidden"/>
				<col ref="preng_occr_seq" visibility="hidden"/>
				<col ref="issu_side" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<col ref="sect_seq" visibility="hidden"/>
				<script type="javascript" ev:event="onmousedown">
					<![CDATA[	
					on_mouse_down(event.currentTarget);
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[

				var datagrid = dg_sect3;
				if(datagrid.col == datagrid.colRef("uprc") || datagrid.col == datagrid.colRef("advt_fee")){
					calcuateAdvtFee(datagrid);
				}else if(datagrid.col == datagrid.colRef("agn_nm")){
										
					var row 		= datagrid.row;
					var agn_nm   = datagrid.valueMatrix(row, datagrid.colRef("agn_nm"));
					
					if(agn_nm != ""){
						var dataIndex = getSelectedRecordIndex(datagrid);
						findDlcoNo("24", agn_nm, "/root/resData/gridData3/record["+dataIndex+"]/agn", "/root/resData/gridData3/record["+dataIndex+"]/agn_nm", "/root/resData/gridData3/record["+dataIndex+"]/dlco_clsf");
					}		
				}	
					//값 변경 row 상태값 변경
					//dg_sect3.addStatus(dg_sect3.row,"update");	
					//dg_sect3.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="onmousemove">
					<![CDATA[
				if(_drag_start){			
					_drag_mode = true;			
				}					
					]]>
				</script>
				<script type="javascript" ev:event="onmouseup">
					<![CDATA[
					on_mouse_up(event.currentTarget);
					]]>
				</script>
			</datagrid>
			<caption id="caption9" ref="/root/resData/gridData3/sect_nm" class="tit02" style="left:2px; top:0px; width:182px; height:20px; ">S3</caption>
		</group>
		<group id="group4" visibility="hidden" style="left:499px; top:350px; width:500px; height:85px; ">
			<datagrid id="sum_sect4" nodeset="/root/resData/sumGridData4/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 90, 55, 68, 70" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:41px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="lbl"/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont"/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col ref="slcrg_pers"/>
			</datagrid>
			<datagrid id="dg_sect4" nodeset="/root/resData/gridData4/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^CHRO_CLSF^BW_CLR_YN^SEQ^ISSU_SIDE^SECT_CD^SECT_SEQ" colsep="#" colwidth="30, 30, 30, 35, 90, 55, 68, 65, 65, 30, 35, 100, 100, 30, 30, 30, 30" rowsep="|" style="left:0px; top:20px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="sect" style="text-align:center; "/>
				<col ref="dn" style="text-align:center; "/>
				<col ref="cm" style="text-align:center; "/>
				<col ref="chro_clsf_nm"/>
				<col class="req" imemode="hangul" ref="advt_cont" type="input" caption="광고내용" style="text-align:left; word-wrap:none; "/>
				<col class="req" ref="uprc" type="input" format="#,###" caption="단가" style="text-align:right; "/>
				<col class="req" ref="advt_fee" type="input" format="#,###" caption="광고료" style="text-align:right; "/>
				<col ref="slcrg_pers" type="combo" caption="영업담당" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="agn_nm" type="input" caption="취급처" style="text-align:left; word-wrap:none; "/>
				<col ref="agn" visibility="hidden"/>
				<col ref="dlco_clsf" visibility="hidden"/>
				<col ref="chro_clsf" visibility="hidden"/>
				<col ref="bw_clr_yn" visibility="hidden"/>
				<col ref="preng_occr_seq" visibility="hidden"/>
				<col ref="issu_side" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<col ref="sect_seq" visibility="hidden"/>
				<script type="javascript" ev:event="onmousedown">
					<![CDATA[	
					on_mouse_down(event.currentTarget);			
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[

				var datagrid = dg_sect4;
				if(datagrid.col == datagrid.colRef("uprc") || datagrid.col == datagrid.colRef("advt_fee")){
					calcuateAdvtFee(datagrid);
				}else if(datagrid.col == datagrid.colRef("agn_nm")){
										
					var row 		= datagrid.row;
					var agn_nm   = datagrid.valueMatrix(row, datagrid.colRef("agn_nm"));
					
					if(agn_nm != ""){
						var dataIndex = getSelectedRecordIndex(datagrid);
						findDlcoNo("24", agn_nm, "/root/resData/gridData4/record["+dataIndex+"]/agn", "/root/resData/gridData4/record["+dataIndex+"]/agn_nm", "/root/resData/gridData4/record["+dataIndex+"]/dlco_clsf");
					}		
				}		
					//값 변경 row 상태값 변경
					//dg_sect4.addStatus(dg_sect4.row,"update");
					//dg_sect4.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="onmousemove">
					<![CDATA[
				if(_drag_start){			
					_drag_mode = true;			
				}					
					]]>
				</script>
				<script type="javascript" ev:event="onmouseup">
					<![CDATA[
					on_mouse_up(event.currentTarget);
									
					]]>
				</script>
			</datagrid>
			<caption id="caption1" ref="/root/resData/gridData4/sect_nm" class="tit02" style="left:0px; top:0px; width:182px; height:20px; ">S4</caption>
		</group>
		<group id="group5" visibility="hidden" style="left:499px; top:435px; width:500px; height:85px; ">
			<datagrid id="sum_sect5" nodeset="/root/resData/sumGridData5/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 90, 55, 68, 70" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:41px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="lbl"/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont"/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col ref="slcrg_pers"/>
			</datagrid>
			<datagrid id="dg_sect5" nodeset="/root/resData/gridData5/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^CHRO_CLSF^BW_CLR_YN^SEQ^ISSU_SIDE^SECT_CD^SECT_SEQ" colsep="#" colwidth="30, 30, 30, 35, 90, 55, 68, 65, 65, 30, 35, 100, 100, 30, 30, 30, 30" rowsep="|" style="left:0px; top:20px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="sect" style="text-align:center; "/>
				<col ref="dn" style="text-align:center; "/>
				<col ref="cm" style="text-align:center; "/>
				<col ref="chro_clsf_nm"/>
				<col class="req" imemode="hangul" ref="advt_cont" type="input" caption="광고내용" style="text-align:left; word-wrap:none; "/>
				<col class="req" ref="uprc" type="input" format="#,###" caption="단가" style="text-align:right; "/>
				<col class="req" ref="advt_fee" type="input" format="#,###" caption="광고료" style="text-align:right; "/>
				<col ref="slcrg_pers" type="combo" caption="영업담당" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="agn_nm" type="input" caption="취급처" style="text-align:left; word-wrap:none; "/>
				<col ref="agn" visibility="hidden"/>
				<col ref="dlco_clsf" visibility="hidden"/>
				<col ref="chro_clsf" visibility="hidden"/>
				<col ref="bw_clr_yn" visibility="hidden"/>
				<col ref="preng_occr_seq" visibility="hidden"/>
				<col ref="issu_side" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<col ref="sect_seq" visibility="hidden"/>
				<script type="javascript" ev:event="onmousedown">
					<![CDATA[		
					on_mouse_down(event.currentTarget);
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[

					var datagrid = dg_sect5;
					if(datagrid.col == datagrid.colRef("uprc") || datagrid.col == datagrid.colRef("advt_fee")){
						calcuateAdvtFee(datagrid);
					}else if(datagrid.col == datagrid.colRef("agn_nm")){
											
						var row 		= datagrid.row;
						var agn_nm   = datagrid.valueMatrix(row, datagrid.colRef("agn_nm"));
						
						if(agn_nm != ""){
							var dataIndex = getSelectedRecordIndex(datagrid);
							findDlcoNo("24", agn_nm, "/root/resData/gridData5/record["+dataIndex+"]/agn", "/root/resData/gridData5/record["+dataIndex+"]/agn_nm", "/root/resData/gridData5/record["+dataIndex+"]/dlco_clsf");
						}		
					}			
					//값 변경 row 상태값 변경
					//dg_sect5.addStatus(dg_sect5.row,"update");	
					//dg_sect5.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="onmousemove">
					<![CDATA[
				if(_drag_start){			
					_drag_mode = true;			
				}					
					]]>
				</script>
				<script type="javascript" ev:event="onmouseup">
					<![CDATA[
					on_mouse_up(event.currentTarget);
					]]>
				</script>
			</datagrid>
			<caption id="caption3" ref="/root/resData/gridData5/sect_nm" class="tit02" style="left:0px; top:0px; width:182px; height:20px; ">S5</caption>
		</group>
		<button id="btnClose" class="btn02" style="left:947px; top:68px; width:52px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if(window.type == "mdi"){
						viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					}else{
						window.close();
					}
				]]>
			</script>
		</button>
		<group id="group6" visibility="hidden" style="left:499px; top:520px; width:500px; height:85px; ">
			<datagrid id="sum_sect6" nodeset="/root/resData/sumGridData6/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 90, 55, 68, 70" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:41px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="lbl"/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont"/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col ref="slcrg_pers"/>
			</datagrid>
			<datagrid id="dg_sect6" nodeset="/root/resData/gridData6/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^CHRO_CLSF^BW_CLR_YN^SEQ^ISSU_SIDE^SECT_CD^SECT_SEQ" colsep="#" colwidth="30, 30, 30, 35, 90, 55, 68, 65, 65, 30, 35, 100, 100, 30, 30, 30, 30" rowsep="|" style="left:0px; top:20px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="sect" style="text-align:center; "/>
				<col ref="dn" style="text-align:center; "/>
				<col ref="cm" style="text-align:center; "/>
				<col ref="chro_clsf_nm"/>
				<col class="req" imemode="hangul" ref="advt_cont" type="input" caption="광고내용" style="text-align:left; word-wrap:none; "/>
				<col class="req" ref="uprc" type="input" format="#,###" caption="단가" style="text-align:right; "/>
				<col class="req" ref="advt_fee" type="input" format="#,###" caption="광고료" style="text-align:right; "/>
				<col ref="slcrg_pers" type="combo" caption="영업담당" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="agn_nm" type="input" caption="취급처" style="text-align:left; word-wrap:none; "/>
				<col ref="agn" visibility="hidden"/>
				<col ref="dlco_clsf" visibility="hidden"/>
				<col ref="chro_clsf" visibility="hidden"/>
				<col ref="bw_clr_yn" visibility="hidden"/>
				<col ref="preng_occr_seq" visibility="hidden"/>
				<col ref="issu_side" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<col ref="sect_seq" visibility="hidden"/>
				<script type="javascript" ev:event="onmousedown">
					<![CDATA[		
					on_mouse_down(event.currentTarget);
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[

					var datagrid = dg_sect6;
					if(datagrid.col == datagrid.colRef("uprc") || datagrid.col == datagrid.colRef("advt_fee")){
						calcuateAdvtFee(datagrid);
					}else if(datagrid.col == datagrid.colRef("agn_nm")){
											
						var row 		= datagrid.row;
						var agn_nm   = datagrid.valueMatrix(row, datagrid.colRef("agn_nm"));
						
						if(agn_nm != ""){
							var dataIndex = getSelectedRecordIndex(datagrid);
							findDlcoNo("24", agn_nm, "/root/resData/gridData6/record["+dataIndex+"]/agn", "/root/resData/gridData6/record["+dataIndex+"]/agn_nm", "/root/resData/gridData6/record["+dataIndex+"]/dlco_clsf");
						}		
					}		
					//값 변경 row 상태값 변경
					//dg_sect6.addStatus(dg_sect6.row,"update");	
					//dg_sect6.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="onmousemove">
					<![CDATA[
				if(_drag_start){			
					_drag_mode = true;			
				}					
					]]>
				</script>
				<script type="javascript" ev:event="onmouseup">
					<![CDATA[
					on_mouse_up(event.currentTarget);
					]]>
				</script>
			</datagrid>
			<caption id="caption4" ref="/root/resData/gridData6/sect_nm" class="tit02" style="left:0px; top:0px; width:182px; height:20px; ">S6</caption>
		</group>
		<group id="group7" visibility="hidden" style="left:499px; top:605px; width:500px; height:85px; ">
			<datagrid id="sum_sect7" nodeset="/root/resData/sumGridData7/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 90, 55, 68, 70" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:41px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="lbl"/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont"/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col ref="slcrg_pers"/>
			</datagrid>
			<datagrid id="dg_sect7" nodeset="/root/resData/gridData7/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^CHRO_CLSF^BW_CLR_YN^SEQ^ISSU_SIDE^SECT_CD^SECT_SEQ" colsep="#" colwidth="30, 30, 30, 35, 90, 55, 68, 65, 65, 30, 35, 100, 100, 30, 30, 30, 30" rowsep="|" style="left:0px; top:20px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="sect" style="text-align:center; "/>
				<col ref="dn" style="text-align:center; "/>
				<col ref="cm" style="text-align:center; "/>
				<col ref="chro_clsf_nm"/>
				<col class="req" imemode="hangul" ref="advt_cont" type="input" caption="광고내용" style="text-align:left; word-wrap:none; "/>
				<col class="req" ref="uprc" type="input" format="#,###" caption="단가" style="text-align:right; "/>
				<col class="req" ref="advt_fee" type="input" format="#,###" caption="광고료" style="text-align:right; "/>
				<col ref="slcrg_pers" type="combo" caption="영업담당" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="agn_nm" type="input" caption="취급처" style="text-align:left; word-wrap:none; "/>
				<col ref="agn" visibility="hidden"/>
				<col ref="dlco_clsf" visibility="hidden"/>
				<col ref="chro_clsf" visibility="hidden"/>
				<col ref="bw_clr_yn" visibility="hidden"/>
				<col ref="preng_occr_seq" visibility="hidden"/>
				<col ref="issu_side" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<col ref="sect_seq" visibility="hidden"/>
				<script type="javascript" ev:event="onmousedown">
					<![CDATA[		
					on_mouse_down(event.currentTarget);
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[

					var datagrid = dg_sect7;
					if(datagrid.col == datagrid.colRef("uprc") || datagrid.col == datagrid.colRef("advt_fee")){
						calcuateAdvtFee(datagrid);
					}else if(datagrid.col == datagrid.colRef("agn_nm")){
											
						var row 		= datagrid.row;
						var agn_nm   = datagrid.valueMatrix(row, datagrid.colRef("agn_nm"));
						
						if(agn_nm != ""){
							var dataIndex = getSelectedRecordIndex(datagrid);
							findDlcoNo("24", agn_nm, "/root/resData/gridData7/record["+dataIndex+"]/agn", "/root/resData/gridData7/record["+dataIndex+"]/agn_nm", "/root/resData/gridData7/record["+dataIndex+"]/dlco_clsf");
						}		
					}	
					//값 변경 row 상태값 변경
					//dg_sect7.addStatus(dg_sect7.row,"update");	
					//dg_sect7.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="onmousemove">
					<![CDATA[
				if(_drag_start){			
					_drag_mode = true;			
				}					
					]]>
				</script>
				<script type="javascript" ev:event="onmouseup">
					<![CDATA[
					on_mouse_up(event.currentTarget);
					]]>
				</script>
			</datagrid>
			<caption id="caption5" ref="/root/resData/gridData7/sect_nm" class="tit02" style="left:0px; top:0px; width:182px; height:20px; ">S7</caption>
		</group>
		<group id="group8" visibility="hidden" style="left:499px; top:695px; width:500px; height:85px; ">
			<datagrid id="sum_sect8" nodeset="/root/resData/sumGridData8/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 90, 55, 68, 70" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:41px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="lbl"/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont"/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col ref="slcrg_pers"/>
			</datagrid>
			<datagrid id="dg_sect8" nodeset="/root/resData/gridData8/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^CHRO_CLSF^BW_CLR_YN^SEQ^ISSU_SIDE^SECT_CD^SECT_SEQ" colsep="#" colwidth="30, 30, 30, 35, 90, 55, 68, 65, 65, 30, 35, 100, 100, 30, 30, 30, 30" rowsep="|" style="left:0px; top:20px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="sect" style="text-align:center; "/>
				<col ref="dn" style="text-align:center; "/>
				<col ref="cm" style="text-align:center; "/>
				<col ref="chro_clsf_nm"/>
				<col class="req" imemode="hangul" ref="advt_cont" type="input" caption="광고내용" style="text-align:left; word-wrap:none; "/>
				<col class="req" ref="uprc" type="input" format="#,###" caption="단가" style="text-align:right; "/>
				<col class="req" ref="advt_fee" type="input" format="#,###" caption="광고료" style="text-align:right; "/>
				<col ref="slcrg_pers" type="combo" caption="영업담당" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="agn_nm" type="input" caption="취급처" style="text-align:left; word-wrap:none; "/>
				<col ref="agn" visibility="hidden"/>
				<col ref="dlco_clsf" visibility="hidden"/>
				<col ref="chro_clsf" visibility="hidden"/>
				<col ref="bw_clr_yn" visibility="hidden"/>
				<col ref="preng_occr_seq" visibility="hidden"/>
				<col ref="issu_side" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<col ref="sect_seq" visibility="hidden"/>
				<script type="javascript" ev:event="onmousedown">
					<![CDATA[		
					on_mouse_down(event.currentTarget);
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[

					var datagrid = dg_sect8;
					if(datagrid.col == datagrid.colRef("uprc") || datagrid.col == datagrid.colRef("advt_fee")){
						calcuateAdvtFee(datagrid);
					}else if(datagrid.col == datagrid.colRef("agn_nm")){
											
						var row 		= datagrid.row;
						var agn_nm   = datagrid.valueMatrix(row, datagrid.colRef("agn_nm"));
						
						if(agn_nm != ""){
							var dataIndex = getSelectedRecordIndex(datagrid);
							findDlcoNo("24", agn_nm, "/root/resData/gridData8/record["+dataIndex+"]/agn", "/root/resData/gridData8/record["+dataIndex+"]/agn_nm", "/root/resData/gridData8/record["+dataIndex+"]/dlco_clsf");
						}		
					}		
					//값 변경 row 상태값 변경
					//dg_sect8.addStatus(dg_sect8.row,"update");
					//dg_sect8.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="onmousemove">
					<![CDATA[
				if(_drag_start){			
					_drag_mode = true;			
				}					
					]]>
				</script>
				<script type="javascript" ev:event="onmouseup">
					<![CDATA[
					on_mouse_up(event.currentTarget);
					]]>
				</script>
			</datagrid>
			<caption id="caption6" ref="/root/resData/gridData8/sect_nm" class="tit02" style="left:0px; top:0px; width:182px; height:20px; ">S8</caption>
		</group>
		<caption id="caption8" style="left:900px; top:1165px; width:100px; height:20px; "/>
		<group id="group1_1" visibility="hidden" style="left:500px; top:790px; width:500px; height:85px; ">
			<datagrid id="sum_dg_sect0_1" nodeset="/root/resData1/sumGridData1/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 90, 55, 68, 70" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:41px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="lbl"/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont"/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col ref="slcrg_pers_nm"/>
			</datagrid>
			<datagrid id="dg_sect0_1" nodeset="/root/resData1/gridData1/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^CHRO_CLSF^BW_CLR_YN^SEQ^ISSU_SIDE^SECT_CD" colsep="#" colwidth="30, 30, 30, 35, 90, 55, 68, 65, 40, 35, 40, 100, 100, 40, 40, 40" rowsep="|" style="left:0px; top:20px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; cursor:hand; ">
				<col ref="sect" style="text-align:left; "/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="cm" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont" style="text-align:left; word-wrap:none; "/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col disabled="true" ref="slcrg_pers" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="agn_nm" style="text-align:left; word-wrap:none; "/>
				<col ref="agn" visibility="hidden"/>
				<col ref="dlco_clsf" visibility="hidden"/>
				<col ref="chro_clsf" visibility="hidden"/>
				<col ref="bw_clr_yn" visibility="hidden"/>
				<col ref="preng_occr_seq" visibility="hidden"/>
				<col ref="issu_side" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<script type="javascript" ev:event="onmousedown">
					<![CDATA[

					]]>
				</script>
				<script type="javascript" ev:event="onmousemove">
					<![CDATA[			
					]]>
				</script>
				<script type="javascript" ev:event="onmouseup">
					<![CDATA[
					]]>
				</script>
			</datagrid>
			<caption id="caption10" class="tit02" style="left:0px; top:0px; width:182px; height:20px; ">기사중광고</caption>
		</group>
		<group id="group1_2" visibility="hidden" style="left:500px; top:880px; width:500px; height:85px; ">
			<datagrid id="sum_dg_sect0_2" nodeset="/root/resData1/sumGridData2/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 90, 55, 68, 70" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:41px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="lbl"/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont"/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col ref="slcrg_pers_nm"/>
			</datagrid>
			<datagrid id="dg_sect0_2" nodeset="/root/resData1/gridData2/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^CHRO_CLSF^BW_CLR_YN^SEQ^ISSU_SIDE^SECT_CD" colsep="#" colwidth="30, 30, 30, 35, 90, 55, 68, 65, 40, 35, 40, 100, 100, 40, 40, 40" rowsep="|" style="left:0px; top:20px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; cursor:hand; ">
				<col ref="sect" style="text-align:left; "/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="cm" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont" style="text-align:left; word-wrap:none; "/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col disabled="true" ref="slcrg_pers" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="agn_nm" style="text-align:left; word-wrap:none; "/>
				<col ref="agn" visibility="hidden"/>
				<col ref="dlco_clsf" visibility="hidden"/>
				<col ref="chro_clsf" visibility="hidden"/>
				<col ref="bw_clr_yn" visibility="hidden"/>
				<col ref="preng_occr_seq" visibility="hidden"/>
				<col ref="issu_side" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<script type="javascript" ev:event="onmousedown">
					<![CDATA[

					]]>
				</script>
				<script type="javascript" ev:event="onmousemove">
					<![CDATA[			
					]]>
				</script>
				<script type="javascript" ev:event="onmouseup">
					<![CDATA[
					]]>
				</script>
			</datagrid>
			<caption id="caption11" class="tit02" style="left:0px; top:0px; width:182px; height:20px; ">지방판</caption>
		</group>
		<bool id="bool1" checkvalue="Y,N" ref="/root/resData/show_uprc" style="left:812px; top:45px; width:20px; height:20px; "/>
		<caption id="caption12" style="left:828px; top:46px; width:30px; height:20px; ">단가</caption>
		<button id="button22" style="left:157px; top:45px; width:18px; height:18px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
			<caption>+</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				var pubc_dt 		= model.getValue("/root/reqData/pubc_dt");
				
				model.setValue("/root/reqData/pubc_dt", dateAdd("d", 1, pubc_dt));
				inp_pubc_dt.refresh();
				
				initVariables();
				loadData();
				
				]]>
			</script>
		</button>
		<button id="button23" style="left:177px; top:45px; width:18px; height:18px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
			<caption>-</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				var pubc_dt 		= model.getValue("/root/reqData/pubc_dt");
				
				model.setValue("/root/reqData/pubc_dt", dateAdd("d", -1, pubc_dt));
				inp_pubc_dt.refresh();
				
				initVariables();		
				loadData();
				
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
