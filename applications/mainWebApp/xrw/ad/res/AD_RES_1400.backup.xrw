<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="/css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<slcrg_pers>
								<item>
									<label/>
									<value/>
								</item>
							</slcrg_pers>
						</comboSet>
						<pageInfo/>
						<cap_lbl>대기광고</cap_lbl>
					</initData>
					<reqData>
						<fwdData>
							<dlco_clsf/>
							<dlco_nm/>
						</fwdData>
						<searchData/>
						<multiUpdateData/>
						<medi_cd>110</medi_cd>
						<pubc_dt/>
						<pubc_clsf>0</pubc_clsf>
						<clos_clsf/>
						<preng_clos_yn/>
						<unasin_uprc/>
					</reqData>
					<resData>
						<resForm>
						</resForm>
						<gridData1>
							<sect_nm/>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
								<chro_clsf/>
								<bw_clr_yn/>
							</record>
						</gridData1>
						<gridData2>
							<sect_nm/>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
								<chro_clsf/>
								<bw_clr_yn/>
							</record>
						</gridData2>
						<gridData3>
							<sect_nm/>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
								<chro_clsf/>
								<bw_clr_yn/>
							</record>
						</gridData3>
						<gridData4>
							<sect_nm/>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
								<chro_clsf/>
								<bw_clr_yn/>
							</record>
						</gridData4>
						<gridData5>
							<sect_nm/>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
								<chro_clsf/>
								<bw_clr_yn/>
							</record>
						</gridData5>
						<preng_clos_yn/>
						<asum_shet_aprv_yn/>
						<tot_side_cnt/>
						<tot_dn_cnt/>
						<advs_ocpy_rate/>
						<unasin_uprc/>
						<avg_uprc/>
						<tot_advt_fee/>
						<sumGridData1>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn/>
							</record>
						</sumGridData1>
						<sumGridData2>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn/>
							</record>
						</sumGridData2>
						<sumGridData3>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn/>
							</record>
						</sumGridData3>
						<sumGridData4>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn/>
							</record>
						</sumGridData4>
						<sumGridData5>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn/>
							</record>
						</sumGridData5>
						<sect_cnt/>
					</resData>
					<tempData>
						<keyData/>
					</tempData>
					<msgData/>
					<resData1>
						<gridData>
							<record>
								<sect/>
								<dn/>
								<cm/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers/>
								<agn_nm/>
								<agn/>
								<dlco_clsf/>
								<preng_occr_seq/>
								<issu_side/>
								<sect_cd/>
								<sect_seq/>
								<chro_clsf/>
								<bw_clr_yn/>
							</record>
						</gridData>
						<sumGridData>
							<record>
								<lbl/>
								<dn/>
								<chro_clsf_nm/>
								<advt_cont/>
								<uprc/>
								<advt_fee/>
								<slcrg_pers_nm/>
								<agn/>
							</record>
						</sumGridData>
					</resData1>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				
					window.left  = 0;
					window.top  = 0;
					window.width = "1024";
					window.height= "768";
					var pubc_dt = dateAdd("d", 1, getCurrentDate());
					
					if(model.property("PUB_1400_PUBC_DT") != ""){
						pubc_dt	=	model.property("PUB_1400_PUBC_DT");
						model.property("PUB_1400_PUBC_DT")	= "";
					}
					
					model.setValue("/root/reqData/pubc_dt", pubc_dt);
					inp_pubc_dt.refresh();
					
					model.send("ad_res_1400_m");
					
					model.copyNode("/root/initData/comboSet/slcrg_pers", "/root/tempData/slcrg_pers");
					
					loadData();
				
				]]>
			</script>
			<submission id="ad_res_1400_m" action="/ad/res/1400" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="ad_res_1410_l" action="/ad/res/1410" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/resData"/>
			<submission id="ad_res_1420_l" action="/ad/res/1420" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/resData1"/>
			<submission id="ad_res_1430_u" action="/ad/res/1430" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/msgData"/>
			<submission id="ad_res_1440_u" action="/ad/res/1440" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData" resultref="/root/msgData"/>
			<submission id="ad_co_9002_s" action="/ad/common/9002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData/dlco_nm" resultref="/root/msgData"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
				var _first_lbl = true;
				function initVariables(){
					_first_lbl = true;
					model.setValue("/root/reqData/pubc_clsf", "0");
					model.setValue("/root/initData/cap_lbl", "대기광고");					
					
					for(var i=1; i<=5; i++){			
						document.controls("group"+i).visible = false;
					}
				}
				
				function redrawDatagrid(){
					
					var bg_color = "#ccffcc";
					var side_indx = 0;
					
					for(var n=1; n<=5; n++){		
						var datagrid    = document.controls("dg_sect" + n);
					
						
						for(var i=datagrid.fixedRows; i<datagrid.rows; i++){
							datagrid.cellstyle("background-color", i, datagrid.colRef("sect")) 	= "#FFFFFF";	
							datagrid.cellstyle("background-color", i, datagrid.colRef("dn")) 	= "#FFFFFF";	
						}
						
//						datagrid.allStyle("data", "background-color") = "#FFFFFF";
						
						for(var i=datagrid.fixedRows; i<datagrid.rows; i++){
							var chro_clsf = datagrid.valueMatrix(i,datagrid.cols-2);
							if(chro_clsf == "1" || chro_clsf == "2" || chro_clsf == "3"){
								datagrid.cellstyle("background-color", i, datagrid.colRef("sect")) = bg_color;		
							}
							var bw_clr_yn = datagrid.valueMatrix(i,datagrid.cols-1);
							if(bw_clr_yn == "2"){
								datagrid.cellstyle("background-color", i, datagrid.colRef("dn")) = bg_color;		
							}
						}	
					}
					
					var sect_cnt = model.getValue("/root/resData/sect_cnt");		

					var gap        = (sect_cnt);
					var height     = 666 /(sect_cnt);
												
					for(var i=1; i<=sect_cnt; i++){		
						var group    = document.controls("group" + i);
						group.visible = true;
						
						if(i == 1){
							var datagrid = document.controls("dg_sect0");
						}else{
							var datagrid = document.controls("dg_sect" + i);
						}					
						
						var sum_grid = document.controls("sum_sect" + i);
						
						var left   = group.currentStyle.left;
						var top    = group.currentStyle.top;
						var width  = group.currentStyle.width;
						
						top = 95 + (i-1) * height;
						
						group.attribute("top")    = top + "px";
						group.attribute("height") = height + "px";
						
						datagrid.attribute("height") = height - 50; 
						datagrid.attribute("width")  = width; 
						
						
						var tmp_top    = datagrid.currentStyle.top;
						var tmp_height = datagrid.currentStyle.height - 21;
						
						sum_grid.attribute("top") = tmp_top + tmp_height;
						
						group.refresh();
						datagrid.refresh();
						sum_grid.refresh();
						
											
					}
										
				}
				
				function loadData(){				
									
					if(validateReq()){	
						model.setValue("/root/reqData/unasin_uprc", model.getValue("/root/resData/unasin_uprc"));					
											
						model.send("ad_res_1410_l");
						model.send("ad_res_1420_l");
						
						model.refresh();
	
						redrawDatagrid();
					}
					
				}
				
				function setDlcoInfo(dlco_no, dlco_nm){
					
					dg_sect1.valueMatrix(dg_sect1.row, 8)  = dlco_no;
					dg_sect1.valueMatrix(dg_sect1.row, 9) = dlco_nm;
					
				}
				function ondragstart(){
 				}
				function ondrop(){				
			 	}
			 	function onmousedown(){								 		
			 	}
			 	function onmouseup(){		 		
			 	}
			 	function calcuateAdvtFee(datagrid){
			 		
			 		var dn = Number(datagrid.valueMatrix(datagrid.row, datagrid.colRef("dn")));
			 		var cm = Number(datagrid.valueMatrix(datagrid.row, datagrid.colRef("cm")));
			 		
					if(datagrid.col == datagrid.colRef("uprc")){
						var uprc     = Number(datagrid.valueMatrix(datagrid.row, datagrid.colRef("uprc")));
						var advt_fee = uprc * dn * cm;
						
						datagrid.valueMatrix(datagrid.row, datagrid.colRef("advt_fee")) = advt_fee;
						datagrid.refresh();
						
					}else if(datagrid.col == datagrid.colRef("advt_fee")){
						var advt_fee	= Number(datagrid.valueMatrix(datagrid.row, datagrid.colRef("advt_fee")));
						var uprc     = Math.round(advt_fee /(dn * cm));
						
						datagrid.valueMatrix(datagrid.row, datagrid.colRef("uprc")) = uprc;
						datagrid.refresh();
						
					}
			 	}
			 	
			 	var _drag_start = false;
			 	var _drag_mode  = false;
			 	
			 	function on_mouse_down(id){

					var datagrid = document.controls(id);													
					if (datagrid.isCell(event.target)){
						if(datagrid.mouseCol>= datagrid.colRef("sect") && datagrid.mouseCol <= datagrid.colRef("chro_clsf_nm")){
							model.property("source_datagrid") = id;		
							model.property("preng_occr_seq")  = datagrid.valueMatrix(datagrid.mouseRow, datagrid.colRef("preng_occr_seq"));
							model.property("advt_cont")       = datagrid.valueMatrix(datagrid.mouseRow, datagrid.colRef("advt_cont"));
							model.property("source_row") 		= parseInt(datagrid.mouseRow);
							_drag_start = true;
						}
					}
			 	}
			 	
			/**
			 * 그리드의 필수입력 확인
			 * param : gridID(그리드 ID 문자열)
			 * 그리드 세팅사항 : 일반 input항목과 마찬가지로 그리드의 컬럼에 class="req" 및 caption="컬럼명" 세팅
			 * 실행예 : if(!commGridReqCheck("datagrid1")) return;
			 */ 
			function gridReqCheck(gridID){
				
				var reqclass = "";
				var reqcaption = "";
				var grid;
			    if( typeof gridID == 'string' ) grid = document.controls(gridID);
			    else grid = gridID;
			
			    var strid = grid.attribute("id");
				var rowcnt = grid.rows;
				var colcnt = grid.cols;
				
				for(var i=grid.fixedRows ; i< rowcnt ; i++){
					rstatus = grid.rowStatus(i);
					
					for(var j=grid.fixedCols ; j< colcnt ; j++){
					
						reqclass = grid.colAttribute(j, "class");
						if(rstatus == 2 && reqclass == "req" && grid.valueMatrix(i,j) == ""){
			                commMsgBox(grid.colAttribute(j, "caption") + "은(는) 필수입력항목입니다.");
							model.setFocus(strid);
							grid.row = i;
							grid.col = j;
							grid.editCell();
							return false;
						}		
					}
				}
			    return true;
			}		
			function on_mouse_up(id){
				
				if(!_drag_mode){
					_drag_start = false;
					_drag_mode  = false;		
					 return;
				}
			 		
				var preng_occr_seq = model.property("preng_occr_seq");	
				var advt_cont      = model.property("advt_cont");	
				if(advt_cont == ""){
					window.alert("옮길 데이타가 없습니다. 위치를 확인하십시요.");
					_drag_start = false;
					_drag_mode  = false;
					return;
				}	
								
				var source_datagrid	= model.property("source_datagrid");
				var source_row 		= model.property("source_row");
				
				var source_ctr  		= document.controls(source_datagrid);	
				var target_ctr  		= document.controls(id);			
				var target_row 		= target_ctr.mouseRow;				
					
				var changable_column  = target_ctr.colRef("advt_cont");//광고내용부터 데이타 변경
				
				var advt_cont = target_ctr.valueMatrix(target_row, target_ctr.colRef("advt_cont"));					
				if(advt_cont != ""){
					window.alert("이미 지정되어 있는 면수입니다. 위치를 확인하십시요.");
					_drag_start = false;
					_drag_mode  = false;
					return;
				}				
								
				var target_cm = target_ctr.valueMatrix(target_row, target_ctr.colRef("cm"));
				var target_dn = target_ctr.valueMatrix(target_row, target_ctr.colRef("dn"));

				var source_cm = source_ctr.valueMatrix(source_row, source_ctr.colRef("cm"));
				var source_dn = source_ctr.valueMatrix(source_row, source_ctr.colRef("dn"));
				
				if(target_cm != source_cm){
					alert("옮길 CM은 같아야 합니다. 위치를 확인하세요");
					_drag_start = false;
					_drag_mode  = false;
					return;
				}
				
				if(target_dn != source_dn){
					alert("옮길 단은 같아야 합니다. 위치를 확인하세요");
					_drag_start = false;
					_drag_mode  = false;
					return;
				}				
			
				if(source_ctr == target_ctr){	 //같은 그리드에서 위치이동할 경우	
					if(target_row >= target_ctr.fixedRows){
						for(var i=changable_column; i<=11; i++){
							var temp = source_ctr.valueMatrix(target_row, i);
							target_ctr.valueMatrix(target_row, i) = source_ctr.valueMatrix(source_row, i);
							source_ctr.valueMatrix(source_row, i) = temp;						
						}					
					}
				}else{//다른 섹션에서 이동할 경우				
					if(target_row >= target_ctr.fixedRows){
						for(var i=changable_column; i<=11; i++){
							target_ctr.valueMatrix(target_row, i) = source_ctr.valueMatrix(source_row, i);
						}
						for(var i=changable_column; i<source_ctr.cols; i++){
							source_ctr.valueMatrix(source_row, i) = "";
						}				
					}					
				}

				source_ctr.rowStatus(source_row) = "4";//"delete";
				target_ctr.rowStatus(target_row) = "2";//"update";				
				source_ctr.refresh();
				target_ctr.refresh();
				
				_drag_start = false;
				_drag_mode  = false;
												
			}	 	
			
			function goReport(gubun){
					
				// 오즈관련 노드 초기화..					
				resetOznode();					
									
				// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
				makeNodeValue("/root/oz_data/ozrName", "ad/SP_AD_RES_1410_P");									
							
				var root			= "/root/reqData/";
				var root2            	= "/root/resData/";
											
				var pubc_dt		= model.getValue(root + "/pubc_dt");
				var unasin_uprc     	= model.getValue(root2 + "/unasin_uprc"); 
				var avg_uprc     	= model.getValue(root2 + "/avg_uprc"); 
				var tot_advt_fee        	= model.getValue(root2 + "/tot_advt_fee");
			
				if ( pubc_dt == "" ){
					commAlert("게재일자가 없습니다.");
					return;
				}								
		
				makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd",model.property("ss_cmpycd"));	
				makeNodeValue("/root/oz_data/odiParam/iv_pubc_dt"		, pubc_dt	);					
				makeNodeValue("/root/oz_data/odiParam/iv_unasin_uprc"	, unasin_uprc);	
				makeNodeValue("/root/oz_data/odiParam/iv_avg_uprc"		, avg_uprc);	
				makeNodeValue("/root/oz_data/odiParam/iv_tot_advt_fee"		, tot_advt_fee);	
				
			
				// 레포트뷰어 호출.					
				openOzwin("/root/oz_data");	
			}
			

			function findDlcoNo(dlco_clsf, dlco_nm, dlco_no_ref, dlco_nm_ref, dlco_clsf_ref){
				
				if(trim(srch_nm) == ""){
					model.setValue(ctrl_cd_ref, "");
					model.setValue(dlco_nm_ref, "");
					model.setValue(dlco_clsf_ref, "");
					return;
				}
				
				makeNodeValue("/root/tempData/searchData/action", "9004");
				makeNodeValue("/root/tempData/searchData/dlco_clsf", dlco_clsf);
				makeNodeValue("/root/tempData/searchData/srch_nm", dlco_nm);
				
				modelSendNoMake("ad_co_9008_s", "/ad/common/9008", "/root/tempData/searchData", "/root/tempData/resData");
				
				var chk_cnt = Number(model.getValue("/root/tempData/resData/chk_cnt"));
				
				if(chk_cnt > 1){
					if(dlco_clsf == "1"){
						showAdvcsSearchPopup("Y", "Y", "", "", "", dlco_nm); 
					}else if(dlco_clsf == "2"){
						showAdvcsSearchPopup("", "", "Y", "", "", dlco_nm); 
					}else if(dlco_clsf == "4"){
						showAdvcsSearchPopup("", "", "", "Y", "Y", srch_nm); 
					}else if(dlco_clsf == "24"){
						showAdvcsSearchPopup("", "", "Y", "Y", "Y", dlco_nm); 
					}else{
						showAdvcsSearchPopup("Y", "Y", "Y", "Y", "Y", dlco_nm); 
					}
				}else{	
					var srch_cd = model.getValue("/root/tempData/resData/srch_cd");
					var srch_nm = model.getValue("/root/tempData/resData/srch_nm");
					var dlco_clsf = model.getValue("/root/tempData/resData/dlco_clsf");
					if(srch_cd == ""){
						srch_nm 		= "";
						dlco_clsf 	= "";
					}
					model.setValue(dlco_no_ref, srch_cd);
					model.setValue(dlco_nm_ref, srch_nm);	
					model.setValue(dlco_clsf_ref, dlco_clsf);	
				}
			}
						
			 	
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main_max" pagewidth="1024" pageheight="768" guideline="1,10;2,822;1,1025;2,768;2,95;1,509;2,762;" style="font-family:굴림; ">
		<datagrid id="sumDataGrid1" nodeset="/root/resData/sumGridData1/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 100, 50, 65, 87" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:10px; top:711px; width:490px; height:42px; font-family:굴림,arial; font-size:8pt; ">
			<col ref="lbl"/>
			<col ref="dn" style="text-align:right; "/>
			<col ref="chro_clsf_nm"/>
			<col ref="advt_cont"/>
			<col ref="uprc" format="#,###" style="text-align:right; "/>
			<col ref="advt_fee" format="#,###" style="text-align:right; "/>
			<col ref="slcrg_pers"/>
		</datagrid>
		<datagrid id="dg_sect1" nodeset="/root/resData/gridData1/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^SEQ^ISSU_SIDE^SECT_CD^SECT_SEQ^CHRO_CLSF^BW_CLR_YN" colsep="#" colwidth="30, 30, 30, 35, 100, 50, 65, 65, 59, 24, 35, 29, 40, 28, 34, 28, 30" rowsep="|" style="left:10px; top:115px; width:490px; height:617px; font-family:굴림,arial; font-size:8pt; cursor:hand; ">
			<col ref="sect" style="text-align:center; "/>
			<col ref="dn" style="text-align:right; "/>
			<col ref="cm" style="text-align:right; "/>
			<col ref="chro_clsf_nm"/>
			<col class="req" ref="advt_cont" type="input" caption="광고내용" style="text-align:left; word-wrap:none; "/>
			<col class="req" ref="uprc" type="input" format="#,###" caption="단가" style="text-align:right; "/>
			<col class="req" ref="advt_fee" type="input" format="#,###" caption="광고료" style="text-align:right; "/>
			<col class="req" ref="slcrg_pers" type="combo" caption="영업담당" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="agn_nm" type="input" caption="취급처" style="text-align:left; word-wrap:none; "/>
			<col ref="agn" visibility="hidden"/>
			<col ref="dlco_clsf" visibility="hidden"/>
			<col ref="preng_occr_seq" visibility="hidden"/>
			<col ref="issu_side" visibility="hidden"/>
			<col ref="sect_cd" visibility="hidden"/>
			<col ref="sect_seq" visibility="hidden"/>
			<col ref="chro_clsf" visibility="hidden"/>
			<col ref="bw_clr_yn" visibility="hidden"/>
			<script type="javascript" ev:event="onmousedown">
				<![CDATA[				
				on_mouse_down(event.currentTarget);
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var datagrid = dg_sect1;
				if(datagrid.col == datagrid.colRef("uprc") || datagrid.col == datagrid.colRef("advt_fee")){
					calcuateAdvtFee(datagrid);
				}else if(datagrid.col == datagrid.colRef("agn_nm")){
										
					var row 		= datagrid.row;
					var agn_nm   = datagrid.valueMatrix(row, datagrid.colRef("agn_nm"));
					
					if(agn_nm != ""){
						var dataIndex = getSelectedRecordIndex(datagrid);
						findDlcoNo("24", agn_nm, "/root/resData/gridData1/record["+dataIndex+"]/agn", "/root/resData/gridData1/record["+dataIndex+"]/agn_nm", "/root/resData/gridData1/record["+dataIndex+"]/dlco_clsf");
					}		
				}
									
				]]>
			</script>
			<script type="javascript" ev:event="onmousemove">
				<![CDATA[
				if(_drag_start){			
					_drag_mode = true;			
				}
				]]>
			</script>
			<script type="javascript" ev:event="onmouseup">
				<![CDATA[
				on_mouse_up(event.currentTarget);
				]]>
			</script>
		</datagrid>
		<caption id="caption15" ref="/root/reqData/preng_occr_dt" class="list_cap02" style="left:10px; top:41px; width:695px; height:26px; "/>
		<caption id="caption16" class="list_cap02" style="left:180px; top:66px; width:525px; height:26px; "/>
		<caption id="caption17" class="list_cap01" style="left:10px; top:41px; width:60px; height:26px; ">게재일자</caption>
		<input id="inp_pubc_dt" ref="/root/reqData/pubc_dt" class="req" inputtype="date" format="yyyy-mm-dd" caption="게재일자" style="left:75px; top:45px; width:90px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[	

			    initVariables();
			    loadData();		
			    					
				]]>
			</script>
		</input>
		<caption id="caption18" class="list_cap01" style="left:545px; top:41px; width:70px; height:26px; ">광고점유율</caption>
		<caption id="caption19" class="list_cap01" style="left:265px; top:41px; width:70px; height:26px; ">총광고면수</caption>
		<output id="input9" ref="/root/resData/tot_dn_cnt" appearance="output" style="left:485px; top:45px; width:55px; height:18px; text-align:right; "/>
		<caption id="caption20" class="list_cap01" style="left:410px; top:41px; width:70px; height:26px; ">총광고단수</caption>
		<output id="input10" ref="/root/resData/tot_side_cnt" appearance="output" style="left:340px; top:45px; width:65px; height:18px; text-align:right; "/>
		<output id="out_preng_clos_yn" ref="/root/resData/preng_clos_yn" style="left:240px; top:45px; width:20px; height:18px; text-align:center; "/>
		<caption id="caption21" class="list_cap01" style="left:170px; top:41px; width:65px; height:26px; ">예약마감</caption>
		<output id="input11" ref="/root/resData/advs_ocpy_rate" appearance="output" style="left:620px; top:46px; width:80px; height:18px; text-align:right; "/>
		<output id="input12" ref="/root/resData/avg_uprc" format="#,###" appearance="output" style="left:485px; top:70px; width:55px; height:18px; text-align:right; "/>
		<output id="input13" ref="/root/resData/tot_advt_fee" format="#,###" appearance="output" style="left:620px; top:70px; width:80px; height:18px; text-align:right; "/>
		<caption id="caption22" class="list_cap01" style="left:265px; top:66px; width:70px; height:26px; ">미배정단가</caption>
		<caption id="caption23" class="list_cap01" style="left:410px; top:66px; width:70px; height:26px; ">평균단가</caption>
		<caption id="caption24" class="list_cap01" style="left:545px; top:66px; width:70px; height:26px; ">예상게재액</caption>
		<caption id="caption25" class="list_cap01" style="left:170px; top:66px; width:65px; height:26px; ">추정표승인</caption>
		<output id="out_asum_shet_aprv_yn" ref="/root/resData/asum_shet_aprv_yn" style="left:240px; top:70px; width:20px; height:18px; text-align:center; "/>
		<input id="input14" ref="/root/resData/unasin_uprc" format="#,###" style="left:340px; top:70px; width:65px; height:18px; text-align:right; "/>
		<button id="button9" class="btn03" crud="R" style="left:717px; top:45px; width:65px; height:21px; ">
			<caption>대기/기사</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				_first_lbl = !_first_lbl;
				
				if(_first_lbl){
					model.setValue("/root/initData/cap_lbl", "대기광고");
					model.setValue("/root/reqData/pubc_clsf", "0");
				}else{
					model.setValue("/root/initData/cap_lbl", "기사중광고");
					model.setValue("/root/reqData/pubc_clsf", "2");
				}
				cap_lbl.refresh();
				
				model.send("ad_res_1420_l");
				
				]]>
			</script>
		</button>
		<button id="button10" class="btn03" crud="P" style="left:786px; top:45px; width:65px; height:21px; ">
			<caption>인쇄</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				goReport("P");	
				]]>
			</script>
		</button>
		<button id="button12" class="btn02" crud="C" style="left:950px; top:45px; width:50px; height:21px; ">
			<caption>저장</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				if(!gridReqCheck("dg_sect1"))					return;
				if(!gridReqCheck("dg_sect2"))					return;
				if(!gridReqCheck("dg_sect3"))					return;
				if(!gridReqCheck("dg_sect4"))					return;
				if(!gridReqCheck("dg_sect5"))					return;
				

				if(windowConfirm("저장하시겠습니까?")){
									
					makeNodeValue("/root/reqData/unasin_uprc", model.getValue("/root/resData/unasin_uprc"));
					
					makeNodeValue("/root/reqData/multiUpdateData1", dg_sect1.getUpdateData());
					makeNodeValue("/root/reqData/multiUpdateData2", dg_sect2.getUpdateData());
					makeNodeValue("/root/reqData/multiUpdateData3", dg_sect3.getUpdateData());
					makeNodeValue("/root/reqData/multiUpdateData4", dg_sect4.getUpdateData());
					makeNodeValue("/root/reqData/multiUpdateData5", dg_sect5.getUpdateData());
					
					model.send("ad_res_1430_u");
					
					if(submit_completed()){
						loadData();
					}
				}					
				
				]]>
			</script>
		</button>
		<button id="button13" class="btn03" crud="A" style="left:717px; top:69px; width:65px; height:21px; ">
			<caption>예약마감</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if(windowConfirm("예약마감을 하시겠습니까?")){
					model.setValue("/root/reqData/clos_clsf", "1");
					model.setValue("/root/reqData/preng_clos_yn", "Y");
					model.send("ad_res_1440_u");
					
					if(submit_completed()){
						model.setValue("/root/resData/preng_clos_yn", "Y");
						out_preng_clos_yn.refresh();
					}						
				}
				]]>
			</script>
		</button>
		<button id="button14" class="btn03" crud="A" style="left:786px; top:69px; width:65px; height:21px; ">
			<caption>마감취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				if(windowConfirm("예약마감취소를 하시겠습니까?")){
					model.setValue("/root/reqData/clos_clsf", "1");
					model.setValue("/root/reqData/preng_clos_yn", "N");
					model.send("ad_res_1440_u");
					
					if(submit_completed()){
						model.setValue("/root/resData/preng_clos_yn", "N");
						out_preng_clos_yn.refresh();
					}						
				}
				
				]]>
			</script>
		</button>
		<button id="button15" class="btn02" crud="R" style="left:114px; top:71px; width:50px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				    initVariables();
				    loadData();		
				]]>
			</script>
		</button>
		<button id="button16" class="btn04" crud="A" style="left:856px; top:68px; width:90px; height:21px; ">
			<caption>추정표승인</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				if(windowConfirm("광고액추정표 데이타가 만들어 집니다. 추정표승인을 하시겠습니까?")){
					model.setValue("/root/reqData/clos_clsf", "2");
					model.send("ad_res_1440_u");	
					
					if(submit_completed()){
						model.setValue("/root/resData/asum_shet_aprv_yn", "Y");
						out_asum_shet_aprv_yn.refresh();
					}											
				}			
				]]>
			</script>
		</button>
		<caption id="caption2" ref="/root/resData/gridData1/sect_nm" class="tit02" style="left:10px; top:94px; width:182px; height:20px; ">S1</caption>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar_1024.xrw" style="left:10px; top:5px; width:1004px; height:29px; "/>
		<button id="button1" class="btn04" crud="R" style="left:856px; top:45px; width:90px; height:21px; ">
			<caption>광고액추정표</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					viewer("mainFrame").window.javaScript.onLoadPage2("AD_RES_2000");
				]]>
			</script>
		</button>
		<group id="group2" visibility="hidden" style="left:509px; top:220px; width:500px; height:110px; ">
			<datagrid id="sum_sect2" nodeset="/root/resData/sumGridData2/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 90, 55, 65, 70" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:61px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="lbl"/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont"/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col ref="slcrg_pers"/>
			</datagrid>
			<datagrid id="dg_sect2" nodeset="/root/resData/gridData2/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^SEQ^ISSU_SIDE^SECT_CD^SECT_SEQ^CHRO_CLSF^BW_CLR_YN" colsep="#" colwidth="30, 30, 30, 35, 90, 55, 65, 70, 65, 24, 35, 26, 30, 25, 30, 26, 29" rowsep="|" style="left:0px; top:20px; width:500px; height:57px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="sect" style="text-align:center; "/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="cm" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col class="req" ref="advt_cont" type="input" caption="광고내용" style="text-align:left; word-wrap:none; "/>
				<col class="req" ref="uprc" type="input" format="#,###" caption="단가" style="text-align:right; "/>
				<col class="req" ref="advt_fee" type="input" format="#,###" caption="광고료" style="text-align:right; "/>
				<col class="req" ref="slcrg_pers" type="combo" caption="영업담당" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="agn_nm" type="input" caption="취급처" style="text-align:left; word-wrap:none; "/>
				<col ref="agn" visibility="hidden"/>
				<col ref="dlco_clsf" visibility="hidden"/>
				<col ref="preng_occr_seq" visibility="hidden"/>
				<col ref="issu_side" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<col ref="sect_seq" visibility="hidden"/>
				<col ref="chro_clsf" visibility="hidden"/>
				<col ref="bw_clr_yn" visibility="hidden"/>
				<script type="javascript" ev:event="onmousedown">
					<![CDATA[					
					on_mouse_down(event.currentTarget);
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
				var datagrid = dg_sect2;
				if(datagrid.col == datagrid.colRef("uprc") || datagrid.col == datagrid.colRef("advt_fee")){
					calcuateAdvtFee(datagrid);
				}else if(datagrid.col == datagrid.colRef("agn_nm")){
										
					var row 		= datagrid.row;
					var agn_nm   = datagrid.valueMatrix(row, datagrid.colRef("agn_nm"));
					
					if(agn_nm != ""){
						var dataIndex = getSelectedRecordIndex(datagrid);
						findDlcoNoByNameWithRef("24", agn_nm, "/root/resData/gridData2/record["+dataIndex+"]/agn", "/root/resData/gridData2/record["+dataIndex+"]/agn_nm");
					}		
				}
									
					]]>
				</script>
				<script type="javascript" ev:event="onmousemove">
					<![CDATA[

				if(_drag_start){			
					_drag_mode = true;			
				}					
					]]>
				</script>
				<script type="javascript" ev:event="onmouseup">
					<![CDATA[
					on_mouse_up(event.currentTarget);
					]]>
				</script>
			</datagrid>
			<caption id="caption7" ref="/root/resData/gridData2/sect_nm" class="tit02" style="left:0px; top:0px; width:182px; height:20px; ">S2</caption>
		</group>
		<group id="group1" visibility="hidden" style="left:509px; top:95px; width:500px; height:115px; ">
			<datagrid id="sum_sect1" nodeset="/root/resData1/sumGridData/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 90, 55, 65, 70" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:71px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="lbl"/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont"/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col ref="slcrg_pers_nm"/>
			</datagrid>
			<datagrid id="dg_sect0" nodeset="/root/resData1/gridData/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^SEQ^ISSU_SIDE^SECT_CD^CHRO_CLSF^BW_CLR_YN" colsep="#" colwidth="30, 30, 30, 35, 90, 55, 65, 70, 65, 40, 35, 40, 40, 40, 40, 40" rowsep="|" style="left:0px; top:20px; width:500px; height:62px; font-family:굴림,arial; font-size:8pt; cursor:hand; ">
				<col ref="sect" style="text-align:left; "/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="cm" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont" style="text-align:left; word-wrap:none; "/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col disabled="true" ref="slcrg_pers" type="combo" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="agn_nm" style="text-align:left; word-wrap:none; "/>
				<col ref="agn" visibility="hidden"/>
				<col ref="dlco_clsf" visibility="hidden"/>
				<col ref="preng_occr_seq" visibility="hidden"/>
				<col ref="issu_side" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<col ref="sect_seq" visibility="hidden"/>
				<col ref="chro_clsf" visibility="hidden"/>
				<script type="javascript" ev:event="onmousedown">
					<![CDATA[
					on_mouse_down(event.currentTarget);
					]]>
				</script>
			</datagrid>
			<caption id="cap_lbl" ref="/root/initData/cap_lbl" class="tit02" style="left:0px; top:0px; width:182px; height:20px; ">대기광고</caption>
		</group>
		<group id="group3" visibility="hidden" style="left:509px; top:340px; width:500px; height:135px; ">
			<datagrid id="sum_sect3" nodeset="/root/resData/sumGridData3/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 90, 55, 65, 70" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:60px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="lbl"/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont"/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col ref="slcrg_pers"/>
			</datagrid>
			<datagrid id="dg_sect3" nodeset="/root/resData/gridData3/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^SEQ^ISSU_SIDE^SECT_CD^SECT_SEQ^CHRO_CLSF^BW_CLR_YN" colsep="#" colwidth="30, 30, 30, 35, 90, 55, 65, 70, 65, 30, 35, 30, 30, 30, 30, 30, 30" rowsep="|" style="left:0px; top:19px; width:500px; height:57px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="sect" style="text-align:center; "/>
				<col ref="dn" style="text-align:center; "/>
				<col ref="cm" style="text-align:center; "/>
				<col ref="chro_clsf_nm"/>
				<col class="req" ref="advt_cont" type="input" caption="광고내용" style="text-align:left; word-wrap:none; "/>
				<col class="req" ref="uprc" type="input" format="#,###" caption="단가" style="text-align:right; "/>
				<col class="req" ref="advt_fee" type="input" format="#,###" caption="광고료" style="text-align:right; "/>
				<col class="req" ref="slcrg_pers" type="combo" caption="영업담당" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="agn_nm" type="input" caption="취급처" style="text-align:left; word-wrap:none; "/>
				<col ref="agn" visibility="hidden"/>
				<col ref="dlco_clsf" visibility="hidden"/>
				<col ref="preng_occr_seq" visibility="hidden"/>
				<col ref="issu_side" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<col ref="sect_seq" visibility="hidden"/>
				<col ref="chro_clsf" visibility="hidden"/>
				<col ref="bw_clr_yn" visibility="hidden"/>
				<script type="javascript" ev:event="onmousedown">
					<![CDATA[	
					on_mouse_down(event.currentTarget);
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[

				var datagrid = dg_sect3;
				if(datagrid.col == datagrid.colRef("uprc") || datagrid.col == datagrid.colRef("advt_fee")){
					calcuateAdvtFee(datagrid);
				}else if(datagrid.col == datagrid.colRef("agn_nm")){
										
					var row 		= datagrid.row;
					var agn_nm   = datagrid.valueMatrix(row, datagrid.colRef("agn_nm"));
					
					if(agn_nm != ""){
						var dataIndex = getSelectedRecordIndex(datagrid);
						findDlcoNoByNameWithRef("24", agn_nm, "/root/resData/gridData3/record["+dataIndex+"]/agn", "/root/resData/gridData3/record["+dataIndex+"]/agn_nm");
					}		
				}					
					]]>
				</script>
				<script type="javascript" ev:event="onmousemove">
					<![CDATA[
				if(_drag_start){			
					_drag_mode = true;			
				}					
					]]>
				</script>
				<script type="javascript" ev:event="onmouseup">
					<![CDATA[
					on_mouse_up(event.currentTarget);
					]]>
				</script>
			</datagrid>
			<caption id="caption9" ref="/root/resData/gridData3/sect_nm" class="tit02" style="left:2px; top:0px; width:182px; height:20px; ">S3</caption>
		</group>
		<group id="group4" visibility="hidden" style="left:509px; top:485px; width:500px; height:105px; ">
			<datagrid id="sum_sect4" nodeset="/root/resData/sumGridData4/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 90, 55, 65, 70" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:60px; width:500px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="lbl"/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont"/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col ref="slcrg_pers"/>
			</datagrid>
			<datagrid id="dg_sect4" nodeset="/root/resData/gridData4/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^SEQ^ISSU_SIDE^SECT_CD^SECT_SEQ^CHRO_CLSF^BW_CLR_YN" colsep="#" colwidth="30, 30, 30, 35, 90, 55, 65, 70, 65, 30, 35, 30, 30, 30, 30, 30, 30" rowsep="|" style="left:0px; top:20px; width:500px; height:57px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="sect" style="text-align:center; "/>
				<col ref="dn" style="text-align:center; "/>
				<col ref="cm" style="text-align:center; "/>
				<col ref="chro_clsf_nm"/>
				<col class="req" ref="advt_cont" type="input" caption="광고내용" style="text-align:left; word-wrap:none; "/>
				<col class="req" ref="uprc" type="input" format="#,###" caption="단가" style="text-align:right; "/>
				<col class="req" ref="advt_fee" type="input" format="#,###" caption="광고료" style="text-align:right; "/>
				<col class="req" ref="slcrg_pers" type="combo" caption="영업담당" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="agn_nm" type="input" caption="취급처" style="text-align:left; word-wrap:none; "/>
				<col ref="agn" visibility="hidden"/>
				<col ref="dlco_clsf" visibility="hidden"/>
				<col ref="preng_occr_seq" visibility="hidden"/>
				<col ref="issu_side" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<col ref="sect_seq" visibility="hidden"/>
				<col ref="chro_clsf" visibility="hidden"/>
				<col ref="bw_clr_yn" visibility="hidden"/>
				<script type="javascript" ev:event="onmousedown">
					<![CDATA[	
					on_mouse_down(event.currentTarget);			
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[

				var datagrid = dg_sect4;
				if(datagrid.col == datagrid.colRef("uprc") || datagrid.col == datagrid.colRef("advt_fee")){
					calcuateAdvtFee(datagrid);
				}else if(datagrid.col == datagrid.colRef("agn_nm")){
										
					var row 		= datagrid.row;
					var agn_nm   = datagrid.valueMatrix(row, datagrid.colRef("agn_nm"));
					
					if(agn_nm != ""){
						var dataIndex = getSelectedRecordIndex(datagrid);
						findDlcoNoByNameWithRef("24", agn_nm, "/root/resData/gridData4/record["+dataIndex+"]/agn", "/root/resData/gridData4/record["+dataIndex+"]/agn_nm");
					}		
				}					
					]]>
				</script>
				<script type="javascript" ev:event="onmousemove">
					<![CDATA[
				if(_drag_start){			
					_drag_mode = true;			
				}					
					]]>
				</script>
				<script type="javascript" ev:event="onmouseup">
					<![CDATA[
					on_mouse_up(event.currentTarget);
									
					]]>
				</script>
			</datagrid>
			<caption id="caption1" ref="/root/resData/gridData4/sect_nm" class="tit02" style="left:0px; top:0px; width:182px; height:20px; ">S4</caption>
		</group>
		<group id="group5" visibility="hidden" style="left:509px; top:600px; width:500px; height:105px; ">
			<datagrid id="sum_sect5" nodeset="/root/resData/sumGridData5/record" caption="c1^c2^c3^c4^c5^c6^c7" colsep="^" colwidth="30, 60, 35, 90, 55, 65, 70" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:60px; width:445px; height:42px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="lbl"/>
				<col ref="dn" style="text-align:right; "/>
				<col ref="chro_clsf_nm"/>
				<col ref="advt_cont"/>
				<col ref="uprc" format="#,###" style="text-align:right; "/>
				<col ref="advt_fee" format="#,###" style="text-align:right; "/>
				<col ref="slcrg_pers"/>
			</datagrid>
			<datagrid id="dg_sect5" nodeset="/root/resData/gridData5/record" allowselection="false" caption="면^단^CM^색도^광고내용^단가^광고료^영업담당^취급처^AGN^DLCO_CLSF^SEQ^ISSU_SIDE^SECT_CD^SECT_SEQ^CHRO_CLSF^BW_CLR_YN" colsep="#" colwidth="30, 30, 30, 35, 90, 55, 65, 70, 65, 30, 35, 30, 30, 30, 30, 30, 30" rowsep="|" style="left:0px; top:20px; width:500px; height:57px; font-family:굴림,arial; font-size:8pt; ">
				<col ref="sect" style="text-align:center; "/>
				<col ref="dn" style="text-align:center; "/>
				<col ref="cm" style="text-align:center; "/>
				<col ref="chro_clsf_nm"/>
				<col class="req" ref="advt_cont" type="input" caption="광고내용" style="text-align:left; word-wrap:none; "/>
				<col class="req" ref="uprc" type="input" format="#,###" caption="단가" style="text-align:right; "/>
				<col class="req" ref="advt_fee" type="input" format="#,###" caption="광고료" style="text-align:right; "/>
				<col class="req" ref="slcrg_pers" type="combo" caption="영업담당" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/slcrg_pers/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="agn_nm" type="input" caption="취급처" style="text-align:left; word-wrap:none; "/>
				<col ref="agn" visibility="hidden"/>
				<col ref="dlco_clsf" visibility="hidden"/>
				<col ref="preng_occr_seq" visibility="hidden"/>
				<col ref="issu_side" visibility="hidden"/>
				<col ref="sect_cd" visibility="hidden"/>
				<col ref="sect_seq" visibility="hidden"/>
				<col ref="chro_clsf" visibility="hidden"/>
				<col ref="bw_clr_yn" visibility="hidden"/>
				<script type="javascript" ev:event="onmousedown">
					<![CDATA[		
					on_mouse_down(event.currentTarget);
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[

					var datagrid = dg_sect5;
					if(datagrid.col == datagrid.colRef("uprc") || datagrid.col == datagrid.colRef("advt_fee")){
						calcuateAdvtFee(datagrid);
					}else if(datagrid.col == datagrid.colRef("agn_nm")){
											
						var row 		= datagrid.row;
						var agn_nm   = datagrid.valueMatrix(row, datagrid.colRef("agn_nm"));
						
						if(agn_nm != ""){
							var dataIndex = getSelectedRecordIndex(datagrid);
							findDlcoNoByNameWithRef("24", agn_nm, "/root/resData/gridData5/record["+dataIndex+"]/agn", "/root/resData/gridData5/record["+dataIndex+"]/agn_nm");
						}		
					}					
					]]>
				</script>
				<script type="javascript" ev:event="onmousemove">
					<![CDATA[
				if(_drag_start){			
					_drag_mode = true;			
				}					
					]]>
				</script>
				<script type="javascript" ev:event="onmouseup">
					<![CDATA[
					on_mouse_up(event.currentTarget);
					]]>
				</script>
			</datagrid>
			<caption id="caption3" ref="/root/resData/gridData5/sect_nm" class="tit02" style="left:0px; top:0px; width:182px; height:20px; ">S5</caption>
		</group>
		<button id="btnClose" class="btn02" style="left:950px; top:68px; width:50px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if(window.type == "mdi"){
						viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					}else{
						window.close();
					}
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
