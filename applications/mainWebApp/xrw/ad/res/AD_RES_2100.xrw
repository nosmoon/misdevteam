<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<hndl_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</hndl_clsf>
							<chro_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</chro_clsf>
							<mony_kind>
								<item>
									<label/>
									<value/>
								</item>
							</mony_kind>
							<nwsp_type_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</nwsp_type_clsf>
							<book_appndx_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</book_appndx_clsf>
							<publ_std>
								<item>
									<label/>
									<value/>
								</item>
							</publ_std>
							<medi_cd>
								<item>
									<label/>
									<value/>
								</item>
							</medi_cd>
						</comboSet>
						<pageInfo/>
						<hndl_nm/>
					</initData>
					<reqData>
						<fwdData/>
						<searchData>
							<preng_occr_dt/>
							<preng_occr_seq/>
							<medi_cd/>
						</searchData>
						<reqForm>
						</reqForm>
						<multiUpdateData/>
						<infoData>
							<dlco_no/>
						</infoData>
					</reqData>
					<resData>
						<resForm>
							<preng_occr_dt/>
							<preng_occr_seq/>
							<dlco_no/>
							<dlco_nm/>
							<pubc_side/>
							<issu_ser_no/>
							<publ_std/>
							<advt_fee/>
							<vat/>
							<pubc_tot_amt/>
							<rtax_yn/>
							<govern_advt_yn/>
							<advcs_offr_yn/>
							<hndl_clsf/>
							<agn/>
							<agn_nm/>
							<fee_rate/>
							<fee/>
							<hndl_plac_cd/>
							<hndl_plac_nm/>
							<coms_rate/>
							<coms/>
							<indt_clsf/>
							<indt_clsf_nm/>
							<chro_clsf/>
							<mony_kind/>
							<type_clsf/>
							<type_clsf_nm/>
							<exrate/>
							<book_appndx_clsf/>
							<nwsp_type_clsf/>
							<frex_cntr_amt/>
							<slcrg_pers/>
							<slcrg_pers_nm/>
							<dept_cd/>
							<dept_nm/>
							<mchrg_pers/>
							<mchrg_pers_nm/>
							<advt_cont/>
							<remk/>
							<chrg_aprv_pers/>
							<chrg_aprv_dt/>
							<team_chf_aprv_pers/>
							<team_chf_aprv_dt/>
							<pubc_slip_no/>
							<preng_clos_yn/>
							<preng_dt/>
							<incmg_pers/>
							<incmg_pers_nm/>
							<flag/>
							<medi_cd/>
							<tax_email/>
							<tax_clsf/>
							<advt_clsf/>
							<patr_chrg_info/>
						</resForm>
						<gridData>
							<record>
							</record>
						</gridData>
						<infoData>
							<email_id/>
						</infoData>
					</resData>
					<tempData>
						<keyData/>
					</tempData>
					<msgData/>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[				
					var cmpy_cd = model.property("ss_cmpycd");
					if(cmpy_cd == "326"){
							cp_tax_clsf_1.visible = true;
							cp_tax_clsf_2.visible = true;
							cp_tax_clsf_4.visible = true;
							rdo_tax_clsf.visible  = true;
					}
					model.setValue("/root/reqData/searchData/preng_occr_dt", getCurrentDate());
					
				
					model.send("ad_res_2100_m");
					
					model.copyNode("/root/initData/comboSet/hndl_clsf", "/root/tempData/hndl_clsf");
					model.copyNode("/root/initData/comboSet/chro_clsf", "/root/tempData/chro_clsf");
					model.copyNode("/root/initData/comboSet/mony_kind", "/root/tempData/mony_kind");
					model.copyNode("/root/initData/comboSet/nwsp_type_clsf", "/root/tempData/nwsp_type_clsf");
					model.copyNode("/root/initData/comboSet/book_appndx_clsf", "/root/tempData/book_appndx_clsf");
					model.copyNode("/root/initData/comboSet/publ_std", "/root/tempData/publ_std");
					model.copyNode("/root/initData/comboSet/medi_cd", "/root/tempData/medi_cd");
					makeComboGubun("", "/root/initData/comboSet/medi_cd", "item", "label", "value")
					
					model.refresh();							

					initPage();
					
					var preng_occr_dt 	= 	model.property(KEY_PROC_DT);
					var preng_occr_seq	=	model.property(KEY_PROC_SEQ);											
					var medi_cd      	=	model.property(KEY_MEDI_CD);

					if(medi_cd != "" && preng_occr_dt != "" && preng_occr_seq != ""){
						model.setValue("/root/reqData/searchData/preng_occr_dt", preng_occr_dt);
						model.setValue("/root/reqData/searchData/preng_occr_seq", preng_occr_seq);
						model.setValue("/root/reqData/searchData/medi_cd", medi_cd);
						
						loadData();
						
						model.property(KEY_PROC_DT)	=	"";
						model.property(KEY_PROC_SEQ)	=	"";
						model.property(KEY_MEDI_CD)          =   "";
					}
					
				]]>
			</script>
			<submission id="ad_res_2100_m" action="/ad/res/2100" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="ad_res_2110_s" action="/ad/res/2110" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData"/>
			<submission id="ad_res_2111_s" action="/ad/res/2111" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/infoData" resultref="/root/resData/infoData"/>
			<submission id="ad_res_2120_a" action="/ad/res/2120" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/msgData"/>
			<submission id="ad_co_9001_s" action="/ad/common/9001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
			
			var _sect_nm = ""; //전역변수 지면섹션
			function initPage(){
				cb_hndl_clsf.select(0);
				cb_mony_kind.value = "KRW";
				cb_chro_clsf.select(0);
				cb_nwsp_type_clsf.select(0);
				cb_book_appndx_clsf.select(0);
				
				btn_upd.disabled = true;
				btn_del.disabled = true;
			}
			function setDlcoInfo(dlco_no, dlco_nm){
				
				var gnr_advcs_yn = model.getValue("/root/reqData/fwdData/gnr_advcs_yn");
				var agn_yn       = model.getValue("/root/reqData/fwdData/agn_yn");
				var advt_bo_yn   = model.getValue("/root/reqData/fwdData/advt_bo_yn");
				var bo_bof_yn    = model.getValue("/root/reqData/fwdData/bo_bof_yn");
				
				if(gnr_advcs_yn == "Y"){									
					model.setValue("/root/resData/resForm/dlco_no", dlco_no);
					model.setValue("/root/resData/resForm/dlco_nm", dlco_nm);					
					inp_dlco_no.refresh();
					inp_dlco_nm.refresh();								
					
					setChrgInfo();
							
				}else if(agn_yn == "Y"){									
					model.setValue("/root/resData/resForm/agn", dlco_no);
					model.setValue("/root/resData/resForm/agn_nm", dlco_nm);					
					inp_agn.refresh();
					inp_agn_nm.refresh();				
				}else if(advt_bo_yn == "Y" || bo_bof_yn == "Y"){									
					model.setValue("/root/resData/resForm/hndl_plac_cd", dlco_no);
					model.setValue("/root/resData/resForm/hndl_plac_nm", dlco_nm);					
					inp_hndl_plac_cd.refresh();
					inp_hndl_plac_nm.refresh();				
				}					
			}
			
			function setChrgInfo(){
				
				modelSendNoMake("ad_co_9007_s", "/ad/common/9007", "/root/resData/resForm", "/root/tempData");	
				if(submit_completed()){
					
					model.setValue("/root/resData/resForm/slcrg_pers", 		model.getValue("/root/tempData/slcrg_pers"));
					model.setValue("/root/resData/resForm/slcrg_pers_nm", 	model.getValue("/root/tempData/slcrg_pers_nm"));
					model.setValue("/root/resData/resForm/dept_cd",       	model.getValue("/root/tempData/dept_cd"));
					model.setValue("/root/resData/resForm/dept_nm", 		model.getValue("/root/tempData/dept_nm"));
//					model.setValue("/root/resData/resForm/mchrg_pers", 		model.getValue("/root/tempData/mchrg_pers"));
//					model.setValue("/root/resData/resForm/mchrg_pers_nm", 	model.getValue("/root/tempData/mchrg_pers_nm"));
//					model.setValue("/root/resData/resForm/grp_cmpy_cd", 	model.getValue("/root/tempData/grp_cmpy_cd"));
					model.refresh();
				}
			}
			
			function selectPubcPreng(preng_occr_dt, preng_occr_seq){
				model.setValue("/root/reqData/searchData/preng_occr_dt", preng_occr_dt);
				model.setValue("/root/reqData/searchData/preng_occr_seq", preng_occr_seq);
				
				model.send("ad_res_1210_s");
				model.refresh();
			}
			
			function selectPubc(pubc_occr_dt, pubc_occr_seq){
				model.setValue("/root/reqData/searchData/pubc_occr_dt", pubc_occr_dt);
				model.setValue("/root/reqData/searchData/pubc_occr_seq", pubc_occr_seq);
				
				model.send("ad_res_1260_s");
				model.refresh();
			}

			function setIndt(indt_clsf, indt_clsf_nm){
				model.setValue("/root/resData/resForm/indt_clsf", indt_clsf);
				model.setValue("/root/resData/resForm/indt_clsf_nm", indt_clsf_nm);
				
				inp_indt_clsf.refresh();
				inp_indt_clsf_nm.refresh();			
				
			}		
			
			function setType(type_clsf, type_clsf_nm){
				model.setValue("/root/resData/resForm/type_clsf", type_clsf);
				model.setValue("/root/resData/resForm/type_clsf_nm", type_clsf_nm);
				
				inp_type_clsf.refresh();
				inp_type_clsf_nm.refresh();			
				
			}			
			
			function checkAll(){
						
				var mony_kind = model.getValue("/root/resData/resForm/mony_kind");
				if(mony_kind != "KRW"){
					var exrate = model.getValue("/root/resData/resForm/exrate");
					if(exrate == ""){
						alert("환율을 확인하십시오.");
						return false;
					}
					var frex_cntr_amt = model.getValue("/root/resData/resForm/frex_cntr_amt");
					if(frex_cntr_amt == ""){
						alert("외화계약액을 확인하십시오.");
						return false;
					}
				}				
				var hndl_clsf 	= model.getValue("/root/resData/resForm/hndl_clsf");
				var agn 		= model.getValue("/root/resData/resForm/agn");
				var hndl_plac_cd = model.getValue("/root/resData/resForm/hndl_plac_cd");							
				var fee      	= Number(model.getValue("/root/resData/resForm/fee"));
				var fee_rate 	= Number(model.getValue("/root/resData/resForm/fee_rate"));
				var coms      	= Number(model.getValue("/root/resData/resForm/coms"));
				var coms_rate= Number(model.getValue("/root/resData/resForm/coms_rate"));	
				var pubc_tot_amt = Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));										
				if(hndl_clsf == "1"){
					//광고주
					if(agn != "" || hndl_plac_cd != ""){
						alert("광고주 선택시 대행사 또는 취급처를 입력할 수 없습니다. ");
						return false;
					}
					if(fee != 0 || fee_rate != 0 || coms != 0 || coms_rate != 0){						
						alert("광고주 선택시 대행료 또는 수수료를 입력할 수 없습니다. ");
						return false;
					}
				}else if(hndl_clsf == "2"){
					if(hndl_plac_cd != ""){
						alert("대행사 선택시 취급처를 입력할 수 없습니다. ");
						return false;
					}
				}				
				if(agn != ""){
					//대행사
					if(fee_rate <= 0 || fee_rate > 15){
						alert("대행료율의 범위는 0 < 수수료율 <= 15 입니다.");
						return false;
					}					
					var ocha = fee - ( pubc_tot_amt * fee_rate )/100;
               			if(ocha > 100){
               				alert("대행료는 (총게재액 * 요율 / 100) 값과 100 이상의 오차 발생시 Error입니다.");
               				return false;
               			}
				}
				if(hndl_plac_cd != ""){
					//취급처					
					if(coms_rate <= 0 || coms_rate > 25){
						alert("수수료율의 범위는 0 < 수수료율 <= 25 입니다.");
						return false;
					}														
				}
				if(fee_rate + coms_rate > 25){
					alert("대행료율과 수수료율의 합은 25 보다 클 수 없습니다.");
					return false;
				}				
				return true;
			}		
			function loadData(){

				var preng_occr_dt  = model.getValue("/root/reqData/searchData/preng_occr_dt");
				var preng_occr_seq = model.getValue("/root/reqData/searchData/preng_occr_seq");
				var medi_cd        = model.getValue("/root/reqData/searchData/medi_cd");
				if(medi_cd == "" || preng_occr_dt == "" || preng_occr_seq == ""){
					alert("매체,게재일자,순번를 확인하세요.");
					return;
				}
				
				model.send("ad_res_2110_s");
				
				if(submit_completed()){
					if(model.getValue("/root/resData/resForm/dlco_nm") == ""){
						alert("검색결과가 없습니다.");
						return;
					}
				}

				if(model.getValue("/root/resData/resForm/agn") != ""){//대행사 
					grp_agn.visible = true;
				}else{
					grp_agn.visible = false;
				}
				if(model.getValue("/root/resData/resForm/hndl_plac_cd") != ""){//취급처 
					grp_hndl_clsf.visible = true;
				}else{
					grp_hndl_clsf.visible = false;
				}									
				
				var hndl_clsf = model.getValue("/root/resData/resForm/hndl_clsf");
				if(hndl_clsf == "2"){
					grp_agn.visible = true;
				}
				if(hndl_clsf == "4"){
					grp_agn.visible = true;
					grp_hndl_clsf.visible = true;
					model.setValue("/root/initData/hndl_nm", "광고지사");	
				}
				if(hndl_clsf == "5"){
					grp_agn.visible = true;
					grp_hndl_clsf.visible = true;
					model.setValue("/root/initData/hndl_nm", "지국지사");	
				}
				if(hndl_clsf == "7"){
					grp_agn.visible = true;
					grp_hndl_clsf.visible = true;
					model.setValue("/root/initData/hndl_nm", "해외지사");	
				}
				cap_hndl_clsf.refresh();
				
				btn_ins.disabled = false;
				btn_upd.disabled = false;
				btn_del.disabled = false;				
			}	
			function recalculate(advt_fee_yn, vat_yn, pubc_tot_amt_yn){
				
				var pubc_tot_amt	=	Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));				
				var advt_fee 	=	Number(model.getValue("/root/resData/resForm/advt_fee"));					
				var vat 			=	Number(model.getValue("/root/resData/resForm/vat"));				

				if(advt_fee_yn	==	"Y"){
					vat	=	advt_fee / 10;
					pubc_tot_amt	=	advt_fee + vat;
				}else if(vat_yn == "Y"){
					advt_fee		=	Math.round(vat * 10);
					pubc_tot_amt	=	advt_fee + vat;					
				}else if(pubc_tot_amt_yn == "Y"){
					advt_fee		=	Math.round((pubc_tot_amt * 10) / 11);
					vat			=	Math.round((pubc_tot_amt * 1) / 11);					
				}
				

				var hndl_clsf	=	model.getValue("/root/resData/resForm/hndl_clsf");
				if(hndl_clsf	==	"2"){
					var fee_rate	=	Number(model.getValue("/root/resData/resForm/fee_rate"));
					if(fee_rate > 0){
						var fee = Math.round(advt_fee * (fee_rate/100));
						model.setValue("/root/resData/resForm/fee", fee);
						inp_fee.refresh();
					}
				}else if(hndl_clsf == "4"){
					var coms_rate	=	Number(model.getValue("/root/resData/resForm/coms_rate"));
					if(coms_rate > 0){
						var coms = Math.round(advt_fee * (coms_rate/100));
						model.setValue("/root/resData/resForm/coms", coms);
						inp_coms.refresh();
					}
				}
								
				model.setValue("/root/resData/resForm/advt_fee", advt_fee);
				model.setValue("/root/resData/resForm/vat", vat);
				model.setValue("/root/resData/resForm/pubc_tot_amt", pubc_tot_amt);	
								
				inp_advt_fee.refresh();
				inp_vat.refresh();
				inp_pubc_tot_amt.refresh();
				
			}	
			function SetExDlcoInfo(){
				var hndl_clsf = model.getValue("/root/resData/resForm/hndl_clsf");
				var dlco_no = "";
				if(hndl_clsf != ""){
					if(hndl_clsf == "1"){//광고주
						dlco_no = model.getValue("/root/resData/resForm/dlco_no");
					}else if(hndl_clsf == "2"){//대행사
						dlco_no = inp_agn.currentText;//model.getValue("/root/resData/resFrom/agn");
					}
					if(dlco_no != ""){
						model.setValue("/root/reqData/infoData/dlco_no",dlco_no);
						model.send("ad_res_2111_s");
						if( submit_completed() )
						{
							model.setValue("/root/resData/resForm/tax_email",model.getValue("/root/resData/infoData/email_id"));
							model.refresh();
						}
					}
				}
			}
		]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="1,9;1,936;2,61;2,71;2,120;" style="font-family:굴림; ">
		<caption id="caption37" class="list_cap02" style="left:10px; top:201px; width:926px; height:26px; "/>
		<caption id="caption29" class="list_cap02" style="left:10px; top:351px; width:900px; height:26px; "/>
		<caption id="caption57" class="list_cap02" style="left:10px; top:351px; width:926px; height:26px; "/>
		<caption id="caption55" class="list_cap02" style="left:10px; top:376px; width:926px; height:26px; "/>
		<caption id="caption45" class="list_cap02" style="left:10px; top:525px; width:926px; height:26px; "/>
		<caption id="caption44" class="list_cap02" style="left:10px; top:500px; width:926px; height:26px; "/>
		<caption id="caption12" class="list_cap02" style="left:10px; top:71px; width:926px; height:28px; "/>
		<caption id="caption6" tyle="left:15px; top:180px; width:940px; height:0px;" style="left:0px; top:10px; width:0px; height:0px; ">caption6</caption>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group_line" class="gro_line" style="left:10px; top:108px; width:926px; height:5px; "/>
		<caption id="caption7" class="list_cap01" style="left:10px; top:71px; width:85px; height:28px; ">게재일자</caption>
		<caption id="caption2" class="list_cap01" style="left:212px; top:71px; width:85px; height:28px; ">순번</caption>
		<input id="input2" ref="/root/reqData/searchData/preng_occr_dt" class="req" navindex="1" inputtype="date" format="yyyy-mm-dd" style="left:100px; top:76px; width:95px; height:18px; "/>
		<button id="btn_qry" class="btn02" crud="R" style="left:534px; top:40px; width:50px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					loadData();
				]]>
			</script>
		</button>
		<caption id="caption1" class="list_cap02" style="left:10px; top:176px; width:926px; height:26px; "/>
		<caption id="caption4" class="list_cap02" style="left:10px; top:276px; width:926px; height:26px; "/>
		<caption id="caption5" class="list_cap02" style="left:10px; top:301px; width:926px; height:26px; "/>
		<caption id="caption8" class="list_cap02" style="left:10px; top:326px; width:926px; height:26px; "/>
		<caption id="caption9" class="list_cap02" style="left:10px; top:401px; width:926px; height:26px; "/>
		<caption id="caption11" class="list_cap02" style="left:10px; top:426px; width:926px; height:50px; "/>
		<caption id="caption13" class="list_cap02" style="left:10px; top:475px; width:926px; height:26px; "/>
		<select1 id="cb_hndl_clsf" ref="/root/resData/resForm/hndl_clsf" class="req" navindex="3" appearance="minimal" caption="취급구분" style="left:106px; top:180px; width:120px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/hndl_clsf/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
				var hndl_clsf = model.getValue("/root/resData/resForm/hndl_clsf");
				if(hndl_clsf == "1"){					
					grp_agn.visible = false;
					grp_hndl_clsf.visible = false;
					model.setValue("/root/resData/resForm/agn", "");
					model.setValue("/root/resData/resForm/agn_nm", "");
					model.setValue("/root/resData/resForm/fee_rate", "");
					model.setValue("/root/resData/resForm/fee", "");
					
					model.setValue("/root/resData/resForm/hndl_plac_cd", "");
					model.setValue("/root/resData/resForm/hndl_plac_nm", "");
					model.setValue("/root/resData/resForm/coms_rate", "");
					model.setValue("/root/resData/resForm/coms", "");
					
				}else if(hndl_clsf == "2"){					
					grp_agn.visible = true;
					grp_hndl_clsf.visible = false;					
					
					model.setValue("/root/resData/resForm/hndl_plac_cd", "");
					model.setValue("/root/resData/resForm/hndl_plac_nm", "");
					model.setValue("/root/resData/resForm/coms_rate", "");
					model.setValue("/root/resData/resForm/coms", "");
					
				}else if(hndl_clsf == "4"){
					model.setValue("/root/initData/hndl_nm", "광고지사");				
					grp_agn.visible = true;
					grp_hndl_clsf.visible = true;
				}else if(hndl_clsf == "5"){
					model.setValue("/root/initData/hndl_nm", "지사지국");				
					grp_agn.visible = true;
					grp_hndl_clsf.visible = true;
				}else if(hndl_clsf == "7"){
					model.setValue("/root/initData/hndl_nm", "해외지사");				
					grp_agn.visible = true;
					grp_hndl_clsf.visible = true;
				}
					
				model.refresh();
				
				]]>
			</script>
		</select1>
		<caption id="caption15" class="list_cap03" style="left:9px; top:176px; width:94px; height:26px; ">취급구분</caption>
		<caption id="caption32" class="list_cap03" style="left:9px; top:276px; width:94px; height:26px; ">업종구분</caption>
		<caption id="caption23" class="list_cap03" style="left:304px; top:376px; width:94px; height:26px; ">면세여부</caption>
		<caption id="cp_tax_clsf_1" class="list_cap03" visibility="hidden" style="left:830px; top:276px; width:54px; height:26px; ">광고주</caption>
		<input id="inp_indt_clsf_nm" ref="/root/resData/resForm/indt_clsf_nm" navindex="15" imemode="hangul" inputtype="button" caption="업종구분" crud="R" style="left:174px; top:280px; width:125px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				showIndtClsfPopup();				
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[				
				if(event.keyCode == "13"){
					findIndtClsfByName(inp_indt_clsf_nm.currentText, inp_indt_clsf, inp_indt_clsf_nm);
				}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				findIndtClsfByName(inp_indt_clsf_nm.currentText, inp_indt_clsf, inp_indt_clsf_nm);
				]]>
			</script>
		</input>
		<input id="inp_type_clsf_nm" ref="/root/resData/resForm/type_clsf_nm" navindex="19" imemode="hangul" inputtype="button" caption="유형구분" crud="R" style="left:174px; top:305px; width:125px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					showTypeClsfPopup();
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[				
				if(event.keyCode == "13"){
					findTypeClsfByName(inp_type_clsf_nm.currentText, inp_type_clsf, inp_type_clsf_nm);
				}		
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				findTypeClsfByName(inp_type_clsf_nm.currentText, inp_type_clsf, inp_type_clsf_nm);
				]]>
			</script>
		</input>
		<caption id="caption31" class="list_cap03" style="left:9px; top:301px; width:94px; height:26px; ">유형구분</caption>
		<select1 id="cb_chro_clsf" ref="/root/resData/resForm/chro_clsf" navindex="16" appearance="minimal" caption="색도구분" style="left:401px; top:280px; width:120px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/chro_clsf/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="caption25" class="list_cap03" style="left:304px; top:276px; width:94px; height:26px; ">색도구분</caption>
		<caption id="caption26" class="list_cap03" style="left:582px; top:376px; width:94px; height:26px; ">정부광고여부</caption>
		<caption id="cp_tax_clsf_2" class="list_cap03" visibility="hidden" style="left:830px; top:301px; width:54px; height:26px; ">대행사</caption>
		<select1 id="cb_nwsp_type_clsf" ref="/root/resData/resForm/nwsp_type_clsf" navindex="20" appearance="minimal" caption="지종구분" style="left:401px; top:305px; width:120px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/nwsp_type_clsf/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="caption28" class="list_cap03" style="left:304px; top:301px; width:94px; height:26px; ">지종구분</caption>
		<caption id="caption34" class="list_cap03" style="left:792px; top:376px; width:94px; height:26px; ">광고주제공여부</caption>
		<caption id="cp_tax_clsf_4" class="list_cap03" visibility="hidden" style="left:830px; top:326px; width:54px; height:26px; ">위수탁</caption>
		<caption id="caption35" class="list_cap03" style="left:9px; top:401px; width:94px; height:26px; ">광고내용</caption>
		<input id="input18" ref="/root/resData/resForm/advt_cont" navindex="32" imemode="hangul" caption="광고내용" style="left:106px; top:405px; width:469px; height:18px; "/>
		<caption id="caption36" class="list_cap03" style="left:9px; top:426px; width:94px; height:50px; ">비고</caption>
		<textarea id="textarea1" ref="/root/resData/resForm/remk" navindex="33" imemode="hangul" style="left:106px; top:430px; width:780px; height:40px; text-align:left; vertical-align:top; padding:2; "/>
		<output id="output4" ref="/root/resData/resForm/chrg_aprv_pers" navindex="34" style="left:106px; top:479px; width:65px; height:18px; border-style:solid; "/>
		<output id="output5" ref="/root/resData/resForm/chrg_aprv_dt" navindex="35" style="left:178px; top:479px; width:120px; height:18px; text-align:center; border-style:solid; "/>
		<output id="output12" ref="/root/resData/resForm/team_chf_aprv_pers" navindex="36" style="left:401px; top:479px; width:65px; height:18px; border-style:solid; "/>
		<output id="output14" ref="/root/resData/resForm/team_chf_aprv_dt" navindex="37" style="left:472px; top:479px; width:120px; height:18px; text-align:center; border-style:solid; "/>
		<caption id="caption38" class="list_cap03" style="left:304px; top:475px; width:94px; height:26px; ">팀장승인</caption>
		<caption id="caption39" class="list_cap03" style="left:9px; top:475px; width:94px; height:26px; ">담당승인</caption>
		<output id="output6" ref="/root/resData/resForm/pubc_slip_no" navindex="38" format="999-99999999-9999" style="left:106px; top:504px; width:147px; height:18px; border-style:solid; "/>
		<output id="output10" ref="/root/resData/resForm/incmg_pers_nm" navindex="42" style="left:472px; top:529px; width:80px; height:18px; border-style:solid; "/>
		<output id="output7" ref="/root/resData/resForm/preng_clos_yn" navindex="39" style="left:401px; top:504px; width:35px; height:18px; border-style:solid; "/>
		<output id="output8" ref="/root/resData/resForm/preng_dt" navindex="40" format="yyyy-mm-dd" style="left:106px; top:529px; width:67px; height:18px; border-style:solid; "/>
		<output id="output9" ref="/root/resData/resForm/incmg_pers" navindex="41" style="left:401px; top:529px; width:65px; height:18px; border-style:solid; "/>
		<caption id="caption43" class="list_cap03" style="left:304px; top:525px; width:94px; height:26px; ">예약자</caption>
		<caption id="caption40" class="list_cap03" style="left:9px; top:500px; width:94px; height:26px; ">게재전표</caption>
		<caption id="caption41" class="list_cap03" style="left:304px; top:500px; width:94px; height:26px; ">예약마감</caption>
		<caption id="caption42" class="list_cap03" style="left:9px; top:525px; width:94px; height:26px; ">예약등록일자</caption>
		<button id="btn_ins" class="btn02" crud="C" style="left:590px; top:40px; width:50px; height:21px; ">
			<caption>입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if(validateReq()){
					
					if(checkAll()){
						model.setValue("/root/resData/resForm/preng_occr_dt", model.getValue("/root/reqData/searchData/preng_occr_dt"));
						model.setValue("/root/resData/resForm/preng_occr_seq", model.getValue("/root/reqData/searchData/preng_occr_seq"));
						model.setValue("/root/resData/resForm/medi_cd", model.getValue("/root/reqData/searchData/medi_cd"));
	
						if(instance1.selectSingleNode("/root/resData/resForm/flag") == null){
							model.makeNode("/root/resData/resForm/flag");
						}
						var flag = "I";
						if(confirmTransaction(flag)){
							model.setValue("/root/resData/resForm/flag", "I");
							model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");
							model.send("ad_res_2120_a");
							if(submit_completed()){	
								var preng_occr_seq = model.getValue("/root/msgData/preng_occr_seq");
								model.setValue("/root/reqData/searchData/preng_occr_seq", preng_occr_seq);
								inp_seq.refresh();								
							}
						}
					}
				}
				]]>
			</script>
		</button>
		<caption id="caption50" class="list_cap03" style="left:445px; top:121px; width:105px; height:30px; text-align:center; ">게재총액</caption>
		<input id="inp_pubc_tot_amt" ref="/root/resData/resForm/pubc_tot_amt" class="req" format="#,###" appearance="input" style="left:445px; top:150px; width:105px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				recalculate("", "", "Y");				
				]]>
			</script>
		</input>
		<caption id="caption46" class="list_cap03" style="left:10px; top:121px; width:60px; height:30px; text-align:center; ">면</caption>
		<input id="input24" ref="/root/resData/resForm/issu_ser_no" format="#,###" caption="CM" appearance="input" style="left:69px; top:150px; width:70px; height:18px; text-align:center; "/>
		<caption id="caption47" class="list_cap03" style="left:69px; top:121px; width:70px; height:30px; text-align:center; ">호수</caption>
		<caption id="caption48" class="list_cap03" style="left:138px; top:121px; width:100px; height:30px; text-align:center; ">규격</caption>
		<caption id="caption51" class="list_cap03" style="left:237px; top:121px; width:105px; height:30px; text-align:center; ">광고료</caption>
		<input id="inp_advt_fee" ref="/root/resData/resForm/advt_fee" class="req" format="#,###" caption="광고료" style="left:237px; top:150px; width:105px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				recalculate("Y", "", "");
				]]>
			</script>
		</input>
		<caption id="caption52" class="list_cap03" style="left:341px; top:121px; width:105px; height:30px; text-align:center; ">부가세</caption>
		<button id="button11" class="btn03" crud="R" style="left:814px; top:40px; width:65px; height:21px; ">
			<caption>제출승인</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				viewer("mainFrame").window.javaScript.onLoadPage2("AD_RES_2200");
/*				
				window.load("./ad_res_2200.xrw"
							, "modal"
							, ""
							, "left:100; top:100; width:1000; height:750; sysmenu:visible; min:visible; max:true; resize:true; caption:visible;")
*/							
				]]>
			</script>
		</button>
		<caption id="caption21" class="list_cap03" style="left:582px; top:276px; width:94px; height:26px; ">화폐종류</caption>
		<caption id="caption24" class="list_cap03" style="left:582px; top:301px; width:94px; height:26px; ">환율</caption>
		<input id="input15" ref="/root/resData/resForm/frex_cntr_amt" navindex="25" format="#,###" style="left:680px; top:330px; width:120px; height:18px; text-align:right; "/>
		<caption id="caption27" class="list_cap03" style="left:582px; top:326px; width:94px; height:26px; ">외화계약</caption>
		<select1 id="cb_mony_kind" ref="/root/resData/resForm/mony_kind" navindex="17" appearance="minimal" style="left:680px; top:280px; width:120px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/mony_kind/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
				var mony_kind = model.getValue("/root/resData/resForm/mony_kind");
				model.makeNode("/root/reqData/searchData/mony_kind");
				model.setValue("/root/reqData/searchData/mony_kind", mony_kind);
				
				if(mony_kind == "KRW") {
					model.setValue("/root/resData/resForm/exrate", "");
					out_exrate.refresh();
					return;
				}
				
				model.send("ad_co_9001_s");
				
				model.setValue("/root/resData/resForm/exrate", model.getValue("/root/tempData/exrate"));
				out_exrate.refresh();
				
				]]>
			</script>
		</select1>
		<group id="grp_agn" visibility="hidden" style="left:9px; top:225px; width:928px; height:27px; ">
			<caption id="caption56" class="list_cap02" style="left:0px; top:1px; width:927px; height:26px; "/>
			<caption id="caption60" class="list_cap03" style="left:573px; top:1px; width:94px; height:26px; ">대행료</caption>
			<input id="inp_fee_rate" ref="/root/resData/resForm/fee_rate" navindex="8" maxlength="2" format="#,###" style="left:392px; top:5px; width:85px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
					var pubc_tot_amt = 	Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));
					var fee_rate     = 	Number(model.getValue("/root/resData/resForm/fee_rate"));
					
					var fee			=	pubc_tot_amt * (fee_rate /100);
					
					model.setValue("/root/resData/resForm/fee", fee);
					inp_fee.refresh();					
					]]>
				</script>
			</input>
			<input id="inp_fee" ref="/root/resData/resForm/fee" navindex="9" format="#,###" style="left:671px; top:5px; width:85px; height:18px; text-align:right; "/>
			<caption id="caption14" class="list_cap03" style="left:0px; top:1px; width:94px; height:26px; ">대행사</caption>
			<caption id="caption59" class="list_cap03" style="left:295px; top:1px; width:94px; height:26px; ">대행료율</caption>
			<input id="inp_agn" ref="/root/resData/resForm/agn" navindex="6" autonext="false" maxlength="8" format="99999999" style="left:97px; top:5px; width:60px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var agn = inp_agn.currentText;
					model.setValue("/root/resData/resForm/agn", lpad(agn, 8, "0"));
					inp_agn.refresh();
				
					commonSubmission("9004", inp_agn.currentText, inp_agn, inp_agn_nm);	
					SetExDlcoInfo();
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keyCode== "13"){
						var agn = inp_agn.currentText;
						model.setValue("/root/resData/resForm/agn", lpad(agn, 8, "0"));
						inp_agn.refresh();
					
						commonSubmission("9004", inp_agn.currentText, inp_agn, inp_agn_nm);						
					}
					]]>
				</script>
			</input>
			<input id="inp_agn_nm" ref="/root/resData/resForm/agn_nm" navindex="7" imemode="hangul" inputtype="button" crud="R" style="left:165px; top:5px; width:125px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					showAdvcsSearchPopup("", "", "Y", "", "", inp_agn_nm.currentText); 
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keyCode== "13"){
						findDlcoNoByName("2", inp_agn_nm.currentText, inp_agn, inp_agn_nm);
					}				
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					findDlcoNoByName("2", inp_agn_nm.currentText, inp_agn, inp_agn_nm);
					]]>
				</script>
			</input>
		</group>
		<group id="grp_hndl_clsf" visibility="hidden" style="left:9px; top:251px; width:928px; height:26px; ">
			<caption id="caption3" class="list_cap02" style="left:0px; top:0px; width:927px; height:26px; "/>
			<input id="inp_coms_rate" ref="/root/resData/resForm/coms_rate" navindex="12" maxlength="2" format="#,###" style="left:392px; top:4px; width:85px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					
					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[

					var pubc_tot_amt = 	Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));
					var coms_rate  	= 	Number(model.getValue("/root/resData/resForm/coms_rate"));
					
					var coms			=	pubc_tot_amt * (coms_rate /100);
					
					model.setValue("/root/resData/resForm/coms", coms);
					inp_coms.refresh();
										
					]]>
				</script>
			</input>
			<input id="inp_coms" ref="/root/resData/resForm/coms" navindex="13" format="#,###" style="left:671px; top:4px; width:85px; height:18px; text-align:right; "/>
			<caption id="caption20" class="list_cap03" style="left:573px; top:0px; width:94px; height:26px; ">수수료</caption>
			<caption id="cap_hndl_clsf" ref="/root/initData/hndl_nm" class="list_cap03" style="left:0px; top:0px; width:94px; height:26px; ">광고지사</caption>
			<caption id="caption19" class="list_cap03" style="left:295px; top:0px; width:94px; height:26px; ">수수료율</caption>
			<input id="inp_hndl_plac_cd" ref="/root/resData/resForm/hndl_plac_cd" navindex="10" autonext="false" maxlength="8" format="99999999" style="left:97px; top:4px; width:60px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var hndl_plac_cd = inp_hndl_plac_cd.currentText;
					model.setValue("/root/resData/resForm/hndl_plac_cd", lpad(hndl_plac_cd, 8, "0"));
					inp_hndl_plac_cd.refresh();
				
					commonSubmission("9004", inp_hndl_plac_cd.currentText, inp_hndl_plac_cd, inp_hndl_plac_nm);						
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keyCode== "13"){
						var hndl_plac_cd = inp_hndl_plac_cd.currentText;
						model.setValue("/root/resData/resForm/hndl_plac_cd", lpad(hndl_plac_cd, 8, "0"));
						inp_hndl_plac_cd.refresh();
					
						commonSubmission("9004", inp_hndl_plac_cd.currentText, inp_hndl_plac_cd, inp_hndl_plac_nm);					
					}
					]]>
				</script>
			</input>
			<input id="inp_hndl_plac_nm" ref="/root/resData/resForm/hndl_plac_nm" navindex="11" imemode="hangul" inputtype="button" crud="R" style="left:165px; top:4px; width:125px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					showAdvcsSearchPopup("", "", "", "Y", "Y", inp_hndl_plac_nm.currentText); 
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keyCode== "13"){
						findDlcoNoByName("4", inp_hndl_plac_nm.currentText, inp_hndl_plac_cd, inp_hndl_plac_nm);
					}					
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					findDlcoNoByName("4", inp_hndl_plac_nm.currentText, inp_hndl_plac_cd, inp_hndl_plac_nm);
					]]>
				</script>
			</input>
		</group>
		<button id="btn_upd" class="btn02" crud="U" style="left:646px; top:40px; width:50px; height:21px; ">
			<caption>수정</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if(validateReq()){
					if(checkAll()){
						if(windowConfirm("수정하시겠습니까?")){
							model.setValue("/root/resData/resForm/preng_occr_dt", model.getValue("/root/reqData/searchData/preng_occr_dt"));
							model.setValue("/root/resData/resForm/preng_occr_seq", model.getValue("/root/reqData/searchData/preng_occr_seq"));
							
							if(instance1.selectSingleNode("/root/resData/resForm/flag") == null){
								model.makeNode("/root/resData/resForm/flag");
							}
							model.setValue("/root/resData/resForm/flag", "U");
							model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");
							model.send("ad_res_2120_a");
						}
					}
										
				}
				]]>
			</script>
		</button>
		<input id="inp_vat" ref="/root/resData/resForm/vat" class="req" format="#,###" caption="부가세" style="left:341px; top:150px; width:105px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				recalculate("", "Y", "");				
				]]>
			</script>
		</input>
		<input id="inp_pubc_side" ref="/root/resData/resForm/pubc_side" style="left:10px; top:150px; width:60px; height:18px; text-align:center; "/>
		<input id="inp_indt_clsf" ref="/root/resData/resForm/indt_clsf" navindex="14" appearance="input" style="left:106px; top:280px; width:60px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				commonSubmission("9009", inp_indt_clsf.currentText,  inp_indt_clsf, inp_indt_clsf_nm);				
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					commonSubmission("9009", inp_indt_clsf.currentText,  inp_indt_clsf, inp_indt_clsf_nm);	
				}
				]]>
			</script>
		</input>
		<input id="inp_type_clsf" ref="/root/resData/resForm/type_clsf" navindex="18" appearance="input" style="left:106px; top:305px; width:60px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				commonSubmission("9010", inp_type_clsf.currentText,  inp_type_clsf, inp_type_clsf_nm);	
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					commonSubmission("9010", inp_type_clsf.currentText,  inp_type_clsf, inp_type_clsf_nm);	
				}
				]]>
			</script>
		</input>
		<output id="out_exrate" ref="/root/resData/resForm/exrate" navindex="21" format="#,###.0000" style="left:680px; top:305px; width:120px; height:18px; text-align:right; border-style:solid; "/>
		<input id="inp_seq" ref="/root/reqData/searchData/preng_occr_seq" navindex="2" maxlength="4" format="9999" style="left:303px; top:76px; width:35px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				/*
					window.load("./AD_RES_1201.xrw"
							    , "modal"
							    , ""
							    , "align:center; width:954; height:756; sysmenu:visible; min:visible; max:true; resize:true; caption:visible;")
				*/							    
				]]>
			</script>
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
					var preng_occr_seq = model.getValue("/root/reqData/searchData/preng_occr_seq");
					
					model.setValue("/root/reqData/searchData/preng_occr_seq", lpad(preng_occr_seq, 4, "0"));
					inp_seq.refresh();
				]]>
			</script>
		</input>
		<button id="btn_init" class="btn02" crud="R" style="left:758px; top:40px; width:50px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.reset();
				btn_qry.disabled = false;
				btn_ins.disabled = false;
				btn_upd.disabled = true;
				btn_del.disabled = true;
				]]>
			</script>
		</button>
		<select1 id="cb_book_appndx_clsf" ref="/root/resData/resForm/book_appndx_clsf" navindex="24" appearance="minimal" caption="본책부록" style="left:401px; top:330px; width:120px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/book_appndx_clsf/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="caption16" class="list_cap03" style="left:304px; top:326px; width:94px; height:26px; ">본책부록</caption>
		<input id="input1" ref="/root/resData/resForm/dept_nm" navindex="28" imemode="hangul" inputtype="button" style="left:469px; top:355px; width:110px; height:18px; text-align:left; "/>
		<caption id="caption17" class="list_cap03" style="left:9px; top:351px; width:94px; height:26px; ">관리담당</caption>
		<caption id="caption18" class="list_cap03" style="left:304px; top:351px; width:94px; height:26px; ">담당부서</caption>
		<caption id="caption22" class="list_cap03" style="left:9px; top:326px; width:94px; height:26px; ">영업담당</caption>
		<bool id="bool1" navindex="29" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/rtax_yn" style="left:407px; top:380px; width:25px; height:20px; text-align:left; background-image:#uncheck; "/>
		<bool id="bool2" navindex="30" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/govern_advt_yn" style="left:684px; top:380px; width:25px; height:20px; text-align:left; background-image:#uncheck; "/>
		<bool id="bool3" navindex="31" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/advcs_offr_yn" style="left:894px; top:380px; width:25px; height:20px; text-align:left; background-image:#uncheck; "/>
		<caption id="caption30" class="list_cap03" style="left:9px; top:201px; width:94px; height:26px; ">광고주</caption>
		<select1 id="combo7" ref="/root/resData/resForm/publ_std" appearance="minimal" style="left:138px; top:150px; width:100px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/publ_std/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<input id="inp_slcrg_pers" ref="/root/resData/resForm/slcrg_pers" class="req" navindex="22" caption="영업담당" style="left:106px; top:330px; width:60px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				commonSubmission("9005", inp_slcrg_pers.currentText,  inp_slcrg_pers, inp_slcrg_pers_nm);	
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					commonSubmission("9005", inp_slcrg_pers.currentText,  inp_slcrg_pers, inp_slcrg_pers_nm);	
				}
				]]>
			</script>
		</input>
		<input id="inp_mchrg_pers" ref="/root/resData/resForm/mchrg_pers" class="req" navindex="25" caption="관리담당" style="left:106px; top:355px; width:60px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				commonSubmission("9005", inp_mchrg_pers.currentText,  inp_mchrg_pers, inp_mchrg_pers_nm);					
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					commonSubmission("9005", inp_mchrg_pers.currentText,  inp_mchrg_pers, inp_mchrg_pers_nm);
				}
				]]>
			</script>
		</input>
		<input id="input7" ref="/root/resData/resForm/dept_cd" navindex="27" style="left:401px; top:355px; width:60px; height:18px; "/>
		<input id="inp_slcrg_pers_nm" ref="/root/resData/resForm/slcrg_pers_nm" class="req" navindex="23" imemode="hangul" inputtype="button" caption="영업담당" crud="R" style="left:174px; top:330px; width:125px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					searchEmpno("setSlcrgPers", "/root/resData/resForm/slcrg_pers", "/root/resData/resForm/slcrg_pers_nm");
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm.currentText, inp_slcrg_pers, inp_slcrg_pers_nm);
				}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm.currentText, inp_slcrg_pers, inp_slcrg_pers_nm);
				]]>
			</script>
		</input>
		<input id="inp_mchrg_pers_nm" ref="/root/resData/resForm/mchrg_pers_nm" class="req" navindex="26" imemode="hangul" inputtype="button" caption="관리담당" crud="R" style="left:174px; top:355px; width:125px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					searchEmpno("setMchrgPers", "/root/resData/resForm/mchrg_pers", "/root/resData/resForm/mchrg_pers_nm");
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);
				}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);
				]]>
			</script>
		</input>
		<button id="btn_del" class="btn02" crud="D" style="left:702px; top:40px; width:50px; height:21px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
									
				if(windowConfirm("삭제하시겠습니까?")){
					model.setValue("/root/resData/resForm/preng_occr_dt", model.getValue("/root/reqData/searchData/preng_occr_dt"));
					model.setValue("/root/resData/resForm/preng_occr_seq", model.getValue("/root/reqData/searchData/preng_occr_seq"));
					
					if(instance1.selectSingleNode("/root/resData/resForm/flag") == null){
						model.makeNode("/root/resData/resForm/flag");
					}
					model.setValue("/root/resData/resForm/flag", "D");
					model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");
					model.send("ad_res_2120_a");
				}
						
				]]>
			</script>
		</button>
		<input id="inp_dlco_no" ref="/root/resData/resForm/dlco_no" class="req" navindex="4" autonext="false" maxlength="8" format="99999999" caption="광고주" style="left:106px; top:205px; width:60px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var dlco_no = inp_dlco_no.currentText;
				model.setValue("/root/resData/resForm/dlco_no", lpad(dlco_no, 8, "0"));
				inp_dlco_no.refresh();
				
				commonSubmission("9004", inp_dlco_no.currentText, inp_dlco_no, inp_dlco_nm);
							
				setChrgInfo();	
				SetExDlcoInfo();
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode== "13"){
					var dlco_no = inp_dlco_no.currentText;
					model.setValue("/root/resData/resForm/dlco_no", lpad(dlco_no, 8, "0"));
					inp_dlco_no.refresh();
					
					commonSubmission("9004", inp_dlco_no.currentText, inp_dlco_no, inp_dlco_nm);
								
					setChrgInfo();	
				}
				]]>
			</script>
		</input>
		<input id="inp_dlco_nm" ref="/root/resData/resForm/dlco_nm" class="req" navindex="5" imemode="hangul" inputtype="button" caption="광고주" crud="R" style="left:174px; top:205px; width:225px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText); 
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode== "13"){
					findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
					setChrgInfo();
				}					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					findDlcoNoByName("1", inp_dlco_nm.currentText, inp_dlco_no, inp_dlco_nm);
					setChrgInfo();				
				]]>
			</script>
		</input>
		<button id="btnClose" class="btn02" style="left:885px; top:40px; width:50px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

					if(window.type == "mdi"){
						viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					}else{
						window.close();
					}				
				]]>
			</script>
		</button>
		<caption id="caption10" class="list_cap01" style="left:345px; top:71px; width:85px; height:28px; ">매체</caption>
		<select1 id="cb_medi_cd" ref="/root/reqData/searchData/medi_cd" class="req" navindex="1" appearance="minimal" style="left:438px; top:76px; width:103px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/medi_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				//관리담당변경
				var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");
				//월간조선,주간조선(220,210)
				if(medi_cd == "220" || medi_cd == "210"){
					model.setValue("/root/resData/resForm/mchrg_pers","214002");
					model.setValue("/root/resData/resForm/mchrg_pers_nm","정지윤");
				}
				//여성조선,월간산,이코노미조선,웰빙라이프
				if(medi_cd == "270" || medi_cd == "230" || medi_cd == "240" || medi_cd == "250"){
					model.setValue("/root/resData/resForm/mchrg_pers","214001");
					model.setValue("/root/resData/resForm/mchrg_pers_nm","김명희");
				}
				model.refresh();
				]]>
			</script>
		</select1>
		<caption id="caption33" class="list_cap03" style="left:582px; top:351px; width:94px; height:26px; ">계산서이메일</caption>
		<input id="input3" ref="/root/resData/resForm/tax_email" navindex="25" style="left:680px; top:355px; width:205px; height:18px; "/>
		<select1 id="rdo_tax_clsf" ref="/root/resData/resForm/tax_clsf" visibility="hidden" appearance="full" cols="1" rows="3" vcellspacing="8" overflow="visible" style="left:900px; top:277px; width:20px; height:71px; border-style:none; ">
			<choices>
				<item>
					<label/>
					<value>1</value>
				</item>
				<item>
					<label/>
					<value>2</value>
				</item>
				<item>
					<label/>
					<value>4</value>
				</item>
			</choices>
		</select1>
		<bool id="bool4" navindex="29" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/advt_clsf" style="left:112px; top:379px; width:25px; height:20px; text-align:left; background-image:#uncheck; "/>
		<caption id="caption49" class="list_cap03" style="left:9px; top:376px; width:94px; height:26px; ">협찬여부</caption>
		<caption id="caption53" class="list_cap03" style="left:582px; top:401px; width:94px; height:26px; ">상대담당정보</caption>
		<input id="input4" ref="/root/resData/resForm/patr_chrg_info" navindex="25" imemode="hangul" style="left:680px; top:405px; width:205px; height:18px; "/>
	</xhtml:body>
</xhtml:html>
