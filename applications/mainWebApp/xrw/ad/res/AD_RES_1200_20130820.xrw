<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="/css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>광고예약등록</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<hndl_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</hndl_clsf>
							<advt_clas>
								<item>
									<label/>
									<value/>
								</item>
							</advt_clas>
							<chro_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</chro_clsf>
							<pubc_clas>
								<item>
									<label/>
									<value/>
								</item>
							</pubc_clas>
							<grp_cmpy_cd>
								<item>
									<label/>
									<value/>
								</item>
							</grp_cmpy_cd>
							<mony_kind>
								<item>
									<label/>
									<value/>
								</item>
							</mony_kind>
							<edt_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</edt_clsf>
							<nwsp_side_type>
								<item>
									<label/>
									<value/>
								</item>
							</nwsp_side_type>
							<medi_cd>
								<item>
									<label/>
									<value/>
								</item>
							</medi_cd>
							<dtnb_medi_cd>
								<item>
									<label/>
									<value/>
								</item>
							</dtnb_medi_cd>
						</comboSet>
						<pageInfo/>
						<hndl_nm/>
					</initData>
					<reqData>
						<fwdData>
							<medi_cd/>
							<preng_occr_dt/>
						</fwdData>
						<searchData>
							<medi_cd/>
							<preng_occr_dt/>
							<preng_occr_seq/>
							<pubc_occr_dt/>
							<pubc_occr_seq/>
						</searchData>
						<reqForm>
							<multiupdateData/>
						</reqForm>
						<multiUpdateData/>
					</reqData>
					<resData>
						<resForm>
							<medi_cd/>
							<preng_occr_dt/>
							<preng_occr_seq/>
							<dlco_no/>
							<dlco_nm/>
							<sect_nm/>
							<cm/>
							<dn/>
							<chro_clsf_nm/>
							<uprc/>
							<advt_fee/>
							<vat/>
							<pubc_tot_amt/>
							<pubc_side/>
							<rtax_yn/>
							<tabl_yn/>
							<hndl_clsf/>
							<agn/>
							<agn_nm/>
							<fee_rate/>
							<fee/>
							<hndl_plac_cd/>
							<hndl_plac_nm/>
							<coms_rate/>
							<coms/>
							<advt_clas/>
							<indt_clsf/>
							<indt_clsf_nm/>
							<mony_kind/>
							<chro_clsf/>
							<type_clsf/>
							<type_clsf_nm/>
							<exrate/>
							<pubc_clsf/>
							<grp_cmpy_cd/>
							<frex_cntr_amt/>
							<edt_clsf/>
							<slcrg_pers/>
							<slcrg_pers_nm/>
							<dept_cd/>
							<dept_nm/>
							<mchrg_pers/>
							<mchrg_pers_nm/>
							<advt_cont/>
							<remk/>
							<bo_chrg_aprv_pers/>
							<bo_chrg_aprv_dt/>
							<chrg_aprv_pers/>
							<chrg_aprv_dt/>
							<part_chf_aprv_pers/>
							<part_chf_aprv_dt/>
							<team_chf_aprv_pers/>
							<team_chf_aprv_dt/>
							<pubc_slip_no/>
							<preng_clos_yn/>
							<preng_dt/>
							<incmg_pers/>
							<incmg_pers_nm/>
							<flag/>
							<issu_chro_clsf/>
							<chrg_aprv/>
							<part_chf_aprv/>
							<team_chf_aprv/>
							<incmg_dt_tm/>
							<bool_ext01/>
							<bool_ext02/>
							<srch_plac/>
							<srch_dt/>
							<cntc_plac/>
							<tm/>
							<sect_clsf/>
							<cnfm_matt/>
							<org_preng_occr_dt>PRENG_OCCR_DT</org_preng_occr_dt>
							<org_preng_occr_seq>PRENG_OCCR_SEQ</org_preng_occr_seq>
							<nwsp_type_yn/>
							<nwsp_side_type/>
							<hp_slcrg_/>
							<pre_issu_yn/>
							<asist_pers/>
							<asist_pers_nm/>
							<pubc_frdt/>
							<pubc_todt/>
						</resForm>
						<gridData>
							<record>
							</record>
						</gridData>
						<gridData2>
							<record>
								<bus_plc/>
								<bus_clsf/>
								<bus_seq/>
							</record>
						</gridData2>
					</resData>
					<tempData>
						<keyData/>
					</tempData>
					<msgData/>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[						
					// 1. 게재일자 - 디폴트 내일, 수배일자 - 디폴트 금일
					var preng_occr_dt = dateAdd("d", +1, getCurrentDate());
					model.setValue("/root/reqData/searchData/preng_occr_dt"	,preng_occr_dt);
					model.setValue("/root/resData/resForm/srch_dt"			,getCurrentDate());

					// 2. 콤보코드 초기화
					model.send("ad_res_1200_m");
					model.copyNode("/root/initData/comboSet/hndl_clsf"		,"/root/tempData/hndl_clsf");
					model.copyNode("/root/initData/comboSet/advt_clas"		,"/root/tempData/advt_clas");
					model.copyNode("/root/initData/comboSet/chro_clsf"		,"/root/tempData/chro_clsf");
					model.copyNode("/root/initData/comboSet/pubc_clas"		,"/root/tempData/pubc_clas");
					model.copyNode("/root/initData/comboSet/grp_cmpy_cd"		,"/root/tempData/grp_cmpy_cd");
					model.copyNode("/root/initData/comboSet/mony_kind"		,"/root/tempData/mony_kind");
					model.copyNode("/root/initData/comboSet/edt_clsf"			,"/root/tempData/edt_clsf");		
					model.copyNode("/root/initData/comboSet/nwsp_side_type"	,"/root/tempData/nwsp_side_type");		
					model.copyNode("/root/initData/comboSet/medi_cd"		,"/root/tempData/medi_cd");		
					model.copyNode("/root/initData/comboSet/dtnb_medi_cd"		,"/root/tempData/dtnb_medi_cd");		
					// 공란추가하기 - 그룹사, 협찬광고
					//20130225 김상훈 공란 추가 게재구분,판구분,광고구분,색도구분
					makeComboGubun("", "/root/initData/comboSet/grp_cmpy_cd"		, "item", "label", "value");
					makeComboGubun("", "/root/initData/comboSet/nwsp_side_type"	, "item", "label", "value");
					
					makeComboGubun("", "/root/initData/comboSet/advt_clas"	, "item", "label", "value");
					makeComboGubun("", "/root/initData/comboSet/edt_clsf"	, "item", "label", "value");
					makeComboGubun("", "/root/initData/comboSet/chro_clsf"	, "item", "label", "value");
					makeComboGubun("", "/root/initData/comboSet/pubc_clas"	, "item", "label", "value");
					model.refresh();							

					// 3. 컨트롤 값 초기화 - 콤보값 초기화, 수정/삭제 비활성화, 대행사/광고지사 취급구분항목 숨기기
					initPage();
										
					// 4. 키값 설정 - 화면전환용
					var medi_cd 		= model.property("RES_1200_MEDI_CD");
					var preng_occr_dt 	= model.property("RES_1200_PRENG_OCCR_DT");
					var preng_occr_seq	= model.property("RES_1200_PRENG_OCCR_SEQ");
					
					if( medi_cd != "" && preng_occr_dt != "" && preng_occr_seq != "" )
					{
						model.setValue("/root/reqData/searchData/medi_cd", 		medi_cd);
						model.setValue("/root/reqData/searchData/preng_occr_dt",	preng_occr_dt);
						model.setValue("/root/reqData/searchData/preng_occr_seq", 	preng_occr_seq);

						loadData();
						
						model.property("RES_1200_MEDI_CD") 			= "";
						model.property("RES_1200_PRENG_OCCR_DT") 	= "";
						model.property("RES_1200_PRENG_OCCR_SEQ") 	= "";
					}
				]]>
			</script>
			<submission id="ad_res_1200_m" action="/ad/res/1200" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="ad_res_1210_s" action="/ad/res/1210" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData"/>
			<submission id="ad_res_1220_a" action="/ad/res/1220" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/msgData"/>
			<submission id="ad_res_1260_s" action="/ad/res/1260" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[			
			var _sect_nm = ""; //전역변수 지면섹션
				
				function setDlcoInfo(dlco_no, dlco_nm)
				{
					var gnr_advcs_yn = model.getValue("/root/reqData/fwdData/gnr_advcs_yn");
					var agn_yn       = model.getValue("/root/reqData/fwdData/agn_yn");
					var advt_bo_yn   = model.getValue("/root/reqData/fwdData/advt_bo_yn");
					var bo_bof_yn    = model.getValue("/root/reqData/fwdData/bo_bof_yn");
					
					if(gnr_advcs_yn == "Y")
					{
						model.setValue("/root/resData/resForm/dlco_no", dlco_no);
						model.setValue("/root/resData/resForm/dlco_nm", dlco_nm);					
						inp_dlco_no.refresh();
						inp_dlco_nm.refresh();			
						
						setExDlcoInfo("1", inp_dlco_no, "");
						if(submit_completed()){
							setDlcoResultInfo();
						}
						
	//					setChrgInfo();
								
					}
					else if(agn_yn == "Y")
					{
						model.setValue("/root/resData/resForm/agn", dlco_no);
						model.setValue("/root/resData/resForm/agn_nm", dlco_nm);					
						inp_agn.refresh();
						inp_agn_nm.refresh();				
					}
					else if(advt_bo_yn  == "Y" || bo_bof_yn  == "Y")
					{
						model.setValue("/root/resData/resForm/hndl_plac_cd", dlco_no);
						model.setValue("/root/resData/resForm/hndl_plac_nm", dlco_nm);					
						inp_hndl_plac_cd.refresh();
						inp_hndl_plac_nm.refresh();				
					}					
				}
			
				function EnableButton()
				{
					var emp_no = model.property("ss_emp_no");
//					alert(emp_no);
//					alert(Number("e"));
//					alert(isNumber("ed00010"));
//					if( Number(emp_no.substr(0,1)) == 0 )
					if( isNumber(emp_no.substr(0,1)) == false && emp_no != "it0015" )
					{
						button1.disabled = true;
						button2.disabled = true;
						button5.disabled = true;
						button9.disabled = true;
						button11.disabled = true;
					}
					else
					{
						button1.disabled = false;
						button2.disabled = false;
						button5.disabled = false;
						button9.disabled = false;
						button11.disabled = false;
					}
				}
			
				/////////////////////////////////////////////////////// 
				// 인수 : 없음.
				// 기능 : 컨트롤 디폴트 값 지정 
				//		- 콤보컨트롤, 수정/삭제버튼 비활성화, 취급구분 대행사/지사 숨기기
				///////////////////////////////////////////////////////
				function initPage()
				{
					cb_medi_cd.select(0);
					cb_hndl_clsf.select(0);
					cb_advt_clas.select(0);
					cb_pubc_clsf.select(0);
					cb_edt_clsf.select(0);
					cb_mony_kind.value	=	"KRW";
					//cb_chro_clsf.value	=	"2";
					cb_chro_clsf.select(0);
					// 수정,삭제 disable
					btn_upd.disabled 	=	true;
					btn_del.disabled 	= 	true;
					
					// 대행사, 광고지사 취급구분 항목 숨기기
					grp_agn.visible 		= 	false;
					grp_hndl_clsf.visible 	= 	false;
					
					EnableButton();
				}
				
				/////////////////////////////////////////////////////// 
				// 인수 : 없음.
				// 기능 : 컨트롤 디폴트 값 지정 
				//		- 콤보컨트롤, 수정/삭제버튼 비활성화, 취급구분 대행사/지사 숨기기
				///////////////////////////////////////////////////////
				function setChrgInfo(){
					modelSendNoMake("ad_co_9007_s", "/ad/common/9007", "/root/resData/resForm", "/root/tempData");	
					if( submit_completed( )){
						if( model.getValue("/root/resData/resForm/slcrg_pers") == "" ){
							model.setValue("/root/resData/resForm/slcrg_pers", 		model.getValue("/root/tempData/slcrg_pers"));
							model.setValue("/root/resData/resForm/slcrg_pers_nm", 		model.getValue("/root/tempData/slcrg_pers_nm"));
						}
						if(model.getValue("/root/resData/resForm/dept_cd") == ""){
							model.setValue("/root/resData/resForm/dept_cd",       	model.getValue("/root/tempData/dept_cd"));
							model.setValue("/root/resData/resForm/dept_nm", 		model.getValue("/root/tempData/dept_nm"));
						}
						if(model.getValue("/root/resData/resForm/mchrg_pers") == ""){
							model.setValue("/root/resData/resForm/mchrg_pers", 		model.getValue("/root/tempData/mchrg_pers"));
							model.setValue("/root/resData/resForm/mchrg_pers_nm", 	model.getValue("/root/tempData/mchrg_pers_nm"));
						}
						
						model.setValue("/root/resData/resForm/grp_cmpy_cd", 	model.getValue("/root/tempData/grp_cmpy_cd"));
						
						model.refresh();
					}
				}
			
			function setMchrgInfo(){

				var dlco_no		=	"";
				
				var hndl_clsf	=	model.getValue("/root/resData/resForm/hndl_clsf");
				
				if(hndl_clsf			==	"2"){
					dlco_no	=	model.getValue("/root/resData/resForm/agn");
				}else if(hndl_clsf 	== 	"4"){
					dlco_no	=	model.getValue("/root/resData/resForm/agn");
					if( dlco_no == "" )	dlco_no	=	model.getValue("/root/resData/resForm/hndl_plac_cd");
				}else{
					return;
				}
				
				if(dlco_no	==	"")	return;
				
				makeNodeValue("/root/tempData/dlco_no", dlco_no);
				modelSendNoMake("ad_co_9007_s", "/ad/common/9007", "/root/tempData", "/root/tempData");	
				if(submit_completed()){
					model.setValue("/root/resData/resForm/mchrg_pers", 		model.getValue("/root/tempData/mchrg_pers"));
					model.setValue("/root/resData/resForm/mchrg_pers_nm", 	model.getValue("/root/tempData/mchrg_pers_nm"));
					model.refresh();
				}
			}
			
			function selectPubcPreng(medi_cd, preng_occr_dt, preng_occr_seq){
				
				model.setValue("/root/reqData/searchData/medi_cd", medi_cd);
				model.setValue("/root/reqData/searchData/preng_occr_dt", preng_occr_dt);
				model.setValue("/root/reqData/searchData/preng_occr_seq", preng_occr_seq);
				
				loadData();
				
			}
			
			function selectPubc(medi_cd, pubc_occr_dt, pubc_occr_seq){
				
				model.setValue("/root/reqData/searchData/medi_cd", medi_cd);
				model.setValue("/root/reqData/searchData/pubc_occr_dt", pubc_occr_dt);
				model.setValue("/root/reqData/searchData/pubc_occr_seq", pubc_occr_seq);
				
				model.send("ad_res_1260_s");
				if(submit_completed()){
					model.setValue("/root/reqData/searchData/medi_cd", 			model.getValue("/root/resData/resForm/medi_cd"));
					model.setValue("/root/reqData/searchData/preng_occr_dt",  	model.getValue("/root/resData/resForm/preng_occr_dt"));
					model.setValue("/root/reqData/searchData/preng_occr_seq",  	model.getValue("/root/resData/resForm/preng_occr_seq"));	
					
					var hndl_clsf = model.getValue("/root/resData/resForm/hndl_clsf");
					if(hndl_clsf	==	"1"){
						grp_agn.visible = false;
						grp_hndl_clsf.visible = false;
					}
					if(hndl_clsf == "2"){
						grp_agn.visible = true;
					}
					if(hndl_clsf == "4"){
						grp_agn.visible = true;
						grp_hndl_clsf.visible = true;
						model.setValue("/root/initData/hndl_nm", "광고지사");	
					}
					if(hndl_clsf == "5"){
						grp_agn.visible = true;
						grp_hndl_clsf.visible = true;
						model.setValue("/root/initData/hndl_nm", "지국지사");	
					}
					if(hndl_clsf == "7"){
						grp_agn.visible = true;
						grp_hndl_clsf.visible = true;
						model.setValue("/root/initData/hndl_nm", "해외지사");	
					}
					
//					btn_ins.disabled = true;
					btn_upd.disabled = false;
					btn_del.disabled = false;		
										
					model.refresh();				
				}
			}

			function setIndt(indt_clsf, indt_clsf_nm){
				model.setValue("/root/resData/resForm/indt_clsf", indt_clsf);
				model.setValue("/root/resData/resForm/indt_clsf_nm", indt_clsf_nm);
				
				inp_indt_clsf.refresh();
				inp_indt_clsf_nm.refresh();			
				
			}		
			
			function setType(type_clsf, type_clsf_nm){
				model.setValue("/root/resData/resForm/type_clsf", type_clsf);
				model.setValue("/root/resData/resForm/type_clsf_nm", type_clsf_nm);
				
				inp_type_clsf.refresh();
				inp_type_clsf_nm.refresh();			
				
			}			
			
			function checkAll()
			{
				var	sect_nm		=	model.getValue("/root/resData/resForm/sect_nm");
				var	pubc_side		=	Number(model.getValue("/root/resData/resForm/pubc_side"));
				
				if(sect_nm	!= "" && sect_nm != "0")
				{
					if( pubc_side == 0 )
					{
						alert("해당면에 면번호가 확정되지 않았습니다. 해당면을 다시 조회하세요.");
						return;
					}
				}
/*				
				var issu_chro_clsf = model.getValue("/root/resData/resForm/issu_chro_clsf");				
				if(issu_chro_clsf == "1"){
					if(model.getValue("/root/resData/resForm/chro_clsf") != "1"){
						alert("흑백면에 컬러광고가 예약 될수 없습니다.[1]");
						return false;
					}
				}				
*/		
				var	pubc_clsf	=	model.getValue("/root/resData/resForm/pubc_clsf");
				if( pubc_clsf	==	"2" )
				{
					//기사중광고는 지방판이 없다.
					var edt_clsf	=	model.getValue("/root/resData/resForm/edt_clsf");
					if( edt_clsf	== "2" )
					{
						alert("기사중광고는 지방판으로 등록될 수 없습니다.");
						return;
					}
				}
				
				var mony_kind = model.getValue("/root/resData/resForm/mony_kind");
				if( mony_kind != "KRW" )
				{
					var exrate = model.getValue("/root/resData/resForm/exrate");
					if( exrate == "" )
					{
						alert("환율을 확인하십시오.");
						return false;
					}
					var frex_cntr_amt = model.getValue("/root/resData/resForm/frex_cntr_amt");
					if (frex_cntr_amt == "" )
					{
						alert("외화계약액을 확인하십시오.");
						return false;
					}
				}				
				var hndl_clsf 	= model.getValue("/root/resData/resForm/hndl_clsf");
				var agn 			= model.getValue("/root/resData/resForm/agn");
				var agn_nm 		= model.getValue("/root/resData/resForm/agn_nm");
				var hndl_plac_cd = model.getValue("/root/resData/resForm/hndl_plac_cd");	
				var hndl_plac_nm = model.getValue("/root/resData/resForm/hndl_plac_nm");							
				var fee      	= Number(model.getValue("/root/resData/resForm/fee"));
				var fee_rate 	= Number(model.getValue("/root/resData/resForm/fee_rate"));
				var coms      	= Number(model.getValue("/root/resData/resForm/coms"));
				var coms_rate	= Number(model.getValue("/root/resData/resForm/coms_rate"));	
				var advt_fee	 	= Number(model.getValue("/root/resData/resForm/advt_fee"));		
				var vat 			= Number(model.getValue("/root/resData/resForm/vat"));		
				var pubc_tot_amt = Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));						
												
				if(hndl_clsf == "1"){
					//광고주
					if(agn != "" || hndl_plac_cd != ""){
						alert("광고주 선택시 대행사 또는 취급처를 입력할 수 없습니다. ");
						return false;
					}
					if(fee != 0 || fee_rate != 0 || coms != 0 || coms_rate != 0){						
						alert("광고주 선택시 대행료 또는 수수료를 입력할 수 없습니다. ");
						return false;
					}
				}
				else if(hndl_clsf == "2"){
					if(hndl_plac_cd != ""){
						alert("대행사 선택시 취급처를 입력할 수 없습니다. ");
						return false;
					}
					if(agn == "" || agn_nm == ""){
						window.alert("대행사를 입력하세요.");
						model.setFocus("inp_agn_nm");
						return false;
					}
				}
				else if(hndl_clsf == "4" || hndl_clsf == "5" || hndl_clsf == "7"){
					if(hndl_plac_cd == "" || hndl_plac_nm == ""){
						alert("취급처를 입력하세요.");
						model.setFocus("inp_hndl_plac_nm");
						return false;
					}					
				}
				
				if(agn != ""){
					//대행사
/*					
					if(fee_rate <= 0 || fee_rate > 15){
						alert("대행료율의 범위는 0 < 수수료율 <= 15 입니다.");
						return false;
					}					
*/					
					if(fee_rate > 0){
						var ocha = fee - ( pubc_tot_amt * fee_rate )/100;
						if(ocha > 100){
	               			alert("대행료는 (총게재액 * 요율 / 100) 값과 100 이상의 오차 발생시 Error입니다.");
	               			return false;
	               			}
					}
				}
				var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");
				
				if(hndl_plac_cd != ""){
					//취급처		
					var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");
					if(medi_cd	==	"110"){
						if(coms_rate <  0 || coms_rate > 25){
							alert("수수료율의 범위는 0 <= 수수료율 <= 25 입니다.");
							return false;
						}																				
					}
					else if(medi_cd == "130"){
						if(coms_rate < 0 || coms_rate > 30){
							alert("수수료율의 범위는 0 <= 수수료율 <= 30 입니다.");
							return false;
						}	
					}
				}
				
				if(medi_cd	==	"110"){
					if(fee_rate + coms_rate > 25){
						alert("대행료율과 수수료율의 합은 25 보다 클 수 없습니다.");
						return false;
					}			
				}
				else if(medi_cd	==	"130"){
					if(fee_rate + coms_rate > 30){
						alert("대행료율과 수수료율의 합은 30 보다 클 수 없습니다.");
						return false;
					}			
				}
				
				var bool_ext01 = model.getValue("/root/resData/resForm/bool_ext01");
				if(bool_ext01 == "Y"){
					if(model.getValue("/root/resData/resForm/srch_dt") == ""){
						alert("광고원고수배장 수배일자를 입력하세요.");
						model.setFocus("inp_srch_dt");
						return false;
					}
					if(model.getValue("/root/resData/resForm/srch_plac") == ""){
						alert("광고원고수배장 수배처를 입력하세요.");
						model.setFocus("inp_srch_plac");
						return false;
					}
/*					
					if(model.getValue("/root/resData/resForm/cntc_plac") == ""){
						alert("광고원고수배장 연락처를 입력하세요.");
						return false;
					}
*/					
					if(model.getValue("/root/resData/resForm/tm") == ""){
						alert("광고원고수배장 시간을 입력하세요.");
						model.setFocus("inp_tm");
						return false;
					}
					if(model.getValue("/root/resData/resForm/sect_clsf") == ""){
						alert("광고원고수배장 구분을 선택하세요.");
						model.setFocus("cb_sect_clsf");
						return false;
					}
				}				
				
				var bool_ext02 = model.getValue("/root/resData/resForm/bool_ext02");
				if(bool_ext02 == "Y"){					
					if(model.getValue("/root/resData/resForm/cnfm_matt") == ""){
						alert("중점광고확인 확인사항을 선택하세요.");
						model.setFocus("inp_cnfm_matt");
						return false;
					}
				}
			        
				var rtax_yn = model.getValue("/root/resData/resForm/rtax_yn");
				if(rtax_yn != "Y" && mony_kind == "KRW"){			        	
					ocha = (advt_fee * 0.1) - vat;	
			        	if(ocha < -100 || ocha > 100){
			        		alert("(광고료/10 - 부가세)의 오차가 100을 초과했습니다.");
			        		return false;
					}
				}
				//색도구분
				var chro_clsf = model.getValue("/root/resData/resForm/chro_clsf");
				if(chro_clsf == ""){
					alert("색도구분을 선택해주세요");
					return false;
				}
				//게재구분
				var pubc_clsf = model.getValue("/root/resData/resForm/pubc_clsf");
				if(pubc_clsf == ""){
					alert("게재구분을 선택해주세요");
					return false;
				}
				//판구분
				var edt_clsf = model.getValue("/root/resData/resForm/edt_clsf");
				if(edt_clsf == ""){
					alert("판구분을 선택해주세요");
					return false;
				}
				
				return true;
			}
			function busInit(){
					var medi_cd = model.getValue("/root/resData/resForm/medi_cd");
					if(medi_cd == "540"){
						model.removeNodeset("/root/resData/gridData2");
						model.refresh();
					}
				}
			function loadData()
			{
				busInit();//뉴비즈 버스승강장 초기화
				model.send("ad_res_1210_s");
				if( submit_completed() )
				{
					if( model.getValue("/root/resData/resForm/urpc") == "0" )
					{
						alert("검색결과가 없습니다.");
						return;
					}
					
					var hndl_clsf = model.getValue("/root/resData/resForm/hndl_clsf");
					if(hndl_clsf	==	"1"){
						grp_agn.visible = false;
						grp_hndl_clsf.visible = false;
					}
					if(hndl_clsf == "2"){
						grp_agn.visible = true;
					}
					if(hndl_clsf == "4"){
						grp_agn.visible = true;
						grp_hndl_clsf.visible = true;
						model.setValue("/root/initData/hndl_nm", "광고지사");	
					}
					if(hndl_clsf == "5"){
						grp_agn.visible = true;
						grp_hndl_clsf.visible = true;
						model.setValue("/root/initData/hndl_nm", "지국지사");	
					}
					if(hndl_clsf == "7"){
						grp_agn.visible = true;
						grp_hndl_clsf.visible = true;
						model.setValue("/root/initData/hndl_nm", "해외지사");	
					}
					
//					btn_ins.disabled = true;
					btn_upd.disabled = false;
					btn_del.disabled = false;				
					
					model.refresh();
					
//					inp_sect_nm.attribute("editable") = "false";
				}		
				
				changeOnMediCd();
			}
						
			function goReport(gubun){
					
				// 오즈관련 노드 초기화..					
				resetOznode();					
									
				// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
				makeNodeValue("/root/oz_data/ozrName", "ad/SP_AD_RES_1210_P1");									
							
				var root			= "/root/reqData/searchData";
				var root2			= "/root/resData/resForm";
				
					
				var preng_occr_dt      	= model.getValue(	root + "/preng_occr_dt");		
				var preng_occr_seq     	= model.getValue(	root + "/preng_occr_seq");		
				var dlco_nm			= model.getValue(	root2 + "/dlco_nm");
				var dn   				= model.getValue(	root2 + "/dn");	
				var cm   				= model.getValue(	root2 + "/cm");	
				var chro_clsf      		= model.getValue(	root2 + "/chro_clsf");	
				var sect_nm			= model.getValue(    root2 + "/sect_nm");
				var advt_fee			= model.getValue(    root2 + "/advt_fee");		
				var frex_cntr_amt		= model.getValue(    root2 + "/frex_cntr_amt");		

				
				makeNodeValue("/root/oz_data/odiParam/iv_preng_occr_dt"		, preng_occr_dt	);	
				makeNodeValue("/root/oz_data/odiParam/iv_preng_occr_seq"		, preng_occr_seq);					
				makeNodeValue("/root/oz_data/odiParam/iv_dlco_nm"			, dlco_nm	);	
				makeNodeValue("/root/oz_data/odiParam/iv_dn"				, dn);	
				makeNodeValue("/root/oz_data/odiParam/iv_cm"				, cm);	
				makeNodeValue("/root/oz_data/odiParam/iv_chro_clsf"		        , chro_clsf);	
				makeNodeValue("/root/oz_data/odiParam/iv_sect_nm"		        , sect_nm);
				makeNodeValue("/root/oz_data/odiParam/iv_advt_fee"		        , advt_fee);
				makeNodeValue("/root/oz_data/odiParam/iv_frex_cntr_amt"		 , frex_cntr_amt);
							
				// 레포트뷰어 호출.					
				openOzwin("/root/oz_data");	
			}
			
			function goReport2(gubun){
					
				// 오즈관련 노드 초기화..					
				resetOznode();					
									
				// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)					
				makeNodeValue("/root/oz_data/ozrName", "ad/SP_AD_RES_1210_P2");									
							
				var root			= "/root/reqData/searchData";
				var root2			= "/root/resData/resForm";				
								
				
				var preng_occr_dt		= model.getValue(	root + "/preng_occr_dt");	
				var dlco_no			= model.getValue(	root2 + "/dlco_no");	
				var dlco_nm			= model.getValue(	root2 + "/dlco_nm");	
				var slcrg_pers			= model.getValue(	root2 + "/slcrg_pers");	 
				var slcrg_pers_nm		= model.getValue(	root2 + "/slcrg_pers_nm");	 
				var chro_clsf      		= model.getValue(	root2 + "/chro_clsf");	
				var dn   				= model.getValue(	root2 + "/dn");	
				var cm   				= model.getValue(	root2 + "/cm");	
				var sect_nm			= model.getValue(	root2 + "/sect_nm");	
				var edt_clsf			= model.getValue(	root2 + "/edt_clsf");	 
				var advt_fee			= model.getValue(    root2 + "/advt_fee");	
				var vat				= model.getValue(    root2 + "/vat");	
				var pubc_tot_amt		= model.getValue(    root2 + "/pubc_tot_amt");	
				
				
				//if ( dlco_no == "" ){
				//	commAlert("거래처번호가 없습니다.");
				//	return;
				//}	
		
		
				makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd",model.property("ss_cmpycd"));					
				makeNodeValue("/root/oz_data/odiParam/iv_slcrg_pers"			, slcrg_pers);
				makeNodeValue("/root/oz_data/odiParam/iv_slcrg_pers_nm"		, slcrg_pers_nm);	
				makeNodeValue("/root/oz_data/odiParam/iv_preng_occr_dt"		, preng_occr_dt);	
				makeNodeValue("/root/oz_data/odiParam/iv_dlco_no"			, dlco_no);	
				makeNodeValue("/root/oz_data/odiParam/iv_dlco_nm"			, dlco_nm);					
				makeNodeValue("/root/oz_data/odiParam/iv_chro_clsf"			, chro_clsf);
				makeNodeValue("/root/oz_data/odiParam/iv_dn"				, dn);
				makeNodeValue("/root/oz_data/odiParam/iv_cm"				, cm);
				makeNodeValue("/root/oz_data/odiParam/iv_sect_nm"		        , sect_nm);
				makeNodeValue("/root/oz_data/odiParam/iv_edt_clsf"		        , edt_clsf);
				makeNodeValue("/root/oz_data/odiParam/iv_advt_fee"		        , advt_fee);
				makeNodeValue("/root/oz_data/odiParam/iv_vat_amt"			 , vat);				
				makeNodeValue("/root/oz_data/odiParam/iv_tot_amt"			 , pubc_tot_amt);
				
			
				// 레포트뷰어 호출.					
				openOzwin("/root/oz_data");	
			}
			

			function recalculate(uprc_yn, advt_fee_yn, vat_yn, pubc_tot_amt_yn, dn_cm_yn){
				
				var pubc_tot_amt	=	Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));				
				var advt_fee 		=	Number(model.getValue("/root/resData/resForm/advt_fee"));					
				var vat 			=	Number(model.getValue("/root/resData/resForm/vat"));				
				var uprc			=	Number(model.getValue("/root/resData/resForm/uprc"));					
				var dn			=	Number(model.getValue("/root/resData/resForm/dn"));				
				var cm			=	Number(model.getValue("/root/resData/resForm/cm"));
				
				var medi_cd		=	cb_medi_cd.value
				
				if(medi_cd	==	"110" || medi_cd == "130" || medi_cd == "190" || medi_cd == "120" ){
					if(pubc_tot_amt_yn == "Y"){					
						advt_fee		=	Math.round((pubc_tot_amt * 10) / 11);
						vat			=	Math.round((pubc_tot_amt * 1) / 11);
						uprc			=	dn * cm  == 0 ? 0 : Math.round(advt_fee/(dn * cm));	
						
						model.setValue("/root/resData/resForm/uprc", uprc);
						model.setValue("/root/resData/resForm/advt_fee", advt_fee);
						model.setValue("/root/resData/resForm/vat", vat);
										
					}
					else if(uprc_yn == "Y"){
						advt_fee		=	Math.round(uprc * dn * cm);
						vat			=	Math.round(advt_fee / 10);
						pubc_tot_amt	=	advt_fee + vat;
	
						model.setValue("/root/resData/resForm/advt_fee", advt_fee);
						model.setValue("/root/resData/resForm/vat", vat);
						model.setValue("/root/resData/resForm/pubc_tot_amt", pubc_tot_amt);		
										
					}
					else if(advt_fee_yn == "Y" && dn_cm_yn == ""){
	//					if(Number(model.getValue("/root/resData/resForm/uprc")) == 0){
							uprc		=	dn * cm  == 0  ? 0 : Math.round(advt_fee/(dn * cm));
							model.setValue("/root/resData/resForm/uprc", uprc);
	//					}
	//					if(Number(model.getValue("/root/resData/resForm/vat"))	==	0){
							vat		=	Math.round(advt_fee / 10);
							model.setValue("/root/resData/resForm/vat", vat);
	//					}
	
						pubc_tot_amt	=	advt_fee + vat;
						model.setValue("/root/resData/resForm/pubc_tot_amt", pubc_tot_amt);	
					}
					else if(vat_yn	==	"Y"){	
	
	//					if(Number(model.getValue("/root/resData/resForm/advt_fee")) == 0){
							advt_fee		=	Math.round(vat * 10);	
							model.setValue("/root/resData/resForm/advt_fee", advt_fee);
	//					}
	//					if(Number(model.getValue("/root/resData/resForm/uprc")) == 0){
							uprc			=	dn * cm  == 0  ? 0 : Math.round(advt_fee/(dn * cm));
							model.setValue("/root/resData/resForm/uprc", uprc);
	//					}
											
						pubc_tot_amt	=	advt_fee + vat;
						model.setValue("/root/resData/resForm/pubc_tot_amt", pubc_tot_amt);		
													
					}
					else if( dn_cm_yn == "Y" && advt_fee_yn == "" )
					{
						if( uprc * dn * cm != 0 ){
							advt_fee		= 	Math.round(uprc * dn * cm);
							vat			=	Math.round(advt_fee / 10);
							pubc_tot_amt	=	advt_fee + vat;
		
							model.setValue("/root/resData/resForm/advt_fee", advt_fee);
							model.setValue("/root/resData/resForm/vat", vat);
							model.setValue("/root/resData/resForm/pubc_tot_amt", pubc_tot_amt);	
//							if( rtax_yn == "Y" )	vat = 0;
//							else				vat = Math.round(uprc * dn * cm / 10);
							pubc_tot_amt	= advt_fee + vat;
						}
					}
					//20120820 정찬화과장 요구사항
					//예약 수정시 단/cm이 변경이 되면 단가 자동 계산 단,광고료/부가세/게재총액은 변동 없음
					else if(advt_fee_yn == "Y" && dn_cm_yn == "Y"){
						uprc		=	dn * cm  == 0  ? 0 : Math.round(advt_fee/(dn * cm));
						model.setValue("/root/resData/resForm/uprc", uprc);						
					}					
				}	
				else{
					if(pubc_tot_amt_yn == "Y"){					
						advt_fee		=	Math.round((pubc_tot_amt * 10) / 11);
						vat			=	Math.round((pubc_tot_amt * 1) / 11);
						model.setValue("/root/resData/resForm/advt_fee", advt_fee);
						model.setValue("/root/resData/resForm/vat", vat);
										
					}
					else if(advt_fee_yn == "Y" && dn_cm_yn == ""){						
						vat			=	Math.round(advt_fee / 10);
						pubc_tot_amt	=	advt_fee + vat;
						model.setValue("/root/resData/resForm/vat", vat);	
						model.setValue("/root/resData/resForm/pubc_tot_amt", pubc_tot_amt);	
					}
					else if(vat_yn	==	"Y"){	
						advt_fee		=	Math.round(vat * 10);	
						pubc_tot_amt	=	advt_fee + vat;
						model.setValue("/root/resData/resForm/advt_fee", advt_fee);						
						model.setValue("/root/resData/resForm/pubc_tot_amt", pubc_tot_amt);		
													
					}
				}
				var hndl_clsf	=	model.getValue("/root/resData/resForm/hndl_clsf");
				var fee_rate		=	Number(model.getValue("/root/resData/resForm/fee_rate"));
				if(fee_rate > 0){
					var fee = Math.round(pubc_tot_amt * (fee_rate/100));
					model.setValue("/root/resData/resForm/fee", fee);
					inp_fee.refresh();
				}
				var coms_rate	=	Number(model.getValue("/root/resData/resForm/coms_rate"));
				if(coms_rate > 0){
					var coms = Math.round(pubc_tot_amt * (coms_rate/100));
					model.setValue("/root/resData/resForm/coms", coms);
					inp_coms.refresh();
				}
				
				inp_uprc.refresh();
				inp_advt_fee.refresh();
				inp_vat.refresh();
				inp_pubc_tot_amt.refresh();
								
			}
			
			function setDlcoResultInfo(){
						
				var dlco_no			=	model.getValue("/root/tempData/resData/dlco_no");
				var dlco_nm			=	model.getValue("/root/tempData/resData/dlco_nm");
				var slcrg_pers			=	model.getValue("/root/tempData/resData/slcrg_pers");
				var slcrg_pers_nm		=	model.getValue("/root/tempData/resData/slcrg_pers_nm");
				var mchrg_pers			=	model.getValue("/root/tempData/resData/mchrg_pers");
				var mchrg_pers_nm 		=	model.getValue("/root/tempData/resData/mchrg_pers_nm");
				var dept_cd			=	model.getValue("/root/tempData/resData/dept_cd");
				var dept_nm			=	model.getValue("/root/tempData/resData/dept_nm");
				var grp_cmpy_cd		=	model.getValue("/root/tempData/resData/grp_cmpy_cd");
				var indt_cd			=	model.getValue("/root/tempData/resData/indt_cd");
				var indt_nm			=	model.getValue("/root/tempData/resData/indt_nm");
				var type_cd			=	model.getValue("/root/tempData/resData/type_cd");
				var type_nm			=	model.getValue("/root/tempData/resData/type_nm");
					
				if(dlco_no	==	"TMRS"){
					model.setValue("/root/resData/resForm/dlco_nm", dlco_nm)
					inp_dlco_nm.refresh();
					showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText); 					
					return;
				}
				model.setValue("/root/resData/resForm/dlco_no", dlco_no);
				model.setValue("/root/resData/resForm/dlco_nm", dlco_nm);

				if(model.getValue("/root/resData/resForm/slcrg_pers") == ""){
					model.setValue("/root/resData/resForm/slcrg_pers", slcrg_pers);
					model.setValue("/root/resData/resForm/slcrg_pers_nm", slcrg_pers_nm);
				}
//				if(model.getValue("/root/resData/resForm/slcrg_pers_nm") == ""){
//					model.setValue("/root/resData/resForm/slcrg_pers_nm", slcrg_pers_nm);
//				}
				if(model.getValue("/root/resData/resForm/mchrg_pers") == ""){
					model.setValue("/root/resData/resForm/mchrg_pers", mchrg_pers);
					model.setValue("/root/resData/resForm/mchrg_pers_nm", mchrg_pers_nm);
				}
//				if(model.getValue("/root/resData/resForm/mchrg_pers_nm") == ""){
//					model.setValue("/root/resData/resForm/mchrg_pers_nm", mchrg_pers_nm);
//				}
				if(model.getValue("/root/resData/resForm/dept_cd") == ""){
					model.setValue("/root/resData/resForm/dept_cd", dept_cd);
					model.setValue("/root/resData/resForm/dept_nm", dept_nm);
				}
//				if(model.getValue("/root/resData/resForm/dept_nm") == ""){
//					model.setValue("/root/resData/resForm/dept_nm", dept_nm);
//				}
				model.setValue("/root/resData/resForm/grp_cmpy_cd", grp_cmpy_cd);
				
				if(model.getValue("/root/resData/resForm/indt_clsf") == ""){
					model.setValue("/root/resData/resForm/indt_clsf"		, indt_cd);
					model.setValue("/root/resData/resForm/indt_clsf_nm"	, indt_nm);
				}
				
				if(model.getValue("/root/resData/resForm/type_clsf") == ""){
					model.setValue("/root/resData/resForm/type_clsf"		, type_cd);
					model.setValue("/root/resData/resForm/type_clsf_nm"	, type_nm);
				}
				
				model.refresh();
				
			}

			function setAgnResultInfo(){
						
				var dlco_no			=	model.getValue("/root/tempData/resData/dlco_no");
				var dlco_nm			=	model.getValue("/root/tempData/resData/dlco_nm");
				var mchrg_pers		=	model.getValue("/root/tempData/resData/mchrg_pers");
				var mchrg_pers_nm 	=	model.getValue("/root/tempData/resData/mchrg_pers_nm");

				if(dlco_no	==	"TMRS"){
					model.setValue("/root/resData/resForm/agn_nm", dlco_nm)
					inp_agn_nm.refresh();
					showAdvcsSearchPopup("", "", "Y", "", "", inp_agn_nm.currentText); 					
					return;
				}
				
				model.setValue("/root/resData/resForm/agn", dlco_no);
				model.setValue("/root/resData/resForm/agn_nm", dlco_nm);

//				if(model.getValue("/root/resData/resForm/mchrg_pers") == ""){
					model.setValue("/root/resData/resForm/mchrg_pers", mchrg_pers);
//				}
//				if(model.getValue("/root/resData/resForm/mchrg_pers_nm") == ""){
					model.setValue("/root/resData/resForm/mchrg_pers_nm", mchrg_pers_nm);
//				}
				
				if(dlco_no == "" || dlco_nm == "") {
					model.setValue("/root/resData/resForm/fee_rate", "");
					model.setValue("/root/resData/resForm/fee", "");	
					inp_fee_rate.refresh();
					inp_fee.refresh();				
				}
				
				inp_agn.refresh();
				inp_agn_nm.refresh();
				inp_mchrg_pers.refresh();
				inp_mchrg_pers_nm.refresh();
				
			}		
			function setHndlPlacResultInfo(){
						
				var dlco_no			=	model.getValue("/root/tempData/resData/dlco_no");
				var dlco_nm			=	model.getValue("/root/tempData/resData/dlco_nm");
				var mchrg_pers		=	model.getValue("/root/tempData/resData/mchrg_pers");
				var mchrg_pers_nm 	=	model.getValue("/root/tempData/resData/mchrg_pers_nm");

				if(dlco_no	==	"TMRS"){
					model.setValue("/root/resData/resForm/hndl_plac_nm", dlco_nm)
					inp_agn_nm.refresh();	
					showAdvcsSearchPopup("", "", "", "Y", "Y", inp_hndl_plac_nm.currentText); 					
					return;
				}
				
				model.setValue("/root/resData/resForm/hndl_plac_cd", dlco_no);
				model.setValue("/root/resData/resForm/hndl_plac_nm", dlco_nm);

//				if(model.getValue("/root/resData/resForm/mchrg_pers") == ""){
					model.setValue("/root/resData/resForm/mchrg_pers", mchrg_pers);
//				}
//				if(model.getValue("/root/resData/resForm/mchrg_pers_nm") == ""){
					model.setValue("/root/resData/resForm/mchrg_pers_nm", mchrg_pers_nm);
//				}


				if(dlco_no == "" || dlco_nm == "") {
					model.setValue("/root/resData/resForm/coms_rate", "");
					model.setValue("/root/resData/resForm/coms", "");	
					inp_coms_rate.refresh();
					inp_coms.refresh();				
				}
				
				inp_hndl_plac_cd.refresh();
				inp_hndl_plac_nm.refresh();
				inp_mchrg_pers.refresh();
				inp_mchrg_pers_nm.refresh();
				
			}		

			function setExDlcoInfo(dlco_clsf, dlco_no_ctrl, dlco_nm_ctrl){
				
				var	dlco_no	=	"";
				if(dlco_no_ctrl){
					dlco_no = dlco_no_ctrl.currentText;
				}

				var	dlco_nm	=	"";
				if(dlco_nm_ctrl){
					dlco_nm = dlco_nm_ctrl.currentText;
				}
				
				if(dlco_no != ""){
					dlco_no  = lpad(dlco_no, 8, "0");
					model.setValue(dlco_no_ctrl.attribute("ref"), dlco_no); 
					dlco_no_ctrl.refresh();
				}
				
				model.removeNode("/root/tempData/reqData");
				model.removeNode("/root/tempData/resData");
				makeNodeValue("/root/tempData/reqData/dlco_clsf", dlco_clsf);
				makeNodeValue("/root/tempData/reqData/dlco_no", dlco_no);
				makeNodeValue("/root/tempData/reqData/dlco_nm", dlco_nm);
				
				modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");
			}			
			
			function setSlcrgPersInfo(slcrg_pers_ctrl, slcrg_pers_nm_ctrl){

				var	slcrg_pers	=	"";
				if(slcrg_pers_ctrl){
					slcrg_pers = slcrg_pers_ctrl.currentText;
				}

				var	slcrg_pers_nm	=	"";
				if(slcrg_pers_nm_ctrl){
					slcrg_pers_nm = slcrg_pers_nm_ctrl.currentText;
				}
								
				model.removeNode("/root/tempData/reqData");
				model.removeNode("/root/tempData/resData");
				
				makeNodeValue("/root/tempData/reqData/slcrg_pers"		,slcrg_pers);
				makeNodeValue("/root/tempData/reqData/slcrg_pers_nm"	,slcrg_pers_nm);
				modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");								
								
			}
			
			function setMchrgPersInfo(mchrg_pers_ctrl, mchrg_pers_nm_ctrl){

				var	mchrg_pers	=	"";
				if(mchrg_pers_ctrl){
					mchrg_pers = mchrg_pers_ctrl.currentText;
				}

				var	mchrg_pers_nm	=	"";
				if(mchrg_pers_nm_ctrl){
					mchrg_pers_nm = mchrg_pers_nm_ctrl.currentText;
				}
								
				model.removeNode("/root/tempData/reqData");
				model.removeNode("/root/tempData/resData");
				
				makeNodeValue("/root/tempData/reqData/mchrg_pers"		,mchrg_pers);
				makeNodeValue("/root/tempData/reqData/mchrg_pers_nm"	,mchrg_pers_nm);
				modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");								
								
			}		
			
			function changeOnMediCd(){

				var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");
				if(medi_cd == "170") {
//					switch2.visible = true;
					group1.visible  = false;
					gr_group1.visible = true;
					gr_bus.visible = false;
					grp_ast.visible = false;
//					model.toggle("case3");
				}
				else if(medi_cd == "180"){
//					switch2.visible = true;
					group1.visible  = false;
					gr_group1.visible = true;
					gr_bus.visible = false;
					grp_ast.visible = false;
//					model.toggle("case4");
				}
				else if(medi_cd == "190"){
//					switch2.visible = true;
					group1.visible  = true;
					gr_group1.visible = true;
					gr_bus.visible = false;
					grp_ast.visible = false;
//					model.toggle("case5");
				}
				else if(medi_cd == "530" || medi_cd == "550" || medi_cd == "560"){
//					switch2.visible = true;
					group1.visible  = false;
					gr_group1.visible = false;
					gr_bus.visible = false;
					grp_ast.visible = true;
//					model.toggle("case5");
				}
				else if(medi_cd == "540"){
//					switch2.visible = true;
					group1.visible  = false;
					gr_group1.visible = false;
					gr_bus.visible = true;
					grp_ast.visible = true;
//					model.toggle("case5");
				}
				else{
//					switch2.visible = false;
					group1.visible  = true;
					gr_group1.visible = true;
					gr_bus.visible = false;
					grp_ast.visible = false;
				}				
								
			}	
							
		]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="1,9;1,936;2,61;2,71;2,125;2,105;2,114;2,117;" style="font-family:굴림; ">
		<caption id="caption45" class="list_cap02" style="left:10px; top:504px; width:926px; height:26px; "/>
		<caption id="caption44" class="list_cap02" style="left:10px; top:479px; width:926px; height:26px; "/>
		<caption id="caption57" class="list_cap02" style="left:10px; top:330px; width:926px; height:26px; "/>
		<caption id="caption8" class="list_cap02" style="left:10px; top:305px; width:926px; height:26px; "/>
		<caption id="caption5" class="list_cap02" style="left:10px; top:280px; width:926px; height:26px; "/>
		<caption id="caption4" class="list_cap02" style="left:10px; top:255px; width:926px; height:26px; "/>
		<group id="group1" style="left:0px; top:125px; width:419px; height:50px; ">
			<caption id="caption53" class="list_cap03" style="left:207px; top:0px; width:70px; height:30px; text-align:center; ">색도</caption>
			<output id="out_chro_clsf_nm" ref="/root/resData/resForm/chro_clsf_nm" appearance="output" style="left:207px; top:29px; width:70px; height:18px; text-align:center; "/>
			<caption id="caption46" class="list_cap03" style="left:10px; top:0px; width:60px; height:30px; text-align:center; ">면</caption>
			<caption id="caption47" class="list_cap03" style="left:138px; top:0px; width:70px; height:30px; text-align:center; ">CM</caption>
			<caption id="caption48" class="list_cap03" style="left:69px; top:0px; width:70px; height:30px; text-align:center; ">단</caption>
			<input id="inp_sect_nm" ref="/root/resData/resForm/sect_nm" navindex="6" imemode="disabled" style="left:10px; top:29px; width:60px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="onkeyup">
					<![CDATA[
				upperCase(inp_sect_nm);
				]]>
				</script>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
					var medi_cd =  model.getValue("/root/reqData/searchData/medi_cd");
					
					var sect_nm =  model.getValue("/root/resData/resForm/sect_nm");
					
					if(sect_nm != ""){
						
						sect_nm = sect_nm.toUpperCase();
						
//						if(sect_nm == _sect_nm) return;
						
						model.setValue("/root/resData/resForm/sect_nm", sect_nm);
						inp_sect_nm.refresh();
						
						model.makeNode("/root/reqData/searchData/sect_nm");
						model.setValue("/root/reqData/searchData/sect_nm", sect_nm);
						
						modelSendNoMake("ad_co_9003_s", "/ad/common/9003", "/root/reqData/searchData", "/root/tempData");		
						
						var issu_side	=	model.getValue("/root/tempData/issu_side");
						
//						if(model.getValue("/root/resData/resForm/cm") == ""){
							model.setValue("/root/resData/resForm/cm", model.getValue("/root/tempData/cm"));
//						}
//						if(model.getValue("/root/resData/resForm/dn") == ""){
							model.setValue("/root/resData/resForm/dn", model.getValue("/root/tempData/dn"));
//						}
						
						var chro_clsf	=		model.getValue("/root/tempData/chro_clsf");
						if(chro_clsf	==	"1")		chro_clsf	=	"1";
						else						chro_clsf	=	"2";
							
						model.setValue("/root/resData/resForm/issu_chro_clsf", chro_clsf);
						
						model.setValue("/root/resData/resForm/chro_clsf_nm", model.getValue("/root/tempData/chro_clsf_nm"));
//						if(model.getValue("/root/resData/resForm/tabl_yn") == ""){
							model.setValue("/root/resData/resForm/tabl_yn", model.getValue("/root/tempData/tabl_yn"));
//						}
							
						model.setValue("/root/resData/resForm/pubc_side", model.getValue("/root/tempData/issu_side"));
						
						if(model.getValue("/root/tempData/issu_side") == ""){
//							alert("해당면이 없습니다.");
							model.setValue("/root/resData/resForm/sect_nm", "");
						}
						
						model.refresh();
						//20130307 김상훈 김준과장 요구사항 
						var advt_fee = model.getValue("/root/resData/resForm/advt_fee");
						if(advt_fee != "" || advt_fee != "0"){
							recalculate("", "Y", "", "", "Y");
						}
					}else{
						model.setValue("/root/resData/resForm/pubc_side", "");
						model.setValue("/root/resData/resForm/chro_clsf_nm", "");
						out_pubc_side.refresh();
						out_chro_clsf_nm.refresh();
					}				
				]]>
				</script>
			</input>
			<caption id="caption49" class="list_cap03" style="left:276px; top:0px; width:105px; height:30px; text-align:center; ">단가</caption>
			<input id="inp_uprc" ref="/root/resData/resForm/uprc" class="req" navindex="9" format="#,###" caption="단가" style="left:276px; top:29px; width:105px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						recalculate("Y", "", "", "", "");
					]]>
				</script>
			</input>
			<input id="inp_cm" ref="/root/resData/resForm/cm" navindex="8" format="#,###.9" caption="CM" appearance="input" style="left:138px; top:29px; width:70px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var advt_fee = model.getValue("/root/resData/resForm/advt_fee");
						if(advt_fee == ""){
							recalculate("", "", "", "", "Y");		
						}else{
							recalculate("", "Y", "", "", "Y");		
						}
					]]>
				</script>
			</input>
			<input id="inp_dn" ref="/root/resData/resForm/dn" navindex="7" caption="단" appearance="input" style="left:69px; top:29px; width:70px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var advt_fee = model.getValue("/root/resData/resForm/advt_fee");
						if(advt_fee == ""){
							recalculate("", "", "", "", "Y");		
						}else{
							recalculate("", "Y", "", "", "Y");		
						}
					]]>
				</script>
			</input>
		</group>
		<group id="gr_group1" style="left:10px; top:255px; width:296px; height:102px; ">
			<caption id="caption22" class="list_cap03" style="left:0px; top:0px; width:94px; height:26px; ">광고분류</caption>
			<caption id="caption25" class="list_cap03" style="left:0px; top:25px; width:94px; height:26px; ">색도구분</caption>
			<caption id="caption28" class="list_cap03" style="left:0px; top:50px; width:94px; height:26px; ">게재구분</caption>
			<caption id="caption17" class="list_cap03" style="left:0px; top:75px; width:94px; height:26px; ">판구분</caption>
			<select1 id="cb_advt_clas" ref="/root/resData/resForm/advt_clas" class="req" navindex="23" appearance="minimal" caption="광고분류" style="left:100px; top:4px; width:120px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/advt_clas/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<select1 id="cb_chro_clsf" ref="/root/resData/resForm/chro_clsf" navindex="24" appearance="minimal" caption="색도구분" style="left:100px; top:29px; width:120px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/chro_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<select1 id="cb_pubc_clsf" ref="/root/resData/resForm/pubc_clsf" class="req" navindex="25" appearance="minimal" caption="게재구분" style="left:100px; top:54px; width:120px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/pubc_clas/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<select1 id="cb_edt_clsf" ref="/root/resData/resForm/edt_clsf" class="req" navindex="26" appearance="minimal" caption="판구분" style="left:100px; top:79px; width:120px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/edt_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
		</group>
		<group id="gr_bus" visibility="hidden" style="left:11px; top:256px; width:296px; height:102px; ">
			<caption id="caption16" style="left:0px; top:0px; width:92px; height:100px; text-align:center; background-color:#e0e2f0; ">버스승강장</caption>
			<datagrid id="gd_bus" nodeset="/root/resData/gridData2/record" caption="위치^구분^순번" colsep="#" colwidth="92, 74, 10" extendlastcol="scroll" mergecellsfixedcols="bycolrec" mergecellsfixedrows="byrowrec" rowsep="|" selectionmode="byrow" colheight="25" style="left:92px; top:0px; width:202px; height:100px; text-align:center; ">
				<col ref="bus_plc" type="input" navindex="13" caption="위치" style="text-align:left; "/>
				<col ref="bus_clsf" type="combo" navindex="14" style="text-align:left; ">
					<choices>
						<itemset nodeset="/root/initData/comboSet/dtnb_medi_cd/item">
							<label ref="label"/>
							<value ref="value"/>
						</itemset>
					</choices>
				</col>
				<col ref="bus_seq" visibility="hidden"/>
			</datagrid>
			<button id="btn_row_add" class="btn_grid03" crud="R" style="left:18px; top:63px; width:65px; height:21px; ">
				<caption>행추가</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(gd_bus.rows != 0){
							gd_bus.addStatus(1, "insert");
						}
						//part_cd.attribute("editable") = "true";
						gd_bus.addRow();		
					]]>
				</script>
			</button>
		</group>
		<group id="grp_ast" visibility="hidden" style="left:304px; top:504px; width:923px; height:26px; ">
			<caption id="caption43" class="list_cap03" style="left:0px; top:0px; width:94px; height:26px; ">어시스트</caption>
			<caption id="caption1" class="list_cap03" style="left:276px; top:0px; width:94px; height:26px; ">게재기간</caption>
			<input id="inp_asist_pers" ref="/root/resData/resForm/asist_pers" navindex="4" autonext="false" maxlength="8" format="99999999" caption="광고주" style="left:100px; top:4px; width:65px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					commonSubmission("9005", inp_asist_pers.currentText,  inp_asist_pers, inp_asist_pers_nm);					
				]]>
				</script>
				<script type="javascript" ev:event="onkeydown">
					<![CDATA[
					if( event.keyCode == 13 ){
						commonSubmission("9005", inp_asist_pers.currentText,  inp_asist_pers, inp_asist_pers_nm);	
					}
				]]>
				</script>
			</input>
			<input id="inp_asist_pers_nm" ref="/root/resData/resForm/asist_pers_nm" navindex="5" imemode="hangul" inputtype="button" caption="광고주" style="left:168px; top:4px; width:80px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					searchEmpno("setAsistPers", "/root/resData/resForm/asist_pers", "/root/resData/resForm/asist_pers_nm");
				]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if( event.keyCode == 13 ){
						findEmpNoByName("setAsistPers", inp_asist_pers_nm.currentText, inp_asist_pers, inp_asist_pers_nm);
					}					
				]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					findEmpNoByName("setAsistPers", inp_asist_pers_nm.currentText, inp_asist_pers, inp_asist_pers_nm);
				]]>
				</script>
			</input>
			<input id="pubc_frdt" ref="/root/resData/resForm/pubc_frdt" navindex="2" inputtype="date" format="yyyy-mm-dd" style="left:378px; top:4px; width:95px; height:18px; text-align:center; "/>
			<input id="pubc_todt" ref="/root/resData/resForm/pubc_todt" navindex="2" inputtype="date" format="yyyy-mm-dd" style="left:490px; top:4px; width:95px; height:18px; text-align:center; "/>
			<caption id="caption75" style="left:476px; top:4px; width:15px; height:15px; vertical-align:middle; ">~</caption>
		</group>
		<caption id="caption58" class="list_cap02" style="left:10px; top:560px; width:926px; height:26px; "/>
		<caption id="caption55" class="list_cap02" style="left:10px; top:355px; width:926px; height:26px; "/>
		<caption id="caption12" class="list_cap02" style="left:10px; top:71px; width:926px; height:28px; "/>
		<caption id="caption6" tyle="left:15px; top:180px; width:940px; height:0px;" style="left:0px; top:10px; width:0px; height:0px; ">caption6</caption>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group_line" class="gro_line" style="left:10px; top:108px; width:926px; height:5px; "/>
		<caption id="caption7" class="list_cap01" style="left:198px; top:71px; width:85px; height:28px; ">게재일자</caption>
		<caption id="caption2" class="list_cap01" style="left:400px; top:71px; width:55px; height:28px; ">순번</caption>
		<input id="inp_preng_occr_dt" ref="/root/reqData/searchData/preng_occr_dt" class="req" navindex="2" inputtype="date" format="yyyy-mm-dd" style="left:286px; top:76px; width:95px; height:18px; text-align:center; "/>
		<caption id="caption10" class="list_cap01" style="left:537px; top:71px; width:85px; height:28px; ">광고주</caption>
		<caption id="caption30" class="list_cap" style="left:757px; top:125px; width:60px; height:22px; ">면세여부</caption>
		<bool id="bool1" navindex="13" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/rtax_yn" style="left:807px; top:125px; width:45px; height:20px; background-image:#uncheck; ">
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var rtax_yn = model.getValue("/root/resData/resForm/rtax_yn");
				if(rtax_yn == "Y"){
					var advt_fee	= Number(model.getValue("/root/resData/resForm/advt_fee"));
					model.setValue("/root/resData/resForm/vat", "0");
					model.setValue("/root/resData/resForm/pubc_tot_amt", advt_fee);
					inp_vat.refresh();
					inp_pubc_tot_amt.refresh();
//					recalculate("", "", "Y", "");	
				}else{
					var advt_fee	= Number(model.getValue("/root/resData/resForm/advt_fee"));
					var vat   	= advt_fee / 10;//Number(model.getValue("/root/resData/resForm/vat"));					
					model.setValue("/root/resData/resForm/vat", vat);
					model.setValue("/root/resData/resForm/pubc_tot_amt", advt_fee  + vat);
					inp_vat.refresh(); 
					inp_pubc_tot_amt.refresh();
//					recalculate("", "", "Y", "");	
				}
				
				]]>
			</script>
		</bool>
		<bool id="bool2" navindex="14" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/tabl_yn" style="left:807px; top:150px; width:45px; height:20px; background-image:#uncheck; "/>
		<caption id="caption33" class="list_cap" style="left:757px; top:150px; width:60px; height:22px; ">T/B여부</caption>
		<caption id="caption3" class="list_cap02" style="left:10px; top:180px; width:926px; height:26px; "/>
		<caption id="caption9" class="list_cap02" style="left:10px; top:380px; width:926px; height:26px; "/>
		<caption id="caption11" class="list_cap02" style="left:10px; top:405px; width:926px; height:50px; "/>
		<caption id="caption13" class="list_cap02" style="left:10px; top:454px; width:926px; height:26px; "/>
		<select1 id="cb_hndl_clsf" ref="/root/resData/resForm/hndl_clsf" class="req" navindex="15" appearance="minimal" caption="취급구분" style="left:110px; top:184px; width:120px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/hndl_clsf/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
				var hndl_clsf = model.getValue("/root/resData/resForm/hndl_clsf");
				if(hndl_clsf == "1"){					
					grp_agn.visible = false;
					grp_hndl_clsf.visible = false;
					model.setValue("/root/resData/resForm/agn", "");
					model.setValue("/root/resData/resForm/agn_nm", "");
					model.setValue("/root/resData/resForm/fee_rate", "");
					model.setValue("/root/resData/resForm/fee", "");
					
					model.setValue("/root/resData/resForm/hndl_plac_cd", "");
					model.setValue("/root/resData/resForm/hndl_plac_nm", "");
					model.setValue("/root/resData/resForm/coms_rate", "");
					model.setValue("/root/resData/resForm/coms", "");
					
				}else if(hndl_clsf == "2"){					
					grp_agn.visible = true;
					grp_hndl_clsf.visible = false;					
					
					model.setValue("/root/resData/resForm/hndl_plac_cd", "");
					model.setValue("/root/resData/resForm/hndl_plac_nm", "");
					model.setValue("/root/resData/resForm/coms_rate", "");
					model.setValue("/root/resData/resForm/coms", "");
					
				}else if(hndl_clsf == "4"){
					model.setValue("/root/initData/hndl_nm", "광고지사");				
					grp_agn.visible = true;
					grp_hndl_clsf.visible = true;
				}else if(hndl_clsf == "5"){
					model.setValue("/root/initData/hndl_nm", "지사지국");				
					grp_agn.visible = true;
					grp_hndl_clsf.visible = true;
				}else if(hndl_clsf == "7"){
					model.setValue("/root/initData/hndl_nm", "해외지사");				
					grp_agn.visible = true;
					grp_hndl_clsf.visible = true;
				}
					
				model.refresh();
				
				]]>
			</script>
		</select1>
		<caption id="caption15" class="list_cap03" style="left:10px; top:180px; width:94px; height:26px; ">취급구분</caption>
		<caption id="caption32" class="list_cap03" style="left:304px; top:255px; width:94px; height:26px; ">업종구분</caption>
		<input id="inp_slcrg_pers_nm" ref="/root/resData/resForm/slcrg_pers_nm" class="req" navindex="35" imemode="hangul" inputtype="button" caption="영업담당" crud="R" style="left:176px; top:359px; width:95px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				searchEmpno("setSlcrgPers", "/root/resData/resForm/slcrg_pers", "/root/resData/resForm/slcrg_pers_nm");
				var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
				if(emp_no != ""){
					findDept(emp_no, out_dept_cd, out_dept_nm);
				}			
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					setSlcrgPersInfo("", inp_slcrg_pers_nm);
					if(submit_completed()){
						var slcrg_pers		=	model.getValue("/root/tempData/resData/slcrg_pers");
						var	slcrg_pers_nm	=	model.getValue("/root/tempData/resData/slcrg_pers_nm");
						var	dept_cd			=	model.getValue("/root/tempData/resData/dept_cd");
						var	dept_nm			=	model.getValue("/root/tempData/resData/dept_nm");
							
						model.setValue("/root/resData/resForm/slcrg_pers", slcrg_pers);
						model.setValue("/root/resData/resForm/slcrg_pers_nm", slcrg_pers_nm)
						model.setValue("/root/resData/resForm/dept_cd", dept_cd)
						model.setValue("/root/resData/resForm/dept_nm", dept_nm)
							
						inp_slcrg_pers.refresh();
						inp_slcrg_pers_nm.refresh();
						out_dept_cd.refresh();
						out_dept_nm.refresh();
						
					}								
				}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[

				setSlcrgPersInfo("", inp_slcrg_pers_nm);			
				if(submit_completed()){
					var slcrg_pers		=	model.getValue("/root/tempData/resData/slcrg_pers");
					var	slcrg_pers_nm	=	model.getValue("/root/tempData/resData/slcrg_pers_nm");
					var	dept_cd			=	model.getValue("/root/tempData/resData/dept_cd");
					var	dept_nm			=	model.getValue("/root/tempData/resData/dept_nm");
						
					model.setValue("/root/resData/resForm/slcrg_pers", slcrg_pers);
					model.setValue("/root/resData/resForm/slcrg_pers_nm", slcrg_pers_nm)
					model.setValue("/root/resData/resForm/dept_cd", dept_cd)
					model.setValue("/root/resData/resForm/dept_nm", dept_nm)
						
					inp_slcrg_pers.refresh();
					inp_slcrg_pers_nm.refresh();
					out_dept_cd.refresh();
					out_dept_nm.refresh();
					
				}		
								
				]]>
			</script>
		</input>
		<input id="inp_slcrg_pers" ref="/root/resData/resForm/slcrg_pers" class="req" navindex="34" autonext="false" caption="영업담당" style="left:110px; top:359px; width:60px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				
				setSlcrgPersInfo(inp_slcrg_pers, "");
				
				if(submit_completed()){
					var slcrg_pers		=	model.getValue("/root/tempData/resData/slcrg_pers");
					var	slcrg_pers_nm	=	model.getValue("/root/tempData/resData/slcrg_pers_nm");
					var	dept_cd			=	model.getValue("/root/tempData/resData/dept_cd");
					var	dept_nm			=	model.getValue("/root/tempData/resData/dept_nm");
						
					model.setValue("/root/resData/resForm/slcrg_pers", slcrg_pers);
					model.setValue("/root/resData/resForm/slcrg_pers_nm", slcrg_pers_nm)
					model.setValue("/root/resData/resForm/dept_cd", dept_cd)
					model.setValue("/root/resData/resForm/dept_nm", dept_nm)
						
					inp_slcrg_pers.refresh();
					inp_slcrg_pers_nm.refresh();
					out_dept_cd.refresh();
					out_dept_nm.refresh();
					
				}
												
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){

					setSlcrgPersInfo(inp_slcrg_pers, "");

					if(submit_completed()){
						
						var slcrg_pers		=	model.getValue("/root/tempData/resData/slcrg_pers");
						var	slcrg_pers_nm	=	model.getValue("/root/tempData/resData/slcrg_pers_nm");
						var	dept_cd			=	model.getValue("/root/tempData/resData/dept_cd");
						var	dept_nm			=	model.getValue("/root/tempData/resData/dept_nm");
						
						model.setValue("/root/resData/resForm/slcrg_pers", slcrg_pers);
						model.setValue("/root/resData/resForm/slcrg_pers_nm", slcrg_pers_nm)
						model.setValue("/root/resData/resForm/dept_cd", dept_cd)
						model.setValue("/root/resData/resForm/dept_nm", dept_nm)
						
						inp_slcrg_pers.refresh();
						inp_slcrg_pers_nm.refresh();
						out_dept_cd.refresh();
						out_dept_nm.refresh();
						
					}
					
				}
				]]>
			</script>
		</input>
		<caption id="caption23" class="list_cap03" style="left:10px; top:355px; width:94px; height:26px; ">영업담당</caption>
		<input id="inp_indt_clsf_nm" ref="/root/resData/resForm/indt_clsf_nm" class="req" navindex="28" imemode="hangul" inputtype="button" caption="업종구분" crud="R" style="left:452px; top:259px; width:123px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					showIndtClsfPopup();
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					findIndtClsfByName(inp_indt_clsf_nm.currentText, inp_indt_clsf, inp_indt_clsf_nm);
				}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				findIndtClsfByName(inp_indt_clsf_nm.currentText, inp_indt_clsf, inp_indt_clsf_nm);
				]]>
			</script>
		</input>
		<input id="inp_type_clsf_nm" ref="/root/resData/resForm/type_clsf_nm" class="req" navindex="30" imemode="hangul" inputtype="button" caption="유형구분" crud="R" style="left:452px; top:284px; width:123px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					showTypeClsfPopup();
					
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					findTypeClsfByName(inp_type_clsf_nm.currentText, inp_type_clsf, inp_type_clsf_nm);
				}				
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				findTypeClsfByName(inp_type_clsf_nm.currentText, inp_type_clsf, inp_type_clsf_nm);
				]]>
			</script>
		</input>
		<caption id="caption31" class="list_cap03" style="left:304px; top:280px; width:94px; height:26px; ">유형구분</caption>
		<caption id="caption26" class="list_cap03" style="left:304px; top:355px; width:94px; height:26px; ">영업부서</caption>
		<output id="out_dept_cd" ref="/root/resData/resForm/dept_cd" class="req" style="left:404px; top:359px; width:60px; height:18px; border-style:solid; "/>
		<output id="out_dept_nm" ref="/root/resData/resForm/dept_nm" class="req" style="left:470px; top:359px; width:95px; height:18px; border-style:solid; "/>
		<input id="inp_mchrg_pers_nm" ref="/root/resData/resForm/mchrg_pers_nm" class="req" navindex="37" imemode="hangul" inputtype="button" caption="관리담당" crud="R" style="left:748px; top:359px; width:95px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[				
				searchEmpno("setMchrgPers", "/root/resData/resForm/mchrg_pers", "/root/resData/resForm/mchrg_pers_nm");		
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					setMchrgPersInfo("", inp_mchrg_pers_nm);					
					if(submit_completed()){
						var mchrg_pers		=	model.getValue("/root/tempData/resData/mchrg_pers");
						var	mchrg_pers_nm	=	model.getValue("/root/tempData/resData/mchrg_pers_nm");
							
						model.setValue("/root/resData/resForm/mchrg_pers", mchrg_pers);
						model.setValue("/root/resData/resForm/mchrg_pers_nm", mchrg_pers_nm)
							
						inp_mchrg_pers.refresh();
						inp_mchrg_pers_nm.refresh();
						
					}				
				}				
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[

					setMchrgPersInfo("", inp_mchrg_pers_nm);		
					if(submit_completed()){
						var mchrg_pers		=	model.getValue("/root/tempData/resData/mchrg_pers");
						var	mchrg_pers_nm	=	model.getValue("/root/tempData/resData/mchrg_pers_nm");
							
						model.setValue("/root/resData/resForm/mchrg_pers", mchrg_pers);
						model.setValue("/root/resData/resForm/mchrg_pers_nm", mchrg_pers_nm)
							
						inp_mchrg_pers.refresh();
						inp_mchrg_pers_nm.refresh();
						
					}								
				
				]]>
			</script>
		</input>
		<input id="inp_mchrg_pers" ref="/root/resData/resForm/mchrg_pers" class="req" navindex="36" autonext="false" caption="관리담당" style="left:682px; top:359px; width:60px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				setMchrgPersInfo(inp_mchrg_pers, "");
				if(submit_completed()){
					var mchrg_pers		=	model.getValue("/root/tempData/resData/mchrg_pers");
					var	mchrg_pers_nm	=	model.getValue("/root/tempData/resData/mchrg_pers_nm");
						
					model.setValue("/root/resData/resForm/mchrg_pers", mchrg_pers);
					model.setValue("/root/resData/resForm/mchrg_pers_nm", mchrg_pers_nm)
					
					inp_mchrg_pers.refresh();
					inp_mchrg_pers_nm.refresh();
				}				
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					setMchrgPersInfo(inp_mchrg_pers, "");
					if(submit_completed()){
						var mchrg_pers	=	model.getValue("/root/tempData/resData/mchrg_pers");
						var	mchrg_pers_nm	=	model.getValue("/root/tempData/resData/mchrg_pers_nm");
							
						model.setValue("/root/resData/resForm/mchrg_pers", mchrg_pers);
						model.setValue("/root/resData/resForm/mchrg_pers_nm", mchrg_pers_nm)
						
						inp_mchrg_pers.refresh();
						inp_mchrg_pers_nm.refresh();
					}					
				}
				]]>
			</script>
		</input>
		<caption id="caption29" class="list_cap03" style="left:304px; top:305px; width:94px; height:26px; ">그룹사</caption>
		<select1 id="combo7" ref="/root/resData/resForm/grp_cmpy_cd" disabled="true" navindex="32" appearance="minimal" style="left:404px; top:309px; width:172px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/grp_cmpy_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="caption34" class="list_cap03" style="left:582px; top:355px; width:94px; height:26px; ">관리담당</caption>
		<caption id="caption35" class="list_cap03" style="left:10px; top:380px; width:94px; height:26px; ">광고내용</caption>
		<input id="input18" ref="/root/resData/resForm/advt_cont" navindex="38" caption="광고내용" style="left:110px; top:384px; width:780px; height:18px; "/>
		<caption id="caption36" class="list_cap03" style="left:10px; top:405px; width:94px; height:50px; ">비고</caption>
		<textarea id="textarea1" ref="/root/resData/resForm/remk" navindex="39" imemode="hangul" style="left:110px; top:409px; width:780px; height:40px; text-align:left; vertical-align:top; padding:2; "/>
		<output id="output4" ref="/root/resData/resForm/chrg_aprv_pers" style="left:110px; top:458px; width:65px; height:18px; border-style:solid; "/>
		<output id="output5" ref="/root/resData/resForm/chrg_aprv_dt" style="left:180px; top:458px; width:80px; height:18px; border-style:solid; "/>
		<output id="output11" ref="/root/resData/resForm/part_chf_aprv_pers" style="left:404px; top:458px; width:65px; height:18px; border-style:solid; "/>
		<output id="output12" ref="/root/resData/resForm/team_chf_aprv_pers" style="left:682px; top:458px; width:65px; height:18px; border-style:solid; "/>
		<output id="output13" ref="/root/resData/resForm/part_chf_aprv_dt" style="left:472px; top:458px; width:80px; height:18px; border-style:solid; "/>
		<output id="output14" ref="/root/resData/resForm/team_chf_aprv_dt" style="left:749px; top:458px; width:80px; height:18px; border-style:solid; "/>
		<caption id="caption37" class="list_cap03" style="left:304px; top:454px; width:94px; height:26px; ">파트장승인</caption>
		<caption id="caption38" class="list_cap03" style="left:580px; top:454px; width:94px; height:26px; ">팀장승인</caption>
		<caption id="caption39" class="list_cap03" style="left:10px; top:454px; width:94px; height:26px; ">담당승인</caption>
		<output id="output6" ref="/root/resData/resForm/pubc_slip_no" format="999-99999999-9999" style="left:110px; top:483px; width:150px; height:18px; border-style:solid; "/>
		<output id="output10" ref="/root/resData/resForm/incmg_pers_nm" style="left:180px; top:508px; width:80px; height:18px; border-style:solid; "/>
		<output id="output7" ref="/root/resData/resForm/preng_clos_yn" style="left:404px; top:483px; width:35px; height:18px; border-style:solid; "/>
		<output id="output8" ref="/root/resData/resForm/incmg_dt_tm" style="left:682px; top:483px; width:147px; height:18px; text-align:center; border-style:solid; "/>
		<output id="output9" ref="/root/resData/resForm/incmg_pers" style="left:110px; top:508px; width:65px; height:18px; border-style:solid; "/>
		<caption id="caption14" class="list_cap03" style="left:10px; top:504px; width:94px; height:26px; ">예약자</caption>
		<caption id="caption40" class="list_cap03" style="left:10px; top:479px; width:94px; height:26px; ">게재전표</caption>
		<caption id="caption41" class="list_cap03" style="left:304px; top:479px; width:94px; height:26px; ">예약마감</caption>
		<caption id="caption42" class="list_cap03" style="left:580px; top:479px; width:94px; height:26px; ">예약등록일시</caption>
		<caption id="caption50" class="list_cap03" style="left:588px; top:125px; width:105px; height:30px; text-align:center; ">게재총액</caption>
		<input id="inp_pubc_tot_amt" ref="/root/resData/resForm/pubc_tot_amt" class="req" navindex="12" format="#,###" caption="게재총액" appearance="input" style="left:588px; top:154px; width:105px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				recalculate("", "", "", "Y", "");
				]]>
			</script>
		</input>
		<caption id="caption51" class="list_cap03" style="left:380px; top:125px; width:105px; height:30px; text-align:center; ">광고료</caption>
		<input id="inp_advt_fee" ref="/root/resData/resForm/advt_fee" class="req" navindex="10" format="#,###" caption="광고료" style="left:380px; top:154px; width:105px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[

				recalculate("", "Y", "", "", "");
					
				]]>
			</script>
		</input>
		<caption id="caption52" class="list_cap03" style="left:484px; top:125px; width:105px; height:30px; text-align:center; ">부가세</caption>
		<caption id="caption54" class="list_cap03" style="left:697px; top:125px; width:50px; height:30px; text-align:center; ">면번호</caption>
		<output id="out_pubc_side" ref="/root/resData/resForm/pubc_side" format="#,###" appearance="output" style="left:697px; top:154px; width:50px; height:18px; text-align:right; "/>
		<button id="button5" class="btn03" disabled="false" crud="R" style="left:567px; top:40px; width:65px; height:21px; ">
			<caption>최근게재</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				window.load("./AD_RES_1204.xrw"
							, "modal"
							, ""
							, "align:center;width:650; height:510; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
							,"/root/reqData/searchData/medi_cd"
							,"/root/reqData/searchData/medi_cd"
				);							
				]]>
			</script>
		</button>
		<button id="button9" class="btn04" disabled="false" crud="R" style="left:475px; top:40px; width:90px; height:21px; ">
			<caption>게재예정표</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.property("PUB_1400_PUBC_DT") = model.getValue("/root/reqData/searchData/preng_occr_dt");
				viewer("mainFrame").window.javaScript.onLoadPopupPage("AD_RES_1400");
				
				]]>
			</script>
		</button>
		<button id="button11" class="btn03" disabled="false" crud="R" style="left:634px; top:40px; width:65px; height:21px; ">
			<caption>제출승인</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				var	preng_occr_dt	=	model.getValue("/root/reqData/searchData/preng_occr_dt");
				
				model.property("ex_preng_occr_dt")		=	preng_occr_dt;
				
				viewer("mainFrame").window.javaScript.onLoadPage2("AD_RES_1300");
				]]>
			</script>
		</button>
		<caption id="caption21" class="list_cap03" style="left:582px; top:255px; width:94px; height:26px; ">화폐종류</caption>
		<caption id="caption24" class="list_cap03" style="left:582px; top:280px; width:94px; height:26px; ">환율</caption>
		<input id="input15" ref="/root/resData/resForm/frex_cntr_amt" navindex="33" format="#,###" style="left:682px; top:309px; width:120px; height:18px; text-align:right; "/>
		<caption id="caption27" class="list_cap03" style="left:582px; top:305px; width:94px; height:26px; ">외화계약</caption>
		<select1 id="cb_mony_kind" ref="/root/resData/resForm/mony_kind" navindex="31" appearance="minimal" style="left:682px; top:259px; width:120px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/mony_kind/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
				var mony_kind = model.getValue("/root/resData/resForm/mony_kind");
				makeNodeValue("/root/reqData/searchData/mony_kind", mony_kind);

				if(mony_kind == "KRW") {
					model.setValue("/root/resData/resForm/exrate", "");
					out_exrate.refresh();
					return;
				}
				
				modelSendNoMake("ad_co_9001_s", "/ad/common/9001", "/root/reqData/searchData", "/root/tempData");		
				
				model.setValue("/root/resData/resForm/exrate", model.getValue("/root/tempData/exrate"));
				out_exrate.refresh();
				
				]]>
			</script>
		</select1>
		<group id="grp_agn" visibility="hidden" style="left:10px; top:205px; width:926px; height:27px; ">
			<caption id="caption56" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; "/>
			<caption id="caption60" class="list_cap03" style="left:572px; top:0px; width:94px; height:26px; ">대행료</caption>
			<input id="inp_fee_rate" ref="/root/resData/resForm/fee_rate" navindex="17" format="##.#" style="left:394px; top:4px; width:85px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
					var pubc_tot_amt = 	Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));
					var fee_rate     = 	Number(model.getValue("/root/resData/resForm/fee_rate"));
					
					var fee			=	pubc_tot_amt * (fee_rate /100);
					
					model.setValue("/root/resData/resForm/fee", fee);
					inp_fee.refresh();
					
					]]>
				</script>
			</input>
			<input id="inp_fee" ref="/root/resData/resForm/fee" navindex="18" format="#,###" style="left:672px; top:4px; width:85px; height:18px; text-align:right; "/>
			<caption id="caption18" class="list_cap03" style="left:0px; top:0px; width:94px; height:26px; ">대행사</caption>
			<caption id="caption59" class="list_cap03" style="left:294px; top:0px; width:94px; height:26px; ">대행료율</caption>
			<input id="inp_agn" ref="/root/resData/resForm/agn" class="req" navindex="15" autonext="false" maxlength="8" format="99999999" style="left:100px; top:4px; width:55px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
	
					setExDlcoInfo("2", inp_agn, "");	
					
					if(submit_completed()){
						setAgnResultInfo();
					}
					
						
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keyCode== "13"){
						
						setExDlcoInfo("2", inp_agn, "");	
						
						if(submit_completed()){
							setAgnResultInfo();
						}
											
					}
					]]>
				</script>
			</input>
			<input id="inp_agn_nm" ref="/root/resData/resForm/agn_nm" class="req" navindex="16" imemode="hangul" inputtype="button" crud="R" style="left:160px; top:4px; width:125px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					showAdvcsSearchPopup("", "", "Y", "", "", inp_agn_nm.currentText); 
					setMchrgInfo();	
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keyCode== "13"){
												
						setExDlcoInfo("2", "", inp_agn_nm);	
						
						if(submit_completed()){
							setAgnResultInfo();
						}						
					}							
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[

					setExDlcoInfo("2", "", inp_agn_nm);	
					
					if(submit_completed()){
						setAgnResultInfo();
					}
										
					]]>
				</script>
			</input>
		</group>
		<group id="grp_hndl_clsf" visibility="hidden" style="left:10px; top:230px; width:926px; height:26px; ">
			<caption id="caption19" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; "/>
			<input id="inp_coms_rate" ref="/root/resData/resForm/coms_rate" navindex="21" format="##.#" style="left:394px; top:3px; width:85px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
			
					var pubc_tot_amt = 	Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));
					var coms_rate  	= 	Number(model.getValue("/root/resData/resForm/coms_rate"));
					
					var coms			=	pubc_tot_amt * (coms_rate /100);
					
					model.setValue("/root/resData/resForm/coms", coms);
					inp_coms.refresh();
							
					]]>
				</script>
			</input>
			<input id="inp_coms" ref="/root/resData/resForm/coms" navindex="22" format="#,###" style="left:672px; top:3px; width:85px; height:18px; text-align:right; "/>
			<caption id="caption20" class="list_cap03" style="left:572px; top:0px; width:94px; height:26px; ">수수료</caption>
			<caption id="cap_hndl_clsf" ref="/root/initData/hndl_nm" class="list_cap03" style="left:0px; top:0px; width:94px; height:26px; ">광고지사</caption>
			<caption id="caption61" class="list_cap03" style="left:294px; top:0px; width:94px; height:26px; ">수수료율</caption>
			<input id="inp_hndl_plac_cd" ref="/root/resData/resForm/hndl_plac_cd" class="req" navindex="19" autonext="false" maxlength="8" format="99999999" style="left:100px; top:3px; width:55px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[

					
					setExDlcoInfo("4", inp_hndl_plac_cd, "");	
					
					if(submit_completed()){
						setHndlPlacResultInfo();
					}
										
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keyCode== "13"){

						setExDlcoInfo("4", inp_hndl_plac_cd, "");	
						
						if(submit_completed()){
							setHndlPlacResultInfo();
						}
												
					}
					]]>
				</script>
			</input>
			<input id="inp_hndl_plac_nm" ref="/root/resData/resForm/hndl_plac_nm" class="req" navindex="20" imemode="hangul" inputtype="button" crud="R" style="left:160px; top:3px; width:125px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					showAdvcsSearchPopup("", "", "", "Y", "Y", inp_hndl_plac_nm.currentText); 
					setMchrgInfo();	
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keyCode== "13"){
						
						setExDlcoInfo("4", "", inp_hndl_plac_nm);	
						
						if(submit_completed()){
							setHndlPlacResultInfo();
						}						
					}				
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						
						setExDlcoInfo("4", "", inp_hndl_plac_nm);	
					
						if(submit_completed()){
							setHndlPlacResultInfo();
						}
					]]>
				</script>
			</input>
		</group>
		<input id="inp_dlco_no" ref="/root/resData/resForm/dlco_no" class="req" navindex="4" autonext="false" maxlength="8" format="99999999" caption="광고주" style="left:625px; top:76px; width:65px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				

					setExDlcoInfo("1", inp_dlco_no, "");
					if(submit_completed()){
						setDlcoResultInfo();
					}

				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[

				if(event.keyCode== "13"){
	
					setExDlcoInfo("1", inp_dlco_no, "");
					if(submit_completed()){
						setDlcoResultInfo();
					}
				}

				]]>
			</script>
		</input>
		<input id="inp_dlco_nm" ref="/root/resData/resForm/dlco_nm" class="req" navindex="5" imemode="hangul" inputtype="button" caption="광고주" style="left:693px; top:76px; width:154px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText);
					
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[				
				if(event.keyCode== "13"){	

					setExDlcoInfo("1", "", inp_dlco_nm);										
					if(submit_completed()){
						setDlcoResultInfo();
					}				
					setExDlcoInfo("1", inp_dlco_no, "");
					if(submit_completed()){
						setDlcoResultInfo();
					}
				}					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[

					setExDlcoInfo("1", "", inp_dlco_nm);	
					if(submit_completed()){
						setDlcoResultInfo();
					}					
					setExDlcoInfo("1", inp_dlco_no, "");
					if(submit_completed()){
						setDlcoResultInfo();
					}

				]]>
			</script>
		</input>
		<input id="inp_vat" ref="/root/resData/resForm/vat" class="req" navindex="11" format="#,###" caption="부가세" style="left:484px; top:154px; width:105px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				recalculate("", "", "Y", "", "");
				]]>
			</script>
		</input>
		<input id="inp_indt_clsf" ref="/root/resData/resForm/indt_clsf" class="req" navindex="27" appearance="input" style="left:404px; top:259px; width:45px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				commonSubmission("9009", inp_indt_clsf.currentText,  inp_indt_clsf, inp_indt_clsf_nm);					
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode== "13"){
					commonSubmission("9009", inp_indt_clsf.currentText,  inp_indt_clsf, inp_indt_clsf_nm);	
				}
				]]>
			</script>
		</input>
		<input id="inp_type_clsf" ref="/root/resData/resForm/type_clsf" class="req" navindex="29" appearance="input" style="left:404px; top:284px; width:45px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				commonSubmission("9010", inp_type_clsf.currentText,  inp_type_clsf, inp_type_clsf_nm);	
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode== "13"){
					commonSubmission("9010", inp_type_clsf.currentText,  inp_type_clsf, inp_type_clsf_nm);	
				}
				]]>
			</script>
		</input>
		<output id="out_exrate" ref="/root/resData/resForm/exrate" format="#,###.0000" style="left:682px; top:284px; width:120px; height:18px; text-align:right; border-style:solid; "/>
		<caption id="caption62" class="list_cap01" style="left:10px; top:71px; width:76px; height:28px; ">매체구분</caption>
		<select1 id="cb_medi_cd" ref="/root/reqData/searchData/medi_cd" class="req" navindex="1" appearance="minimal" style="left:89px; top:76px; width:100px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/medi_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					changeOnMediCd();
				]]>
			</script>
		</select1>
		<button id="btn_qry" class="btn02" crud="R" style="left:205px; top:40px; width:52px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var preng_occr_dt  	= model.getValue("/root/reqData/searchData/preng_occr_dt");
					var preng_occr_seq	= model.getValue("/root/reqData/searchData/preng_occr_seq");
					
					if( preng_occr_dt == "" || preng_occr_seq == "" )
					{
						alert("게재일자와 순번을 확인하세요.");
						return;
					}
					
					loadData();
				]]>
			</script>
		</button>
		<button id="btn_ins" class="btn02" crud="C" style="left:259px; top:40px; width:52px; height:21px; ">
			<caption>입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if(validateReq()){					
					if(checkAll()){
						//alert(model.getValue("/root/resData/resForm/uprc"));
						
						if(windowConfirm("입력하시겠습니까?")){
							var pubc_clsf = model.getValue("/root/resData/resForm/pubc_clsf");
							if(pubc_clsf != "3"){//돌출광고가 아닌 경우만 Check
								var sect_nm = model.getValue("/root/resData/resForm/sect_nm");
								var uprc = Number(model.getValue("/root/resData/resForm/uprc"));
								var sect_cd  = sect_nm.substring(0,1);
								if(sect_nm != ""){
									if(sect_cd == "A"){
										if(uprc > 60000 || uprc < 30000){
											if(window.alert("광고 단가를 확인하십시오. 계속 입력하시겠습니까?", "확인", 1) != 1){
												return;
											}
										}
									}else{
										if(uprc > 45000 || uprc < 30000){
											if(window.alert("광고 단가를 확인하십시오. 계속 입력하시겠습니까?", "확인", 1) != 1){
												return;
											}
										}
									}
								}
							}
																	
							model.setValue("/root/resData/resForm/medi_cd", model.getValue("/root/reqData/searchData/medi_cd"));							
							model.setValue("/root/resData/resForm/preng_occr_dt", model.getValue("/root/reqData/searchData/preng_occr_dt"));
							model.setValue("/root/resData/resForm/preng_occr_seq", model.getValue("/root/reqData/searchData/preng_occr_seq"));
		//					model.setValue("/root/resData/resForm/dlco_no", model.getValue("/root/reqData/searchData/dlco_no"));
		
							if(instance1.selectSingleNode("/root/resData/resForm/flag") == null){
								model.makeNode("/root/resData/resForm/flag");
							}
							model.setValue("/root/resData/resForm/flag", "I");
							model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");
							model.makeNode("/root/reqData/reqForm/multiUpdateData");
							model.setValue("/root/reqData/reqForm/multiUpdateData"	,gd_bus.getUpdateData());					
							model.send("ad_res_1220_a");
							if(submit_completed()){
								var preng_occr_seq = model.getValue("/root/msgData/preng_occr_seq");
								model.setValue("/root/reqData/searchData/preng_occr_seq", preng_occr_seq);
								inp_seq.refresh();

								btn_upd.disabled = false;
								btn_del.disabled = false;									
							}
						}
					}
				}
				]]>
			</script>
		</button>
		<button id="btn_upd" class="btn02" crud="U" style="left:313px; top:40px; width:52px; height:21px; ">
			<caption>수정</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if(validateReq()){					
					if(checkAll()){						
						var chrg_aprv 		= model.getValue("/root/resData/resForm/chrg_aprv");
						var part_chf_aprv 	= model.getValue("/root/resData/resForm/part_chf_aprv");
						var team_chf_aprv 	= model.getValue("/root/resData/resForm/team_chf_aprv");	
						var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");
						var pers_no = model.property("ss_emp_no");
						
						//20120327 김상훈 김영한 과장님 요구사항 
						if(pers_no != "213503"){
							if(chrg_aprv == "Y" || 	part_chf_aprv == "Y" ||  team_chf_aprv == "Y"){
								alert("이미 승인된 자료이므로 수정이 불가능 합니다. ");
								return;
							}			
						}
					
						
						var pubc_clsf = model.getValue("/root/resData/resForm/pubc_clsf");
						if(pubc_clsf != "3"){//돌출광고가 아닌 경우만 Check
							var sect_nm = model.getValue("/root/resData/resForm/sect_nm");
							var uprc = Number(model.getValue("/root/resData/resForm/uprc"));
							var sect_cd  = sect_nm.substring(0,1);
							
							if(medi_cd != "540" && medi_cd != "530" && medi_cd != "550" && medi_cd != "560")
							{
								if(sect_nm != "0"){
									if(sect_cd == "A"){
										if(uprc > 60000 || uprc < 30000){										
											if(window.alert("광고 단가를 확인하십시오. 계속 입력하시겠습니까?", "확인", 1) != 1){
												return;
											}
										}
									}else{
										if(uprc > 45000 || uprc < 30000){
											if(window.alert("광고 단가를 확인하십시오. 계속 입력하시겠습니까?", "확인", 1) != 1){
												return;
											}
										}
									}
								}
							}
						}
						
												
						if(window.alert("수정하시겠습니까?", "확인", 1) == 1){
							if( model.getValue("/root/resData/resForm/medi_cd") != model.getValue("/root/reqData/searchData/medi_cd") ||
								model.getValue("/root/resData/resForm/preng_occr_dt") != model.getValue("/root/reqData/searchData/preng_occr_dt") ||
								model.getValue("/root/resData/resForm/preng_occr_seq") != model.getValue("/root/reqData/searchData/preng_occr_seq") ){
									window.alert("예약전표 Key가 변경되었습니다. 재조회 후 수정하세요.");
									return
							}
								
							model.setValue("/root/resData/resForm/medi_cd", model.getValue("/root/reqData/searchData/medi_cd"));
							model.setValue("/root/resData/resForm/preng_occr_dt", model.getValue("/root/reqData/searchData/preng_occr_dt"));
							model.setValue("/root/resData/resForm/preng_occr_seq", model.getValue("/root/reqData/searchData/preng_occr_seq"));
							
							if(instance1.selectSingleNode("/root/resData/resForm/flag") == null){
								model.makeNode("/root/resData/resForm/flag");
							}
							model.setValue("/root/resData/resForm/flag", "U");
							model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");
							model.makeNode("/root/reqData/reqForm/multiUpdateData");
							model.setValue("/root/reqData/reqForm/multiUpdateData"	,gd_bus.getUpdateData());					
							model.send("ad_res_1220_a");
							if(submit_completed()){
								var preng_occr_seq = model.getValue("/root/msgData/preng_occr_seq");
								model.setValue("/root/reqData/searchData/preng_occr_seq", preng_occr_seq);
								inp_seq.refresh();
								loadData();
							}
						}
					}					
				}
				]]>
			</script>
		</button>
		<button id="btn_del" class="btn02" crud="D" style="left:367px; top:40px; width:52px; height:21px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
//				if(validateReq()){
						
					var chrg_aprv 		= model.getValue("/root/resData/resForm/chrg_aprv");
					var part_chf_aprv 	= model.getValue("/root/resData/resForm/part_chf_aprv");
					var team_chf_aprv 	= model.getValue("/root/resData/resForm/team_chf_aprv");	
					
					if(chrg_aprv == "Y" || 	part_chf_aprv == "Y" ||  team_chf_aprv == "Y"){
						alert("이미 승인된 자료이므로 삭제가 불가능 합니다. ");
						return;
					}			
											
					if(window.alert("삭제하시겠습니까?", "확인", 1) == 1){
		 				model.setValue("/root/resData/resForm/medi_cd", model.getValue("/root/reqData/searchData/medi_cd"));
						model.setValue("/root/resData/resForm/preng_occr_dt", model.getValue("/root/reqData/searchData/preng_occr_dt"));
						model.setValue("/root/resData/resForm/preng_occr_seq", model.getValue("/root/reqData/searchData/preng_occr_seq"));
						
						if(instance1.selectSingleNode("/root/resData/resForm/flag") == null){
							model.makeNode("/root/resData/resForm/flag");
						}
						model.setValue("/root/resData/resForm/flag", "D");
						model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");
						
						model.makeNode("/root/reqData/reqForm/multiUpdateData");
						model.setValue("/root/reqData/reqForm/multiUpdateData"	,gd_bus.getUpdateData());					
						
						model.send("ad_res_1220_a");
						if(submit_completed()){
							model.reset();
							initPage();
						}
					}				
				//}
				]]>
			</script>
		</button>
		<button id="btn_init" class="btn02" crud="R" style="left:421px; top:40px; width:52px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var preng_occr_dt		=	model.getValue("/root/reqData/searchData/preng_occr_dt");
				model.reset();
				
//				inp_sect_nm.attribute("editable") = "true";
				
				inp_seq.disabled 		= false;
				
				btn_qry.disabled 		= false;
//				btn_ins.disabled = false;
				btn_upd.disabled 		= true;
				btn_del.disabled 		= true;
				
				cb_hndl_clsf.select(0);
				grp_agn.visible = false;
				grp_hndl_clsf.visible = false;
							
				group1.visible  = true;
				gr_group1.visible = true;
				gr_bus.visible = false;
				grp_ast.visible = false;

				model.setValue("/root/reqData/searchData/preng_occr_dt", preng_occr_dt)
				inp_preng_occr_dt.refresh();
				
				
				]]>
			</script>
		</button>
		<button id="btnClose" class="btn02" style="left:885px; top:40px; width:52px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				if(window.type == "mdi"){
					viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
				}else{													
					window.close();
				}								
				]]>
			</script>
		</button>
		<button id="button1" class="btn04" disabled="false" crud="P" style="left:701px; top:40px; width:90px; height:21px; ">
			<caption>INVOICE</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[		
					goReport("P");		
				]]>
			</script>
		</button>
		<button id="button2" class="btn04" disabled="false" crud="P" style="left:793px; top:40px; width:90px; height:21px; ">
			<caption>게재의뢰서</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[	
					goReport2("P");		
				]]>
			</script>
		</button>
		<caption id="caption63" class="list_cap03" style="left:175px; top:560px; width:75px; height:26px; ">수배처</caption>
		<caption id="subtitle" class="tit02" style="left:10px; top:540px; width:130px; height:20px; ">광고원고수배장</caption>
		<input id="inp_srch_plac" ref="/root/resData/resForm/srch_plac" navindex="42" style="left:254px; top:564px; width:100px; height:18px; "/>
		<caption id="caption64" class="list_cap03" style="left:359px; top:560px; width:75px; height:26px; ">연락처</caption>
		<caption id="caption65" class="list_cap03" style="left:610px; top:560px; width:75px; height:26px; ">시간</caption>
		<caption id="caption66" class="list_cap03" style="left:779px; top:560px; width:75px; height:26px; ">섹션</caption>
		<caption id="caption67" class="list_cap03" style="left:244px; top:615px; width:95px; height:26px; ">연락처</caption>
		<caption id="caption68" class="list_cap03" style="left:505px; top:615px; width:95px; height:26px; ">시간</caption>
		<caption id="caption69" class="tit02" style="left:10px; top:595px; width:130px; height:20px; ">중점광고확인</caption>
		<caption id="caption70" class="list_cap03" style="left:724px; top:615px; width:95px; height:26px; ">구분</caption>
		<caption id="caption71" class="list_cap02" style="left:10px; top:615px; width:926px; height:26px; "/>
		<input id="inp_cnfm_matt" ref="/root/resData/resForm/cnfm_matt" navindex="47" imemode="hangul" style="left:88px; top:619px; width:843px; height:18px; "/>
		<caption id="caption72" class="list_cap03" style="left:10px; top:615px; width:75px; height:26px; ">확인사항</caption>
		<input id="inp_cntc_plac" ref="/root/resData/resForm/cntc_plac" navindex="43" style="left:438px; top:564px; width:165px; height:18px; "/>
		<input id="inp_tm" ref="/root/resData/resForm/tm" navindex="44" style="left:688px; top:564px; width:85px; height:18px; "/>
		<bool id="bool_ext01" navindex="40" checkvalue="Y,N" ref="/root/resData/resForm/bool_ext01" style="left:118px; top:540px; width:25px; height:20px; "/>
		<bool id="bool_ext02" navindex="46" checkvalue="Y,N" ref="/root/resData/resForm/bool_ext02" style="left:104px; top:595px; width:25px; height:20px; "/>
		<caption id="caption73" class="list_cap03" style="left:10px; top:560px; width:75px; height:26px; ">수배일자</caption>
		<input id="inp_srch_dt" ref="/root/resData/resForm/srch_dt" navindex="41" inputtype="date" format="yyyy-mm-dd" style="left:88px; top:564px; width:85px; height:18px; "/>
		<input id="input1" ref="/root/resData/resForm/sect_clsf" style="left:857px; top:564px; width:75px; height:18px; "/>
		<output id="output1" ref="/root/resData/resForm/org_preng_occr_dt" visibility="hidden" style="left:490px; top:508px; width:110px; height:18px; "/>
		<output id="output2" ref="/root/resData/resForm/org_preng_occr_seq" visibility="hidden" style="left:605px; top:508px; width:125px; height:18px; "/>
		<output id="output3" ref="/root/resData/resForm/issu_chro_clsf" visibility="hidden" style="left:893px; top:154px; width:40px; height:18px; "/>
		<caption id="caption74" class="list_cap03" style="left:304px; top:330px; width:94px; height:26px; ">협찬광고</caption>
		<bool id="bool3" visibility="hidden" checkvalue="Y,N" ref="/root/resData/resForm/nwsp_type_yn" style="left:404px; top:333px; width:25px; height:20px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var spon_advt_yn = bool3.value;
/*
					if (spon_advt_yn == "Y"){
						combo1.disabled = false;
					}else{
						combo1.value = "";
						combo1.disabled = true;
						combo1.refresh();
					}
*/
				]]>
			</script>
		</bool>
		<caption id="caption76" class="list_cap03" style="left:582px; top:330px; width:94px; height:26px; ">선발행여부</caption>
		<select1 id="combo1" ref="/root/resData/resForm/nwsp_side_type" navindex="31" appearance="minimal" style="left:405px; top:335px; width:172px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/nwsp_side_type/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[				
				var spon_type = model.getValue("/root/resData/resForm/nwsp_side_type");
				if( trim(spon_type) == ""  ){
					bool3.value = "N";
				}
				else{
					bool3.value = "Y";
				}
				
/*				
				var mony_kind = model.getValue("/root/resData/resForm/mony_kind");
				makeNodeValue("/root/reqData/searchData/mony_kind", mony_kind);

				if(mony_kind == "KRW") {
					model.setValue("/root/resData/resForm/exrate", "");
					out_exrate.refresh();
					return;
				}
				
				modelSendNoMake("ad_co_9001_s", "/ad/common/9001", "/root/reqData/searchData", "/root/tempData");		
				
				model.setValue("/root/resData/resForm/exrate", model.getValue("/root/tempData/exrate"));
				out_exrate.refresh();
*/				
				]]>
			</script>
		</select1>
		<input id="inp_seq" ref="/root/reqData/searchData/preng_occr_seq" navindex="3" inputtype="button" maxlength="4" format="9999" style="left:458px; top:76px; width:70px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					
//					model.setValue("/root/reqData/fwdData/medi_cd", model.getValue("/root/reqData/searchData/medi_cd"));
//					model.setValue("/root/reqData/fwdData/preng_occr_dt", model.getValue("/root/reqData/searchData/preng_occr_dt"));

					model.setValue("/root/reqData/fwdData/medi_cd", model.getValue("/root/resData/resForm/medi_cd"));	
					model.copyNode("/root/reqData/fwdData", "/root/reqData/searchData");
					window.load("./AD_RES_1201.xrw"
							    , "modal"
							    , ""
							    , "align:center; width:954; height:660; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
							    , "/root/reqData/fwdData"
							    , "/root/reqData/fwdData"
							    )
				]]>
			</script>
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[
					var preng_occr_seq = model.getValue("/root/reqData/searchData/preng_occr_seq");
					
					model.setValue("/root/reqData/searchData/preng_occr_seq", lpad(preng_occr_seq, 4, "0"));
					inp_seq.refresh();
				]]>
			</script>
		</input>
		<bool id="bool4" navindex="45" checkvalue="Y,N" ref="/root/resData/resForm/pre_issu_yn" style="left:680px; top:335px; width:35px; height:15px; "/>
	</xhtml:body>
</xhtml:html>
