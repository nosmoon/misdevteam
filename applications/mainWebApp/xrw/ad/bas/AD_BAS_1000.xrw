<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session>
							<cmpy_cd>100</cmpy_cd>
						</session>
						<pageInfo/>
					</initData>
					<reqData>
						<fwdData>
							<func_nm/>
						</fwdData>
						<searchData>
							<dlco_no/>
							<dlco_abrv_nm/>
						</searchData>
					</reqData>
					<formData>
						<dlco_nm/>
						<ern/>
						<zip_1/>
						<zip_2/>
						<addr/>
						<dtls_addr/>
						<presi_nm/>
						<presi_prn/>
						<presi_zip_1/>
						<presi_zip_2/>
						<presi_addr/>
						<presi_dtls_addr/>
						<bizcond/>
						<item/>
						<grp_cmpy_cd/>
						<eps_clsf_cd/>
						<cntr_yn/>
						<mang_clsf/>
						<oth_cmpy_dlco_yn/>
						<govern_advt_yn/>
						<cntr_type/>
						<slcrg_pers/>
						<mchrg_pers/>
						<slcrg_pers_nm/>
						<mchrg_pers_nm/>
						<indt_cd/>
						<type_cd/>
						<fndt_dt/>
						<dhon_dt/>
						<chg_dt_tm/>
						<chg_pers/>
						<capt_amt/>
						<gnr_advcs_yn/>
						<arow_advcs_yn/>
						<agn_yn/>
						<nmd_agn_yn/>
						<advt_bo_yn/>
						<bo_bof_yn/>
						<del_yn/>
						<dlco_no/>
						<dlco_abrv_nm/>
						<elec_tax_comp_cd/>
						<email_id/>
						<flag/>
						<chk_cnt/>
						<gridData>
							<record>
								<seq/>
								<job_clsf/>
								<advcs_feat/>
								<chrg_pers/>
								<tel_no/>
							</record>
						</gridData>
						<gridData2>
							<record>
								<seq/>
								<insrt_dt/>
								<dlco_info/>
								<chrg_pers/>
							</record>
						</gridData2>
						<multiUpdateData/>
						<multiUpdateData2/>
						<preng_yn/>
					</formData>
					<codeData>
						<grp_cmpy_cd>
							<item>
								<label/>
								<value/>
							</item>
						</grp_cmpy_cd>
						<mang_clsf>
							<item>
								<label/>
								<value/>
							</item>
						</mang_clsf>
						<cntr_type>
							<item>
								<label/>
								<value/>
							</item>
						</cntr_type>
						<indt_cd>
							<item>
								<label/>
								<value/>
							</item>
						</indt_cd>
						<job_clsf>
							<item>
								<label/>
								<value/>
							</item>
						</job_clsf>
						<elec_tax_comp_cd>
							<item>
								<label/>
								<value/>
							</item>
						</elec_tax_comp_cd>
						<type_cd>
							<item>
								<label/>
								<value/>
							</item>
						</type_cd>
					</codeData>
					<resData>
					</resData>
					<rcvData/>
					<gridData>
					</gridData>
					<tempData>
						<flag/>
					</tempData>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					model.send("ad_bas_1000_m");
					model.copyNode("/root/codeData/grp_cmpy_cd"	, "/root/resData/grp_cmpy_cd");
					model.copyNode("/root/codeData/mang_clsf"		, "/root/resData/mang_clsf");
					model.copyNode("/root/codeData/cntr_type"		, "/root/resData/cntr_type");
					model.copyNode("/root/codeData/indt_cd"		, "/root/resData/indt_cd");
					model.copyNode("/root/codeData/type_cd"		, "/root/resData/type_cd");
					model.copyNode("/root/codeData/job_clsf"		, "/root/resData/job_clsf");
					model.copyNode("/root/codeData/elec_tax_comp_cd", "/root/resData/elec_tax_comp_cd");
					
					makeComboGubun("", "/root/codeData/grp_cmpy_cd"	, "item", "label", "value");
					makeComboGubun("", "/root/codeData/mang_clsf"		, "item", "label", "value");
					makeComboGubun("", "/root/codeData/cntr_type"		, "item", "label", "value");
					makeComboGubun("", "/root/codeData/indt_cd"		, "item", "label", "value");
					makeComboGubun("", "/root/codeData/type_cd"		, "item", "label", "value");
					makeComboGubun("", "/root/codeData/elec_tax_comp_cd", "item", "label", "value");
					
					var dept_cd = model.property("ss_deptcd").substring(0,2);
					var emp_no  = model.property("ss_emp_no").substring(0,2);
					var emp_no2 = model.property("ss_emp_no");
					var cmpy_cd = model.property("ss_cmpycd");
					//alert(dept_cd);
					//alert(emp_no);
					//alert(cmpy_cd);
					if(cmpy_cd = "100"){
						//부서에 따라 광고주구분의 체크박스 visible = ture/false
						if(dept_cd == "57" || dept_cd == "15" || dept_cd == "25"){//뉴미디어
							bool7.visible     = false;
							caption11.visible = false;
						}else if(emp_no == "it" || dept_cd == "36"){//관리자 or 재경국

						}else{//AD본부
							bool10.visible    = true;
							caption27.visible = true;
						}
						
						//20130704 주석처리함 
						//20130702 김상훈 변경내용:방지영,원승식,김영한만 입력/수정되게 코드 추가함
						//AD본부인경우에만 적용함 
						//if(dept_cd == "54")
						//{
//							if(emp_no2 != "209041" && emp_no2 != "211019" && emp_no2 != "195054"){
//								btnIns.disabled = true;
//								btnUpd.disabled = true;
//							}						
//						}
					}
					
					model.refresh();
					
					if( model.property(KEY_DLCO_NO) != "" )
					{
						model.setValue("/root/reqData/searchData/dlco_no",  model.property(KEY_DLCO_NO));
						model.send("ad_bas_1010_s");
						if(submit_completed())
						{
							model.setValue("/root/reqData/searchData/dlco_abrv_nm", model.getValue("/root/formData/dlco_abrv_nm"));
							inp_dlco_abrv_nm.refresh();
							model.property(KEY_DLCO_NO) = "";
						}
						
						setMode(UPDATE_MODE);
					}
					else
					{
						setMode(INSERT_MODE);
					}	
				
				]]>
			</script>
			<submission id="ad_bas_1000_m" action="/ad/bas/1000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/resData"/>
			<submission id="ad_bas_1010_s" action="/ad/bas/1010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/formData"/>
			<submission id="ad_bas_1030_a" action="/ad/bas/1030" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/formData" resultref="/root/resData"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
				function setDlcoInfo(dlco_no, dlco_nm)
				{
					model.setValue("/root/reqData/searchData/dlco_no"		, dlco_no);
					model.setValue("/root/formData/dlco_nm"				, dlco_nm);
					model.setValue("/root/reqData/searchData/dlco_abrv_nm", "");
	
					inp_dlco_abrv_nm.refresh();
					inp_dlco_no.refresh();
					out_dlco_nm.refresh();
					
					model.send("ad_bas_1010_s");
					if( submit_completed() )
					{
						model.setValue("/root/reqData/searchData/dlco_abrv_nm", model.getValue("/root/formData/dlco_abrv_nm"));
						setMode(UPDATE_MODE);
					}
					model.refresh();
				}
						
				function setDlcoNo(dlco_no)
				{
					model.setValue("/root/reqData/searchData/dlco_no", dlco_no);
					inp_dlco_no.refresh();
					
					model.send("ad_bas_1010_s");
				}
				
				function setMode(mode)
				{
					if(mode == INSERT_MODE)
					{
//						btnIns.disabled = false;
//						btnUpd.disabled = true;
					}
					else if(mode == UPDATE_MODE)
					{
//						btnIns.disabled = true;
//						btnUpd.disabled = false;					
					}
					else
					{
//						btnIns.disabled = true;
//						btnUpd.disabled = true;
					}
				}
				
				function chk_gnr_advcs_yn(){
					//일반광고주인 경우 업종은 필수 사항 20130627 김상훈
					//단, 다른 광고주구분이 체크되었다면 널값 가능함
					var chk = true;
					var gnr_advcs_yn = model.getValue("/root/formData/gnr_advcs_yn");
					var arow_advcs_yn = model.getValue("/root/formData/arow_advcs_yn");
					var agn_yn = model.getValue("/root/formData/agn_yn");
					//var nmd_agn_yn = model.getValue("/root/formData/nmd_agn_yn");
					var advt_bo_yn = model.getValue("/root/formData/advt_bo_yn");
					var bo_bof_yn = model.getValue("/root/formData/bo_bof_yn");
					//alert("gnr_advcs_yn::"+gnr_advcs_yn+"::arow_advcs_yn::"+arow_advcs_yn+"::agn_yn::"+agn_yn+"::advt_bo_yn::"+advt_bo_yn+"::bo_bof_yn::"+bo_bof_yn);
					if(arow_advcs_yn != "Y" || agn_yn != "Y" || advt_bo_yn != "Y" || bo_bof_yn != "Y" )
					{
						if(gnr_advcs_yn == "Y"){
							var indt_nm = combo8.label;
							if(indt_nm == ""){
								chk = false;
								alert("업종: 필수 입력사항이 누락되었습니다.");
							}
						}						
					}
					return chk;
				}
				function zip_visible(zip,clsf){
					if(clsf == "1"){
						if(zip.length == "5"){
							inp_new_zip.visible = true;
							input7.visible = false;
							input15.visible = false;
							caption30.visible = false;
						}else{
							inp_new_zip.visible = false;
							input7.visible = true;
							input15.visible = true;
							caption30.visible = true;
						}	
					}
					else{
						if(zip.length == "5"){
							inp_new_pzip.visible = true;
							input15.visible = false;
							input16.visible = false;
						}else{
							inp_new_pzip.visible = false;
							input15.visible = true;
							input16.visible = true;
						}	
						
					}
				}				
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="756" guideline="1,10;1,936;2,59;2,102;2,749;" style="font-family:돋움; font-size:12px; ">
		<caption id="caption4" class="list_cap02" style="left:10px; top:111px; width:926px; height:26px; "/>
		<caption id="caption74" class="list_cap02" style="left:10px; top:70px; width:926px; height:28px; "/>
		<caption id="caption52" class="list_cap02" style="left:10px; top:511px; width:926px; height:26px; "/>
		<caption id="caption51" class="list_cap02" style="left:10px; top:486px; width:926px; height:26px; "/>
		<caption id="caption40" class="list_cap02" style="left:10px; top:461px; width:926px; height:26px; "/>
		<caption id="caption39" class="list_cap02" style="left:10px; top:436px; width:926px; height:26px; "/>
		<caption id="caption73" class="list_cap02" style="left:10px; top:411px; width:926px; height:26px; "/>
		<caption id="caption72" class="list_cap02" style="left:10px; top:386px; width:926px; height:26px; "/>
		<caption id="caption71" class="list_cap02" style="left:10px; top:361px; width:926px; height:26px; "/>
		<caption id="caption70" class="list_cap02" style="left:10px; top:336px; width:926px; height:26px; "/>
		<caption id="caption69" class="list_cap02" style="left:10px; top:286px; width:926px; height:26px; "/>
		<caption id="caption59" class="list_cap02" style="left:10px; top:261px; width:926px; height:26px; "/>
		<caption id="caption58" class="list_cap02" style="left:10px; top:236px; width:926px; height:26px; "/>
		<caption id="caption56" class="list_cap02" style="left:10px; top:211px; width:926px; height:26px; "/>
		<caption id="caption57" class="list_cap02" style="left:10px; top:186px; width:926px; height:26px; "/>
		<caption id="caption54" class="list_cap02" style="left:10px; top:161px; width:926px; height:26px; "/>
		<caption id="caption55" class="list_cap02" style="left:119px; top:136px; width:802px; height:26px; "/>
		<caption id="caption5" class="list_cap02" style="left:10px; top:136px; width:926px; height:26px; "/>
		<caption id="caption29" class="cell2" style="left:504px; top:216px; width:180px; height:23px; "/>
		<caption id="caption26" class="cell2" style="left:109px; top:279px; width:180px; height:20px; "/>
		<caption id="caption10" class="list_cap03_110" style="left:10px; top:135px; width:110px; height:26px; text-align:center; ">사업자등록번호</caption>
		<caption id="caption13" class="list_cap03_110" style="left:10px; top:159px; width:110px; height:26px; text-align:center; ">우편번호</caption>
		<caption id="caption15" class="cell2" style="left:129px; top:161px; width:180px; height:20px; "/>
		<output id="input6" ref="/root/formData/ern" class="output" appearance="output" style="left:123px; top:140px; width:172px; height:18px; "/>
		<output id="inp_new_zip" ref="/root/formData/zip_1" appearance="output" style="left:123px; top:165px; width:106px; height:18px; "/>
		<output id="input7" ref="/root/formData/zip_1" visibility="hidden" appearance="output" style="left:123px; top:165px; width:45px; height:18px; "/>
		<caption id="caption16" class="list_cap03_110" style="left:10px; top:183px; width:110px; height:26px; text-align:center; ">주소</caption>
		<caption id="caption17" class="list_cap03_110" style="left:10px; top:207px; width:110px; height:26px; text-align:center; ">대표자명</caption>
		<output id="input9" ref="/root/formData/addr" appearance="output" style="left:123px; top:190px; width:292px; height:18px; "/>
		<caption id="caption20" class="list_cap03_110" style="left:10px; top:231px; width:110px; height:26px; text-align:center; ">대표우편번호</caption>
		<caption id="caption21" class="list_cap03_110" style="left:10px; top:255px; width:110px; height:26px; text-align:center; ">대표주소</caption>
		<output id="input8" ref="/root/formData/presi_nm" appearance="output" style="left:123px; top:215px; width:172px; height:18px; "/>
		<caption id="caption24" class="list_cap03_110" style="left:10px; top:279px; width:110px; height:26px; text-align:center; ">업태</caption>
		<output id="input12" ref="/root/formData/item" appearance="output" style="left:457px; top:290px; width:317px; height:18px; "/>
		<caption id="caption25" class="list_cap03" style="left:345px; top:286px; width:110px; height:26px; text-align:center; ">종목</caption>
		<output id="input13" ref="/root/formData/bizcond" appearance="output" style="left:123px; top:290px; width:217px; height:18px; "/>
		<output id="input14" ref="/root/formData/presi_prn" appearance="output" style="left:457px; top:215px; width:172px; height:18px; "/>
		<caption id="caption28" class="list_cap03" style="left:344px; top:211px; width:110px; height:26px; text-align:center; ">주민등록번호</caption>
		<caption id="caption30" visibility="hidden" style="left:170px; top:165px; width:15px; height:20px; text-align:center; ">-</caption>
		<output id="input15" ref="/root/formData/zip_2" visibility="hidden" appearance="output" style="left:184px; top:165px; width:45px; height:18px; "/>
		<output id="input17" ref="/root/formData/dtls_addr" appearance="output" style="left:419px; top:190px; width:263px; height:18px; "/>
		<output id="input11" ref="/root/formData/presi_zip_1" appearance="output" style="left:123px; top:240px; width:106px; height:18px; "/>
		<output id="output1" ref="/root/formData/presi_zip_1" appearance="output" style="left:123px; top:240px; width:45px; height:18px; "/>
		<caption id="caption31" style="left:170px; top:240px; width:15px; height:20px; text-align:center; ">-</caption>
		<output id="input19" ref="/root/formData/presi_zip_2" appearance="output" style="left:185px; top:240px; width:45px; height:18px; "/>
		<output id="input20" ref="/root/formData/presi_addr" appearance="output" style="left:123px; top:265px; width:292px; height:18px; "/>
		<output id="input23" ref="/root/formData/presi_dtls_addr" appearance="output" style="left:420px; top:265px; width:262px; height:18px; "/>
		<caption id="caption23" class="list_cap03" style="left:10px; top:336px; width:110px; height:26px; text-align:center; ">그룹사</caption>
		<caption id="caption35" class="list_cap03" style="left:10px; top:361px; width:110px; height:26px; text-align:center; ">관리구분</caption>
		<caption id="caption37" class="list_cap03" style="left:10px; top:386px; width:110px; height:26px; text-align:center; ">계약형태</caption>
		<caption id="caption42" class="list_cap03" style="left:10px; top:461px; width:110px; height:26px; text-align:center; ">부도일자</caption>
		<caption id="caption44" class="list_cap03" style="left:10px; top:486px; width:110px; height:26px; text-align:center; ">자본금</caption>
		<input id="input25" ref="/root/formData/capt_amt" navindex="19" format="#,###" style="left:123px; top:490px; width:172px; height:18px; text-align:right; "/>
		<caption id="caption47" class="list_cap03" style="left:345px; top:461px; width:110px; height:26px; text-align:center; ">변경일시</caption>
		<caption id="caption48" class="list_cap03" style="left:345px; top:336px; width:110px; height:26px; text-align:center; ">사업자구분</caption>
		<caption id="caption49" class="list_cap03" style="left:345px; top:361px; width:110px; height:26px; text-align:center; ">타사거래처</caption>
		<caption id="caption50" class="list_cap03" style="left:345px; top:386px; width:110px; height:26px; text-align:center; ">영업담당</caption>
		<caption id="caption60" class="list_cap03" style="left:645px; top:336px; width:110px; height:26px; text-align:center; ">계약여부</caption>
		<caption id="caption61" class="list_cap03" style="left:645px; top:361px; width:110px; height:26px; text-align:center; ">정부광고</caption>
		<caption id="caption63" class="list_cap03" style="left:645px; top:461px; width:110px; height:26px; text-align:center; ">변경자</caption>
		<select1 id="radio3" ref="/root/formData/eps_clsf_cd" navindex="4" appearance="full" cols="2" itemwidth="40" rows="1" overflow="visible" style="left:460px; top:340px; width:100px; height:17px; background-color:transparent; border-style:none; ">
			<choices>
				<item>
					<label>법인</label>
					<value>1</value>
				</item>
				<item>
					<label>개인</label>
					<value>2</value>
				</item>
			</choices>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
				]]>
			</script>
		</select1>
		<input id="inp_slcrg_pers" ref="/root/formData/slcrg_pers" navindex="10" maxlength="10" caption="영업담당" style="left:458px; top:390px; width:60px; height:18px; ">
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == "13" )
					{
						commonSubmission("9005", inp_slcrg_pers.currentText,  inp_slcrg_pers, inp_slcrg_pers_nm);
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					commonSubmission("9005", inp_slcrg_pers.currentText,  inp_slcrg_pers, inp_slcrg_pers_nm);	
				]]>
			</script>
		</input>
		<input id="inp_slcrg_pers_nm" ref="/root/formData/slcrg_pers_nm" navindex="11" imemode="hangul" inputtype="button" caption="영업담당" crud="R" style="left:525px; top:390px; width:100px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					searchEmpno("setSlcrgPers", "/root/formData/slcrg_pers", "/root/formData/slcrg_pers_nm");
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == "13" )
					{
						findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm.currentText, inp_slcrg_pers, inp_slcrg_pers_nm);
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					findEmpNoByName("setSlcrgPers", inp_slcrg_pers_nm.currentText, inp_slcrg_pers, inp_slcrg_pers_nm);
				]]>
			</script>
		</input>
		<input id="inp_mchrg_pers" ref="/root/formData/mchrg_pers" navindex="12" maxlength="10" caption="관리담당" style="left:758px; top:390px; width:60px; height:18px; ">
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == "13" )
					{
						commonSubmission("9005", inp_mchrg_pers.currentText,  inp_mchrg_pers, inp_mchrg_pers_nm);
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					commonSubmission("9005", inp_mchrg_pers.currentText,  inp_mchrg_pers, inp_mchrg_pers_nm);		
				]]>
			</script>
		</input>
		<input id="inp_mchrg_pers_nm" ref="/root/formData/mchrg_pers_nm" navindex="13" imemode="hangul" inputtype="button" caption="관리담당" crud="R" style="left:825px; top:390px; width:100px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[	
					searchEmpno("setMchrgPers", "/root/formData/mchrg_pers", "/root/formData/mchrg_pers_nm");	
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[				
					if( event.keyCode == "13" )
					{
						findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					findEmpNoByName("setMchrgPers", inp_mchrg_pers_nm.currentText, inp_mchrg_pers, inp_mchrg_pers_nm);
				]]>
			</script>
		</input>
		<output id="input31" ref="/root/formData/chg_dt_tm" appearance="output" style="left:458px; top:465px; width:172px; height:18px; "/>
		<output id="input32" ref="/root/formData/chg_pers" appearance="output" style="left:758px; top:465px; width:172px; height:18px; "/>
		<caption id="caption62" class="list_cap03" style="left:10px; top:511px; width:110px; height:26px; text-align:center; ">광고주구분</caption>
		<datagrid id="datagrid1" nodeset="/root/formData/gridData/record" caption="일련번호^업무구분^광고주특성^담당자^전화번호" colsep="#" colwidth="100, 150, 346, 150, 150" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="byrow" style="left:10px; top:567px; width:926px; height:68px; ">
			<col ref="seq" visibility="hidden"/>
			<col ref="job_clsf" type="combo">
				<choices>
					<itemset nodeset="/root/codeData/job_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</col>
			<col ref="advcs_feat" type="input" style="text-align:left; vertical-align:middle; "/>
			<col ref="chrg_pers" type="input" style="text-align:left; vertical-align:middle; "/>
			<col ref="tel_no" type="input" style="text-align:left; vertical-align:middle; "/>
		</datagrid>
		<button id="btnQry" class="btn02" crud="R" style="left:473px; top:40px; width:52px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if( trim(inp_dlco_no.currentText) == "" && trim(inp_dlco_abrv_nm.currentText) == "" )
					{
						alert("조회할 거래처번호 또는 광고주약어명을 입력하세요.");
						return;
					}
					
					model.send("ad_bas_1010_s");	
					if( submit_completed() )
					{
						var chk_cnt = Number(model.getValue("/root/formData/chk_cnt"));
						if( chk_cnt == 0 )
						{
							alert("검색결과가 없습니다.");
						}
						else if( chk_cnt == 1 )
						{
							model.setValue("/root/reqData/searchData/dlco_no"		, model.getValue("/root/formData/dlco_no"));
							model.setValue("/root/reqData/searchData/dlco_abrv_nm", model.getValue("/root/formData/dlco_abrv_nm"));
							inp_dlco_no.refresh();
							inp_dlco_abrv_nm.refresh();
						}
						else
						{
							showAdvcsSearchPopup("", "", "", "", "", inp_dlco_abrv_nm.currentText); 
						}
						setMode(UPDATE_MODE);
					}
				]]>
			</script>
		</button>
		<button id="btnIns" class="btn02" crud="C" style="left:531px; top:40px; width:52px; height:21px; ">
			<caption>입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if( validateReq() )
					{	
						if(chk_gnr_advcs_yn() ){
							if( windowConfirm("등록하시겠습니까?") )
							{
								model.setValue("/root/formData/flag"			, "I");
								model.setValue("/root/formData/dlco_no"			, model.getValue("/root/reqData/searchData/dlco_no"));
								model.setValue("/root/formData/multiUpdateData"		,datagrid1.getUpdateData());
								model.setValue("/root/formData/multiUpdateData2"	,datagrid2.getUpdateData());
								model.send("ad_bas_1030_a");
							}
						}
					}
				]]>
			</script>
		</button>
		<button id="btnUpd" class="btn02" crud="U" style="left:589px; top:40px; width:52px; height:21px; ">
			<caption>수정</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if( validateReq() )
					{
						if(chk_gnr_advcs_yn() ){
							if( windowConfirm("수정하시겠습니까?") )
							{
								model.setValue("/root/formData/flag"			, "U");
								model.setValue("/root/formData/multiUpdateData"		,datagrid1.getUpdateData());
								model.setValue("/root/formData/multiUpdateData2"	,datagrid2.getUpdateData());
								model.send("ad_bas_1030_a");
								if( submit_completed() )
								{
									model.send("ad_bas_1010_s");
								}	
							}	
						}
					}
				]]>
			</script>
		</button>
		<button id="btnInit" class="btn02" crud="R" style="left:647px; top:40px; width:52px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.reset();
					setMode(INSERT_MODE);
				]]>
			</script>
		</button>
		<button id="button3" class="btn04" crud="R" style="left:705px; top:40px; width:87px; height:21px; ">
			<caption>공통거래처</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					regDlcoInfo();

					var if_dlco_no = model.property("IF_DLCO_NO");		
					
					if( if_dlco_no != "" )
					{
						model.setValue("/root/reqData/searchData/dlco_no", if_dlco_no);
						inp_dlco_no.refresh();	
										
						model.send("ad_bas_1010_s");	
						if( submit_completed() )
						{
							model.setValue("/root/reqData/searchData/dlco_no"			, model.getValue("/root/formData/dlco_no"));
							model.setValue("/root/reqData/searchData/dlco_abrv_nm"	, model.getValue("/root/formData/dlco_abrv_nm"));
							inp_dlco_no.refresh();
							inp_dlco_abrv_nm.refresh();
						}
					}
				]]>
			</script>
		</button>
		<line id="line1" style="x1:18px; y1:324px; x2:928px; y2:324px; border-color:#99ccff; "/>
		<bool id="bool1" navindex="7" checkvalue="Y,N" select.background-image="#check" ref="/root/formData/oth_cmpy_dlco_yn" style="left:460px; top:365px; width:26px; height:20px; background-image:#uncheck; "/>
		<bool id="bool2" navindex="5" checkvalue="Y,N" select.background-image="#check" ref="/root/formData/cntr_yn" style="left:760px; top:340px; width:26px; height:20px; background-image:#uncheck; "/>
		<bool id="bool3" navindex="8" checkvalue="Y,N" select.background-image="#check" ref="/root/formData/govern_advt_yn" style="left:760px; top:365px; width:26px; height:20px; background-image:#uncheck; "/>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<caption id="caption3" class="list_cap03" style="left:645px; top:386px; width:110px; height:26px; text-align:center; ">관리담당</caption>
		<caption id="caption6" class="list_cap03" style="left:10px; top:436px; width:110px; height:26px; text-align:center; ">설립일자</caption>
		<caption id="caption53" class="list_cap03" style="left:10px; top:411px; width:110px; height:26px; text-align:center; ">업종</caption>
		<input id="input1" ref="/root/formData/fndt_dt" navindex="16" inputtype="date" crud="R" style="left:123px; top:440px; width:172px; height:18px; "/>
		<select1 id="combo5" ref="/root/formData/grp_cmpy_cd" navindex="3" appearance="minimal" style="left:123px; top:340px; width:172px; height:18px; ">
			<choices>
				<itemset nodeset="/root/codeData/grp_cmpy_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<input id="input2" ref="/root/formData/dhon_dt" navindex="18" inputtype="date" crud="R" style="left:123px; top:465px; width:172px; height:18px; "/>
		<select1 id="combo6" ref="/root/formData/mang_clsf" navindex="6" appearance="minimal" style="left:123px; top:365px; width:172px; height:18px; ">
			<choices>
				<itemset nodeset="/root/codeData/mang_clsf/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<select1 id="combo7" ref="/root/formData/cntr_type" navindex="9" appearance="minimal" style="left:123px; top:390px; width:172px; height:18px; ">
			<choices>
				<itemset nodeset="/root/codeData/cntr_type/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<select1 id="combo8" ref="/root/formData/indt_cd" navindex="14" appearance="minimal" style="left:123px; top:415px; width:172px; height:18px; ">
			<choices>
				<itemset nodeset="/root/codeData/indt_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<group id="group_line" class="gro_line" style="left:11px; top:102px; width:926px; height:5px; "/>
		<input id="inp_dlco_no" ref="/root/reqData/searchData/dlco_no" class="req" navindex="1" autonext="false" maxlength="8" format="99999999" caption="거래처번호" style="left:123px; top:75px; width:72px; height:18px; ">
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == "13" )
					{
						if( trim(inp_dlco_no.currentText) == "" )
						{
							alert("조회할 거래처번호를 입력하세요.");
							return;
						}
						
						var dlco_no = inp_dlco_no.currentText;					
						model.setValue("/root/reqData/searchData/dlco_no", lpad(dlco_no, 8, "0"));
						inp_dlco_no.refresh();								
						
						model.send("ad_bas_1010_s");	
						if( submit_completed() )
						{
							model.setValue("/root/reqData/searchData/dlco_no"		, model.getValue("/root/formData/dlco_no"));
							model.setValue("/root/reqData/searchData/dlco_abrv_nm", model.getValue("/root/formData/dlco_abrv_nm"));
							inp_dlco_no.refresh();
							inp_dlco_abrv_nm.refresh();
							setMode(UPDATE_MODE);
						}			
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var dlco_no = inp_dlco_no.currentText;//model.getValue("/root/reqData/searchData/dlco_no");					
	
					model.setValue("/root/reqData/searchData/dlco_no", lpad(dlco_no, 8, "0"));
					inp_dlco_no.refresh();	
					commonSubmission("9004", inp_dlco_no.currentText,  inp_dlco_no, inp_dlco_abrv_nm);	
					
					if( model.getValue("/root/tempData/srch_nm") != "" )
					{
						model.send("ad_bas_1010_s");	
						if( submit_completed() )
						{
							model.setValue("/root/reqData/searchData/dlco_no", model.getValue("/root/formData/dlco_no"));
							model.setValue("/root/reqData/searchData/dlco_abrv_nm", model.getValue("/root/formData/dlco_abrv_nm"));
							inp_dlco_no.refresh();
							inp_dlco_abrv_nm.refresh();
							setMode(UPDATE_MODE);
						}
					}
				]]>
			</script>
		</input>
		<caption id="caption1" class="list_cap01" style="left:10px; top:70px; width:110px; height:28px; text-align:center; ">거래처번호</caption>
		<input id="inp_dlco_abrv_nm" ref="/root/reqData/searchData/dlco_abrv_nm" navindex="2" imemode="hangul" style="left:458px; top:75px; width:167px; height:18px; ">
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if( event.keyCode == "13" )
					{
						if( trim(inp_dlco_abrv_nm.currentText) == "" )
						{
							alert("조회할 광고주를 입력하세요.");
							return;
						}			

						findDlcoNoByName("1", inp_dlco_abrv_nm.currentText, inp_dlco_no, inp_dlco_abrv_nm);
						if( model.getValue("/root/tempData/resData/srch_cd") != "" )
						{
							model.send("ad_bas_1010_s");	
							if( submit_completed() )
							{
								var chk_cnt = Number(model.getValue("/root/formData/chk_cnt"));
								if(chk_cnt == 0)
								{
									alert("검색결과가 없습니다.");
								}
								else if(chk_cnt == 1)
								{
									model.setValue("/root/reqData/searchData/dlco_no"		, model.getValue("/root/formData/dlco_no"));
									model.setValue("/root/reqData/searchData/dlco_abrv_nm", model.getValue("/root/formData/dlco_abrv_nm"));
									inp_dlco_no.refresh();
									inp_dlco_abrv_nm.refresh();
								}
								else
								{
									showAdvcsSearchPopup("", "", "", "", "", inp_dlco_abrv_nm.currentText); 
								}
								setMode(UPDATE_MODE);
							}						
						}				
					}				
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					findDlcoNoByName("1", inp_dlco_abrv_nm.currentText, inp_dlco_no, inp_dlco_abrv_nm);	
					if(model.getValue("/root/tempData/resData/srch_cd") != ""){
	
						model.send("ad_bas_1010_s");	
						if(submit_completed()){
							var chk_cnt = Number(model.getValue("/root/formData/chk_cnt"));
							if(chk_cnt == 0){
								alert("검색결과가 없습니다.");
							}else if(chk_cnt == 1){
								model.setValue("/root/reqData/searchData/dlco_no", model.getValue("/root/formData/dlco_no"));
								inp_dlco_no.refresh();
								model.setValue("/root/reqData/searchData/dlco_abrv_nm", model.getValue("/root/formData/dlco_abrv_nm"));
								inp_dlco_abrv_nm.refresh();
							}else{
								showAdvcsSearchPopup("", "", "", "", "", inp_dlco_abrv_nm.currentText); 
							}
							setMode(UPDATE_MODE);
						}						
					}
				]]>
			</script>
		</input>
		<caption id="caption12" class="list_cap01" style="left:345px; top:70px; width:110px; height:28px; text-align:center; ">광고주약어명</caption>
		<button id="button1" crud="R" style="left:198px; top:75px; width:20px; height:19px; background-color:#dce5ec; border-color:#000000; border-style:solid; ">
			<caption>...</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[									
					showDlcoSearchPopup();	
				]]>
			</script>
		</button>
		<button id="button2" crud="R" style="left:220px; top:75px; width:20px; height:19px; color:#ff0000; background-color:#dce5ec; border-color:#000000; border-style:solid; ">
			<caption>...</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					showAdvcsSearchPopup("Y", "Y", "", "", "", ""); 
				]]>
			</script>
		</button>
		<caption id="caption22" class="list_cap03" style="left:10px; top:236px; width:110px; height:26px; text-align:center; ">대표우편번호</caption>
		<caption id="caption33" class="list_cap03" style="left:10px; top:261px; width:110px; height:26px; text-align:center; ">대표주소</caption>
		<caption id="caption36" class="list_cap03" style="left:10px; top:286px; width:110px; height:26px; text-align:center; ">업태</caption>
		<caption id="caption38" class="list_cap03" style="left:10px; top:161px; width:110px; height:26px; text-align:center; ">우편번호</caption>
		<caption id="caption43" class="list_cap03" style="left:10px; top:211px; width:110px; height:26px; text-align:center; ">대표자명</caption>
		<button id="btnClose" class="btn02" style="left:885px; top:40px; width:50px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if( window.type == "mdi" )
					{
						viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					}
					else
					{
						window.close();
					}
				]]>
			</script>
		</button>
		<caption id="caption2" class="list_cap03" style="left:10px; top:111px; width:110px; height:26px; text-align:center; ">거래처명</caption>
		<output id="out_dlco_nm" ref="/root/formData/dlco_nm" class="output" appearance="output" style="left:123px; top:115px; width:172px; height:18px; "/>
		<caption id="caption34" class="list_cap03" style="left:10px; top:136px; width:110px; height:26px; text-align:center; ">사업자등록번호</caption>
		<caption id="caption41" class="list_cap03" style="left:10px; top:186px; width:110px; height:26px; text-align:center; ">주소</caption>
		<output id="output2" ref="/root/formData/dlco_no" visibility="hidden" style="left:360px; top:115px; width:100px; height:18px; "/>
		<output id="output3" ref="/root/formData/dlco_abrv_nm" visibility="hidden" style="left:469px; top:115px; width:100px; height:18px; "/>
		<button id="btnG2" class="btn_grid03" crud="R" style="left:778px; top:548px; width:53px; height:17px; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var grid = datagrid1;
					
					grid.addRow();
					
					grid.row 	= grid.rows;
					grid.col 	= 1;
					
					grid.refresh();
				]]>
			</script>
		</button>
		<button id="button4" class="btn_grid02" crud="R" style="left:892px; top:548px; width:43px; height:17px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var grid 		= 	datagrid1;
					var firstRow 	= 	grid.row;
					var lastRow  	= 	grid.selectedRow(grid.selectedRows-1);				
					
					for( var i=firstRow; i<=lastRow; i++ )
					{
						if( grid.rowStatus(i) == "1" )
						{
							grid.removeRow(i);
							i--;
						}
						else if( grid.rowStatus(i) == "4" )
						{
							grid.rowStatus(i) = "0";
						}
						else
						{
							grid.rowStatus(i) = "0";
						}
					}
				]]>
			</script>
		</button>
		<button id="button13" class="btn_grid03" crud="R" style="left:835px; top:548px; width:53px; height:17px; ">
			<caption>행삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var grid 		= datagrid1;
					var firstRow 	= grid.row;
					var lastRow  	= grid.selectedRow(grid.selectedRows-1);

					for( var i=firstRow; i<=lastRow; i++ )
					{
						grid.rowStatus(i) = "4";
					}
					grid.refresh();
				]]>
			</script>
		</button>
		<caption id="caption7" class="list_cap03" style="left:345px; top:436px; width:110px; height:26px; text-align:center; ">삭제여부</caption>
		<bool id="bool4" navindex="17" checkvalue="Y,N" select.background-image="#check" ref="/root/formData/del_yn" style="left:460px; top:438px; width:26px; height:20px; background-image:#uncheck; "/>
		<bool id="bool5" checkvalue="Y,N" ref="/root/formData/gnr_advcs_yn" style="left:125px; top:514px; width:25px; height:20px; "/>
		<bool id="bool6" checkvalue="Y,N" ref="/root/formData/arow_advcs_yn" style="left:220px; top:515px; width:25px; height:20px; "/>
		<bool id="bool7" checkvalue="Y,N" ref="/root/formData/agn_yn" style="left:305px; top:515px; width:25px; height:20px; "/>
		<bool id="bool8" checkvalue="Y,N" ref="/root/formData/advt_bo_yn" style="left:375px; top:515px; width:25px; height:20px; "/>
		<bool id="bool9" checkvalue="Y,N" ref="/root/formData/bo_bof_yn" style="left:455px; top:515px; width:25px; height:20px; "/>
		<caption id="caption8" style="left:476px; top:515px; width:60px; height:20px; ">지사지국</caption>
		<caption id="caption9" style="left:396px; top:515px; width:50px; height:20px; ">광고지사</caption>
		<caption id="caption11" style="left:326px; top:515px; width:50px; height:20px; ">대행사</caption>
		<caption id="caption14" style="left:241px; top:515px; width:50px; height:20px; ">행광고주</caption>
		<caption id="caption18" style="left:146px; top:515px; width:62px; height:20px; ">일반광고주</caption>
		<button id="button5" class="btn04" crud="C" style="left:795px; top:40px; width:87px; height:21px; ">
			<caption>그룹사관리</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				window.load("../co/AD_CO_1400.xrw"
							  ,"modal"
							  ,""
							  ,"align:center;width:645;height:490;caption:hidden;"
							  );				
				]]>
			</script>
		</button>
		<caption id="cpt_elec_tax_comp_cd" class="list_cap03" style="left:345px; top:486px; width:110px; height:26px; font-size:8pt; text-align:center; ">전자세금계산서업체</caption>
		<caption id="cpt_email_id" class="list_cap03" style="left:645px; top:486px; width:110px; height:26px; text-align:center; ">E-MAIL</caption>
		<select1 id="cmb_elec_tax_comp_cd" ref="/root/formData/elec_tax_comp_cd" navindex="20" appearance="minimal" style="left:458px; top:490px; width:172px; height:18px; ">
			<choices>
				<itemset nodeset="/root/codeData/elec_tax_comp_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<input id="inp_email_id" ref="/root/formData/email_id" navindex="21" style="left:759px; top:490px; width:172px; height:18px; text-align:left; "/>
		<caption id="caption19" class="list_cap03" style="left:345px; top:411px; width:110px; height:26px; text-align:center; ">유형</caption>
		<select1 id="cmb_type_cd" ref="/root/formData/type_cd" navindex="15" appearance="minimal" style="left:458px; top:415px; width:172px; height:18px; ">
			<choices>
				<itemset nodeset="/root/codeData/type_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<bool id="bool10" checkvalue="Y,N" ref="/root/formData/nmd_agn_yn" style="left:534px; top:515px; width:25px; height:20px; "/>
		<caption id="caption27" style="left:555px; top:515px; width:95px; height:20px; ">뉴미디어 대행사</caption>
		<datagrid id="datagrid2" nodeset="/root/formData/gridData2/record" caption="일자^등록내용^등록자^일련번호" colsep="#" colwidth="100, 703, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="byrow" style="left:10px; top:667px; width:926px; height:88px; ">
			<col ref="insrt_dt" type="inputdate" format="yyyy-mm-dd"/>
			<col ref="dlco_info" type="input" style="text-align:left; vertical-align:middle; "/>
			<col ref="chrg_pers" type="output" style="text-align:center; vertical-align:middle; "/>
			<col ref="seq" visibility="hidden"/>
		</datagrid>
		<button id="button6" class="btn_grid03" crud="R" style="left:780px; top:650px; width:53px; height:17px; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var grid  = datagrid2;
					var rows  = grid.rows;
					var curdt = getCurrentDate();
					
					//alert(rows);
					if(rows > 1){
						grid.insertRow(1,"above");
						datagrid2.valueMatrix(1,1) = curdt;
					}else{
						grid.addRow();
						datagrid2.valueMatrix(1,1) = curdt;
					}
					grid.row 	= grid.rows;
					grid.col 	= 1;
					
					grid.refresh();
				]]>
			</script>
		</button>
		<button id="button7" class="btn_grid02" crud="R" style="left:892px; top:649px; width:43px; height:17px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var grid 		= 	datagrid2;
					var firstRow 	= 	grid.row;
					var lastRow  	= 	grid.selectedRow(grid.selectedRows-1);				
					
					for( var i=firstRow; i<=lastRow; i++ )
					{
						if( grid.rowStatus(i) == "1" )
						{
							grid.removeRow(i);
							i--;
						}
						else if( grid.rowStatus(i) == "4" )
						{
							grid.rowStatus(i) = "0";
						}
						else
						{
							grid.rowStatus(i) = "0";
						}
					}
				]]>
			</script>
		</button>
		<button id="button8" class="btn_grid03" crud="R" style="left:835px; top:650px; width:53px; height:17px; ">
			<caption>행삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var grid 		= datagrid2;
					var firstRow 	= grid.row;
					var lastRow  	= grid.selectedRow(grid.selectedRows-1);

					for( var i=firstRow; i<=lastRow; i++ )
					{
						grid.rowStatus(i) = "4";
					}
					grid.refresh();
				]]>
			</script>
		</button>
		<bool id="bool11" checkvalue="Y,N" ref="/root/formData/preng_yn" style="left:14px; top:646px; width:25px; height:20px; "/>
		<caption id="caption32" style="left:35px; top:647px; width:62px; height:20px; ">예약조회</caption>
	</xhtml:body>
</xhtml:html>
