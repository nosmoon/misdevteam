<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet_ad.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
						</comboSet>
						<pageInfo/>
					</initData>
					<reqData>
						<fwdData/>
						<searchData>
							<srch_yymm/>
							<dlco_no/>
							<dlco_nm/>
							<dlco_clsf/>
						</searchData>
						<reqForm>
						</reqForm>
						<multiUpdateData/>
					</reqData>
					<resData>
						<resForm>
						</resForm>
						<gridData>
							<curlist1>
								<record>
									<basi_dt/>
									<avg_amt/>
								</record>
							</curlist1>
							<curlist2>
								<record>
									<sun/>
									<mon/>
									<tue/>
									<wed/>
									<thr/>
									<fri/>
									<sat/>
								</record>
							</curlist2>
						</gridData>
					</resData>
					<resData2>
						<resForm>
							<prvmm_unrcp_amt/>
							<thmm_unrcp_amt/>
							<unrcp_tot_amt/>
							<un_repay_dhon_bal/>
							<mang_expt_ufth_bond_amt/>
							<busn_expt_ufth_bond_amt/>
							<mang_dr_stot/>
							<busn_dr_stot/>
							<mang_mortg_surp_amt/>
							<busn_mortg_surp_amt/>
							<mortg_amt/>
							<un_pay_fee/>
							<precpt_amt/>
							<acml_amt/>
							<etc_mortg_amt/>
							<dng_stot/>
							<recenote_tot_amt/>
							<mang_recenote_tot_amt/>
							<busn_recenote_tot_amt/>
							<avg_point/>
							<evlu_frdt/>
							<evlu_todt/>
							<sum_kiil/>
							<slcrg_pers/>
							<slcrg_pers_nm/>
							<mchrg_pers/>
							<mchrg_pers_nm/>
							<basi_dt/>
							<chg_dt_tm/>
							<chg_pers/>
						</resForm>
						<gridData>
							<record>
								<mang_chce_yn/>
								<busn_chce_yn/>
								<dhon_chce_yn/>
								<issu_pers_nm/>
								<mtry_dt/>
								<note_amt/>
								<now_note_stat_nm/>
								<note_no/>
								<seq/>
								<note_seq/>
								<bank_cd/>
							</record>
						</gridData>
					</resData2>
					<tempData>
						<keyData/>
					</tempData>
					<msgData/>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				
				var 	srch_yymm	=	model.property("srch_yymm");
				var	dlco_no		=	getSessionDlcoNo();
				var	dlco_nm		=	getSessionDlcoNm();
				var	dlco_clsf	=	getSessionDlcoClsf();
				
				if(srch_yymm == ""){
					srch_yymm	=	getCurrentMonth();
				}
				
				model.setValue("/root/reqData/searchData/srch_yymm", srch_yymm);
				model.setValue("/root/reqData/searchData/dlco_no", dlco_no);
				model.setValue("/root/reqData/searchData/dlco_nm", dlco_nm);
				model.setValue("/root/reqData/searchData/dlco_clsf", dlco_clsf);												
				
				setChrgInfo();
				
				model.refresh();
				
				inp_mang_dr_stot.attribute("background-color") = M_BGCOLOR;
				inp_busn_dr_stot.attribute("background-color") = M_BGCOLOR;
				inp_dng_stot.attribute("background-color") 	= P_BGCOLOR;
				
				]]>
			</script>
			<submission id="ad_bas_1951_l" action="/ad/bas/1951" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/curlist1"/>
			<submission id="ad_bas_1952_l" action="/ad/bas/1952" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/tempData" resultref="/root/resData/gridData/curlist2"/>
			<submission id="ad_bas_1953_s" action="/ad/bas/1953" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/tempData" resultref="/root/resData2"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
			
			var _loaded = false;
			
			function setDlcoInfo(dlco_no, dlco_nm){
				model.setValue("/root/reqData/searchData/dlco_no", dlco_no);
				model.setValue("/root/reqData/searchData/dlco_nm", dlco_nm);					
				inp_dlco_no.refresh();
				inp_dlco_nm.refresh();
			}
			function setMakePers(emp_no, emp_nm){
				model.setValue(_emp_no_ref, emp_no);
				model.setValue(_emp_nm_ref, emp_nm);				
				inp_make_pers.refresh();
				inp_make_pers_nm.refresh();				
			}
			
			function loadData(){
				
					
				
//				if(!_loaded){	
					clear();
					
					var dlco_clsf = getSessionDlcoClsf();
					var dlco_no   = getSessionDlcoNo();
					var dlco_nm   = getSessionDlcoNm();
					var srch_yymm = model.property("srch_yymm");
					
					if(srch_yymm == ""){
						srch_yymm	=	getCurrentMonth();
					}
					
					model.setValue("/root/reqData/searchData/dlco_clsf", dlco_clsf);					
					model.setValue("/root/reqData/searchData/dlco_no", dlco_no);
					model.setValue("/root/reqData/searchData/dlco_nm", dlco_nm);
					model.setValue("/root/reqData/searchData/srch_yymm", srch_yymm);
					
					model.send("ad_bas_1951_l");
					if(submit_completed()){						
						var srch_yymm = datagrid1.valueMatrix(1, datagrid1.colRef("basi_dt"));
						loadCalendar(srch_yymm);													
					}
//					_loaded = !_loaded;
//				}		
			}
			
			function clear(){
				model.removeNodeSet("/root/resData2");
			}
			
			var	_srch_yymm;
			
			function loadCalendar(srch_yymm){
				
				_srch_yymm	=	srch_yymm;
				
				makeNodeValue("/root/tempData/dlco_no", model.getValue("/root/reqData/searchData/dlco_no"));
				makeNodeValue("/root/tempData/srch_yymm", srch_yymm);
				
				model.send("ad_bas_1952_l");		
				if(submit_completed()){
					for(var i=datagrid2.fixedRows;i<datagrid2.rows;i++){
						for(var j=datagrid2.fixedCols;j<datagrid2.cols;j++){
							datagrid2.cellstyle("background-color", i, j, i, j) = "#FFFFFF";
							if(i%2 == 1){
								var dd = datagrid2.valueMatrix(i, j);
								if(dd != ""){
									if(j == datagrid2.colRef("sun")){
										datagrid2.cellstyle("background-color", i, j, i, j) = "#FFCC00";
									}else if(j == datagrid2.colRef("sat")){
										datagrid2.cellstyle("background-color", i, j, i, j) = "#CCFFFF";
									}else{
										datagrid2.cellstyle("background-color", i, j, i, j) = "#FFFFCC";
									}
								}
							}
						}
					}
					
					datagrid2.refresh();
				}				
			}
			function setSessionDlcoInfo(){
				
				var dlco_no 		=	model.getValue("/root/reqData/searchData/dlco_no");
				var	dlco_nm 		=	model.getValue("/root/reqData/searchData/dlco_nm");
				var dlco_clsf	=	model.getValue("/root/reqData/searchData/dlco_clsf");

				setSessionDlco(dlco_clsf, dlco_no, dlco_nm);
			}		
			
			function setChrgInfo(){
				
				modelSendNoMake("ad_co_9007_s", "/ad/common/9007", "/root/reqData/searchData", "/root/tempData");	
				if(submit_completed()){
					model.makeValue("/root/resData2/resForm/slcrg_pers"		, 	model.getValue("/root/tempData/slcrg_pers"));
					model.makeValue("/root/resData2/resForm/slcrg_pers_nm"	,	model.getValue("/root/tempData/slcrg_pers_nm"));
					model.makeValue("/root/resData2/resForm/mchrg_pers"		, 	model.getValue("/root/tempData/mchrg_pers"));
					model.makeValue("/root/resData2/resForm/mchrg_pers_nm"	, 	model.getValue("/root/tempData/mchrg_pers_nm"));
										
					setSessionDlcoInfo();
					
					model.refresh();
				}
			}		
				

			function setExDlcoInfo(dlco_clsf, dlco_no_ctrl, dlco_nm_ctrl){
				
				var	dlco_no	=	"";
				if(dlco_no_ctrl){
					dlco_no = dlco_no_ctrl.currentText;
				}

				var	dlco_nm	=	"";
				if(dlco_nm_ctrl){
					dlco_nm = dlco_nm_ctrl.currentText;
				}
				
				if(dlco_no != ""){
					dlco_no  = lpad(dlco_no, 8, "0");
					model.setValue(dlco_no_ctrl.attribute("ref"), dlco_no); 
					dlco_no_ctrl.refresh();
				}
				
				model.removeNode("/root/tempData/reqData");
				model.removeNode("/root/tempData/resData");
				makeNodeValue("/root/tempData/reqData/dlco_clsf", dlco_clsf);
				makeNodeValue("/root/tempData/reqData/dlco_no", dlco_no);
				makeNodeValue("/root/tempData/reqData/dlco_nm", dlco_nm);
				
				modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");
			}		
			
			function setDlcoResultInfo(){
						
				var dlco_no			=	model.getValue("/root/tempData/resData/dlco_no");
				var dlco_nm			=	model.getValue("/root/tempData/resData/dlco_nm");
				var slcrg_pers		=	model.getValue("/root/tempData/resData/slcrg_pers");
				var slcrg_pers_nm		=	model.getValue("/root/tempData/resData/slcrg_pers_nm");
				var mchrg_pers		=	model.getValue("/root/tempData/resData/mchrg_pers");
				var mchrg_pers_nm 	=	model.getValue("/root/tempData/resData/mchrg_pers_nm");
				var dlco_clsf		=	model.getValue("/root/tempData/resData/dlco_clsf");
					
				if(dlco_no	==	"TMRS"){
					showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText); 					
					return;
				}
				
				model.setValue("/root/reqData/searchData/dlco_no", dlco_no);
				model.setValue("/root/reqData/searchData/dlco_nm", dlco_nm);
				model.setValue("/root/reqData/searchData/dlco_clsf", dlco_clsf);


				setSessionDlco(dlco_clsf, dlco_no, dlco_nm);
				
				model.refresh();
				
			}
										
			]]>
		</script>
	</xhtml:head>
	<xhtml:body pagewidth="920" pageheight="660" guideline="1,5;2,10;2,40;1,913;2,660;1,550;1,555;" style="font-family:굴림; ">
		<caption id="caption26" class="list_cap02" style="left:255px; top:625px; width:291px; height:30px; font-size:10pt; "/>
		<caption id="caption15" class="list_cap02" style="left:5px; top:467px; width:541px; height:30px; font-size:10pt; "/>
		<caption id="caption25" class="list_cap02" style="left:255px; top:596px; width:291px; height:30px; font-size:10pt; "/>
		<caption id="caption74" class="list_cap02" style="left:5px; top:596px; width:327px; height:59px; font-size:10pt; "/>
		<caption id="caption17" class="list_cap02" style="left:5px; top:438px; width:541px; height:30px; font-size:10pt; "/>
		<caption id="caption39" class="list_cap02" style="left:5px; top:546px; width:541px; height:51px; font-size:10pt; "/>
		<caption id="caption27" class="list_cap02" style="left:5px; top:496px; width:541px; height:51px; font-size:10pt; "/>
		<caption id="caption5" class="list_cap02" style="left:5px; top:409px; width:541px; height:30px; font-size:10pt; "/>
		<caption id="caption53" class="list_cap02" style="left:5px; top:380px; width:541px; height:30px; font-size:10pt; "/>
		<caption id="caption4" class="list_cap02" style="left:5px; top:346px; width:541px; height:30px; font-size:10pt; "/>
		<caption id="caption12" class="list_cap02" style="left:5px; top:40px; width:910px; height:30px; font-size:10pt; "/>
		<caption id="caption6" tyle="left:15px; top:180px; width:940px; height:0px;" style="left:0px; top:10px; width:0px; height:0px; ">caption6</caption>
		<button id="button26" class="btn02" style="left:681px; top:10px; width:52px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if(validateReq()){
//					_loaded = false;
					loadData();
				}
				]]>
			</script>
		</button>
		<button id="button30" class="btn02" style="left:737px; top:10px; width:52px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.reset();
				]]>
			</script>
		</button>
		<button id="button31" class="btn03" style="left:793px; top:10px; width:65px; height:21px; ">
			<caption>화면인쇄</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				window.print();
				]]>
			</script>
		</button>
		<button id="button25" class="btn02" style="left:862px; top:10px; width:52px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[		
				parent.javaScript.windowClose();	
				]]>
			</script>
		</button>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/curlist1/record" caption="월^담보여유액(월평균)" colsep="^" colwidth="80, 130" defaultrows="13" explorerbar="sort" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" selectionmode="byrow" style="left:645px; top:78px; width:270px; height:262px; font-size:10pt; ">
			<col ref="basi_dt" format="yyyy-mm"/>
			<col ref="avg_amt" format="(-)#,###" style="text-align:right; word-wrap:none; "/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				if(!isDataRegion(datagrid1))	return;
				
				var srch_yymm = datagrid1.valueMatrix(datagrid1.row,datagrid1.colRef("basi_dt"));

				loadCalendar(srch_yymm);

					
				]]>
			</script>
		</datagrid>
		<input id="inp_dlco_no" ref="/root/reqData/searchData/dlco_no" class="req" navindex="2" autonext="false" format="99999999" caption="거래처" style="left:231px; top:45px; width:65px; height:20px; font-size:10pt; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
				
					setExDlcoInfo("1", inp_dlco_no, "");
					if(submit_completed()){
						setDlcoResultInfo();
					}
				
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){	

					setExDlcoInfo("1", inp_dlco_no, "");
					if(submit_completed()){
						setDlcoResultInfo();
					}				
				}
				]]>
			</script>
		</input>
		<input id="inp_dlco_nm" ref="/root/reqData/searchData/dlco_nm" class="req" navindex="3" imemode="hangul" inputtype="button" caption="거래처" style="left:301px; top:45px; width:160px; height:20px; font-size:10pt; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[

				var dlco_clsf = model.getValue("/root/reqData/searchData/dlco_clsf");
				if(dlco_clsf == "1"){
					showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText); 
				}else if(dlco_clsf == "2"){
					showAdvcsSearchPopup("", "", "Y", "", "", inp_dlco_nm.currentText); 
				}else if(dlco_clsf == "4"){
					showAdvcsSearchPopup("", "", "", "Y", "Y", inp_dlco_nm.currentText); 
				}
				setChrgInfo();
										
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode== "13"){		

					setExDlcoInfo("1", "", inp_dlco_nm);										
					if(submit_completed()){
						setDlcoResultInfo();
					}										
				}					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
		

					setExDlcoInfo("1", "", inp_dlco_nm);										
					if(submit_completed()){
						setDlcoResultInfo();
					}						
							
								
				]]>
			</script>
		</input>
		<caption id="caption1" class="list_cap01" style="left:156px; top:40px; width:70px; height:30px; font-size:10pt; vertical-align:middle; ">거래처</caption>
		<caption id="caption10" class="list_cap01" style="left:5px; top:40px; width:70px; height:30px; font-size:10pt; vertical-align:middle; ">조회년월</caption>
		<input id="input5" ref="/root/reqData/searchData/srch_yymm" class="req" navindex="1" format="yyyy-mm" caption="조회기간" style="left:78px; top:45px; width:70px; height:20px; font-size:10pt; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
//				_loaded = false;
				loadData();
				]]>
			</script>
		</input>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData/curlist2/record" autoresize="true" caption="일^월^화^수^목^금^토" colsep="#" colwidth="90, 90, 90, 90, 90, 90, 90" mergecellsfixedcols="byrowrec" mergecellsfixedrows="bycolrec" rowsep="|" selectionmode="free" style="left:4px; top:78px; width:632px; height:262px; font-size:10pt; ">
			<col ref="sun" format="(-)#,###" style="text-align:right; "/>
			<col ref="mon" format="(-)#,###" style="text-align:right; "/>
			<col ref="tue" format="(-)#,###" style="text-align:right; "/>
			<col ref="wed" format="(-)#,###" style="text-align:right; "/>
			<col ref="thr" format="(-)#,###" style="text-align:right; "/>
			<col ref="fri" format="(-)#,###" style="text-align:right; "/>
			<col ref="sat" format="(-)#,###" style="text-align:right; "/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[			
				if(!isDataRegion(datagrid2))	return;					
				
				var row = datagrid2.row;
				if(row % 2 == 0){
					row--;
				}
				
				var basi_dt		=	Number(datagrid2.valueMatrix(row, datagrid2.col));
				if(basi_dt == "")		return;
				
				basi_dt			=	_srch_yymm + "" + (basi_dt < 10 ? "0"+basi_dt : ""+basi_dt);		
				
				var dlco_no		=	model.getValue("/root/reqData/searchData/dlco_no");
				var dlco_clsf	=	model.getValue("/root/reqData/searchData/dlco_clsf");
				
				makeNodeValue("/root/tempData/basi_dt", basi_dt);	
				makeNodeValue("/root/tempData/dlco_clsf", dlco_clsf);
				makeNodeValue("/root/tempData/dlco_no", dlco_no);
				
				//model.removeNodeSet("/root/resData2");
				
				model.send("ad_bas_1953_s");
				
				if(submit_completed()){
					for(var i=datagrid3.fixedRows;i<datagrid3.rows;i++){
						
						datagrid3.isReadOnly(i, datagrid3.colRef("mang_chce_yn")) = true;
						datagrid3.isReadOnly(i, datagrid3.colRef("busn_chce_yn")) = true;
						datagrid3.isReadOnly(i, datagrid3.colRef("dhon_chce_yn")) = true;
								
						var mang_chce_yn 	= datagrid3.valueMatrix(i, datagrid3.colRef("mang_chce_yn"));
						var busn_chce_yn 	= datagrid3.valueMatrix(i, datagrid3.colRef("busn_chce_yn"));
						var dhon_chce_yn 	= datagrid3.valueMatrix(i, datagrid3.colRef("dhon_chce_yn"));
						
						datagrid3.rowStyle(i,"data","color") = "#000000"; 		
						
						if("Y" == mang_chce_yn &&  "Y" == busn_chce_yn  &&  "Y" == dhon_chce_yn){
							datagrid3.rowStyle(i,"data","background-color") = YY_BGCOLOR; //빨강
//							datagrid3.rowStyle(i,"data","color") = "#ff0000"; 		      //빨강
						}else if("Y" == mang_chce_yn &&  "Y" == busn_chce_yn  &&  "N" == dhon_chce_yn){
							datagrid3.rowStyle(i,"data","background-color") = YY_BGCOLOR; //빨강
//							datagrid3.rowStyle(i,"data","color") = "#000000";		      //검정
						}else if( "Y" == dhon_chce_yn &&  (  ("Y" == mang_chce_yn &&  "N" == busn_chce_yn) || ("N" == mang_chce_yn &&  "Y" == busn_chce_yn) ) ){
							datagrid3.rowStyle(i,"data","background-color") = YN_BGCOLOR; //파랑
//							datagrid3.rowStyle(i,"data","color") = "#ff0000"; 		     //빨강
						}else if( "N" == dhon_chce_yn &&  (  ("Y" == mang_chce_yn &&  "N" == busn_chce_yn) || ("N" == mang_chce_yn &&  "Y" == busn_chce_yn) ) ){
							datagrid3.rowStyle(i,"data","background-color") = YN_BGCOLOR; //파랑
//							datagrid3.rowStyle(i,"data","color") = "#000000"; 		     //검정
						}else if("N" == mang_chce_yn &&  "N" == busn_chce_yn &&  "Y" == dhon_chce_yn){
							datagrid3.rowStyle(i,"data","background-color") = "#ffffff";    //흰
//							datagrid3.rowStyle(i,"data","color") = "#ff0000";		      //빨강
						}else if("N" == mang_chce_yn &&  "N" == busn_chce_yn &&  "N" == dhon_chce_yn){
							datagrid3.rowStyle(i,"data","background-color") = "#ffffff";    //흰
//							datagrid3.rowStyle(i,"data","color") = "#000000";		      //검정
						}		
					}
					datagrid3.refresh();
					
					inp_mang_mortg_surp_amt.attribute("background-color")	=	"#FFFFFF";
					inp_busn_mortg_surp_amt.attribute("background-color")	=	"#FFFFFF";
					inp_sum_kiil.attribute("background-color") 			=	"#FFFFFF";
					inp_avg_point.attribute("background-color")			=	"#FFFFFF";
					
					//담보여유액 관리,영업 
					var mang_mortg_surp_amt = 0;
					var busn_mortg_surp_amt = 0;
					
					mang_mortg_surp_amt = Number(model.getValue("/root/resData2/resForm/mang_mortg_surp_amt"));
					busn_mortg_surp_amt = Number(model.getValue("/root/resData2/resForm/busn_mortg_surp_amt"));
					
					if(mang_mortg_surp_amt < 0){
						inp_mang_mortg_surp_amt.attribute("background-color") = M_BGCOLOR;//빨강
					}
					if(mang_mortg_surp_amt > 0){
						inp_mang_mortg_surp_amt.attribute("background-color") = P_BGCOLOR;//파랑 
					}
					
					if(busn_mortg_surp_amt < 0){
						inp_busn_mortg_surp_amt.attribute("background-color") = M_BGCOLOR;//빨강
					}
					if(busn_mortg_surp_amt > 0){
						inp_busn_mortg_surp_amt.attribute("background-color") = P_BGCOLOR;//파랑
					}		

										//평균기일
					var avg_point = 0;
					
					avg_point = Number(model.getValue("/root/resData2/resForm/avg_point")); 
				
					if(avg_point < 0){
						inp_sum_kiil.attribute("background-color") 	= M_BGCOLOR;//빨강
						inp_avg_point.attribute("background-color") 	= M_BGCOLOR;//빨강
					}
					if(avg_point > 0){
						inp_sum_kiil.attribute("background-color") 	= P_BGCOLOR;//파랑
						inp_avg_point.attribute("background-color") 	= P_BGCOLOR;//파랑
					}					
				}
				
				model.property("basi_dt") = basi_dt;

				]]>
			</script>
		</datagrid>
		<select1 id="rb_dlco_clsf" ref="/root/reqData/searchData/dlco_clsf" navindex="1" appearance="full" cols="3" rows="1" overflow="visible" style="left:468px; top:46px; width:155px; height:17px; font-size:10pt; background-color:transparent; border-style:none; ">
			<choices>
				<item>
					<label>광고주</label>
					<value>1</value>
				</item>
				<item>
					<label>대행사</label>
					<value>2</value>
				</item>
				<item>
					<label>지사</label>
					<value>4</value>
				</item>
			</choices>
		</select1>
		<output id="output4" ref="/root/resData2/resForm/mchrg_pers_nm" navindex="6" appearance="output" style="left:243px; top:352px; width:60px; height:20px; font-size:10pt; text-align:center; "/>
		<input id="inp_precpt_amt" ref="/root/resData2/resForm/precpt_amt" format="(-)#,###" appearance="input" style="left:399px; top:443px; width:95px; height:20px; font-size:10pt; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
				showTotal();
				]]>
			</script>
		</input>
		<output id="output7" ref="/root/resData2/resForm/slcrg_pers_nm" navindex="5" appearance="output" style="left:78px; top:352px; width:60px; height:20px; font-size:10pt; text-align:center; "/>
		<caption id="caption51" class="list_cap03" style="left:289px; top:495px; width:105px; height:51px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding:5; ">기타담보액</caption>
		<caption id="caption40" class="list_cap03" style="left:5px; top:546px; width:160px; height:51px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding:5; ">계</caption>
		<caption id="caption62" class="list_cap03" style="left:5px; top:596px; width:160px; height:59px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding:5; ">담보여유액</caption>
		<caption id="caption52" class="list_cap03" style="left:289px; top:545px; width:105px; height:52px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding:5; ">계</caption>
		<caption id="caption41" style="left:498px; top:414px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<caption id="caption63" class="list_cap03" style="left:289px; top:596px; width:105px; height:30px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding:5; ">
			<![CDATA[평균기일]]>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseover">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseout">
				<![CDATA[
				]]>
			</script>
		</caption>
		<caption id="caption64" style="left:460px; top:602px; width:20px; height:20px; font-size:10pt; text-align:center; ">일</caption>
		<output id="output24" ref="/root/resData2/resForm/evlu_todt" format="yyyy-mm" appearance="output" style="left:478px; top:630px; width:60px; height:20px; font-size:10pt; text-align:center; "/>
		<caption id="caption75" class="list_cap03" style="left:289px; top:625px; width:105px; height:30px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding:5; ">
			<![CDATA[평가기간]]>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseover">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseout">
				<![CDATA[
				]]>
			</script>
		</caption>
		<caption id="caption42" class="list_cap03" style="left:289px; top:380px; width:105px; height:30px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding:5; ">
			<![CDATA[담보액]]>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseover">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseout">
				<![CDATA[
				]]>
			</script>
		</caption>
		<input id="inp_mang_dr_stot" ref="/root/resData2/resForm/mang_dr_stot" format="(-)#,###" appearance="input" style="left:170px; top:551px; width:90px; height:20px; font-size:10pt; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
				showTotal();
				]]>
			</script>
		</input>
		<caption id="caption20" style="left:264px; top:472px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<caption id="caption76" style="left:460px; top:631px; width:20px; height:20px; font-size:10pt; text-align:center; vertical-align:middle; ">~</caption>
		<output id="output25" ref="/root/resData2/resForm/evlu_frdt" format="yyyy-mm" appearance="output" style="left:399px; top:630px; width:60px; height:20px; font-size:10pt; text-align:center; "/>
		<caption id="caption32" style="left:264px; top:501px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<caption id="caption3" class="list_cap01" style="left:5px; top:346px; width:68px; height:30px; font-size:10pt; font-weight:bold; vertical-align:middle; ">영업담당</caption>
		<output id="inp_avg_point" ref="/root/resData2/resForm/avg_point" format="(-)#,###%" appearance="output" style="left:478px; top:601px; width:60px; height:20px; font-size:10pt; text-align:right; "/>
		<caption id="caption55" style="left:498px; top:553px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<caption id="caption44" style="left:498px; top:384px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<caption id="caption33" style="left:264px; top:525px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<input id="inp_un_repay_dhon_bal" ref="/root/resData2/resForm/un_repay_dhon_bal" format="(-)#,###" appearance="input" style="left:170px; top:472px; width:90px; height:20px; font-size:10pt; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
				showTotal();
				]]>
			</script>
		</input>
		<caption id="caption66" style="left:264px; top:604px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<caption id="caption22" class="list_cap01" style="left:169px; top:346px; width:68px; height:30px; font-size:10pt; font-weight:bold; vertical-align:middle; ">관리담당</caption>
		<caption id="caption23" class="list_cap01" style="left:330px; top:346px; width:63px; height:30px; font-size:10pt; font-weight:bold; vertical-align:middle; ">기준일</caption>
		<caption id="caption45" style="left:498px; top:442px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<input id="inp_prvmm_unrcp_amt" ref="/root/resData2/resForm/prvmm_unrcp_amt" format="(-)#,###" appearance="input" style="left:170px; top:384px; width:90px; height:20px; font-size:10pt; text-align:right; "/>
		<input id="output17" ref="/root/resData2/resForm/etc_mortg_amt" format="(-)#,###" appearance="input" style="left:399px; top:502px; width:95px; height:20px; font-size:10pt; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
				showTotal();
				]]>
			</script>
		</input>
		<caption id="caption35" style="left:264px; top:551px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<input id="inp_mang_expt_ufth_bond_amt" ref="/root/resData2/resForm/mang_expt_ufth_bond_amt" format="(-)#,###" appearance="input" style="left:170px; top:501px; width:90px; height:20px; font-size:10pt; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
				showTotal();				
				]]>
			</script>
		</input>
		<caption id="caption68" style="left:264px; top:630px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<caption id="caption47" class="list_cap03" style="left:289px; top:438px; width:105px; height:30px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding:5; ">
			<![CDATA[선수금]]>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				]]>
			</script>
			<script type="javascript" ev:event="onmouseover">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseout">
				<![CDATA[
				]]>
			</script>
		</caption>
		<caption id="caption36" style="left:264px; top:575px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<input id="inp_unrcp_tot_amt" ref="/root/resData2/resForm/unrcp_tot_amt" format="(-)#,###" appearance="input" style="left:170px; top:443px; width:90px; height:20px; font-size:10pt; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				showTotal();
				]]>
			</script>
		</input>
		<caption id="caption14" class="list_cap03" style="left:5px; top:438px; width:160px; height:30px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding:5; ">
			<![CDATA[미수총액]]>
			<script type="javascript" ev:event="onclick">
				<![CDATA[

				]]>
			</script>
			<script type="javascript" ev:event="onmouseover">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseout">
				<![CDATA[
				]]>
			</script>
		</caption>
		<output id="inp_sum_kiil" ref="/root/resData2/resForm/sum_kiil" appearance="output" style="left:399px; top:601px; width:60px; height:20px; font-size:10pt; text-align:right; "/>
		<input id="inp_dng_stot" ref="/root/resData2/resForm/dng_stot" format="(-)#,###" appearance="input" style="left:399px; top:552px; width:95px; height:20px; font-size:10pt; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
				showTotal();
				]]>
			</script>
		</input>
		<caption id="caption37" class="list_cap03" style="left:289px; top:409px; width:105px; height:30px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding:5; ">
			<![CDATA[미지급대행료]]>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseover">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseout">
				<![CDATA[
				]]>
			</script>
		</caption>
		<caption id="caption49" style="left:498px; top:503px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<input id="inp_un_pay_fee" ref="/root/resData2/resForm/un_pay_fee" format="(-)#,###" appearance="input" style="left:399px; top:414px; width:95px; height:20px; font-size:10pt; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
				showTotal();
				]]>
			</script>
		</input>
		<input id="inp_mortg_amt" ref="/root/resData2/resForm/mortg_amt" format="(-)#,###" appearance="input" style="left:399px; top:384px; width:95px; height:20px; font-size:10pt; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
				showTotal();
				]]>
			</script>
		</input>
		<caption id="caption16" style="left:264px; top:444px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<caption id="caption8" class="list_cap03" style="left:5px; top:380px; width:160px; height:59px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding:5; ">
			<![CDATA[미수액]]>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseover">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseout">
				<![CDATA[				
				]]>
			</script>
		</caption>
		<input id="inp_basi_dt" ref="/root/resData2/resForm/basi_dt" navindex="4" editable="false" format="yyyy-mm-dd" caption="기준일자" appearance="input" style="left:396px; top:351px; width:103px; height:20px; font-size:10pt; "/>
		<input id="inp_busn_dr_stot" ref="/root/resData2/resForm/busn_dr_stot" format="(-)#,###" appearance="input" style="left:170px; top:573px; width:90px; height:20px; font-size:10pt; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
				showTotal();
				]]>
			</script>
		</input>
		<input id="inp_mang_mortg_surp_amt" ref="/root/resData2/resForm/mang_mortg_surp_amt" format="(-)#,###" appearance="input" style="left:170px; top:603px; width:90px; height:20px; font-size:10pt; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[	
				var mang_mortg_surp_amt = Number(model.getValue("/root/resData/resForm/mang_mortg_surp_amt"));
				
				if(mang_mortg_surp_amt < 0){
					inp_mang_mortg_surp_amt.attribute("background-color") 	= M_BGCOLOR;//빨강
				}else{
					 inp_mang_mortg_surp_amt.attribute("background-color") = P_BGCOLOR;//파랑 
				}				
				]]>
			</script>
		</input>
		<input id="inp_busn_mortg_surp_amt" ref="/root/resData2/resForm/busn_mortg_surp_amt" format="(-)#,###" appearance="input" style="left:170px; top:629px; width:90px; height:20px; font-size:10pt; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var busn_mortg_surp_amt = Number(model.getValue("/root/resData/resForm/busn_mortg_surp_amt"));
				
				if(busn_mortg_surp_amt < 0){
					inp_busn_mortg_surp_amt.attribute("background-color") 	= M_BGCOLOR;//빨강
				}else{
			 		inp_busn_mortg_surp_amt.attribute("background-color") 	= P_BGCOLOR;//파랑 
				}	
				]]>
			</script>
		</input>
		<caption id="caption29" class="list_cap03" style="left:5px; top:496px; width:160px; height:51px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding:5; ">
			<![CDATA[예상부실채권액]]>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseover">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseout">
				<![CDATA[
				]]>
			</script>
		</caption>
		<caption id="caption9" style="left:264px; top:384px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<caption id="caption19" class="list_cap03" style="left:5px; top:467px; width:160px; height:30px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding:5; ">
			<![CDATA[미변제부도잔액]]>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseover">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseout">
				<![CDATA[
				]]>
			</script>
		</caption>
		<input id="inp_busn_expt_ufth_bond_amt" ref="/root/resData2/resForm/busn_expt_ufth_bond_amt" format="(-)#,###" appearance="input" style="left:170px; top:523px; width:90px; height:20px; font-size:10pt; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
				showTotal();
				]]>
			</script>
		</input>
		<input id="input1" ref="/root/resData2/resForm/acml_amt" format="(-)#,###" appearance="input" style="left:399px; top:472px; width:95px; height:20px; font-size:10pt; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
				showTotal();
				]]>
			</script>
		</input>
		<caption id="caption2" style="left:498px; top:470px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<datagrid id="datagrid3" nodeset="/root/resData2/gridData/record" scroll="both" caption="관^영^부^발행자^만기일^금액^어음상태^어음번호^SEQ^NOTE_STAT_CD^NOTE_SEQ^BANK_CD" colsep="#" colwidth="25, 25, 25, 100, 80, 85, 55, 60, 100, 100, 100, 100" dataheight="25" explorerbar="sort" extendlastcol="scroll" frozencols="4" mergecellsfixedrows="bycolrec" rowheight="25" rowsep="|" style="left:555px; top:371px; width:360px; height:266px; font-size:10pt; ">
			<col checkvalue="Y,N" ref="mang_chce_yn" type="checkbox"/>
			<col checkvalue="Y,N" ref="busn_chce_yn" type="checkbox"/>
			<col checkvalue="Y,N" ref="dhon_chce_yn" type="checkbox"/>
			<col ref="issu_pers_nm" style="text-align:left; word-wrap:none; "/>
			<col ref="mtry_dt" format="yyyy-mm-dd"/>
			<col ref="note_amt" format="#,###" style="text-align:right; "/>
			<col ref="now_note_stat_nm"/>
			<col ref="note_no"/>
			<col ref="seq" visibility="hidden"/>
			<col ref="note_seq" visibility="hidden"/>
			<col ref="bank_cd" visibility="hidden"/>
			<col ref="bank_cd" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[

				var dataIndex = getSelectedRecordIndex(datagrid2);
				var note_amt = Number(model.getValue("/root/resData/gridData/record["+dataIndex+"]/note_amt"));				
				
				if(datagrid2.col == datagrid2.colRef("mang_chce_yn")){
					var mang_expt_ufth_bond_amt = Number(model.getValue("/root/resData/resForm/mang_expt_ufth_bond_amt"));
					mang_expt_ufth_bond_amt += note_amt;					
					model.setValue("/root/resData/resForm/mang_expt_ufth_bond_amt", mang_expt_ufth_bond_amt);
					inp_mang_expt_ufth_bond_amt.refresh();
					
				}else if(datagrid2.col == datagrid2.colRef("busn_chce_yn")){
					var busn_expt_ufth_bond_amt = Number(model.getValue("/root/resData/resForm/busn_expt_ufth_bond_amt"));
					busn_expt_ufth_bond_amt += note_amt;					
					model.setValue("/root/resData/resForm/busn_expt_ufth_bond_amt", busn_expt_ufth_bond_amt);
					inp_busn_expt_ufth_bond_amt.refresh();
				}				
				showTotal();
				
				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[
				var dataIndex = getSelectedRecordIndex(datagrid2);
				var note_amt = Number(model.getValue("/root/resData/gridData/record["+dataIndex+"]/note_amt"));				
				
				if(datagrid2.col == datagrid2.colRef("mang_chce_yn")){
					var mang_expt_ufth_bond_amt = Number(model.getValue("/root/resData/resForm/mang_expt_ufth_bond_amt"));
					mang_expt_ufth_bond_amt -= note_amt;					
					model.setValue("/root/resData/resForm/mang_expt_ufth_bond_amt", mang_expt_ufth_bond_amt);
					inp_mang_expt_ufth_bond_amt.refresh();
					
				}else if(datagrid2.col == datagrid2.colRef("busn_chce_yn")){
					var busn_expt_ufth_bond_amt = Number(model.getValue("/root/resData/resForm/busn_expt_ufth_bond_amt"));
					busn_expt_ufth_bond_amt -= note_amt;					
					model.setValue("/root/resData/resForm/busn_expt_ufth_bond_amt", busn_expt_ufth_bond_amt);
					inp_busn_expt_ufth_bond_amt.refresh();
				}				
				showTotal();
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var dataIndex = getSelectedRecordIndex(datagrid2);
				


				]]>
			</script>
		</datagrid>
		<caption id="caption87" class="list_cap" style="left:696px; top:349px; width:87px; height:17px; font-size:10pt; ">받은어음총액</caption>
		<caption id="subtitle2" class="tit02" style="left:555px; top:347px; width:77px; height:20px; font-size:10pt; ">어음내역</caption>
		<output id="output27" ref="/root/resData2/resForm/recenote_tot_amt" format="#,###" appearance="output" style="left:780px; top:347px; width:134px; height:18px; font-size:10pt; text-align:right; "/>
		<output id="output30" ref="/root/resData2/resForm/mang_recenote_tot_amt" appearance="output" style="left:608px; top:639px; width:125px; height:18px; font-size:10pt; text-align:right; "/>
		<output id="output34" ref="/root/resData2/resForm/busn_recenote_tot_amt" appearance="output" style="left:789px; top:639px; width:125px; height:18px; font-size:10pt; text-align:right; "/>
		<caption id="caption7" class="tit02" style="left:556px; top:639px; width:47px; height:20px; font-size:10pt; ">관리</caption>
		<caption id="caption11" class="tit02" style="left:738px; top:639px; width:47px; height:20px; font-size:10pt; ">영업</caption>
		<caption id="caption13" class="list_cap03" style="left:289px; top:467px; width:105px; height:30px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding:5; ">
			<![CDATA[적립금]]>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				]]>
			</script>
			<script type="javascript" ev:event="onmouseover">
				<![CDATA[
				]]>
			</script>
			<script type="javascript" ev:event="onmouseout">
				<![CDATA[
				]]>
			</script>
		</caption>
		<input id="input2" ref="/root/resData2/resForm/thmm_unrcp_amt" format="(-)#,###" appearance="input" style="left:170px; top:413px; width:90px; height:20px; font-size:10pt; text-align:right; "/>
		<caption id="caption21" style="left:264px; top:413px; width:20px; height:20px; font-size:10pt; ">원</caption>
		<caption id="caption72" class="tab" style="left:129px; top:599px; width:34px; height:30px; font-size:10pt; font-weight:bold; color:#ff0000; vertical-align:middle; ">관리</caption>
		<caption id="caption30" class="tab" style="left:129px; top:494px; width:34px; height:30px; font-size:10pt; font-weight:bold; color:#ff0000; vertical-align:middle; ">관리</caption>
		<caption id="caption31" class="tab" style="left:129px; top:520px; width:34px; height:30px; font-size:10pt; font-weight:bold; color:#0000ff; vertical-align:middle; ">영업</caption>
		<caption id="caption65" class="tab" style="left:129px; top:625px; width:34px; height:30px; font-size:10pt; font-weight:bold; color:#0000ff; vertical-align:middle; ">영업</caption>
		<caption id="caption34" class="tab" style="left:129px; top:570px; width:34px; height:30px; font-size:10pt; font-weight:bold; color:#0000ff; vertical-align:middle; ">영업</caption>
		<caption id="caption24" class="tab" style="left:132px; top:409px; width:35px; height:30px; font-size:10pt; font-weight:bold; vertical-align:middle; ">당월</caption>
		<caption id="caption28" class="tab" style="left:129px; top:547px; width:34px; height:30px; font-size:10pt; font-weight:bold; color:#ff0000; vertical-align:middle; ">관리</caption>
		<caption id="caption18" class="tab" style="left:132px; top:381px; width:35px; height:30px; font-size:10pt; font-weight:bold; vertical-align:middle; ">전월</caption>
	</xhtml:body>
</xhtml:html>
