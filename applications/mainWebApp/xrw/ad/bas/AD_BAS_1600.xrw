<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet_ad.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<pageInfo/>
						<comboSet>
						</comboSet>
					</initData>
					<reqData>
						<fwdData/>
						<searchData>
							<srch_yymm/>
							<dlco_clsf>24</dlco_clsf>
						</searchData>
						<reqForm>
						</reqForm>
						<multiUpdateData/>
						<popup>
							<basi_dt/>
						</popup>
					</reqData>
					<resData>
						<resForm>
							<bonddebt>
								<dlco_clsf/>
								<dlco_no/>
								<dlco_nm/>
								<slcrg_pers/>
								<slcrg_pers_nm/>
								<mchrg_pers/>
								<mchrg_pers_nm/>
								<basi_dt/>
								<unrcp_tot_amt/>
								<un_repay_dhon_bal/>
								<mang_expt_ufth_bond_amt/>
								<busn_expt_ufth_bond_amt/>
								<mortg_amt/>
								<un_pay_fee/>
								<precpt_acml_amt/>
								<etc_mortg_amt/>
								<mang_dr_stot/>
								<busn_dr_stot/>
								<dng_stot/>
								<recenote_tot_amt/>
								<busn_recenote_tot_amt/>
								<mang_recenote_tot_amt/>
								<mang_mortg_surp_amt/>
								<busn_mortg_surp_amt/>
								<avg_point/>
								<evlu_frdt/>
								<evlu_todt/>
								<sum_kiil/>
								<curlist3>
									<record>
										<mang_chce_yn/>
										<busn_chce_yn/>
										<dhon_chce_yn/>
										<issu_pers/>
										<mtry_dt/>
										<amt/>
										<note_clsf_nm/>
										<note_stat/>
										<note_no/>
									</record>
								</curlist3>
							</bonddebt>
							<diary>
								<diary_titl/>
								<make_dt/>
								<make_pers/>
								<dlco_nm/>
								<diary_cont/>
								<opn/>
								<curlist>
									<record>
										<make_dt/>
										<dlco_nm/>
										<make_pers_nm/>
										<diary_titl/>
										<dlco_no/>
										<diary_cont/>
									</record>
								</curlist>
							</diary>
						</resForm>
						<gridData>
							<curlist1>
								<record>
									<dlco_nm/>
									<basi_dt/>
									<mang_mortg_surp_amt/>
									<busn_mortg_surp_amt/>
									<diary_titl/>
									<mchrg_pers_nm/>
									<slcrg_pers_nm/>
									<make_dt/>
									<dlco_no/>
									<dlco_clsf/>
									<make_pers/>
									<make_pers_nm/>
								</record>
							</curlist1>
							<curlist2>
								<record>
									<dlco_nm/>
									<amt_avg/>
									<amt_1/>
									<amt_2/>
									<amt_3/>
									<amt_4/>
									<amt_5/>
									<amt_6/>
									<dlco_clsf/>
									<dlco_no/>
								</record>
							</curlist2>
						</gridData>
					</resData>
					<tempData>
						<keyData/>
					</tempData>
					<msgData/>
					<popup>
						<reqData>
							<basi_dt/>
							<multiUpdateData/>
						</reqData>
						<resData>
							<gridData>
								<record>
									<checked/>
									<dlco_nm/>
									<pre_basi_dt/>
									<next_basi_dt/>
									<dlco_no/>
								</record>
							</gridData>
							<all_cnt/>
							<un_cnt/>
							<sel_cnt/>
						</resData>
					</popup>
					<resData2>
						<gridData>
							<curlist1>
								<record>
									<basi_dt/>
									<avg_amt/>
								</record>
							</curlist1>
							<curlist2>
								<record>
									<sun/>
									<mon/>
									<tue/>
									<wed/>
									<thr/>
									<fri/>
									<sat/>
								</record>
							</curlist2>
						</gridData>
					</resData2>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					//model.send("ad_bas_1600_m");
					//초기값 세팅
					//model.setValue("/root/reqData/searchData/dlco_clsf/item[0]",model.getValue("root/tempData/xx_dlco_clsf_001"));					
					
					model.setValue("/root/reqData/searchData/srch_yymm", getCurrentMonth());
					model.setValue("/root/popup/reqData/basi_dt", getCurrentDate());
					model.refresh();
					
					switch1.selectedIndex = 0;
					switch2.selectedIndex = 0;
					
					dg_main.attribute("focuscolor") = "transparent";
					
					IP_MANG_DR_STOT.attribute("background-color") 	= 	M_BGCOLOR;
					IP_BUSN_DR_STOT.attribute("background-color")	=	M_BGCOLOR;
					OP_DNG_STOT.attribute("background-color")		=	P_BGCOLOR;
					
					loadData();
				]]>
			</script>
			<!--submission id="ad_bas_1600_m" action="/ad/bas/1600" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/-->
			<submission id="ad_bas_1610_l" action="/ad/bas/1610" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/curlist1"/>
			<submission id="ad_bas_1611_l" action="/ad/bas/1611" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/curlist2"/>
			<submission id="ad_bas_1612_l" action="/ad/bas/1612" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/popup/reqData" resultref="/root/popup/resData"/>
			<submission id="ad_bas_1613_a" action="/ad/bas/1613" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/popup/reqData" resultref="/root/msgData"/>
			<submission id="ad_bas_1615_s" action="/ad/bas/1615" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/tempData" resultref="/root/resData/resForm/diary"/>
			<submission id="ad_bas_1616_s" action="/ad/bas/1616" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/tempData" resultref="/root/resData/resForm/bonddebt"/>
			<submission id="ad_bas_1617_l" action="/ad/bas/1617" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/tempData/searchData" resultref="/root/resData2/gridData/curlist1"/>
			<submission id="ad_bas_1618_l" action="/ad/bas/1618" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/tempData/searchData" resultref="/root/resData2/gridData/curlist2"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
				//default case3 : 채권채무상세
				var	_case = "case3";
			    	var _selected_dlco_clsf = "";
				var _selected_dlco_no = "";
				var _selected_dlco_nm = "";
				var _selected_srch_yymm = "";
				
				function RefreshInfo(){
					OP_SYSTEM.value = _selected_dlco_nm + "-" + _selected_srch_yymm;
				}
				
				function strip(src_str, str) {
					var temp = '';
					for( var i = 0; i < src_str.length; i++ ){
						if( src_str.charAt(i) ==  str ){
							continue;
						} 
						else{
							temp += src_str.charAt(i);
						}
				 	}
				  	return	temp;
				}
				
				// 상세화면 전환 - mdi
			    	function loadDetail(){
			    		viewer("mainFrame").window.javaScript.onLoadExMDIPage("AD_BAS_1601");
	//		    		viewer("mainFrame").window.javaScript.onLoadPage2("AD_BAS_1601");
	/*
					window.load("./AD_BAS_1601.xrw"
							  ,"mdichild"
							  ,""
							  ,"caption:hidden;left:0px;top:0px;width:982;height:770;"
							  ,"/root/initData/pageInfo"
							  ,"/root/initData/pageInfo"  
							  );
	*/						  
			    	}
				
				function loadData(){
					group1.visible = false;					
					if( validateReq() ){
						// 채권채무
						if( switch1.selectedIndex==0 ){	
							// 1. 그리드 초기화
							for( var i=dg_main.fixedRows; i<dg_main.rows; i++ ){
								dg_main.rowstyle( i, "data", "background-color" ) 	= "#FFFFFF";
								dg_main.cellstyle( "font-weight", i, dg_main.colRef("diary_titl"), i, dg_main.colRef("diary_titl") ) = "";
							}
							
							// 2. 목록조회
							model.send("ad_bas_1610_l");
							
							// 3. 상세목록 조회
							if( submit_completed() ){
								var dlco_no	=	dg_main.valueMatrix(1, dg_main.colRef("dlco_no"));
								var make_dt	=	dg_main.valueMatrix(1, dg_main.colRef("make_dt"));
								if( dlco_no != "" && make_dt != "" ){
									makeNodeValue("/root/tempData/dlco_no", dlco_no);
									makeNodeValue("/root/tempData/make_dt", make_dt);
									model.send("ad_bas_1615_s");
								}							
							}
							
							// 4. 최근등록글(3일전 까지) 제목은 BOLD체로 
							for( var i=dg_main.fixedRows; i<dg_main.rows; i++ ){
								//dg_main.rowstyle( i, "data", "background-color" ) 	= "#FFFFFF";
								//CIISComm.js
								if( dateAdd("d", -3, getCurrentDate()) <=  model.getValue("/root/resData/gridData/curlist1/record["+i+"]/make_dt") ){
									dg_main.cellstyle("font-weight", i, dg_main.colRef("diary_titl"), i, dg_main.colRef("diary_titl")) = "bold";
								}
							}
						}
						// 평균
						else{							
							model.send("ad_bas_1611_l");
							if( submit_completed() ){
								var caption = "DLCO_NO^DLCO_CLSF^거래처명^담보여유액(연평균)^";
								var srch_yymm  = model.getValue("/root/reqData/searchData/srch_yymm");
								var start_yymm = dateAdd("m", 0, srch_yymm +"01");
								
								// 1.픽스로우 설정 - 12개월
								for( var i=0; i<12; i++ ){
									var yymm = dateAdd("m", -i, start_yymm);
									var yyyy = yymm.substring(0,4);
									var mm   = yymm.substring(4,6);
									caption += (yyyy +"."+mm);
									caption += "^";
								}
								dg_sub.caption = caption;
								var dlco_no = dg_sub.valueMatrix(1,dg_sub.colRef("dlco_no"));								
								
								// 리스트 조회
								dg_sub.row= 1;
								var dlco_clsf	= 	dg_sub.valueMatrix(dg_sub.row, dg_sub.colRef("dlco_clsf"));
								var dlco_no	=	dg_sub.valueMatrix(dg_sub.row, dg_sub.colRef("dlco_no"));
								var dlco_nm	=	dg_sub.valueMatrix(dg_sub.row, dg_sub.colRef("dlco_nm"));								
								loadDataList(dlco_clsf, dlco_no, dlco_nm, srch_yymm);
							}	
						}
					}
				}
				
				function loadDataList(in_dlco_clsf, in_dlco_no, in_dlco_nm, in_srch_yymm){
					if( in_dlco_clsf == "" || in_dlco_no == "" || in_dlco_nm == "" || in_srch_yymm == "" )	return;
					makeNodeValue("/root/tempData/searchData/dlco_no", in_dlco_no);
					makeNodeValue("/root/tempData/searchData/srch_yymm", in_srch_yymm);	
					//model.removeNodeset("/root/resData2/gridData/curlist2");
					model.send("ad_bas_1617_l");					
					if( submit_completed() ){
						_selected_dlco_clsf 		= in_dlco_clsf;
						_selected_dlco_no 		= in_dlco_no;
						_selected_dlco_nm 		= in_dlco_nm;
						datagrid2.row = 1;
						loadCalendar(in_srch_yymm);
					}										
				}
				// 달력그리드
				function loadCalendar(in_srch_yymm){
					makeNodeValue("/root/tempData/searchData/dlco_no", _selected_dlco_no);
					makeNodeValue("/root/tempData/searchData/srch_yymm", in_srch_yymm);
					// 달력그리드
					model.send("ad_bas_1618_l");
					if( submit_completed() ){
						// 요일색 표시
						for( var i=datagrid3.fixedRows;i<datagrid3.rows;i++ ){
							for( var j=datagrid3.fixedCols;j<datagrid3.cols;j++ ){
								datagrid3.cellstyle( "background-color", i, j, i, j ) = "#FFFFFF";
								if( i%2 == 1 ){
									var dd = datagrid3.valueMatrix(i, j);
									if( dd != "" ){
										if( j == datagrid3.colRef("sun") ){
											datagrid3.cellstyle("background-color", i, j, i, j) = "#FFCC00";
										}
										else if( j == datagrid3.colRef("sat") ){
											datagrid3.cellstyle("background-color", i, j, i, j) = "#CCFFFF";
										}
										else{
											datagrid3.cellstyle("background-color", i, j, i, j) = "#FFFFCC";
										}
									}
								}
							}
						}
						datagrid3.refresh();						
						_selected_srch_yymm 	= in_srch_yymm;
						RefreshInfo();
					}				
				}
				
				function showTotal(){
					var dng_stot	= Number(model.getValue("/root/resData/resForm/bonddebt/dng_stot"));
					var mang_dr_stot		 = Number(model.getValue("/root/resData/resForm/bonddebt/mang_dr_stot"));
					var busn_dr_stot		 = 	Number(model.getValue("/root/resData/resForm/bonddebt/busn_dr_stot"));
					var mang_mortg_surp_amt = Number(model.getValue("/root/resData/resForm/bonddebt/mang_mortg_surp_amt"));
					var busn_mortg_surp_amt = Number(model.getValue("/root/resData/resForm/bonddebt/busn_mortg_surp_amt"));
					
					if(mang_mortg_surp_amt < 0){
						out_mang_mortg_surp_amt.attribute("background-color") = M_BGCOLOR;//빨강
					}
					else{
						out_mang_mortg_surp_amt.attribute("background-color") = P_BGCOLOR;//파랑 
					}
					
					if(busn_mortg_surp_amt < 0){
						out_busn_mortg_surp_amt.attribute("background-color") = M_BGCOLOR;//빨강
					}
					else{
						out_busn_mortg_surp_amt.attribute("background-color") = P_BGCOLOR;//파랑
					}		
					
					//평균기일
					var avg_point = Number(model.getValue("/root/resData/resForm/avg_point")); 
					if(avg_point < 0){
						out_sum_kiil.attribute("background-color") 	= M_BGCOLOR;//빨강
						out_avg_point.attribute("background-color") 	= M_BGCOLOR;//빨강
					}
					else{
						out_sum_kiil.attribute("background-color") 	= P_BGCOLOR;//파랑
						out_avg_point.attribute("background-color") 	= P_BGCOLOR;//파랑
					}			
				}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="756" guideline="1,936;2,105;1,10;2,40;" style="font-family:굴림; font-size:72pt; ">
		<switch id="switch1" class="gro_sel" style="left:10px; top:98px; width:926px; height:290px; ">
			<case id="case1" selected="true">
				<datagrid id="dg_main" nodeset="/root/resData/gridData/curlist1/record" caption="거래처명^기준일^담보여유액(관리)^담보여유액(영업)^일지제목^관리담당^영업담당^MAKE_DT^DLCO_NO^DLCO_CLSF^MAKE_PERS^MAKE_PERS_NM" colsep="^" colwidth="130, 90, 120, 120, 291, 60, 60, 100, 100, 100, 100, 100" dataheight="25" defaultrows="0" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowheight="25" rowsep="|" style="left:5px; top:5px; width:914px; height:276px; font-size:11pt; ">
					<col ref="dlco_nm" type="output" style="text-align:left; "/>
					<col ref="basi_dt" type="output" format="yyyy-mm-dd"/>
					<col ref="mang_mortg_surp_amt" type="output" format="(-)#,###" style="text-align:right; "/>
					<col ref="busn_mortg_surp_amt" type="output" format="(-)#,###" style="text-align:right; "/>
					<col ref="diary_titl" type="output" style="text-align:left; word-wrap:none; "/>
					<col ref="mchrg_pers_nm" type="output"/>
					<col ref="slcrg_pers_nm" type="output"/>
					<col ref="make_dt" visibility="hidden"/>
					<col ref="dlco_no" visibility="hidden"/>
					<col ref="dlco_clsf" visibility="hidden"/>
					<col ref="make_pers" visibility="hidden"/>
					<col ref="make_pers_nm" visibility="hidden"/>
					<script type="javascript" ev:event="ondblclick">
						<![CDATA[
							if( !isDataRegion(dg_main) ) 	return;
							if( dg_main.col >= dg_main.colRef("diary_titl") ){
								group1.visible = false;
								var dataIndex = getSelectedRecordIndex(dg_main);
								var dlco_no 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("dlco_no"));
								var dlco_nm 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("dlco_nm"));
								var make_dt 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("make_dt"));
								var make_pers 	= dg_main.valueMatrix(dg_main.row, dg_main.colRef("make_pers"));
								var make_pers_nm 	= dg_main.valueMatrix(dg_main.row, dg_main.colRef("make_pers_nm"));
								var basi_dt 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("basi_dt"));
								var dlco_clsf 	= dg_main.valueMatrix(dg_main.row, dg_main.colRef("dlco_clsf"));
								
								setSessionDlco(dlco_clsf, dlco_no, dlco_nm);
								
								model.property("make_dt")			= make_dt;
								model.property("basi_dt") 		= basi_dt;
								model.property("make_pers") 		= make_pers;
								model.property("make_pers_nm")	= make_pers_nm;
								
								model.property("cur_tab")   	= "2";
								
								loadDetail();
							}
							else{
								group1.visible = false;
	
								var dlco_no 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("dlco_no"));
								var dlco_nm 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("dlco_nm"));
								var make_dt 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("make_dt"));
								var make_pers 	= dg_main.valueMatrix(dg_main.row, dg_main.colRef("make_pers"));
								var make_pers_nm 	= dg_main.valueMatrix(dg_main.row, dg_main.colRef("make_pers_nm"));
								var basi_dt 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("basi_dt"));
								var dlco_clsf 	= dg_main.valueMatrix(dg_main.row, dg_main.colRef("dlco_clsf"));
								
								setSessionDlco(dlco_clsf, dlco_no, dlco_nm);
								
								model.property("make_dt") 		= make_dt;
								model.property("make_pers") 		= make_pers;
								model.property("make_pers_nm")	= make_pers_nm;
								model.property("basi_dt") 			= basi_dt;
								model.property("cur_tab")   		= "1";					
								
								loadDetail();
							}					
						]]>
					</script>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							if( !isDataRegion(dg_main) )	return;
							
							// 1. 그리드 색상초기화
							for( var i=dg_main.fixedRows; i<dg_main.rows; i++ ){
								dg_main.rowstyle(i, "data", "background-color") = "#FFFFFF";
							}
							
							// 2. 선택 로우 색상 변경
							dg_main.rowstyle( dg_main.row, "data", "background-color" ) = "#EEEEEE";
							
							// 3. 담보여유액에 따른 색상 변경							
							var mang_mortg_surp_amt	 =	Number(dg_main.valueMatrix(dg_main.row, dg_main.colRef("mang_mortg_surp_amt")));
							var busn_mortg_surp_amt	 =	Number(dg_main.valueMatrix(dg_main.row, dg_main.colRef("busn_mortg_surp_amt")));

							if( mang_mortg_surp_amt < 0 ){
								dg_main.cellstyle("background-color", dg_main.row, dg_main.colRef("mang_mortg_surp_amt")) = M_BGCOLOR;
							}
							else{
								dg_main.cellstyle("background-color", dg_main.row, dg_main.colRef("mang_mortg_surp_amt")) = P_BGCOLOR;
							}
							
							if( busn_mortg_surp_amt < 0 ){
								dg_main.cellstyle("background-color", dg_main.row, dg_main.colRef("busn_mortg_surp_amt")) = M_BGCOLOR;
							}
							else{
								dg_main.cellstyle("background-color", dg_main.row, dg_main.colRef("busn_mortg_surp_amt")) = P_BGCOLOR;
							}
							
							// 4. 선택된 컬럼에 따라서 상세목록 선택
							if( dg_main.col == dg_main.colRef("diary_titl") ){
								/*
								var dataIndex = getSelectedRecordIndex(dg_main);
								var dlco_no	 = model.getValue("/root/resData/gridData/curlist1/record["+dataIndex+"]/dlco_no");
								var make_dt	 = model.getValue("/root/resData/gridData/curlist1/record["+dataIndex+"]/make_dt");
								*/
								var dlco_no	=	dg_main.valueMatrix(dg_main.row, dg_main.colRef("dlco_no"));
								var make_dt	=	dg_main.valueMatrix(dg_main.row, dg_main.colRef("make_dt"));
								if( dlco_no != "" && make_dt != "" ){
									makeNodeValue("/root/tempData/dlco_no", dlco_no);
									makeNodeValue("/root/tempData/make_dt", make_dt);
									model.send("ad_bas_1615_s");
								}
								
								model.toggle("case3");
								_case	=	"case3"
							}
							else if( dg_main.col == dg_main.colRef("mang_mortg_surp_amt") || dg_main.col== dg_main.colRef("busn_mortg_surp_amt") ){
								/*
								var dataIndex = getSelectedRecordIndex(dg_main);
								var dlco_no	 = model.getValue("/root/resData/gridData/curlist1/record["+dataIndex+"]/dlco_no");
								var basi_dt	 = model.getValue("/root/resData/gridData/curlist1/record["+dataIndex+"]/basi_dt");
								*/					
								var dlco_no	=	dg_main.valueMatrix(dg_main.row, dg_main.colRef("dlco_no"));
								var basi_dt	=	dg_main.valueMatrix(dg_main.row, dg_main.colRef("basi_dt"));
								if( dlco_no != "" && make_dt != "" ){
									makeNodeValue("/root/tempData/dlco_no", dlco_no);
									makeNodeValue("/root/tempData/basi_dt", basi_dt);
									model.send("ad_bas_1616_s");
									if( submit_completed() ){
										for( var i=dg_note.fixedRows;i<dg_note.rows;i++ ){
											dg_note.rowstyle(i, "data", "background-color") = "#FFFFFF";
											var mang_chce_yn	=	dg_note.valueMatrix(i, dg_note.colRef("mang_chce_yn"));
											var busn_chce_yn	=	dg_note.valueMatrix(i, dg_note.colRef("busn_chce_yn"));
											var dhon_chce_yn	=	dg_note.valueMatrix(i, dg_note.colRef("dhon_chce_yn"));
											
											if(mang_chce_yn == "Y" && busn_chce_yn == "Y"){
												dg_note.rowstyle(i, "data", "background-color") = YY_BGCOLOR;
											}
											if(mang_chce_yn == "Y" && busn_chce_yn == "N"){
												dg_note.rowstyle(i, "data", "background-color") = YN_BGCOLOR;
											}
										}
										showTotal();
									}
								}						
								model.toggle("case4");
								_case	=	"case4"
							}
							datagrid1.refresh();
						]]>
					</script>
				</datagrid>
			</case>
			<case id="case2">
				<datagrid id="dg_sub" nodeset="/root/resData/gridData/curlist2/record" caption="DLCO_NO^DLCO_CLSF^거래처명^담보여유액(연평균)" colsep="^" colwidth="100, 100, 150, 120, 100, 100, 100, 100, 100, 100" dataheight="25" defaultrows="0" explorerbar="sort" frozencols="2" mergecellsfixedrows="bycolrec" rowheader="seq" rowheight="25" rowsep="|" selectionmode="byrow" style="left:5px; top:5px; width:914px; height:276px; font-size:11pt; ">
					<col ref="dlco_no" visibility="hidden"/>
					<col ref="dlco_clsf" visibility="hidden"/>
					<col ref="dlco_nm" type="output" style="left:20px; top:20px; width:130px; height:50px; text-align:left; "/>
					<col ref="amt_avg" type="output" format="(-)#,###" style="left:150px; top:20px; width:156px; height:5px; text-align:right; "/>
					<col ref="amt_1" format="(-)#,###" style="text-align:right; "/>
					<col ref="amt_2" format="(-)#,###" style="text-align:right; "/>
					<col ref="amt_3" format="(-)#,###" style="text-align:right; "/>
					<col ref="amt_4" format="(-)#,###" style="text-align:right; "/>
					<col ref="amt_5" format="(-)#,###" style="text-align:right; "/>
					<col ref="amt_6" format="(-)#,###" style="text-align:right; "/>
					<script type="javascript" ev:event="ondblclick">
						<![CDATA[
							// 채권채무현황상세 >> 연평균현황 화면이동
							if( !isDataRegion(dg_sub) )		return;
							if( dg_sub.col == dg_sub.colRef("dlco_nm") ){
								var	basi_dt		=	getCurrentMonth();
								if( dg_sub.col >= dg_sub.colRef("amt_1") ){
									basi_dt	=	dg_sub.valueMatrix(0, dg_sub.col);
								}
								
								var	dlco_no	=	dg_sub.valueMatrix(dg_sub.row, dg_sub.colRef("dlco_no"));
								var	dlco_nm	=	dg_sub.valueMatrix(dg_sub.row, dg_sub.colRef("dlco_nm"));
								var	dlco_clsf	=	dg_sub.valueMatrix(dg_sub.row, dg_sub.colRef("dlco_clsf"));
								
								setSessionDlco(dlco_clsf,dlco_no,dlco_nm);
								
								model.property("srch_yymm") 	= strip(basi_dt, ".");
								model.property("cur_tab")   	= "4";						
								
								loadDetail();
							}
						]]>
					</script>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							if( !isDataRegion(dg_sub) )	return;
							if( dg_sub.col != dg_sub.colRef("dlco_nm") ){
								var dlco_clsf		= dg_sub.valueMatrix(dg_sub.row, dg_sub.colRef("dlco_clsf"));
								var dlco_no 		= dg_sub.valueMatrix(dg_sub.row, dg_sub.colRef("dlco_no"));
								var dlco_nm		= dg_sub.valueMatrix(dg_sub.row, dg_sub.colRef("dlco_nm"));
								var srch_yymm  	= model.getValue("/root/reqData/searchData/srch_yymm");
								loadDataList( dlco_clsf, dlco_no, dlco_nm, srch_yymm );
							}					
						]]>
					</script>
				</datagrid>
			</case>
		</switch>
		<switch id="switch2" class="gro_sel" style="left:10px; top:396px; width:926px; height:355px; ">
			<case id="case3" selected="true">
				<caption id="caption24" class="list_cap02" style="left:492px; top:5px; width:429px; height:30px; font-size:10pt; "/>
				<caption id="caption43" class="list_cap02" style="left:5px; top:39px; width:479px; height:310px; font-size:10pt; "/>
				<caption id="caption31" ref="/root/resData/resForm/resDIARY/DIARY_TITL" class="list_cap02" style="left:5px; top:5px; width:479px; height:30px; font-size:10pt; "/>
				<caption id="caption2" class="list_cap03" style="left:5px; top:39px; width:35px; height:310px; font-size:10pt; font-weight:bold; ">
					<![CDATA[내

용]]>
				</caption>
				<caption id="caption5" class="list_cap03" style="left:492px; top:5px; width:60px; height:30px; font-size:10pt; font-weight:bold; ">작성일자</caption>
				<caption id="caption7" class="list_cap03" style="left:647px; top:5px; width:60px; height:30px; font-size:10pt; font-weight:bold; ">작성자</caption>
				<caption id="caption8" class="list_cap03" style="left:767px; top:5px; width:60px; height:30px; font-size:10pt; font-weight:bold; ">거래처명</caption>
				<caption id="caption44" class="list_cap03" style="left:5px; top:5px; width:35px; height:30px; font-size:10pt; font-weight:bold; ">제목</caption>
				<output id="OP_JEMOG" ref="/root/resData/resForm/diary/diary_titl" appearance="output" style="left:43px; top:10px; width:425px; height:20px; font-size:11pt; text-align:left; "/>
				<output id="OP_CYMD" ref="/root/resData/resForm/diary/make_dt" format="yyyy-mm-dd" appearance="output" style="left:555px; top:10px; width:90px; height:20px; font-size:10pt; "/>
				<output id="OP_CUSTNM" ref="/root/resData/resForm/diary/dlco_nm" appearance="output" style="left:830px; top:10px; width:88px; height:20px; font-size:10pt; "/>
				<output id="OP_MGTNM" ref="/root/resData/resForm/diary/make_pers" appearance="output" style="left:710px; top:10px; width:52px; height:20px; font-size:10pt; "/>
				<textarea id="TA_DOCU" ref="/root/resData/resForm/diary/diary_cont" scroll="vertical" editable="false" style="left:43px; top:43px; width:438px; height:300px; font-size:11pt; text-align:left; vertical-align:top; line-spacing:5; padding:5; background-color:#fefedd; "/>
				<datagrid id="datagrid4" nodeset="/root/resData/resForm/diary/curlist/record" caption="일 자^거래처명^작성자^일지제목^dlco_no^DIARY_CONT" colsep="^" colwidth="80, 85, 50, 100, 100, 100" dataheight="26" mergecellsfixedrows="bycolrec" rowheader="seq" rowheight="25" rowsep="|" style="left:492px; top:39px; width:429px; height:310px; font-size:10pt; ">
					<col ref="make_dt" format="yyyy-mm-dd"/>
					<col ref="dlco_nm" style="text-align:left; word-wrap:none; "/>
					<col ref="make_pers_nm"/>
					<col ref="diary_titl" style="text-align:left; word-wrap:none; "/>
					<col ref="dlco_no" visibility="hidden"/>
					<col ref="diary_cont" visibility="hidden"/>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							if( !isDataRegion(datagrid4) )	return;							
							var diary_cont	= datagrid4.valueMatrix(datagrid4.row, datagrid4.colRef("diary_cont"));							
							model.setValue("/root/resData/resForm/diary/diary_cont", diary_cont);
							TA_DOCU.refresh();
						]]>
					</script>
				</datagrid>
			</case>
			<case id="case4">
				<caption id="caption35" class="list_cap02" style="left:339px; top:290px; width:173px; height:30px; "/>
				<caption id="caption74" class="list_cap02" style="left:5px; top:290px; width:535px; height:59px; "/>
				<caption id="caption38" class="list_cap02" style="left:5px; top:118px; width:535px; height:34px; font-size:10pt; "/>
				<caption id="caption15" class="list_cap02" style="left:5px; top:223px; width:535px; height:62px; font-size:10pt; "/>
				<caption id="caption50" class="list_cap02" style="left:5px; top:156px; width:535px; height:62px; font-size:10pt; "/>
				<caption id="caption27" class="list_cap02" style="left:5px; top:39px; width:535px; height:34px; font-size:10pt; "/>
				<caption id="caption23" class="list_cap02" style="left:545px; top:5px; width:377px; height:345px; font-size:10pt; "/>
				<caption id="caption32" class="list_cap" style="left:692px; top:12px; width:106px; height:17px; font-size:10pt; text-align:right; ">받은어음총액</caption>
				<caption id="caption34" style="left:901px; top:12px; width:15px; height:17px; font-size:10pt; ">원</caption>
				<caption id="caption33" class="list_cap02" style="left:5px; top:6px; width:535px; height:34px; font-size:10pt; "/>
				<caption id="caption39" class="list_cap03" style="left:397px; top:6px; width:75px; height:34px; font-size:10pt; font-weight:bold; text-align:center; vertical-align:middle; padding-left:0; ">영업담당</caption>
				<caption id="caption14" class="list_cap03" style="left:397px; top:39px; width:75px; height:34px; font-size:10pt; font-weight:bold; text-align:center; vertical-align:middle; padding-left:0; ">관리담당</caption>
				<caption id="caption52" class="list_cap03" style="left:5px; top:39px; width:154px; height:34px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding-left:5; ">기준일</caption>
				<caption id="caption9" class="list_cap02" style="left:5px; top:79px; width:535px; height:34px; font-size:10pt; "/>
				<caption id="caption54" style="left:515px; top:87px; width:20px; height:20px; font-size:10pt; ">원</caption>
				<caption id="caption55" class="list_cap03" style="left:285px; top:79px; width:110px; height:34px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding-left:5; ">담보액</caption>
				<caption id="caption10" style="left:515px; top:126px; width:20px; height:20px; font-size:10pt; ">원</caption>
				<caption id="caption28" class="list_cap03" style="left:285px; top:118px; width:110px; height:34px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding-left:5; ">미지급대행료</caption>
				<caption id="caption56" style="left:515px; top:162px; width:20px; height:20px; font-size:10pt; ">원</caption>
				<caption id="caption58" class="list_cap03" style="left:285px; top:156px; width:110px; height:62px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding-left:5; ">
					<![CDATA[선수금+적립금

기타적립금]]>
				</caption>
				<caption id="caption59" style="left:515px; top:192px; width:20px; height:20px; font-size:10pt; ">원</caption>
				<caption id="caption63" class="list_cap03" style="left:285px; top:223px; width:110px; height:62px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding-left:5; ">계</caption>
				<caption id="caption64" style="left:515px; top:230px; width:20px; height:20px; font-size:10pt; ">원</caption>
				<caption id="caption29" class="list_cap03" style="left:5px; top:79px; width:154px; height:34px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding-left:5; ">미수총액</caption>
				<caption id="caption36" style="left:264px; top:85px; width:20px; height:20px; font-size:10pt; ">원</caption>
				<caption id="caption40" style="left:264px; top:124px; width:20px; height:20px; font-size:10pt; ">원</caption>
				<caption id="caption41" class="list_cap03" style="left:5px; top:118px; width:154px; height:34px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding-left:5; ">미변제부도잔액</caption>
				<caption id="caption42" style="left:264px; top:162px; width:20px; height:20px; font-size:10pt; ">원</caption>
				<caption id="caption48" class="list_cap03" style="left:5px; top:156px; width:154px; height:62px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding-left:5; ">예상부실채권액</caption>
				<caption id="caption66" style="left:264px; top:194px; width:20px; height:20px; font-size:10pt; ">원</caption>
				<caption id="caption16" style="left:265px; top:230px; width:20px; height:20px; font-size:10pt; ">원</caption>
				<caption id="caption18" style="left:265px; top:259px; width:20px; height:20px; font-size:10pt; ">원</caption>
				<caption id="caption20" class="list_cap03" style="left:5px; top:223px; width:154px; height:62px; font-size:10pt; font-weight:bold; text-align:left; vertical-align:middle; padding-left:5; ">계</caption>
				<caption id="subtitle" class="tit02" style="left:550px; top:11px; width:75px; height:20px; font-size:10pt; ">어음내역</caption>
				<caption id="caption21" class="tit02" style="left:555px; top:326px; width:45px; height:20px; font-size:10pt; ">관리</caption>
				<caption id="caption22" class="tit02" style="left:738px; top:326px; width:45px; height:20px; font-size:10pt; ">영업</caption>
				<output id="OP_EoeumListTotal" ref="/root/resData/resForm/bonddebt/recenote_tot_amt" format="#,###" appearance="output" style="left:807px; top:11px; width:109px; height:18px; font-size:10pt; text-align:right; "/>
				<datagrid id="dg_note" nodeset="/root/resData/resForm/bonddebt/curlist3/record" overflow="scroll" scroll="both" caption="관^영^부^발행자^만기일^금액^어음구분^어음상태^어음번호" colsep="#" colwidth="30, 30, 30, 92, 80, 90, 100, 60, 70" dataheight="25" extendlastcol="scroll" frozencols="4" mergecellsfixedrows="bycolrec" rowsep="|" style="left:550px; top:35px; width:370px; height:288px; font-size:10pt; ">
					<col checkvalue="Y,N" disabled="true" ref="mang_chce_yn" type="checkbox"/>
					<col checkvalue="Y,N" disabled="true" ref="busn_chce_yn" type="checkbox"/>
					<col checkvalue="Y,N" disabled="true" ref="dhon_chce_yn" type="checkbox"/>
					<col ref="issu_pers" style="text-align:left; word-wrap:none; "/>
					<col ref="mtry_dt" format="yyyy-mm-dd"/>
					<col ref="amt" format="(-)#,###" style="text-align:right; "/>
					<col ref="note_clsf_nm" style="text-align:left; word-wrap:none; "/>
					<col ref="note_stat" style="text-align:center; word-wrap:none; "/>
					<col ref="note_no" style="text-align:center; word-wrap:none; "/>
				</datagrid>
				<select1 id="opt_dlco_clsf" ref="/root/resData/resForm/bonddebt/dlco_clsf" appearance="full" cols="3" rows="1" overflow="visible" style="left:9px; top:14px; width:160px; height:17px; font-size:10pt; background-color:transparent; border-style:none; ">
					<choices>
						<item>
							<label>대행사</label>
							<value>2</value>
						</item>
						<item>
							<label>지사</label>
							<value>4</value>
						</item>
						<item>
							<label>광고주</label>
							<value>1</value>
						</item>
					</choices>
				</select1>
				<output id="OP_BASI_DT" ref="/root/resData/resForm/bonddebt/basi_dt" format="yyyy-mm-dd" inputtype="date" appearance="output" style="left:163px; top:47px; width:95px; height:20px; font-size:10pt; text-align:center; "/>
				<output id="OP_UNRCP_AMT" ref="/root/resData/resForm/bonddebt/unrcp_tot_amt" format="(-)#,###" appearance="output" style="left:163px; top:86px; width:95px; height:20px; font-size:10pt; text-align:right; "/>
				<output id="OP_UN_REPAY_DHON_BAL" ref="/root/resData/resForm/bonddebt/un_repay_dhon_bal" format="(-)#,###" appearance="output" style="left:163px; top:125px; width:95px; height:20px; font-size:10pt; text-align:right; "/>
				<output id="OP_MANG_EXPT_UFTH_BOND_AMT" ref="/root/resData/resForm/bonddebt/mang_expt_ufth_bond_amt" format="(-)#,###" appearance="output" style="left:163px; top:163px; width:95px; height:20px; font-size:10pt; text-align:right; "/>
				<output id="OP_BUSN_EXPT_UFTH_BOND_AMT" ref="/root/resData/resForm/bonddebt/busn_expt_ufth_bond_amt" format="(-)#,###" appearance="output" style="left:163px; top:192px; width:95px; height:20px; font-size:10pt; text-align:right; "/>
				<output id="IP_MANG_DR_STOT" ref="/root/resData/resForm/bonddebt/mang_dr_stot" format="(-)#,###" editable="false" appearance="output" style="left:164px; top:230px; width:95px; height:20px; font-size:10pt; text-align:right; background-color:#FFCACA; "/>
				<output id="IP_BUSN_DR_STOT" ref="/root/resData/resForm/bonddebt/busn_dr_stot" format="(-)#,###" editable="false" appearance="output" style="left:164px; top:259px; width:95px; height:20px; font-size:10pt; text-align:right; background-color:#FFCACA; "/>
				<output id="OP_MORTG_AMT" ref="/root/resData/resForm/bonddebt/mortg_amt" format="(-)#,###" appearance="output" style="left:400px; top:86px; width:110px; height:20px; font-size:10pt; text-align:right; "/>
				<output id="OP_UN_PAY_FEE" ref="/root/resData/resForm/bonddebt/un_pay_fee" format="(-)#,###" appearance="output" style="left:400px; top:126px; width:110px; height:20px; font-size:10pt; text-align:right; "/>
				<output id="OP_PRECPT_ACML_AMT" ref="/root/resData/resForm/bonddebt/precpt_acml_amt" format="(-)#,###" appearance="output" style="left:400px; top:162px; width:110px; height:20px; font-size:10pt; text-align:right; "/>
				<output id="OP_ETC_MORTG_AMT" ref="/root/resData/resForm/bonddebt/etc_mortg_amt" format="(-)#,###" appearance="output" style="left:400px; top:192px; width:110px; height:20px; font-size:10pt; text-align:right; "/>
				<output id="OP_DNG_STOT" ref="/root/resData/resForm/bonddebt/dng_stot" format="(-)#,###" editable="false" appearance="output" style="left:400px; top:230px; width:110px; height:20px; font-size:10pt; text-align:right; background-color:#A4A4FF; "/>
				<output id="OP_MANG_ChkTotal" ref="/root/resData/resForm/bonddebt/mang_recenote_tot_amt" appearance="output" style="left:605px; top:325px; width:125px; height:20px; font-size:10pt; text-align:right; "/>
				<output id="OP_BUSN_ChkTotal" ref="/root/resData/resForm/bonddebt/busn_recenote_tot_amt" appearance="output" style="left:788px; top:325px; width:125px; height:20px; font-size:10pt; text-align:right; "/>
				<output id="output1" ref="/root/resData/resForm/bonddebt/dlco_nm" inputtype="button" appearance="output" style="left:246px; top:13px; width:145px; height:20px; font-size:10pt; "/>
				<output id="output2" ref="/root/resData/resForm/bonddebt/dlco_no" appearance="output" style="left:177px; top:13px; width:65px; height:20px; font-size:10pt; text-align:center; "/>
				<output id="output3" ref="/root/resData/resForm/bonddebt/slcrg_pers_nm" appearance="output" style="left:477px; top:14px; width:55px; height:20px; font-size:10pt; text-align:center; "/>
				<output id="output4" ref="/root/resData/resForm/bonddebt/mchrg_pers_nm" appearance="output" style="left:477px; top:47px; width:55px; height:20px; font-size:10pt; text-align:center; "/>
				<caption id="caption65" class="tab" style="left:121px; top:162px; width:34px; height:23px; font-size:10pt; font-weight:bold; color:#ff0000; vertical-align:middle; ">관리</caption>
				<caption id="caption67" class="tab" style="left:121px; top:191px; width:34px; height:23px; font-size:10pt; font-weight:bold; color:#0000ff; vertical-align:middle; ">영업</caption>
				<caption id="caption17" class="tab" style="left:120px; top:228px; width:34px; height:23px; font-size:10pt; font-weight:bold; color:#ff0000; vertical-align:middle; ">관리</caption>
				<caption id="caption19" class="tab" style="left:120px; top:255px; width:34px; height:23px; font-size:10pt; font-weight:bold; color:#0000ff; vertical-align:middle; ">영업</caption>
				<caption id="caption62" class="list_cap03" style="left:5px; top:290px; width:154px; height:59px; font-weight:bold; text-align:left; vertical-align:middle; padding:5; padding-left:5; padding-top:5; ">담보여유액</caption>
				<caption id="caption30" style="left:264px; top:297px; width:20px; height:20px; font-size:10pt; ">원</caption>
				<caption id="caption68" style="left:264px; top:324px; width:20px; height:20px; font-size:10pt; ">원</caption>
				<output id="out_mang_mortg_surp_amt" ref="/root/resData/resForm/bonddebt/mang_mortg_surp_amt" format="(-)#,###" appearance="output" style="left:164px; top:297px; width:95px; height:20px; font-size:10pt; text-align:right; ">
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[	
							var mang_mortg_surp_amt = Number(model.getValue("/root/resData/resForm/mang_mortg_surp_amt"));
							if(mang_mortg_surp_amt < 0){
								out_mang_mortg_surp_amt.attribute("background-color") 	= M_BGCOLOR;//빨강
							}
							else{
								 out_mang_mortg_surp_amt.attribute("background-color") 	= P_BGCOLOR;//파랑 
							}				
						]]>
					</script>
				</output>
				<output id="out_busn_mortg_surp_amt" ref="/root/resData/resForm/bonddebt/busn_mortg_surp_amt" format="(-)#,###" appearance="output" style="left:164px; top:322px; width:95px; height:20px; font-size:10pt; text-align:right; ">
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
							var busn_mortg_surp_amt = Number(model.getValue("/root/resData/resForm/busn_mortg_surp_amt"));
							if(busn_mortg_surp_amt < 0){
								out_busn_mortg_surp_amt.attribute("background-color") 	= 	M_BGCOLOR;//빨강
							}
							else{
								 out_busn_mortg_surp_amt.attribute("background-color") 	=	P_BGCOLOR;//파랑 
							}	
						]]>
					</script>
				</output>
				<caption id="caption3" class="tab" style="left:120px; top:294px; width:34px; height:26px; font-size:10pt; font-weight:bold; color:#ff0000; vertical-align:middle; ">관리</caption>
				<caption id="caption26" class="tab" style="left:120px; top:320px; width:34px; height:26px; font-size:10pt; font-weight:bold; color:#0000FF; vertical-align:middle; ">영업</caption>
				<caption id="caption4" class="list_cap03" style="left:285px; top:290px; width:110px; height:30px; font-weight:bold; text-align:left; vertical-align:middle; padding-left:5; ">
					<![CDATA[평균기일]]>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							if(validateReq()){
								model.property("DEP_1800_DLCO_CLSF") = model.getValue("/root/reqData/searchData/dlco_clsf");
								model.property("DEP_1800_DLCO_NO")   = model.getValue("/root/reqData/searchData/dlco_no");
								model.property("DEP_1800_DLCO_NM")   = model.getValue("/root/reqData/searchData/dlco_nm");
				      				model.property("DEP_1800_BASI_DT")   = model.getValue("/root/resData/resForm/basi_dt");
								
								viewer("mainFrame").window.javaScript.onLoadPage2("AD_DEP_1800");	
							}
						]]>
					</script>
					<script type="javascript" ev:event="onmouseover">
						<![CDATA[
							caption4.attribute("cursor") = "hand";
							caption4.attribute("color") = "#0000FF";		
						]]>
					</script>
					<script type="javascript" ev:event="onmouseout">
						<![CDATA[
							caption4.attribute("cursor") = "";
							caption4.attribute("color") = "#000000";		
						]]>
					</script>
				</caption>
				<output id="output24" ref="/root/resData/resForm/bonddebt/evlu_todt" format="yyyy-mm" appearance="output" style="left:476px; top:324px; width:60px; height:20px; font-size:10pt; font-style:10pt; text-align:center; "/>
				<caption id="caption13" style="left:459px; top:295px; width:15px; height:20px; font-size:10pt; font-style:10pt; text-align:center; ">일</caption>
				<caption id="caption75" class="list_cap03" style="left:285px; top:319px; width:110px; height:30px; font-weight:bold; text-align:left; vertical-align:middle; padding-left:5; ">
					<![CDATA[평가기간]]>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							if(validateReq()){
								makeNodeValue("/root/tempData/hndl_clsf",model.getValue("/root/reqData/searchData/dlco_clsf"));
								makeNodeValue("/root/tempData/dlco_no",model.getValue("/root/reqData/searchData/dlco_no"));
								makeNodeValue("/root/tempData/dlco_nm",model.getValue("/root/reqData/searchData/dlco_nm"));
								var basi_dt = model.getValue("/root/reqData/searchData/basi_dt");
								var todt    = basi_dt.substring(0,6);
								var frdt    = dateAdd("m",-1,basi_dt);
								makeNodeValue("/root/tempData/frdt",todt.substring(0,6));
								makeNodeValue("/root/tempData/todt",todt.substring(0,6));
								
								window.load("../dep/AD_DEP_1801.xrw"
											,"modal"
									               ,""
								 	 		, "align:center; width:705; height:485; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
								  	  		,"/root/tempData"
								   	  		,"/root/reqData/searchData");	
							}	
						]]>
					</script>
					<script type="javascript" ev:event="onmouseover">
						<![CDATA[
							caption75.attribute("cursor") = "hand";
							caption75.attribute("color") = "#0000FF";		
						]]>
					</script>
					<script type="javascript" ev:event="onmouseout">
						<![CDATA[
							caption75.attribute("cursor") = "";
							caption75.attribute("color") = "#000000";		
						]]>
					</script>
				</caption>
				<caption id="caption76" style="left:459px; top:324px; width:15px; height:20px; font-size:10pt; font-style:10pt; text-align:center; vertical-align:middle; ">~</caption>
				<output id="output25" ref="/root/resData/resForm/bonddebt/evlu_frdt" format="yyyy-mm" appearance="output" style="left:400px; top:324px; width:58px; height:20px; font-size:10pt; font-style:10pt; text-align:center; "/>
				<output id="out_avg_point" ref="/root/resData/resForm/bonddebt/avg_point" format="(-)#,###%" appearance="output" style="left:476px; top:295px; width:60px; height:20px; font-size:10pt; font-style:10pt; text-align:right; "/>
				<output id="out_sum_kiil" ref="/root/resData/resForm/bonddebt/sum_kiil" appearance="output" style="left:400px; top:295px; width:58px; height:20px; font-size:10pt; font-style:10pt; text-align:right; "/>
			</case>
			<case id="case5">
				<datagrid id="datagrid2" nodeset="/root/resData2/gridData/curlist1/record" caption="월^담보여유액(월평균)" colsep="^" colwidth="80, 130" dataheight="26" explorerbar="sort" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheight="25" rowsep="|" selectionmode="byrow" style="left:645px; top:5px; width:270px; height:339px; font-size:11pt; ">
					<col ref="basi_dt" format="yyyy-mm"/>
					<col ref="avg_amt" format="(-)#,###" style="text-align:right; word-wrap:none; "/>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							var srch_yymm = datagrid2.valueMatrix( datagrid2.row, datagrid2.colRef("basi_dt") );
							loadCalendar(srch_yymm);
						]]>
					</script>
				</datagrid>
				<datagrid id="datagrid3" nodeset="/root/resData2/gridData/curlist2/record" caption="일^월^화^수^목^금^토" colsep="#" colwidth="90, 90, 90, 90, 90, 90, 90" dataheight="26" mergecellsfixedcols="byrowrec" mergecellsfixedrows="bycolrec" rowheight="25" rowsep="|" selectionmode="free" style="left:6px; top:6px; width:632px; height:339px; font-size:10pt; ">
					<col ref="sun" format="(-)#,###" style="text-align:right; "/>
					<col ref="mon" format="(-)#,###" style="text-align:right; "/>
					<col ref="tue" format="(-)#,###" style="text-align:right; "/>
					<col ref="wed" format="(-)#,###" style="text-align:right; "/>
					<col ref="thr" format="(-)#,###" style="text-align:right; "/>
					<col ref="fri" format="(-)#,###" style="text-align:right; "/>
					<col ref="sat" format="(-)#,###" style="text-align:right; "/>
					<script type="javascript" ev:event="ondblclick">
						<![CDATA[
							//2010.03.03 KBS - 이상록氏. 채권채무상세화면으로 화면전환
							var currow;	// 조회 대상 로우-날짜
							var amtrow;	// 조회 체크 로우-금액
							var dlco_clsf;
							var dlco_no;
							var dlco_nm;
							var basi_dt;							

							if( !isDataRegion(datagrid3) ) 	return;
							
							currow = datagrid3.row
							if( currow%2 == 0 ){
								if( (currow-1) < 1 ){
									alert("["+currow+"] 날짜에서 더블클릭 하세요.");
								}
								else{
									currow = currow - 1;
								}
								amtrow = datagrid3.row
							}
							else{
								amtrow = datagrid3.row + 1;
								if( amtrow > datagrid3.rows ){
									alert("["+amtrow+"] 날짜에서 더블클릭 하세요.");
								}
							}
														
							basi_dt = datagrid3.valueMatrix( currow, datagrid3.col );
							if( basi_dt < 10 ){
								basi_dt = "0" + basi_dt;
							}							
							basi_dt = _selected_srch_yymm + basi_dt;
							OP_SYSTEM.value = _selected_dlco_nm + "-" + basi_dt;
							//금액이 없다면 조회할 필요 없다.
							if( datagrid3.valueMatrix(amtrow, datagrid3.col) == "" ) 	return;
							//basi_dt = strip(datagrid2.valueMatrix( datagrid2.row, datagrid2.colRef("basi_dt") ), "-") + basi_dt;
							//dlco_clsf 	= 	dg_sub.valueMatrix( dg_sub.row, dg_sub.colRef("dlco_clsf") );
							//dlco_no 	= 	dg_sub.valueMatrix( dg_sub.row, dg_sub.colRef("dlco_no") );
							//dlco_nm 	= 	dg_sub.valueMatrix( dg_sub.row, dg_sub.colRef("dlco_nm") );
//							if( _selected_dlco_clsf == "" || _selected_dlco_no == "" || _selected_dlco_nm == "" || len(basi_dt) != 8 )	return;														
							model.property("basi_dt") = basi_dt;	
							model.property("cur_tab") = "1";
							
							setSessionDlco(_selected_dlco_clsf, _selected_dlco_no, _selected_dlco_nm);
							loadDetail();
							//viewer("mainFrame").window.javaScript.onLoadExPopupPage("AD_BAS_1601");
/*								
								if(dg_main.row < dg_main.fixedRows)	return;
					
								group1.visible = false;
								
								var dlco_no 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("dlco_no"));
								var dlco_nm 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("dlco_nm"));
								var make_dt 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("make_dt"));
								var make_pers 	= dg_main.valueMatrix(dg_main.row, dg_main.colRef("make_pers"));
								var make_pers_nm 	= dg_main.valueMatrix(dg_main.row, dg_main.colRef("make_pers_nm"));
								var basi_dt 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("basi_dt"));
								var dlco_clsf 	= dg_main.valueMatrix(dg_main.row, dg_main.colRef("dlco_clsf"));
								
								model.property("make_dt") 		= make_dt;
								model.property("make_pers") 		= make_pers;
								model.property("make_pers_nm")	= make_pers_nm;
								model.property("basi_dt") 		= basi_dt;
								
								if(dg_main.col == dg_main.colRef("diary_titl")){
									model.property("cur_tab")   = "2";					
								}else{
									model.property("cur_tab")   = "1";				
								}
				
								setSessionDlco(dlco_clsf, dlco_no, dlco_nm);
								
								loadDetail()
*/							
/*						
							if( !isDataRegion(datagrid2) )	return;
							var row = datagrid2.row;
							if( row%2 == 0 ){
								row--;
							}
							
							var basi_dt 		= 	Number(datagrid2.valueMatrix(row, datagrid2.col));
							if( basi_dt == "" )		return;							
							basi_dt			=	_srch_yymm + "" + ( basi_dt < 10 ? "0"+basi_dt : ""+basi_dt );
							
							var dlco_no		=	model.getValue("/root/reqData/searchData/dlco_no");
							var dlco_clsf		=	model.getValue("/root/reqData/searchData/dlco_clsf");
							
							makeNodeValue("/root/tempData/basi_dt", basi_dt);	
							makeNodeValue("/root/tempData/dlco_clsf", dlco_clsf);
							makeNodeValue("/root/tempData/dlco_no", dlco_no);
							alert(basi_dt);
							alert(dlco_clsf);
							alert(dlco_no);
							//model.removeNodeSet("/root/resData2");
							
							model.send("ad_bas_1953_s");
							if( submit_completed() ){
								for(var i=datagrid3.fixedRows;i<datagrid3.rows;i++){
									
									datagrid3.isReadOnly(i, datagrid3.colRef("mang_chce_yn")) = true;
									datagrid3.isReadOnly(i, datagrid3.colRef("busn_chce_yn")) = true;
									datagrid3.isReadOnly(i, datagrid3.colRef("dhon_chce_yn")) = true;
											
									var mang_chce_yn 	= datagrid3.valueMatrix(i, datagrid3.colRef("mang_chce_yn"));
									var busn_chce_yn 	= datagrid3.valueMatrix(i, datagrid3.colRef("busn_chce_yn"));
									var dhon_chce_yn 	= datagrid3.valueMatrix(i, datagrid3.colRef("dhon_chce_yn"));
									
									datagrid3.rowStyle(i,"data","color") = "#FFFFFF"; 		
									
									if("Y" == mang_chce_yn &&  "Y" == busn_chce_yn  &&  "Y" == dhon_chce_yn){
										datagrid3.rowStyle(i,"data","background-color") = YY_BGCOLOR; //빨강
			//							datagrid3.rowStyle(i,"data","color") = "#ff0000"; 		      //빨강
									}else if("Y" == mang_chce_yn &&  "Y" == busn_chce_yn  &&  "N" == dhon_chce_yn){
										datagrid3.rowStyle(i,"data","background-color") = YY_BGCOLOR; //빨강
			//							datagrid3.rowStyle(i,"data","color") = "#000000";		      //검정
									}else if( "Y" == dhon_chce_yn &&  (  ("Y" == mang_chce_yn &&  "N" == busn_chce_yn) || ("N" == mang_chce_yn &&  "Y" == busn_chce_yn) ) ){
										datagrid3.rowStyle(i,"data","background-color") = YN_BGCOLOR; //파랑
			//							datagrid3.rowStyle(i,"data","color") = "#ff0000"; 		     //빨강
									}else if( "N" == dhon_chce_yn &&  (  ("Y" == mang_chce_yn &&  "N" == busn_chce_yn) || ("N" == mang_chce_yn &&  "Y" == busn_chce_yn) ) ){
										datagrid3.rowStyle(i,"data","background-color") = YN_BGCOLOR; //파랑
			//							datagrid3.rowStyle(i,"data","color") = "#000000"; 		     //검정
									}else if("N" == mang_chce_yn &&  "N" == busn_chce_yn &&  "Y" == dhon_chce_yn){
										datagrid3.rowStyle(i,"data","background-color") = "#ffffff";    //흰
			//							datagrid3.rowStyle(i,"data","color") = "#ff0000";		      //빨강
									}else if("N" == mang_chce_yn &&  "N" == busn_chce_yn &&  "N" == dhon_chce_yn){
										datagrid3.rowStyle(i,"data","background-color") = "#ffffff";    //흰
			//							datagrid3.rowStyle(i,"data","color") = "#000000";		      //검정
									}		
								}
								datagrid3.refresh();
								
								out_mang_mortg_surp_amt.attribute("background-color")	=	"#FFFFFF";
								out_busn_mortg_surp_amt.attribute("background-color")	=	"#FFFFFF";
								out_sum_kiil.attribute("background-color") 			=	"#FFFFFF";
								out_avg_point.attribute("background-color")			=	"#FFFFFF";
								
								//담보여유액 관리,영업 
								var mang_mortg_surp_amt = 0;
								var busn_mortg_surp_amt = 0;
								
								mang_mortg_surp_amt = Number(model.getValue("/root/resData2/resForm/mang_mortg_surp_amt"));
								busn_mortg_surp_amt = Number(model.getValue("/root/resData2/resForm/busn_mortg_surp_amt"));
								
								if(mang_mortg_surp_amt < 0){
									out_mang_mortg_surp_amt.attribute("background-color") = M_BGCOLOR;//빨강
								}
								else{
									out_mang_mortg_surp_amt.attribute("background-color") = P_BGCOLOR;//파랑 
								}
								
								if(busn_mortg_surp_amt < 0){
									out_busn_mortg_surp_amt.attribute("background-color") = M_BGCOLOR;//빨강
								}
								else{
									out_busn_mortg_surp_amt.attribute("background-color") = P_BGCOLOR;//파랑
								}		
			
													//평균기일
								var avg_point = 0;
								
								avg_point = Number(model.getValue("/root/resData2/resForm/avg_point")); 
							
								if(avg_point < 0){
									out_sum_kiil.attribute("background-color") 	= M_BGCOLOR;//빨강
									out_avg_point.attribute("background-color") 	= M_BGCOLOR;//빨강
								}
								if(avg_point > 0){
									out_sum_kiil.attribute("background-color") 	= P_BGCOLOR;//파랑
									out_avg_point.attribute("background-color") 	= P_BGCOLOR;//파랑
								}					
							}
							
							model.property("basi_dt") = basi_dt;
*/							

				]]>
					</script>
				</datagrid>
			</case>
		</switch>
		<caption id="caption12" class="list_cap02" style="left:10px; top:40px; width:501px; height:30px; "/>
		<caption id="caption6" tyle="left:15px; top:180px; width:940px; height:0px;" style="left:0px; top:10px; width:0px; height:0px; ">caption6</caption>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<button id="button4" class="btn02" crud="R" style="left:568px; top:40px; width:52px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[				
					loadData();
				]]>
			</script>
		</button>
		<button id="button5" class="btn04" crud="R" style="left:625px; top:40px; width:88px; height:21px; ">
			<caption>상세내용조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if( dg_main.row < dg_main.fixedRows )	return;
					
					group1.visible = false;
					
					var dlco_no 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("dlco_no"));
					var dlco_nm 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("dlco_nm"));
					var make_dt 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("make_dt"));
					var make_pers 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("make_pers"));
					var make_pers_nm 	= dg_main.valueMatrix(dg_main.row, dg_main.colRef("make_pers_nm"));
					var basi_dt 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("basi_dt"));
					var dlco_clsf 		= dg_main.valueMatrix(dg_main.row, dg_main.colRef("dlco_clsf"));
					
					model.property("make_dt") 		= make_dt;
					model.property("make_pers") 		= make_pers;
					model.property("make_pers_nm")	= make_pers_nm;
					model.property("basi_dt") 			= basi_dt;
					
					if( dg_main.col == dg_main.colRef("diary_titl") ){
						model.property("cur_tab")   = "2";					
					}
					else{
						model.property("cur_tab")   = "1";				
					}
	
					setSessionDlco(dlco_clsf, dlco_no, dlco_nm);
					
					loadDetail(); 
				]]>
			</script>
		</button>
		<button id="button6" class="btn04" crud="R" style="left:720px; top:40px; width:88px; height:21px; ">
			<caption>관리담당일지</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					group1.visible = false;
					model.property("cur_tab")   	= "3";
					loadDetail();
				]]>
			</script>
		</button>
		<button id="button7" class="btn02" style="left:881px; top:40px; width:52px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if(window.type == "mdi"){
						viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					}
					else{													
						window.close();
					}
				]]>
			</script>
		</button>
		<button id="button8" class="btn03" crud="C" style="left:811px; top:40px; width:65px; height:21px; ">
			<caption>익일등록</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					group1.visible = true;
					if( commReqCheck("group1") ){
						makeNodeValue("/root/popup/reqData/srch_yymm", model.getValue("/root/reqData/searchData/srch_yymm"));
						model.send("ad_bas_1612_l");
						if( submit_completed() ){
							for( var i=datagrid1.fixedRows; i<datagrid1.rows; i++ ){	
								var next_basi_dt = datagrid1.valueMatrix(i, datagrid1.colRef("next_basi_dt")); 
								if( next_basi_dt != "" ){
									datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = true;
								}
								else{
									datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = false;
								}
							}						
						}
					}
				]]>
			</script>
		</button>
		<caption id="caption11" class="list_cap01" style="left:10px; top:40px; width:81px; height:30px; font-size:10pt; font-weight:bold; vertical-align:middle; ">
			<![CDATA[조회년월]]>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					OP_SYSTEM.visible = !OP_SYSTEM.visible;
				]]>
			</script>
		</caption>
		<caption id="caption1" class="list_cap01" style="left:211px; top:40px; width:81px; height:30px; font-size:10pt; font-weight:bold; vertical-align:middle; ">거래처구분</caption>
		<button id="TAB_MainList" class="tab04" group="tab" selected="true" style="left:10px; top:76px; width:78px; height:23px; ">
			<caption>일지</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.toggle("case1");
					model.toggle(_case);		
					loadData();			
				]]>
			</script>
		</button>
		<button id="TAB_MainAVG" class="tab04" group="tab" selected="false" style="left:88px; top:76px; width:78px; height:23px; ">
			<caption>평균</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.toggle("case2");
					model.toggle("case5");
					loadData();
				]]>
			</script>
		</button>
		<input id="inp_srch_yymm" ref="/root/reqData/searchData/srch_yymm" class="req" format="yyyy-mm" caption="조회년월" style="left:94px; top:45px; width:60px; height:20px; font-size:10pt; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					loadData();
				]]>
			</script>
		</input>
		<button id="button22" style="left:163px; top:45px; width:20px; height:20px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
			<caption>+</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var srch_yymm = model.getValue("/root/reqData/searchData/srch_yymm");
					var tmp_date  = dateAdd("m", 1, srch_yymm+"01");
					
					model.setValue("/root/reqData/searchData/srch_yymm", tmp_date.substring(0,6));
					inp_srch_yymm.refresh();		
					
					loadData();
				]]>
			</script>
		</button>
		<button id="button23" style="left:183px; top:45px; width:20px; height:20px; font-weight:bold; text-align:center; border-color:#c0c0c0; border-style:solid; ">
			<caption>-</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var srch_yymm = model.getValue("/root/reqData/searchData/srch_yymm");
					var tmp_date  = dateAdd("m", -1, srch_yymm+"01");
					
					model.setValue("/root/reqData/searchData/srch_yymm", tmp_date.substring(0,6));
					inp_srch_yymm.refresh();	
					
					loadData();
				]]>
			</script>
		</button>
		<select1 id="radio1" ref="/root/reqData/searchData/dlco_clsf" appearance="full" cols="3" rows="1" overflow="visible" style="left:300px; top:46px; width:205px; height:20px; font-size:10pt; border-style:none; ">
			<choices>
				<item>
					<label>대행사/지사</label>
					<value>24</value>
				</item>
				<item>
					<label>광고주</label>
					<value>1</value>
				</item>
				<item>
					<label>전체</label>
					<value/>
				</item>
			</choices>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				//alert(radio1.value);
				]]>
			</script>
		</select1>
		<group id="group1" visibility="hidden" style="left:481px; top:65px; width:455px; height:316px; background-color:#ffffff; border-color:#aec9e9; border-style:solid; ">
			<caption id="caption46" class="list_cap02" style="left:5px; top:4px; width:159px; height:26px; "/>
			<caption id="caption72" class="list_cap02" style="left:5px; top:279px; width:320px; height:26px; "/>
			<datagrid id="datagrid1" nodeset="/root/popup/resData/gridData/record" caption="선택^거래처^기준일자^대상일자^DLCO_NO" colsep="#" colwidth="32, 167, 90, 90, 100" explorerbar="sort" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:5px; top:35px; width:442px; height:240px; ">
				<col checkvalue="Y,N" ref="checked" type="checkbox"/>
				<col ref="dlco_nm" style="text-align:left; word-wrap:none; "/>
				<col ref="pre_basi_dt" format="yyyy-mm-dd"/>
				<col ref="next_basi_dt" format="yyyy-mm-dd"/>
				<col ref="dlco_no" visibility="hidden"/>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[					
						var sel_cnt = Number(model.getValue("/root/popup/resData/sel_cnt"));
						model.setValue("/root/popup/resData/sel_cnt", sel_cnt + 1);
						out_sel_cnt.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="xforms-deselect">
					<![CDATA[					
						var sel_cnt = Number(model.getValue("/root/popup/resData/sel_cnt"));
						model.setValue("/root/popup/resData/sel_cnt", sel_cnt - 1);
						out_sel_cnt.refresh();
					]]>
				</script>
			</datagrid>
			<caption id="caption69" class="list_cap03" style="left:4px; top:279px; width:47px; height:26px; ">전체</caption>
			<caption id="caption25" class="list_cap03" style="left:100px; top:279px; width:50px; height:26px; ">미등록</caption>
			<caption id="caption37" class="list_cap03" style="left:199px; top:279px; width:47px; height:26px; ">선택</caption>
			<output id="output5" ref="/root/popup/resData/all_cnt" format="#,###" style="left:55px; top:283px; width:40px; height:18px; text-align:right; "/>
			<output id="output6" ref="/root/popup/resData/un_cnt" format="#,###" style="left:155px; top:283px; width:40px; height:18px; text-align:right; "/>
			<output id="out_sel_cnt" ref="/root/popup/resData/sel_cnt" format="#,###" style="left:250px; top:283px; width:40px; height:18px; text-align:right; "/>
			<button id="button1" class="btn02" style="left:340px; top:7px; width:52px; height:21px; ">
				<caption>등록</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(commReqCheck("group1")){
							if(windowConfirm("등록하시겠습니까?")){
								
								for(var i=datagrid1.fixedRows;i<datagrid1.rows;i++){
									if(datagrid1.valueMatrix(i, datagrid1.colRef("checked")) == "Y"){
										datagrid1.addStatus(i, "update");
									}
								}
								
								model.setValue("/root/popup/reqData/multiUpdateData", datagrid1.getUpdateData());
								model.send("ad_bas_1613_a");
								if(submit_completed()){
									group1.visible = false;
									loadData();
								}
							}
						}
					]]>
				</script>
			</button>
			<button id="button2" class="btn02" style="left:394px; top:7px; width:52px; height:21px; ">
				<caption>닫기</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						group1.visible = false;
					]]>
				</script>
			</button>
			<input id="input2" ref="/root/popup/reqData/basi_dt" inputtype="date" format="yyyy-mm-dd" style="left:69px; top:8px; width:85px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(commReqCheck("group1")){
													
							makeNodeValue("/root/popup/reqData/srch_yymm", model.getValue("/root/reqData/searchData/srch_yymm"));
							model.send("ad_bas_1612_l");
							
							if(submit_completed()){
								for(var i=datagrid1.fixedRows; i<datagrid1.rows; i++){	
									var next_basi_dt = datagrid1.valueMatrix(i, datagrid1.colRef("next_basi_dt")); 
									if(next_basi_dt != ""){
										datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = true;
									}else{
										datagrid1.isReadOnly(i, datagrid1.colRef("checked")) = false;
									}
								}					
							}
						}		
					]]>
				</script>
			</input>
			<caption id="caption45" class="list_cap03" style="left:4px; top:4px; width:60px; height:26px; ">대상일자</caption>
		</group>
		<output id="OP_SYSTEM" visibility="hidden" style="left:300px; top:75px; width:135px; height:20px; text-align:center; ">
			<script type="javascript" ev:event="onkeydown">
				<![CDATA[
					RefreshInfo();
				]]>
			</script>
		</output>
	</xhtml:body>
</xhtml:html>
