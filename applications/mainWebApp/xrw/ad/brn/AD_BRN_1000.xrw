<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<hndl_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</hndl_clsf>
							<advt_clas>
								<item>
									<label/>
									<value/>
								</item>
							</advt_clas>
							<chro_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</chro_clsf>
							<pubc_clas>
								<item>
									<label/>
									<value/>
								</item>
							</pubc_clas>
							<grp_cmpy_cd>
								<item>
									<label/>
									<value/>
								</item>
							</grp_cmpy_cd>
							<mony_kind>
								<item>
									<label/>
									<value/>
								</item>
							</mony_kind>
							<edt_clsf>
								<item>
									<label/>
									<value/>
								</item>
							</edt_clsf>
							<dtls_medi_cd>
								<item>
									<label/>
									<value/>
								</item>
							</dtls_medi_cd>
							<pubc_clas_350>
								<item>
									<label/>
									<value/>
								</item>
							</pubc_clas_350>
						</comboSet>
						<pageInfo/>
						<hndl_nm/>
					</initData>
					<reqData>
						<fwdData>
							<medi_cd/>
							<preng_occr_dt/>
						</fwdData>
						<searchData>
							<medi_cd/>
							<preng_occr_dt/>
							<preng_occr_seq/>
							<pubc_occr_dt/>
							<pubc_occr_seq/>
						</searchData>
						<reqForm>
						</reqForm>
						<multiUpdateData/>
					</reqData>
					<resData>
						<resForm>
							<medi_cd/>
							<preng_occr_dt/>
							<preng_occr_seq/>
							<dlco_no/>
							<dlco_nm/>
							<sect_nm/>
							<cm/>
							<dn/>
							<chro_clsf_nm/>
							<uprc/>
							<advt_fee/>
							<vat/>
							<pubc_tot_amt/>
							<pubc_side/>
							<rtax_yn/>
							<tabl_yn/>
							<hndl_clsf/>
							<agn/>
							<agn_nm/>
							<fee_rate/>
							<fee/>
							<hndl_plac_cd/>
							<hndl_plac_nm/>
							<coms_rate/>
							<coms/>
							<advt_clas/>
							<indt_clsf/>
							<indt_clsf_nm/>
							<mony_kind/>
							<chro_clsf/>
							<type_clsf/>
							<type_clsf_nm/>
							<exrate/>
							<pubc_clsf/>
							<grp_cmpy_cd/>
							<frex_cntr_amt/>
							<edt_clsf/>
							<slcrg_pers/>
							<slcrg_pers_nm/>
							<dept_cd/>
							<dept_nm/>
							<mchrg_pers/>
							<mchrg_pers_nm/>
							<advt_cont/>
							<remk/>
							<chrg_aprv_pers/>
							<chrg_aprv_dt/>
							<pubc_slip_no/>
							<preng_clos_yn/>
							<preng_dt/>
							<incmg_pers/>
							<incmg_pers_nm/>
							<flag/>
							<issu_chro_clsf/>
							<chrg_aprv/>
							<part_chf_aprv/>
							<team_chf_aprv/>
							<incmg_dt_tm/>
							<org_preng_occr_dt/>
							<org_preng_occr_seq/>
							<dtls_medi_cd/>
							<asist_pers/>
							<asist_pers_nm/>
							<pubc_frdt/>
							<pubc_todt/>
						</resForm>
						<gridData>
							<record>
							</record>
						</gridData>
					</resData>
					<tempData>
						<keyData/>
					</tempData>
					<msgData/>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[				
				
					var preng_occr_dt = dateAdd("d", 1, getCurrentDate());
					
					model.setValue("/root/reqData/searchData/preng_occr_dt", preng_occr_dt);
				
					model.send("ad_brn_1000_m");
					
					model.copyNode("/root/initData/comboSet/hndl_clsf", "/root/tempData/hndl_clsf");
					model.copyNode("/root/initData/comboSet/advt_clas", "/root/tempData/advt_clas");
					model.copyNode("/root/initData/comboSet/chro_clsf", "/root/tempData/chro_clsf");
					model.copyNode("/root/initData/comboSet/pubc_clas", "/root/tempData/pubc_clas");
					model.copyNode("/root/initData/comboSet/grp_cmpy_cd", "/root/tempData/grp_cmpy_cd");
					model.copyNode("/root/initData/comboSet/mony_kind", "/root/tempData/mony_kind");
					model.copyNode("/root/initData/comboSet/edt_clsf", "/root/tempData/edt_clsf");		
					model.copyNode("/root/initData/comboSet/dtls_medi_cd", "/root/tempData/dtls_medi_cd");	
					model.copyNode("/root/initData/comboSet/pubc_clas_350", "/root/tempData/pubc_clas_350");
					
					makeComboGubun("", "/root/initData/comboSet/grp_cmpy_cd", "item", "label", "value");
					makeComboGubun("", "/root/initData/comboSet/dtls_medi_cd", "item", "label", "value");
					
					//makeComboGubun("", "/root/initData/comboSet/advt_clas"	, "item", "label", "value");
					makeComboGubun("", "/root/initData/comboSet/edt_clsf"	, "item", "label", "value");
					makeComboGubun("", "/root/initData/comboSet/chro_clsf"	, "item", "label", "value");
					makeComboGubun("", "/root/initData/comboSet/pubc_clas"	, "item", "label", "value");
					makeComboGubun("", "/root/initData/comboSet/pubc_clas_350"	, "item", "label", "value");
					
					model.setValue("/root/resData/resForm/mchrg_pers", model.getValue("/root/tempData/mchrg_pers"));
					model.setValue("/root/resData/resForm/mchrg_pers_nm", model.getValue("/root/tempData/mchrg_pers_nm"));

					model.setValue("/root/resData/resForm/hndl_plac_cd", model.getValue("/root/tempData/hndl_plac_cd"));
					model.setValue("/root/resData/resForm/hndl_plac_nm", model.getValue("/root/tempData/hndl_plac_nm"));
															
					model.refresh();							

					initPage();
					
					var medi_cd 			= 	model.property("BRN_1000_MEDI_CD");
					var preng_occr_dt		=	model.property("BRN_1000_PRENG_OCCR_DT");	
					var preng_occr_seq	=	model.property("BRN_1000_PRENG_OCCR_SEQ");	
					
					if(medi_cd != "" && preng_occr_dt != "" && preng_occr_seq != ""){
						
						model.setValue("/root/reqData/searchData/medi_cd"		, medi_cd);
						model.setValue("/root/reqData/searchData/preng_occr_dt"	, preng_occr_dt);
						model.setValue("/root/reqData/searchData/preng_occr_seq"	, preng_occr_seq);

						loadData();
						
						model.property("BRN_1000_MEDI_CD") 		= "";
						model.property("BRN_1000_PRENG_OCCR_DT") 	= "";
						model.property("BRN_1000_PRENG_OCCR_SEQ") 	= "";
					}
					
				]]>
			</script>
			<submission id="ad_brn_1000_m" action="/ad/brn/1000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/tempData"/>
			<submission id="ad_brn_1010_s" action="/ad/brn/1010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData"/>
			<submission id="ad_brn_1020_a" action="/ad/brn/1020" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/msgData"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
			
			var _sect_nm = ""; //전역변수 지면섹션
			function initPage(){
				cb_edt_clsf.select(0);
				cb_medi_cd.select(0);
				cb_mony_kind.value	=	"KRW";
				cb_hndl_clsf.value	= 	"4";
				cb_advt_clas.select(0);
				cb_chro_clsf.value	=	"2";
				cb_pubc_clsf.select(0);
				
				btn_upd.disabled = true;
				btn_del.disabled = true;
				changeOnMediCd();
			}
			function setDlcoInfo(dlco_no, dlco_nm){
				
				var gnr_advcs_yn = model.getValue("/root/reqData/fwdData/gnr_advcs_yn");
				var agn_yn       = model.getValue("/root/reqData/fwdData/agn_yn");
				var advt_bo_yn   = model.getValue("/root/reqData/fwdData/advt_bo_yn");
				var bo_bof_yn    = model.getValue("/root/reqData/fwdData/bo_bof_yn");
				
				if(gnr_advcs_yn == "Y"){									
					model.setValue("/root/resData/resForm/dlco_no", dlco_no);
					model.setValue("/root/resData/resForm/dlco_nm", dlco_nm);					
					inp_dlco_no.refresh();
					inp_dlco_nm.refresh();	
					setChrgInfo();
									
				}else if(agn_yn == "Y"){									
					model.setValue("/root/resData/resForm/agn", dlco_no);
					model.setValue("/root/resData/resForm/agn_nm", dlco_nm);					
					inp_agn.refresh();
					inp_agn_nm.refresh();				
				}else if(advt_bo_yn == "Y" || bo_bof_yn == "Y"){									
					model.setValue("/root/resData/resForm/hndl_plac_cd", dlco_no);
					model.setValue("/root/resData/resForm/hndl_plac_nm", dlco_nm);					
					inp_hndl_plac_cd.refresh();
					inp_hndl_plac_nm.refresh();				
				}					
			}

			function setChrgInfo(){
				
				modelSendNoMake("ad_co_9007_s", "/ad/common/9007", "/root/resData/resForm", "/root/tempData");	
				if(submit_completed()){
					if(model.getValue("/root/resData/resForm/slcrg_pers") == ""){
						model.setValue("/root/resData/resForm/slcrg_pers", 		model.getValue("/root/tempData/slcrg_pers"));
						model.setValue("/root/resData/resForm/slcrg_pers_nm", 	model.getValue("/root/tempData/slcrg_pers_nm"));
					}
					if(model.getValue("/root/resData/resForm/dept_cd") == ""){
						model.setValue("/root/resData/resForm/dept_cd",       	model.getValue("/root/tempData/dept_cd"));
						model.setValue("/root/resData/resForm/dept_nm", 		model.getValue("/root/tempData/dept_nm"));
					}
					if(model.getValue("/root/resData/resForm/mchrg_pers") == ""){
						model.setValue("/root/resData/resForm/mchrg_pers", 		model.getValue("/root/tempData/mchrg_pers"));
						model.setValue("/root/resData/resForm/mchrg_pers_nm", 	model.getValue("/root/tempData/mchrg_pers_nm"));
					}
					if(model.getValue("/root/resData/resForm/grp_cmpy_cd") == ""){
						model.setValue("/root/resData/resForm/grp_cmpy_cd", 	model.getValue("/root/tempData/grp_cmpy_cd"));
					}
					
					model.refresh();
				}
			}
						
			function selectPubcPreng(medi_cd, preng_occr_dt, preng_occr_seq){
				
				
				model.setValue("/root/reqData/searchData/medi_cd", medi_cd);
				model.setValue("/root/reqData/searchData/preng_occr_dt", preng_occr_dt);
				model.setValue("/root/reqData/searchData/preng_occr_seq", preng_occr_seq);
				changeOnMediCd();
				
				model.send("ad_brn_1010_s");
				if(submit_completed()){
					
					if(model.getValue("/root/resData/resForm/urpc") == "0"){
						alert("검색결과가 없습니다.");
						return;
					}

					btn_upd.disabled = false;
					btn_del.disabled = false;
													
					model.refresh();					
				}
/*				
				if(model.getValue("/root/resData/resForm/agn") != ""){//대행사 
					grp_agn.visible = true;
				}else{
					grp_agn.visible = false;
				}
				if(model.getValue("/root/resData/resForm/hndl_plac_cd") != ""){//취급처 
					grp_hndl_clsf.visible = true;
				}else{
					grp_hndl_clsf.visible = false;
				}
*/				
//				btn_ins.disabled = true;
			}
			
			function selectPubc(pubc_occr_dt, pubc_occr_seq){
				
				model.setValue("/root/reqData/searchData/pubc_occr_dt", pubc_occr_dt);
				model.setValue("/root/reqData/searchData/pubc_occr_seq", pubc_occr_seq);
				
				model.send("ad_brn_1060_s");
				model.refresh();
			}

			function setIndt(indt_clsf, indt_clsf_nm){
				model.setValue("/root/resData/resForm/indt_clsf", indt_clsf);
				model.setValue("/root/resData/resForm/indt_clsf_nm", indt_clsf_nm);
				
				inp_indt_clsf.refresh();
				inp_indt_clsf_nm.refresh();			
				
			}		
			
			function setType(type_clsf, type_clsf_nm){
				model.setValue("/root/resData/resForm/type_clsf", type_clsf);
				model.setValue("/root/resData/resForm/type_clsf_nm", type_clsf_nm);
				
				inp_type_clsf.refresh();
				inp_type_clsf_nm.refresh();			
				
			}			
			
			function checkAll(){
				
				var mony_kind = model.getValue("/root/resData/resForm/mony_kind");
				if(mony_kind != "KRW"){
					var exrate = model.getValue("/root/resData/resForm/exrate");
					if(exrate == ""){
						alert("환율을 확인하십시오.");
						return false;
					}
					var frex_cntr_amt = model.getValue("/root/resData/resForm/frex_cntr_amt");
					if(frex_cntr_amt == ""){
						alert("외화계약액을 확인하십시오.");
						return false;
					}
				}				
				var hndl_clsf 	= model.getValue("/root/resData/resForm/hndl_clsf");
				var agn 			= model.getValue("/root/resData/resForm/agn");
				var agn_nm 		= model.getValue("/root/resData/resForm/agn_nm");
				var hndl_plac_cd = model.getValue("/root/resData/resForm/hndl_plac_cd");	
				var hndl_plac_nm = model.getValue("/root/resData/resForm/hndl_plac_nm");							
				var fee      	= Number(model.getValue("/root/resData/resForm/fee"));
				var fee_rate 	= Number(model.getValue("/root/resData/resForm/fee_rate"));
				var coms      	= Number(model.getValue("/root/resData/resForm/coms"));
				var coms_rate	= Number(model.getValue("/root/resData/resForm/coms_rate"));		
				var advt_fee	 	= Number(model.getValue("/root/resData/resForm/advt_fee"));		
				var vat 			= Number(model.getValue("/root/resData/resForm/vat"));		
				var pubc_tot_amt = Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));	
													
				if(hndl_clsf == "1"){
					//광고주
					if(agn != "" || hndl_plac_cd != ""){
						alert("광고주 선택시 대행사 또는 취급처를 입력할 수 없습니다. ");
						return false;
					}
					if(fee != 0 || fee_rate != 0 || coms != 0 || coms_rate != 0){						
						alert("광고주 선택시 대행료 또는 수수료를 입력할 수 없습니다. ");
						return false;
					}
				}else if(hndl_clsf == "2"){
					if(hndl_plac_cd != ""){
						alert("대행사 선택시 취급처를 입력할 수 없습니다. ");
						return false;
					}
					if(agn == "" || agn_nm == ""){
						window.alert("대행사를 입력하세요.");
						model.setFocus("inp_agn");
						return false;
					}
				}else if(hndl_clsf == "4" || hndl_clsf == "5" || hndl_clsf == "7"){
					if(hndl_plac_cd == "" || hndl_plac_nm == ""){
						alert("취급처를 입력하세요.");
						model.setFocus("inp_hndl_plac_cd");
						return false;
					}	
					if(coms_rate == ""){
						alert("수수료율을 입력하세요");
						model.setFocus("inp_coms_rate");
						return false;
					}					
				}
				if(agn != ""){
					//대행사
					if(fee_rate <= 0 || fee_rate > 15){
						alert("대행료율의 범위는 0 < 수수료율 <= 15 입니다.");
						return false;
					}					
					var ocha = fee - ( pubc_tot_amt * fee_rate )/100;
               			if(ocha > 100){
               				alert("대행료는 (총게재액 * 요율 / 100) 값과 100 이상의 오차 발생시 Error입니다.");
               				return false;
               			}
				}
				if(hndl_plac_cd != ""){
					//취급처					
					if(coms_rate <= 0 || coms_rate > 25){
						alert("수수료율의 범위는 0 < 수수료율 <= 25 입니다.");
						return false;
					}														
				}
				if(fee_rate + coms_rate > 25){
					alert("대행료율과 수수료율의 합은 25 보다 클 수 없습니다.");
					return false;
				}		
				
				var rtax_yn = model.getValue("/root/resData/resForm/rtax_yn");
				if(rtax_yn != "Y" && mony_kind == "KRW"){			        	
					ocha = (advt_fee * 0.1) - vat;	
			        	if(ocha < -100 || ocha > 100){
			        		alert("(광고료/10 - 부가세)의 오차가 100을 초과했습니다.");
			        		return false;
					}
				}
								
				return true;
			}
			

			function recalculate(uprc_yn, advt_fee_yn, vat_yn, pubc_tot_amt_yn, dn_cm_yn){
				
				var pubc_tot_amt	=	Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));				
				var advt_fee 	=	Number(model.getValue("/root/resData/resForm/advt_fee"));					
				var vat 			=	Number(model.getValue("/root/resData/resForm/vat"));				
				var uprc			=	Number(model.getValue("/root/resData/resForm/uprc"));					
				var dn			=	Number(model.getValue("/root/resData/resForm/dn"));				
				var cm			=	Number(model.getValue("/root/resData/resForm/cm"));
				
				var medi_cd		=	cb_medi_cd.value
				
				if(medi_cd	==	"110" || medi_cd == "130"){				
					if(pubc_tot_amt_yn == "Y"){					
						advt_fee		=	Math.round((pubc_tot_amt * 10) / 11);
						vat			=	Math.round((pubc_tot_amt * 1) / 11);
						uprc			=	Math.round(advt_fee/(dn * cm));	
						
						model.setValue("/root/resData/resForm/uprc", uprc);
						model.setValue("/root/resData/resForm/advt_fee", advt_fee);
						model.setValue("/root/resData/resForm/vat", vat);
										
					}else if(uprc_yn == "Y"){
						advt_fee		=	Math.round(uprc * dn * cm);
						vat			=	Math.round(advt_fee / 10);
						pubc_tot_amt	=	advt_fee + vat;

						model.setValue("/root/resData/resForm/advt_fee", advt_fee);
						model.setValue("/root/resData/resForm/vat", vat);
						model.setValue("/root/resData/resForm/pubc_tot_amt", pubc_tot_amt);		
										
					}else if(advt_fee_yn == "Y"){

						if(Number(model.getValue("/root/resData/resForm/uprc")) == 0){
							uprc		=	Math.round(advt_fee/(dn * cm));
							model.setValue("/root/resData/resForm/uprc", uprc);
						}
						if(Number(model.getValue("/root/resData/resForm/vat"))	==	0){
							vat		=	Math.round(advt_fee / 10);
							model.setValue("/root/resData/resForm/vat", vat);
						}
						
						if(uprc != 0 && advt_fee != 0 && vat != 0 && pubc_tot_amt != 0){
							vat		=	pubc_tot_amt - advt_fee;
							if(vat <	0){
								alert("광고료가 게재총액보다 클 수 없습니다.");
								return;
							}
							model.setValue("/root/resData/resForm/vat", vat);
						}
											
						pubc_tot_amt	=	advt_fee + vat;
						model.setValue("/root/resData/resForm/pubc_tot_amt", pubc_tot_amt);		
										
					}else if(vat_yn	==	"Y"){	

						if(Number(model.getValue("/root/resData/resForm/advt_fee")) == 0){
							advt_fee		=	Math.round(vat * 10);	
							model.setValue("/root/resData/resForm/advt_fee", advt_fee);
						}
						if(Number(model.getValue("/root/resData/resForm/uprc")) == 0){
							uprc			=	Math.round(advt_fee/(dn * cm));
							model.setValue("/root/resData/resForm/uprc", uprc);
						}

						if(uprc != 0 && advt_fee != 0 && vat != 0 && pubc_tot_amt != 0){
							advt_fee		=	pubc_tot_amt - vat;
							if(advt_fee <	0){
								alert("부가세가 게재총액보다 클 수 없습니다.");
								return;
							}						
							model.setValue("/root/resData/resForm/advt_fee", advt_fee);
						}
											
						pubc_tot_amt	=	advt_fee + vat;
						model.setValue("/root/resData/resForm/pubc_tot_amt", pubc_tot_amt);		
													
					}else if(dn_cm_yn		==	"Y"){				
						advt_fee		=	Math.round(uprc * dn * cm);	
						vat			=	Math.round(advt_fee / 10);	
						pubc_tot_amt	=	advt_fee + vat;
						
						model.setValue("/root/resData/resForm/advt_fee", advt_fee);
						model.setValue("/root/resData/resForm/vat", vat);
						model.setValue("/root/resData/resForm/pubc_tot_amt", pubc_tot_amt);		
										
					}
				}else{//350
					if(pubc_tot_amt_yn == "Y"){					
						advt_fee		=	Math.round((pubc_tot_amt * 10) / 11);
						vat			=	Math.round((pubc_tot_amt * 1) / 11);
						model.setValue("/root/resData/resForm/advt_fee", advt_fee);
						model.setValue("/root/resData/resForm/vat", vat);
										
					}
					else if(advt_fee_yn == "Y" && dn_cm_yn == ""){						
						vat			=	Math.round(advt_fee / 10);
						pubc_tot_amt	=	advt_fee + vat;
						model.setValue("/root/resData/resForm/vat", vat);	
						model.setValue("/root/resData/resForm/pubc_tot_amt", pubc_tot_amt);	
					}
					else if(vat_yn	==	"Y"){	
						advt_fee		=	Math.round(vat * 10);	
						pubc_tot_amt	=	advt_fee + vat;
						model.setValue("/root/resData/resForm/advt_fee", advt_fee);						
						model.setValue("/root/resData/resForm/pubc_tot_amt", pubc_tot_amt);		
													
					}					
				}
				var hndl_clsf	=	model.getValue("/root/resData/resForm/hndl_clsf");
				var fee_rate		=	Number(model.getValue("/root/resData/resForm/fee_rate"));
				if(fee_rate > 0){
					var fee = Math.round(pubc_tot_amt * (fee_rate/100));
					model.setValue("/root/resData/resForm/fee", fee);
					inp_fee.refresh();
				}
				var coms_rate	=	Number(model.getValue("/root/resData/resForm/coms_rate"));
				if(coms_rate > 0){
					var coms = Math.round(pubc_tot_amt * (coms_rate/100));
					model.setValue("/root/resData/resForm/coms", coms);
					inp_coms.refresh();
				}
				
				inp_uprc.refresh();
				inp_advt_fee.refresh();
				inp_vat.refresh();
				inp_pubc_tot_amt.refresh();
								
			}
			
			function loadData(){

				model.send("ad_brn_1010_s");
				if(submit_completed()){						
					if(model.getValue("/root/resData/resForm/pubc_tot_amt") == ""){
						alert("검색결과가 없습니다.");
						return;
					}
/*						
					var hndl_clsf = model.getValue("/root/resData/resForm/hndl_clsf");
					if(hndl_clsf == "2"){
						grp_agn.visible = true;
					}
					if(hndl_clsf == "4"){
						grp_agn.visible = true;
						grp_hndl_clsf.visible = true;
						model.setValue("/root/initData/hndl_nm", "광고지사");	
					}
					if(hndl_clsf == "5"){
						grp_agn.visible = true;
						grp_hndl_clsf.visible = true;
						model.setValue("/root/initData/hndl_nm", "지국지사");	
					}
					if(hndl_clsf == "7"){
						grp_agn.visible = true;
						grp_hndl_clsf.visible = true;
						model.setValue("/root/initData/hndl_nm", "해외지사");	
					}
*/						
					
					btn_ins.disabled = true;
					btn_upd.disabled = false;
					btn_del.disabled = false;				
					
					model.refresh();
				}				
			}
			function setDlcoResultInfo(){
						
				var dlco_no			=	model.getValue("/root/tempData/resData/dlco_no");
				var dlco_nm			=	model.getValue("/root/tempData/resData/dlco_nm");
				var slcrg_pers		=	model.getValue("/root/tempData/resData/slcrg_pers");
				var slcrg_pers_nm		=	model.getValue("/root/tempData/resData/slcrg_pers_nm");
				var dept_cd			=	model.getValue("/root/tempData/resData/dept_cd");
				var dept_nm			=	model.getValue("/root/tempData/resData/dept_nm");
				var grp_cmpy_cd		=	model.getValue("/root/tempData/resData/grp_cmpy_cd");
					
				if(dlco_no	==	"TMRS"){
					showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText); 					
					return;
				}
				
				model.setValue("/root/resData/resForm/dlco_no", dlco_no);
				model.setValue("/root/resData/resForm/dlco_nm", dlco_nm);

				if(model.getValue("/root/resData/resForm/slcrg_pers") == ""){
					model.setValue("/root/resData/resForm/slcrg_pers", slcrg_pers);
				}
				if(model.getValue("/root/resData/resForm/slcrg_pers_nm") == ""){
					model.setValue("/root/resData/resForm/slcrg_pers_nm", slcrg_pers_nm);
				}
				if(model.getValue("/root/resData/resForm/dept_cd") == ""){
					model.setValue("/root/resData/resForm/dept_cd", dept_cd);
				}
				if(model.getValue("/root/resData/resForm/dept_nm") == ""){
					model.setValue("/root/resData/resForm/dept_nm", dept_nm);
				}
				model.setValue("/root/resData/resForm/grp_cmpy_cd", grp_cmpy_cd);
				
				model.refresh();
				
			}

			function setAgnResultInfo(){
						
				var dlco_no			=	model.getValue("/root/tempData/resData/dlco_no");
				var dlco_nm			=	model.getValue("/root/tempData/resData/dlco_nm");

				if(dlco_no	==	"TMRS"){
					showAdvcsSearchPopup("", "", "Y", "", "", inp_agn_nm.currentText); 					
					return;
				}
				
				model.setValue("/root/resData/resForm/agn", dlco_no);
				model.setValue("/root/resData/resForm/agn_nm", dlco_nm);
				
				inp_agn.refresh();
				inp_agn_nm.refresh();

			}		
			function changeOnMediCd(){

				var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");
				if(medi_cd == "350"){
					group1.visible  = false;
					gr_group1.visible = false;
					grp_ast.visible = true;					
					cb_dtls_medi_cd.visible = true;
					gr_350.visible = true;	
				}
				else{
					group1.visible  = true;
					gr_group1.visible = true;
					grp_ast.visible = false;
					cb_dtls_medi_cd.visible = false;
					gr_350.visible = false;				
				}								
			}				
		]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="1,10;1,936;2,61;2,71;2,125;2,105;2,115;2,119;" style="font-family:굴림; ">
		<caption id="caption57" class="list_cap02" style="left:10px; top:330px; width:926px; height:26px; "/>
		<caption id="caption55" class="list_cap02" style="left:10px; top:355px; width:926px; height:26px; "/>
		<caption id="caption44" class="list_cap02" style="left:10px; top:479px; width:926px; height:26px; "/>
		<caption id="caption12" class="list_cap02" style="left:10px; top:71px; width:926px; height:28px; "/>
		<caption id="caption6" tyle="left:15px; top:180px; width:940px; height:0px;" style="left:0px; top:10px; width:0px; height:0px; ">caption6</caption>
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group_line" class="gro_line" style="left:10px; top:108px; width:926px; height:5px; "/>
		<caption id="caption7" class="list_cap01" style="left:273px; top:71px; width:85px; height:28px; ">게재일자</caption>
		<caption id="caption2" class="list_cap01" style="left:475px; top:71px; width:55px; height:28px; ">순번</caption>
		<input id="inp_preng_occr_dt" ref="/root/reqData/searchData/preng_occr_dt" navindex="2" inputtype="date" format="yyyy-mm-dd" style="left:362px; top:76px; width:95px; height:18px; text-align:center; "/>
		<caption id="caption10" class="list_cap01" style="left:612px; top:71px; width:85px; height:28px; ">광고주</caption>
		<caption id="caption30" class="list_cap" style="left:757px; top:125px; width:60px; height:22px; ">면세여부</caption>
		<bool id="bool1" navindex="13" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/rtax_yn" style="left:807px; top:125px; width:45px; height:20px; background-image:#uncheck; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[

				var rtax_yn = model.getValue("/root/resData/resForm/rtax_yn");
				if(rtax_yn == "Y"){
					var advt_fee	= Number(model.getValue("/root/resData/resForm/advt_fee"));
					model.setValue("/root/resData/resForm/vat", "0");
					model.setValue("/root/resData/resForm/pubc_tot_amt", advt_fee);
					inp_vat.refresh();
					inp_pubc_tot_amt.refresh();
				}else{
					var advt_fee	= Number(model.getValue("/root/resData/resForm/advt_fee"));
					var vat   	= advt_fee / 10;//Number(model.getValue("/root/resData/resForm/vat"));					
					model.setValue("/root/resData/resForm/vat", vat);
					model.setValue("/root/resData/resForm/pubc_tot_amt", advt_fee  + vat);
					inp_vat.refresh(); 
					inp_pubc_tot_amt.refresh();
				}
								
				]]>
			</script>
		</bool>
		<bool id="bool2" navindex="14" checkvalue="Y,N" select.background-image="#check" ref="/root/resData/resForm/tabl_yn" style="left:807px; top:150px; width:45px; height:20px; background-image:#uncheck; "/>
		<caption id="caption33" class="list_cap" style="left:757px; top:150px; width:60px; height:22px; ">T/B여부</caption>
		<caption id="caption1" class="list_cap02" style="left:10px; top:180px; width:926px; height:26px; "/>
		<caption id="caption4" class="list_cap02" style="left:10px; top:255px; width:926px; height:26px; "/>
		<caption id="caption5" class="list_cap02" style="left:10px; top:280px; width:926px; height:26px; "/>
		<caption id="caption8" class="list_cap02" style="left:10px; top:305px; width:926px; height:26px; "/>
		<caption id="caption9" class="list_cap02" style="left:10px; top:380px; width:926px; height:26px; "/>
		<caption id="caption11" class="list_cap02" style="left:10px; top:405px; width:926px; height:50px; "/>
		<caption id="caption13" class="list_cap02" style="left:10px; top:454px; width:926px; height:26px; "/>
		<select1 id="cb_hndl_clsf" ref="/root/resData/resForm/hndl_clsf" class="req" navindex="15" appearance="minimal" caption="취급구분" style="left:109px; top:184px; width:120px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/hndl_clsf/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
				var hndl_clsf = model.getValue("/root/resData/resForm/hndl_clsf");
/*				
				if(hndl_clsf == "1"){					
					grp_agn.visible = false;
					grp_hndl_clsf.visible = false;
				}else if(hndl_clsf == "2"){					
					grp_agn.visible = true;
					grp_hndl_clsf.visible = false;
				}else if(hndl_clsf == "4"){
					model.setValue("/root/initData/hndl_nm", "광고지사");				
					grp_agn.visible = true;
					grp_hndl_clsf.visible = true;
				}else if(hndl_clsf == "5"){
					model.setValue("/root/initData/hndl_nm", "지사지국");				
					grp_agn.visible = true;
					grp_hndl_clsf.visible = true;
				}else if(hndl_clsf == "7"){
					model.setValue("/root/initData/hndl_nm", "해외지사");				
					grp_agn.visible = true;
					grp_hndl_clsf.visible = true;
				}
*/					
				cap_hndl_clsf.refresh();
				
				]]>
			</script>
		</select1>
		<caption id="caption15" class="list_cap03" style="left:10px; top:180px; width:94px; height:26px; ">취급구분</caption>
		<caption id="caption32" class="list_cap03" style="left:304px; top:255px; width:94px; height:26px; ">업종구분</caption>
		<input id="inp_slcrg_pers_nm" ref="/root/resData/resForm/slcrg_pers_nm" class="req" navindex="36" imemode="hangul" inputtype="button" caption="영업담당" crud="R" style="left:176px; top:359px; width:95px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				searchEmpno("setSlcrgPers", "/root/resData/resForm/slcrg_pers", "/root/resData/resForm/slcrg_pers_nm");
				var emp_no = model.getValue("/root/resData/resForm/slcrg_pers");
				if(emp_no != ""){
					findDept(emp_no, out_dept_cd, out_dept_nm);
				}	
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){

					var slcrg_pers_nm		=	inp_slcrg_pers_nm.currentText;
					model.removeNode("/root/tempData/reqData");
					makeNodeValue("/root/tempData/reqData/slcrg_pers_nm", slcrg_pers_nm);
					modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");
					if(submit_completed()){
						var slcrg_pers		=	model.getValue("/root/tempData/resData/slcrg_pers");
						var	slcrg_pers_nm	=	model.getValue("/root/tempData/resData/slcrg_pers_nm");
						var	dept_cd			=	model.getValue("/root/tempData/resData/dept_cd");
						var	dept_nm			=	model.getValue("/root/tempData/resData/dept_nm");
							
						model.setValue("/root/resData/resForm/slcrg_pers", slcrg_pers);
						model.setValue("/root/resData/resForm/slcrg_pers_nm", slcrg_pers_nm)
						model.setValue("/root/resData/resForm/dept_cd", dept_cd)
						model.setValue("/root/resData/resForm/dept_nm", dept_nm)
							
						inp_slcrg_pers.refresh();
						inp_slcrg_pers_nm.refresh();
						out_dept_cd.refresh();
						out_dept_nm.refresh();
						
					}							
				}					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[

					var slcrg_pers_nm		=	inp_slcrg_pers_nm.currentText;
					model.removeNode("/root/tempData/reqData");
					makeNodeValue("/root/tempData/reqData/slcrg_pers_nm", slcrg_pers_nm);
					modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");
					if(submit_completed()){
						var slcrg_pers		=	model.getValue("/root/tempData/resData/slcrg_pers");
						var	slcrg_pers_nm	=	model.getValue("/root/tempData/resData/slcrg_pers_nm");
						var	dept_cd			=	model.getValue("/root/tempData/resData/dept_cd");
						var	dept_nm			=	model.getValue("/root/tempData/resData/dept_nm");
							
						model.setValue("/root/resData/resForm/slcrg_pers", slcrg_pers);
						model.setValue("/root/resData/resForm/slcrg_pers_nm", slcrg_pers_nm)
						model.setValue("/root/resData/resForm/dept_cd", dept_cd)
						model.setValue("/root/resData/resForm/dept_nm", dept_nm)
							
						inp_slcrg_pers.refresh();
						inp_slcrg_pers_nm.refresh();
						out_dept_cd.refresh();
						out_dept_nm.refresh();
						
					}		
				]]>
			</script>
		</input>
		<input id="inp_slcrg_pers" ref="/root/resData/resForm/slcrg_pers" class="req" navindex="35" caption="영업담당" style="left:109px; top:359px; width:60px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var slcrg_pers	=	inp_slcrg_pers.currentText;
				model.removeNode("/root/tempData/reqData");
				makeNodeValue("/root/tempData/reqData/slcrg_pers", slcrg_pers);
				modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");
				if(submit_completed()){
					var slcrg_pers		=	model.getValue("/root/tempData/resData/slcrg_pers");
					var	slcrg_pers_nm	=	model.getValue("/root/tempData/resData/slcrg_pers_nm");
					var	dept_cd			=	model.getValue("/root/tempData/resData/dept_cd");
					var	dept_nm			=	model.getValue("/root/tempData/resData/dept_nm");
						
					model.setValue("/root/resData/resForm/slcrg_pers", slcrg_pers);
					model.setValue("/root/resData/resForm/slcrg_pers_nm", slcrg_pers_nm)
					model.setValue("/root/resData/resForm/dept_cd", dept_cd)
					model.setValue("/root/resData/resForm/dept_nm", dept_nm)
						
					inp_slcrg_pers.refresh();
					inp_slcrg_pers_nm.refresh();
					out_dept_cd.refresh();
					out_dept_nm.refresh();
					
				}
								
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					var slcrg_pers	=	inp_slcrg_pers.currentText;
					model.removeNode("/root/tempData/reqData");
					makeNodeValue("/root/tempData/reqData/slcrg_pers", slcrg_pers);
					modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");
					if(submit_completed()){
						
						var slcrg_pers		=	model.getValue("/root/tempData/resData/slcrg_pers");
						var	slcrg_pers_nm	=	model.getValue("/root/tempData/resData/slcrg_pers_nm");
						var	dept_cd			=	model.getValue("/root/tempData/resData/dept_cd");
						var	dept_nm			=	model.getValue("/root/tempData/resData/dept_nm");
						
						model.setValue("/root/resData/resForm/slcrg_pers", slcrg_pers);
						model.setValue("/root/resData/resForm/slcrg_pers_nm", slcrg_pers_nm)
						model.setValue("/root/resData/resForm/dept_cd", dept_cd)
						model.setValue("/root/resData/resForm/dept_nm", dept_nm)
						
						inp_slcrg_pers.refresh();
						inp_slcrg_pers_nm.refresh();
						out_dept_cd.refresh();
						out_dept_nm.refresh();
						
					}
				}
				]]>
			</script>
		</input>
		<caption id="caption23" class="list_cap03" style="left:10px; top:355px; width:94px; height:26px; ">영업담당</caption>
		<input id="inp_indt_clsf_nm" ref="/root/resData/resForm/indt_clsf_nm" class="req" navindex="29" imemode="hangul" inputtype="button" caption="업종구분" appearance="input" crud="R" style="left:452px; top:259px; width:123px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				showIndtClsfPopup();
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				findIndtClsfByName(inp_indt_clsf_nm.currentText, inp_indt_clsf, inp_indt_clsf_nm);				
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					findIndtClsfByName(inp_indt_clsf_nm.currentText, inp_indt_clsf, inp_indt_clsf_nm);
				}				
				]]>
			</script>
		</input>
		<input id="inp_type_clsf_nm" ref="/root/resData/resForm/type_clsf_nm" class="req" navindex="31" imemode="hangul" inputtype="button" caption="유형구분" appearance="input" crud="R" style="left:452px; top:284px; width:123px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				showTypeClsfPopup();					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				findTypeClsfByName(inp_type_clsf_nm.currentText, inp_type_clsf, inp_type_clsf_nm);
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					findTypeClsfByName(inp_type_clsf_nm.currentText, inp_type_clsf, inp_type_clsf_nm);
				}							
				]]>
			</script>
		</input>
		<caption id="caption31" class="list_cap03" style="left:304px; top:280px; width:94px; height:26px; ">유형구분</caption>
		<caption id="caption26" class="list_cap03" style="left:304px; top:355px; width:94px; height:26px; ">영업부서</caption>
		<output id="out_dept_cd" ref="/root/resData/resForm/dept_cd" class="req" style="left:403px; top:359px; width:60px; height:18px; border-style:solid; "/>
		<output id="out_dept_nm" ref="/root/resData/resForm/dept_nm" class="req" style="left:470px; top:359px; width:95px; height:18px; border-style:solid; "/>
		<output id="inp_mchrg_pers_nm" ref="/root/resData/resForm/mchrg_pers_nm" class="req" imemode="hangul" inputtype="button" caption="관리담당" appearance="output" crud="R" style="left:748px; top:359px; width:95px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[				
				searchEmpno("setMchrgPers", "/root/resData/resForm/mchrg_pers", "/root/resData/resForm/mchrg_pers_nm");		
				]]>
			</script>
		</output>
		<output id="inp_mchrg_pers" ref="/root/resData/resForm/mchrg_pers" class="req" navindex="20" caption="관리담당" appearance="output" style="left:682px; top:359px; width:60px; height:18px; ">
			<script type="javascript" ev:event="DOMFocusOut">
				<![CDATA[							
						
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				commonSubmission("9005", inp_mchrg_pers.currentText,  inp_mchrg_pers, inp_mchrg_pers_nm);				
				]]>
			</script>
		</output>
		<caption id="caption29" class="list_cap03" style="left:304px; top:305px; width:94px; height:26px; ">그룹사</caption>
		<select1 id="combo7" ref="/root/resData/resForm/grp_cmpy_cd" disabled="true" navindex="32" appearance="minimal" style="left:404px; top:309px; width:172px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/grp_cmpy_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="caption34" class="list_cap03" style="left:582px; top:355px; width:94px; height:26px; ">관리담당</caption>
		<caption id="caption35" class="list_cap03" style="left:10px; top:380px; width:94px; height:26px; ">광고내용</caption>
		<input id="input18" ref="/root/resData/resForm/advt_cont" navindex="37" imemode="hangul" caption="광고내용" style="left:109px; top:384px; width:780px; height:18px; "/>
		<caption id="caption36" class="list_cap03" style="left:10px; top:405px; width:94px; height:50px; ">비고</caption>
		<textarea id="textarea1" ref="/root/resData/resForm/remk" navindex="38" imemode="hangul" style="left:109px; top:409px; width:780px; height:40px; text-align:left; vertical-align:top; padding:2; "/>
		<output id="output4" ref="/root/resData/resForm/chrg_aprv_pers" style="left:109px; top:458px; width:65px; height:18px; border-style:solid; "/>
		<output id="output5" ref="/root/resData/resForm/chrg_aprv_dt" style="left:178px; top:458px; width:120px; height:18px; border-style:solid; "/>
		<caption id="caption39" class="list_cap03" style="left:10px; top:454px; width:94px; height:26px; ">담당승인</caption>
		<output id="output6" ref="/root/resData/resForm/pubc_slip_no" format="999-99999999-9999" style="left:109px; top:483px; width:147px; height:18px; border-style:solid; "/>
		<output id="output7" ref="/root/resData/resForm/preng_clos_yn" style="left:403px; top:458px; width:35px; height:18px; border-style:solid; "/>
		<output id="output8" ref="/root/resData/resForm/incmg_dt_tm" style="left:681px; top:458px; width:147px; height:18px; text-align:center; border-style:solid; "/>
		<caption id="caption40" class="list_cap03" style="left:10px; top:479px; width:94px; height:26px; ">게재전표</caption>
		<caption id="caption41" class="list_cap03" style="left:304px; top:454px; width:94px; height:26px; ">예약마감</caption>
		<caption id="caption42" class="list_cap03" style="left:580px; top:454px; width:94px; height:26px; ">예약등록일시</caption>
		<caption id="caption50" class="list_cap03" style="left:588px; top:125px; width:105px; height:30px; text-align:center; ">게재총액</caption>
		<input id="inp_pubc_tot_amt" ref="/root/resData/resForm/pubc_tot_amt" class="req" navindex="12" format="#,###" caption="게재총액" appearance="input" style="left:588px; top:154px; width:105px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				recalculate("", "", "", "Y", "");		
				]]>
			</script>
		</input>
		<caption id="caption51" class="list_cap03" style="left:380px; top:125px; width:105px; height:30px; text-align:center; ">광고료</caption>
		<input id="inp_advt_fee" ref="/root/resData/resForm/advt_fee" class="req" navindex="10" format="#,###" caption="광고료" style="left:380px; top:154px; width:105px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				recalculate("", "Y", "", "", "");				
				]]>
			</script>
		</input>
		<caption id="caption52" class="list_cap03" style="left:484px; top:125px; width:105px; height:30px; text-align:center; ">부가세</caption>
		<caption id="caption54" class="list_cap03" style="left:697px; top:125px; width:50px; height:30px; text-align:center; ">면번호</caption>
		<output id="out_pubc_side" ref="/root/resData/resForm/pubc_side" format="#,###" appearance="output" style="left:697px; top:154px; width:50px; height:18px; text-align:right; "/>
		<caption id="caption21" class="list_cap03" style="left:582px; top:255px; width:94px; height:26px; ">화폐종류</caption>
		<caption id="caption24" class="list_cap03" style="left:582px; top:280px; width:94px; height:26px; ">환율</caption>
		<input id="input15" ref="/root/resData/resForm/frex_cntr_amt" navindex="33" format="#,###" style="left:682px; top:309px; width:120px; height:18px; text-align:right; "/>
		<caption id="caption27" class="list_cap03" style="left:582px; top:305px; width:94px; height:26px; ">외화계약</caption>
		<select1 id="cb_mony_kind" ref="/root/resData/resForm/mony_kind" navindex="32" appearance="minimal" style="left:682px; top:259px; width:120px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/mony_kind/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
				var mony_kind = model.getValue("/root/resData/resForm/mony_kind");
				model.makeNode("/root/reqData/searchData/mony_kind");
				model.setValue("/root/reqData/searchData/mony_kind", mony_kind);
				
				modelSendNoMake("ad_co_9001_s", "/ad/common/9001", "/root/reqData/searchData", "/root/tempData");		
				
				model.setValue("/root/resData/resForm/exrate", model.getValue("/root/tempData/exrate"));
				out_exrate.refresh();
				
				]]>
			</script>
		</select1>
		<group id="grp_agn" navindex="14" style="left:10px; top:205px; width:926px; height:27px; ">
			<caption id="caption56" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; "/>
			<caption id="caption60" class="list_cap03" style="left:572px; top:0px; width:94px; height:26px; ">대행료</caption>
			<input id="inp_fee_rate" ref="/root/resData/resForm/fee_rate" navindex="18" maxlength="2" format="#,###" style="left:393px; top:4px; width:85px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
			
					var pubc_tot_amt = 	Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));
					var fee_rate     = 	Number(model.getValue("/root/resData/resForm/fee_rate"));
					
					var fee			=	pubc_tot_amt * (fee_rate /100);
					
					model.setValue("/root/resData/resForm/fee", fee);
					inp_fee.refresh();
							
					]]>
				</script>
			</input>
			<input id="inp_fee" ref="/root/resData/resForm/fee" navindex="19" format="#,###" style="left:672px; top:4px; width:85px; height:18px; text-align:right; "/>
			<caption id="caption14" class="list_cap03" style="left:0px; top:0px; width:94px; height:26px; ">대행사</caption>
			<caption id="caption59" class="list_cap03" style="left:294px; top:0px; width:94px; height:26px; ">대행료율</caption>
			<input id="inp_agn" ref="/root/resData/resForm/agn" navindex="16" autonext="false" maxlength="8" format="99999999" style="left:99px; top:4px; width:55px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[	

					var agn = lpad(inp_agn.currentText, 8, "0");
					if(agn == ""){
						model.setValue("/root/resData/resForm/agn_nm", "");
						inp_agn_nm.refresh();
						return;
					}
					model.setValue("/root/resData/resForm/agn", agn);
					inp_agn.refresh();
			
					model.removeNode("/root/tempData/reqData");
					makeNodeValue("/root/tempData/reqData/dlco_clsf", "2");
					makeNodeValue("/root/tempData/reqData/dlco_no", agn);
					modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");
					
					if(submit_completed()){
						setAgnResultInfo();
					}
					
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keyCode== "13"){

						var agn = lpad(inp_agn.currentText, 8, "0");
						if(agn == ""){
							model.setValue("/root/resData/resForm/agn_nm", "");
							inp_agn_nm.refresh();
							return;
						}
						model.setValue("/root/resData/resForm/agn", agn);
						inp_agn.refresh();
				
						model.removeNode("/root/tempData/reqData");
						makeNodeValue("/root/tempData/reqData/dlco_clsf", "2");
						makeNodeValue("/root/tempData/reqData/dlco_no", agn);
						modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");
						
						if(submit_completed()){
							setAgnResultInfo();
						}
					}
					]]>
				</script>
			</input>
			<input id="inp_agn_nm" ref="/root/resData/resForm/agn_nm" navindex="17" imemode="hangul" inputtype="button" crud="R" style="left:159px; top:4px; width:125px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					showAdvcsSearchPopup("", "", "Y", "", "", inp_agn_nm.currentText); 					
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keyCode== "13"){
						var agn_nm = inp_agn_nm.currentText;
						if(agn_nm == ""){
							model.setValue("/root/resData/resForm/agn", "");
							inp_agn.refresh();
							return;
						}
						model.setValue("/root/resData/resForm/agn_nm", agn_nm);
						inp_agn_nm.refresh();
				
						model.removeNode("/root/tempData/reqData");
						makeNodeValue("/root/tempData/reqData/dlco_clsf", "2");
						makeNodeValue("/root/tempData/reqData/dlco_nm", agn_nm);
						modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");
						
						if(submit_completed()){
							setAgnResultInfo();
						}							
					}							
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[

					var agn_nm = inp_agn_nm.currentText;
					if(agn_nm == ""){
						model.setValue("/root/resData/resForm/agn", "");
						inp_agn.refresh();
						return;
					}
					model.setValue("/root/resData/resForm/agn_nm", agn_nm);
					inp_agn_nm.refresh();
			
					model.removeNode("/root/tempData/reqData");
					makeNodeValue("/root/tempData/reqData/dlco_clsf", "2");
					makeNodeValue("/root/tempData/reqData/dlco_nm", agn_nm);
					modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");
					
					if(submit_completed()){
						setAgnResultInfo();
					}
					
					]]>
				</script>
			</input>
		</group>
		<group id="grp_hndl_clsf" style="left:10px; top:230px; width:926px; height:26px; ">
			<caption id="caption3" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; "/>
			<input id="inp_coms_rate" ref="/root/resData/resForm/coms_rate" navindex="22" maxlength="2" format="#,###" style="left:393px; top:4px; width:85px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
			
					var pubc_tot_amt = 	Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));
					var coms_rate  	= 	Number(model.getValue("/root/resData/resForm/coms_rate"));
					
					var coms			=	pubc_tot_amt * (coms_rate /100);
					
					model.setValue("/root/resData/resForm/coms", coms);
					inp_coms.refresh();
							
					]]>
				</script>
			</input>
			<input id="inp_coms" ref="/root/resData/resForm/coms" navindex="23" format="#,###" style="left:672px; top:4px; width:85px; height:18px; text-align:right; "/>
			<caption id="caption20" class="list_cap03" style="left:572px; top:0px; width:94px; height:26px; ">수수료</caption>
			<caption id="cap_hndl_clsf" class="list_cap03" style="left:0px; top:0px; width:94px; height:26px; ">광고지사</caption>
			<caption id="caption19" class="list_cap03" style="left:294px; top:0px; width:94px; height:26px; ">수수료율</caption>
			<output id="inp_hndl_plac_cd" ref="/root/resData/resForm/hndl_plac_cd" navindex="20" format="99999999" appearance="output" maxlength="8" style="left:99px; top:4px; width:55px; height:18px; "/>
			<output id="inp_hndl_plac_nm" ref="/root/resData/resForm/hndl_plac_nm" navindex="21" inputtype="button" appearance="output" crud="R" style="left:159px; top:4px; width:125px; height:18px; "/>
		</group>
		<input id="inp_dlco_no" ref="/root/resData/resForm/dlco_no" class="req" navindex="4" autonext="false" format="99999999" caption="광고주" style="left:700px; top:76px; width:65px; height:18px; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
					var dlco_no = inp_dlco_no.currentText;
					if(dlco_no	== "")	return;
					
					model.setValue("/root/resData/resForm/dlco_no", lpad(dlco_no, 8, "0"));
					inp_dlco_no.refresh();
			
					model.removeNode("/root/tempData/reqData");
					makeNodeValue("/root/tempData/reqData/dlco_clsf", "1");
					makeNodeValue("/root/tempData/reqData/dlco_no", model.getValue("/root/resData/resForm/dlco_no"));
					modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");
					
					if(submit_completed()){
						setDlcoResultInfo();
					}				
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode== "13"){

					var dlco_no = inp_dlco_no.currentText;
					if(dlco_no	== "")	return;
					
					model.setValue("/root/resData/resForm/dlco_no", lpad(dlco_no, 8, "0"));
					inp_dlco_no.refresh();
					
					model.removeNode("/root/tempData/reqData");
					makeNodeValue("/root/tempData/reqData/dlco_clsf", "1");
					makeNodeValue("/root/tempData/reqData/dlco_no", model.getValue("/root/resData/resForm/dlco_no"));
					modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");
					
					if(submit_completed()){
						setDlcoResultInfo();
					}
				}
				]]>
			</script>
		</input>
		<input id="inp_dlco_nm" ref="/root/resData/resForm/dlco_nm" class="req" navindex="5" imemode="hangul" inputtype="button" caption="광고주" style="left:768px; top:76px; width:154px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				showAdvcsSearchPopup("Y", "Y", "", "", "", inp_dlco_nm.currentText); 
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[				
				if(event.keyCode== "13"){
					var dlco_nm	=	inp_dlco_nm.currentText;
					if(dlco_nm	== "")	return;
					model.setValue("/root/resData/resForm/dlco_nm", dlco_nm);
					model.removeNode("/root/tempData/reqData");
					makeNodeValue("/root/tempData/reqData/dlco_clsf", "1");
					makeNodeValue("/root/tempData/reqData/dlco_nm", dlco_nm);
					modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");
					
					if(submit_completed()){
						setDlcoResultInfo();
					}					
				}					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[

					var dlco_nm = inp_dlco_nm.currentText;
					if(dlco_nm	== "")	return;
					
					model.removeNode("/root/tempData/reqData");
					makeNodeValue("/root/tempData/reqData/dlco_clsf", "1");
					makeNodeValue("/root/tempData/reqData/dlco_nm", dlco_nm);
					modelSendNoMake("ad_co_9010_s", "/ad/common/9010", "/root/tempData/reqData", "/root/tempData/resData");
					
					if(submit_completed()){
						setDlcoResultInfo();
					}					
				]]>
			</script>
		</input>
		<input id="inp_vat" ref="/root/resData/resForm/vat" class="req" navindex="11" format="#,###" caption="부가세" style="left:484px; top:154px; width:105px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
				recalculate("", "", "Y", "", "");
				]]>
			</script>
		</input>
		<input id="inp_indt_clsf" ref="/root/resData/resForm/indt_clsf" class="req" navindex="28" caption="업종구분" appearance="input" style="left:403px; top:259px; width:45px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				commonSubmission("9009", inp_indt_clsf.currentText,  inp_indt_clsf, inp_indt_clsf_nm);					
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					commonSubmission("9009", inp_indt_clsf.currentText,  inp_indt_clsf, inp_indt_clsf_nm);
				}
				]]>
			</script>
		</input>
		<input id="inp_type_clsf" ref="/root/resData/resForm/type_clsf" class="req" navindex="30" caption="유형구분" appearance="input" style="left:403px; top:284px; width:45px; height:18px; text-align:center; ">
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				commonSubmission("9010", inp_type_clsf.currentText,  inp_type_clsf, inp_type_clsf_nm);	
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
				if(event.keyCode == "13"){
					commonSubmission("9010", inp_type_clsf.currentText,  inp_type_clsf, inp_type_clsf_nm);	
				}
				]]>
			</script>
		</input>
		<output id="out_exrate" ref="/root/resData/resForm/exrate" format="#,###.0000" style="left:682px; top:284px; width:120px; height:18px; text-align:right; border-style:solid; "/>
		<input id="inp_seq" ref="/root/reqData/searchData/preng_occr_seq" navindex="3" inputtype="button" maxlength="4" format="9999" style="left:534px; top:76px; width:70px; height:18px; text-align:right; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				
					model.copyNode("/root/reqData/fwdData", "/root/reqData/searchData");					
					window.load("./AD_BRN_1001.xrw"
							    , "modal"
							    , ""
							    , "align:center; width:954; height:756; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
							    , "/root/reqData/fwdData"
							    , "/root/reqData/fwdData"
							    )
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var preng_occr_seq = model.getValue("/root/reqData/searchData/preng_occr_seq");
					
					model.setValue("/root/reqData/searchData/preng_occr_seq", lpad(preng_occr_seq, 4, "0"));
					inp_seq.refresh();
				
				]]>
			</script>
		</input>
		<caption id="caption16" class="list_cap01" style="left:10px; top:71px; width:76px; height:28px; ">매체구분</caption>
		<select1 id="cb_medi_cd" ref="/root/reqData/searchData/medi_cd" navindex="1" appearance="minimal" style="left:89px; top:76px; width:100px; height:18px; ">
			<choices>
				<item>
					<label>110 본지</label>
					<value>110</value>
				</item>
				<item>
					<label>130 소년</label>
					<value>130</value>
				</item>
				<item>
					<label>350 디지털</label>
					<value>350</value>
				</item>
			</choices>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					changeOnMediCd();
				]]>
			</script>
		</select1>
		<button id="btn_qry" class="btn02" crud="R" style="left:595px; top:40px; width:50px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var preng_occr_dt  = model.getValue("/root/reqData/searchData/preng_occr_dt");
					var preng_occr_seq = model.getValue("/root/reqData/searchData/preng_occr_seq");
					
					if(preng_occr_dt == ""){
						alert("게재일자와 순번을 확인하세요.");
						model.setFocus("inp_preng_occr_dt");
						return;
					}
					
					if(preng_occr_seq == ""){
						alert("게재일자와 순번을 확인하세요.");
						model.setFocus("inp_seq");
						return;
					}
					
					loadData();
				]]>
			</script>
		</button>
		<button id="btn_ins" class="btn02" crud="C" style="left:653px; top:40px; width:50px; height:21px; ">
			<caption>입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if(validateReq()){					
					if(checkAll()){
						var pubc_clsf = model.getValue("/root/resData/resForm/pubc_clsf");
						var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");
						if(pubc_clsf != "3" && medi_cd != "350"){//돌출광고가 아닌 경우만 Check
							var sect_nm = model.getValue("/root/resData/resForm/sect_nm");
							var uprc = Number(model.getValue("/root/resData/resForm/uprc"));
							var sect_cd  = sect_nm.substring(0,1);
							if(sect_nm != "0"){
								if(sect_cd == "A"){
									if(uprc > 60000 || uprc < 30000){
										if(window.alert("광고 단가를 확인하십시오. 계속 입력하시겠습니까?", "확인", 1) != 1){
											return;
										}
									}
								}else{
									if(uprc > 45000 || uprc < 30000){
										if(window.alert("광고 단가를 확인하십시오. 계속 입력하시겠습니까?", "확인", 1) != 1){
											return;
										}
									}
								}
							}
						}
																
						model.setValue("/root/resData/resForm/medi_cd", model.getValue("/root/reqData/searchData/medi_cd"));
						model.setValue("/root/resData/resForm/preng_occr_dt", model.getValue("/root/reqData/searchData/preng_occr_dt"));
						model.setValue("/root/resData/resForm/preng_occr_seq", model.getValue("/root/reqData/searchData/preng_occr_seq"));
	//					model.setValue("/root/resData/resForm/dlco_no", model.getValue("/root/reqData/searchData/dlco_no"));
	
						if(instance1.selectSingleNode("/root/resData/resForm/flag") == null){
							model.makeNode("/root/resData/resForm/flag");
						}
						
						if(windowConfirm("입력하시겠습니까?")){
							model.setValue("/root/resData/resForm/flag", "I");
							model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");
							model.send("ad_brn_1020_a");
							if(submit_completed()){
								var preng_occr_seq = model.getValue("/root/msgData/preng_occr_seq");
								model.setValue("/root/reqData/searchData/preng_occr_seq", preng_occr_seq);
								inp_seq.refresh();
							}
						}
					}
				}
				]]>
			</script>
		</button>
		<button id="btn_upd" class="btn02" crud="U" style="left:711px; top:40px; width:50px; height:21px; ">
			<caption>수정</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if(validateReq()){					
					if(checkAll()){						
						var chrg_aprv 		= model.getValue("/root/resData/resForm/chrg_aprv");
						var part_chf_aprv 	= model.getValue("/root/resData/resForm/part_chf_aprv");
						var team_chf_aprv 	= model.getValue("/root/resData/resForm/team_chf_aprv");	
						
						if(chrg_aprv == "Y" || part_chf_aprv == "Y" ||  team_chf_aprv == "Y"){
							alert("이미 승인된 자료이므로 수정이 불가능 합니다. ");
							return;
						}									

						var pubc_clsf = model.getValue("/root/resData/resForm/pubc_clsf");
						var medi_cd = model.getValue("/root/reqData/searchData/medi_cd");
						if(pubc_clsf != "3" && medi_cd != "350"){//돌출광고가 아닌 경우만 Check
							var sect_nm = model.getValue("/root/resData/resForm/sect_nm");
							var uprc = Number(model.getValue("/root/resData/resForm/uprc"));
							var sect_cd  = sect_nm.substring(0,1);
							if(sect_nm != "0"){
								if(sect_cd == "A"){
									if(uprc > 60000 || uprc < 30000){
									  	if(window.alert("광고 단가를 확인하십시오. 계속 입력하시겠습니까?", "확인", 1) != 1){
									  		return;
									  	}
									}
								}else{
									if(uprc > 45000 || uprc < 30000){
										if(window.alert("광고 단가를 확인하십시오. 계속 입력하시겠습니까?", "확인", 1) != 1){
											return;
										}
									}
								}
							}
						}
												
						if(window.alert("수정하시겠습니까?", "확인", 1) == 1){
							model.setValue("/root/resData/resForm/medi_cd", model.getValue("/root/reqData/searchData/medi_cd"));
							model.setValue("/root/resData/resForm/preng_occr_dt", model.getValue("/root/reqData/searchData/preng_occr_dt"));
							model.setValue("/root/resData/resForm/preng_occr_seq", model.getValue("/root/reqData/searchData/preng_occr_seq"));
							
							if(instance1.selectSingleNode("/root/resData/resForm/flag") == null){
								model.makeNode("/root/resData/resForm/flag");
							}
							model.setValue("/root/resData/resForm/flag", "U");
							model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");
							model.send("ad_brn_1020_a");
							if(submit_completed()){
								var preng_occr_seq = model.getValue("/root/msgData/preng_occr_seq");
								model.setValue("/root/reqData/searchData/preng_occr_seq", preng_occr_seq);
								inp_seq.refresh();
								loadData();
							}
						}
					}					
				}
				]]>
			</script>
		</button>
		<button id="btn_del" class="btn02" crud="D" style="left:769px; top:40px; width:50px; height:21px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				if(validateReq()){
						
					var chrg_aprv 		= model.getValue("/root/resData/resForm/chrg_aprv");
					var part_chf_aprv 	= model.getValue("/root/resData/resForm/part_chf_aprv");
					var team_chf_aprv 	= model.getValue("/root/resData/resForm/team_chf_aprv");	
					
					if(chrg_aprv == "Y" || 	part_chf_aprv == "Y" ||  team_chf_aprv == "Y"){
						alert("이미 승인된 자료이므로 삭제가 불가능 합니다. ");
						return;
					}			
											
					if(window.alert("삭제하시겠습니까?", "확인", 1) == 1){
		 				model.setValue("/root/resData/resForm/medi_cd", model.getValue("/root/reqData/searchData/medi_cd"));
						model.setValue("/root/resData/resForm/preng_occr_dt", model.getValue("/root/reqData/searchData/preng_occr_dt"));
						model.setValue("/root/resData/resForm/preng_occr_seq", model.getValue("/root/reqData/searchData/preng_occr_seq"));
						
						if(instance1.selectSingleNode("/root/resData/resForm/flag") == null){
							model.makeNode("/root/resData/resForm/flag");
						}
						model.setValue("/root/resData/resForm/flag", "D");
						model.copyNode("/root/reqData/reqForm", "/root/resData/resForm");
						model.send("ad_brn_1020_a");
						if(submit_completed()){
							model.reset();
							initPage();
						}
					}				
				}
				]]>
			</script>
		</button>
		<button id="btn_init" class="btn02" crud="R" style="left:827px; top:40px; width:50px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.reset();
				inp_seq.disabled = false;
				
				btn_qry.disabled = false;
				btn_ins.disabled = false;
				btn_upd.disabled = true;
				btn_del.disabled = true;
				]]>
			</script>
		</button>
		<button id="btnClose" class="btn02" style="left:885px; top:40px; width:50px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
								
				]]>
			</script>
		</button>
		<output id="output1" ref="/root/resData/resForm/org_preng_occr_dt" visibility="hidden" style="left:400px; top:530px; width:115px; height:18px; "/>
		<output id="output9" ref="/root/resData/resForm/org_preng_occr_seq" visibility="hidden" style="left:520px; top:530px; width:145px; height:18px; "/>
		<group id="group1" style="left:0px; top:125px; width:419px; height:50px; ">
			<caption id="caption18" class="list_cap03" style="left:207px; top:0px; width:70px; height:30px; text-align:center; ">색도</caption>
			<output id="out_chro_clsf_nm" ref="/root/resData/resForm/chro_clsf_nm" appearance="output" style="left:207px; top:29px; width:70px; height:18px; text-align:center; "/>
			<caption id="caption37" class="list_cap03" style="left:10px; top:0px; width:60px; height:30px; text-align:center; ">면</caption>
			<caption id="caption38" class="list_cap03" style="left:138px; top:0px; width:70px; height:30px; text-align:center; ">CM</caption>
			<caption id="caption43" class="list_cap03" style="left:69px; top:0px; width:70px; height:30px; text-align:center; ">단</caption>
			<input id="inp_sect_nm" ref="/root/resData/resForm/sect_nm" navindex="6" imemode="disabled" style="left:10px; top:29px; width:60px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="onkeyup">
					<![CDATA[
				upperCase(inp_sect_nm);
				]]>
				</script>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
					var medi_cd =  model.getValue("/root/reqData/searchData/medi_cd");
					
					var sect_nm =  model.getValue("/root/resData/resForm/sect_nm");
					
					if(sect_nm != ""){
						
						sect_nm = sect_nm.toUpperCase();
						
//						if(sect_nm == _sect_nm) return;
						
						model.setValue("/root/resData/resForm/sect_nm", sect_nm);
						inp_sect_nm.refresh();
						
						model.makeNode("/root/reqData/searchData/sect_nm");
						model.setValue("/root/reqData/searchData/sect_nm", sect_nm);
						
						modelSendNoMake("ad_co_9003_s", "/ad/common/9003", "/root/reqData/searchData", "/root/tempData");		
						
						var issu_side	=	model.getValue("/root/tempData/issu_side");
						
//						if(model.getValue("/root/resData/resForm/cm") == ""){
							model.setValue("/root/resData/resForm/cm", model.getValue("/root/tempData/cm"));
//						}
//						if(model.getValue("/root/resData/resForm/dn") == ""){
							model.setValue("/root/resData/resForm/dn", model.getValue("/root/tempData/dn"));
//						}
						
						var chro_clsf	=		model.getValue("/root/tempData/chro_clsf");
						if(chro_clsf	==	"1")		chro_clsf	=	"1";
						else						chro_clsf	=	"2";
							
						model.setValue("/root/resData/resForm/issu_chro_clsf", chro_clsf);
						
						model.setValue("/root/resData/resForm/chro_clsf_nm", model.getValue("/root/tempData/chro_clsf_nm"));
//						if(model.getValue("/root/resData/resForm/tabl_yn") == ""){
							model.setValue("/root/resData/resForm/tabl_yn", model.getValue("/root/tempData/tabl_yn"));
//						}
							
						model.setValue("/root/resData/resForm/pubc_side", model.getValue("/root/tempData/issu_side"));
						
						if(model.getValue("/root/tempData/issu_side") == ""){
//							alert("해당면이 없습니다.");
							model.setValue("/root/resData/resForm/sect_nm", "");
						}
						
						model.refresh();
						//20130307 김상훈 김준과장 요구사항 
						var advt_fee = model.getValue("/root/resData/resForm/advt_fee");
						if(advt_fee != "" || advt_fee != "0"){
							recalculate("", "Y", "", "", "Y");
						}
					}else{
						model.setValue("/root/resData/resForm/pubc_side", "");
						model.setValue("/root/resData/resForm/chro_clsf_nm", "");
						out_pubc_side.refresh();
						out_chro_clsf_nm.refresh();
					}				
				]]>
				</script>
			</input>
			<caption id="caption45" class="list_cap03" style="left:276px; top:0px; width:105px; height:30px; text-align:center; ">단가</caption>
			<input id="inp_uprc" ref="/root/resData/resForm/uprc" class="req" navindex="9" format="#,###" caption="단가" style="left:276px; top:29px; width:105px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						recalculate("Y", "", "", "", "");
					]]>
				</script>
			</input>
			<input id="inp_cm" ref="/root/resData/resForm/cm" navindex="8" format="#,###.9" caption="CM" appearance="input" style="left:138px; top:29px; width:70px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var advt_fee = model.getValue("/root/resData/resForm/advt_fee");
						if(advt_fee == ""){
							recalculate("", "", "", "", "Y");		
						}else{
							recalculate("", "Y", "", "", "Y");		
						}
					]]>
				</script>
			</input>
			<input id="inp_dn" ref="/root/resData/resForm/dn" navindex="7" caption="단" appearance="input" style="left:69px; top:29px; width:70px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var advt_fee = model.getValue("/root/resData/resForm/advt_fee");
						if(advt_fee == ""){
							recalculate("", "", "", "", "Y");		
						}else{
							recalculate("", "Y", "", "", "Y");		
						}
					]]>
				</script>
			</input>
		</group>
		<select1 id="cb_dtls_medi_cd" ref="/root/resData/resForm/dtls_medi_cd" navindex="2" visibility="hidden" appearance="minimal" style="left:194px; top:76px; width:74px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/dtls_medi_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<group id="gr_group1" style="left:10px; top:255px; width:296px; height:102px; ">
			<caption id="caption22" class="list_cap03" style="left:0px; top:0px; width:94px; height:26px; ">광고분류</caption>
			<caption id="caption17" class="list_cap03" style="left:0px; top:25px; width:94px; height:26px; ">색도구분</caption>
			<caption id="caption28" class="list_cap03" style="left:0px; top:50px; width:94px; height:26px; ">게재구분</caption>
			<caption id="caption46" class="list_cap03" style="left:0px; top:75px; width:94px; height:26px; ">판구분</caption>
			<select1 id="cb_advt_clas" ref="/root/resData/resForm/advt_clas" class="req" navindex="23" appearance="minimal" caption="광고분류" style="left:100px; top:4px; width:120px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/advt_clas/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<select1 id="cb_chro_clsf" ref="/root/resData/resForm/chro_clsf" navindex="24" appearance="minimal" caption="색도구분" style="left:100px; top:29px; width:120px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/chro_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<select1 id="cb_pubc_clsf" ref="/root/resData/resForm/pubc_clsf" class="req" navindex="25" appearance="minimal" caption="게재구분" style="left:100px; top:54px; width:120px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/pubc_clas/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
			<select1 id="cb_edt_clsf" ref="/root/resData/resForm/edt_clsf" class="req" navindex="26" appearance="minimal" caption="판구분" style="left:100px; top:79px; width:120px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/edt_clsf/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var pan_gb = model.getValue("/root/resData/resForm/edt_clsf");
					if(pan_gb == "2"){
						inp_coms_rate.value = "25";
					}else{
						inp_coms_rate.value= "";
					}
					var pubc_tot_amt = 	Number(model.getValue("/root/resData/resForm/pubc_tot_amt"));
					var coms_rate  	= 	Number(model.getValue("/root/resData/resForm/coms_rate"));
					
					var coms			=	pubc_tot_amt * (coms_rate /100);
					
					model.setValue("/root/resData/resForm/coms", coms);
	
					inp_coms_rate.refresh();
					inp_coms.refresh();								
					]]>
				</script>
			</select1>
		</group>
		<group id="grp_ast" visibility="hidden" style="left:304px; top:330px; width:923px; height:26px; ">
			<caption id="caption47" class="list_cap03" style="left:0px; top:0px; width:94px; height:26px; ">어시스트</caption>
			<caption id="caption48" class="list_cap03" style="left:278px; top:0px; width:94px; height:26px; ">게재기간</caption>
			<input id="inp_asist_pers" ref="/root/resData/resForm/asist_pers" navindex="4" autonext="false" maxlength="8" format="99999999" caption="광고주" style="left:100px; top:4px; width:65px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					commonSubmission("9005", inp_asist_pers.currentText,  inp_asist_pers, inp_asist_pers_nm);					
				]]>
				</script>
				<script type="javascript" ev:event="onkeydown">
					<![CDATA[
					if( event.keyCode == 13 ){
						commonSubmission("9005", inp_asist_pers.currentText,  inp_asist_pers, inp_asist_pers_nm);	
					}
				]]>
				</script>
			</input>
			<input id="inp_asist_pers_nm" ref="/root/resData/resForm/asist_pers_nm" navindex="5" imemode="hangul" inputtype="button" caption="광고주" style="left:168px; top:4px; width:80px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					searchEmpno("setAsistPers", "/root/resData/resForm/asist_pers", "/root/resData/resForm/asist_pers_nm");
				]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if( event.keyCode == 13 ){
						findEmpNoByName("setAsistPers", inp_asist_pers_nm.currentText, inp_asist_pers, inp_asist_pers_nm);
					}					
				]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					findEmpNoByName("setAsistPers", inp_asist_pers_nm.currentText, inp_asist_pers, inp_asist_pers_nm);
				]]>
				</script>
			</input>
			<input id="pubc_frdt" ref="/root/resData/resForm/pubc_frdt" navindex="2" inputtype="date" format="yyyy-mm-dd" style="left:378px; top:4px; width:95px; height:18px; text-align:center; "/>
			<input id="pubc_todt" ref="/root/resData/resForm/pubc_todt" navindex="2" inputtype="date" format="yyyy-mm-dd" style="left:490px; top:4px; width:95px; height:18px; text-align:center; "/>
			<caption id="caption75" style="left:476px; top:4px; width:15px; height:15px; vertical-align:middle; ">~</caption>
		</group>
		<group id="gr_350" visibility="hidden" style="left:10px; top:255px; width:296px; height:102px; ">
			<caption id="caption25" class="list_cap03" style="left:0px; top:75px; width:94px; height:26px; ">게재구분</caption>
			<select1 id="cd_pubc_clsf_350" ref="/root/resData/resForm/pubc_clsf" navindex="26" appearance="minimal" caption="게재구분" style="left:100px; top:79px; width:120px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/pubc_clas_350/item">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
			</select1>
		</group>
	</xhtml:body>
</xhtml:html>
