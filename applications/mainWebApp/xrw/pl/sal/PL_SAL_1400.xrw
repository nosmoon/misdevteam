<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="/css/style_sheet.css" type="text/css" ?>
<!--*************************************************************************************************
* 파일명 : PL_SAL_1400.xrw
* 기능 : 배본관리-사내판매
* 작성일자 : 2009-04-02
* 작성자 : 김상옥
**************************************************************************************************-->
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>사내판매(PL_SAL_1400)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<medi_clsf>
								<item>
									<cd/>
									<cdnm/>
								</item>
							</medi_clsf>
							<medi_cd>
								<item>
									<cd/>
									<cdnm/>
								</item>
							</medi_cd>
							<sale_clsf>
								<item>
									<cd/>
									<cdnm/>
								</item>
							</sale_clsf>
							<sendclsf>
								<item>
									<cd/>
									<cdnm/>
								</item>
							</sendclsf>
							<wh_cd>
								<item>
									<cd/>
									<cdnm/>
								</item>
							</wh_cd>
							<sell_type>
								<item>
									<cd/>
									<cdnm/>
								</item>
							</sell_type>
						</comboSet>
						<pageInfo/>
					</initData>
					<reqData>
						<fwdData>
							<callgb/>
						</fwdData>
						<searchData>
							<searchTop>
								<medi_clsf/>
								<basi_dt_fr/>
								<basi_dt_to/>
								<dlco_cd/>
								<dlco_seq/>
								<dlco_nm/>
								<send_plac_nm/>
								<phone_no_1/>
								<phone_no_2/>
								<phone_no_3/>
								<owh_yn/>
							</searchTop>
							<searchDtl>
								<ordr_dt/>
								<ordr_grp_seq/>
							</searchDtl>
							<searchDealEtc>
								<deal_clsf/>
								<flag/>
								<dlco_cd/>
								<dlco_seq/>
								<medi_cd/>
								<medi_ser_no/>
							</searchDealEtc>
						</searchData>
						<reqForm>
						</reqForm>
						<multiUpdate>
							<acc_flag/>
							<updateData/>
							<dtlinfo/>
						</multiUpdate>
					</reqData>
					<resData>
						<comboSet/>
						<resform>
							<ORDR_HEADER>
								<medi_clsf/>
								<basi_dt/>
								<dlco_cd/>
								<dlco_seq/>
								<dlco_nm/>
								<send_plac_seq/>
								<send_plac_nm/>
								<send_plac_tel_no_1/>
								<send_plac_tel_no_2/>
								<send_plac_tel_no_3/>
								<send_plac_ptph_no_1/>
								<send_plac_ptph_no_2/>
								<send_plac_ptph_no_3/>
								<send_plac_fax_no_1/>
								<send_plac_fax_no_2/>
								<send_plac_fax_no_3/>
								<send_plac_zip_1/>
								<send_plac_zip_2/>
								<send_plac_addr/>
								<send_plac_dtls_addr/>
								<remk/>
								<ordr_dt/>
								<ordr_grp_seq/>
								<deal_dt/>
								<deal_grp_seq/>
							</ORDR_HEADER>
							<ORDR_PTCRCUR>
								<record>
									<medi_cd/>
									<medi_ser_no/>
									<medi_nm/>
									<stok_qty/>
									<deal_qty/>
									<deal_uprc/>
									<dcrate/>
									<deal_amt/>
									<sale_clsf/>
									<sendclsf/>
									<wh_cd/>
									<sell_type/>
									<ordr_dt/>
									<ordr_grp_seq/>
									<ordr_seq/>
									<deal_dt/>
									<deal_grp_seq/>
									<deal_seq/>
									<medi_clsf/>
									<absence_clsf/>
								</record>
							</ORDR_PTCRCUR>
						</resform>
						<gridData>
							<ORDR_PTCRLIST>
								<record>
									<basi_dt/>
									<dlco_nm/>
									<send_plac_nm/>
									<deal_qty/>
									<deal_amt/>
									<owh_yn/>
									<rcpm_amt/>
									<phone_no/>
									<send_plac_addr/>
									<ordr_dt/>
									<ordr_grp_seq/>
									<medi_clsf/>
									<dlco_cd/>
									<dlco_seq/>
									<clos_yn/>
								</record>
							</ORDR_PTCRLIST>
						</gridData>
						<resultData/>
						<MsgData/>
					</resData>
					<tempData>
						<keyData/>
						<btState/>
						<total>
							<deal_qty_sum/>
							<deal_amt_sum/>
						</total>
					</tempData>
				</root>
			</instance>
			<submission id="pl_sal_1400_m" action="/pl/sal/1400" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/resData/comboSet"/>
			<submission id="pl_sal_1410_l" action="/pl/sal/1410" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchTop" resultref="/root/resData/gridData"/>
			<submission id="pl_sal_1420_l" action="/pl/sal/1420" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchDtl" resultref="/root/resData/resform"/>
			<submission id="pl_sal_1430_a" action="/pl/sal/1430" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpdate" resultref="/root/resData/resultData"/>
			<submission id="pl_com_1510_s" action="/pl/com/1510" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/searchDealEtc" resultref="/root/resData/resultData"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					setReady();
				]]>
			</script>
			<bind id="deal_qty_sum" ref="/root/tempData/total/deal_qty_sum" calculate="sum(/root/resData/resform/ORDR_PTCRCUR/record/deal_qty)"/>
			<bind id="deal_amt_sum" ref="/root/tempData/total/deal_amt_sum" calculate="sum(/root/resData/resform/ORDR_PTCRCUR/record/deal_amt)"/>
			<!--
	//script로 자동계산처리 변경
			<bind id="deal_amt" ref="/root/resData/resform/ORDR_PTCRCUR/record/deal_amt" calculate="(../deal_qty * ../deal_uprc * ../dcrate) div 100"/>
-->
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/CRMComm.js"/>
		<script type="javascript" src="/js/pl_comm.js"/>
		<script type="javascript">
			<![CDATA[
				//초기화 Set
				function setReady(){
					model.send("pl_sal_1400_m");						//Submission

					var basi_fr = addDate("d",-7,commCurDate("ymd"),"");
					var basi_to = commCurDate("ymd");
					
					model.setValue("/root/reqData/searchData/searchTop/basi_dt_fr",basi_fr);
					model.setValue("/root/reqData/searchData/searchTop/basi_dt_to",basi_to);

					model.copyNode("/root/initData/comboSet/medi_clsf","/root/resData/comboSet/medi_clsf");				//매체구분 copy
					model.copyNode("/root/initData/comboSet/medi_cd","/root/resData/comboSet/medi_cd");				//매체코드 copy
					model.copyNode("/root/initData/comboSet/sale_clsf","/root/resData/comboSet/sale_clsf");				//매출구분 copy
					model.copyNode("/root/initData/comboSet/sendclsf","/root/resData/comboSet/sendclsf");				//발송구분 copy
					model.copyNode("/root/initData/comboSet/wh_cd","/root/resData/comboSet/wh_cd");					//창고코드 copy
					model.copyNode("/root/initData/comboSet/sell_type","/root/resData/comboSet/sell_type");				//판매유형 copy

					model.copyNode("/root/resData/resform/ORDR_PTCRCUR","/root/resData/comboSet/ORDR_PTCRCUR");		//주문내역 copy

					model.setValue("/root/tempData/btState","RE");			//버튼제어상태 (RE:초기화)
					buttonControl("RE");		//출고,입금버튼제어

					model.refresh();
				}

				//조회
				function srcRetrieve(){
					//필수체크
					if(!commReqCheck(group1)) {
						return;
					}
					
					model.send("pl_sal_1410_l");						//Submission

					//상세내역 초기화
					model.resetInstanceNode( "/root/resData/resform" );
					datagrid2.clearStatus();
					model.refresh();

					model.setValue("/root/tempData/btState","RT");			//버튼제어상태 (RT:조회)
					buttonControl("RT");		//출고,입금버튼제어
				}

				//상세조회
				function dtlRetrieve(){
					var ordr_dt = datagrid1.valueMatrix(datagrid1.row, 10);					//선택한 레코드의 주문일자
					var ordr_grp_seq = datagrid1.valueMatrix(datagrid1.row, 11);				//선택한 레코드의 주문그룹순번

					//REQUEST 노드에 키값 SET
					model.setValue("/root/reqData/searchData/searchDtl/ordr_dt",ordr_dt);				//주문일자
					model.setValue("/root/reqData/searchData/searchDtl/ordr_grp_seq",ordr_grp_seq);		//주문그룹순번

					model.send("pl_sal_1420_l");						//Submission

					model.setValue("/root/tempData/btState","DT");			//버튼제어상태 (DT:상세조회)
					buttonControl("DT");		//출고,입금버튼제어

					model.refresh();
				}

				//저장처리
				function saveProcess(){
					var btnctl = model.getValue("/root/tempData/btState");	//버튼제어상태 Get
					
					//Confirm체크
					if(!commConfirmBox("저장 하시겠습니까?", "저장")){
						return;
					}

					//필수체크
					if(!commReqCheck(group3)) {
						return;
					}
					
					model.setValue("/root/reqData/multiUpdate/acc_flag","S");								//저장 플래그 Set
					model.copyNode("/root/reqData/multiUpdate/dtlinfo","/root/resData/resform/ORDR_HEADER");		//Request 노드카피
					model.setValue("/root/reqData/multiUpdate/updateData",datagrid2.getUpdateData());				//상세내역 그리드 Set
					
					model.send("pl_sal_1430_a");						//Submission

					//에러체크
					if(submit_completed()){
						model.send("pl_sal_1410_l");					//Submission(조회)

						model.resetInstanceNode( "/root/resData/resform" );
						datagrid2.clearStatus();
						model.refresh();

						model.setValue("/root/tempData/btState","SA");		//버튼제어상태 (SA:저장)
						buttonControl("SA");		//출고,입금버튼제어
					}
				}

				//삭제처리
				function deleteProcess(){
					var btnctl = model.getValue("/root/tempData/btState");	//버튼제어상태 Get
					
					//Confirm체크
					if(!commConfirmBox("삭제 하시겠습니까?", "삭제")){
						return;
					}

					//버튼체크
					if(btnctl != "DT"){
						commAlert("상세조회 후 삭제할 수 있습니다.");
						return;
					}

					//필수체크
					if(!commReqCheck(group3)) {
						return;
					}
					
					//선택 row 상태변경
					pl_grid_select_del("datagrid2");

					model.setValue("/root/reqData/multiUpdate/acc_flag","D");								//작업FLAG Set(D:삭제)
					model.copyNode("/root/reqData/multiUpdate/dtlinfo","/root/resData/resform/ORDR_HEADER");		//Request 노드카피
					model.setValue("/root/reqData/multiUpdate/updateData",datagrid2.getUpdateData());				//상세내역 그리드 Set
					
					model.send("pl_sal_1430_a");						//Submission

					//에러체크
					if(submit_completed()){
						model.send("pl_sal_1410_l");					//Submission(조회)

						model.resetInstanceNode( "/root/resData/resform" );
						datagrid2.clearStatus();
						model.refresh();

						model.setValue("/root/tempData/btState","DE");		//버튼제어상태 (DE:삭제)
						buttonControl("DE");		//출고,입금버튼제어
					}
				}

				//출고,입금처리버튼 제어
				function buttonControl(clickBtn){
					//상세조회일 경우만 버튼 활성화
					if(clickBtn == "DT"){
						var owh_yn = datagrid1.valueMatrix(datagrid1.row, 6);				//선택한 레코드의 출고여부
						var deal_amt = parseInt(datagrid1.valueMatrix(datagrid1.row, 5));		//선택한 레코드의 거래금액
						var rcpm_amt = parseInt(datagrid1.valueMatrix(datagrid1.row, 7));		//선택한 레코드의 입금액

						var crud = model.getValue("/root/initData/pageInfo/strCrud");					//권한
						var crudTF;

						crudTF = crud.indexOf("C");
						
						if(crudTF >= 0){
							btnOwh.disabled = false;
							btnRcpm.disabled = false;
	
							if(owh_yn != "Y"){
								btnRcpm.disabled = true;
							}
						}else{
							btnOwh.disabled = true;
							btnRcpm.disabled = true;
						}
					}else{
						btnOwh.disabled = true;
						btnRcpm.disabled = true;
					}
				}

				//출고처리
				function beforeOwhprocess(){
					var btnctl = model.getValue("/root/tempData/btState");	//버튼제어상태 Get
					
					//Confirm체크
					if(!commConfirmBox("주문내역에 대해 출고 작업 하시겠습니까?", "출고")){
						return;
					}

					//버튼체크
					if(btnctl != "DT"){
						commAlert("상세조회 후 처리 가능합니다.");
						return;
					}

					model.property("processflag")		=	"";																//처리초기화
					model.property("ordr_dt")			=	model.getValue("/root/resData/resform/ORDR_HEADER/ordr_dt");				//주문일자 Set
					model.property("ordr_grp_seq")		=	model.getValue("/root/resData/resform/ORDR_HEADER/ordr_grp_seq");			//주문그룹순번 Set
					model.property("medi_clsf")		=	model.getValue("/root/resData/resform/ORDR_HEADER/medi_clsf");				//매체구분 Set
					model.property("dlco_cd")			=	model.getValue("/root/resData/resform/ORDR_HEADER/dlco_cd");				//거래처코드 Set
					model.property("dlco_seq")		=	model.getValue("/root/resData/resform/ORDR_HEADER/dlco_seq");				//거래처순번 Set
					model.property("dlco_nm")		=	model.getValue("/root/resData/resform/ORDR_HEADER/dlco_nm");				//거래처명 Set
					model.property("send_plac_seq")	=	model.getValue("/root/resData/resform/ORDR_HEADER/send_plac_seq");			//발송처순번 Set
					model.property("send_plac_nm")	=	model.getValue("/root/resData/resform/ORDR_HEADER/send_plac_nm");			//발송처명 Set
					model.property("remk")			=	model.getValue("/root/resData/resform/ORDR_HEADER/remk");				//비고 Set

					window.load(
							"/xrw/pl/com/PL_COM_1200.xrw", 
							"modal", 
							"", 
							"left:200px; top:200px; width:410px; height:310px; align:center; caption:hidden;"
							,""
							,""
						);
					
					//처리결과 체크
					if(model.property("processflag") == "P"){
						model.send("pl_sal_1410_l");					//Submission(조회)

						model.resetInstanceNode( "/root/resData/resform" );
						datagrid2.clearStatus();
						model.refresh();

						model.setValue("/root/tempData/btState","BO");		//버튼제어상태 (BO:출고처리)
						buttonControl("BO");		//출고,입금버튼제어
					}
				}

				//입금처리
				function Rcpmprocess(){
					var btnctl = model.getValue("/root/tempData/btState");	//버튼제어상태 Get
					
					//Confirm체크
					if(!commConfirmBox("주문내역에 대해 입금 작업 하시겠습니까?", "입금")){
						return;
					}

					//버튼체크
					if(btnctl != "DT"){
						commAlert("상세조회 후 처리 가능합니다.");
						return;
					}

					model.property("processflag")		=	"";																//처리초기화
					model.property("deal_dt")			=	model.getValue("/root/resData/resform/ORDR_HEADER/deal_dt");				//거래일자 Set
					model.property("deal_grp_seq")		=	model.getValue("/root/resData/resform/ORDR_HEADER/deal_grp_seq");			//거래그룹순번 Set
					model.property("ordr_dt")			=	model.getValue("/root/resData/resform/ORDR_HEADER/ordr_dt");				//주문일자 Set
					model.property("ordr_grp_seq")		=	model.getValue("/root/resData/resform/ORDR_HEADER/ordr_grp_seq");			//주문그룹순번 Set
					model.property("medi_clsf")		=	model.getValue("/root/resData/resform/ORDR_HEADER/medi_clsf");				//매체구분 Set
					model.property("dlco_cd")			=	model.getValue("/root/resData/resform/ORDR_HEADER/dlco_cd");				//거래처코드 Set
					model.property("dlco_seq")		=	model.getValue("/root/resData/resform/ORDR_HEADER/dlco_seq");				//거래처순번 Set
					model.property("dlco_nm")		=	model.getValue("/root/resData/resform/ORDR_HEADER/dlco_nm");				//거래처명 Set

					window.load(
							"/xrw/pl/com/PL_COM_1300.xrw", 
							"modal", 
							"", 
							"left:200px; top:200px; width:650px; height:490px; align:center; caption:hidden;"
							,""
							,""
						);
					
					//처리결과 체크
					if(model.property("processflag") == "R"){
						model.send("pl_sal_1410_l");					//Submission(조회)

						model.resetInstanceNode( "/root/resData/resform" );
						datagrid2.clearStatus();
						model.refresh();

						model.setValue("/root/tempData/btState","RC");		//버튼제어상태 (RC:입금처리)
						buttonControl("RC");		//출고,입금버튼제어
					}
				}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="1,13;2,65;2,70;1,933;2,725;" style="font-family:굴림; vertical-align:top; ">
		<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<button id="btnReset" class="btn03" style="left:580px; top:45px; width:63px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.reset();

					var basi_fr = addDate("d",-7,commCurDate("ymd"),"");
					var basi_to = commCurDate("ymd");
					
					model.setValue("/root/reqData/searchData/searchTop/basi_dt_fr",basi_fr);
					model.setValue("/root/reqData/searchData/searchTop/basi_dt_to",basi_to);

					datagrid2.clearStatus();
					model.setValue("/root/tempData/btState","RE");		//버튼제어상태 (RE:초기화)
					buttonControl("RE");		//출고,입금버튼제어
				]]>
			</script>
		</button>
		<button id="btnRetrieve" class="btn03" crud="R" style="left:649px; top:45px; width:63px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					srcRetrieve();
				]]>
			</script>
		</button>
		<button id="btnSave" class="btn03" crud="C" style="left:718px; top:45px; width:63px; height:21px; ">
			<caption>저장</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					saveProcess();
				]]>
			</script>
		</button>
		<button id="btnDelete" class="btn03" crud="D" style="left:788px; top:45px; width:63px; height:21px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					deleteProcess();
				]]>
			</script>
		</button>
		<button id="btnClose" class="btn03" style="left:857px; top:45px; width:63px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
				]]>
			</script>
		</button>
		<group id="group1" style="left:13px; top:70px; width:920px; height:55px; ">
			<caption id="caption11" class="list_cap02" style="left:0px; top:0px; width:920px; height:26px; "/>
			<caption id="caption18" class="list_cap03" style="left:0px; top:0px; width:70px; height:26px; ">매체구분</caption>
			<caption id="caption5" class="list_cap03" style="left:200px; top:0px; width:70px; height:26px; ">주문기간</caption>
			<caption id="caption13" class="list_cap03" style="left:517px; top:0px; width:70px; height:26px; ">거래처</caption>
			<caption id="caption7" class="list_cap02" style="left:0px; top:25px; width:920px; height:26px; "/>
			<caption id="caption8" class="list_cap03" style="left:0px; top:25px; width:70px; height:26px; ">고객명</caption>
			<caption id="caption9" class="list_cap03" style="left:200px; top:25px; width:70px; height:26px; ">전화번호</caption>
			<caption id="caption16" class="list_cap03" style="left:517px; top:25px; width:70px; height:26px; ">출고유무</caption>
			<select1 id="combo4" ref="/root/reqData/searchData/searchTop/medi_clsf" class="req" appearance="minimal" caption="매체구분" style="left:73px; top:4px; width:100px; height:18px; text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/medi_clsf/item">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</select1>
			<input id="input8" ref="/root/reqData/searchData/searchTop/basi_dt_fr" class="req" inputtype="date" format="yyyy-mm-dd" caption="주문기간FROM" style="left:273px; top:4px; width:100px; height:18px; text-align:left; "/>
			<caption id="caption10" style="left:372px; top:4px; width:20px; height:18px; font-weight:bold; text-align:center; ">~</caption>
			<input id="input10" ref="/root/reqData/searchData/searchTop/basi_dt_to" class="req" inputtype="date" format="yyyy-mm-dd" caption="주문기간TO" style="left:391px; top:4px; width:100px; height:18px; text-align:left; "/>
			<input id="dlco_cd_s" ref="/root/reqData/searchData/searchTop/dlco_cd" disabled="true" appearance="input" style="left:590px; top:4px; width:60px; height:18px; text-align:center; "/>
			<input id="dlco_seq_s" ref="/root/reqData/searchData/searchTop/dlco_seq" disabled="true" appearance="input" style="left:653px; top:4px; width:40px; height:18px; text-align:center; "/>
			<input id="dlco_nm_s" ref="/root/reqData/searchData/searchTop/dlco_nm" inputtype="button" style="left:696px; top:4px; width:200px; height:18px; text-align:left; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						var dlco_nm = dlco_nm_s.currentText;	

						//거래처명 체크
						if(dlco_nm == ""){
							model.setValue("/root/reqData/searchData/searchTop/dlco_cd","");		//거래처코드 초기화
							model.setValue("/root/reqData/searchData/searchTop/dlco_seq","");	//거래처순번 초기화
						}

						//거래처검색 Call
						pl_getDlcoInfo_p("B",
									"N",
									"/root/reqData/searchData/searchTop",
									"",
									"dlco_cd",
									"dlco_seq",
									"dlco_nm",
									"",
									"",
									"")
						 /*
						 * - btnChk(버튼체크) : B-버튼클릭, P-버튼클릭외(INPUT BOX OR ENTER)
						 * - flag(형태구분)   : N-일반 컴포넌트, G-그리드 컴퍼넌트
						 * - rootPath         : 상위노드 xpath  
						 * - grid             : grid 호출일경우 grid id명(String)
						 * - dlco_cdReq       : 거래처코드 Element명
						 * - dlco_seqReq      : 거래처순번 Element명
						 * - dlco_nmReq       : 거래처명 Element명
						 * - dlco_clsfReq     : 거래처구분 Element명
						 * - areaReq          : 지역 Element명
						 * - prv_curr_clsfReq : 전현임구분 Element명
						*/

						//refresh
						group1.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="onkeydown">
					<![CDATA[
						//엔터키 체크
						if(event.keyCode == 13) {
							var dlco_nm = dlco_nm_s.currentText;										//거래처명
							if(dlco_nm == ""){
								model.setValue("/root/reqData/searchData/searchTop/dlco_cd","");				//거래처코드 초기화
								model.setValue("/root/reqData/searchData/searchTop/dlco_seq","");			//거래처순번 초기화
								return;
							}else{
								model.setValue("/root/reqData/searchData/searchTop/dlco_nm",dlco_nm);		//거래처명 초기화
							}
							
							//거래처검색 Call
							pl_getDlcoInfo_p("P",
										"N",
										"/root/reqData/searchData/searchTop",
										"",
										"dlco_cd",
										"dlco_seq",
										"dlco_nm",
										"",
										"",
										"")
							
							//refresh
							group1.refresh();
						}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var dlco_nm = model.getValue("/root/reqData/searchData/searchTop/dlco_nm");	//거래처명
					
						//거래처명 null인 경우 코드 초기화
						if(dlco_nm == ""){
							model.setValue("/root/reqData/searchData/searchTop/dlco_cd","");			//거래처명 초기화
							model.setValue("/root/reqData/searchData/searchTop/dlco_seq","");		//거래처순번 초기화
							return;
						}

						//refresh
						group1.refresh();
					]]>
				</script>
			</input>
			<input id="input1" ref="/root/reqData/searchData/searchTop/send_plac_nm" style="left:73px; top:29px; width:100px; height:18px; "/>
			<input id="input9" ref="/root/reqData/searchData/searchTop/phone_no_1" format="999" style="left:273px; top:29px; width:35px; height:18px; text-align:center; "/>
			<input id="input11" ref="/root/reqData/searchData/searchTop/phone_no_2" format="9999" style="left:311px; top:29px; width:35px; height:18px; text-align:center; "/>
			<input id="input12" ref="/root/reqData/searchData/searchTop/phone_no_3" format="9999" style="left:349px; top:29px; width:35px; height:18px; text-align:center; "/>
			<select1 id="combo5" ref="/root/reqData/searchData/searchTop/owh_yn" appearance="minimal" style="left:590px; top:29px; width:100px; height:18px; text-align:left; ">
				<choices>
					<item>
						<label>전체</label>
						<value>A</value>
					</item>
					<item>
						<label>출고</label>
						<value>Y</value>
					</item>
					<item>
						<label>미출고</label>
						<value>N</value>
					</item>
				</choices>
			</select1>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:126px; width:926px; height:5px; "/>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/ORDR_PTCRLIST/record" caption="주문일자^거래처^고객명^거래부수^거래금액^출고^입금액^전화/휴대폰^주소^주문일자^주문그룹순번^매체구분^거래처코드^거래처순번^마감여부" colsep="^" colwidth="90, 100, 80, 60, 80, 40, 80, 180, 280, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:13px; top:136px; width:920px; height:244px; ">
			<col ref="basi_dt" format="yyyy-mm-dd" style="text-align:center; "/>
			<col ref="dlco_nm" style="text-align:left; "/>
			<col ref="send_plac_nm" style="text-align:left; "/>
			<col ref="deal_qty" format="###,###,###" style="text-align:right; "/>
			<col ref="deal_amt" format="###,###,###,###" style="text-align:right; "/>
			<col ref="owh_yn" style="text-align:center; "/>
			<col ref="rcpm_amt" format="###,###,###,###" style="text-align:right; "/>
			<col ref="phone_no" style="text-align:center; "/>
			<col ref="send_plac_addr" style="text-align:left; "/>
			<col ref="ordr_dt" visibility="hidden"/>
			<col ref="ordr_grp_seq" visibility="hidden"/>
			<col ref="medi_clsf" visibility="hidden"/>
			<col ref="dlco_cd" visibility="hidden"/>
			<col ref="dlco_seq" visibility="hidden"/>
			<col ref="clos_yn" visibility="hidden"/>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					dtlRetrieve();
				]]>
			</script>
		</datagrid>
		<caption id="caption1" class="tit02" style="left:13px; top:395px; width:257px; height:20px; ">주문  상세  내역</caption>
		<button id="btnOwh" class="btn05" crud="C" style="left:691px; top:392px; width:112px; height:21px; ">
			<caption>출고처리</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					beforeOwhprocess();
				]]>
			</script>
		</button>
		<button id="btnRcpm" class="btn05" crud="C" style="left:808px; top:392px; width:112px; height:21px; ">
			<caption>입금처리</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					Rcpmprocess();
				]]>
			</script>
		</button>
		<group id="group3" style="left:13px; top:415px; width:920px; height:105px; ">
			<caption id="caption12" class="list_cap02" style="left:0px; top:0px; width:920px; height:26px; "/>
			<caption id="caption14" class="list_cap03" style="left:0px; top:0px; width:70px; height:26px; ">매체구분</caption>
			<caption id="caption4" class="list_cap03" style="left:212px; top:0px; width:70px; height:26px; ">주문일자</caption>
			<caption id="caption20" class="list_cap03" style="left:452px; top:0px; width:70px; height:26px; ">거래처</caption>
			<caption id="caption2" class="list_cap02" style="left:0px; top:25px; width:920px; height:26px; "/>
			<caption id="caption17" class="list_cap03" style="left:0px; top:25px; width:70px; height:26px; ">고객명</caption>
			<caption id="caption15" class="list_cap03" style="left:212px; top:25px; width:70px; height:26px; ">전화번호</caption>
			<caption id="caption25" class="list_cap03" style="left:452px; top:25px; width:70px; height:26px; ">휴대폰번호</caption>
			<caption id="caption3" class="list_cap03" style="left:685px; top:25px; width:70px; height:26px; ">팩스번호</caption>
			<caption id="caption21" class="list_cap02" style="left:0px; top:50px; width:920px; height:26px; "/>
			<caption id="caption23" class="list_cap03" style="left:0px; top:50px; width:70px; height:26px; ">주소</caption>
			<caption id="caption22" class="list_cap02" style="left:0px; top:75px; width:920px; height:26px; "/>
			<caption id="caption24" class="list_cap03" style="left:0px; top:75px; width:70px; height:26px; ">비고</caption>
			<select1 id="combo1" ref="/root/resData/resform/ORDR_HEADER/medi_clsf" class="req" appearance="minimal" caption="매체구분" style="left:73px; top:4px; width:100px; height:18px; text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/medi_clsf/item">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var btnctl = model.getValue("/root/tempData/btState");	//버튼제어상태 Get

						//상세내역 초기화
						model.resetInstanceNode( "/root/resData/resform/ORDR_PTCRCUR" );
						datagrid2.clearStatus();
						model.setValue("/root/resData/resform/ORDR_HEADER/ordr_dt","");
						model.setValue("/root/resData/resform/ORDR_HEADER/ordr_grp_seq","");
						model.setValue("/root/resData/resform/ORDR_HEADER/deal_dt","");
						model.setValue("/root/resData/resform/ORDR_HEADER/deal_grp_seq","");
						model.setValue("/root/tempData/btState","RE");		//버튼제어상태 초기화
						model.refresh();
					]]>
				</script>
			</select1>
			<input id="input4" ref="/root/resData/resform/ORDR_HEADER/basi_dt" class="req" inputtype="date" format="yyyy-mm-dd" caption="주문일자" style="left:285px; top:4px; width:100px; height:18px; text-align:left; "/>
			<input id="dlco_cd_s2" ref="/root/resData/resform/ORDR_HEADER/dlco_cd" class="req" disabled="true" caption="거래처코드" appearance="input" style="left:525px; top:4px; width:60px; height:18px; text-align:center; "/>
			<input id="dlco_seq_s2" ref="/root/resData/resform/ORDR_HEADER/dlco_seq" class="req" disabled="true" caption="거래처순번" appearance="input" style="left:588px; top:4px; width:40px; height:18px; text-align:center; "/>
			<input id="dlco_nm_s2" ref="/root/resData/resform/ORDR_HEADER/dlco_nm" class="req" inputtype="button" caption="거래처명" style="left:631px; top:4px; width:220px; height:18px; text-align:left; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						var dlco_cd_bef = dlco_cd_s2.currentText;	
						var dlco_seq_bef = dlco_seq_s2.currentText;	
						var dlco_nm_bef = dlco_nm_s2.currentText;	

						//거래처명 체크
						if(dlco_nm_bef == ""){
							model.resetInstanceNode( "/root/resData/resform/ORDR_PTCRCUR" );
							datagrid2.clearStatus();
							datagrid2.refresh();
							model.setValue("/root/resData/resform/ORDR_HEADER/dlco_cd","");			//거래처코드 초기화
							model.setValue("/root/resData/resform/ORDR_HEADER/dlco_seq","");			//거래처순번 초기화
							model.setValue("/root/resData/resform/ORDR_HEADER/send_plac_seq","");		//발송처순번 초기화
							model.setValue("/root/resData/resform/ORDR_HEADER/ordr_dt","");
							model.setValue("/root/resData/resform/ORDR_HEADER/ordr_grp_seq","");
							model.setValue("/root/resData/resform/ORDR_HEADER/deal_dt","");
							model.setValue("/root/resData/resform/ORDR_HEADER/deal_grp_seq","");
						}

						//거래처발송처검색 Call
						pl_getDlcoSendPlac_p("B",
										"N",
										"/root/resData/resform/ORDR_HEADER",
										"",
										"dlco_cd",
										"dlco_seq",
										"dlco_nm",
										"send_plac_seq",
										"",
										"",
										"",
										"")
						 /*
						 * - btnChk(버튼체크) : B-버튼클릭, P-버튼클릭외(INPUT BOX OR ENTER)
						 * - flag(형태구분)   : N-일반 컴포넌트, G-그리드 컴퍼넌트
						 * - rootPath         : 상위노드 xpath  
						 * - grid             : grid 호출일경우 grid id명(String)
						 * - dlco_cdReq       : 거래처코드 Element명
						 * - dlco_seqReq      : 거래처순번 Element명
						 * - dlco_nmReq       : 거래처명 Element명
						 * - send_plac_seqReq : 발송처순번 Element명
						 * - send_plac_nmReq  : 발송처명 Element명
						 * - dlco_clsfReq     : 거래처구분 Element명
						 * - areaReq          : 지역 Element명
						 * - prv_curr_clsfReq : 전현임구분 Element명
						*/

						//set node값 get
						var dlco_cd = model.getValue("/root/resData/resform/ORDR_HEADER/dlco_cd");
						var dlco_seq = model.getValue("/root/resData/resform/ORDR_HEADER/dlco_seq");

						//변경체크
						if(dlco_cd != dlco_cd_bef || dlco_seq != dlco_seq_bef){
							model.resetInstanceNode( "/root/resData/resform/ORDR_PTCRCUR" );
							model.setValue("/root/resData/resform/ORDR_HEADER/ordr_dt","");
							model.setValue("/root/resData/resform/ORDR_HEADER/ordr_grp_seq","");
							model.setValue("/root/resData/resform/ORDR_HEADER/deal_dt","");
							model.setValue("/root/resData/resform/ORDR_HEADER/deal_grp_seq","");
							datagrid2.clearStatus();
							datagrid2.refresh();
						}
						
						//refresh
						group3.refresh();

						//FOCUST SET
						model.setFocus("datagrid2");
						datagrid2.row = datagrid2.fixedRows;
						datagrid2.col = 3;
						datagrid2.editCell();
					]]>
				</script>
				<script type="javascript" ev:event="onkeydown">
					<![CDATA[
						//엔터키 체크
						if(event.keyCode == 13) {
							var dlco_cd_bef = dlco_cd_s2.currentText;	
							var dlco_seq_bef = dlco_seq_s2.currentText;	
							var dlco_nm_bef = dlco_nm_s2.currentText;										//거래처명
							if(dlco_nm_bef == ""){
								model.resetInstanceNode( "/root/resData/resform/ORDR_PTCRCUR" );
								datagrid2.clearStatus();
								datagrid2.refresh();
								model.setValue("/root/resData/resform/ORDR_HEADER/dlco_cd","");			//거래처코드 초기화
								model.setValue("/root/resData/resform/ORDR_HEADER/dlco_seq","");			//거래처순번 초기화
								model.setValue("/root/resData/resform/ORDR_HEADER/send_plac_seq","");		//발송처순번 초기화
								model.setValue("/root/resData/resform/ORDR_HEADER/ordr_dt","");
								model.setValue("/root/resData/resform/ORDR_HEADER/ordr_grp_seq","");
								model.setValue("/root/resData/resform/ORDR_HEADER/deal_dt","");
								model.setValue("/root/resData/resform/ORDR_HEADER/deal_grp_seq","");
								return;
							}else{
								model.setValue("/root/resData/resform/ORDR_HEADER/dlco_nm",dlco_nm_bef);	//거래처명 초기화
							}
							
							//거래처발송처검색 Call
							pl_getDlcoSendPlac_p("P",
											"N",
											"/root/resData/resform/ORDR_HEADER",
											"",
											"dlco_cd",
											"dlco_seq",
											"dlco_nm",
											"send_plac_seq",
											"",
											"",
											"",
											"")
							
							//set node값 get
							var dlco_cd = model.getValue("/root/resData/resform/ORDR_HEADER/dlco_cd");
							var dlco_seq = model.getValue("/root/resData/resform/ORDR_HEADER/dlco_seq");
	
							//변경체크
							if(dlco_cd != dlco_cd_bef || dlco_seq != dlco_seq_bef){
								model.resetInstanceNode( "/root/resData/resform/ORDR_PTCRCUR" );
								model.setValue("/root/resData/resform/ORDR_HEADER/ordr_dt","");
								model.setValue("/root/resData/resform/ORDR_HEADER/ordr_grp_seq","");
								model.setValue("/root/resData/resform/ORDR_HEADER/deal_dt","");
								model.setValue("/root/resData/resform/ORDR_HEADER/deal_grp_seq","");
								datagrid2.refresh();
								datagrid2.clearStatus();
							}
							
							group3.refresh();

							//FOCUST SET
							model.setFocus("datagrid2");
							datagrid2.row = datagrid2.fixedRows;
							datagrid2.col = 3;
							datagrid2.editCell();
						}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						//초기화
						model.resetInstanceNode( "/root/resData/resform/ORDR_PTCRCUR" );
						model.setValue("/root/resData/resform/ORDR_HEADER/dlco_cd","");			//거래처코드 초기화
						model.setValue("/root/resData/resform/ORDR_HEADER/dlco_seq","");			//거래처순번 초기화
						model.setValue("/root/resData/resform/ORDR_HEADER/send_plac_seq","");		//발송처순번 초기화
						model.setValue("/root/resData/resform/ORDR_HEADER/ordr_dt","");
						model.setValue("/root/resData/resform/ORDR_HEADER/ordr_grp_seq","");
						model.setValue("/root/resData/resform/ORDR_HEADER/deal_dt","");
						model.setValue("/root/resData/resform/ORDR_HEADER/deal_grp_seq","");
						model.setValue("/root/tempData/btState","RE");		//버튼제어상태 초기화
						
						model.refresh();

						//FOCUST SET
						model.setFocus("datagrid2");
						datagrid2.row = datagrid2.fixedRows;
						datagrid2.col = 3;
						datagrid2.editCell();
					]]>
				</script>
			</input>
			<input id="input13" ref="/root/resData/resform/ORDR_HEADER/send_plac_nm" class="req" caption="고객명" appearance="input" style="left:73px; top:29px; width:100px; height:18px; text-align:left; "/>
			<input id="input3" ref="/root/resData/resform/ORDR_HEADER/send_plac_tel_no_1" format="999" style="left:285px; top:29px; width:40px; height:18px; text-align:center; "/>
			<input id="input14" ref="/root/resData/resform/ORDR_HEADER/send_plac_tel_no_2" format="9999" style="left:328px; top:29px; width:40px; height:18px; text-align:center; "/>
			<input id="input15" ref="/root/resData/resform/ORDR_HEADER/send_plac_tel_no_3" format="9999" style="left:371px; top:29px; width:40px; height:18px; text-align:center; "/>
			<input id="input18" ref="/root/resData/resform/ORDR_HEADER/send_plac_ptph_no_1" format="999" style="left:525px; top:29px; width:40px; height:18px; text-align:center; "/>
			<input id="input16" ref="/root/resData/resform/ORDR_HEADER/send_plac_ptph_no_2" format="9999" style="left:568px; top:29px; width:40px; height:18px; text-align:center; "/>
			<input id="input17" ref="/root/resData/resform/ORDR_HEADER/send_plac_ptph_no_3" format="9999" style="left:611px; top:29px; width:40px; height:18px; text-align:center; "/>
			<input id="input21" ref="/root/resData/resform/ORDR_HEADER/send_plac_fax_no_1" format="999" style="left:758px; top:29px; width:40px; height:18px; text-align:center; "/>
			<input id="input19" ref="/root/resData/resform/ORDR_HEADER/send_plac_fax_no_2" format="9999" style="left:801px; top:29px; width:40px; height:18px; text-align:center; "/>
			<input id="input20" ref="/root/resData/resform/ORDR_HEADER/send_plac_fax_no_3" format="9999" style="left:844px; top:29px; width:40px; height:18px; text-align:center; "/>
			<output id="input22" ref="/root/resData/resform/ORDR_HEADER/send_plac_zip_1" appearance="output" style="left:73px; top:54px; width:35px; height:18px; "/>
			<output id="input23" ref="/root/resData/resform/ORDR_HEADER/send_plac_zip_2" appearance="output" style="left:111px; top:54px; width:35px; height:18px; "/>
			<input id="input24" ref="/root/resData/resform/ORDR_HEADER/send_plac_addr" inputtype="button" style="left:149px; top:54px; width:360px; height:18px; text-align:left; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						pl_openZip("L", "/root/resData/resform/ORDR_HEADER/send_plac_zip_1", "/root/resData/resform/ORDR_HEADER/send_plac_zip_2", "/root/resData/resform/ORDR_HEADER/send_plac_addr");
					]]>
				</script>
			</input>
			<input id="input25" ref="/root/resData/resform/ORDR_HEADER/send_plac_dtls_addr" style="left:512px; top:54px; width:372px; height:18px; text-align:left; "/>
			<input id="input26" ref="/root/resData/resform/ORDR_HEADER/remk" style="left:73px; top:79px; width:811px; height:18px; text-align:left; "/>
			<output id="output3" ref="/root/resData/resform/ORDR_HEADER/ordr_dt" visibility="hidden" style="left:405px; top:4px; width:15px; height:18px; "/>
			<output id="output6" ref="/root/resData/resform/ORDR_HEADER/ordr_grp_seq" visibility="hidden" style="left:425px; top:4px; width:15px; height:18px; "/>
			<output id="output8" ref="/root/resData/resform/ORDR_HEADER/send_plac_seq" visibility="hidden" style="left:860px; top:4px; width:15px; height:18px; "/>
			<output id="output7" ref="/root/resData/resform/ORDR_HEADER/deal_dt" visibility="hidden" style="left:880px; top:4px; width:15px; height:18px; "/>
			<output id="output9" ref="/root/resData/resform/ORDR_HEADER/deal_grp_seq" visibility="hidden" style="left:900px; top:4px; width:15px; height:18px; "/>
		</group>
		<datagrid id="datagrid2" nodeset="/root/resData/resform/ORDR_PTCRCUR/record" caption="매체코드^매체호수^매체명^재고부수^주문부수^단가^할제^주문금액^매출구분^발송구분^창고^판매유형^주문일자^주문그룹순번^주문순번^거래일자^거래그룹순번^거래순번^매체구분" colsep="#" colwidth="60, 60, 158, 70, 60, 60, 50, 80, 75, 75, 75, 75, 100, 100, 100, 100, 100, 100, 100" frozencols="3" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" selectionmode="byrow" arrowkey="Y" style="left:13px; top:521px; width:920px; height:159px; ">
			<col ref="medi_cd" style="text-align:center; "/>
			<col ref="medi_ser_no" style="text-align:center; "/>
			<col ref="medi_nm" type="inputbutton" style="text-align:left; "/>
			<col ref="stok_qty" format="###,###,###" style="text-align:right; "/>
			<col ref="deal_qty" type="input" format="###,###,###" style="text-align:right; "/>
			<col ref="deal_uprc" type="input" format="###,###" style="text-align:right; "/>
			<col ref="dcrate" type="input" format="###.##" style="text-align:right; "/>
			<col ref="deal_amt" type="input" format="###,###,###,###" style="text-align:right; "/>
			<col ref="sale_clsf" type="combo" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/sale_clsf/item">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</col>
			<col ref="sendclsf" type="combo" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/sendclsf/item">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</col>
			<col ref="wh_cd" type="combo" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/wh_cd/item">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</col>
			<col ref="sell_type" type="combo" style="text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/sell_type/item">
						<label ref="cdnm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</col>
			<col ref="ordr_dt" visibility="hidden"/>
			<col ref="ordr_grp_seq" visibility="hidden"/>
			<col ref="ordr_seq" visibility="hidden"/>
			<col ref="deal_dt" visibility="hidden"/>
			<col ref="deal_grp_seq" visibility="hidden"/>
			<col ref="deal_seq" visibility="hidden"/>
			<col ref="medi_clsf" visibility="hidden"/>
			<col ref="absence_clsf" visibility="hidden"/>
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					//current 값 set
					datagrid2.endeditCell();

					//필수체크
					if(!commReqCheck(group3)) {
						return;
					}

					var medi_clsf = model.getValue("/root/resData/resform/ORDR_HEADER/medi_clsf");		//매체구분 Get

					var nowrow = datagrid2.row - datagrid2.fixedRows + 1;
					var rowinx = "";
					rowinx = "["+ (nowrow) + "]";

					model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_clsf",medi_clsf);	//매체구분 Set
					model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/absence_clsf","10");	//절판구분 Set(미절판)

					var medi_cd_bef = model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_cd");			//매체코드
					var medi_ser_no_bef = model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_ser_no");	//매체호수
					var medi_nm_bef = model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_nm");		//매체명
					if(medi_nm_bef == ""){
						model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_cd","");		//매체코드 초기화
						model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_ser_no","");	//매체호수 초기화
						model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/stok_qty","");		//재고부수 초기화
					}
					
					//매체검색 Call
					pl_getMediInfo_p("B",
								 "G",
								 "/root/resData/resform/ORDR_PTCRCUR/record",
								 "datagrid2",
								 "S",
								 "medi_cd",
								 "medi_ser_no",
								 "medi_nm",
								 "",
								 "medi_clsf",
								 "absence_clsf",
								 "",
								 "",
								 "",
								 "",
								 "");
					/**
					 * 매체명으로 구성된 1건검색 또는 팝업 뛰우기 
					 * parameter 
					 * - btnChk(버튼체크) : B-버튼클릭, P-버튼클릭외(INPUT BOX OR ENTER)
					 * - flag(형태구분)   : N-일반 컴포넌트, G-그리드 컴퍼넌트
					 * - rootPath         : 상위노드 xpath  
					 * - grid             : grid 호출일경우 grid id명(String)
					 * - dynmstat         : 매체구분 동적,정적 체크(D:동적   S:정적)
					 * - medi_cdReq     : 매체코드 Element명
					 * - medi_ser_noReq       : 매체호수 Element명
					 * - medi_nmReq       : 매체명 Element명
					 * - issu_cmpyReq     : 발행사 Element명
					 * - medi_clsfReq     : 매체구분 Element명
					 * - absence_clsfReq  : 절판구분 Element명
					 * - uprcReq 		  : 단가 Element명
					 * - dcrateReq        : 할제 Element명
					 * - ser_no_basiReq   : 호수기준 Element명
					 * - issu_clsfReq     : 발행구분 Element명
					 * - end_ser_noReq    : 마감최종호수 Element명
					 */

					//매체 체크
					var medi_cd = model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_cd");		//매체코드
					var medi_ser_no = model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_ser_no");	//매체호수

					if(medi_cd != medi_cd_bef || medi_ser_no != medi_ser_no_bef){
						model.setValue("/root/reqData/searchData/searchDealEtc/flag","MC");
						model.setValue("/root/reqData/searchData/searchDealEtc/deal_clsf","D");
						model.setValue("/root/reqData/searchData/searchDealEtc/dlco_cd",model.getValue("/root/resData/resform/ORDR_HEADER/dlco_cd"));
						model.setValue("/root/reqData/searchData/searchDealEtc/dlco_seq",model.getValue("/root/resData/resform/ORDR_HEADER/dlco_seq"));
						model.setValue("/root/reqData/searchData/searchDealEtc/medi_cd",model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_cd"));
						model.setValue("/root/reqData/searchData/searchDealEtc/medi_ser_no",model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_ser_no"));
						
						model.send("pl_com_1510_s");

						//에러체크 후 기초데이터 Set
						if(submit_completed()){
							model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/stok_qty",model.getValue("/root/resData/resultData/DEAL_ETCINFO/stok_qty"));
							model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/deal_uprc",model.getValue("/root/resData/resultData/DEAL_ETCINFO/deal_uprc"));
							model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/dcrate",model.getValue("/root/resData/resultData/DEAL_ETCINFO/dcrate"));
							model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/sale_clsf","10");
							model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/sendclsf",model.getValue("/root/resData/resultData/DEAL_ETCINFO/sendclsf"));
							model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/wh_cd",model.getValue("/root/resData/resultData/DEAL_ETCINFO/wh_cd"));
							model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/sell_type","10");
						}
					}

					datagrid2.refresh();
					
					//FOCUST SET
					model.setFocus("datagrid2");
					datagrid2.row = datagrid2.row;
					datagrid2.col = 5;
					datagrid2.editCell();
			]]>
			</script>
			<script type="javascript" ev:event="onkeydown">
				<![CDATA[
					//엔터키 체크
					if(event.keyCode == 13) {
						var col = datagrid2.col;

						if(col == 3){
							model.setFocus("datagrid2",true);
							//current 값 set
							datagrid2.endeditCell();

							//필수체크
							if(!commReqCheck(group3)) {
								return;
							}
							
							//datagrid2.gridToInstance();

							var medi_clsf = model.getValue("/root/resData/resform/ORDR_HEADER/medi_clsf");		//매체구분 Get
		
							var nowrow = datagrid2.row - datagrid2.fixedRows + 1;
							var rowinx = "";
							rowinx = "["+ (nowrow) + "]";
		
							model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_clsf",medi_clsf);	//매체구분 Set
							model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/absence_clsf","10");	//절판구분 Set(미절판)

							var medi_cd_bef = model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_cd");			//매체코드
							var medi_ser_no_bef = model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_ser_no");	//매체호수
							var medi_nm_bef = model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_nm");		//매체명
							//var medi_nm_bef = datagrid2.labelMatrix(datagrid2.row,3);		//매체명

							if(medi_nm_bef == ""){
								model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_cd","");		//매체코드 초기화
								model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_ser_no","");	//매체호수 초기화
								model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/stok_qty","");		//재고부수 초기화
							}
	
							//매체검색 Call
							pl_getMediInfo_p("P",
										 "G",
										 "/root/resData/resform/ORDR_PTCRCUR/record",
										 "datagrid2",
										 "S",
										 "medi_cd",
										 "medi_ser_no",
										 "medi_nm",
										 "",
										 "medi_clsf",
										 "absence_clsf",
										 "",
										 "",
										 "",
										 "",
										 "");
	
							//매체 체크
							var medi_cd = model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_cd");		//매체코드
							var medi_ser_no = model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_ser_no");	//매체호수
		
							if(medi_cd != medi_cd_bef || medi_ser_no != medi_ser_no_bef){
								model.setValue("/root/reqData/searchData/searchDealEtc/flag","MC");
								model.setValue("/root/reqData/searchData/searchDealEtc/deal_clsf","D");
								model.setValue("/root/reqData/searchData/searchDealEtc/dlco_cd",model.getValue("/root/resData/resform/ORDR_HEADER/dlco_cd"));
								model.setValue("/root/reqData/searchData/searchDealEtc/dlco_seq",model.getValue("/root/resData/resform/ORDR_HEADER/dlco_seq"));
								model.setValue("/root/reqData/searchData/searchDealEtc/medi_cd",model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_cd"));
								model.setValue("/root/reqData/searchData/searchDealEtc/medi_ser_no",model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_ser_no"));
								
								model.send("pl_com_1510_s");
		
								//에러체크 후 기초데이터 Set
								if(submit_completed()){
									model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/stok_qty",model.getValue("/root/resData/resultData/DEAL_ETCINFO/stok_qty"));
									model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/deal_uprc",model.getValue("/root/resData/resultData/DEAL_ETCINFO/deal_uprc"));
									model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/dcrate",model.getValue("/root/resData/resultData/DEAL_ETCINFO/dcrate"));
									model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/sale_clsf","10");
									model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/sendclsf",model.getValue("/root/resData/resultData/DEAL_ETCINFO/sendclsf"));
									model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/wh_cd",model.getValue("/root/resData/resultData/DEAL_ETCINFO/wh_cd"));
									model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/sell_type","10");
								}
							}
	
							datagrid2.refresh();
							
							//FOCUST SET
							model.setFocus("datagrid2");
							datagrid2.row = datagrid2.row;
							datagrid2.col = 5;
							datagrid2.editCell();
						}
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var nowrow = datagrid2.row - datagrid2.fixedRows + 1;
					var rowinx = "";
					rowinx = "["+ (nowrow) + "]";

					if(nowrow > 0){
						datagrid2.endeditCell();
	
						var medi_cd_bef = model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_cd");			//매체코드
						var medi_ser_no_bef = model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_ser_no");	//매체호수
						var medi_nm_bef = model.getValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_nm");		//매체명
						if(medi_nm_bef == ""){
							model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_cd","");		//매체코드 초기화
							model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/medi_ser_no","");	//매체호수 초기화
							model.setValue("/root/resData/resform/ORDR_PTCRCUR/record"+rowinx+"/stok_qty","");		//재고부수 초기화
						}

						//금액 자동계산
						var col = datagrid2.col;
						var deal_amt = 0;
	
						if(col == 5 || col == 6 || col == 7){
							deal_qty = Number(datagrid2.valueMatrix(nowrow,datagrid2.colRef("deal_qty")));		//거래부수
							deal_uprc = Number(datagrid2.valueMatrix(nowrow,datagrid2.colRef("deal_uprc")));		//거래단가
							dcrate = Number(datagrid2.valueMatrix(nowrow,datagrid2.colRef("dcrate")));			//할제
							
							deal_amt = (deal_qty * deal_uprc * dcrate) / 100;
							
							datagrid2.valueMatrix(nowrow,datagrid2.colRef("deal_amt")) = deal_amt;
						}

						datagrid2.refresh();

						if(col == 3){
							//FOCUST SET
							model.setFocus("datagrid2");
							datagrid2.row = datagrid2.row;
							datagrid2.col = 5;
							datagrid2.editCell();
						}
					}
				]]>
			</script>
		</datagrid>
		<caption id="caption6" class="list_cap03" style="left:662px; top:689px; width:50px; height:37px; font-weight:bold; text-align:center; vertical-align:middle; ">합계</caption>
		<caption id="caption19" class="list_cap03" style="left:711px; top:689px; width:65px; height:20px; font-weight:bold; text-align:center; ">주문부수</caption>
		<caption id="caption26" class="list_cap03" style="left:775px; top:689px; width:100px; height:20px; font-weight:bold; text-align:center; ">주문금액</caption>
		<output id="output4" ref="/root/tempData/total/deal_amt_sum" format="###,###,###,##0" style="left:775px; top:708px; width:100px; height:18px; font-weight:bold; color:#0000ff; text-align:right; background-color:#ff9900; border-color:#0000ff; border-style:solid; "/>
		<output id="output5" ref="/root/tempData/total/deal_qty_sum" format="###,###,###,##0" style="left:711px; top:708px; width:65px; height:18px; font-weight:bold; color:#0000ff; text-align:right; background-color:#ff9900; border-color:#0000ff; border-style:solid; "/>
	</xhtml:body>
</xhtml:html>
