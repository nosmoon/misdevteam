<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>원가배부처리(MC_COST_3000)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session/>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData/>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<yymm/>
							<clos_clsf/>
							<kind/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqForm>
							<yymm/>
							<incmg_pers/>
							<incmg_pers_nm/>
							<dept_cd/>
							<tms_yb>1</tms_yb>
							<tms>1</tms>
						</reqForm>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpDate>
						</multiUpDate>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resForm>
							<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
							<mc_cost_3000_a>
								<dataSet>
									<xx_clos_clsf_010/>
									<xx_clos_clsf_020/>
									<xx_clos_clsf_030/>
									<xx_clos_clsf_040/>
									<xx_clos_clsf_050/>
									<CURLIST_01>
										<record>
											<col1/>
										</record>
									</CURLIST_01>
									<CURLIST_02>
										<record>
											<col1/>
										</record>
									</CURLIST_02>
									<CURLIST_03>
										<record>
											<col1/>
										</record>
									</CURLIST_03>
									<CURLIST_04>
										<record>
											<budg_cdnm/>
										</record>
									</CURLIST_04>
									<CURLIST_05>
										<record>
											<ndstb_cd/>
										</record>
									</CURLIST_05>
									<CURLIST_06>
										<record>
											<dstb_nm/>
										</record>
									</CURLIST_06>
									<CURLIST_07>
										<record>
											<bscd_no_entry/>
											<bscd_err/>
										</record>
									</CURLIST_07>
									<CURLIST_08>
										<record>
											<bsbbcd_no_entry/>
											<bsbbcd_err/>
										</record>
									</CURLIST_08>
									<CURLIST_09>
										<record>
											<excp_dstb_cd/>
										</record>
									</CURLIST_09>
									<CURLIST_00>
										<record>
											<tms/>
										</record>
									</CURLIST_00>
								</dataSet>
							</mc_cost_3000_a>
						</resForm>
						<gridData>
							<grid1>
								<record>
									<data1>결산준비정보생성</data1>
								</record>
								<record>
									<data1>전사비배부정보생성</data1>
								</record>
								<record>
									<data1>보조부서배부정보생성</data1>
								</record>
								<record>
									<data1>최종배부정보생성</data1>
								</record>
							</grid1>
						</gridData>
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<keyData/>
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
					</tempData>
					<!-- 저장소 -->
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					S_AllDateCaption();
					set_refvalue("/root/reqData/searchData/kind","01");
					model.send("mc_cost_3000_a");
					yymm.value = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_01/record/col1");
					S_AllDateCaption();					
					ss_emp_no = getProperty("ss_emp_no");
					ss_emp_nm = getProperty("ss_emp_nm");
					ss_deptcd = getProperty("ss_deptcd");
					ss_deptnm = getProperty("ss_deptnm");					

					G_WorkSabeon = getProperty("ss_emp_no");
					
					set_refvalue("/root/reqData/reqForm/incmg_pers", ss_emp_no);
					set_refvalue("/root/reqData/reqForm/incmg_pers_nm", ss_emp_nm);					
					set_refvalue("/root/reqData/reqForm/dept_cd", ss_deptcd + "    " + ss_deptnm);
					incmg_pers.refresh();
					incmg_pers_nm.refresh();
					dept_cd.refresh();
					G_Cym = yymm.value;
					/*
					alert(model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_010"));
					alert(model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_020"));
					alert(model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_030"));
					alert(model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_040"));
					alert(model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_050"));
					*/
				]]>
			</script>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<script type="javascript" src="/js/fcmc_common.js"/>
			<submission id="mc_cost_3000_a" action="/mc/cost3000/3000" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm/mc_cost_3000_a/dataSet"/>
			<submission id="mc_cost_3001_i" action="/mc/cost3000/3001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="mc_cost_3002_i" action="/mc/cost3000/3002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="mc_cost_3003_i" action="/mc/cost3000/3003" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="mc_cost_3004_i" action="/mc/cost3000/3004" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="mc_cost_3006_d" action="/mc/cost3000/3006" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="mc_cost_3007_d" action="/mc/cost3000/3007" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="mc_cost_3008_d" action="/mc/cost3000/3008" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="mc_cost_3009_d" action="/mc/cost3000/3009" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="hd_com_1002" action="/hd/com/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					init_controls();									
				]]>
			</script>
			<submission id="mc_cost_9999_d" action="/mc/cost3000/9999" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/MsgData/dataSet"/>
		</model>
		<script type="javascript">
			<![CDATA[
				var ss_emp_no;
				var ss_emp_nm;
				var ss_deptcd;
				var ss_deptnm;
				var G_Cym;
				var G_WorkSabeon;
				var process_cnt = 0;
							
				function init_controls(){
					set_default(
						yymm
					,	incmg_pers_nm
					,	dept_cd
					);					//input
					set_default(
						incmg_pers
					);					//input button					
					set_format(
						"code"
					,	incmg_pers
					);
					set_format(
						"string_l"
					,	incmg_pers_nm
					,	dept_cd
					);
					set_format(
						"month_1"
					,	yymm
					);
					
					for(i = 1 ; i < 5 ; i++){
						datagrid1.rowStatus(i) = "1";
					}
				}
				function setEmp_no(emp_no, nm_korn){
					incmg_pers.value = emp_no;
					incmg_pers_nm.value = nm_korn;
				}	
				function send_mc_cost_3004_i(mgyb){
					set_refvalue("/root/reqData/reqForm/yymm",G_Cym);

					model.send("mc_cost_3004_i");

					if(submit_completed()){
//						show_message("저장되었습니다.");
						return true;
					}
					else{
						return false;
					}
				}

				function S_AllDateCaption(){
					//S_DateCaption("1", "GJ");		// lblGsJunbi ="1"
					//S_DateCaption("2", "JB");		// lblJunsaBbgg ="2"
					//S_DateCaption("3", "BB");		// lblBojoBbgg ="3"
					S_DateCaption("1", model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_010"));		// lblGsJunbi ="1"
					S_DateCaption("2", model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_020"));		// lblJunsaBbgg ="2"
					S_DateCaption("3", model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_030"));		// lblBojoBbgg ="3"
					S_SeqDateCaption();
				}
				function S_SeqDateCaption(){
					var sLastSeq;
					var sMagamYb;

					set_refvalue("/root/reqData/searchData/yymm",G_Cym);
					set_refvalue("/root/reqData/searchData/kind","00");
						
					model.send("mc_cost_3000_a");
					sLastSeq = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_00/record/tms");
					
					S_DateCaption("4", (sLastSeq+"B"));						//lblSeqBbgg ="4"

					set_refvalue("/root/reqData/searchData/kind","03");			//kind 03인 경우 마감여부 chk
					//set_refvalue("/root/reqData/searchData/clos_clsf","CB");
					set_refvalue("/root/reqData/searchData/clos_clsf",model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_040"));
						
					model.send("mc_cost_3000_a");
						
					sMagamYb = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_03/record/col1");
				}
				function S_DateCaption(cControl,sGbcd){
					var sMagamYb;
					set_refvalue("/root/reqData/searchData/yymm",yymm.value);
					set_refvalue("/root/reqData/searchData/kind","03");			//kind 03인 경우 마감여부 chk
					set_refvalue("/root/reqData/searchData/clos_clsf",sGbcd);
						
					model.send("mc_cost_3000_a");
						
					sMagamYb = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_03/record/col1");
												
					if(sMagamYb.substring(0,1) == "Y"){
						if(cControl == "1"){
							lblGsJunbi.attribute("text") = "최종처리시간 : " + sMagamYb.substring(1,20);
						}
						else if(cControl == "2"){
							lblJunsaBbgg.attribute("text") = "최종처리시간 : " + sMagamYb.substring(1,20);
						}
						else if(cControl == "3"){
							lblBojoBbgg.attribute("text") = "최종처리시간 : " + sMagamYb.substring(1,20);
						}
						else if(cControl == "4"){
							lblSeqBbgg.attribute("text") = "최종처리시간 : " + sMagamYb.substring(1,20);
						}
					}
					else{
						if(cControl == "1"){
							lblGsJunbi.attribute("text") = "최종처리시간 : 처리정보 없음";
						}
						else if(cControl == "2"){
							lblJunsaBbgg.attribute("text") = "최종처리시간 : 처리정보 없음";
						}
						else if(cControl == "3"){
							lblBojoBbgg.attribute("text") = "최종처리시간 : 처리정보 없음";
						}
						else if(cControl == "4"){
							lblSeqBbgg.attribute("text") = "최종처리시간 : 처리정보 없음";
						}
					}					
				}
				
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="2,34;2,39;2,40;2,49;2,70;2,78;2,80;2,104;2,106;2,112;2,113;2,117;2,118;2,132;2,133;2,157;2,158;2,366;2,393;1,936;1,927;1,926;2,755;1,240;1,380;1,519;">
		<caption id="caption10" class="list_cap02" style="left:10px; top:95px; width:888px; height:619px; text-align:center; "/>
		<group id="group_line" class="gro_line" style="left:10px; top:83px; width:926px; height:5px; "/>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:50px; width:926px; height:21px; ">
			<button id="btn_select" class="btn02" crud="R" style="left:816px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						G_Cym = yymm.value;
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:871px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose();
					]]>
				</script>
			</button>
		</group>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group_scr" class="gro_sel" style="left:20px; top:115px; width:866px; height:26px; ">
			<caption id="caption2" class="list_cap03" style="left:0px; top:0px; width:110px; height:26px; text-align:center; ">년월</caption>
			<caption id="caption3" class="list_cap02" style="left:109px; top:0px; width:757px; height:26px; text-align:center; "/>
			<caption id="caption50" class="list_cap03" style="left:200px; top:0px; width:110px; height:26px; ">등록자</caption>
			<caption id="caption1" class="list_cap03" style="left:535px; top:0px; width:110px; height:26px; ">등록부서</caption>
			<input id="yymm" ref="/root/reqData/reqForm/yymm" class="req" navindex="1" caption="년월" style="left:115px; top:4px; width:80px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(G_Cym !=  yymm.value){
							G_Cym =  yymm.value;
							S_AllDateCaption();
						}
					]]>
				</script>
			</input>
			<input id="incmg_pers" ref="/root/reqData/reqForm/incmg_pers" class="req" navindex="9" inputtype="button" caption="등록자" style="left:315px; top:4px; width:80px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (incmg_pers.value.length == 6) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/emp_no");
							model.setValue("/root/reqData/fwdData/emp_no", incmg_pers.value);
							model.send("hd_com_1002");
							
							if (model.getValue("/root/tempData/record/emp_no") != "") {
								incmg_pers_nm.value = model.getValue("/root/tempData/record/nm_korn");
							}
							else {
								incmg_pers.value = "";
								incmg_pers_nm.value = "";
							}
						}		
						else {
							incmg_pers.value = "";
							incmg_pers_nm.value = "";
						}													
						
					]]>
				</script>
			</input>
			<input id="incmg_pers_nm" ref="/root/reqData/reqForm/incmg_pers_nm" editable="false" style="left:400px; top:4px; width:130px; height:18px; "/>
			<input id="dept_cd" ref="/root/reqData/reqForm/dept_cd" editable="false" style="left:650px; top:4px; width:210px; height:18px; "/>
		</group>
		<group id="group2" style="left:20px; top:170px; width:867px; height:60px; ">
			<button id="btn_insert_gj" class="btn06" crud="C" style="left:220px; top:30px; width:136px; height:21px; ">
				<caption>결산준비정보생성</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var sLAST_CYM;
						var sMagamYb;
						
						if(model.getFocus() != "btn_process"){
							if (model.alert("● 현업전표에서 사용부서별, 예산코드별, 매체별로 결산준비정보를 생성\n● 대상 : 예산코드 TABLE의 분류1이 10, 20 인 금액/수량\n             - 수입(10)   : 대변 금액\n             - 비용(기타): 차변 금액\n             - 승인여부  : 승인\n● 조건 : 대체전표 마감후\n\n결산준비정보를 생성하시겠습니까?","결산준비정보생성",MB_YESNO) != IDYES) {
						 	  	return false;
							}
						}
						
						if(!commReqCheck(group_scr)) {
							return false;
						}
						set_refvalue("/root/reqData/searchData/yymm",G_Cym);						
						set_refvalue("/root/reqData/searchData/kind","02");		//kind 02인경우 최종마감년월 Chk
												
						model.send("mc_cost_3000_a");
						sLAST_CYM = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_02/record/col1");
						
						if(G_Cym <= sLAST_CYM){
							model.alert("최종 마감월 이전 월은 배부처리 불가! (최종마감년월 " + sLAST_CYM.substring(0,4) + "-" +  sLAST_CYM.substring(4,6) + ")","결산준비정보생성");
							return false;
						}
						
						set_refvalue("/root/reqData/searchData/kind","03");			//kind 03인 경우 마감여부 chk
						//set_refvalue("/root/reqData/searchData/clos_clsf","GJ");
						set_refvalue("/root/reqData/searchData/clos_clsf",model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_010"));
						
						model.send("mc_cost_3000_a");
						
						sMagamYb = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_03/record/col1");
												
						if(sMagamYb.substring(0,1) == "Y"){
							if (model.alert("이미 처리된 자료입니다.\n재생성하시겠습니까?","결산준비정보생성",MB_YESNO) != IDYES) {
						 	  	return false;
							}
							else{
								btn_delete_gj.dispatch("onclick");
							}
						}
						set_refvalue("/root/reqData/reqForm/yymm",G_Cym);

						model.send("mc_cost_3001_i");

						if(submit_completed()){						
							if(model.getFocus() != "btn_process"){
								model.alert("저장되었습니다.","결산준비정보생성");
							}
							//S_DateCaption("1", "GJ");		//lblGsJunbi ="1"
							S_DateCaption("1", model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_010"));		//lblGsJunbi ="1"
							datagrid1.rowStatus(1) = "4";
							process_cnt += 1;
						}
					]]>
				</script>
			</button>
			<button id="btn_delete_gj" class="btn06" crud="D" style="left:360px; top:30px; width:136px; height:21px; ">
				<caption>결산준비정보삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (show_message("해당 자료를 삭제하시겠습니까?","삭제 확인",MB_YESNO) != IDYES) {
					 	  	return false;
						}
						
						if(!commReqCheck(group_scr)) {
							return false;
						}
						set_refvalue("/root/reqData/searchData/yymm",G_Cym);						
						set_refvalue("/root/reqData/searchData/kind","02");		//kind 02인경우 최종마감년월 Chk
												
						model.send("mc_cost_3000_a");
						sLAST_CYM = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_02/record/col1");
						
						if(G_Cym <= sLAST_CYM){
							show_message("최종 마감월 이전 월은 배부처리 불가! (최종마감년월 " + sLAST_CYM.substring(0,4) + "-" +  sLAST_CYM.substring(4,6) + ")");
							return false;
						}
						
						set_refvalue("/root/reqData/reqForm/yymm",G_Cym);

						model.send("mc_cost_3006_d");

						if(submit_completed()){						
							show_message("삭제되었습니다.");
							//S_DateCaption("1", "GJ");			// lblGsJunbi ="1"
							S_DateCaption("1", model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_010"));			// lblGsJunbi ="1"
						}						
												
					]]>
				</script>
			</button>
			<button id="btn_select_gj" class="btn06" crud="R" style="left:499px; top:30px; width:136px; height:21px; ">
				<caption>결산준비정보조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.property("MC_COST_3020_popup_flag")  = "Y";

//						viewer("mainFrame").window.javaScript.onLoadExPopupPage("MC_COST_3020");
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("MC_COST_3020");
					]]>
				</script>
			</button>
			<caption id="caption41" class="tit02" style="left:5px; top:5px; width:524px; height:20px; ">결산준비정보처리</caption>
			<caption id="lblGsJunbi" style="left:20px; top:30px; width:240px; height:20px; ">최종처리시간 : 1998/01/01 13:20</caption>
		</group>
		<group id="group3" style="left:20px; top:255px; width:867px; height:60px; ">
			<button id="btn_insert_jb" class="btn06" crud="C" style="left:220px; top:30px; width:136px; height:21px; ">
				<caption>전사비배부정보생성</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var sLAST_CYM;
						var sMagamYb;
						var sTemp;
						var budg_cdnm;
						var ndstb_cd;
						var dstb_nm;

						if(model.getFocus() != "btn_process"){
							if (model.alert("● 결산준비정보에서 전사공통비 배부정보 생성\n● 대상 : 사용부서가 '999999'인 결산준비정보\n● 내용 : 예산코드의 전사배부비로 배부\n\n전사공통비 배부정보를 생성하시겠습니까?","전사비배부정보생성",MB_YESNO) != IDYES) {
						 	  	return false;
							}
						}
						if(!commReqCheck(group_scr)) {
							return false;
						}
						set_refvalue("/root/reqData/searchData/yymm",G_Cym);						
						set_refvalue("/root/reqData/searchData/kind","02");		//kind 02인경우 최종마감년월 Chk
												
						model.send("mc_cost_3000_a");
						sLAST_CYM = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_02/record/col1");
						
						if(G_Cym <= sLAST_CYM){
							model.alert("최종 마감월 이전 월은 배부처리 불가! (최종마감년월 " + sLAST_CYM.substring(0,4) + "-" +  sLAST_CYM.substring(4,6) + ")","전사비배부정보생성");
							return false;
						}

						set_refvalue("/root/reqData/searchData/kind","03");			//kind 03인 경우 마감여부 chk
						//set_refvalue("/root/reqData/searchData/clos_clsf","BD");
						set_refvalue("/root/reqData/searchData/clos_clsf",model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_050"));
						
						model.send("mc_cost_3000_a");
						
						sMagamYb = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_03/record/col1");
												
						if(sMagamYb.substring(0,1) == "N"){
							model.alert("배부비등록이 마감되지 않아 작업이 취소되었습니다.","전사비배부정보생성");
					 	  	return false;
						}
						
						//set_refvalue("/root/reqData/searchData/clos_clsf","GJ");
						set_refvalue("/root/reqData/searchData/clos_clsf",model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_010"));
						
						model.send("mc_cost_3000_a");
						
						sMagamYb = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_03/record/col1");
												
						if(sMagamYb.substring(0,1) == "N"){
							model.alert("처리할 수 없는 자료입니다.(결산준비정보 미생성)","전사비배부정보생성");
					 	  	return false;
						}

						set_refvalue("/root/reqData/searchData/yymm",yymm.value);
						set_refvalue("/root/reqData/searchData/kind","04");			//kind 04인 경우
						
						model.send("mc_cost_3000_a");
						totalcnt = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_04/totalcnt");
					
						if (totalcnt > 0) {
							for(i=1; i<= totalcnt; i++){
								if(get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_04/record/budg_cdnm") == ""){
									budg_cdnm = "'      '";
								}
								else{
									budg_cdnm = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_04/record/budg_cdnm");
								}
								sTemp = sTemp + "\n" + 	budg_cdnm;
							}
							model.alert("전사공통비(사용부서:999999)중 예산코드가\n예산코드 TABLE에 없습니다.\n"+sTemp,"전사비배부정보생성");
							return;
						}
						set_refvalue("/root/reqData/searchData/yymm",yymm.value);
						set_refvalue("/root/reqData/searchData/kind","05");			//kind 05인 경우
						
						model.send("mc_cost_3000_a");
						totalcnt = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_05/totalcnt");
						
						if (totalcnt > 0) {
							for(i=1; i<= totalcnt; i++){
								if(get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_05/record/ndstb_cd") == ""){
									ndstb_cd = "'      '";
								}
								else{
									ndstb_cd = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_05/record/ndstb_cd");
								}
								sTemp = sTemp + "\n" + 	ndstb_cd;
							}
							model.alert("전사공통비(사용부서:999999)중 예산코드 TABLE에\n오류인 코드가 있습니다.\n"+sTemp,"전사비배부정보생성");
							return;
						}
						
						set_refvalue("/root/reqData/searchData/yymm",yymm.value);
						set_refvalue("/root/reqData/searchData/kind","06");			//kind 06인 경우
						
						model.send("mc_cost_3000_a");
						totalcnt = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_06/totalcnt");
						
						if (totalcnt > 0) {
							for(i=1; i<= totalcnt; i++){
								if(get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_06/record/dstb_nm") == ""){
									dstb_nm = "'      '";
								}
								else{
									dstb_nm = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_06/record/dstb_nm");
								}
								sTemp = sTemp + "\n" + 	dstb_nm;
							}
							model.alert("전사공통비(사용부서:999999)로 배부될\n배부비료가 등록되지 않았습니다.\n"+sTemp,"전사비배부정보생성");
							return;
						}												
						set_refvalue("/root/reqData/searchData/kind","03");			//kind 03인 경우 마감여부 chk
						//set_refvalue("/root/reqData/searchData/clos_clsf","JB");
						set_refvalue("/root/reqData/searchData/clos_clsf",model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_020"));
						
						model.send("mc_cost_3000_a");
						
						sMagamYb = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_03/record/col1");
												
						if(sMagamYb.substring(0,1) == "Y"){
							if (model.alert("이미 처리된 자료입니다.\n재생성하시겠습니까?","전사비배부정보생성",MB_YESNO) != IDYES) {
						 	  	return false;
							}
							else{
								btn_delete_jb.dispatch("onclick");
							}
						}
						set_refvalue("/root/reqData/reqForm/yymm",G_Cym);

						model.send("mc_cost_3002_i");

						if(submit_completed()){						
							if(model.getFocus() != "btn_process"){
								model.alert("저장되었습니다.","전사비배부정보생성");
							}
							//S_DateCaption("2", "JB");				// lblGsJunbi ="2"
							S_DateCaption("2", model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_020"));				// lblGsJunbi ="2"
							datagrid1.rowStatus(2) = "4";
							process_cnt += 1;
						}
					]]>
				</script>
			</button>
			<button id="btn_delete_jb" class="btn06" crud="D" style="left:360px; top:30px; width:136px; height:21px; ">
				<caption>전사비배부정보삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (show_message("해당 자료를 삭제하시겠습니까?","삭제 확인",MB_YESNO) != IDYES) {
					 	  	return false;
						}
						
						if(!commReqCheck(group_scr)) {
							return false;
						}

						set_refvalue("/root/reqData/searchData/yymm",G_Cym);
						set_refvalue("/root/reqData/searchData/kind","02");		//kind 02인경우 최종마감년월 Chk
												
						model.send("mc_cost_3000_a");
						sLAST_CYM = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_02/record/col1");
						
						if(G_Cym <= sLAST_CYM){
							show_message("최종 마감월 이전 월은 배부처리 불가! (최종마감년월 " + sLAST_CYM.substring(0,4) + "-" +  sLAST_CYM.substring(4,6) + ")");
							return false;
						}
						
						set_refvalue("/root/reqData/reqForm/yymm",G_Cym);

						model.send("mc_cost_3008_d");

						if(submit_completed()){
							show_message("삭제되었습니다.");
							//S_DateCaption("2", "JB");			// lblGsJunbi ="2"
							S_DateCaption("2", model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_020"));			// lblGsJunbi ="2"
						}											
					]]>
				</script>
			</button>
			<button id="btn_select_jb" class="btn06" crud="R" style="left:499px; top:30px; width:136px; height:21px; ">
				<caption>전사비배부결과조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.property("MC_COST_3050_popup_flag")  = "Y";

//						viewer("mainFrame").window.javaScript.onLoadExPopupPage("MC_COST_3050");
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("MC_COST_3050");
					]]>
				</script>
			</button>
			<caption id="caption4" class="tit02" style="left:5px; top:5px; width:524px; height:20px; ">전사배부비배부처리</caption>
			<caption id="lblJunsaBbgg" style="left:20px; top:30px; width:230px; height:20px; ">최종처리시간 : 1998/01/01 13:20</caption>
		</group>
		<group id="group4" style="left:20px; top:340px; width:867px; height:60px; ">
			<button id="btn_insert_bb" class="btn06" crud="C" style="left:220px; top:30px; width:136px; height:21px; ">
				<caption>보조부서배부정보생성</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var sLAST_CYM;
						var sMagamYb;
						var sTemp;
						var budg_cdnm;
						var ndstb_cd;
						var dstb_nm;
											
						if(model.getFocus() != "btn_process"){
							if (model.alert("● 전사비배부결과에서 보조부서 수입/비용을 제조및일반부서로 배부\n● 대상 : 매체가 결정되지 않은 수입/비용\n● 내용 : 해당보조부서의 원가배부코드를 이용하여 부서별로 배부하고,\n             또 다시 보조부서로 배부되면 보조부서가 제외된 비율2를\n             이용하여 배부한다.\n\n보조부서 배부정보를 생성하시겠습니까?","보조부서배부정보생성",MB_YESNO) != IDYES) {
						 	  	return false;
							}
						}

						if(!commReqCheck(group_scr)) {
							return false;
						}
						set_refvalue("/root/reqData/searchData/yymm",G_Cym);						
						set_refvalue("/root/reqData/searchData/kind","02");		//kind 02인경우 최종마감년월 Chk
												
						model.send("mc_cost_3000_a");
						sLAST_CYM = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_02/record/col1");
						
						if(G_Cym <= sLAST_CYM){
							model.alert("최종 마감월 이전 월은 배부처리 불가! (최종마감년월 " + sLAST_CYM.substring(0,4) + "-" +  sLAST_CYM.substring(4,6) + ")","보조부서배부정보생성");
							return false;
						}

						set_refvalue("/root/reqData/searchData/kind","03");			//kind 03인 경우 마감여부 chk
						//set_refvalue("/root/reqData/searchData/clos_clsf","BD");
						set_refvalue("/root/reqData/searchData/clos_clsf",model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_050"));
						
						model.send("mc_cost_3000_a");
						
						sMagamYb = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_03/record/col1");
												
						if(sMagamYb.substring(0,1) == "N"){
							model.alert("배부비등록이 마감되지 않아 작업이 취소되었습니다.","보조부서배부정보생성");
					 	  	return false;
						}
						
						//set_refvalue("/root/reqData/searchData/clos_clsf","JB");
						set_refvalue("/root/reqData/searchData/clos_clsf",model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_020"));
						
						model.send("mc_cost_3000_a");
						
						sMagamYb = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_03/record/col1");
												
						if(sMagamYb.substring(0,1) == "N"){
							model.alert("처리할 수 없는 자료입니다.(전사비배부정보)","보조부서배부정보생성");
					 	  	return false;
						}

						set_refvalue("/root/reqData/searchData/kind","07");			//kind 07

						model.send("mc_cost_3000_a");
												
						totalcnt = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_07/totalcnt");
						
						if (totalcnt > 0) {
							if(get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_07/record/bscd_no_entry") != "0"){
								model.alert("1차배부 부서코드중\부서코드 TABLE에 없는 부서코드가 있습니다.","보조부서배부정보생성");
							}
							if(get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_07/record/bscd_err") != "0"){
								model.alert("1차배부 부서코드중\오류인 코드가 있습니다.","보조부서배부정보생성");
							}
							if(get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_07/record/bscd_no_entry") != "0" || 
	  						  get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_07/record/bscd_err") != "0"){
	  						  	return false;
	  						}
						}
						
						set_refvalue("/root/reqData/searchData/kind","08");			//kind 08

						model.send("mc_cost_3000_a");
												
						totalcnt = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_08/totalcnt");
						
						if (totalcnt > 0) {
							if(get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_08/record/bsbbcd_no_entry") != "0"){
								model.alert("부서코드 TABLE의 원가배부코드중\배부비자료가 등록되지 않았습니다.","보조부서배부정보생성");
							}
							if(get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_08/record/bsbbcd_err") != "0"){
								model.alert("부서코드 TABLE의 원가배부코드중\오류인 코드가 있습니다.","보조부서배부정보생성");
							}
							if(get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_08/record/bsbbcd_no_entry") != "0" || 
	  						  get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_08/record/bsbbcd_err") != "0"){
	  						  	return false;
	  						}
						}						
						
						set_refvalue("/root/reqData/searchData/kind","03");			//kind 03인 경우 마감여부 chk
						//set_refvalue("/root/reqData/searchData/clos_clsf","BB");
						set_refvalue("/root/reqData/searchData/clos_clsf",model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_030"));
						
						model.send("mc_cost_3000_a");
						
						sMagamYb = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_03/record/col1");
												
						if(sMagamYb.substring(0,1) == "Y"){
							if (model.alert("이미 처리된 자료입니다.\n재생성하시겠습니까?","보조부서배부정보생성",MB_YESNO) != IDYES) {
						 	  	return false;
							}
							else{
								btn_delete_bb.dispatch("onclick");
							}
						}
						set_refvalue("/root/reqData/reqForm/yymm",G_Cym);

						model.send("mc_cost_3003_i");

						if(submit_completed()){						
							if(model.getFocus() != "btn_process"){
								model.alert("저장되었습니다.","보조부서배부정보생성");
							}
							//S_DateCaption("3", "BB");				// lblBojoBbgg ="3"
							S_DateCaption("3", model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_030"));				// lblBojoBbgg ="3"
							datagrid1.rowStatus(3) = "4";
							process_cnt += 1;
						}
					]]>
				</script>
			</button>
			<button id="btn_delete_bb" class="btn06" crud="D" style="left:360px; top:30px; width:136px; height:21px; ">
				<caption>보조부서배부정보삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (show_message("해당 자료를 삭제하시겠습니까?","삭제 확인",MB_YESNO) != IDYES) {
					 	  	return false;
						}
						
						if(!commReqCheck(group_scr)) {
							return false;
						}

						set_refvalue("/root/reqData/searchData/yymm",G_Cym);
						set_refvalue("/root/reqData/searchData/kind","02");		//kind 02인경우 최종마감년월 Chk
												
						model.send("mc_cost_3000_a");
						sLAST_CYM = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_02/record/col1");
						
						if(G_Cym <= sLAST_CYM){
							show_message("최종 마감월 이전 월은 배부처리 불가! (최종마감년월 " + sLAST_CYM.substring(0,4) + "-" +  sLAST_CYM.substring(4,6) + ")");
							return false;
						}
						
						set_refvalue("/root/reqData/reqForm/yymm",G_Cym);

						model.send("mc_cost_3007_d");

						if(submit_completed()){
							show_message("삭제되었습니다.");
							//S_DateCaption("3", "BB");				// lblBojoBbgg ="3"
							S_DateCaption("3", model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_030"));				// lblBojoBbgg ="3"
						}					
					]]>
				</script>
			</button>
			<button id="btn_select_bb" class="btn06" crud="R" style="left:499px; top:30px; width:136px; height:21px; ">
				<caption>보조부서배부결과</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.property("MC_COST_3030_popup_flag")  = "Y";

//						viewer("mainFrame").window.javaScript.onLoadExPopupPage("MC_COST_3030");	
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("MC_COST_3030");				
					]]>
				</script>
			</button>
			<caption id="caption8" class="tit02" style="left:5px; top:5px; width:524px; height:20px; ">보조부분배부처리</caption>
			<caption id="lblBojoBbgg" style="left:20px; top:30px; width:230px; height:20px; ">최종처리시간 : 1998/01/01 13:20</caption>
		</group>
		<group id="group5" style="left:20px; top:425px; width:867px; height:60px; ">
			<button id="btn_insert_cb" class="btn06" crud="C" style="left:220px; top:30px; width:136px; height:21px; ">
				<caption>최종배부정보생성</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var iMsgVal;
						var sMagamYb;
						var sLastSeq;
						var sMgCd;
						var sSEQ_MGYB;
						var sLAST_CYM;
						
						if(model.getFocus() != "btn_process"){
							if (model.alert("● 보조부서 배부결과에서 최종배부결과로 배부\n● 대상 : 보조부서 배부결과의 모든 금액/수량\n● 내용 : 보조부서 배부결과의 정보중 매체가 결정된 경우,\n             예산코드 TABLE에 매체배부비가 있는 경우,\n             예외배부코드가 매체배부비인 경우, 부서코드의 원가배부코드가\n             매체배부코드인 경우 최종배부결과에 배부정보를 등록하고\n             매체로 배부되지 못한 정보는 차수별 배부결과에 등록한다.\n             차수별 배부결과의 정보중 1차와 동일하게 매체를 찾아\n             최종배부결과에 배부결과를 등록하고 매체로 배부되지 못한\n             정보는 차수를 증가하여 차수별 배부결과에 등록한다.\n※ 차수마감이 체크되면 실행시의 차수가 최종차수가 되어 차수별 배부결과의\n   배부되지 못한 정보들을 최종배부결과의 배부된 매체별 비율별로 나누어 더\n하고 그래도 차이나는 금액은 가장큰 매체에 더한다.\n배부도중 차수별 배부정보가 모두 배부되면 해당배부차수로 배부마감되며\n배부를 종결한다.\n\n최종배부정보를 생성하시겠습니까?","최종배부정보생성",MB_YESNO) != IDYES) {
						 	  	return false;
							}
						}
						
						if(!commReqCheck(group_scr)) {
							return false;
						}
						set_refvalue("/root/reqData/searchData/yymm",G_Cym);						
						set_refvalue("/root/reqData/searchData/kind","02");		//kind 02인경우 최종마감년월 Chk
												
						model.send("mc_cost_3000_a");
						sLAST_CYM = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_02/record/col1");
						
						if(G_Cym <= sLAST_CYM){
							model.alert("최종 마감월 이전 월은 배부처리 불가! (최종마감년월 " + sLAST_CYM.substring(0,4) + "-" +  sLAST_CYM.substring(4,6) + ")","최종배부정보생성");
							return false;
						}
						
						set_refvalue("/root/reqData/searchData/kind","03");			//kind 03인 경우 마감여부 chk
						//set_refvalue("/root/reqData/searchData/clos_clsf","BD");
						set_refvalue("/root/reqData/searchData/clos_clsf",model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_050"));
						
						model.send("mc_cost_3000_a");
						
						sMagamYb = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_03/record/col1");
												
						if(sMagamYb.substring(0,1) == "N"){
							model.alert("배부비등록이 마감되지 않아 작업이 취소되었습니다.","최종배부정보생성");
					 	  	return false;
						}

						//set_refvalue("/root/reqData/searchData/clos_clsf","BB");
						set_refvalue("/root/reqData/searchData/clos_clsf",model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_030"));
						
						model.send("mc_cost_3000_a");						

						sMagamYb = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_03/record/col1");
												
						if(sMagamYb.substring(0,1) == "N"){
							model.alert("처리할 수 없는 자료입니다.(보조부서 OR 이전차수 배부정보 미생성","최종배부정보생성");
					 	  	return false;
						}

						//set_refvalue("/root/reqData/searchData/clos_clsf","BB");
						set_refvalue("/root/reqData/searchData/clos_clsf",model1.getValue("/root/resData/resForm/mc_cost_3000_a/dataSet/xx_clos_clsf_030"));
						
						model.send("mc_cost_3000_a");						

						sMagamYb = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_03/record/col1");
												
						set_refvalue("/root/reqData/searchData/kind","09");			
						set_refvalue("/root/reqData/reqForm/yymm",G_Cym);
						
						model.send("mc_cost_3000_a");
						
						totalcnt = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_09/totalcnt");
												
						if(totalcnt > 0){
							model.alert("배부비자료에 등록되지 않은\n예외배부코드가 있습니다.","최종배부정보생성");
					 	  	return false;
						}
						
						send_mc_cost_3004_i();
						
						if(submit_completed()){
							if(model.getFocus() != "btn_process"){
								model.alert("저장되었습니다.","최종배부정보생성");
							}
							S_SeqDateCaption();
							datagrid1.rowStatus(4) = "4";
							process_cnt += 1;
						}
					]]>
				</script>
			</button>
			<button id="btn_delete_cb" class="btn06" crud="D" style="left:360px; top:30px; width:136px; height:21px; ">
				<caption>최종배부정보삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (show_message("해당 자료를 삭제하시겠습니까?","삭제 확인",MB_YESNO) != IDYES) {
					 	  	return false;
						}
						if(!commReqCheck(group_scr)) {
							return false;
						}
						set_refvalue("/root/reqData/searchData/yymm",G_Cym);
						set_refvalue("/root/reqData/searchData/kind","02");		//kind 02인경우 최종마감년월 Chk
												
						model.send("mc_cost_3000_a");
						sLAST_CYM = get_refvalue("/root/resData/resForm/mc_cost_3000_a/dataSet/CURLIST_02/record/col1");

						if(G_Cym <= sLAST_CYM){
							show_message("최종 마감월 이전 월은 배부처리 불가! (최종마감년월 " + sLAST_CYM.substring(0,4) + "-" +  sLAST_CYM.substring(4,6) + ")");
							return false;
						}
						
						set_refvalue("/root/reqData/reqForm/yymm",G_Cym);

						model.send("mc_cost_3009_d");

						if(submit_completed()){
							show_message("삭제되었습니다.");
							S_SeqDateCaption();
						}					
					]]>
				</script>
			</button>
			<button id="btn_select_cb" class="btn06" crud="R" style="left:499px; top:30px; width:136px; height:21px; ">
				<caption>최종배부결과조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.property("MC_COST_3000_yymm") = yymm.value;
						//viewer("mainFrame").window.javaScript.onLoadExPopupPage("MC_COST_3190");	
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("MC_COST_3190");
					]]>
				</script>
			</button>
			<caption id="caption11" class="tit02" style="left:5px; top:5px; width:524px; height:20px; ">최종배부처리</caption>
			<caption id="lblSeqBbgg" style="left:20px; top:30px; width:220px; height:20px; ">최종처리시간 : 1998/01/01 13:20</caption>
		</group>
		<group id="group1" style="left:20px; top:497px; width:867px; height:146px; ">
			<caption id="caption6" class="list_cap02" style="left:0px; top:0px; width:640px; height:142px; text-align:center; "/>
			<button id="btn_process" class="btn06" crud="R" style="left:220px; top:7px; width:136px; height:21px; ">
				<caption>원가배부일괄생성</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(show_message("일괄생성 하시겠습니까?","생성",4) == 7){
							return;
						}
					
						for(i = 1 ; i < 5 ; i++){
							datagrid1.rowStatus(i) = "1";
						}
						process_cnt = 0;
						btn_insert_gj.dispatch("onclick");
						btn_insert_jb.dispatch("onclick");
						btn_insert_bb.dispatch("onclick");
						btn_insert_cb.dispatch("onclick");
						
						if(submit_completed() && process_cnt == 4){
							show_message("일괄생성되었습니다.");
						}
					]]>
				</script>
			</button>
			<caption id="caption5" class="tit02" style="left:5px; top:5px; width:130px; height:20px; ">원가배부일괄처리</caption>
			<datagrid id="datagrid1" nodeset="/root/resData/gridData/grid1/record" caption="배부일괄생성결과" colsep="^" colwidth="190" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:220px; top:33px; width:212px; height:102px; ">
				<col ref="data1"/>
			</datagrid>
			<button id="btn_delete" class="btn06" crud="D" style="left:499px; top:7px; width:136px; height:21px; ">
				<caption>원가배부일괄취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(show_message("● 처리내역\n                 1) 원가배부마감되었을 경우 일괄삭제 불가\n                 2) 최종배부결과 삭제\n                 3) 보조부서 배부결과 삭제\n                 4) 전사비 배부결과 삭제\n                 5) 결산준비 삭제\n                 6) 월별예산코드 삭제\n                 7) 월별예외배부코드 삭제\n                 8) 월별부서별원가배부코드삭제\n                 9) 월별분류및출력구분코드삭제\n                10) 회계인터페이스배부비삭제\n                11) 인사인터페이스배부비삭제\n                12) 모든 마감구분을 처리전으로 변경\n\n상기 내역을 일괄취소 처리하시겠습니까 ?\n일괄 취소 처리시 (회계 및 인사배부자료 일괄처리) 부터 다시 처리 하세요.","취소",4) == 7){
							return;
						}
						set_refvalue("/root/reqData/reqForm/yymm",G_Cym);
						set_refvalue("/root/reqData/reqForm/incmg_pers",incmg_pers.value);
						model.send("mc_cost_9999_d");
						
						if(submit_completed()){
							show_message("일괄취소되었습니다.");
						}
					]]>
				</script>
			</button>
		</group>
	</xhtml:body>
</xhtml:html>
