<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session>
						</session>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
							<mc_budg_4010_m>
								<dataSet>
									<CURLIST1>
									</CURLIST1>
								</dataSet>
							</mc_budg_4010_m>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData>
							<mc_budg_4019_d>
								<budg_yy/>
								<work_dt/>
								<hsty_no/>
								<dept_cd/>
							</mc_budg_4019_d>
						</fwdData>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<mc_budg_4010_m>
								<work_dt/>
								<clsf_cd>1</clsf_cd>
								<dept_cd/>
								<crte_clsf>1</crte_clsf>
							</mc_budg_4010_m>
							<mc_budg_4011_l>
								<budg_yymm/>
								<budg_cd/>
								<dept_cd/>
								<evnt_cd/>
							</mc_budg_4011_l>
							<mc_budg_4016_l>
								<work_dt/>
								<hsty_no/>
								<dept_cd/>
							</mc_budg_4016_l>
							<mc_budg_4012_l>
								<work_dt/>
								<hsty_no/>
								<budg_yymm/>
								<budg_cd/>
								<dept_cd/>
								<evnt_cd/>
							</mc_budg_4012_l>
							<mc_budg_4015_l>
								<work_dt/>
								<dept_cd/>
								<clsf_cd/>
								<crte_clsf_cd/>
							</mc_budg_4015_l>
							<mc_budg_4017_l>
								<work_dt/>
								<hsty_no/>
								<dept_cd/>
							</mc_budg_4017_l>
							<mc_budg_1002_l>
								<budg_cd/>
							</mc_budg_1002_l>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqform/>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpDate>
							<mc_budg_4013_i>
								<multiUpdateData/>
								<work_dt/>
								<budg_yy/>
								<dept_cd/>
								<rmks2/>
								<incmg_pers/>
							</mc_budg_4013_i>
							<mc_budg_4014_i>
								<multiUpdateData/>
								<budg_yy/>
								<work_dt/>
								<hsty_no/>
								<budg_yymm/>
								<budg_cd/>
								<dept_cd/>
								<evnt_cd/>
								<rmks2/>
							</mc_budg_4014_i>
							<mc_budg_4018_d>
								<multiUpdateData/>
								<budg_yy/>
								<work_dt/>
								<hsty_no/>
							</mc_budg_4018_d>
						</multiUpDate>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resform>
							<mc_budg_4010_m>
								<dataSet>
									<xx_clsf_cd/>
									<xx_crte_clsf_cd/>
									<CURLIST4>
										<record>
											<max_sub_cd/>
										</record>
									</CURLIST4>
									<CURLIST3>
										<record>
											<dd/>
										</record>
									</CURLIST3>
									<CURLIST2>
										<record>
											<max_yymm/>
										</record>
									</CURLIST2>
									<CURLIST1>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURLIST1>
								</dataSet>
							</mc_budg_4010_m>
							<mc_budg_4011_l>
								<dataSet>
									<CURLIST>
										<record>
											<budg_yymm/>
											<dept_cd/>
											<dept_nm/>
											<budg_cd/>
											<evnt_nm/>
											<budg_nm/>
											<last_asin_amt/>
											<budg_ask_amt/>
											<budg_cndt_amt/>
											<chamt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4011_l>
							<mc_budg_4015_l>
								<dataSet>
									<CURLIST>
										<record>
											<hsty_no/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4015_l>
							<mc_budg_1002_l>
								<dataSet>
									<CURLIST>
										<record>
											<mang_item_cd/>
											<mang_item_nm/>
											<mang_item_val/>
											<acct_yn/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_1002_l>
						</resform>
						<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<gridData>
							<mc_budg_4016_l>
								<dataSet>
									<CURLIST>
										<record>
											<rmks2/>
											<budg_yymm/>
											<budg_cd/>
											<budg_nm/>
											<evnt_cd/>
											<evnt_nm/>
											<incmg_pers/>
											<yramt/>
											<amt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4016_l>
							<mc_budg_4017_l>
								<dataSet>
									<CURLIST>
										<record>
											<evnt_cd/>
											<evnt_nm/>
											<budg_cd/>
											<budg_nm/>
											<budg_yymm/>
											<use_dept_cd/>
											<use_dept_nm/>
											<medi_cd/>
											<medi_nm/>
											<rmks/>
											<yrsqty/>
											<yrdan/>
											<yramt/>
											<amt/>
											<qunt/>
											<uprc/>
											<hsty_no/>
											<sub_no/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4017_l>
							<mc_budg_4012_l>
								<dataSet>
									<CURLIST>
										<record>
											<amt_s/>
											<use_dept_cd/>
											<medi_cd/>
											<rmks/>
											<qunt/>
											<uprc/>
											<yramt/>
											<amt/>
											<hsty_no/>
											<sub_no/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4012_l>
						</gridData>
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<keyData/>
						<dept_cdnm/>
						<work_dd/>
						<rmks2/>
						<incmg_persnm/>
						<evnt_cdnm/>
						<budg_cdnm/>
						<hjamt/>
						<eramt/>
						<jhamt/>
						<bggnamt/>
						<fc_co_1101_l>
							<dataSet>
								<CURLIST1>
									<record>
										<cmpy_cd/>
										<dept_cd/>
										<dept_team_clsf/>
										<abrv_nm/>
										<offi_nm/>
										<dept_team_nm/>
										<part_nm/>
										<part_dn_nm/>
									</record>
								</CURLIST1>
							</dataSet>
						</fc_co_1101_l>
					</tempData>
					<!-- 저장소 -->
				</root>
			</instance>
			<submission id="mc_budg_4010_m" action="/mc/budg4000/4010" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4010_m" resultref="/root/resData/resform/mc_budg_4010_m/dataSet"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
				//컨트롤 초기화
				init_controls();
				
				//datagrid 컬럼 재 설정
				set_column_visibility();
				
				]]>
			</script>
			<submission id="mc_budg_4016_l" action="/mc/budg4000/4016" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4016_l" resultref="/root/resData/gridData/mc_budg_4016_l/dataSet"/>
			<submission id="mc_budg_4011_l" action="/mc/budg4000/4011" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4011_l" resultref="/root/resData/resform/mc_budg_4011_l/dataSet"/>
			<submission id="mc_budg_4012_l" action="/mc/budg4000/4012" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4012_l" resultref="/root/resData/resform/mc_budg_4012_l/dataSet"/>
			<submission id="mc_budg_4015_l" action="/mc/budg4000/4015" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4015_l" resultref="/root/resData/resform/mc_budg_4015_l/dataSet"/>
			<submission id="mc_budg_4013_i" action="/mc/budg4000/4013" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate/mc_budg_4013_i" resultref="/root/resData/MsgData"/>
			<submission id="mc_budg_4014_i" action="/mc/budg4000/4014_i" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate/mc_budg_4014_i" resultref="/root/resData/MsgData"/>
			<submission id="mc_budg_4017_l" action="/mc/budg4000/4017" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4017_l" resultref="/root/resData/resform/mc_budg_4017_l/dataSet"/>
			<submission id="mc_budg_4018_d" action="/mc/budg4000/4018" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate/mc_budg_4018_d" resultref="/root/resData/MsgData"/>
			<submission id="mc_budg_4019_d" action="/mc/budg4000/4019" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData/mc_budg_4019_d" resultref="/root/resData/MsgData"/>
			<submission id="mc_budg_1002_l" action="/mc/budg1000/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_1002_l" resultref="/root/resData/resform/mc_budg_1002_l/dataSet"/>
			<submission id="fc_co_1101" action="/fc/co1000/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/fc_co_1101_l/dataSet"/>
			<instance id="instance2">
				<root/>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				
				load_ch();
				]]>
			</script>
		</model>
		<script type="javascript" src="../../../js/TFCommon.js"/>
		<script type="javascript" src="../../../js/CIISComm.js"/>
		<script type="javascript" src="../../../js/fcmc_common.js"/>
		<script type="javascript">
			<![CDATA[
			var	_oth_clsf = "2";
			
			//-------------------------------------------------------------------------------
			//	컨트롤의 기본 설정 적용 및 컨트롤 별 포맷 적용
			//-------------------------------------------------------------------------------
			function init_controls() {
				//control의 기본 설정 적용
								
				//datagrid init
				set_default(
						"it was comment field"
				);
				
				datagrid1.attribute("explorerbar") = "";
				datagrid2.attribute("explorerbar") = "";
				datagrid3.attribute("explorerbar") = "";
		
				//combo init
				set_default(
						"it was comment field"
					,	work_dd
					,	hsty_no
				);
				//input init
				set_default(
						"it was comment field"
					,	dept_cdnm
					,	work_mm
					,	incmg_persnm
					,	rmks2
					,	srch_budg_yymm
					,	budg_cdnm
					,	evnt_cdnm
					,	hjamt
					,	eramt
					,	jhamt
					,	bggnamt
				);
				//input button init
				set_default(
						"it was comment field"
					,	srch_dept_cd
					,	incmg_pers
					,	srch_budg_cd
					,	srch_evnt_cd
				);
				//input date init
				set_default(
						"it was comment field"
				);

				//control format 설정 적용
				
				//코드
				set_format(
						"code"						//코드포맷,중간정렬,중간정렬
					,	datagrid1				,"3,10,11"
					,	datagrid3				,"3"
					,	srch_dept_cd
					,	hsty_no
					,	srch_budg_cd
					,	srch_evnt_cd
				);
				
				//금액
				set_format(
						"number5"						//숫자포맷,오른쪽정렬,중간정렬,(#,###)
					,	datagrid1				,"6,7,8,9"
					,	datagrid3				,"6,7,8"
					,	hjamt
					,	eramt
					,	jhamt
					,	bggnamt
				);
				
				//날짜
				set_format(
						"date_1"						//날짜포맷,중간정렬,중간정렬,yyyy-mm-dd
				);
				
				//날짜
				set_format(
						"month_1"						//날짜포맷,중간정렬,중간정렬,yyyy-mm
					,	datagrid2				,"5"
					,	work_mm
					,	srch_budg_yymm
				);
				
				//문자열(왼쪽)
				set_format(
						"string_l"						//문자열,왼쪽정렬,중간정렬
					,	datagrid1				,"2,4,5"
					,	datagrid2				,"1,3"
					,	datagrid3				,"2,4,5"
					,	dept_cdnm
					,	work_dd
					,	incmg_pers
					,	incmg_persnm
					,	rmks2
					,	budg_cdnm
					,	evnt_cdnm
				);
				
				
			}
			
			//-------------------------------------------------------------------------------
			//	datagrid의 컬럼 설정
			//-------------------------------------------------------------------------------
			function set_column_visibility() {
				//모든 컬럼을 감춘다.
				hide_all_columns(datagrid1);
				hide_all_columns(datagrid2);
				hide_all_columns(datagrid3);
				//공통항목을 보여준다.
				show_columns(datagrid1,"2,3,4,5,6,7,8,9,10,11");
				show_columns(datagrid2,"1,3,5,6,7");
				show_columns(datagrid3,"2,3,4,5,6,7,8");
			}
			
			var W_CYM;
			var W_GHjmg;
			
			var W_SaveYH;
			var W_IRIRSEQ;
			var W_IRYCCYMD;
			var W_ActiveRow;
			var W_Jeogyo;
			var W_Heentsb;
			var W_SelectIRSEQ;
			var W_SelectAllCnt;
			
			var medi_cd_ch_var;
						
			function load_ch(){
				var ref_4010 = "/root/reqData/searchData/mc_budg_4010_m/";
				set_refvalue(ref_4010 + "dept_cd", srch_dept_cd.value);				
				
				model.send("mc_budg_4010_m");
				makeComboGubun("","/root/initData/comboSet/mc_budg_4010_m/dataSet/CURLIST1","record","cdabrvnm_cd", "cd");
				//alert(model1.getValue("/root/resData/resform/mc_budg_4010_m/dataSet/xx_clsf_cd"));
				//alert(model1.getValue("/root/resData/resform/mc_budg_4010_m/dataSet/xx_crte_clsf_cd"));
				
				var result_4010 = "/root/resData/resform/mc_budg_4010_m/dataSet/";
				
				W_CYM = get_refvalue(result_4010 + "CURLIST2/record/max_yymm");
				W_GHjmg = get_refvalue(result_4010 + "CURLIST4/record/max_sub_cd");
				model.copyNode("/root/initData/comboSet/mc_budg_4010_m/dataSet/CURLIST1","/root/resData/resform/mc_budg_4010_m/dataSet/CURLIST1");
				model.removenode("/root/resData/resform/mc_budg_4010_m/dataSet/CURLIST3");
				
				set_refvalue(incmg_pers,getProperty("ss_emp_no"));
				incmg_pers.dispatch("xforms-value-changed");
				
				W_IRIRSEQ ="";
			}
			
//			function open_mc_co_1010() {
//				
//				W_SaveYH = "";
//				W_Jeogyo = "";
//				W_SelectIRSEQ = "";
//				W_SelectAllCnt = 0;
//				
//				set_refvalue(work_mm,"");
//				set_refvalue(work_dd,"");
//				set_refvalue(hsty_no,"");
//				set_refvalue(rmks2,"");
//				set_refvalue(srch_budg_yymm,"");
//				set_refvalue(srch_budg_cd,"");
//				set_refvalue(srch_evnt_cd,"");
//				
//				var popid = "mc_co_1010";
//				var rcvs_flag = false;
//				
//				if (event != null && event.name == "xforms-value-changed") {
//					//값이 변경되면 기존에 조회된 자료를 모두 제거한다.
//					reset_popup_rcvs_data(popid);
//				}
//				
//				set_popup_send_data(popid,"mode","sr");
//				set_popup_send_data(popid,"title","");
//				set_popup_send_data(popid,"readonly","0");
//				set_popup_send_data(popid,"datafilter","");				
//				set_popup_send_data(popid,"dept_cd",get_refvalue(srch_dept_cd));
//				set_popup_send_data(popid,"require","dept_cd");	
//				
//				rcvs_flag = call_mc_co_1010();
//				if (rcvs_flag) {
//					//정상처리
//				}
//				else {
//					//취소버튼을 누른 경우 조회 조회를 위한 값과 조회된 값이 틀린 경우 기존 값을 모두 제거한다.
//				}
//				
//				//value-changed 와 buttonclick이 동시 발생했을 경우
//				//이하 코드는 두번씩 실행되므로 무거운 코드는 넣지 않도록 하자
//
//				//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
//				//다시 조회 하기 쉽도록 하고
//				
//				set_refvalue(srch_dept_cd,get_popup_rcvs_data(popid,"dept_cd"));
//
//				set_refvalue(dept_cdnm,get_popup_rcvs_data(popid,"abrv_nm"));
//								
//				return rcvs_flag;
//			}
			function setDept_cd(iv_dept_cd, iv_dept_nm, iv_dept_team_clsf, iv_offi_nm, iv_dept_team_nm, iv_part_nm, iv_part_dn_nm){	
				set_refvalue(srch_dept_cd, iv_dept_cd);
				set_refvalue(dept_cdnm, iv_dept_nm);
			}
				
			function work_mm_ch(){
				if(work_mm.value == "" || work_mm.value.length != 6){
					return false;
				}
				
				var ref_4010 = "/root/reqData/searchData/mc_budg_4010_m/";
				set_refvalue(ref_4010 + "dept_cd",srch_dept_cd.value);
				
				model.send("mc_budg_4010_m");
				makeComboGubun("","/root/initData/comboSet/mc_budg_4010_m/dataSet/CURLIST3","record","dd", "dd");
				
				work_dd.refresh();
				
				W_SaveYH = "";
				W_Jeogyo = "";
				W_SelectIRSEQ = "";
				W_SelectAllCnt = 0;
				set_refvalue(work_dd,"");
				set_refvalue(hsty_no,"");
				set_refvalue(rmks2,"");
				set_refvalue(srch_budg_yymm,"");
				set_refvalue(srch_budg_cd,"");
				set_refvalue(srch_evnt_cd,"");
				
				datagrid_clear();
			}
			
			function datagrid_clear(){
				datagrid_data_clear(datagrid1);
				datagrid_data_clear(datagrid2);
				datagrid_data_clear(datagrid3);
			}
			
			function work_dd_ch(){
				
				W_SaveYH = "";
			       W_Jeogyo = "";
         			W_SelectIRSEQ = "";
				W_SelectAllCnt = 0;
				
				set_refvalue(hsty_no,"");
				set_refvalue(rmks2,"");
				set_refvalue(srch_budg_yymm,"");
				set_refvalue(srch_budg_cd,"");
				set_refvalue(srch_evnt_cd,"");
				
				datagrid_clear();
				
				var ref_4015 = "/root/reqData/searchData/mc_budg_4015_l/";
				set_refvalue(ref_4015 + "work_dt",(work_mm.value+work_dd.value));
				//set_refvalue(ref_4015 + "clsf_cd","1");
				//set_refvalue(ref_4015 + "crte_clsf_cd","1");
				set_refvalue(ref_4015 + "clsf_cd",model1.getValue("/root/resData/resform/mc_budg_4010_m/dataSet/xx_clsf_cd"));
				set_refvalue(ref_4015 + "crte_clsf_cd",model1.getValue("/root/resData/resform/mc_budg_4010_m/dataSet/xx_crte_clsf_cd"));
				set_refvalue(ref_4015 + "dept_cd",srch_dept_cd.value);
				
				model.send("mc_budg_4015_l");
				makeComboGubun("","/root/resData/resform/mc_budg_4015_l/dataSet/CURLIST","record","hsty_no", "hsty_no");
				
				hsty_no.refresh();
			}
			
			function hsty_no_ch(){
				
				set_refvalue(rmks2,"");
				set_refvalue(srch_budg_yymm,"");
				set_refvalue(srch_budg_cd,"");
				set_refvalue(srch_evnt_cd,"");
				
				W_Jeogyo = "";
				
				var ref_4016 = "/root/reqData/searchData/mc_budg_4016_l/";
				set_refvalue(ref_4016 + "work_dt",(work_mm.value+work_dd.value));
				set_refvalue(ref_4016 + "dept_cd",srch_dept_cd.value);
				
				model.send("mc_budg_4016_l");
				
				var result_4016 = "/root/resData/gridData/mc_budg_4016_l/dataSet/CURLIST/"
				if(get_refvalue(result_4016 + "totalcnt") > 0){
					btn_copy.disabled = false;
				}else{
					btn_copy.disabled = true;
					btn_insert.attribute("visibility") = "visible";
					btn_update.attribute("visibility") = "hidden";
				}
				
				set_refvalue("rmks2",result_4016 + "record[0]/rmks2");
				W_Jeogyo = rmks2.value;
				set_refvalue("incmg_pers",result_4016 + "record[0]/incmg_pers");
				W_Heentsb = incmg_pers.value
				incmg_pers.dispatch("xforms-value-changed");
				
			}
			
			function setEmp_no(emp_no, nm_korn){

				incmg_pers.value= emp_no;
				incmg_persnm.value = nm_korn;

			}
			
			function datagrid2_click(){
				
				var row = datagrid2.row;
				var col = datagrid2.col;
				var budg_yymm_ref = datagrid2.colRef("budg_yymm");
				var budg_cd_ref = datagrid2.colRef("budg_cd");
				var evnt_cd_ref = datagrid2.colRef("evnt_cd");
								
				if(row>= datagrid2.fixedRows){
					if(datagrid2.valueMatrix(row,budg_yymm_ref) == ""){
						set_refvalue(srch_budg_yymm,"");
						set_refvalue(srch_dept_cd,"");
						set_refvalue(dept_cdnm,"");
						set_refvalue(srch_budg_cd,"");
						set_refvalue(budg_cdnm,"");
						set_refvalue(srch_evnt_cd,"");
						set_refvalue(evnt_cdnm,"");
					}
					set_refvalue(srch_budg_yymm,datagrid2.valueMatrix(row,budg_yymm_ref));
					set_refvalue(srch_budg_cd,datagrid2.valueMatrix(row,budg_cd_ref));
					set_refvalue(srch_evnt_cd,datagrid2.valueMatrix(row,evnt_cd_ref));
					
					var medi_cd_ref = datagrid1.colRef("medi_cd");
					
					if(W_SaveYH = "C"){
						if(medi_cd_ch_var != ""){
							datagrid3.colHidden(medi_cd_ref) = true;
						}else{
							datagrid3.colHidden(medi_cd_ref) = false;
						}
					}else{
						btn_select.dispatch("onclick");
						if(medi_cd_ch_var != ""){
							datagrid3.colHidden(medi_cd_ref) = true;
						}else{
							datagrid3.colHidden(medi_cd_ref) = false;
						}
					}
				}
			}
			
			function select_ch(){
				//필수항목체크(검색)
				if(!commReqCheck(group_scr)) {
					return false;
				}
				source.disabled = false;
				copy.disabled = true;
				btn_copy.disabled = true;
				btn_update.attribute("visibility") = "visible";
															
				model.send("mc_budg_4011_l");
				
				var ref_4012 = "/root/reqData/searchData/mc_budg_4012_l/";
				
				set_refvalue(ref_4012 + "work_dt",(work_mm.value+work_dd.value));
				set_refvalue(ref_4012 + "hsty_no",hsty_no.value);
				set_refvalue(ref_4012 + "dept_cd",srch_dept_cd.value);
				set_refvalue(ref_4012 + "srch_budg_yymm",srch_budg_yymm.value);
				set_refvalue(ref_4012 + "srch_budg_cd",srch_budg_cd.value);
				set_refvalue(ref_4012 + "srch_evnt_cd",srch_evnt_cd.value);
				
				model.send("mc_budg_4012_l");
				
				var result_4011 = "/root/resData/resform/mc_budg_4011_l/dataSet/CURLIST/record[0]/";
				
				set_refvarlue(hjamt,result_4011 + "last_asin_amt");
				set_refvarlue(eramt,result_4011 + "budg_ask_amt");
				set_refvarlue(jhamt,result_4011 + "budg_cndt_amt");

				var yramt_ref = datagrid1.colRef("yramt");
				set_refvarlue(bggnamt,datagrid_data_sum(datagrid1,datagrid1.fixedRows,yramt_ref,datagrid1.rows,yramt_ref));
				var amt_s_ref = datagrid1.colRef("amt_s");
				var select_ref = datagrid1.colRef("select");
				var amt_ref = datagrid1.colRef("amt");
				var ctn = 0;
				
				for(i = datagrid1.fixedRows ; i <= datagrid1.rows ; i++){
					datagrid1.valueMatrix(i,select_ref) == "R"
					if(datagrid1.valueMatrix(i,amt_ref) == 0){
						datagrid1.valueMatrix(i,amt_s_ref) = "요청";
					}else{
						datagrid1.valueMatrix(i,amt_s_ref) = "승인";
						ctn = ctn + 1;
					}
					if(datagrid1.valueMatrix(i,amt_s_ref) == "승인"){
						datagrid1.rowHidden(i) = true;
					}
				}
				
				if(W_CYM >= srch_budg_yymm.value){
					show_columns(datagrid2,"2,3,4,5,6,7,9,10");
				}else{
					hide_columns(datagrid1,"2,3,4,5,6,7,");
				}
				if(ctn > 0){
					btn_insert.attribute("visibility") = "visible";
					btn_update.attribute("visibility") = "hidden";
				}else{
					if(get_refvalue("/root/resData/resform/mc_budg_4012_l/dataSet/CURLIST/totalcnt") == 0){
						btn_insert.attribute("visibility") = "hidden";
						btn_update.attribute("visibility") = "visible";
					}else{
						if(hsty_no.value.length > 0){
							btn_insert.attribute("visibility") = "visible";
							btn_update.attribute("visibility") = "hidden";
						}else{
							btn_insert.attribute("visibility") = "hidden";
							btn_update.attribute("visibility") = "visible";
						}
					}
				}
			}
			
			function updata_ch(){
				if(rmks2.value != W_Jeogyo || incmg_pers.value !=W_Heentsb){
					W_SaveYH == "J";
				}else{
					W_SaveYH == "U";
				}
				if (show_message("해당 일련번호에 저장됩니다. 저장하시겠습니까?","저장 취소",MB_YESNO) != IDYES) {
					return false;
				}
				save_function();
			}
			
			function srch_budg_yymm_ch(){
				var yymm_var = srch_budg_yymm.value;
				if(yymm_var == "" || yymm_var.length != 6){
					return false;
				}
				if(yymm_var.substring(0,4) > (W_GHjmg -1)){
					show_message("["+ yymm_var.substring(0,4) +"년] 에대한 경리마감처리가 되지 않았으므로 추경작업을 할 수 없습니다.");
					set_refvalue(srch_budg_yymm,"");
					return false;
				}
				if(W_CYM >= yymm_var){
					show_message("해당 월은 월마감되었으므로 처리가 불가능합니다.");
					set_refvalue(srch_budg_yymm,"");
					return false;
				}
				if(W_SaveYH != "C"){
					var select_ref = datagrid1.colRef("select");
					for(i = datagrid1.fixedRows ; i <= datagrid1.rows ; i++){
						datagrid1.valueMatrix(i,select_ref) = "I";
					}
				}
			}
			
			function open_mc_co_1020_budg_cd() {				
				var popid = "mc_co_1020";
				var rcvs_flag = false;

//					if (!check_reqItem(dept_cd,"trim","focus","부서코드를 먼저 조회하세요.")) {return false;}
//					if (!check_reqItem(srch_abrv_nm,"trim",dept_cd,"부서코드 조회가 되지 않았습니다. 부서코드를 먼저 조회하세요.")) {return false;}

				if (event != null && event.name == "xforms-value-changed") {
					//값이 변경되면 기존에 조회된 자료를 모두 제거한다.
					reset_popup_rcvs_data(popid);
				}
				
				set_popup_send_data(popid,"mode","sr");
				set_popup_send_data(popid,"title","예산코드조회");
				set_popup_send_data(popid,"readonly","0");
				set_popup_send_data(popid,"datafilter","");	
				//행사코드조회
				set_popup_send_data(popid,"searchid","2");
//					set_popup_send_data(popid,"msg","[" + srch_abrv_nm.value + "] 부서에서 등록한 예산행사코드만이 조회됩니다.");
				//부서코드가 정상적으로 조회된 경우에만 처리해야 함
//					set_popup_send_data(popid,"dept_cd",dept_cd.value);
				set_popup_send_data(popid,"cd",get_refvalue(srch_budg_cd));
				set_popup_send_data(popid,"cdnm","");
				set_popup_send_data(popid,"require","cd");	
				set_popup_send_data(popid,"dept_cd",srch_dept_cd);
				
				rcvs_flag = call_mc_co_1020("mc_co_1002_l","CURLIST",false);
				if (rcvs_flag) {
					//정상처리
				}
				else {
					//취소버튼을 누른 경우 조회 조회를 위한 값과 조회된 값이 틀린 경우 기존 값을 모두 제거한다.
				}
				
				//value-changed 와 buttonclick이 동시 발생했을 경우
				//이하 코드는 두번씩 실행되므로 무거운 코드는 넣지 않도록 하자

				//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
				//다시 조회 하기 쉽도록 하고
				if (get_popup_rcvs_data(popid,"cd") != "") {
					set_refvalue(srch_budg_cd,get_popup_rcvs_data(popid,"cd"));
				}
				set_refvalue(budg_cdnm,get_popup_rcvs_data(popid,"cdnm"));
				
				return rcvs_flag;
			}
			
			function open_mc_co_1020_evnt_cd() {
				var popid = "mc_co_1020";
				var rcvs_flag = false;

				if (!check_reqItem(srch_dept_cd,"trim","focus","부서코드를 먼저 조회하세요.")) {return false;}
				if (!check_reqItem(dept_cdnm,"trim",srch_dept_cd,"부서코드 조회가 되지 않았습니다. 부서코드를 먼저 조회하세요.")) {return false;}

				if (event != null && event.name == "xforms-value-changed") {
					//값이 변경되면 기존에 조회된 자료를 모두 제거한다.
					reset_popup_rcvs_data(popid);
				}
				
				set_popup_send_data(popid,"mode","sr");
				set_popup_send_data(popid,"title","고유행사코드조회");
				set_popup_send_data(popid,"readonly","0");
				set_popup_send_data(popid,"datafilter","");	
				//행사코드조회
				set_popup_send_data(popid,"searchid","16");
				set_popup_send_data(popid,"msg","[" + dept_cdnm.value + "] 부서에서 등록한 예산행사코드만이 조회됩니다.");
				//부서코드가 정상적으로 조회된 경우에만 처리해야 함
				set_popup_send_data(popid,"dept_cd",srch_dept_cd.value);
				set_popup_send_data(popid,"cd",srch_evnt_cd.value);
				set_popup_send_data(popid,"cdnm","");
				
				set_popup_send_data(popid,"require","cd");	
				
				rcvs_flag = call_mc_co_1020("mc_co_1005_l","CURLIST",false);
				if (rcvs_flag) {
					//정상처리
				}
				else {
					//취소버튼을 누른 경우 조회 조회를 위한 값과 조회된 값이 틀린 경우 기존 값을 모두 제거한다.
				}
				
				//value-changed 와 buttonclick이 동시 발생했을 경우
				//이하 코드는 두번씩 실행되므로 무거운 코드는 넣지 않도록 하자

				//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
				//다시 조회 하기 쉽도록 하고
				if (get_popup_rcvs_data(popid,"cd") != "") {
					set_refvalue(srch_evnt_cd,get_popup_rcvs_data(popid,"cd"));
				}
				
				set_refvalue(evnt_cdnm,get_popup_rcvs_data(popid,"cdnm"));
				
				return rcvs_flag;
			}
			
			function medi_cd_ch(){
				set_refvalue("/root/reqData/searchData/mc_budg_1002_l/budg_cd",srch_budg_cd.value);
				model.send("mc_budg_1002_l");
				var ch_var = get_refvalue("/root/resData/resform/mc_budg_4015_l/dataSet/CURLIST/record/mang_item_cd");
				if(ch_var == "03"){
					return true;
				}else{
					return false;
				}
			}
			
			function datagrid1_click(){
				var row = datagrid1.row;
				var col = datagrid1.col;
				var amt_s_ref = datagrid1.colRef("amt_s");
				var select_ref = datagrid1.colRef("select");
				if(col == amt_s_ref){
					show_message("입력/수정할 수 없는 칼럼입니다");
					return false;
				}
				if(col < datagrid1.fixedCols){
					if(datagrid1.valueMatrix(row,amt_s_ref) == "승인"){
						show_message("이미 승인되었으므로 삭제할 수 없습니다.");
						return false;
					}
					var row_style = datagrid1.rowStyle(row, "data", "background-color");
					var select_var = datagrid1.valueMatrix(i,select_ref);
					if(row_style == "#FFF000"){
						datagrid1.rowStyle(row, "data", "background-color") = "#FFFFFF";
					}else if(select_var == "R" || select_var == "U"){
						datagrid1.rowStyle(row, "data", "background-color") = "#FFF000";
					}
				}
			}
			
			function datagrid3_click(){
				var row = datagrid3.row;
				var col = datagrid3.col;
				var amt_s_ref = datagrid3.colRef("amt_s");
				var select_ref = datagrid3.colRef("select");
				if(col == amt_s_ref){
					show_message("입력/수정할 수 없는 칼럼입니다");
					return false;
				}
				if(col < datagrid1.fixedCols){
					var row_style = datagrid3.rowStyle(row, "data", "background-color");
					var select_var = datagrid3.valueMatrix(i,select_ref);
					if(row_style == "#FFF000"){
						datagrid3.rowStyle(row, "data", "background-color") = "#FFFFFF";
					}else if(datagrid3.valueMatrix(i,amt_s_ref) != ""){
						datagrid3.rowStyle(row, "data", "background-color") = "#FFF000";
					}
				}
			}
			
			function datagrid1_changed(){
				var row = datagrid1.row;
				var col = datagrid1.col;
				var select_ref = datagrid1.colRef("select");
				var amt_s_ref = datagrid1.colRef("amt_s");
				var use_dept_cd_ref = datagrid1.colRef("use_dept_cd");
				var yramt_ref = datagrid1.colRef("yramt");
				var qunt_ref = datagrid1.colRef("qunt");
				var uprc_ref = datagrid1.colRef("uprc");
				var select_ch = datagrid1.valueMatrix(row,select_ref);
				var dept_cd_var  = datagrid1.valueMatrix(row,use_dept_cd_ref);
				
				if(col == use_dept_cd_ref){					
					var ch_var;
					if(ch_var == ""){
						ch_var = false;
					}else{
						ch_var = dept_cd_check(dept_cd_var);
					}
					if(!ch_var){
						for(i = datagrid1.fixedCols ; i <= datagrid1.cols; i++){
							datagrid1.valueMatrix(row,i) = "";
						}					
						return false;
					}
				}
				
				if(select_ch == ""){
					datagrid1.valueMatrix(row,select_ref) = "I";
					datagrid1.valueMatrix(row,amt_s_ref) = "요청";
				}else{
					if(select_ch == "R" || select_ch == "U"){
						datagrid1.valueMatrix(row,select_ref) = "U"
					}else if(select_ch == "I"){
						if(dept_cd_var == ""){
							for(i = datagrid1.fixedCols ; i <= datagrid1.cols ; i++){
								datagrid1.valueMatrix(row,i) = "";
							}
						}
					}
				}
				
				
				
			}
			
			function datagrid3_changed(){
				var row = datagrid3.row;
				var col = datagrid3.col;
				var select_ref = datagrid3.colRef("select");
				var amt_s_ref = datagrid3.colRef("amt_s");
				var use_dept_cd_ref = datagrid3.colRef("use_dept_cd");
				var medi_cd_ref = datagrid3.colRef("medi_cd");
				var yramt_ref = datagrid3.colRef("yramt");
				var qunt_ref = datagrid3.colRef("qunt");
				var uprc_ref = datagrid3.colRef("uprc");
				var medi_ch_ref = datagrid3.colRef("medi_ch");
				var select_ch = datagrid3.valueMatrix(row,select_ref);
				var dept_cd_var  = datagrid3.valueMatrix(row,use_dept_cd_ref);
				var medi_cd_var = datagrid3.valueMatrix(row,medi_cd_ref);
				
				if(col == use_dept_cd_ref){					
					var ch_var;
					if(ch_var == ""){
						ch_var = false;
					}else{
						ch_var = dept_cd_check(dept_cd_var);
					}
					if(!ch_var){
						for(i = datagrid3.fixedCols ; i <= datagrid3.cols; i++){
							datagrid3.valueMatrix(row,i) = "";
						}					
						return false;
					}
				}
				
				if(dept_cd_var == ""){
					show_message("필수 입력 항목이 입력되지 않았습니다.");
					datagrid1.valueMatrix(row,col) = "";
					return false;
				}
				
				if(col > medi_cd_ref){
					if(medi_cd_ch_var != "" && dept_cd_var != ""){
						show_message("필수 입력 항목이 입력되지 않았습니다.(매체코드)");
						datagrid1.valueMatrix(row,col) = "";
						return false;
					}
				}
				
				if(col == qunt_ref || col == uprc_ref){
					var dan = 0;
					var sqty = 0;
					var ch_sqty = datagrid1.valueMatrix(qunt_ref,col);
					var ch_dan = datagrid1.valueMatrix(uprc_ref,col);
					if(ch_sqty != ""){
						sqyt = ch_sqty;
					}
					if(ch_dan != ""){
						dan = ch_dan;
					}
					
					datagrid1.valueMatrix(row,yramt_ref) = sqty * dan;
					
					if(sqyt != 0 && dan != 0){
						datagrid1.isReadOnly(row,yramt_ref) = true;
					}else{
						datagrid1.isReadOnly(row,yramt_ref) = false;
					}
				}
				if(medi_cd_ch_var != "" ){
					datagrid3.valueMatrix(row,medi_ch_ref) = "M";
				}
			}
			
			function dept_cd_check(dept_cd_ch) {
				var popid = "mc_co_1010";
				var rcvs_flag = false;
				
					reset_popup_rcvs_data(popid);
				
				
				set_popup_send_data(popid,"mode","sr");
				set_popup_send_data(popid,"title","");
				set_popup_send_data(popid,"readonly","0");
				set_popup_send_data(popid,"datafilter","");				
				set_popup_send_data(popid,"dept_cd",dept_cd_ch);
				set_popup_send_data(popid,"require","dept_cd");	
				
				rcvs_flag = call_mc_co_1010();
				
				return rcvs_flag;
				
			}
			
			function insert_ch(){
				//필수항목체크(검색)
				if(!commReqCheck(group_scr)) {
					return false;
				}
				if(!commReqCheck(group2)) {
					return false;
				}
				
				if(W_CYM >= srch_budg_yymm.value){
					show_message("해당 월은 월마감되었으므로 처리가 불가능합니다.");
					return false;
				}
				if(W_SaveYH != "C"){
					W_SaveYH = "I";
					if (show_message("신규 일련번호가 추가됩니다. 저장하시겠습니까?","저장 취소",MB_YESNO) != IDYES) {
						return false;
					}
				}
				save_function();
			}
			
			function save_function(){
				if(!datagrid1_check()){
					show_message("매체코드가 미입력됐거나 금액이 0입니다.");
					return false;
				}
				for(i = datagrid1.fixedRows ; i <= datagrid1.rows ; I++){
					var select_ref = datagrid1.colRef("select");
					
					var yramt_ref = datagrid1.colRef("yramt");
					var qunt_ref = datagrid1.colRef("qunt");
					var uprc_ref = datagrid1.colRef("uprc");
					
					if(datagrid1.valueMatrix(i,select_ref) != "R" ||datagrid1.valueMatrix(i,select_ref) != ""){
						if(datagrid1.valueMatrix(i,yramt_ref) < 0 ||datagrid1.valueMatrix(i,qunt_ref) < 0 || datagrid1.valueMatrix(i,uprc_ref) <0){
							if (show_message("저장하려는 data중에 (-)금액이 존재합니다. 그대로 저장하시겠습니까?","저장 취소",MB_YESNO) != IDYES) {
								break;
							}else{
								return false;
							}
						}
					}
				}
				
				if(W_SaveYH == "C"){
					var select_ref = datagrid3.colRef("select");
					var use_dept_cd_ref = datagrid3.colRef("use_dept_cd");
					var medi_cd_ref = datagrid3.colRef("medi_cd");
					var err_dept = 0;
					var err_medi = 0;
					for(var i = datagrid3.fixedRows ; i <= datagrid1.rows ; i ++){
						if(datagrid3.valueMatrix(i,use_dept_cd_ref) == ""){
							err_dept = err_dept + 1;
						}
						if(datagrid3.valueMatrix(i,medi_cd_ref) == ""){
							err_medi = err_medi + 1;
						}						
					}
					if(err_dept > 0){
						show_message("입력하고자 하는 데이타중에 사용부서가 미입력된 데이타가 존재합니다.");
						return false;
					}
					if(err_dept > 0){
						show_message("입력하고자 하는 데이타중에 매체필수 항목에 미입력된 매체가 존재합니다.");
					}
					
					ref_4013 = "/root/reqData/multiUpDate/mc_budg_4013_i/";
					set_refvalue(ref_4013 + "work_dt",(work_mm.value + work_dd.value));
					set_refvalue(ref_4013 + "budg_yy",work_mm.value.substring(0,4));
					set_refvalue(ref_4013 + "dept_cd",srch_dept_cd.value);
					set_refvalue(ref_4013 + "rmks2",rmks2.value);
					
					model.send("mc_budg_4013_i");
					
				}else{
					var ref_4014 = "/root/reqData/multiUpDate/mc_budg_4014_i/";
					var select_ref = datagrid1.colRef("select");
					if(W_SaveYH != "I" || W_SaveYH != "C"){
						set_refvalue(ref_4014 + "hsty_no",hsty_no.value);
						set_refvalue(ref_4014 + "work_dt",(work_mm.value + work_dd.value));
						set_refvalue(ref_4014 + "budg_cd",srch_budg_cd.value);
						set_refvalue(ref_4014 + "dept_cd", srch_dept_cd.value);
						if(srch_evnt_cd.value == ""){
							srch_evnt_cd.value = " ";
						}
						set_refvalue(ref_4014 + "evnt_cd", srch_evnt_cd.value);
						var ch_select;
						for(var i = datagrid1.fixedRows ; i <= datagrid1.rows ; i++){
							ch_select = datagrid1.valueMatrix(i,select_ref);
							if(ch_select != ""){
								if(W_SaveYH == "I"){
									 datagrid1.valueMatrix(i,select_ref) = "II";
								}else if(W_SaveYH == "J"){
									if(ch_select == "I"){
										datagrid1.valueMatrix(i,select_ref) = "JI";
									}else if (ch_select == "U" || ch_select == "R"){
										datagrid1.valueMatrix(i,select_ref_ = "JU");
									}
								}
							}
						}
					}
					set_refvalue(ref_4014 + "multiUpdateData",datagrid1.getUpdateData());
					model.send("mc_budg_4014");
				}
				if(W_SaveYH == "I" || W_SaveYH == "C"){
					var mon = work_dd.value;
					work_mm.dispatch("xforms-value-changed");
				}else{
					hsty_no.dispatch("xforms-value-changed");
				}
			}
			
			function datagrid1_check(){
				var cnt = 0;
				var err_cnt = 0;
				var m_chk = 0;
				var a_chk = 0;
				
				var select_ref = datagrid1.colRef("select");
				
				var yramt_ref = datagrid1.colRef("yramt");
				var qunt_ref = datagrid1.colRef("qunt");
				var uprc_ref = datagrid1.colRef("uprc");
				var amt_var;
				var sqty_var;
				var dan_var;
				
				for(i = datagrid1.fixedRows ; i <= datagrid1.rows ; i++){
					var select_var = datagrid1.valueMatrix(i,select_ref);
					if(select_var == "I"){
						ctn = ctn + 1;
						amt_var = datagrid1.valueMatrix(i,yramt_ref);
						sqty_var = datagrid1.valueMatrix(i,qunt_ref);
						dan_var = datagrid1.valueMatrix(i,uprc_ref);
						if(amt_var == 0){
							err_cnt = err_cnt + 1;
							a_chk = a_chk + 1;
							if(sqyt_var == "" && dan_var != ""){
								err_cnt = err_cnt + 1;
								a_chk = a_chk +1;
							}else{
								 if(sqyt_var != "" && dan_var == ""){
									err_cnt = err_cnt + 1;
									a_chk = a_chk +1;
								 }
							}
						}
					}
				}
				
				if(err_cnt > 0 ){
					return false;
				}else{
					return true;
				}
			}
			
			function copy_click(){
				source.disabled = true;
				copy.disabled = false;
				copy.dispatch("onclick");
				
				W_SaveYH = "C";
				W_IRIRSEQ = hsty_no.value;
				W_IRYCCYMD = work_mm.value + work_dd.value;
				to_day = commCurDate();
				set_refvalue(work_mm,to_day.substring(0,6));
				set_refvalue(work_dd,to_substring(6,8));
				W_SelectAllCnt = 0;
				
				var ref_4017 = "/root/reqData/searchData/mc_budg_4017_l/";
				set_refvalue(ref_4017 + "work_dt", W_IRYCCYMD);
				set_refvalue(ref_4017 + "dept_cd", srch_dept_cd.value);
				set_refvalue(ref_4017 + "hsty_no", W_IRIRSEQ);
				
				model.send("mc_budg_4017_l");
				
				var select_ref = datagrid3.colRef("select");
				var amt_s_ref = datagrid3.colRef("amt_s");
				var pos_ref = datagrid3.colRef("pos");
				
				for(i = datagrid3.fixedRows ; i <= datagrid3.row ; i++){
					datagrid3.valueMatrix(i,select_ref) = "I";
					datagrid3.valueMatrix(i,amt_s_ref) = "요청";
					datagrid3.valueMatrix(i,pos_ref) = i;					
				}
								
				btn_insert.attribute("visibility") = "visible";
				btn_update.attribute("visibility") = "hidden";
				
				var medi_cd_ref = datagrid1.colRef("medi_cd");				
				if(medi_cd_ch_var != ""){
					datagrid3.colHidden(medi_cd_ref) = true;
				}else{
					datagrid3.colHidden(medi_cd_ref) = false;
				}
			}
			
			function delete_click(){
				if(W_SaveYH == "C"){
					
					return false;
				}
				
				if(srch_dept_cd.value == "" || work_mm.value == ""){
					show_message("필수입력항목이 입력되지 않았습니다.");
					return false;
				}
				if(srch_budg_yymm.value == ""){return false;}
				if(W_CYM >= srch_budg_yymm.value){
					show_message("해당 월은 월마감되었으므로 처리가 불가능합니다.");
					return false;
				}
				if (show_message("삭제하시겠습니까?","삭제 확인",MB_YESNO) != IDYES) {
					return false;
				}
				var ch_var = 0;
				for(i = datagrid1.fixedRows ; i <= datagrid1.rows ; i++){
					if(datagrid1.rowStyle(i, "data", "background-color") == "#FFF000"){
						datagrid1.rowStatus(i) = 4;
						ch_var = ch_var + 1;
					}else{
						datagrid1.rowStatus(i) = "";
					}
				}
				
				if(ch_var >0){
					var ref_4018 = "/root/reqData/multiUpDate/mc_budg_4018_d/";
					set_refvalue(ref_4018 + "budg_yy", work_mm.value);
					set_refvalue(ref_4018 + "work_dt", work_mm.value + work_dd.value);
					set_refvalue(ref_4018 + "hsty_no", hsty_no.value);
					set_refvalue(ref_4018 + "multiUpdateData",datagrid1.getUpdateData("delete"));
					
					model.send("mc_budg_4018_d");
					
					hsty_no.disabled("xforms-value-changed");
				}else if(ch_var == 0){
					show_message("처리할 데이타가 없습니다.");
				}
			}
			
			function fun_print(){
				var work_dt_var;
				work_dt_var = work_mm.value + work_dd.value;
				//필수항목체크(검색)
				if(work_dt_var == "" || hsty_no.value == "") {
					show_message("필수 입력 항목이 입력되지 않았습니다.");
					return false;
				}
				
				resetOznode();
				
				// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)
				makeNodeValue("/root/oz_data/ozrName","fcmc/SP_MC_BUDG_4090_P");
				
				// odi 파라미터 설정.
				makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd", getProperty("ss_cmpycd"));
				makeNodeValue("/root/oz_data/odiParam/iv_work_dt", work_dt_var);
				makeNodeValue("/root/oz_data/odiParam/iv_hsty_no", hsty_no.value);
				
				// 레포트뷰어 호출.
				openOzwin("/root/oz_data");		
			}
			
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="1,10;2,12;1,874;1,878;1,893;1,900;1,913;1,917;1,936;1,936;2,30;2,39;2,42;2,49;2,705;2,681;2,680;2,666;1,177;" style="font-family:굴림; ">
		<group id="group_scr" class="gro_sel" style="left:10px; top:50px; width:926px; height:101px; ">
			<caption id="caption9" class="list_cap02" style="left:0px; top:25px; width:462px; height:26px; text-align:center; "/>
			<caption id="caption7" class="list_cap02" style="left:0px; top:0px; width:462px; height:26px; text-align:center; "/>
			<caption id="caption6" class="list_cap02" style="left:0px; top:75px; width:462px; height:26px; text-align:center; "/>
			<caption id="caption4" class="list_cap02" style="left:0px; top:50px; width:462px; height:26px; text-align:center; "/>
			<caption id="caption2" class="list_cap01" style="left:0px; top:0px; width:110px; height:26px; text-align:center; ">부서코드</caption>
			<caption id="caption3" class="list_cap01" style="left:0px; top:25px; width:110px; height:26px; text-align:center; ">요청일자</caption>
			<input id="work_mm" ref="/root/reqData/searchData/mc_budg_4010_m/work_dt" class="req" navindex="2" maxlength="6" caption="요청년월" style="left:113px; top:29px; width:62px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					work_mm_ch();
					]]>
				</script>
			</input>
			<input id="srch_dept_cd" ref="/root/reqData/searchData/mc_budg_4011_l/dept_cd" class="req" navindex="1" inputtype="button" maxlength="6" caption="부서코드" style="left:113px; top:4px; width:64px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					var var_con_date = "";

						if (work_mm.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = work_mm.value.length;
							if(num_ch == 8){
								var_con_date = work_mm.value;
							}else if(num_ch == 6){
								var_con_date = work_mm.value + "01";
							}else if(num_ch == 4){
								var_con_date = work_mm.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "I");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
//					if (open_mc_co_1010()) {
//						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
//						work_mm_ch();
//					}
//					else {
//						//팝업에서 취소 버튼을 누른 경우
//					}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var var_con_date = "";

						if (work_mm.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = work_mm.value.length;
							if(num_ch == 8){
								var_con_date = work_mm.value;
							}else if(num_ch == 6){
								var_con_date = work_mm.value + "01";
							}else if(num_ch == 4){
								var_con_date = work_mm.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (srch_dept_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
							model.setValue("/root/reqData/fwdData/dept_cd", srch_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "I");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								dept_cdnm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								srch_dept_cd.value = "";
								dept_cdnm.value = "";
							}
						}
						else {
							srch_dept_cd.value = "";
							dept_cdnm.value = "";
						}	
//					if (open_mc_co_1010()) {
//						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
//						work_mm_ch();
//					}
//					else {
//						//팝업에서 취소 버튼을 누른 경우
//					}
					]]>
				</script>
			</input>
			<input id="dept_cdnm" ref="/root/tempData/dept_cdnm" editable="false" style="left:185px; top:4px; width:244px; height:18px; "/>
			<caption id="caption1" class="list_cap01" style="left:0px; top:50px; width:110px; height:26px; text-align:center; ">일련번호</caption>
			<caption id="caption5" class="list_cap01" style="left:0px; top:75px; width:110px; height:26px; text-align:center; ">적  요</caption>
			<input id="rmks2" ref="/root/tempData/rmks2" navindex="6" style="left:113px; top:79px; width:314px; height:18px; "/>
			<caption id="caption15" style="left:184px; top:29px; width:15px; height:18px; ">월</caption>
			<select1 id="work_dd" ref="/root/tempData/work_dd" class="req" navindex="3" appearance="minimal" editmode="inputsearch" caption="요청일" style="left:205px; top:29px; width:70px; height:18px; ">
				<choices>
					<itemset nodeset="/root/resData/resform/mc_budg_4010_m/dataSet/CURLIST3/record">
						<label ref="dd"/>
						<value ref="dd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(work_dd, work_dd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(work_dd,"");
						return;
					}
					work_dd_ch();
					]]>
				</script>
			</select1>
			<caption id="caption40" style="left:284px; top:29px; width:15px; height:18px; ">일</caption>
			<input id="incmg_pers" ref="/root/reqData/multiUpDate/mc_budg_4013_i/incmg_pers" class="담당자" navindex="5" inputtype="button" maxlength="6" style="left:304px; top:54px; width:64px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (incmg_pers.value.length == 6) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/emp_no");
							model.setValue("/root/reqData/fwdData/emp_no", incmg_pers.value);
							model.send("hd_com_1002");
							
							if (model.getValue("/root/tempData/record/emp_no") != "") {
								incmg_persnm.value = model.getValue("/root/tempData/record/nm_korn");
							}
							else {
								incmg_pers.value = "";
								incmg_persnm.value = "";
							}
						}		
						else {
							incmg_pers.value = "";
							incmg_persnm.value = "";
						}
					]]>
				</script>
			</input>
			<caption id="caption8" class="list_cap01" style="left:192px; top:50px; width:110px; height:26px; text-align:center; ">담당자</caption>
			<input id="incmg_persnm" ref="/root/tempData/incmg_persnm" editable="false" style="left:371px; top:54px; width:68px; height:18px; "/>
			<datagrid id="datagrid2" nodeset="/root/resData/gridData/mc_budg_4016_l/dataSet/CURLIST/record" caption="행사명^행사코드^예산명^예산코드^년월^요청액^승인액" colsep="^" colwidth="100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:461px; top:0px; width:465px; height:101px; ">
				<col ref="evnt_nm"/>
				<col ref="evnt_cd"/>
				<col ref="budg_nm"/>
				<col ref="budg_cd"/>
				<col ref="budg_yymm"/>
				<col ref="yramt"/>
				<col ref="amt"/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					_oth_clsf = "2";
					datagrid2_click();
					]]>
				</script>
			</datagrid>
			<select1 id="hsty_no" ref="/root/reqData/searchData/mc_budg_4016_l/hsty_no" class="req" navindex="4" appearance="minimal" editmode="inputsearch" caption="일렬번호" style="left:113px; top:54px; width:60px; height:18px; ">
				<choices>
					<itemset nodeset="/root/resData/resform/mc_budg_4015_l/dataSet/CURLIST/record">
						<label ref="hsty_no"/>
						<value ref="hsty_no"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(hsty_no, hsty_no.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(hsty_no,"");
						return;
					}
					hsty_no_ch();
					]]>
				</script>
			</select1>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:161px; width:926px; height:5px; "/>
		<group id="group2" class="gro_sel" style="left:10px; top:175px; width:926px; height:498px; ">
			<caption id="caption37" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption25" class="list_cap01" style="left:109px; top:0px; width:83px; height:26px; text-align:center; ">예산년월</caption>
			<input id="srch_budg_yymm" ref="/root/reqData/searchData/mc_budg_4011_l/budg_yymm" class="req" navindex="7" caption="예산년월" style="left:195px; top:4px; width:74px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					srch_budg_yymm_ch();
					]]>
				</script>
			</input>
			<caption id="caption31" class="list_cap01" style="left:0px; top:0px; width:110px; height:26px; color:#ff0000; text-align:center; ">입 력</caption>
			<input id="srch_budg_cd" ref="/root/reqData/searchData/mc_budg_4011_l/budg_cd" class="req" navindex="8" inputtype="button" caption="예산코드" style="left:363px; top:4px; width:64px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if (open_mc_co_1020_budg_cd()) {
						var medi_cd_ref = datagrid1.colRef("medi_cd");
						if(medi_cd_ch()){
							medi_cd_ch_var = "true";
							show_message("매체코드는 필수 입력사항입니다.");
							datagrid1.colHidden(medi_cd_ref) = false;
						}else{
							medi_cd_ch_var = "";
							datagrid1.colHidden(medi_cd_ref) = true;
						}
					}
					else {
						//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					if (open_mc_co_1020_budg_cd()) {
						var medi_cd_ref = datagrid1.colRef("medi_cd");
						if(medi_cd_ch()){
							show_message("매체코드는 필수 입력사항입니다.");
							datagrid1.colHidden(medi_cd_ref) = false;
						}else{
							datagrid1.colHidden(medi_cd_ref) = true;
						}
					}
					else {
						//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
			</input>
			<caption id="caption11" class="list_cap01" style="left:295px; top:0px; width:65px; height:26px; text-align:center; ">예산코드</caption>
			<input id="budg_cdnm" ref="/root/tempData/budg_cdnm" editable="false" style="left:432px; top:4px; width:135px; height:18px; "/>
			<input id="evnt_cdnm" ref="/root/tempData/evnt_cdnm" editable="false" style="left:738px; top:4px; width:135px; height:18px; "/>
			<caption id="caption13" class="list_cap01" style="left:602px; top:0px; width:65px; height:26px; text-align:center; ">행사코드</caption>
			<input id="srch_evnt_cd" ref="/root/reqData/searchData/mc_budg_4011_l/evnt_cd" navindex="9" inputtype="button" maxlength="10" style="left:669px; top:4px; width:64px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					if (open_mc_co_1020_evnt_cd()) {
					//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					}
					else {
					//팝업에서 취소 버튼을 누른 경우
						}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if (open_mc_co_1020_evnt_cd()) {
					//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					}
					else {
					//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
			</input>
			<button id="source" class="tab16" group="stat" crud="R" style="left:0px; top:25px; width:530px; height:23px; ">
				<caption>SOURCE</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("source1");
					]]>
				</script>
			</button>
			<button id="copy" class="tab16" disabled="true" group="stat" crud="R" style="left:235px; top:25px; width:92px; height:23px; ">
				<caption>COPY</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("copy1");
					]]>
				</script>
			</button>
			<switch id="switch1" style="left:0px; top:48px; width:926px; height:442px; ">
				<case id="copy1" selected="true">
					<datagrid id="datagrid3" nodeset="/root/resData/gridData/mc_budg_4017_l/dataSet/CURLIST/record" caption="select^상 태^사용부서^매 체^적 요^요청금액^요청수량^요청단가^POS^필수매체여부" colsep="^" colwidth="100, 100, 100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:0px; top:0px; width:926px; height:419px; ">
						<col ref="select"/>
						<col ref="amt_s"/>
						<col ref="use_dept_cd" type="input" maxlength="6"/>
						<col editmode="inputsearch" ref="medi_cd" type="combo">
							<choices>
								<itemset nodeset="/root/initData/comboSet/mc_budg_4010_m/dataSet/CURLIST1/record">
									<label ref="cdabrvnm_cd"/>
									<value ref="cd"/>
								</itemset>
							</choices>
						</col>
						<col ref="rmks" type="input"/>
						<col ref="yramt" type="input"/>
						<col ref="qunt" type="input"/>
						<col ref="uprc" type="input"/>
						<col ref="pos"/>
						<col ref="medi_ch"/>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
							_oth_clsf = "3";
							datagrid3_click();
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							if(datagrid3.col == "4"){
								var i = datagrid3.row;
								var ch_colref = datagrid3.colRef("medi_cd");
								
								if(datagrid3.col == ch_colref){
									var ch_var = datagrid3.valueMatrix(i,ch_colref);
									if(grid_combo_data_contains(ch_var,"/root/initData/comboSet/mc_budg_4010_m/dataSet/CURLIST1/record","cd") == -1){
										show_message("정확한 값을 선택해 주세요.");
										datagrid3.valueMatrix(i,ch_colref) = "";
										return;
									}
								}
							}
							datagrid3_changed();
							]]>
						</script>
					</datagrid>
				</case>
				<case id="source1" style="left:0px; top:0px; width:924px; height:457px; ">
					<datagrid id="datagrid1" nodeset="/root/resData/gridData/mc_budg_4012_l/dataSet/CURLIST/record" caption="select^상 태^사용부서^매 체^적 요^요청금액^요청수량^요청단가^승인금액^이력번호^서브번호" colsep="^" colwidth="100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:0px; top:0px; width:926px; height:420px; ">
						<col ref="select"/>
						<col ref="amt_s"/>
						<col ref="use_dept_cd" type="input" maxlength="6"/>
						<col editmode="inputsearch" ref="medi_cd" type="combo">
							<choices>
								<itemset nodeset="/root/initData/comboSet/mc_budg_4010_m/dataSet/CURLIST1/record">
									<label ref="cdabrvnm_cd"/>
									<value ref="cd"/>
								</itemset>
							</choices>
						</col>
						<col ref="rmks" type="input"/>
						<col ref="yramt" type="input"/>
						<col ref="qunt" type="input"/>
						<col ref="uprc" type="input"/>
						<col ref="amt" type="input"/>
						<col ref="hsty_no" type="input"/>
						<col ref="sub_no" type="input"/>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
							_oth_clsf = "1";
							datagrid1_click();
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							if(datagrid1.col == "4"){
								var i = datagrid1.row;
								var ch_colref = datagrid1.colRef("medi_cd");
								
								if(datagrid1.col == ch_colref){
									var ch_var = datagrid1.valueMatrix(i,ch_colref);
									if(grid_combo_data_contains(ch_var,"/root/initData/comboSet/mc_budg_4010_m/dataSet/CURLIST1/record","cd") == -1){
										show_message("정확한 값을 선택해 주세요.");
										datagrid1.valueMatrix(i,ch_colref) = "";
										return;
									}
								}
							}
							datagrid1_changed();
							]]>
						</script>
					</datagrid>
				</case>
			</switch>
		</group>
		<group id="group_tit" class="gro_tit" style="left:0px; top:0px; width:946px; height:39px; ">
			<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		</group>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:734px; width:926px; height:21px; ">
			<button id="btn_update" class="btn02" style="left:56px; top:0px; width:52px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					updata_ch();
					]]>
				</script>
			</button>
			<button id="button15" class="btn02" style="left:276px; top:0px; width:52px; height:21px; ">
				<caption>사용부서</caption>
			</button>
			<button id="btn_reset" class="btn02" style="left:221px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model.reset();
					]]>
				</script>
			</button>
			<button id="btn_close" class="btn02" style="left:451px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					formClose();
					]]>
				</script>
			</button>
			<button id="btn_copy" class="btn02" disabled="true" style="left:165px; top:0px; width:52px; height:21px; ">
				<caption>복사</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					copy_click();
					]]>
				</script>
			</button>
			<button id="btn_delete" class="btn02" style="left:111px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					delete_click();
					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" style="left:56px; top:0px; width:52px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					insert_ch();
					]]>
				</script>
			</button>
			<button id="btn_select" class="btn02" style="left:0px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					select_ch();
					]]>
				</script>
			</button>
			<button id="button13" class="btn03" style="left:331px; top:0px; width:69px; height:21px; ">
				<caption>요청서발행</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					fun_print();
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" style="left:398px; top:0px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					if(_oth_clsf == "2"){			
						grid = datagrid2;
					}
					if(_oth_clsf == "3"){			
						grid = datagrid3;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
					]]>
				</script>
			</button>
		</group>
		<group id="group1" class="gro_sel" style="left:10px; top:699px; width:926px; height:26px; ">
			<caption id="caption26" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption21" class="list_cap01" style="left:230px; top:0px; width:110px; height:26px; text-align:center; ">의뢰누계</caption>
			<input id="hjamt" ref="/root/tempData/hjamt" editable="false" style="left:113px; top:4px; width:112px; height:18px; "/>
			<caption id="caption23" class="list_cap01" style="left:460px; top:0px; width:110px; height:26px; text-align:center; ">집행누계</caption>
			<input id="jhamt" ref="/root/tempData/jhamt" editable="false" style="left:573px; top:4px; width:112px; height:18px; "/>
			<caption id="caption36" class="list_cap01" style="left:0px; top:0px; width:110px; height:26px; text-align:center; ">확정금액</caption>
			<input id="bggnamt" ref="/root/tempData/bggnamt" editable="false" style="left:799px; top:4px; width:112px; height:18px; "/>
			<caption id="caption18" class="list_cap01" style="left:688px; top:0px; width:110px; height:26px; text-align:center; ">추 경 액</caption>
			<input id="eramt" ref="/root/tempData/eramt" editable="false" style="left:343px; top:4px; width:112px; height:18px; "/>
		</group>
		<group id="group3" class="gro_line" style="left:10px; top:685px; width:926px; height:5px; "/>
	</xhtml:body>
</xhtml:html>
