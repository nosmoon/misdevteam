<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>연간손익((MC_BUDG_6110)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session/>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
							<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
							<mc_budg_6130_m_bf>
								<dataSet>
									<CURLIST>
										<record>
											<tms/>
											<rslt_aply_prd_bgn/>
											<rslt_aply_prd_end/>
											<expt_aply_prd_bgn/>
											<expt_aply_prd_end/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_6130_m_bf>
							<mc_budg_6130_m_af>
								<dataSet>
									<CURLIST>
										<record>
											<tms/>
											<rslt_aply_prd_bgn/>
											<rslt_aply_prd_end/>
											<expt_aply_prd_bgn/>
											<expt_aply_prd_end/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_6130_m_af>
							<mc_budg_6210_m>
								<dataSet>
									<CURLIST>
										<record>
											<code/>
											<codename/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_6210_m>
						</comboSet>
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData/>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<yyyy/>
							<tms/>
							<clas_cd1/>
							<clas_cd2/>
							<clas_cd3/>
							<clas_cd4/>
							<last_yyyymm/>
							<yyyy_tab2/>
							<tms_tab2/>
							<mc_budg_6115_l>
								<yyyy/>
							</mc_budg_6115_l>
							<yyyy_bf/>
							<yyyy_af/>
							<tms_bf/>
							<tms_af/>
							<yy/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqform>
							<chk_tms/>
						</reqform>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpDate>
							<yyyy/>
							<fr_to_11/>
							<fr_to_12/>
							<fr_to_21/>
							<fr_to_22/>
							<multiUpdateData1/>
							<multiUpdateData2/>
							<tms/>
							<yyyy_tab2/>
							<tms_tab2/>
							<clsf_cd/>
							<multiUpdateData_tab2/>
							<chk_tms/>
						</multiUpDate>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resform>
							<mc_budg_6111_l>
								<dataSet>
									<CURLIST3>
										<record>
											<fr_to_1/>
											<fr_to_2/>
										</record>
									</CURLIST3>
									<CURLIST2>
										<record>
											<last_yyyymm/>
										</record>
									</CURLIST2>
									<CURLIST1>
										<record>
											<cd1/>
											<cd2/>
										</record>
									</CURLIST1>
								</dataSet>
							</mc_budg_6111_l>
							<clas_cd_nm>
								<dataSet>
									<clas_cd1_nm/>
									<clas_cd2_nm/>
									<clas_cd3_nm/>
									<clas_cd4_nm/>
								</dataSet>
							</clas_cd_nm>
							<rslt_aply_prd_bgn/>
							<rslt_aply_prd_end/>
							<expt_aply_prd_bgn/>
							<expt_aply_prd_end/>
						</resform>
						<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<mc_budg_6112_l>
								<dataSet>
									<CURLIST>
										<record>
											<kind/>
											<clas_cd/>
											<clas_cd_code/>
											<budg_clas_cd_nm/>
											<amt_01/>
											<amt_02/>
											<amt_03/>
											<amt_04/>
											<amt_05/>
											<amt_06/>
											<amt_07/>
											<amt_08/>
											<amt_09/>
											<amt_10/>
											<amt_11/>
											<amt_12/>
											<tot_amt/>
											<pre_tot_amt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_6112_l>
							<mc_budg_6113_l>
								<dataSet>
									<CURLIST>
										<record>
											<kind/>
											<clas_cd/>
											<clas_cd_code/>
											<budg_clas_cd_nm/>
											<amt_01/>
											<amt_02/>
											<amt_03/>
											<amt_04/>
											<amt_05/>
											<amt_06/>
											<amt_07/>
											<amt_08/>
											<amt_09/>
											<amt_10/>
											<amt_11/>
											<amt_12/>
											<tot_amt/>
											<pre_tot_amt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_6113_l>
							<mc_budg_6115_l>
								<dataSet>
									<CURLIST>
										<record>
											<seqnm/>
											<amt_01/>
											<amt_02/>
											<amt_03/>
											<amt_04/>
											<amt_05/>
											<amt_06/>
											<amt_07/>
											<amt_08/>
											<amt_09/>
											<amt_10/>
											<amt_11/>
											<amt_12/>
											<tot_amt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_6115_l>
							<mc_budg_6116_i>
								<dataSet/>
							</mc_budg_6116_i>
							<mc_budg_6132_l>
								<dataSet>
									<CURLIST>
										<record>
											<budg_clas_cd/>
											<budg_clas_cdnm/>
											<bf_sumamt/>
											<af_sumamt/>
											<diff_amt/>
											<bf_amt1/>
											<af_amt1/>
											<bf_amt2/>
											<af_amt2/>
											<bf_amt3/>
											<af_amt3/>
											<bf_amt4/>
											<af_amt4/>
											<bf_amt5/>
											<af_amt5/>
											<bf_amt6/>
											<af_amt6/>
											<bf_amt7/>
											<af_amt7/>
											<bf_amt8/>
											<af_amt8/>
											<bf_amt9/>
											<af_amt9/>
											<bf_amt10/>
											<af_amt10/>
											<bf_amt11/>
											<af_amt11/>
											<bf_amt12/>
											<af_amt12/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_6132_l>
							<mc_budg_6211_l>
								<dataSet>
									<CURLIST>
										<record>
											<budg_clas_cd/>
											<budg_clas_cd_nm/>
											<groupings/>
											<mm_amt_1/>
											<mm_amt_2/>
											<mm_amt_3/>
											<mm_amt_4/>
											<mm_amt_5/>
											<mm_amt_6/>
											<mm_amt_7/>
											<mm_amt_8/>
											<mm_amt_9/>
											<mm_amt_10/>
											<mm_amt_11/>
											<mm_amt_12/>
											<amount_sum/>
											<prvyy_rslt_amt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_6211_l>
							<mc_budg_6212_l>
								<dataSet>
									<CURLIST>
										<record>
											<budg_clas_cd/>
											<budg_clas_cd_nm/>
											<groupings/>
											<mm_amt_1/>
											<mm_amt_2/>
											<mm_amt_3/>
											<mm_amt_4/>
											<mm_amt_5/>
											<mm_amt_6/>
											<mm_amt_7/>
											<mm_amt_8/>
											<mm_amt_9/>
											<mm_amt_10/>
											<mm_amt_11/>
											<mm_amt_12/>
											<amount_sum/>
											<prvyy_rslt_amt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_6212_l>
							<mc_budg_6213_l>
								<dataSet>
									<CURLIST>
										<record>
											<rownm/>
											<mm_amt_1/>
											<mm_amt_2/>
											<mm_amt_3/>
											<mm_amt_4/>
											<mm_amt_5/>
											<mm_amt_6/>
											<mm_amt_7/>
											<mm_amt_8/>
											<mm_amt_9/>
											<mm_amt_10/>
											<mm_amt_11/>
											<mm_amt_12/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_6213_l>
						</gridData>
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
					</resData>
					<temtData>
						<!-- 데이터를 가공할 임시저장소 -->
						<keyData/>
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<fr_to_11/>
						<fr_to_12/>
						<fr_to_21/>
						<fr_to_22/>
						<clas_id/>
						<save_yn/>
						<grid_focus/>
					</temtData>
				</root>
			</instance>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<script type="javascript" src="/js/fcmc_common.js"/>
			<submission id="mc_budg_6111_l" action="/mc/budg6000/6111" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resform/mc_budg_6111_l/dataSet"/>
			<submission id="mc_budg_6113_l" action="/mc/budg6000/6113" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/mc_budg_6113_l/dataSet"/>
			<submission id="mc_budg_6115_l" action="/mc/budg6000/6115" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_6115_l" resultref="/root/resData/gridData/mc_budg_6115_l/dataSet"/>
			<submission id="mc_budg_6112_l" action="/mc/budg6000/6112" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/mc_budg_6112_l/dataSet"/>
			<submission id="mc_budg_6116_i" action="/mc/budg6000/6116" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="mc_budg_6210_m" action="/mc/budg6000/6210" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/initData/comboSet/mc_budg_6210_m/dataSet"/>
			<submission id="mc_budg_6211_l" action="/mc/budg6000/6211" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/mc_budg_6211_l/dataSet"/>
			<submission id="mc_budg_6212_l" action="/mc/budg6000/6212" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/mc_budg_6212_l/dataSet"/>
			<submission id="mc_budg_6213_l" action="/mc/budg6000/6213" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/mc_budg_6213_l/dataSet"/>
			<submission id="mc_budg_6214_i" action="/mc/budg6000/6214" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/resData/MsgData/dataSet"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					init_controls();
					
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[

				]]>
			</script>
			<submission id="mc_budg_6130_m" action="/mc/budg6000/6130" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData"/>
			<submission id="mc_budg_6132_l" action="/mc/budg6000/6132" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/mc_budg_6132_l/dataSet"/>
		</model>
		<script type="javascript">
			<![CDATA[
				var	_oth_clsf = "1";
				// 초기화 함수 //
				function init_controls(){
					set_default(
						datagrid1,			// 수입
						datagrid2,			// 비용
						datagrid3,			// 전년실적
						datagrid4,			
						datagrid5,			
						datagrid6,
						datagrid7,			
						srch_yyyy,		// 예산년도
						srch_tms,			// 예산차수
						last_yyyymm,		// 최종마감월
						fr_to_11,			// 실적월1
						fr_to_12,			// 실적월2
						fr_to_21,			// 예산월1
						fr_to_22,			// 예산월2
						srch_clas_cd1,		// 분류기준(장) 코드
						srch_clas_cd2,		// 분류기준(관) 코드
						srch_clas_cd3,		// 분류기준(항) 코드
						srch_clas_cd4,		// 분류기준(목) 코드
						srch_clas_cd1_nm,	// 분류기준(장) 명
						srch_clas_cd2_nm,	// 분류기준(관) 명
						srch_clas_cd3_nm,	// 분류기준(항) 명
						srch_clas_cd4_nm,	// 분류기준(목) 명
						srch_yyyy_bf,		// 작전보고차이탭 - 대상년도(직전)
						srch_yyyy_af,		// 작전보고차이탭 - 대상회차(직전)
						srch_tms_bf,		// 작전보고차이탭 - 비교년도
						srch_tms_af		// 작전보고차이탭 - 비교회차
					);
					set_format(
						"number4",
						datagrid1,"5,6,7,8,9,10,11,12,13,14,15,16,17,18",
						datagrid2,"5,6,7,8,9,10,11,12,13,14,15,16,17,18",
						datagrid3,"1,2,3,4,5,6,7,8,9,10,11,12,13",
						datagrid4,"4,5,6,7,8,9,10,11,12,13,14,15,16,17,18",
						datagrid5,"4,5,6,7,8,9,10,11,12,13,14,15,16,17,18",
						datagrid6,"1,2,3,4,5,6,7,8,9,10,11,12,13",
						datagrid7,"1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27",
						amt11,
						amt12,
						amt21,
						amt22,
						amt31,
						amt32,
						amt41,
						amt42,
						amt51,
						amt52,
						amt61,
						amt62,
						amt71,
						amt72,
						amt81,
						amt82,
						amt91,
						amt92,
						amt101,
						amt102,
						amt111,
						amt112,
						amt121,
						amt122,
						tot_amt
					);
					set_format(
						"code",
						datagrid1,"1,2",
						datagrid2,"1,2"
					);
					set_format(
						"month_1",
						rslt_aply_prd_bgn,
						rslt_aply_prd_end,
						expt_aply_prd_bgn,
						expt_aply_prd_end
					);					
					set_format(
						"date_320",
						srch_yyyy_bf,
						srch_yyyy_af
					);
				}
				
				// 조회탭 예산차수 콤보데이터 불러오기 //
				function mc_budg_6111_l_cb(){
					model.send("mc_budg_6111_l");
				}
				
				// 수정탭 콤보데이터 불러오기 //
				function mc_budg_6210_m_cb(){
					model.send("mc_budg_6210_m");
					makeComboGubun("","/root/initData/comboSet/mc_budg_6210_m/dataSet/CURLIST","record","codename", "code");
				}
				
				// 콤보에러 //
				function srch_tms_err(){
					show_message("예산년도를 입력하세요.");
					model.setFocus("srch_yyyy");
					return;
				}
				// 분류기준 팝업 //
				function open_mc_co_1020() {
					var popid = "mc_co_1020";
					var rcvs_flag = false;
					
					model.removeNodeset("/root/resData/rcvData");
					set_refvalue("/root/temtData/clas_id",model.getFocus());
	
					if (event != null && event.name == "xforms-value-changed") {
						//값이 변경되면 기존에 조회된 자료를 모두 제거한다.
						reset_popup_rcvs_data(popid);
					}
					
					set_popup_send_data(popid,"mode","S");
					set_popup_send_data(popid,"readonly","0");
					set_popup_send_data(popid,"datafilter","");	
					set_popup_send_data(popid,"searchid","11");
					
					switch (model.getFocus()) {
						case "srch_clas_cd1" : 
							set_popup_send_data(popid,"title","분류코드(장) 조회");
							set_popup_send_data(popid,"clas_clsf_cd","1");
							set_popup_send_data(popid,"cd",srch_clas_cd1.value);
							break;
						case "srch_clas_cd2" : 
							set_popup_send_data(popid,"title","분류코드(관) 조회");
							set_popup_send_data(popid,"clas_clsf_cd","2");
							set_popup_send_data(popid,"clas_cd",srch_clas_cd1.value);
							set_popup_send_data(popid,"cd",srch_clas_cd2.value);
							break;
						case "srch_clas_cd3" : 
							set_popup_send_data(popid,"title","분류코드(항) 조회");
							set_popup_send_data(popid,"clas_clsf_cd","3");
							set_popup_send_data(popid,"clas_cd",srch_clas_cd1.value+srch_clas_cd2.value);
							set_popup_send_data(popid,"cd",srch_clas_cd3.value);
							break;
						case "srch_clas_cd4" : 
							set_popup_send_data(popid,"title","분류코드(목) 조회");
							set_popup_send_data(popid,"clas_clsf_cd","4");
							set_popup_send_data(popid,"clas_cd",srch_clas_cd1.value+srch_clas_cd2.value+srch_clas_cd3.value);
							set_popup_send_data(popid,"cd",srch_clas_cd4.value);
							break;
					}
					
					rcvs_flag = call_mc_co_1020();
					
					if (rcvs_flag) {
						//정상처리
					}else{
						//취소버튼을 누른 경우 조회 조회를 위한 값과 조회된 값이 틀린 경우 기존 값을 모두 제거한다.
					}
					
					//value-changed 와 buttonclick이 동시 발생했을 경우
					//이하 코드는 두번씩 실행되므로 무거운 코드는 넣지 않도록 하자
					
					//만약  value-changed 이벤트이면서 결과값이 없는 경우면 현재 값과 현재값에 종속되는 모든 값을 삭제한다.
					if (event != null && event.name == "xforms-value-changed" && !rcvs_flag) {
						//부서가 변경되면 고유행사코드는 삭제한다.
						//단 부서의 앞 2자리가 같은 경우 제외
						//입력값에 대한 oldValue와 currentText는 input에만 있으므로 조회하는 컨트롤이 input 컨트롤이라고 가정한다.
						//현재값이 공백이어도 변경 처리
						set_refvalue(srch_clas_cd1,"");
						set_refvalue(srch_clas_cd2,"");
						set_refvalue(srch_clas_cd3,"");
						set_refvalue(srch_clas_cd4,"");
						set_refvalue(srch_clas_cd1_nm,"");
						set_refvalue(srch_clas_cd2_nm,"");
						set_refvalue(srch_clas_cd3_nm,"");
						set_refvalue(srch_clas_cd4_nm,"");
					}
	
					//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
					//다시 조회 하기 쉽도록 하고
					if (get_popup_rcvs_data(popid,"cd") != "") {
						switch (get_refvalue("/root/temtData/clas_id")) {
							case "srch_clas_cd1" : 
								set_refvalue(srch_clas_cd1_nm,get_popup_rcvs_data(popid,"cdnm"));
								set_refvalue(srch_clas_cd1,get_popup_rcvs_data(popid,"cd").substr(0,2));
								break;
							case "srch_clas_cd2" : 
								set_refvalue(srch_clas_cd2_nm,get_popup_rcvs_data(popid,"cdnm"));
								set_refvalue(srch_clas_cd2,get_popup_rcvs_data(popid,"cd").substr(2,2));
								break;
							case "srch_clas_cd3" : 
								set_refvalue(srch_clas_cd3_nm,get_popup_rcvs_data(popid,"cdnm"));
								set_refvalue(srch_clas_cd3,get_popup_rcvs_data(popid,"cd").substr(4,2));
								break;
							case "srch_clas_cd4" : 
								set_refvalue(srch_clas_cd4_nm,get_popup_rcvs_data(popid,"cdnm"));
								set_refvalue(srch_clas_cd4,get_popup_rcvs_data(popid,"cd").substr(6,8));
								break;
						}
					}else{

					}
					//그외의 값은 지워지도록 한다.
					
					return rcvs_flag;
				}
				
				// 조회탭 조회 //
				function search(){
					var subid1 = "mc_budg_6112_l";
					var subid2 = "mc_budg_6113_l";
					var subid3 = "mc_budg_6115_l";
					var subref1 = eval(subid1).attribute("ref");
					var subref2 = eval(subid2).attribute("ref");
					var subref3 = eval(subid3).attribute("ref");
					var subresultref1 = eval(subid1).attribute("resultref");
					var subresultref2 = eval(subid2).attribute("resultref");
					var subresultref3 = eval(subid3).attribute("resultref");
					var subid1_cur1 = "CURLIST";
					var subid2_cur2 = "CURLIST";
					var subid3_cur3 = "CURLIST";
					
					// 필수값 체크 //
					if (!commReqCheck(group_scr)) {
						return false;
					}

					set_refvalue("/root/reqData/searchData/mc_budg_6115_l/yyyy",Number(srch_yyyy.value) - 1);
					
					model.send(subid1);
					model.send(subid2);
					model.send(subid3);
					
					totalcnt = get_refvalue(subresultref1 + "/" + subid1_cur1 + "/totalcnt");
					totalcnt2 = get_refvalue(subresultref2 + "/" + subid2_cur2 + "/totalcnt");
					totalcnt3 = get_refvalue(subresultref3 + "/" + subid3_cur3 + "/totalcnt");
					
					if(get_refvalue("/root/temtData/save_yn") != "Y"){
						for (i=1; i<datagrid1.rows-2; i++){
							datagrid1.rowStatus(i) = "1";
						}
						for (i=1; i<datagrid2.rows-2; i++){
							datagrid2.rowStatus(i) = "1";
						}
					}

					datagrid1.refresh();
					datagrid2.refresh();
					datagrid3.refresh();
					
					if(totalcnt == 0 && totalcnt2 == 0){
						show_message("검색결과가 없습니다.");
						commGroupInit(group1);
						datagrid_data_clear(datagrid1);
						datagrid_data_clear(datagrid2);
						datagrid_data_clear(datagrid3);
						return;
					}
					
					amt_cal();
				}
				
				// 조회탭 저장 //
				function send_mc_budg_6116_i(){
					if(datagrid1.rows < 1 && datagrid2.rows < 1){
						show_message("저장할 항목이 없습니다.");
						return;
					}
					
					if(get_refvalue("/root/temtData/save_yn") == "Y"){
						show_message("이미 저장하였습니다.");
						return;
					}
					
					if(show_message("저장하시겠습니까?", "연간손익 저장", 4)  == 7){	
						return;
					}
					
					var fr_to_1_var = get_refvalue("/root/resData/resform/mc_budg_6111_l/dataSet/CURLIST3/record/fr_to_1");
					var fr_to_2_var = get_refvalue("/root/resData/resform/mc_budg_6111_l/dataSet/CURLIST3/record/fr_to_2");
							
					set_refvalue("/root/reqData/multiUpDate/yyyy",srch_yyyy.value);
					set_refvalue("/root/reqData/multiUpDate/fr_to_11",fr_to_1_var.substring(0,6));
					set_refvalue("/root/reqData/multiUpDate/fr_to_12",fr_to_1_var.substring(7,13));
					set_refvalue("/root/reqData/multiUpDate/fr_to_21",fr_to_2_var.substring(0,6));
					set_refvalue("/root/reqData/multiUpDate/fr_to_22",fr_to_2_var.substring(7,13));
					set_refvalue("/root/reqData/multiUpDate/tms",srch_tms.value);
					set_refvalue("/root/reqData/multiUpDate/multiUpdateData1", datagrid1.getUpdateData());
					set_refvalue("/root/reqData/multiUpDate/multiUpdateData2", datagrid2.getUpdateData());

					model.send("mc_budg_6116_i");
					
					if(submit_completed()){
						show_message("저장되었습니다.");
						set_refvalue("/root/temtData/save_yn","Y");
					}
					change_status();
				}
				
				// 수정탭 조회 //
				function search_tab2(){
					var subid1 = "mc_budg_6211_l";
					var subid2 = "mc_budg_6212_l";
					var subid3 = "mc_budg_6213_l";
					var subref1 = eval(subid1).attribute("ref");
					var subref2 = eval(subid2).attribute("ref");
					var subref3 = eval(subid3).attribute("ref");
					var subresultref1 = eval(subid1).attribute("resultref");
					var subresultref2 = eval(subid2).attribute("resultref");
					var subresultref3 = eval(subid3).attribute("resultref");
					var subid1_cur1 = "CURLIST";
					var subid2_cur2 = "CURLIST";
					var subid3_cur3 = "CURLIST";
					
					// 필수값 체크 //
					if (!commReqCheck(group3)) {
						return false;
					}
					
					model.send(subid1);
					model.send(subid2);
					model.send(subid3);
					
					totalcnt = get_refvalue(subresultref1 + "/" + subid1_cur1 + "/totalcnt");
					totalcnt2 = get_refvalue(subresultref2 + "/" + subid2_cur2 + "/totalcnt");
					totalcnt3 = get_refvalue(subresultref3 + "/" + subid3_cur3 + "/totalcnt");
					
					datagrid1.refresh();
					datagrid2.refresh();
					datagrid3.refresh();
					
					var budg_clas_cd_var = "";
					for(i = 1 ; i < datagrid4.rows ; i++){
						budg_clas_cd_var = datagrid4.valueMatrix(i,2);
						if(budg_clas_cd_var == ""){
							datagrid4.isReadOnly(i,1,i,17) = true;
							datagrid4.rowstyle(i, "data", "background-color") = "#EAEAEA";
						}
					}
					
					for(i = 1 ; i < datagrid5.rows ; i++){
						budg_clas_cd_var = datagrid5.valueMatrix(i,2);
						switch(budg_clas_cd_var){
							case "20100000": case "20200000": case "20300000": case "99999999": case "":
								datagrid5.isReadOnly(i,1,i,17) = true;
								datagrid5.rowstyle(i, "data", "background-color") = "#EAEAEA";
								break;
						}
					}
					
					if(totalcnt == 0 && totalcnt2 == 0){
						show_message("검색결과가 없습니다.");
						datagrid_data_clear(datagrid4);
						datagrid_data_clear(datagrid5);
						datagrid_data_clear(datagrid6);
						return;
					}
				}
				
				// 수정탭 저장 //
				function send_mc_budg_6214_i(){
					var cnt = 0;
					var rows_var = datagrid4.rows;
					var subid = "";
					
					if(chk_tms.value == "1"){
						subid = "mc_budg_6116_i";
					}else{
						subid = "mc_budg_6214_i";
					}
					
					for(i = 1 ; i < 3 ; i ++){
						for(i = 1 ; i < rows_var ; i ++){
							if(datagrid4.rowStatus(i) == "2"){;
								cnt = cnt + 1;
							}
							if(datagrid5.rowStatus(i) == "2"){;
								cnt = cnt + 1;
							}
						}
						rows_var = datagrid5.rows;
					}
					
					if(cnt == 0){
						show_message("저장할 항목이 없습니다.");
						return;
					}
					
					if(show_message("수정하시겠습니까?", "저장", 4)  == 7){	
						return;
					}
					
					set_refvalue("/root/reqData/multiUpDate/yyyy_tab2", srch_yyyy_tab2.value);
					set_refvalue("/root/reqData/multiUpDate/tms_tab2", srch_tms_tab2.value);
					
					set_refvalue("/root/reqData/multiUpDate/clsf_cd","1");
					set_refvalue("/root/reqData/multiUpDate/multiUpdateData_tab2", datagrid4.getUpdateData());
					model.send(subid);
					
					set_refvalue("/root/reqData/multiUpDate/clsf_cd","2");
					set_refvalue("/root/reqData/multiUpDate/multiUpdateData_tab2", datagrid5.getUpdateData());
					model.send(subid);
					
					if(submit_completed()){
						show_message("저장되었습니다.");
					}
					search_tab2();
				}
				
				// status 설정 //
				function change_status(){
					for (i=1; i<datagrid4.rows; i++){
						datagrid1.rowStatus(i) = "0";
					}
					for (i=1; i<datagrid5.rows; i++){
						datagrid2.rowStatus(i) = "0";
					}
				}
				
				// 작전보고차이탭 콤보불러오기 //
				function send_mc_budg_6130_m(yy){
					set_refvalue("/root/reqData/searchData/yy",yy);
					model.send("mc_budg_6130_m");
				}
				
				// 작전보고차이탭 조회 //
				function search_tab3(yy){
					// 필수값 체크 //
					if (!commReqCheck(group5)) {
						return false;
					}
					
					model.send("mc_budg_6132_l");
					
					if(datagrid7.rows == 1){
						show_message("검색결과가 없습니다.");
					}
				}
				
				// 세전이익 계산 //
				function amt_cal(){
					// 금액
					var sum_1 = Number(datagrid1.rows-2);
					var amt01_1 = Number(get_refvalue("/root/resData/gridData/mc_budg_6112_l/dataSet/CURLIST/record["+sum_1+"]/amt_01"));
					var amt02_1 = Number(get_refvalue("/root/resData/gridData/mc_budg_6112_l/dataSet/CURLIST/record["+sum_1+"]/amt_02"));
					var amt03_1 = Number(get_refvalue("/root/resData/gridData/mc_budg_6112_l/dataSet/CURLIST/record["+sum_1+"]/amt_03"));
					var amt04_1 = Number(get_refvalue("/root/resData/gridData/mc_budg_6112_l/dataSet/CURLIST/record["+sum_1+"]/amt_04"));
					var amt05_1 = Number(get_refvalue("/root/resData/gridData/mc_budg_6112_l/dataSet/CURLIST/record["+sum_1+"]/amt_05"));
					var amt06_1 = Number(get_refvalue("/root/resData/gridData/mc_budg_6112_l/dataSet/CURLIST/record["+sum_1+"]/amt_06"));
					var amt07_1 = Number(get_refvalue("/root/resData/gridData/mc_budg_6112_l/dataSet/CURLIST/record["+sum_1+"]/amt_07"));
					var amt08_1 = Number(get_refvalue("/root/resData/gridData/mc_budg_6112_l/dataSet/CURLIST/record["+sum_1+"]/amt_08"));
					var amt09_1 = Number(get_refvalue("/root/resData/gridData/mc_budg_6112_l/dataSet/CURLIST/record["+sum_1+"]/amt_09"));
					var amt10_1 = Number(get_refvalue("/root/resData/gridData/mc_budg_6112_l/dataSet/CURLIST/record["+sum_1+"]/amt_10"));
					var amt11_1 = Number(get_refvalue("/root/resData/gridData/mc_budg_6112_l/dataSet/CURLIST/record["+sum_1+"]/amt_11"));
					var amt12_1 = Number(get_refvalue("/root/resData/gridData/mc_budg_6112_l/dataSet/CURLIST/record["+sum_1+"]/amt_12"));
					var tot_amt_1 = Number(get_refvalue("/root/resData/gridData/mc_budg_6112_l/dataSet/CURLIST/record["+sum_1+"]/tot_amt"));
					
					var sum_2 = Number(datagrid2.rows-2);
					var amt01_2 = Number(get_refvalue("/root/resData/gridData/mc_budg_6113_l/dataSet/CURLIST/record["+sum_2+"]/amt_01"));
					var amt02_2 = Number(get_refvalue("/root/resData/gridData/mc_budg_6113_l/dataSet/CURLIST/record["+sum_2+"]/amt_02"));
					var amt03_2 = Number(get_refvalue("/root/resData/gridData/mc_budg_6113_l/dataSet/CURLIST/record["+sum_2+"]/amt_03"));
					var amt04_2 = Number(get_refvalue("/root/resData/gridData/mc_budg_6113_l/dataSet/CURLIST/record["+sum_2+"]/amt_04"));
					var amt05_2 = Number(get_refvalue("/root/resData/gridData/mc_budg_6113_l/dataSet/CURLIST/record["+sum_2+"]/amt_05"));
					var amt06_2 = Number(get_refvalue("/root/resData/gridData/mc_budg_6113_l/dataSet/CURLIST/record["+sum_2+"]/amt_06"));
					var amt07_2 = Number(get_refvalue("/root/resData/gridData/mc_budg_6113_l/dataSet/CURLIST/record["+sum_2+"]/amt_07"));
					var amt08_2 = Number(get_refvalue("/root/resData/gridData/mc_budg_6113_l/dataSet/CURLIST/record["+sum_2+"]/amt_08"));
					var amt09_2 = Number(get_refvalue("/root/resData/gridData/mc_budg_6113_l/dataSet/CURLIST/record["+sum_2+"]/amt_09"));
					var amt10_2 = Number(get_refvalue("/root/resData/gridData/mc_budg_6113_l/dataSet/CURLIST/record["+sum_2+"]/amt_10"));
					var amt11_2 = Number(get_refvalue("/root/resData/gridData/mc_budg_6113_l/dataSet/CURLIST/record["+sum_2+"]/amt_11"));
					var amt12_2 = Number(get_refvalue("/root/resData/gridData/mc_budg_6113_l/dataSet/CURLIST/record["+sum_2+"]/amt_12"));
					var tot_amt_2 = Number(get_refvalue("/root/resData/gridData/mc_budg_6113_l/dataSet/CURLIST/record["+sum_2+"]/tot_amt"));
					
					amt11.value = amt01_1 - amt01_2;
					amt21.value = amt02_1 - amt02_2;
					amt31.value = amt03_1 - amt03_2;
					amt41.value = amt04_1 - amt04_2;
					amt51.value = amt05_1 - amt05_2;
					amt61.value = amt06_1 - amt06_2;
					amt71.value = amt07_1 - amt07_2;
					amt81.value = amt08_1 - amt08_2;
					amt91.value = amt09_1 - amt09_2;
					amt101.value = amt10_1 - amt10_2;
					amt111.value = amt11_1 - amt11_2;
					amt121.value = amt12_1 - amt12_2;
					tot_amt.value = tot_amt_1 - tot_amt_2;
					
					// 누계
					amt12.value = amt11.value;
					amt22.value = Number(amt12.value)+Number(amt21.value);
					amt32.value = Number(amt22.value)+Number(amt31.value);
					amt42.value = Number(amt32.value)+Number(amt41.value);
					amt52.value = Number(amt42.value)+Number(amt51.value);
					amt62.value = Number(amt52.value)+Number(amt61.value);
					amt72.value = Number(amt62.value)+Number(amt71.value);
					amt82.value = Number(amt72.value)+Number(amt81.value);
					amt92.value = Number(amt82.value)+Number(amt91.value);
					amt102.value = Number(amt92.value)+Number(amt101.value);
					amt112.value = Number(amt102.value)+Number(amt111.value);
					amt122.value = Number(amt112.value)+Number(amt121.value);
				}
				
				// 분류별 예산조정 //
				function open_mc_budg_6010(){
					var kind_var = "";
					var clas_cd_code_var = "";
					var srch_mm = "";
					
					if(switch1.selectedIndex != 0){
						model.property("property_srch_budg_clas_frcd") = "";
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("MC_BUDG_6010");
						return;
					}
					
					if(get_refvalue("/root/temtData/grid_focus") == "grid1"){
						kind_var = string_lpad(datagrid1.valueMatrix(datagrid1.row,1),2,"0");
						clas_cd_code_var = datagrid1.valueMatrix(datagrid1.row,3);
						if(datagrid1.col > 4 && datagrid1.col< 17){
							srch_mm = string_lpad(String(datagrid1.col - 4),2,"0");
						}else{
							srch_mm = "";
						}
					}else if(get_refvalue("/root/temtData/grid_focus") == "grid2"){
						kind_var = string_lpad(datagrid2.valueMatrix(datagrid2.row,1),2,"0");
						clas_cd_code_var = datagrid2.valueMatrix(datagrid2.row,3);
						if(datagrid2.col > 4 && datagrid2.col< 17){
							srch_mm = string_lpad(String(datagrid2.col - 4),2,"0");
						}else{
							srch_mm = "";
						}
					}
					
					model.property("property_srch_yyyy") = srch_yyyy.value;
					model.property("property_srch_mm") = srch_mm;
					model.property("property_srch_tms") = srch_tms.value;
					model.property("property_level") = kind_var;
					model.property("property_srch_budg_clas_frcd") = clas_cd_code_var;
					model.property("property_srch_budg_clas_tocd") = clas_cd_code_var;
					
					viewer("mainFrame").window.javaScript.onLoadExMDIPage("MC_BUDG_6010");
				}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="1,10;2,10;1,935;2,30;2,39;2,40;2,753;1,16;" style="font-family:굴림; ">
		<group id="group_tit" class="gro_tit" style="left:0px; top:0px; width:946px; height:39px; ">
			<img id="img1" src="./images/tit_icon.gif" style="left:10px; top:11px; width:22px; height:14px; background-stretch:stretch; "/>
			<img id="img2" src="./images/ta_img_01.gif" style="left:878px; top:10px; width:15px; height:15px; background-stretch:stretch; "/>
			<img id="img3" src="./images/ta_img_02.gif" style="left:898px; top:10px; width:15px; height:15px; background-stretch:stretch; "/>
			<img id="img4" src="./images/ta_img_03.gif" style="left:918px; top:10px; width:15px; height:15px; background-stretch:stretch; "/>
		</group>
		<button id="btn_select" class="btn02" crud="R" style="left:10px; top:732px; width:52px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if(switch1.selectedIndex == 0){
						search();
					}else if(switch1.selectedIndex == 1){
						search_tab2();
					}else if(switch1.selectedIndex == 2){
						search_tab3();
					}
				]]>
			</script>
		</button>
		<button id="btn_insert" class="btn02" style="left:65px; top:732px; width:52px; height:21px; ">
			<caption>저장</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if(switch1.selectedIndex == 0){
						send_mc_budg_6116_i();
					}else if(switch1.selectedIndex == 1){
						send_mc_budg_6214_i();
					}
				]]>
			</script>
		</button>
		<button id="button2" class="btn05" style="left:120px; top:732px; width:113px; height:21px; ">
			<caption>분류별 예산조정</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					open_mc_budg_6010();
				]]>
			</script>
		</button>
		<button id="btn_help" class="btn02" style="left:235px; top:732px; width:52px; height:21px; ">
			<caption>엑셀</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					if(_oth_clsf == "2"){			
						grid = datagrid2;
					}
					if(_oth_clsf == "3"){			
						grid = datagrid3;
					}
					if(_oth_clsf == "4"){			
						grid = datagrid4;
					}
					if(_oth_clsf == "5"){			
						grid = datagrid5;
					}
					if(_oth_clsf == "6"){			
						grid = datagrid6;
					}
					if(_oth_clsf == "7"){			
						grid = datagrid7;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
				]]>
			</script>
		</button>
		<button id="btnClose" class="btn02" style="left:290px; top:732px; width:52px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					formClose();
				]]>
			</script>
		</button>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<switch id="switch1" style="left:10px; top:75px; width:925px; height:655px; ">
			<case id="case1" selected="true">
				<datagrid id="datagrid2" nodeset="/root/resData/gridData/mc_budg_6113_l/dataSet/CURLIST/record" caption="kind^구분^분류코드^분류명^1월^2월^3월^4월^5월^6월^7월^8월^9월^10월^11월^12월^합계^전년 실적" colsep="^" colwidth="100, 100, 100, 100, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 100, 100" extendlastcol="scroll" frozencols="4" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:0px; top:245px; width:920px; height:150px; font-weight:bold; ">
					<col ref="kind" visibility="hidden"/>
					<col ref="clas_cd" visibility="hidden"/>
					<col ref="clas_cd_code" visibility="hidden"/>
					<col ref="budg_clas_cd_nm"/>
					<col ref="amt_01"/>
					<col ref="amt_02"/>
					<col ref="amt_03"/>
					<col ref="amt_04"/>
					<col ref="amt_05"/>
					<col ref="amt_06"/>
					<col ref="amt_07"/>
					<col ref="amt_08"/>
					<col ref="amt_09"/>
					<col ref="amt_10"/>
					<col ref="amt_11"/>
					<col ref="amt_12"/>
					<col ref="tot_amt"/>
					<col ref="pre_tot_amt"/>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							_oth_clsf = "2";
							set_refvalue("/root/temtData/grid_focus","grid2");				
						]]>
					</script>
				</datagrid>
				<datagrid id="datagrid1" nodeset="/root/resData/gridData/mc_budg_6112_l/dataSet/CURLIST/record" caption="kind^구분^분류코드^분류명^1월^2월^3월^4월^5월^6월^7월^8월^9월^10월^11월^12월^합계^전년 실적" colsep="^" colwidth="100, 100, 100, 100, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 100, 100" extendlastcol="scroll" frozencols="4" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:0px; top:90px; width:920px; height:150px; font-weight:bold; ">
					<col ref="kind" visibility="hidden"/>
					<col ref="clas_cd" visibility="hidden"/>
					<col ref="clas_cd_code" visibility="hidden"/>
					<col ref="budg_clas_cd_nm"/>
					<col ref="amt_01"/>
					<col ref="amt_02"/>
					<col ref="amt_03"/>
					<col ref="amt_04"/>
					<col ref="amt_05"/>
					<col ref="amt_06"/>
					<col ref="amt_07"/>
					<col ref="amt_08"/>
					<col ref="amt_09"/>
					<col ref="amt_10"/>
					<col ref="amt_11"/>
					<col ref="amt_12"/>
					<col ref="tot_amt"/>
					<col ref="pre_tot_amt"/>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							_oth_clsf = "1";
							set_refvalue("/root/temtData/grid_focus","grid1");
						]]>
					</script>
				</datagrid>
				<datagrid id="datagrid3" nodeset="/root/resData/gridData/mc_budg_6115_l/dataSet/CURLIST/record" caption="구     분^1월^2월^3월^4월^5월^6월^7월^8월^9월^10월^11월^12월^합계" colsep="^" colwidth="100, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60" extendlastcol="scroll" fixedcols="1" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:510px; width:917px; height:142px; font-weight:bold; ">
					<col ref="seqnm"/>
					<col ref="amt_01"/>
					<col ref="amt_02"/>
					<col ref="amt_03"/>
					<col ref="amt_04"/>
					<col ref="amt_05"/>
					<col ref="amt_06"/>
					<col ref="amt_07"/>
					<col ref="amt_08"/>
					<col ref="amt_09"/>
					<col ref="amt_10"/>
					<col ref="amt_11"/>
					<col ref="amt_12"/>
					<col ref="tot_amt"/>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
						_oth_clsf = "3";
						]]>
					</script>
				</datagrid>
				<group id="group1" style="left:1px; top:420px; width:918px; height:65px; font-weight:bold; ">
					<caption id="caption7" style="left:0px; top:0px; width:100px; height:21px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; ">구     분</caption>
					<caption id="caption10" style="left:0px; top:20px; width:100px; height:22px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; ">금     액</caption>
					<caption id="caption12" style="left:0px; top:41px; width:100px; height:21px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; ">누     계</caption>
					<caption id="caption13" style="left:99px; top:0px; width:61px; height:21px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; ">1월</caption>
					<caption id="caption14" style="left:159px; top:0px; width:61px; height:21px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; ">2월</caption>
					<caption id="caption15" style="left:219px; top:0px; width:61px; height:21px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; ">3월</caption>
					<caption id="caption16" style="left:279px; top:0px; width:61px; height:21px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; ">4월</caption>
					<caption id="caption19" style="left:339px; top:0px; width:61px; height:21px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; ">5월</caption>
					<caption id="caption23" style="left:399px; top:0px; width:61px; height:21px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; ">6월</caption>
					<caption id="caption24" style="left:759px; top:0px; width:61px; height:21px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; ">12월</caption>
					<caption id="caption29" style="left:459px; top:0px; width:61px; height:21px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; ">7월</caption>
					<caption id="caption35" style="left:519px; top:0px; width:61px; height:21px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; ">8월</caption>
					<caption id="caption36" style="left:579px; top:0px; width:61px; height:21px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; ">9월</caption>
					<caption id="caption38" style="left:639px; top:0px; width:61px; height:21px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; ">10월</caption>
					<caption id="caption39" style="left:699px; top:0px; width:61px; height:21px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; ">11월</caption>
					<caption id="caption40" style="left:819px; top:0px; width:96px; height:21px; text-align:center; background-color:#EAEAEA; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt11" style="left:99px; top:20px; width:61px; height:22px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt12" style="left:99px; top:41px; width:61px; height:21px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt21" style="left:159px; top:20px; width:61px; height:22px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt22" style="left:159px; top:41px; width:61px; height:21px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt41" style="left:279px; top:20px; width:61px; height:22px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt42" style="left:279px; top:41px; width:61px; height:21px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt31" style="left:219px; top:20px; width:61px; height:22px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt32" style="left:219px; top:41px; width:61px; height:21px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt61" style="left:399px; top:20px; width:61px; height:22px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt62" style="left:399px; top:41px; width:61px; height:21px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt51" style="left:339px; top:20px; width:61px; height:22px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt52" style="left:339px; top:41px; width:61px; height:21px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt121" style="left:759px; top:20px; width:61px; height:22px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt111" style="left:699px; top:20px; width:61px; height:22px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt122" style="left:759px; top:41px; width:61px; height:21px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt101" style="left:639px; top:20px; width:61px; height:22px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt112" style="left:699px; top:41px; width:61px; height:21px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt91" style="left:579px; top:20px; width:61px; height:22px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt102" style="left:639px; top:41px; width:61px; height:21px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt81" style="left:519px; top:20px; width:61px; height:22px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt92" style="left:579px; top:41px; width:61px; height:21px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt82" style="left:519px; top:41px; width:61px; height:21px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt72" style="left:459px; top:41px; width:61px; height:21px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="caption53" style="left:819px; top:20px; width:96px; height:22px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; ">세후이익</caption>
					<caption id="tot_amt" style="left:819px; top:41px; width:96px; height:21px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
					<caption id="amt71" style="left:459px; top:20px; width:61px; height:22px; text-align:center; background-color:transparent; border-color:#D4D0C8; border-style:solid; "/>
				</group>
				<caption id="caption37" style="left:10px; top:489px; width:79px; height:15px; font-weight:bold; ">※ 전년 실적</caption>
				<caption id="caption6" style="left:10px; top:400px; width:55px; height:15px; font-weight:bold; ">세전이익</caption>
				<group id="group_scr" class="gro_sel" style="left:0px; top:10px; width:919px; height:62px; font-weight:bold; ">
					<caption id="caption8" class="list_cap01" style="left:5px; top:1px; width:120px; height:25px; text-align:center; ">예산년도</caption>
					<caption id="caption9" class="list_cap02" style="left:124px; top:1px; width:790px; height:25px; text-align:center; "/>
					<caption id="caption17" class="list_cap01" style="left:240px; top:1px; width:120px; height:25px; text-align:center; ">예산차수</caption>
					<caption id="caption18" class="list_cap02" style="left:359px; top:1px; width:104px; height:25px; text-align:center; "/>
					<input id="srch_yyyy" ref="/root/reqData/searchData/yyyy" class="req" navindex="1" maxlength="4" format="9999" caption="예산년도" style="left:131px; top:4px; width:103px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
						if(get_refvalue("/root/reqData/searchData/yyyy").length == 4){
							
							mc_budg_6111_l_cb();
						
							var last_yyyymm_var = get_refvalue("/root/resData/resform/mc_budg_6111_l/dataSet/CURLIST2/record/last_yyyymm");
							var fr_to_1_var = get_refvalue("/root/resData/resform/mc_budg_6111_l/dataSet/CURLIST3/record/fr_to_1");
							var fr_to_2_var = get_refvalue("/root/resData/resform/mc_budg_6111_l/dataSet/CURLIST3/record/fr_to_2");
							
							set_refvalue("/root/reqData/searchData/last_yyyymm",last_yyyymm_var);
							last_yyyymm.value = last_yyyymm_var.substr(4,2);
							fr_to_11.value = fr_to_1_var.substring(4,6);
							fr_to_12.value = fr_to_1_var.substring(11,13);
							fr_to_21.value = fr_to_2_var.substring(4,6);
							fr_to_22.value = fr_to_2_var.substring(11,13);
							
							set_refvalue("/root/temtData/save_yn","N");
							
							//set_refvalue("/root/resData/gridData/mc_budg_6114_l/dataSet/CURLIST/record/amt_01", "0001");
							//fr_to_11.refresh();
						}
					]]>
						</script>
					</input>
					<select1 id="srch_tms" ref="/root/reqData/searchData/tms" class="req" navindex="2" appearance="minimal" editmode="inputsearch" caption="예산차수" style="left:366px; top:4px; width:90px; height:18px; ">
						<choices>
							<itemset nodeset="/root/resData/resform/mc_budg_6111_l/dataSet/CURLIST1/record">
								<label ref="cd2"/>
								<value ref="cd1"/>
							</itemset>
						</choices>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
						if(srch_yyyy.value == ""){
							srch_tms_err();
						}
					]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								if(combo_data_contains(srch_tms, srch_tms.value) == -1){
								show_message("정확한 값을 선택해 주세요.");
								set_refvalue(srch_tms,"");
								return;
							}			
							]]>
						</script>
					</select1>
					<caption id="caption25" class="list_cap01" style="left:5px; top:30px; width:120px; height:25px; text-align:center; ">분류기준</caption>
					<caption id="caption26" class="list_cap02" style="left:124px; top:30px; width:102px; height:25px; text-align:center; "/>
					<input id="srch_clas_cd1" ref="/root/reqData/searchData/clas_cd1" navindex="3" inputtype="button" format="99" style="left:129px; top:33px; width:92px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
						open_mc_co_1020();
					]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
						if(srch_clas_cd1.value == ""){
							set_refvalue(srch_clas_cd2,"");
							set_refvalue(srch_clas_cd3,"");
							set_refvalue(srch_clas_cd4,"");
							set_refvalue(srch_clas_cd1_nm,"");
							set_refvalue(srch_clas_cd2_nm,"");
							set_refvalue(srch_clas_cd3_nm,"");
							set_refvalue(srch_clas_cd4_nm,"");
						}
					]]>
						</script>
					</input>
					<caption id="caption28" style="left:475px; top:3px; width:155px; height:20px; color:#3366ff; ">최종 마감월 :      월</caption>
					<caption id="caption2" class="list_cap02" style="left:225px; top:30px; width:97px; height:25px; text-align:center; "/>
					<input id="srch_clas_cd2" ref="/root/reqData/searchData/clas_cd2" navindex="4" inputtype="button" format="99" style="left:230px; top:33px; width:87px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
						if(srch_clas_cd1.value == "" || srch_clas_cd1.value == "장"){
							show_message("분류기준(장)이 입력되지 않았습니다.");
							model.setFocus("srch_clas_cd1");
							return;
						}
						open_mc_co_1020();
					]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
						if(srch_clas_cd2.value == ""){
							set_refvalue(srch_clas_cd3,"");
							set_refvalue(srch_clas_cd4,"");
							set_refvalue(srch_clas_cd2_nm,"");
							set_refvalue(srch_clas_cd3_nm,"");
							set_refvalue(srch_clas_cd4_nm,"");
						}
					]]>
						</script>
					</input>
					<caption id="caption3" class="list_cap02" style="left:417px; top:30px; width:97px; height:25px; text-align:center; "/>
					<input id="srch_clas_cd4" ref="/root/reqData/searchData/clas_cd4" navindex="6" inputtype="button" format="99" style="left:422px; top:33px; width:87px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
						if(srch_clas_cd3.value == "" ||  srch_clas_cd3.value == "항"){
							show_message("분류기준(항)이 입력되지 않았습니다.");
							model.setFocus("srch_clas_cd3");
							return;
						}
						open_mc_co_1020();
					]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
						if(srch_clas_cd4.value == ""){
							set_refvalue(srch_clas_cd4_nm,"");
						}
					]]>
						</script>
					</input>
					<caption id="caption4" class="list_cap02" style="left:321px; top:30px; width:97px; height:25px; text-align:center; "/>
					<input id="srch_clas_cd3" ref="/root/reqData/searchData/clas_cd3" navindex="5" inputtype="button" format="99" style="left:326px; top:33px; width:87px; height:18px; text-align:center; ">
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
						if(srch_clas_cd2.value == "" ||  srch_clas_cd2.value == "관"){
							show_message("분류기준(관)이 입력되지 않았습니다.");
							model.setFocus("srch_clas_cd2");
							return;
						}
						open_mc_co_1020();
					]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
						if(srch_clas_cd3.value == ""){
							set_refvalue(srch_clas_cd4,"");
							set_refvalue(srch_clas_cd3_nm,"");
							set_refvalue(srch_clas_cd4_nm,"");
						}
					]]>
						</script>
					</input>
					<caption id="last_yyyymm" style="left:565px; top:5px; width:20px; height:15px; "/>
					<caption id="caption20" class="list_cap02" style="left:609px; top:30px; width:93px; height:25px; text-align:center; "/>
					<caption id="caption21" class="list_cap02" style="left:797px; top:30px; width:118px; height:25px; text-align:center; "/>
					<caption id="caption22" class="list_cap02" style="left:701px; top:30px; width:97px; height:25px; text-align:center; "/>
					<input id="srch_clas_cd2_nm" ref="/root/resData/resform/clas_cd_nm/dataSet/clas_cd2_nm" editable="false" style="left:614px; top:33px; width:83px; height:18px; "/>
					<caption id="caption27" class="list_cap02" style="left:513px; top:30px; width:97px; height:25px; text-align:center; "/>
					<input id="srch_clas_cd4_nm" ref="/root/resData/resform/clas_cd_nm/dataSet/clas_cd4_nm" editable="false" style="left:802px; top:33px; width:87px; height:18px; "/>
					<input id="srch_clas_cd1_nm" ref="/root/resData/resform/clas_cd_nm/dataSet/clas_cd1_nm" editable="false" style="left:518px; top:33px; width:87px; height:18px; "/>
					<input id="srch_clas_cd3_nm" ref="/root/resData/resform/clas_cd_nm/dataSet/clas_cd3_nm" editable="false" style="left:706px; top:33px; width:87px; height:18px; "/>
					<input id="fr_to_11" ref="/root/temtData/fr_to_11" editable="false" style="left:698px; top:4px; width:20px; height:18px; "/>
					<caption id="caption31" style="left:725px; top:4px; width:10px; height:20px; vertical-align:middle; ">-</caption>
					<input id="fr_to_12" ref="/root/temtData/fr_to_12" editable="false" style="left:740px; top:4px; width:20px; height:18px; "/>
					<caption id="caption32" class="list_cap01" style="left:632px; top:1px; width:60px; height:25px; text-align:center; ">실적월</caption>
					<caption id="caption33" style="left:859px; top:4px; width:10px; height:20px; vertical-align:middle; ">-</caption>
					<input id="fr_to_21" ref="/root/temtData/fr_to_21" editable="false" style="left:833px; top:4px; width:20px; height:18px; "/>
					<caption id="caption34" class="list_cap01" style="left:767px; top:1px; width:60px; height:25px; text-align:center; ">예산월</caption>
					<input id="fr_to_22" ref="/root/temtData/fr_to_22" editable="false" style="left:873px; top:4px; width:20px; height:18px; "/>
				</group>
				<group id="group_line" class="gro_line" style="left:5px; top:75px; width:916px; height:5px; "/>
			</case>
			<case id="case2">
				<datagrid id="datagrid5" nodeset="/root/resData/gridData/mc_budg_6212_l/dataSet/CURLIST/record" caption="구분^분류코드^분류명^1월^2월^3월^4월^5월^6월^7월^8월^9월^10월^11월^12월^합계^전년 실적" colsep="#" colwidth="100, 100, 100, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 100, 100" extendlastcol="scroll" frozencols="3" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:0px; top:330px; width:919px; height:235px; font-weight:bold; ">
					<col ref="groupings" visibility="hidden"/>
					<col ref="budg_clas_cd" visibility="hidden"/>
					<col ref="budg_clas_cd_nm"/>
					<col ref="mm_amt_1" type="input"/>
					<col ref="mm_amt_2" type="input"/>
					<col ref="mm_amt_3" type="input"/>
					<col ref="mm_amt_4" type="input"/>
					<col ref="mm_amt_5" type="input"/>
					<col ref="mm_amt_6" type="input"/>
					<col ref="mm_amt_7" type="input"/>
					<col ref="mm_amt_8" type="input"/>
					<col ref="mm_amt_9" type="input"/>
					<col ref="mm_amt_10" type="input"/>
					<col ref="mm_amt_11" type="input"/>
					<col ref="mm_amt_12" type="input"/>
					<col ref="amount_sum"/>
					<col ref="prvyy_rslt_amt"/>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							_oth_clsf = "5";		
						]]>
					</script>
				</datagrid>
				<datagrid id="datagrid4" nodeset="/root/resData/gridData/mc_budg_6211_l/dataSet/CURLIST/record" caption="구분^분류코드^분류명^1월^2월^3월^4월^5월^6월^7월^8월^9월^10월^11월^12월^합계^전년 실적" colsep="#" colwidth="100, 100, 100, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 100, 100" extendlastcol="scroll" frozencols="3" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:0px; top:70px; width:919px; height:245px; font-weight:bold; ">
					<col ref="groupings" visibility="hidden"/>
					<col ref="budg_clas_cd" visibility="hidden"/>
					<col ref="budg_clas_cd_nm"/>
					<col ref="mm_amt_1" type="input"/>
					<col ref="mm_amt_2" type="input"/>
					<col ref="mm_amt_3" type="input"/>
					<col ref="mm_amt_4" type="input"/>
					<col ref="mm_amt_5" type="input"/>
					<col ref="mm_amt_6" type="input"/>
					<col ref="mm_amt_7" type="input"/>
					<col ref="mm_amt_8" type="input"/>
					<col ref="mm_amt_9" type="input"/>
					<col ref="mm_amt_10" type="input"/>
					<col ref="mm_amt_11" type="input"/>
					<col ref="mm_amt_12" type="input"/>
					<col ref="amount_sum"/>
					<col ref="prvyy_rslt_amt"/>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							_oth_clsf = "4";		
						]]>
					</script>
				</datagrid>
				<group id="group3" class="gro_sel" style="left:5px; top:10px; width:914px; height:30px; font-weight:bold; ">
					<caption id="caption1" class="list_cap01" style="left:0px; top:1px; width:120px; height:25px; text-align:center; ">예산년도</caption>
					<caption id="caption5" class="list_cap02" style="left:119px; top:1px; width:790px; height:25px; text-align:center; "/>
					<caption id="caption11" class="list_cap01" style="left:235px; top:1px; width:120px; height:25px; text-align:center; ">조정차수</caption>
					<caption id="caption30" class="list_cap02" style="left:354px; top:1px; width:104px; height:25px; text-align:center; "/>
					<input id="srch_yyyy_tab2" ref="/root/reqData/searchData/yyyy_tab2" class="req" maxlength="4" format="9999" caption="예산년도" style="left:126px; top:4px; width:103px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								mc_budg_6210_m_cb();
							]]>
						</script>
					</input>
					<select1 id="srch_tms_tab2" ref="/root/reqData/searchData/tms_tab2" class="req" navindex="2" appearance="minimal" editmode="inputsearch" caption="예산차수" style="left:361px; top:4px; width:90px; height:18px; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/mc_budg_6210_m/dataSet/CURLIST/record">
								<label ref="codename"/>
								<value ref="code"/>
							</itemset>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								if(combo_data_contains(srch_tms_tab2, srch_tms_tab2.value) == -1){
									show_message("정확한 값을 선택해 주세요.");
									set_refvalue(srch_tms_tab2,"");
									return;
								}						
							]]>
						</script>
					</select1>
					<select id="chk_tms" ref="/root/reqData/reqform/chk_tms" overflow="visible" appearance="full" style="left:465px; top:5px; width:75px; height:15px; border-style:none; ">
						<choices>
							<item>
								<label>차수증가</label>
								<value>1</value>
							</item>
						</choices>
					</select>
				</group>
				<group id="group4" class="gro_line" style="left:5px; top:50px; width:916px; height:5px; "/>
				<datagrid id="datagrid6" nodeset="/root/resData/gridData/mc_budg_6213_l/dataSet/CURLIST/record" caption="구분^1월^2월^3월^4월^5월^6월^7월^8월^9월^10월^11월^12월" colsep="^" colwidth="130, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowsep="|" style="left:0px; top:588px; width:919px; height:63px; font-weight:bold; ">
					<col ref="rownm"/>
					<col ref="mm_amt_1"/>
					<col ref="mm_amt_2"/>
					<col ref="mm_amt_3"/>
					<col ref="mm_amt_4"/>
					<col ref="mm_amt_5"/>
					<col ref="mm_amt_6"/>
					<col ref="mm_amt_7"/>
					<col ref="mm_amt_8"/>
					<col ref="mm_amt_9"/>
					<col ref="mm_amt_10"/>
					<col ref="mm_amt_11"/>
					<col ref="mm_amt_12"/>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							_oth_clsf = "6";		
						]]>
					</script>
				</datagrid>
				<caption id="caption41" style="left:10px; top:570px; width:55px; height:15px; font-weight:bold; ">세전이익</caption>
			</case>
			<case id="case3">
				<group id="group5" class="gro_sel" style="left:5px; top:10px; width:914px; height:50px; font-weight:bold; ">
					<caption id="caption47" class="list_cap02" style="left:575px; top:1px; width:117px; height:25px; text-align:center; "/>
					<caption id="caption42" class="list_cap01" style="left:0px; top:1px; width:120px; height:25px; text-align:center; ">대상년도(직전)</caption>
					<caption id="caption43" class="list_cap02" style="left:119px; top:1px; width:117px; height:25px; text-align:center; "/>
					<caption id="caption44" class="list_cap01" style="left:235px; top:1px; width:120px; height:25px; text-align:center; ">대상회차(직전)</caption>
					<caption id="caption45" class="list_cap02" style="left:354px; top:1px; width:121px; height:25px; text-align:center; "/>
					<input id="srch_yyyy_bf" ref="/root/reqData/searchData/yyyy_bf" class="req" caption="대상년도(직전)" style="left:126px; top:4px; width:103px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								var yy = srch_yyyy_bf.value;
								mc_budg_6130_m.attribute("resultref") = "/root/initData/comboSet/mc_budg_6130_m_bf/dataSet";
								send_mc_budg_6130_m(yy);
								makeComboGubun("","/root/initData/comboSet/mc_budg_6130_m_bf/dataSet/CURLIST","record","tms", "tms");
							]]>
						</script>
					</input>
					<select1 id="srch_tms_bf" ref="/root/reqData/searchData/tms_bf" class="req" appearance="minimal" editmode="inputsearch" caption="대상회차(직전)" style="left:361px; top:4px; width:90px; height:18px; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/mc_budg_6130_m_bf/dataSet/CURLIST/record">
								<label ref="tms"/>
								<value ref="tms"/>
							</itemset>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								if(combo_data_contains(srch_tms_bf, srch_tms_bf.value) == -1){
									show_message("정확한 값을 선택해 주세요.");
									set_refvalue(srch_tms_bf,"");
									return;
								}
								var idx = srch_tms_bf.focusIndex + 1;
								rslt_aply_prd_bgn.value = get_refvalue("/root/initData/comboSet/mc_budg_6130_m_bf/dataSet/CURLIST/record["+idx+"]/rslt_aply_prd_bgn");
								expt_aply_prd_bgn.value = get_refvalue("/root/initData/comboSet/mc_budg_6130_m_bf/dataSet/CURLIST/record["+idx+"]/expt_aply_prd_bgn");
							]]>
						</script>
					</select1>
					<input id="srch_yyyy_af" ref="/root/reqData/searchData/yyyy_af" class="req" caption="비교년도" style="left:582px; top:4px; width:103px; height:18px; ">
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								var yy = srch_yyyy_af.value;
								mc_budg_6130_m.attribute("resultref") = "/root/initData/comboSet/mc_budg_6130_m_af/dataSet";
								send_mc_budg_6130_m(yy);
								makeComboGubun("","/root/initData/comboSet/mc_budg_6130_m_af/dataSet/CURLIST","record","tms", "tms");
							]]>
						</script>
					</input>
					<caption id="caption46" class="list_cap01" style="left:456px; top:1px; width:120px; height:25px; text-align:center; ">비교년도</caption>
					<caption id="caption48" class="list_cap01" style="left:691px; top:1px; width:120px; height:25px; text-align:center; ">비교회차</caption>
					<caption id="caption49" class="list_cap02" style="left:810px; top:1px; width:102px; height:25px; text-align:center; "/>
					<select1 id="srch_tms_af" ref="/root/reqData/searchData/tms_af" class="req" appearance="minimal" editmode="inputsearch" caption="비교회차" style="left:817px; top:4px; width:90px; height:18px; ">
						<choices>
							<itemset nodeset="/root/initData/comboSet/mc_budg_6130_m_af/dataSet/CURLIST/record">
								<label ref="tms"/>
								<value ref="tms"/>
							</itemset>
						</choices>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								if(combo_data_contains(srch_tms_af, srch_tms_af.value) == -1){
									show_message("정확한 값을 선택해 주세요.");
									set_refvalue(srch_tms_af,"");
									return;
								}
								var idx = srch_tms_af.focusIndex + 1;
								rslt_aply_prd_end.value = get_refvalue("/root/initData/comboSet/mc_budg_6130_m_af/dataSet/CURLIST/record["+idx+"]/rslt_aply_prd_end");
								expt_aply_prd_end.value = get_refvalue("/root/initData/comboSet/mc_budg_6130_m_af/dataSet/CURLIST/record["+idx+"]/expt_aply_prd_end");						
							]]>
						</script>
					</select1>
					<caption id="caption51" class="list_cap01" style="left:0px; top:25px; width:120px; height:25px; text-align:center; ">실적월</caption>
					<caption id="caption54" class="list_cap02" style="left:119px; top:25px; width:117px; height:25px; text-align:center; "/>
					<caption id="caption56" class="list_cap01" style="left:235px; top:25px; width:120px; height:25px; text-align:center; ">예상월</caption>
					<caption id="caption58" class="list_cap02" style="left:354px; top:25px; width:121px; height:25px; text-align:center; "/>
					<caption id="caption59" class="list_cap01" style="left:456px; top:25px; width:120px; height:25px; text-align:center; ">실적월</caption>
					<caption id="caption60" class="list_cap02" style="left:575px; top:25px; width:117px; height:25px; text-align:center; "/>
					<caption id="caption61" class="list_cap01" style="left:691px; top:25px; width:120px; height:25px; text-align:center; ">예상월</caption>
					<caption id="caption62" class="list_cap02" style="left:810px; top:25px; width:102px; height:25px; text-align:center; "/>
					<input id="rslt_aply_prd_bgn" ref="/root/resData/resform/rslt_aply_prd_bgn" editable="false" style="left:126px; top:28px; width:103px; height:18px; "/>
					<input id="expt_aply_prd_bgn" ref="/root/resData/resform/expt_aply_prd_bgn" editable="false" style="left:361px; top:28px; width:90px; height:18px; "/>
					<input id="rslt_aply_prd_end" ref="/root/resData/resform/rslt_aply_prd_end" editable="false" style="left:582px; top:28px; width:103px; height:18px; "/>
					<input id="expt_aply_prd_end" ref="/root/resData/resform/expt_aply_prd_end" editable="false" style="left:817px; top:28px; width:90px; height:18px; "/>
				</group>
				<datagrid id="datagrid7" nodeset="/root/resData/gridData/mc_budg_6132_l/dataSet/CURLIST/record" caption="구분^대상금액^비교금액^증감액^1월^1월^2월^2월^3월^3월^4월^4월^5월^5월^6월^6월^7월^7월^8월^8월^9월^9월^10월^10월^11월^11월^12월^12월|구분^대상금액^비교금액^증감액^대상금액^비교금액^대상금액^비교금액^대상금액^비교금액^대상금액^비교금액^대상금액^비교금액^대상금액^비교금액^대상금액^비교금액^대상금액^비교금액^대상금액^비교금액^대상금액^비교금액^대상금액^비교금액^대상금액^비교금액" colsep="#" colwidth="131, 110, 110, 110, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" frozencols="4" mergecellsfixedrows="bycolrec" rowsep="|" style="left:5px; top:85px; width:914px; height:560px; font-weight:bold; ">
					<col ref="budg_clas_cdnm"/>
					<col ref="bf_sumamt"/>
					<col ref="af_sumamt"/>
					<col ref="diff_amt"/>
					<col ref="bf_amt1"/>
					<col ref="af_amt1"/>
					<col ref="bf_amt2"/>
					<col ref="af_amt2"/>
					<col ref="bf_amt3"/>
					<col ref="af_amt3"/>
					<col ref="bf_amt4"/>
					<col ref="af_amt4"/>
					<col ref="bf_amt5"/>
					<col ref="af_amt5"/>
					<col ref="bf_amt6"/>
					<col ref="af_amt6"/>
					<col ref="bf_amt7"/>
					<col ref="af_amt7"/>
					<col ref="bf_amt8"/>
					<col ref="af_amt8"/>
					<col ref="bf_amt9"/>
					<col ref="af_amt9"/>
					<col ref="bf_amt10"/>
					<col ref="af_amt10"/>
					<col ref="bf_amt11"/>
					<col ref="af_amt11"/>
					<col ref="bf_amt12"/>
					<script type="javascript" ev:event="onclick">
						<![CDATA[
							_oth_clsf = "7";		
						]]>
					</script>
				</datagrid>
				<group id="group6" class="gro_line" style="left:5px; top:70px; width:915px; height:5px; "/>
			</case>
		</switch>
		<group id="group2" style="left:10px; top:40px; width:200px; height:35px; ">
			<button id="search" class="tab02" group="group2" crud="R" style="left:0px; top:10px; width:92px; height:23px; ">
				<caption>조  회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case1");
						tab_cap.value = "※ 실적월 : 예산확정 DATA , 예산월 : 예산계획 DATA";
						button2.disabled = false;
					]]>
				</script>
			</button>
			<button id="update" class="tab02" group="group2" crud="R" style="left:52px; top:10px; width:52px; height:23px; ">
				<caption>수  정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case2");
						tab_cap.value = "※ SOURCE : 예산계획 DATA , 저장시 원래의 예산계획 DATA 변경없음";
						button2.disabled = true;
						]]>
				</script>
			</button>
			<button id="button1" class="tab05" group="group2" crud="R" style="left:104px; top:10px; width:71px; height:23px; ">
				<caption>직전보고 차이</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case3");
						tab_cap.value = "※ 당월예산 : 예산확정 DATA , 당월조정 : 수정된 예산 DATA";
						button2.disabled = true;
						]]>
				</script>
			</button>
		</group>
		<caption id="tab_cap" style="left:220px; top:56px; width:560px; height:15px; ">※ 실적월 : 예산확정 DATA , 예산월 : 예산계획 DATA</caption>
	</xhtml:body>
</xhtml:html>
