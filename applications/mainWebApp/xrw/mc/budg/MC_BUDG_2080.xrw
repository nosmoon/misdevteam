<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>재료비 및 외주가공비 등록(MC_BUDG_2080)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session/>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
							<mc_budg_2103_m>
								<dataSet>
									<CURLIST>
										<record>
											<cd_nm/>
											<cd/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_2103_m>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
						<mc_budg_2085_m>
							<dataSet>
								<xx_budg_type_cd_010/>
								<xx_budg_type_cd_020/>
							</dataSet>
						</mc_budg_2085_m>
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData/>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<budg_yymm/>
							<budg_cd/>
							<budg_type_cd>04</budg_type_cd>
							<dept_cd/>
							<use_dept_cd/>
							<work_no/>
							<seq/>
							<mc_budg_1001_l>
								<cd/>
							</mc_budg_1001_l>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqform>
							<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						</reqform>
						<multiUpDate>
							<medi_cd/>
							<rmks/>
							<today/>
							<tag/>
							<budg_yy/>
							<budg_cd/>
							<dept_cd/>
							<evnt_cd>
							</evnt_cd>
							<work_no/>
							<seq/>
							<use_dept_cd/>
							<chg_pers/>
							<del_cnt/>
						</multiUpDate>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resform>
							<incmg_pers/>
							<incmg_pers_nm/>
							<budg_nm/>
							<dept_nm/>
							<use_dept_nm/>
							<mc_budg_2240_m>
								<dataSet>
									<CURLIST>
										<record>
											<max_sub_cd/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_2240_m>
							<mc_budg_2080_m>
								<dataSet>
									<CURLIST>
										<record>
											<budg_cd/>
											<budg_nm/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_2080_m>
							<mc_budg_1001_l>
								<dataSet>
									<CURLIST>
										<record>
											<budg_clas_cd/>
											<budg_type_cd/>
											<budg_cdnm/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_1001_l>
							<mc_budg_2072_l>
								<dataSet>
									<CURLIST1>
										<record>
											<cmpy_cd/>
											<dept_cd/>
											<budg_type_cd/>
											<budg_cd/>
											<budg_nm/>
										</record>
									</CURLIST1>
								</dataSet>
							</mc_budg_2072_l>
							<mc_budg_1002_l>
								<dataSet>
									<CURLIST>
										<record>
											<mang_item_cd/>
											<mang_item_nm/>
											<mang_item_val/>
											<acct_yn/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_1002_l>
						</resform>
						<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<gridData>
							<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
							<mc_budg_2081_l>
								<dataSet>
									<CURLIST>
										<record>
											<seq/>
											<use_dept_cd/>
											<if_buseonm_dtsybscd/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_2081_l>
							<mc_budg_2082_l>
								<dataSet>
									<CURLIST>
										<record>
											<month/>
											<use_dept_cd/>
											<if_buseonm_dtsybscd/>
											<budg_yymm/>
											<req_qunt/>
											<req_uprc/>
											<req_amt/>
											<medi_cd/>
											<rmks/>
											<jobtag/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_2082_l>
						</gridData>
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<keyData/>
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<focusin/>
						<medi_cd_chg/>
						<rmks_chg/>
						<gridData>
							<mc_budg_2082_l/>
						</gridData>
						<fc_co_1101_l>
							<dataSet>
								<CURLIST1>
									<record>
										<cmpy_cd/>
										<dept_cd/>
										<dept_team_clsf/>
										<abrv_nm/>
										<offi_nm/>
										<dept_team_nm/>
										<part_nm/>
										<part_dn_nm/>
									</record>
								</CURLIST1>
							</dataSet>
						</fc_co_1101_l>
					</tempData>
					<!-- 저장소 -->
				</root>
			</instance>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<script type="javascript" src="/js/fcmc_common.js"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					init_controls();
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					if(srch_budg_yymm.value == ""){
						send_mc_budg_2240_m();
					}
					model.send("mc_budg_2085_m");
					//alert(model1.getValue("/root/initData/mc_budg_2085_m/dataSet/xx_budg_type_cd_010"));
					//alert(model1.getValue("/root/initData/mc_budg_2085_m/dataSet/xx_budg_type_cd_020"));
					model.refresh();
				]]>
			</script>
			<submission id="mc_budg_2240_m" action="/mc/budg2000/2240" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/resData/resform/mc_budg_2240_m/dataSet"/>
			<submission id="mc_budg_2080_m" action="/mc/budg2000/2080" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resform/mc_budg_2080_m/dataSet"/>
			<submission id="mc_budg_2083_i" action="/mc/budg2000/2083" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="mc_budg_2084_d" action="/mc/budg2000/2084" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="mc_budg_2081_l" action="/mc/budg2000/2081" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/mc_budg_2081_l/dataSet"/>
			<submission id="mc_budg_2082_l" action="/mc/budg2000/2082" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/mc_budg_2082_l/dataSet"/>
			<submission id="mc_budg_1001_l" action="/mc/budg1000/1001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resform/mc_budg_1001_l/dataSet"/>
			<submission id="mc_budg_2103_m" action="/mc/budg2000/2103" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/comboSet/mc_budg_2103_m/dataSet"/>
			<submission id="mc_budg_2072_l" action="/mc/budg2000/2072" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resform/mc_budg_2072_l/dataSet"/>
			<submission id="fc_co_1101" action="/fc/co1000/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/fc_co_1101_l/dataSet"/>
			<submission id="mc_budg_1002_l" action="/mc/budg1000/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resform/mc_budg_1002_l/dataSet"/>
			<submission id="mc_budg_2085_m" action="/mc/budg2000/2085" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/mc_budg_2085_m/dataSet"/>
		</model>
		<script type="javascript">
			<![CDATA[
				// 초기화 함수 //
				function init_controls(){
					set_default(
						datagrid1,
						datagrid2,
						datagrid3,
						medi_cd
					);
					
					set_format(
						"month_1",
						today
					);
					
					set_format(
						"number3_2",
						datagrid2,"2,3"
					);
					
					set_format(
						"number4",
						datagrid2,"4"
					);
					
					datagrid2.attribute("explorerbar") = "";
					default_grid();
					set_today();
					send_mc_budg_2103_m();
					
					incmg_pers.value = getProperty("ss_emp_no");
					incmg_pers_nm.value = getProperty("ss_emp_nm");
				}
			
				// 매체콤보 불러오기 //
				function send_mc_budg_2103_m(){
					model.send("mc_budg_2103_m");
					makeComboGubun("","/root/initData/comboSet/mc_budg_2103_m/dataSet/CURLIST","record","cd_nm", "cd");
				}
				
				// 등록일자 설정 //
				function set_today(){
					today.value = commCurDate();
				}
				
				// 경리확정마감년도 불러오기 //
				function send_mc_budg_2240_m(){
					model.send("mc_budg_2240_m");
					srch_budg_yymm.value = Number(get_refvalue("/root/resData/resform/mc_budg_2240_m/dataSet/CURLIST/record/max_sub_cd"))+1;
				}
				
				// 부서코드조회 팝업//
//				function open_mc_co_1010() {
//					var popid = "mc_co_1010";
//					var rcvs_flag = false;
//					
//					if (event != null && event.name == "xforms-value-changed") {
//						//값이 변경되면 기존에 조회된 자료를 모두 제거한다.
//						reset_popup_rcvs_data(popid);
//					}
//					
//					set_popup_send_data(popid,"mode","sr");
//					set_popup_send_data(popid,"title","");
//					set_popup_send_data(popid,"readonly","0");
//					set_popup_send_data(popid,"datafilter","");	
//					
//					if(get_refvalue("/root/tempData/focusin") == "srch_dept_cd"){
//						set_popup_send_data(popid,"dept_cd",srch_dept_cd.value);
//					}else{
//						set_popup_send_data(popid,"dept_cd",use_dept_cd.value);
//					}
//					
//					rcvs_flag = call_mc_co_1010(false);
//					
//					if (rcvs_flag) {
//						//정상처리
//					}
//					else {
//						//취소버튼을 누른 경우 조회 조회를 위한 값과 조회된 값이 틀린 경우 기존 값을 모두 제거한다.
//					}
//					
//					//value-changed 와 buttonclick이 동시 발생했을 경우
//					//이하 코드는 두번씩 실행되므로 무거운 코드는 넣지 않도록 하자
//	
//					//만약  value-changed 이벤트이면서 결과값이 없는 경우면 현재 값과 현재값에 종속되는 모든 값을 삭제한다.
//					if (event != null && event.name == "xforms-value-changed" && !rcvs_flag) {
//						//부서가 변경되면 고유행사코드는 삭제한다.
//						//단 부서의 앞 2자리가 같은 경우 제외
//						//입력값에 대한 oldValue와 currentText는 input에만 있으므로 조회하는 컨트롤이 input 컨트롤이라고 가정한다.
//						//현재값이 공백이어도 변경 처리
//						if(get_refvalue("/root/tempData/focusin") == "srch_dept_cd"){
//							set_refvalue(srch_dept_cd,"");
//							set_refvalue(dept_nm,"");
//						}else{
//							set_refvalue(use_dept_cd,"");
//							set_refvalue(use_dept_nm,"");
//						}
//					}
//					
//					/*----------------------------------------------------------------
//				        ' 개인별보안관리' space권한일 경우 1999.06.17
//				        '=================================================================
//				        If GF_SYBUSEOCDYB(txtbuseocd.Text) = False Then
//				            If W_GUNHAN = "G" Then
//				                MsgBox "사용가능한 부서코드가 아닙니다", vbCritical, Cmndll.GF_GetMessage(1, 201)
//				            End If
//				            spr3.ReDraw = False
//				            lblBuseocdnm.Caption = "": txtbuseocd.Text = "":
//				            Screen.MousePointer = vbArrow
//				        Else
//				            '해당 부서에 해당하는 예산코드를 가져온다. 단, 경비예산만
//				            GS_BuyscdSelect 1, "04" 'spread에 부서별예산코드를 보여줌 또한 재료비예산임
//				            W_SPR3_Select_Cnt = spr3.DataRowCnt
//				            spr3.col = 0: spr3.ROW = 0: spr3.Action = 0
//				        End If
//				        '=================================================================
//				        '-----------------------------------------------------------------*/
//	
//					if(get_refvalue("/root/tempData/focusin") == "srch_dept_cd"){
//						set_refvalue(srch_dept_cd,get_popup_rcvs_data(popid,"dept_cd"));
//						set_refvalue(dept_nm, get_popup_rcvs_data(popid,"abrv_nm"));
//					}else{
//						set_refvalue(use_dept_cd,get_popup_rcvs_data(popid,"dept_cd"));
//						set_refvalue(use_dept_nm, get_popup_rcvs_data(popid,"abrv_nm"));
//					}
//					
//					model.send("mc_budg_2080_m");
//
//					if(get_refvalue("/root/resData/resform/mc_budg_2080_m/dataSet/CURLIST/totalcnt") == "0"){
//						show_message("해당 부서에 등록된 예산코드가 없습니다. 등록후 사용하십시오.");
//						return;
//					}
//					
//					return rcvs_flag;
//				}
				function setDept_cd(iv_dept_cd, iv_dept_nm, iv_dept_team_clsf, iv_offi_nm, iv_dept_team_nm, iv_part_nm, iv_part_dn_nm){	
					if(get_refvalue("/root/tempData/focusin") == "srch_dept_cd"){
						set_refvalue(srch_dept_cd,iv_dept_cd);
						set_refvalue(dept_nm, iv_dept_nm);
						
						model.send("mc_budg_2080_m");

						if(get_refvalue("/root/resData/resform/mc_budg_2080_m/dataSet/CURLIST/totalcnt") == "0"){
							show_message("해당 부서에 등록된 예산코드가 없습니다. 등록후 사용하십시오.");
							return;
						}
					}else{
						set_refvalue(use_dept_cd,iv_dept_cd);
						set_refvalue(use_dept_nm, iv_dept_nm);
					}
					
				}
				
				// 등록번호 조회 팝업 //
				function open_mc_co_2070(){
					model.property("MC_CO_2070_srch_budg_yyyy") =  srch_budg_yymm.value;
					model.property("MC_CO_2070_srch_dept_cd") =  srch_dept_cd.value;
					model.property("MC_CO_2070_srch_budg_cd") =  srch_budg_cd.value;
					model.property("MC_CO_2070_srch_budg_type_cd") = "04";
												
					model.property("MC_CO_2070_popup_flag")  = "Y";

					viewer("mainFrame").window.javaScript.onLoadPopupPageEx("MC_CO_2070", "modal", "align:center; caption:hidden; width:650px; height:480px;");
					
					if(model.property("MC_CO_2070_budg_cd") != ""){
						srch_budg_cd.value = model.property("MC_CO_2070_budg_cd");
						srch_budg_cd.dispatch("xforms-value-changed");
						srch_work_no.value = model.property("MC_CO_2070_work_no");
						use_dept_cd.value = model.property("MC_CO_2070_use_dept_cd");
						use_dept_cd.dispatch("xforms-value-changed");
						btn_select.dispatch("onclick");
					}
				}
				
				// 예산코드 조회 //
				function send_mc_budg_1001_l(){
					var alert_set = "";
					
					set_refvalue("/root/reqData/searchData/mc_budg_1001_l/cd",srch_budg_cd.value);
					//model.send("mc_budg_2072_l");
					model.send("mc_budg_1001_l");
					
					if(get_refvalue("/root/resData/resform/mc_budg_1001_l/dataSet/CURLIST/totalcnt") != "1"){
						srch_budg_cd.value = "";
						budg_nm.value = "";
					}else{
						var chk_budg_clas_cd = Number(get_refvalue("/root/resData/resform/mc_budg_1001_l/dataSet/CURLIST/record/budg_clas_cd"));
						var chk_budg_type_cd = get_refvalue("/root/resData/resform/mc_budg_1001_l/dataSet/CURLIST/record/budg_type_cd");
						
						switch(chk_budg_type_cd){
							/*case "04":
								alert_set = "재료비및외주가공비등록";
								break;*/
							//case "02":
							case model1.getValue("/root/initData/mc_budg_2085_m/dataSet/xx_budg_type_cd_020"):
								if(chk_budg_clas_cd >= 10101010 && chk_budg_clas_cd <= 10101019 || chk_budg_clas_cd >= 10102010 && chk_budg_clas_cd <= 10102019){
									alert_set = "광고매출계획등록";
								}else if(chk_budg_clas_cd >= 10101020 && chk_budg_clas_cd <= 10101029){
									alert_set = "신문판매매출계획등록";
								}else if(chk_budg_clas_cd >= 10102020 && chk_budg_clas_cd <= 10102029){
									alert_set = "출판판매매출계획등록";
								}
								break;
							//case "01":
							case model1.getValue("/root/initData/mc_budg_2085_m/dataSet/xx_budg_type_cd_010"):
								alert_set = "예산계획등록";
								break;
						}

						if(datagrid1.findRow(srch_budg_cd.value, 1, 0) == -1){
							if(alert_set != ""){
								show_message("해당 예산코드는 이화면에서 사용할 수 없습니다." + "[" + alert_set +"]" + "화면에서 사용하세요");
							}else{
								show_message("예산코드 " + "["+ srch_budg_cd.value + "]" + "는 해당부서에 등록된 예산코드가 아닙니다.");
							}
							srch_budg_cd.value = "";
							budg_nm.value = "";
							return;
						}else{
							budg_nm.value = get_refvalue("/root/resData/resform/mc_budg_1001_l/dataSet/CURLIST/record/budg_cdnm");
							medi_cd.disabled = check_medi_cd();
						}
					}
				}
				
				// 예산코드 불러오기 //
				function send_mc_budg_2080_m(){
					model.send("mc_budg_2080_m");
				}
				
				// 그리드 초기화 //
				function default_grid(){
					datagrid_data_clear(datagrid2);
					for(i = 1 ; i < 13 ; i++){
						datagrid2.addRow(false, true);
						datagrid2.valueMatrix(i,1) = i + "월";
						datagrid2.rowStatus(i) = "1";
					}
					
					datagrid2.isReadOnly(1,2,12,3) = true;
					datagrid2.refresh();
					grid_sum();
					
					set_refvalue("/root/reqData/multiUpDate/tag","1");
				}
				
				// 그리드내 합계계산 //
				function grid_sum(){
					for(i = 1 ; i < 13 ; i++){
						var col2 = Number(datagrid2.valueMatrix(i,2));
						var col3 = Number(datagrid2.valueMatrix(i,3));
						
						datagrid2.valueMatrix(i,4) = col2 * col3;
					}
					datagrid2.subtotal("clear", -1, 2, 1, "합계");
					datagrid2.subtotal("clear", -1, 4, 1, "합계");
					datagrid2.subtotal("sum", -1, 2, "(-)#,###.99", "", 1, "합계");
					datagrid2.subtotal("sum", -1, 4, "(-)#,###.99", "", 1, "합계");
				}
				
				// reset후 컨트롤 재설정 //
				function reset_model(p_save){
					var srch_budg_yymm_var = srch_budg_yymm.value;
					
					model.reset();
					
					if(p_save){
						srch_budg_yymm.value = srch_budg_yymm_var;
					}
				}
				
				// 일련번호 조회 //
				function send_mc_budg_2081_l(){
					model.send("mc_budg_2081_l");
					var seq_var = get_refvalue("/root/resData/gridData/mc_budg_2081_l/dataSet/CURLIST/record["+1+"]/seq");
					if(seq_var == ""){
						set_refvalue("/root/reqData/searchData/seq", "001");
					}
					set_refvalue("/root/reqData/searchData/seq", seq_var);
					return seq_var;
				}
				
				// 매체코드 체크 //
				function check_medi_cd() {
					var return_value = true;
					
					model.send("mc_budg_1002_l");

					if (submit_completed()) {
						if (model.getxpathvalue("count(/root/resData/resform/mc_budg_1002_l/dataSet/CURLIST/record[mang_item_cd='03'])") > 0){
							return_value = false;
						}
					}
					return return_value;
				}
				
				// 조회 //
				function send_mc_budg_2082_l(){
					var subid1 = "mc_budg_2082_l";
					var subref1 = eval(subid1).attribute("ref");
					var subresultref1 = eval(subid1).attribute("resultref");
					var subid1_cur1 = "CURLIST";
					
					set_refvalue("/root/tempData/medi_cd_chg","");
					set_refvalue("/root/tempData/rmks_chg","");
					
					// 필수항목 체크 //
					if (!commReqCheck(group_scr)) {
						return false;
					}
					mc_budg_2082_l.attribute("resultref") = "/root/resData/gridData/mc_budg_2082_l/dataSet";
					send_mc_budg_2081_l();
					
					set_refvalue("/root/reqData/multiUpDate/tag","");
					
					model.send(subid1);
					
					totalcnt = get_refvalue(subresultref1 + "/" + subid1_cur1 + "/totalcnt");
					
					if(totalcnt > 1){
						var medi_cd_var = get_refvalue("/root/resData/gridData/mc_budg_2082_l/dataSet/CURLIST/record["+1+"]/medi_cd");
						var medi_cd_idx = combo_data_contains(medi_cd,medi_cd_var);
						medi_cd.select(medi_cd_idx -1);
						rmks.value = get_refvalue("/root/resData/gridData/mc_budg_2082_l/dataSet/CURLIST/record["+1+"]/rmks");
					}else{
						medi_cd.select(0);
						rmks.value = "";
					}
					
					if(totalcnt < 12){
						model.copyNode("/root/tempData/gridData","/root/resData/gridData/mc_budg_2082_l");
						datagrid_data_clear(datagrid2);
						
						for(i = 1 ; i < 13 ; i++){
							datagrid2.addRow(false, true);
						}
						
						// 각 월에 해당하는 위치에 데이터 설정 //
						var totcnt = get_refvalue("/root/tempData/gridData/dataSet/CURLIST/totalcnt");
						for(i = 0 ; i < 12 ; i++){
							var mon = Number(get_refvalue("/root/tempData/gridData/dataSet/CURLIST/record["+i+"]/budg_yymm").substr(4,2));
							if(mon > 0){
								model.copyNode("/root/resData/gridData/mc_budg_2082_l/dataSet/CURLIST/record["+mon+"]","/root/tempData/gridData/dataSet/CURLIST/record["+i+"]");
								datagrid2.rowStatus(mon) = "0";
							}
						}
					}
					
					for(i = 1 ; i < 13 ; i++){
						set_refvalue("/root/resData/gridData/mc_budg_2082_l/dataSet/CURLIST/record["+i+"]/month",i+"월");
					}
					
					datagrid2.refresh();
					
					grid_sum();
					
					if(totalcnt == 0){
						show_message("검색결과가 없습니다.");
						default_grid();
					}
				}
				
				// 저장 //
				function send_mc_budg_2083_i(){
					var cnt = 0;
					var jobtag_set = get_refvalue("/root/tempData/medi_cd_chg") + get_refvalue("/root/tempData/rmks_chg");
					var seq_var = send_mc_budg_2081_l();
					var max_seq = Number(datagrid3.valueMatrix(datagrid3.rows-1,1));
					var err_chk = 0;
					
					// 필수항목 체크 //
					if (!commReqCheck(group_scr)) {
						return false;
					}
					
					if (!check_reqItem(use_dept_cd,"trim","focus","사용부서는 필수입력항목입니다.")) {return false;}
					
					for (i = 1 ; i < 13 ;  i++){
						if(datagrid2.rowStatus(i) == "2" || datagrid2.rowStatus(i) == "3"){
							for(j = 2 ; j < 4 ; j++){
								if(datagrid2.valueMatrix(i,j) == "0"){
									err_chk = err_chk + 1;
									if(err_chk > 0){
										show_message("처리할 수 없는 자료가 존재합니다. 수정후 다시 [저장]하세요");
										return;
									}
								}
							}
							if(datagrid2.rowStatus(i) == "3"){
								set_refvalue("/root/resData/gridData/mc_budg_2082_l/dataSet/CURLIST/record["+i+"]/budg_yymm",srch_budg_yymm.value + string_lpad(String(i),2,"0"));
							}
							cnt = cnt + 1;
						}else{
							datagrid2.rowStatus(i) = "0";
						}							
					}
					
					if(cnt == 0 && jobtag_set == ""){
						show_message("저장할 항목이 없습니다.");
						return;
					}
					
					if(show_message("저장하시겠습니까?", "저장", 4)  == 7){	
						return;
					}
					
					mc_budg_2082_l.attribute("resultref") = "/root/tempData/gridData/mc_budg_2082_l";
					model.send("mc_budg_2082_l");

					if(seq_var != ""){
						set_refvalue("/root/reqData/multiUpDate/tag","0");
						set_refvalue("/root/reqData/multiUpDate/seq", seq_var);
					}else{
						if(medi_cd.value == ""){
							show_message("매체코드를 선택하세요.");
							return;
						}
						set_refvalue("/root/reqData/multiUpDate/tag","1");
						set_refvalue("/root/reqData/multiUpDate/seq", "001");
					}
					
					today.value = today.value.substr(0,6);
					
					set_refvalue("/root/reqData/multiUpDate/budg_yy", srch_budg_yymm.value);
					set_refvalue("/root/reqData/multiUpDate/budg_cd", srch_budg_cd.value);
					set_refvalue("/root/reqData/multiUpDate/work_no", srch_work_no.value);
					set_refvalue("/root/reqData/multiUpDate/dept_cd", srch_dept_cd.value);
					
					var min_chk = 0;
					var iu_cnt = 0;
					var chk_amt = 0;
					for(i = 1 ; i < 13 ; i++){
						chk_amt = datagrid2.valueMatrix(i,4);
						if(datagrid2.rowStatus(i) == 3){
							set_refvalue("/root/resData/gridData/mc_budg_2082_l/dataSet/CURLIST/record["+i+"]/jobtag", "i");
							iu_cnt = iu_cnt + 1;
						}else if(datagrid2.rowStatus(i) == 2){
							set_refvalue("/root/resData/gridData/mc_budg_2082_l/dataSet/CURLIST/record["+i+"]/jobtag","u");
							iu_cnt = iu_cnt + 1;
						}
						
						if(chk_amt < 0){
							min_chk = min_chk + 1;
						}
					}

					if(iu_cnt == 0){
						set_refvalue("/root/resData/gridData/mc_budg_2082_l/dataSet/CURLIST/record["+1+"]/jobtag", jobtag_set);
						datagrid2.rowStatus(1) = "2";
					}

					if(min_chk > 0){
						if(show_message("저장하려는 data중에 (-)금액이 존재합니다. 그대로 저장하시겠습니까?", "저장", 4)  == 7){
							return;
						}
					}

					set_refvalue("/root/reqData/multiUpDate/multiUpdateData", datagrid2.getUpdateData());
					model.send("mc_budg_2083_i");
					
					if(submit_completed()){
						mc_budg_2082_l.attribute("resultref") = "/root/resData/gridData/mc_budg_2082_l/dataSet";
						btn_select.dispatch("onclick");
						datagrid2.refresh();
						show_message("저장되었습니다.");
					}
				}
				
				// 삭제 //
				function send_mc_budg_2084_d(){
					var seq_var = send_mc_budg_2081_l();
					
					// 필수항목 체크 //
					if (!commReqCheck(group_scr)) {
						return false;
					}
					
					set_refvalue("/root/reqData/multiUpDate/seq", seq_var);
					set_refvalue("/root/reqData/multiUpDate/budg_yy", srch_budg_yymm.value);
					set_refvalue("/root/reqData/multiUpDate/budg_cd", srch_budg_cd.value);
					set_refvalue("/root/reqData/multiUpDate/work_no", srch_work_no.value);
					set_refvalue("/root/reqData/multiUpDate/dept_cd", srch_dept_cd.value);
					
					var del_cnt = 0;
					for(i = 1 ; i < 13 ; i++){
						if(datagrid2.rowStatus(i) == 4){
							del_cnt = del_cnt + 1;
						}
					}
					
					if(del_cnt == 0){
						var use_dept_cd_var = get_refvalue("/root/resData/gridData/mc_budg_2082_l/dataSet/CURLIST/record["+1+"]/use_dept_cd");
						var use_dept_cd_idx = 0;
						
						set_refvalue("/root/reqData/multiUpDate/del_cnt", "12");
						set_refvalue("/root/reqData/multiUpDate/tag","0");
						use_dept_cd_idx = datagrid3.findRow(use_dept_cd_var,1,2);
						datagrid3.rowStatus(use_dept_cd_idx) = 4;
					}else{
						set_refvalue("/root/reqData/multiUpDate/del_cnt", del_cnt);
						set_refvalue("/root/reqData/multiUpDate/tag","1");
					}
					
					if(show_message("삭제하시겠습니까?", "삭제", 4)  == 7){	
						return;
					}
					
					set_refvalue("/root/reqData/multiUpDate/multiUpdateData", datagrid3.getUpdateData());
					model.send("mc_budg_2084_d");
					
					if(submit_completed()){
						btn_select.dispatch("onclick");
						datagrid2.refresh();
						show_message("삭제되었습니다.");
					}
				}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="728" guideline="1,10;2,11;1,902;1,912;1,917;1,937;1,936;2,30;2,39;2,42;2,49;2,705;2,680;" style="font-family:굴림; ">
		<group id="group_scr" class="gro_sel" style="left:10px; top:50px; width:926px; height:64px; ">
			<caption id="caption12" class="list_cap02" style="left:700px; top:35px; width:155px; height:25px; text-align:center; "/>
			<caption id="caption5" class="list_cap02" style="left:124px; top:5px; width:107px; height:25px; text-align:center; "/>
			<caption id="caption3" class="list_cap01" style="left:15px; top:35px; width:110px; height:25px; text-align:center; ">예산코드</caption>
			<caption id="caption9" class="list_cap02" style="left:124px; top:35px; width:278px; height:25px; text-align:center; "/>
			<input id="srch_budg_cd" ref="/root/reqData/searchData/budg_cd" class="req" navindex="3" format="999999" caption="예산코드" style="left:129px; top:38px; width:96px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						send_mc_budg_1001_l();
					]]>
				</script>
			</input>
			<input id="budg_nm" ref="/root/resData/resform/budg_nm" editable="false" style="left:229px; top:38px; width:167px; height:18px; "/>
			<caption id="caption1" class="list_cap01" style="left:15px; top:5px; width:110px; height:25px; text-align:center; ">예산년도</caption>
			<input id="srch_budg_yymm" ref="/root/reqData/searchData/budg_yymm" class="req" navindex="1" format="9999" caption="예산년도" style="left:129px; top:8px; width:82px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						reset_model(true);
					]]>
				</script>
			</input>
			<caption id="caption6" class="list_cap01" style="left:401px; top:35px; width:110px; height:25px; text-align:center; ">등록번호</caption>
			<caption id="caption7" class="list_cap02" style="left:510px; top:35px; width:82px; height:25px; text-align:center; "/>
			<caption id="caption4" class="list_cap01" style="left:230px; top:5px; width:105px; height:25px; text-align:center; ">부서코드</caption>
			<caption id="caption10" class="list_cap02" style="left:334px; top:5px; width:258px; height:25px; text-align:center; "/>
			<input id="srch_dept_cd" ref="/root/reqData/searchData/dept_cd" class="req" navindex="2" inputtype="button" format="999999" caption="부서코드" style="left:339px; top:8px; width:92px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						var var_con_date = "";

						if (srch_budg_yymm.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_budg_yymm.value.length;
							if(num_ch == 8){
								var_con_date = srch_budg_yymm.value;
							}else if(num_ch == 6){
								var_con_date = srch_budg_yymm.value + "01";
							}else if(num_ch == 4){
								var_con_date = srch_budg_yymm.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "I");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
//						open_mc_co_1010();		
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var var_con_date = "";

						if (srch_budg_yymm.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_budg_yymm.value.length;
							if(num_ch == 8){
								var_con_date = srch_budg_yymm.value;
							}else if(num_ch == 6){
								var_con_date = srch_budg_yymm.value + "01";
							}else if(num_ch == 4){
								var_con_date = srch_budg_yymm.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (srch_dept_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
							model.setValue("/root/reqData/fwdData/dept_cd", srch_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "I");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								dept_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								srch_dept_cd.value = "";
								dept_nm.value = "";
							}
						}
						else {
							srch_dept_cd.value = "";
							dept_nm.value = "";
						}	
						
						model.send("mc_budg_2080_m");

						if(get_refvalue("/root/resData/resform/mc_budg_2080_m/dataSet/CURLIST/totalcnt") == "0"){
							show_message("해당 부서에 등록된 예산코드가 없습니다. 등록후 사용하십시오.");
							return;
						}
//						open_mc_co_1010();
					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[
						set_refvalue("/root/tempData/focusin",model.getFocus());
					]]>
				</script>
			</input>
			<input id="dept_nm" ref="/root/resData/resform/dept_nm" editable="false" style="left:435px; top:8px; width:151px; height:18px; "/>
			<caption id="caption11" class="list_cap01" style="left:591px; top:35px; width:110px; height:25px; text-align:center; ">등록자</caption>
			<input id="incmg_pers" ref="/root/reqData/multiUpDate/chg_pers" editable="false" style="left:705px; top:38px; width:51px; height:20px; "/>
			<input id="incmg_pers_nm" ref="/root/resData/resform/incmg_pers_nm" editable="false" style="left:759px; top:38px; width:91px; height:20px; "/>
			<input id="srch_work_no" ref="/root/reqData/searchData/work_no" class="req" navindex="4" inputtype="button" format="999" caption="등록번호" style="left:515px; top:38px; width:71px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						open_mc_co_2070();
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						send_mc_budg_2081_l();
						if(get_refvalue("/root/resData/gridData/mc_budg_2081_l/dataSet/CURLIST/totalcnt") == "0"){
							use_dept_cd.value = "";
							use_dept_nm.value = "";
							datagrid_data_clear(datagrid3);
							default_grid();
							model.setFocus("srch_work_no");
						}else{
							use_dept_cd.value = get_refvalue("/root/resData/gridData/mc_budg_2081_l/dataSet/CURLIST/record/use_dept_cd");
							use_dept_nm.value = get_refvalue("/root/resData/gridData/mc_budg_2081_l/dataSet/CURLIST/record/if_buseonm_dtsybscd");
							send_mc_budg_2082_l();
						}		
					]]>
				</script>
			</input>
			<input id="input11" style="left:759px; top:8px; width:91px; height:20px; "/>
			<caption id="caption13" class="list_cap01" style="left:591px; top:5px; width:110px; height:25px; text-align:center; ">등록일자</caption>
			<caption id="caption14" class="list_cap02" style="left:700px; top:5px; width:155px; height:25px; text-align:center; "/>
			<input id="today" ref="/root/reqData/multiUpDate/today" editable="false" style="left:705px; top:8px; width:145px; height:18px; "/>
			<button id="srch_budg_yymm_up" class="input_plus" navindex="-1" style="left:213px; top:7px; width:9px; height:9px; ">
				<caption/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
		                       	change_yyyy(srch_budg_yymm,UPDOWN_UP);
		                       	reset_model(true);
		                       ]]>
				</script>
			</button>
			<button id="srch_budg_yymm_down" class="input_minus" navindex="-1" style="left:213px; top:16px; width:9px; height:9px; ">
				<caption/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
			                	change_yyyy(srch_budg_yymm,UPDOWN_DN);
			                	reset_model(true);
			                ]]>
				</script>
			</button>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:120px; width:926px; height:5px; "/>
		<group id="group2" class="gro_sel" style="left:10px; top:130px; width:926px; height:545px; ">
			<caption id="caption15" class="list_cap02" style="left:94px; top:250px; width:211px; height:25px; text-align:center; "/>
			<caption id="caption21" class="list_cap02" style="left:424px; top:0px; width:467px; height:25px; text-align:center; "/>
			<caption id="caption8" class="list_cap02" style="left:423px; top:29px; width:468px; height:25px; text-align:center; "/>
			<caption id="caption2" class="list_cap01" style="left:315px; top:29px; width:110px; height:25px; text-align:center; ">적  요</caption>
			<input id="rmks" ref="/root/reqData/multiUpDate/rmks" navindex="6" maxlength="64" style="left:429px; top:32px; width:457px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						set_refvalue("/root/tempData/rmks_chg", "J");
					]]>
				</script>
			</input>
			<select1 id="medi_cd" ref="/root/reqData/multiUpDate/medi_cd" class="req" navindex="5" appearance="minimal" editmode="inputsearch" style="left:429px; top:3px; width:160px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/mc_budg_2103_m/dataSet/CURLIST/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(medi_cd, medi_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(medi_cd,"");
							return;
						}
						set_refvalue("/root/tempData/medi_cd_chg","M");
					]]>
				</script>
			</select1>
			<caption id="caption20" class="list_cap01" style="left:315px; top:0px; width:110px; height:25px; text-align:center; ">매체코드</caption>
			<datagrid id="datagrid1" nodeset="/root/resData/resform/mc_budg_2080_m/dataSet/CURLIST/record" caption="예산코드^예산명" colsep="^" colwidth="87, 130" mergecellsfixedrows="bycolrec" rowsep="|" style="left:15px; top:0px; width:290px; height:240px; ">
				<col ref="budg_cd"/>
				<col ref="budg_nm"/>
				<script type="javascript" ev:event="ondblclick">
					<![CDATA[
						//그리드 스크롤바 클릭, 더블클릭 방지 소스
						if (-1 != event.target.lastIndexOf("scroll.thumb")) {
							return;
						}
						
						if (datagrid1.mouseRow < 1) {
							return;
						}
						
						var grid = eval(event.currentTarget);
						var rowid = grid.row;
						var colid = grid.col;
						
						if (rowid < grid.fixedRows || colid < grid.fixedCols) {
							return;
						}					
						if(datagrid1.rows > 1 && datagrid1.row != 0){
							srch_budg_cd.value = datagrid1.valueMatrix(datagrid1.row,0);
							budg_nm.value = datagrid1.valueMatrix(datagrid1.row,1);
							srch_work_no.value = "";

							medi_cd.disabled = check_medi_cd();
						}		
					]]>
				</script>
			</datagrid>
			<datagrid id="datagrid2" nodeset="/root/resData/gridData/mc_budg_2082_l/dataSet/CURLIST/record" caption="월^수량^단가^금액^jobtag^budg_yymm" colsep="^" colwidth="62, 110, 139, 142, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" subtotalposition="below" style="left:316px; top:60px; width:576px; height:465px; ">
				<col ref="month" style="background-color:#E3E3E3; "/>
				<col ref="req_qunt" type="input"/>
				<col ref="req_uprc" type="input"/>
				<col ref="req_amt" style="background-color:#EBEBEB; "/>
				<col ref="jobtag" visibility="hidden"/>
				<col ref="budg_yymm" visibility="hidden"/>
				<script type="javascript" ev:event="ondblclick">
					<![CDATA[
						//그리드 스크롤바 클릭, 더블클릭 방지 소스
						if (-1 != event.target.lastIndexOf("scroll.thumb")) {
							return;
						}
						
						if (datagrid2.mouseRow < 1) {
							return;
						}
						
						var grid = eval(event.currentTarget);
						var rowid = grid.row;
						var colid = grid.col;
						
						if (rowid < grid.fixedRows || colid < grid.fixedCols) {
							return;
						}					
						if(datagrid2.col == "2" || datagrid2.col == "3"){
							if(datagrid2.row != "13"){
								if(use_dept_cd.value != ""){
									datagrid2.isReadOnly(1,2,12,3) = false;
								}else{
									show_message("사용부서를 먼저 입력하세요.");
									model.setFocus("use_dept_cd");
								}
							}
						}		
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						grid_sum();
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keyCode == 22){
							grid_sum();
						}		
					]]>
				</script>
			</datagrid>
			<input id="use_dept_nm" ref="/root/resData/resform/use_dept_nm" editable="false" style="left:184px; top:253px; width:116px; height:18px; "/>
			<caption id="caption16" class="list_cap01" style="left:15px; top:250px; width:80px; height:25px; text-align:center; ">사용부서</caption>
			<input id="use_dept_cd" ref="/root/reqData/multiUpDate/use_dept_cd" class="req" navindex="7" inputtype="button" format="999999" style="left:99px; top:253px; width:82px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var var_con_date = "";

						if (srch_budg_yymm.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_budg_yymm.value.length;
							if(num_ch == 8){
								var_con_date = srch_budg_yymm.value;
							}else if(num_ch == 6){
								var_con_date = srch_budg_yymm.value + "01";
							}else if(num_ch == 4){
								var_con_date = srch_budg_yymm.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (use_dept_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
							model.setValue("/root/reqData/fwdData/dept_cd", use_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "I");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								use_dept_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								use_dept_cd.value = "";
								use_dept_nm.value = "";
							}
						}
						else {
							use_dept_cd.value = "";
							use_dept_nm.value = "";
						}	
//						open_mc_co_1010();	
						if(use_dept_cd.value == ""){
							datagrid2.isReadOnly(1,2,12,3) = true;
						}
					]]>
				</script>
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						var var_con_date = "";

						if (srch_budg_yymm.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_budg_yymm.value.length;
							if(num_ch == 8){
								var_con_date = srch_budg_yymm.value;
							}else if(num_ch == 6){
								var_con_date = srch_budg_yymm.value + "01";
							}else if(num_ch == 4){
								var_con_date = srch_budg_yymm.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "I");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
//						open_mc_co_1010();
					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[
						set_refvalue("/root/tempData/focusin",model.getFocus());		
					]]>
				</script>
			</input>
			<datagrid id="datagrid3" nodeset="/root/resData/gridData/mc_budg_2081_l/dataSet/CURLIST/record" caption="seq^부 서^부서명" colsep="^" colwidth="100, 87, 130" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:15px; top:280px; width:290px; height:245px; ">
				<col ref="seq" visibility="hidden"/>
				<col ref="use_dept_cd"/>
				<col ref="if_buseonm_dtsybscd"/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						use_dept_cd.value = datagrid3.valueMatrix(datagrid3.row,2);
						use_dept_nm.value = datagrid3.valueMatrix(datagrid3.row,3);
						if(datagrid3.mouseCol == 0 && datagrid3.mouseRow != 13){
							if(datagrid3.rowStatus(datagrid3.mouseRow) == "4"){
								datagrid3.removeStatus(datagrid3.mouseRow, "delete");
							}
							else if(datagrid3.rowStatus(datagrid3.mouseRow) == "0"){
								datagrid3.addStatus(datagrid3.mouseRow, "delete");
							}
						}
					]]>
				</script>
			</datagrid>
		</group>
		<button id="button3" class="btn04" style="left:235px; top:684px; width:90px; height:21px; ">
			<caption>등록내역조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					open_mc_co_2070();
				]]>
			</script>
		</button>
		<button id="btn_insert" class="btn02" crud="C" style="left:70px; top:684px; width:52px; height:21px; ">
			<caption>저장</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					send_mc_budg_2083_i();
				]]>
			</script>
		</button>
		<button id="btn_select" class="btn02" crud="R" style="left:15px; top:685px; width:52px; height:21px; ">
			<caption>조회</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					send_mc_budg_2082_l();
				]]>
			</script>
		</button>
		<button id="btnReset" class="btn02" style="left:180px; top:684px; width:52px; height:21px; ">
			<caption>초기화</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					model.reset();
					default_grid();
				]]>
			</script>
		</button>
		<button id="button7" class="btn04" style="left:325px; top:684px; width:90px; height:21px; ">
			<caption>예산서 출력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
		                    //필수항목체크(검색)
		                    if(!checkref(srch_budg_yymm)) {
		                        return false;
		                    }
		                    if(!checkref(srch_dept_cd)) {
		                        return false;
		                    }
		                    
		                    // ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)
		                    makeNodeValue("/root/oz_data/ozrName","fcmc/SP_MC_BUDG_2150_P");
		                    
		                    // odi 파라미터 설정.
		                    makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd",getProperty("ss_cmpycd"));
		                    makeNodeValue("/root/oz_data/odiParam/iv_budg_yymm", srch_budg_yymm.value);
		                    makeNodeValue("/root/oz_data/odiParam/iv_in_tag", "1");
		                    makeNodeValue("/root/oz_data/odiParam/iv_dept_cd", srch_dept_cd.value);
		                    makeNodeValue("/root/oz_data/odiParam/iv_dept_bulen", "6");
		                    makeNodeValue("/root/oz_data/odiParam/iv_budg_yymm1", srch_budg_yymm.value);
		
		                    // 레포트뷰어 호출.
		                    openOzwin("/root/oz_data");
		                ]]>
			</script>
		</button>
		<button id="btn_delete" class="btn02" crud="D" style="left:125px; top:684px; width:52px; height:21px; ">
			<caption>삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					send_mc_budg_2084_d();
				]]>
			</script>
		</button>
		<button id="button14" class="btn02" style="left:416px; top:685px; width:52px; height:21px; ">
			<caption>도움말</caption>
		</button>
		<button id="button8" class="btn02" style="left:470px; top:684px; width:52px; height:21px; ">
			<caption>종료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					formClose();
				]]>
			</script>
		</button>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
	</xhtml:body>
</xhtml:html>
