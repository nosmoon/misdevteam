<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title/>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session/>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
							<mc_budg_2070_m>
								<dataSet>
									<CURLIST1>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURLIST1>
									<CURLIST2>
										<record>
											<cmpy_cd/>
											<max_yy/>
										</record>
									</CURLIST2>
								</dataSet>
							</mc_budg_2070_m>
							<evnt_yyyy>
								<record>
									<label/>
									<value/>
								</record>
							</evnt_yyyy>
							<evnt_seq>
								<record>
									<label/>
									<value/>
								</record>
							</evnt_seq>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData>
							<mc_budg_2073_l>
								<evnt_cd/>
								<evnt_nm/>
								<cd_gubun/>
								<from_cd/>
								<to_cd/>
								<bgn_dt/>
								<last_dt/>
							</mc_budg_2073_l>
						</fwdData>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<budg_yymm/>
							<emp_no/>
							<emp_nm/>
							<budg_cd/>
							<budg_nm/>
							<dept_cd/>
							<abrv_nm/>
							<work_no/>
							<evnt_cd/>
							<evnt_cd2/>
							<evnt_seq/>
							<evnt_yyyy/>
							<evnt_nm/>
							<medi_cd/>
							<rmks/>
							<year_amt_tot/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqform/>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpDate>
							<tag/>
							<budg_yy/>
							<budg_cd/>
							<dept_cd/>
							<evnt_cd/>
							<work_no/>
							<medi_cd/>
							<rmks/>
							<chg_pers/>
							<dtls_medi_cd/>
						</multiUpDate>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resform>
						</resform>
						<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<gridData>
							<mc_budg_1002_l>
								<dataSet>
									<CURLIST>
										<record>
											<mang_item_cd/>
											<mang_item_nm/>
											<mang_item_val/>
											<acct_yn/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_1002_l>
							<mc_budg_2071_l>
								<dataSet>
									<CURLIST1>
										<record>
											<cmpy_cd/>
											<budg_yymm/>
											<budg_cd/>
											<dept_cd/>
											<evnt_cd/>
											<work_no/>
											<rmks/>
											<medi_cd/>
											<dtls_medi_cd/>
											<dtls_medi_cd_nm/>
										</record>
									</CURLIST1>
									<CURLIST2>
										<record>
											<budg_yy/>
											<medi_cd/>
											<rmks/>
											<work_no/>
											<seq/>
											<use_dept_cd/>
											<abrv_nm/>
											<budg_yymm01/>
											<budg_yymm02/>
											<budg_yymm03/>
											<budg_yymm04/>
											<budg_yymm05/>
											<budg_yymm06/>
											<budg_yymm07/>
											<budg_yymm08/>
											<budg_yymm09/>
											<budg_yymm10/>
											<budg_yymm11/>
											<budg_yymm12/>
											<req_amt_tot/>
											<jobtag/>
										</record>
									</CURLIST2>
								</dataSet>
							</mc_budg_2071_l>
							<mc_budg_2072_l>
								<dataSet>
									<CURLIST1>
										<record>
											<cmpy_cd/>
											<dept_cd/>
											<budg_type_cd/>
											<budg_cd/>
											<budg_nm/>
										</record>
									</CURLIST1>
								</dataSet>
							</mc_budg_2072_l>
							<mc_budg_2073_l>
								<dataSet>
									<CURLIST1>
										<record>
											<evnt_cd/>
											<evnt_nm/>
											<bgn_dt/>
											<last_dt/>
											<supv_dept_cd/>
											<supv_dept_nm/>
											<emp_no/>
											<emp_nm/>
										</record>
									</CURLIST1>
								</dataSet>
							</mc_budg_2073_l>
						</gridData>
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
						<rcvData>
						</rcvData>
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<keyData/>
						<amt_set/>
						<mc_budg_2071_l>
							<dataSet/>
						</mc_budg_2071_l>
						<fc_co_1101_l>
							<dataSet>
								<CURLIST1>
									<record>
										<cmpy_cd/>
										<dept_cd/>
										<dept_team_clsf/>
										<abrv_nm/>
										<offi_nm/>
										<dept_team_nm/>
										<part_nm/>
										<part_dn_nm/>
									</record>
								</CURLIST1>
							</dataSet>
						</fc_co_1101_l>
						<medi_cd_chg/>
						<rmks_chg/>
						<totalcount/>
						<dtls_medi_cd_chg/>
					</tempData>
					<!-- 저장소 -->
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
				//컨트롤 초기화
				init_controls();
				
				//콤보데이터 조회
				send_mc_budg_2070_m();
				
				//datagrid 컬럼 재 설정
				set_column_visibility();
				default_grid();
				
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					ss_cmpy_cd = getProperty("ss_cmpycd");
					if(ss_cmpy_cd == "500"){
						dtls_medi_cd.visible = true;
						dtls_medi_cd_nm.visible = true;
						caption30.visible = true;
					}else{						
						dtls_medi_cd.visible = false;
						dtls_medi_cd_nm.visible = false;
						caption30.visible = false;
					}
				]]>
			</script>
			<submission id="mc_budg_2070_m" action="/mc/budg2000/2070" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" resultref="/root/initData/comboSet/mc_budg_2070_m/dataSet"/>
			<submission id="mc_budg_2071_l" action="/mc/budg2000/2071" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData"/>
			<submission id="mc_budg_2072_l" action="/mc/budg2000/2072" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/mc_budg_2072_l/dataSet"/>
			<submission id="mc_budg_2073_l" action="/mc/budg2000/2073" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/fwdData/mc_budg_2073_l" resultref="/root/resData/gridData/mc_budg_2073_l/dataSet"/>
			<submission id="mc_budg_2076_i" action="/mc/budg2000/2076" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="mc_budg_2077_d" action="/mc/budg2000/2077" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="fc_co_1101" action="/fc/co1000/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/fc_co_1101_l/dataSet"/>
		</model>
		<script type="javascript" src="../../../js/TFCommon.js"/>
		<script type="javascript" src="../../../js/CIISComm.js"/>
		<script type="javascript" src="../../../js/fcmc_common.js"/>
		<script type="javascript">
			<![CDATA[
			//-------------------------------------------------------------------------------
			//	컨트롤의 기본 설정 적용 및 컨트롤 별 포맷 적용
			//-------------------------------------------------------------------------------
			function init_controls() {
				//control의 기본 설정 적용
				
				//datagrid init
				set_default(
						"it was comment field"
					,	datagrid1
					,	datagrid2
				);
				
				datagrid1.attribute("extendlastcol")	=	BOOLEAN_TRUE;
				datagrid1.attribute("autoresize")		=	BOOLEAN_TRUE;
		
				//combo init
				set_default(
						"it was comment field"
					,	srch_evnt_yyyy
					,	srch_evnt_seq
					,	srch_work_no
					,	medi_cd
				);
				//input init
				set_default(
						"it was comment field"
					,	srch_abrv_nm
					,	srch_emp_no
					,	srch_budg_yy
					,	srch_emp_nm
					,	srch_budg_cd
					,	srch_budg_nm
					,	srch_evnt_nm
					,	year_amt_tot
				);
				//input button init
				set_default(
						"it was comment field"
					,	srch_dept_cd
					,	srch_evnt_cd
				);
				//input date init
				set_default(
						"it was comment field"
				);

				//control format 설정 적용
				set_format(
						"code"						//코드포맷,중간정렬,중간정렬
					,	datagrid1		,"1,2,3,4,5"			//회사코드,코드,팀부서구분,예산코드
					,	datagrid2		,"1,2,4,5,6"			//예산년도,매체코드,등록번호,순번,사용부서
					,	srch_dept_cd					//부서코드
					,	srch_emp_no					//등록자
					,	srch_budg_cd					//예산코드
					,	srch_evnt_cd					//행사코드
					,	srch_work_no					//등록번호
					,	srch_evnt_seq					//회차
					,	medi_cd						//매체코드
				);
				set_format(
						"number3"						//양수음수 금액,우측정렬,중간정렬
					,	year_amt_tot
					,	datagrid2,		"8,9,10,11,12,13,14,15,16,17,18,19,20"	//1,2,3,4,5,6,7,8,9,10,11,12월,합계
				);
				set_format(
						"number5"						//양수 금액,우측정렬,중간정렬
				);
				set_format(
						"rate_1"						//비율포맷,우측정렬,중간정렬
				);
				set_format(
						"date_320"						//날짜포맷,중간정렬,중간정렬
					,	srch_budg_yy					//예산년도
					,	srch_evnt_yyyy					//행사년도
				);
				set_format(
						"string_c"						//포맷없음,중간정렬,중간정렬
					,	srch_emp_nm					//등록자명
				);
				set_format(
						"string_l"						//포맷없음,좌측정렬,중간정렬
					,	datagrid1		,"6"				//예산명
					,	datagrid2		,"3,7"				//적요,부서명
					,	srch_abrv_nm					//부서코드명
					,	srch_budg_nm					//예산코드명
					,	srch_evnt_nm					//행사명
					,	rmks							//적요
				);
				
				set_refvalue(srch_emp_no,model.property("ss_emp_no"));
				set_refvalue(srch_emp_nm,model.property("ss_emp_nm"));
				default_grid();
			}
			
			// 그리드 초기화 //
			function default_grid(){
				datagrid1.clearStatus();
				datagrid_data_clear(datagrid2);
				year_amt_tot.value = "";
				rmks.value = "";
				for (i = 1 ; i < 11 ; i++){
					datagrid2.addRow(false);
					datagrid2.rowStatus(i) = "1";
				}
				datagrid2.isReadOnly(1,8,10,19) = true;
			}
			
			//-------------------------------------------------------------------------------
			//	datagrid의 컬럼 설정
			//-------------------------------------------------------------------------------
			function set_column_visibility() {
				//모든 컬럼을 감춘다.
				hide_all_columns(datagrid1);
				//공통항목을 보여준다.
				//show_columns(datagrid1,"0,1,2");
				show_columns(datagrid1,"4,5");
				
				//모든 컬럼을 감춘다.
				hide_all_columns(datagrid2);
				//공통항목을 보여준다.
				//show_columns(datagrid2,"1,2,3,4,5,20");
				show_columns(datagrid2,"6,7,8,9,10,11,12,13,14,15,16,17,18,19");
			}
			
			//-------------------------------------------------------------------------------
			//	조회 값 체크
			//	p_siud		"s","i","u","d"로 호출하는 동작을 명세한다.
			//-------------------------------------------------------------------------------			
			function check_search_values(p_siud) {
				//필수항목체크(검색)
				if(!commReqCheck(group_searches)) {
					return false;
				}
				
				//조회,입력,수정,삭제에 따라 입력값 검증 처리
				switch (p_siud.toUpperCase()) {
					case "S":
						//조회시
						
						break;
					case "I":
						//입력시
						
						break;
					case "U":
						//수정시
						
						break;
					case "D":
						//삭제시
						
						break;
					default:
						show_message("key 값 확인을 위한 구분자가 지정되지 않았습니다.");
						break;
				}
				
				return true;
			}
			
			//-------------------------------------------------------------------------------
			//	입력값 체크
			//	p_siud		"s","i","u","d"로 호출하는 동작을 명세한다.
			//-------------------------------------------------------------------------------
			function check_input_values(p_siud) {
				//필수항목체크(내용)
				if (!commReqCheck(group_contents)) {
					return false;
				}
				//필수항목체크(grid);
				if(!commGridReqCheck("datagrid1")) {
					return false;
				}
					
				//선택적필수항목체크
				
				//유효성체크

				//조회,입력,수정,삭제에 따라 입력값 검증 처리
				switch (p_siud.toUpperCase()) {
					case "S":
						//조회시
						
						break;
					case "I":
						//입력시
						
						break;
					case "U":
						//수정시
						
						break;
					case "D":
						//삭제시
						
						break;
					default:
						show_message("key 값 확인을 위한 구분자가 지정되지 않았습니다.");
						break;
				}
				
				return true;
			}
			
			//-------------------------------------------------------------------------------
			//	키값 체크
			//	p_siud		"s","i","u","d"로 호출하는 동작을 명세한다.
			//-------------------------------------------------------------------------------
			function check_key_values(p_siud) {
				//키값의 변경 여부
				var key_flag = false;
				//키값 변경 여부에 따른 메시지
				var key_msg = "";
				
				//체크할 키 값들의 이전 값을 instance나 control에서 가져온다.
				var prev_key			=	"prev";
				
				//체크할 키 값들의 현재 값을  instance나 control에서 가져온다.
				var curr_key			=	"curr";
								
				//이전 키값과 현재 조회창에 입력된 값을 비교하여 키값의 변경 여부를 확인				
				if (
						prev_key	==	curr_key
				) {					
					//키값이 변경되지 않은 경우
					key_flag = true;
				}
				else {
					//키값이 변경 된 경우
					key_flag = false;
				}
				
				//조회,입력,수정,삭제에 따라 키 값의 변경에 따른 처리
				switch (p_siud.toUpperCase()) {
					case "S":
						//조회시
						
						break;
					case "I":
						//입력시

						break;
					case "U":
						//수정시
						
						break;
					case "D":
						//삭제시
						
						break;
					default:
						show_message("key 값 확인을 위한 구분자가 지정되지 않았습니다.");
						break;
				}

				//키 값이 변경되었을 경우 메시지를 보여준다.
				if (!key_flag) check_reqItem("","none","none",key_msg);	
				
				//키 값의 변경 여부를 반환
				return key_flag;
			}
			
			//-------------------------------------------------------------------------------
			//	모델 리셋
			//-------------------------------------------------------------------------------
			function reset_model(p_save) {
				//p_save가 true인 경우 기존 값을 백업하고 다시 복원시킨다.
				//데이터 백업
				var srch_budg_yy_var = srch_budg_yy.value;
				var srch_dept_cd_var = srch_dept_cd.value;
				var srch_abrv_nm_var = srch_abrv_nm.value;
				//모델 리셋
				model.reset();
				medi_cd.disabled = false;
				default_grid();
				//데이터 복원
				if (p_save) {
					srch_budg_yy.value = srch_budg_yy_var;
					srch_dept_cd.value = srch_dept_cd_var;
					srch_abrv_nm.value = srch_abrv_nm_var;
				}
				//데이터 복원 후 필요한 추가 작업
				
			}
			
			function send_mc_budg_2070_m() {
				//submission 이름 지정 및 관련 변수 설정
				var subid1 = "mc_budg_2070_m";
				var subref1 = eval(subid1).attribute("ref");
				var subresultref1 = eval(subid1).attribute("resultref");
				
				//입력값 설정
				
				//실행
				model.send(subid1);
				
				//데이터 설정
				set_refvalue(srch_budg_yy,get_refvalue(subresultref1 + "/CURLIST2/record/max_yy"));
				
				//전체항목 추가	
				makeComboGubun("", "/root/initData/comboSet/mc_budg_2070_m/dataSet/CURLIST1","record", "cdabrvnm_cd", "cd");
			}
			
			// 부서조회 팝업 //
//			function open_mc_co_1010() {
//				var popid = "mc_co_1010";
//				var rcvs_flag = false;
//				
//				var req_dept_cd = "";
//				var res_dept_cd = "";
//				var res_abrv_nm = "";
//				
//				//두 곳 이상에서 호출을 할 경우 상황에 맞는 값 설정
//				if (event != null && event.currentTarget == "srch_dept_cd") {
//					var obj = srch_dept_cd;
//					req_dept_cd = get_refvalue(obj);
//				}
//				else if (event != null && event.currentTarget == "datagrid2") {
//					var obj = datagrid2;
//					req_dept_cd = obj.valueMatrix(obj.row,obj.col);
//				}
//				else {
//					req_dept_cd = "";
//				}
//				
//				if (event != null && event.name == "xforms-value-changed") {
//					//값이 변경되면 기존에 조회된 자료를 모두 제거한다.
//					reset_popup_rcvs_data(popid);
//				}
//
//				set_popup_send_data(popid,"mode","sr");
//				set_popup_send_data(popid,"title","");
//				set_popup_send_data(popid,"readonly","0");
//				set_popup_send_data(popid,"datafilter","");				
//				set_popup_send_data(popid,"dept_cd",req_dept_cd);
//				set_popup_send_data(popid,"require","dept_cd");	
//				
//				rcvs_flag = call_mc_co_1010(false);
//				if (rcvs_flag) {
//					//정상처리
//				}
//				else {
//					//취소버튼을 누른 경우 조회 조회를 위한 값과 조회된 값이 틀린 경우 기존 값을 모두 제거한다.
//				}
//				
//				//value-changed 와 buttonclick이 동시 발생했을 경우
//				//이하 코드는 두번씩 실행되므로 무거운 코드는 넣지 않도록 하자
//				res_dept_cd = get_popup_rcvs_data(popid,"dept_cd");
//				res_abrv_nm = get_popup_rcvs_data(popid,"abrv_nm");
//
//				//두 곳 이상에서 호출을 할 경우 상황에 맞는 값 설정
//				if (event != null && event.currentTarget == "srch_dept_cd") {
//
//					var obj = srch_dept_cd;
//					//만약  value-changed 이벤트이면서 결과값이 없는 경우면 현재 값과 현재값에 종속되는 모든 값을 삭제한다.
//					if (event != null && event.name == "xforms-value-changed" && !rcvs_flag) {
//						//value-changed->buttonclick 이벤트 흐름을 탄 경우 이미 값은 지워진 공백이므로
//						//더 이상 메시지를 보여줄 필요가 없다.
//						if (get_refvalue(srch_dept_cd) != "") {
//							//show_message("사용가능한 부서코드가 아닙니다");
//						}
//						//부서가 변경되면 고유행사코드는 삭제한다.
//						//단 부서의 앞 2자리가 같은 경우 제외
//						//입력값에 대한 oldValue와 currentText는 input에만 있으므로 조회하는 컨트롤이 input 컨트롤이라고 가정한다.
//						//현재값이 공백이어도 변경 처리
//						set_refvalue(srch_dept_cd,"");
//						set_refvalue(srch_evnt_cd,"");
//						set_refvalue(srch_budg_cd,"");
//						set_refvalue(srch_budg_nm,"");
//						datagrid_data_clear(datagrid1);
//						combo_data_clear(srch_evnt_yyyy);
//						combo_data_clear(srch_evnt_seq);
//						set_refvalue(srch_evnt_nm,"");
//						set_refvalue(srch_abrv_nm,"");
//					}
//					if(res_dept_cd != ""){
//						reset_model(true);
//						set_refvalue(srch_dept_cd,res_dept_cd);
//						set_refvalue(srch_abrv_nm,res_abrv_nm);
//					}
//				}
//				else if (event != null && event.currentTarget == "datagrid2") {
//					var obj = datagrid2;
//					if (event != null && event.name == "xforms-value-changed" && !rcvs_flag) {
//						//value-changed->buttonclick 이벤트 흐름을 탄 경우 이미 값은 지워진 공백이므로
//						//더 이상 메시지를 보여줄 필요가 없다.
//						obj.valueMatrix(obj.row,obj.col) = "";
//						//보통 조회하는 값에 대한 추가되는 값들은 조회 컬럼 뒤에 위치하기 때문에 + n 형태로 처리하자
//						obj.valueMatrix(obj.row,obj.col+1) = "";
//					}
//					if(res_dept_cd != ""){
//						obj.valueMatrix(obj.row,obj.col) = res_dept_cd;
//						obj.valueMatrix(obj.row,obj.col+1) = res_abrv_nm;
//					}
//					//recalc_req_amt();
//				}
//
//				return rcvs_flag;
//			}
			var ch_grid = false;
			function setDept_cd(iv_dept_cd, iv_dept_nm, iv_dept_team_clsf, iv_offi_nm, iv_dept_team_nm, iv_part_nm, iv_part_dn_nm){	
				 if (ch_grid) {
					var obj = datagrid2;
					if (iv_dept_cd == "") {
						obj.valueMatrix(obj.row,obj.col) = "";
						obj.valueMatrix(obj.row,obj.col+1) = "";
					}else{
						obj.valueMatrix(obj.row,obj.col) = iv_dept_cd;
						obj.valueMatrix(obj.row,obj.col+1) = iv_dept_nm;
					}
				}else{
					model.setValue("/root/reqData/searchData/dept_cd", iv_dept_cd);
					model.setValue("/root/reqData/searchData/abrv_nm", iv_dept_nm);
					srch_dept_cd.refresh();
					srch_abrv_nm.refresh();
					
					if(srch_dept_cd.value != ""){
						send_mc_budg_2072_l();
					}
				}
			}
			
			// 등록번호 조회 팝업 //
			function open_mc_co_2070(){
				model.property("MC_CO_2070_srch_budg_yyyy") =  srch_budg_yy.value;
				model.property("MC_CO_2070_srch_dept_cd") =  srch_dept_cd.value;
				model.property("MC_CO_2070_srch_budg_cd") =  srch_budg_cd.value;
				model.property("MC_CO_2070_srch_budg_type_cd") = "01";
											
				model.property("MC_CO_2070_popup_flag")  = "Y";

				viewer("mainFrame").window.javaScript.onLoadPopupPageEx("MC_CO_2070", "modal", "align:center; caption:hidden; width:650px; height:480px;");
				
				if(model.property("MC_CO_2070_budg_cd") != ""){
					srch_work_no.value = model.property("MC_CO_2070_work_no");
				}
			}
			
			function open_mc_co_1020() {
				var popid = "mc_co_1020";
				var rcvs_flag = false;

				if (!check_reqItem(srch_dept_cd,"trim","focus","부서코드를 먼저 조회하세요.")) {return false;}
				if (!check_reqItem(srch_abrv_nm,"trim",srch_dept_cd,"부서코드 조회가 되지 않았습니다. 부서코드를 먼저 조회하세요.")) {return false;}

				if (event != null && event.name == "xforms-value-changed") {
					//값이 변경되면 기존에 조회된 자료를 모두 제거한다.
					reset_popup_rcvs_data(popid);
				}
				
				set_popup_send_data(popid,"mode","sr");
				set_popup_send_data(popid,"title","고유행사코드조회");
				set_popup_send_data(popid,"readonly","0");
				set_popup_send_data(popid,"datafilter","");	
				//행사코드조회
				set_popup_send_data(popid,"searchid","16");
				set_popup_send_data(popid,"msg","[" + srch_abrv_nm.value + "] 부서에서 등록한 예산행사코드만이 조회됩니다.");
				//부서코드가 정상적으로 조회된 경우에만 처리해야 함
				set_popup_send_data(popid,"dept_cd",srch_dept_cd.value);
				set_popup_send_data(popid,"cd","G"+srch_evnt_cd.value);
				set_popup_send_data(popid,"cdnm","");
				
				set_popup_send_data(popid,"require","cd");	

				var codeheader = get_popup_send_data(popid,"dept_cd").substr(0,2);
				set_popup_send_data(popid,"from_cd", codeheader + "0000");
				set_popup_send_data(popid,"to_cd", codeheader + "9999");
				set_popup_send_data(popid,"bgn_dt", "00000000");
				set_popup_send_data(popid,"last_dt", "99999999");
				
				rcvs_flag = call_mc_co_1020("mc_co_1005_l","CURLIST",false);
				if (rcvs_flag) {
					//정상처리
				}
				else {
					//취소버튼을 누른 경우 조회 조회를 위한 값과 조회된 값이 틀린 경우 기존 값을 모두 제거한다.
				}
				
				//value-changed 와 buttonclick이 동시 발생했을 경우
				//이하 코드는 두번씩 실행되므로 무거운 코드는 넣지 않도록 하자
				
				//만약  value-changed 이벤트이면서 결과값이 없는 경우면 현재 값과 현재값에 종속되는 모든 값을 삭제한다.
				if (event != null && event.name == "xforms-value-changed" && !rcvs_flag) {
					if (get_refvalue(srch_evnt_cd) != "") {
						//show_message("해당 부서에서 등록한 행사코드가 존재하지 않습니다");
					}
					//고유행사코드의 경우 정확한 값이 아닌 G이후 3자리만 선별적으로 가져오는 경우라서
					//value-changed 인 경우 항상 값이 없다
					//따라서 자리수가 3자리 이면 올바른 값이라고 가정한다.
					if (get_refvalue(srch_evnt_cd).length != 3) {
						set_refvalue(srch_evnt_cd,"");
					}
					else {
						//정상적으로 3자리인경우
						//정상 처리된것 처럼 플래그를 설정한다.
						//true 처리어야지 뒤에 행사년도를 가져옴둥
						rcvs_flag = true;
					}
					combo_data_clear(srch_evnt_yyyy);
					combo_data_clear(srch_evnt_seq);
					set_refvalue(srch_evnt_nm,"");
				}
				
				//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
				//다시 조회 하기 쉽도록 하고

				if (get_popup_rcvs_data(popid,"cd") != "") {
					var evnt_cd = get_popup_rcvs_data(popid,"cd").substr(5,3);
					set_refvalue(srch_evnt_cd,evnt_cd);
				}
				//그외의 값은 지워지도록 한다.
				
				return rcvs_flag;
			}
			
			function prepare_mc_budg_2072_l() {
				if (!check_reqItem(srch_dept_cd,"trim",srch_dept_cd,srch_dept_cd)) {return false;}
				
				return true;
			}
			
			function send_mc_budg_2072_l() {
				//조건에 문제가 없다면 처리
				if (!prepare_mc_budg_2072_l()) {
					return false;
				}

				//submission 이름 지정 및 관련 변수 설정
				var subid1 = "mc_budg_2072_l";
				var subref1 = eval(subid1).attribute("ref");
				var subresultref1 = eval(subid1).attribute("resultref");
				var subid1_cur1 = "CURLIST1";
				var subid1_cur2 = "CURLIST2";
				var totalcnt = 0;
			
				//입력값 설정
				//set_refvalue(subref1 + "/budg_type_cd","01");
				set_refvalue(subref1 + "/budg_type_cd","01");

				//실행
				model.send(subid1);
				
				//조회 건수 확인
				totalcnt = get_refvalue(subresultref1 + "/" + subid1_cur1 + "/totalcnt");
				
				//조회가 0건인 경우 초기화 시키고 메시지 출력
				if (totalcnt == 0) {
					//reset_model(true);
					//show_message("검색결과가 없습니다.");
					return false;
				}
			}
			
			function find_budg_cd_in_grid(p_obj) {
				if (!check_reqItem(srch_dept_cd,"trim","focus","부서코드를 먼저 조회하세요.")) {return  (false);}
				if (!check_reqItem(srch_abrv_nm,"trim",srch_dept_cd,"부서코드 조회가 되지 않았습니다. 부서코드를 먼저 조회하세요.")) {return  (false);}

				var obj = eval(p_obj);
				var budg_cd_id = obj.colRef("budg_cd");
				var budg_nm_id = obj.colRef("budg_nm");
				var budg_row = obj.findRow(get_refvalue(srch_budg_cd),obj.fixedRows,budg_cd_id, true, true);
				var medi_cd_flag = false;
				var return_value = false;

				if (budg_row >= obj.fixedRows) {
					set_refvalue(srch_budg_cd,obj.valueMatrix(budg_row,budg_cd_id));
					set_refvalue(srch_budg_nm ,obj.valueMatrix(budg_row,budg_nm_id));
					return_value = true;
					medi_cd_flag = check_medi_cd_enable(get_refvalue(srch_budg_cd));
					obj.row = budg_row;
					obj.col = budg_cd_id;
					obj.topRow = budg_row;
				}
				else {
					set_refvalue(srch_budg_nm ,"");
					return_value = false;
				}
				
				medi_cd.disabled = !medi_cd_flag;
				
				return (return_value);
			}
			
			function check_medi_cd_enable(p_budg_cd) {
				var subid1 = "mc_budg_1002_l";
				var cur1 = "CURLIST";
				var subref1 = "/root/reqData/searchData";
				var subresultref1 = "/root/resData/gridData/mc_budg_1002_l/dataSet";
				var action1 = "/mc/budg1000/1002";
				var recref1 = subresultref1 + "/" + cur1 + "/" + "record";
				var return_value = false;
								
				send_submission(
						"auto_" + subid1
					,	subref1
					,	subresultref1
					,	action1
					,	"urlencoded-post"
					,	"application/x-www-form-urlencoded"
				);
				
				if (submit_completed()) {
					if (model.getXPathValue("count(" + recref1 + "[mang_item_cd='03']" + ")") > 0) {
						return_value = true;
					}
				
				}
				return return_value;
			}
			
			function fill_evnt_yyyy() {
				//submission 이름 지정 및 관련 변수 설정
				var subid1 = "mc_budg_2073_l";
				var subref1 = eval(subid1).attribute("ref");
				var subresultref1 = eval(subid1).attribute("resultref");
				var subid1_cur1 = "CURLIST1";
				var totalcnt = 0;
				
				var tobj = srch_evnt_yyyy;
				
				set_refvalue(subref1 + "/" + "evnt_cd",srch_evnt_cd.value);
				set_refvalue(subref1 + "/" + "evnt_nm","");
				set_refvalue(subref1 + "/" + "cd_gubun","=");
				set_refvalue(subref1 + "/" + "from_cd","000000");
				set_refvalue(subref1 + "/" + "to_cd","999999");
				set_refvalue(subref1 + "/" + "bgn_dt","00000000");
				set_refvalue(subref1 + "/" + "last_dt","99999999");

				reset_refnode(subresultref1);
				model1.send(subid1);
				
				totalcnt = model.getValue(subresultref1 + "/" + subid1_cur1 + "/totalcnt");
				
				var dept_cd_h = get_refvalue(srch_dept_cd).substr(0,2);
				
				combo_data_clear(tobj);
				
				var temp_supv_dept_cd_h = "";
				var temp_evnt_cd = "";
				var temp_evnt_yyyy = "";
				var temp_evnt_seq = "";

				for(var i = 1;i <= totalcnt;i++) {
					var noderef = subresultref1 + "/" + subid1_cur1 + "/" + "record" + "[" + i + "]" + "/";
					temp_supv_dept_cd_h = get_refvalue(noderef + "supv_dept_cd").substr(0,2);
					temp_evnt_cd = get_refvalue(noderef + "evnt_cd");
					temp_evnt_yyyy = temp_evnt_cd.substr(0,4);
					temp_evnt_seq = temp_evnt_cd.substr(temp_evnt_cd.length - 2,2);
				
					if (temp_supv_dept_cd_h == dept_cd_h) {
						combo_data_add(tobj,temp_evnt_yyyy,temp_evnt_yyyy,false,false);
					}
				}
				
				tobj.refresh();
				tobj.select(0);
				tobj.dispatch("xforms-value-changed");
			}
			
			function fill_evnt_seq() {
				//submission 이름 지정 및 관련 변수 설정
				var subid1 = "mc_budg_2073_l";
				var subref1 = eval(subid1).attribute("ref");
				var subresultref1 = eval(subid1).attribute("resultref");
				var subid1_cur1 = "CURLIST1";
				var totalcnt = 0;
				
				var tobj = srch_evnt_seq;
				
				set_refvalue(subref1 + "/" + "evnt_cd",srch_evnt_yyyy.value + "G" + srch_evnt_cd.value);
				set_refvalue(subref1 + "/" + "evnt_nm","");
				set_refvalue(subref1 + "/" + "cd_gubun","=");
				set_refvalue(subref1 + "/" + "from_cd","000000");
				set_refvalue(subref1 + "/" + "to_cd","999999");
				set_refvalue(subref1 + "/" + "bgn_dt","00000000");
				set_refvalue(subref1 + "/" + "last_dt","99999999");

				reset_refnode(subresultref1);
				model1.send(subid1);
				
				totalcnt = model.getValue(subresultref1 + "/" + subid1_cur1 + "/totalcnt");
				
				var dept_cd_h = get_refvalue(srch_dept_cd).substr(0,2);
				
				combo_data_clear(tobj);
				
				var temp_supv_dept_cd_h = "";
				var temp_evnt_cd = "";
				var temp_evnt_yyyy = "";
				var temp_evnt_seq = "";

				for(var i = 1;i <= totalcnt;i++) {
					var noderef = subresultref1 + "/" + subid1_cur1 + "/" + "record" + "[" + i + "]" + "/";
					temp_supv_dept_cd_h = get_refvalue(noderef + "supv_dept_cd").substr(0,2);
					temp_evnt_cd = get_refvalue(noderef + "evnt_cd");
					temp_evnt_yyyy = temp_evnt_cd.substr(0,4);
					temp_evnt_seq = temp_evnt_cd.substr(temp_evnt_cd.length - 2,2);
				
					if (temp_supv_dept_cd_h == dept_cd_h) {
						combo_data_add(tobj,temp_evnt_seq,temp_evnt_seq,false,false);
					}
				}
				
				tobj.refresh();
				tobj.select(0);
				tobj.dispatch("xforms-value-changed");
			}
			function set_evnt_nm() {
				//submission 이름 지정 및 관련 변수 설정
				var subid1 = "mc_budg_2073_l";
				var subref1 = eval(subid1).attribute("ref");
				var subresultref1 = eval(subid1).attribute("resultref");
				var subid1_cur1 = "CURLIST1";
				var totalcnt = 0;
				var temp_evnt_nm = "";
				
				var temp_evnt_cd = srch_evnt_yyyy.value + "G" + srch_evnt_cd.value + srch_evnt_seq.value;
				
				try{
					temp_evnt_nm = instance1.selectSingleNode(subresultref1 + "/" + subid1_cur1 + "/" + "record" + "[evnt_cd='" + temp_evnt_cd + "']/evnt_nm").value;
					set_refvalue(srch_evnt_nm,temp_evnt_nm);
				}
				catch(e){
					set_refvalue(srch_evnt_nm,temp_evnt_nm);
				}	
				
			}
			function prepare_mc_budg_2071_l() {
				if(!check_search_values("s")) {
					return false;
				}
				
				return true;
			}
			
			// 조회 //
			function send_mc_budg_2071_l() {
				//조건에 문제가 없다면 처리
				if (!prepare_mc_budg_2071_l()) {
					return false;
				}
				
				datagrid1.clearStatus();
				
				set_refvalue("/root/tempData/medi_cd_chg","");
				set_refvalue("/root/tempData/rmks_chg","");
				set_refvalue("/root/tempData/totalcount","");
				set_refvalue("/root/tempData/dtls_medi_cd_chg","");
				
				if(model.getFocus() == "btn_insert"){
					mc_budg_2071_l.attribute("resultref") = "/root/tempData/mc_budg_2071_l/dataSet";
				}else{
					datagrid_data_clear(datagrid2);
					mc_budg_2071_l.attribute("resultref") = "/root/resData/gridData/mc_budg_2071_l/dataSet";
				}

				if (fn_cmpcMgmt(srch_dept_cd.value) == false) { return; }				
				//submission 이름 지정 및 관련 변수 설정
				var subid1 = "mc_budg_2071_l";
				var subref1 = eval(subid1).attribute("ref");
				var subresultref1 = eval(subid1).attribute("resultref");
				var subid1_cur1 = "CURLIST1";
				var subid1_cur2 = "CURLIST2";
				var totalcnt = 0;
				
				//입력값 설정
				var temp_evnt_cd = "";
				if (get_refvalue(srch_evnt_yyyy) != "" && get_refvalue(srch_evnt_cd) != "" && get_refvalue(srch_evnt_seq)) {
					temp_evnt_cd = get_refvalue(srch_evnt_yyyy) + "G" + get_refvalue(srch_evnt_cd) + get_refvalue(srch_evnt_seq);
				}
				set_refvalue(subref1 + "/" + "evnt_cd",temp_evnt_cd);
				
				//실행
				model.send(subid1);
				
				totalcnt = model.getValue(subresultref1 + "/" + subid1_cur2 + "/" + "totalcnt");
				
				set_refvalue("/root/tempData/totalcount",totalcnt);
				
				if(model.getFocus() == "btn_insert"){
					return totalcnt;
				}
			
				if (totalcnt == 0 && check_submit_completed()) {
					show_message("검색결과가 없습니다.");
				}
				
				if (totalcnt == 0) {
					combo_data_init(medi_cd);
					set_refvalue(rmks,"");
					set_refvalue(year_amt_tot,"");
					
					for (i = 1 ; i < 11 ; i++){
						datagrid2.addRow(false);
						datagrid2.isReadOnly(i,8,i,19) = true;
					}
				}
				else {
					/*
					var temp_medi_cd = get_refvalue(subresultref1 + "/" + subid1_cur1 + "/" + "medi_cd");
					var temp_rmks = get_refvalue("/root/resData/gridData/mc_budg_2071_l/dataSet/CURLIST2/record/rmks");
					
					if (temp_medi_cd == "") {
						combo_data_init(medi_cd);
					}
					else {
						set_refvalue(medi_cd,temp_medi_cd);
					}
					set_refvalue(rmks,temp_rmks);
					*/
					
					recalc_req_amt();
					
					for (i = 1 ; i < 11 ; i++){
						datagrid2.addRow(false);
						datagrid2.isReadOnly(i,8,i,19) = true;
					}
				}
				return;
			}
			
			// 합계 //
			function recalc_req_amt() {
				var ytot = 0;
				var ttot = 0;
				var obj = datagrid2;
				
				var col01 = obj.colRef("budg_yymm01");
				var col12 = obj.colRef("budg_yymm12");
				var coltot = obj.colRef("req_amt_tot");

				for(var i = obj.fixedRows;i < obj.rows;i++) {
					//부서코드와 부서명이 등록되지 않았으면 계산에서 제외한다.
					if (obj.valueMatrix(i,obj.colRef("use_dept_cd")).Trim() != "" && obj.valueMatrix(i,obj.colRef("abrv_nm")).Trim() != "") {
						ytot = datagrid_data_sum(obj,i,col01,i,col12);
						obj.valueMatrix(i,coltot) = ytot;
						ttot += ytot;
					}
				}				
				set_refvalue(year_amt_tot,ttot);
			}

			// 저장 //
			function send_mc_budg_2076_i(){
				var cnt = 0;
				//var totcnt = send_mc_budg_2071_l();
				var totcnt = get_refvalue("/root/tempData/totalcount");
				var evnt_cd_var = srch_evnt_yyyy.value + "G" + srch_evnt_cd.value + srch_evnt_seq.value;
				var medi_cd_chg = get_refvalue("/root/tempData/medi_cd_chg");
				var rmks_chg = get_refvalue("/root/tempData/rmks_chg");
				var dtls_medi_cd_chg = get_refvalue("/root/tempData/dtls_medi_cd_chg");

				// 필수항목 체크 //
				if (!commReqCheck(group_searches)) {
					return false;
				}

				//alert(rmks_chg);
				
				if(!medi_cd.disabled && medi_cd.value == ""){
					show_message("매체코드를 입력하세요.");
					return;
				}
				
				if(totcnt == "0"){
					set_refvalue("/root/reqData/multiUpDate/tag","1");
				}else{
					set_refvalue("/root/reqData/multiUpDate/tag","0");
				}
				
				var min_chk = 0;
				var chk_amt = 0;
				
				//alert(rmks_chg);
				
				for(i = 1 ; i < datagrid2.rows ; i++){
					
					if(datagrid2.rowStatus(i) == "2" || datagrid2.rowStatus(i) == "3"){
						for(j = 8 ; j < 20 ; j++){
							chk_amt = datagrid2.valueMatrix(i,j);
							if(chk_amt < 0){
								min_chk += 1;
							}
						}
						set_refvalue("/root/reqData/multiUpDate/tag","0");
						cnt += 1;
					}
					
					if(datagrid2.rowStatus(i) == "2"){
						set_refvalue("/root/resData/gridData/mc_budg_2071_l/dataSet/CURLIST2/record["+i+"]/jobtag","U");
					}else if(datagrid2.rowStatus(i) == "3"){
						set_refvalue("/root/reqData/multiUpDate/tag","1");
						set_refvalue("/root/resData/gridData/mc_budg_2071_l/dataSet/CURLIST2/record["+i+"]/jobtag","I");
						set_refvalue("/root/resData/gridData/mc_budg_2071_l/dataSet/CURLIST2/record["+i+"]/seq","001");
					}
				}
				
				if(cnt == 0 && medi_cd_chg == "" && rmks_chg == "" && dtls_medi_cd_chg == ""){
					change_status();
					show_message("저장할 항목이 없습니다:"+rmks_chg);
					return;
				}else if ((cnt == 0 && medi_cd_chg == "M") || (cnt == 0 && rmks_chg == "J")) {
					for(i = 1 ; i < datagrid2.rows ; i++){
						if(datagrid2.rowStatus(i) == "0"){
							set_refvalue("/root/resData/gridData/mc_budg_2071_l/dataSet/CURLIST2/record["+i+"]/jobtag",medi_cd_chg + rmks_chg);
							datagrid2.rowStatus(i) = "2";
						}
					}
				}else if (cnt == 0 && dtls_medi_cd_chg == "D" && medi_cd_chg == "" && rmks_chg == "") {
					for(i = 1 ; i < datagrid2.rows ; i++){
						if(datagrid2.rowStatus(i) == "0"){
							set_refvalue("/root/resData/gridData/mc_budg_2071_l/dataSet/CURLIST2/record["+i+"]/jobtag",dtls_medi_cd_chg);
							datagrid2.rowStatus(i) = "2";
						}
					}
				}
				
				if(min_chk > 0){
					if(show_message("저장하려는 data중에 (-)금액이 존재합니다. 그대로 저장하시겠습니까?", "저장", 4)  == 7){
						change_status();
						return;
					}
				}else if(show_message("저장하시겠습니까?", "저장", 4) == 7){
					change_status();
					return;
				}
				
				for(i = 1 ; i < datagrid2.rows ; i++){
					if(datagrid2.rowStatus(i) == "1" || datagrid2.rowStatus(i) == "4"){
						datagrid2.rowStatus(i) = "0";
					}
				}

				if(evnt_cd_var.length != 10){
					set_refvalue("/root/reqData/multiUpDate/evnt_cd"," ");
				}else{
					set_refvalue("/root/reqData/multiUpDate/evnt_cd",evnt_cd_var);
				}
				set_refvalue("/root/reqData/multiUpDate/budg_yy",srch_budg_yy.value);
				set_refvalue("/root/reqData/multiUpDate/budg_cd",srch_budg_cd.value);
				set_refvalue("/root/reqData/multiUpDate/dept_cd",srch_dept_cd.value);
				set_refvalue("/root/reqData/multiUpDate/work_no",srch_work_no.value);
				set_refvalue("/root/reqData/multiUpDate/medi_cd",medi_cd.value);
				set_refvalue("/root/reqData/multiUpDate/dtls_medi_cd",dtls_medi_cd.value);
				set_refvalue("/root/reqData/multiUpDate/rmks",rmks.value);
				set_refvalue("/root/reqData/multiUpDate/chg_pers",srch_emp_no.value);
				
				set_refvalue("/root/reqData/multiUpDate/multiUpdateData", datagrid2.getUpdateData());
				model.send("mc_budg_2076_i");
				
				if(submit_completed()){
					show_message("저장되었습니다.");
					model.setFocus("btn_select");
					srch_work_no.value = model.getValue("/root/resData/MsgData/dataSet/work_no");
					send_mc_budg_2071_l();
				}
			}
			
			// 삭제 //
			function send_mc_budg_2077_d(){
				var cnt = 0;
				var cnt2 = 0;
				var evnt_cd_var = srch_evnt_yyyy.value + "G" + srch_evnt_cd.value + srch_evnt_seq.value;

				// 필수항목 체크 //
				if (!commReqCheck(group_searches)) {
					return false;
				}
				
				if(datagrid2.rows == 11){
					show_message("삭제할 항목이 없습니다.");
					return;
				}
				
				for(i = 1 ; i < datagrid1.rows ; i++){
					if(datagrid1.rowStatus(i) == "4"){
						cnt += 1;
					}
				}
				
				for(i = 1 ; i < datagrid2.rows ; i++){
					if(datagrid2.rowStatus(i) == "4"){
						cnt2 += 1;
					}
				}
				
				if(cnt == 0 && cnt2 == 0){
					show_message("삭제할 항목이 없습니다.");
					return;
				}

				if(cnt > 0){
					if(show_message("삭제하시겠습니까?(등록번호)", "삭제", 4) == 7){
						return;
					}
					set_refvalue("/root/reqData/multiUpDate/tag","1");
				}else{
					if(show_message("삭제하시겠습니까?(사용부서)", "삭제", 4) == 7){
						return;
					}
					set_refvalue("/root/reqData/multiUpDate/tag","0");
				}

				if(evnt_cd_var.length == 1){
					set_refvalue("/root/reqData/multiUpDate/evnt_cd"," ");
				}else{
					set_refvalue("/root/reqData/multiUpDate/evnt_cd",evnt_cd_var);
				}
				
				set_refvalue("/root/reqData/multiUpDate/budg_yy",srch_budg_yy.value);
				set_refvalue("/root/reqData/multiUpDate/budg_cd",srch_budg_cd.value);
				set_refvalue("/root/reqData/multiUpDate/dept_cd",srch_dept_cd.value);
				//set_refvalue("/root/reqData/multiUpDate/evnt_cd",srch_evnt_cd.value);
				set_refvalue("/root/reqData/multiUpDate/work_no",srch_work_no.value);
				set_refvalue("/root/reqData/multiUpDate/chg_pers",srch_emp_no.value);
				
				set_refvalue("/root/reqData/multiUpDate/multiUpdateData", datagrid2.getUpdateData("delete"));
				model.send("mc_budg_2077_d");
				
				if(submit_completed()){
					datagrid1.clearStatus();
					show_message("삭제되었습니다.");
					model.setFocus("btn_select");
					send_mc_budg_2071_l();

				}
			}
			
			// status 변경 //
			function change_status(){
				for(var i=datagrid2.rows; i > datagrid2.rows-11; i--){
					datagrid2.rowStatus(i) = "1";
				}
			}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="2,50;1,936;1,10;2,5;2,734;2,721;">
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:734px; width:926px; height:21px; ">
			<button id="btnReset" class="btn02" navindex="19" style="left:165px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						medi_cd.disabled = false;
						model.reset();
						default_grid();
					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" navindex="16" crud="C" style="left:55px; top:0px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_mc_budg_2076_i();
					]]>
				</script>
			</button>
			<button id="btn_delete" class="btn02" navindex="18" crud="D" style="left:110px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_mc_budg_2077_d();
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" navindex="21" style="left:340px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose();		
					]]>
				</script>
			</button>
			<button id="btn_select" class="btn02" navindex="15" crud="R" style="left:0px; top:0px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_mc_budg_2071_l();
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" navindex="20" crud="R" style="left:285px; top:0px; width:52px; height:21px; ">
				<caption>도움말</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[

					]]>
				</script>
			</button>
			<button id="btn_print" class="btn03" navindex="20" crud="R" style="left:220px; top:0px; width:60px; height:21px; ">
				<caption>예산서출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					//필수항목체크(검색)
					if(!checkref(srch_budg_yy)) {
						return false;
					}
					if(!checkref(srch_dept_cd)) {
						return false;
					}
					ss_cmpy_cd = getProperty("ss_cmpycd");
					if(ss_cmpy_cd == "500"){
						// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)
						makeNodeValue("/root/oz_data/ozrName","fcmc/SP_MC_BUDG_2150_500_P");
						// odi 파라미터 설정.
						makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd",getProperty("ss_cmpycd"));
						makeNodeValue("/root/oz_data/odiParam/iv_in_tag", "1");
						makeNodeValue("/root/oz_data/odiParam/iv_budg_yymm", srch_budg_yy.value);
						makeNodeValue("/root/oz_data/odiParam/iv_dept_cd", srch_dept_cd.value);
						makeNodeValue("/root/oz_data/odiParam/iv_in_bulen", "6");
						makeNodeValue("/root/oz_data/odiParam/iv_budg_yymm1", srch_budg_yy.value);
					}else{
						// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)
						makeNodeValue("/root/oz_data/ozrName","fcmc/SP_MC_BUDG_2150_P");
						// odi 파라미터 설정.
						makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd",getProperty("ss_cmpycd"));
						makeNodeValue("/root/oz_data/odiParam/iv_in_tag", "1");
						makeNodeValue("/root/oz_data/odiParam/iv_budg_yymm", srch_budg_yy.value);
						makeNodeValue("/root/oz_data/odiParam/iv_dept_cd", srch_dept_cd.value);
						makeNodeValue("/root/oz_data/odiParam/iv_in_bulen", "6");
						makeNodeValue("/root/oz_data/odiParam/iv_budg_yymm1", srch_budg_yy.value);
					}

					// 레포트뷰어 호출.
					openOzwin("/root/oz_data");
					]]>
				</script>
			</button>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:140px; width:926px; height:5px; "/>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group_searches" class="gro_sel" style="left:10px; top:50px; width:926px; height:76px; ">
			<caption id="caption5" class="list_cap02" style="left:0px; top:0px; width:926px; "/>
			<caption id="caption2" class="list_cap03" style="left:0px; top:0px; width:110px; ">예산년도</caption>
			<caption id="caption4" class="list_cap03" style="left:215px; top:0px; width:110px; height:26px; ">부서코드</caption>
			<caption id="caption6" class="list_cap02" style="left:0px; top:25px; width:926px; height:26px; "/>
			<caption id="caption9" class="list_cap02" style="left:0px; top:50px; width:926px; height:26px; "/>
			<caption id="caption11" class="list_cap03" style="left:0px; top:25px; width:110px; height:26px; ">예산코드</caption>
			<caption id="caption13" class="list_cap03" style="left:0px; top:50px; width:110px; height:26px; ">고유행사코드</caption>
			<caption id="caption14" class="list_cap03" style="left:665px; top:0px; width:110px; height:26px; ">등록자</caption>
			<input id="srch_emp_no" ref="/root/reqData/searchData/emp_no" navindex="-1" editable="false" caption="등록자사번" style="left:778px; top:4px; width:44px; height:18px; "/>
			<input id="srch_emp_nm" ref="/root/reqData/searchData/emp_nm" navindex="-1" editable="false" caption="등록자명" style="left:825px; top:4px; width:97px; height:18px; "/>
			<caption id="caption16" class="list_cap03" style="left:429px; top:25px; width:110px; height:26px; ">등록번호</caption>
			<caption id="caption17" class="list_cap03" style="left:215px; top:50px; width:110px; height:26px; ">행사년도</caption>
			<caption id="caption18" class="list_cap03" style="left:429px; top:50px; width:110px; height:26px; ">회차</caption>
			<input id="srch_evnt_cd" ref="/root/reqData/searchData/evnt_cd2" navindex="7" inputtype="button" maxlength="3" caption="고유행사코드" style="left:125px; top:54px; width:50px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					if (open_mc_co_1020()) {
						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
						fill_evnt_yyyy();
					}
					else {
						//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if (open_mc_co_1020()) {
						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
						fill_evnt_yyyy();
					}
					else {
						//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
			</input>
			<input id="srch_evnt_nm" ref="/root/reqData/searchData/evnt_nm" navindex="-1" editable="false" caption="행사명" style="left:595px; top:54px; width:327px; height:18px; "/>
			<button id="srch_budg_yy_up" class="input_plus" navindex="-1" style="left:163px; top:4px; width:9px; height:9px; ">
				<caption/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					srch_dept_cd.value = "";
					srch_abrv_nm.value = "";
					//reset_model(true);
					change_yyyy(srch_budg_yy,UPDOWN_UP);
					]]>
				</script>
			</button>
			<button id="srch_budg_yy_down" class="input_minus" navindex="-1" style="left:163px; top:13px; width:9px; height:9px; ">
				<caption/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					srch_dept_cd.value = "";
					srch_abrv_nm.value = "";
					//reset_model(true);
					change_yyyy(srch_budg_yy,UPDOWN_DN);
					]]>
				</script>
			</button>
			<input id="srch_budg_yy" ref="/root/reqData/searchData/budg_yymm" class="req" navindex="1" autonext="false" maxlength="4" caption="예산년도" style="left:113px; top:4px; width:51px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						srch_dept_cd.value = "";
						srch_abrv_nm.value = "";
						reset_model(true);
					]]>
				</script>
			</input>
			<select1 id="srch_evnt_yyyy" ref="/root/reqData/searchData/evnt_yyyy" navindex="8" appearance="minimal" caption="행사년도" style="left:328px; top:54px; width:72px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/evnt_yyyy/record">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					fill_evnt_seq();
					]]>
				</script>
			</select1>
			<input id="srch_dept_cd" ref="/root/reqData/searchData/dept_cd" class="req" navindex="4" autonext="false" inputtype="button" maxlength="6" format="999999" caption="부서코드" style="left:328px; top:4px; width:70px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					var var_con_date = "";
						if (srch_budg_yy.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_budg_yy.value.length;
							if(num_ch == 8){
								var_con_date = srch_budg_yy.value;
							}else if(num_ch == 6){
								var_con_date = srch_budg_yy.value + "01";
							}else if(num_ch == 4){
								var yy = commCurDate().substring(0,4); 
								if(srch_budg_yy.value == yy){
									var_con_date = commCurDate(); 
								}else{
									var_con_date = srch_budg_yy.value + "0101";
								}
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "I");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						ch_grid = false;
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						
						
//					if (open_mc_co_1010()) {
//						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
//						send_mc_budg_2072_l();
//					}
//					else {
//						//팝업에서 취소 버튼을 누른 경우
//						//datagrid_data_clear(datagrid1);
//					}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var var_con_date = "";

						if (srch_budg_yy.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_budg_yy.value.length;
							if(num_ch == 8){
								var_con_date = srch_budg_yy.value;
							}else if(num_ch == 6){
								var_con_date = srch_budg_yy.value + "01";
							}else if(num_ch == 4){
								var yy = commCurDate().substring(0,4); 
								if(srch_budg_yy.value == yy){
									var_con_date = commCurDate(); 
								}else{
									var_con_date = srch_budg_yy.value + "0101";
								}
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (srch_dept_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
							model.setValue("/root/reqData/fwdData/dept_cd", srch_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "I");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								srch_abrv_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								srch_dept_cd.value = "";
								srch_abrv_nm.value = "";
							}
						}
						else {
							srch_dept_cd.value = "";
							srch_abrv_nm.value = "";
						}
						
						reset_model(true);
						
						if(srch_dept_cd.value != ""){
							send_mc_budg_2072_l();
						}
						
//					if (open_mc_co_1010()) {
//						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
//						send_mc_budg_2072_l();
//					}
					]]>
				</script>
			</input>
			<input id="srch_abrv_nm" ref="/root/reqData/searchData/abrv_nm" navindex="-1" editable="false" caption="부서코드명" style="left:401px; top:4px; width:261px; height:18px; "/>
			<input id="srch_work_no" ref="/root/reqData/searchData/work_no" navindex="6" autonext="false" inputtype="button" maxlength="3" caption="등록번호" style="left:542px; top:29px; width:50px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						open_mc_co_2070();
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						//default_grid();
					]]>
				</script>
			</input>
			<input id="srch_budg_nm" ref="/root/reqData/searchData/budg_nm" navindex="-1" editable="false" caption="예산코드명" style="left:167px; top:29px; width:259px; height:18px; "/>
			<input id="srch_budg_cd" ref="/root/reqData/searchData/budg_cd" class="req" navindex="5" autonext="false" maxlength="6" caption="예산코드" style="left:113px; top:29px; width:51px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						//default_grid();
						find_budg_cd_in_grid(datagrid1);
					]]>
				</script>
			</input>
			<select1 id="srch_evnt_seq" ref="/root/reqData/searchData/evnt_seq" navindex="9" appearance="minimal" caption="회차" style="left:542px; top:54px; width:50px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/evnt_seq/record">
						<label ref="label"/>
						<value ref="value"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					set_evnt_nm();
					]]>
				</script>
			</select1>
			<caption id="caption8" style="left:112px; top:56px; width:12px; height:15px; font-weight:bold; text-decoration:underline; color:#0000ff; ">G</caption>
		</group>
		<group id="group_contents" class="gro_sel" style="left:10px; top:155px; width:926px; height:320px; border-color:#00ccff; ">
			<caption id="caption3" class="list_cap02" style="left:0px; top:0px; width:566px; height:26px; "/>
			<caption id="caption77" class="list_cap02" style="left:0px; top:25px; width:666px; height:26px; "/>
			<caption id="caption1" class="list_cap03" style="left:0px; top:0px; width:110px; height:26px; ">매체코드</caption>
			<caption id="caption10" class="list_cap03" style="left:0px; top:25px; width:110px; height:26px; text-align:center; ">적요</caption>
			<caption id="caption7" class="list_cap02" style="left:565px; top:0px; width:361px; height:51px; "/>
			<caption id="caption22" style="left:565px; top:2px; width:360px; height:25px; font-size:14pt; font-weight:bold; color:#ff0000; text-align:center; vertical-align:middle; ">
				<![CDATA[<< 부가세 제외 >>]]>
			</caption>
			<select id="amt_set" ref="/root/tempData/amt_set" navindex="12" overflow="visible" appearance="full" style="left:570px; top:32px; width:95px; height:18px; vertical-align:middle; border-style:none; ">
				<choices>
					<item>
						<label>금액 일괄적용</label>
						<value>Y</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(amt_set.value == "Y" && datagrid2.col > 7 && datagrid2.valueMatrix(datagrid2.row,6) != ""){
							if(show_message("금액을 일괄 적용하시겠습니까?", "확인", 4) == 7){
								amt_set.value = "";
								return;
							}
							var focus_val = Number(datagrid2.valueMatrix(datagrid2.row,datagrid2.col));
							for(i = datagrid2.col+1 ; i < datagrid2.cols-1 ; i++){
								datagrid2.valueMatrix(datagrid2.row,i) = focus_val;
							}
							recalc_req_amt();
						}
						amt_set.value = "";
					]]>
				</script>
			</select>
			<caption id="caption23" style="left:675px; top:31px; width:85px; height:18px; vertical-align:middle; ">연간 예산합계</caption>
			<input id="year_amt_tot" ref="/root/reqData/searchData/year_amt_tot" navindex="-1" editable="false" style="left:760px; top:30px; width:155px; height:18px; vertical-align:middle; "/>
			<select1 id="medi_cd" ref="/root/resData/gridData/mc_budg_2071_l/dataSet/CURLIST1/record/medi_cd" navindex="10" appearance="minimal" editmode="inputsearch" caption="매체코드" style="left:113px; top:4px; width:92px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/mc_budg_2070_m/dataSet/CURLIST1/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(medi_cd, medi_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(medi_cd,"");
							return;
						}
						set_refvalue("/root/tempData/medi_cd_chg","M");
					]]>
				</script>
			</select1>
			<input id="rmks" ref="/root/resData/gridData/mc_budg_2071_l/dataSet/CURLIST1/record/rmks" navindex="11" caption="적요" style="left:113px; top:29px; width:445px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						set_refvalue("/root/tempData/rmks_chg","J");
					]]>
				</script>
			</input>
			<caption id="caption30" class="list_cap03" visibility="hidden" style="left:215px; top:0px; width:110px; height:26px; text-align:center; ">상세매체</caption>
			<input id="dtls_medi_cd_nm" ref="/root/resData/gridData/mc_budg_2071_l/dataSet/CURLIST1/record/dtls_medi_cd_nm" visibility="hidden" editable="false" style="left:426px; top:4px; width:132px; height:18px; "/>
			<input id="dtls_medi_cd" ref="/root/resData/gridData/mc_budg_2071_l/dataSet/CURLIST1/record/dtls_medi_cd" navindex="17" visibility="hidden" inputtype="button" style="left:329px; top:4px; width:90px; height:18px; ">
				<!-- 2012.01.13 -->
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					if (medi_cd.value != "") {
							/*2012.01.13*/
							makeFwdDataNodes();			
					
							model.setValue("/root/reqData/fwdData/job_clsf", "00"); //필수항목
							model.setValue("/root/reqData/fwdData/cd_clsf", "01"); //필수항목
							model.setValue("/root/reqData/fwdData/cd",  medi_cd.value);
							model.setValue("/root/reqData/fwdData/cdnm", medi_cd.text);

							model.setValue("/root/reqData/fwdData/resultRef1", "/root/resData/gridData/mc_budg_2071_l/dataSet/CURLIST1/record/dtls_medi_cd");
							model.setValue("/root/reqData/fwdData/resultRef2", "/root/resData/gridData/mc_budg_2071_l/dataSet/CURLIST1/record/dtls_medi_cd_nm");	
	
							window.load("/xrw/co/cocd/CO_COCD_1400.xrw"
										, "modal"
										, ""
										, "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
									,"/root/reqData/fwdData"
									,"/root/reqData/searchData"
									)									
							if (dtls_medi_cd.value != "") {
								set_refvalue("/root/tempData/dtls_medi_cd_chg","D");
							}
					}			
									
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					/*2012.01.13*/			
						
						set_refvalue("/root/tempData/dtls_medi_cd_chg","D");
					/* 20131120막음
					if (medi_cd.value != "") {
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cd");
						model.makeNode("/root/reqData/fwdData/medi_cd");
						model.setValue("/root/reqData/fwdData/cd", dtls_medi_cd.value);
						model.setValue("/root/reqData/fwdData/medi_cd",medi_cd.value);
						model.send("fc_acct_2015_l");
						

						if (model.getValue("/root/tempData/fc_acct_2015_l/dataSet/CURLIST/record/cd") != "") {
							dtls_medi_cd_nm.value = model.getValue("/root/tempData/fc_acct_2015_l/dataSet/CURLIST/record/cdnm")
						}else {
							dtls_medi_cd.value = "";
						}
					}else{
						dtls_medi_cd.value = "";
					}
					*/
					/*
					if(dtls_medi_cd.value.length == 10 ){
						
						
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cd");
						model.makeNode("/root/reqData/fwdData/medi_cd");
						model.setValue("/root/reqData/fwdData/cd", dtls_medi_cd.value);
						model.setValue("/root/reqData/fwdData/medi_cd",medi_cd.value);
						
						
						
						model.setValue("/root/reqData/searchData/cd", dtls_medi_cd.value);
						
						alert(model.getValue("/root/reqData/searchData/cd"));
						
						model.send("co_cocd_1410_l");
						

						if (model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cd").Trim() != "") {
							dtls_medi_cd_nm.value = model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cdnm");
							dtls_medi_cd.value = "";
						}
						else
						{
							dtls_medi_cd.value = "";
							dtls_medi_cd_nm.value = "";
						}
						
						
					}
					else {
						dtls_medi_cd.value = "";
						dtls_medi_cd_nm.value = "";
					}
					
					//if(medi_cd.value != ""){
						//if (open_fc_co_8010("focus","s","매체코드조회","1","","00","01")) {
							//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
						//}
						//else {
							//팝업에서 취소 버튼을 누른 경우
						//}
					//}
//						if (medi_cd.value == "110" || medi_cd.value == "210") {
					/*
					if (get_refvalue("/root/tempData/medi_ch") == "Y") {
						dtls_medi_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
					}
					else {
						dtls_medi_cd.attribute("background-color") = "white";
					}
					*/
					
					
					
					
					
					
					
					
					]]>
				</script>
			</input>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/mc_budg_2072_l/dataSet/CURLIST1/record" caption="회사코드^부서코드^예산유형코드^예산코드^예산명" colsep="^" colwidth="87, 100, 100, 60, 108" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" navindex="13" style="left:12px; top:215px; width:200px; height:506px; ">
			<col ref="cmpy_cd" caption="회사코드"/>
			<col ref="dept_cd" caption="부서코드"/>
			<col ref="budg_type_cd" caption="예산유형코드"/>
			<col ref="budg_cd" caption="예산코드"/>
			<col ref="budg_nm" caption="예산명"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var obj = datagrid1;
					if (obj.row >= 1 && obj.col >= 1) {
						var budg_cd_id = obj.colRef("budg_cd");
						var budg_nm_id = obj.colRef("budg_nm");
						var budg_row = obj.row;
						
						set_refvalue(srch_budg_cd,obj.valueMatrix(budg_row,budg_cd_id));
						set_refvalue(srch_budg_nm ,obj.valueMatrix(budg_row,budg_nm_id));
						
						var medi_cd_flag = check_medi_cd_enable(get_refvalue(srch_budg_cd));
						
						if(!medi_cd_flag){
							medi_cd.select(0);
						}
						
						medi_cd.disabled = !medi_cd_flag;
						srch_work_no.value = "";
						default_grid();
					}
				]]>
			</script>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					var grid1_row = 0;
					grid1_row = datagrid1.findRow(srch_budg_cd.value,1,4);
					if(datagrid1.mouseCol == 0 && datagrid1.mouseRow == grid1_row){
						if(datagrid1.rowStatus(datagrid1.mouseRow) == "4"){
							datagrid1.removeStatus(datagrid1.mouseRow, "delete");
							for(i = 1 ; i < datagrid2.rows ; i++){
								if(datagrid2.rowStatus(i) == "4"){
									datagrid2.rowStatus(i) = "0";
								}
							}
						}
						else if(datagrid1.rowStatus(datagrid1.mouseRow) == "0"){
							datagrid1.addStatus(datagrid1.mouseRow, "delete");
							for(i = 1 ; i < datagrid2.rows ; i++){
								if(datagrid2.rowStatus(i) == "0" || datagrid2.rowStatus(i) == "2"){
									datagrid2.rowStatus(i) = "4";
								}
							}
						}
					}
				]]>
			</script>
		</datagrid>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData/mc_budg_2071_l/dataSet/CURLIST2/record" caption="예산년도^매체코드^적요^등록번호^순번^사용부서^부서명^1월^2월^3월^4월^5월^6월^7월^8월^9월^10월^11월^12월^합계^jobtag" colsep="^" colwidth="100, 100, 100, 100, 100, 80, 150, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" frozencols="7" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" navindex="14" style="left:215px; top:215px; width:721px; height:506px; ">
			<col ref="budg_yy"/>
			<col ref="medi_cd" style="left:120px; top:20px; width:100px; height:20px; "/>
			<col ref="rmks"/>
			<col ref="work_no"/>
			<col ref="seq"/>
			<col ref="use_dept_cd" type="inputbutton"/>
			<col ref="abrv_nm"/>
			<col ref="budg_yymm01" type="input"/>
			<col ref="budg_yymm02" type="input"/>
			<col ref="budg_yymm03" type="input"/>
			<col ref="budg_yymm04" type="input"/>
			<col ref="budg_yymm05" type="input"/>
			<col ref="budg_yymm06" type="input"/>
			<col ref="budg_yymm07" type="input"/>
			<col ref="budg_yymm08" type="input"/>
			<col ref="budg_yymm09" type="input"/>
			<col ref="budg_yymm10" type="input"/>
			<col ref="budg_yymm11" type="input"/>
			<col ref="budg_yymm12" type="input"/>
			<col ref="req_amt_tot"/>
			<col ref="jobtag"/>
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				obj = eval(event.currentTarget);
				
				if (obj.row >= obj.fixedRows && obj.col == obj.colRef("use_dept_cd")) {
					var var_con_date = "";

					if (datagrid2.valueMatrix(obj.row,datagrid2.colRef("budg_yy")) == ""){ 
						var_con_date = commCurDate(); 
					}else { 
						var num_ch = datagrid2.valueMatrix(obj.row,datagrid2.colRef("budg_yy")).length;
						if(num_ch == 8){
							var_con_date = datagrid2.valueMatrix(obj.row,datagrid2.colRef("budg_yy"));
						}else if(num_ch == 6){
							var_con_date = datagrid2.valueMatrix(obj.row,datagrid2.colRef("budg_yy")) + "01";
						}else if(num_ch == 4){
							var_con_date = datagrid2.valueMatrix(obj.row,datagrid2.colRef("budg_yy")) + "0101";
						}else{
							var_con_date = commCurDate(); 
						}
					}
					
					model.removeNodeset("/root/reqData/fwdData");  
					model.makeNode("/root/reqData/fwdData/func_nm");
					model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
					model.makeNode("/root/reqData/fwdData/select_ch");
					model.setValue("/root/reqData/fwdData/select_ch", "I");
					model.makeNode("/root/reqData/fwdData/use_end_dt");
					model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
					ch_grid = true;
					window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
//					if (open_mc_co_1010()) {
//						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
//					}
//					else {
//						//팝업에서 취소 버튼을 누른 경우
//					}
				}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				obj = eval(event.currentTarget);
				
				if (obj.row >= obj.fixedRows && obj.col == obj.colRef("use_dept_cd")) {
					var var_con_date = "";

					if (datagrid2.valueMatrix(obj.row,datagrid2.colRef("budg_yy")) == ""){ 
						var_con_date = commCurDate(); 
					}else { 
						var num_ch = datagrid2.valueMatrix(obj.row,datagrid2.colRef("budg_yy")).length;
						if(num_ch == 8){
							var_con_date = datagrid2.valueMatrix(obj.row,datagrid2.colRef("budg_yy"));
						}else if(num_ch == 6){
							var_con_date = datagrid2.valueMatrix(obj.row,datagrid2.colRef("budg_yy")) + "01";
						}else if(num_ch == 4){
							var_con_date = datagrid2.valueMatrix(obj.row,datagrid2.colRef("budg_yy")) + "0101";
						}else{
							var_con_date = commCurDate(); 
						}
					}

					if (datagrid2.valueMatrix(obj.row,datagrid2.colRef("use_dept_cd")).length == 6) {
						
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/dept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/dept_cd", datagrid2.valueMatrix(obj.row,datagrid2.colRef("use_dept_cd")));
						model.setValue("/root/reqData/fwdData/select_ch", "I");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						model.send("fc_co_1101");

						if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
							datagrid2.valueMatrix(obj.row,datagrid2.colRef("abrv_nm")) = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
						}
						else {
							datagrid2.valueMatrix(obj.row,datagrid2.colRef("use_dept_cd")) = "";
							datagrid2.valueMatrix(obj.row,datagrid2.colRef("abrv_nm")) = "";
						}
					}
					else {
						datagrid2.valueMatrix(obj.row,datagrid2.colRef("use_dept_cd")) = "";
						datagrid2.valueMatrix(obj.row,datagrid2.colRef("abrv_nm")) = "";
					}	
//					if (open_mc_co_1010()) {
//						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
//					}
//					else {
//						//팝업에서 취소 버튼을 누른 경우
//					}
				}
				
				//변경된 금액 재계산
				if (obj.row >= obj.fixedRows && obj.col >= obj.colRef("budg_yymm01") && obj.col <= obj.colRef("budg_yymm12")) {
					recalc_req_amt();
				}

				if(datagrid2.valueMatrix(datagrid2.row,6) == ""){
					datagrid2.isReadOnly(datagrid2.row,8,datagrid2.row,19) = true;
				}
				]]>
			</script>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					//그리드 스크롤바 클릭, 더블클릭 방지 소스
					if (-1 != event.target.lastIndexOf("scroll.thumb")) {
						return;
					}
					
					if (datagrid2.mouseRow < 1) {
						return;
					}
					
					var grid = eval(event.currentTarget);
					var rowid = grid.row;
					var colid = grid.col;
					
					if (rowid < grid.fixedRows || colid < grid.fixedCols) {
						return;
					}				
					if(datagrid2.col > 7){
						if(datagrid2.valueMatrix(datagrid2.row,6) == ""){
							show_message("사용부서를 먼저 입력하세요.");
						}else{
							datagrid2.isReadOnly(datagrid2.row,8,datagrid2.row,19) = false;
						}
					}
				]]>
			</script>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if(datagrid2.mouseCol == 0 && datagrid2.mouseRow != 13){
						if(datagrid2.rowStatus(datagrid2.mouseRow) == "4"){
							datagrid2.removeStatus(datagrid2.mouseRow, "delete");
						}
						else if(datagrid2.rowStatus(datagrid2.mouseRow) == "0"){
							datagrid2.addStatus(datagrid2.mouseRow, "delete");
						}
					}
				]]>
			</script>
		</datagrid>
	</xhtml:body>
</xhtml:html>
