<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session>
						</session>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
						<mc_budg_4000_m>
							<dataSet>
								<xx_budg_type_cd_010/>
							</dataSet>
						</mc_budg_4000_m>
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData>
						</fwdData>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<mc_budg_4003_l>
								<budg_yymm/>
								<budg_cd/>
								<dept_cd/>
								<evnt_cd/>
							</mc_budg_4003_l>
							<mc_budg_4001_l>
								<budg_yymm_fr/>
								<budg_yymm_to/>
								<budg_cd_fr/>
								<budg_cd_to/>
								<dept_cd_fr/>
								<dept_cd_to/>
								<evnt_cd_fr/>
								<evnt_cd_to/>
							</mc_budg_4001_l>
							<mc_budg_4002_e>
								<kind/>
								<budg_yymm/>
								<clsf_cd/>
							</mc_budg_4002_e>
							<mc_budg_4006_l>
								<budg_cd/>
							</mc_budg_4006_l>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqform/>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpDate>
							<mc_budg_4004_i>
								<multiUpdateData/>
								<cnt/>
								<budg_yymm/>
								<budg_cd/>
								<dept_cd/>
								<evnt_cd/>
								<budg_yymm_to/>
								<budg_cd_to/>
								<dept_cd_to/>
								<evnt_cd_to/>
								<from_iwamt/>
								<to_iwamt/>
								<crte_clsf/>
								<multiUpdateData2/>
							</mc_budg_4004_i>
						</multiUpDate>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resform>
							<mc_budg_4005_l>
								<dataSet>
									<CURLIST2>
										<record>
											<max_sub_cd/>
										</record>
									</CURLIST2>
									<CURLIST1>
										<record>
											<max_yymm/>
										</record>
									</CURLIST1>
								</dataSet>
							</mc_budg_4005_l>
							<mc_budg_4001_l>
								<dataSet>
									<CURLIST>
										<record>
											<budg_yymm/>
											<dept_cd/>
											<buseonm/>
											<budg_cd/>
											<evnt_nm/>
											<ysnm/>
											<last_asin_amt/>
											<budg_ask_amt/>
											<budg_cndt_amt/>
											<chamt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4001_l>
							<mc_budg_4002_e>
								<dataSet>
									<CURLIST>
										<record>
											<sub_cd/>
											<clos_yn/>
											<ymjedate/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4002_e>
							<mc_budg_4006_l>
								<dataSet>
									<CURLIST>
										<record>
											<budg_clas_cd/>
											<prt_clsf_cd/>
											<gf_commcdnm_prt_clsf_cd/>
											<budg_type_cd/>
											<budg_cdnm/>
											<budg_abrv_nm/>
											<clas_cd1/>
											<yf_brnm_budg_clas_cd1/>
											<clas_cd2/>
											<yf_budg_clas_cd2/>
											<clas_cd3/>
											<yf_budg_clas_cd3/>
											<clas_cd4/>
											<yf_budg_clas_cd4/>
											<cyov_yn/>
											<lesd_yn/>
											<advc_cndt_yn/>
											<limt_chk_yn/>
											<posbfee_yn/>
											<fixfee_yn/>
											<medi_dstb_cd/>
											<gf_commcdnm_medi_dstb_cd/>
											<whco_ndstb_cd/>
											<gf_commcdnm_ycjsbbcd/>
											<whco_comn_cost_yn/>
											<via_dept_cd/>
											<if_buseonm_dept_cd/>
											<dstb_acct_cd/>
											<drcr_bal_clsf/>
											<use_bgn_dt/>
											<use_end_dt/>
											<use_yn/>
											<dlco_clsf/>
											<ycentdate/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4006_l>
							<mc_budg_4001_l_1>
								<dataSet>
									<CURLIST>
										<record>
											<budg_yymm/>
											<dept_cd/>
											<buseonm/>
											<budg_cd/>
											<evnt_nm/>
											<ysnm/>
											<last_asin_amt/>
											<budg_ask_amt/>
											<budg_cndt_amt/>
											<chamt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4001_l_1>
							<mc_budg_4001_l_2>
								<dataSet>
									<CURLIST>
										<record>
											<budg_yymm/>
											<dept_cd/>
											<buseonm/>
											<budg_cd/>
											<evnt_nm/>
											<ysnm/>
											<last_asin_amt/>
											<budg_ask_amt/>
											<budg_cndt_amt/>
											<chamt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4001_l_2>
						</resform>
						<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<gridData>
							<mc_budg_4003_l>
								<dataSet>
									<CURLIST>
										<record>
											<work_no/>
											<seq/>
											<sub_seq/>
											<use_dept_cd/>
											<medi_cd/>
											<rmks/>
											<fix_asin_amt/>
											<fix_asin_uprc/>
											<fix_asin_qunt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4003_l>
							<mc_budg_4003_l_1>
								<dataSet>
									<CURLIST>
										<record>
											<work_no/>
											<seq/>
											<sub_seq/>
											<use_dept_cd/>
											<medi_cd/>
											<rmks/>
											<fix_asin_amt/>
											<fix_asin_uprc/>
											<fix_asin_qunt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4003_l_1>
							<mc_budg_4003_l_2>
								<dataSet>
									<CURLIST>
										<record>
											<work_no/>
											<seq/>
											<sub_seq/>
											<use_dept_cd/>
											<medi_cd/>
											<rmks/>
											<fix_asin_amt/>
											<fix_asin_uprc/>
											<fix_asin_qunt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4003_l_2>
						</gridData>
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<keyData/>
						<budg_cdnm/>
						<dept_cdnm/>
						<evnt_cdnm/>
						<budg_yymm/>
						<budg_yymm2/>
						<budg_cd2/>
						<dept_cd2/>
						<evnt_cd2/>
						<budg_cdnm2/>
						<dept_cdnm2/>
						<evnt_cdnm2/>
						<radio1/>
						<radio2/>
						<radio3/>
						<bgatm/>
						<bgsumatm/>
						<fc_co_1101_l>
							<dataSet>
								<CURLIST1>
									<record>
										<cmpy_cd/>
										<dept_cd/>
										<dept_team_clsf/>
										<abrv_nm/>
										<offi_nm/>
										<dept_team_nm/>
										<part_nm/>
										<part_dn_nm/>
									</record>
								</CURLIST1>
							</dataSet>
						</fc_co_1101_l>
					</tempData>
					<!-- 저장소 -->
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
				//컨트롤 초기화
				init_controls();
				
								
				]]>
			</script>
			<submission id="mc_budg_4005_l" action="/mc/budg4000/4005" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/resData/resform/mc_budg_4005_l/dataSet"/>
			<submission id="mc_budg_4003_l" action="/mc/budg4000/4003" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4003_l" resultref="/root/resData/gridData/mc_budg_4003_l/dataSet"/>
			<submission id="mc_budg_4001_l" action="/mc/budg4000/4001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4001_l" resultref="/root/resData/resform/mc_budg_4001_l/dataSet"/>
			<submission id="mc_budg_4002_e" action="/mc/budg4000/4002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4002_e" resultref="/root/resData/resform/mc_budg_4002_e/dataSet"/>
			<submission id="mc_budg_4000_m" action="/mc/budg4000/4000" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/mc_budg_4000_m/dataSet"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				
				//load체크
				load_ch();
				button_ch();
				model.send("mc_budg_4000_m");
				//alert(model1.getValue("/root/initData/mc_budg_4000_m/dataSet/xx_budg_type_cd_010"));
				model.refresh();
				]]>
			</script>
			<submission id="mc_budg_4006_l" action="/mc/budg4000/4006" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4006_l" resultref="/root/resData/resform/mc_budg_4006_l/dataSet"/>
			<submission id="mc_budg_4004_i" action="/mc/budg4000/4004" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate/mc_budg_4004_i" resultref="/root/resData/MsgData"/>
			<submission id="fc_co_1101" action="/fc/co1000/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/fc_co_1101_l/dataSet"/>
		</model>
		<script type="javascript" src="../../../js/TFCommon.js"/>
		<script type="javascript" src="../../../js/CIISComm.js"/>
		<script type="javascript" src="../../../js/fcmc_common.js"/>
		<script type="javascript">
			<![CDATA[
			var	_oth_clsf = "1";
			
			//-------------------------------------------------------------------------------
			//	컨트롤의 기본 설정 적용 및 컨트롤 별 포맷 적용
			//-------------------------------------------------------------------------------
			function init_controls() {
				//control의 기본 설정 적용
								
				//datagrid init
				set_default(
						"it was comment field"
					,	datagrid1
					,	datagrid2
				);
				
				datagrid1.attribute("explorerbar") = "";
				datagrid2.attribute("explorerbar") = "";
		
				//combo init
				set_default(
						"it was comment field"			
				);
				//input init
				set_default(
						"it was comment field"
					,	srch_budg_yymm
					,	dept_cdnm
					,	budg_cdnm
					,	evnt_cdnm
					,	last_asin_amt
					,	budg_ask_amt
					,	budg_cndt_amt
					,	chamt
					,	bgatm
					,	budg_yymm2
					,	dept_cd2
					,	dept_cdnm2
					,	budg_cdnm2
					,	evnt_cd2
					,	evnt_cdnm2
					,	last_asin_amt2
					,	budg_ask_amt2
					,	budg_cndt_amt2
					,	chamt2
					,	bgsumatm
				);
				//input button init
				set_default(
						"it was comment field"
					,	srch_dept_cd
					,	srch_budg_cd
					,	srch_evnt_cd
					,	budg_cd2
				);
				//input date init
				set_default(
						"it was comment field"
				);

				//control format 설정 적용
				
				//코드
				set_format(
						"code"						//코드포맷,중간정렬,중간정렬
					,	datagrid1				,"1,2,3,5,6"
					,	datagrid2				,"1,2,3,5,6"
					,	srch_dept_cd
					,	srch_budg_cd
					,	srch_evnt_cd
					,	dept_cd2
					,	budg_cd2
					,	evnt_cd2
				);
				
				//금액
				set_format(
						"number1"						//숫자포맷,오른쪽정렬,중간정렬,(#,###)
					,	datagrid1				,"7,8"
					,	datagrid2				,"7"
					,	last_asin_amt
					,	budg_ask_amt
					,	budg_cndt_amt
					,	chamt
					,	bgatm
					,	last_asin_amt2
					,	budg_ask_amt2
					,	budg_cndt_amt2
					,	chamt2
					,	bgsumatm
				);
				
				//날짜
				set_format(
						"month_1"						//날짜포맷,중간정렬,중간정렬,yyyy-mm-dd
					,	srch_budg_yymm
					,	budg_yymm2
					,   max_yymm
				);
				
				
				
				//문자열(왼쪽)
				set_format(
						"string_l"						//문자열,왼쪽정렬,중간정렬
					,	datagrid1				,"4"
					,	datagrid2				,"4"
					,	dept_cdnm
					,	budg_cdnm
					,	evnt_cdnm
					,	dept_cdnm2
					,	budg_cdnm2
					,	evnt_cdnm2
				);
			}
			
			var W_CYM;
			var W_GHjmg;				//경리최대확정마감년도
			var W_MGYB;
			
			var button_check;
			
			function button_ch(){
				if(button_check == "true"){
					btn_select.disabled = true;
					btn_insert.disabled = true;
					btn_reset.disabled = true;
				}
			}
			
			function send_mc_budg_4002_e(kind,yymm){
				var ref = "root/reqData/searchData/mc_budg_4002_e/";
				model.setValue(ref + "budg_yymm" , yymm);
				model.setValue(ref + "kind" , kind);
				
				model.send("mc_budg_4002_e");
				if(kind == "1"){
					if(get_refvalue("/root/resData/resform/mc_budg_4002_e/dataSet/CURLIST/record/sub_cd") == ""){
						return false;
					}else{
						return true;
					}
				}else if(kind == "2"){
					var ch_var = get_refvalue("/root/resData/resform/mc_budg_4002_e/dataSet/CURLIST/record/clos_yn");
					if(ch_var == ""){return true;}
					if(ch_var == "Y"){
						return false;
					}else{
						return true;
					}
				}
				
			}
			
			function load_ch(){

				//권한체크 필요!!!
				
				model.send("mc_budg_4005_l");
				var ref_4005 = "/root/resData/resform/mc_budg_4005_l/dataSet/";
				if(get_refvalue(ref_4005 + "CURLIST1/totalcnt") > 0){
					W_CYM = get_refvalue(ref_4005 + "CURLIST1/record/max_yymm");
					//W_CYM = "20081101";
				}
				if(get_refvalue(ref_4005 + "CURLIST2/totalcnt") > 0){
					W_GHjmg = get_refvalue(ref_4005 + "CURLIST2/record/max_sub_cd");
				}
				
				var yymm_var = srch_budg_yymm.value;
				if(yymm_var.substring(4,6) == "12"){
					//예산확정마감조회
					yymm_var = (Number(W_CYM.substring(0,4))+1);
					if(!send_mc_budg_4002_e("1",yymm_var)){
						show_message("경리마감이 되어있지 않으므로 변경이 불가능합니다.");
						srch_budg_yymm.value = "";
						srch_budg_yymm.attribute("editable") = "false";
						budg_yymm2.attribute("editable") = "false";
						button_check = "true";
						srch_dept_cd.attribute("editable") = "false";
						srch_budg_cd.attribute("editable") = "false";
						srch_evnt_cd.attribute("editable") = "false";
						
//						budg_cd2.attribute("editable") = "false";

						//dept_cd2.attribute("editable") = "false";
						//budg_cd2.disabled = true;						
						//evnt_cd2.attribute("editable") = "false";
						/*
						radio1.disabled = true;
						radio2.disabled = true;
						radio3.disabled = true;
						*/
					}else{
//						srch_budg_yymm.value = yymm_var + "01";
						srch_budg_yymm.value = srch_budg_yymm.value.substring(0,6);
					}					
				}else{
					srch_budg_yymm.value = srch_budg_yymm.value.substring(0,6);
				}
				yymm_ch();
				
			}
			
//			function open_mc_co_1010() {
//				var popid = "mc_co_1010";
//				var rcvs_flag = false;
//				
//				if (event != null && event.name == "xforms-value-changed") {
//					//값이 변경되면 기존에 조회된 자료를 모두 제거한다.
//					reset_popup_rcvs_data(popid);
//				}
//				
//				set_popup_send_data(popid,"mode","sr");
//				set_popup_send_data(popid,"title","");
//				set_popup_send_data(popid,"readonly","0");
//				set_popup_send_data(popid,"datafilter","");				
//				set_popup_send_data(popid,"dept_cd",get_refvalue(srch_dept_cd));
//				set_popup_send_data(popid,"require","dept_cd");	
//				
//				rcvs_flag = call_mc_co_1010(false);
//				if (rcvs_flag) {
//					//정상처리
//				}
//				else {
//					//취소버튼을 누른 경우 조회 조회를 위한 값과 조회된 값이 틀린 경우 기존 값을 모두 제거한다.
//				}
//				
//				if (event != null && event.name == "xforms-value-changed" && !rcvs_flag) {
//					if (get_refvalue(srch_dept_cd) != "") {
//						//show_message("사용가능한 부서코드가 아닙니다");
//					}
//					set_refvalue(srch_dept_cd,"");
//					set_refvalue(dept_cdnm,"");
//					set_refvalue(srch_budg_cd,"");
//					set_refvalue(budg_cdnm,"");
//					datagrid_data_clear(datagrid1);
//					datagrid_data_clear(datagrid2);
//					set_refvalue(srch_evnt_cd,"");
//					set_refvalue(evnt_cdnm,"");
//					
//				}
//				set_refvalue(srch_dept_cd,get_popup_rcvs_data(popid,"dept_cd"));
//				set_refvalue(dept_cdnm,get_popup_rcvs_data(popid,"abrv_nm"));
//				
//				return rcvs_flag;
//			}
			function setDept_cd(iv_dept_cd, iv_dept_nm, iv_dept_team_clsf, iv_offi_nm, iv_dept_team_nm, iv_part_nm, iv_part_dn_nm){	
				set_refvalue(srch_dept_cd, iv_dept_cd);
				set_refvalue(dept_cdnm, iv_dept_nm);
			}
			function setDept_cd2(iv_dept_cd, iv_dept_nm, iv_dept_team_clsf, iv_offi_nm, iv_dept_team_nm, iv_part_nm, iv_part_dn_nm){	
				set_refvalue(dept_cd2, iv_dept_cd);
				set_refvalue(dept_cdnm2, iv_dept_nm);
			}			
			
				
			function open_mc_co_1020_evnt_cd() {
				var popid = "mc_co_1020";
				var rcvs_flag = false;

				if (!check_reqItem(srch_dept_cd,"trim","focus","부서코드를 먼저 조회하세요.")) {return false;}
				if (!check_reqItem(dept_cdnm,"trim",srch_dept_cd,"부서코드 조회가 되지 않았습니다. 부서코드를 먼저 조회하세요.")) {return false;}

				if (event != null && event.name == "xforms-value-changed") {
					//값이 변경되면 기존에 조회된 자료를 모두 제거한다.
					reset_popup_rcvs_data(popid);
				}
				
				set_popup_send_data(popid,"mode","sr");
				set_popup_send_data(popid,"title","고유행사코드조회");
				set_popup_send_data(popid,"readonly","0");
				set_popup_send_data(popid,"datafilter","");	
				//행사코드조회
				set_popup_send_data(popid,"searchid","16");
				set_popup_send_data(popid,"msg","[" + dept_cdnm.value + "] 부서에서 등록한 예산행사코드만이 조회됩니다.");
				//부서코드가 정상적으로 조회된 경우에만 처리해야 함
				set_popup_send_data(popid,"dept_cd",srch_dept_cd.value);
				set_popup_send_data(popid,"cd",srch_evnt_cd.value);
				set_popup_send_data(popid,"cdnm","");
				
				set_popup_send_data(popid,"require","cd");	
				
				rcvs_flag = call_mc_co_1020("mc_co_1005_l","CURLIST",false);
				if (rcvs_flag) {
					//정상처리
				}
				else {
					//취소버튼을 누른 경우 조회 조회를 위한 값과 조회된 값이 틀린 경우 기존 값을 모두 제거한다.
				}
				
				//value-changed 와 buttonclick이 동시 발생했을 경우
				//이하 코드는 두번씩 실행되므로 무거운 코드는 넣지 않도록 하자

				//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
				//다시 조회 하기 쉽도록 하고
				if (get_popup_rcvs_data(popid,"cd") != "") {
					set_refvalue(srch_evnt_cd,get_popup_rcvs_data(popid,"cd"));
				}
				
				set_refvalue(evnt_cdnm,get_popup_rcvs_data(popid,"cdnm"));
				
				return rcvs_flag;
			}
			
			function open_mc_co_1020_evnt_cd2() {
				var popid = "mc_co_1020";
				var rcvs_flag = false;

				if (!check_reqItem(dept_cd2,"trim","focus","부서코드를 먼저 조회하세요.")) {return false;}
				if (!check_reqItem(dept_cdnm,"trim",srch_dept_cd,"부서코드 조회가 되지 않았습니다. 부서코드를 먼저 조회하세요.")) {return false;}

				if (event != null && event.name == "xforms-value-changed") {
					//값이 변경되면 기존에 조회된 자료를 모두 제거한다.
					reset_popup_rcvs_data(popid);
				}
				
				set_popup_send_data(popid,"mode","sr");
				set_popup_send_data(popid,"title","고유행사코드조회");
				set_popup_send_data(popid,"readonly","0");
				set_popup_send_data(popid,"datafilter","");	
				//행사코드조회
				set_popup_send_data(popid,"searchid","16");
				set_popup_send_data(popid,"msg","[" + dept_cdnm2.value + "] 부서에서 등록한 예산행사코드만이 조회됩니다.");
				//부서코드가 정상적으로 조회된 경우에만 처리해야 함
				set_popup_send_data(popid,"dept_cd",dept_cd2.value);
				set_popup_send_data(popid,"cd",evnt_cd2.value);
				set_popup_send_data(popid,"cdnm","");
				
				set_popup_send_data(popid,"require","cd");	
				
				rcvs_flag = call_mc_co_1020("mc_co_1005_l","CURLIST",false);
				if (rcvs_flag) {
					//정상처리
				}
				else {
					//취소버튼을 누른 경우 조회 조회를 위한 값과 조회된 값이 틀린 경우 기존 값을 모두 제거한다.
				}
				
				//value-changed 와 buttonclick이 동시 발생했을 경우
				//이하 코드는 두번씩 실행되므로 무거운 코드는 넣지 않도록 하자

				//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
				//다시 조회 하기 쉽도록 하고
				if (get_popup_rcvs_data(popid,"cd") != "") {
					set_refvalue(srch_evnt_cd,get_popup_rcvs_data(popid,"cd"));
				}
				
				set_refvalue(evnt_cdnm2,get_popup_rcvs_data(popid,"cdnm"));
				
				return rcvs_flag;
			}			
			
			function open_mc_co_1020_budg_cd2() {
				var budg_cd2_var = budg_cd2.value;
				//alert(budg_cd2_var);
				/*
				if(budg_cd2_var == "" || budg_cd2_var.length != 6){
					budg_cd2.value = "";
					budg_cdnm2.value = ""
					return false;
				}
				*/
				
				var popid = "mc_co_1020";
				var rcvs_flag = false;

//					if (!check_reqItem(dept_cd,"trim","focus","부서코드를 먼저 조회하세요.")) {return false;}
//					if (!check_reqItem(srch_abrv_nm,"trim",dept_cd,"부서코드 조회가 되지 않았습니다. 부서코드를 먼저 조회하세요.")) {return false;}

				if (event != null && event.name == "xforms-value-changed") {
					//값이 변경되면 기존에 조회된 자료를 모두 제거한다.
					reset_popup_rcvs_data(popid);
				}
				
				set_popup_send_data(popid,"mode","sr");
				set_popup_send_data(popid,"title","예산코드조회");
				set_popup_send_data(popid,"readonly","0");
				set_popup_send_data(popid,"datafilter","");	
				//행사코드조회
				set_popup_send_data(popid,"searchid","2");
//					set_popup_send_data(popid,"msg","[" + srch_abrv_nm.value + "] 부서에서 등록한 예산행사코드만이 조회됩니다.");
				//부서코드가 정상적으로 조회된 경우에만 처리해야 함
//					set_popup_send_data(popid,"dept_cd",dept_cd.value);
				set_popup_send_data(popid,"cd",get_refvalue(budg_cd2));
				set_popup_send_data(popid,"cdnm","");
				set_popup_send_data(popid,"require","cd");	
				set_popup_send_data(popid,"dept_cd",dept_cd2.value);
				
				rcvs_flag = call_mc_co_1020("mc_co_1002_l","CURLIST",false);
				//alert(rcvs_flag);
				if (rcvs_flag) {
					//정상처리
				}
				else {
					//취소버튼을 누른 경우 조회 조회를 위한 값과 조회된 값이 틀린 경우 기존 값을 모두 제거한다.
				}
				
				//value-changed 와 buttonclick이 동시 발생했을 경우
				//이하 코드는 두번씩 실행되므로 무거운 코드는 넣지 않도록 하자

				//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
				//다시 조회 하기 쉽도록 하고
				if (get_popup_rcvs_data(popid,"cd") != "") {
					set_refvalue(budg_cd2,get_popup_rcvs_data(popid,"cd"));
				}
				set_refvalue(budg_cdnm2,get_popup_rcvs_data(popid,"cdnm"));
				
				return rcvs_flag;
			}
			
			function open_mc_co_1020_budg_cd() {
				var popid = "mc_co_1020";
				var rcvs_flag = false;

//					if (!check_reqItem(dept_cd,"trim","focus","부서코드를 먼저 조회하세요.")) {return false;}
//					if (!check_reqItem(srch_abrv_nm,"trim",dept_cd,"부서코드 조회가 되지 않았습니다. 부서코드를 먼저 조회하세요.")) {return false;}

				if (event != null && event.name == "xforms-value-changed") {
					//값이 변경되면 기존에 조회된 자료를 모두 제거한다.
					reset_popup_rcvs_data(popid);
				}
				
				set_popup_send_data(popid,"mode","sr");
				set_popup_send_data(popid,"title","예산코드조회");
				set_popup_send_data(popid,"readonly","0");
				set_popup_send_data(popid,"datafilter","");	
				//행사코드조회
				set_popup_send_data(popid,"searchid","2");
//					set_popup_send_data(popid,"msg","[" + srch_abrv_nm.value + "] 부서에서 등록한 예산행사코드만이 조회됩니다.");
				//부서코드가 정상적으로 조회된 경우에만 처리해야 함
//					set_popup_send_data(popid,"dept_cd",dept_cd.value);
				set_popup_send_data(popid,"cd",get_refvalue(srch_budg_cd));
				set_popup_send_data(popid,"cdnm","");
				set_popup_send_data(popid,"require","cd");	
				set_popup_send_data(popid,"dept_cd",srch_dept_cd.value	);
				
				rcvs_flag = call_mc_co_1020("mc_co_1002_l","CURLIST",false);
				if (rcvs_flag) {
					//정상처리
				}
				else {
					//취소버튼을 누른 경우 조회 조회를 위한 값과 조회된 값이 틀린 경우 기존 값을 모두 제거한다.
				}
				
				//value-changed 와 buttonclick이 동시 발생했을 경우
				//이하 코드는 두번씩 실행되므로 무거운 코드는 넣지 않도록 하자

				//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
				//다시 조회 하기 쉽도록 하고
				if (get_popup_rcvs_data(popid,"cd") != "") {
					set_refvalue(srch_budg_cd,get_popup_rcvs_data(popid,"cd"));
				}
				set_refvalue(budg_cdnm,get_popup_rcvs_data(popid,"cdnm"));
				
				return rcvs_flag;
			}
			
			function select_1(ch){
				var ref="/root/reqData/searchData/mc_budg_4001_l/";
				if(ch == "1"){
					set_refvalue(ref + "budg_yymm_fr",srch_budg_yymm.value);
					set_refvalue(ref + "budg_yymm_to",srch_budg_yymm.value);
					set_refvalue(ref + "budg_cd_fr",srch_budg_cd.value);
					set_refvalue(ref + "budg_cd_to",srch_budg_cd.value);
					set_refvalue(ref + "dept_cd_fr",srch_dept_cd.value);
					set_refvalue(ref + "dept_cd_to",srch_dept_cd.value);
					set_refvalue(ref + "evnt_cd_fr",srch_evnt_cd.value);
					set_refvalue(ref + "evnt_cd_to",srch_evnt_cd.value);
				}
				if(ch == "2"){
					set_refvalue(ref + "budg_yymm_fr",budg_yymm2.value);
					set_refvalue(ref + "budg_yymm_to",budg_yymm2.value);
					set_refvalue(ref + "budg_cd_fr",budg_cd2.value);
					set_refvalue(ref + "budg_cd_to",budg_cd2.value);
					set_refvalue(ref + "dept_cd_fr",dept_cd2.value);
					set_refvalue(ref + "dept_cd_to",dept_cd2.value);
					set_refvalue(ref + "evnt_cd_fr",evnt_cd2.value);
					set_refvalue(ref + "evnt_cd_to",evnt_cd2.value);
				}
							
				model.send("mc_budg_4001_l");		
				
				if(ch == "1"){
					model.copyNode("/root/resData/resform/mc_budg_4001_l_1","/root/resData/resform/mc_budg_4001_l");
				}else{
					model.copyNode("/root/resData/resform/mc_budg_4001_l_2","/root/resData/resform/mc_budg_4001_l");
				}
			}
			
			function select_2(ch){
				var ref = "/root/reqData/searchData/mc_budg_4003_l/"
				if(ch == "1"){
					model.setValue(ref + "budg_yymm" , srch_budg_yymm.value);
					model.setValue(ref + "dept_cd" , srch_dept_cd.value);
					model.setValue(ref + "budg_cd" , srch_budg_cd.value);
					model.setValue(ref + "evnt_cd" , srch_evnt_cd.value);					
				}
				if(ch == "2"){
					model.setValue(ref + "budg_yymm" , budg_yymm2.value);
					model.setValue(ref + "dept_cd" , dept_cd2.value);
					model.setValue(ref + "budg_cd" , budg_cd2.value);
					model.setValue(ref + "evnt_cd" , evnt_cd2.value);
				}
								
				model.send("mc_budg_4003_l");
				
				if(ch == "1"){
					model.copyNode("/root/resData/gridData/mc_budg_4003_l_1","/root/resData/gridData/mc_budg_4003_l");
					//datagrid1.refresh;
				}else{
					model.copyNode("/root/resData/gridData/mc_budg_4003_l_2","/root/resData/gridData/mc_budg_4003_l");
					//datagrid2.refresh;
				}
				
				//model.refresh;
				//alert("aa1");
				if(ch == "1"){
					/*
					radio1.disabled = true;
					radio2.disabled = true;
					radio3.disabled = true;
					*/
					var fix_asin_amt_ref = datagrid1.colRef("fix_asin_amt");
					var fix_asin_uprc_ref = datagrid1.colRef("fix_asin_uprc");
					var ch_var = 0;
					for(i = datagrid1.fixedRows ; i <= datagrid1.rows ; i++){
						ch_var = datagrid1.valueMatrix(i,fix_asin_amt_ref);
						if(ch_var > 0){
							datagrid1.isReadOnly(i,fix_asin_uprc_ref) = false;
						}else{
							datagrid1.isReadOnly(i,fix_asin_uprc_ref) = true;
						}
					}
				}else{
					bgatm.value = "0";
					bgsumatm.value = "0";
				}
					/*
					if(radio3.value != "2"){
						dept_cd2.value = srch_dept_cd.value;
						dept_cdnm2.value = dept_cdnm.value;
						dept_cd2.disabled = true;
					}
					*/
					//evnt_cd2.value = srch_evnt_cd.value;
					//evnt_cdnm2.value = evnt_cdnm.value;
					//evnt_cd2.disabled = true;
					

				
			}
			
			function send_mc_budg_4001_l(){
				//필수항목체크(검색)
				if(!commReqCheck(group_scr)) {
					return false;
				}
				
				//alert("1");

				//alert("2");

				//alert("3");
				from_clear();				
				datagrid_data_clear(datagrid1);
				select_1("1");
				select_2("1");

				to_clear();				
				datagrid_data_clear(datagrid2);
				select_1("2");
				select_2("2");
/*
				var ex_ref = datagrid1.colRef("ex");
				datagrid1.colDisabled(ex_ref) = false;
				
				datagrid1.refresh;
				datagrid2.refresh;
*/				
			}
			
			function from_clear(){
				last_asin_amt.value = "";
				budg_ask_amt.value = "";
				budg_cndt_amt.value = "";
				chamt.value = "";
			}
			
			function to_clear(){
				last_asin_amt2.value = "";
				budg_ask_amt2.value = "";
				budg_cndt_amt2.value = "";
				chamt2.value = "";
			}
			
			function yymm_ch(){
				var yymm_var = srch_budg_yymm.value;
				if(yymm_var.length == 1 || yymm_var.length == 0){return false;}
				
				var ref_work_no1 = datagrid1.colRef("work_no");
				var ref_work_no2 = datagrid2.colRef("work_no");
				if(datagrid1.valueMatrix(datagrid1.fixedRows,ref_work_no1) == ""){
					datagrid_data_clear(datagrid1);
				}
				if(datagrid2.valueMatrix(datagrid2.fixedRows,ref_work_no2) == ""){
					datagrid_data_clear(datagrid2);
				}
				radio1.value = "";
				radio2.value = "";
				radio3.value = "";
				
				if(yymm_var.length == 6){
					/*
					if(yymm_var.substring(0,4) > W_GHjmg){
						show_message("[" + yymm_var.substring(0,4) + "년] 에 대한 경리마감처리가 되지 않았으므로 변경작업을 할 수 없습니다.")
						srch_budg_yymm.value = "";
						return false;
					}
					*/
					
					//alert(W_CYM);
					
					if(W_CYM > yymm_var.value){
						show_message("해당 월은 월마감되었으므로 처리가 불가능합니다.");
						srch_budg_yymm.value = "";
						return false;
					}
					
					if( (yymm_var - W_CYM > 0 && yymm_var - W_CYM <= 2) || W_CYM.substring(4,6) == "12"){
						budg_yymm2.value = yymm_var;
					}else{
						show_message(W_CYM + "로 월마감 되었으므로 해당 년월은 변경가능개월(2개월)의 범위를 초과하였습니다.");
						srch_budg_yymm.value = "";
						return false;
					}
				}
				
			}
			
			function radio_ch(ch){
/*				
				if(ch == "0"){
					radio1.value = "0";
					radio2.value = "";
					radio3.value = "";
				}
				if(ch == "1"){
					radio1.value = "";
					radio2.value = "1";
					radio3.value = "";
				}
				if(ch == "2"){
					radio1.value = "";
					radio2.value = "";
					radio3.value = "2";
				}
				if(ch == "0" || ch == "1"){
					budg_yymm2.attribute("editable") = "true";
					budg_yymm2.value = "";
					budg_cd2.disabled = true;
//					budg_cd2.attribute("editable") = "false";
					evnt_cd2.attribute("editable") = "false";
					budg_cd2.value = srch_budg_cd.value;
					budg_cdnm2.value = budg_cdnm.value;
					evnt_cd2.value = srch_evnt_cd.value;
					evnt_cdnm2.value = evnt_cdnm.value;
					model.setFocus("budg_yymm2");
				}else{
					budg_cd2.disabled = false;
//					budg_cd2.attribute("editable") = "true";
					evnt_cd2.attribute("editable") = "true";
					budg_cd2.value = "";
					budg_cdnm2.value = "";
					budg_yymm2.attribute("editable") = "false";
					model.setFocus("budg_cd2");
				}
*/	
				return;

			}
			
			function budg_cd_ch(){
				set_refvalue("/root/reqData/searchData/mc_budg_4006_l/budg_cd",srch_budg_cd.value);
				model.send("mc_budg_4006_l");
				var ref_4006 = "/root/resData/resform/mc_budg_4006_l/dataSet/CURLIST/"
				if(get_refvalue(ref_4006 + "totalcnt") == 0){
					return false;
				}
				//if(get_refvalue(ref_4006 + "record/budg_type_cd") != "01"){
				if(get_refvalue(ref_4006 + "record/budg_type_cd") != model1.getValue("/root/initData/mc_budg_4000_m/dataSet/xx_budg_type_cd_010")){
					show_message("해당 예산은 변경대상이 아닙니다.(일반경비예산만 변경가능)");
					srch_budg_cd.value = "";
					budg_cd2.value = "";
					budg_cdnm.value = "";
					budg_cdnm2.value = "";
					return false;
				}
				
				var ch_var = 0;
				//조기집행
				if(get_refvalue(ref_4006 + "record/advc_cndt_yn") != "Y"){
					radio2.disabled = true;
				}else{
					radio2.disabled = false;
					ch_var = ch_var + 1;					
				}
				
				//이월
				if(get_refvalue(ref_4006 + "record/cyov_yn") != "Y"){
					radio1.disabled = true;
				}else{
					radio1.disabled = false;
					ch_var = ch_var + 1;										
				}
				
				//전용
				if(get_refvalue(ref_4006 + "record/lesd_yn") != "Y"){
					radio3.disabled = true;
				}else{
					radio3.disabled = false;
					ch_var = ch_var + 1;										
				}
				
				if(ch_var == 0){
					show_message("해당 예산코드는 예산변경에 관한 정보가 없거나 변경할 수 없는 자료입니다.. 확인하세요.");
					srch_budg_cd.value = "";
					budg_cd2.value = "";
					budg_cdnm.value = "";
					budg_cdnm2.value = "";
				}
				
			}
			
			function budg_cd2_ch(){
				set_refvalue("/root/reqData/searchData/mc_budg_4006_l/budg_cd",budg_cd2.value);
				model.send("mc_budg_4006_l");
				var ref_4006 = "/root/resData/resform/mc_budg_4006_l/dataSet/CURLIST/"
				if(get_refvalue(ref_4006 + "totalcnt") == 0){
					return false;
				}
				//if(get_refvalue(ref_4006 + "record/budg_type_cd") != "01"){
				if(get_refvalue(ref_4006 + "record/budg_type_cd") != model1.getValue("/root/initData/mc_budg_4000_m/dataSet/xx_budg_type_cd_010")){
					show_message("해당 예산은 변경대상이 아닙니다.(일반경비예산만 변경가능)");
					budg_cd2.value = "";
					budg_cdnm2.value = "";
					return false;
				}
			}
			
			function datagrid1_ch(){
				var medi_cd_ref = datagrid1.colRef("medi_cd");
				var fix_asin_amt_ref = datagrid1.colRef("fix_asin_amt");
				if(medi_cd_ref != datagrid1.col){
					return false;
				}
				if(W_MGYB == 0 || W_MGYB == ""){
					return false;
				}
				var ch_var;
				var select_var = 0;
				select_var = radio1.value + radio2.value + radio3.value;
				if(radio1.disabled == true){
					select_var = select_var + 1;
				}
				if(radio2.disabled == true){
					select_var = select_var + 1;
				}
				if(radio3.disabled == true){
					select_var = select_var + 1;
				}
				if(select_var == 0 && ch_var == 0){
					show_message("월변경 종류를 먼저 선택하세요");
					return false;
				} 				
			}
			
			function datagrid1_value_ch(){
				var ch_var;
				var select_var = 0;
				/*
				select_var = radio1.value + radio2.value + radio3.value;
				if(radio1.disabled == true){
					select_var = select_var + 1;
				}
				if(radio2.disabled == true){
					select_var = select_var + 1;
				}
				if(radio3.disabled == true){
					select_var = select_var + 1;
				}
				if(select_var == 0 && ch_var == 0){
					show_message("월변경 종류를 먼저 선택하세요");
					return false;
				} 
				*/
				var amt = 0;
				var row = datagrid1.row;
				var col = datagrid1.col;				
				var fix_asin_amt_ref = datagrid1.colRef("fix_asin_amt");
				var fix_asin_amt_uprc = datagrid1.colRef("fix_asin_uprc");
				amt = datagrid_data_sum(datagrid1,datagrid1.fixedRows, fix_asin_amt_ref, datagrid1.rows, fix_asin_amt_ref);
				if(amt < datagrid1.valueMatrix(row,fix_asin_amt_uprc)){
					show_message("예산금액을 초과하였습니다.(변경가능최대금액 : " + amt+"원)");
					return false;
				}
				amt = datagrid_data_sum(datagrid1,datagrid1.fixedRows, fix_asin_amt_uprc, datagrid1.rows, fix_asin_amt_uprc);
				if(amt <= chamt.value){
					set_refvalue(bgatm,amt);
					set_refvalue(bgsumatm,amt);
				}else{
					show_message("변경가능한 금액을 초과하였습니다.");
					return false;
				}
				if((datagrid1.valueMatrix(row,fix_asin_amt_uprc) == 0) || (datagrid1.valueMatrix(row,fix_asin_amt_uprc) == "")){
					datagrid1.rowStatus(row) = 0;
				}
				//datagrid_data_ch();
			}
			
			function datagrid_data_ch(){
				if(!checkref(budg_yymm2)){
					return false;
				}
				var jseq_var = datagrid2.rows + 1;
				var seq_var = datagrid2.rows + 1;
				if(jseq_var < 10){
					jseq_var = "00" + jseq_var;
				}else if(jseq_var >= 10 && jseq_var < 100){
					jseq_var = "0" + jseq_var;
				}
				if(seq_var < 10){
					seq_var = "00" + seq_var;
				}else if(seq_var >= 10 && seq_var < 100){
					seq_var = "0" + seq_var;
				}
				var row_1 = datagrid1.row;
				var fix_asin_uprc_ref = datagrid1.colRef("fix_asin_uprc");
				var ch_row;
				for(i = datagrid2.fixedRows ; i <= datagrid2.rows ; i ++){
						if(datagrid2.valueMatrix(i,datagrid2.colRef("ch")) ==  row_1){
							ch_row = i;
						}
					}
				if(datagrid1.valueMatrix(row_1,fix_asin_uprc_ref) == ""){
					datagrid2.deleteColumn(ch_row);
					return false;
				}
				if(ch_row == ""){
					datagrid2.addRow();
					var add_row = datagrid2.rows;
					datagrid2.valueMatrix(add_row,1) = jseq_var;
					datagrid2.valueMatrix(add_row,2) = seq_var;
					datagrid2.valueMatrix(add_row,3) = datagrid1.valueMatrix(row_1,3);
					datagrid2.valueMatrix(add_row,4) = datagrid1.valueMatrix(row_1,4);
					datagrid2.valueMatrix(add_row,5) = datagrid1.valueMatrix(row_1,5);
					datagrid2.valueMatrix(add_row,6) = datagrid1.valueMatrix(row_1,6);
					datagrid2.valueMatrix(add_row,7) = datagrid1.valueMatrix(row_1,8);
					datagrid2.valueMatrix(add_row,8) = row_1;
				}else{
					datagrid2.valueMatrix(ch_row,7) = datagrid1.valueMatrix(row_1,8);
				}
				
			}
			
			function budg_yymm2_ch(){
				var yymm_var2 = budg_yymm2.value;
				var yymm_var = srch_budg_yymm.value;
				if(yymm_var2 == "" || yymm_var2.length!= 6){
					return false;
				}
				if(yymm_var2 > yymm_var){
					if(W_CYM.substring(4,6) == "12" || ((yymm_var2 - W_CYM) > 0 && (yymm_var2 - W_CYM) <= 2)){
						if(checkbox1.value != "Y"){
							show_message("해당 예산코드는 이월불가능한 예산코드입니다.");
							set_refvalue(budg_yymm2,srch_budg_yymm.value);
							return false;
						}
/*							
						radio1.value = 0;
						radio2.value = "";
						radio3.value = "";
						if(radio1.attribute("disabled") == "false"){
							model.setFocus("radio1");
						}else{
							show_message("해당 예산코드는 이월불가능한 예산코드입니다.");
							set_refvalue(budg_yymm2,srch_budg_yymm.value);
							return false;
						}
*/						
					}else{
						show_messgae(W_CYM + "로 월마감되었으므로 해당 년월은 변경가능년월의 범위를 초과하였습니다.");
						set_refvalue(budg_yymm2,"");
						return false;
					}
				}else if(yymm_var2 < yymm_var){
					if(checkbox2.value != "Y"){
						show_message("해당 예산코드는 조기집행이 불가능한 예산코드입니다.");
						set_refvalue(budg_yymm2,srch_budg_yymm.value);
						return false;
					}
					/*
					radio1.value = "";
					radio2.value = 1;
					radio3.value = "";
					if(radio2.attribute("disabled") == "false"){
						model.setFocus("radio2");
					}else{
						show_message("해당 예산코드는 조기집행이 불가능한 예산코드입니다.");
						set_refvalue(budg_yymm2,srch_budg_yymm.value);
						return false;
					}
					*/
				}
				/*
				if(radio2.value != ""){
					if(yymm_var2 >= yymm_var){
						show_message("잘못된 형식입니다.");
						set_refvalue(budg_yymm2,"");
						return false;
					}
				}else if(radio1.value != ""){
					if(yymm_var2 <= yymm_var){
						show_message("잘못된 형식입니다.");
						set_refvalue(budg_yymm2,"");
						return false;
					}
				}
				*/
				if(!send_mc_budg_4002_e("1",budg_yymm2.value)){
					show_message("경리마감처리가 되지 않았으므로 변경불가능합니다.");
					return false;
				}
				if(!send_mc_budg_4002_e("2",budg_yymm2.value)){
					show_message("해당 월은 월마감되었으므로 처리가 불가능합니다.");
					set_refvalue(budg_yymm2,"");
					return false;
				}
				else{
					if(W_CYM >yymm_var){
						show_message("해당 월은 월마감되었으므로 처리가 불가능합니다.");
						set_refvalue(budg_yymm2,"");
						return false;
					}
				}
				select_2("2");
			}
			
			function send_mc_budg_4004_i(){
				if(!send_mc_budg_4002_e("1",srch_budg_yymm.value)){
					show_message("경리마감처리가 되지 않았으므로 변경불가능합니다.");
					return false;
				}else{
					if(!send_mc_budg_4002_e("2",srch_budg_yymm.value)){
						show_message("해당 월은 월마감되었으므로 처리가 불가능합니다.");
						return false;
					}
				}

				var cnt_var = datagrid1.rows - datagrid1.fixedRows + datagrid2.rows - datagrid2.fixedRows;
				if(cnt_var == 0){
					return false;
				}

				var ref_4004 = "/root/reqData/multiUpDate/mc_budg_4004_i/";

				set_refvalue(ref_4004 + "from_iwamt", bgatm.value);
				set_refvalue(ref_4004 + "to_iwamt",bgsumatm.value);

				var crte_clsf_var;
				
				crte_clsf_var = "0";
				// 이월, 조기집행
				if(srch_budg_yymm.value != budg_yymm2.value){
					if(srch_budg_yymm.value < budg_yymm2.value){
						crte_clsf_var = "2";
						if(checkbox1.value != "Y"){
							show_message("해당 예산은 이월 불가능한 예산입니다. 예산코드를 확인하세요!!!");
							return false;
						}
					}
					if(srch_budg_yymm.value > budg_yymm2.value){
						crte_clsf_var = "4";
						if(checkbox2.value != "Y"){
							show_message("해당 예산은 조기집행이 불가능한 예산입니다. 예산코드를 확인하세요!!!");
							return false;
						}						
					}
				}
				
				// 전용(예산코드)
				if(srch_budg_cd.value != budg_cd2.value){
					crte_clsf_var = "3";
					if(checkbox3.value != "Y"){
						show_message("해당 예산은 전용이 불가능한 예산입니다. 예산코드를 확인하세요!!!");
						return false;
					}					
				}	
				
				// 전용(부서)
				if(srch_dept_cd.value != dept_cd2.value){
					crte_clsf_var = "3";
					if(checkbox3.value != "Y"){
						show_message("해당 예산은 전용이 불가능한 예산입니다. 예산코드를 확인하세요!!!");
						return false;
					}					
				}
				
				// 전용(행사코드)
				if(srch_evnt_cd.value != evnt_cd2.value){
					crte_clsf_var = "3";
					if(checkbox3.value != "Y"){
						show_message("해당 예산은 전용이 불가능한 예산입니다. 예산코드를 확인하세요!!!");
						return false;
					}					
				}
				
				if(crte_clsf_var == "0"){
					show_message("변경할 예산월,부서,예산코드,행사코드가 동일합니다.");
					return false;
				}
				/*
				if(radio1.value != ""){
					crte_clsf_var = "2";
				}else if(radio2.value != ""){
					crte_clsf_var = "4";
				}else if(radio3.value != ""){
					crte_clsf_var = "3";
				}
				*/
				
				set_refvalue(ref_4004 + "multiUpdateData", datagrid1.getUpdateData());
				set_refvalue(ref_4004 + "multiUpdateData2", datagrid2.getUpdateData());
				set_refvalue(ref_4004 + "crte_clsf",crte_clsf_var);
				set_refvalue(ref_4004 + "cnt",cnt_var);
				//set_refvalue(ref_4004 + "dept_cd",srch_dept_cd.value);
				//set_refvalue(ref_4004 + "budg_yymm",srch_budg_yymm.value);
				//set_refvalue(ref_4004 + "budg_cd",srch_budg_cd.value);
				//set_refvalue(ref_4004 + "evnt_cd",srch_evnt_cd.value);			

				model.send("mc_budg_4004_i");
				
				
				send_mc_budg_4001_l();
				/*
				select_1("1");
				select_2("1");

				budg_yymm2_ch();
				*/
				/*
				if(radio3.value != ""){
					budg_cd2.dispatch("xforms-value-changed");
				}
				*/
			}
						
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="1,10;2,11;1,874;1,878;1,893;1,899;1,913;1,917;1,936;1,936;2,30;2,39;2,42;2,49;2,705;2,688;2,680;" style="font-family:굴림; ">
		<group id="group_scr" class="gro_sel" style="left:10px; top:50px; width:926px; height:101px; ">
			<caption id="caption6" class="list_cap02" style="left:0px; top:75px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption4" class="list_cap02" style="left:0px; top:50px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption7" class="list_cap02" style="left:px; top:25px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption9" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption2" class="list_cap03" style="left:0px; top:25px; width:110px; height:26px; text-align:center; ">부서코드</caption>
			<caption id="caption3" class="list_cap03" style="left:109px; top:0px; width:110px; height:26px; text-align:center; ">예산년월</caption>
			<input id="srch_budg_yymm" ref="/root/reqData/multiUpDate/mc_budg_4004_i/budg_yymm" class="req" maxlength="6" caption="예산년월" style="left:222px; top:4px; width:90px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					yymm_ch();
					]]>
				</script>
			</input>
			<input id="srch_dept_cd" ref="/root/reqData/multiUpDate/mc_budg_4004_i/dept_cd" class="req" inputtype="button" maxlength="6" caption="부서코드" style="left:113px; top:29px; width:64px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var dept_var = srch_dept_cd.value;
					if(dept_var == ""){
						dept_cdnm.value = "";
						dept_cd2.value = "";
						dept_cdnm.value = "";
						return false;
					}
					if(dept_var.length != 6){
						show_message("[부서코드]은 잘못된 형식입니다.");
						srch_dept_cd.value = "";
						dept_cdnm.value = "";
						dept_cd2.value = "";
						dept_cdnm.value = "";
						return false;
					}
					
					var var_con_date = "";

						if (srch_budg_yymm.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_budg_yymm.value.length;
							if(num_ch == 8){
								var_con_date = srch_budg_yymm.value;
							}else if(num_ch == 6){
								var_con_date = srch_budg_yymm.value + "01";
							}else if(num_ch == 4){
								var_con_date = srch_budg_yymm.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (srch_dept_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
							model.setValue("/root/reqData/fwdData/dept_cd", srch_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "I");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								dept_cdnm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								srch_dept_cd.value = "";
								dept_cdnm.value = "";
							}
						}
						else {
							srch_dept_cd.value = "";
							dept_cdnm.value = "";
						}	
						
						dept_cd2.value = srch_dept_cd.value;
						dept_cdnm2.value = dept_cdnm.value;
						
//					if (open_mc_co_1010()) {
//						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
//						dept_cd2.value = srch_dept_cd.value;
//						dept_cdnm2.value = dept_cdnm.value;
//					}
//					else {
//						//팝업에서 취소 버튼을 누른 경우
//					}
					]]>
				</script>
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						var var_con_date = "";

						if (srch_budg_yymm.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_budg_yymm.value.length;
							if(num_ch == 8){
								var_con_date = srch_budg_yymm.value;
							}else if(num_ch == 6){
								var_con_date = srch_budg_yymm.value + "01";
							}else if(num_ch == 4){
								var_con_date = srch_budg_yymm.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "I");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						
						dept_cd2.value = srch_dept_cd.value;
						dept_cdnm2.value = dept_cdnm.value;
						
//					if (open_mc_co_1010()) {
//						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
//						dept_cd2.value = srch_dept_cd.value;
//						dept_cdnm2.value = dept_cdnm.value;
//					}
//					else {
//						//팝업에서 취소 버튼을 누른 경우
//					}
					]]>
				</script>
			</input>
			<input id="dept_cdnm" ref="/root/tempData/dept_cdnm" editable="false" style="left:179px; top:29px; width:153px; height:18px; "/>
			<input id="srch_budg_cd" ref="/root/reqData/multiUpDate/mc_budg_4004_i/budg_cd" class="req" inputtype="button" maxlength="6" caption="예산코드" style="left:113px; top:54px; width:64px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var budg_cd_var = srch_budg_cd.value;
					if(budg_cd_var == ""){
						budg_cdnm.value = "";
						budg_cd2.value = "";
						budg_cdnm2.value = ""
						return false;
					}
					budg_cd_ch();
					if (open_mc_co_1020_budg_cd()) {
						budg_cd2.value = srch_budg_cd.value;
						budg_cdnm2.value = budg_cdnm.value;
					}
					else {
						//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					if (open_mc_co_1020_budg_cd()) {
						if(!budg_cd_ch()){return false;}
						budg_cd2.value = srch_budg_cd.value;
						budg_cdnm2.value = budg_cdnm.value;
					}
					else {
						//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
			</input>
			<caption id="caption1" class="list_cap03" style="left:0px; top:50px; width:110px; height:26px; text-align:center; ">예산코드</caption>
			<input id="budg_cdnm" ref="/root/tempData/budg_cdnm" editable="false" style="left:179px; top:54px; width:153px; height:18px; "/>
			<input id="evnt_cdnm" ref="/root/tempData/evnt_cdnm" editable="false" style="left:179px; top:79px; width:153px; height:18px; "/>
			<caption id="caption5" class="list_cap03" style="left:0px; top:75px; width:110px; height:26px; text-align:center; ">행사코드</caption>
			<input id="srch_evnt_cd" ref="/root/reqData/multiUpDate/mc_budg_4004_i/evnt_cd" inputtype="button" maxlength="10" style="left:113px; top:79px; width:64px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					var evnt_cd_var = srch_evnt_cd.value;
					if(evnt_cd_var == ""){
						evnt_cdnm.value = "";
						evnt_cd2.value = "";
						evnt_cdnm2.value = "";
						return false;
					}
					if (open_mc_co_1020_evnt_cd()) {
					//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					evnt_cd2.value = srch_evnt_cd.value;
					evnt_cdnm2.value = evnt_cdnm.value;
					}
					else {
					//팝업에서 취소 버튼을 누른 경우
						}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if (open_mc_co_1020_evnt_cd()) {
					//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					evnt_cd2.value = srch_evnt_cd.value;
					evnt_cdnm2.value = evnt_cdnm.value;
					}
					else {
					//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
			</input>
			<caption id="caption8" class="list_cap03" style="left:465px; top:25px; width:110px; height:26px; text-align:center; ">확정금액</caption>
			<caption id="caption10" class="list_cap03" style="left:465px; top:50px; width:110px; height:26px; text-align:center; ">의뢰누계</caption>
			<caption id="caption11" class="list_cap03" style="left:465px; top:75px; width:110px; height:26px; text-align:center; ">집행누계</caption>
			<caption id="caption16" class="list_cap03" style="left:690px; top:75px; width:110px; height:26px; text-align:center; ">변경금액</caption>
			<caption id="caption20" class="list_cap03" style="left:690px; top:25px; width:110px; height:26px; text-align:center; ">변경가능액</caption>
			<input id="last_asin_amt" ref="/root/resData/resform/mc_budg_4001_l_1/dataSet/CURLIST/record/last_asin_amt" editable="false" style="left:578px; top:29px; width:109px; height:18px; "/>
			<input id="budg_ask_amt" ref="/root/resData/resform/mc_budg_4001_l_1/dataSet/CURLIST/record/budg_ask_amt" editable="false" style="left:578px; top:54px; width:109px; height:18px; "/>
			<input id="input9" style="left:578px; top:79px; width:109px; height:18px; "/>
			<input id="chamt" ref="/root/resData/resform/mc_budg_4001_l_1/dataSet/CURLIST/record/chamt" editable="false" style="left:803px; top:29px; width:109px; height:18px; "/>
			<input id="budg_cndt_amt" ref="/root/resData/resform/mc_budg_4001_l_1/dataSet/CURLIST/record/budg_cndt_amt" editable="false" style="left:578px; top:79px; width:109px; height:18px; "/>
			<caption id="caption15" class="list_cap03" style="left:0px; top:0px; width:110px; height:26px; color:#ff0000; text-align:center; ">변경전</caption>
			<input id="bgatm" ref="/root/tempData/bgatm" editable="false" style="left:803px; top:79px; width:109px; height:18px; "/>
			<input id="max_yymm" ref="/root/resData/resform/mc_budg_4005_l/dataSet/CURLIST1/record/max_yymm" editable="false" maxlength="6" caption="예산년월" style="left:473px; top:4px; width:90px; height:18px; "/>
			<caption id="caption12" class="list_cap03" style="left:332px; top:0px; width:133px; height:26px; text-align:center; ">최종마감월</caption>
			<caption id="caption39" class="list_cap03" style="left:573px; top:0px; width:110px; height:26px; text-align:center; ">구  분</caption>
			<select id="checkbox1" ref="/root/resData/resform/mc_budg_4006_l/dataSet/CURLIST/record/cyov_yn" disabled="true" overflow="visible" appearance="full" style="left:690px; top:3px; width:57px; height:21px; color:#0000ff; border-style:none; ">
				<choices>
					<item>
						<label>이월</label>
						<value>Y</value>
					</item>
				</choices>
			</select>
			<select id="checkbox2" ref="/root/resData/resform/mc_budg_4006_l/dataSet/CURLIST/record/advc_cndt_yn" disabled="true" overflow="visible" appearance="full" style="left:752px; top:3px; width:71px; height:21px; border-style:none; ">
				<choices>
					<item>
						<label>조기집행</label>
						<value>Y</value>
					</item>
				</choices>
			</select>
			<select id="checkbox3" ref="/root/resData/resform/mc_budg_4006_l/dataSet/CURLIST/record/lesd_yn" disabled="true" overflow="visible" appearance="full" style="left:831px; top:3px; width:57px; height:21px; border-style:none; ">
				<choices>
					<item>
						<label>전용</label>
						<value>Y</value>
					</item>
				</choices>
			</select>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:160px; width:926px; height:5px; "/>
		<group id="group2" class="gro_sel" style="left:10px; top:390px; width:926px; height:101px; ">
			<caption id="caption32" class="list_cap02" style="left:0px; top:75px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption28" class="list_cap02" style="left:0px; top:50px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption34" class="list_cap02" style="left:0px; top:25px; width:926px; height:26px; text-align:center; "/>
			<input id="budg_cdnm2" ref="/root/tempData/budg_cdnm2" editable="false" style="left:178px; top:54px; width:153px; height:18px; "/>
			<input id="last_asin_amt2" ref="/root/resData/resform/mc_budg_4001_l_2/dataSet/CURLIST/record/last_asin_amt" editable="false" style="left:578px; top:29px; width:109px; height:18px; "/>
			<caption id="caption37" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; text-align:center; "/>
			<input id="budg_ask_amt2" ref="/root/resData/resform/mc_budg_4001_l_2/dataSet/CURLIST/record/budg_ask_amt" editable="false" style="left:578px; top:54px; width:109px; height:18px; "/>
			<input id="budg_cndt_amt2" ref="/root/resData/resform/mc_budg_4001_l_2/dataSet/CURLIST/record/budg_cndt_amt" editable="false" style="left:578px; top:79px; width:109px; height:18px; "/>
			<input id="chamt2" ref="/root/resData/resform/mc_budg_4001_l_2/dataSet/CURLIST/record/chamt" editable="false" style="left:803px; top:29px; width:109px; height:18px; "/>
			<caption id="caption18" class="list_cap03" style="left:690px; top:25px; width:110px; height:26px; text-align:center; ">변경금액</caption>
			<input id="bgsumatm" ref="/root/tempData/bgsumatm" editable="false" style="left:803px; top:79px; width:109px; height:18px; "/>
			<caption id="caption21" class="list_cap03" style="left:465px; top:50px; width:110px; height:26px; text-align:center; ">의뢰누계</caption>
			<caption id="caption22" class="list_cap03" style="left:0px; top:50px; width:110px; height:26px; text-align:center; ">예산코드</caption>
			<input id="dept_cd2" ref="/root/reqData/multiUpDate/mc_budg_4004_i/dept_cd_to" inputtype="button" style="left:113px; top:29px; width:64px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var dept_var = dept_cd2.value;
					if(dept_var == ""){
						dept_cd2.value = "";
						dept_cdnm2.value = "";
						return false;
					}
					if(dept_var.length != 6){
						show_message("[부서코드]은 잘못된 형식입니다.");
						dept_cd2.value = "";
						dept_cdnm2.value = "";
						return false;
					}
					
					var var_con_date = "";

						if (budg_yymm2.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = budg_yymm2.value.length;
							if(num_ch == 8){
								var_con_date = budg_yymm2.value;
							}else if(num_ch == 6){
								var_con_date = budg_yymm2.value + "01";
							}else if(num_ch == 4){
								var_con_date = budg_yymm2.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (dept_cd2.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
							model.setValue("/root/reqData/fwdData/dept_cd", dept_cd2.value);
							model.setValue("/root/reqData/fwdData/select_ch", "I");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								dept_cdnm2.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								dept_cd2.value = "";
								dept_cdnm2.value = "";
							}
						}
						else {
							dept_cd2.value = "";
							dept_cdnm2.value = "";
						}	
						
						
//					if (open_mc_co_1010()) {
//						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
//						dept_cd2.value = srch_dept_cd.value;
//						dept_cdnm2.value = dept_cdnm.value;
//					}
//					else {
//						//팝업에서 취소 버튼을 누른 경우
//					}
					]]>
				</script>
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						var var_con_date = "";

						if (dept_cd2.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = dept_cd2.value.length;
							if(num_ch == 8){
								var_con_date = dept_cd2.value;
							}else if(num_ch == 6){
								var_con_date = dept_cd2.value + "01";
							}else if(num_ch == 4){
								var_con_date = dept_cd2.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd2");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "I");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						
						//dept_cd2.value = srch_dept_cd.value;
						//dept_cdnm2.value = dept_cdnm.value;
						
//					if (open_mc_co_1010()) {
//						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
//						dept_cd2.value = srch_dept_cd.value;
//						dept_cdnm2.value = dept_cdnm.value;
//					}
//					else {
//						//팝업에서 취소 버튼을 누른 경우
//					}
					]]>
				</script>
			</input>
			<caption id="caption23" class="list_cap03" style="left:465px; top:75px; width:110px; height:26px; text-align:center; ">집행누계</caption>
			<caption id="caption24" class="list_cap03" style="left:0px; top:25px; width:110px; height:26px; text-align:center; ">부서코드</caption>
			<caption id="caption25" class="list_cap03" style="left:109px; top:0px; width:110px; height:26px; text-align:center; ">예산년월</caption>
			<input id="budg_yymm2" ref="/root/reqData/multiUpDate/mc_budg_4004_i/budg_yymm_to" class="req" caption="예산년월" style="left:222px; top:4px; width:90px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					budg_yymm2_ch();
					]]>
				</script>
			</input>
			<caption id="caption30" class="list_cap03" style="left:0px; top:75px; width:110px; height:26px; text-align:center; ">행사코드</caption>
			<caption id="caption31" class="list_cap03" style="left:0px; top:0px; width:110px; height:26px; color:#ff0000; text-align:center; ">변경후</caption>
			<input id="budg_cd2" ref="/root/reqData/multiUpDate/mc_budg_4004_i/budg_cd_to" editable="true" inputtype="button" style="left:112px; top:54px; width:64px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var budg_cd_var = budg_cd2.value;
					if(budg_cd_var == ""){
						budg_cd2.value = "";
						budg_cdnm2.value = ""
						return false;
					}
					//budg_cd_ch2();
					open_mc_co_1020_budg_cd2();
					]]>
				</script>
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					if (open_mc_co_1020_budg_cd2()) {
						//if(!budg_cd_ch2()){return false;}
					}
					]]>
				</script>
			</input>
			<caption id="caption33" class="list_cap03" style="left:690px; top:75px; width:110px; height:26px; text-align:center; ">변경접수</caption>
			<input id="evnt_cdnm2" ref="/root/tempData/evnt_cdnm2" editable="false" style="left:178px; top:79px; width:153px; height:18px; "/>
			<caption id="caption36" class="list_cap03" style="left:465px; top:25px; width:110px; height:26px; text-align:center; ">확정금액</caption>
			<input id="evnt_cd2" ref="/root/reqData/multiUpDate/mc_budg_4004_i/evnt_cd_to" inputtype="button" style="left:112px; top:79px; width:64px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					var evnt_cd_var = evnt_cd2.value;
					if(evnt_cd_var == ""){
						evnt_cd2.value = "";
						evnt_cdnm2.value = "";
						return false;
					}
					if (open_mc_co_1020_evnt_cd()) {
					//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					evnt_cd2.value = srch_evnt_cd.value;
					evnt_cdnm2.value = evnt_cdnm.value;
					}
					else {
					//팝업에서 취소 버튼을 누른 경우
						}
					]]>
				</script>
			</input>
			<input id="dept_cdnm2" ref="/root/tempData/dept_cdnm2" editable="false" style="left:179px; top:29px; width:153px; height:18px; "/>
			<select1 id="radio1" ref="/root/tempData/radio1" visibility="hidden" appearance="full" cols="3" overflow="visible" style="left:729px; top:3px; width:47px; height:18px; border-style:none; ">
				<choices>
					<item>
						<label>이 월</label>
						<value>0</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					radio_ch("0");
					]]>
				</script>
			</select1>
			<select1 id="radio2" ref="/root/tempData/radio2" visibility="hidden" appearance="full" cols="3" overflow="visible" style="left:786px; top:3px; width:67px; height:18px; border-style:none; ">
				<choices>
					<item>
						<label>조기집행</label>
						<value>1</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					radio_ch("1");
					]]>
				</script>
			</select1>
			<select1 id="radio3" ref="/root/tempData/radio3" visibility="hidden" appearance="full" cols="3" overflow="visible" style="left:863px; top:3px; width:50px; height:18px; border-style:none; ">
				<choices>
					<item>
						<label>전용</label>
						<value>2</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					radio_ch("2");
					]]>
				</script>
			</select1>
		</group>
		<group id="group_tit" class="gro_tit" style="left:0px; top:0px; width:946px; height:39px; ">
			<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		</group>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:734px; width:926px; height:21px; ">
			<button id="btn_reset" class="btn02" style="left:111px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model.reset();
					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" style="left:56px; top:0px; width:52px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					send_mc_budg_4004_i();
					]]>
				</script>
			</button>
			<button id="btn_close" class="btn02" style="left:221px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					formClose();
					]]>
				</script>
			</button>
			<button id="btn_select" class="btn02" style="left:0px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					send_mc_budg_4001_l();
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" style="left:166px; top:0px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					if(_oth_clsf == "2"){			
						grid = datagrid2;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
					]]>
				</script>
			</button>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/mc_budg_4003_l_1/dataSet/CURLIST/record" caption="작업코드^일련번호^번호^적요^부서코드^매체^예산금액^월변경금액" colsep="^" colwidth="71, 64, 74, 243, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:10px; top:170px; width:926px; height:200px; ">
			<col ref="work_no"/>
			<col ref="seq"/>
			<col ref="sub_seq"/>
			<col ref="rmks"/>
			<col ref="use_dept_cd"/>
			<col ref="medi_cd"/>
			<col ref="fix_asin_amt"/>
			<col ref="fix_asin_uprc" type="input"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				_oth_clsf = "1";
				datagrid1_ch();
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				datagrid1_value_ch();
				]]>
			</script>
		</datagrid>
		<group id="group1" class="gro_line" style="left:10px; top:375px; width:926px; height:5px; "/>
		<group id="group3" class="gro_line" style="left:10px; top:500px; width:926px; height:5px; "/>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData/mc_budg_4003_l_2/dataSet/CURLIST/record" caption="작업코드^일련번호^번호^적요^부서코드^매체^예산금액^caption1" colsep="^" colwidth="71, 64, 74, 301, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:10px; top:510px; width:926px; height:215px; ">
			<col ref="work_no"/>
			<col ref="seq"/>
			<col ref="sub_seq"/>
			<col ref="rmks"/>
			<col ref="use_dept_cd"/>
			<col ref="medi_cd"/>
			<col ref="fix_asin_amt"/>
			<col ref="ch" visibility="hidden"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				_oth_clsf = "2";
				]]>
			</script>
		</datagrid>
	</xhtml:body>
</xhtml:html>
