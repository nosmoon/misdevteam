<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>Untitle</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session>
						</session>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<mc_budg_40500_m>
								<dataSet>
									<xx_clsf_cd/>
									<xx_crte_clsf/>
									<xx_clas_cd1_010/>
									<xx_clas_cd1_020/>
								</dataSet>
							</mc_budg_40500_m>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
							<mc_budg_4050_m>
								<dataSet>
									<CURLIST1>
										<record>
											<dept_cd/>
											<dept_team_clsf/>
											<abrv_nm/>
											<offi_nm/>
											<part_nm/>
											<part_dn_nm/>
											<use_bgn_dt/>
											<use_end_dt/>
										</record>
									</CURLIST1>
								</dataSet>
							</mc_budg_4050_m>
							<mc_budg_4050_m_1>
								<dataSet>
									<CURLIST4>
										<record>
											<budg_cd/>
											<budg_abrv_nm/>
										</record>
									</CURLIST4>
								</dataSet>
							</mc_budg_4050_m_1>
							<mc_budg_4050_m_3>
								<dataSet>
									<CURLIST4>
										<record>
											<budg_cd/>
											<budg_abrv_nm/>
										</record>
									</CURLIST4>
								</dataSet>
							</mc_budg_4050_m_3>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData>
						</fwdData>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<mc_budg_4050_m>
								<dept_cd/>
								<work_dt/>
								<!--
								<clsf_cd>1</clsf_cd>
								<crte_clsf>1</crte_clsf>
								-->
								<clsf_cd/>
								<crte_clsf/>
								<clas_cd1/>
							</mc_budg_4050_m>
							<mc_budg_4055_l>
								<work_dt/>
								<hsty_no/>
								<dept_cd/>
							</mc_budg_4055_l>
							<mc_budg_4051_l>
								<budg_yymm/>
								<dept_cd/>
								<evnt_cd/>
							</mc_budg_4051_l>
							<mc_budg_4052_l>
								<work_dt/>
								<hsty_no/>
								<budg_yymm/>
								<dept_cd/>
								<evnt_cd/>
								<work_no/>
								<use_dept_cd/>
							</mc_budg_4052_l>
							<mc_budg_4053_l>
								<work_dt/>
								<hsty_no/>
								<budg_yymm/>
								<dept_cd/>
								<evnt_cd/>
								<work_no/>
								<use_dept_cd/>
							</mc_budg_4053_l>
							<mc_budg_4015_l>
								<work_dt/>
								<dept_cd/>
								<clsf_cd/>
								<crte_clsf_cd/>
							</mc_budg_4015_l>
							<mc_budg_4056_l>
								<work_dt/>
								<hsty_no/>
								<dept_cd/>
								<work_no/>
								<evnt_cd/>
								<budg_yymm/>
							</mc_budg_4056_l>
							<mc_budg_4054_l>
								<budg_yymm/>
								<evnt_cd/>
								<dept_cd/>
								<budg_cd/>
								<work_no/>
							</mc_budg_4054_l>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqform/>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpDate>
							<mc_budg_4057_i>
								<multiUpdateData/>
								<work_dt/>
								<dept_cd/>
								<incmg_pers/>
							</mc_budg_4057_i>
							<mc_budg_4058_i>
								<multiUpdateData/>
								<work_dt/>
								<hsty_no/>
								<work_no/>
								<budg_yymm/>
								<dept_cd/>
								<evnt_cd/>
								<rmks2/>
								<use_dept_cd/>
								<incmg_pers/>
							</mc_budg_4058_i>
							<mc_budg_4059_d>
								<multiUpdateData/>
								<yyyy/>
							</mc_budg_4059_d>
						</multiUpDate>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resform>
							<mc_budg_4050_m>
								<dataSet>
									<CURLIST1>
										<record>
											<dept_cd/>
											<dept_team_clsf/>
											<abrv_nm/>
											<offi_nm/>
											<part_nm/>
											<part_dn_nm/>
											<use_bgn_dt/>
											<use_end_dt/>
										</record>
									</CURLIST1>
									<CURLIST2>
										<record>
											<dd/>
										</record>
									</CURLIST2>
									<CURLIST3>
										<record>
											<max_ymcym/>
										</record>
									</CURLIST3>
									<CURLIST4>
										<record>
											<budg_cd/>
											<budg_abrv_nm/>
										</record>
									</CURLIST4>
								</dataSet>
							</mc_budg_4050_m>
							<mc_budg_4015_l>
								<dataSet>
									<CURLIST>
										<record>
											<hsty_no/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4015_l>
							<mc_budg_4051_l>
								<dataSet>
									<CURLIST>
										<record>
											<bjamt/>
											<eramt/>
											<jhamt/>
											<cgamt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4051_l>
							<mc_budg_4054_l>
								<dataSet>
									<CURLIST>
										<record>
											<fix_asin_amt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4054_l>
						</resform>
						<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<gridData>
							<mc_budg_4055_l>
								<dataSet>
									<CURLIST>
										<record>
											<evnt_cd/>
											<evnt_nm/>
											<work_no/>
											<budg_yymm/>
											<use_dept_cd/>
											<dept_cdnm/>
											<yramt/>
											<amt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4055_l>
							<mc_budg_4052_l>
								<dataSet>
									<CURLIST>
										<record>
											<amt_s/>
											<work_dt/>
											<budg_cd/>
											<budg_nm/>
											<rmks/>
											<yramt/>
											<amt/>
											<hsty_no/>
											<sub_no/>
											<fix_asin_amt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4052_l>
							<mc_budg_4053_l>
								<dataSet>
									<CURLIST>
										<record>
											<budg_cd/>
											<budg_nm/>
											<fix_asin_amt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4053_l>
							<mc_budg_4056_l>
								<dataSet>
									<CURLIST>
										<record>
											<evnt_cd/>
											<evnt_nm/>
											<budg_cd/>
											<budg_nm/>
											<budg_yymm/>
											<work_no/>
											<use_dept_cd/>
											<use_dept_nm/>
											<rmks/>
											<yramt/>
											<amt/>
											<hsty_no/>
											<sub_no/>
											<fix_asin_amt/>
										</record>
									</CURLIST>
								</dataSet>
							</mc_budg_4056_l>
						</gridData>
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<keyData/>
						<work_dd/>
						<bggnamt/>
						<bgamt/>
						<radio/>
						<evnt_cdnm/>
						<work_nonm/>
					</tempData>
					<!-- 저장소 -->
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				model.send("mc_budg_40500_m");
				model1.setValue("/root/reqData/searchData/mc_budg_4050_m/clsf_cd", model1.getValue("/root/initData/comboSet/mc_budg_40500_m/dataSet/xx_clsf_cd"));
				model1.setValue("/root/reqData/searchData/mc_budg_4050_m/crte_clsf", model1.getValue("/root/initData/comboSet/mc_budg_40500_m/dataSet/xx_crte_clsf"));
				//alert(model1.getValue("/root/reqData/searchData/mc_budg_4050_m/clsf_cd"));
				//alert(model1.getValue("/root/reqData/searchData/mc_budg_4050_m/crte_clsf"));
				//alert(model1.getValue("/root/initData/comboSet/mc_budg_40500_m/dataSet/xx_clsf_cd"));
				//alert(model1.getValue("/root/initData/comboSet/mc_budg_40500_m/dataSet/xx_crte_clsf"));
				//alert(model1.getValue("/root/initData/comboSet/mc_budg_40500_m/dataSet/xx_clas_cd1_010"));
				//alert(model1.getValue("/root/initData/comboSet/mc_budg_40500_m/dataSet/xx_clas_cd1_020"));
				model.refresh();
				]]>
			</script>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
				//컨트롤 초기화
				init_controls();
				
				//datagrid 컬럼 재 설정
				set_column_visibility();
				
				load_ch();
				]]>
			</script>
			<submission id="mc_budg_40500_m" action="/mc/budg4000/40500" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/comboSet/mc_budg_40500_m/dataSet"/>
			<submission id="mc_budg_4050_m" action="/mc/budg4000/4050" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4050_m" resultref="/root/resData/resform/mc_budg_4050_m/dataSet"/>
			<submission id="mc_budg_4055_l" action="/mc/budg4000/4055" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4055_l" resultref="/root/resData/gridData/mc_budg_4055_l/dataSet"/>
			<submission id="mc_budg_4051_l" action="/mc/budg4000/4051" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4051_l" resultref="/root/resData/resform/mc_budg_4051_l"/>
			<submission id="mc_budg_4042_l" action="/mc/budg4000/4052" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4052_l" resultref="/root/resData/gridData/mc_budg_4052_l"/>
			<submission id="mc_budg_4053_l" action="/mc/budg4000/4053" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4053_l" resultref="/root/resData/gridData/mc_budg_4053_l"/>
			<submission id="mc_budg_4056_l" action="/mc/budg4000/4056" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4056_l" resultref="/root/resData/gridData/mc_budg_4056_l/dataSet"/>
			<submission id="mc_budg_4054_l" action="/mc/budg4000/4054" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/mc_budg_4054_l" resultref="/root/resData/resform/mc_budg_4054_l/dataSet"/>
			<submission id="mc_budg_4057_i" action="/mc/budg4000/4057" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate/mc_budg_4057_i" resultref="/root/resData/MsgData"/>
			<submission id="mc_budg_4058_i" action="/mc/budg4000/4058" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate/mc_budg_4058_i" resultref="/root/resData/MsgData"/>
			<submission id="mc_budg_4059_i" action="/mc/budg4000/4059" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate/mc_budg_4059_d" resultref="/root/resData/MsgData"/>
		</model>
		<script type="javascript" src="../../../js/TFCommon.js"/>
		<script type="javascript" src="../../../js/CIISComm.js"/>
		<script type="javascript" src="../../../js/fcmc_common.js"/>
		<script type="javascript">
			<![CDATA[
			var	_oth_clsf = "2";
			
			//-------------------------------------------------------------------------------
			//	컨트롤의 기본 설정 적용 및 컨트롤 별 포맷 적용
			//-------------------------------------------------------------------------------
			function init_controls() {
				//control의 기본 설정 적용
								
				//datagrid init
				set_default(
						"it was comment field"
					,	datagrid1
					,	datagrid2
					,	datagrid3
				);
				
				datagrid1.attribute("explorerbar") = "";
				datagrid2.attribute("explorerbar") = "";
				datagrid3.attribute("explorerbar") = "";
		
				//combo init
				set_default(
						"it was comment field"			
					,	srch_dept_cd
					,	work_dd
					,	srch_hsty_no
					,	srch_use_dept_cd
				);
				//input init
				set_default(
						"it was comment field"
					,	work_mm
					,	work_dd
					,	evnt_cdnm
					,	srch_budg_yymm
					,	work_nonm
					,	bjamt
					,	eramt
					,	jhamt
					,	bggnamt
					,	bgamt
				);
				//input button init
				set_default(
						"it was comment field"
					,	srch_evnt_cd
					,	srch_work_no
				);
				//input date init
				set_default(
						"it was comment field"
				);

				//control format 설정 적용
				
				//코드
				set_format(
						"code"						//코드포맷,중간정렬,중간정렬
					,	datagrid1				,"10,11"
					,	datagrid2				,"6"
					,	srch_evnt_cd
					,	srch_work_no
				);
				
				//금액
				set_format(
						"number5"						//숫자포맷,오른쪽정렬,중간정렬,(#,###)
					,	datagrid1				,"6,7,8,9"
					,	datagrid2				,"8,9"
					,	datagrid3				,"6,7,8"
					,	bjamt
					,	eramt
					,	jhamt
					,	bggnamt
					,	bgamt
				);
				
				
				//날짜
				set_format(
						"month_1"						//날짜포맷,중간정렬,중간정렬,yyyy-mm
					,	datagrid2				,"5"
					,	work_mm
					,	srch_budg_yymm
				);
				
				//문자열(왼쪽)
				set_format(
						"string_l"						//문자열,왼쪽정렬,중간정렬
					,	datagrid1				,"2,4,5"
					,	datagrid2				,"1,3"
					,	datagrid3				,"2,4,5"
					,	srch_dept_cd
					,	work_dd
					,	srch_hsty_no
					,	evnt_cdnm
					,	srch_use_dept_cd
					,	work_nonm
				);
			}
			
			//-------------------------------------------------------------------------------
			//	datagrid의 컬럼 설정
			//-------------------------------------------------------------------------------
			function set_column_visibility() {
				//모든 컬럼을 감춘다.
				hide_all_columns(datagrid1);
				hide_all_columns(datagrid2);
				hide_all_columns(datagrid3);
				//공통항목을 보여준다.
				show_columns(datagrid1,"2,4,5,6,7,8,9,10,11");
				show_columns(datagrid2,"1,3,5,6,8,9");
				show_columns(datagrid3,"2,4,5,6,7,8");
			}
			
			var W_CYM;
			var W_Spr3Selectyb;
			var W_SaveYH;
			var W_SelectIRSEQ;
			var W_SelectAllCnt;
			var W_CboIRseq_ClickYB;
			
			var evnt_cd_temp;
			var budg_yymm_temp;
			var use_dept_cd_temp;
			var work_no_temp;
			
			var W_IRYCCYMD;
			var W_IRIRSEQ;
			
			var W_HJBJAMT_Cnt;
			
			function load_ch(){
				model.send("mc_budg_4050_m");
				makeComboGubun("","/root/initData/comboSet/mc_budg_4050_m/dataSet/CURLIST1","record","dept_team_clsf", "dept_cd");
				makeComboGubun("","/root/initData/comboSet/mc_budg_4050_m/dataSet/CURLIST2","record","dd", "dd");
				makeComboGubun("","/root/initData/comboSet/mc_budg_4050_m/dataSet/CURLIST3","record","budg_abrv_nm", "budg_cd");
				model.copyNode("/root/initData/comboSet/mc_budg_4010_m/dataSet/CURLIST1","/root/resData/resform/mc_budg_4010_m/dataSet/CURLIST1");
				
				var result_4050 = "/root/resData/resform/mc_budg_4050_m/dataSet/";
				W_CYM = get_refvalue(result_4050 + "CURLIST3/record/max_ymcym");
				W_Spr3Selectyb = "true"
			}
			
			function dept_cd_ch(){
				
				datagrid_data_clear(datagrid1);

				W_SaveYH == "";
         		        W_SelectIRSEQ == "";
			        W_SelectAllCnt == 0;
			        
			        set_refvalue(bjamt,"");
			        set_refvalue(eramt,"");
			        set_refvalue(jhamt,"");
			        set_refvalue(bggnamt,"");
			        set_refvalue(bgamt,"");
			        
			        set_refvalue(work_mm,"");
			        set_refvalue(work_dd,"");
			        set_refvalue(srch_hsty_no,"");
			        
			        set_refvalue(srch_evnt_cd,"");
			        set_refvalue(srch_budg_yymm,"");
			        
			        if(work_mm.value != ""){
				        work_mm_ch();
			        }
			        set_refvalue(radio,"");
			        model.setFocus("work_mm");
			        
			}
			
			function work_mm_ch(){
				var work_mm_var = get_refvalue(work_mm);
				if(work_mm_var == "" || work_mm_var.length != 6){
					return false;
				}
				
			        set_refvalue(work_dd,"");
			        set_refvalue(srch_hsty_no,"");
			        
			        var ref_4050 = "/root/reqData/searchData/mc_budg_4050_m/";
				set_refvalue(ref_4050 + "dept_cd",srch_dept_cd.value);
				
				model.send("mc_budg_4010_m");
				
				work_dd.refresh();
				
				datagrid_data_clear(datagrid1);
				
				W_SaveYH == "";
				W_SelectIRSEQ == "";
				W_SelectAllCnt == 0;
				
				set_refvalue(bjamt,"");
			 	set_refvalue(eramt,"");
			  	set_refvalue(jhamt,"");
			   	set_refvalue(bggnamt,"");
			    	set_refvalue(bgamt,"");
			        			        
			        set_refvalue(srch_evnt_cd,"");
			        set_refvalue(srch_budg_yymm,"");
				
			}
			
			function work_dd_ch(){
				var work_dd_var = get_refvalue(work_dd);
				if(work_dd_var == "" ||work_dd_var.length != 2){
					 set_refvalue(srch_hsty_no,"");
					 return false;
				}
				
				var ref_4015 = "/root/reqData/searchData/mc_budg_4015_l/";
				set_refvalue(ref_4015 + "work_dt",(work_mm.value+work_dd.value));
				//set_refvalue(ref_4015 + "clsf_cd","1");
				//set_refvalue(ref_4015 + "crte_clsf_cd","1");
				set_refvalue(ref_4015 + "clsf_cd",model1.getValue("/root/initData/comboSet/mc_budg_40500_m/dataSet/xx_clsf_cd"));
				set_refvalue(ref_4015 + "crte_clsf_cd",model1.getValue("/root/initData/comboSet/mc_budg_40500_m/dataSet/xx_crte_clsf"));
				set_refvalue(ref_4015 + "dept_cd",srch_dept_cd.value);
				
				model.send("mc_budg_4015_l");
				makeComboGubun("","/root/resData/resform/mc_budg_4015_l/dataSet/CURLIST","record","hsty_no", "hsty_no");
				
				srch_hsty_no.refresh();
				
				datagrid_data_clear(datagrid1);
				
				W_SaveYH == "";
				W_SelectIRSEQ == "";
				W_SelectAllCnt == 0;
				
				set_refvalue(bjamt,"");
			 	set_refvalue(eramt,"");
			  	set_refvalue(jhamt,"");
			   	set_refvalue(bggnamt,"");
			    	set_refvalue(bgamt,"");
			        			        
			        set_refvalue(srch_evnt_cd,"");
			        set_refvalue(srch_budg_yymm,"");
				
			}
			
			function hsty_no_ch(){
				var hsty_no_var = get_refvalue(srch_hsty_no);
				if(hsty_no_var == ""){
					btn_insert.attribute("visibility") = "visible";
					btn_update.attribute("visibility") = "hidden";
				}
				
				if(W_CboIRseq_ClickYB == ""){
					btn_insert.attribute("visibility") = "hidden";
					btn_update.attribute("visibility") = "visible";
				}
				
				if(W_CboIRseq_ClickYB != ""){
					W_CboIRseq_ClickYB = "";
					return false;
				}else{
					if(W_SelectIRSEQ == hsty_no_var){
						return false;
					}
				}
							
				W_CboIRseq_ClickYB = "true";
				evnt_cd_temp = get_refvalue(srch_evnt_cd);
				budg_yymm_temp = get_refvalue(srch_budg_yymm);
				use_dept_cd_temp = get_refvalue(srch_use_dept_cd);
				work_no_temp = get_refvalue(srch_work_no);
				
				set_refvalue(srch_evnt_cd,"");
			        set_refvalue(srch_budg_yymm,"");
			 					
				var ref_4055 = "/root/reqData/searchData/mc_budg_4055_l/";
				set_refvalue(ref_4055 + "work_dt",(work_mm.value+work_dd.value));
				set_refvalue(ref_4055 + "dept_cd",srch_dept_cd.value);
				set_refvalue(ref_4055 + "hsty_no",srch_hsty_no.value);
				
				set_refvalue(bjamt,"");
			        set_refvalue(eramt,"");
			        set_refvalue(jhamt,"");
			        set_refvalue(bggnamt,"");
			        set_refvalue(bgamt,"");
				
				model.send("mc_budg_4055_l");
				
				var result_4055 = "/root/resData/gridData/mc_budg_4055_l/dataSet/CURLIST/"
				if(get_refvalue(result_4055 + "totalcnt") > 0){
					btn_copy.disabled = false;
				}else{
					btn_copy.disabled = true;
					btn_insert.attribute("visibility") = "visible";
					btn_update.attribute("visibility") = "hidden";
				}
				
				W_CboIRseq_ClickYB = "False";
			}
			
			function datagrid2_ch(){
				var row = datagrid2.row;
				var col = datagrid2.col;
				
				if(row >= datagrid2.fixedRows){
					var evnt_cd_ref = datagrid2.colRef("evnt_cd");
					var work_no_ref = datagrid2.colRef("work_no");
					var evnt_cd_ref = datagrid2.colRef("budg_yymm");
					var use_dept_cd_ref = datagrid2.colRef("use_dept_cd");
					var evnt_cd_var = datagrid2.valueMatrix(row,evnt_cd_ref);
					var work_no_var = datagrid2.valueMatrix(row,work_no_ref);
					var budg_yymm_var = datagrid2.valueMatrix(row,evnt_cd_ref);
					var use_dept_cd_var = datagrid2.valueMatrix(row,use_dept_cd_ref);
					
					if(budg_yymm_var == ""){
						set_refvalue(srch_budg_yymm,"");
						set_refvalue(srch_evnt_cd,"");
						set_refvalue(srch_dept_cd,"");
						set_refvalue(evnt_cdnm,"");
						set_refvalue(srch_use_dept_cd,"");
						set_refvalue(srch_work_no,"");
						set_refvalue(work_nonm,"");
						
						datagrid_data_clear(datagrid1);	
					}
					set_refvalue(srch_evnt_cd,evnt_cd_var);
					set_refvalue(srch_budg_yymm,work_no_var);
					set_refvalue(srch_use_dept_cd,budg_yymm_var);
				   	set_refvalue(srch_work_no,use_dept_cd_var);
			   	
				   	if(W_SaveYH == "C"){
				   		if(W_Spr3Selectyb != ""){
				   			
				   		}
				   	}else{
				   		btn_select.dispatch("onclick");
				   	}
			   	
				}
			}
			
			function select_ch(){
				if(get_refvalue(radio) == ""){
					show_message("예산코드의 유형을 먼저 선택하세요");
					return false;
				}
				if(W_SaveYH == "C"){
					btn_copy.dispatch("onclick");
				}
				source.disabled = false;
				copy.disabled = true;
				btn_copy.disabled = false;
				btn_insert.attribute("visibility") = "hidden";
				btn_update.attribute("visibility") = "visible";
				W_SelectIRSEQ == "";
				model.toggle("source1");
				W_SaveYH == "";
				W_SelectIRSEQ = get_refvalue(srch_hsty_no);
				
				var ref_4051 = "/root/reqData/searchData/mc_budg_4051_l/"
				var ref_4052 = "/root/reqData/searchData/mc_budg_4052_l/"
				var ref_4053 = "/root/reqData/searchData/mc_budg_4053_l/"
				
				set_refvalue(ref_4052 + "work_dt",(work_mm.value + work_dd.value));
				set_refvalue(ref_4053 + "work_dt",(work_mm.value + work_dd.value));
				
				set_refvalue(ref_4053 + "hsty_no",srch_hsty_no.value);
				
				set_refvalue(ref_4051 + "budg_yymm", srch_budg_yymm.value);
				set_refvalue(ref_4053 + "budg_yymm", srch_budg_yymm.value);
				
				set_refvalue(ref_4051 + "dept_cd", srch_dept_cd.value);
				set_refvalue(ref_4053 + "dept_cd", srch_dept_cd.value);
				
				set_refvalue(ref_4051 + "evnt_cd", srch_dept_cd.value);
				set_refvalue(ref_4053 + "evnt_cd", srch_dept_cd.value);
				
				set_refvalue(ref_4053 + "use_dept_cd", srch_use_dept_cd.value);
								
				set_refvalue(ref_4053 + "work_no", srch_work_no.value);
				
				if(work_mm.value == "" || work_dd.value == "" || srch_dept_cd.value == "" || srch_use_dept_cd.value == "" || srch_work_no.value == ""){
					show_message("필수 입력 항목이 입력되지 않았습니다.");
					return false;
				}
				
				set_refvalue(bjamt,"");
			 	set_refvalue(eramt,"");
			  	set_refvalue(jhamt,"");
			   	set_refvalue(bggnamt,"");
			    	set_refvalue(bgamt,"");
			    	
			    	datagrid_data_clear(datagrid1);
				
				model.send("mc_budg_4051_l");
				model.send("mc_budg_4052_l");
				model.send("mc_budg_4053_l");
				
				var total = 0;
				var select_ref = datagrid1.colRef("select");
				var amt_s_ref = datagrid1.colRef("amt_s");
				var budg_cd_ref = datagrid1.colRef("budg_cd");
				var yramt_ref = datagrid1.colRef("yramt");
				var yramt2_ref = datagrid1.colRef("yramt2");
				var yramt_var;
				var fix_asin_amt_ref = datagrid1.colRef("fix_asin_amt");
				var fix_asin_amt_var;
				
				var ch_btn = 0;
				for(i = datagrid1.fixedRows ; i <= datagrid1.rows ; i++){
					datagrid1.valueMatrix(i,select_ref) = "R";
					if(datagrid1.valueMatrix(i,amt_s_ref) == "승인"){
						ch_btn = ch_btn + 1;
					}
					yramt_var = datagrid1.valueMatrix(i,yramt_ref);
					fix_asin_amt_var = datagrid1.valueMatrix(i,fix_asin_amt_ref);
					if(Number(yramt_var) != 0){
						datagrid1.valueMatrix(i,yramt2_ref) = (yramt_var + fix_asin_amt_var);
					}else{
						datagrid1.valueMatrix(i,yramt_ref) = (yramt_var - fix_asin_amt_var);
						datagrid1.valueMatrix(i,yramt2_ref) = yramt_var;
					}
					total = total + yramt_var;
				}
				
				var result_4053 = "/root/resData/gridData/mc_budg_4053_l/"
				var result_4052 = "/root/resData/gridData/mc_budg_4052_l/"
				var cnt_4053 = get_refvalue(result_4053 + "dataSet/CURLIST/totalcnt");
				var cnt_4052 = get_refvalue(result_4052 + "dataSet/CURLIST/totalcnt");
				for(i = 0 ; i < cnt_4053 ; i++){
					datagrid1.addRow();
					datagrid1.valueMatrix(datagrid1.rows,budg_cd_ref) = get_refvalue(refsult_4053 + "dataSet/CURLIST/record["+i+"]/budg_cd");
					datagrid1.valueMatrix(datagrid1.rows,fix_asin_amt_ref) = get_refvalue(refsult_4053 + "dataSet/CURLIST/record["+i+"]/fix_asin_amtf");
				}
				if(W_CYM >= srch_budg_yymm.value){
					datagrid.isReadOnly(datagrid1.fixedRows, datagrid1.frozenCols, datagrid1.rows, datagrid1.cols) = true;
				}
				
				set_refvalue(bggnamt,total);
				set_refvalue(bgamt,total);
				
				if(ch_btn > 0){
					btn_insert.attribute("visibility") = "visible";
					btn_update.attribute("visibility") = "hidden";
				}else{
					if(cnt_4052 == 0){
						btn_insert.attribute("visibility") = "hidden";
						btn_update.attribute("visibility") = "visible";
					}else{
						if(srch_hsty_no.value.length > 0){
							btn_insert.attribute("visibility") = "visible";
							btn_update.attribute("visibility") = "hidden";
						}else{
							btn_insert.attribute("visibility") = "hidden";
							btn_update.attribute("visibility") = "visible";
						}
					}
				}			
			}
			
			function radio_ch(){
				datagrid_data_clear(datagrid1);
				var ref_4050 = "/root/reqData/searchData/mc_budg_4050_m/";
				if(radio.value == 0){
					//set_refvalue(ref_4050 + "clas_cd1","10");
					set_refvalue(ref_4050 + "clas_cd1",model1.getValue("/root/initData/comboSet/mc_budg_40500_m/dataSet/xx_clas_cd1_010"));
				}else{
					//set_refvalue(ref_4050 + "clas_cd1","20");
					set_refvalue(ref_4050 + "clas_cd1",model1.getValue("/root/initData/comboSet/mc_budg_40500_m/dataSet/xx_clas_cd1_020"));
				}
				set_refvalue(ref_4050 + "dept_cd",srch_dept_cd.value);
				model.send("mc_budg_4050_m");
				makeComboGubun("","/root/initData/comboSet/mc_budg_4050_m/dataSet/CURLIST1","record","dept_team_clsf", "dept_cd");
				makeComboGubun("","/root/initData/comboSet/mc_budg_4050_m/dataSet/CURLIST2","record","dd", "dd");
				makeComboGubun("","/root/initData/comboSet/mc_budg_4050_m/dataSet/CURLIST3","record","budg_abrv_nm", "budg_cd");
				if(W_SaveYH == "C"){
					model.copyNode("/root/initData/comboSet/mc_budg_4010_m_3/dataSet/CURLIST4","/root/resData/resform/mc_budg_4010_m/dataSet/CURLIST4");
					if(srch_evnt_cd.value != "" && srch_budg_yymm.value != "" && srch_use_dept_cd.value != "" && srch_work_no.value != "" && datagrid1.rows > datagrid1.fixedRows){
						datagrid2.dispatch("onclick");
					}
				}else{
					model.copyNode("/root/initData/comboSet/mc_budg_4010_m_1/dataSet/CURLIST4","/root/resData/resform/mc_budg_4010_m/dataSet/CURLIST4");
					if(srch_evnt_cd.value != "" && srch_budg_yymm.value != "" && srch_use_dept_cd.value != "" && srch_work_no.value != "" && datagrid1.rows > datagrid1.fixedRows){
						btn_select.dispatch("onclick");
					}
				}
			}
			
			function open_mc_co_1020_evnt_cd() {
				var popid = "mc_co_1020";
				var rcvs_flag = false;

				if (!check_reqItem(srch_dept_cd,"trim","focus","부서코드를 먼저 조회하세요.")) {return false;}

				if (event != null && event.name == "xforms-value-changed") {
					//값이 변경되면 기존에 조회된 자료를 모두 제거한다.
					reset_popup_rcvs_data(popid);
				}
				
				set_popup_send_data(popid,"mode","sr");
				set_popup_send_data(popid,"title","고유행사코드조회");
				set_popup_send_data(popid,"readonly","0");
				set_popup_send_data(popid,"datafilter","");	
				//행사코드조회
				set_popup_send_data(popid,"searchid","16");
				//부서코드가 정상적으로 조회된 경우에만 처리해야 함
				set_popup_send_data(popid,"dept_cd",srch_dept_cd.value);
				set_popup_send_data(popid,"cd",srch_evnt_cd.value);
				set_popup_send_data(popid,"cdnm","");
				
				set_popup_send_data(popid,"require","cd");	
				
				rcvs_flag = call_mc_co_1020("mc_co_1005_l","CURLIST",false);
				if (rcvs_flag) {
					//정상처리
				}
				else {
					//취소버튼을 누른 경우 조회 조회를 위한 값과 조회된 값이 틀린 경우 기존 값을 모두 제거한다.
				}
				
				//value-changed 와 buttonclick이 동시 발생했을 경우
				//이하 코드는 두번씩 실행되므로 무거운 코드는 넣지 않도록 하자

				//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
				//다시 조회 하기 쉽도록 하고
				if (get_popup_rcvs_data(popid,"cd") != "") {
					set_refvalue(srch_evnt_cd,get_popup_rcvs_data(popid,"cd"));
				}
				
				set_refvalue(evnt_cdnm,get_popup_rcvs_data(popid,"cdnm"));
				
				return rcvs_flag;
			}
			
			function budg_yymm_ch(){
				var srch_budg_yymm_var = get_refvalue(srch_budg_yymm);
				if(srch_budg_yymm == "" || srch_budg_yymm.length != 6){return false;}
				
				if(srch_budg_yymm.substring(0,4) > (W_CYM-1)){
					show_message("["+ yymm_var.substring(0,4) +"년] 에대한 경리마감처리가 되지 않았으므로 추경작업을 할 수 없습니다.");
					set_refvalue(srch_budg_yymm,"");
					return false;
				}
				if(W_CYM >= srch_budg_yymm){
					show_message("해당 월은 월마감되었으므로 처리가 불가능합니다.");
					set_refvalue(srch_budg_yymm,"");
					return false;
				}
				W_HJBJAMT_Cnt = 0;
				if(srch_budg_yymm.value == "" || srch_dept_cd.value == "" || srch_evnt_cd.value == ""){return false;}
								
				if(W_SaveYH == "C"){
					var select_ref = datagrid1.colRef("select");
					for(i = datagrid1.fixedRows ; i <= datagrid1.rows ; i++){
						datagrid1.valueMatrix(i,select_ref) = "I";
					}
				}
			}
			
			function use_dept_cd_ch(){
				if(W_SaveYH == "C"){
					var select_ref = datagrid1.colRef("select");
					for(i = datagrid1.fixedRows ; i <= datagrid1.rows ; i++){
						datagrid1.valueMatrix(i,select_ref) = "I";
					}
				}
			}
			
			function btn_copy_ch(){
				copy.disabled = false;
				source.disabled = true;
				W_SaveYH = "C";
				W_IRIRSEQ = get_refvalue(srch_hsty_no);
				W_IRYCCYMD = (work_mm.value + work_dd.value);
				
				var yymmdd_var = commCurDate();
				
				set_refvalue(work_mm,yymmdd_var.substring(0,6));
				set_refvalue(work_dd,yymmdd_var.substring(6,8));
				
				datagrid_data_clear(datagrid3);
				var ref_4050 = "/root/reqData/searchData/mc_budg_4050_m/";
				if(radio.value == 0){
					//set_refvalue(ref_4050 + "clas_cd1","10");
					set_refvalue(ref_4050 + "clas_cd1",model1.getValue("/root/initData/comboSet/mc_budg_40500_m/dataSet/xx_clas_cd1_010"));
				}else{
					//set_refvalue(ref_4050 + "clas_cd1","20");
					set_refvalue(ref_4050 + "clas_cd1",model1.getValue("/root/initData/comboSet/mc_budg_40500_m/dataSet/xx_clas_cd1_020"));
				}
				set_refvalue(ref_4050 + "dept_cd",srch_dept_cd.value);
				model.send("mc_budg_4050_m");
				makeComboGubun("","/root/initData/comboSet/mc_budg_4050_m/dataSet/CURLIST1","record","dept_team_clsf", "dept_cd");
				makeComboGubun("","/root/initData/comboSet/mc_budg_4050_m/dataSet/CURLIST2","record","dd", "dd");
				makeComboGubun("","/root/initData/comboSet/mc_budg_4050_m/dataSet/CURLIST3","record","budg_abrv_nm", "budg_cd");
				model.copyNode("/root/initData/comboSet/mc_budg_4010_m_3/dataSet/CURLIST4","/root/resData/resform/mc_budg_4010_m/dataSet/CURLIST4");
				
				
				var ref_4056 = "/root/resData/gridData/mc_budg_4056_l/dataSet/";
				set_refvalue(ref_4056 + "work_dt", W_IRYCCYMD);
				set_refvalue(ref_4056 + "hsty_no", W_IRIRSEQ);
				set_refvalue(ref_4056 + "dept_cd", srch_dept_cd.value);
				
				model.send("mc_budg_4056_l");
				
				var select_ref = datagrid3.colRef("select");
				var amt_s_ref = datagrid3.colRef("amt_s");
				var yramt_ref = datagrid3.colRef("yramt");
				var yramt2_ref = datagrid3.colRef("yramt2");
				var yramt_var;
				var fix_asin_amt_ref = datagrid3.colRef("fix_asin_amt");
				var fix_asin_amt_var;
				
				for(i = datagrid3.fixedRows ; i <= datagrid3.rows ; i++){
					datagrid3.valueMatrix(i,select_ref) = "II";
					datagrid3.valueMatrix(i,amt_s_ref) = "요청";
					yramt_var = datagrid3.valueMatrix(i,yramt_ref);
					fix_asin_amt_var = datagrid3.valueMatrix(i,fix_asin_amt_ref);
					datagrid3.valueMatrix(i,yramt2_ref) = (yramt_var + fix_asin_amt_var);
				}
			}
			
			function datagrid1_click(){
				var row= datagrid1.row;
				var col = datagrid1.col;
				
				var select_ref = datagrid1.colRef("select");
				var select_var = datagrid1.valueMatrix(row,select_ref);
				var amt_s_ref = datagrid1.colRef("amt_s");
				var amt_s_var = datagrid1.valueMatrix(row,amt_s_ref);
				var work_dt_ref = datagrid1.colRef("work_dt");
				var work_dt_var = datagrid1.valueMatrix(row,work_dt_ref);
				var budg_cd_ref = datagrid1.colRef("budg_cd");
				var budg_cd_var = datagrid1.valueMatrix(row,budg_cd_ref);
				
				if(col == amt_s_ref || col == work_dt_ref){
					show_message("입력/수정할 수 없는 칼럼입니다.");
					return false;
				}
				if(col > datagrid1.fixedCols){
					if(amt_s_var == "승인"){
						show_messgae("이미 승인되었으므로 삭제할 수 없습니다.");
						return false;
					}
					var row_style = datagrid1.rowStyle(row, "data", "background-color");
					if(row_style == "#FFF000"){
						datagrid1.rowStyle(row, "data", "background-color") = "#FFFFFF";
						datagrid1.removeStatus(row,"daelete");
					}else if(select_var == "R" || select_var == "U"){
						datagrid1.rowStyle(row, "data", "background-color") = "#FFF000";
						datagrid1.rowStatus(row) = 4;
					}					
				}
			}
			
			function datagrid1_ch(){
				var row = datagrid1.row;
				var col = datagrid1.col;
				
				var select_ref = datagrid1.colRef("select");
				var select_var = datagrid1.valueMatrix(row,select_ref);
				var amt_s_ref = datagrid1.colRef("amt_s");
				var work_dt_ref = datagrid1.colRef("work_dt");
				var work_dt_var = datagrid1.valueMatrix(row,work_dt_ref);
				var budg_cd_ref = datagrid1.colRef("budg_cd");
				var budg_cd_var = datagrid1.valueMatrix(row,budg_cd_ref);
				var fix_asin_amt_ref = datagrid1.colRef("fix_asin_amt");
				var fix_asin_amt_var = datagrid1.colRef(row,fix_asin_amt_ref);
				var yramt_ref = datagrid1.colRef("yramt");
				var yramt2_ref = datagrid1.colRef("yramt2");
				var yramt2_var = datagrid1.valueMatrix(row,yramt2_ref);
				
				if(col == budg_cd_ref){
					var ref_4054 = "/root/reqData/searchData/mc_budg_4054_l/";
					set_refvalue(ref_4054 + "budg_yymm", srch_budg_yymm.value);
					set_refvalue(ref_4054 + "evnt_cd", srch_evnt_cd.value);
					set_refvalue(ref_4054 + "work_no", srch_work_no.value);
					set_refvalue(ref_4054 + "budg_cd", datagrid1.valueMatrix(row,col));
					
					model.send("mc_budg_4054_l");
					
					var result_4054 = "/root/resData/resform/mc_budg_4054_l/dataSet/";
					
					datagrid1.valueMatrix(row,fix_asin_amt_ref) = get_refvalue(result_4054 + "CURLIST/record/fix_asin_amt");
				}
				if(select_var == ""){
					datagrid1.valueMatrix(row,select_ref) = "I";
					datagrid1.valueMatrix(row,amt_s_ref) = "요청";
					datagrid1.valueMatrix(row,work_dt_ref) = commCurDate();
				}else{
					if(select_var == "R" || select_var == "U"){
						datagrid1.valueMatrix(row,select_ref) = "U";
					}else if(select_var == "I" && budg_cd_var == ""){
						for(i = datagrid1.fixedCols ; i <= datagrid1.cols ; i++){
							datagrid1.valueMatrix(row,i) = "";
						}
					}
				}
				if(col != work_dt_ref && budg_cd_var == ""){
					show_message("필수 입력 항목이 입력되지 않았습니다.(예산코드)");
					for(i = datagrid1.fixedCols ; i <= datagrid1.cols ; i++){
						datagrid1.valueMatrix(row,i) = "";
					}
					return false;
				}
				if(col == yramt2_ref){
					datagrid1.valueMatrix(row,yramt_ref) = (yramt2_var - fix_asin_amt_var);
					set_refvalue(bgamt,datagrid_data_sum(datagrid1,datagrid1.fixedRows,yramt_ref,datagrid1.rows,yramt_ref));
				}
			}
			
			function datagrid3_click(){
				var row= datagrid3.row;
				var col = datagrid3.col;
				
				var select_ref = datagrid1.colRef("select");
				var select_var = datagrid1.valueMatrix(row,select_ref);
				var amt_s_ref = datagrid3.colRef("amt_s");
				var amt_s_var = datagrid3.valueMatrix(row,amt_s_ref);
				var work_dt_ref = datagrid1.colRef("work_dt");
				var work_dt_var = datagrid1.valueMatrix(row,work_dt_ref);
				var budg_cd_ref = datagrid1.colRef("budg_cd");
				var budg_cd_var = datagrid1.valueMatrix(row,budg_cd_ref);
				
				if(col == amt_s_ref ){
					show_message("입력/수정할 수 없는 칼럼입니다.");
					return false;
				}
				if(col > datagrid3.fixedCols){
					var row_style = datagrid3.rowStyle(row, "data", "background-color");
					if(row_style == "#FFF000"){
						datagrid3.rowStyle(row, "data", "background-color") = "#FFFFFF";
						datagrid3.removeStatus(row,"daelete");
					}else if(select_var == "R" || select_var == "U"){
						datagrid3.rowStyle(row, "data", "background-color") = "#FFF000";
						datagrid3.rowStatus(row) = 4;
					}	
				}
			}
			
			function datagrid3_ch(){
				var row = datagrid3.row;
				var col = datagrid3.col;
				
				var select_ref = datagrid3.colRef("select");
				var select_var = datagrid3.valueMatrix(row,select_ref);
				var amt_s_ref = datagrid3.colRef("amt_s");
				var work_dt_ref = datagrid3.colRef("work_dt");
				var work_dt_var = datagrid3.valueMatrix(row,work_dt_ref);
				var budg_cd_ref = datagrid3.colRef("budg_cd");
				var budg_cd_var = datagrid3.valueMatrix(row,budg_cd_ref);
				var fix_asin_amt_ref = datagrid3.colRef("fix_asin_amt");
				var fix_asin_amt_var = datagrid3.colRef(row,fix_asin_amt_ref);
				var yramt_ref = datagrid3.colRef("yramt");
				var yramt2_ref = datagrid3.colRef("yramt2");
				var yramt2_var = datagrid3.valueMatrix(row,yramt2_ref);
				
				if(col == budg_cd_ref){
					var ref_4054 = "/root/reqData/searchData/mc_budg_4054_l/";
					set_refvalue(ref_4054 + "budg_yymm", srch_budg_yymm.value);
					set_refvalue(ref_4054 + "evnt_cd", srch_evnt_cd.value);
					set_refvalue(ref_4054 + "work_no", srch_work_no.value);
					set_refvalue(ref_4054 + "budg_cd", datagrid1.valueMatrix(row,col));
					
					model.send("mc_budg_4054_l");
					
					var result_4054 = "/root/resData/resform/mc_budg_4054_l/dataSet/";
					
					datagrid3.valueMatrix(row,fix_asin_amt_ref) = get_refvalue(result_4054 + "CURLIST/record/fix_asin_amt");
				}
				datagrid1.valueMatrix(row,select_ref) = "I";
				datagrid1.valueMatrix(row,amt_s_ref) = "요청";
				datagrid1.valueMatrix(row,work_dt_ref) = get_refvalue(srch_budg_yymm);
				if(col != work_dt_ref && budg_cd_var == ""){
					show_message("필수 입력 항목이 입력되지 않았습니다.(예산코드)");
					for(i = datagrid1.fixedCols ; i <= datagrid1.cols ; i++){
						datagrid1.valueMatrix(row,i) = "";
					}
					return false;
				}
				if(col == yramt2_ref){
					datagrid1.valueMatrix(row,yramt_ref) = (yramt2_var - fix_asin_amt_var);
					set_refvalue(bgamt,datagrid_data_sum(datagrid1,datagrid1.fixedRows,yramt_ref,datagrid1.rows,yramt_ref));
				}
			}
			
			function insert_ch(){
				//필수항목체크(검색)
				if(!commReqCheck(group2)) {
					return false;
				}
				
				if(W_CYM >= srch_budg_yymm.value){
					show_message("해당 월은 월마감되었으므로 처리가 불가능합니다.");
					return false;
				}
				
				if(W_SaveYH == "I"){
					if (show_message("신규 일련번호가 추가됩니다. 저장하시겠습니까?","저장 취소",MB_YESNO) != IDYES) {
						return false;
					}
				}
				save_function();
				btn_select.dispatch("onclick")
			}
			
			function update_ch(){
				W_SaveYH = "U";
				if (show_message("해당 일련번호에 저장됩니다 저장하시겠습니까?","저장 취소",MB_YESNO) != IDYES) {
					return false;
				}
				save_function();
				btn_select.dispatch("onclick")
			}
			
			function save_function(){
				if(W_SaveYH == "C"){
					var ref_4057 = "/root/reqData/multiUpDate/mc_budg_4057_i/";
					set_refvalue(ref_4057 + "work_dt",(work_mm.value + work_dd.value));
					set_refvalue(ref_4057 + "dept_cd", srch_dept_cd.value);
					set_refvalue(ref_4057 + "incmg_pers", getProperty("ss_emp_no"));
					for(i = datagrid3.fixedRows ; i <= datagrid3.rows ; i++){
						datagrid3.addStatus(i,insert);
					}
					set_refvalue(ref_4057 + "multiUpdateData", datagrid3.getUpdateData());
				}else{
					var ref_4058 = "/root/reqData/multiUpDate/mc_budg_4058_i/";
					set_refvalue(ref_4058 + "work_dt",(work_mm.value + work_dd.value));
					if(W_SaveYH != "I" && W_SaveYH != "C"){
						set_refvalue(ref_4058 + "hsty_no", srch_hsty_no.value);
					}
					set_refvalue(ref_4058 + "budg_YYMM", srch_budg_yymm.value);
					set_refvalue(ref_4058 + "dept_cd", srch_dept_cd.value);
					set_refvalue(ref_4058 + "use_dept_cd", srch_use_dept_cd.value);
					set_refvalue(ref_4058 + "evnt_cd", srch_evnt_cd.value);
					set_refvalue(ref_4058 + "incmg_pers", getProperty("ss_emp_no"));
					
					var select_ref = datagrid1.colRef("select");
					var select_var
					for(i = datagrid1.fixedRows ; i <= datagrid1.rows ; i++){
						select_var = datagrid1.valueMatrix(i,select_ref);
						if(select_var != ""){
							if(W_SaveYH == "I"){
								datagrid1.valueMatrix(i,select_ref) = "II";
							}else{
								if(select_var == "I" || select_var == "U"){
									
								}
							}
						}
					}
					if(W_SaveYH == "I"){
						set_refvalue(ref_4058 + "hsty_no", srch_hsty_no.value);
					}
					set_refvalue(ref_4058 + "work_no", srch_work_no.value);
					for(i = datagrid1.fixedRows ; i <= datagrid1.rows ; i++){
						datagrid1.addStatus(i,insert);
					}
					set_refvalue(ref_4058 + "multiUpdateData", datagrid1.getUpdateData());
					model.send("mc_budg_4058_i");
				}
				
				if(W_SaveYH == "I" || W_SaveYH == "C"){
					var mon = get_refvalue(work_dd);
					work_mm.disabled("xforms-value-changed");
					set_refvalue(work_dd,mon);
					if(W_SaveYH == "C"){
						model.toggle("source1");
					}
				}else{
					srch_hsty_no.disabled("xforms-value-changed");
				}
			}
			
			function delete_ch(){
				if(W_SaveYH == "C"){
					for(i = datagrid3.fixedRows ; i <= datagrid3.rows ; i++){
						if(datagrid3.rowStatus(i) == 4){
							datagrid3.deleteRow(i);
						}
					}
					return false;
				}
				
				if(W_CYM >= srch_budg_yymm.value){
					show_message("해당 월은 월마감되었으므로 처리가 불가능합니다.");
					return false;
				}
				
				var ref_4059 = "/root/reqData/multiUpDate/mc_budg_4059_d/";
				set_refvalue(ref_4059 + "yyyy", srch_budg_yymm.value);
				set_refvalue(ref_4059 + "multiUpdateData",datagrid1.getUpdateData("delete"));
				
				model.send("mc_budg_4059_d");
				
				srch_hsty_no.disabled("xforms-value-changed");
			}
			
			function fun_print(){
				var work_dt_var;
				work_dt_var = work_mm.value + work_dd.value;
				//필수항목체크(검색)
				if(work_dt_var == "" || srch_hsty_no.value == "") {
					show_message("필수 입력 항목이 입력되지 않았습니다.");
					return false;
				}
				
				resetOznode();
				
				// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)
				makeNodeValue("/root/oz_data/ozrName","fcmc/SP_MC_BUDG_4090_P");
				
				// odi 파라미터 설정.
				makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd", getProperty("ss_cmpycd"));
				makeNodeValue("/root/oz_data/odiParam/iv_work_dt", work_dt_var);
				makeNodeValue("/root/oz_data/odiParam/iv_hsty_no", srch_hsty_no.value);
				
				// 레포트뷰어 호출.
				openOzwin("/root/oz_data");
			}
			
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="1,10;2,12;1,874;1,878;1,893;1,899;1,913;1,917;1,936;1,936;2,30;2,39;2,42;2,49;2,705;2,688;2,680;" style="font-family:굴림; ">
		<group id="group_scr" class="gro_sel" style="left:10px; top:50px; width:926px; height:101px; ">
			<caption id="caption9" class="list_cap02" style="left:0px; top:25px; width:325px; height:26px; text-align:center; "/>
			<caption id="caption7" class="list_cap02" style="left:0px; top:0px; width:325px; height:26px; text-align:center; "/>
			<caption id="caption4" class="list_cap02" style="left:0px; top:50px; width:325px; height:26px; text-align:center; "/>
			<caption id="caption2" class="list_cap01" style="left:0px; top:0px; width:110px; height:26px; text-align:center; ">편성부서</caption>
			<caption id="caption3" class="list_cap01" style="left:0px; top:25px; width:110px; height:26px; text-align:center; ">요청일자</caption>
			<input id="work_mm" ref="/root/reqData/searchData/mc_budg_4050_m/work_dt" navindex="2" style="left:113px; top:29px; width:62px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					work_mm_ch();
					]]>
				</script>
			</input>
			<caption id="caption1" class="list_cap01" style="left:0px; top:50px; width:110px; height:26px; text-align:center; ">일련번호</caption>
			<caption id="caption15" style="left:185px; top:25px; width:15px; height:26px; ">월</caption>
			<select1 id="work_dd" ref="/root/tempData/work_dd" navindex="3" appearance="minimal" editmode="inputsearch" style="left:215px; top:29px; width:70px; height:18px; ">
				<choices>
					<itemset nodeset="/root/resData/resform/mc_budg_4050_m/dataSet/CURLIST2/record">
						<label ref="dd"/>
						<value ref="dd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(work_dd, work_dd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(work_dd,"");
						return;
					}
					work_dd_ch();
					]]>
				</script>
			</select1>
			<caption id="caption40" style="left:295px; top:26px; width:15px; height:26px; ">일</caption>
			<datagrid id="datagrid2" nodeset="/root/resData/gridData/mc_budg_4055_l/dataSet/CURLIST/record" caption="행사명^evnt_cd^진행명^work_no^년월^사용부서^dept_cd^요청액^승인액" colsep="^" colwidth="100, 100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:324px; top:0px; width:602px; height:101px; ">
				<col ref="evnt_nm"/>
				<col ref="evnt_cd"/>
				<col ref="work_no"/>
				<col ref="work_no"/>
				<col ref="budg_yymm"/>
				<col ref="dept_cdnm"/>
				<col ref="use_dept_cd"/>
				<col ref="yramt"/>
				<col ref="amt"/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					_oth_clsf = "2";
					datagrid2_ch();
					]]>
				</script>
			</datagrid>
			<select1 id="srch_hsty_no" ref="/root/reqData/searchData/mc_budg_4052_l/hsty_no" navindex="4" appearance="minimal" editmode="inputsearch" style="left:113px; top:54px; width:155px; height:18px; ">
				<choices>
					<itemset nodeset="/root/resData/resform/mc_budg_4015_l/dataSet/CURLIST/record">
						<label ref="hsty_no"/>
						<value ref="hsty_no"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(srch_hsty_no, srch_hsty_no.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(srch_hsty_no,"");
						return;
					}
					hsty_no_ch();
					]]>
				</script>
			</select1>
			<select1 id="srch_dept_cd" ref="/root/reqData/searchData/mc_budg_4052_l/dept_cd" navindex="1" appearance="minimal" editmode="inputsearch" style="left:113px; top:4px; width:155px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/mc_budg_4050_m/dataSet/CURLIST1/record">
						<label ref="dept_team_clsf"/>
						<value ref="dept_cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(srch_dept_cd, srch_dept_cd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(srch_dept_cd,"");
						return;
					}
					dept_cd_ch();
					]]>
				</script>
			</select1>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:161px; width:926px; height:5px; "/>
		<group id="group2" class="gro_sel" style="left:10px; top:180px; width:926px; height:508px; ">
			<caption id="caption12" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption8" class="list_cap02" style="left:0px; top:25px; width:926px; height:26px; text-align:center; "/>
			<input id="srch_budg_yymm" ref="/root/reqData/searchData/mc_budg_4052_l/budg_yymm" class="req" navindex="6" maxlength="6" caption="예산년월" style="left:747px; top:4px; width:74px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					budg_yymm_ch();
					]]>
				</script>
			</input>
			<input id="srch_work_no" ref="/root/reqData/searchData/mc_budg_4052_l/work_no" class="req" navindex="8" inputtype="button" caption="진행번호" style="left:448px; top:29px; width:64px; height:18px; "/>
			<input id="work_nonm" ref="/root/tempData/work_nonm" editable="false" style="left:515px; top:29px; width:135px; height:18px; "/>
			<input id="evnt_cdnm" ref="/root/tempData/evnt_cdnm" editable="false" style="left:515px; top:4px; width:135px; height:18px; "/>
			<caption id="caption13" class="list_cap01" style="left:380px; top:0px; width:65px; height:26px; text-align:center; ">행사코드</caption>
			<input id="srch_evnt_cd" ref="/root/reqData/searchData/mc_budg_4052_l/evnt_cd" class="req" navindex="5" inputtype="button" caption="행사코드" style="left:448px; top:4px; width:64px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					if (open_mc_co_1020_evnt_cd()) {
					//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					}
					else {
					//팝업에서 취소 버튼을 누른 경우
						}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if (open_mc_co_1020_evnt_cd()) {
					//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					}
					else {
					//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
			</input>
			<caption id="caption5" class="list_cap01" style="left:109px; top:0px; width:83px; height:26px; text-align:center; ">유  형</caption>
			<caption id="caption6" class="list_cap01" style="left:109px; top:25px; width:83px; height:26px; text-align:center; ">사용부서</caption>
			<select1 id="srch_use_dept_cd" ref="/root/reqData/searchData/mc_budg_4052_l/use_dept_cd" class="req" navindex="7" appearance="minimal" editmode="inputsearch" caption="사용부서" style="left:195px; top:29px; width:155px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/mc_budg_4050_m/dataSet/CURLIST1/record">
						<label ref="dept_team_clsf"/>
						<value ref="dept_cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(srch_use_dept_cd, srch_use_dept_cd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(srch_use_dept_cd,"");
						return;
					}
					use_dept_cd_ch();
					]]>
				</script>
			</select1>
			<select1 id="radio" ref="/root/tempData/radio" appearance="full" cols="2" overflow="visible" style="left:215px; top:5px; width:95px; height:15px; border-style:none; ">
				<choices>
					<item>
						<label>수 입</label>
						<value>0</value>
					</item>
					<item>
						<label>지출</label>
						<value>1</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					radio_ch();
					]]>
				</script>
			</select1>
			<caption id="caption25" class="list_cap01" style="left:660px; top:0px; width:83px; height:26px; text-align:center; ">예산년월</caption>
			<caption id="caption31" class="list_cap01" style="left:0px; top:0px; width:110px; height:51px; color:#ff0000; text-align:center; ">입 력</caption>
			<caption id="caption11" class="list_cap01" style="left:380px; top:25px; width:65px; height:26px; text-align:center; ">진행번호</caption>
			<switch id="switch2" style="left:0px; top:75px; width:926px; height:433px; ">
				<case id="copy1" selected="true">
					<datagrid id="datagrid3" nodeset="/root/resData/gridData/mc_budg_4056_l/dataSet/CURLIST/record" caption="select^상 태^요청일자^예산코드^적 요^확정금액^차 액^요청금액" colsep="^" colwidth="100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:0px; top:0px; width:925px; height:424px; ">
						<col ref="select"/>
						<col ref="amt_s"/>
						<col ref="work_dt"/>
						<col editmode="inputsearch" ref="budg_cd" type="combo">
							<choices>
								<itemset nodeset="/root/initData/comboSet/mc_budg_4050_m_3/dataSet/CURLIST4/record">
									<label ref="budg_abrv_nm"/>
									<value ref="budg_cd"/>
								</itemset>
							</choices>
						</col>
						<col ref="rmks" type="input"/>
						<col ref="fix_asin_amt"/>
						<col ref="yramt"/>
						<col ref="yramt2" type="input"/>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
							_oth_clsf = "3";
							datagrid3_click();
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							if(datagrid3.col == "4"){
								var i = datagrid3.row;
								var ch_colref = datagrid3.colRef("budg_cd");
								
								if(datagrid3.col == ch_colref){
									var ch_var = datagrid3.valueMatrix(i,ch_colref);
									if(grid_combo_data_contains(ch_var,"/root/initData/comboSet/mc_budg_4050_m_3/dataSet/CURLIST4/record","budg_cd") == -1){
										show_message("정확한 값을 선택해 주세요.");
										datagrid3.valueMatrix(i,ch_colref) = "";
										return;
									}
								}
							}
							datagrid3_ch();
							]]>
						</script>
					</datagrid>
				</case>
				<case id="source1" style="left:0px; top:0px; width:924px; height:457px; ">
					<datagrid id="datagrid1" nodeset="/root/resData/gridData/mc_budg_4052_l/dataSet/CURLIST/record" caption="select^상 태^요청일자^예산코드^적 요^확정금액^차 액^요청금액^승인금액^이력번호^서브번호" colsep="^" colwidth="100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:0px; top:0px; width:924px; height:424px; ">
						<col ref="select"/>
						<col ref="amt_s"/>
						<col ref="work_dt"/>
						<col editmode="inputsearch" ref="budg_cd" type="combo">
							<choices>
								<itemset nodeset="/root/initData/comboSet/mc_budg_4050_m_1/dataSet/CURLIST4/record">
									<label ref="budg_abrv_nm"/>
									<value ref="budg_cd"/>
								</itemset>
							</choices>
						</col>
						<col ref="rmks" type="input"/>
						<col ref="fix_asin_amt"/>
						<col ref="yramt"/>
						<col ref="yramt2" type="input"/>
						<col ref="amt"/>
						<col ref="hsty_no"/>
						<col ref="sub_no"/>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
							if(datagrid1.col == "4"){
								var i = datagrid1.row;
								var ch_colref = datagrid1.colRef("budg_cd");
								
								if(datagrid1.col == ch_colref){
									var ch_var = datagrid1.valueMatrix(i,ch_colref);
									if(grid_combo_data_contains(ch_var,"/root/initData/comboSet/mc_budg_4050_m_1/dataSet/CURLIST4/record","budg_cd") == -1){
										show_message("정확한 값을 선택해 주세요.");
										datagrid1.valueMatrix(i,ch_colref) = "";
										return;
									}
								}
							}
							datagrid1_ch();
							]]>
						</script>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
							_oth_clsf = "1";
							datagrid1_click();
							]]>
						</script>
					</datagrid>
				</case>
			</switch>
			<button id="copy" class="tab16" disabled="true" group="stat" crud="R" style="left:235px; top:50px; width:235px; height:23px; ">
				<caption>COPY</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("copy1");
					]]>
				</script>
			</button>
			<button id="source" class="tab16" group="stat" crud="R" style="left:0px; top:50px; width:235px; height:23px; ">
				<caption>SOURCE</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("source1");
					]]>
				</script>
			</button>
		</group>
		<group id="group_tit" class="gro_tit" style="left:0px; top:0px; width:946px; height:39px; ">
			<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		</group>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:734px; width:926px; height:21px; ">
			<button id="btn_reset" class="btn02" style="left:221px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					model.reset();
					]]>
				</script>
			</button>
			<button id="btn_close" class="btn02" style="left:396px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					formClose();
					]]>
				</script>
			</button>
			<button id="btn_copy" class="btn02" style="left:165px; top:0px; width:52px; height:21px; ">
				<caption>복사</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					btn_copy_ch();
					]]>
				</script>
			</button>
			<button id="btn_delete" class="btn02" style="left:111px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					delete_ch();
					]]>
				</script>
			</button>
			<button id="btn_select" class="btn02" style="left:0px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					select_ch();
					]]>
				</script>
			</button>
			<button id="button13" class="btn03" style="left:276px; top:0px; width:69px; height:21px; ">
				<caption>요청서발행</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					fun_print();
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" style="left:343px; top:0px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					if(_oth_clsf == "2"){			
						grid = datagrid2;
					}
					if(_oth_clsf == "3"){			
						grid = datagrid3;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
					]]>
				</script>
			</button>
			<button id="btn_update" class="btn02" style="left:56px; top:0px; width:52px; height:21px; ">
				<caption>수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					update_ch();
					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" style="left:56px; top:0px; width:52px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					insert_ch();
					]]>
				</script>
			</button>
		</group>
		<group id="group4" class="gro_sel" style="left:10px; top:699px; width:926px; height:26px; ">
			<caption id="caption26" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption21" class="list_cap01" style="left:183px; top:0px; width:65px; height:26px; text-align:center; ">의뢰누계</caption>
			<input id="bjamt" ref="/root/resData/resform/mc_budg_4051_l/dataSet/CURLIST/record/bjamt" editable="false" style="left:68px; top:4px; width:112px; height:18px; "/>
			<caption id="caption23" class="list_cap01" style="left:366px; top:0px; width:65px; height:26px; text-align:center; ">집행누계</caption>
			<input id="jhamt" ref="/root/resData/resform/mc_budg_4051_l/dataSet/CURLIST/record/jhamt" editable="false" style="left:434px; top:4px; width:112px; height:18px; "/>
			<caption id="caption36" class="list_cap01" style="left:0px; top:0px; width:65px; height:26px; text-align:center; ">확정금액</caption>
			<input id="bggnamt" ref="/root/tempData/bggnamt" editable="false" style="left:616px; top:4px; width:112px; height:18px; "/>
			<input id="bgamt" ref="/root/tempData/bgamt" editable="false" style="left:799px; top:4px; width:112px; height:18px; "/>
			<caption id="caption18" class="list_cap01" style="left:548px; top:0px; width:65px; height:26px; text-align:center; ">추 경 액</caption>
			<input id="eramt" ref="/root/resData/resform/mc_budg_4051_l/dataSet/CURLIST/record/eramt" editable="false" style="left:251px; top:4px; width:112px; height:18px; "/>
			<caption id="caption19" class="list_cap01" style="left:731px; top:0px; width:65px; height:26px; text-align:center; ">합계금액</caption>
		</group>
	</xhtml:body>
</xhtml:html>
