<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>전표행번등록(FC_ACCT_2290)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session/>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
							<fc_acct_2290_m>
								<dataSet>
									<NOTE_STAT_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</NOTE_STAT_CURLIST>
									<DLCO_CLSF_CD_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</DLCO_CLSF_CD_CURLIST>
									<SLIP_CLSF_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</SLIP_CLSF_CURLIST>
									<MEDI_CD_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</MEDI_CD_CURLIST>
									<FRCR_CLSF_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</FRCR_CLSF_CURLIST>
									<MANG_CLSF_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</MANG_CLSF_CURLIST>
									<CUR_PROF_TYPE_LIST>
										<record>
											<cd_nm/>
											<cd/>
										</record>
									</CUR_PROF_TYPE_LIST>
									<CUR_ERPLACE_CD_LIST>
										<record>
											<cd_nm/>
											<cd/>
										</record>
									</CUR_ERPLACE_CD_LIST>
									<CUR_MANG_ITEM_CD_LIST>
										<record>
											<mang_item_cd/>
											<drcr_clsf/>
										</record>
									</CUR_MANG_ITEM_CD_LIST>
									<CUR_DLCO_CLSF_LIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CUR_DLCO_CLSF_LIST>
									<CUR_BUDGMANGCD_LIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CUR_BUDGMANGCD_LIST>
									<CUR_WHCO_NDSTB_CD_LIST>
										<record>
											<whco_ndstb_cd/>
											<whco_comn_cost_yn/>
										</record>
									</CUR_WHCO_NDSTB_CD_LIST>
								</dataSet>
							</fc_acct_2290_m>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData/>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<cmpy_cd/>
							<budg_cd/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqform>
						</reqform>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpDate/>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resform>
							<!-- 행번호             -->
							<slip_arow_no/>
							<!-- 예산코드           -->
							<budg_cd/>
							<!-- 예산코드명         -->
							<pch_sdysnm/>
							<!-- 사용부서           -->
							<use_dept_cd/>
							<!-- 사용부서명         -->
							<pch_buseonm/>
							<!-- 차변금액           -->
							<dr_amt/>
							<!-- 대변금액           -->
							<crdt_amt/>
							<!-- 거래처구분         -->
							<dlco_clsf_cd/>
							<!-- 거래처코드         -->
							<dlco_cd/>
							<!-- 거래처명           -->
							<dlco_nm/>
							<!-- 통합거래처코드     -->
							<intg_dlco_cd/>
							<!-- 부거래처명         -->
							<boks_dlco_nm/>
							<!-- 관리구분           -->
							<mang_clsf_cd/>
							<!-- 관리번호           -->
							<mang_no/>
							<!-- 은행코드           -->
							<mang_clsf_nm/>
							<bank_cd/>
							<!-- 은행코드명         -->
							<pch_banknm/>
							<!-- 영수증구분         -->
							<prop_equip_cd/>
							<!-- 매체코드           -->
							<prop_equip_cd_nm/>
							<medi_cd/>
							<!-- 상세매체           -->
							<dtls_medi_cd/>
							<!-- 행사코드           -->
							<evnt_cd/>
							<!-- 행사코드명         -->
							<pch_hsnm/>
							<!-- 단위               -->
							<unit/>
							<!-- 기산일자           -->
							<comp_dt/>
							<!-- 만기일자           -->
							<mtry_dt/>
							<!-- 수량               -->
							<qunt/>
							<!-- 전사전표번호구분   -->
							<occr_slip_clsf/>
							<!-- 전사전표번호       -->
							<occr_slip/>
							<!-- 상계전표번호       -->
							<setoff_slip_no/>
							<!-- 적요1              -->
							<rmks1/>
							<!-- 적요2              -->
							<rmks2/>
							<!-- 대상계정           -->
							<obj_acct_cd/>
							<!-- 대상계정명         -->
							<pch_dsacctnm/>
							<!-- 대상일자           -->
							<obj_dt/>
							<!-- 대상금액           -->
							<obj_amt/>
							<!-- 어음상태           -->
							<note_stat/>
							<!-- 외화구분코드       -->
							<frcr_clsf_cd/>
							<!-- 환율               -->
							<exrate/>
							<!-- 외화금액           -->
							<frcr_amt/>
							<prof_type_cd/>
							<occr_slip_clsf_cd/>
							<occr_slip_occr_dt/>
							<occr_slip_seq/>
							<erplace_cd/>
							<make_dt/>
							<etc_in/>
							<ern/>
							<suply_amt/>
						</resform>
						<fc_acct_2291_s>
							<dataSet>
								<CUR_MANG_ITEM_CD_LIST>
									<record>
										<mang_item_cd/>
										<drcr_clsf/>
									</record>
								</CUR_MANG_ITEM_CD_LIST>
							</dataSet>
						</fc_acct_2291_s>
						<fc_acct_2292_s>
							<dataSet>
								<CUR_BUDGMANGCD_LIST>
									<record>
										<cd/>
										<cdnm/>
										<cd_abrv_nm/>
										<cdnm_cd/>
										<cdabrvnm_cd/>
									</record>
								</CUR_BUDGMANGCD_LIST>
								<CUR_DLCO_CLSF_LIST>
									<record>
										<cd/>
										<cdnm/>
										<cd_abrv_nm/>
										<cdnm_cd/>
										<cdabrvnm_cd/>
									</record>
								</CUR_DLCO_CLSF_LIST>
								<CUR_ERPLACE_CD_LIST>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</CUR_ERPLACE_CD_LIST>
							</dataSet>
						</fc_acct_2292_s>
						<fc_acct_2293_s>
							<dataSet>
								<CUR_WHCO_NDSTB_CD_LIST>
									<record>
										<whco_ndstb_cd/>
										<whco_comn_cost_yn/>
									</record>
								</CUR_WHCO_NDSTB_CD_LIST>
							</dataSet>
						</fc_acct_2293_s>
						<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<gridData/>
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<keyData/>
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<fc_co_1101_l>
							<dataSet>
								<CURLIST1>
									<record>
										<cmpy_cd/>
										<dept_cd/>
										<dept_team_clsf/>
										<abrv_nm/>
										<offi_nm/>
										<dept_team_nm/>
										<part_nm/>
										<part_dn_nm/>
									</record>
								</CURLIST1>
							</dataSet>
						</fc_co_1101_l>
						<medi_ch/>
						<fc_acct_2015_l>
							<dataSet>
								<CURLIST>
									<record>
										<cd/>
										<cdnm/>
									</record>
								</CURLIST>
							</dataSet>
						</fc_acct_2015_l>
					</tempData>
					<!-- 저장소 -->
				</root>
			</instance>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<script type="javascript" src="/js/fcmc_common.js"/>
			<submission id="fc_acct_2290_m" action="/fc/acct2000/2290" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/initData/comboSet/fc_acct_2290_m/dataSet"/>
			<submission id="fc_acct_2291_s" action="/fc/acct2000/2291" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/resData/fc_acct_2291_s/dataSet"/>
			<submission id="fc_acct_2292_s" action="/fc/acct2000/2292" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/resData/fc_acct_2292_s/dataSet"/>
			<submission id="fc_acct_2293_s" action="/fc/acct2000/2293" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/resData/fc_acct_2293_s/dataSet"/>
			<submission id="fc_co_8000_s" action="/fc/co8000/8000" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/mc_co_8000_s"/>
			<submission id="fc_co_8080_s" action="/fc/co8000/8080" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/mc_co_8080_s"/>
			<submission id="mc_co_1001_l" action="/mc/co1000/1001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/mc_co_1001_l"/>
			<submission id="mc_co_1006_l" action="/mc/co1000/1006" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/mc_co_1005_l"/>
			<submission id="fc_co_1101" action="/fc/co1000/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/fc_co_1101_l/dataSet"/>
			<submission id="fc_acct_2015_l" action="/fc/acct2000/2015" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/fc_acct_2015_l/dataSet"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					if(getProperty("ss_cmpycd") != "100"){
						grp_buttons.attribute("top") = "585";
						group2.attribute("top") = "485";
					}
					init_controls();			// 컨트롤 초기화
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[

					init_setting();			// 기타 초기화
					mang_clsf_cd.dispatch("xforms-value-changed");
				]]>
			</script>
		</model>
		<script type="javascript">
			<![CDATA[
				var budg_mang_clsf_cd = "";			
				var parentWindow = window.parent;
				var childBody = parentWindow.body;
				var gvar_evnt_check_flag = "N";
			
				function init_controls() {
	
					//control의 기본 설정 적용

					//combo init
					set_default(
							dlco_clsf_cd				// 거래처구분
						,	occr_slip_clsf				// 전사전표번호구분
						,	frcr_clsf_cd				// 외화구분코드
						,	note_stat					// 어음상태
						,	medi_cd					// 매체코드
					);
					//input init
					set_default(
							slip_arow_no			       // 행번호
						,	pch_sdysnm				// 예산코드명
						,	pch_buseonm				// 사용부서명
						,	dr_amt					// 차변금액
						,	crdt_amt					// 대변금액
						,	dlco_nm					// 거래처명
						,	intg_dlco_cd				// 통합거래처코드
						,	boks_dlco_nm				// 부거래처명
						,	mang_clsf_nm				// 관리구분명
						,	mang_no					// 관리번호
						,	pch_banknm				// 은행코드명
						,	dtls_medi_cd				// 상세매체
						,	pch_hsnm					// 행사코드명
						,	unit						// 단위
						,	qunt						// 수량
						,	rmks1					// 적요1
						,	rmks2					// 적요2
						,	pch_dsacctnm				// 대상계정명
						,	obj_amt					// 대상금액
						,	exrate					// 환율
						,	frcr_amt					// 외화금액
					);
					//input button init
					set_default(
							budg_cd					// 예산코드
						,	use_dept_cd				// 사용부서
						,	dlco_cd					// 거래처코드
						,	mang_clsf_cd				// 관리구분						
						,	bank_cd					// 은행코드
						,	prop_equip_cd				// 영수증구분
						,	evnt_cd					// 행사코드
						,	occr_slip					// 전사전표번호
						,	setoff_slip_no				// 상계전표번호
						,	obj_acct_cd				// 대상계정
					);
					//input date init
					set_default(
							comp_dt					// 기산일자
						,	mtry_dt					// 만기일자
						,	obj_dt					// 대상일자
					);

					//control format 설정 적용
					set_format(
							"code"
						,	use_dept_cd				// 사용부서
						,	frcr_clsf_cd				// 외화구분코드
						,	dlco_cd					// 거래처코드
						,	intg_dlco_cd				// 통합거래처코드
						,	bank_cd					// 은행코드
						,	prop_equip_cd				// 영수증구분
						,	evnt_cd					// 행사코드
						,	budg_cd					// 예산코드
						,	obj_acct_cd				// 대상계정
					);
					set_format(
							"number1_2"
						,	frcr_amt					// 외화금액
					);
					set_format(
							"number1_4"
						,	exrate					// 환율
					);
					set_format(
							"number4"
						,	dr_amt					// 차변금액
						,	crdt_amt					// 대변금액
						,	obj_amt					// 대상금액
						,	qunt						// 수량
					);
					set_format(
							"date_1"
						,	comp_dt					// 기산일자
						,	mtry_dt					// 만기일자
						,	obj_dt					// 대상일자   
					);
					set_format(
							"string_c"
						,	slip_arow_no			       // 행번호
					);
					set_format(
							"string_l"
						,	dlco_clsf_cd				// 거래처구분
						,	mang_clsf_cd				// 관리구분
						,	medi_cd					// 매체코드
						,	occr_slip_clsf				// 전사전표번호구분
						,	note_stat					// 어음상태
						,	pch_sdysnm				// 예산코드명
						,	pch_buseonm				// 사용부서명
						,	dlco_nm					// 거래처명
						,	boks_dlco_nm				// 부거래처명
						,	mang_no					// 관리번호
						,	pch_banknm				// 은행코드명
						,	dtls_medi_cd				// 상세매체
						,	pch_hsnm					// 행사코드명
						,	unit						// 단위
						,	rmks1					// 적요1
						,	rmks2					// 적요2
						,	pch_dsacctnm				// 대상계정명
						,	occr_slip					// 전사전표번호
						,	setoff_slip_no				// 상계전표번호
					);
				}
			
				// 콤보 셋팅
				function send_fc_acct_2290_m() {
					//입력값 설정
					set_refvalue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
					set_refvalue("/root/reqData/searchData/budg_cd",budg_cd.value);
										
					//실행
					model.send("fc_acct_2290_m", false);
					//데이터 설정
					//전체항목 추가
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/NOTE_STAT_CURLIST", "record", "cdabrvnm_cd", "cd")
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/DLCO_CLSF_CD_CURLIST", "record", "cdabrvnm_cd", "cd")
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/SLIP_CLSF_CURLIST", "record", "cdabrvnm_cd", "cd")
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/MEDI_CD_CURLIST", "record", "cdabrvnm_cd", "cd")
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/FRCR_CLSF_CURLIST", "record", "cdabrvnm_cd", "cd")
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/MANG_CLSF_CURLIST", "record", "cdabrvnm_cd", "cd")
					
					//combobox refresh
					//srch_cntr_clsf_cd.refresh();
					//leas_hire_clsf_cd.refresh();
					//model.refresh();
				}
				
				// 기타 초기화
				function init_setting() {
					//setoff_slip_no.attribute("editable") = "false";
					occr_slip.attribute("editable") = "false";
					fn_GridToForm(parentWindow.datagrid1.row);
					
					send_fc_acct_2290_m();	// 콤보 초기화
					
					model.setFocus("slip_arow_no");
					
					if (model.getValue("/root/resData/resform/budg_cd") == "") {
						// 
					} else {
						gvar_evnt_check_flag = "Y";
						budg_cd.dispatch("xforms-value-changed");
						gvar_evnt_check_flag = "N";
					}
				}
				
				// 그리드의 내용을 폼에 셋팅
				function fn_GridToForm(iv_Row) {
					
					// 모화면의 커서를 첫컬럼으로 이동
					childBody.datagrid1.row = iv_Row;
					childBody.datagrid1.col = 1;
					
					// 행번호 셋팅
					set_refvalue("/root/resData/resform/slip_arow_no",String(childBody.datagrid1.row).GetZeroString(6));	// 행번호
					set_refvalue("/root/resData/resform/budg_cd",childBody.datagrid1.valueMatrix(iv_Row, 2));			// 예산코드					
					set_refvalue("/root/resData/resform/pch_sdysnm",childBody.datagrid1.valueMatrix(iv_Row, 3));		// 예산코드명
					set_refvalue("/root/resData/resform/use_dept_cd",childBody.datagrid1.valueMatrix(iv_Row, 20));		// 사용부서
					set_refvalue("/root/resData/resform/pch_buseonm",childBody.datagrid1.valueMatrix(iv_Row, 21));		// 사용부서
					set_refvalue("/root/resData/resform/dr_amt",childBody.datagrid1.valueMatrix(iv_Row, 4));				// 차변금액
					set_refvalue("/root/resData/resform/crdt_amt",childBody.datagrid1.valueMatrix(iv_Row, 5));			// 대변금액
					set_refvalue("/root/resData/resform/dlco_clsf_cd",childBody.datagrid1.valueMatrix(iv_Row, 9));			// 거래처구분
					set_refvalue("/root/resData/resform/dlco_cd",childBody.datagrid1.valueMatrix(iv_Row, 10));			// 거래처코드
					set_refvalue("/root/resData/resform/dlco_nm",childBody.datagrid1.valueMatrix(iv_Row, 11));			// 거래처명
					set_refvalue("/root/resData/resform/intg_dlco_cd",childBody.datagrid1.valueMatrix(iv_Row, 36));		// 통합거래처코드
					set_refvalue("/root/resData/resform/boks_dlco_nm",childBody.datagrid1.valueMatrix(iv_Row, 12));		// 부거래처명
					set_refvalue("/root/resData/resform/mang_clsf_cd",childBody.datagrid1.valueMatrix(iv_Row, 13));		// 관리구분
					set_refvalue("/root/resData/resform/mang_no",childBody.datagrid1.valueMatrix(iv_Row, 14));			// 관리번호
					set_refvalue("/root/resData/resform/bank_cd",childBody.datagrid1.valueMatrix(iv_Row, 24));			// 은행코드
					set_refvalue("/root/resData/resform/pch_banknm",childBody.datagrid1.valueMatrix(iv_Row, 25));		// 은행코드명
					set_refvalue("/root/resData/resform/prop_equip_cd",childBody.datagrid1.valueMatrix(iv_Row, 37));		// 영수증구분
					set_refvalue("/root/resData/resform/medi_cd",childBody.datagrid1.valueMatrix(iv_Row, 16));			// 매체코드
					set_refvalue("/root/resData/resform/dtls_medi_cd",childBody.datagrid1.valueMatrix(iv_Row, 17));		// 상세매체코드
					set_refvalue("/root/resData/resform/evnt_cd",childBody.datagrid1.valueMatrix(iv_Row, 18));			// 행사코드
					set_refvalue("/root/resData/resform/pch_hsnm",childBody.datagrid1.valueMatrix(iv_Row, 19));			// 행사코드명
					set_refvalue("/root/resData/resform/unit",childBody.datagrid1.valueMatrix(iv_Row, 26));				// 단위
					set_refvalue("/root/resData/resform/comp_dt",childBody.datagrid1.valueMatrix(iv_Row, 22));			// 기산일자
					set_refvalue("/root/resData/resform/mtry_dt",childBody.datagrid1.valueMatrix(iv_Row, 23));			// 만기일자
					set_refvalue("/root/resData/resform/qunt",childBody.datagrid1.valueMatrix(iv_Row, 27));				// 수량
					set_refvalue("/root/resData/resform/occr_slip_clsf",childBody.datagrid1.valueMatrix(iv_Row, 44));		// 전사전표구분
					set_refvalue("/root/resData/resform/occr_slip",childBody.datagrid1.valueMatrix(iv_Row, 45));			// 전사전표번호
					set_refvalue("/root/resData/resform/setoff_slip_no",childBody.datagrid1.valueMatrix(iv_Row, 43));		// 상계전표번호
					set_refvalue("/root/resData/resform/rmks1",parentWindow.rmks1.value);							// 적요1
					set_refvalue("/root/resData/resform/rmks2",childBody.datagrid1.valueMatrix(iv_Row, 7));				// 적요2
					set_refvalue("/root/resData/resform/obj_acct_cd",childBody.datagrid1.valueMatrix(iv_Row, 28));		// 대상계정
					set_refvalue("/root/resData/resform/pch_dsacctnm",childBody.datagrid1.valueMatrix(iv_Row, 29));		// 대상계정명
					set_refvalue("/root/resData/resform/obj_dt",childBody.datagrid1.valueMatrix(iv_Row, 30));				// 대상일자
					set_refvalue("/root/resData/resform/obj_amt",childBody.datagrid1.valueMatrix(iv_Row, 31));			// 대상금액
					set_refvalue("/root/resData/resform/note_stat",childBody.datagrid1.valueMatrix(iv_Row, 35));			// 어음상태
     					set_refvalue("/root/resData/resform/frcr_clsf_cd",childBody.datagrid1.valueMatrix(iv_Row, 32));			// 외화구분코드
     					set_refvalue("/root/resData/resform/exrate",childBody.datagrid1.valueMatrix(iv_Row, 34));				// 환율
     					set_refvalue("/root/resData/resform/frcr_amt",childBody.datagrid1.valueMatrix(iv_Row, 33));			// 외화금액

     					set_refvalue("/root/resData/resform/prof_type_cd",childBody.datagrid1.valueMatrix(iv_Row, 39).substring(0, 2));		//  39.세금계산서번호 
     					set_refvalue("/root/resData/resform/occr_slip_clsf_cd",childBody.datagrid1.valueMatrix(iv_Row, 39).substring(2, 4));		//  39.세금계산서번호 
     					set_refvalue("/root/resData/resform/occr_slip_occr_dt",childBody.datagrid1.valueMatrix(iv_Row, 39).substring(4, 12));	//  39.세금계산서번호 
     					set_refvalue("/root/resData/resform/occr_slip_seq",childBody.datagrid1.valueMatrix(iv_Row, 39).substring(12, 20));		//  39.세금계산서번호 

     					set_refvalue("/root/resData/resform/erplace_cd",childBody.datagrid1.valueMatrix(iv_Row, 41));						//  41.사업장코드
     					set_refvalue("/root/resData/resform/make_dt",childBody.datagrid1.valueMatrix(iv_Row, 40));						//  40.작성일자
     					set_refvalue("/root/resData/resform/etc_in",childBody.datagrid1.valueMatrix(iv_Row, 38));							//  38.잡수익
     					set_refvalue("/root/resData/resform/ern",childBody.datagrid1.valueMatrix(iv_Row, 42));							//  42.공급자번호

     					set_refvalue("/root/resData/resform/suply_amt",childBody.datagrid1.valueMatrix(iv_Row, 52));						//  52.공급가액
					model.refresh();

					fun_budg_cd_ch();
				}
				
				// 그리드의 내용을 폼에 셋팅
				function fn_FormToGrid(iv_Row, iv_X) {
					var var_suply_amt = 0;
					
					// HEAD 필수 CHECK
					if (budg_cd.value.Trim().ReplaceString("-", "").length != 6) {
						show_message("예산코드는 필수입력사항입니다.");
						model.setFocus("budg_cd");
						return false;
					}
					if (use_dept_cd.value.Trim().ReplaceString("-", "").length != 6) {
						show_message("사용부서는 필수입력사항입니다.");
						model.setFocus("use_dept_cd");
						return false;
					}
					if (dr_amt.value.Trim().length == 0) {
						dr_amt.value = "0";
					}
					if (crdt_amt.value.Trim().length == 0) {
						crdt_amt.value = "0";
					}
					if (Number(dr_amt.value.Trim()) != 0 && Number(crdt_amt.value.Trim()) != 0) {
						show_message("차변금액과 대변금액은 동시에 입력될 수 없습니다.");
						model.setFocus("dr_amt");
						return false;
					}
					
					// BACKGROUND COLOR로 CHECK
					if (dlco_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(dlco_clsf_cd,"trim","focus","거래처구분은 필수입력항목입니다.")) { return false; }     
					}
					if (dlco_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(dlco_cd,"trim","focus","거래처코드는 필수입력항목입니다.")) { return false; }     
					}
					if (boks_dlco_nm.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(boks_dlco_nm,"trim","focus","부거래처명은 필수입력항목입니다.")) { return false; }     
					}					
					if (mang_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(mang_clsf_cd,"trim","focus","관리구분은 필수입력항목입니다.")) { return false; }     
					}										
					if (prop_equip_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(prop_equip_cd,"trim","focus","영수증구분은 필수입력항목입니다.")) { return false; }     
					}
					if (dtls_medi_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(dtls_medi_cd,"trim","focus","상세매체는 필수입력항목입니다.")) { return false; }     
					}

					// 유가증권 or 보험
					if (budg_cd.value.Trim().substring(0, 4) == "1713" || budg_cd.value.Trim() == "022100") {
						if (budg_cd.value.Trim() == "022100") {	// 유가증권
							if (mang_clsf_cd.value.Trim().substring(0, 1) != "2") {
								show_message("예산코드가 유가증권(022100)이면 관리구분(증권구분)코드의 첫번째 자리수가 '2'가 되어야 합니다.");
								model.setFocus("mang_clsf_cd");
								return false;
							}
						}
						else {	// 보험
							if (mang_clsf_cd.value.Trim().substring(0, 4) != "5100"
							&& mang_clsf_cd.value.Trim().substring(0, 4) != "5200"
							&& mang_clsf_cd.value.Trim().substring(0, 4) != "5400" ) {
								show_message("예산코드가 보험(1713으로 시작)이면 관리구분(보험구분)코드는 '5100', '5200', '5400'중에 하나가 되어야 합니다.");
								model.setFocus("mang_clsf_cd");
								return false;
							}
						}						
					}
					if (mang_no.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (budg_cd.value.Trim() == "022100") {	// 유가증권
							if (!check_reqItem(mang_no,"trim","focus","관리번호(증권번호)는 필수입력항목입니다.")) { return false; }     
							if (mang_no.value.Trim().length != 8) {
								show_message("관리번호(증권번호)는 형식이 일치하지 않습니다.(8자리)");
								model.setFocus("mang_no");
								return false;
							}
						}
						else {
							if (!check_reqItem(mang_no,"trim","focus","관리번호는 필수입력항목입니다.")) { return false; }     
						}
					}
					
					// 예산코드가 예수금(대체,기타)이면서 차변금액이 입력된 경우 전사전표번호 필수 입력
					if (budg_cd.value.Trim() == "463100" || budg_cd.value.Trim() == "456100"
					|| budg_cd.value.Trim() == "466500" || budg_cd.value.Trim() == "466700"
					|| budg_cd.value.Trim() == "466800" ) {
						if (Number(dr_amt.value.Trim()) != 0) {
							if (!check_reqItem(occr_slip_clsf,"trim","focus","전사전표구분은 필수입력항목입니다.")) { return false; }     
							if (occr_slip.value.Trim().ReplaceString("-", "").length < 17 ) {
								show_message("전사전표번호는 필수입력항목입니다.");
								model.setFocus("occr_slip");
								return false;
							}
						}
					}
					if (setoff_slip_no.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (setoff_slip_no.value.Trim().ReplaceString("-", "").length != 20) {
							show_message("상계전표번호는 필수입력항목입니다.");
							model.setFocus("setoff_slip_no");
							return false;
						}
					}
					if (medi_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(medi_cd,"trim","focus","매체코드는 필수입력항목입니다.")) { return false; }     
					}
					if (dtls_medi_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(dtls_medi_cd,"trim","focus","상세매체코드는 필수입력항목입니다.")) { return false; }     
					}
					if (evnt_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(evnt_cd,"trim","focus","행사코드는 필수입력항목입니다.")) { return false; }     
					}
					if (comp_dt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (comp_dt.value.Trim().ReplaceString("-", "").length != 8) {
							show_message("기산일자는 필수입력항목입니다.");
							model.setFocus("comp_dt");
							return false;
						}
					}
					if (mtry_dt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (mtry_dt.value.Trim().ReplaceString("-", "").length != 8) {
							show_message("만기일자 필수입력항목입니다.");
							model.setFocus("mtry_dt");
							return false;
						}
					}
					if (unit.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(unit,"trim","focus","단위는 필수입력항목입니다.")) { return false; }     
					}
					if (qunt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (Number(qunt.value.Trim()) == 0) {
							show_message("수량은 필수입력항목입니다.");
							model.setFocus("qunt");
							return false;
						}
					}
					if (rmks1.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(rmks1,"trim","focus","적요1은 필수입력항목입니다.")) { return false; }     
					}
					if (rmks2.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(rmks2,"trim","focus","적요2는 필수입력항목입니다.")) { return false; }     
					}
					if (obj_acct_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(obj_acct_cd,"trim","focus","대상계정코드는 필수입력항목입니다.")) { return false; }     
					}
					if (obj_dt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (obj_dt.value.Trim().ReplaceString("-", "").length != 8) {
							show_message("대상일자는 필수입력항목입니다.");
							model.setFocus("obj_dt");
							return false;
						}
					}
					if (obj_amt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (Number(obj_amt.value.Trim()) == 0) {
							show_message("대상금액은 필수입력항목입니다.");
							model.setFocus("obj_amt");
							return false;
						}
					}
					if (note_stat.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(note_stat,"trim","focus","어음상태는 필수입력항목입니다.")) { return false; }     
					}
					if (frcr_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(frcr_clsf_cd,"trim","focus","외화구분코드는 필수입력항목입니다.")) { return false; }     
					}
					if (exrate.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (Number(exrate.value.Trim()) == 0) {
							show_message("환율은 필수입력항목입니다.");
							model.setFocus("exrate");
							return false;
						}
					}
					if (frcr_amt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (Number(frcr_amt.value.Trim()) == 0) {
							show_message("외화금액은 필수입력항목입니다.");
							model.setFocus("frcr_amt");
							return false;
						}
					}
					
					
//					세금계산서  추가 -------------------------------------------------------------------------------start
					if(getProperty("ss_cmpycd") == "332"){
						
						if (prof_type_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							
							if (!check_reqItem(prof_type_cd,"trim","focus","세금계산서유형은 필수입력항목입니다.")) { return false; }     
							
						}
											
						if (occr_slip_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (occr_slip_clsf_cd.value == "") {
								model.alert("세금계산서구분은 필수입력항목입니다.");
								model.setFocus("prof_type_cd");
								return;
							}
						}
	
						if (occr_slip_occr_dt.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (!check_reqItem(occr_slip_occr_dt,"trim","focus","세금계산서 발생일자는 필수입력항목입니다.")) { return false; }     
						}
	
						if (make_dt.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (!check_reqItem(make_dt,"trim","focus","작성일자는 필수입력항목입니다.")) { return false; }     
							
							if (make_dt.value.ReplaceString("-", "").substring(0, 6) != parentWindow.srch_slip_occr_dt.value.ReplaceString("-", "").substring(0, 6)) {
								model.alert("예산년월과 작성일자의 월이 상이합니다.");
								model.setFocus("make_dt");
								return;
							}
						}
	
						if (erplace_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (!check_reqItem(erplace_cd,"trim","focus","사업장코드는 필수입력항목입니다.")) { return false; }     
						}
						
						if (ern.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (ern.value.length!= 12) {
								model.alert("공급자번호는 필수입력항목입니다.");
								model.setFocus("ern");
								return;
							}
						}
						
						if (suply_amt.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (!check_reqItem(suply_amt,"trim","focus","과표는 필수입력항목입니다.")) { return false; }     
						}
						// 세금계산서 임시순번 채번
						if (occr_slip_seq.value == "" && prof_type_cd.value != "") {
							
							var_occr_slip_seq = "";
	
							for (i=1;i< childBody.datagrid1.Rows-1;i++) {
	
								if (childBody.datagrid1.valueMatrix(i, 39).ReplaceString("-", "").substring(0, 12) == prof_type_cd.value.substring(0, 2) + occr_slip_clsf_cd.value + occr_slip_occr_dt.value.ReplaceString("-", "") &&
								    childBody.datagrid1.valueMatrix(i, 39).ReplaceString("-", "").substring(12, 16) > var_occr_slip_seq) {
								    	var_occr_slip_seq = childBody.datagrid1.valueMatrix(i, 39).ReplaceString("-", "").substring(12, 16);
								}
							}
							
							if (Number(var_occr_slip_seq) >= 0) {
								occr_slip_seq.value = Number(var_occr_slip_seq) + 1;
								occr_slip_seq.value = occr_slip_seq.value.GetZeroString(4);
							}
							else {
								occr_slip_seq.value = "0001";
							}
						}	
					}
//					세금계산서  추가 -------------------------------------------------------------------------------end
					
					if (iv_X == "I") {
						childBody.datagrid1.insertRow(childBody.datagrid1.rows - 1);

						childBody.datagrid1.row = childBody.datagrid1.rows - 2;
						childBody.datagrid1.col = 1;

						slip_arow_no.value = childBody.datagrid1.rows - 2;
						slip_arow_no.value = slip_arow_no.value.GetZeroString(6);
						
						iv_Row = childBody.datagrid1.rows - 2;
						
						childBody.datagrid1.rowStatus(iv_Row) = 3;
					}
					
					if (iv_X == "A") {
						childBody.datagrid1.insertRow(childBody.datagrid1.row);

						childBody.datagrid1.row = childBody.datagrid1.row;
						childBody.datagrid1.col = 1;
						slip_arow_no.value = childBody.datagrid1.row;
						slip_arow_no.value = slip_arow_no.value.GetZeroString(6);
						
						iv_Row = childBody.datagrid1.row;
						childBody.datagrid1.rowStatus(iv_Row) = 3;
					}
					
					if (iv_X == "U") {
						childBody.datagrid1.rowStatus(iv_Row) = 3;
					}

					childBody.datagrid1.valueMatrix(iv_Row, 2)  = budg_cd.value;          		// 예산코드      
					childBody.datagrid1.valueMatrix(iv_Row, 3)  = pch_sdysnm.value;        	// 예산코드명    
					childBody.datagrid1.valueMatrix(iv_Row, 4)  = dr_amt.value;            		// 차변금액      
					childBody.datagrid1.valueMatrix(iv_Row, 5)  = crdt_amt.value;          		// 대변금액      
					childBody.datagrid1.valueMatrix(iv_Row, 6)  = rmks1.value;             		// 적요1
					childBody.datagrid1.valueMatrix(iv_Row, 7)  = rmks2.value;             		// 적요2         
					
					// 차대구분
					if (Number(dr_amt.value.Trim()) != 0) {
						childBody.datagrid1.valueMatrix(iv_Row, 8)  = "1";            			// 차변
					}
					else {
						childBody.datagrid1.valueMatrix(iv_Row, 8)  = "9";             		// 대변
					}
					
					childBody.datagrid1.valueMatrix(iv_Row, 9)  = dlco_clsf_cd.value;      	// 거래처구분    
					childBody.datagrid1.valueMatrix(iv_Row, 10) = dlco_cd.value;          		// 거래처코드    
					childBody.datagrid1.valueMatrix(iv_Row, 11) = dlco_nm.value;           	// 거래처명      
					childBody.datagrid1.valueMatrix(iv_Row, 12) = boks_dlco_nm.value;      	// 부거래처명    
					childBody.datagrid1.valueMatrix(iv_Row, 13) = mang_clsf_cd.value;      	// 관리구분      
					childBody.datagrid1.valueMatrix(iv_Row, 14) = mang_no.value;           	// 관리번호      
					
					// 소득구분코드
					if (budg_cd.value.Trim().substring(0, 4) == "4255" || budg_cd.value.Trim().substring(0, 4) == "4270") {
						childBody.datagrid1.valueMatrix(iv_Row, 15) = mang_clsf_cd.value.Trim().substring(0, 6);
					}
					
					childBody.datagrid1.valueMatrix(iv_Row, 16) = medi_cd.value           	// 매체코드      
					childBody.datagrid1.valueMatrix(iv_Row, 17) = dtls_medi_cd.value      	// 상세매체      
					childBody.datagrid1.valueMatrix(iv_Row, 18) = evnt_cd.value           		// 행사코드      
					childBody.datagrid1.valueMatrix(iv_Row, 19) = pch_hsnm.value          	// 행사코드명    
					childBody.datagrid1.valueMatrix(iv_Row, 20) = use_dept_cd.value       	// 사용부서      
					childBody.datagrid1.valueMatrix(iv_Row, 21) = pch_buseonm.value       	// 사용부서명    
					childBody.datagrid1.valueMatrix(iv_Row, 22) = comp_dt.value           	// 기산일자      
					childBody.datagrid1.valueMatrix(iv_Row, 23) = mtry_dt.value           		// 만기일자      
					childBody.datagrid1.valueMatrix(iv_Row, 24) = bank_cd.value           		// 은행코드      
					childBody.datagrid1.valueMatrix(iv_Row, 25) = pch_banknm.value        	// 은행코드명    
					childBody.datagrid1.valueMatrix(iv_Row, 26) = unit.value              		// 단위          
					childBody.datagrid1.valueMatrix(iv_Row, 27) = qunt.value              		// 수량          
					childBody.datagrid1.valueMatrix(iv_Row, 28) = obj_acct_cd.value       	// 대상계정      
					childBody.datagrid1.valueMatrix(iv_Row, 29) = pch_dsacctnm.value      	// 대상계정명    
					childBody.datagrid1.valueMatrix(iv_Row, 30) = obj_dt.value            		// 대상일자      
					childBody.datagrid1.valueMatrix(iv_Row, 31) = obj_amt.value           		// 대상금액      
					childBody.datagrid1.valueMatrix(iv_Row, 32) = frcr_clsf_cd.value      		// 외화구분코드  
					childBody.datagrid1.valueMatrix(iv_Row, 33) = frcr_amt.value          		// 외화금액      
					childBody.datagrid1.valueMatrix(iv_Row, 34) = exrate.value            		// 환율          
					childBody.datagrid1.valueMatrix(iv_Row, 35) = note_stat.value         		// 어음상태      
					childBody.datagrid1.valueMatrix(iv_Row, 36) = intg_dlco_cd.value      	// 통합거래처코드
					childBody.datagrid1.valueMatrix(iv_Row, 37) = prop_equip_cd.value     	// 영수증구분    
					
					childBody.datagrid1.valueMatrix(iv_Row, 38) = etc_in.value
					childBody.datagrid1.valueMatrix(iv_Row, 39) = prof_type_cd.value.substring(0, 2) + occr_slip_clsf_cd.value + occr_slip_occr_dt.value.ReplaceString("-", "") + occr_slip_seq.value;				// 세금계산서번호 
					childBody.datagrid1.valueMatrix(iv_Row, 40) = make_dt.value
					childBody.datagrid1.valueMatrix(iv_Row, 41) = erplace_cd.value
					childBody.datagrid1.valueMatrix(iv_Row, 42) = ern.value 

					childBody.datagrid1.valueMatrix(iv_Row, 43) = setoff_slip_no.value    	// 상계전표번호  
					childBody.datagrid1.valueMatrix(iv_Row, 44) = occr_slip_clsf.value    	// 전사전표구분  
					childBody.datagrid1.valueMatrix(iv_Row, 45) = occr_slip.value         		// 전사전표번호  
											
					//childBody.datagrid1.valueMatrix(iv_Row, 52) = suply_amt.value; // 52.공급가액  20170316 봉은정추가
					
					if(getProperty("ss_cmpycd") != "100" && (budg_cd.value == "182000" || budg_cd.value == "462000")){
						childBody.datagrid1.valueMatrix(iv_Row, 38) = etc_in.value
						childBody.datagrid1.valueMatrix(iv_Row, 39) = prof_type_cd.value.substring(0, 2) + occr_slip_clsf_cd.value + occr_slip_occr_dt.value.ReplaceString("-", "") + occr_slip_seq.value;				// 세금계산서번호 
						childBody.datagrid1.valueMatrix(iv_Row, 40) = make_dt.value
						childBody.datagrid1.valueMatrix(iv_Row, 41) = erplace_cd.value
						childBody.datagrid1.valueMatrix(iv_Row, 42) = ern.value 
						childBody.datagrid1.valueMatrix(iv_Row, 51)  = Number(dr_amt.value) + Number(crdt_amt.value);                     // 51.과표						
						childBody.datagrid1.valueMatrix(iv_Row, 52) = suply_amt.value;                     							// 52.공급가액
					}

					return true;
				}
				
				var gstr_popupid = "";
				
				// 팝업
				function setDept_cd(iv_dept_cd, iv_dept_nm, iv_dept_team_clsf, iv_offi_nm, iv_dept_team_nm, iv_part_nm, iv_part_dn_nm){	
					model.setValue("/root/resData/resform/use_dept_cd", iv_dept_cd);
					model.setValue("/root/resData/resform/pch_buseonm", iv_dept_nm);
					use_dept_cd.refresh();
					pch_buseonm.refresh();
				}
				
				function setEvntInfo(Evnt_cd, Evnt_cd_nm){
					// 행사코드 팝업
					if (gstr_popupid == "evnt_cd") {
						evnt_cd.value = Evnt_cd;
						pch_hsnm.value = Evnt_cd_nm;
					}
					// 예산코드 팝업
					if (gstr_popupid == "budg_cd") {
						budg_cd.value = Evnt_cd;
						pch_sdysnm.value = Evnt_cd_nm;
					}
					// 대상계정 팝업
					if (gstr_popupid == "obj_acct_cd") {
						obj_acct_cd.value = Evnt_cd;
						pch_dsacctnm.value = Evnt_cd_nm;
					}
					if (gstr_popupid == "dtls_medi_cd") {
						dtls_medi_cd.value =  Evnt_cd;						
					}
				}
				
				function open_fc_acct_1180(p_where,p_mode,p_title,p_readonly,p_to) {
					var need_popup = true;
					var rcvs_flag = false;
	
					var popid = "fc_acct_1180";
					var subid = "fc_acct_1181_l";
					
					
					p_where = p_where.toUpperCase();
					
					if (gstr_popupid != "dtls_medi_cd") {
						if (!check_reqItem(dlco_clsf_cd,"none","focus","거래처검색은 거래처구분을 선택 후 조회 할 수 있습니다.")) {return rcvs_flag};
					}
					//검색조건이 모두 충족하지 않으면 종료한다.
					if (gstr_popupid == "ern") { // 공급자번호
						if (p_where == "FOCUS" && (ern.value.Trim() == "")) {
							return rcvs_flag;
						}				
					}else{
						if (p_where == "FOCUS" && (dlco_clsf_cd.value.Trim() == "" || dlco_cd.value.Trim() == "")) {
							dlco_nm.value	= "";
							intg_dlco_cd.value = "";
							reset_refnode(get_popup_rcvs_ref(popid));
							return rcvs_flag;
						}
					}
					
					////버튼클릭으로 이벤트가 발생하기 전에
					////value-changed 이벤트가 먼저 발생한 경우
					////input button의 내부 버튼이 클릭됐는지 여부를 확인한다.
					//if (check_dup_input_event()) {					
					//	return rcvs_flag;
					//}
	
					set_popup_send_data(popid		,"mode"			,p_mode			);
					set_popup_send_data(popid		,"title"			,p_title			);
					if (gstr_popupid == "ern") { // 공급자번호
						set_popup_send_data(popid		,"clsf_cd"			,"93"	);
						set_popup_send_data(popid		,"cd_f"			,ern.value		);
						set_popup_send_data(popid		,"cd_t"			,ern.value		);
	//					set_popup_send_data(popid		,"cd_abrv_nm"		,ern.value		);
					}else if (gstr_popupid == "dtls_medi_cd") { // 사원
						set_popup_send_data(popid		,"clsf_cd"			,"91"	);
						set_popup_send_data(popid		,"cd_f"			,dtls_medi_cd.value		);
						set_popup_send_data(popid		,"cd_t"			,dtls_medi_cd.value		);
	//					set_popup_send_data(popid		,"cd_abrv_nm"		,ern.value		);
					}else{
						set_popup_send_data(popid		,"readonly"		,p_readonly		);
						set_popup_send_data(popid		,"clsf_cd"			,dlco_clsf_cd.value	);
						set_popup_send_data(popid		,"cd_f"			,dlco_cd.value		);
						set_popup_send_data(popid		,"cd_t"			,dlco_cd.value		);
						//set_popup_send_data(popid		,"cd_abrv_nm"		,dlco_cd.value		);
						set_popup_send_data(popid		,"cd_abrv_nm"		,""				);
					}
	
					//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
					if (p_where == "FOCUS") {
						//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
						//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
						model.removenode(get_popup_rcvs_ref(popid));
						//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
						model.makeNode(get_popup_rcvs_ref(popid));
						
						//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
						send_submission(
								"auto_" + subid
							,	get_popup_send_ref(popid)
							,	get_popup_rcvs_ref(subid) + "/dataSet"
							,	"/fc/acct1000/1181"
							,	"urlencoded-post"
							,	"application/x-www-form-urlencoded"
						);
						
						totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
				
						if (totalcnt == 1) {
							//데이터가 1건이고 focus out에서 호출한 경우
							//데이터를 설정하고 나간다.
	
							//model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							//return;
							need_popup = false;
							rcvs_flag = true;
						}
						else if (totalcnt == 0) {
							//show_message("거래처코드의 검색결과가 없습니다.");
							//return;
							need_popup = false;	
							rcvs_flag = false;
						}
						else {
							//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
							//만약 1건 이상인 경우 popup을 호출해 달라고 하면
							//return을 지우면 됨
							//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
							//return;
							need_popup = true;
						}
					}
					
					//버튼클릭으로 이벤트가 발생하기 전에
					//value-changed 이벤트가 먼저 발생한 경우
					//input button의 내부 버튼이 클릭됐는지 여부를 확인한다.
					if (check_dup_input_event()) {					
						return rcvs_flag;
					}
					
					//그외 버튼인 경우는 계속 진행
					if (need_popup) {
						rcvs_flag = open_popup(popid,"640");
					}
					
					if (gstr_popupid == "ern") { // 공급자번호
	//					if (get_popp_rcvs_data(popid,"clsf_cd") != "")			recp_pers_clsf.value		=	get_popup_rcvs_data(popid,"clsf_cd");
						if (get_popup_rcvs_data(popid,"cd") == "104-81-24695") {
							ern.value = "";
						}
						else {
							if (get_popup_rcvs_data(popid,"cd") != "")				ern.value		=	get_popup_rcvs_data(popid,"cd");
							if (get_popup_rcvs_data(popid,"cd") == "") {
								boks_dlco_nm.value = "";
							}
							else {
								if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		boks_dlco_nm.value		=	get_popup_rcvs_data(popid,"cd_abrv_nm");
							}
						}
						//그외의 값은 지워지도록 한다.
						//if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
						//pay_bank_cd_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					}else if (gstr_popupid == "dtls_medi_cd") { // 공급자번호
						if (get_popup_rcvs_data(popid,"cd") != "")				dtls_medi_cd.value		=	get_popup_rcvs_data(popid,"cd");
							/*
							if (get_popup_rcvs_data(popid,"cd") == "") {
								boks_dlco_nm.value = "";
							}
							else {
								if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		boks_dlco_nm.value		=	get_popup_rcvs_data(popid,"cd_abrv_nm");
							}*/
						
						//그외의 값은 지워지도록 한다.
						//if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
						//pay_bank_cd_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					}else{
						//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
						//다시 조회 하기 쉽도록 하고
						if (get_popup_rcvs_data(popid,"clsf_cd") != "")			dlco_clsf_cd.value		=	get_popup_rcvs_data(popid,"clsf_cd");
						//if (get_popup_rcvs_data(popid,"cd") != "")				dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
						//if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
						//if (get_popup_rcvs_data(popid,"intg_cd") != "")			intg_dlco_cd.value		=	get_popup_rcvs_data(popid,"intg_cd");
						//그외의 값은 지워지도록 한다.
						dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
						dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
						intg_dlco_cd.value		=	get_popup_rcvs_data(popid,"intg_cd");
						
						reset_popup_send_data(popid);
					}
						
					return rcvs_flag;
				}
			
				// 예산별관리항목별로 필수색 셋팅
				function fn_background_color_setting(rv_drcr_clsf) {
					var var_drcr_clsf = "";			// 차대구분

					// 모든 컨트롤의 backcolor를 기본색으로 설정
					slip_arow_no.attribute("background-color") = DEFAULT_COLOR_REQ;       	// 행번호
					budg_cd.attribute("background-color") = DEFAULT_COLOR_REQ;         	// 예산코드    
					use_dept_cd.attribute("background-color") = DEFAULT_COLOR_REQ;     	// 사용부서    
					dr_amt.attribute("background-color") = DEFAULT_COLOR_REQ;          	// 차변금액    
					crdt_amt.attribute("background-color") = DEFAULT_COLOR_REQ;        	// 대변금액    
					dlco_clsf_cd.attribute("background-color") = "white";    				// 거래처구분  
					dlco_cd.attribute("background-color") = "white";         				// 거래처코드  
					boks_dlco_nm.attribute("background-color") = "white";    				// 부거래처명  
					mang_clsf_cd.attribute("background-color") = "white";    				// 관리구분    
					mang_no.attribute("background-color") = "white";         				// 관리번호    
					bank_cd.attribute("background-color") = "white";         				// 은행코드    
					prop_equip_cd.attribute("background-color") = "white";   				// 영수증구분  
					medi_cd.attribute("background-color") = "white";         				// 매체코드    
					dtls_medi_cd.attribute("background-color") = "white";    				// 상세매체    
					evnt_cd.attribute("background-color") = "white";         				// 행사코드    
					unit.attribute("background-color") = "white";            					// 단위        
					comp_dt.attribute("background-color") = "white";         				// 기산일자    
					mtry_dt.attribute("background-color") = "white";         					// 만기일자    
					qunt.attribute("background-color") = "white";            					// 수량        
					occr_slip_clsf.attribute("background-color") = "white";  				// 전사전표구분
					occr_slip.attribute("background-color") = "white";       				// 전사전표번호
					setoff_slip_no.attribute("background-color") = "white";  				// 상계전표번호
					rmks2.attribute("background-color") = "white";           				// 적요2       
					obj_acct_cd.attribute("background-color") = "white";     				// 대상계정    
					obj_dt.attribute("background-color") = "white";          					// 대상일자    
					obj_amt.attribute("background-color") = "white";         				// 대상금액    
					note_stat.attribute("background-color") = "white";       				// 어음상태    
					frcr_clsf_cd.attribute("background-color") = "white";    				// 외화구분코드
					exrate.attribute("background-color") = "white";          					// 환율        
					frcr_amt.attribute("background-color") = "white";        					// 외화금액    
					
					// 예산별관리항목(화면 색상을 지정하기 위함)

					//입력값 설정
					set_refvalue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
					set_refvalue("/root/reqData/searchData/budg_cd", budg_cd.value);
					//실행

					if (gvar_evnt_check_flag != "N") {
						model.copyNode( "/root/resData/fc_acct_2291_s/dataSet/CUR_MANG_ITEM_CD_LIST", "/root/initData/comboSet/fc_acct_2290_m/dataSet/CUR_MANG_ITEM_CD_LIST");
					}
					else{							
						model.send("fc_acct_2291_s");
					}
					
					var_drcr_clsf = rv_drcr_clsf;	// 차대구분
					
					// 각 CONTROL 색상 지정
					for (var i = 1; i <= Number(model.getValue("/root/resData/fc_acct_2291_s/dataSet/CUR_MANG_ITEM_CD_LIST/totalcnt")); i++) {

						if (model.getValue("/root/resData/fc_acct_2291_s/dataSet/CUR_MANG_ITEM_CD_LIST/record[" + i + "]/drcr_clsf") == ""
						|| model.getValue("/root/resData/fc_acct_2291_s/dataSet/CUR_MANG_ITEM_CD_LIST/record[" + i + "]/drcr_clsf") == var_drcr_clsf ) {
						
							switch (model.getValue("/root/resData/fc_acct_2291_s/dataSet/CUR_MANG_ITEM_CD_LIST/record[" + i + "]/mang_item_cd")) {
								case "02" :	// 주거래처
									dlco_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									dlco_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "03" :  	// 매체
									medi_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "04" :  	// 부거래처명
									boks_dlco_nm.attribute("background-color") = DEFAULT_COLOR_REQ;
									//alert(model.getValue("/root/resData/fc_acct_2291_s/dataSet/CUR_MANG_ITEM_CD_LIST/record[" + i + "]/mang_item_cd"));
									break;
								case "05" :  	// 관리구분
									mang_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "06" :  	// 관리번호
									mang_no.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "12" :  	// 대상계정코드
									obj_acct_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "13" :  	// 단위
									unit.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "17" :  	// 기산일
									comp_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "18" :  	// 만기일
									mtry_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "19" :  	// 대상일자
									obj_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "20" :  	// 대상금액
									obj_amt.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "31" :  	// 수량
									qunt.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "34" :  	// 상세매체코드
									dtls_medi_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "35" : 	// 행사코드
									evnt_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "36" : 	// 영수증구분
									prop_equip_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								default :
							}
							
						}
						
					}
					
				}
				
				// 예산코드에 따른 거래처구분, 관리구분 콤보 셋팅
				function fn_dlco_mang_clsf_setting() {
	
					var var_dlco_clsf_cd = "";		// 거래처구분
					var var_dlco_cd = "";			// 거래처코드
					var var_dlco_nm = "";			// 거래처명
					var var_intg_dlco_cd = "";		// 통합거래처코드
					var var_mang_clsf_cd = "";		// 관리구분코드
	
					// 거래처구분 combo list 채움
					var_dlco_clsf_cd = dlco_clsf_cd.value;		// 거래처구분
					var_dlco_cd = dlco_cd.value;				// 거래처코드
					var_dlco_nm = dlco_nm.value;				// 거래처명
					var_intg_dlco_cd = intg_dlco_cd.value;		// 통합거래처코드
					
					// 관리구분 combo list 채움
					var_mang_clsf_cd = mang_clsf_cd.value;		// 관리구분코드
					
					//입력값 설정
					set_refvalue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
					set_refvalue("/root/reqData/searchData/budg_cd", budg_cd.value);

					//실행
					if (gvar_evnt_check_flag != "N") {
						model.copyNode( "/root/resData/fc_acct_2292_s/dataSet/CUR_DLCO_CLSF_LIST", "/root/initData/comboSet/fc_acct_2290_m/dataSet/CUR_DLCO_CLSF_LIST");
						model.copyNode( "/root/resData/fc_acct_2292_s/dataSet/CUR_BUDGMANGCD_LIST", "/root/initData/comboSet/fc_acct_2290_m/dataSet/CUR_BUDGMANGCD_LIST");
					}
					else{							
						model.send("fc_acct_2292_s");
					}					
					
					model.removeNodeset("/root/initData/comboSet/fc_acct_2290_m/dataSet/DLCO_CLSF_CD_CURLIST/record");
					model.removeNodeset("/root/initData/comboSet/fc_acct_2290_m/dataSet/MANG_CLSF_CURLIST/record");
					model.copyNode("/root/initData/comboSet/fc_acct_2290_m/dataSet/DLCO_CLSF_CD_CURLIST", "/root/resData/fc_acct_2292_s/dataSet/CUR_DLCO_CLSF_LIST");
					model.copyNode("/root/initData/comboSet/fc_acct_2290_m/dataSet/MANG_CLSF_CURLIST", "/root/resData/fc_acct_2292_s/dataSet/CUR_BUDGMANGCD_LIST");
					
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/DLCO_CLSF_CD_CURLIST", "record", "cdabrvnm_cd", "cd")
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/MANG_CLSF_CURLIST", "record", "cdabrvnm_cd", "cd")
					
					mang_clsf_cd.value = var_mang_clsf_cd;

					budg_mang_clsf_cd = get_refvalue("/root/resData/fc_acct_2292_s/dataSet/CUR_BUDGMANGCD_LIST/record/cd");

					model.refresh();
				}
				
				var btnclickchk = "";
				function onevent()
				{
					var evCtarg = event.currenttarget;
					var evTarg = event.target;
					if(evCtarg != evTarg) return;
					if(event.name != "DOMFocusOut" && event.name != "onbuttonclick" && event.name != "DOMFocusIn" &&event.name != "xforms-value-changed" && event.name != "onmousedown" && event.name != "onmouseup") return;
					
					var pID = event.pTarget.elementname;
					if (pID != "xforms:button" && pID != "xforms:input") return;
					
					var obj = document.all(evCtarg);
					
					if(obj.elementName == "xforms:input" && (evCtarg == "slip_arow_no" || evCtarg =="budg_cd"  || evCtarg == "use_dept_cd" || evCtarg == "dr_amt"
						|| evCtarg == "crdt_amt"
						|| evCtarg == "dlco_cd"
						|| evCtarg == "boks_dlco_nm"
						|| evCtarg == "mang_clsf_cd"
						|| evCtarg == "mang_no"
						|| evCtarg == "bank_cd"
						|| evCtarg == "prop_equip_cd"
						|| evCtarg == "medi_cd"
						|| evCtarg == "dtls_medi_cd"
						|| evCtarg == "evnt_cd"
						|| evCtarg == "unit"
						|| evCtarg == "comp_dt"
						|| evCtarg == "mtry_dt"
						|| evCtarg == "qunt"
						|| evCtarg == "occr_slip_clsf"
						|| evCtarg == "occr_slip"
						|| evCtarg == "setoff_slip_no"
						|| evCtarg == "rmks2"
						|| evCtarg == "obj_dt"
						|| evCtarg == "obj_amt"
						|| evCtarg == "exrate"
						|| evCtarg == "frcr_amt"))
					
					{
						model.addLog(event.name + " --> " + evCtarg);
						
						//onmousedown -> DOMFocusIn -> onmouseup -> xforms-value-changed -> DOMFocusOut 
						if(event.name == "onmousedown" )
						{
							body.attribute("inputClkChk") = "true";
						}
						if(event.name == "DOMFocusIn" )
						{
							body.attribute("inputClkChk") = "true";
						}
						if(event.name == "xforms-value-changed")
						{
							if( btnclickchk != "" )
							{
								body.attribute("value-changed-chk") = "true";
							}
						}
						if(event.name == "DOMFocusOut")
						{
							if(body.attribute("inputClkChk") == "true")
							{
								if(btnclickchk != "" && body.attribute("value-changed-chk") == "true")
								{
									document.all(btnclickchk).dispatch("onmouseup");
								}
							}
						}
					}
					
					if(obj.elementName == "xforms:button" && (evCtarg =="btn_insert" || evCtarg == "btn_update" || evCtarg == "btn_append"))
					{
						model.addLog(event.name + " --> " + evCtarg);
						
						//onmousedown -> DOMFocusIn -> onmouseup -> DOMFocusOut 
						if(event.name == "onmousedown" )
						{
							btnclickchk = evCtarg;
						}
						if(event.name == "onmouseup" )
						{
							btnclickchk = "";
						}
					}


				}
				
				function open_fc_co_8010(p_where,p_mode,p_title,p_readonly,p_to,p_job_clsf,p_cd_clsf) {
					var need_popup = true;
					var rcvs_flag = false;
					
					//검색조건이 모두 충족하지 않으면 종료한다.
					if (p_where == "FOCUS" && medi_cd.value.Trim() == "") {
						pch_mcnm.value	= "";
						return rcvs_flag;
					}
					
					p_where = p_where.toUpperCase();
					
					var popid = "fc_co_8010";
					var subid = "fc_co_8010_l";
	
					set_popup_send_data(popid		,"mode"			,p_mode			);
					set_popup_send_data(popid		,"title"			,p_title			);
					set_popup_send_data(popid		,"readonly"		,p_readonly		);
					set_popup_send_data(popid		,"job_clsf"			,p_job_clsf		);
					set_popup_send_data(popid		,"cd_clsf"			,p_cd_clsf			);
					set_popup_send_data(popid		,"cd"				,medi_cd.value		);
					set_popup_send_data(popid		,"cd_abrv_nm"		,""				);
					
					model.removenode(get_popup_rcvs_ref(popid));
					model.makeNode(get_popup_rcvs_ref(popid));
					
					//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
					if (p_where == "FOCUS") {
						
						//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
						send_submission(
								"auto_" + subid
							,	get_popup_send_ref(popid)
							,	get_popup_rcvs_ref(subid) + "/dataSet"
							,	"/fc/co8000/8011"
							,	"urlencoded-post"
							,	"application/x-www-form-urlencoded"
						);
						
						totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
				
						if (totalcnt == 1) {
							//데이터가 1건이고 focus out에서 호출한 경우
							//데이터를 설정하고 나간다.
	
	//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
	//						return;
							need_popup = false;
							rcvs_flag = true;
						}
						else if (totalcnt == 0) {
	//						return;
							need_popup = false;	
							rcvs_flag = false;					
						}
						else {
							//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
							//만약 1건 이상인 경우 popup을 호출해 달라고 하면
							//return을 지우면 됨
							//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
							//return;
							need_popup = true;
						}
					}
					
					//그외 버튼인 경우는 계속 진행
					if (need_popup) {
						rcvs_flag = open_popup(popid,"640");
					}
	
					set_refvalue("/root/tempData/medi_ch", get_popup_rcvs_data(popid,"mang_cd_2"));
					
					reset_popup_send_data(popid);
					
					return rcvs_flag;
				}
				
			function fun_budg_cd_ch(){
				var ch_var = budg_cd.value;
				
				if(ch_var == "182000" || ch_var == "462000"){
					prof_type_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
					occr_slip_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
					occr_slip_occr_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
					occr_slip_seq.attribute("background-color") = DEFAULT_COLOR_REQ;
					erplace_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
					make_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
					ern.attribute("background-color") = DEFAULT_COLOR_REQ;
					suply_amt.attribute("background-color") = DEFAULT_COLOR_REQ;
					group2.disabled = false;
				}else{
					prof_type_cd.value = "";
					occr_slip_clsf_cd.value = "";
					occr_slip_occr_dt.value = "";
					occr_slip_seq.value = "";
					erplace_cd.value = "";
					make_dt.value = "";
					etc_in.value = "";
					ern.value = "";
					suply_amt.value = "";
					prof_type_cd.attribute("background-color") = "white";
					occr_slip_clsf_cd.attribute("background-color") = "white";
					occr_slip_occr_dt.attribute("background-color") = "white";
					occr_slip_seq.attribute("background-color") = "white";
					erplace_cd.attribute("background-color") = "white";
					make_dt.attribute("background-color") = "white";
					ern.attribute("background-color") = "white";
					suply_amt.attribute("background-color") = "white";
					group2.disabled = true;
				}
			}
			
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" scroll="autohscroll" pagewidth="550" pageheight="650" guideline="1,10;2,10;1,873;1,878;1,933;1,936;2,30;2,39;2,41;2,51;" style="font-family:굴림; ">
		<group id="group1" class="gro_sel" style="left:10px; top:135px; width:529px; height:351px; ">
			<caption id="caption14" class="list_cap03" style="left:0px; top:0px; width:90px; height:26px; text-align:center; ">거래처구분</caption>
			<caption id="caption15" class="list_cap02" style="left:89px; top:0px; width:440px; height:26px; text-align:center; "/>
			<caption id="caption16" class="list_cap03" style="left:0px; top:25px; width:90px; height:26px; text-align:center; ">부거래처명</caption>
			<caption id="caption17" class="list_cap02" style="left:89px; top:25px; width:440px; height:26px; text-align:center; "/>
			<caption id="caption22" class="list_cap03" style="left:299px; top:50px; width:90px; height:26px; text-align:center; ">관리번호</caption>
			<caption id="caption23" class="list_cap02" style="left:388px; top:50px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption24" class="list_cap03" style="left:0px; top:50px; width:90px; height:26px; text-align:center; ">관리구분</caption>
			<caption id="caption25" class="list_cap02" style="left:89px; top:50px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption26" class="list_cap03" style="left:299px; top:100px; width:90px; height:26px; text-align:center; ">상세매체</caption>
			<caption id="caption27" class="list_cap02" style="left:388px; top:100px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption30" class="list_cap03" style="left:0px; top:125px; width:90px; height:26px; text-align:center; ">행사코드</caption>
			<caption id="caption31" class="list_cap03" style="left:0px; top:75px; width:90px; height:26px; text-align:center; ">은행코드</caption>
			<caption id="caption32" class="list_cap02" style="left:89px; top:125px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption33" class="list_cap02" style="left:89px; top:75px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption34" class="list_cap03" style="left:0px; top:100px; width:90px; height:26px; text-align:center; ">매체코드</caption>
			<caption id="caption35" class="list_cap02" style="left:89px; top:100px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption36" class="list_cap03" style="left:299px; top:75px; width:90px; height:26px; text-align:center; ">영수증구분</caption>
			<caption id="caption37" class="list_cap02" style="left:388px; top:75px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption38" class="list_cap03" style="left:0px; top:300px; width:90px; height:26px; text-align:center; ">대상금액</caption>
			<caption id="caption40" class="list_cap03" style="left:0px; top:225px; width:90px; height:26px; text-align:center; ">적요1</caption>
			<caption id="caption42" class="list_cap02" style="left:89px; top:300px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption44" class="list_cap02" style="left:89px; top:225px; width:440px; height:26px; text-align:center; "/>
			<caption id="caption51" class="list_cap03" style="left:0px; top:150px; width:90px; height:26px; text-align:center; ">기산/만기일</caption>
			<caption id="caption54" class="list_cap02" style="left:89px; top:150px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption56" class="list_cap03" style="left:0px; top:175px; width:90px; height:26px; text-align:center; ">전사전표번호</caption>
			<caption id="caption57" class="list_cap03" style="left:299px; top:300px; width:90px; height:26px; text-align:center; ">어음상태</caption>
			<caption id="caption58" class="list_cap02" style="left:89px; top:175px; width:440px; height:26px; text-align:center; "/>
			<caption id="caption59" class="list_cap02" style="left:388px; top:300px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption60" class="list_cap03" style="left:299px; top:150px; width:90px; height:26px; text-align:center; ">수량</caption>
			<caption id="caption61" class="list_cap02" style="left:388px; top:150px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption62" class="list_cap03" style="left:299px; top:325px; width:90px; height:26px; text-align:center; ">외화금액</caption>
			<caption id="caption63" class="list_cap02" style="left:388px; top:325px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption65" class="list_cap03" style="left:0px; top:325px; width:90px; height:26px; text-align:center; ">외화구분코드</caption>
			<caption id="caption71" class="list_cap02" style="left:89px; top:325px; width:211px; height:26px; text-align:center; "/>
			<select1 id="dlco_clsf_cd" ref="/root/resData/resform/dlco_clsf_cd" navindex="5" appearance="minimal" editmode="inputsearch" style="left:95px; top:4px; width:90; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2290_m/dataSet/DLCO_CLSF_CD_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(dlco_clsf_cd, dlco_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(dlco_clsf_cd,"");
							return;
						}
						//dlco_cd.value = "";		// 거래처코드
						//dlco_nm.value = "";		// 거래처명
						//intg_dlco_cd.value = "";	// 공통거래처코드  20170112 봉은정 주석처리함
					]]>
				</script>
			</select1>
			<input id="dlco_cd" ref="/root/resData/resform/dlco_cd" navindex="6" inputtype="button" style="left:188; top:4px; width:100; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					gstr_popupid = "";
					
					if (open_fc_acct_1180("button","s","","0")) {
						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					}
					else {
						//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					gstr_popupid = "";
					
					if (open_fc_acct_1180("focus","s","","0")) {
						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					}
					else {
						//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
			</input>
			<input id="mang_no" ref="/root/resData/resform/mang_no" navindex="8" inputtype="input" style="left:393px; top:54px; width:130; height:18px; "/>
			<input id="prop_equip_cd" ref="/root/resData/resform/prop_equip_cd" navindex="11" inputtype="button" maxlength="4" style="left:393px; top:79px; width:65; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
								
						var cd   =  "";
						var cdnm =  "";
							
						var resultRef1 = "/root/resData/resform/prop_equip_cd";
						var resultRef2 = "/root/resData/resform/prop_equip_cd_nm";
						
						showCommonCodePopup1("00", "12", cd, cdnm, "N", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(prop_equip_cd.value.length == 4 ){
							model.removeNodeset("/root/reqData/fwdData");  
							model.removeNodeset("/root/tempData/dataSet");  
							model.makeNode("/root/reqData/fwdData/job_clsf");
							model.makeNode("/root/reqData/fwdData/cd_clsf");
							model.makeNode("/root/reqData/fwdData/cd");
							model.setValue("/root/reqData/fwdData/job_clsf", "00");
							model.setValue("/root/reqData/fwdData/cd_clsf", "12");
							model.setValue("/root/reqData/fwdData/cd", prop_equip_cd.value);

							model.send("fc_co_8000_s");
							
							if (Number(model.getValue("/root/tempData/dataSet/CURLIST1/totalcnt")) != 1) {
								prop_equip_cd.value = "";
							}
						}
						else { prop_equip_cd.value = ""; }
					]]>
				</script>
			</input>
			<input id="boks_dlco_nm" ref="/root/resData/resform/boks_dlco_nm" navindex="7" inputtype="input" style="left:95px; top:29px; width:200; height:18px; "/>
			<input id="comp_dt" ref="/root/resData/resform/comp_dt" navindex="16" inputtype="date" style="left:95px; top:154px; width:90; height:18px; "/>
			<input id="mtry_dt" ref="/root/resData/resform/mtry_dt" navindex="17" inputtype="date" appearance="input" style="left:205px; top:154px; width:90px; height:18px; "/>
			<input id="qunt" ref="/root/resData/resform/qunt" navindex="18" style="left:393px; top:154px; width:65; height:18px; "/>
			<input id="occr_slip" ref="/root/resData/resform/occr_slip" navindex="20" inputtype="button" style="left:188px; top:179px; width:200px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					
						if (occr_slip.attribute("editable") == "false" && occr_slip.attribute("background-color") == DEFAULT_COLOR_DISABLE) { return; }
					
						model.property("FC_ACCT_2500_popup_clsf")  = "Y";
						model.property("FC_ACCT_2500_srch_occr_slip_clsf")  = occr_slip_clsf.value;
					
						viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2500");
						
						occr_slip_clsf.value = model.property("FC_ACCT_2500_srch_occr_slip_clsf");
						occr_slip.value = model.property("FC_ACCT_2500_occr_slip");
						
						model.property("FC_ACCT_2500_occr_slip") = "";
						model.property("FC_ACCT_2500_srch_occr_slip_clsf") = "";
					]]>
				</script>
			</input>
			<caption id="caption19" class="list_cap03" style="left:0px; top:200px; width:90px; height:26px; text-align:center; ">상계전표번호</caption>
			<caption id="caption28" class="list_cap02" style="left:89px; top:200px; width:440px; height:26px; text-align:center; "/>
			<input id="input29" inputtype="date" style="left:95px; top:253px; width:100px; height:18px; "/>
			<caption id="caption43" class="list_cap03" style="left:0px; top:250px; width:90px; height:26px; text-align:center; ">적요2</caption>
			<caption id="caption48" class="list_cap03" style="left:299px; top:275px; width:90px; height:26px; text-align:center; ">대상일자</caption>
			<caption id="caption49" class="list_cap02" style="left:89px; top:250px; width:440px; height:26px; text-align:center; "/>
			<caption id="caption50" class="list_cap02" style="left:388px; top:275px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption53" class="list_cap02" style="left:89px; top:275px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption55" class="list_cap03" style="left:0px; top:275px; width:90px; height:26px; text-align:center; ">대상계정</caption>
			<input id="rmks2" ref="/root/resData/resform/rmks2" navindex="22" style="left:95px; top:254px; width:428; height:18px; "/>
			<input id="obj_acct_cd" ref="/root/resData/resform/obj_acct_cd" navindex="23" inputtype="button" maxlength="6" style="left:95px; top:279px; width:65; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					
						gstr_popupid = "obj_acct_cd";
					
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cmpy_cd");
						model.makeNode("/root/reqData/fwdData/G_Tag");
						model.makeNode("/root/reqData/fwdData/G_Caption");
						model.makeNode("/root/reqData/fwdData/G_Codenu");
						model.makeNode("/root/reqData/fwdData/G_BRCode");
						model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
						model.setValue("/root/reqData/fwdData/G_Tag", "1");
						model.setValue("/root/reqData/fwdData/G_Caption", "예산코드조회");
						model.setValue("/root/reqData/fwdData/G_Codenu", "");	
						model.setValue("/root/reqData/fwdData/G_BRCode", "");
						window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");		
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					
						// 팝업 시작
						if (obj_acct_cd.value.Trim().length == 6) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.removeNodeset("/root/tempData/dataSet");  
							model.makeNode("/root/reqData/fwdData/cmpy_cd");
							model.makeNode("/root/reqData/fwdData/cd");
							model.makeNode("/root/reqData/fwdData/cdnm");
							model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
							model.setValue("/root/reqData/fwdData/cd", obj_acct_cd.value);
							model.setValue("/root/reqData/fwdData/cdnm", "");
							model.send("mc_co_1001_l");
		
							if (Number(model.getValue("/root/tempData/dataSet/CURLIST/totalcnt")) == 1
							&& obj_acct_cd.value == model.getValue("/root/tempData/dataSet/CURLIST/record/cd")) {
								pch_dsacctnm.value = model.getValue("/root/tempData/dataSet/CURLIST/record/cdnm");
							}
							else {
								obj_acct_cd.value = "";
								pch_dsacctnm.value = "";
							}
						}
						else {
							obj_acct_cd.value = "";
							pch_dsacctnm.value = "";
						}
						
						// 팝업 끝
					]]>
				</script>
			</input>
			<input id="obj_dt" ref="/root/resData/resform/obj_dt" navindex="24" inputtype="date" style="left:393px; top:279px; width:90px; height:18px; "/>
			<input id="frcr_amt" ref="/root/resData/resform/frcr_amt" navindex="28" style="left:393px; top:329px; width:130px; height:18px; "/>
			<caption id="caption3" class="list_cap03" style="left:299px; top:125px; width:90px; height:26px; text-align:center; ">단위</caption>
			<caption id="caption20" class="list_cap02" style="left:388px; top:125px; width:141px; height:26px; text-align:center; "/>
			<input id="bank_cd" ref="/root/resData/resform/bank_cd" navindex="9" inputtype="button" maxlength="6" style="left:95px; top:79px; width:65; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
								
						var cd   =  "";
						var cdnm =  "";
							
						var resultRef1 = "/root/resData/resform/bank_cd";
						var resultRef2 = "/root/resData/resform/pch_banknm";
						
						showCommonCodePopup1("02", "71", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(bank_cd.value.length == 6 ){
							model.removeNodeset("/root/reqData/fwdData");  
							model.removeNodeset("/root/tempData/dataSet");  
							model.makeNode("/root/reqData/fwdData/job_clsf");
							model.makeNode("/root/reqData/fwdData/cd_clsf");
							model.makeNode("/root/reqData/fwdData/cd");
							model.setValue("/root/reqData/fwdData/job_clsf", "02");
							model.setValue("/root/reqData/fwdData/cd_clsf", "71");
							model.setValue("/root/reqData/fwdData/cd", bank_cd.value);

							model.send("fc_co_8000_s");
							
							if (Number(model.getValue("/root/tempData/dataSet/CURLIST1/totalcnt")) == 1
							&& bank_cd.value == model.getValue("/root/tempData/dataSet/CURLIST1/record/cd")) {
								pch_banknm.value = model.getValue("/root/tempData/dataSet/CURLIST1/record/cd_abrv_nm");
							}
							else {
								bank_cd.value = "";
								pch_banknm.value = "";
							}
						}
						else {
							bank_cd.value = "";
							pch_banknm.value = "";
						}
					]]>
				</script>
			</input>
			<input id="unit" ref="/root/resData/resform/unit" navindex="15" maxlength="10" style="left:393px; top:129px; width:65; height:18px; "/>
			<select1 id="medi_cd" ref="/root/resData/resform/medi_cd" navindex="12" appearance="minimal" editmode="inputsearch" style="left:95px; top:104px; width:200px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2290_m/dataSet/MEDI_CD_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if (open_fc_co_8010("focus","s","매체코드조회","1","","00","01")) {
						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					}
					else {
						//팝업에서 취소 버튼을 누른 경우
					}
					dtls_medi_cd.value = "";
					if (get_refvalue("/root/tempData/medi_ch") == "Y") {
						dtls_medi_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
					}
					else {
						dtls_medi_cd.attribute("background-color") = "white";
					}
					]]>
				</script>
			</select1>
			<input id="evnt_cd" ref="/root/resData/resform/evnt_cd" navindex="14" inputtype="button" style="left:95px; top:129px; width:90; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					
						gstr_popupid = "evnt_cd";
					
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cmpy_cd");
						model.makeNode("/root/reqData/fwdData/G_Tag");
						model.makeNode("/root/reqData/fwdData/G_Caption");
						model.makeNode("/root/reqData/fwdData/G_Codenu");
						model.makeNode("/root/reqData/fwdData/G_BRCode");
						model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
						model.setValue("/root/reqData/fwdData/G_Tag", "16");
						model.setValue("/root/reqData/fwdData/G_Caption", "행사코드조회");
						model.setValue("/root/reqData/fwdData/G_Codenu", "");	
						model.setValue("/root/reqData/fwdData/G_BRCode", "");
						window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (evnt_cd.value.Trim().length == 6 || evnt_cd.value.Trim().length == 10) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.removeNodeset("/root/tempData/dataSet");  
							model.makeNode("/root/reqData/fwdData/cmpy_cd");
							model.makeNode("/root/reqData/fwdData/cd");
							model.makeNode("/root/reqData/fwdData/cdnm");
							model.makeNode("/root/reqData/fwdData/from_cd");
							model.makeNode("/root/reqData/fwdData/to_cd");
							model.makeNode("/root/reqData/fwdData/bgn_dt");
							model.makeNode("/root/reqData/fwdData/last_dt");
							model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
							model.setValue("/root/reqData/fwdData/cd", evnt_cd.value);
							model.setValue("/root/reqData/fwdData/cdnm", "");
							model.setValue("/root/reqData/fwdData/from_cd", "00" + "0000");
							model.setValue("/root/reqData/fwdData/to_cd", "00" + "9999");
							model.setValue("/root/reqData/fwdData/bgn_dt", "00000000");
							model.setValue("/root/reqData/fwdData/last_dt", "99999999");
							model.send("mc_co_1006_l");
							
							if (Number(model.getValue("/root/tempData/dataSet/CURLIST/totalcnt")) == 1
							&& evnt_cd.value == model.getValue("/root/tempData/dataSet/CURLIST/record/cd")) {
								pch_hsnm.value = model.getValue("/root/tempData/dataSet/CURLIST/record/cdnm");
							}
							else {
								evnt_cd.value = "";
								pch_hsnm.value = "";
							}
						}
						else {
							evnt_cd.value = "";
							pch_hsnm.value = "";
						}
					]]>
				</script>
			</input>
			<select1 id="occr_slip_clsf" ref="/root/resData/resform/occr_slip_clsf" navindex="19" appearance="minimal" editmode="inputsearch" style="left:95px; top:179px; width:90px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2290_m/dataSet/SLIP_CLSF_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(occr_slip_clsf, occr_slip_clsf.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(occr_slip_clsf,"");
							return;
						}
					]]>
				</script>
			</select1>
			<input id="setoff_slip_no" ref="/root/resData/resform/setoff_slip_no" navindex="21" editable="true" inputtype="button" maxlength="24" style="left:95px; top:204px; width:200px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						if (setoff_slip_no.attribute("editable") == "false" && setoff_slip_no.attribute("background-color") == DEFAULT_COLOR_DISABLE) { return; }
						
						//model.property("FC_ACCT_2040_srchdept_cd")  = parentWindow.clam_dept_cd.value;
						//model.property("FC_ACCT_2040_srchdept_nm") = parentWindow.pch_cgbuseonm.value;
						model.property("FC_ACCT_2040_srchdept_cd")  = use_dept_cd.value;
						model.property("FC_ACCT_2040_srchdept_nm") = pch_buseonm.value;
						model.property("FC_ACCT_2040_srchoccr_acct_cd") = budg_cd.value.substring(0, 4);
	
						viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2040");
	
						setoff_slip_no.value = model.property("FC_ACCT_2040_slip_no");
						
						model.property("FC_ACCT_2040_slip_no") = "";		
					]]>
				</script>
			</input>
			<select1 id="note_stat" ref="/root/resData/resform/note_stat" navindex="26" appearance="minimal" editmode="inputsearch" style="left:393px; top:304px; width:130px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2290_m/dataSet/NOTE_STAT_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(note_stat, note_stat.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(note_stat,"");
							return;
						}
					]]>
				</script>
			</select1>
			<select1 id="frcr_clsf_cd" ref="/root/resData/resform/frcr_clsf_cd" navindex="27" appearance="minimal" editmode="inputsearch" style="left:95px; top:329px; width:65; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2290_m/dataSet/FRCR_CLSF_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(frcr_clsf_cd, frcr_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(frcr_clsf_cd,"");
							return;
						}
					]]>
				</script>
			</select1>
			<input id="exrate" ref="/root/resData/resform/exrate" navindex="27" style="left:230px; top:329px; width:65px; height:18px; "/>
			<input id="pch_banknm" ref="/root/resData/resform/pch_banknm" editable="false" inputtype="input" style="left:163; top:79px; width:132; height:18px; "/>
			<input id="intg_dlco_cd" ref="/root/resData/resform/intg_dlco_cd" editable="false" inputtype="input" style="left:458; top:4px; width:65; height:18px; "/>
			<input id="dlco_nm" ref="/root/resData/resform/dlco_nm" editable="false" inputtype="input" style="left:291; top:4px; width:163; height:18px; "/>
			<input id="pch_dsacctnm" ref="/root/resData/resform/pch_dsacctnm" editable="false" inputtype="input" style="left:163px; top:279px; width:132px; height:18px; "/>
			<input id="pch_hsnm" ref="/root/resData/resform/pch_hsnm" editable="false" inputtype="input" style="left:188px; top:129px; width:107px; height:18px; "/>
			<input id="rmks1" ref="/root/resData/resform/rmks1" editable="false" style="left:95px; top:229px; width:428; height:18px; "/>
			<input id="dtls_medi_cd" ref="/root/resData/resform/dtls_medi_cd" navindex="13" inputtype="button" maxlength="10" style="left:393px; top:104px; width:90; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						if(getProperty("ss_cmpycd") == "100"){
							
							if (medi_cd.value == "110") {
					
								var cd   =  "";
								var cdnm =  "";
															
								var resultRef1 = "/root/resData/resform/dtls_medi_cd";
								var resultRef2 = "/root/resData/resform/dtls_medi_cd_nm";							
	
								showCommonCodePopup1("03", "30", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
		
								model.refresh();
							} else if (medi_cd.value == "610") {
						
								var cd   =  "";
								var cdnm =  "";
															
								var resultRef1 = "/root/resData/resform/dtls_medi_cd";
								var resultRef2 = "/root/resData/resform/dtls_medi_cd_nm";							
	
								showCommonCodePopup1("06", "077", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
		
								model.refresh();
							}
							else if (medi_cd.value != "") {
								
								model.removeNodeset("/root/reqData/fwdData");  
								
								model.makeNode("/root/reqData/fwdData/cmpy_cd");
								model.makeNode("/root/reqData/fwdData/G_Tag");
								model.makeNode("/root/reqData/fwdData/G_Caption");
								model.makeNode("/root/reqData/fwdData/G_Codenu");
								model.makeNode("/root/reqData/fwdData/G_BRCode");
								
								model.setValue("/root/reqData/fwdData/cmpy_cd", model.getValue("/root/initData/session/cmpy_cd"));
								model.setValue("/root/reqData/fwdData/G_Tag", "3");
								model.setValue("/root/reqData/fwdData/G_Caption", "상세매체코드조회");
								model.setValue("/root/reqData/fwdData/G_Codenu", medi_cd.value.substring(0, 3));					
								model.setValue("/root/reqData/fwdData/G_BRCode", "");
		
								gstr_popupid = "dtls_medi_cd";
								window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData")
							}
							
						}else if(getProperty("ss_cmpycd") == "500"){							
							/*2012.01.20*/
							//model.setValue("/root/reqData/fwdData/job_clsf", "00"); //필수항목
							//model.setValue("/root/reqData/fwdData/cd_clsf", "01"); //필수항목
							model.makeNode("/root/reqData/fwdData/cd");
							model.setValue("/root/reqData/fwdData/cd",  medi_cd.value);
							//model.setValue("/root/reqData/fwdData/cdnm", medi_cd_nm.value);

							//model.setValue("/root/reqData/fwdData/resultRef1", "/root/resData/resform/dtls_medi_cd");
							//model.setValue("/root/reqData/fwdData/resultRef2", "/root/resData/resform/dtls_medi_cd_nm");	
							
							if(instance1.selectSingleNode("/root/reqData/fwdData/resultRef1") == null){
								model.makeNode("/root/reqData/fwdData/resultRef1");
							}
							model.setValue("/root/reqData/fwdData/resultRef1", "/root/resData/resform/dtls_medi_cd");									
									
							window.load(
								 "/xrw/co/cocd/CO_COCD_1400.xrw"
								,"modal"
								,""
								,"caption:hidden;align:center;width:455px; height:425px;"
								,"/root/reqData/fwdData"
								,"/root/reqData/searchData"
							);		
							
						}else if(getProperty("ss_cmpycd") == "207"){							
							
							gstr_popupid = "dtls_medi_cd";
							open_fc_acct_1180("button","s");	
							
						}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if (medi_cd.value != "") {
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cd");
						model.makeNode("/root/reqData/fwdData/medi_cd");
						model.setValue("/root/reqData/fwdData/cd", dtls_medi_cd.value);
						model.setValue("/root/reqData/fwdData/medi_cd",medi_cd.value);
						model.send("fc_acct_2015_l");

						if (model.getValue("/root/tempData/fc_acct_2015_l/dataSet/CURLIST/record/cd") != "") {
							
						}
						else {
							dtls_medi_cd.value = "";
						}
					}else{
						dtls_medi_cd.value = "";
					}

					]]>
				</script>
			</input>
			<caption id="caption8" style="left:190px; top:155px; width:15px; height:20px; ">~</caption>
			<input id="obj_amt" ref="/root/resData/resform/obj_amt" navindex="25" inputtype="input" style="left:95px; top:304px; width:200px; height:18px; "/>
			<caption id="caption9" class="list_cap03" style="left:164px; top:325px; width:61px; height:26px; text-align:center; ">환율</caption>
			<input id="mang_clsf_cd" ref="/root/resData/resform/mang_clsf_cd" navindex="10" inputtype="button" maxlength="6" style="left:95px; top:54px; width:65px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
								
						var cd   =  "";
						var cdnm =  "";
							
						var resultRef1 = "/root/resData/resform/mang_clsf_cd";
						var resultRef2 = "/root/resData/resform/mang_clsf_nm";
						
						showCommonCodePopup1("02", "68", cd, cdnm, "Y", resultRef1, resultRef2, "", "", budg_mang_clsf_cd, "", "", "", "", "", "", "", "", "");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
//						if(mang_clsf_cd.value.length == 6 ){
							model.removeNodeset("/root/reqData/fwdData");  
							model.removeNodeset("/root/tempData/dataSet");  
							model.makeNode("/root/reqData/fwdData/job_clsf");
							model.makeNode("/root/reqData/fwdData/cd_clsf");
							model.makeNode("/root/reqData/fwdData/cd");
							model.makeNode("/root/reqData/fwdData/mang_cd_3");							
							model.setValue("/root/reqData/fwdData/job_clsf", "02");
							model.setValue("/root/reqData/fwdData/cd_clsf", "68");
							model.setValue("/root/reqData/fwdData/cd", mang_clsf_cd.value);
							model.setValue("/root/reqData/fwdData/mang_cd_3", budg_mang_clsf_cd);

							model.send("fc_co_8080_s");
							
							if (Number(model.getValue("/root/tempData/dataSet/CURLIST1/totalcnt")) == 1
							&& mang_clsf_cd.value == model.getValue("/root/tempData/dataSet/CURLIST1/record/cd")) {
								mang_clsf_nm.value = model.getValue("/root/tempData/dataSet/CURLIST1/record/cd_abrv_nm");
							}
							else {
								mang_clsf_cd.value = "";
								mang_clsf_nm.value = "";
							}
//						}
//						else {
//							mang_clsf_cd.value = "";
//							mang_clsf_nm.value = "";
//						}
					]]>
				</script>
			</input>
			<input id="mang_clsf_nm" ref="/root/resData/resform/mang_clsf_nm" editable="false" inputtype="input" style="left:163px; top:54px; width:132px; height:18px; "/>
		</group>
		<group id="group_scr" class="gro_sel" style="left:10px; top:45px; width:529px; height:76px; ">
			<caption id="caption29" class="list_cap02" style="left:89px; top:0px; width:440px; height:26px; text-align:center; "/>
			<caption id="caption13" class="list_cap02" style="left:89px; top:50px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption2" class="list_cap03" style="left:0px; top:0px; width:90px; height:26px; text-align:center; ">행번호</caption>
			<caption id="caption4" class="list_cap03" style="left:0px; top:25px; width:90px; height:26px; text-align:center; ">예산코드</caption>
			<caption id="caption5" class="list_cap02" style="left:89px; top:25px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption10" class="list_cap03" style="left:299px; top:25px; width:90px; height:26px; text-align:center; ">차변금액</caption>
			<caption id="caption11" class="list_cap02" style="left:388px; top:25px; width:141px; height:26px; text-align:center; "/>
			<input id="dr_amt" ref="/root/resData/resform/dr_amt" class="req" navindex="3" inputtype="input" style="left:393px; top:29px; width:130px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						// 외상매입,미지급금 정리시 상계전표번호는 필수
						//if (budg_cd.value.substring(0, 4) == "4001" || budg_cd.value.substring(0, 4) == "4045" ||  budg_cd.value.substring(0, 4) == "1606") {
						if (budg_cd.value.substring(0, 4) == "4001" || budg_cd.value.substring(0, 4) == "4045" ) {  //20160926 봉은정 수정
							setoff_slip_no.attribute("background-color") = DEFAULT_COLOR_REQ;
							setoff_slip_no.attribute("editable") == "true";
						}else{
							setoff_slip_no.attribute("background-color") = "white";
							setoff_slip_no.attribute("editable") == "false";							
						}
						//setoff_slip_no.refresh;
						//alert(setoff_slip_no.attribute("editable"));
					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
						if (dr_amt.value.Trim().length == 0) {
							dr_amt.value = "0";
						}
					
						if (dr_amt.value.Trim() != "0") {
							if (budg_cd.value == "463100"
							|| budg_cd.value == "456100"
							|| budg_cd.value == "466500"
							|| budg_cd.value == "466700"
							|| budg_cd.value == "466800") {
								occr_slip_clsf.attribute("background-color") = DEFAULT_COLOR_REQ;
								occr_slip.attribute("background-color") = DEFAULT_COLOR_REQ;
							}	
						}	
					]]>
				</script>
			</input>
			<caption id="caption6" class="list_cap03" style="left:299px; top:50px; width:90px; height:26px; text-align:center; ">대변금액</caption>
			<caption id="caption7" class="list_cap02" style="left:388px; top:50px; width:141px; height:26px; text-align:center; "/>
			<caption id="use_dept_label" class="list_cap03" style="left:0px; top:50px; width:90px; height:26px; text-align:center; ">사용부서</caption>
			<input id="crdt_amt" ref="/root/resData/resform/crdt_amt" class="req" navindex="4" inputtype="input" style="left:393px; top:54px; width:130px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (Number(crdt_amt.value.Trim()) == 0) { return; }

						// 예산별관리항목별로 필수색 셋팅
						fn_background_color_setting("9");
						
						// 선급금 정리시 선급지출번호는 필수(선급금계정의)
						if (budg_cd.value.substring(0, 4) == "1606" || budg_cd.value.substring(0, 4) == "1608") {
							setoff_slip_no.attribute("background-color") = DEFAULT_COLOR_REQ;
						}
						else {
							setoff_slip_no.attribute("background-color") = "white";
						}
						
						// 예산코드에 따른 거래처구분, 관리구분 콤보 셋팅
						fn_dlco_mang_clsf_setting();
						
						model.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
						if (crdt_amt.value.Trim().length == 0) {
							crdt_amt.value = "0";
						}
					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[
					
					]]>
				</script>
			</input>
			<button id="slip_arow_no_up" class="btn_up" style="left:163px; top:1px; width:20px; height:12px; ">
				<caption/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (childBody.datagrid1.row <= 1) { return; }
						
						childBody.datagrid1.row = childBody.datagrid1.row - 1;
						childBody.datagrid1.col = 1;
						
						fn_GridToForm(childBody.datagrid1.row);
						mang_clsf_cd.dispatch("xforms-value-changed");
						// 예산별관리항목별로 필수색 셋팅
						fn_background_color_setting("9");
					]]>
				</script>
			</button>
			<button id="slip_arow_no_down" class="btn_down" appearance="button" style="left:163px; top:14px; width:20px; height:10px; ">
				<caption/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//debugger;
						if (childBody.datagrid1.row >= childBody.datagrid1.rows) { return; }
					
						childBody.datagrid1.row = childBody.datagrid1.row + 1;
						childBody.datagrid1.col = 1;
						
						fn_GridToForm(childBody.datagrid1.row);
						
						mang_clsf_cd.dispatch("xforms-value-changed");
						
						// 예산별관리항목별로 필수색 셋팅
						fn_background_color_setting("9");
					]]>
				</script>
			</button>
			<input id="slip_arow_no" ref="/root/resData/resform/slip_arow_no" class="req" navindex="0" style="left:95px; top:4px; width:65px; height:18px; "/>
			<input id="budg_cd" ref="/root/resData/resform/budg_cd" class="req" navindex="1" inputtype="button" maxlength="6" style="left:95px; top:29px; width:65px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					
						gstr_popupid = "budg_cd";
					
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cmpy_cd");
						model.makeNode("/root/reqData/fwdData/G_Tag");
						model.makeNode("/root/reqData/fwdData/G_Caption");
						model.makeNode("/root/reqData/fwdData/G_Codenu");
						model.makeNode("/root/reqData/fwdData/G_BRCode");
						model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
						model.setValue("/root/reqData/fwdData/G_Tag", "1");
						model.setValue("/root/reqData/fwdData/G_Caption", "예산코드조회");
						model.setValue("/root/reqData/fwdData/G_Codenu", "");	
						model.setValue("/root/reqData/fwdData/G_BRCode", "");
						window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");		

						//입력값 설정
						set_refvalue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
						set_refvalue("/root/reqData/searchData/budg_cd", budg_cd.value);
						//실행
						model.send("fc_acct_2293_s");
						
						// 전사공통비여부가 "1" 이면 사용부서 "999999"
						use_dept_cd.attribute("editable") = "true";
						use_dept_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						if (model.getValue("/root/resData/fc_acct_2293_s/dataSet/CUR_WHCO_NDSTB_CD_LIST/record[1]/whco_comn_cost_yn") == "Y") {
							use_dept_cd.attribute("editable") = "false";
							use_dept_cd.attribute("background-color") = DEFAULT_COLOR_DISABLE;
							use_dept_cd.value = "999999";
							pch_buseonm.value = "공통부서";
						}


						// 예산별관리항목별로 필수색 셋팅
						fn_background_color_setting("1");

						// 예산코드에 따른 거래처구분, 관리구분 콤보 셋팅
						fn_dlco_mang_clsf_setting();

						fun_budg_cd_ch();
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					
						// 팝업 시작
						if (gvar_evnt_check_flag == "N") {
							if (budg_cd.value.Trim().length == 6) {
								model.removeNodeset("/root/reqData/fwdData");  
								model.removeNodeset("/root/tempData/dataSet");  
								model.makeNode("/root/reqData/fwdData/cmpy_cd");
								model.makeNode("/root/reqData/fwdData/cd");
								model.makeNode("/root/reqData/fwdData/cdnm");
								model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
								model.setValue("/root/reqData/fwdData/cd", budg_cd.value);
								model.setValue("/root/reqData/fwdData/cdnm", "");
								model.send("mc_co_1001_l");
			
								if (Number(model.getValue("/root/tempData/dataSet/CURLIST/totalcnt")) == 1
								&& budg_cd.value == model.getValue("/root/tempData/dataSet/CURLIST/record/cd")) {
									pch_sdysnm.value = model.getValue("/root/tempData/dataSet/CURLIST/record/cdnm");
								}
								else {
									budg_cd.value = "";
									pch_sdysnm.value = "";
								}
							}
							else {
								budg_cd.value = "";
								pch_sdysnm.value = "";
							}
						}
						
						// 팝업 끝

						if (budg_cd.value.Trim() != "" && budg_cd.value.Trim().length < 6) { return; }
						
						//입력값 설정
						set_refvalue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
						set_refvalue("/root/reqData/searchData/budg_cd", budg_cd.value);
						//실행
						
						if (gvar_evnt_check_flag != "N") {
							model.copyNode( "/root/resData/fc_acct_2293_s/dataSet/CUR_WHCO_NDSTB_CD_LIST", "/root/initData/comboSet/fc_acct_2290_m/dataSet/CUR_WHCO_NDSTB_CD_LIST");
						}
						else{							
							model.send("fc_acct_2293_s");
						}
						
						// 전사공통비여부가 "1" 이면 사용부서 "999999"
						use_dept_cd.attribute("editable") = "true";
						use_dept_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						if (model.getValue("/root/resData/fc_acct_2293_s/dataSet/CUR_WHCO_NDSTB_CD_LIST/record[1]/whco_comn_cost_yn") == "Y") {
							use_dept_cd.attribute("editable") = "false";
							use_dept_cd.attribute("background-color") = DEFAULT_COLOR_DISABLE;							
							use_dept_cd.value = "999999";
							pch_buseonm.value = "공통부서";
						}
																	
						// 예산별관리항목별로 필수색 셋팅
						fn_background_color_setting("1");
					
						// 예산코드에 따른 거래처구분, 관리구분 콤보 셋팅
						fn_dlco_mang_clsf_setting();		
						
						fun_budg_cd_ch();
					]]>
				</script>
			</input>
			<input id="use_dept_cd" ref="/root/resData/resform/use_dept_cd" class="req" navindex="2" inputtype="button" maxlength="6" style="left:95px; top:54px; width:65px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						
						var var_con_date = "";
						var var_date_ch = parentWindow.srch_slip_occr_dt.value.ReplaceString("-", "");

						if (var_date_ch == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = var_date_ch;
							if(num_ch == 8){
								var_con_date = var_date_ch;
							}else if(num_ch == 6){
								var_con_date = var_date_ch + "01";
							}else if(num_ch == 4){
								var_con_date = var_date_ch + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "I");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						
						var var_con_date = "";
						var var_date_ch = parentWindow.srch_slip_occr_dt.value.ReplaceString("-", "");

						if (var_date_ch == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = var_date_ch;
							if(num_ch == 8){
								var_con_date = var_date_ch;
							}else if(num_ch == 6){
								var_con_date = var_date_ch + "01";
							}else if(num_ch == 4){
								var_con_date = var_date_ch + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (use_dept_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
//							model.setValue("/root/reqData/searchData/emp_no", "");
							model.setValue("/root/reqData/fwdData/dept_cd", use_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "I");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								pch_buseonm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								use_dept_cd.value = "";
								pch_buseonm.value = "";
							}
						}
						else {
							use_dept_cd.value = "";
							pch_buseonm.value = "";
						}	
						
					]]>
				</script>
			</input>
			<input id="pch_buseonm" ref="/root/resData/resform/pch_buseonm" editable="false" inputtype="input" style="left:163px; top:54px; width:132px; height:18px; "/>
			<input id="pch_sdysnm" ref="/root/resData/resform/pch_sdysnm" editable="false" inputtype="input" style="left:163px; top:29px; width:132px; height:18px; "/>
		</group>
		<group id="group_tit" class="gro_tit" style="left:0px; top:0px; width:545px; height:39px; ">
			<caption id="caption1" class="tit01" style="left:10px; top:6px; width:351px; height:27px; ">전표행번등록</caption>
			<img id="img4" src="/images/ta_img_03.gif" style="left:525px; top:10px; width:15px; height:15px; background-stretch:stretch; ">
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						window.close();
					]]>
				</script>
			</img>
		</group>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:501px; width:529px; height:21px; ">
			<button id="btn_append" class="btn02" style="left:108px; top:0px; width:52px; height:21px; ">
				<caption>행삽입</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (fn_FormToGrid(childBody.datagrid1.row, "A") == false) { return; }
						model.setFocus("slip_arow_no");
					]]>
				</script>
			</button>
			<button id="btn_delete" class="btn02" style="left:162px; top:0px; width:52px; height:21px; ">
				<caption>행삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (childBody.datagrid1.valueMatrix(childBody.datagrid1.row, 2) != "") {
							childBody.datagrid1.deleteRow(childBody.datagrid1.row);
							fn_GridToForm(childBody.datagrid1.row);
							model.setFocus("slip_arow_no");
						}
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:216px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						window.close();		
					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" style="left:0px; top:0px; width:52px; height:21px; ">
				<caption>행입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (fn_FormToGrid(childBody.datagrid1.row, "I") == false) { return; }
						model.setFocus("slip_arow_no");	
					]]>
				</script>
			</button>
			<button id="btn_update" class="btn02" style="left:54px; top:0px; width:52px; height:21px; ">
				<caption>행수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (childBody.datagrid1.valueMatrix(childBody.datagrid1.row, 2) == "") { 
							show_message("행입력을 눌러주십시오.");
							return;
						}
				
						if (fn_FormToGrid(childBody.datagrid1.row, "U") == false) { return; }
						model.setFocus("slip_arow_no");
					]]>
				</script>
			</button>
		</group>
		<group id="group2" disabled="true" style="left:10px; top:540px; width:528px; height:95px; ">
			<caption id="caption12" class="list_cap02" style="left:89px; top:69px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption39" class="list_cap02" style="left:89px; top:44px; width:439px; height:26px; text-align:center; "/>
			<caption id="subtitle" class="tit02" style="left:0px; top:0px; width:524px; height:20px; ">세금계산서</caption>
			<caption id="caption45" class="list_cap02" style="left:89px; top:19px; width:439px; height:26px; text-align:center; "/>
			<input id="occr_slip_occr_dt" ref="/root/resData/resform/occr_slip_occr_dt" format="yyyy-mm-dd" style="left:261px; top:23px; width:90px; height:18px; "/>
			<caption id="caption41" class="list_cap03" style="left:0px; top:69px; width:90px; height:26px; text-align:center; ">잡수익</caption>
			<caption id="caption64" class="list_cap03" style="left:0px; top:44px; width:90px; height:26px; text-align:center; ">사업장코드</caption>
			<select1 id="prof_type_cd" ref="/root/resData/resform/prof_type_cd" navindex="29" appearance="minimal" editmode="inputsearch" style="left:95px; top:23px; width:130px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2290_m/dataSet/CUR_PROF_TYPE_LIST/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					]]>
				</script>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
						if (prof_type_cd.value != "") {
							occr_slip_clsf_cd.value = "60";
							occr_slip_occr_dt.value = commCurDate();
							occr_slip_seq.value = "";
							if (erplace_cd.value == "") {
								erplace_cd.value = "01";
								erplace_cd.dispatch("xforms-value-changed");
							}
							if ((dlco_clsf_cd.value == "93" || dlco_clsf_cd.value == "94") && dlco_cd.value != "") {
								ern.value = dlco_cd.value;
							}
						}
						else {
							occr_slip_clsf_cd.value = "";
							occr_slip_occr_dt.value = "";
							occr_slip_seq.value = "";
							erplace_cd.value = "";
							ern.value = "";
							make_dt.value = "";
							etc_in.value = "";
						}			
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(prof_type_cd, prof_type_cd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(prof_type_cd,"");
						return;
					}
					]]>
				</script>
			</select1>
			<caption id="caption21" class="list_cap02" style="left:387px; top:69px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption46" class="list_cap03" style="left:390px; top:19px; width:55px; height:26px; text-align:center; ">작성일자</caption>
			<caption id="caption47" class="list_cap03" style="left:0px; top:19px; width:90px; height:26px; text-align:center; ">세금계산서</caption>
			<input id="make_dt" ref="/root/resData/resform/make_dt" navindex="32" inputtype="date" style="left:450px; top:23px; width:70px; height:18px; "/>
			<select1 id="erplace_cd" ref="/root/resData/resform/erplace_cd" navindex="31" appearance="minimal" editmode="inputsearch" style="left:95px; top:48px; width:130px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2290_m/dataSet/CUR_ERPLACE_CD_LIST/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(erplace_cd, erplace_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(erplace_cd,"");
							return;
						}
					
						if (erplace_cd.value == "02" && use_dept_cd.value != "215096" || 
						    erplace_cd.value == "03" && use_dept_cd.value != "215097" || 
						    erplace_cd.value == "04" && use_dept_cd.value != "215098" || 
						    erplace_cd.value == "05" && use_dept_cd.value != "317020" ||
						    ((erplace_cd.value == "01" || erplace_cd.value == "06") &&
						       (use_dept_cd.value == "215096" || 
						        use_dept_cd.value == "215097" || 
						        use_dept_cd.value == "215098" || 
						        use_dept_cd.value == "317020"))) {
  							show_message("[사용부서 혹은 사업장코드 확인요]");
  							return;
						}
						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
					
					]]>
				</script>
			</select1>
			<input id="ern" ref="/root/resData/resform/ern" navindex="34" inputtype="button" style="left:393px; top:73px; width:130px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						gstr_popupid = "ern";
						open_fc_acct_1180("button","s");		
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						gstr_popupid = "ern";
						open_fc_acct_1180("focus","s");		
					]]>
				</script>
			</input>
			<input id="occr_slip_clsf_cd" ref="/root/resData/resform/occr_slip_clsf_cd" style="left:228px; top:23px; width:30px; height:18px; "/>
			<caption id="caption18" class="list_cap03" style="left:298px; top:69px; width:90px; height:26px; text-align:center; ">공급자번호</caption>
			<input id="etc_in" ref="/root/resData/resform/etc_in" navindex="33" format="(-)#,###" style="left:95px; top:73px; width:130px; height:18px; text-align:right; "/>
			<input id="occr_slip_seq" ref="/root/resData/resform/occr_slip_seq" navindex="30" style="left:354px; top:23px; width:30px; height:18px; "/>
			<input id="suply_amt" ref="/root/resData/resform/suply_amt" navindex="5" inputtype="input" format="(-)#,###" style="left:392px; top:48px; width:130px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
//Private Sub txtHJPgwapyo_Change()
//    w_txthjpgwapyo_change_flag = True
//End Sub
//
//Private Sub txtHJPgwapyo_GotFocus()
//    Cmndll.GF_NumberDisplay txtHJPgwapyo
//    w_txthjpgwapyo_change_flag = False
//End Sub
//
//Private Sub txtHJPgwapyo_KeyPress(KeyAscii As Integer)
//    Cmndll.GF_Key_Check txtHJPgwapyo, KeyAscii
//End Sub
//
//Private Sub txtHJPgwapyo_LostFocus()
//    Cmndll.GF_NumericDisplay txtHJPgwapyo
//    If w_txthjpgwapyo_change_flag = True Then
//        Call S_WCJS_Compute
//        
//        If Left(Trim(txtHJPYSCD.Text), 4) = "6226" Then  '2005.4.12
//           Call S_GYBHRYO_Compute
//        Else
//           txtGYBHRYO.Text = ""
//        End If
//        
//        If Left(Trim(cboHJPSDGBCD.Text), 4) = "9011" Then  '2005.5.10
//           Call S_GYBHRYO_Compute
//        Else
//           txtGYBHRYO.Text = ""
//        End If
//    End If
//End Sub		
					]]>
				</script>
			</input>
			<caption id="suplyamt" class="list_cap03" style="left:298px; top:44px; width:90px; height:26px; text-align:center; ">과표</caption>
		</group>
	</xhtml:body>
</xhtml:html>
