<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>시내교통비현업등록(FC_ACCT_2030)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session>
						</session>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<dataSet>
								<CUR_SLIP_CLSF_LIST>
									<record>
										<cd/>
										<cdnm/>
										<cd_abrv_nm/>
										<cdnm_cd/>
										<cdabrvnm_cd/>
									</record>
								</CUR_SLIP_CLSF_LIST>
								<srch_slip_clsf_cd/>
								<slip_clsf_cd/>
							</dataSet>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData/>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<dept_cd/>
							<emp_no/>
							<slip_clsf_cd1/>
							<select_ch/>
							<use_end_dt/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqform>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<slip_arow_no/>
							<budg_yymm/>
							<clam_dept_cd/>
							<clam_amt/>
							<rmks/>
							<chrg_emp_no/>
							<incmg_pers_ipadd/>
							<incmg_pers/>
							<!-- Grid의 MultiUpDate유형 사용시 처리 -->
							<multiUpdateData/>
							<hj_slip_aprv_yn/>
						</reqform>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<gridData>
							<dataSet>
								<CURLIST>
									<record>
										<slip_occr_dt/>
										<slip_clsf_cd/>
										<slip_seq/>
										<budg_yymm/>
										<clam_dept_cd/>
										<chrg_emp_no/>
										<chrg_emp_no_nm/>
										<rmks/>
										<clam_amt/>
										<hj_incmg_emp_no/>
										<hj_incmg_emp_no_nm/>
										<hj_slip_aprv_yn/>
										<slip_arow_no/>
										<emp_no/>
										<emp_no_nm/>
										<emp_dept_cd_nm/>
										<dest/>
										<amt/>
									</record>
									<totalcnt/>
								</CURLIST>
							</dataSet>
						</gridData>
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<MsgData>
							<dataSet>
								<slip_seq/>
								<errcode/>
								<errmsg/>
							</dataSet>
						</MsgData>
						<!-- (submit의 결과) 전달 받은 MsgData -->
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
					</tempData>
					<printData/>
					<tmpData>
						<clam_dept_cd_nm/>
						<chrg_emp_no_nm/>
						<incmg_pers_nm/>
						<emp_no/>
						<emp_nm/>
						<emp_dept_nm/>
					</tmpData>
					<tempData>
						<fc_co_1101_l>
							<dataSet>
								<CURLIST1>
									<record>
										<cmpy_cd/>
										<dept_cd/>
										<dept_team_clsf/>
										<abrv_nm/>
										<offi_nm/>
										<dept_team_nm/>
										<part_nm/>
										<part_dn_nm/>
									</record>
								</CURLIST1>
							</dataSet>
						</fc_co_1101_l>
					</tempData>
				</root>
			</instance>
			<script type="javascript" src="../../../js/CIISComm.js"/>
			<script type="javascript" src="../../../js/TFCommon.js"/>
			<script type="javascript" src="../../../js/fcmc_common.js"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					// 폼로드
					//debugger;
					//set_refvalue("/root/reqData/searchData/slip_occr_dt", commCurDate());
					
					model.send("fc_acct_2030_m");
					srch_slip_occr_dt.value= commCurDate();
					//srch_slip_clsf_cd.currentText = "60 지출결의";
					srch_slip_clsf_cd.value = model.getValue("/root/initData/comboSet/dataSet/srch_slip_clsf_cd");
					
					slip_occr_dt.value = commCurDate();
					//slip_clsf_cd.value= "60";
					slip_clsf_cd.value = model.getValue("/root/initData/comboSet/dataSet/slip_clsf_cd");

					budg_yymm.value = commCurDate().substring(0, 6);
					clam_dept_cd.value = getProperty("ss_deptcd")
					clam_dept_cd_nm.value = getProperty("ss_deptnm")
					chrg_emp_no.value = getProperty("ss_emp_no")
					chrg_emp_no_nm.value = getProperty("ss_emp_nm")
					//incmg_pers.value = getProperty("ss_emp_no")
					//incmg_pers_nm.value = getProperty("ss_emp_nm")					

					model.setFocus("srch_slip_occr_dt");

					datagrid1.addStatus(1,"insert");
					
					for (i=1; i<51; i++){
						datagrid1.addRow( false);
					}										
				]]>
			</script>
			<submission id="hd_com_1002" action="/hd/com/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="fc_acct_2030_m" action="/fc/acct2000/2030" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/comboSet/dataSet"/>
			<submission id="fc_acct_2031_l" action="/fc/acct2000/2031" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/dataSet"/>
			<submission id="fc_acct_2032_i" action="/fc/acct2000/2032" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqform" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="fc_acct_2033_d" action="/fc/acct2000/2033" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqform" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="fc_acct_2034_t" action="/fc/acct2000/2034" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/printData" resultref="/root/printData"/>
			<submission id="fc_co_1101" action="/fc/co1000/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/fc_co_1101_l/dataSet"/>
			<instance id="instance2">
				<root>
					<printData/>
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					init_controls();
				]]>
			</script>
		</model>
		<model id="model_print">
			<submission id="submission1" action="/fc/acct2000/2034" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/printData"/>
		</model>
		<script type="javascript">
			<![CDATA[
				var	_oth_clsf = "1";
				
				var gvar_slip_occr_dt;
				var gvar_slip_clsf_cd;
				var gvar_slip_seq;		

				function init_controls(){
						set_default(datagrid1);	
				}
				// 입력자명
				function setEmp_no(emp_no, nm_korn, dept_nm){

					set_refvalue("/root/tmpData/emp_no", emp_no);
					set_refvalue("/root/tmpData/emp_nm", nm_korn);
					set_refvalue("/root/tmpData/emp_dept_nm", dept_nm);
					
					datagrid1.valueMatrix(datagrid1.row,datagrid1.col) = get_refvalue("/root/tmpData/emp_no");
					datagrid1.valueMatrix(datagrid1.row,datagrid1.col+2) = get_refvalue("/root/tmpData/emp_nm");
					datagrid1.valueMatrix(datagrid1.row,datagrid1.col+1) = get_refvalue("/root/tmpData/emp_dept_nm");
					datagrid1.addStatus(datagrid1.row, "update");
				}

				// 담당자명
				function set_chrg_emp_no(emp_no, nm_korn){

					chrg_emp_no.value= emp_no;
					chrg_emp_no_nm.value = nm_korn;
				}

				// 입력자명
				function set_incmg_pers(emp_no, nm_korn){

					incmg_pers.value= emp_no;
					incmg_pers_nm.value = nm_korn;
				}
				
				function setDept_cd(iv_dept_cd, iv_dept_nm, iv_dept_team_clsf, iv_offi_nm, iv_dept_team_nm, iv_part_nm, iv_part_dn_nm){	
					model.setValue("/root/reqData/reqform/clam_dept_cd", iv_dept_cd);
					model.setValue("/root/tmpData/clam_dept_cd_nm", iv_dept_nm);
					clam_dept_cd.refresh();
					clam_dept_cd_nm.refresh();
				}

				function change_status(){
					for(var i=datagrid1.rows; i > datagrid1.rows-11; i--){
						datagrid1.rowStatus(i) = "1";
					}
				}	
				
				function delete_row(){
					var row = datagrid1.row;
					if(row != datagrid1.rows){
						datagrid1.deleteRow(row);
					}else{
						datagrid1.removeRow();
					}
				}
				
				function insert_row(){
					var row = datagrid1.row;
					datagrid1.insertRow(row,"above","false");
					datagrid1.removeStatus(row,"insert");			
					datagrid1.refresh();
				}
				
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="1,10;2,11;1,873;1,878;1,933;1,936;2,30;2,39;2,40;2,50;" style="font-family:굴림; ">
		<group id="group_tit" class="gro_tit" style="left:0px; top:0px; width:946px; height:39px; ">
			<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:10px; width:926px; height:29px; "/>
		</group>
		<group id="group_scr" class="gro_sel" style="left:10px; top:49px; width:926px; height:112px; ">
			<caption id="caption3" class="list_cap02" style="left:109px; top:0px; width:814px; height:25px; text-align:center; "/>
			<caption id="caption5" class="list_cap02" style="left:109px; top:35px; width:390px; height:25px; text-align:center; "/>
			<caption id="caption7" class="list_cap02" style="left:109px; top:59px; width:390px; height:25px; text-align:center; "/>
			<caption id="caption10" class="list_cap03" style="left:494px; top:35px; width:120px; height:25px; text-align:center; ">예산년월</caption>
			<caption id="caption11" class="list_cap02" style="left:613px; top:35px; width:310px; height:25px; text-align:center; "/>
			<caption id="caption12" class="list_cap03" style="left:494px; top:59px; width:120px; height:25px; text-align:center; ">입력자</caption>
			<caption id="caption13" class="list_cap02" style="left:613px; top:59px; width:310px; height:25px; text-align:center; "/>
			<caption id="caption15" class="list_cap02" style="left:613px; top:83px; width:310px; height:25px; text-align:center; "/>
			<caption id="caption17" class="list_cap02" style="left:109px; top:83px; width:390px; height:25px; text-align:center; "/>
			<caption id="caption20" class="list_cap03" style="left:494px; top:0px; width:120px; height:25px; text-align:center; ">전표상태</caption>
			<input id="slip_occr_dt" ref="/root/reqData/reqform/slip_occr_dt" navindex="3" inputtype="input" style="left:115px; top:38px; width:55px; height:18px; "/>
			<input id="rmks" ref="/root/reqData/reqform/rmks" navindex="8" inputtype="input" style="left:115px; top:86px; width:291px; height:18px; "/>
			<caption id="caption8" style="left:321px; top:4px; width:180px; height:18px; ">(발생일자-전표구분-일련번호)</caption>
			<caption id="caption9" style="left:175px; top:38px; width:13px; height:20px; ">-</caption>
			<caption id="caption29" style="left:215px; top:38px; width:13px; height:20px; ">-</caption>
			<input id="slip_clsf_cd" ref="/root/reqData/reqform/slip_clsf_cd" navindex="4" inputtype="input" style="left:185px; top:38px; width:25px; height:18px; "/>
			<input id="slip_seq" ref="/root/reqData/reqform/slip_seq" editable="false" inputtype="input" style="left:225px; top:38px; width:30px; height:18px; "/>
			<input id="slip_arow_no" ref="/root/reqData/reqform/slip_arow_no" editable="false" inputtype="input" style="left:260px; top:38px; width:20px; height:18px; "/>
			<input id="hj_slip_aprv_yn" ref="/root/reqData/reqform/hj_slip_aprv_yn" editable="false" inputtype="input" style="left:622px; top:4px; width:105px; height:18px; "/>
			<input id="chrg_emp_no" ref="/root/reqData/reqform/chrg_emp_no" class="req" navindex="7" inputtype="button" maxlength="6" style="left:622px; top:62px; width:90px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						set_refvalue("/root/reqData/fwdData/func_nm", "set_chrg_emp_no");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (chrg_emp_no.value.length== 6) {

							set_refvalue("/root/reqData/searchData/emp_no", chrg_emp_no.value); // 검색조건에 셋팅
							set_refvalue("/root/reqData/searchData/dept_cd", ""); // 검색조건에 셋팅

							model.send("hd_com_1002");

							chrg_emp_no_nm.value = get_refvalue("/root/tempData/record/nm_korn");
						}		
						else {
							chrg_emp_no_nm.value = "";
						}
					]]>
				</script>
			</input>
			<input id="chrg_emp_no_nm" ref="/root/tmpData/chrg_emp_no_nm" editable="false" style="left:715px; top:62px; width:162px; height:18px; "/>
			<input id="srch_slip_clsf_cd" ref="/root/reqData/searchData/slip_clsf_cd1" editable="false" inputtype="input" style="left:208px; top:4px; width:80px; height:18px; "/>
			<input id="srch_slip_seq" ref="/root/reqData/searchData/slip_seq" class="req" navindex="2" inputtype="input" maxlength="3" style="left:290px; top:4px; width:25px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						// 전표일자 변경시
						if(get_refvalue("/root/reqData/searchData/slip_occr_dt").length == 8 &&  get_refvalue("/root/reqData/searchData/slip_seq").length == 3){
							btn_select.dispatch("onclick");
						}
					]]>
				</script>
			</input>
			<input id="srch_slip_occr_dt" ref="/root/reqData/searchData/slip_occr_dt" class="req" navindex="1" inputtype="date" style="left:115px; top:4px; width:90px; height:18px; "/>
			<input id="clam_dept_cd_nm" ref="/root/tmpData/clam_dept_cd_nm" editable="false" style="left:208px; top:63px; width:198px; height:18px; "/>
			<input id="clam_dept_cd" ref="/root/reqData/reqform/clam_dept_cd" class="req" navindex="6" inputtype="button" maxlength="6" style="left:115px; top:63px; width:90px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						var var_con_date = "";

						if (budg_yymm.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = budg_yymm.value.length
							if(num_ch == 8){
								var_con_date = budg_yymm.value;
							}else if(num_ch == 6){
								var_con_date = budg_yymm.value + "01";
							}else if(num_ch == 4){
								var_con_date = budg_yymm.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "I");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var var_con_date = "";

						if (budg_yymm.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = budg_yymm.value.length
							if(num_ch == 8){
								var_con_date = budg_yymm.value;
							}else if(num_ch == 6){
								var_con_date = budg_yymm.value + "01";
							}else if(num_ch == 4){
								var_con_date = budg_yymm.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (clam_dept_cd.value.length== 6) {
							
							model.setValue("/root/reqData/searchData/emp_no", "");
							model.setValue("/root/reqData/searchData/dept_cd", clam_dept_cd.value);
							model.setValue("/root/reqData/searchData/select_ch", "I");
							model.setValue("/root/reqData/searchData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								clam_dept_cd_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								clam_dept_cd.value = "";
								clam_dept_cd_nm.value = "";
							}
						}
						else {
							clam_dept_cd.value = "";
							clam_dept_cd_nm.value = "";
						}			
					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[
						gvar_dept_cd = 	clam_dept_cd.value;
					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
						
						if (gvar_dept_cd == clam_dept_cd.value) {
							return;
						}
						
					]]>
				</script>
			</input>
			<!--
			<input id="incmg_pers" ref="/root/reqData/reqform/incmg_pers" class="req" editable="false" inputtype="button" maxlength="6" style="left:616px; top:111px; width:90px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						set_refvalue("/root/reqData/fwdData/func_nm", "set_incmg_pers");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (incmg_pers.value.length== 6) {
						
							set_refvalue("/root/reqData/searchData/emp_no", incmg_pers.value); // 검색조건에 셋팅
							set_refvalue("/root/reqData/searchData/dept_cd", ""); // 검색조건에 셋팅
							
							model.send("hd_com_1002");
							
							incmg_pers_nm.value = get_refvalue("/root/tempData/record/nm_korn");
		
						}		
						else {
							incmg_pers_nm.value = "";
						}
					]]>
				</script>
			</input>
			<input id="incmg_pers_nm" ref="/root/tmpData/incmg_pers_nm" editable="false" style="left:709px; top:111px; width:162px; height:18px; "/>
			-->
			<input id="clam_amt" ref="/root/reqData/reqform/clam_amt" editable="false" format="(-)#,###" style="left:622px; top:87px; width:122px; height:18px; text-align:right; "/>
			<input id="budg_yymm" ref="/root/reqData/reqform/budg_yymm" class="req" navindex="5" inputtype="input" maxlength="6" format="yyyy-mm" style="left:622px; top:38px; width:90px; height:18px; "/>
			<caption id="caption2" class="list_cap03" style="left:0px; top:0px; width:110px; height:25px; text-align:center; ">전표번호</caption>
			<caption id="caption4" class="list_cap03" style="left:0px; top:35px; width:110px; height:25px; text-align:center; ">전표번호</caption>
			<caption id="caption6" class="list_cap03" style="left:0px; top:59px; width:110px; height:25px; text-align:center; ">청구부서</caption>
			<caption id="caption16" class="list_cap03" style="left:0px; top:83px; width:110px; height:25px; text-align:center; ">적요2</caption>
			<caption id="caption14" class="list_cap03" style="left:494px; top:83px; width:120px; height:25px; text-align:center; ">금액</caption>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:164px; width:921px; height:5px; "/>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/dataSet/CURLIST/record" caption="순번^사번^부서^성명^행선지^금액" colsep="#" colwidth="120, 150, 120, 200, 149, 150" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:10px; top:175px; width:97.36%; height:542px; ">
			<col ref="slip_arow_no"/>
			<col ref="emp_no" type="inputbutton"/>
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
				if(datagrid1.row > 0) {
					if ((datagrid1.mouseCol == 2)){
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						set_refvalue("/root/reqData/fwdData/func_nm" , "setEmp_no");
						window.load("/xrw/hd/com/HD_COM_1010.xrw","mdichild", "hd_com_1010", "align:center; caption:hidden;",  "/root/reqData/fwdData",  "/root/reqData/fwdData");
					}
				}
				]]>
			</script>
			<col ref="emp_dept_cd_nm"/>
			<col ref="emp_no_nm"/>
			<col ref="dest" type="input"/>
			<col imemode="alpha" ref="amt" type="input" format="(-)#,###"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					if(datagrid1.row > 0) {
						if (datagrid1.col == 2){				
							
							if (datagrid1.valueMatrix(datagrid1.row,datagrid1.col).length== 6) {
								
								set_refvalue("/root/reqData/searchData/emp_no", datagrid1.valueMatrix(datagrid1.row,datagrid1.col)); // 검색조건에 셋팅
								set_refvalue("/root/reqData/searchData/dept_cd", ""); // 검색조건에 셋팅
								
								model.send("hd_com_1002");
	
								//set_refvalue("/root/tempData/emp_no", emp_no);
								//set_refvalue("/root/tempData/nm_korn", nm_korn);
								//set_refvalue("/root/tempData/dept_nm", dept_nm);
								
								datagrid1.valueMatrix(datagrid1.row,datagrid1.col) = get_refvalue("/root/tempData/record/emp_no");
								datagrid1.valueMatrix(datagrid1.row,datagrid1.col+2) = get_refvalue("/root/tempData/record/nm_korn");
								datagrid1.valueMatrix(datagrid1.row,datagrid1.col+1) = get_refvalue("/root/tempData/record/dept_nm");

								datagrid1.rowStatus(i) = "3";
								datagrid1.addStatus(datagrid1.row, "update");
							}
						}else if (datagrid1.col == 6){
								//debugger;
								var var_clam_amt = 0;
								for (i=1; i<datagrid1.rows - 1; i++) {
									if (datagrid1.valueMatrix(i,6) != ""){
										var_clam_amt = Number(var_clam_amt) + Number(datagrid1.valueMatrix(i,6));
									}
								}
								clam_amt.value= Number(var_clam_amt);
						}
					}
				]]>
			</script>
			<script type="javascript" ev:event="oncopy">
				<![CDATA[
					// datagrid 에 선택된 셀을 얻어온다							
					var selected = datagrid1.selectedCells;
					var excelData = "";
					var miniCol = selected.item(0).col;
					var miniRow = selected.item(0).row;
					var maxCol = selected.item(0).col;
					var maxRow = selected.item(0).row;
					
					var cell;
					// col의 최대 최소 값을 구한다				
					for(var i=0; i<selected.length; i++)
					{
						cell = selected.item(i);
						
						// 최대 col 겁색
						if( cell.col > maxCol )
							maxCol = cell.col;
						
						// 최소 col 겁색
						if (cell.col < miniCol )
							miniCol = cell.col;
						
						// 최대 row 검색
						if( cell.row > maxRow )
							maxRow = cell.row;
						
						// 최소 row 검색
						if (cell.row < miniRow )
							miniRow = cell.row;
					}
							
					// cell Data 를 클립보드에 excel 형태로 집어넣음
					for(var k=miniRow; k<=maxRow; k++)
					{
						for(var j=miniCol; j<=maxCol; j++)
						{
							var data = datagrid1.valueMatrix(k,j);
							excelData += data;
							if( j != maxCol)
								excelData += "\t";
						}
		
						if( k != maxRow)
							excelData += "\n";
					}
					
					//  클립보드 데이터 변경
					window.clipBoardData = excelData;
				]]>
			</script>
		</datagrid>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:731px; width:926px; height:21px; ">
			<button id="btn_update" class="btn02" crud="U" style="left:111px; top:0px; width:52px; height:21px; ">
				<caption>수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (gvar_slip_occr_dt != srch_slip_occr_dt.value.ReplaceString("-", "") || gvar_slip_clsf_cd != model.getValue("/root/initData/comboSet/dataSet/slip_clsf_cd") || gvar_slip_seq != srch_slip_seq.value) {
							show_message("KEY 변경시 작업불가");
							model.setFocus("srch_slip_occr_dt");
							return;
						}

						if (slip_occr_dt.value.ReplaceString("-", "").length != 8){
							show_message("전표번호[일자]는 잘못된 형식입니다.");
							model.setFocus("slip_occr_dt");
							return;
						}
					
						if (slip_clsf_cd.value.length != 2){
							show_message("전표번호[구분코드]는 필수입력항목입니다.");
							model.setFocus("slip_clsf_cd");
							return;
						}
						
						if (slip_seq.value.length == 0){
							show_message("전표번호[일련번호]는 필수입력항목입니다.");
							model.setFocus("slip_seq");
							return;
						}

						if (budg_yymm.value.ReplaceString("-", "").length != 6){
							show_message("예산년월는 필수입력항목입니다.");
							model.setFocus("budg_yymm");
							return;
						}
							
						if (clam_dept_cd.value.ReplaceString("-", "").length != 6){
							show_message("청구부서는 필수입력항목입니다.");
							model.setFocus("clam_dept_cd");
							return;
						}	

      						if (chrg_emp_no.value.ReplaceString("-", "").length != 6){
							show_message("담당자는 필수입력항목입니다.");
							model.setFocus("chrg_emp_no");
							return;
						}						
					
						if ((clam_amt.value == "") || (clam_amt.value == "0")){
							show_message("결의금액은 0보다 커야됩니다.");
							model.setFocus("clam_amt");
							return;
						}							

						var cnt = 0;
						var var_clam_amt = 0;
						
						for (i=1; i<datagrid1.rows; i++){
							var emp_no = datagrid1.valueMatrix(i, 2);
							var dest = datagrid1.valueMatrix(i, 5);
							var amt = datagrid1.valueMatrix(i, 6);

							if (emp_no == "" || dest == "" || amt == ""){
								datagrid1.rowStatus(i) = 0;
							}
							else {	
								//debugger;					
								if(datagrid1.rowStatus(i) == "3" || datagrid1.rowStatus(i) == "2" || datagrid1.rowStatus(i) == "1"){
									cnt = cnt+1;
								}
								
								if (datagrid1.valueMatrix(i,6) != ""){
									var_clam_amt = Number(var_clam_amt) + Number(datagrid1.valueMatrix(i,6));
								}
								datagrid1.rowStatus(i) = 1;

							}
						}
						
						clam_amt.value= Number(var_clam_amt);
						
						if(cnt ==0){
							show_message("사번, 행선지, 금액은 필수입력항목입니다.");
							change_status();
							return;
						}
						if (show_message("수정하시겠습니까?","수정 확인",MB_YESNO) != IDYES) {
							change_status();							
							return;
						}

						set_refvalue("/root/reqData/reqform/multiUpdateData",  datagrid1.getUpdateData());
//						alert(get_refvalue("/root/reqData/multiUpDate/multiUpdateData"));

						model.refresh();

    						model.send("fc_acct_2032_i");
    						
						if(submit_completed()){
//							alert(get_refvalue("/root/resData/MsgData/slip_seq"));
    							srch_slip_seq.value = get_refvalue("/root/resData/MsgData/dataSet/slip_seq");
						       show_message("수정되었습니다.");
							btn_select.dispatch("onclick");
						}
						else{
							change_status();
							return;	
						}						
				
					]]>
				</script>
			</button>
			<button id="btn_copy" class="btn02" navindex="9" crud="R" style="left:222px; top:0px; width:54px; height:21px; ">
				<caption>복사</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//datagrid1.dispatch("oncopy");
						btn_insert.disabled = false;
						
						if (gvar_slip_occr_dt != srch_slip_occr_dt.value.ReplaceString("-", "") || gvar_slip_clsf_cd != model.getValue("/root/initData/comboSet/dataSet/slip_clsf_cd") || trim(gvar_slip_seq) != trim(srch_slip_seq.value)) {
							model.alert("KEY 변경시 작업불가");
							model.setFocus("srch_slip_occr_dt");
							return;
						}		
						
						srch_slip_seq.value = "";
						slip_seq.value = "";
						slip_arow_no.value = "";
//						gvar_slip_seq = "";
						
						datagrid1.clearStatus();
						
						for (i=1; i<datagrid1.rows - 1; i++) {
							if (datagrid1.valueMatrix(i, 25) != "") {
//								alert(datagrid1.valueMatrix(i, 25));
//								alert(datagrid1.valueMatrix(i, 25).substring(0, 4));
//								alert(commCurDate());
//								alert(datagrid1.valueMatrix(i, 25).substring(12, 16));
								datagrid1.valueMatrix(i, 25) = datagrid1.valueMatrix(i, 25).ReplaceString("-", "").substring(0, 4) + commCurDate() + datagrid1.valueMatrix(i, 25).ReplaceString("-", "").substring(12, 16);
							}
							datagrid1.rowStatus(i) = "3";
						}			
						
						
//						datagrid1.gridToInstance();
//						datagrid2.gridToInstance();
						
//						alert(gvar_slip_occr_dt);
/*						
						if (gvar_slip_occr_dt != srch_slip_occr_dt.value.ReplaceString("-", "") || gvar_slip_clsf_cd != "60" || trim(gvar_slip_seq) != trim(srch_slip_seq.value)) {
							show_message("KEY 변경시 작업불가");
							model.setFocus("srch_slip_occr_dt");
							return;
						}		
						
						srch_slip_seq.value = "";
//						gvar_slip_seq = "";
						fisc_dt.value = "";
						slip_aprv_yn.value = "";
						slip_aprv_yn.attribute("background-color") = "green"; 
						
						datagrid1.clearStatus();
						
						for (i=1; i<datagrid1.rows - 1; i++) {
							if (datagrid1.valueMatrix(i,  25) != "") {
//								alert(datagrid1.valueMatrix(i, 25));
//								alert(datagrid1.valueMatrix(i, 25).substring(0, 4));
//								alert(commCurDate());
//								alert(datagrid1.valueMatrix(i, 25).substring(12, 16));
								datagrid1.valueMatrix(i, 25) = datagrid1.valueMatrix(i, 25).ReplaceString("-", "").substring(0, 4) + commCurDate() + datagrid1.valueMatrix(i, 25).ReplaceString("-", "").substring(12, 16);
							}
							datagrid1.rowStatus(i) = "3";
						}
*/						
					]]>
				</script>
			</button>
			<button id="btn_delete" class="btn02" crud="D" style="left:166px; top:0px; width:54px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (gvar_slip_occr_dt != srch_slip_occr_dt.value.ReplaceString("-", "") || gvar_slip_clsf_cd != model.getValue("/root/initData/comboSet/dataSet/slip_clsf_cd") || gvar_slip_seq != srch_slip_seq.value) {
							show_message("KEY 변경시 작업불가");
							model.setFocus("srch_slip_occr_dt");
							return;
						}

						if(hj_slip_aprv_yn.value == "승  인") {
							show_message("승인된 자료는 입력할 수 없습니다.");
							return;
						}
						
						if (srch_slip_occr_dt.value.ReplaceString("-", "").length != 8){
							show_message("전표번호[일자]는 잘못된 형식입니다.");
							model.setFocus("srch_slip_occr_dt");
							return;
						}
						
						if (srch_slip_seq.value.ReplaceString("-", "").length != 3){
							show_message("전표번호[순번]는 필수입력항목입니다.");
							model.setFocus("srch_slip_seq");
							return;
						}
						
						if (show_message("삭제하시겠습니까?","삭제 확인",MB_YESNO) != IDYES) {
							change_status();							
							return;
						}

						model.refresh();
						
    						model.send("fc_acct_2033_d");
    						
						if(submit_completed()){
//							alert(get_refvalue("/root/resData/MsgData/slip_seq"));
   							model.reset();
   							show_message("삭제되었습니다.");
						       
						       	for (i=1; i<datagrid1.rows; i++){
								datagrid1.rowStatus(i) = "1";
							}
						}
						else{
							change_status();
							return;	
						}					
					]]>
				</script>
			</button>
			<button id="btn_select" class="btn02" crud="R" style="left:0px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[	// 조회버튼 클릭시

						if (srch_slip_occr_dt.value.ReplaceString("-", "").length != 8){
							show_message("전표번호[일자]는 잘못된 형식입니다.");
							model.setFocus("srch_slip_occr_dt");
							return;
						}
						
						if (srch_slip_seq.value.ReplaceString("-", "").length != 3){
							show_message("전표번호[순번]는 필수입력항목입니다.");
							model.setFocus("srch_slip_seq");
							return;
						}

						// "사용가능한 부서코드가 아닙니다" 로직이 들어가야 함 (개인별권한관리)
						
						model.send("fc_acct_2030_m");
						//alert(model.getValue("/root/initData/comboSet/dataSet/slip_clsf_cd"));
						model.setValue("/root/reqData/searchData/slip_clsf_cd", model.getValue("/root/initData/comboSet/dataSet/slip_clsf_cd"));
						
						model.send("fc_acct_2031_l");

						if(submit_completed()){
							//fn_ColorChange();
							
							//fn_gridDataChange();
							/*
							if (datagrid1.rows > 0 && datagrid1.valueMatrix(1, 1) != ""){
								datagrid1.addRow();
								datagrid1.rowStatus(datagrid1.rows - 1) = 0;
								//datagrid2.row = datagrid1.selectedRow(0)
							}
							*/
							datagrid1.row = 1;
							//datagrid2.row = datagrid1.selectedRow(0)
						
							if (get_refvalue("/root/resData/gridData/dataSet/CURLIST/totalcnt") == 0) {
								show_message("검색결과가 없습니다.");
								return;
							}else{
								//debugger;
								slip_occr_dt.value	= get_refvalue("/root/resData/gridData/dataSet/CURLIST/record/slip_occr_dt");  
								slip_clsf_cd.value    = get_refvalue("/root/resData/gridData/dataSet/CURLIST/record/slip_clsf_cd");    
								slip_seq.value        = get_refvalue("/root/resData/gridData/dataSet/CURLIST/record/slip_seq");
								slip_arow_no.value    = "0";
								budg_yymm.value       = get_refvalue("/root/resData/gridData/dataSet/CURLIST/record/budg_yymm");
								clam_dept_cd.value    = get_refvalue("/root/resData/gridData/dataSet/CURLIST/record/clam_dept_cd");
								chrg_emp_no.value     = get_refvalue("/root/resData/gridData/dataSet/CURLIST/record/chrg_emp_no");
								chrg_emp_no_nm.value  = get_refvalue("/root/resData/gridData/dataSet/CURLIST/record/chrg_emp_no_nm");
								rmks.value            = get_refvalue("/root/resData/gridData/dataSet/CURLIST/record/rmks");
								clam_amt.value        = get_refvalue("/root/resData/gridData/dataSet/CURLIST/record/clam_amt");
								//incmg_pers.value  = get_refvalue("/root/resData/gridData/dataSet/CURLIST/record/hj_incmg_emp_no");
								//incmg_pers_nm.value = get_refvalue("/root/resData/gridData/dataSet/CURLIST/record/hj_incmg_emp_no_nm");
								//hj_slip_aprv_yn.value = get_refvalue("/root/redData/gridData/dataSet/CURLIST/record/hj_slip_aprv_yn");
								//debugger;
								if (get_refvalue("/root/resData/gridData/dataSet/CURLIST/record/hj_slip_aprv_yn") == "1") {
								    hj_slip_aprv_yn.value = "미승인";                  //전표승인여부
								}else{
								   hj_slip_aprv_yn.value = "승  인";
								}
														
								gvar_slip_occr_dt = srch_slip_occr_dt.value.ReplaceString("-", "");
								//gvar_slip_clsf_cd = "60";
								gvar_slip_clsf_cd = model.getValue("/root/initData/comboSet/dataSet/slip_clsf_cd");
								gvar_slip_seq = srch_slip_seq.value;
								
								model.refresh();								
							}
							datagrid_addrow(datagrid1,50);
							 btn_insert.disabled = true;
							 btn_update.disabled = false;
						}
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:554px; top:0px; width:54px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose();		
					]]>
				</script>
			</button>
			<button id="btn_row_delete" class="btn02" style="left:388px; top:0px; width:52px; height:21px; ">
				<caption>행삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					delete_row();
					]]>
				</script>
			</button>
			<button id="btn_row_insert" class="btn02" style="left:332px; top:0px; width:52px; height:21px; ">
				<caption>행삽입</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					insert_row();
					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" style="left:277px; top:0px; width:54px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[	// 초기화버튼 클릭시
						
						var strslip_occr_dt;
						strslip_occr_dt = get_refvalue("/root/reqData/searchData/slip_occr_dt");
						
						model.reset();		
						
						//fn_ColorChange();
						
						if (strslip_occr_dt.length == 8) {
							set_refvalue("/root/reqData/searchData/slip_occr_dt", strslip_occr_dt);
							srch_slip_occr_dt.refresh();
						}
						
						model.setFocus("srch_slip_occr_dt");
						
						for (i=1; i<datagrid1.rows; i++){
							datagrid1.rowStatus(i) = "1";
						}
						gvar_slip_occr_dt = "";
						gvar_slip_clsf_cd = "";
						gvar_slip_seq = "";
						
						 btn_insert.disabled = false;
						 btn_update.disabled = true;						
					]]>
				</script>
			</button>
			<button id="btn_print" class="btn02" crud="P" style="left:443px; top:0px; width:54px; height:21px; ">
				<caption>출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
//						// 오즈관련 노드 초기화..
//					 	resetOznode();
//					 	
//					 	// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅.
//					 	makeNodeValue("/root/oz_data/ozrName","fcmc/SP_FC_ACCT_1151_P")
//
//						// connection 파라미터 설정.					 	
//					 	makeNodeValue("/root/oz_data/conParam/sv_url","19110");
//					 	makeNodeValue("/root/oz_data/conParam/sv_uid");
//					 	makeNodeValue("/root/oz_data/conParam/sv_bonm");
//					 	makeNodeValue("/root/oz_data/conParam/uv_line");
//					 	makeNodeValue("/root/oz_data/conParam/uv_summary");
//					 	
//					 	// odi 파라미터 설정.
//					 	makeNodeValue("/root/oz_data/odiParam/iv_bocd","19110");
//					 	makeNodeValue("/root/oz_data/odiParam/iv_medicd","110");
//					 	makeNodeValue("/root/oz_data/odiParam/iv_dstccd");
//					 	makeNodeValue("/root/oz_data/odiParam/iv_frbno");
//					 	makeNodeValue("/root/oz_data/odiParam/iv_tobno");					 	
//					 	makeNodeValue("/root/oz_data/odiParam/iv_freecd");
//					 	makeNodeValue("/root/oz_data/odiParam/iv_dlvmth");
//					 	makeNodeValue("/root/oz_data/odiParam/iv_rdrnmyn");
//					 	makeNodeValue("/root/oz_data/odiParam/iv_rpttp");
//					 	makeNodeValue("/root/oz_data/odiParam/iv_remkyn");	
//
//						// 프린터로 직접출력할 경우에만 사용.. ( preview:미리보기,export:직접출력 )
//					 	makeNodeValue("/root/oz_data/preview","export"); 
//					 	
//					 	// 레포트뷰어 호출.
//					 	openOzwin("/root/oz_data");
//						//window.load("/common/xrw/oz_popup.xrw","modal","oz_popup","resize:false;width:987px;height:" + (window.height - 30) + "px;top:20px;left:100px;","/root/oz_data","/root/oz_data");

						// 글로벌변수 셋팅
						model.property("FC_ACCT_2060_slip_occr_dt")  = srch_slip_occr_dt.value;	// 발생일자
						model.property("FC_ACCT_2060_slip_seq") = srch_slip_seq.value;		// 일련번호
	
						// 화면호출
//						viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2060", "modal", "align:center; caption:hidden; width:650px; height:480px;");
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2060");	
					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" crud="C" style="left:56px; top:0px; width:52px; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[

						if (slip_occr_dt.value.ReplaceString("-", "").length != 8){
							show_message("전표번호[일자]는 잘못된 형식입니다.");
							model.setFocus("slip_occr_dt");
							return;
						}
					
						if (slip_clsf_cd.value.length != 2){
							show_message("전표번호[구분코드]는 필수입력항목입니다.");
							model.setFocus("slip_clsf_cd");
							return;
						}
						
						if (slip_seq.value.length != 0){
							show_message("전표번호[일련번호]는 입력할수 없습니다.");
							model.setFocus("slip_seq");
							return;
						}

						if (budg_yymm.value.ReplaceString("-", "").length != 6){
							show_message("예산년월는 필수입력항목입니다.");
							model.setFocus("budg_yymm");
							return;
						}
							
						if (clam_dept_cd.value.ReplaceString("-", "").length != 6){
							show_message("청구부서는 필수입력항목입니다.");
							model.setFocus("clam_dept_cd");
							return;
						}	

      						if (chrg_emp_no.value.ReplaceString("-", "").length != 6){
							show_message("담당자는 필수입력항목입니다.");
							model.setFocus("chrg_emp_no");
							return;
						}						
					
						if ((clam_amt.value == "") || (clam_amt.value == "0")){
							show_message("결의금액은 0보다 커야됩니다.");
							model.setFocus("clam_amt");
							return;
						}							

						var cnt = 0;
						var var_clam_amt = 0;
						
						for (i=1; i<datagrid1.rows; i++){
							var emp_no = datagrid1.valueMatrix(i, 2);
							var dest = datagrid1.valueMatrix(i, 5);
							var amt = datagrid1.valueMatrix(i, 6);

							if (emp_no == "" || dest == "" || amt == ""){
								datagrid1.rowStatus(i) = 0;
							}
							else {	
								//debugger;					
								if(datagrid1.rowStatus(i) == "3" || datagrid1.rowStatus(i) == "2" || datagrid1.rowStatus(i) == "1"){
									cnt = cnt+1;
								}
								
								if (datagrid1.valueMatrix(i,6) != ""){
									var_clam_amt = Number(var_clam_amt) + Number(datagrid1.valueMatrix(i,6));
								}
								

							}
						}
						
						clam_amt.value= Number(var_clam_amt);
						
						if(cnt ==0){
							show_message("사번, 행선지, 금액은 필수입력항목입니다.");
							change_status();
							return;
						}
						if (show_message("저장하시겠습니까?","저장 확인",MB_YESNO) != IDYES) {
							change_status();							
							return;
						}
//						var var_check_row = 0;
//					
//						for (i=1; i<datagrid1.rows; i++) {
//							var slip_arow_no = datagrid1.valueMatrix(i, 1);
//							
//							if (datagrid1.rowStatus(i) != 0) {
////								if (slip_arow_no != ""){
//									
//									var_check_row = var_check_row + 1;
//								
//									if (datagrid1.valueMatrix(i, 2).length != 6) {
//			  							show_message("사번을 정확히 입력하세요."+ i + ":" + datagrid1.valueMatrix(i, 2));
//										return;
//									}
//									
//									if (datagrid1.valueMatrix(i, 5).length < 2) {
//			  							show_message("행선지을 정확히 입력하세요.");
//										return;
//									}
//									
//									if (Number(datagrid1.valueMatrix(i, 6)) == 0) {
//			  						       show_message("금액을 정확히 입력하세요.");
//			  						       	return;
//									}
//								}else{
//									datagrid1.rowStatus(i) =0;
//								}
//
////							}
//						}
						
//						if (var_check_row == 0) {
//							show_message("저장할 자료가 존재하지 않습니다.");
//							return;							
//						}

						// 합계 display
						
//						if(show_message("등록하시겠습니까?", "알림", 4)  == 7){	return; }
						/*
						set_refvalue("/root/reqData/multiUpDate/inupd_flag", "I");
						set_refvalue("/root/reqData/multiUpDate/cmpy_cd", get_refvalue("/root/reqData/searchData/cmpy_cd"));
						set_refvalue("/root/reqData/multiUpDate/slip_occr_dt", get_refvalue("/root/reqData/searchData/slip_occr_dt"));
						set_refvalue("/root/reqData/multiUpDate/slip_clsf_cd", get_refvalue("/root/reqData/searchData/slip_clsf_cd"));
						set_refvalue("/root/reqData/multiUpDate/slip_seq", get_refvalue("/root/reqData/searchData/slip_seq"));
						set_refvalue("/root/reqData/multiUpDate/titl", get_refvalue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/titl"));
						set_refvalue("/root/reqData/multiUpDate/reso_amt", get_refvalue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/reso_amt"));
						set_refvalue("/root/reqData/multiUpDate/expn_hope_dt", get_refvalue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/expn_hope_dt"));
						set_refvalue("/root/reqData/multiUpDate/expn_clsf", get_refvalue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/expn_clsf"));
						set_refvalue("/root/reqData/multiUpDate/clam_dept_cd", get_refvalue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/clam_dept_cd"));
						set_refvalue("/root/reqData/multiUpDate/evnt_cd", get_refvalue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/evnt_cd"));
						set_refvalue("/root/reqData/multiUpDate/budg_yymm", get_refvalue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/budg_yymm"));
						set_refvalue("/root/reqData/multiUpDate/chrg_emp_no", get_refvalue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/chrg_emp_no"));
						set_refvalue("/root/reqData/multiUpDate/chg_pers", get_refvalue("/root/initData/session/chg_pers"));
						set_refvalue("/root/reqData/multiUpDate/incmg_pers_ipadd", get_refvalue("/root/initData/session/incmg_pers_ipadd"));
						*/
						
						set_refvalue("/root/reqData/reqform/multiUpdateData",  datagrid1.getUpdateData());
//						alert(get_refvalue("/root/reqData/multiUpDate/multiUpdateData"));

						model.refresh();

    						model.send("fc_acct_2032_i");
    						
						if(submit_completed()){
//							alert(get_refvalue("/root/resData/MsgData/slip_seq"));
    							srch_slip_seq.value = get_refvalue("/root/resData/MsgData/dataSet/slip_seq");
						       show_message("저장되었습니다.");
							btn_select.dispatch("onclick");
						}
						else{
							change_status();
							return;	
						}
					]]>
				</script>
			</button>
			<button id="button1" class="btn02" style="left:499px; top:0px; width:54px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}	
					]]>
				</script>
			</button>
		</group>
	</xhtml:body>
</xhtml:html>
