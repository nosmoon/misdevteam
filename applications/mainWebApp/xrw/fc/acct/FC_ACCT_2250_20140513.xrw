<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>일반전표등록(FC_ACCT_2250))</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session/>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
							<fc_acct_2250_m>
								<dataSet>
									<CURLIST1>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURLIST1>
									<xx_ss_cmpycd/>
									<xx_ss_emp_no/>
									<xx_srch_slip_clsf_cd/>
									<xx_srch_slip_clsf_cd_1/>
									<xx_srch_slip_clsf_cd_2/>
									<xx_srch_slip_clsf_cd_3/>
									<xx_ss_emp_no_010/>
									<xx_valuematrix/>
								</dataSet>
							</fc_acct_2250_m>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData/>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<cmpy_cd/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<slip_sub_seq/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqform/>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpDate/>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
						<fc_acct_2253_i>
							<cmpy_cd/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<slip_sub_seq/>
							<clam_dept_cd/>
							<incmg_emp_no/>
							<fisc_dt/>
							<incmg_pers/>
							<incmg_pers_ipadd/>
							<incmg_dt/>
							<multiUpdateData/>
						</fc_acct_2253_i>
						<fc_acct_2254_u>
							<cmpy_cd/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<slip_sub_seq/>
							<clam_dept_cd/>
							<incmg_emp_no/>
							<fisc_dt/>
							<incmg_pers/>
							<incmg_pers_ipadd/>
							<incmg_dt/>
							<reso_amt/>
							<reso_amt_ch/>
							<multiUpdateData/>
						</fc_acct_2254_u>
						<fc_acct_2255_d>
							<cmpy_cd/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<slip_sub_seq/>
							<incmg_pers/>
							<incmg_pers_ipadd/>
							<in_sicsgb/>
						</fc_acct_2255_d>
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resform>
							<dr_amt_sum/>
							<crdt_amt_sum/>
							<rmks1/>
						</resform>
						<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<gridData>
							<fc_acct_2251_l>
								<dataSet>
									<CURLIST>
										<record>
											<clam_dept_cd/>
											<pch_cgbuseonm/>
											<incmg_emp_no/>
											<pch_irjnm/>
											<incmg_dt/>
											<fisc_dt/>
											<reso_amt/>
											<reso_amt_ch/>
										</record>
									</CURLIST>
									<CURLIST1>
										<record>
											<slip_arow_no/>
											<budg_cd/>
											<pch_sdysnm/>
											<dr_amt/>
											<crdt_amt/>
											<rmks1/>
											<rmks2/>
											<drcr_clsf/>
											<dlco_clsf_cd/>
											<dlco_cd/>
											<dlco_nm/>
											<boks_dlco_nm/>
											<mang_clsf_cd/>
											<mang_no/>
											<incm_clsf_cd/>
											<medi_cd/>
											<dtls_medi_cd/>
											<evnt_cd/>
											<pch_hsnm/>
											<use_dept_cd/>
											<pch_buseonm/>
											<comp_dt/>
											<mtry_dt/>
											<bank_cd/>
											<pch_banknm/>
											<unit/>
											<qunt/>
											<obj_acct_cd/>
											<pch_dsacctnm/>
											<obj_dt/>
											<obj_amt/>
											<frcr_clsf_cd/>
											<frcr_amt/>
											<exrate/>
											<note_stat/>
											<intg_dlco_cd/>
											<prop_equip_cd/>
											<tax_stmt_no/>
											<make_dt/>
											<erplace_cd/>
											<ern/>
											<suply_amt/>
											<setoff_slip_no/>
											<occr_slip_clsf/>
											<occr_slip/>
										</record>
									</CURLIST1>
								</dataSet>
							</fc_acct_2251_l>
						</gridData>
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<keyData/>
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<fc_co_1101_l>
							<dataSet>
								<CURLIST1>
									<record>
										<cmpy_cd/>
										<dept_cd/>
										<dept_team_clsf/>
										<abrv_nm/>
										<offi_nm/>
										<dept_team_nm/>
										<part_nm/>
										<part_dn_nm/>
									</record>
								</CURLIST1>
							</dataSet>
						</fc_co_1101_l>
					</tempData>
					<!-- 저장소 -->
				</root>
			</instance>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<script type="javascript" src="/js/fcmc_common.js"/>
			<submission id="fc_acct_2250_m" action="/fc/acct2000/2250" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/initData/comboSet/fc_acct_2250_m/dataSet"/>
			<submission id="fc_acct_2251_l" action="/fc/acct2000/2251" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/fc_acct_2251_l/dataSet"/>
			<submission id="fc_acct_2253_i" action="/fc/acct2000/2253" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fc_acct_2253_i" resultref="/root/resData/MsgData"/>
			<submission id="fc_acct_2254_u" action="/fc/acct2000/2254" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fc_acct_2254_u" resultref="/root/resData/MsgData"/>
			<submission id="fc_acct_2255_d" action="/fc/acct2000/2255" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fc_acct_2255_d" resultref="/root/resData/MsgData"/>
			<submission id="fc_co_1101" action="/fc/co1000/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/fc_co_1101_l/dataSet"/>
			<submission id="hd_com_1002" action="/hd/com/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					init_controls();			// 컨트롤 초기화
					caption1.visible = false;
					caption12.visible = false;
					reso_amt.visible = false; 
					datagrid1.attribute("explorerbar") = "";
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				
					send_fc_acct_2250_m();	// 콤보 초기화
					init_setting();			// 기타 초기화
				]]>
			</script>
		</model>
		<script type="javascript">
			<![CDATA[
				var	_oth_clsf = "1";
				// key
				var gvar_slip_occr_dt = "";		// 입력일자
				var gvar_slip_clsf_cd = "";		// 전표구분
				var gvar_slip_seq = "";		// 일련번호
				var gvar_slip_sub_seq = "";	// SUBSEQ
			
				function init_controls() {
	
					//control의 기본 설정 적용
	
					//datagrid init
					set_default(
							datagrid1
					);
					//combo init
					set_default(
							srch_slip_clsf_cd			// 전표구분
					);
					//input init
					set_default(
							srch_slip_seq			       // 일련번호
						,	srch_slip_sub_seq			// SUBSEQ
						,	pch_cgbuseonm			// 청구부서명
						,	pch_irjnm					// 입력자사번명
						,	rmks1					// 제목
						,	dr_amt_sum				// 차변합계
						,	crdt_amt_sum				// 대변합계
						,	incmg_dt					// 입력일자
						,	reso_amt					// 결의금액
					);
					//input button init
					set_default(
							clam_dept_cd				// 청구부서
						,	incmg_emp_no				// 입력자사번
					);
					//input date init
					set_default(
							srch_slip_occr_dt			// 입력일자
						,	fisc_dt					// 회계일자
					);

					//control format 설정 적용
					set_format(
							"code"
						,	datagrid1			,"1,2,9,10,13,15,16,17,18,20,24,28,32,36,37"
						,	clam_dept_cd				// 청구부서
						,	incmg_emp_no				// 입력자사번
					);
					set_format(
							"number1_2"
						,	datagrid1			,"33"
					);
					set_format(
							"number1_4"
						,	datagrid1			,"34"
					);
					set_format(
							"number4"
						,	datagrid1			,"4,5,27,31"
						,	dr_amt_sum				// 차변합계
						,	crdt_amt_sum				// 대변합계
						,	reso_amt					// 결의금액
					);
					set_format(
							"date_1"
						,	datagrid1			,"22,23,30"
                                             ,	srch_slip_occr_dt			// 입력일자
                                             ,	fisc_dt					// 회계일자
					);
					set_format(
							"string_c"
						,	datagrid1			,"35,44"
						,	srch_slip_seq				// 일련번호
						,	srch_slip_sub_seq			// SUBSEQ
					);
					set_format(
							"string_l"
						,	datagrid1			,"3,6,7,11,12,14,19,21,25,26,29,44"
						,	srch_slip_clsf_cd			// 전표구분
						,	pch_cgbuseonm			// 청구부서명
						,	pch_irjnm					// 입력자사번명
						,	rmks1					// 제목
					);
				}
				
				var reso_amt_var;
				
				// 콤보 셋팅
				function send_fc_acct_2250_m() {
					
//					alert(getProperty("ss_cmpycd"));
					
					//입력값 설정
					set_refvalue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
					//실행
					model.send("fc_acct_2250_m");
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2250_m/dataSet/CURLIST1", "record", "cdabrvnm_cd", "cd")					
					//데이터 설정
					//전체항목 추가
					//makeComboGubun("A", "/root/initData/comboSet/fc_func_8000_m/CURLIST1", "record", "cdabrvnm_cd", "cd")
					
					//combobox refresh
					//srch_cntr_clsf_cd.refresh();
					//leas_hire_clsf_cd.refresh();
					
					model.refresh();
				}
				
				// 기타 초기화
				function init_setting() {
					srch_slip_occr_dt.value = commCurDate();	// 입력일자
					srch_slip_sub_seq.value = "0";				// SUBSEQ
					
					datagrid1.addRow(false);
					datagrid1.rowStatus(datagrid1.rows - 1) = 0;
					datagrid1.row = 1;	datagrid1.col= 1;
					
					model.setFocus("srch_slip_occr_dt");
				}
				
				// 그리드 컬럼 합계
				function fn_grid_sum_value (p_obj, p_col, t_obj) {
					if (typeof(p_obj) != DATA_TYPE_OBJECT) {
						return;
					}
					if (typeof(t_obj) != DATA_TYPE_OBJECT) {
						return;
					}
					
					var pobj = eval(p_obj);
					var pcol = eval(p_col);
					var tobj = eval(t_obj);
					
					var var_sum = 0;
					
					for (i=1;i<=pobj.rows;i++) {
						var_sum = var_sum + Number(pobj.valueMatrix(i, pcol));
					}
					
					t_obj.value = var_sum;
				}
				
				// 청구부서 popup
				function setDept_cd(iv_dept_cd, iv_dept_nm, iv_dept_team_clsf, iv_offi_nm, iv_dept_team_nm, iv_part_nm, iv_part_dn_nm){	
					model.setValue("/root/resData/gridData/fc_acct_2251_l/dataSet/CURLIST/record/clam_dept_cd", iv_dept_cd);
					model.setValue("/root/resData/gridData/fc_acct_2251_l/dataSet/CURLIST/record/pch_cgbuseonm", iv_dept_nm);
					clam_dept_cd.refresh();
					pch_cgbuseonm.refresh();
				}
				
				// 입력자사번 popup
				function setEmp_no(emp_no, nm_korn){
					incmg_emp_no.value = emp_no;		// 입력자사번
					pch_irjnm.value = nm_korn;			// 입력자사번명
				}

				var btnclickchk = "";				
				function onevent()
				{
					var evCtarg = event.currenttarget;
					var evTarg = event.target;
					if(evCtarg != evTarg) return;
					if(event.name != "DOMFocusOut" && event.name != "onbuttonclick" && event.name != "DOMFocusIn" &&event.name != "xforms-value-changed" && event.name != "onmousedown" && event.name != "onmouseup") return;
					
					var pID = event.pTarget.elementname;
					if (pID != "xforms:button" && pID != "xforms:input") return;
					
					var obj = document.all(evCtarg);
					
					if(obj.elementName == "xforms:input" && (evCtarg == "rmks1"))
					
					{
						model.addLog(event.name + " --> " + evCtarg);
						
						//onmousedown -> DOMFocusIn -> onmouseup -> xforms-value-changed -> DOMFocusOut 
						if(event.name == "onmousedown" )
						{
							body.attribute("inputClkChk") = "true";
						}
						if(event.name == "DOMFocusIn" )
						{
							body.attribute("inputClkChk") = "true";
						}
						if(event.name == "xforms-value-changed")
						{
							if( btnclickchk != "" )
							{
								body.attribute("value-changed-chk") = "true";
							}
						}
						if(event.name == "DOMFocusOut")
						{
							if(body.attribute("inputClkChk") == "true")
							{
								if(btnclickchk != "" && body.attribute("value-changed-chk") == "true")
								{
									document.all(btnclickchk).dispatch("onmouseup");
								}
							}
						}
					}
					
					if(obj.elementName == "xforms:button" && (evCtarg =="btn_insert" || evCtarg == "btn_update" || evCtarg == "btn_append"))
					{
						model.addLog(event.name + " --> " + evCtarg);
						
						//onmousedown -> DOMFocusIn -> onmouseup -> DOMFocusOut 
						if(event.name == "onmousedown" )
						{
							btnclickchk = evCtarg;
						}
						if(event.name == "onmouseup" )
						{
							btnclickchk = "";
						}
					}


				}				
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="1,10;2,10;1,873;1,878;1,933;1,937;2,29;2,40;2,40;2,121;2,129;2,50;2,136;" style="font-family:굴림; ">
		<group id="group_scr" class="gro_sel" style="left:10px; top:49px; width:926px; height:76px; ">
			<caption id="caption2" class="list_cap03" style="left:0px; top:0px; width:150px; height:26px; text-align:center; ">전표번호</caption>
			<caption id="caption3" class="list_cap02" style="left:149px; top:0px; width:310px; height:26px; text-align:center; "/>
			<input id="srch_slip_occr_dt" ref="/root/reqData/searchData/slip_occr_dt" class="req" navindex="0" inputtype="date" style="left:153px; top:4px; width:90px; height:18px; "/>
			<caption id="caption5" class="list_cap02" style="left:0px; top:25px; width:459px; height:51px; text-align:center; "/>
			<caption id="caption7" class="list_cap02" style="left:607px; top:50px; width:319px; height:26px; text-align:center; "/>
			<caption id="caption8" class="list_cap03" style="left:458px; top:0px; width:150px; height:26px; text-align:center; ">청구부서</caption>
			<caption id="caption9" class="list_cap02" style="left:607px; top:0px; width:319px; height:26px; text-align:center; "/>
			<caption id="caption10" class="list_cap03" style="left:458px; top:25px; width:150px; height:26px; text-align:center; ">입력자사번</caption>
			<caption id="caption11" class="list_cap02" style="left:607px; top:25px; width:319px; height:26px; text-align:center; "/>
			<input id="rmks1" ref="/root/resData/resform/rmks1" class="req" navindex="6" inputtype="input" style="left:611px; top:54px; width:311px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						for(var i=1; i<datagrid1.rows-1;i++){
							set_refvalue("/root/resData/gridData/fc_acct_2251_l/dataSet/CURLIST1/record["+i+"]/rmks1",rmks1.value);
						}
						datagrid1.refresh();					
					]]>
				</script>
			</input>
			<input id="srch_slip_seq" ref="/root/reqData/searchData/slip_seq" class="req" navindex="2" maxlength="3" style="left:379px; top:4px; width:30px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[										
						if (srch_slip_occr_dt.value.Trim().ReplaceString("-", "").length == 8
						&& srch_slip_clsf_cd.value != ""
						&& srch_slip_seq.value.Trim().ReplaceString("-", "").length == 3
						&& srch_slip_sub_seq.value.Trim().ReplaceString("-", "").length == 1 ){
							btn_select.dispatch("onclick");
						}

					]]>
				</script>
			</input>
			<caption id="caption4" class="list_cap03" style="left:458px; top:50px; width:150px; height:26px; text-align:center; ">제목</caption>
			<caption id="caption6" style="left:155px; top:28px; width:240px; height:18px; font-size:8pt; color:#ff00ff; text-align:center; ">(입력일자-전표구분-일련번호- SUB)</caption>
			<select1 id="srch_slip_clsf_cd" ref="/root/reqData/searchData/slip_clsf_cd" class="req" navindex="1" appearance="minimal" editmode="inputsearch" style="left:246px; top:4px; width:130px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2250_m/dataSet/CURLIST1/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(srch_slip_clsf_cd, srch_slip_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(srch_slip_clsf_cd,"");
							return;
						}					
					]]>
				</script>
			</select1>
			<input id="clam_dept_cd" ref="/root/resData/gridData/fc_acct_2251_l/dataSet/CURLIST/record/clam_dept_cd" class="req" navindex="4" inputtype="button" maxlength="6" style="left:611px; top:4px; width:90px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						
						var var_con_date = "";

						if (srch_slip_occr_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_slip_occr_dt.value.length;
							if(num_ch == 8){
								var_con_date = srch_slip_occr_dt.value;
							}else if(num_ch == 6){
								var_con_date = srch_slip_occr_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = srch_slip_occr_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "I");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					
						var var_con_date = "";

						if (srch_slip_occr_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_slip_occr_dt.value.length;
							if(num_ch == 8){
								var_con_date = srch_slip_occr_dt.value;
							}else if(num_ch == 6){
								var_con_date = srch_slip_occr_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = srch_slip_occr_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (clam_dept_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
//							model.setValue("/root/reqData/searchData/emp_no", "");
							model.setValue("/root/reqData/fwdData/dept_cd", clam_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "I");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								pch_cgbuseonm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								clam_dept_cd.value = "";
								pch_cgbuseonm.value = "";
							}
						}
						else {
							clam_dept_cd.value = "";
							pch_cgbuseonm.value = "";
						}	
						
					]]>
				</script>
			</input>
			<input id="incmg_emp_no" ref="/root/resData/gridData/fc_acct_2251_l/dataSet/CURLIST/record/incmg_emp_no" class="req" navindex="5" inputtype="button" maxlength="6" style="left:611px; top:29px; width:90px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (incmg_emp_no.value.length == 6) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/emp_no");
							model.setValue("/root/reqData/fwdData/emp_no", incmg_emp_no.value);
							model.send("hd_com_1002");
							
							if (model.getValue("/root/tempData/record/emp_no") != "") {
								pch_irjnm.value = model.getValue("/root/tempData/record/nm_korn");
							}
							else {
								incmg_emp_no.value = "";
								pch_irjnm.value = "";
							}
						}		
						else {
							incmg_emp_no.value = "";
							pch_irjnm.value = "";
						}
					]]>
				</script>
			</input>
			<input id="srch_slip_sub_seq" ref="/root/reqData/searchData/slip_sub_seq" class="req" navindex="3" maxlength="1" style="left:412px; top:4px; width:15px; height:18px; "/>
			<input id="pch_cgbuseonm" ref="/root/resData/gridData/fc_acct_2251_l/dataSet/CURLIST/record/pch_cgbuseonm" editable="false" style="left:704px; top:4px; width:218px; height:18px; "/>
			<input id="pch_irjnm" ref="/root/resData/gridData/fc_acct_2251_l/dataSet/CURLIST/record/pch_irjnm" editable="false" style="left:704px; top:29px; width:218px; height:18px; "/>
			<input id="incmg_dt" ref="/root/resData/gridData/fc_acct_2251_l/dataSet/CURLIST/record/incmg_dt" visibility="hidden" editable="false" style="left:0px; top:25px; width:90px; height:18px; "/>
			<caption id="caption1" class="list_cap03" style="left:0px; top:50px; width:150px; height:26px; text-align:center; ">결의금액</caption>
			<caption id="caption12" class="list_cap02" style="left:149px; top:50px; width:310px; height:26px; text-align:center; "/>
			<input id="reso_amt" ref="/root/resData/gridData/fc_acct_2251_l/dataSet/CURLIST/record/reso_amt" navindex="7" inputtype="input" caption="결의금액" style="left:153px; top:54px; width:187px; height:18px; "/>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:130px; width:926px; height:5px; "/>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/fc_acct_2251_l/dataSet/CURLIST1/record" caption="행번호^예산코드^예산코드명^차변금액^대변금액^적요1^적요2^차대구분^거래처구분^거래처코드^거래처명^부거래처명^관리구분^관리번호^소득구분^매체코드^상세매체^행사코드^행사명^사용부서^사용부서명^기산일^만기일^은행코드^은행명^단위^수량^대상코드^대상명^대상일자^대상금액^외화구분^외화금액^환율^어음상태^통합거래처^고정자산^잡수익^세금계산서^작성일자^사업장코드^공급자번호^상계전표^전사전표구분^전사전표번호^setoff_slip_occr_dt^setoff_slip_clsf_cd^setoff_slip_seq^setoff_slip_sub_seq^setoff_slip_arow_no^caption1^caption2" colsep="#" colwidth="50, 50, 150, 80, 80, 200, 200, 50, 80, 100, 150, 150, 100, 100, 100, 100, 100, 100, 100, 50, 100, 100, 100, 100, 100, 100, 30, 50, 100, 100, 80, 100, 80, 50, 50, 70, 50, 100, 150, 100, 100, 100, 150, 100, 150, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:10px; top:143px; width:926px; height:540px; ">
			<!-- 1.행번호          -->
			<col ref="slip_arow_no"/>
			<!-- 2.예산코드        -->
			<col ref="budg_cd"/>
			<!-- 3.예산코드명      -->
			<col ref="pch_sdysnm"/>
			<!-- 4.차변금액        -->
			<col ref="dr_amt"/>
			<!-- 5.대변금액        -->
			<col ref="crdt_amt"/>
			<!-- 6.적요1           -->
			<col ref="rmks1"/>
			<!-- 7.적요2           -->
			<col ref="rmks2"/>
			<!-- 8.차대구분        -->
			<col ref="drcr_clsf"/>
			<!-- 9.거래처구분코드  -->
			<col ref="dlco_clsf_cd"/>
			<!-- 10.거래처코드     -->
			<col ref="dlco_cd"/>
			<!-- 11.거래처명       -->
			<col ref="dlco_nm"/>
			<!-- 12.부거래처명     -->
			<col ref="boks_dlco_nm"/>
			<!-- 13.관리구분코드   -->
			<col ref="mang_clsf_cd"/>
			<!-- 14.관리번호       -->
			<col ref="mang_no"/>
			<!-- 15.소득구분코드   -->
			<col ref="incm_clsf_cd"/>
			<!-- 16.매체코드       -->
			<col ref="medi_cd"/>
			<!-- 17.상세매체코드   -->
			<col ref="dtls_medi_cd"/>
			<!-- 18.행사코드       -->
			<col ref="evnt_cd"/>
			<!-- 19.행사코드명     -->
			<col ref="pch_hsnm"/>
			<!-- 20.사용부서코드   -->
			<col ref="use_dept_cd"/>
			<!-- 21.사용부서코드명 -->
			<col ref="pch_buseonm"/>
			<!-- 22.기산일자       -->
			<col ref="comp_dt"/>
			<!-- 23.만기일자       -->
			<col ref="mtry_dt"/>
			<!-- 24.은행코드       -->
			<col ref="bank_cd"/>
			<!-- 25.은행코드명     -->
			<col ref="pch_banknm"/>
			<!-- 26.단위           -->
			<col ref="unit"/>
			<!-- 27.수량           -->
			<col ref="qunt"/>
			<!-- 28.대상계정코드   -->
			<col ref="obj_acct_cd"/>
			<!-- 29.대상계정코드명 -->
			<col ref="pch_dsacctnm"/>
			<!-- 30.대상일자       -->
			<col ref="obj_dt"/>
			<!-- 31.대상금액       -->
			<col ref="obj_amt"/>
			<!-- 32.외화구분코드   -->
			<col ref="frcr_clsf_cd"/>
			<!-- 33.외화금액       -->
			<col ref="frcr_amt"/>
			<!-- 34.환율           -->
			<col ref="exrate"/>
			<!-- 35.어음상태       -->
			<col ref="note_stat"/>
			<!-- 36.통합거래처코드 -->
			<col ref="intg_dlco_cd"/>
			<!-- 37.고정자산코드   -->
			<col ref="prop_equip_cd"/>
			<!-- 38.잡수익 -->
			<col ref="etc_in"/>
			<!-- 39.세금계산서번호 -->
			<col ref="tax_stmt_no" format="99-99-99999999-9999"/>
			<!-- 40.작성일자 -->
			<col ref="make_dt"/>
			<!-- 41.사업장코드 -->
			<col ref="erplace_cd"/>
			<!-- 42.공급자번호 -->
			<col ref="ern"/>
			<!-- 43.상계전표번호   -->
			<col ref="setoff_slip_no"/>
			<!-- 44.전사전표구분   -->
			<col ref="occr_slip_clsf"/>
			<!-- 45.전사전표번호   -->
			<col ref="occr_slip"/>
			<!-- 46.setoff_slip_occr_dt   -->
			<col ref="setoff_slip_occr_dt" visibility="hidden"/>
			<!-- 47.setoff_slip_clsf_cd   -->
			<col ref="setoff_slip_clsf_cd" visibility="hidden"/>
			<!-- 48.setoff_slip_seq   -->
			<col ref="setoff_slip_seq" visibility="hidden"/>
			<!-- 49.setoff_slip_sub_seq   -->
			<col ref="setoff_slip_sub_seq" visibility="hidden"/>
			<!-- 50.setoff_slip_arow_no   -->
			<col ref="setoff_slip_arow_no" visibility="hidden"/>
			<col ref="vat_amt" visibility="hidden"/>
			<col ref="suply_amt" visibility="hidden"/>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					//그리드 스크롤바 클릭, 더블클릭 방지 소스
					if (-1 != event.target.lastIndexOf("scroll.thumb")) {
						return;
					}
					
					if (datagrid1.mouseRow < 1) {
						return;
					}
					
					var grid = eval(event.currentTarget);
					var rowid = grid.row;
					var colid = grid.col;
					
					if (rowid < grid.fixedRows || colid < grid.fixedCols) {
						return;
					}				
					// 행번등록 팝업창 띄우기
					if ((datagrid1.mouseCol > 0) && (datagrid1.mouseCol < datagrid1.cols) && (datagrid1.mouseRow >= datagrid1.fixedRows))  {
						if(getProperty("ss_cmpycd") != "100"){
							window.load("./FC_ACCT_2290.xrw", "modal", "", "align:center; width:555; height:616; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;");
						}else{
							window.load("./FC_ACCT_2290.xrw", "modal", "", "align:center; width:555; height:537; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;");
						}
					}
				]]>
			</script>
		</datagrid>
		<group id="group1" class="gro_sel" style="left:10px; top:695px; width:926px; height:26px; ">
			<caption id="caption13" class="list_cap03" style="left:0px; top:0px; width:120px; height:26px; text-align:center; ">회계일자</caption>
			<caption id="caption15" class="list_cap02" style="left:119px; top:0px; width:190px; height:26px; text-align:center; "/>
			<input id="fisc_dt" ref="/root/resData/gridData/fc_acct_2251_l/dataSet/CURLIST/record/fisc_dt" class="req" navindex="8" inputtype="date" style="left:123px; top:4px; width:90px; height:18px; "/>
			<caption id="caption18" class="list_cap03" style="left:308px; top:0px; width:120px; height:26px; text-align:center; ">차변합계</caption>
			<caption id="caption19" class="list_cap02" style="left:427px; top:0px; width:190px; height:26px; text-align:center; "/>
			<caption id="caption24" class="list_cap03" style="left:616px; top:0px; width:120px; height:26px; text-align:center; ">대변합계</caption>
			<caption id="caption25" class="list_cap02" style="left:735px; top:0px; width:191px; height:26px; text-align:center; "/>
			<input id="dr_amt_sum" ref="/root/resData/resform/dr_amt_sum" editable="false" style="left:431px; top:4px; width:155px; height:18px; "/>
			<input id="crdt_amt_sum" ref="/root/resData/resform/crdt_amt_sum" editable="false" style="left:739px; top:4px; width:155px; height:18px; "/>
		</group>
		<group id="group_tit" class="gro_tit" style="left:0px; top:0px; width:946px; height:39px; ">
			<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:10px; width:926px; height:29px; "/>
		</group>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:734px; width:926px; height:21px; ">
			<button id="btn_select" class="btn02" navindex="9" crud="R" style="left:0px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
						// 필수 입력항목 Check
						if (srch_slip_occr_dt.value.Trim().ReplaceString("-", "").length != 8){
							show_message("전표번호[입력일자]는 필수입력사항입니다.");
							model.setFocus("srch_slip_occr_dt");
							return;
						}
						if (srch_slip_clsf_cd.value.Trim().ReplaceString("-", "").length != 2){
							show_message("전표번호[전표구분]는 필수입력사항입니다.");
							model.setFocus("srch_slip_clsf_cd");
							return;
						}
						if (srch_slip_seq.value.Trim().ReplaceString("-", "").length != 3){
							show_message("전표번호[일련번호]는 필수입력사항입니다.");
							model.setFocus("srch_slip_seq");
							return;
						}
						if (srch_slip_sub_seq.value.Trim().ReplaceString("-", "").length != 1){
							show_message("전표번호[SUBSEQ]는 필수입력사항입니다.");
							model.setFocus("srch_slip_sub_seq");
							return;
						}

						model.send("fc_acct_2251_l");
						
						if (model.getValue("/root/resData/gridData/fc_acct_2251_l/dataSet/CURLIST/totalcnt") == 0) {
							show_message("검색결과가 없습니다.");
							model.reset();
							caption1.visible = false;
							caption12.visible = false;
							reso_amt.visible = false; 
							control_unmark_req(reso_amt);
							return;
						}
						else {
							datagrid1.addRow(false);
							datagrid1.rowStatus(datagrid1.rows - 1) = 0;
							datagrid1.row = 1;	datagrid1.col= 1;

							rmks1.value = model.getValue("/root/resData/gridData/fc_acct_2251_l/dataSet/CURLIST1/record[1]/rmks1");
							
							//결의금액 추가--------------------------------start
							reso_amt_var = model.getValue("/root/resData/gridData/fc_acct_2251_l/dataSet/CURLIST/record[1]/reso_amt_ch");
							if(reso_amt_var == "Y"){
								caption1.visible = true;
								caption12.visible = true;
								reso_amt.visible = true; 
								control_mark_req(reso_amt);
							}else{
								caption1.visible = false;
								caption12.visible = false;
								reso_amt.visible = false; 
								control_unmark_req(reso_amt);
							}
							//결의금액 추가--------------------------------end

							fn_grid_sum_value(datagrid1, 4, dr_amt_sum);		// 차변합계
							fn_grid_sum_value(datagrid1, 5, crdt_amt_sum);	// 대변합계
							
							// key save
							gvar_slip_occr_dt = srch_slip_occr_dt.value.Trim().ReplaceString("-", "");		// 입력일자
							gvar_slip_clsf_cd = srch_slip_clsf_cd.value.Trim().ReplaceString("-", "");		// 전표구분
							gvar_slip_seq = srch_slip_seq.value.Trim().ReplaceString("-", "");			// 일련번호
							gvar_slip_sub_seq = srch_slip_sub_seq.value.Trim().ReplaceString("-", "");	// SUBSEQ
							
							var var_ref = datagrid1.colRef("vat_amt");
							var orgStr = model.getValue("/root/initData/comboSet/fc_acct_2250_m/dataSet/xx_valuematrix");
							for (i=1; i<datagrid1.rows - 1; i++) {
								//if(getProperty("ss_cmpycd") != "100" && (datagrid1.valueMatrix(i,2) == "182000" || datagrid1.valueMatrix(i,2) == "462000")){ //2012.01.11
								if(getProperty("ss_cmpycd") != "100" && instr_yn(orgStr, datagrid1.valueMatrix(i,2))){									
									datagrid1.valueMatrix(i, var_ref) = Number(datagrid1.valueMatrix(i,4)) +Number(datagrid1.valueMatrix(i,5));
								}
							}
						}
					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" navindex="10" crud="C" style="left:54px; top:0px; width:52px; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[

						if (!check_reqItem(srch_slip_clsf_cd,"trim","focus","전표구분코드는 필수입력항목입니다.")) { return; }     

						// 백승민, 박지원
						//if(getProperty("ss_cmpycd") == "100" || getProperty("ss_cmpycd") == "332"){ //2012.01.11
						var orgStr1 = model.getValue("/root/initData/comboSet/fc_acct_2250_m/dataSet/xx_ss_cmpycd");
						if(instr_yn(orgStr1, getProperty("ss_cmpycd"))){						
							//if ( getProperty("ss_emp_no") == "194030" || getProperty("ss_emp_no") == "194082"  || getProperty("ss_emp_no") == "210006" || getProperty("ss_emp_no") == "it0000" || getProperty("ss_emp_no") == "196024" ) { //2012.01.11
							var orgStr2 = model.getValue("/root/initData/comboSet/fc_acct_2250_m/dataSet/xx_ss_emp_no");
							if(instr_yn(orgStr2, getProperty("ss_emp_no"))){
								
							}else{
								//if (srch_slip_clsf_cd.value == "54" && getProperty("ss_emp_no") == "202036") { //2012.01.11
								var orgStr3 = model.getValue("/root/initData/comboSet/fc_acct_2250_m/dataSet/xx_srch_slip_clsf_cd_1");
								var orgStr4 = model.getValue("/root/initData/comboSet/fc_acct_2250_m/dataSet/xx_ss_emp_no_010");
								if(instr_yn(orgStr3, srch_slip_clsf_cd.value) && instr_yn(orgStr4, getProperty("ss_emp_no")) ) {
									
								}
								//if (srch_slip_clsf_cd.value != "90" && srch_slip_clsf_cd.value != "95") {  //2012.01.11
								var orgStr5 = model.getValue("/root/initData/comboSet/fc_acct_2250_m/dataSet/xx_srch_slip_clsf_cd_2");
								var orgStr6 = model.getValue("/root/initData/comboSet/fc_acct_2250_m/dataSet/xx_srch_slip_clsf_cd_3");																
								if(! instr_yn(orgStr5, srch_slip_clsf_cd.value) && ! instr_yn(orgStr6, srch_slip_clsf_cd.value)){
									show_message("수정할 수 없는 전표구분코드 입니다.('90,'95'만 입력)");
									model.setFocus("srch_slip_clsf_cd");
									return;								
								}
							}
						}
/*
						if(getProperty("ss_cmpycd") == "332"){
							if ( getProperty("ss_emp_no") == "196024" || getProperty("ss_emp_no") == "it0000") {
								
							}
							else {
								if (srch_slip_clsf_cd.value == "54" && getProperty("ss_emp_no") == "202036") {
									//
								}
								if (srch_slip_clsf_cd.value != "90" && srch_slip_clsf_cd.value != "95") {
									show_message("수정할 수 없는 전표구분코드 입니다.('90,'95'만 입력)");
									model.setFocus("srch_slip_clsf_cd");
									return;								
								}
							}
						}
*/
						if (srch_slip_seq.value.Trim() != "") {
							show_message("일련번호를 지워주세요.");
							model.setFocus("srch_slip_seq");
							return;
						}
						

						if (!check_reqItem(clam_dept_cd,"trim","focus","청구부서는 필수입력항목입니다.")) { return; }     
						if (!check_reqItem(incmg_emp_no,"trim","focus","입력자사번은 필수입력항목입니다.")) { return; }     
						
						if (fisc_dt.value.ReplaceString("-", "").length != 8){
							show_message("회계일자는 잘못된 형식입니다.");
							model.setFocus("fisc_dt");
							return;
						}
						
						fn_grid_sum_value(datagrid1, 4, dr_amt_sum);		// 차변합계
						fn_grid_sum_value(datagrid1, 5, crdt_amt_sum);	// 대변합계
						
						if (Number(dr_amt_sum.value) != Number(crdt_amt_sum.value)) {
							show_message("차대변 금액이 일치하지 않습니다.");
							return;	
						}
						
						if(model1.alert("등록하시겠습니까?", "알림", 4)  == 7){	return; }
						
						for (i=1; i<datagrid1.rows - 1; i++) {
							datagrid1.rowStatus(i) = "3";
						}
						
						model.setValue("/root/reqData/fc_acct_2253_i/cmpy_cd", getProperty("ss_cmpycd"));
						model.setValue("/root/reqData/fc_acct_2253_i/slip_occr_dt", srch_slip_occr_dt.value);
						model.setValue("/root/reqData/fc_acct_2253_i/slip_clsf_cd", srch_slip_clsf_cd.value);
						model.setValue("/root/reqData/fc_acct_2253_i/slip_seq", srch_slip_seq.value);
						model.setValue("/root/reqData/fc_acct_2253_i/slip_sub_seq", srch_slip_sub_seq.value);
						model.setValue("/root/reqData/fc_acct_2253_i/clam_dept_cd", clam_dept_cd.value);
						model.setValue("/root/reqData/fc_acct_2253_i/incmg_emp_no", incmg_emp_no.value);
						model.setValue("/root/reqData/fc_acct_2253_i/fisc_dt", fisc_dt.value);
						model.setValue("/root/reqData/fc_acct_2253_i/incmg_pers", getProperty("ss_emp_no"));
						model.setValue("/root/reqData/fc_acct_2253_i/incmg_pers_ipadd", "");
						model.setValue("/root/reqData/fc_acct_2253_i/incmg_dt", srch_slip_occr_dt.value);
						
//						for (i=1; i<datagrid1.rows - 1; i++) {
//							datagrid1.valueMatrix(i, 6) = rmks1.value;
//							datagrid1.valueMatrix(i, 42) = datagrid1.valueMatrix(i, 39).Trim().ReplaceString("-", "").substring(0, 8);
//							datagrid1.valueMatrix(i, 43) = datagrid1.valueMatrix(i, 39).Trim().ReplaceString("-", "").substring(8, 10);
//							datagrid1.valueMatrix(i, 44) = datagrid1.valueMatrix(i, 39).Trim().ReplaceString("-", "").substring(10, 13);
//							datagrid1.valueMatrix(i, 45) = datagrid1.valueMatrix(i, 39).Trim().ReplaceString("-", "").substring(13, 14);
//							datagrid1.valueMatrix(i, 46) = datagrid1.valueMatrix(i, 39).Trim().ReplaceString("-", "").substring(14, 20);
//						}

						for (i=1; i<datagrid1.rows - 1; i++) {
							datagrid1.valueMatrix(i, 46) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(0, 8);
							datagrid1.valueMatrix(i, 47) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(8, 10);
							datagrid1.valueMatrix(i, 48) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(10, 13);
							datagrid1.valueMatrix(i, 49) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(13, 14);
							datagrid1.valueMatrix(i, 50) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(14, 20);
							//alert(datagrid1.valueMatrix(i,28) + "::" + datagrid1.valueMatrix(i,13));
							if((datagrid1.valueMatrix(i,28) == "320500") && (datagrid1.valueMatrix(i,13) == "")) {
								show_message("선급제세(부가세) 계정의 대상계정이 건설중인자산일 경우 관리구분을 반드시 입력하여야 합니다.");
								return;	
							}							
						}
/*						
			<!-- 43.상계전표번호   -->
			<col ref="setoff_slip_no"/>
			<!-- 44.전사전표구분   -->
			<col ref="occr_slip_clsf"/>
			<!-- 45.전사전표번호   -->
			<col ref="occr_slip"/>
			<!-- 46.setoff_slip_occr_dt   -->
			<col ref="setoff_slip_occr_dt" visibility="hidden"/>
			<!-- 47.setoff_slip_clsf_cd   -->
			<col ref="setoff_slip_clsf_cd" visibility="hidden"/>
			<!-- 48.setoff_slip_seq   -->
			<col ref="setoff_slip_seq" visibility="hidden"/>
			<!-- 49.setoff_slip_sub_seq   -->
			<col ref="setoff_slip_sub_seq" visibility="hidden"/>
			<!-- 50.setoff_slip_arow_no   -->
			<col ref="setoff_slip_arow_no" visibility="hidden"/>
*/									
						model.setValue("/root/reqData/fc_acct_2253_i/multiUpdateData",datagrid1.getUpdateData("insert"));
						
						model.refresh();
						
    					model.send("fc_acct_2253_i");
    						
						if(submit_completed()){
    						srch_slip_seq.value = model.getValue("/root/resData/dataSet/slip_seq");
						    show_message("저장되었습니다.");
							btn_select.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="btn_update" class="btn02" navindex="11" crud="U" style="left:108px; top:0px; width:52px; height:21px; ">
				<caption>수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						// KEY 변경시 작업불가
						if (gvar_slip_occr_dt != srch_slip_occr_dt.value.Trim().ReplaceString("-", "")
						|| gvar_slip_clsf_cd != srch_slip_clsf_cd.value.Trim().ReplaceString("-", "")
						|| gvar_slip_seq != srch_slip_seq.value.Trim().ReplaceString("-", "")
						|| gvar_slip_sub_seq != srch_slip_sub_seq.value.Trim().ReplaceString("-", "")	) {
							show_message("키가 변경되어서 수정할 수 없는 자료입니다. 다시 조회해 주십시오.");
							model.setFocus("btn_select");
							return;
						}
						
						//if(getProperty("ss_cmpycd") == "100" || getProperty("ss_cmpycd") == "332"){ //2012.01.11
						var orgStr1 = model.getValue("/root/initData/comboSet/fc_acct_2250_m/dataSet/xx_ss_cmpycd");
						if(instr_yn(orgStr1, getProperty("ss_cmpycd"))){	
							// 백승민, 박지원
							//if (getProperty("ss_emp_no") == "194030" || getProperty("ss_emp_no") == "194082" || getProperty("ss_emp_no") == "210006" || getProperty("ss_emp_no") == "it0000" || getProperty("ss_emp_no") == "196024" ) { //2012.01.11
							var orgStr2 = model.getValue("/root/initData/comboSet/fc_acct_2250_m/dataSet/xx_ss_emp_no");							
							if(instr_yn(orgStr2, getProperty("ss_emp_no"))){							
								// 
							}
							else {
								//if (srch_slip_clsf_cd.value != "90" && srch_slip_clsf_cd.value != "95") { //2012.01.11
								var orgStr3 = model.getValue("/root/initData/comboSet/fc_acct_2250_m/dataSet/xx_srch_slip_clsf_cd_2");
								var orgStr4 = model.getValue("/root/initData/comboSet/fc_acct_2250_m/dataSet/xx_srch_slip_clsf_cd_3");
								if(! instr_yn(orgStr3, srch_slip_clsf_cd.value) && ! instr_yn(orgStr4, srch_slip_clsf_cd.value)){
									show_message("수정할 수 없는 전표구분코드 입니다.('90,'95'만 입력)");
									model.setFocus("srch_slip_clsf_cd");
									return;								
								}
							}
						}
						
						if (!check_reqItem(srch_slip_clsf_cd,"trim","focus","전표구분코드는 필수입력항목입니다.")) { return; }     
						if (!check_reqItem(clam_dept_cd,"trim","focus","청구부서는 필수입력항목입니다.")) { return; }     
						if (!check_reqItem(incmg_emp_no,"trim","focus","입력자사번은 필수입력항목입니다.")) { return; }     
						
						fn_grid_sum_value(datagrid1, 4, dr_amt_sum);		// 차변합계
						fn_grid_sum_value(datagrid1, 5, crdt_amt_sum);	// 대변합계
						
						if (Number(dr_amt_sum.value) != Number(crdt_amt_sum.value)) {
							show_message("차대변 금액이 일치하지 않습니다.");
							return;	
						}
						
						if(model1.alert("수정하시겠습니까?", "알림", 4)  == 7){	return; }
						
						for (i=1; i<datagrid1.rows - 1; i++) {
							datagrid1.rowStatus(i) = "3";
						}
						
						model.setValue("/root/reqData/fc_acct_2254_u/cmpy_cd", getProperty("ss_cmpycd"));
						model.setValue("/root/reqData/fc_acct_2254_u/slip_occr_dt", srch_slip_occr_dt.value);
						model.setValue("/root/reqData/fc_acct_2254_u/slip_clsf_cd", srch_slip_clsf_cd.value);
						model.setValue("/root/reqData/fc_acct_2254_u/slip_seq", srch_slip_seq.value);
						model.setValue("/root/reqData/fc_acct_2254_u/slip_sub_seq", srch_slip_sub_seq.value);
						model.setValue("/root/reqData/fc_acct_2254_u/clam_dept_cd", clam_dept_cd.value);
						model.setValue("/root/reqData/fc_acct_2254_u/incmg_emp_no", incmg_emp_no.value);
						model.setValue("/root/reqData/fc_acct_2254_u/fisc_dt", fisc_dt.value);
						model.setValue("/root/reqData/fc_acct_2254_u/incmg_pers", getProperty("ss_emp_no"));
						model.setValue("/root/reqData/fc_acct_2254_u/incmg_pers_ipadd", "");
						model.setValue("/root/reqData/fc_acct_2254_u/incmg_dt", incmg_dt.value);
						model.setValue("/root/reqData/fc_acct_2254_u/reso_amt", reso_amt.value);
						model.setValue("/root/reqData/fc_acct_2254_u/reso_amt_ch", reso_amt_var);
						
						for (i=1; i<datagrid1.rows - 1; i++) {
							datagrid1.valueMatrix(i, 46) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(0, 8);
							datagrid1.valueMatrix(i, 47) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(8, 10);
							datagrid1.valueMatrix(i, 48) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(10, 13);
							datagrid1.valueMatrix(i, 49) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(13, 14);
							datagrid1.valueMatrix(i, 50) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(14, 20);
							//alert(datagrid1.valueMatrix(i,28) + "::" + datagrid1.valueMatrix(i,13));
							if((datagrid1.valueMatrix(i,28) == "320500") && (datagrid1.valueMatrix(i,13) == "")) {
								show_message("선급제세(부가세) 계정의 대상계정이 건설중인자산일 경우 관리구분을 반드시 입력하여야 합니다.");
								return;	
							}
						}
												
//						for (i=1; i<datagrid1.rows - 1; i++) {
//							datagrid1.valueMatrix(i, 6) = rmks1.value;
//							datagrid1.valueMatrix(i, 42) = datagrid1.valueMatrix(i, 39).Trim().ReplaceString("-", "").substring(0, 8);
//							datagrid1.valueMatrix(i, 43) = datagrid1.valueMatrix(i, 39).Trim().ReplaceString("-", "").substring(8, 10);
//							datagrid1.valueMatrix(i, 44) = datagrid1.valueMatrix(i, 39).Trim().ReplaceString("-", "").substring(10, 13);
//							datagrid1.valueMatrix(i, 45) = datagrid1.valueMatrix(i, 39).Trim().ReplaceString("-", "").substring(13, 14);
//							datagrid1.valueMatrix(i, 46) = datagrid1.valueMatrix(i, 39).Trim().ReplaceString("-", "").substring(14, 20);
//						}

			
						
						
						
						model.setValue("/root/reqData/fc_acct_2254_u/multiUpdateData",datagrid1.getUpdateData("insert"));
						
						model.refresh();
						
    						model.send("fc_acct_2254_u");
    						
						if(submit_completed()){
						       show_message("수정되었습니다.");
							btn_select.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="btn_delete" class="btn02" navindex="12" crud="D" style="left:162px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						// KEY 변경시 작업불가
						if (gvar_slip_occr_dt != srch_slip_occr_dt.value.Trim().ReplaceString("-", "")
						|| gvar_slip_clsf_cd != srch_slip_clsf_cd.value.Trim().ReplaceString("-", "")
						|| gvar_slip_seq != srch_slip_seq.value.Trim().ReplaceString("-", "")
						|| gvar_slip_sub_seq != srch_slip_sub_seq.value.Trim().ReplaceString("-", "")	) {
							show_message("키가 변경되어서 삭제할 수 없는 자료입니다. 다시 조회해 주십시오.");
							model.setFocus("btn_select");
							return;
						}
						
						if (srch_slip_occr_dt.value.ReplaceString("-", "").length != 8){
							show_message("전표번호[입력일자]는 잘못된 형식입니다.");
							model.setFocus("srch_slip_occr_dt");
							return;
						}

						if (srch_slip_clsf_cd.value.ReplaceString("-", "").length != 2){
							show_message("전표번호[전표구분]는 필수입력항목입니다.");
							model.setFocus("srch_slip_clsf_cd");
							return;
						}
						
						if (srch_slip_seq.value.ReplaceString("-", "").length != 3){
							show_message("전표번호[순번]는 필수입력항목입니다.");
							model.setFocus("srch_slip_seq");
							return;
						}
						
						if (srch_slip_sub_seq.value.ReplaceString("-", "").length != 1){
							show_message("전표번호[SUBSEQ]는 필수입력항목입니다.");
							model.setFocus("srch_slip_sub_seq");
							return;
						}

						// 김경훈, 박지원
						//if(getProperty("ss_cmpycd") == "100" || getProperty("ss_cmpycd") == "332"){ //2012.01.11
						var orgStr1 = model.getValue("/root/initData/comboSet/fc_acct_2250_m/dataSet/xx_ss_cmpycd");
						if(instr_yn(orgStr1, getProperty("ss_cmpycd"))){	
							//if (getProperty("ss_emp_no") == "194030" || getProperty("ss_emp_no") == "194082" || getProperty("ss_emp_no") == "210006" || getProperty("ss_emp_no") == "196024" ){ //2012.01.11
							var orgStr2 = model.getValue("/root/initData/comboSet/fc_acct_2250_m/dataSet/xx_ss_emp_no");							
							if(instr_yn(orgStr2, getProperty("ss_emp_no"))){									
								// 
							}
							else {
								//if (srch_slip_clsf_cd.value != "90" && srch_slip_clsf_cd.value != "95") { //2012.01.11
								var orgStr3 = model.getValue("/root/initData/comboSet/fc_acct_2250_m/dataSet/xx_srch_slip_clsf_cd_2");
								var orgStr4 = model.getValue("/root/initData/comboSet/fc_acct_2250_m/dataSet/xx_srch_slip_clsf_cd_3");
								if(! instr_yn(orgStr3, srch_slip_clsf_cd.value) && ! instr_yn(orgStr4, srch_slip_clsf_cd.value)){	
									show_message("삭제할 수 없는 전표구분코드 입니다.('90,'95'만 입력)");
									model.setFocus("srch_slip_clsf_cd");
									return;								
								}
							}
						}

						if(model1.alert("삭제하시겠습니까?", "알림", 4)  == 7){	return; }

						model.setValue("/root/reqData/fc_acct_2255_d/cmpy_cd", getProperty("ss_cmpycd"));
						model.setValue("/root/reqData/fc_acct_2255_d/slip_occr_dt", srch_slip_occr_dt.value);
						model.setValue("/root/reqData/fc_acct_2255_d/slip_clsf_cd", srch_slip_clsf_cd.value);
						model.setValue("/root/reqData/fc_acct_2255_d/slip_seq", srch_slip_seq.value);
						model.setValue("/root/reqData/fc_acct_2255_d/slip_sub_seq", srch_slip_sub_seq.value);
						model.setValue("/root/reqData/fc_acct_2255_d/incmg_pers", getProperty("ss_emp_no"));
						model.setValue("/root/reqData/fc_acct_2255_d/incmg_pers_ipadd", "");
						model.setValue("/root/reqData/fc_acct_2255_d/in_sicsgb", "C");
						
						for (i=1; i<datagrid1.rows - 1; i++) {
							datagrid1.valueMatrix(i, 46) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(0, 8);
							datagrid1.valueMatrix(i, 47) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(8, 10);
							datagrid1.valueMatrix(i, 48) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(10, 13);
							datagrid1.valueMatrix(i, 49) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(13, 14);
							datagrid1.valueMatrix(i, 50) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(14, 20);
						}
												
    						model.send("fc_acct_2255_d");
    						
						if(submit_completed()){
    							model.reset();
							show_message("삭제되었습니다.");
						}
					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" navindex="13" style="left:216px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.reset();	// 초기화
						model.setFocus("srch_slip_occr_dt");
					]]>
				</script>
			</button>
			<button id="btn_insert_row" class="btn02" navindex="14" crud="P" style="left:270px; top:0px; width:52px; height:21px; ">
				<caption>행번등록</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						// 행번등록 팝업창 띄우기
						model.setFocus("datagrid1");
						if (datagrid1.col > 0 && datagrid1.col < datagrid1.cols && datagrid1.row > 0)  {
							if(getProperty("ss_cmpycd") != "100"){
								window.load("./FC_ACCT_2290.xrw", "modal", "", "align:center; width:555; height:616; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;");
							}else{
								window.load("./FC_ACCT_2290.xrw", "modal", "", "align:center; width:555; height:537; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;");
							}
						}
					]]>
				</script>
			</button>
			<button id="btn_copy" class="btn02" navindex="15" crud="R" style="left:324px; top:0px; width:51px; height:21px; ">
				<caption>복사</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						// KEY 변경시 작업불가
						if (gvar_slip_occr_dt != srch_slip_occr_dt.value.Trim().ReplaceString("-", "")
						|| gvar_slip_clsf_cd != srch_slip_clsf_cd.value.Trim().ReplaceString("-", "")
						|| gvar_slip_seq != srch_slip_seq.value.Trim().ReplaceString("-", "")	) {
							show_message("복사할 수 없는 자료입니다.");
							return;
						}
						
						srch_slip_seq.value = "";
						
						datagrid1.clearStatus();
						
						for (i=1; i<datagrid1.rows - 1; i++) {
							datagrid1.rowStatus(i) = "3";
						}
						
						show_message("복사가 정상적으로 실행되었습니다.");
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" navindex="19" crud="R" style="left:489px; top:0px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" navindex="20" style="left:543px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose();		
					]]>
				</script>
			</button>
			<button id="btn_update_slip" class="btn02" navindex="17" crud="R" style="left:379px; top:0px; width:51px; height:21px; ">
				<caption>수정전표</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						// KEY 변경시 작업불가
						if (gvar_slip_occr_dt != srch_slip_occr_dt.value.Trim().ReplaceString("-", "")
						|| gvar_slip_clsf_cd != srch_slip_clsf_cd.value.Trim().ReplaceString("-", "")
						|| gvar_slip_seq != srch_slip_seq.value.Trim().ReplaceString("-", "")	) {
							show_message("수정전표 처리 할 수 없는 자료입니다.");
							return;
						}
						
						srch_slip_seq.value = "";
						
						for (i=1;i<datagrid1.rows -1;i++) {
							datagrid1.valueMatrix(i, 4) = Number(datagrid1.valueMatrix(i, 4)) * -1;
							datagrid1.valueMatrix(i, 5) = Number(datagrid1.valueMatrix(i, 5)) * -1;
						}

						datagrid1.clearStatus();
						
						for (i=1; i<datagrid1.rows - 1; i++) {
							datagrid1.rowStatus(i) = "3";
						}
						
						show_message("수정전표가 정상적으로 실행되었습니다.");
					]]>
				</script>
			</button>
			<button id="btn_slip_print" class="btn02" navindex="16" crud="P" style="left:434px; top:0px; width:51px; height:21px; ">
				<caption>전표발행</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						// 글로벌변수 셋팅
						model.property("FC_ACCT_2260_slip_occr_dt")  = srch_slip_occr_dt.value;			// 발생일자
						model.property("FC_ACCT_2260_slip_clsf_cd")  = srch_slip_clsf_cd.value;			// 전표구분
						model.property("FC_ACCT_2260_slip_seqfr") = srch_slip_seq.value;			// 일련번호 from
						model.property("FC_ACCT_2260_slip_seqto") = srch_slip_seq.value;			// 일련번호 to
						model.property("FC_ACCT_2260_slip_radio1") = "";			// 출력구분
						model.property("FC_ACCT_2260_popup_flag") ="Y";
						
						// 화면호출
//						viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2260", "modal", "align:center; caption:hidden; width:650px; height:480px;");
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2260");	
					]]>
				</script>
			</button>
		</group>
	</xhtml:body>
</xhtml:html>
