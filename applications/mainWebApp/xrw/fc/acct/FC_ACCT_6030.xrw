<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>부가세전산매체생성(FC_ACCT_6030)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session/>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
							<fc_acct_6030_m>
								<dataSet>
									<CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_6030_m>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData/>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqForm>
							<erplace_cd1/>
							<erplace_cd/>
							<fr_slip_occr_mm/>
							<to_slip_occr_mm/>
							<gssgb1>1</gssgb1>
							<fr_slip_occr_dt/>
							<to_slip_occr_dt/>
							<check/>
							<jobgb/>
							<clsf_cd/>
							<fileh/>
							<filei/>
							<year/>
							<bungi/>
							<std_dt/>
						</reqForm>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpDate>
						</multiUpDate>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resForm>
							<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
							<fc_acct_6032_l>
								<dataSet>
									<CURLIST>
										<record>
											<nul/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_6032_l>
							<fc_acct_6033_l>
								<dataSet>
									<CURLIST>
										<record>
											<erplace_cd/>
											<ernm/>
											<ern/>
											<presi_nm/>
											<erplace_addr/>
											<erplace_bizcond/>
											<erplace_item/>
											<taxoff/>
											<corp_reg_no/>
											<intg_dlco_cd/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_6033_l>
							<fc_acct_6034_l>
								<dataSet>
									<CURLIST>
										<record>
											<bill_sender/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_6034_l>
							<fc_acct_6035_s>
								<dataSet>
									<CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_6035_s>
							<fc_co_8070_s>
								<dataSet>
									<CURLIST>
										<record>
											<ern/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_co_8070_s>
							<fc_acct_6031_i>
								<mkFlag1/>
								<mkFlag2/>
								<mkFlag3/>
								<mkFlag4/>
								<mkFlag5/>
								<mkFlag6/>
							</fc_acct_6031_i>
							<gridData1>
								<record>
									<data_cls/>
									<ern/>
									<firmnm/>
									<presi_nm/>
									<addr/>
									<bizcond/>
									<item/>
									<deal_prd/>
									<make_dt/>
									<nul/>
								</record>
							</gridData1>
							<gridData2>
								<record>
									<select/>
									<data_clsf/>
									<suply_pers_reg_no/>
									<seq/>
									<rec_suply_reg_no/>
									<firmnm/>
									<bizcond/>
									<item/>
									<nosh/>
									<deal_cnt/>
									<suply_amt/>
									<vat_amt/>
									<whosal_cd/>
									<retail_cd/>
									<vol_no/>
									<subm_paper/>
									<nul/>
								</record>
							</gridData2>
							<gridData3>
								<record>
									<data_clsf/>
									<suply_pers_reg_no/>
									<sale_dlco_cnt1/>
									<nosh1/>
									<suply_amt1/>
									<vat_amt1/>
									<sale_dlco_cnt2/>
									<nosh2/>
									<suply_amt2/>
									<vat_amt2/>
									<sale_dlco_cnt3/>
									<nosh3/>
									<suply_amt3/>
									<vat_amt3/>
									<nul/>
								</record>
							</gridData3>
							<gridData4>
								<record>
									<select/>
									<data_clsf/>
									<suply_pers_reg_no/>
									<seq/>
									<rec_suply_reg_no/>
									<firmnm/>
									<bizcond/>
									<item/>
									<nosh/>
									<deal_cnt/>
									<suply_amt/>
									<vat_amt/>
									<whosal_cd/>
									<retail_cd/>
									<vol_no/>
									<subm_paper/>
									<nul/>
								</record>
							</gridData4>
							<gridData5>
								<record>
									<data_clsf/>
									<suply_pers_reg_no/>
									<sale_dlco_cnt1/>
									<nosh1/>
									<suply_amt1/>
									<vat_amt1/>
									<sale_dlco_cnt2/>
									<nosh2/>
									<suply_amt2/>
									<vat_amt2/>
									<sale_dlco_cnt3/>
									<nosh3/>
									<suply_amt3/>
									<vat_amt3/>
									<nul/>
								</record>
							</gridData5>
							<gridData6>
								<record>
									<seq1/>
									<seq2/>
									<seq3/>
									<seq4/>
									<seq5/>
									<recd_clsf/>
									<taxoff/>
									<subm_ymd/>
									<subm_pers_clsf/>
									<tax_agnt_no/>
									<ern/>
									<corp_nm/>
									<corp_reg_no/>
									<presi/>
									<plcw_law_cd/>
									<plcw_law_addr/>
									<tel_no/>
									<subm_noit_tot/>
									<use_korn_cd_kind/>
									<bill_sender/>
								</record>
							</gridData6>
							<gridData7>
								<record>
									<seq1/>
									<seq2/>
									<seq3/>
									<seq4/>
									<seq5/>
									<recd_clsf/>
									<taxoff/>
									<seq/>
									<ern/>
									<corp_nm/>
									<presi/>
									<erplace_law_dstc_cd/>
									<erplace_plcw/>
									<bill_sender/>
								</record>
							</gridData7>
							<gridData3_N>
								<record>
									<seq1/>
									<seq2/>
									<seq3/>
									<seq4/>
									<seq5/>
									<recd_clsf/>
									<data_clsf/>
									<qt_clsf/>
									<taxoff/>
									<seq/>
									<subm_ern/>
									<rvrs_yy/>
									<deal_prd_fr/>
									<deal_prd_to/>
									<make_dt/>
									<sale_dlco_cnt1/>
									<stmt_nosh1/>
									<minus_indc1/>
									<sale_amt1/>
									<sale_dlco_cnt2/>
									<stmt_nosh2/>
									<minus_indc2/>
									<sale_amt2/>
									<sale_dlco_cnt3/>
									<stmt_nosh3/>
									<minus_indc3/>
									<sale_amt3/>
									<bill_sender/>
								</record>
							</gridData3_N>
							<gridData4_N>
								<record>
									<seq1/>
									<seq2/>
									<seq3/>
									<seq4/>
									<seq5/>
									<recd_clsf/>
									<data_clsf/>
									<qt_clsf/>
									<taxoff/>
									<seq/>
									<subm_ern/>
									<sale_dlco_ern/>
									<corp_nm/>
									<stmt_nosh/>
									<minus_indc/>
									<sale_amt/>
									<bill_sender/>
								</record>
							</gridData4_N>
							<gridData10_N>
								<record>
									<seq1/>
									<seq2/>
									<seq3/>
									<seq4/>
									<seq5/>
									<recd_clsf/>
									<data_clsf/>
									<qt_clsf/>
									<taxoff/>
									<seq/>
									<subm_ern/>
									<rvrs_yy/>
									<deal_prd_fr/>
									<deal_prd_to/>
									<make_dt/>
									<sale_dlco_cnt1/>
									<stmt_nosh1/>
									<minus_indc1/>
									<sale_amt1/>
									<sale_dlco_cnt2/>
									<stmt_nosh2/>
									<minus_indc2/>
									<sale_amt2/>
									<sale_dlco_cnt3/>
									<stmt_nosh3/>
									<minus_indc3/>
									<sale_amt3/>
									<bill_sender/>
								</record>
							</gridData10_N>
							<gridData10>
								<record>
									<data_clsf/>
									<tax_clsf/>
									<ern/>
									<ern_nm/>
									<cnt/>
									<suply_amt/>
									<vat_amt/>
									<total_amt/>
								</record>
							</gridData10>
							<gridData11>
								<record>
									<data_clsf/>
									<suply_pers_reg_no/>
									<sale_dlco_cnt1/>
									<nosh1/>
									<suply_amt1/>
									<vat_amt1/>
									<sale_dlco_cnt2/>
									<nosh2/>
									<suply_amt2/>
									<vat_amt2/>
									<sale_dlco_cnt3/>
									<nosh3/>
									<suply_amt3/>
									<vat_amt3/>
									<nul/>
								</record>
							</gridData11>
							<gridData12>
								<record>
									<data_clsf/>
									<tax_clsf/>
									<ern/>
									<ern_nm/>
									<cnt/>
									<suply_amt/>
									<vat_amt/>
									<total_amt/>
								</record>
							</gridData12>
							<gridData13>
								<record>
									<data_clsf/>
									<suply_pers_reg_no/>
									<sale_dlco_cnt1/>
									<nosh1/>
									<suply_amt1/>
									<vat_amt1/>
									<sale_dlco_cnt2/>
									<nosh2/>
									<suply_amt2/>
									<vat_amt2/>
									<sale_dlco_cnt3/>
									<nosh3/>
									<suply_amt3/>
									<vat_amt3/>
									<nul/>
								</record>
							</gridData13>
							<totalcnt/>
							<gridData5_N>
								<record>
									<seq1/>
									<seq2/>
									<seq3/>
									<seq4/>
									<seq5/>
									<recd_clsf/>
									<data_clsf/>
									<qt_clsf/>
									<taxoff/>
									<seq/>
									<subm_ern/>
									<rvrs_yy/>
									<deal_prd_fr/>
									<deal_prd_to/>
									<make_dt/>
									<sale_dlco_cnt1/>
									<stmt_nosh1/>
									<minus_indc1/>
									<sale_amt1/>
									<sale_dlco_cnt2/>
									<stmt_nosh2/>
									<minus_indc2/>
									<sale_amt2/>
									<sale_dlco_cnt3/>
									<stmt_nosh3/>
									<minus_indc3/>
									<sale_amt3/>
									<bill_sender/>
								</record>
							</gridData5_N>
							<gridData2_N>
								<record>
									<seq1/>
									<seq2/>
									<seq3/>
									<seq4/>
									<seq5/>
									<recd_clsf/>
									<data_clsf/>
									<qt_clsf/>
									<taxoff/>
									<seq/>
									<subm_ern/>
									<sale_dlco_ern/>
									<corp_nm/>
									<stmt_nosh/>
									<minus_indc/>
									<sale_amt/>
									<bill_sender/>
								</record>
							</gridData2_N>
							<gridData12_N>
								<record>
									<seq1/>
									<seq2/>
									<seq3/>
									<seq4/>
									<seq5/>
									<recd_clsf/>
									<data_clsf/>
									<qt_clsf/>
									<taxoff/>
									<seq/>
									<subm_ern/>
									<rvrs_yy/>
									<deal_prd_fr/>
									<deal_prd_to/>
									<make_dt/>
									<sale_dlco_cnt1/>
									<stmt_nosh1/>
									<minus_indc1/>
									<sale_amt1/>
									<sale_dlco_cnt2/>
									<stmt_nosh2/>
									<minus_indc2/>
									<sale_amt2/>
									<sale_dlco_cnt3/>
									<stmt_nosh3/>
									<minus_indc3/>
									<sale_amt3/>
									<bill_sender/>
								</record>
							</gridData12_N>
							<gridData11_N>
								<record>
									<data_clsf/>
									<tax_clsf/>
									<ern/>
									<ern_nm/>
									<cnt/>
									<suply_amt/>
									<vat_amt/>
									<total_amt/>
								</record>
							</gridData11_N>
							<gridData13_N>
								<record>
									<data_clsf/>
									<tax_clsf/>
									<ern/>
									<ern_nm/>
									<cnt/>
									<suply_amt/>
									<vat_amt/>
									<total_amt/>
								</record>
							</gridData13_N>
						</resForm>
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<keyData/>
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
					</tempData>
					<!-- 저장소 -->
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					btnVsbl("1");					
					rowBtnState("0");
					send_fc_acct_6030_m();	
					send_fc_acct_6035_s();
					tax_date = get_refvalue("/root/resData/resForm/fc_acct_6035_s/dataSet/CURLIST/record/cdnm");
					//fr_slip_occr_mm.value = commCurDate().substring(0,6);
					//to_slip_occr_mm.value = commCurDate().substring(0,6);
					gssgb1.value = "1";
					check1.value ="1 2 3 4 5";
					
					model.toggle("case1");	
					button3.disabled = true;
					button1.disabled = true;
					//데이타그리드 초기화
					model.removeNodeset("/root/resData/resForm/gridData1/record");
					model.removeNodeset("/root/resData/resForm/gridData2/record");
//					model.removeNodeset("/root/resData/resForm/gridData3/record");
					model.removeNodeset("/root/resData/resForm/gridData4/record");
//					model.removeNodeset("/root/resData/resForm/gridData5/record");
					model.removeNodeset("/root/resData/resForm/gridData6/record");
					model.removeNodeset("/root/resData/resForm/gridData7/record");
					model.removeNodeset("/root/resData/resForm/gridData8/record");
					model.removeNodeset("/root/resData/resForm/gridData9/record");
					model.removeNodeset("/root/resData/resForm/gridData9_1/record");
					model.removeNodeset("/root/resData/resForm/gridData10/record");
//					model.removeNodeset("/root/resData/resForm/gridData11/record");
					model.removeNodeset("/root/resData/resForm/gridData12/record");
//					model.removeNodeset("/root/resData/resForm/gridData13/record");

					//년 + 분기를 이용하여 날짜를 자동으로 보여주기 위해 년(yy)만 구한다.
					year.value=  commCurDate().substring(0,4);
					
					var mm =  commCurDate().substring(4,6);					
					if (mm == "02" || mm == "03" || mm == "04"){
						model.setValue("/root/reqData/reqForm/bungi","1");
					}else if (mm == "05" || mm == "06" || mm == "07"){
						model.setValue("/root/reqData/reqForm/bungi","2");
					}else if (mm == "08" || mm == "09" || mm == "10"){
						model.setValue("/root/reqData/reqForm/bungi","3");
					}else if (mm == "11" || mm == "12" || mm == "01"){
						model.setValue("/root/reqData/reqForm/bungi","4");
					}					
					bungi.dispatch("xforms-value-changed");
					
					var std_dt = commCurDate().substring(0,6)+"12";
					if (commGetDay(std_dt) == "일"){
						std_dt = commCurDate().substring(0,6)+"13";
					}else if (commGetDay(std_dt) == "토"){
						std_dt = commCurDate().substring(0,6)+"14";						
					}					
					model.setValue("/root/reqData/reqForm/std_dt",std_dt);
					
					model.refresh();
				]]>
			</script>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<script type="javascript" src="/js/fcmc_common.js"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
//					init_controls();
				]]>
			</script>
			<submission id="fc_acct_6030_m" action="/fc/acct6000/6030" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/comboSet/fc_acct_6030_m/dataSet"/>
			<submission id="fc_acct_6031_i" action="/fc/acct6000/6031" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="fc_acct_6032_l" action="/fc/acct6000/6032" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="fc_acct_6033_l" action="/fc/acct6000/6033" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/resForm/fc_acct_6033_l/dataSet"/>
			<submission id="fc_acct_6034_l" action="/fc/acct6000/6034" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/tempData"/>
			<submission id="fc_acct_6035_s" action="/fc/acct6000/6035" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/resData/resForm/fc_acct_6035_s/dataSet"/>
			<submission id="fc_acct_6036_u" action="/fc/acct6000/6036" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/formData" resultref="/root/msgData"/>
			<submission id="fc_acct_6037_u" action="/fc/acct6000/6037" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/formData" resultref="/root/msgData"/>
			<submission id="fc_acct_6038_u" action="/fc/acct6000/6038" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/formData" resultref="/root/msgData"/>
			<submission id="fc_co_8070_s" action="/fc/co8000/8070" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/resData/resform/fc_co_8070_s/dataSet"/>
		</model>
		<script type="javascript">
			<![CDATA[
				var sFile_Name = "";
				var sFile_Name2 = "";
				var BUFF; 
				var flag = "";
				var loop_flag = "";
				var tax_date = "";
								
//				function init_controls(){	
//					set_default(
//						srch_from_fisc_dt
//					,	srch_to_fisc_dt
//					);		//input_date
//					
//					set_default(
//						inwoncnt
//					,	w_tcnt
//					,	totamt
//					,	sdstotamt
//					,	jmstotamt
//					,	wctotamt
//					,	soaegcnt
//					,	soaegamt
//					);		//input
//					set_format(
//						"date_1"
//					,	srch_from_fisc_dt
//					,	srch_to_fisc_dt
//					);
//					set_format(
//						"number4"
//					,	inwoncnt
//					,	w_tcnt
//					,	totamt
//					,	sdstotamt
//					,	jmstotamt
//					,	wctotamt
//					,	soaegcnt
//					,	soaegamt
//					);
//				}		
				function send_fc_acct_6030_m(){
					model.send("fc_acct_6030_m");
					makeComboGubun("","/root/initData/comboSet/fc_acct_6030_m/dataSet/CURLIST","record","cdabrvnm_cd", "cd");
				}
				function send_fc_acct_6031_i(){
					var totalcnt;
					

					if(fr_slip_occr_mm.value + "01" < tax_date){
//					if(fr_slip_occr_mm.value + "01" < "20060101"){	//테스트용
						if(gssgb1.value == "2" && erplace_cd.value !=""){
							show_message("계산서는 사업장코드를 space[전체]로 선택해야 합니다.");
							return false;
						}
						
						if(gssgb1.value == "1" ){
					
							if(erplace_cd.value == ""){
								show_message("사업장코드는 필수입력항목입니다.");
								return false;
							}
							if (!check_reqItem(fr_slip_occr_mm,"trim","focus","발행일자FR은 필수입력항목입니다.")) { return false; }
							if (!check_reqItem(to_slip_occr_mm,"trim","focus","발행일자TO는 필수입력항목입니다.")) { return false; }
						}

						set_refvalue("/root/reqData/reqForm/erplace_cd",erplace_cd.value);	
						set_refvalue("/root/reqData/reqForm/fr_slip_occr_dt",fr_slip_occr_mm.value + "01");
						set_refvalue("/root/reqData/reqForm/to_slip_occr_dt",to_slip_occr_mm.value + commLastDay(to_slip_occr_mm.value));
	
						if(gssgb1.value == "1" ){
							

							if(check1.value == "1"){
								set_refvalue("/root/reqData/reqForm/jobgb","1");		//표지자료
								model.send("fc_acct_6031_i");
								
								if(submit_completed()){
									alert("자료생성이 완료되었습니다.(1)");
									//생성 완료후 자동 조회 
									loadList_6032();
								}
								else{
									return false;
								}
							}
							else if(check1.value == "1 2"){
								set_refvalue("/root/reqData/reqForm/jobgb","2");		//매출건별
								model.send("fc_acct_6031_i");
								if(submit_completed()){
									alert("자료생성이 완료되었습니다.(1,2)");
									//생성 완료후 자동 조회 
									loadList_6032();										
								}
								else{
									return false;
								}
							}
							else if(check1.value == "1 2 3"){
								set_refvalue("/root/reqData/reqForm/jobgb","3");		//매출합계
								model.send("fc_acct_6031_i");
								if(submit_completed()){
									alert("자료생성이 완료되었습니다.(1,2,3)");
									//생성 완료후 자동 조회 
									loadList_6032();										
								}
								else{
									return false;
								}
							}
							else if(check1.value =="1 2 3 4"){
								set_refvalue("/root/reqData/reqForm/jobgb","4");		//매입건별
								model.send("fc_acct_6031_i");
								if(submit_completed()){
									alert("자료생성이 완료되었습니다.(1,2,3,4)");
									//생성 완료후 자동 조회 
									loadList_6032();										
								}
								else{
									return false;
								}
							}
							else if(check1.value =="1 2 3 4 5"){
								set_refvalue("/root/reqData/reqForm/jobgb","5");		//매입합계								
								
								model.send("fc_acct_6031_i");
								if(submit_completed()){
									alert("자료생성이 완료되었습니다.(1,2,3,4,5)");
									//생성 완료후 자동 조회 
									loadList_6032();										
								}
								else{
									return false;
								}
							}
						}
						else if(gssgb1.value == "2" ){
							//set_refvalue("/root/reqData/reqForm/erplace_cd","01"); 20150723 봉은정 주석처리함
							model.send("fc_acct_6033_l");
	
							totalcnt = get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/totalcnt");
							if(totalcnt == 0){
								return false;
							}
							fileh.value = "C:\\TEMP\\"+"H"+get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/record/ern").ReplaceString("-","").substring(0,7)+"." +get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/record/ern").ReplaceString("-","").substring(7,11);

							//set_refvalue("/root/reqData/reqForm/erplace_cd","00"); 20150723 봉은정 주석처리함
							set_refvalue("/root/reqData/reqForm/jobgb","1");
							model.send("fc_acct_6031_i");
							if(submit_completed()){
								alert("자료생성이 완료되었습니다.(6)");
								loadList_6034();
							}
							else{
								return false;
							}
						}
					}

					//발행일자가 세무사업장 분리일자보다 큰경우
					else{						
						var combo_totalcnt  = get_refvalue("/root/initData/comboSet/fc_acct_6030_m/dataSet/CURLIST/totalcnt");
						var create_cnt = 0;
						if(erplace_cd.value != ""){
							if(gssgb1.value == "1" ){
						
//										if(erplace_cd.value == ""){
//											show_message("사업장코드는 필수입력항목입니다.");
//											return false;
//										}
								if (!check_reqItem(fr_slip_occr_mm,"trim","focus","발행일자FR은 필수입력항목입니다.")) { return false; }
								if (!check_reqItem(to_slip_occr_mm,"trim","focus","발행일자TO는 필수입력항목입니다.")) { return false; }
							}
							
							set_refvalue("/root/reqData/reqForm/erplace_cd",erplace_cd.value);	
							set_refvalue("/root/reqData/reqForm/fr_slip_occr_dt",fr_slip_occr_mm.value + "01");
							set_refvalue("/root/reqData/reqForm/to_slip_occr_dt",to_slip_occr_mm.value + commLastDay(to_slip_occr_mm.value));
		
							if(gssgb1.value == "1" ){
								if(check1.value == "1"){
									set_refvalue("/root/reqData/reqForm/jobgb","1");		//표지자료
									model.send("fc_acct_6031_i");
									
									if(submit_completed()){
										alert("자료생성이 완료되었습니다.([2] 1)");
										loadList_6032();
									}
									else{
										return false;
									}
								}
								else if(check1.value == "1 2"){
									set_refvalue("/root/reqData/reqForm/jobgb","2");		//매출건별
									model.send("fc_acct_6031_i");
									if(submit_completed()){
										alert("자료생성이 완료되었습니다.([2] 1,2)");
										loadList_6032();
									}
									else{
										return false;
									}
								}
								else if(check1.value == "1 2 3"){
									set_refvalue("/root/reqData/reqForm/jobgb","3");		//매출합계
									model.send("fc_acct_6031_i");
									if(submit_completed()){
										alert("자료생성이 완료되었습니다.([2] 1,2,3)");
										loadList_6032();
									}
									else{
										return false;
									}							
								}
								else if(check1.value =="1 2 3 4"){
									set_refvalue("/root/reqData/reqForm/jobgb","4");		//매입건별
									model.send("fc_acct_6031_i");
									if(submit_completed()){
										alert("자료생성이 완료되었습니다.([2] 1,2,3,4)");
										loadList_6032();
									}
									else{
										return false;
									}							
								}
								else if(check1.value =="1 2 3 4 5"){
									set_refvalue("/root/reqData/reqForm/jobgb","5");		//매입합계								
									
									model.send("fc_acct_6031_i");
									if(submit_completed()){
										alert("자료생성이 완료되었습니다.([2] 1,2,3,4,5)");
										loadList_6032();
									}
									else{
										return false;
									}							
								}
							}
							else if(gssgb1.value == "2" ){
//											set_refvalue("/root/reqData/reqForm/erplace_cd","01");
								set_refvalue("/root/reqData/reqForm/erplace_cd",erplace_cd.value);
								model.send("fc_acct_6033_l");
		
								totalcnt = get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/totalcnt");
								if(totalcnt == 0){
									return false;
								}
								fileh.value = "C:\\TEMP\\"+"H"+get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/record/ern").ReplaceString("-","").substring(0,7)+"." +get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/record/ern").ReplaceString("-","").substring(7,11);
		
								//set_refvalue("/root/reqData/reqForm/erplace_cd","00"); 20150723 봉은정주석
								set_refvalue("/root/reqData/reqForm/jobgb","1");
								model.send("fc_acct_6031_i");
								if(submit_completed()){
									alert("자료생성이 완료되었습니다.");
									loadList_6034();
								}
								else{
									return false;
								}
							}
						}
						else{
								for(var k = 1; k<= combo_totalcnt; k++){
								
									if(gssgb1.value == "1" ){
			
			//							if(erplace_cd.value == ""){
			//								show_message("사업장코드는 필수입력항목입니다.");
			//								return false;
			//							}
										if (!check_reqItem(fr_slip_occr_mm,"trim","focus","발행일자FR은 필수입력항목입니다.")) { return false; }
										if (!check_reqItem(to_slip_occr_mm,"trim","focus","발행일자TO는 필수입력항목입니다.")) { return false; }
									}
		//							set_refvalue("/root/reqData/reqForm/erplace_cd",erplace_cd.value);	
		
									set_refvalue("/root/reqData/reqForm/erplace_cd",get_refvalue("/root/initData/comboSet/fc_acct_6030_m/dataSet/CURLIST/record["+(k+1)+"]/cd"));    //사업장코드
									set_refvalue("/root/reqData/reqForm/fr_slip_occr_dt",fr_slip_occr_mm.value + "01");
									set_refvalue("/root/reqData/reqForm/to_slip_occr_dt",to_slip_occr_mm.value + commLastDay(to_slip_occr_mm.value));

									if(gssgb1.value == "1" ){
										if(check1.value == "1"){
											set_refvalue("/root/reqData/reqForm/jobgb","1");		//표지자료
											model.send("fc_acct_6031_i");
		
											if(submit_completed()){
												alert("자료생성이 완료되었습니다.");
												loadList_6032();
											}
											else{
												return false;
											}
										}
										else if(check1.value == "1 2"){
											set_refvalue("/root/reqData/reqForm/jobgb","2");		//매출건별
											model.send("fc_acct_6031_i");
											if(submit_completed()){
												alert("자료생성이 완료되었습니다.");
												loadList_6032();
											}
											else{
												return false;
											}
										}
										else if(check1.value == "1 2 3"){
											set_refvalue("/root/reqData/reqForm/jobgb","3");		//매출합계
											model.send("fc_acct_6031_i");
											if(submit_completed()){
												alert("자료생성이 완료되었습니다.");
												loadList_6032();
											}
											else{
												return false;
											}						
										}
										else if(check1.value =="1 2 3 4"){
											set_refvalue("/root/reqData/reqForm/jobgb","4");		//매입건별
											model.send("fc_acct_6031_i");
											if(submit_completed()){
												alert("자료생성이 완료되었습니다.");
												loadList_6032();
											}
											else{
												return false;
											}						
										}
										else if(check1.value =="1 2 3 4 5"){
											set_refvalue("/root/reqData/reqForm/jobgb","5");		//매입합계								
											
											model.send("fc_acct_6031_i");
											if(submit_completed()){
												alert("자료생성이 완료되었습니다.");
												loadList_6032();
											}
											else{
												return false;
											}						
										}
									}
									else if(gssgb1.value == "2" ){
	//									set_refvalue("/root/reqData/reqForm/erplace_cd","01");
										set_refvalue("/root/reqData/reqForm/erplace_cd",get_refvalue("/root/initData/comboSet/fc_acct_6030_m/dataSet/CURLIST/record["+(k+1)+"]/cd"));    //사업장코드
										model.send("fc_acct_6033_l");
	
										var totalcnt = get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/totalcnt");
	
										if(totalcnt == 0){
											return false;
										}
										fileh.value = "C:\\TEMP\\"+"H"+get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/record/ern").ReplaceString("-","").substring(0,7)+"." +get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/record/ern").ReplaceString("-","").substring(7,11);
				
	//									set_refvalue("/root/reqData/reqForm/erplace_cd","00");
										set_refvalue("/root/reqData/reqForm/erplace_cd",get_refvalue("/root/initData/comboSet/fc_acct_6030_m/dataSet/CURLIST/record["+(k+1)+"]/cd"));    //사업장코드
				
										if(loop_flag == ""){
											if (show_message("생성하시겠습니까?","화일 확인",MB_YESNO) != IDYES) {
												flag ="1";
												return false;
											}
											loop_flag ="1";
										}
										set_refvalue("/root/reqData/reqForm/jobgb","1");
										model.send("fc_acct_6031_i");
										if(submit_completed()){
											alert("자료생성이 완료되었습니다.");
											loadList_6034();
										}
										else{
											return false;
										}
									}
								}
							}
					loop_flag = "";
					}
				}
				function send_fc_acct_6035_s(){
					model.send("fc_acct_6035_s");
				}
				function loadList(){
					if(gssgb1.value == "1"){
						loadList_6032();
					}else{
						loadList_6034();
					}
				}				
				function loadList_6032(){
					//if(erplace_cd.value == ""){
					//	show_message("사업장코드는 필수입력항목입니다.");
					//	return false;
					//}					
					var ck_val =  "";
					if(check1.value == "1"){         ck_val = "1";}
					if(check1.value == "1 2"){       ck_val = "2";}
					if(check1.value == "1 2 3"){     ck_val = "3";}
					if(check1.value == "1 2 3 4"){   ck_val = "4";}
					if(check1.value == "1 2 3 4 5"){ ck_val = "5";}

					if(gssgb1.value == "1"){
						set_refvalue("/root/reqData/reqForm/clsf_cd",ck_val);
						set_refvalue("/root/reqData/reqForm/erplace_cd",erplace_cd.value);
						set_refvalue("/root/reqData/reqForm/fr_slip_occr_dt",fr_slip_occr_mm.value + "01");
						set_refvalue("/root/reqData/reqForm/to_slip_occr_dt",to_slip_occr_mm.value + commLastDay(to_slip_occr_mm.value));
						set_refvalue("/root/reqData/reqForm/std_dt",std_dt.value);  //20160721 봉은정추가
						model.send("fc_acct_6032_l");	
						if(submit_completed()){
							model.toggle("case1");
							button11.selected = "true";
							
							model.copyNode("/root/resData/resForm/gridData1","/root/tempData/gridData1");
							datagrid1.refresh();
							model.copyNode("/root/resData/resForm/gridData2","/root/tempData/gridData2");
							datagrid2.refresh();
							model.copyNode("/root/resData/resForm/gridData3","/root/tempData/gridData3");
							datagrid3.refresh();
							model.copyNode("/root/resData/resForm/gridData4","/root/tempData/gridData4");
							datagrid4.refresh();
							model.copyNode("/root/resData/resForm/gridData5","/root/tempData/gridData5");
							datagrid5.refresh();
							model.copyNode("/root/resData/resForm/gridData10","/root/tempData/gridData10");
							datagrid10.refresh();
							model.copyNode("/root/resData/resForm/gridData11","/root/tempData/gridData11");
							datagrid11.refresh();
							model.copyNode("/root/resData/resForm/gridData12","/root/tempData/gridData12");
							datagrid12.refresh();
							model.copyNode("/root/resData/resForm/gridData13","/root/tempData/gridData13");
							datagrid13.refresh();							
							//model.copyNode("/root/resData/resForm/totalcnt","/root/tempData/totalcnt");							
							//nul 세팅
							model.copyNode("/root/resData/resForm/fc_acct_6032_l/dataSet/CURLIST","/root/tempData/fc_acct_6032_l");
							button3.disabled = false;
							button1.disabled = false;							
							model.refresh();
						}
					}
				}
				function loadList_6034(){
					var mkflag6 = model.getValue("/root/resData/resForm/fc_acct_6031_i/mkFlag6");
					
					/*if(mkflag6 != "Y"){
						alert("계산서 자료가 생성되지 않았습니다.생성 먼저 실행해주세요");
						return;
					}*/					
					set_refvalue("/root/reqData/reqForm/erplace_cd",erplace_cd.value);
					set_refvalue("/root/reqData/reqForm/fr_slip_occr_dt",fr_slip_occr_mm.value + "01");
					set_refvalue("/root/reqData/reqForm/to_slip_occr_dt",to_slip_occr_mm.value + commLastDay(to_slip_occr_mm.value));
				
					model.send("fc_acct_6034_l");
					if(submit_completed()){
						model.toggle("case6");
						button16.selected = "true";						
						model.copyNode("/root/resData/resForm/gridData6","/root/tempData/gridData6");
						datagrid6.refresh();
						model.copyNode("/root/resData/resForm/gridData7","/root/tempData/gridData7");
						datagrid7.refresh();
						model.copyNode("/root/resData/resForm/gridData3_N","/root/tempData/gridData3_N");
						datagrid3_N.refresh();
						model.copyNode("/root/resData/resForm/gridData2_N","/root/tempData/gridData2_N");
						datagrid2_N.refresh();
						model.copyNode("/root/resData/resForm/gridData5_N","/root/tempData/gridData5_N");
						datagrid5_N.refresh();
						model.copyNode("/root/resData/resForm/gridData4_N","/root/tempData/gridData4_N");
						datagrid4_N.refresh();
						model.copyNode("/root/resData/resForm/gridData11_N","/root/tempData/gridData11_N");
						datagrid11_N.refresh();
						model.copyNode("/root/resData/resForm/gridData10_N","/root/tempData/gridData10_N");
						datagrid10_N.refresh();
						model.copyNode("/root/resData/resForm/gridData13_N","/root/tempData/gridData13_N");
						datagrid13_N.refresh();
						model.copyNode("/root/resData/resForm/gridData12_N","/root/tempData/gridData12_N");
						datagrid12_N.refresh();
										
						model.copyNode("/root/resData/resForm/fc_acct_6034_l/dataSet/CURLIST","/root/tempData/fc_acct_6034_l");
						button3.disabled = false;
						button1.disabled = false;							
						model.refresh();
					}	
				}
				function makeFile(){
					var totalcnt;
					var combo_totalcnt  = get_refvalue("/root/initData/comboSet/fc_acct_6030_m/dataSet/CURLIST/totalcnt");
					if(gssgb1.value == "1" ){					
						var files = window.fileDialog("save", "|", true, "", "", "txt Files (*.txt)|*.txt");

						sFile_Name = files;
						if (sFile_Name != "") {						
							var fso = new ActiveXObject("Scripting.FileSystemObject");
							BUFF = fso.CreateTextFile(sFile_Name, true);
						}
					}					
					else{
						var totalcnt = get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/totalcnt");
						//alert(":0:"+totalcnt+"::");
						if(totalcnt == ""){
							//set_refvalue("/root/reqData/reqForm/erplace_cd",get_refvalue("/root/initData/comboSet/fc_acct_6030_m/dataSet/CURLIST/record["+(k+1)+"]/cd"));    //사업장코드
							set_refvalue("/root/reqData/reqForm/erplace_cd",erplace_cd.value);    //사업장코드
							model.send("fc_acct_6033_l");
							totalcnt = get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/totalcnt");
							//alert(":1:"+totalcnt+"::");
						}
						if(totalcnt == 0){
							return false;
						}
						//alert(":2:"+get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/record/ern"));
						//alert(":3:"+get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/record/ern").ReplaceString("-","").substring(0,7));
						//alert(":4:"+get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/record/ern").ReplaceString("-","").substring(7,11));
						//alert(":5:"+get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/record/ern").ReplaceString("-","").substring(0,7)+"." +get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/record/ern").ReplaceString("-","").substring(7,11));
						var fileh = "C:\\TEMP\\"+"H"+get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/record/ern").ReplaceString("-","").substring(0,7)+"." +get_refvalue("/root/resData/resForm/fc_acct_6033_l/dataSet/CURLIST/record/ern").ReplaceString("-","").substring(7,11);
						//alert(fileh);
						model.setValue("/root/reqData/reqForm/fileh",fileh);
						model.refresh();
						//alert(fileh.value);
						
						
					}
					try{
						if(gssgb1.value == "1" ){//세금계산서	
							var totalcnt = get_refvalue("/root/resData/resForm/fc_acct_6032_l/dataSet/CURLIST/totalcnt");
							if(totalcnt == 0){
								return false;
							}		
							for(var i=1; i<=totalcnt;i++){
								BUFF.WriteLine(get_refvalue("/root/resData/resForm/fc_acct_6032_l/dataSet/CURLIST/record["+i+"]/nul").substring(0,get_refvalue("/root/resData/resForm/fc_acct_6032_l/dataSet/CURLIST/record["+i+"]/nul").length-1));
							}					
						}
						else{//계산서
							//var fileh = fileh.value;
							var fileh = model.getValue("/root/reqData/reqForm/fileh");
							if(fileh == "" ){
								alert("계산서 생성 먼저 실행해 주세요");
								return;
							}
							if (show_message("생성하시겠습니까?","화일 확인",MB_YESNO) != IDYES) {
								flag ="1";
								return false;
							}							
							//sFile_Name = fileh.value.TrimRight();
							sFile_Name = fileh.TrimRight();
							if(sFile_Name != ""){
								var fso = new ActiveXObject("Scripting.FileSystemObject");
								BUFF = fso.CreateTextFile(sFile_Name, true);
							}
							sFile_Name2 = filei.value.TrimRight();
							if(sFile_Name2 != ""){
								var fso = new ActiveXObject("Scripting.FileSystemObject");
								BUFF = fso.CreateTextFile(sFile_Name2, true);
							}								
							var totalcnt = get_refvalue("/root/resData/resForm/fc_acct_6034_l/dataSet/CURLIST/totalcnt");
							if(totalcnt == 0){
								return false;
							}		
							for(var i=1; i<=totalcnt;i++){
								BUFF.WriteLine(get_refvalue("/root/resData/resForm/fc_acct_6034_l/dataSet/CURLIST/record["+i+"]/bill_sender").substring(0,get_refvalue("/root/resData/resForm/fc_acct_6034_l/dataSet/CURLIST/record["+i+"]/bill_sender").length-1));
							}			
						}
					}
					catch (ex) {
						show_message(ex + "\r파일 생성시 오류가 발생했습니다.");
					}
					finally {
						if(flag == "1"){
							flag = "";
							return false;
						}
						if(sFile_Name != ""){
							BUFF.Close();
							show_message("부가세 신고자료 생성이 완료되었습니다.");
						}
						sFile_Name2 = filei.value.TrimRight();
						if(sFile_Name2 != ""){
							BUFF.Close();
							show_message("부가세 신고자료 생성이 완료되었습니다.");
						}					
					}	
				}
				function btnVsbl(gb){
					if(gb == "1"){
						button11.visible = true;
						button12.visible = true;
						button13.visible = true;
						button14.visible = true;
						button15.visible = true;
						
						button16.visible = false;
						button17.visible = false;
						button18.visible = false;
						button19.visible = false;
						button20.visible = false;
						model.toggle("case1");
						button11.selected = true;
						button5.visible = false;
					}else{
						button11.visible = false;
						button12.visible = false;
						button13.visible = false;
						button14.visible = false;
						button15.visible = false;
						
						button16.visible = true;
						button17.visible = true;
						button18.visible = true;
						button19.visible = true;	
						button20.visible = true;	
						model.toggle("case6");
						button16.selected = true;
						button5.visible = true;
					}
				}
				function rowBtnState(strInt){
					if(strInt == "0"){
						btn_rowInsert.visible = false;
						btn_rowDelete.visible = false;
						btn_rowCancel.visible = false;
					}else{
						btn_rowInsert.visible = true;
						//btn_rowDelete.visible = true;
						btn_rowCancel.visible = true;						
					}
				}
				function cancelRow(datagrid){

					var firstRow = datagrid.selectedRow(0);
					var lastRow  = datagrid.selectedRow(datagrid.selectedRows-1);				
					
					for(var i=firstRow;i<=lastRow;i++){
						if(datagrid.rowStatus(i) == "1" || datagrid.rowStatus(i) == "3"){
							datagrid.removeRow(i);
							i--;
						}else if(datagrid.rowStatus(i) == "4"){
							datagrid.rowStatus(i) = "0";
						}else{
							datagrid.rowStatus(i) = "0";
						}
					}	
				}
				/*
					행추가
				*/
				function addRow(datagrid){
					datagrid.addRow();
					datagrid.row = datagrid.rows;
					datagrid.col = 1;
				}
				/*
					행삭제
				*/
				function deleteRow(datagrid){
					var firstRow = datagrid.selectedRow(0);
					var lastRow  = datagrid.selectedRow(datagrid.selectedRows-1);
					for(var i=firstRow;i<=lastRow;i++){
						datagrid.rowStatus(i) = "4";
					}
					datagrid.refresh();
				}	
				
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" visibility="visible" pagewidth="946" pageheight="765" guideline="2,34;2,39;2,40;2,49;2,66;2,78;2,80;2,227;2,243;1,936;1,926;1,926;1,462;1,449;2,755;">
		<button id="button5" class="tab07" group="tab" crud="R" style="left:560px; top:163px; width:118px; height:23px; ">
			<caption>전자매입계산서</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case11");
				rowBtnState("0");
				]]>
			</script>
		</button>
		<button id="button19" class="tab08" group="tab" crud="R" style="left:194px; top:163px; width:130px; height:23px; ">
			<caption>매출계산서</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case9");	
				rowBtnState("1");
				]]>
			</script>
		</button>
		<button id="button18" class="tab07" group="tab" crud="R" style="left:324px; top:163px; width:118px; height:23px; ">
			<caption>매입계산서</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case8");
				rowBtnState("0");
				]]>
			</script>
		</button>
		<button id="button20" class="tab07" group="tab" crud="R" style="left:442px; top:163px; width:118px; height:23px; ">
			<caption>전자매출계산서</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case10");
				rowBtnState("0");
				]]>
			</script>
		</button>
		<button id="button17" class="tab05" group="tab" crud="R" style="left:102px; top:163px; width:92px; height:23px; ">
			<caption>제출의무자</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case7");	
				rowBtnState("0");
				]]>
			</script>
		</button>
		<button id="button16" class="tab05" group="tab" crud="R" style="left:10px; top:163px; width:92px; height:23px; ">
			<caption>제출자</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case6");	
				rowBtnState("0");
				]]>
			</script>
		</button>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:50px; width:926px; height:21px; ">
			<button id="btn_select" class="btn02" crud="R" style="left:760px; top:0px; width:52px; height:21px; ">
				<caption>마감화면</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
//						window.load("/xrw/fc/acct/FC_ACCT_6110.xrw","mdichild", "fc_acct_6110", "align:center; width:640; height:480; caption:hidden;", "", "");
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_6110");						
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:871px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose();
					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" crud="C" style="left:540px; top:0px; width:52px; height:21px; ">
				<caption>생성</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_fc_acct_6031_i();
					]]>
				</script>
			</button>
			<button id="button1" class="btn02" crud="C" style="left:705px; top:0px; width:52px; height:21px; ">
				<caption>파일</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						makeFile();
					]]>
				</script>
			</button>
			<button id="button2" class="btn02" crud="C" style="left:595px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						loadList();
					]]>
				</script>
			</button>
			<button id="button3" class="btn02" crud="C" style="left:650px; top:0px; width:52px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[	
						if(switch1.selectedIndex == "1") //매출건별
						{
							model.makeNode("/root/formData/erplace_cd");
							model.setValue("/root/formData/erplace_cd",model.getValue("/root/reqData/reqForm/erplace_cd1"));
							model.makeNode("/root/formData/multiUpdateData");
							model.setValue("/root/formData/multiUpdateData",datagrid2.getUpdateData());	
							//alert(datagrid2.getUpdateData()); return;
							model.send("fc_acct_6036_u");
							if( submit_completed() )
							{
								loadList();
								//model.toggle("case2");
								datagrid2.clearStatus();
								datagrid2.refresh();
							}
						}
						else if(switch1.selectedIndex == "2") //매입건별
						{
							model.makeNode("/root/formData/erplace_cd");
							model.setValue("/root/formData/erplace_cd",model.getValue("/root/reqData/reqForm/erplace_cd1"));
							model.makeNode("/root/formData/multiUpdateData");
							model.setValue("/root/formData/multiUpdateData",datagrid4.getUpdateData());	
							//alert(datagrid4.getUpdateData()); return;
							model.send("fc_acct_6037_u");
							if( submit_completed() )
							{
								loadList();
								//model.toggle("case4");
								datagrid4.clearStatus();
								datagrid4.refresh();
							}
						}
						else if(switch1.selectedIndex == "8") //매출입처별거래명세
						{
							var gssgb = model.getValue("/root/reqData/reqForm/gssgb1");
							if(gssgb == "2"){
								model.makeNode("/root/formData/erplace_cd");
								model.setValue("/root/formData/erplace_cd",model.getValue("/root/reqData/reqForm/erplace_cd1"));
								model.makeNode("/root/formData/multiUpdateData");
								model.setValue("/root/formData/multiUpdateData",datagrid4_N.getUpdateData());	
								//alert(datagrid9.getUpdateData()); return;
								model.send("fc_acct_6038_u");
								if( submit_completed() )
								{
									loadList();
									//model.toggle("case9");
									datagrid4_N.clearStatus();
									datagrid4_N.refresh();
								}
							}
							else{
								alert("계산서구분이 계산서이어야 합니다.");
								return;
							}
						}
						else{
							alert("매출,매입,매출입처별거래명세탭에서만 수정 가능합니다.");
							return;
						}
					]]>
				</script>
			</button>
			<button id="button4" class="btn02" style="left:815px; top:0px; width:52px; height:21px; ">
				<caption>출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						// 오즈관련 노드 초기화
						resetOznode();					
						
						//오즈실행을 위한 파라미터 셋팅(검색 프로시저의 리턴값)
						var erplace_cd = model.getValue("/root/reqData/reqForm/erplace_cd1");
						var frdt = model.getValue("/root/reqData/reqForm/fr_slip_occr_mm");
						var todt = model.getValue("/root/reqData/reqForm/to_slip_occr_mm");
						var clsf_cd = "";
						var std_dt = model.getValue("/root/reqData/reqForm/std_dt");
						
						if(model.getValue("/root/reqData/reqForm/gssgb1") == "1"){
							clsf_cd = "1";
						}
						
						//필수값 체크
						if(erplace_cd == "" || frdt == "" || todt == ""){
							show_message("사업장코드 및 발행년월 정보가 누락되었습니다.");
							return false;
						}
						
						if(model.getValue("/root/reqData/reqForm/gssgb1") == "1"){
							// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)	
							makeNodeValue("/root/oz_data/ozrName", "fcmc/SP_FC_ACCT_6032_P"); //세금계산서
						
							makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd", model.property("ss_cmpycd"));	//테스트는 고정   model.property("ss_cmpycd")
							makeNodeValue("/root/oz_data/odiParam/iv_clsf_cd",  clsf_cd);
							makeNodeValue("/root/oz_data/odiParam/iv_erplace_cd",  erplace_cd);
							makeNodeValue("/root/oz_data/odiParam/iv_fr_slip_occr_dt", frdt);
							makeNodeValue("/root/oz_data/odiParam/iv_to_slip_occr_dt", todt);
							
							// 레포트뷰어 호출.					
							openOzwin("/root/oz_data");		
						}else{
							// ozr경로 및 odi 파일명으로 사용될 노드 및 value셋팅 ( OZR파일경로 .ozr 제거)	
							makeNodeValue("/root/oz_data/ozrName", "fcmc/SP_FC_ACCT_6034_P"); //합계표
						
							makeNodeValue("/root/oz_data/odiParam/iv_cmpy_cd", model.property("ss_cmpycd"));	//테스트는 고정   model.property("ss_cmpycd")
							makeNodeValue("/root/oz_data/odiParam/iv_erplace_cd",  erplace_cd);
							makeNodeValue("/root/oz_data/odiParam/iv_fr_slip_occr_dt", frdt);
							makeNodeValue("/root/oz_data/odiParam/iv_to_slip_occr_dt", todt);			
							
							// 레포트뷰어 호출.					
							openOzwin("/root/oz_data");		
						}
					]]>
				</script>
			</button>
		</group>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group1" style="left:10px; top:79px; width:910px; height:70px; border-color:#c0c0c0; border-style:solid; ">
			<caption id="caption2" class="list_cap02" style="left:4px; top:33px; width:900px; height:30px; font-size:14pt; font-weight:bolder; text-align:center; "/>
			<caption id="caption4" class="list_cap02" style="left:4px; top:4px; width:900px; height:30px; font-size:14pt; font-weight:bolder; text-align:center; "/>
			<caption id="caption10" class="list_cap03" style="left:680px; top:4px; width:70px; height:30px; text-align:center; ">계산서구분</caption>
			<caption id="caption8" class="list_cap03" style="left:103px; top:4px; width:80px; height:30px; text-align:center; ">사업장코드</caption>
			<caption id="caption9" class="list_cap03" style="left:291px; top:4px; width:80px; height:30px; text-align:center; ">발행년월</caption>
			<select1 id="erplace_cd" ref="/root/reqData/reqForm/erplace_cd1" class="req" appearance="minimal" editmode="inputsearch" style="left:187px; top:10px; width:97px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_6030_m/dataSet/CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(erplace_cd, erplace_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(erplace_cd,"");
							return;
						}
					]]>
				</script>
			</select1>
			<input id="fr_slip_occr_mm" ref="/root/reqData/reqForm/fr_slip_occr_mm" class="req" format="yyyy-mm" style="left:519px; top:10px; width:70px; height:18px; "/>
			<input id="to_slip_occr_mm" ref="/root/reqData/reqForm/to_slip_occr_mm" class="req" format="yyyy-mm" style="left:604px; top:10px; width:70px; height:18px; "/>
			<select1 id="gssgb1" ref="/root/reqData/reqForm/gssgb1" appearance="full" cellspacing="6" cols="2" overflow="visible" style="left:757px; top:9px; width:142px; height:20px; text-align:left; border-color:#ffffff; border-style:solid; ">
				<choices>
					<item>
						<label>세금계산서</label>
						<value>1</value>
					</item>
					<item>
						<label>계산서</label>
						<value>2</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var gssgb1 = model.getValue("/root/reqData/reqForm/gssgb1");
					if(gssgb1 == "1"){
						btnVsbl("1");
						rowBtnState("0");
					}else{
						btnVsbl("2");
						rowBtnState("0");
					}
					]]>
				</script>
			</select1>
			<group id="group3" visibility="visi" style="left:106px; top:39px; width:463px; height:21px; border-color:#ffffff; border-style:solid; ">
				<select id="check1" ref="/root/reqData/reqForm/check" overflow="visible" appearance="full" cellspacing="10" cols="5" vcellspacing="1" style="left:-1px; top:-1px; width:455px; height:20px; text-align:left; border-color:#ffffff; border-style:solid; ">
					<choices>
						<item>
							<label>표 지 자 료</label>
							<value>1</value>
						</item>
						<item>
							<label>매 출 건 별</label>
							<value>2</value>
						</item>
						<item>
							<label>매 출 합 계</label>
							<value>3</value>
						</item>
						<item>
							<label>매 입 건 별</label>
							<value>4</value>
						</item>
						<item>
							<label>매 입 합 계</label>
							<value>5</value>
						</item>
					</choices>
					<script type="javascript" ev:event="xforms-select">
						<![CDATA[
						if(check1.focusIndex == "0"){
							check1.value = "1";
						}
						else if(check1.focusIndex == "1"){
							check1.value = "1 2";
						}
						else if(check1.focusIndex == "2"){
							check1.value = "1 2 3";
						}
						else if(check1.focusIndex == "3"){
							check1.value = "1 2 3 4";
						}
						else if(check1.focusIndex == "4"){
							check1.value = "1 2 3 4 5";
						}
					]]>
					</script>
					<script type="javascript" ev:event="xforms-deselect">
						<![CDATA[
					
						if(check1.focusIndex == "0"){
							check1.value = "";
						}
						else if(check1.focusIndex == "1"){
							check1.value = "1";
						}
						else if(check1.focusIndex == "2"){
							check1.value = "1 2";
						}
						else if(check1.focusIndex == "3"){
							check1.value = "1 2 3";
						}
						else if(check1.focusIndex == "4"){
							check1.value = "1 2 3 4";
						}				
					]]>
					</script>
				</select>
			</group>
			<caption id="caption1" style="left:591px; top:13px; width:15px; height:15px; ">~</caption>
			<caption id="caption11" class="list_cap03" style="left:4px; top:4px; width:100px; height:30px; font-weight:bold; text-align:center; background-color:#d0e0ff; ">처 리 범 위</caption>
			<caption id="caption12" class="list_cap03" style="left:4px; top:33px; width:100px; height:30px; font-weight:bold; text-align:center; background-color:#d0e0ff; ">처 리 대 상</caption>
			<select1 id="bungi" ref="/root/reqData/reqForm/bungi" class="req" navindex="3" appearance="minimal" style="left:438px; top:10px; width:70px; height:18px; text-align:center; ">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>1  분기</label>
						<value>1</value>
					</item>
					<item>
						<label>2  분기</label>
						<value>2</value>
					</item>
					<item>
						<label>3  분기</label>
						<value>3</value>
					</item>
					<item>
						<label>4  분기</label>
						<value>4</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var yy = model.getValue("/root/reqData/reqForm/year");
						if(yy.value != ""){						
							if(bungi.value == "1"){
								fr_slip_occr_mm.value =  yy +  "01";
								to_slip_occr_mm.value =  yy +  "03";
							}
							else if(bungi.value == "2"){
								fr_slip_occr_mm.value =  yy +  "04";
								to_slip_occr_mm.value =  yy +  "06";
							}
							else if(bungi.value == "3"){
								fr_slip_occr_mm.value =  yy +  "07";
								to_slip_occr_mm.value =  yy +  "09";
							}
							else if(bungi.value == "4"){
								fr_slip_occr_mm.value =  yy +  "10";
								to_slip_occr_mm.value =  yy +  "12";							
							}
							else{
								fr_slip_occr_mm.value =  "";
								to_slip_occr_mm.value =   "";								
							}
						}
					]]>
				</script>
			</select1>
			<caption id="caption14" style="left:420px; top:11px; width:15px; height:18px; ">년</caption>
			<input id="year" ref="/root/reqData/reqForm/year" class="req" navindex="2" style="left:375px; top:10px; width:43px; height:18px; text-align:center; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						bungi.value = "";
						fr_slip_occr_mm.value =  "";
						to_slip_occr_mm.value =  "";
					]]>
				</script>
			</input>
			<caption id="caption6" class="list_cap03" style="left:680px; top:33px; width:70px; height:30px; text-align:center; ">기준일자</caption>
			<input id="std_dt" ref="/root/reqData/reqForm/std_dt" class="req" navindex="2" autonext="false" inputtype="date" style="left:759px; top:39px; width:90px; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					
					]]>
				</script>
			</input>
		</group>
		<switch id="switch1" class="gro_sel" style="left:10px; top:185px; width:910px; height:525px; ">
			<case id="case1">
				<datagrid id="datagrid1" nodeset="/root/resData/resForm/gridData1/record" caption="자료구분^사업자번호^상호^대표자명^주소^업태^종목^거래기간^작성일자^공란" colsep="#" colwidth="54, 90, 100, 70, 150, 80, 150, 100, 80, 120" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" style="left:5px; top:5px; width:900px; height:505px; padding-right:10; background-position:center right; ">
					<col ref="data_clsf" type="output" caption="자료구분" style="word-wrap:none; "/>
					<col ref="ern" type="output" format="999-99-99999" caption="사업자번호" style="word-wrap:none; "/>
					<col ref="firmnm" type="output" caption="상호" style="word-wrap:none; "/>
					<col ref="presi_nm" type="output" caption="대표자명" style="word-wrap:none; "/>
					<col ref="addr" type="output" caption="주소" style="word-wrap:none; "/>
					<col ref="bizcond" type="output" caption="업태" style="word-wrap:none; "/>
					<col ref="item" type="output" caption="종목" style="word-wrap:none; "/>
					<col ref="deal_prd" type="output" format="yy.mm.dd-yy.mm.dd" caption="거래기간" style="word-wrap:none; "/>
					<col ref="make_dt" type="output" format="yy.mm.dd" caption="작성일자" style="word-wrap:none; "/>
					<col ref="nul" type="output" visibility="hidden" caption="공란" style="word-wrap:none; "/>
				</datagrid>
			</case>
			<case id="case2">
				<datagrid id="datagrid2" nodeset="/root/resData/resForm/gridData2/record" caption="^자료구분^공급자등록번호^일련번호^피공급자등록번호^상호^업태^종목^매수^거래수^공급가액^부가세액^도매코드^소매코드^권번호^제출서^공란" colsep="#" colwidth="30,54, 116, 57, 116, 120, 80, 80, 45, 45, 80, 70, 55, 55, 55, 55, 120" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" style="left:5px; top:5px; width:900px; height:440px; padding-right:10; background-position:center right; ">
					<col checkvalue="Y,N" ref="select" type="checkbox"/>
					<col ref="data_clsf" type="output" caption="자료구분" style="word-wrap:none; "/>
					<col ref="suply_pers_reg_no" type="output" format="999-99-99999" caption="공급자등록번호" style="word-wrap:none; "/>
					<col ref="seq" type="output" caption="일련번호" style="word-wrap:none; "/>
					<col ref="rec_suply_reg_no" type="input" format="999-99-99999" caption="피공급자등록번호" style="word-wrap:none; "/>
					<col ref="firmnm" type="output" caption="상호" style="text-align:left; word-wrap:none; "/>
					<col ref="bizcond" type="output" caption="업태" style="text-align:left; word-wrap:none; "/>
					<col ref="item" type="output" caption="종목" style="text-align:left; word-wrap:none; "/>
					<col ref="nosh" type="input" format="(-)#,###" caption="매수" style="word-wrap:none; "/>
					<col ref="deal_cnt" type="input" format="(-)#,###" caption="거래수" style="word-wrap:none; "/>
					<col ref="suply_amt" type="input" format="(-)#,###" caption="공급가액" style="text-align:right; word-wrap:none; "/>
					<col ref="vat_amt" type="input" format="(-)#,###" caption="부가세액" style="text-align:right; word-wrap:none; "/>
					<col ref="whosal_cd" type="output" caption="도매코드" style="word-wrap:none; "/>
					<col ref="retail_cd" type="output" caption="소매코드" style="word-wrap:none; "/>
					<col ref="vol_no" type="output" caption="권번호" style="word-wrap:none; "/>
					<col ref="subm_paper" type="output" caption="제출서" style="word-wrap:none; "/>
					<col ref="nul" type="output" visibility="hidden" caption="공란" style="word-wrap:none; "/>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
							if(datagrid2.col == 11){
							var suply_amt 	= datagrid2.valueMatrix( datagrid2.row, 11 );
							var vat_amt = 0;							 
							vat_amt = suply_amt * 0.1;
							datagrid2.valueMatrix( datagrid2.row, 12 ) = vat_amt;
							}
							
						]]>
					</script>
					<script type="javascript" ev:event="xforms-select">
						<![CDATA[
						var row = datagrid2.mouseRow;
						var col = datagrid2.mouseCol;
						
						if(row <  datagrid2.fixedRows){ //헤더 일괄선택시 		
							for(var i=datagrid2.fixedRows;i<datagrid2.rows; i++){ 
								var check_ok = false;
								for(var j=datagrid2.colRef("seq"); j<datagrid2.cols;j++){
									if(datagrid2.valueMatrix(i, j) != ""){
										check_ok = true;
										break;
									}
								}
								
								if(check_ok == true){
									datagrid2.addStatus(i, "update");
								}
								else{
									datagrid2.valueMatrix(i, datagrid2.colRef("select")) = "N";
									datagrid2.removeStatus(i, "update");
								}
							}		
						}
						else{					
							var check_ok = false;
							for(var j=datagrid2.colRef("seq"); j<datagrid2.cols;j++){
								if(datagrid2.valueMatrix(datagrid2.row, j) != ""){
									check_ok = true;
									break;
								}
							}
							if (check_ok == true ){
								datagrid2.addStatus(datagrid2.row, "update");
							}
							else{
								datagrid2.valueMatrix(datagrid2.row, datagrid2.colRef("select")) = "N";
								datagrid2.removeStatus(datagrid2.row, "update");
							}
						}
						
						datagrid2.refresh();
									
						]]>
					</script>
					<script type="javascript" ev:event="xforms-deselect">
						<![CDATA[
						if(datagrid2.row <  datagrid2.fixedRows){ //헤더 일괄선택시 		
							for(var i=datagrid2.fixedRows;i<datagrid2.rows; i++){ 
								datagrid2.valueMatrix(i, datagrid2.colRef("select")) = "N";
								datagrid2.removeStatus(i, "update");
							}		
						}else{
							datagrid2.removeStatus(datagrid2.row, "update");
						}
						datagrid2.refresh();
						
						]]>
					</script>
				</datagrid>
				<datagrid id="datagrid3" nodeset="/root/resData/resForm/gridData3/record" caption="^자료구분^공급자등록번호^매출처수1^매수1^공급가액1^부가세액1^매출처수2^매수2^공급가액2^부가세액2^매출처수3^매수3^공급가액3^부가세액3^공란" colsep="#" colwidth="40,54, 100, 60, 60, 90, 80, 60, 60, 90, 80, 60, 60, 90, 80, 100" defaultrows="1" fixedcols="1" mergecellsfixedrows="bycolrec" rowsep="|" style="left:5px; top:455px; width:900px; height:60px; padding-right:10; background-position:center right; ">
					<col ref="lbl"/>
					<col ref="data_clsf" type="output" caption="자료구분" style="word-wrap:none; "/>
					<col ref="suply_pers_reg_no" type="output" format="999-99-99999" caption="공급자등록번호" style="word-wrap:none; "/>
					<col ref="sale_dlco_cnt1" type="output" format="(-)#,###" caption="매출처수1" style="word-wrap:none; "/>
					<col ref="nosh1" type="output" format="(-)#,###" caption="매수1" style="word-wrap:none; "/>
					<col ref="suply_amt1" type="output" format="(-)#,###" caption="공급가액1" style="text-align:right; word-wrap:none; "/>
					<col ref="vat_amt1" type="output" format="(-)#,###" caption="부가세액1" style="text-align:right; word-wrap:none; "/>
					<col ref="sale_dlco_cnt2" type="output" format="(-)#,###" caption="매출처수2" style="word-wrap:none; "/>
					<col ref="nosh2" type="output" format="(-)#,###" caption="매수2" style="word-wrap:none; "/>
					<col ref="suply_amt2" type="output" format="(-)#,###" caption="공급가액2" style="text-align:right; word-wrap:none; "/>
					<col ref="vat_amt2" type="output" format="(-)#,###" caption="부가세액2" style="text-align:right; word-wrap:none; "/>
					<col ref="sale_dlco_cnt3" type="output" format="(-)#,###" caption="매출처수3" style="word-wrap:none; "/>
					<col ref="nosh3" type="output" format="(-)#,###" caption="매수3" style="word-wrap:none; "/>
					<col ref="suply_amt3" type="output" format="(-)#,###" caption="공급가액3" style="text-align:right; word-wrap:none; "/>
					<col ref="vat_amt3" type="output" format="(-)#,###" caption="부가세액3" style="text-align:right; word-wrap:none; "/>
					<col ref="nul" type="output" visibility="hidden" caption="공란" style="word-wrap:none; "/>
				</datagrid>
			</case>
			<case id="case3">
				<datagrid id="datagrid4" nodeset="/root/resData/resForm/gridData4/record" caption="^자료구분^공급자등록번호^일련번호^피공급자등록번호^상호^업태^종목^매수^거래수^공급가액^부가세액^도매코드^소매코드^권번호^제출서^공란" colsep="#" colwidth="30,54, 116, 57, 116, 120, 60, 60, 45, 45, 80, 70, 55, 55, 55, 55, 120" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" style="left:5px; top:5px; width:900px; height:440px; padding-right:10; background-position:center right; ">
					<col checkvalue="Y,N" ref="select" type="checkbox"/>
					<col ref="data_clsf" type="output" caption="자료구분" style="word-wrap:none; "/>
					<col ref="suply_pers_reg_no" type="input" format="999-99-99999" caption="공급자등록번호" style="word-wrap:none; "/>
					<col ref="seq" type="output" caption="일련번호" style="word-wrap:none; "/>
					<col ref="rec_suply_reg_no" type="output" format="999-99-99999" caption="피공급자등록번호" style="word-wrap:none; "/>
					<col ref="firmnm" type="output" caption="상호" style="text-align:left; word-wrap:none; "/>
					<col ref="bizcond" type="output" caption="업태" style="text-align:left; word-wrap:none; "/>
					<col ref="item" type="output" caption="종목" style="text-align:left; word-wrap:none; "/>
					<col ref="nosh" type="input" format="(-)#,###" caption="매수" style="word-wrap:none; "/>
					<col ref="nul_cnt" type="input" format="(-)#,###" caption="거래수" style="word-wrap:none; "/>
					<col ref="suply_amt" type="input" format="(-)#,###" caption="공급가액" style="text-align:right; word-wrap:none; "/>
					<col ref="vat_amt" type="input" format="(-)#,###" caption="부가세액" style="text-align:right; word-wrap:none; "/>
					<col ref="whosal_cd" type="output" caption="도매코드" style="word-wrap:none; "/>
					<col ref="retail_cd" type="output" caption="소매코드" style="word-wrap:none; "/>
					<col ref="vol_no" type="output" caption="권번호" style="word-wrap:none; "/>
					<col ref="subm_paper" type="output" caption="제출서" style="word-wrap:none; "/>
					<col ref="nul" type="output" visibility="hidden" caption="공란" style="word-wrap:none; "/>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
							if(datagrid4.col == 11){
							var suply_amt 	= datagrid4.valueMatrix( datagrid4.row, 11 );
							var vat_amt = 0;							 
							vat_amt = suply_amt * 0.1;
							datagrid4.valueMatrix( datagrid4.row, 12 ) = vat_amt;
							}
							
						]]>
					</script>
					<script type="javascript" ev:event="xforms-select">
						<![CDATA[
						var row = datagrid4.mouseRow;
						var col = datagrid4.mouseCol;
						
						if(row <  datagrid4.fixedRows){ //헤더 일괄선택시 		
							for(var i=datagrid4.fixedRows;i<datagrid4.rows; i++){ 
								var check_ok = false;
								for(var j=datagrid4.colRef("seq"); j<datagrid4.cols;j++){
									if(datagrid4.valueMatrix(i, j) != ""){
										check_ok = true;
										break;
									}
								}
								
								if(check_ok == true){
									datagrid4.addStatus(i, "update");
								}
								else{
									datagrid4.valueMatrix(i, datagrid4.colRef("select")) = "N";
									datagrid4.removeStatus(i, "update");
								}
							}		
						}
						else{					
							var check_ok = false;
							for(var j=datagrid4.colRef("seq"); j<datagrid4.cols;j++){
								if(datagrid4.valueMatrix(datagrid4.row, j) != ""){
									check_ok = true;
									break;
								}
							}
							if (check_ok == true ){
								datagrid4.addStatus(datagrid4.row, "update");
							}
							else{
								datagrid4.valueMatrix(datagrid4.row, datagrid4.colRef("select")) = "N";
								datagrid4.removeStatus(datagrid4.row, "update");
							}
						}
						
						datagrid4.refresh();
									
						]]>
					</script>
					<script type="javascript" ev:event="xforms-deselect">
						<![CDATA[
						if(datagrid4.row <  datagrid4.fixedRows){ //헤더 일괄선택시 		
							for(var i=datagrid4.fixedRows;i<datagrid4.rows; i++){ 
								datagrid4.valueMatrix(i, datagrid4.colRef("select")) = "N";
								datagrid4.removeStatus(i, "update");
							}		
						}else{
							datagrid4.removeStatus(datagrid4.row, "update");
						}
						datagrid4.refresh();
						
						]]>
					</script>
				</datagrid>
				<datagrid id="datagrid5" nodeset="/root/resData/resForm/gridData5/record" caption="^자료구분^공급자등록번호^매출처수1^매수1^공급가액1^부가세액1^매출처수2^매수2^공급가액2^부가세액2^매출처수3^매수3^공급가액3^부가세액3^공란" colsep="#" colwidth="40,54, 100, 60, 60, 100, 90, 60, 60, 100, 90, 60, 60, 100, 90, 100" defaultrows="1" explorerbar="sort" fixedcols="1" mergecellsfixedrows="bycolrec" rowsep="|" selectionmode="byrow" style="left:5px; top:455px; width:900px; height:60px; padding-right:10; background-position:center right; ">
					<col ref="lbl"/>
					<col ref="data_clsf" type="output" caption="자료구분" style="word-wrap:none; "/>
					<col ref="rec_suply_reg_no" type="output" format="999-99-99999" caption="공급자등록번호" style="word-wrap:none; "/>
					<col ref="sale_dlco_cnt1" type="output" format="(-)#,###" caption="매출처수1" style="word-wrap:none; "/>
					<col ref="nosh1" type="output" format="(-)#,###" caption="매수1" style="word-wrap:none; "/>
					<col ref="suply_amt1" type="output" format="(-)#,###" caption="공급가액1" style="text-align:right; word-wrap:none; "/>
					<col ref="vat_amt1" type="output" format="(-)#,###" caption="부가세액1" style="text-align:right; word-wrap:none; "/>
					<col ref="sale_dlco_cnt2" type="output" format="(-)#,###" caption="매출처수2" style="word-wrap:none; "/>
					<col ref="nosh2" type="output" format="(-)#,###" caption="매수2" style="word-wrap:none; "/>
					<col ref="suply_amt2" type="output" format="(-)#,###" caption="공급가액2" style="text-align:right; word-wrap:none; "/>
					<col ref="vat_amt2" type="output" format="(-)#,###" caption="부가세액2" style="text-align:right; word-wrap:none; "/>
					<col ref="sale_dlco_cnt3" type="output" format="(-)#,###" caption="매출처수3" style="word-wrap:none; "/>
					<col ref="nosh3" type="output" format="(-)#,###" caption="매수3" style="word-wrap:none; "/>
					<col ref="suply_amt3" type="output" format="(-)#,###" caption="공급가액3" style="text-align:right; word-wrap:none; "/>
					<col ref="vat_amt3" type="output" format="(-)#,###" caption="부가세액3" style="text-align:right; word-wrap:none; "/>
					<col ref="nul" type="output" visibility="hidden" caption="공란" style="word-wrap:none; "/>
				</datagrid>
			</case>
			<case id="case4">
				<datagrid id="datagrid10" nodeset="/root/resData/resForm/gridData10/record" caption="자료구분^세금구분^사업자번호^사업자명^거래수^공급가액^부가세액^합계" colsep="#" colwidth="80, 80, 120, 160, 80, 120, 100, 120" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" style="left:5px; top:5px; width:900px; height:440px; padding-right:10; background-position:center right; ">
					<col ref="data_clsf" type="output" caption="자료구분" style="word-wrap:none; "/>
					<col ref="tax_clsf" type="output" caption="공급자등록번호" style="word-wrap:none; "/>
					<col ref="ern" type="output" format="999-99-99999" caption="사업자번호" style="word-wrap:none; "/>
					<col ref="ern_nm" type="output" caption="사업자명" style="text-align:left; word-wrap:none; "/>
					<col ref="cnt" type="output" format="(-)#,###" caption="거래수" style="word-wrap:none; "/>
					<col ref="suply_amt" type="output" format="(-)#,###" caption="공급가액" style="text-align:right; word-wrap:none; "/>
					<col ref="vat_amt" type="output" format="(-)#,###" caption="부가세액" style="text-align:right; word-wrap:none; "/>
					<col ref="total_amt" type="output" format="(-)#,###" caption="합계" style="text-align:right; word-wrap:none; "/>
				</datagrid>
				<datagrid id="datagrid11" nodeset="/root/resData/resForm/gridData11/record" caption="^자료구분^공급자등록번호^매출처수1^매수1^공급가액1^부가세액1^합계1^공란" colsep="#" colwidth="80, 80, 120, 160, 80, 120, 100, 120" defaultrows="1" fixedcols="1" mergecellsfixedrows="bycolrec" rowsep="|" style="left:5px; top:455px; width:900px; height:60px; padding-right:10; background-position:center right; ">
					<col ref="lbl"/>
					<col ref="data_clsf" type="output" caption="자료구분" style="word-wrap:none; "/>
					<col ref="rec_suply_reg_no" type="output" format="999-99-99999" caption="공급자등록번호" style="word-wrap:none; "/>
					<col ref="sale_dlco_cnt1" type="output" format="(-)#,###" caption="매출처수1" style="word-wrap:none; "/>
					<col ref="nosh1" type="output" format="(-)#,###" caption="매수1" style="word-wrap:none; "/>
					<col ref="suply_amt1" type="output" format="(-)#,###" caption="공급가액1" style="text-align:right; word-wrap:none; "/>
					<col ref="vat_amt1" type="output" format="(-)#,###" caption="부가세액1" style="text-align:right; word-wrap:none; "/>
					<col ref="total_amt1" type="output" format="(-)#,###" caption="합계1" style="text-align:right; word-wrap:none; "/>
					<col ref="nul" type="output" visibility="hidden" caption="공란" style="word-wrap:none; "/>
				</datagrid>
			</case>
			<case id="case5">
				<datagrid id="datagrid12" nodeset="/root/resData/resForm/gridData12/record" caption="자료구분^세금구분^사업자번호^사업자명^거래수^공급가액^부가세액^합계" colsep="#" colwidth="80, 80, 120, 160, 80, 120, 100, 120" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" style="left:5px; top:5px; width:900px; height:440px; padding-right:10; background-position:center right; ">
					<col ref="data_clsf" type="output" caption="자료구분" style="word-wrap:none; "/>
					<col ref="tax_clsf" type="output" caption="공급자등록번호" style="word-wrap:none; "/>
					<col ref="ern" type="output" format="999-99-99999" caption="사업자번호" style="word-wrap:none; "/>
					<col ref="ern_nm" type="output" caption="사업자명" style="text-align:left; word-wrap:none; "/>
					<col ref="cnt" type="output" format="(-)#,###" caption="거래수" style="word-wrap:none; "/>
					<col ref="suply_amt" type="output" format="(-)#,###" caption="공급가액" style="text-align:right; word-wrap:none; "/>
					<col ref="vat_amt" type="output" format="(-)#,###" caption="부가세액" style="text-align:right; word-wrap:none; "/>
					<col ref="total_amt" type="output" format="(-)#,###" caption="합계" style="text-align:right; word-wrap:none; "/>
				</datagrid>
				<datagrid id="datagrid13" nodeset="/root/resData/resForm/gridData13/record" caption="^자료구분^공급자등록번호^매출처수1^매수1^공급가액1^부가세액1^합계1^공란" colsep="#" colwidth="80, 80, 120, 160, 80, 120, 100, 120" defaultrows="1" fixedcols="1" mergecellsfixedrows="bycolrec" rowsep="|" style="left:5px; top:455px; width:900px; height:60px; padding-right:10; background-position:center right; ">
					<col ref="lbl"/>
					<col ref="data_clsf" type="output" caption="자료구분" style="word-wrap:none; "/>
					<col ref="rec_suply_reg_no" type="output" format="999-99-99999" caption="공급자등록번호" style="word-wrap:none; "/>
					<col ref="sale_dlco_cnt1" type="output" format="(-)#,###" caption="매출처수1" style="word-wrap:none; "/>
					<col ref="nosh1" type="output" format="(-)#,###" caption="매수1" style="word-wrap:none; "/>
					<col ref="suply_amt1" type="output" format="(-)#,###" caption="공급가액1" style="text-align:right; word-wrap:none; "/>
					<col ref="vat_amt1" type="output" format="(-)#,###" caption="부가세액1" style="text-align:right; word-wrap:none; "/>
					<col ref="total_amt1" type="output" format="(-)#,###" caption="합계1" style="text-align:right; word-wrap:none; "/>
					<col ref="nul" type="output" visibility="hidden" caption="공란" style="word-wrap:none; "/>
				</datagrid>
			</case>
			<case id="case6">
				<datagrid id="datagrid6" nodeset="/root/resData/resForm/gridData6/record" caption="seq1^seq2^seq3^seq4^seq5^레코드구분^세무서^제출일^제출자구분^세무대리인관리번호^사업자번호^법인명^법인등록번호^대표자^소재지법정동코드^소재지법정동주소^전화번호^제출건수계^한글코드^내용" colsep="#" colwidth="30, 30, 30, 30, 30, 75, 49, 68, 69, 115, 80, 70, 99, 60, 110, 134, 80, 70, 60, 100" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" style="left:5px; top:5px; width:900px; height:505px; padding-right:10; background-position:center right; ">
					<col ref="seq1" type="output" visibility="hidden" caption="seq1" style="word-wrap:none; "/>
					<col ref="seq2" type="output" visibility="hidden" caption="seq2" style="word-wrap:none; "/>
					<col ref="seq3" type="output" visibility="hidden" caption="seq3" style="word-wrap:none; "/>
					<col ref="seq4" type="output" visibility="hidden" caption="seq4" style="word-wrap:none; "/>
					<col ref="seq5" type="output" visibility="hidden" caption="seq5" style="word-wrap:none; "/>
					<col ref="recd_clsf" type="output" caption="레코드구분" style="word-wrap:none; "/>
					<col ref="taxoff" type="output" caption="세무서" style="word-wrap:none; "/>
					<col ref="subm_ymd" type="output" format="9999-99-99" caption="제출일" style="word-wrap:none; "/>
					<col ref="subm_pers_clsf" type="output" caption="제출자구분" style="word-wrap:none; "/>
					<col ref="tax_agnt_no" type="output" caption="세무대리인관리번호" style="word-wrap:none; "/>
					<col ref="ern" type="output" format="999-99-99999" caption="사업자번호" style="word-wrap:none; "/>
					<col ref="corp_nm" type="output" caption="법인명" style="word-wrap:none; "/>
					<col ref="corp_reg_no" type="output" caption="법인등록번호" style="word-wrap:none; "/>
					<col ref="presi" type="output" caption="대표자" style="word-wrap:none; "/>
					<col ref="plcw_law_cd" type="output" format="999-999" caption="소재지법정동코드" style="word-wrap:none; "/>
					<col ref="plcw_law_addr" type="output" caption="소재지법정동주소" style="word-wrap:none; "/>
					<col ref="tel_no" type="output" caption="전화번호" style="word-wrap:none; "/>
					<col ref="subm_noit_tot" type="output" caption="제출건수계" style="word-wrap:none; "/>
					<col ref="use_korn_cd_kind" type="output" caption="사용한글코드종류" style="word-wrap:none; "/>
					<col ref="bill_sender" type="output" visibility="hidden" caption="내용" style="word-wrap:none; "/>
				</datagrid>
			</case>
			<case id="case7">
				<datagrid id="datagrid7" nodeset="/root/resData/resForm/gridData7/record" caption="seq1^seq2^seq3^seq4^seq5^레코드구분^세무서^일련번호^사업자번호^법인명^대표자^사업장법정동코드^사업장소재지^내용" colsep="#" colwidth="30, 30, 30, 30, 30, 80, 80, 60, 80, 120, 100, 110, 120, 30" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" style="left:5px; top:5px; width:900px; height:505px; padding-right:10; background-position:center right; ">
					<col ref="seq1" type="output" visibility="hidden" caption="seq1" style="word-wrap:none; "/>
					<col ref="seq2" type="output" visibility="hidden" caption="seq2" style="word-wrap:none; "/>
					<col ref="seq3" type="output" visibility="hidden" caption="seq3" style="word-wrap:none; "/>
					<col ref="seq4" type="output" visibility="hidden" caption="seq4" style="word-wrap:none; "/>
					<col ref="seq5" type="output" visibility="hidden" caption="seq5" style="word-wrap:none; "/>
					<col ref="recd_clsf" type="output" caption="레코드구분" style="word-wrap:none; "/>
					<col ref="taxoff" type="output" caption="세무서" style="word-wrap:none; "/>
					<col ref="seq" type="output" caption="일련번호" style="word-wrap:none; "/>
					<col ref="ern" type="output" format="999-99-99999" caption="사업자번호" style="word-wrap:none; "/>
					<col ref="corp_nm" type="output" caption="법인명" style="word-wrap:none; "/>
					<col ref="presi" type="output" caption="대표자" style="word-wrap:none; "/>
					<col ref="erplace_law_dstc_cd" type="output" format="999-999" caption="사업장법정동코드" style="word-wrap:none; "/>
					<col ref="erplace_plcw" type="output" caption="사업장소재지" style="word-wrap:none; "/>
					<col ref="bill_sender" type="output" visibility="hidden" caption="내용" style="word-wrap:none; "/>
				</datagrid>
			</case>
			<case id="case8" selected="true">
				<datagrid id="datagrid5_N" nodeset="/root/resData/resForm/gridData5_N/record" caption="seq1^seq2^seq3^seq4^seq5^레코드구분^자료구분^월구분^세무서^일련번호^제출사업자번호^귀속년도^거래시작일^거래종료일^작성일자^매출처수1^계산서매수1^음수표시1^매출금액1^매출처수2^계산서매수2^음수표시2^매출금액2^매출처수3^계산서매수3^음수표시3^매출금액3^내용" colsep="#" colwidth="30, 30, 30, 30, 30, 80, 60, 60, 80, 75, 100, 75, 80, 80, 80, 60, 75, 60, 100, 60, 75, 60, 100, 60, 75, 60, 100, 100" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" style="left:5px; top:455px; width:900px; height:60px; padding-right:10; background-position:center right; ">
					<col ref="seq1" type="output" visibility="hidden" caption="seq1" style="word-wrap:none; "/>
					<col ref="seq2" type="output" visibility="hidden" caption="seq2" style="word-wrap:none; "/>
					<col ref="seq3" type="output" visibility="hidden" caption="seq3" style="word-wrap:none; "/>
					<col ref="seq4" type="output" visibility="hidden" caption="seq4" style="word-wrap:none; "/>
					<col ref="seq5" type="output" visibility="hidden" caption="seq5" style="word-wrap:none; "/>
					<col ref="recd_clsf" type="output" caption="레코드구분" style="word-wrap:none; "/>
					<col ref="data_clsf" type="output" caption="자료구분" style="word-wrap:none; "/>
					<col ref="qt_clsf" type="output" caption="월구분" style="word-wrap:none; "/>
					<col ref="taxoff" type="output" caption="세무서" style="word-wrap:none; "/>
					<col ref="seq" type="output" caption="일련번호" style="word-wrap:none; "/>
					<col ref="subm_ern" type="output" format="999-99-99999" caption="제출사업자번호" style="word-wrap:none; "/>
					<col ref="rvrs_yy" type="output" caption="귀속년도" style="word-wrap:none; "/>
					<col ref="deal_prd_fr" type="output" format="yyyy-mm-dd" caption="거래시작일" style="word-wrap:none; "/>
					<col ref="deal_prd_to" type="output" format="yyyy-mm-dd" caption="거래종료일" style="word-wrap:none; "/>
					<col ref="make_dt" type="output" format="yyyy-mm-dd" caption="작성일자" style="word-wrap:none; "/>
					<col ref="sale_dlco_cnt1" type="output" format="(-)#,###" caption="매출처수1" style="word-wrap:none; "/>
					<col ref="stmt_nosh1" type="output" format="(-)#,###" caption="계산서매수1" style="word-wrap:none; "/>
					<col ref="minus_indc1" type="output" caption="음수표시1" style="word-wrap:none; "/>
					<col ref="sale_amt1" type="output" format="(-)#,###" caption="매출금액1" style="text-align:right; word-wrap:none; "/>
					<col ref="sale_dlco_cnt2" type="output" format="(-)#,###" caption="매출처수2" style="word-wrap:none; "/>
					<col ref="stmt_nosh2" type="output" format="(-)#,###" caption="계산서매수2" style="word-wrap:none; "/>
					<col ref="minus_indc2" type="output" caption="음수표시2" style="word-wrap:none; "/>
					<col ref="sale_amt2" type="output" format="(-)#,###" caption="매출금액2" style="text-align:right; word-wrap:none; "/>
					<col ref="sale_dlco_cnt3" type="output" format="(-)#,###" caption="매출처수3" style="word-wrap:none; "/>
					<col ref="stmt_nosh3" type="output" format="(-)#,###" caption="계산서매수3" style="word-wrap:none; "/>
					<col ref="minus_indc3" type="output" caption="음수표시3" style="word-wrap:none; "/>
					<col ref="sale_amt3" type="output" format="(-)#,###" caption="매출금액3" style="text-align:right; word-wrap:none; "/>
					<col ref="bill_sender" type="output" visibility="hidden" caption="내용" style="word-wrap:none; "/>
				</datagrid>
				<datagrid id="datagrid4_N" nodeset="/root/resData/resForm/gridData4_N/record" caption="^seq1^seq2^seq3^seq4^seq5^레코드구분^자료구분^월구분^세무서^일련번호^제출사업자번호^매출처사업자번호^법인명^계산서매수^음수표시^매출금액^내용" colsep="#" colwidth="30,60, 60, 60, 60, 60, 80, 80, 80, 80, 80, 120, 120, 150, 70, 60, 120, 100" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" style="left:5px; top:5px; width:900px; height:440px; padding-right:10; background-position:center right; ">
					<col checkvalue="Y,N" ref="select" type="checkbox"/>
					<col ref="seq1" type="output" visibility="hidden" caption="seq1" style="word-wrap:none; "/>
					<col ref="seq2" type="output" visibility="hidden" caption="seq2" style="word-wrap:none; "/>
					<col ref="seq3" type="output" visibility="hidden" caption="seq3" style="word-wrap:none; "/>
					<col ref="seq4" type="output" visibility="hidden" caption="seq4" style="word-wrap:none; "/>
					<col ref="seq5" type="output" visibility="hidden" caption="seq5" style="word-wrap:none; "/>
					<col ref="recd_clsf" type="output" caption="레코드구분" style="word-wrap:none; "/>
					<col ref="data_clsf" type="input" caption="자료구분" style="word-wrap:none; "/>
					<col ref="qt_clsf" type="output" caption="월구분" style="word-wrap:none; "/>
					<col ref="taxoff" type="output" caption="세무서" style="word-wrap:none; "/>
					<col ref="seq" type="output" caption="일련번호" style="word-wrap:none; "/>
					<col ref="subm_ern" type="output" format="999-99-99999" caption="제출사업자번호" style="word-wrap:none; "/>
					<col ref="sale_dlco_ern" type="input" format="999-99-99999" caption="매출처사업자번호" style="word-wrap:none; "/>
					<col ref="corp_nm" type="output" caption="법인명" style="text-align:left; word-wrap:none; "/>
					<col ref="stmt_nosh" type="input" format="(-)#,###" caption="계산서매수" style="word-wrap:none; "/>
					<col ref="minus_indc" type="input" caption="음수표시" style="word-wrap:none; "/>
					<col ref="sale_amt" type="input" format="(-)#,###" caption="매출금액" style="text-align:right; word-wrap:none; "/>
					<col ref="bill_sender" type="output" visibility="hidden" caption="내용" style="word-wrap:none; "/>
					<script type="javascript" ev:event="xforms-select">
						<![CDATA[
						var row = datagrid4_N.mouseRow;
						var col = datagrid4_N.mouseCol;
						
						if(row <  datagrid4_N.fixedRows){ //헤더 일괄선택시 		
							for(var i=datagrid4_N.fixedRows;i<datagrid4_N.rows; i++){ 
								var check_ok = false;
								for(var j=datagrid4_N.colRef("seq"); j<datagrid4_N.cols;j++){
									if(datagrid4_N.valueMatrix(i, j) != ""){
										check_ok = true;
										break;
									}
								}
								
								if(check_ok == true){
									datagrid4_N.addStatus(i, "update");
								}
								else{
									datagrid4_N.valueMatrix(i, datagrid4_N.colRef("select")) = "N";
									datagrid4_N.removeStatus(i, "update");
								}
							}		
						}
						else{					
							var check_ok = false;
							for(var j=datagrid4_N.colRef("seq"); j<datagrid4_N.cols;j++){
								if(datagrid4_N.valueMatrix(datagrid4_N.row, j) != ""){
									check_ok = true;
									break;
								}
							}
							if (check_ok == true ){
								datagrid4_N.addStatus(datagrid4_N.row, "update");
							}
							else{
								datagrid4_N.valueMatrix(datagrid4_N.row, datagrid4_N.colRef("select")) = "N";
								datagrid4_N.removeStatus(datagrid4_N.row, "update");
							}
						}
						
						datagrid4_N.refresh();
									
						]]>
					</script>
					<script type="javascript" ev:event="xforms-deselect">
						<![CDATA[
						if(datagrid4_N.row <  datagrid4_N.fixedRows){ //헤더 일괄선택시 		
							for(var i=datagrid4_N.fixedRows;i<datagrid4_N.rows; i++){ 
								datagrid4_N.valueMatrix(i, datagrid4_N.colRef("select")) = "N";
								datagrid4_N.removeStatus(i, "update");
							}		
						}else{
							datagrid4_N.removeStatus(datagrid4_N.row, "update");
						}
						datagrid4_N.refresh();
						
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						//var rows = datagrid9.rows - 1;
						var row  = datagrid4_N.row;
						var data_clsf = datagrid4_N.valueMatrix(row,datagrid4_N.colRef("data_clsf"));
						var ck_data_clsf = "";
						var seq = "";
						var new_seq = "";
						if(data_clsf == "17")
						{
							for(var i=1;i<row;i++)
							{
								ck_data_clsf = datagrid4_N.valueMatrix(i,datagrid4_N.colRef("data_clsf"));
								if(data_clsf == ck_data_clsf)
								{
									seq = datagrid4_N.valueMatrix(i,datagrid4_N.colRef("seq"));
								}
							}
							//alert("17::"+seq);
							if(seq != "")
							{
								new_seq = Number(seq) + 1;
								new_seq = String(new_seq);
								datagrid4_N.valueMatrix(row,datagrid4_N.colRef("seq")) = lpad(new_seq,6,"0");
							}								
							else
							{
								datagrid4_N.valueMatrix(row,datagrid4_N.colRef("seq")) = "000001";
							}								
						}
						else if(data_clsf == "18")
						{
							for(var i=1;i<row;i++)
							{
								ck_data_clsf = datagrid4_N.valueMatrix(i,datagrid4_N.colRef("data_clsf"));
								if(data_clsf == ck_data_clsf)
								{
									seq = datagrid4_N.valueMatrix(i,datagrid4_N.colRef("seq"));
								}
							}
							//alert("18::"+seq);
							if(seq != "")
							{
								new_seq = Number(seq) + 1;
								new_seq = String(new_seq);
								datagrid4_N.valueMatrix(row,datagrid4_N.colRef("seq")) = lpad(new_seq,6,"0");
							}
							else
							{
								datagrid4_N.valueMatrix(row,datagrid4_N.colRef("seq")) = "000001";
							}
						}
						datagrid4_N.refresh();
						]]>
					</script>
				</datagrid>
			</case>
			<case id="case9">
				<datagrid id="datagrid2_N" nodeset="/root/resData/resForm/gridData2_N/record" caption="^seq1^seq2^seq3^seq4^seq5^레코드구분^자료구분^월구분^세무서^일련번호^제출사업자번호^매출처사업자번호^법인명^계산서매수^음수표시^매출금액^내용" colsep="#" colwidth="30,60, 60, 60, 60, 60, 80, 80, 80, 80, 80, 120, 120, 150, 70, 60, 120, 100" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" style="left:5px; top:5px; width:900px; height:440px; padding-right:10; background-position:center right; ">
					<col checkvalue="Y,N" ref="select" type="checkbox"/>
					<col ref="seq1" type="output" visibility="hidden" caption="seq1" style="word-wrap:none; "/>
					<col ref="seq2" type="output" visibility="hidden" caption="seq2" style="word-wrap:none; "/>
					<col ref="seq3" type="output" visibility="hidden" caption="seq3" style="word-wrap:none; "/>
					<col ref="seq4" type="output" visibility="hidden" caption="seq4" style="word-wrap:none; "/>
					<col ref="seq5" type="output" visibility="hidden" caption="seq5" style="word-wrap:none; "/>
					<col ref="recd_clsf" type="output" caption="레코드구분" style="word-wrap:none; "/>
					<col ref="data_clsf" type="input" caption="자료구분" style="word-wrap:none; "/>
					<col ref="qt_clsf" type="output" caption="월구분" style="word-wrap:none; "/>
					<col ref="taxoff" type="output" caption="세무서" style="word-wrap:none; "/>
					<col ref="seq" type="output" caption="일련번호" style="word-wrap:none; "/>
					<col ref="subm_ern" type="output" format="999-99-99999" caption="제출사업자번호" style="word-wrap:none; "/>
					<col ref="sale_dlco_ern" type="input" format="999-99-99999" caption="매출처사업자번호" style="word-wrap:none; "/>
					<col ref="corp_nm" type="output" caption="법인명" style="text-align:left; word-wrap:none; "/>
					<col ref="stmt_nosh" type="input" format="(-)#,###" caption="계산서매수" style="word-wrap:none; "/>
					<col ref="minus_indc" type="input" caption="음수표시" style="word-wrap:none; "/>
					<col ref="sale_amt" type="input" format="(-)#,###" caption="매출금액" style="text-align:right; word-wrap:none; "/>
					<col ref="bill_sender" type="output" visibility="hidden" caption="내용" style="word-wrap:none; "/>
					<script type="javascript" ev:event="xforms-select">
						<![CDATA[
						var row = datagrid2_N.mouseRow;
						var col = datagrid2_N.mouseCol;
						
						if(row <  datagrid2_N.fixedRows){ //헤더 일괄선택시 		
							for(var i=datagrid2_N.fixedRows;i<datagrid2_N.rows; i++){ 
								var check_ok = false;
								for(var j=datagrid2_N.colRef("seq"); j<datagrid2_N.cols;j++){
									if(datagrid2_N.valueMatrix(i, j) != ""){
										check_ok = true;
										break;
									}
								}
								
								if(check_ok == true){
									datagrid2_N.addStatus(i, "update");
								}
								else{
									datagrid2_N.valueMatrix(i, datagrid2_N.colRef("select")) = "N";
									datagrid2_N.removeStatus(i, "update");
								}
							}		
						}
						else{					
							var check_ok = false;
							for(var j=datagrid2_N.colRef("seq"); j<datagrid2_N.cols;j++){
								if(datagrid2_N.valueMatrix(datagrid2_N.row, j) != ""){
									check_ok = true;
									break;
								}
							}
							if (check_ok == true ){
								datagrid2_N.addStatus(datagrid2_N.row, "update");
							}
							else{
								datagrid2_N.valueMatrix(datagrid2_N.row, datagrid2_N.colRef("select")) = "N";
								datagrid2_N.removeStatus(datagrid2_N.row, "update");
							}
						}
						
						datagrid2_N.refresh();
									
						]]>
					</script>
					<script type="javascript" ev:event="xforms-deselect">
						<![CDATA[
						if(datagrid2_N.row <  datagrid2_N.fixedRows){ //헤더 일괄선택시 		
							for(var i=datagrid2_N.fixedRows;i<datagrid2_N.rows; i++){ 
								datagrid2_N.valueMatrix(i, datagrid2_N.colRef("select")) = "N";
								datagrid2_N.removeStatus(i, "update");
							}		
						}else{
							datagrid2_N.removeStatus(datagrid2_N.row, "update");
						}
						datagrid2_N.refresh();
						
						]]>
					</script>
					<script type="javascript" ev:event="xforms-value-changed">
						<![CDATA[
						//var rows = datagrid9.rows - 1;
						var row  = datagrid2_N.row;
						var data_clsf = datagrid2_N.valueMatrix(row,datagrid2_N.colRef("data_clsf"));
						var ck_data_clsf = "";
						var seq = "";
						var new_seq = "";
						if(data_clsf == "17")
						{
							for(var i=1;i<row;i++)
							{
								ck_data_clsf = datagrid2_N.valueMatrix(i,datagrid2_N.colRef("data_clsf"));
								if(data_clsf == ck_data_clsf)
								{
									seq = datagrid2_N.valueMatrix(i,datagrid2_N.colRef("seq"));
								}
							}
							//alert("17::"+seq);
							if(seq != "")
							{
								new_seq = Number(seq) + 1;
								new_seq = String(new_seq);
								datagrid2_N.valueMatrix(row,datagrid2_N.colRef("seq")) = lpad(new_seq,6,"0");
							}								
							else
							{
								datagrid2_N.valueMatrix(row,datagrid2_N.colRef("seq")) = "000001";
							}								
						}
						else if(data_clsf == "18")
						{
							for(var i=1;i<row;i++)
							{
								ck_data_clsf = datagrid2_N.valueMatrix(i,datagrid2_N.colRef("data_clsf"));
								if(data_clsf == ck_data_clsf)
								{
									seq = datagrid2_N.valueMatrix(i,datagrid2_N.colRef("seq"));
								}
							}
							//alert("18::"+seq);
							if(seq != "")
							{
								new_seq = Number(seq) + 1;
								new_seq = String(new_seq);
								datagrid2_N.valueMatrix(row,datagrid2_N.colRef("seq")) = lpad(new_seq,6,"0");
							}
							else
							{
								datagrid2_N.valueMatrix(row,datagrid2_N.colRef("seq")) = "000001";
							}
						}
						datagrid2_N.refresh();
						]]>
					</script>
				</datagrid>
				<datagrid id="datagrid3_N" nodeset="/root/resData/resForm/gridData3_N/record" caption="seq1^seq2^seq3^seq4^seq5^레코드구분^자료구분^월구분^세무서^일련번호^제출사업자번호^귀속년도^거래시작일^거래종료일^작성일자^매출처수1^계산서매수1^음수표시1^매출금액1^매출처수2^계산서매수2^음수표시2^매출금액2^매출처수3^계산서매수3^음수표시3^매출금액3^내용" colsep="#" colwidth="30, 30, 30, 30, 30, 80, 60, 60, 80, 75, 100, 75, 80, 80, 80, 60, 75, 60, 100, 60, 75, 60, 100, 60, 75, 60, 100, 100" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" style="left:5px; top:455px; width:900px; height:60px; padding-right:10; background-position:center right; ">
					<col ref="seq1" type="output" visibility="hidden" caption="seq1" style="word-wrap:none; "/>
					<col ref="seq2" type="output" visibility="hidden" caption="seq2" style="word-wrap:none; "/>
					<col ref="seq3" type="output" visibility="hidden" caption="seq3" style="word-wrap:none; "/>
					<col ref="seq4" type="output" visibility="hidden" caption="seq4" style="word-wrap:none; "/>
					<col ref="seq5" type="output" visibility="hidden" caption="seq5" style="word-wrap:none; "/>
					<col ref="recd_clsf" type="output" caption="레코드구분" style="word-wrap:none; "/>
					<col ref="data_clsf" type="output" caption="자료구분" style="word-wrap:none; "/>
					<col ref="qt_clsf" type="output" caption="월구분" style="word-wrap:none; "/>
					<col ref="taxoff" type="output" caption="세무서" style="word-wrap:none; "/>
					<col ref="seq" type="output" caption="일련번호" style="word-wrap:none; "/>
					<col ref="subm_ern" type="output" format="999-99-99999" caption="제출사업자번호" style="word-wrap:none; "/>
					<col ref="rvrs_yy" type="output" caption="귀속년도" style="word-wrap:none; "/>
					<col ref="deal_prd_fr" type="output" format="yyyy-mm-dd" caption="거래시작일" style="word-wrap:none; "/>
					<col ref="deal_prd_to" type="output" format="yyyy-mm-dd" caption="거래종료일" style="word-wrap:none; "/>
					<col ref="make_dt" type="output" format="yyyy-mm-dd" caption="작성일자" style="word-wrap:none; "/>
					<col ref="sale_dlco_cnt1" type="output" format="(-)#,###" caption="매출처수1" style="word-wrap:none; "/>
					<col ref="stmt_nosh1" type="output" format="(-)#,###" caption="계산서매수1" style="word-wrap:none; "/>
					<col ref="minus_indc1" type="output" caption="음수표시1" style="word-wrap:none; "/>
					<col ref="sale_amt1" type="output" format="(-)#,###" caption="매출금액1" style="text-align:right; word-wrap:none; "/>
					<col ref="sale_dlco_cnt2" type="output" format="(-)#,###" caption="매출처수2" style="word-wrap:none; "/>
					<col ref="stmt_nosh2" type="output" format="(-)#,###" caption="계산서매수2" style="word-wrap:none; "/>
					<col ref="minus_indc2" type="output" caption="음수표시2" style="word-wrap:none; "/>
					<col ref="sale_amt2" type="output" format="(-)#,###" caption="매출금액2" style="text-align:right; word-wrap:none; "/>
					<col ref="sale_dlco_cnt3" type="output" format="(-)#,###" caption="매출처수3" style="word-wrap:none; "/>
					<col ref="stmt_nosh3" type="output" format="(-)#,###" caption="계산서매수3" style="word-wrap:none; "/>
					<col ref="minus_indc3" type="output" caption="음수표시3" style="word-wrap:none; "/>
					<col ref="sale_amt3" type="output" format="(-)#,###" caption="매출금액3" style="text-align:right; word-wrap:none; "/>
					<col ref="bill_sender" type="output" visibility="hidden" caption="내용" style="word-wrap:none; "/>
				</datagrid>
			</case>
			<case id="case10">
				<datagrid id="datagrid10_N" nodeset="/root/resData/resForm/gridData10_N/record" caption="seq1^seq2^seq3^seq4^seq5^레코드구분^자료구분^월구분^세무서^일련번호^제출사업자번호^귀속년도^거래시작일^거래종료일^작성일자^매출처수1^계산서매수1^음수표시1^매출금액1^매출처수2^계산서매수2^음수표시2^매출금액2^매출처수3^계산서매수3^음수표시3^매출금액3^내용" colsep="#" colwidth="30, 30, 30, 30, 30, 80, 60, 60, 80, 75, 100, 75, 80, 80, 80, 60, 75, 60, 100, 60, 75, 60, 100, 60, 75, 60, 100, 100" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" style="left:5px; top:455px; width:900px; height:60px; padding-right:10; background-position:center right; ">
					<col ref="seq1" type="output" visibility="hidden" caption="seq1" style="word-wrap:none; "/>
					<col ref="seq2" type="output" visibility="hidden" caption="seq2" style="word-wrap:none; "/>
					<col ref="seq3" type="output" visibility="hidden" caption="seq3" style="word-wrap:none; "/>
					<col ref="seq4" type="output" visibility="hidden" caption="seq4" style="word-wrap:none; "/>
					<col ref="seq5" type="output" visibility="hidden" caption="seq5" style="word-wrap:none; "/>
					<col ref="recd_clsf" type="output" caption="레코드구분" style="word-wrap:none; "/>
					<col ref="data_clsf" type="output" caption="자료구분" style="word-wrap:none; "/>
					<col ref="qt_clsf" type="output" caption="월구분" style="word-wrap:none; "/>
					<col ref="taxoff" type="output" caption="세무서" style="word-wrap:none; "/>
					<col ref="seq" type="output" caption="일련번호" style="word-wrap:none; "/>
					<col ref="subm_ern" type="output" format="999-99-99999" caption="제출사업자번호" style="word-wrap:none; "/>
					<col ref="rvrs_yy" type="output" caption="귀속년도" style="word-wrap:none; "/>
					<col ref="deal_prd_fr" type="output" format="yyyy-mm-dd" caption="거래시작일" style="word-wrap:none; "/>
					<col ref="deal_prd_to" type="output" format="yyyy-mm-dd" caption="거래종료일" style="word-wrap:none; "/>
					<col ref="make_dt" type="output" format="yyyy-mm-dd" caption="작성일자" style="word-wrap:none; "/>
					<col ref="sale_dlco_cnt1" type="output" format="(-)#,###" caption="매출처수1" style="word-wrap:none; "/>
					<col ref="stmt_nosh1" type="output" format="(-)#,###" caption="계산서매수1" style="word-wrap:none; "/>
					<col ref="minus_indc1" type="output" caption="음수표시1" style="word-wrap:none; "/>
					<col ref="sale_amt1" type="output" format="(-)#,###" caption="매출금액1" style="text-align:right; word-wrap:none; "/>
					<col ref="sale_dlco_cnt2" type="output" format="(-)#,###" caption="매출처수2" style="word-wrap:none; "/>
					<col ref="stmt_nosh2" type="output" format="(-)#,###" caption="계산서매수2" style="word-wrap:none; "/>
					<col ref="minus_indc2" type="output" caption="음수표시2" style="word-wrap:none; "/>
					<col ref="sale_amt2" type="output" format="(-)#,###" caption="매출금액2" style="text-align:right; word-wrap:none; "/>
					<col ref="sale_dlco_cnt3" type="output" format="(-)#,###" caption="매출처수3" style="word-wrap:none; "/>
					<col ref="stmt_nosh3" type="output" format="(-)#,###" caption="계산서매수3" style="word-wrap:none; "/>
					<col ref="minus_indc3" type="output" caption="음수표시3" style="word-wrap:none; "/>
					<col ref="sale_amt3" type="output" format="(-)#,###" caption="매출금액3" style="text-align:right; word-wrap:none; "/>
					<col ref="bill_sender" type="output" visibility="hidden" caption="내용" style="word-wrap:none; "/>
				</datagrid>
				<datagrid id="datagrid11_N" nodeset="/root/resData/resForm/gridData11_N/record" caption="자료구분^세금구분^사업자번호^사업자명^거래수^공급가액^부가세액^합계" colsep="#" colwidth="80, 80, 120, 160, 80, 120, 100, 120" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" style="left:5px; top:5px; width:900px; height:440px; padding-right:10; background-position:center right; ">
					<col ref="data_clsf" type="output" caption="자료구분" style="word-wrap:none; "/>
					<col ref="tax_clsf" type="output" caption="공급자등록번호" style="word-wrap:none; "/>
					<col ref="ern" type="output" format="999-99-99999" caption="사업자번호" style="word-wrap:none; "/>
					<col ref="ern_nm" type="output" caption="사업자명" style="text-align:left; word-wrap:none; "/>
					<col ref="cnt" type="output" format="(-)#,###" caption="거래수" style="word-wrap:none; "/>
					<col ref="suply_amt" type="output" format="(-)#,###" caption="공급가액" style="text-align:right; word-wrap:none; "/>
					<col ref="vat_amt" type="output" format="(-)#,###" caption="부가세액" style="text-align:right; word-wrap:none; "/>
					<col ref="total_amt" type="output" format="(-)#,###" caption="합계" style="text-align:right; word-wrap:none; "/>
				</datagrid>
			</case>
			<case id="case11">
				<datagrid id="datagrid12_N" nodeset="/root/resData/resForm/gridData12_N/record" caption="seq1^seq2^seq3^seq4^seq5^레코드구분^자료구분^월구분^세무서^일련번호^제출사업자번호^귀속년도^거래시작일^거래종료일^작성일자^매출처수1^계산서매수1^음수표시1^매출금액1^매출처수2^계산서매수2^음수표시2^매출금액2^매출처수3^계산서매수3^음수표시3^매출금액3^내용" colsep="#" colwidth="30, 30, 30, 30, 30, 80, 60, 60, 80, 75, 100, 75, 80, 80, 80, 60, 75, 60, 100, 60, 75, 60, 100, 60, 75, 60, 100, 100" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" style="left:5px; top:455px; width:900px; height:60px; padding-right:10; background-position:center right; ">
					<col ref="seq1" type="output" visibility="hidden" caption="seq1" style="word-wrap:none; "/>
					<col ref="seq2" type="output" visibility="hidden" caption="seq2" style="word-wrap:none; "/>
					<col ref="seq3" type="output" visibility="hidden" caption="seq3" style="word-wrap:none; "/>
					<col ref="seq4" type="output" visibility="hidden" caption="seq4" style="word-wrap:none; "/>
					<col ref="seq5" type="output" visibility="hidden" caption="seq5" style="word-wrap:none; "/>
					<col ref="recd_clsf" type="output" caption="레코드구분" style="word-wrap:none; "/>
					<col ref="data_clsf" type="output" caption="자료구분" style="word-wrap:none; "/>
					<col ref="qt_clsf" type="output" caption="월구분" style="word-wrap:none; "/>
					<col ref="taxoff" type="output" caption="세무서" style="word-wrap:none; "/>
					<col ref="seq" type="output" caption="일련번호" style="word-wrap:none; "/>
					<col ref="subm_ern" type="output" format="999-99-99999" caption="제출사업자번호" style="word-wrap:none; "/>
					<col ref="rvrs_yy" type="output" caption="귀속년도" style="word-wrap:none; "/>
					<col ref="deal_prd_fr" type="output" format="yyyy-mm-dd" caption="거래시작일" style="word-wrap:none; "/>
					<col ref="deal_prd_to" type="output" format="yyyy-mm-dd" caption="거래종료일" style="word-wrap:none; "/>
					<col ref="make_dt" type="output" format="yyyy-mm-dd" caption="작성일자" style="word-wrap:none; "/>
					<col ref="sale_dlco_cnt1" type="output" format="(-)#,###" caption="매출처수1" style="word-wrap:none; "/>
					<col ref="stmt_nosh1" type="output" format="(-)#,###" caption="계산서매수1" style="word-wrap:none; "/>
					<col ref="minus_indc1" type="output" caption="음수표시1" style="word-wrap:none; "/>
					<col ref="sale_amt1" type="output" format="(-)#,###" caption="매출금액1" style="text-align:right; word-wrap:none; "/>
					<col ref="sale_dlco_cnt2" type="output" format="(-)#,###" caption="매출처수2" style="word-wrap:none; "/>
					<col ref="stmt_nosh2" type="output" format="(-)#,###" caption="계산서매수2" style="word-wrap:none; "/>
					<col ref="minus_indc2" type="output" caption="음수표시2" style="word-wrap:none; "/>
					<col ref="sale_amt2" type="output" format="(-)#,###" caption="매출금액2" style="text-align:right; word-wrap:none; "/>
					<col ref="sale_dlco_cnt3" type="output" format="(-)#,###" caption="매출처수3" style="word-wrap:none; "/>
					<col ref="stmt_nosh3" type="output" format="(-)#,###" caption="계산서매수3" style="word-wrap:none; "/>
					<col ref="minus_indc3" type="output" caption="음수표시3" style="word-wrap:none; "/>
					<col ref="sale_amt3" type="output" format="(-)#,###" caption="매출금액3" style="text-align:right; word-wrap:none; "/>
					<col ref="bill_sender" type="output" visibility="hidden" caption="내용" style="word-wrap:none; "/>
				</datagrid>
				<datagrid id="datagrid13_N" nodeset="/root/resData/resForm/gridData13_N/record" caption="자료구분^세금구분^사업자번호^사업자명^거래수^공급가액^부가세액^합계" colsep="#" colwidth="80, 80, 120, 160, 80, 120, 100, 120" explorerbar="sort" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" selectionmode="byrow" style="left:5px; top:5px; width:900px; height:440px; padding-right:10; background-position:center right; ">
					<col ref="data_clsf" type="output" caption="자료구분" style="word-wrap:none; "/>
					<col ref="tax_clsf" type="output" caption="공급자등록번호" style="word-wrap:none; "/>
					<col ref="ern" type="output" format="999-99-99999" caption="사업자번호" style="word-wrap:none; "/>
					<col ref="ern_nm" type="output" caption="사업자명" style="text-align:left; word-wrap:none; "/>
					<col ref="cnt" type="output" format="(-)#,###" caption="거래수" style="word-wrap:none; "/>
					<col ref="suply_amt" type="output" format="(-)#,###" caption="공급가액" style="text-align:right; word-wrap:none; "/>
					<col ref="vat_amt" type="output" format="(-)#,###" caption="부가세액" style="text-align:right; word-wrap:none; "/>
					<col ref="total_amt" type="output" format="(-)#,###" caption="합계" style="text-align:right; word-wrap:none; "/>
				</datagrid>
			</case>
		</switch>
		<button id="button11" class="tab05" group="tab" selected="true" crud="R" style="left:10px; top:163px; width:105px; height:23px; ">
			<caption>표지자료</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case1");
				rowBtnState("0");
				]]>
			</script>
		</button>
		<button id="button12" class="tab05" group="tab" crud="R" style="left:102px; top:163px; width:92px; height:23px; ">
			<caption>매출</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case2");	
				rowBtnState("1");
				]]>
			</script>
		</button>
		<button id="button13" class="tab05" group="tab" crud="R" style="left:194px; top:163px; width:92px; height:23px; ">
			<caption>매입</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case3");	
				rowBtnState("1");
				]]>
			</script>
		</button>
		<button id="button15" class="tab05" group="tab" crud="R" style="left:378px; top:163px; width:92px; height:23px; ">
			<caption>전자매입</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case5");	
				rowBtnState("0");
				]]>
			</script>
		</button>
		<button id="button14" class="tab05" group="tab" crud="R" style="left:286px; top:163px; width:92px; height:23px; ">
			<caption>전자매출</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				model.toggle("case4");	
				rowBtnState("0");
				]]>
			</script>
		</button>
		<caption id="caption3" class="list_cap03" style="left:75px; top:725px; width:100px; height:25px; text-align:center; ">매출계산서</caption>
		<caption id="caption5" class="list_cap03" style="left:470px; top:725px; width:100px; height:25px; text-align:center; ">매입계산서</caption>
		<input id="fileh" ref="/root/reqData/reqForm/fileh" style="left:185px; top:728px; width:245px; height:18px; "/>
		<input id="filei" ref="/root/reqData/reqForm/filei" style="left:580px; top:728px; width:245px; height:18px; "/>
		<button id="btn_rowInsert" class="btn_grid03" crud="C" style="left:816px; top:165px; width:53px; height:17px; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if(switch1.selectedIndex == 1){
						addRow(datagrid2);
						if(datagrid2.rows == 2){
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("select") ) 				= "Y";
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("data_clsf") ) 			= "1";
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("suply_pers_reg_no") ) 	= "";
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("seq") )                  = "0001";
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("whosal_cd") )            = "0";
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("retail_cd") )            = "0";
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("vol_no") )           	= "7001";
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("subm_paper") )           = "104";
						}else{
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("select") ) 				= "Y";
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("data_clsf") ) 			= datagrid2.valueMatrix( datagrid2.rows-2, datagrid2.colRef("data_clsf") );
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("suply_pers_reg_no") ) 	= datagrid2.valueMatrix( datagrid2.rows-2, datagrid2.colRef("suply_pers_reg_no") );
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("whosal_cd") )            = "0";
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("retail_cd") )            = "0";
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("vol_no") )           	= "7001";
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("subm_paper") )           = "104";
							
							var seq = datagrid2.valueMatrix( datagrid2.rows-2, datagrid2.colRef("seq") );
							var new_seq = Number(seq) + 1;
							new_seq = String(new_seq);
							datagrid2.valueMatrix( datagrid2.rows-1, datagrid2.colRef("seq") )                  = lpad(new_seq,4,"0");
						}
						datagrid2.addStatus(datagrid2.rows-1, "insert");
						datagrid2.refresh();
					}
					else if(switch1.selectedIndex == 2){
						addRow(datagrid4);
						if(datagrid4.rows == 2){
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("select") ) 				= "Y";
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("data_clsf") ) 			= "2";
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("rec_suply_reg_no") )     = "";
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("seq") )                  = "0001";
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("whosal_cd") )            = "0";
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("retail_cd") )            = "0";
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("vol_no") )           	= "8001";
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("subm_paper") )           = "104";							
						}else{
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("select") ) 				= "Y";
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("data_clsf") ) 			= datagrid4.valueMatrix( datagrid4.rows-2, datagrid4.colRef("data_clsf") );
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("rec_suply_reg_no") ) 	= datagrid4.valueMatrix( datagrid4.rows-2, datagrid4.colRef("rec_suply_reg_no") );
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("whosal_cd") )            = "0";
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("retail_cd") )            = "0";
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("vol_no") )           	= "8001";
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("subm_paper") )           = "104";
							
							var seq = datagrid4.valueMatrix( datagrid4.rows-2, datagrid4.colRef("seq") );
							var new_seq = Number(seq) + 1;
							new_seq = String(new_seq);
							datagrid4.valueMatrix( datagrid4.rows-1, datagrid4.colRef("seq") )                  = lpad(new_seq,4,"0");
						}		
						datagrid4.addStatus(datagrid4.rows-1, "insert");
						datagrid4.refresh();
					}
					else if(switch1.selectedIndex == 8){
						addRow(datagrid4_N);
						if(datagrid4_N.rows == 2){
							datagrid4_N.valueMatrix( datagrid4_N.rows-1, datagrid4_N.colRef("select") ) 				= "Y";
							datagrid4_N.valueMatrix( datagrid4_N.rows-1, datagrid4_N.colRef("recd_clsf") ) 			= "D";
							datagrid4_N.valueMatrix( datagrid4_N.rows-1, datagrid4_N.colRef("subm_ern") ) 			= "";
							datagrid4_N.valueMatrix( datagrid4_N.rows-1, datagrid4_N.colRef("seq") )                  = "000001";
							datagrid4_N.valueMatrix( datagrid4_N.rows-1, datagrid4_N.colRef("taxoff") )               = "104";
						}else{
							datagrid4_N.valueMatrix( datagrid4_N.rows-1, datagrid4_N.colRef("select") ) 				= "Y";
							datagrid4_N.valueMatrix( datagrid4_N.rows-1, datagrid4_N.colRef("recd_clsf") ) 			= datagrid4_N.valueMatrix( datagrid4_N.rows-2, datagrid4_N.colRef("recd_clsf") );
							datagrid4_N.valueMatrix( datagrid4_N.rows-1, datagrid4_N.colRef("subm_ern") ) 			= datagrid4_N.valueMatrix( datagrid4_N.rows-2, datagrid4_N.colRef("subm_ern") );
							datagrid4_N.valueMatrix( datagrid4_N.rows-1, datagrid4_N.colRef("taxoff") )               = datagrid4_N.valueMatrix( datagrid4_N.rows-2, datagrid4_N.colRef("taxoff") );
						}		
						datagrid4_N.addStatus(datagrid4_N.rows-1, "insert");
						datagrid4_N.refresh();
					}
				]]>
			</script>
		</button>
		<button id="btn_rowCancel" class="btn_grid02" crud="C" style="left:874px; top:165px; width:43px; height:17px; ">
			<caption>취소</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if(switch1.selectedIndex == 1){
						cancelRow(datagrid2);
					}
					else if(switch1.selectedIndex == 2){
						cancelRow(datagrid4);
					}
					else if(switch1.selectedIndex == 8){
						cancelRow(datagrid4_N);
					}
				]]>
			</script>
		</button>
		<button id="btn_rowDelete" class="btn_grid03" crud="C" style="left:757px; top:165px; width:53px; height:17px; ">
			<caption>행삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					if(switch1.selectedIndex == 1){
//						datagrid2.removeRow();
						deleteRow(datagrid2);
					}
					else if(switch1.selectedIndex == 2){
//						datagrid4.removeRow();
						deleteRow(datagrid4);
					}
					else if(switch1.selectedIndex == 8){
//						datagrid9.removeRow();
						deleteRow(datagrid4_N);
					}
				]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
