<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>공통수입결의등록(FC_ACCT_2120_500)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session>
							<uid/>
							<cmpy_cd/>
							<emp_no/>
							<emp_nm/>
							<dept_cd/>
							<dept_nm/>
						</session>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
							<fc_acct_2120_m>
								<dataSet>
									<DLCO_CLSF_CD_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</DLCO_CLSF_CD_CURLIST>
									<ELEC_TAX_COMP_CD>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</ELEC_TAX_COMP_CD>
									<G2_NOTE_CLSF_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</G2_NOTE_CLSF_CURLIST>
									<PROF_KIND_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</PROF_KIND_CURLIST>
									<G2_ISSU_CMPY_CD_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</G2_ISSU_CMPY_CD_CURLIST>
									<G2_RCPM_ACCT_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</G2_RCPM_ACCT_CURLIST>
									<ERPLACE_CD_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</ERPLACE_CD_CURLIST>
									<RCPM_SHET_KIND_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</RCPM_SHET_KIND_CURLIST>
									<G1_MANG_CLSF_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</G1_MANG_CLSF_CURLIST>
									<SLIP_CLSF_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</SLIP_CLSF_CURLIST>
									<G1_FRCR_CLSF_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</G1_FRCR_CLSF_CURLIST>
									<G3_WHCO_SLIP_CLSF_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</G3_WHCO_SLIP_CLSF_CURLIST>
									<MEDI_CD_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</MEDI_CD_CURLIST>
									<CHNL_CLSF_CD_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CHNL_CLSF_CD_CURLIST>
								</dataSet>
							</fc_acct_2120_m>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<popupSet>
							<fc_co_8001_s>
								<dataSet>
									<CURLIST>
										<record>
											<budg_cdnm/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_co_8001_s>
						</popupSet>
						<pageInfo>
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData/>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<tax_stmt_no/>
							<cmpy_cd/>
							<slip_clsf_cd/>
							<slip_occr_dt/>
							<slip_seq/>
							<rcpm_slip_occr_dt/>
							<rcpm_slip_clsf_cd/>
							<rcpm_slip_seq/>
							<dept_cd/>
							<emp_no/>
							<budg_cd/>
							<uid/>
							<select_ch/>
							<use_end_dt/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqform>
							<cmpy_cd/>
							<prof_type_cd/>
							<slip_clsf_cd/>
							<slip_occr_dt/>
							<slip_seq/>
							<bank_cd/>
							<note_no/>
							<slip_rcpm_dt/>
							<in_igyb/>
							<rcpm_shet_kind/>
							<rcpm_shet_no/>
							<whco_slip_clsf/>
							<whco_slip_no/>
							<rcpm_amt/>
							<incmg_pers/>
							<incmg_pers_ipadd/>
						</reqform>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpDate>
							<cmpy_cd/>
							<mode/>
							<reg_clsf/>
							<prof_type_cd/>
							<slip_clsf_cd/>
							<slip_occr_dt/>
							<slip_seq/>
							<make_dt/>
							<erplace_cd/>
							<dlco_clsf_cd/>
							<dlco_cd/>
							<deal_clsf/>
							<ern/>
							<dlco_nm/>
							<boks_dlco_nm/>
							<presi_nm/>
							<addr/>
							<bizcond/>
							<item/>
							<evnt_cd/>
							<suply_amt/>
							<vat_amt/>
							<tax_stmt_aprv_yn/>
							<rcpt_nosh/>
							<sg_budg_cd/>
							<ask_emp_no/>
							<ask_dept_cd/>
							<rcpm_plan_dd/>
							<incmg_pers/>
							<incmg_pers_ipadd/>
							<sgtitem/>
							<medi_cd/>
							<dtls_medi_cd/>
							<vexc_cmpy_cd/>
							<draft_doc_no/>
							<draft_impt_amt/>
							<draft_expn_amt/>
							<in_igyb/>
							<slip_rcpm_dt/>
							<rcpm_shet_kind/>
							<rcpm_shet_no/>
							<g0_rcpm_amt/>
							<multiUpdateData1/>
							<multiUpdateData2/>
							<multiUpdateData3/>
							<make_upd_dt/>
							<upd_tms/>
							<last_upd_dd/>
							<rcpm_slip_no/>
							<exrate_diff_yn/>
							<etc_in_yn/>
							<stmt_rmtt_yn/>
							<unit/>
							<qunt/>
							<code_cd/>
							<email/>
							<chnl_clsf_cd/>
						</multiUpDate>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resform>
							<reg_clsf/>
							<intg_dlco_cd/>
							<boks_dlco_nm/>
							<exrate_diff_yn/>
							<etc_in_yn/>
							<stmt_slip_no/>
							<stmt_rmtt_yn/>
							<rcpm_slip_no/>
							<rcpm_amt/>
							<draft_doc_no/>
							<draft_dept_cd/>
							<rcpm_slip_no2/>
						</resform>
						<resform3>
							<fc_acct_2013_s>
								<dataSet>
									<CURLIST>
										<record>
											<clsf_yn/>
											<draft_expn_amt/>
											<draft_impt_amt/>
											<dr_amt/>
											<crdt_amt/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_2013_s>
						</resform3>
						<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<gridData>
							<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
							<gridData1>
								<dataSet>
									<CURLIST2>
										<record>
											<rcpm_slip_no2/>
										</record>
									</CURLIST2>
									<CURLIST1>
										<record>
											<rcpm_slip_no/>
										</record>
									</CURLIST1>
									<CURLIST>
										<record>
											<prof_type_cd/>
											<slip_clsf_cd/>
											<slip_occr_dt/>
											<slip_seq/>
											<occr_slip_occr_dt/>
											<occr_slip_clsf_cd/>
											<occr_slip_seq/>
											<occr_slip_sub_seq/>
											<occr_slip_arow_no/>
											<make_dt/>
											<erplace_cd/>
											<dlco_clsf_cd/>
											<dlco_cd/>
											<deal_clsf/>
											<ern/>
											<dlco_nm/>
											<boks_dlco_nm/>
											<presi_nm/>
											<addr/>
											<bizcond/>
											<presi_item/>
											<suply_amt/>
											<vat_amt/>
											<tax_stmt_aprv_yn/>
											<upd_tms/>
											<rcpt_nosh/>
											<budg_cd/>
											<budg_cd_nm/>
											<ask_emp_no/>
											<ask_emp_nm/>
											<ask_dept_cd/>
											<ask_dept_nm/>
											<rcpm_plan_dt/>
											<item/>
											<medi_cd/>
											<remk/>
											<evnt_cd/>
											<evnt_cd_nm/>
											<dtls_medi_cd/>
											<dtls_medi_cd_nm/>
											<draft_doc_no/>
											<draft_impt_amt/>
											<draft_expn_amt/>
											<rcpm_amt/>
											<vexc_cmpy_cd/>
											<vexc_cmpy_cd_ern/>
											<vexc_cmpy_cd_nm/>
											<reg_clsf/>
											<unit/>
											<qunt/>
											<mang_clsf_cd/>
											<email/>
											<semuro_no/>
											<elec_tax_comp_cd/>
											<chnl_clsf_cd>10</chnl_clsf_cd>
										</record>
									</CURLIST>
								</dataSet>
							</gridData1>
							<gridData2>
								<dataSet>
									<CURLIST4>
										<record>
											<rcpm_shet_kind/>
											<rcpm_shet_no/>
											<rcpm_slip_no2/>
											<rcpm_amt/>
										</record>
									</CURLIST4>
									<CURLIST3>
										<record>
											<g3_rcpm_sub_seq/>
											<g3_budg_cd/>
											<g3_budg_cd_nm/>
											<g3_rcpm_amt/>
											<g3_whco_slip_clsf/>
											<g3_whco_slip_no/>
										</record>
									</CURLIST3>
									<CURLIST2>
										<record>
											<g2_rcpm_sub_seq/>
											<g2_note_no/>
											<g2_rcpm_amt/>
											<g2_note_clsf_cd/>
											<g2_bank_cd/>
											<g2_bank_cd_nm/>
											<g2_issu_pers_nm/>
											<g2_issu_cmpy_clsf_cd/>
											<g2_comp_dt/>
											<g2_mtry_dt/>
											<g2_rcpm_acct/>
											<g2_sale_aprv_no/>
										</record>
									</CURLIST2>
									<CURLIST1>
										<record>
											<g1_rcpm_slip_seq/>
											<g1_rcpm_dt/>
											<g1_rcpm_amt/>
											<g1_rcpm_pers_nm/>
											<g1_deps_psbk/>
											<g1_coms/>
											<g1_frex_clsf/>
											<g1_exrate/>
											<g1_frex_amt/>
											<biz_reg_no/>
											<bank_id/>
											<acct_num/>
											<tran_date_seq/>
											<current_clsf/>
										</record>
									</CURLIST1>
									<CURLIST>
										<record>
											<rcpm_amt/>
										</record>
									</CURLIST>
								</dataSet>
							</gridData2>
							<popupData>
								<bank_cd/>
								<bank_cd_nm/>
							</popupData>
							<fc_acct_2126_s>
								<dataSet>
									<CUR_MANG_ITEM_CD_LIST>
										<record>
											<mang_item_cd/>
											<drcr_clsf/>
											<mang_item_val/>
										</record>
									</CUR_MANG_ITEM_CD_LIST>
									<CUR_MANG_ITEM_CD_LIST1>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CUR_MANG_ITEM_CD_LIST1>
								</dataSet>
							</fc_acct_2126_s>
						</gridData>
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<keyData/>
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<fc_co_1101_l>
							<dataSet>
								<CURLIST1>
									<record>
										<cmpy_cd/>
										<dept_cd/>
										<dept_team_clsf/>
										<abrv_nm/>
										<offi_nm/>
										<dept_team_nm/>
										<part_nm/>
										<part_dn_nm/>
									</record>
								</CURLIST1>
							</dataSet>
						</fc_co_1101_l>
						<amt/>
						<medi_ch/>
						<fc_acct_2015_l>
							<dataSet>
								<CURLIST>
									<record>
										<cd/>
										<cdnm/>
									</record>
								</CURLIST>
							</dataSet>
						</fc_acct_2015_l>
						<elec_tax_no1/>
						<elec_tax_no2/>
						<elec_tax_no3/>
					</tempData>
					<!-- 저장소 -->
				</root>
			</instance>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<script type="javascript" src="/js/fcmc_common.js"/>
			<script type="javascript" src="/js/ad_common.js"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				
					// session 정보 셋팅
					model.setValue("/root/initData/session/uid", getProperty("ss_uid")); 		     	       // 아이디
					model.setValue("/root/initData/session/cmpy_cd", getProperty("ss_cmpycd"));		// 회사
					model.setValue("/root/initData/session/emp_no", getProperty("ss_emp_no"));      	// 사번
					model.setValue("/root/initData/session/emp_nm", getProperty("ss_emp_nm"));     	// 성명
					model.setValue("/root/initData/session/dept_cd", getProperty("ss_deptcd"));      	// 부서
					model.setValue("/root/initData/session/dept_nm", getProperty("ss_deptnm"));      	// 부서명

					model.setValue("/root/reqData/searchData/cmpy_cd", model.getValue("/root/initData/session/cmpy_cd"));     // 회사

					// tab 초기화
					btn_tab_01.dispatch("onclick");
					
					// combo 초기화
					model.send("fc_acct_2120_m");

					makeComboGubun("", "/root/initData/comboSet/fc_acct_2120_m/dataSet/DLCO_CLSF_CD_CURLIST", "record", "cdabrvnm_cd", "cd");
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2120_m/dataSet/ERPLACE_CD_CURLIST", "record", "cdabrvnm_cd", "cd");
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2120_m/dataSet/RCPM_SHET_KIND_CURLIST", "record", "cdabrvnm_cd", "cd");
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2120_m/dataSet/G1_MANG_CLSF_CURLIST", "record", "cdabrvnm_cd", "cd");
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2120_m/dataSet/G1_FRCR_CLSF_CURLIST", "record", "cdabrvnm_cd", "cd");
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2120_m/dataSet/G2_NOTE_CLSF_CURLIST", "record", "cdabrvnm_cd", "cd");
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2120_m/dataSet/G2_ISSU_CMPY_CD_CURLIST", "record", "cdabrvnm_cd", "cd");
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2120_m/dataSet/G2_RCPM_ACCT_CURLIST", "record", "cdabrvnm_cd", "cd");
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2120_m/dataSet/G3_WHCO_SLIP_CLSF_CURLIST", "record", "cdabrvnm_cd", "cd");
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2120_m/dataSet/MEDI_CD_CURLIST", "record", "cdabrvnm_cd", "cd");
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2120_m/dataSet/PROF_KIND_CURLIST", "record", "cdabrvnm_cd", "cd");
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2120_m/dataSet/SLIP_CLSF_CURLIST", "record", "cdabrvnm_cd", "cd");		
					makeComboGubun("/root/initData/comboSet/fc_acct_2120_m/dataSet/CHNL_CLSF_CD_CURLIST", "record", "cdabrvnm_cd", "cd");	
					
					
					slip_clsf.value = "30";
					slip_clsf.disabled = true;
//					slip_clsf.attribute("editable") = "false";
//					slip_clsf.attribute("background-color") = DEFAULT_COLOR_DISABLE;
					erplace_cd.value = "01";

					// 컨트롤 초기화					
					impt_emp_no.value = getProperty("ss_emp_no");
					impt_emp_nm.value = getProperty("ss_emp_nm");
					
					//if (getProperty("ss_deptcd") != "") {  //20170117 봉은정수정
					//	impt_dept.value = getProperty("ss_deptcd").substring(0, 4) + "00";
					//	impt_dept_nm.value = getProperty("ss_deptnm");
					//}					
					impt_dept.value = getProperty("ss_deptcd");
					impt_dept_nm.value = getProperty("ss_deptnm");
					
					btn_update.disabled = true;
					btn_delete.disabled = true;
					
					budg_cd.attribute("editable") = "false";

					datagrid1.deleteRow(1, false);
					datagrid2.deleteRow(1, false);
					datagrid3.deleteRow(1, false);
					
					for (i=0;i<20;i++) {
						datagrid1.addRow(false);
						datagrid2.addRow(false);
						datagrid3.addRow(false);
					}
					
					datagrid1.refresh();
					datagrid2.refresh();
					datagrid3.refresh();
					
//					vexc_cmpy_cd.value = "104-86-08161";
//					gstr_popupid = "vexc_cmpy_cd";
//					open_fc_acct_1180("focus","s");	

//					dlco_clsf_cd.attribute("background-color") = "white";
//					dlco_cd.attribute("background-color") = "white";
					medi_cd.attribute("background-color") = "white";
					boks_dlco_nm.attribute("background-color") = "white";
					code_cd.attribute("background-color") = "white";
//					unit.attribute("background-color") = "white";
//					qunt.attribute("background-color") = "white";
					dtls_medi_cd.attribute("background-color") = "white";
					
					if(model.property("FC_ACCT_2120_popup_flag") == "Y"){
						tax_stmt_no.value = model.property("FC_ACCT_2120_srch_tax_stmt_no");
						
						model.property("FC_ACCT_2120_srch_tax_stmt_no") = "";
						model.property("FC_ACCT_2120_popup_flag") = "";
						
						if (tax_stmt_no.value.Trim().ReplaceString("-", "").length == 14) {
							gvar_form_load_flag = "Y";
							btn_select.dispatch("onclick");
							gvar_form_load_flag = "N";
						}
					}					
				]]>
			</script>
			<submission id="fc_acct_2120_m" action="/fc/acct2000/2120" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/initData/comboSet/fc_acct_2120_m/dataSet"/>
			<submission id="fc_acct_2121_l" action="/fc/acct2000/2121" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/gridData1/dataSet"/>
			<submission id="fc_acct_2122_i" action="/fc/acct2000/2122" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="fc_acct_2124_d" action="/fc/acct2000/2124" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqform" resultref="/root/resData/MsgData"/>
			<submission id="fc_acct_2125_s" action="/fc/acct2000/2125" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/gridData2/dataSet"/>
			<submission id="fc_acct_2128_s" action="/fc/acct2000/2128" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/gridData2/dataSet"/>
			<submission id="fc_acct_2126_s" action="/fc/acct2000/2126" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/fc_acct_2126_s/dataSet"/>
			<submission id="fc_co_8001_s" action="/fc/co8000/8001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/initData/popupSet/fc_co_8001_s/dataSet"/>
			<submission id="fc_co_1101" action="/fc/co1000/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData/fc_co_1101_l/dataSet"/>
			<submission id="hd_com_1002" action="/hd/com/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="fc_acct_2013_s" action="/fc/acct2000/2013" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resform" resultref="/root/resData/resform3/fc_acct_2013_s/dataSet"/>
			<submission id="fc_acct_2015_l" action="/fc/acct2000/2015" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/fc_acct_2015_l/dataSet"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					init_controls();
					set_column_visibility();
					
				]]>
			</script>
		</model>
		<script type="javascript">
			<![CDATA[
				var gvar_form_load_flag = "N";
				var	_oth_clsf = "1";
				// 글로벌 스크립트
				var gvar_tax_stmt_aprv_yn = "";		// 세금계산서 상태
				var gvar_upd_tms = "";			// 수정횟수
				var gvar_stmt_slip_no = "";			// 세금계산서 전표번호
				var gvar_reg_clsf = "";
				var gvar_delete_check = "false";
				
				var gstr_popupid = "";
				
				var gvar_rcpm_slip_no_cnt = 0;
				
				function set_column_visibility() {
					//모든 컬럼을 감춘다.
					hide_all_columns(datagrid1);
					hide_all_columns(datagrid2);
					hide_all_columns(datagrid3);					
					//공통 컬럼을 보여준다.
					show_columns(datagrid1,"1,2,3,4,5,6,7,8,9");
					show_all_columns(datagrid2);
					show_all_columns(datagrid3);					
				}				
				function rcvs_from_fc_co_9010() {
					draft_doc_no.value = arguments[0][0];
				}

				function init_controls(){
					set_default(datagrid1);							//datagrid
					set_default(datagrid2);							//datagrid
					set_default(datagrid3);							//datagrid
					
//					set_default(srch_mang_item_cd);					//input
//					
//					set_format(
//						"code"
//					,	datagrid1			,"2"
//					);
//					set_format(
//						"string_l"
//					,	datagrid1			,"3"
//					,	srch_mang_item_cd							//코드
//					);
				}

				// pop-up
				function setEvntInfo(Evnt_cd, Evnt_cd_nm){
					
					if (gstr_popupid == "dtls_medi_cd") { dtls_medi_cd.value = Evnt_cd; }		// 상세매체코드

					if (gstr_popupid == "evnt_cd") {		// 행사코드
						evnt_cd.value = Evnt_cd;
						evnt_cd_nm.value = Evnt_cd_nm;
					}

					if (gstr_popupid == "budg_cd") {		// 예산코드
						budg_cd.value = Evnt_cd;
						budg_cd_nm.value = Evnt_cd_nm;
						
						if (getProperty("ss_cmpycd") == "100" || getProperty("ss_cmpycd") == "332"){
						if (budg_cd.value.substring(0, 2) >= "61" && budg_cd.value.substring(0, 2) <= "69") {
							show_message("비용예산코드 불가:경리부 문의요2");
							budg_cd.value = "";
							budg_cd_nm.value = "";
							return;
						}
						}
					}
					
					if (gstr_popupid == "g3_budg_cd") {		// 예산코드 (기타입금 그리드)
						datagrid3.valueMatrix(datagrid3.row, 2) = Evnt_cd;
						datagrid3.valueMatrix(datagrid3.row, 3) = Evnt_cd_nm;
					}
					
				}
				
				// 수입부서
				function setDept_cd(iv_dept_cd, iv_dept_nm, iv_dept_team_clsf, iv_offi_nm, iv_dept_team_nm, iv_part_nm, iv_part_dn_nm){	
					model.setValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/ask_dept_cd", iv_dept_cd);
					model.setValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/ask_dept_nm", iv_dept_nm);
					impt_dept.refresh();
					impt_dept_nm.refresh();
				}
				
				// 수입사번
				function setEmp_no(emp_no, nm_korn){

					model.setValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/ask_emp_no", emp_no);
					model.setValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/ask_emp_nm", nm_korn);

					impt_emp_no.refresh();
					impt_emp_nm.refresh();

				}
				
				// 거래처 popup
				function open_fc_acct_1180(p_where,p_mode) {
					var need_popup = true;
					var rcvs_flag = false;

					//검색조건이 모두 충족하지 않으면 종료한다.
					if (gstr_popupid == "dlco_cd") { 		// 거래처
						if (p_where == "FOCUS" && (dlco_clsf_cd.value.Trim() == "" || dlco_cd.value.Trim() == "")) {
							dlco_nm.value	= "";
							return;
						}
					}
					else if (gstr_popupid == "vexc_cmpy_cd") {	// 대행사
						if (p_where == "FOCUS" && (vexc_cmpy_cd.value.Trim() == "")) {
							vexc_cmpy_nm.value	= "";
							return;
						}
					}
					
					p_where = p_where.toUpperCase();
					
					var popid = "fc_acct_1180";
					var subid = "fc_acct_1181_l";
	
					if (p_where == "FOCUS" && (dlco_clsf_cd.value.Trim() == "" && dlco_cd.value.Trim() != "")) {
		                              if (!check_reqItem(dlco_clsf_cd,"none","focus","거래처검색은 거래처구분을 선택 후 조회 할 수 있습니다.")) {return rcvs_flag};
					}

					//검색조건이 모두 충족하지 않으면 종료한다.
					if (gstr_popupid == "dlco_cd") { 
						if (p_where == "FOCUS" && (dlco_clsf_cd.value.Trim() == "" || dlco_cd.value.Trim() == "")) {
							ernm.value	= "";
							intg_dlco_cd.value = "";
							ern.value = "";
							presi_nm.value ="";
							bizcond.value = "";
							erplace_item.value = "";
							addr.value = "";
							email.value = "";
							reset_refnode(get_popup_rcvs_ref(popid));
							return rcvs_flag;
						}
					}
					
					set_popup_send_data(popid		,"mode"			,p_mode			);
					set_popup_send_data(popid  ,"title"   ,""    );
//					set_popup_send_data(popid  ,"readonly"  ,"1"    );

					if (gstr_popupid == "dlco_cd") { 		// 거래처
						set_popup_send_data(popid		,"clsf_cd"			,dlco_clsf_cd.value.substring(0, 2));
						set_popup_send_data(popid		,"cd_f"			,dlco_cd.value		);
						set_popup_send_data(popid		,"cd_t"			,dlco_cd.value		);
						set_popup_send_data(popid		,"cd_abrv_nm"		,dlco_cd.value		);
					}
					else if (gstr_popupid == "vexc_cmpy_cd") { 	// 대행사
						set_popup_send_data(popid		,"clsf_cd"			,"93"	);
						set_popup_send_data(popid		,"cd_f"			,vexc_cmpy_cd.value		);
						set_popup_send_data(popid		,"cd_t"			,vexc_cmpy_cd.value		);
						set_popup_send_data(popid		,"cd_abrv_nm"		,vexc_cmpy_cd.value		);
					}
	
					//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
					if (p_where == "FOCUS") {
						//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
						//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
						model.removenode(get_popup_rcvs_ref(popid));
						//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
						model.makeNode(get_popup_rcvs_ref(popid));
						
						//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
						send_submission(
								"auto_" + subid
							,	get_popup_send_ref(popid)
							,	get_popup_rcvs_ref(subid) + "/dataSet"
							,	"/fc/acct1000/1181"
							,	"urlencoded-post"
							,	"application/x-www-form-urlencoded"
						);
						
						totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");



						if (totalcnt == 1) {
							//데이터가 1건이고 focus out에서 호출한 경우
							//데이터를 설정하고 나간다.
	
							//model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							//debugger;
							model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							//return;
							need_popup = false;
						}
						else if (totalcnt == 0) {
							//show_message("[거래처코드]의 검색결과가 없습니다.");
							//return;
							need_popup = false;						
						}
						else {
							//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
							//만약 1건 이상인 경우 popup을 호출해 달라고 하면
							//return을 지우면 됨
							//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
							//return;
							need_popup = true;
						}
					}


					//그외 버튼인 경우는 계속 진행
					if (need_popup) {
						rcvs_flag = open_popup(popid,"640");
					}
					

					
//					if (!rcvs_flag) {
//						return;
//					}
	
					//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
					//다시 조회 하기 쉽도록 하고
					if (gstr_popupid == "dlco_cd") { 		// 거래처
						if (get_popup_rcvs_data(popid,"clsf_cd") != "")			dlco_clsf_cd.value		=	get_popup_rcvs_data(popid,"clsf_cd");
//						if (get_popup_rcvs_data(popid,"cd") != "")				dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
//						if (get_popup_rcvs_data(popid,"intg_cd") != "")			intg_dlco_cd.value		=	get_popup_rcvs_data(popid,"intg_cd");
//						if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		ernm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
//						if (get_popup_rcvs_data(popid,"cd") != "")				ern.value				=	get_popup_rcvs_data(popid,"cd");
//						if (get_popup_rcvs_data(popid,"presi_nm") != "")			presi_nm.value			=	get_popup_rcvs_data(popid,"presi_nm");
//						if (get_popup_rcvs_data(popid,"bizcond") != "")			bizcond.value			=	get_popup_rcvs_data(popid,"bizcond");
//						if (get_popup_rcvs_data(popid,"item") != "")			erplace_item.value		=	get_popup_rcvs_data(popid,"item");
						dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
						intg_dlco_cd.value		=	get_popup_rcvs_data(popid,"intg_cd");
						ernm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
						ern.value				=	get_popup_rcvs_data(popid,"cd");
						presi_nm.value			=	get_popup_rcvs_data(popid,"presi_nm");
						bizcond.value			=	get_popup_rcvs_data(popid,"bizcond");
						erplace_item.value		=	get_popup_rcvs_data(popid,"item");
						email.value			=	get_popup_rcvs_data(popid,"email");
						addr.value = get_popup_rcvs_data(popid,"addr1") + get_popup_rcvs_data(popid,"addr2") + get_popup_rcvs_data(popid,"addr3") + get_popup_rcvs_data(popid,"addr4");
//						boks_dlco_nm.disabled = true;
//						boks_dlco_nm.attribute("editable") = "false";
//						boks_dlco_nm.attribute("background-color") = DEFAULT_COLOR_DISABLE;
					}
					else if (gstr_popupid == "vexc_cmpy_cd") { 		// 대행사

						if (get_popup_rcvs_data(popid,"cd") != "")				vexc_cmpy_cd.value			=	get_popup_rcvs_data(popid,"cd");
						if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		vexc_cmpy_nm.value		=	get_popup_rcvs_data(popid,"cd_abrv_nm");
						if (get_popup_rcvs_data(popid,"intg_cd") != "")                   intg_vexc_cmpy_cd.value		=	get_popup_rcvs_data(popid,"intg_cd");
					}
				}
				
				// 거래처 체크 로직
				function fn_dlco_check() {

					if(dlco_clsf_cd.value.substring(0, 2) == "93"){
						if (dlco_cd.value.ReplaceString("-", "").length == 10) {
							if (commCheckBrnoVal(dlco_cd.value.ReplaceString("-", "")) == false) { dlco_cd.value = ""; }
						}
					}

					if (dlco_cd.value.length == 0) {
						intg_dlco_cd.value = "";
						ernm.value = "";
						ern.value = "";
						presi_nm.value = "";
						bizcond.value = "";
						erplace_item.value = "";
						addr.value = "";
						email.value = "";
//						boks_dlco_nm.disabled = false;
//						boks_dlco_nm.attribute("editable") = "true";
//						boks_dlco_nm.attribute("background-color") = "white";
					}
				}
				
				// 예산코드에 따른 대행사 셋팅
				function fn_vexc_cmpy_cd_Setting() {
					
					switch (budg_cd.value) {	// 예산코드
						case "803504" :		// 정보서비스
							vexc_cmpy_cd.value = "";
							vexc_cmpy_cd.dispatch("xforms-value-changed");
							break;
						case "803508" :		// 용역식대
							vexc_cmpy_cd.value = "";
							vexc_cmpy_cd.dispatch("xforms-value-changed");
							break;
						case "803501" :		// 출판과월호
							vexc_cmpy_cd.value = "";
							vexc_cmpy_cd.dispatch("xforms-value-changed");
							break;
						case "803517" :		// 식권판매수입
							vexc_cmpy_cd.value = "";
							vexc_cmpy_cd.dispatch("xforms-value-changed");
							break;
						case "803518" :		// 주차수입
							vexc_cmpy_cd.value = "";
							vexc_cmpy_cd.dispatch("xforms-value-changed");
							break;
						case "803505" :		// 포토뱅크
							vexc_cmpy_cd.value = "104-86-08161";
							vexc_cmpy_cd.dispatch("xforms-value-changed");
							break;
						case "803529" :		// 인물DB
							vexc_cmpy_cd.value = "104-86-08161";
							vexc_cmpy_cd.dispatch("xforms-value-changed");
							break;
						case "803530" :		// 마이크로필름
							vexc_cmpy_cd.value = "104-86-08161";
							vexc_cmpy_cd.dispatch("xforms-value-changed");
							break;
						case "803527" :		// 정보제공료
							vexc_cmpy_cd.value = "104-86-08161";
							vexc_cmpy_cd.dispatch("xforms-value-changed");
							break;
						case "803531" :		// 1일PDF
							vexc_cmpy_cd.value = "104-86-08161";
							vexc_cmpy_cd.dispatch("xforms-value-changed");
							break;
						case "803532" :		// 유료기사PDF
							vexc_cmpy_cd.value = "104-86-08161";
							vexc_cmpy_cd.dispatch("xforms-value-changed");
							break;
/*							
						case "803516" :		// 뉴스정보제공수입
							vexc_cmpy_cd.value = "104-86-08161";
							vexc_cmpy_cd.dispatch("xforms-value-changed");						
							break;
*/							
						default :
							vexc_cmpy_cd.value = "";
							vexc_cmpy_cd.dispatch("xforms-value-changed");
					}
					
				}
				
				function fun_amt(){
					set_refvalue(amt, Number(suply_amt.value) + Number(vat_amt.value));
				}
				
				function open_fc_co_8010(p_where,p_mode,p_title,p_readonly,p_to,p_job_clsf,p_cd_clsf) {
					var need_popup = true;
					var rcvs_flag = false;
					
					//검색조건이 모두 충족하지 않으면 종료한다.
					if (p_where == "FOCUS" && medi_cd.value.Trim() == "") {
						pch_mcnm.value	= "";
						return rcvs_flag;
					}
					
					p_where = p_where.toUpperCase();
					
					var popid = "fc_co_8010";
					var subid = "fc_co_8010_l";
	
					set_popup_send_data(popid		,"mode"			,p_mode			);
					set_popup_send_data(popid		,"title"			,p_title			);
					set_popup_send_data(popid		,"readonly"		,p_readonly		);
					set_popup_send_data(popid		,"job_clsf"			,p_job_clsf		);
					set_popup_send_data(popid		,"cd_clsf"			,p_cd_clsf			);
					set_popup_send_data(popid		,"cd"				,medi_cd.value		);
					set_popup_send_data(popid		,"cd_abrv_nm"		,""				);
					
					model.removenode(get_popup_rcvs_ref(popid));
					model.makeNode(get_popup_rcvs_ref(popid));
					
					//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
					if (p_where == "FOCUS") {
						
						//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
						send_submission(
								"auto_" + subid
							,	get_popup_send_ref(popid)
							,	get_popup_rcvs_ref(subid) + "/dataSet"
							,	"/fc/co8000/8011"
							,	"urlencoded-post"
							,	"application/x-www-form-urlencoded"
						);
						
						totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
				
						if (totalcnt == 1) {
							//데이터가 1건이고 focus out에서 호출한 경우
							//데이터를 설정하고 나간다.
	
	//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
	//						return;
							need_popup = false;
							rcvs_flag = true;
						}
						else if (totalcnt == 0) {
	//						return;
							need_popup = false;	
							rcvs_flag = false;					
						}
						else {
							//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
							//만약 1건 이상인 경우 popup을 호출해 달라고 하면
							//return을 지우면 됨
							//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
							//return;
							need_popup = true;
						}
					}
					
					//그외 버튼인 경우는 계속 진행
					if (need_popup) {
						rcvs_flag = open_popup(popid,"640");
					}
	
					set_refvalue("/root/tempData/medi_ch", get_popup_rcvs_data(popid,"mang_cd_2"));
					
					reset_popup_send_data(popid);
					
					return rcvs_flag;
				}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="1,10;2,8;1,875;1,878;1,946;1,927;1,913;1,918;1,953;1,1098;2,29;2,38;2,40;2,50;2,74;2,75;2,82;2,86;2,88;2,100;2,669;2,704;2,686;2,668;2,392;2,414;" style="font-family:굴림; ">
		<group id="group_tit" class="gro_tit" style="left:0px; top:0px; width:946px; height:39px; ">
			<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:10px; width:926px; height:29px; "/>
		</group>
		<group id="group_scr" class="gro_sel" style="left:10px; top:50px; width:926px; height:26px; ">
			<caption id="caption3" class="list_cap02" style="left:119px; top:0px; width:326px; height:26px; text-align:center; "/>
			<caption id="caption83" class="list_cap02" style="left:563px; top:0px; width:363px; height:26px; text-align:center; "/>
			<caption id="caption2" class="list_cap03" style="left:0px; top:0px; width:120px; height:26px; text-align:center; ">세금계산서번호</caption>
			<input id="tax_stmt_no" ref="/root/reqData/searchData/tax_stmt_no" class="req" navindex="1" inputtype="button" maxlength="14" format="99-99999999-9999" style="left:124px; top:4px; width:186px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.property("FC_ACCT_2230_popup_clsf")  = "Y";
						model.property("FC_ACCT_2120_popup_impt_dept")  = impt_dept.value;
					
						viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2230");
						
						tax_stmt_no.value = model.property("FC_ACCT_2230_stmt_slip_no");
												
						model.property("FC_ACCT_2230_popup_clsf")  = "";
						model.property("FC_ACCT_2230_stmt_slip_no") = "";
						model.property("FC_ACCT_2120_popup_impt_dept")  = "";
						
						if (tax_stmt_no.value.Trim().ReplaceString("-", "").length == 14) {
							btn_select.dispatch("onclick");
						}
						if(model.property("FC_ACCT_2230_rcpm_no") != ""){
							set_refvalue(rcpm_slip_no, model.property("FC_ACCT_2230_rcpm_no"));
							model.property("FC_ACCT_2230_rcpm_no") = "";
							rcpm_slip_no.dispatch("xforms-value-changed");
						}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (tax_stmt_no.value.Trim().ReplaceString("-", "").length == 14) {
							btn_select.dispatch("onclick");
						}
					]]>
				</script>
			</input>
			<caption id="caption82" class="list_cap03" style="left:444px; top:0px; width:120px; height:26px; text-align:center; ">대행사</caption>
			<input id="vexc_cmpy_cd" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/vexc_cmpy_cd_ern" editable="false" inputtype="button" style="left:568px; top:4px; width:115px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					
						if (vexc_cmpy_cd.attribute("editable") == "false") { return; }
					
						gstr_popupid = "vexc_cmpy_cd";
						open_fc_acct_1180("button","s");	
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					
						if (vexc_cmpy_cd.value == "601") {
							show_message("601 은 사용할 수 없는 거래처코드입니다");
							vexc_cmpy_cd.value = "";
							return;
						}	
						
						if (vexc_cmpy_cd.value.Trim().length== 0) {
							vexc_cmpy_nm.value = "";
							intg_vexc_cmpy_cd.value = "";
						}
						else {
							
							gstr_popupid = "vexc_cmpy_cd";
							open_fc_acct_1180("focus","s");
							
							if (vexc_cmpy_cd.value == "") {
								vexc_cmpy_nm.value = "";
								intg_vexc_cmpy_cd.value = "";
							}
						}

					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[

					]]>
				</script>
			</input>
			<input id="vexc_cmpy_nm" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/vexc_cmpy_cd_nm" editable="false" appearance="input" style="left:687px; top:4px; width:155px; height:18px; "/>
			<input id="intg_vexc_cmpy_cd" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/vexc_cmpy_cd" editable="false" appearance="input" style="left:846px; top:4px; width:75px; height:18px; "/>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:83px; width:926px; height:5px; "/>
		<group id="group1" style="left:10px; top:97px; width:438px; height:251px; ">
			<caption id="caption24" class="list_cap02" style="left:119px; top:175px; width:319px; height:26px; text-align:center; "/>
			<input id="unit" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/unit" navindex="12" visibility="hidden" style="left:326px; top:180px; width:31px; height:18px; ">
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[

					]]>
				</script>
			</input>
			<caption id="caption84" class="list_cap02" style="left:119px; top:0px; width:319px; height:26px; text-align:center; "/>
			<caption id="caption20" class="list_cap02" style="left:40px; top:25px; width:398px; height:30px; text-align:center; "/>
			<caption id="caption26" class="list_cap02" style="left:119px; top:50px; width:319px; height:26px; text-align:center; "/>
			<caption id="caption30" class="list_cap02" style="left:119px; top:75px; width:319px; height:26px; text-align:center; "/>
			<caption id="caption17" class="list_cap02" style="left:119px; top:100px; width:100px; height:26px; text-align:center; "/>
			<caption id="caption59" class="list_cap02" style="left:337px; top:100px; width:101px; height:26px; text-align:center; "/>
			<caption id="caption16" class="list_cap02" style="left:119px; top:125px; width:319px; height:26px; text-align:center; "/>
			<caption id="caption25" class="list_cap02" style="left:119px; top:150px; width:319px; height:26px; text-align:center; "/>
			<caption id="caption22" class="list_cap02" style="left:119px; top:200px; width:319px; height:26px; text-align:center; "/>
			<caption id="caption21" class="list_cap02" style="left:119px; top:225px; width:319px; height:26px; text-align:center; "/>
			<caption id="caption85" class="list_cap03" style="left:0px; top:0px; width:120px; height:26px; text-align:center; ">등록구분</caption>
			<select1 id="reg_clsf" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/reg_clsf" class="req" navindex="2" appearance="minimal" style="left:124px; top:4px; width:124px; height:18px; ">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>세금계산서</label>
						<value>1</value>
					</item>
					<item>
						<label>미수입금</label>
						<value>2</value>
					</item>
					<item>
						<label>세금계산서/입금</label>
						<value>3</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
//						alert(reg_clsf.		

						if (reg_clsf.value == "1") {
							rcpm_slip_no.value = "";
							rcpm_slip_no.dispatch("xforms-value-changed");
//							rcpm_slip_no.disabled = true;
//							rcpm_slip_no.attribute("editable") = "false";
//							rcpm_slip_no.attribute("background-color") = DEFAULT_COLOR_DISABLE;
						}
						else {
							rcpm_slip_no.value = "";
							rcpm_slip_no.dispatch("xforms-value-changed");
//							rcpm_slip_no.disabled = false;
//							rcpm_slip_no.attribute("editable") = "true";
//							rcpm_slip_no.attribute("background-color") = "white";
						}
						
						if (gvar_reg_clsf == "3" && (reg_clsf.value == "1" || reg_clsf.value == "2")) {
							show_message(reg_clsf.label + "(으)로 변경할 수 없습니다.");
							model.setFocus("reg_clsf");
							reg_clsf.value = gvar_reg_clsf;
							return;
						}
						
						if (stmt_slip_no.value.Trim() != "") {
							if (gvar_reg_clsf == "1" && reg_clsf.value == "3") {
								show_message(reg_clsf.label + "은 입금으로만 변경할 수 있습니다.");
								model.setFocus("reg_clsf");
								reg_clsf.value = gvar_reg_clsf;
								return;
							}
                                             }

						
						if (gvar_reg_clsf == "" && reg_clsf.value == "2") {
							show_message("최초입력시 " + reg_clsf.label + "(으)로 선택할 수 없습니다.");
							model.setFocus("reg_clsf");
							reg_clsf.value = "";
							return;
						}
						
						if (reg_clsf.value == "1") {
							btn_tab_01.dispatch("onclick");	// tab 초기화
							
							tot_rcpm_amt.value = "";
							rcpm_slip_no.value = "";
							rcpm_slip_no2.value = "";
	
							model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST/record");  
							model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST1/record");  
							model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST2/record");  
							model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST3/record");  
							model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST4/record");  
							
							model.refresh();
	
							for (i=0;i<20;i++) {
								datagrid1.addRow(false);
								datagrid2.addRow(false);
								datagrid3.addRow(false);
							}
							
							model.refresh();
							
							group3.disabled = true;
						}
						else {
							group3.disabled = false;
						}
						30200906090
//						gvar_reg_clsf = reg_clsf.value;
					]]>
				</script>
				<script type="javascript" ev:event="onclick">
					<![CDATA[

					]]>
				</script>
			</select1>
			<caption id="caption23" class="list_cap03" style="left:0px; top:75px; width:120px; height:26px; text-align:center; ">예산코드</caption>
			<input id="budg_cd" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/budg_cd" class="req" navindex="5" inputtype="button" maxlength="6" style="left:124px; top:79px; width:90px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[

						model.removeNodeset("/root/reqData/fwdData");  
						
						model.makeNode("/root/reqData/fwdData/cmpy_cd");
						model.makeNode("/root/reqData/fwdData/G_Tag");
						model.makeNode("/root/reqData/fwdData/G_Caption");
						model.makeNode("/root/reqData/fwdData/G_Codenu");
						model.makeNode("/root/reqData/fwdData/G_BRCode");
						model.makeNode("/root/reqData/fwdData/clas_cd1");
						
						model.setValue("/root/reqData/fwdData/cmpy_cd", model.getValue("/root/initData/session/cmpy_cd"));
						model.setValue("/root/reqData/fwdData/G_Tag", "21");
						model.setValue("/root/reqData/fwdData/G_Caption", "부서별예산코드조회");
						model.setValue("/root/reqData/fwdData/G_Codenu", impt_dept.value);					
						model.setValue("/root/reqData/fwdData/G_BRCode", "");
						model.setValue("/root/reqData/fwdData/clas_cd1", "10");

						gstr_popupid = "budg_cd";
					
						window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						
						fn_vexc_cmpy_cd_Setting();
						
						budg_cd.dispatch("xforms-value-changed");
						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (budg_cd.value.length == 6) {
							model.setValue("/root/reqData/searchData/budg_cd", budg_cd.value);
							model.send("fc_co_8001_s");
							budg_cd_nm.value =  model.getValue("/root/initData/popupSet/fc_co_8001_s/dataSet/CURLIST/record/budg_cdnm");
							
							if (model.getValue("/root/initData/popupSet/fc_co_8001_s/dataSet/CURLIST/totalcnt") == 0) {
								budg_cd.value = "";
								budg_cd_nm.value = "";
//								return;
							}
							if (getProperty("ss_cmpycd") == "100" || getProperty("ss_cmpycd") == "332"){
							if (budg_cd.value.substring(0, 2) >= "61" && budg_cd.value.substring(0, 2) <= "69") {
								show_message("비용예산코드 불가:경리부 문의요2");
								budg_cd.value = "";
								budg_cd_nm.value = "";
//								return;
							}
							}
						}
						else {
							budg_cd.value = "";
							budg_cd_nm.value = "";
						}
						
						fn_vexc_cmpy_cd_Setting();
						
//						alert(budg_cd.value);
						
						model.setValue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
						model.setValue("/root/reqData/searchData/budg_cd", budg_cd.value);
						
						model.send("fc_acct_2126_s");

//						dlco_clsf_cd.attribute("background-color") = "white";
//						dlco_cd.attribute("background-color") = "white";
						medi_cd.attribute("background-color") = "white";
						boks_dlco_nm.attribute("background-color") = "white";
						code_cd.value = "";
						code_cd.attribute("background-color") = "white";
//						unit.attribute("background-color") = "white";
//						qunt.attribute("background-color") = "white";
						dtls_medi_cd.attribute("background-color") = "white";
						
						
						// 각 CONTROL 색상 지정
						for (i = 1; i <= Number(model.getValue("/root/resData/gridData/fc_acct_2126_s/dataSet/CUR_MANG_ITEM_CD_LIST/totalcnt")); i++) {
							if (model.getValue("/root/resData/gridData/fc_acct_2126_s/dataSet/CUR_MANG_ITEM_CD_LIST/record[" + i + "]/drcr_clsf") == "" ||
							    model.getValue("/root/resData/gridData/fc_acct_2126_s/dataSet/CUR_MANG_ITEM_CD_LIST/record[" + i + "]/drcr_clsf") == "9" ) {

								switch (model.getValue("/root/resData/gridData/fc_acct_2126_s/dataSet/CUR_MANG_ITEM_CD_LIST/record[" + i + "]/mang_item_cd")) {
									case "02" :	// 주거래처
							                    dlco_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    dlco_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
							                case "03" :  //매체
							                    medi_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
							                case "04" :  //부거래처명
							                	if (dlco_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							                		// 
							                	}
							                	else {
								                	boks_dlco_nm.attribute("background-color") = DEFAULT_COLOR_REQ;
							                	}
							                    break;
							                case "05" :  //예산코드
										code_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
										makeComboGubun("", "/root/resData/gridData/fc_acct_2126_s/dataSet/CUR_MANG_ITEM_CD_LIST1", "record", "cdabrvnm_cd", "cd");
							                    break;
							                case "13" :  //단위
//										unit.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
							                case "31" :  //수량
//										qunt.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
							                case "34" :  //상세매체코드
										dtls_medi_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
									default :
								} 
 							}
						}
						
					]]>
				</script>
			</input>
			<input id="budg_cd_nm" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/budg_cd_nm" editable="false" appearance="input" style="left:218px; top:79px; width:214px; height:18px; border-style:none; "/>
			<caption id="caption27" class="list_cap03" style="left:0px; top:25px; width:120px; height:26px; text-align:center; ">수입부서</caption>
			<input id="impt_dept" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/ask_dept_cd" class="req" navindex="3" inputtype="button" maxlength="6" style="left:124px; top:29px; width:90px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					
						var var_con_date = "";

						if (make_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = make_dt.value.length;
							if(num_ch == 8){
								var_con_date = make_dt.value;
							}else if(num_ch == 6){
								var_con_date = make_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = make_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "I");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						
						// 권한관리 셋팅
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					
						var var_con_date = "";

						if (make_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = make_dt.value.length;
							if(num_ch == 8){
								var_con_date = make_dt.value;
							}else if(num_ch == 6){
								var_con_date = make_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = make_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (impt_dept.value.length== 6) {
							
							model.setValue("/root/reqData/searchData/emp_no", "");
							model.setValue("/root/reqData/searchData/dept_cd", impt_dept.value);
							model.setValue("/root/reqData/searchData/select_ch", "I");
							model.setValue("/root/reqData/searchData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								impt_dept_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								impt_dept.value = "";
								impt_dept_nm.value = "";
							}
						}
						else {
							impt_dept.value = "";
							impt_dept_nm.value = "";
						}	
						
						// 권한관리 셋팅
					]]>
				</script>
			</input>
			<input id="impt_dept_nm" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/ask_dept_nm" editable="false" appearance="input" style="left:218px; top:29px; width:214px; height:18px; border-style:none; "/>
			<caption id="caption31" class="list_cap03" style="left:0px; top:50px; width:120px; height:26px; text-align:center; ">수입사번</caption>
			<input id="impt_emp_no" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/ask_emp_no" class="req" navindex="4" inputtype="button" maxlength="6" style="left:124px; top:54px; width:90px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (impt_emp_no.value.length== 6) {
							model.setValue("/root/reqData/searchData/emp_no", impt_emp_no.value);
							model.setValue("/root/reqData/searchData/dept_cd", "");
							model.send("hd_com_1002");
							impt_emp_nm.value = model.getValue("/root/tempData/record/nm_korn");
						}		
						else {
							impt_emp_nm.value = "";
						}
					]]>
				</script>
			</input>
			<input id="impt_emp_nm" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/ask_emp_nm" editable="false" appearance="input" style="left:218px; top:54px; width:214px; height:18px; border-style:none; "/>
			<caption id="caption19" class="list_cap03" style="left:0px; top:100px; width:120px; height:26px; text-align:center; ">매체코드</caption>
			<select1 id="medi_cd" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/medi_cd" navindex="6" appearance="minimal" editmode="inputsearch" style="left:124px; top:104px; width:90px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2120_m/dataSet/MEDI_CD_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(medi_cd, medi_cd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(medi_cd,"");
						return;
					}
					
					if(medi_cd.value != ""){
						if (open_fc_co_8010("focus","s","매체코드조회","1","","00","01")) {
							//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
						}
						else {
							//팝업에서 취소 버튼을 누른 경우
						}
					}
					dtls_medi_cd.value = "";
					if (get_refvalue("/root/tempData/medi_ch") == "Y") {
						dtls_medi_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
					}
					else {
						dtls_medi_cd.attribute("background-color") = "white";
					}
					
					]]>
				</script>
			</select1>
			<caption id="caption58" class="list_cap03" style="left:218px; top:100px; width:120px; height:26px; text-align:center; ">상세매체</caption>
			<input id="dtls_medi_cd" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/dtls_medi_cd" navindex="7" inputtype="button" style="left:342px; top:104px; width:90px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						if(getProperty("ss_cmpycd") == "100"){
							if (medi_cd.value == "110") {
					
								var cd   =  "";
								var cdnm =  "";
															
								var resultRef1 = "/root/resData/gridData/gridData1/dataSet/CURLIST/record/dtls_medi_cd";
								var resultRef2 = "/root/resData/gridData/gridData1/dataSet/CURLIST/record/dtls_medi_cd_nm";							
	
								showCommonCodePopup1("03", "30", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
		
								model.refresh();
							} else if (medi_cd.value == "610") {
						
								var cd   =  "";
								var cdnm =  "";
															
								var resultRef1 = "/root/resData/gridData/gridData1/dataSet/CURLIST/record/dtls_medi_cd";
								var resultRef2 = "/root/resData/gridData/gridData1/dataSet/CURLIST/record/dtls_medi_cd_nm";							
	
								showCommonCodePopup1("06", "077", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
		
								model.refresh();
								
							} else if (medi_cd.value != "") {
								
								model.removeNodeset("/root/reqData/fwdData");  
								
								model.makeNode("/root/reqData/fwdData/cmpy_cd");
								model.makeNode("/root/reqData/fwdData/G_Tag");
								model.makeNode("/root/reqData/fwdData/G_Caption");
								model.makeNode("/root/reqData/fwdData/G_Codenu");
								model.makeNode("/root/reqData/fwdData/G_BRCode");
								
								model.setValue("/root/reqData/fwdData/cmpy_cd", model.getValue("/root/initData/session/cmpy_cd"));
								model.setValue("/root/reqData/fwdData/G_Tag", "3");
								model.setValue("/root/reqData/fwdData/G_Caption", "상세매체코드조회");
								model.setValue("/root/reqData/fwdData/G_Codenu", medi_cd.value.substring(0, 3));					
								model.setValue("/root/reqData/fwdData/G_BRCode", "");
		
								gstr_popupid = "dtls_medi_cd";
								window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData")
							}
						}else{
							if (medi_cd.value != "") {
									
									/*2012.01.13*/
									makeFwdDataNodes();			
							
									model.setValue("/root/reqData/fwdData/job_clsf", "00"); //필수항목
									model.setValue("/root/reqData/fwdData/cd_clsf", "01"); //필수항목
									model.setValue("/root/reqData/fwdData/cd",  medi_cd.value);
		
									model.setValue("/root/reqData/fwdData/resultRef1", "/root/resData/gridData/gridData1/dataSet/CURLIST/record/dtls_medi_cd");
			
									window.load("/xrw/co/cocd/CO_COCD_1400.xrw"
												, "modal"
												, ""
												, "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
											,"/root/reqData/fwdData"
											,"/root/reqData/searchData"
											)									
							}
						}
						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if (medi_cd.value != "") {
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cd");
						model.makeNode("/root/reqData/fwdData/medi_cd");
						model.setValue("/root/reqData/fwdData/cd", dtls_medi_cd.value);
						model.setValue("/root/reqData/fwdData/medi_cd",medi_cd.value);
						model.send("fc_acct_2015_l");

						if (model.getValue("/root/tempData/fc_acct_2015_l/dataSet/CURLIST/record/cd") != "") {
							
						}
						else {
							dtls_medi_cd.value = "";
						}
					}else{
						dtls_medi_cd.value = "";
					}

					]]>
				</script>
			</input>
			<caption id="caption18" class="list_cap03" style="left:0px; top:125px; width:120px; height:26px; text-align:center; ">행사코드</caption>
			<input id="evnt_cd" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/evnt_cd" navindex="8" inputtype="button" style="left:124px; top:129px; width:90px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					
						model.removeNodeset("/root/reqData/fwdData");  
						
						model.makeNode("/root/reqData/fwdData/cmpy_cd");
						model.makeNode("/root/reqData/fwdData/G_Tag");
						model.makeNode("/root/reqData/fwdData/G_Caption");
						model.makeNode("/root/reqData/fwdData/G_Codenu");
						model.makeNode("/root/reqData/fwdData/G_BRCode");
						
						model.setValue("/root/reqData/fwdData/cmpy_cd", model.getValue("/root/initData/session/cmpy_cd"));
						model.setValue("/root/reqData/fwdData/G_Tag", "16");
						model.setValue("/root/reqData/fwdData/G_Caption", "행사코드조회");
						model.setValue("/root/reqData/fwdData/G_Codenu", "");					
						model.setValue("/root/reqData/fwdData/G_BRCode", "");
						
						gstr_popupid = "evnt_cd";

						window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (evnt_cd.value == "") {
							evnt_cd_nm.value = "";
						}
					]]>
				</script>
			</input>
			<input id="evnt_cd_nm" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/evnt_cd_nm" editable="false" appearance="input" style="left:218px; top:129px; width:214px; height:18px; border-style:none; "/>
			<caption id="caption29" class="list_cap03" style="left:0px; top:150px; width:120px; height:26px; text-align:center; ">거래처코드</caption>
			<select1 id="dlco_clsf_cd" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_clsf_cd" class="req" navindex="9" appearance="minimal" editmode="inputsearch" style="left:124px; top:154px; width:90px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2120_m/dataSet/DLCO_CLSF_CD_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(dlco_clsf_cd, dlco_clsf_cd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(dlco_clsf_cd,"");
						return;
					}
					dlco_cd.value			=	"";
					intg_dlco_cd.value		=	"";
					ernm.value			=	"";
					ern.value				=	"";
					presi_nm.value			=	"";
					bizcond.value			=	"";
					erplace_item.value		=	"";
					addr.value = "";
					]]>
				</script>
			</select1>
			<input id="dlco_cd" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_cd" class="req" navindex="10" inputtype="button" style="left:218px; top:154px; width:135px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					
						if (dlco_cd.attribute("editable") == "false") { return; }
					
						gstr_popupid = "dlco_cd";
						open_fc_acct_1180("button","s");	
						
						fn_dlco_check();
						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						/*
						alert("1");
						gstr_popupid = "dlco_cd";
						open_fc_acct_1180("focus","s");		
						
						fn_dlco_check();
						*/
					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
						//alert("2");
						gstr_popupid = "dlco_cd";
						open_fc_acct_1180("focus","s");		
						
						fn_dlco_check();
					]]>
				</script>
			</input>
			<input id="intg_dlco_cd" ref="/root/resData/resform/intg_dlco_cd" editable="false" appearance="input" style="left:357px; top:154px; width:75px; height:18px; "/>
			<caption id="caption28" class="list_cap03" style="left:0px; top:175px; width:120px; height:26px; text-align:center; ">부거래처명</caption>
			<input id="boks_dlco_nm" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/boks_dlco_nm" navindex="11" style="left:124px; top:179px; width:196px; height:18px; ">
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[
//						if (dlco_clsf_cd.value == "" && dlco_cd.value == "") {
//							boks_dlco_nm.value = "독자";
//							ernm.value = boks_dlco_nm.value;
//						}
					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
						if (dlco_clsf_cd.value == "" && dlco_cd.value == "") {
							if (boks_dlco_nm.value != "") {
								ernm.value = boks_dlco_nm.value;
							}
						}		
					]]>
				</script>
			</input>
			<caption id="caption15" class="list_cap03" style="left:0px; top:200px; width:120px; height:26px; text-align:center; ">관리구분</caption>
			<select id="etc_in_yn" ref="/root/resData/resform/etc_in_yn" navindex="16" overflow="visible" appearance="full" cellspacing="20" cols="2" style="left:355px; top:205px; width:70px; height:18px; border-style:none; ">
				<choices>
					<item>
						<label>잡이익</label>
						<value>Y</value>
					</item>
				</choices>
			</select>
			<select id="exrate_diff_yn" ref="/root/resData/resform/exrate_diff_yn" navindex="15" overflow="visible" appearance="full" cellspacing="20" cols="2" style="left:240px; top:205px; width:95px; height:18px; border-style:none; ">
				<choices>
					<item>
						<label>환차익/환차손</label>
						<value>Y</value>
					</item>
				</choices>
			</select>
			<caption id="caption14" class="list_cap03" style="left:0px; top:225px; width:120px; height:26px; text-align:center; ">계산서전표번호</caption>
			<input id="stmt_slip_no" ref="/root/resData/resform/stmt_slip_no" editable="false" format="99999999-99-999" appearance="input" style="left:124px; top:229px; width:196px; height:18px; border-style:none; "/>
			<input id="qunt" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/qunt" navindex="13" visibility="hidden" format="(-)#,###" style="left:360px; top:180px; width:70px; height:18px; text-align:right; "/>
			<select id="stmt_rmtt_yn" ref="/root/resData/resform/stmt_rmtt_yn" navindex="17" visibility="hidden" overflow="visible" appearance="full" style="left:331px; top:230px; width:80px; height:18px; border-style:none; ">
				<choices>
					<item>
						<label>계산서의뢰</label>
						<value>N</value>
					</item>
				</choices>
			</select>
			<select1 id="code_cd" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/mang_clsf_cd" navindex="14" appearance="minimal" editmode="inputsearch" style="left:124px; top:204px; width:90px; height:18px; ">
				<choices>
					<itemset nodeset="/root/resData/gridData/fc_acct_2126_s/dataSet/CUR_MANG_ITEM_CD_LIST1/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(code_cd, code_cd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(code_cd,"");
						return;
					}					
					]]>
				</script>
			</select1>
			<input id="rcpm_plan_dt" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/rcpm_plan_dt" visibility="hidden" inputtype="date" style="left:335px; top:180px; width:90px; height:18px; "/>
			<caption id="caption65" class="list_cap03" style="left:251px; top:0px; width:73px; height:26px; text-align:center; ">채널구분</caption>
		</group>
		<group id="group2" style="left:453px; top:97px; width:483px; height:251px; ">
			<caption id="caption63" class="list_cap02" style="left:119px; top:225px; width:364px; height:26px; text-align:center; "/>
			<caption id="subtitle" class="tit02" style="left:5px; top:0px; width:454px; height:20px; ">세금계산서 사항</caption>
			<caption id="caption36" class="list_cap02" style="left:119px; top:25px; width:123px; height:26px; text-align:center; "/>
			<caption id="caption39" class="list_cap02" style="left:310px; top:25px; width:173px; height:26px; text-align:center; "/>
			<caption id="caption10" class="list_cap02" style="left:119px; top:50px; width:123px; height:26px; text-align:center; "/>
			<caption id="caption13" class="list_cap02" style="left:310px; top:50px; width:173px; height:26px; text-align:center; "/>
			<caption id="caption38" class="list_cap02" style="left:119px; top:75px; width:364px; height:26px; text-align:center; "/>
			<caption id="caption6" class="list_cap02" style="left:119px; top:100px; width:364px; height:26px; text-align:center; "/>
			<caption id="caption8" class="list_cap02" style="left:119px; top:125px; width:364px; height:26px; text-align:center; "/>
			<caption id="caption12" class="list_cap02" style="left:119px; top:150px; width:364px; height:26px; text-align:center; "/>
			<caption id="caption34" class="list_cap02" style="left:119px; top:200px; width:364px; height:26px; text-align:center; "/>
			<caption id="caption33" class="list_cap03" style="left:0px; top:25px; width:120px; height:26px; text-align:center; ">증빙종류</caption>
			<select1 id="prof_kind" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/prof_type_cd" class="req" navindex="18" appearance="minimal" editmode="inputsearch" style="left:124px; top:29px; width:112px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2120_m/dataSet/PROF_KIND_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
						if (prof_kind.value == "36") {
							make_dt.value = commCurDate();
						}		
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(prof_kind, prof_kind.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(prof_kind,"");
							return;
						}
						
//			                      dlco_clsf_cd.attribute("background-color") = "white";
//			                      dlco_cd.attribute("background-color") = "white";
			                	boks_dlco_nm.attribute("background-color") = "white";

						if (prof_kind.value != "33" && prof_kind.value != "36" && prof_kind.value != "37" && prof_kind.value != "38" && prof_kind.value != "39") {		
				                      dlco_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
				                      dlco_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						}
						else {
				                	boks_dlco_nm.attribute("background-color") = DEFAULT_COLOR_REQ;
						}
					]]>
				</script>
			</select1>
			<caption id="caption35" class="list_cap03" style="left:241px; top:25px; width:74px; height:26px; text-align:center; ">전표구분</caption>
			<select1 id="slip_clsf" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/slip_clsf_cd" class="req" navindex="19" appearance="minimal" editmode="inputsearch" style="left:320px; top:29px; width:157px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2120_m/dataSet/SLIP_CLSF_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(slip_clsf, slip_clsf.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(slip_clsf,"");
						return;
					}
					]]>
				</script>
			</select1>
			<caption id="caption9" class="list_cap03" style="left:0px; top:50px; width:120px; height:26px; text-align:center; ">작성일자</caption>
			<input id="make_dt" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/make_dt" class="req" navindex="20" inputtype="date" style="left:124px; top:54px; width:112px; height:18px; "/>
			<caption id="caption40" class="list_cap03" style="left:241px; top:50px; width:74px; height:26px; text-align:center; ">사업장코드</caption>
			<select1 id="erplace_cd" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/erplace_cd" navindex="21" appearance="minimal" editmode="inputsearch" style="left:320px; top:54px; width:157px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2120_m/dataSet/ERPLACE_CD_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(erplace_cd, erplace_cd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(erplace_cd,"");
						return;
					}
					]]>
				</script>
			</select1>
			<caption id="caption37" class="list_cap03" style="left:0px; top:75px; width:120px; height:26px; text-align:center; ">사업자번호/명</caption>
			<input id="ern" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/ern" navindex="22" style="left:124px; top:79px; width:175px; height:18px; "/>
			<input id="ernm" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_nm" editable="false" appearance="input" style="left:302px; top:79px; width:175px; height:18px; "/>
			<caption id="caption1" class="list_cap03" style="left:0px; top:100px; width:120px; height:26px; text-align:center; ">대표자/업태</caption>
			<input id="presi_nm" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/presi_nm" editable="false" appearance="input" style="left:124px; top:104px; width:175px; height:18px; "/>
			<input id="bizcond" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/bizcond" editable="false" appearance="input" style="left:302px; top:104px; width:175px; height:18px; "/>
			<caption id="caption4" class="list_cap03" style="left:0px; top:125px; width:120px; height:26px; text-align:center; ">종     목</caption>
			<input id="erplace_item" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/presi_item" editable="false" appearance="input" style="left:124px; top:129px; width:111px; height:18px; "/>
			<caption id="caption5" class="list_cap03" style="left:0px; top:150px; width:120px; height:26px; text-align:center; ">주     소</caption>
			<input id="addr" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/addr" editable="false" appearance="input" style="left:124px; top:154px; width:353px; height:18px; "/>
			<caption id="caption7" class="list_cap03" style="left:0px; top:175px; width:120px; height:26px; text-align:center; ">품     목</caption>
			<input id="item" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/item" class="req" navindex="23" caption="품     목" style="left:124px; top:179px; width:350px; height:18px; "/>
			<caption id="caption11" class="list_cap03" style="left:0px; top:200px; width:120px; height:26px; text-align:center; ">공급/부가세액</caption>
			<input id="suply_amt" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/suply_amt" class="req" navindex="24" format="(-)#,###" style="left:125px; top:204px; width:180px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
						if (prof_kind.value.substring(0, 2) == "31" || prof_kind.value.substring(0, 2) == "32" || prof_kind.value.substring(0, 2) == "39") {
							vat_amt.value = Number(suply_amt.value).GetRound(-1, -1) * 0.1;
//							vat_amt.disabled = false;
							vat_amt.attribute("editable") = "true";
							vat_amt.attribute("background-color") = "white";
						}
						else {
							vat_amt.value = "";
//							vat_amt.disabled = false;		
							vat_amt.attribute("editable") = "true";
							vat_amt.attribute("background-color") = "white";
						}		
						fun_amt();
					]]>
				</script>
			</input>
			<input id="vat_amt" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/vat_amt" class="req" format="(-)#,###" style="left:313px; top:204px; width:161px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
						var amt1 = 0;
						var amt2 = 0;
						
						if (prof_kind.value.substring(0, 2) == "31" || prof_kind.value.substring(0, 2) == "32" || prof_kind.value.substring(0, 2) == "39") {
							amt1 = Number(suply_amt.value) * 0.098;
							amt2 = Number(suply_amt.value) * 0.102;
							
							if (vat_amt.value.length==0 ) {
								vat_amt.value = "0";
							}

							if (Number(suply_amt.value) > 0) {
								if (Number(vat_amt.value) > amt2 || Number(vat_amt.value) < amt1) {
									show_message("부가세 금액을 다시 입력해 주십시오.");
									model.setFocus("vat_amt");
									return;
								}
							}
							else {
								if (Number(vat_amt.value) < amt2 || Number(vat_amt.value) > amt1) {
									show_message("부가세 금액을 다시 입력해 주십시오.");
									model.setFocus("vat_amt");
									return;
								}
							}

						}
						else {
							vat_amt.value = "";
						}		
						fun_amt();
					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[
						if (prof_kind.value.substring(0, 2) != "31" && prof_kind.value.substring(0, 2) != "32" && prof_kind.value.substring(0, 2) != "39") {
//							vat_amt.disabled = true;
							vat_amt.attribute("editable") = "false";
							vat_amt.attribute("background-color") = DEFAULT_COLOR_DISABLE;
						}
						else {
//							vat_amt.disabled = false;			
							vat_amt.attribute("editable") = "true";
							vat_amt.attribute("background-color") = "white";				
						}				
					]]>
				</script>
			</input>
			<input id="amt" ref="/root/tempData/amt" editable="false" format="(-)#,###" style="left:125px; top:230px; width:349px; height:18px; text-align:right; "/>
			<caption id="caption62" class="list_cap03" style="left:0px; top:225px; width:120px; height:26px; text-align:center; ">합   계</caption>
			<caption id="caption64" class="list_cap03" style="left:240px; top:125px; width:75px; height:26px; text-align:center; ">E-MAIL</caption>
			<input id="email" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/email" navindex="25" style="left:320px; top:129px; width:157px; height:18px; text-align:left; "/>
		</group>
		<caption id="caption53" class="list_cap02" style="left:125px; top:353px; width:325px; height:26px; text-align:center; "/>
		<caption id="caption52" class="list_cap02" style="left:455px; top:353px; width:481px; height:26px; text-align:center; "/>
		<caption id="caption50" class="list_cap02" visibility="hidden" style="left:129px; top:380px; width:190px; height:26px; text-align:center; "/>
		<caption id="caption55" class="list_cap03" style="left:10px; top:353px; width:120px; height:26px; text-align:center; ">기안문서번호</caption>
		<input id="draft_doc_no" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/draft_doc_no" editable="false" inputtype="button" style="left:134px; top:357px; width:151px; height:18px; ">
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
						if (draft_doc_no.value != "") { return; }
						set_refvalue(draft_doc_no,"");
						set_refvalue("/root/resData/resform/draft_dept_cd","");
						set_refvalue("/root/reqData/fwdData/url",XFORMS_EP_WEB_ADDRESS + "/nanum/flow/ihtml/ecab/ecab_list_chosun_f.jsp?deptid=" + ((getProperty("ss_cmpycd") == "100") ? getProperty("ss_deptcd") : getProperty("ss_cmpycd") + "_" + getProperty("ss_deptcd")));
						window.load("/xrw/fc/co/FC_CO_9010.xrw","modal","FC_CO_9010","width:790; height:728; sysmenu:visible; min:hidden; max:hidden; resize:false; caption:visible; align:center;","/root/reqData/fwdData","/root/reqData/fwdData");
						
//						alert("1");
						
						if (draft_doc_no.value != "") {
							var var_draft_doc_no = draft_doc_no.value.split("^");
							draft_doc_no.value = var_draft_doc_no[0];

							model.setValue("/root/resData/resform/draft_dept_cd", var_draft_doc_no[1]);
							
							model.setValue("/root/resData/resform/draft_doc_no", var_draft_doc_no[0]);
							
							model.send("fc_acct_2013_s");
							
							if(get_refvalue("/root/resData/resform3/fc_acct_2013_s/dataSet/CURLIST/record/clsf_yn") == "Y"){
								draft_expn_amt.value = get_refvalue("/root/resData/resform3/fc_acct_2013_s/dataSet/CURLIST/record/draft_expn_amt");
								draft_expn_amt.attribute("editable") = "false";
								draft_impt_amt.attribute("editable") = "false";
								control_unmark_req1(draft_expn_amt);
								control_unmark_req1(draft_impt_amt);
							}
							else{
								draft_expn_amt.value = "";
								draft_impt_amt.value = "";
								draft_expn_amt.attribute("editable") = "true";
								draft_impt_amt.attribute("editable") = "true";
								control_unmark_req(draft_expn_amt);
								control_unmark_req1(draft_impt_amt);
							}					
						}	
				]]>
			</script>
		</input>
		<caption id="caption54" class="list_cap03" style="left:287px; top:353px; width:55px; height:26px; text-align:center; ">기안금액</caption>
		<input id="draft_impt_amt" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/draft_impt_amt" navindex="25" format="(-)#,###" style="left:346px; top:357px; width:100px; height:18px; text-align:right; "/>
		<caption id="caption51" class="list_cap03" visibility="hidden" style="left:10px; top:380px; width:120px; height:26px; text-align:center; ">기안지출금액</caption>
		<input id="draft_expn_amt" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/draft_expn_amt" visibility="hidden" format="(-)#,###" style="left:135px; top:378px; width:180px; height:18px; text-align:right; "/>
		<group id="group3" style="left:8px; top:395px; width:928px; height:317px; ">
			<caption id="caption61" class="list_cap02" style="left:333px; top:50px; width:166px; height:26px; text-align:center; "/>
			<caption id="caption41" class="tit02" style="left:5px; top:0px; width:524px; height:20px; ">입금내역</caption>
			<caption id="caption56" class="list_cap02" style="left:84px; top:25px; width:844px; height:26px; text-align:center; "/>
			<caption id="caption47" class="list_cap02" style="left:84px; top:50px; width:166px; height:26px; text-align:center; "/>
			<caption id="caption44" class="list_cap02" style="left:582px; top:50px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption45" class="list_cap02" style="left:806px; top:50px; width:122px; height:26px; text-align:center; "/>
			<caption id="caption57" class="list_cap03" style="left:0px; top:25px; width:85px; height:26px; text-align:center; ">입금액</caption>
			<input id="tot_rcpm_amt" ref="/root/resData/gridData/gridData2/dataSet/CURLIST4/record/rcpm_amt" editable="false" format="(-)#,###" style="left:89px; top:29px; width:155px; height:18px; text-align:right; "/>
			<caption id="caption46" class="list_cap03" style="left:0px; top:50px; width:85px; height:26px; text-align:center; ">입금번호</caption>
			<select1 id="rcpm_slip_no" ref="/root/resData/resform/rcpm_slip_no" navindex="26" appearance="minimal" editmode="inputsearch" style="left:90px; top:54px; width:155px; height:18px; ">
				<choices>
					<itemset nodeset="/root/resData/gridData/gridData1/dataSet/CURLIST1/record">
						<label ref="rcpm_slip_no"/>
						<value ref="rcpm_slip_no"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(rcpm_slip_no, rcpm_slip_no.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(rcpm_slip_no,"");
							return;
						}

						btn_tab_01.dispatch("onclick");	// tab 초기화

						if (rcpm_slip_no.value != "") {
							
							model.setValue("/root/reqData/searchData/rcpm_slip_occr_dt", rcpm_slip_no.value.substring(0, 8));    	// 입금일자
							model.setValue("/root/reqData/searchData/rcpm_slip_clsf_cd", rcpm_slip_no.value.substring(9, 11));    	// 발생전표구분
							model.setValue("/root/reqData/searchData/rcpm_slip_seq", rcpm_slip_no.value.substring(12, 16));      	// 입금일련번호
							model.setValue("/root/reqData/searchData/slip_occr_dt", tax_stmt_no.value.substring(2,10));
							model.setValue("/root/reqData/searchData/slip_seq", tax_stmt_no.value.substring(10,14));

							model.send("fc_acct_2125_s");

							set_refvalue(rcpm_slip_no2,get_refvalue("/root/resData/gridData/gridData2/dataSet/CURLIST4/record/rcpm_slip_no2"));
														
							var ch1,ch2,ch3,ch4;
							ch1 = get_refvalue("/root/resData/gridData/gridData2/dataSet/CURLIST/record/rcpm_amt");
							ch2 = get_refvalue("/root/resData/gridData/gridData2/dataSet/CURLIST1/totalcnt");
							ch3 = get_refvalue("/root/resData/gridData/gridData2/dataSet/CURLIST2/totalcnt");
							ch4 = get_refvalue("/root/resData/gridData/gridData2/dataSet/CURLIST3/totalcnt");
							
							if(ch1 != ""){
								btn_tab_01.dispatch("onclick");	
							}else if(ch2 > 0 ){
								btn_tab_02.dispatch("onclick");	
							}else if(ch3 > 0){
								btn_tab_03.dispatch("onclick");	
							}else if(ch4 > 0){
								btn_tab_04.dispatch("onclick");	
							}
							

							for (i=1;i<=datagrid1.rows; i++) {
								if (datagrid1.valueMatrix(i, 14) != "") {
									datagrid1.valueMatrix(i, 15) = "D";
								}
							}
						}
						else {
							
//							datagrid1.re
							
//							model.removeNodeset("/root/resData/gridData/gridData2/dataSet/CURLIST/record");  
//							model.removeNodeset("/root/resData/gridData/gridData2/dataSet/CURLIST1/record");  
//							model.removeNodeset("/root/resData/gridData/gridData2/dataSet/CURLIST2/record");  
//							model.removeNodeset("/root/resData/gridData/gridData2/dataSet/CURLIST3/record");  
//							model.removeNodeset("/root/resData/gridData/gridData2/dataSet/CURLIST4/record");  

							model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST/record");  
							model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST1/record");  
							model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST2/record");  
							model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST3/record");  
							model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST4/record");  
							set_refvalue(rcpm_slip_no2,"");
							model.refresh();

						}

						for (i=0;i<20;i++) {
							datagrid1.addRow(false);
							datagrid2.addRow(false);
							datagrid3.addRow(false);
						}
						
						model.refresh();
						
					]]>
				</script>
			</select1>
			<caption id="caption42" class="list_cap03" style="left:498px; top:50px; width:85px; height:26px; text-align:center; ">입금표종류</caption>
			<select1 id="rcpm_shet_kind" ref="/root/resData/gridData/gridData2/dataSet/CURLIST4/record/rcpm_shet_kind" navindex="28" appearance="minimal" editmode="inputsearch" style="left:587px; top:54px; width:130px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2120_m/dataSet/RCPM_SHET_KIND_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(rcpm_shet_kind, rcpm_shet_kind.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(rcpm_shet_kind,"");
						return;
					}
					]]>
				</script>
			</select1>
			<caption id="caption43" class="list_cap03" style="left:722px; top:50px; width:85px; height:26px; text-align:center; ">입금표번호</caption>
			<input id="rcpm_shet_no" ref="/root/resData/gridData/gridData2/dataSet/CURLIST4/record/rcpm_shet_no" navindex="29" editable="false" inputtype="button" maxlength="7" style="left:811px; top:54px; width:112px; height:18px; background-color:#ffffff; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					
						model.property("FC_ACCT_2860_popup_flag") = "Y";
						model.property("FC_ACCT_2860_rcpm_shet_kind")  = rcpm_shet_kind.value;
						model.property("FC_ACCT_2860_dept_no")  = impt_dept.value;

						viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2860");

						rcpm_shet_kind.value = model.property("FC_ACCT_2860_rcpm_shet_kind");
						rcpm_shet_no.value = model.property("FC_ACCT_2860_widr_resn");
					
						model.property("FC_ACCT_2860_rcpm_shet_kind")  = "";
						model.property("FC_ACCT_2860_widr_resn") = "";
						
					]]>
				</script>
			</input>
			<switch id="switch2" style="left:0px; top:110px; width:928px; height:200px; ">
				<case id="case1" style="left:0px; top:0px; width:835px; height:108px; ">
					<caption id="caption49" class="list_cap02" style="left:139px; top:25px; width:151px; height:26px; text-align:center; "/>
					<caption id="caption48" class="list_cap03" style="left:20px; top:25px; width:120px; height:26px; text-align:center; ">입금금액</caption>
					<input id="rcpm_amt" ref="/root/resData/gridData/gridData2/dataSet/CURLIST/record/rcpm_amt" class="req" format="(-)#,###" style="left:144px; top:29px; width:140px; height:18px; text-align:right; "/>
				</case>
				<case id="case2" selected="true">
					<datagrid id="datagrid1" nodeset="/root/resData/gridData/gridData2/dataSet/CURLIST1/record" caption="SEQ^입금일자^입금금액^입금자명^관리구분^수수료^외화구분^환율^외화금액^acct_mang_no^biz_reg_no^bank_id^acct_num^tran_date_seq^current_clsf" colsep="#" colwidth="50, 100, 100, 100, 140, 100, 100, 100, 88, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedcols="byrowrec" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:5px; top:5px; width:916px; height:160px; ">
						<col ref="g1_rcpm_slip_seq" type="input"/>
						<col ref="g1_rcpm_dt" type="inputdate"/>
						<col ref="g1_rcpm_amt" type="input" format="(-)#,###" style="text-align:right; "/>
						<col ref="g1_rcpm_pers_nm" type="input" style="text-align:left; "/>
						<col editmode="inputsearch" ref="g1_deps_psbk" type="combo" style="text-align:left; ">
							<choices>
								<itemset nodeset="/root/initData/comboSet/fc_acct_2120_m/dataSet/G1_MANG_CLSF_CURLIST/record">
									<label ref="cdabrvnm_cd"/>
									<value ref="cd"/>
								</itemset>
							</choices>
						</col>
						<col ref="g1_coms" type="input" format="(-)#,###" style="text-align:right; "/>
						<col editmode="inputsearch" ref="g1_frex_clsf" type="combo" style="text-align:left; ">
							<choices>
								<itemset nodeset="/root/initData/comboSet/fc_acct_2120_m/dataSet/G1_FRCR_CLSF_CURLIST/record">
									<label ref="cdabrvnm_cd"/>
									<value ref="cd"/>
								</itemset>
							</choices>
						</col>
						<col ref="g1_exrate" type="input" format="(-)#,##0.0000" style="text-align:right; "/>
						<col ref="g1_frex_amt" type="input" format="(-)#,##0.00" style="text-align:right; "/>
						<col ref="acct_mang_no" visibility="hidden"/>
						<col ref="biz_reg_no" visibility="hidden"/>
						<col ref="bank_id" visibility="hidden"/>
						<col ref="acct_num" visibility="hidden"/>
						<col ref="tran_date_seq" visibility="hidden"/>
						<col ref="current_clsf" visibility="hidden"/>
						<!--col ref="acct_mang_no"/>
						<col ref="biz_reg_no"/>
						<col ref="bank_id"/>
						<col ref="acct_num"/>
						<col ref="tran_date_seq"/>
						<col ref="current_clsf"/-->
						<script type="javascript" ev:event="onclick">
							<![CDATA[
								var cnt = 0;			
								if(datagrid1.mouseCol == 0){

									if(datagrid1.rowStatus(datagrid1.mouseRow) == "4"){
//										datagrid1.removeStatus(datagrid1.mouseRow, "delete");
										datagrid1.rowStatus(datagrid1.mouseRow) = "1";
									}
									else {
//										datagrid1.addStatus(datagrid1.mouseRow, "delete");
										datagrid1.rowStatus(datagrid1.mouseRow) = "4";
									}

//									datagrid1.addStatus(datagrid1.mouseRow, "delete");
//									datagrid1.rowStatus(datagrid1.row) = "4";
								}						
							]]>
						</script>
						<script type="javascript" ev:event="ondblclick">
							<![CDATA[
							
//								if(!isDataRegion(datagrid1)) return;

								//그리드 스크롤바 클릭, 더블클릭 방지 소스
								if (-1 != event.target.lastIndexOf("scroll.thumb")) {
									return;
								}
								
								if (datagrid1.mouseRow < 1) {
									return;
								}
								
								var grid = eval(event.currentTarget);
								var rowid = grid.row;
								var colid = grid.col;
								
								if (rowid < grid.fixedRows || colid < grid.fixedCols) {
									return;
								}

				
//								if(!isDataRegion(datagrid1)) return;
//
//
//								
//								if(!datagrid1.iscell(event.target))  return;

				  				var dataIndex = datagrid1.row; // getSelectedRecordIndex(datagrid1);
								if(dataIndex > 0){
									
									var acct_mang_no = model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST1/record["+dataIndex+"]/g1_deps_psbk");

				  					model.makeNode("/root/reqData/fwdData/acct_mang_no_ref");	
				  					model.setValue("/root/reqData/fwdData/acct_mang_no_ref", "/root/resData/gridData/gridData2/dataSet/CURLIST1/record["+dataIndex+"]/g1_deps_psbk");		
//				  					model.makeNode("/root/reqData/fwdData/acct_mang_nm_ref");	
//				  					model.setValue("/root/reqData/fwdData/acct_mang_nm_ref", "/root/resData/gridData/gridData2/dataSet/CURLIST1/record["+dataIndex+"]/g1_deps_psbk");	  					
				  					model.makeNode("/root/reqData/fwdData/tran_amt_ref");	
				  					model.setValue("/root/reqData/fwdData/tran_amt_ref", "/root/resData/gridData/gridData2/dataSet/CURLIST1/record["+dataIndex+"]/g1_rcpm_amt");
				  					model.makeNode("/root/reqData/fwdData/tran_content_ref");	
				  					model.setValue("/root/reqData/fwdData/tran_content_ref", "/root/resData/gridData/gridData2/dataSet/CURLIST1/record["+dataIndex+"]/g1_rcpm_pers_nm");		
				  					model.makeNode("/root/reqData/fwdData/acct_tonghwa_ref");	
				  					model.setValue("/root/reqData/fwdData/acct_tonghwa_ref", "/root/resData/gridData/gridData2/dataSet/CURLIST1/record["+dataIndex+"]/g1_frex_clsf");
				  					
				  					model.makeNode("/root/reqData/fwdData/frex_amt_ref");
				  					model.setValue("/root/reqData/fwdData/frex_amt_ref", "/root/resData/gridData/gridData2/dataSet/CURLIST1/record["+dataIndex+"]/g1_frex_amt");
				  							
									loadRcpmDtlsPop("H1"
									                ,""
									                ,"/root/resData/gridData/gridData2/dataSet/CURLIST1/record["+dataIndex+"]/biz_reg_no"
									                ,"/root/resData/gridData/gridData2/dataSet/CURLIST1/record["+dataIndex+"]/bank_id"
									                ,"/root/resData/gridData/gridData2/dataSet/CURLIST1/record["+dataIndex+"]/acct_num"
									                ,"/root/resData/gridData/gridData2/dataSet/CURLIST1/record["+dataIndex+"]/g1_rcpm_dt"
									                ,"/root/resData/gridData/gridData2/dataSet/CURLIST1/record["+dataIndex+"]/tran_date_seq"
									                ,"/root/resData/gridData/gridData2/dataSet/CURLIST1/record["+dataIndex+"]/current_clsf"
												   ,"/root/reqData/fwdData"); 
									
									var pre_biz_reg_no 	=	"";
									var pre_bank_id		=	"";
									var pre_acct_num		=	"";
									var pre_rmtt_dt		=	"";
									var pre_tran_date_seq	=	"";
									var pre_current_clsf	=	"";
//									alert(datagrid1.fixedRows);
									for(var i=datagrid1.fixedRows; i<datagrid1.rows;i++){
										
										var biz_reg_no 	    =	datagrid1.valueMatrix(i, datagrid1.colRef("biz_reg_no"));
										var bank_id	    =	datagrid1.valueMatrix(i, datagrid1.colRef("bank_id"));
										var acct_num	    =	datagrid1.valueMatrix(i, datagrid1.colRef("acct_num"));
										var rmtt_dt		    =	datagrid1.valueMatrix(i, datagrid1.colRef("g1_rcpm_dt"));
										var tran_date_seq  =	datagrid1.valueMatrix(i, datagrid1.colRef("tran_date_seq"));
										var current_clsf	    =	datagrid1.valueMatrix(i, datagrid1.colRef("current_clsf"));					
										
										if (current_clsf == "KRW"){
											datagrid1.valueMatrix(i, datagrid1.colRef("current_clsf")) = "";
										}
										
										if(pre_biz_reg_no != ""){
											if(pre_biz_reg_no 	== 	biz_reg_no &&
											   pre_bank_id		==	bank_id &&
											   pre_acct_num	==	acct_num &&
											   pre_rmtt_dt		==	rmtt_dt &&
											   pre_tran_date_seq	==	tran_date_seq &&
											   pre_current_clsf	==	current_clsf){
											   	
											   	alert("같은 입금계좌내역이 있습니다.");
											   	datagrid1.deleteRow(i);
											   	datagrid1.insertRow(i);
											   	return;
											}
										}
										
										pre_biz_reg_no 	    =	biz_reg_no;    
										pre_bank_id	    =	bank_id;		    
										pre_acct_num	    =	acct_num;	    
										pre_rmtt_dt	    =	rmtt_dt;	    
										pre_tran_date_seq =	tran_date_seq;
										pre_current_clsf	    =	current_clsf;				
									}							   
									
									datagrid1.refresh();
								   
								}					
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								var i = datagrid1.row;
								
								var ch_colref = datagrid1.colRef("g1_deps_psbk");
								
								if(datagrid1.col == ch_colref){
								
									var ch_var = datagrid1.valueMatrix(i, ch_colref);
								
									if(grid_combo_data_contains(ch_var,"/root/initData/comboSet/fc_acct_2120_m/dataSet/G1_MANG_CLSF_CURLIST/record","cd") == -1){
										show_message("정확한 값을 선택해 주세요.");
										datagrid1.valueMatrix(i, ch_colref) = "";
										return;
									}
								}

								var ch_colref = datagrid1.colRef("g1_frex_clsf");
								
								if(datagrid1.col == ch_colref){
								
									var ch_var = datagrid1.valueMatrix(i, ch_colref);
								
									if(grid_combo_data_contains(ch_var,"/root/initData/comboSet/fc_acct_2120_m/dataSet/G1_FRCR_CLSF_CURLIST/record","cd") == -1){
										show_message("정확한 값을 선택해 주세요.");
										datagrid1.valueMatrix(i, ch_colref) = "";
										return;
									}
								}								
								
							]]>
						</script>
					</datagrid>
					<button id="btn_insert_row" class="btn_grid03" style="left:856px; top:174px; width:53px; height:17px; ">
						<caption>행추가</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
					datagrid1.addRow();
				]]>
						</script>
					</button>
				</case>
				<case id="case3">
					<datagrid id="datagrid2" nodeset="/root/resData/gridData/gridData2/dataSet/CURLIST2/record" caption="SEQ^어음번호^입금금액^어음구분^금융기관^금융기관명^발행인^발행사코드^기산일^만기일^입금계좌^매출승인번호" colsep="#" colwidth="30, 80, 80, 80, 80, 80, 80, 80, 75, 75, 75, 63" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:5px; top:5px; width:916px; height:160px; ">
						<col ref="g2_rcpm_sub_seq" type="input"/>
						<col ref="g2_note_no" type="input" style="text-align:center; "/>
						<col ref="g2_rcpm_amt" type="input" format="(-)#,###" style="text-align:right; "/>
						<col editmode="inputsearch" ref="g2_note_clsf_cd" type="combo" style="text-align:left; ">
							<choices>
								<itemset nodeset="/root/initData/comboSet/fc_acct_2120_m/dataSet/G2_NOTE_CLSF_CURLIST/record">
									<label ref="cdabrvnm_cd"/>
									<value ref="cd"/>
								</itemset>
							</choices>
						</col>
						<col ref="g2_bank_cd" type="inputbutton" maxlength="6"/>
						<col ref="g2_bank_cd_nm" format="(-)#,###" style="text-align:left; "/>
						<col ref="g2_issu_pers_nm" type="input" style="text-align:left; "/>
						<col editmode="inputsearch" ref="g2_issu_cmpy_clsf_cd" type="combo">
							<choices>
								<itemset nodeset="/root/initData/comboSet/fc_acct_2120_m/dataSet/G2_ISSU_CMPY_CD_CURLIST/record">
									<label ref="cdabrvnm_cd"/>
									<value ref="cd"/>
								</itemset>
							</choices>
						</col>
						<col ref="g2_comp_dt" type="inputdate"/>
						<col ref="g2_mtry_dt" type="inputdate"/>
						<col editmode="inputsearch" ref="g2_rcpm_acct" type="combo" style="text-align:left; ">
							<choices>
								<itemset nodeset="/root/initData/comboSet/fc_acct_2120_m/dataSet/G2_RCPM_ACCT_CURLIST/record">
									<label ref="cdabrvnm_cd"/>
									<value ref="cd"/>
								</itemset>
							</choices>
						</col>
						<col ref="g2_sale_aprv_no" type="input" style="text-align:left; "/>
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								var getRow = datagrid2.row;
								var getCol = datagrid2.col;							
							
								if (getCol== 5) {		// 금융기관
									var cd   =  "";
									var cdnm =  "";
																
									var resultRef1 = "/root/resData/gridData/popupData/bank_cd";
									var resultRef2 = "/root/resData/gridData/popupData/bank_cd_nm";							
		
									showCommonCodePopup1("02", "71", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");

									datagrid2.valueMatrix(getRow,getCol) = model.getValue(resultRef1);
									datagrid2.valueMatrix(getRow,getCol+1) = model.getValue(resultRef2);
								}
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								var i = datagrid2.row;
								
								var ch_colref = datagrid2.colRef("g2_note_clsf_cd");
								
								if(datagrid2.col == ch_colref){
								
									var ch_var = datagrid2.valueMatrix(i, ch_colref);
								
									if(grid_combo_data_contains(ch_var,"/root/initData/comboSet/fc_acct_2120_m/dataSet/G2_NOTE_CLSF_CURLIST/record","cd") == -1){
										show_message("정확한 값을 선택해 주세요.");
										datagrid2.valueMatrix(i, ch_colref) = "";
										return;
									}
								}
								var ch_colref = datagrid2.colRef("g2_issu_cmpy_clsf_cd");
								
								if(datagrid2.col == ch_colref){
								
									var ch_var = datagrid2.valueMatrix(i, ch_colref);
								
									if(grid_combo_data_contains(ch_var,"/root/initData/comboSet/fc_acct_2120_m/dataSet/G2_ISSU_CMPY_CD_CURLIST/record","cd") == -1){
										show_message("정확한 값을 선택해 주세요.");
										datagrid2.valueMatrix(i, ch_colref) = "";
										return;
									}
								}

								var ch_colref = datagrid2.colRef("g2_rcpm_acct");
								
								if(datagrid2.col == ch_colref){
								
									var ch_var = datagrid2.valueMatrix(i, ch_colref);
								
									if(grid_combo_data_contains(ch_var,"/root/initData/comboSet/fc_acct_2120_m/dataSet/G2_RCPM_ACCT_CURLIST/record","cd") == -1){
										show_message("정확한 값을 선택해 주세요.");
										datagrid2.valueMatrix(i, ch_colref) = "";
										return;
									}
								}
																							
								var getRow = datagrid2.row;
								var getCol = datagrid2.col;			
							
								if (getCol== 5) {
									if (datagrid2.valueMatrix(getRow, getCol) == "") {
										datagrid2.valueMatrix(getRow, getCol+1) = "";
									}
								}						
							]]>
						</script>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
								var cnt = 0;			
								if(datagrid2.mouseCol == 0){

									if(datagrid2.rowStatus(datagrid2.mouseRow) == "4"){
//										datagrid1.removeStatus(datagrid1.mouseRow, "delete");
										datagrid2.rowStatus(datagrid2.mouseRow) = "1";
									}
									else {
//										datagrid1.addStatus(datagrid1.mouseRow, "delete");
										datagrid2.rowStatus(datagrid2.mouseRow) = "4";
									}

//									datagrid1.addStatus(datagrid1.mouseRow, "delete");
//									datagrid1.rowStatus(datagrid1.row) = "4";
								}							
							]]>
						</script>
					</datagrid>
					<button id="button2" class="btn_grid03" style="left:856px; top:174px; width:53px; height:17px; ">
						<caption>행추가</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
					datagrid2.addRow();
				]]>
						</script>
					</button>
				</case>
				<case id="case4">
					<datagrid id="datagrid3" nodeset="/root/resData/gridData/gridData2/dataSet/CURLIST3/record" caption="SEQ^예산코드^예산명^입금금액^전사전표구분^전사전표번호" colsep="#" colwidth="50, 170, 170, 170, 153, 165" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:5px; top:5px; width:916px; height:160px; ">
						<col ref="g3_rcpm_sub_seq" type="input"/>
						<col ref="g3_budg_cd" type="inputbutton" maxlength="6" style="text-align:center; "/>
						<col ref="g3_budg_cd_nm" style="text-align:left; "/>
						<col ref="g3_rcpm_amt" type="input" format="(-)#,###" style="text-align:right; "/>
						<col editmode="inputsearch" ref="g3_whco_slip_clsf" type="combo" style="text-align:left; ">
							<choices>
								<itemset nodeset="/root/initData/comboSet/fc_acct_2120_m/dataSet/G3_WHCO_SLIP_CLSF_CURLIST/record">
									<label ref="cdabrvnm_cd"/>
									<value ref="cd"/>
								</itemset>
							</choices>
						</col>
						<col ref="g3_whco_slip_no" type="inputbutton" style="text-align:left; "/>
						<script type="javascript" ev:event="onbuttonclick">
							<![CDATA[
								var getRow = datagrid3.row;
								var getCol = datagrid3.col;		
								
								if (getCol== 2) {

									model.removeNodeset("/root/reqData/fwdData");  
									
									model.makeNode("/root/reqData/fwdData/cmpy_cd");
									model.makeNode("/root/reqData/fwdData/G_Tag");
									model.makeNode("/root/reqData/fwdData/G_Caption");
									model.makeNode("/root/reqData/fwdData/G_Codenu");
									model.makeNode("/root/reqData/fwdData/G_BRCode");
									
									model.setValue("/root/reqData/fwdData/cmpy_cd", model.getValue("/root/initData/session/cmpy_cd"));
									model.setValue("/root/reqData/fwdData/G_Tag", "1");
									model.setValue("/root/reqData/fwdData/G_Caption", "예산코드조회");
									model.setValue("/root/reqData/fwdData/G_Codenu", "");					
									model.setValue("/root/reqData/fwdData/G_BRCode", "");
			
									gstr_popupid = "g3_budg_cd";
								
									window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
									
								}
								else if (getCol == 6) {
		
									if(datagrid3.valueMatrix(datagrid3.row,2).substring(0, 4) == "4045"){
										model.property("FC_ACCT_2040_srchdept_cd")  = impt_dept.value;
										model.property("FC_ACCT_2040_srchdept_nm") = impt_dept_nm.value;
										model.property("FC_ACCT_2040_srchoccr_acct_cd") = datagrid3.valueMatrix(datagrid3.row,2).substring(0, 4);
					
										viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2040");
										var tmp_slip_no = model.property("FC_ACCT_2040_slip_no");
										
										datagrid3.valueMatrix(datagrid3.row,6) = tmp_slip_no.ReplaceString("-", "");
										
										model.property("FC_ACCT_2040_slip_no") = "";	
									}else{
										model.property("FC_ACCT_2500_popup_clsf")  = "Y";
										model.property("FC_ACCT_2500_srch_occr_slip_clsf")  = datagrid3.valueMatrix(datagrid3.row,5).substring(0, 2);
									
	//									viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2500");
										viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2500");
										
	//									alert(model.property("FC_ACCT_2500_srch_occr_slip_clsf"));
										
										datagrid3.valueMatrix(datagrid3.row,5) = model.property("FC_ACCT_2500_srch_occr_slip_clsf");
										datagrid3.valueMatrix(datagrid3.row,6) = model.property("FC_ACCT_2500_occr_slip");
										
										model.property("FC_ACCT_2500_occr_slip") = "";
										model.property("FC_ACCT_2500_srch_occr_slip_clsf") = "";
									}
								}
							]]>
						</script>
						<script type="javascript" ev:event="xforms-value-changed">
							<![CDATA[
								var i = datagrid3.row;
								
								var ch_colref = datagrid3.colRef("g3_whco_slip_clsf");
								
								if(datagrid3.col == ch_colref){
								
									var ch_var = datagrid3.valueMatrix(i, ch_colref);
								
									if(grid_combo_data_contains(ch_var,"/root/initData/comboSet/fc_acct_2120_m/dataSet/G3_WHCO_SLIP_CLSF_CURLIST/record","cd") == -1){
										show_message("정확한 값을 선택해 주세요.");
										datagrid3.valueMatrix(i, ch_colref) = "";
										return;
									}
								}
															
								var getRow = datagrid3.row;
								var getCol = datagrid3.col;		
								
								if (getCol== 2) {
									if (datagrid3.valueMatrix(datagrid3.row,2).Trim().length == 6) {
										model.setValue("/root/reqData/searchData/budg_cd", datagrid3.valueMatrix(datagrid3.row,2));
										model.send("fc_co_8001_s");
							
										if (model.getValue("/root/initData/popupSet/fc_co_8001_s/dataSet/CURLIST/totalcnt") != "0") {
											datagrid3.valueMatrix(datagrid3.row,3) =  model.getValue("/root/initData/popupSet/fc_co_8001_s/dataSet/CURLIST/record/budg_cdnm");
										}
										else {
											datagrid3.valueMatrix(datagrid3.row,2) = "";
											datagrid3.valueMatrix(datagrid3.row,3) = "";
										}
									}
									else {
										datagrid3.valueMatrix(datagrid3.row,2) = "";
										datagrid3.valueMatrix(datagrid3.row,3) = "";
									}
								}
								else if (getCol == 6) {
								}
							]]>
						</script>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
								var cnt = 0;			
								if(datagrid3.mouseCol == 0){

									if(datagrid3.rowStatus(datagrid3.mouseRow) == "4"){
//										datagrid1.removeStatus(datagrid1.mouseRow, "delete");
										datagrid3.rowStatus(datagrid3.mouseRow) = "1";
									}
									else {
//										datagrid1.addStatus(datagrid1.mouseRow, "delete");
										datagrid3.rowStatus(datagrid3.mouseRow) = "4";
									}

//									datagrid1.addStatus(datagrid1.mouseRow, "delete");
//									datagrid1.rowStatus(datagrid1.row) = "4";
								}							
							]]>
						</script>
					</datagrid>
					<button id="button3" class="btn_grid03" style="left:856px; top:174px; width:53px; height:17px; ">
						<caption>행추가</caption>
						<script type="javascript" ev:event="onclick">
							<![CDATA[
					datagrid3.addRow();
				]]>
						</script>
					</button>
				</case>
			</switch>
			<button id="btn_tab_01" class="tab05" group="1" style="left:0px; top:88px; width:92px; height:23px; ">
				<caption>현금입금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.toggle("case1");
					]]>
				</script>
			</button>
			<button id="btn_tab_02" class="tab05" group="1" style="left:92px; top:88px; width:92px; height:23px; ">
				<caption>예금입금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						_oth_clsf = "1";
						model.toggle("case2");		
					]]>
				</script>
			</button>
			<button id="btn_tab_03" class="tab05" group="1" style="left:184px; top:88px; width:92px; height:23px; ">
				<caption>어음입금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						_oth_clsf = "2";
						model.toggle("case3");		
					]]>
				</script>
			</button>
			<button id="btn_tab_04" class="tab05" group="1" style="left:276px; top:88px; width:92px; height:23px; ">
				<caption>기타입금</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						_oth_clsf = "3";
						model.toggle("case4");		
					]]>
				</script>
			</button>
			<caption id="caption60" class="list_cap03" style="left:249px; top:50px; width:85px; height:26px; text-align:center; ">입금전표번호</caption>
			<select1 id="rcpm_slip_no2" ref="/root/resData/resform/rcpm_slip_no2" navindex="27" appearance="minimal" editmode="inputsearch" style="left:339px; top:54px; width:155px; height:18px; text-align:center; ">
				<choices>
					<itemset nodeset="/root/resData/gridData/gridData1/dataSet/CURLIST2/record">
						<label ref="rcpm_slip_no2"/>
						<value ref="rcpm_slip_no2"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(rcpm_slip_no2, rcpm_slip_no2.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(rcpm_slip_no2,"");
							return;
						}

						btn_tab_01.dispatch("onclick");	// tab 초기화

						if (rcpm_slip_no2.value != "") {
							
							model.setValue("/root/reqData/searchData/rcpm_slip_occr_dt", rcpm_slip_no2.value.substring(0, 8));    	// 입금일자
							model.setValue("/root/reqData/searchData/rcpm_slip_clsf_cd", rcpm_slip_no2.value.substring(9, 11));    	// 발생전표구분
							model.setValue("/root/reqData/searchData/rcpm_slip_seq", rcpm_slip_no2.value.substring(12, 16));      	// 입금일련번호
							model.setValue("/root/reqData/searchData/slip_occr_dt", tax_stmt_no.value.substring(2,10));
							model.setValue("/root/reqData/searchData/slip_seq", tax_stmt_no.value.substring(10,14));
							
							model.send("fc_acct_2128_s");

							set_refvalue(rcpm_slip_no,get_refvalue("/root/resData/gridData/gridData2/dataSet/CURLIST4/record/rcpm_slip_no"));
																					
							var ch1,ch2,ch3,ch4;
							ch1 = get_refvalue("/root/resData/gridData/gridData2/dataSet/CURLIST/record/rcpm_amt");
							ch2 = get_refvalue("/root/resData/gridData/gridData2/dataSet/CURLIST1/totalcnt");
							ch3 = get_refvalue("/root/resData/gridData/gridData2/dataSet/CURLIST2/totalcnt");
							ch4 = get_refvalue("/root/resData/gridData/gridData2/dataSet/CURLIST3/totalcnt");
							
							if(ch1 != ""){
								btn_tab_01.dispatch("onclick");	
							}else if(ch2 > 0 ){
								btn_tab_02.dispatch("onclick");	
							}else if(ch3 > 0){
								btn_tab_03.dispatch("onclick");	
							}else if(ch4 > 0){
								btn_tab_04.dispatch("onclick");	
							}
							

							for (i=1;i<=datagrid1.rows; i++) {
								if (datagrid1.valueMatrix(i, 14) != "") {
									datagrid1.valueMatrix(i, 15) = "D";
								}
							}
						}
						else {
							
//							datagrid1.re
							
//							model.removeNodeset("/root/resData/gridData/gridData2/dataSet/CURLIST/record");  
//							model.removeNodeset("/root/resData/gridData/gridData2/dataSet/CURLIST1/record");  
//							model.removeNodeset("/root/resData/gridData/gridData2/dataSet/CURLIST2/record");  
//							model.removeNodeset("/root/resData/gridData/gridData2/dataSet/CURLIST3/record");  
//							model.removeNodeset("/root/resData/gridData/gridData2/dataSet/CURLIST4/record");  

							model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST/record");  
							model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST1/record");  
							model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST2/record");  
							model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST3/record");  
							model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST4/record");  
							set_refvalue(rcpm_slip_no,"");
							model.refresh();

						}

						for (i=0;i<20;i++) {
							datagrid1.addRow(false);
							datagrid2.addRow(false);
							datagrid3.addRow(false);
						}
						
						model.refresh();
						
					]]>
				</script>
			</select1>
			<button id="btnClear" class="btn04" crud="P" style="left:385px; top:88px; width:87px; height:21px; ">
				<caption>입금내역 초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
				
						btn_tab_01.dispatch("onclick");	// tab 초기화

						model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST/record");  
						model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST1/record");  
						model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST2/record");  
						model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST3/record");  
						model.resetInstanceNode("/root/resData/gridData/gridData2/dataSet/CURLIST4/record");  
//						set_refvalue(rcpm_slip_no, "");
//						set_refvalue(rcpm_slip_no2, "");
						
						model.refresh();

						for (i=0;i<20;i++) {
							datagrid1.addRow(false);
							datagrid2.addRow(false);
							datagrid3.addRow(false);
						}
						
						model.refresh();
						show_message("입금내역이 초기화되었습니다.");
					]]>
				</script>
			</button>
		</group>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:734px; width:926px; height:21px; ">
			<button id="btn_select" class="btn02" crud="R" style="left:0px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[

						var var_temp_tax_stmt_clsf = "";
						var var_temp_tax_stmt_dt = "";
						var var_temp_tax_stmt_seq = "";

						if (tax_stmt_no.value.ReplaceString("-", "").substring(0, 2) != "30") {
							show_message("세금계산서구분은 30 만 가능합니다.필수입력항목입니다.");
							model.setFocus("tax_stmt_no");
							return;							
						}

						if (tax_stmt_no.value.ReplaceString("-", "").length!= 14) {
							show_message("세금계산서번호는 필수입력항목입니다.");
							model.setFocus("tax_stmt_no");
							return;							
						}
						
						var var_temp_tax_stmt_no = tax_stmt_no.value;
						
						if (gvar_form_load_flag == "Y") {
							// 
						} else {
							btnReset.dispatch("onclick");
						}
						
						tax_stmt_no.value = var_temp_tax_stmt_no;
						
						model.setValue("/root/reqData/searchData/slip_clsf_cd", tax_stmt_no.value.substring(0, 2));      			// 발생전표구분
						model.setValue("/root/reqData/searchData/slip_occr_dt", tax_stmt_no.value.substring(2, 10));      			// 발생일자
						model.setValue("/root/reqData/searchData/slip_seq", tax_stmt_no.value.substring(10, 14));      			// 일련번호
						model.setValue("/root/reqData/searchData/uid", model.getValue("/root/initData/session/uid"));      			// 아이디
						model.setValue("/root/reqData/searchData/emp_no", model.getValue("/root/initData/session/emp_no"));      	// 사번
						
						gvar_stmt_slip_no = "";
						gvar_reg_clsf = "";

						model.send("fc_acct_2121_l");

						// 개인별 권한관리 부분 => 조회SP에 구현

						if(submit_completed()){

							makeComboGubun("", "/root/resData/gridData/gridData1/dataSet/CURLIST1", "record", "rcpm_slip_no", "rcpm_slip_no")
							makeComboGubun("", "/root/resData/gridData/gridData1/dataSet/CURLIST2", "record", "rcpm_slip_no2", "rcpm_slip_no2")
							
							stmt_slip_no.value = "";
							
							gvar_rcpm_slip_no_cnt = Number(model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST1/totalcnt"));
							
							if(model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/draft_doc_no") !=""){
								draft_expn_amt.attribute("editable") = "false";
								draft_impt_amt.attribute("editable") = "false";
								control_unmark_req1(draft_expn_amt);
								control_unmark_req1(draft_impt_amt);
							}
							else{
								draft_expn_amt.attribute("editable") = "true";
								draft_impt_amt.attribute("editable") = "true";
								control_unmark_req(draft_expn_amt);
								control_unmark_req(draft_expn_amt);
							}
	
							if (model.getValue("/root/resData/gridData/gridData1/errData/errcode") != "") {
								return;
							}
	
							if (model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/totalcnt") == 0) {
								show_message("검색결과가 없습니다.");
								return;
							}
						
							impt_dept.attribute("editable") = "false";
							impt_emp_no.attribute("editable") = "false";
//							prof_kind.disabled = true;
							slip_clsf.disabled = true;
						
//							if (dlco_cd.value == "") {
//								boks_dlco_nm.value = ernm.value;
//							}
	
							gvar_tax_stmt_aprv_yn = model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/tax_stmt_aprv_yn");		// 세금계산서 상태
							gvar_upd_tms = model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/upd_tms");					// 수정횟수
							
							gvar_stmt_slip_no = model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/occr_slip_occr_dt") + 
							                            model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/occr_slip_clsf_cd") +
							                            model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/occr_slip_seq");
	
							gvar_reg_clsf = model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/reg_clsf");
	
							stmt_slip_no.value = gvar_stmt_slip_no;
							
//							if (gvar_tax_stmt_aprv_yn == "") {	// 세금계산서상태가 의뢰인 경우
//								stmt_rmtt_yn.value = "Y";
//								btn_update.disabled = false;
//								btn_delete.disabled = false;
//								btn_insert.disabled = true;
//								return;
//							}
							
							stmt_rmtt_yn.value = "Y";
							btn_update.disabled = false;
							btn_delete.disabled = false;
							btn_insert.disabled = true;


//						if (model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST1/totalcnt") > 0) {
//							btn_update.disabled = true;
//							btn_delete.disabled = true;
//						}
						

					
//    If rv <> 0 Then
//        cboGTIIGPTYPE.Locked = True
//        txtGTIIGPNO.Locked = True
//        cboGTIJJBSJPGB.Locked = True
//        txtGTIJJBSJPNO.Locked = True
//        txtGTIIGAMT.Locked = True
//        txtGTIIGAMT1.Locked = True
//        txtGTIIGAMT2.Locked = True
//        txtGTIIGAMT3.Locked = True
//        txtGTISSRAMT.Locked = True
//        txtGTIBANKCD.Locked = True
//        txtGTIEENO.Locked = True
//        txtGTIYSCD.Locked = True
//    Else
//        gMISU = "Y"
//    End If
//    
//    GGTIGJPNO = GTIGJPBSCYMD$(0) & GTIGJPGBCD$(0) & GTIGJPSEQ$(0) '기타입금전표번호
//    txtGTIGJPBSCYMD.Text = GTIGJPBSCYMD$(0)
//    cboGTIGJPGBCD.Text = GTIGJPGBCD$(0)
//    txtGTIGJPSEQ.Text = GTIGJPSEQ$(0)
//    
//    GGTICYMD = GTICYMD$(0)              '입금일자(KEY)



//						dlco_cd.disabled = false;
//						
//						if (GGTIGJPNO != "" && gvar_stmt_slip_no != "") {
//							btn_update.disabled = true;
//							btn_delete.disabled = true;
//						}
//						else {
//							if (gvar_stmt_slip_no != "") {	// 계산서전표번호가 있으면서
//								if (gMISU != "Y") {		// 미수건이 아니면
//									btn_update.disabled = true;
//									btn_delete.disabled = false;
//									btn_insert.disabled = false;
//								}
//								else {
//									btn_update.disabled = false;
//									btn_delete.disabled = true;
//									btn_insert.disabled = true;
//								}
//							}
//							else {
//								btn_update.disabled = false;
//								btn_delete.disabled = true;
//								btn_insert.disabled = false;
//							}
//						}
							var cd_var = model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/mang_clsf_cd");
							budg_cd.dispatch("xforms-value-changed");
							code_cd.value = cd_var;
							prof_kind.dispatch("xforms-value-changed");

							if (get_refvalue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/semuro_no") != " " && get_refvalue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/semuro_no") != "" ) {
								if(get_refvalue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/semuro_no").length == 24){
									elec_tax_no1.value = get_refvalue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/semuro_no").substring(0, 8);
									elec_tax_no2.value = get_refvalue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/semuro_no").substring(8, 16);
									elec_tax_no3.value = get_refvalue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/semuro_no").substring(16, 24);
								}
							}

							if (gvar_tax_stmt_aprv_yn == "2") {	// 세금계산서상태가 '2'이면 수정, 삭제 불가
								erplace_cd.disabled = true;
	//							erplace_cd.attribute("editable") = "false";
	//							erplace_cd.attribute("background-color") = DEFAULT_COLOR_DISABLE;
	//							ern.disabled = true;
								ern.attribute("editable") = "false";
								ern.attribute("background-color") = DEFAULT_COLOR_DISABLE;
	//							item.disabled = true;
								item.attribute("editable") = "false";
								item.attribute("background-color") = DEFAULT_COLOR_DISABLE;
	//							suply_amt.disabled = true;
								suply_amt.attribute("editable") = "false";
								suply_amt.attribute("background-color") = DEFAULT_COLOR_DISABLE;
	//							vat_amt.disabled = true;
								vat_amt.attribute("editable") = "false";
								vat_amt.attribute("background-color") = DEFAULT_COLOR_DISABLE;
								dlco_clsf_cd.disabled = true;
	//							dlco_clsf_cd.attribute("editable") = "false";
	//							dlco_clsf_cd.attribute("background-color") = DEFAULT_COLOR_DISABLE;
	//							dlco_cd.disabled = true;
								dlco_cd.attribute("editable") = "false";
								dlco_cd.attribute("background-color") = DEFAULT_COLOR_DISABLE;
								elec_tax_comp_cd.disabled = true;
								elec_tax_no1.disabled = true;
								elec_tax_no2.disabled = true;
								elec_tax_no3.disabled = true;
								
							}else{
								erplace_cd.disabled = false;
	//							erplace_cd.attribute("editable") = "false";
	//							erplace_cd.attribute("background-color") = DEFAULT_COLOR_DISABLE;
	//							ern.disabled = true;
								ern.attribute("editable") = "true";
								ern.attribute("background-color") = DEFAULT_COLOR_NONEREQ;
	//							item.disabled = true;
								item.attribute("editable") = "true";
								item.attribute("background-color") = DEFAULT_COLOR_NONEREQ;
	//							suply_amt.disabled = true;
								suply_amt.attribute("editable") = "true";
								suply_amt.attribute("background-color") = DEFAULT_COLOR_NONEREQ;
	//							vat_amt.disabled = true;
								vat_amt.attribute("editable") = "true";
								vat_amt.attribute("background-color") = DEFAULT_COLOR_NONEREQ;
								dlco_clsf_cd.disabled = false;
	//							dlco_clsf_cd.attribute("editable") = "false";
	//							dlco_clsf_cd.attribute("background-color") = DEFAULT_COLOR_DISABLE;
	//							dlco_cd.disabled = true;
								dlco_cd.attribute("editable") = "true";
								dlco_cd.attribute("background-color") = DEFAULT_COLOR_NONEREQ;								
								elec_tax_comp_cd.disabled = false;
								elec_tax_no1.disabled = false;
								elec_tax_no2.disabled = false;
								elec_tax_no3.disabled = false;								
							}
							
							
						}
						fun_amt();
						
						
						if(gvar_rcpm_slip_no_cnt > 0){
							rcpm_slip_no.select(1);
						}
					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" crud="C" style="left:54px; top:0px; width:52px; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						
						if (reg_clsf.value == "") {
							show_message("등록구분은 필수입력항목입니다.");
							model.setFocus("reg_clsf");
							return;							
						}
						
						if (reg_clsf.value == "1" || reg_clsf.value == "3") {
							if (budg_cd.value == "") {
								show_message("예산코드는 필수입력항목입니다.");
								model.setFocus("budg_cd");
								return;						
							}	
						}
						
						gvar_reg_clsf = reg_clsf.value;
						
						if (prof_kind.value == "") {
							show_message("증빙종류는 필수입력항목입니다.");
							model.setFocus("prof_kind");
							return;							
						}
						
						if (slip_clsf.value == "") {
							show_message("전표구분코드는 필수입력항목입니다.");
							model.setFocus("slip_clsf");
							return;							
						}
						
						if (make_dt.value.length != 8) {
							show_message("작성일자는 필수입력항목입니다.");
							model.setFocus("make_dt");
							return;							
						}
						
						if (impt_dept.value.length != 6) {
							show_message("수입부서는 필수입력항목입니다.");
							model.setFocus("impt_dept");
							return;							
						}
						
						if (impt_emp_no.value.length != 6) {
							show_message("수입사번은 필수입력항목입니다.");
							model.setFocus("impt_emp_no");
							return;							
						}
						
						if (medi_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (medi_cd.value == "") {
								show_message("매체코드는 필수입력항목입니다.");
								model.setFocus("medi_cd");
								return;							
							}							
						}

						if (dlco_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (dlco_clsf_cd.value == "") {
								show_message("거래처구분코드는 필수입력항목입니다.");
								model.setFocus("dlco_clsf_cd");
								return;							
							}
						}
						
						if (dlco_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (dlco_cd.value.ReplaceString("-", "") == "") {
								show_message("거래처코드는 필수입력항목입니다.");
								model.setFocus("dlco_cd");
								return;							
							}
						}
						
						if (boks_dlco_nm.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (boks_dlco_nm.value.Trim() == "") {
								show_message("부거래처명은 필수입력항목입니다.");
								model.setFocus("boks_dlco_nm");
								return;							
							}
						}
						
						if (code_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (code_cd.value.Trim() == "") {
								show_message("관리구분은 필수입력항목입니다.");
								model.setFocus("code_cd");
								return;							
							}
						}
						
//						if (unit.attribute("background-color") == DEFAULT_COLOR_REQ) {
//							if (unit.value.Trim() == "") {
//								show_message("단위는 필수입력항목입니다.");
//								model.setFocus("unit");
//								return;							
//							}
//						}

//						if (qunt.attribute("background-color") == DEFAULT_COLOR_REQ) {
//							if (qunt.value.Trim() == "") {
//								show_message("수량은 필수입력항목입니다.");
//								model.setFocus("qunt");
//								return;							
//							}
//						}

//						if (medi_cd.value == "110" || medi_cd.value == "210") {
//							if (dtls_medi_cd.value == "") {
//								show_message("매체코드가 110, 210 인 경우에는 상세매체코드는 필수입력사항입니다.");
//								model.setFocus("dtls_medi_cd");
//								return;							
//							}
//						}
						if(get_refvalue("/root/tempData/medi_ch") == "Y") {
							if(dtls_medi_cd.value == ""){
								show_message("상세매체코드는 필수입력항목입니다.");
								return false;
							}
						}
						
						if (erplace_cd.value == "") {
							show_message("사업장코드는 필수입력항목입니다.");
							model.setFocus("erplace_cd");
							return;							
						}
						
						if (prof_kind.value != "33" && prof_kind.value != "36" && prof_kind.value != "37" && prof_kind.value != "38" && prof_kind.value != "39") {
							if (dlco_clsf_cd.value == "") {
								show_message("거래처구분코드는 필수입력항목입니다.");
								model.setFocus("dlco_clsf_cd");
								return;							
							}
							
//							alert(dlco_cd.value.ReplaceString("-", "").length);
							if (dlco_cd.value.ReplaceString("-", "") == "") {
								show_message("거래처코드는 필수입력항목입니다.");
								model.setFocus("dlco_cd");
								return;							
							}
						}
						else {
							if (boks_dlco_nm.value.Trim() == "") {
								show_message("부거래처명은 필수입력항목입니다.");
								model.setFocus("boks_dlco_nm");
								return;							
							}
						}
						
						if (item.value == "") {
							show_message("품목은 필수입력항목입니다.");
							model.setFocus("item");
							return;							
						}
						
						if (Number(suply_amt.value) == 0) {
							show_message("공급가액은 필수입력항목입니다.");
							model.setFocus("suply_amt");
							return;							
						}
						
						fn_dlco_check();	// 거래처코드의 주소확인
						
						if (prof_kind.value != "36" && prof_kind.value != "37" && prof_kind.value != "38" && prof_kind.value != "39") {
							if (dlco_cd.value.substring(0, 2) == "93") {
								if (presi_nm.value.Trim() == "") {
									show_message("공통거래처 등록화면에서 대표자명를 수정하시오.");
									return;	
								}
								
								if (bizcond.value.Trim() == "") {
									show_message("공통거래처 등록화면에서 업태를 수정하시오.");
									return;	
								}
								
								if (erplace_item.value.Trim() == "") {
									show_message("공통거래처 등록화면에서 종목을 수정하시오.");
									return;	
								}
								
								if (addr.value.Trim() == "") {
									show_message("공통거래처 등록화면에서 주소를 수정하시오.");
									return;	
								}
							}
							else {
								if (addr.value.Trim() == "") {
									show_message("공통거래처 등록화면에서 주소를 수정하시오.");
									return;	
								}
							}
						}
						
						if (prof_kind.value.substring(0, 1) != "3") {
							show_message("증빙종류 선택 오류 : 선택가능한 증빙종류는(31 - 39)까지 입니다.");
							return;								
						}
						
						if (getProperty("ss_cmpycd") == "100" || getProperty("ss_cmpycd") == "332"){
							if (budg_cd.value.substring(0, 2) >= "61" && budg_cd.value.substring(0, 2) <= "69") {
								show_message("비용예산코드 불가 : 경리부에 문의 바랍니다.");
								budg_cd.value = "";
								budg_cd_nm.value = "";
								return;
							}
						}
						
						if (budg_cd.value.substring(0, 4) == "4664" || budg_cd.value.substring(0, 4) == "4631" ||
						   budg_cd.value.substring(0, 4) == "4561" || budg_cd.value.substring(0, 4) == "4665" ||
						   budg_cd.value.substring(0, 4) == "4667" || budg_cd.value.substring(0, 4) == "4668" ||
						   budg_cd.value.substring(0, 4) == "2402" || budg_cd.value.substring(0, 4) == "2413" ||
						   budg_cd.value.substring(0, 4) == "2424" || budg_cd.value.substring(0, 4) == "4784") {
						   	// skip
						}
						else {
							if (dlco_clsf_cd.value.substring(0, 2) == "93") {
								if (prof_kind.value != "31" && prof_kind.value != "34" && prof_kind.value != "36" && prof_kind.value != "38" && prof_kind.value != "39") {
									show_message("증빙종류 선택 오류 : 거래처구분(93)이면서 증빙종류(31, 34, 36, 38, 39) 입니다.");
									return;		
								}
							}
							
							if (dlco_clsf_cd.value.substring(0, 2) == "94") {
								if (prof_kind.value != "32" && prof_kind.value != "35" && prof_kind.value != "36" && prof_kind.value != "37"  && prof_kind.value != "38" && prof_kind.value != "39") {
									show_message("증빙종류 선택 오류 : 거래처구분(94)이면서 증빙종류(32, 35, 36, 37, 38, 39) 입니다.");
									return;		
								}
							}
						}
						
						if (Number(vat_amt.value) != 0) {
							if (prof_kind.value != "31" && prof_kind.value != "32" && prof_kind.value != "39") {
								show_message("증빙종류 선택 오류 : 부가세금액이 있으면 증빙종류는(31,32,39)만 선택가능합니다.");
								return;		
							}
						}
						
						//if (budg_cd.value == "803505" ||budg_cd.value == "803529" ||budg_cd.value == "803530" ||budg_cd.value == "803527" ||budg_cd.value == "803531" ||budg_cd.value == "803532" ||budg_cd.value == "803516") {
							if (budg_cd.value == "803505" ||budg_cd.value == "803529" ||budg_cd.value == "803530" ||budg_cd.value == "803527" ||budg_cd.value == "803531" ||budg_cd.value == "803532") {
							if (vexc_cmpy_cd.value == "") {
								show_message("대행사는 필수입력사항입니다.");
								model.setFocus(vexc_cmpy_cd);
								return;		
							}
							else {
								vexc_cmpy_cd.value = "";
								vexc_cmpy_nm.value = "";
								intg_vexc_cmpy_cd.value = "";
							}
						}
						
//						if (rcpm_slip_no.disabled == false) {
						
							// 그리드 부분 저장
							
							var var_grid_sum1 = 0;
							var var_grid_sum2 = 0;
							var var_grid_sum3 = 0;
							
							var var_check_value = false;
							
							for (i=1;i<=datagrid1.rows;i++){
								
								var_check_value = false;
								for (j=1;j<=datagrid1.cols;j++) {
//									alert(datagrid1.valueMatrix(i, j));
//									alert(Number(datagrid1.valueMatrix(i, j).Trim()));
									if (datagrid1.valueMatrix(i, j).Trim() != "" && Number(datagrid1.valueMatrix(i, j).Trim()) != 0) {
//										alert(datagrid1.valueMatrix(i, j));
										var_check_value = true;
									}
								}
								
								if (var_check_value == false) {
									if (datagrid1.rowStatus(i) != 4) { datagrid1.rowStatus(i) = 0; }
								}
								else {
									if (datagrid1.valueMatrix(i, 2) == "" || 
									    Number(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST1/record[" + i + "]/g1_rcpm_amt")) == 0) {
									    	if (datagrid1.rowStatus(i) != 4) { datagrid1.rowStatus(i) = 0; }
									}
									else {
										if (datagrid1.rowStatus(i) != 4) { datagrid1.rowStatus(i) = 1; }
									}
								}
								
								var_grid_sum1 = var_grid_sum1 + Number(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST1/record[" + i + "]/g1_rcpm_amt"));
								var_grid_sum1 = var_grid_sum1 + Number(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST1/record[" + i + "]/g1_coms"));
							}
							
							for (i=1;i<=datagrid2.rows;i++){
								
								var_check_value = false;
								for (j=1;j<=datagrid2.cols;j++) {
									if (datagrid2.valueMatrix(i, j).Trim() != "" && Number(datagrid2.valueMatrix(i, j).Trim()) != 0) {
										var_check_value = true;
									}
								}
								
								if (var_check_value == false) {
									if (datagrid2.rowStatus(i) != 4) { datagrid2.rowStatus(i) = 0; }
								}
								else {
									if (datagrid2.valueMatrix(i, 3) == "" || 
									    Number(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST2/record[" + i + "]/g2_rcpm_amt")) == 0) {
									    	if (datagrid2.rowStatus(i) != 4) { datagrid2.rowStatus(i) = 0; }
									}
									else {
										if (datagrid2.rowStatus(i) != 4) { datagrid2.rowStatus(i) = 1; }
									}
								}
								
								var_grid_sum2 = var_grid_sum2 + Number(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST2/record[" + i + "]/g2_rcpm_amt"));
							}
							
							for (i=1;i<=datagrid3.rows;i++){
								
								var_check_value = false;
								for (j=1;j<=datagrid3.cols;j++) {
									if (datagrid3.valueMatrix(i, j).Trim() != "" && Number(datagrid3.valueMatrix(i, j).Trim()) != 0) {
										var_check_value = true;
									}
								}
								
								if (var_check_value == false) {
									if (datagrid3.rowStatus(i) != 4) { datagrid3.rowStatus(i) = 0; }
								}
								else {
									if (datagrid3.valueMatrix(i, 2) == "" || 
									    Number(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST3/record[" + i + "]/g3_rcpm_amt")) == 0) {
									    	if (datagrid3.rowStatus(i) != 4) { datagrid3.rowStatus(i) = 0; }
									}
									else {
										if (datagrid3.rowStatus(i) != 4) { datagrid3.rowStatus(i) = 1; }
									}
								}
								
								var_grid_sum3 = var_grid_sum3 + Number(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST3/record[" + i + "]/g3_rcpm_amt"));
							}			
							
							if (reg_clsf.value == "3") {
								if (Number(rcpm_amt.value) == 0 && var_grid_sum1 == 0 && var_grid_sum2 == 0 && var_grid_sum3 == 0 ) {
									show_message("등록구분이 세금계산서/입금이면 입금정보는 필수 입력사항입니다.");
									return;
								}
							}
							
							
							// 입금금액이 존재하면 입금표종류, 입금표번호는 필수 입력(현금,받을어음 인 경우만 필수)
							if (Number(rcpm_amt.value) != 0 || var_grid_sum2 != 0) {
								
	//							if (!check_reqItem(rcpm_shet_kind,"trim","focus","입금표종류는 필수입력사항입니다.")) { return; }
								
								if (rcpm_shet_kind.value.Trim() == "") {
									show_message("입금표종류는 필수입력사항입니다.");
									model.setFocus("rcpm_shet_kind");
									return;
								}
								
								if (rcpm_shet_no.value.Trim() == "") {
									show_message("입금표번호는 필수입력사항입니다.");
									model.setFocus("rcpm_shet_no");
									return;
								}
								
							}
							
							
							var var_key = "";
							
//							btn_tab_02.dispatch("onclick");	// tab 초기화
							
							if (var_grid_sum1 != 0) {	// 예금인 경우 필수입력항목 CHECK
								for (i=1;i<=datagrid1.rows;i++){
									var_key = datagrid1.valueMatrix(i, 2);
									if (datagrid1.rowStatus(i) != 0 && var_key != "") {
										if (datagrid1.valueMatrix(i, 2).Trim().ReplaceString("-", "").length!= 8) {
											btn_tab_02.dispatch("onclick");
											show_message("입금일자는 필수입력사항입니다.");
											model.setFocus("datagrid1");
											datagrid1.row= i;	datagrid1.col= 2;	datagrid1.editCell();
											return;
										}
										if (Number(datagrid1.valueMatrix(i, 3)) == 0) {
											btn_tab_02.dispatch("onclick");
											show_message("입금금액은 필수입력사항입니다.");
											model.setFocus("datagrid1");
											datagrid1.row= i;	datagrid1.col= 3;	datagrid1.editCell();
											return;
										}
										if (datagrid1.valueMatrix(i, 4).Trim() == "") {
											btn_tab_02.dispatch("onclick");
											show_message("입금자명은 필수입력사항입니다.");
											model.setFocus("datagrid1");
											datagrid1.row= i;	datagrid1.col= 4;	datagrid1.editCell();
											return;
										}
										if (datagrid1.valueMatrix(i, 5).Trim() == "") {
											btn_tab_02.dispatch("onclick");
											show_message("관리구분은 필수입력사항입니다.");
											model.setFocus("datagrid1");
											datagrid1.row= i;	datagrid1.col= 5;	datagrid1.editCell();
											return;
										}
										//if(datagrid1.valueMatrix(i, 11).Trim() == ""){ //20160808 봉은정추가
										//	btn_tab_02.dispatch("onclick");
										//	show_message("예금입금은 반드시 통장입금내역 팝업을 통해 처리해주세요.");
										//	model.setFocus("datagrid1");
										//	datagrid1.row= i;	datagrid1.col= 1;	datagrid1.editCell();
										//	return;
										//}
										
										// 관리구분이 "3511","3512"이면 외화구분,환율,외화금액 필수입력
										if (datagrid1.valueMatrix(i, 5).Trim().substring(0, 4) == "3511" || datagrid1.valueMatrix(i, 5).Trim().substring(0, 4) == "3512") {
											if (datagrid1.valueMatrix(i, 7).Trim() == "") {
												btn_tab_02.dispatch("onclick");
												show_message("외화구분은 필수입력사항입니다.");
												model.setFocus("datagrid1");
												datagrid1.row= i;	datagrid1.col= 7;	datagrid1.editCell();
												return;
											}
											if (Number(datagrid1.valueMatrix(i, 8)) == 0) {
												btn_tab_02.dispatch("onclick");
												show_message("환율은 필수입력사항입니다.");
												model.setFocus("datagrid1");
												datagrid1.row= i;	datagrid1.col= 8;	datagrid1.editCell();
												return;
											}
											if (Number(datagrid1.valueMatrix(i, 9)) == 0) {
												btn_tab_02.dispatch("onclick");
												show_message("외화금액은 필수입력사항입니다.");
												model.setFocus("datagrid1");
												datagrid1.row= i;	datagrid1.col= 9;	datagrid1.editCell();
												return;
											}
										}
									}
								}
							}
							
							var var_note_clsf_cd = "";	// 어음구분
							var var_comp_dt = "";		// 기산일자
							var var_mtry_dt = "";		// 만기일자
							
//							btn_tab_03.dispatch("onclick");	// tab 초기화
							
							
							if (var_grid_sum2 != 0) {	// 어음인 경우 기산,만기일자 CHECK
								for (i=1;i<=datagrid2.rows;i++){
									var_key = datagrid2.valueMatrix(i, 2);
									var_note_clsf_cd = datagrid2.valueMatrix(i, 4).substring(0, 4);
									if (datagrid2.rowStatus(i) != 0 && (var_key != "" || var_note_clsf_cd == "1061" || var_note_clsf_cd == "1071")) {
										if (var_note_clsf_cd != "1061" && var_note_clsf_cd != "1071") {
											if (datagrid2.valueMatrix(i, 2).Trim().ReplaceString("-", "").length!= 8) {
												btn_tab_03.dispatch("onclick");
												show_message("어음번호[8자리]는 필수입력사항입니다.");
												model.setFocus("datagrid2");
												datagrid2.row= i;	datagrid2.col= 2;	datagrid2.editCell();
												return;
											}										
										}
										if (Number(datagrid2.valueMatrix(i, 3)) == 0) {
											btn_tab_03.dispatch("onclick");
											show_message("입금금액은 필수입력사항입니다.");
											model.setFocus("datagrid2");
											datagrid2.row= i;	datagrid2.col= 3;	datagrid2.editCell();
											return;
										}
										if (datagrid2.valueMatrix(i, 4).Trim() == "") {
											btn_tab_03.dispatch("onclick");
											show_message("어음구분은 필수입력사항입니다.");
											model.setFocus("datagrid2");
											datagrid2.row= i;	datagrid2.col= 4;	datagrid2.editCell();
											return;
										}
										if (datagrid2.valueMatrix(i, 5).Trim() == "") {
											btn_tab_03.dispatch("onclick");
											show_message("금융기관은 필수입력사항입니다.");
											model.setFocus("datagrid2");
											datagrid2.row= i;	datagrid2.col= 5;	datagrid2.editCell();
											return;
										}
										if (datagrid2.valueMatrix(i, 7).Trim() == "") {
											btn_tab_03.dispatch("onclick");
											show_message("발행인은 필수입력사항입니다.");
											model.setFocus("datagrid2");
											datagrid2.row= i;	datagrid2.col= 7;	datagrid2.editCell();
											return;
										}									
										if (datagrid2.valueMatrix(i, 8).Trim() == "") {
											btn_tab_03.dispatch("onclick");
											show_message("발행사코드는 필수입력사항입니다.");
											model.setFocus("datagrid2");
											datagrid2.row= i;	datagrid2.col= 8;	datagrid2.editCell();
											return;
										}
										var_comp_dt = datagrid2.valueMatrix(i, 9).Trim().ReplaceString("-", "");		// 기산일자
										if (var_comp_dt.length!= 8) {
											btn_tab_03.dispatch("onclick");
											show_message("기산일자는 필수입력사항입니다.");
											model.setFocus("datagrid2");
											datagrid2.row= i;	datagrid2.col= 9;	datagrid2.editCell();
											return;
										}
										var_mtry_dt = datagrid2.valueMatrix(i, 10).Trim().ReplaceString("-", "");		// 만기일자
										if (var_mtry_dt.length!= 8) {
											btn_tab_03.dispatch("onclick");
											show_message("만기일자는 필수입력사항입니다.");
											model.setFocus("datagrid2");
											datagrid2.row= i;	datagrid2.col= 10;	datagrid2.editCell();
											return;
										}
										if (var_comp_dt > var_mtry_dt) {
											btn_tab_03.dispatch("onclick");
											show_message("일자 입력 오류입니다.");
											return;
										}
										if (var_note_clsf_cd == "1061" || var_note_clsf_cd == "1071") {
											if (datagrid2.valueMatrix(i, 11).Trim() == "") {
												btn_tab_03.dispatch("onclick");
												show_message("입금계좌는 필수입력사항입니다.");
												model.setFocus("datagrid2");
												datagrid2.row= i;	datagrid2.col= 11;	datagrid2.editCell();
												return;
											}		
											if (datagrid2.valueMatrix(i, 12).Trim() == "") {
												btn_tab_03.dispatch("onclick");
												show_message("매출승인번호는 필수입력사항입니다.");
												model.setFocus("datagrid2");
												datagrid2.row= i;	datagrid2.col= 12;	datagrid2.editCell();
												return;
											}	
										}
									}
								}
							}
							
//							btn_tab_04.dispatch("onclick");	// tab 초기화
													
							if (var_grid_sum3 != 0) {	// 기타계정인 경우 CHECK
								for (i=1;i<=datagrid3.rows;i++){
									var_key = datagrid3.valueMatrix(i, 2);
									if (datagrid3.rowStatus(i) != 0 && var_key != "") {
										if (datagrid3.valueMatrix(i, 2).Trim().length!= 6) {
											btn_tab_04.dispatch("onclick");
											show_message("예산코드는 필수입력사항입니다.");
											model.setFocus("datagrid3");
											datagrid3.row= i;	datagrid3.col= 2;	datagrid3.editCell();
											return;
										}
										if (datagrid3.valueMatrix(i, 2).Trim().substring(0, 4) == "4631" || 
										    datagrid3.valueMatrix(i, 2).Trim().substring(0, 4) == "4664" || 
										    datagrid3.valueMatrix(i, 2).Trim().substring(0, 4) == "4561" || 
										    datagrid3.valueMatrix(i, 2).Trim().substring(0, 4) == "4665" || 
										    datagrid3.valueMatrix(i, 2).Trim().substring(0, 4) == "4667" || 
										    datagrid3.valueMatrix(i, 2).Trim().substring(0, 4) == "4668" ) {	// 예수금계정이면
											if (datagrid3.valueMatrix(i, 5).Trim() == "") {
												btn_tab_04.dispatch("onclick");
												show_message("전사전표구분은 필수입력사항입니다.");
												model.setFocus("datagrid3");
												datagrid3.row= i;	datagrid3.col= 5;	datagrid3.editCell();
												return;
											}
											if (datagrid3.valueMatrix(i, 6).Trim().length < 17) {
												btn_tab_04.dispatch("onclick");
												show_message("전사전표번호[17자리]는 필수입력사항입니다.");
												model.setFocus("datagrid3");
												datagrid3.row= i;	datagrid3.col= 6;	datagrid3.editCell();
												return;
											}
										}
									}
								}
							}
							
						if (show_message("저장하시겠습니까?","저장 확인",MB_YESNO) != IDYES) { return; }

						model.setValue("/root/reqData/multiUpDate/cmpy_cd", model.getValue("/root/initData/session/cmpy_cd"));
						model.setValue("/root/reqData/multiUpDate/mode", "I");
						model.setValue("/root/reqData/multiUpDate/reg_clsf", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/reg_clsf"));
						gvar_reg_clsf = model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/reg_clsf");
						model.setValue("/root/reqData/multiUpDate/prof_type_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/prof_type_cd"));
						model.setValue("/root/reqData/multiUpDate/slip_clsf_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/slip_clsf_cd"));
						model.setValue("/root/reqData/multiUpDate/slip_occr_dt", commCurDate());
						model.setValue("/root/reqData/multiUpDate/slip_seq", "");
						model.setValue("/root/reqData/multiUpDate/make_dt", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/make_dt"));
						model.setValue("/root/reqData/multiUpDate/erplace_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/erplace_cd"));
						var rv_dlco_clsf_cd = model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_clsf_cd");
						rv_dlco_clsf_cd = rv_dlco_clsf_cd.substring(0, 2);
						model.setValue("/root/reqData/multiUpDate/dlco_clsf_cd", rv_dlco_clsf_cd);
						model.setValue("/root/reqData/multiUpDate/dlco_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_cd"));

						if (model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_clsf_cd") == "93") {
							model.setValue("/root/reqData/multiUpDate/deal_clsf", "3");						
							model.setValue("/root/reqData/multiUpDate/presi_nm", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/presi_nm"));
						}
						else if (model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_clsf_cd") == "94") {
							model.setValue("/root/reqData/multiUpDate/deal_clsf", "4");						
							model.setValue("/root/reqData/multiUpDate/presi_nm", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_nm"));
						}
						else {
							model.setValue("/root/reqData/multiUpDate/deal_clsf", "4");						
							model.setValue("/root/reqData/multiUpDate/presi_nm", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/presi_nm"));
						}

						model.setValue("/root/reqData/multiUpDate/unit", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/unit"));
						model.setValue("/root/reqData/multiUpDate/qunt", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/qunt"));
						model.setValue("/root/reqData/multiUpDate/code_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/mang_clsf_cd"));

						model.setValue("/root/reqData/multiUpDate/ern", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/ern"));
						
//						if (model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_clsf_cd") == "" &&
//							model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_cd") == "") {
							model.setValue("/root/reqData/multiUpDate/boks_dlco_nm", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/boks_dlco_nm"));
//						}
//						else {
							model.setValue("/root/reqData/multiUpDate/dlco_nm", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_nm"));
//						}
						
						model.setValue("/root/reqData/multiUpDate/addr", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/addr"));
						model.setValue("/root/reqData/multiUpDate/bizcond", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/bizcond"));
						model.setValue("/root/reqData/multiUpDate/item", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/presi_item"));
						model.setValue("/root/reqData/multiUpDate/evnt_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/evnt_cd"));
						model.setValue("/root/reqData/multiUpDate/suply_amt", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/suply_amt"));
						model.setValue("/root/reqData/multiUpDate/vat_amt", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/vat_amt"));
						model.setValue("/root/reqData/multiUpDate/tax_stmt_aprv_yn", gvar_tax_stmt_aprv_yn);
						model.setValue("/root/reqData/multiUpDate/rcpt_nosh", "0");
						model.setValue("/root/reqData/multiUpDate/sg_budg_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/budg_cd"));
						model.setValue("/root/reqData/multiUpDate/ask_emp_no", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/ask_emp_no"));
						model.setValue("/root/reqData/multiUpDate/ask_dept_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/ask_dept_cd"));
						model.setValue("/root/reqData/multiUpDate/rcpm_plan_dd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/rcpm_plan_dt"));
						model.setValue("/root/reqData/multiUpDate/incmg_pers", model.getValue("/root/initData/session/emp_no"));
						model.setValue("/root/reqData/multiUpDate/incmg_pers_ipadd", "");
						model.setValue("/root/reqData/multiUpDate/sgtitem", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/item"));
						model.setValue("/root/reqData/multiUpDate/medi_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/medi_cd"));
						model.setValue("/root/reqData/multiUpDate/dtls_medi_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dtls_medi_cd"));
						model.setValue("/root/reqData/multiUpDate/vexc_cmpy_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/vexc_cmpy_cd"));
						model.setValue("/root/reqData/multiUpDate/draft_doc_no", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/draft_doc_no"));
						model.setValue("/root/reqData/multiUpDate/draft_impt_amt", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/draft_impt_amt"));
						model.setValue("/root/reqData/multiUpDate/draft_expn_amt", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/draft_expn_amt"));

						model.setValue("/root/reqData/multiUpDate/email", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/email"));
						model.setValue("/root/reqData/multiUpDate/chnl_clsf_cd",chnl_clsf_cd.value);
//						alert(model.getValue("/root/resData/resform/stmt_rmtt_yn"));

//						if (model.getValue("/root/resData/resform/stmt_rmtt_yn") == "Y") {
//							model.setValue("/root/reqData/multiUpDate/in_igyb", "N");
//						}
//						else {
							model.setValue("/root/reqData/multiUpDate/in_igyb", "Y");
//						}
						
						model.setValue("/root/reqData/multiUpDate/slip_rcpm_dt", commCurDate());
						model.setValue("/root/reqData/multiUpDate/rcpm_shet_kind", model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST4/record/rcpm_shet_kind"));
						model.setValue("/root/reqData/multiUpDate/rcpm_shet_no", model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST4/record/rcpm_shet_no"));
//						alert(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST/record/rcpm_amt"));
//						alert(rcpm_amt.value);
						model.setValue("/root/reqData/multiUpDate/g0_rcpm_amt", rcpm_amt.value); // model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST/record/rcpm_amt"));
						model.setValue("/root/reqData/multiUpDate/multiUpdateData1",datagrid1.getUpdateData("insert"));
						model.setValue("/root/reqData/multiUpDate/multiUpdateData2",datagrid2.getUpdateData("insert"));
						model.setValue("/root/reqData/multiUpDate/multiUpdateData3",datagrid3.getUpdateData("insert"));
						
						model.setValue("/root/reqData/multiUpDate/make_upd_dt", "");
						model.setValue("/root/reqData/multiUpDate/upd_tms", "");
						model.setValue("/root/reqData/multiUpDate/last_upd_dd", "");
						
						model.setValue("/root/reqData/multiUpDate/rcpm_slip_no", rcpm_slip_no.value.ReplaceString("-", ""));
						model.setValue("/root/reqData/multiUpDate/exrate_diff_yn", exrate_diff_yn.value);
						model.setValue("/root/reqData/multiUpDate/etc_in_yn", etc_in_yn.value);
						model.setValue("/root/reqData/multiUpDate/stmt_rmtt_yn", stmt_rmtt_yn.value);

						set_refvalue("/root/reqData/multiUpDate/elec_tax_comp_cd",elec_tax_comp_cd.value);							
						set_refvalue("/root/reqData/multiUpDate/semuro_no",elec_tax_no1.value + elec_tax_no2.value + elec_tax_no3.value);

						model.refresh();

    					model.send("fc_acct_2122_i");
    						
						if(submit_completed()){
//    							srch_slip_seq.value = model.getValue("/root/resData/MsgData/dataSet/slip_seq");
							gvar_stmt_slip_no = model.getValue("/root/reqData/multiUpDate/slip_clsf_cd") + model.getValue("/root/reqData/multiUpDate/slip_occr_dt") + model.getValue("/root/resData/MsgData/dataSet/slip_seq");
							tax_stmt_no.value = gvar_stmt_slip_no;
							reg_clsf.value = gvar_reg_clsf;
						       model.alert("저장되었습니다.");
							var var_rcpm_slip_no = model.getValue("/root/resData/MsgData/dataSet/rcpm_slip_no");
							btn_select.dispatch("onclick");
							rcpm_slip_no.value = var_rcpm_slip_no;
							rcpm_slip_no.dispatch("xforms-value-changed");
						}else{
							var ch_var = get_refvalue("/root/resData/MsgData/errData/errmsg").substring(0,1);
							if(ch_var == "Y"){
								model.property("FC_ACCT_2230_popup_clsf")  = "Y";
								model.property("FC_ACCT_2120_popup_impt_dept")  = impt_dept.value;
								if(tax_stmt_no.value != ""){
									model.property("FC_ACCT_2120_popup_slip_occr_dt") = tax_stmt_no.value.substring(2,10);
								}else{
									model.property("FC_ACCT_2120_popup_slip_occr_dt") = commCurDate();
								}
								
								viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2230");
								
								tax_stmt_no.value = model.property("FC_ACCT_2230_stmt_slip_no");
								
								model.property("FC_ACCT_2230_popup_clsf")  = "";
								model.property("FC_ACCT_2230_stmt_slip_no") = "";
								model.property("FC_ACCT_2120_popup_impt_dept")  = "";
								model.property("FC_ACCT_2120_popup_slip_occr_dt") = "";
								
							}
						}
						
					]]>
				</script>
			</button>
			<button id="btn_update" class="btn02" crud="U" style="left:108px; top:0px; width:52px; height:21px; ">
				<caption>수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (reg_clsf.value == "") {
							show_message("등록구분은 필수입력항목입니다.");
							model.setFocus("reg_clsf");
							return;							
						}
						
						if (reg_clsf.value == "1" || reg_clsf.value == "3") {
							if (budg_cd.value == "") {
								show_message("예산코드는 필수입력항목입니다.");
								model.setFocus("budg_cd");
								return;						
							}	
						}
						
						gvar_reg_clsf = reg_clsf.value;
						
						if (prof_kind.value == "") {
							show_message("증빙종류는 필수입력항목입니다.");
							model.setFocus("prof_kind");
							return;							
						}
						
						if (slip_clsf.value == "") {
							show_message("전표구분코드는 필수입력항목입니다.");
							model.setFocus("slip_clsf");
							return;							
						}
						
						if (make_dt.value.length != 8) {
							show_message("작성일자는 필수입력항목입니다.");
							model.setFocus("make_dt");
							return;							
						}
						
						if (impt_dept.value.length != 6) {
							show_message("수입부서는 필수입력항목입니다.");
							model.setFocus("impt_dept");
							return;							
						}
						
						if (impt_emp_no.value.length != 6) {
							show_message("수입사번은 필수입력항목입니다.");
							model.setFocus("impt_emp_no");
							return;							
						}
						
						
						if (medi_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (medi_cd.value == "") {
								show_message("매체코드는 필수입력항목입니다.");
								model.setFocus("medi_cd");
								return;							
							}							
						}

						if (dlco_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (dlco_clsf_cd.value == "") {
								show_message("거래처구분코드는 필수입력항목입니다.");
								model.setFocus("dlco_clsf_cd");
								return;							
							}
						}
						
						if (dlco_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (dlco_cd.value.ReplaceString("-", "") == "") {
								show_message("거래처코드는 필수입력항목입니다.");
								model.setFocus("dlco_cd");
								return;							
							}
						}
						
						if (boks_dlco_nm.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (boks_dlco_nm.value.Trim() == "") {
								show_message("부거래처명은 필수입력항목입니다.");
								model.setFocus("boks_dlco_nm");
								return;							
							}
						}
						
						if (code_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (code_cd.value.Trim() == "") {
								show_message("관리구분은 필수입력항목입니다.");
								model.setFocus("code_cd");
								return;							
							}
						}
						
//						if (unit.attribute("background-color") == DEFAULT_COLOR_REQ) {
//							if (unit.value.Trim() == "") {
//								show_message("단위는 필수입력항목입니다.");
//								model.setFocus("unit");
//								return;							
//							}
//						}

//						if (qunt.attribute("background-color") == DEFAULT_COLOR_REQ) {
//							if (qunt.value.Trim() == "") {
//								show_message("수량은 필수입력항목입니다.");
//								model.setFocus("qunt");
//								return;							
//							}
//						}
						
//						if (medi_cd.value == "110" || medi_cd.value == "210") {
//							if (dtls_medi_cd.value == "") {
//								show_message("매체코드가 110, 210 인 경우에는 상세매체코드는 필수입력사항입니다.");
//								model.setFocus("dtls_medi_cd");
//								return;							
//							}
//						}
						if(get_refvalue("/root/tempData/medi_ch") == "Y") {
							if(dtls_medi_cd.value == ""){
								show_message("상세매체코드는 필수입력항목입니다.");
								return false;
							}
						}
						
						if (erplace_cd.value == "") {
							show_message("사업장코드는 필수입력항목입니다.");
							model.setFocus("erplace_cd");
							return;							
						}
						
						if (prof_kind.value != "33" && prof_kind.value != "36" && prof_kind.value != "37" && prof_kind.value != "38" && prof_kind.value != "39") {
							if (dlco_clsf_cd.value == "") {
								show_message("거래처구분코드는 필수입력항목입니다.");
								model.setFocus("dlco_clsf_cd");
								return;							
							}
							
//							alert(dlco_cd.value.ReplaceString("-", "").length);
							if (dlco_cd.value.ReplaceString("-", "") == "") {
								show_message("거래처코드는 필수입력항목입니다.");
								model.setFocus("dlco_cd");
								return;							
							}
						}
						else {
							if (boks_dlco_nm.value.Trim() == "") {
								show_message("부거래처명은 필수입력항목입니다.");
								model.setFocus("boks_dlco_nm");
								return;							
							}
						}
						
						if (item.attribute("editable") != "false") {
							if (item.value == "") {	
								show_message("품목은 필수입력항목입니다.");
								model.setFocus("item");
								return;							
							}
						}
						
						if (Number(suply_amt.value) == 0) {
							show_message("공급가액은 필수입력항목입니다.");
							model.setFocus("suply_amt");
							return;							
						}
						
						fn_dlco_check();	// 거래처코드의 주소확인
						
						if (prof_kind.value != "36" && prof_kind.value != "37" && prof_kind.value != "38" && prof_kind.value != "39") {
							if (dlco_cd.value.substring(0, 2) == "93") {
								if (presi_nm.value.Trim() == "") {
									show_message("공통거래처 등록화면에서 대표자명를 수정하시오.");
									return;	
								}
								
								if (bizcond.value.Trim() == "") {
									show_message("공통거래처 등록화면에서 업태를 수정하시오.");
									return;	
								}
								
								if (erplace_item.value.Trim() == "") {
									show_message("공통거래처 등록화면에서 종목을 수정하시오.");
									return;	
								}
								
								if (addr.value.Trim() == "") {
									show_message("공통거래처 등록화면에서 주소를 수정하시오.");
									return;	
								}
							}
							else {
								if (addr.value.Trim() == "") {
									show_message("공통거래처 등록화면에서 주소를 수정하시오.");
									return;	
								}
							}
						}
						
						if (prof_kind.value.substring(0, 1) != "3") {
							show_message("증빙종류 선택 오류 : 선택가능한 증빙종류는(31 - 39)까지 입니다.");
							return;								
						}
						
						if (getProperty("ss_cmpycd") == "100" || getProperty("ss_cmpycd") == "332"){
						if (budg_cd.value.substring(0, 2) >= "61" && budg_cd.value.substring(0, 2) <= "69") {
							show_message("비용예산코드 불가 : 경리부에 문의 바랍니다.");
							budg_cd.value = "";
							budg_cd_nm.value = "";
							return;
						}
						}
						
						if (budg_cd.value.substring(0, 4) == "4664" || budg_cd.value.substring(0, 4) == "4631" ||
						   budg_cd.value.substring(0, 4) == "4561" || budg_cd.value.substring(0, 4) == "4665" ||
						   budg_cd.value.substring(0, 4) == "4667" || budg_cd.value.substring(0, 4) == "4668" ||
						   budg_cd.value.substring(0, 4) == "2402" || budg_cd.value.substring(0, 4) == "2413" ||
						   budg_cd.value.substring(0, 4) == "2424") {
						   	// skip
						}
						else {
							if (dlco_clsf_cd.value.substring(0, 2) == "93") {
								if (prof_kind.value != "31" && prof_kind.value != "34" && prof_kind.value != "36" && prof_kind.value != "38" && prof_kind.value != "39") {
									show_message("증빙종류 선택 오류 : 거래처구분(93)이면서 증빙종류(31, 34, 36, 38, 39) 입니다.");
									return;		
								}
							}
							
							if (dlco_clsf_cd.value.substring(0, 2) == "94") {
								if (prof_kind.value != "32" && prof_kind.value != "35" && prof_kind.value != "36" && prof_kind.value != "37" &&  prof_kind.value != "38" && prof_kind.value != "39") {
									show_message("증빙종류 선택 오류 : 거래처구분(94)이면서 증빙종류(32, 35, 36, 37, 38, 39) 입니다.");
									return;		
								}
							}
						}
						
						if (Number(vat_amt.value) != 0) {
							if (prof_kind.value != "31" && prof_kind.value != "32" && prof_kind.value != "39") {
								show_message("증빙종류 선택 오류 : 부가세금액이 있으면 증빙종류는(31,32,39)만 선택가능합니다.");
								return;		
							}
						}
						
						//if (budg_cd.value == "803505" ||budg_cd.value == "803529" ||budg_cd.value == "803530" ||budg_cd.value == "803527" ||budg_cd.value == "803531" ||budg_cd.value == "803532" ||budg_cd.value == "803516") {
							if (budg_cd.value == "803505" ||budg_cd.value == "803529" ||budg_cd.value == "803530" ||budg_cd.value == "803527" ||budg_cd.value == "803531" ||budg_cd.value == "803532") {
							if (vexc_cmpy_cd.value == "") {
								show_message("대행사는 필수입력사항입니다.");
								model.setFocus(vexc_cmpy_cd);
								return;		
							}
							else {
								vexc_cmpy_cd.value = "";
								vexc_cmpy_nm.value = "";
								intg_vexc_cmpy_cd.value = "";
							}
						}
						

						
						
//						if (rcpm_slip_no.disabled == false) {
						
							// 그리드 부분 저장
							
							var var_grid_sum1 = 0;
							var var_grid_sum2 = 0;
							var var_grid_sum3 = 0;
							
							var var_check_value = false;
							
							for (i=1;i<=datagrid1.rows;i++){
								
								var_check_value = false;
								for (j=1;j<=datagrid1.cols;j++) {
//									alert(datagrid1.valueMatrix(i, j));
//									alert(Number(datagrid1.valueMatrix(i, j).Trim()));
									if (datagrid1.valueMatrix(i, j).Trim() != "" && Number(datagrid1.valueMatrix(i, j).Trim()) != 0) {
//										alert(datagrid1.valueMatrix(i, j));
										var_check_value = true;
									}
								}
								
								if (var_check_value == false) {
									if (datagrid1.rowStatus(i) != 4) { datagrid1.rowStatus(i) = 0; }
								}
								else {
									if (datagrid1.valueMatrix(i, 2) == "" || 
									    Number(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST1/record[" + i + "]/g1_rcpm_amt")) == 0) {
									    	if (datagrid1.rowStatus(i) != 4) { datagrid1.rowStatus(i) = 0; }
									}
									else {
										if (datagrid1.rowStatus(i) != 4) { datagrid1.rowStatus(i) = 1; }
									}
								}
								
								var_grid_sum1 = var_grid_sum1 + Number(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST1/record[" + i + "]/g1_rcpm_amt"));
								var_grid_sum1 = var_grid_sum1 + Number(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST1/record[" + i + "]/g1_coms"));
							}
							
							for (i=1;i<=datagrid2.rows;i++){
								
								var_check_value = false;
								for (j=1;j<=datagrid2.cols;j++) {
									if (datagrid2.valueMatrix(i, j).Trim() != "" && Number(datagrid2.valueMatrix(i, j).Trim()) != 0) {
										var_check_value = true;
									}
								}
								
								if (var_check_value == false) {
									if (datagrid2.rowStatus(i) != 4) { datagrid2.rowStatus(i) = 0; }
								}
								else {
									if (datagrid2.valueMatrix(i, 3) == "" || 
									    Number(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST2/record[" + i + "]/g2_rcpm_amt")) == 0) {
									    	if (datagrid2.rowStatus(i) != 4) { datagrid2.rowStatus(i) = 0; }
									}
									else {
										if (datagrid2.rowStatus(i) != 4) { datagrid2.rowStatus(i) = 1; }
									}
								}
								
								var_grid_sum2 = var_grid_sum2 + Number(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST2/record[" + i + "]/g2_rcpm_amt"));
							}
							
							for (i=1;i<=datagrid3.rows;i++){
								
								var_check_value = false;
								for (j=1;j<=datagrid3.cols;j++) {
									if (datagrid3.valueMatrix(i, j).Trim() != "" && Number(datagrid3.valueMatrix(i, j).Trim()) != 0) {
										var_check_value = true;
									}
								}
								
								if (var_check_value == false) {
									if (datagrid3.rowStatus(i) != 4) { datagrid3.rowStatus(i) = 0; }
								}
								else {
									if (datagrid3.valueMatrix(i, 2) == "" || 
									    Number(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST3/record[" + i + "]/g3_rcpm_amt")) == 0) {
									    	if (datagrid3.rowStatus(i) != 4) { datagrid3.rowStatus(i) = 0; }
									}
									else {
										if (datagrid3.rowStatus(i) != 4) { datagrid3.rowStatus(i) = 1; }
									}
								}
								
								var_grid_sum3 = var_grid_sum3 + Number(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST3/record[" + i + "]/g3_rcpm_amt"));
							}			
							

							
							
							// 입금금액이 존재하면 입금표종류, 입금표번호는 필수 입력(현금,받을어음 인 경우만 필수)
							if (Number(rcpm_amt.value) != 0 || var_grid_sum2 != 0) {
								
	//							if (!check_reqItem(rcpm_shet_kind,"trim","focus","입금표종류는 필수입력사항입니다.")) { return; }
								
								if (rcpm_shet_kind.value.Trim() == "") {
									show_message("입금표종류는 필수입력사항입니다.");
									model.setFocus("rcpm_shet_kind");
									return;
								}
								
								if (rcpm_shet_no.value.Trim() == "") {
									show_message("입금표번호는 필수입력사항입니다.");
									model.setFocus("rcpm_shet_no");
									return;
								}
								
							}
							
							
							var var_key = "";
							
//							btn_tab_02.dispatch("onclick");	// tab 초기화
							
							if (var_grid_sum1 != 0) {	// 예금인 경우 필수입력항목 CHECK
								for (i=1;i<=datagrid1.rows;i++){
									var_key = datagrid1.valueMatrix(i, 2);
									if (datagrid1.rowStatus(i) != 0 && var_key != "") {
										if (datagrid1.valueMatrix(i, 2).Trim().ReplaceString("-", "").length!= 8) {
											btn_tab_02.dispatch("onclick");
											show_message("입금일자는 필수입력사항입니다.");
											model.setFocus("datagrid1");
											datagrid1.row= i;	datagrid1.col= 2;	datagrid1.editCell();
											return;
										}
										if (Number(datagrid1.valueMatrix(i, 3)) == 0) {
											btn_tab_02.dispatch("onclick");
											show_message("입금금액은 필수입력사항입니다.");
											model.setFocus("datagrid1");
											datagrid1.row= i;	datagrid1.col= 3;	datagrid1.editCell();
											return;
										}
										if (datagrid1.valueMatrix(i, 4).Trim() == "") {
											btn_tab_02.dispatch("onclick");
											show_message("입금자명은 필수입력사항입니다.");
											model.setFocus("datagrid1");
											datagrid1.row= i;	datagrid1.col= 4;	datagrid1.editCell();
											return;
										}
										if (datagrid1.valueMatrix(i, 5).Trim() == "") {
											btn_tab_02.dispatch("onclick");
											show_message("관리구분은 필수입력사항입니다.");
											model.setFocus("datagrid1");
											datagrid1.row= i;	datagrid1.col= 5;	datagrid1.editCell();
											return;
										}										
										//if(datagrid1.valueMatrix(i, 11).Trim() == ""){ //20160808 봉은정추가
										//	btn_tab_02.dispatch("onclick");
										//	show_message("예금입금은 반드시 통장입금내역 팝업을 통해 처리해주세요.");
										//	model.setFocus("datagrid1");
										//	datagrid1.row= i;	datagrid1.col= 1;	datagrid1.editCell();
										//	return;
										//}
										
										// 관리구분이 "3511","3512"이면 외화구분,환율,외화금액 필수입력
										if (datagrid1.valueMatrix(i, 5).Trim().substring(0, 4) == "3511" || datagrid1.valueMatrix(i, 5).Trim().substring(0, 4) == "3512") {
											if (datagrid1.valueMatrix(i, 7).Trim() == "") {
												btn_tab_02.dispatch("onclick");
												show_message("외화구분은 필수입력사항입니다.");
												model.setFocus("datagrid1");
												datagrid1.row= i;	datagrid1.col= 7;	datagrid1.editCell();
												return;
											}
											if (Number(datagrid1.valueMatrix(i, 8)) == 0) {
												btn_tab_02.dispatch("onclick");
												show_message("환율은 필수입력사항입니다.");
												model.setFocus("datagrid1");
												datagrid1.row= i;	datagrid1.col= 8;	datagrid1.editCell();
												return;
											}
											if (Number(datagrid1.valueMatrix(i, 9)) == 0) {
												btn_tab_02.dispatch("onclick");
												show_message("외화금액은 필수입력사항입니다.");
												model.setFocus("datagrid1");
												datagrid1.row= i;	datagrid1.col= 9;	datagrid1.editCell();
												return;
											}
										}
									}
								}
							}
							
							var var_note_clsf_cd = "";	// 어음구분
							var var_comp_dt = "";		// 기산일자
							var var_mtry_dt = "";		// 만기일자
							
//							btn_tab_03.dispatch("onclick");	// tab 초기화
							
							
							if (var_grid_sum2 != 0) {	// 어음인 경우 기산,만기일자 CHECK
								for (i=1;i<=datagrid2.rows;i++){
									var_key = datagrid2.valueMatrix(i, 2);
									var_note_clsf_cd = datagrid2.valueMatrix(i, 4).substring(0, 4);
									var_comp_dt = datagrid2.valueMatrix(i, 9).Trim().ReplaceString("-", "");		// 기산일자
									var_mtry_dt = datagrid2.valueMatrix(i, 10).Trim().ReplaceString("-", "");		// 만기일자
																												
									if (datagrid2.rowStatus(i) != 0 && (var_key != "" || var_note_clsf_cd == "1061" || var_note_clsf_cd == "1071")) {
										if (var_note_clsf_cd != "1061" && var_note_clsf_cd != "1071") {
											if (datagrid2.valueMatrix(i, 2).Trim().ReplaceString("-", "").length!= 8) {
												btn_tab_03.dispatch("onclick");
												show_message("어음번호[8자리]는 필수입력사항입니다.");
												model.setFocus("datagrid2");
												datagrid2.row= i;	datagrid2.col= 2;	datagrid2.editCell();
												return;
											}										
										}
										if (Number(datagrid2.valueMatrix(i, 3)) == 0) {
											btn_tab_03.dispatch("onclick");
											show_message("입금금액은 필수입력사항입니다.");
											model.setFocus("datagrid2");
											datagrid2.row= i;	datagrid2.col= 3;	datagrid2.editCell();
											return;
										}
										if (datagrid2.valueMatrix(i, 4).Trim() == "") {
											btn_tab_03.dispatch("onclick");
											show_message("어음구분은 필수입력사항입니다.");
											model.setFocus("datagrid2");
											datagrid2.row= i;	datagrid2.col= 4;	datagrid2.editCell();
											return;
										}
										if (datagrid2.valueMatrix(i, 5).Trim() == "") {
											btn_tab_03.dispatch("onclick");
											show_message("금융기관은 필수입력사항입니다.");
											model.setFocus("datagrid2");
											datagrid2.row= i;	datagrid2.col= 5;	datagrid2.editCell();
											return;
										}
										if (datagrid2.valueMatrix(i, 7).Trim() == "") {
											btn_tab_03.dispatch("onclick");
											show_message("발행인은 필수입력사항입니다.");
											model.setFocus("datagrid2");
											datagrid2.row= i;	datagrid2.col= 7;	datagrid2.editCell();
											return;
										}									
										if (datagrid2.valueMatrix(i, 8).Trim() == "") {
											btn_tab_03.dispatch("onclick");
											show_message("발행사코드는 필수입력사항입니다.");
											model.setFocus("datagrid2");
											datagrid2.row= i;	datagrid2.col= 8;	datagrid2.editCell();
											return;
										}

										if (var_comp_dt.length!= 8) {
											btn_tab_03.dispatch("onclick");
											show_message("기산일자는 필수입력사항입니다.");
											model.setFocus("datagrid2");
											datagrid2.row= i;	datagrid2.col= 9;	datagrid2.editCell();
											return;
										}

										if (var_mtry_dt.length!= 8) {
											btn_tab_03.dispatch("onclick");
											show_message("만기일자는 필수입력사항입니다.");
											model.setFocus("datagrid2");
											datagrid2.row= i;	datagrid2.col= 10;	datagrid2.editCell();
											return;
										}
										if (var_comp_dt > var_mtry_dt) {
											btn_tab_03.dispatch("onclick");
											show_message("일자 입력 오류입니다.");
											return;
										}
										if (var_note_clsf_cd == "1061" || var_note_clsf_cd == "1071") {
											if (datagrid2.valueMatrix(i, 11).Trim() == "") {
												btn_tab_03.dispatch("onclick");
												show_message("입금계좌는 필수입력사항입니다.");
												model.setFocus("datagrid2");
												datagrid2.row= i;	datagrid2.col= 11;	datagrid2.editCell();
												return;
											}		
											if (datagrid2.valueMatrix(i, 12).Trim() == "") {
												btn_tab_03.dispatch("onclick");
												show_message("매출승인번호는 필수입력사항입니다.");
												model.setFocus("datagrid2");
												datagrid2.row= i;	datagrid2.col= 12;	datagrid2.editCell();
												return;
											}	
										}
									}
								}
							}
							
//							btn_tab_04.dispatch("onclick");	// tab 초기화
													
							if (var_grid_sum3 != 0) {	// 기타계정인 경우 CHECK
								for (i=1;i<=datagrid3.rows;i++){
									var_key = datagrid3.valueMatrix(i, 2);
									if (datagrid3.rowStatus(i) != 0 && var_key != "") {
										if (datagrid3.valueMatrix(i, 2).Trim().length!= 6) {
											btn_tab_04.dispatch("onclick");
											show_message("예산코드는 필수입력사항입니다.");
											model.setFocus("datagrid3");
											datagrid3.row= i;	datagrid3.col= 2;	datagrid3.editCell();
											return;
										}
										if (datagrid3.valueMatrix(i, 2).Trim().substring(0, 4) == "4631" || 
										    datagrid3.valueMatrix(i, 2).Trim().substring(0, 4) == "4664" || 
										    datagrid3.valueMatrix(i, 2).Trim().substring(0, 4) == "4561" || 
										    datagrid3.valueMatrix(i, 2).Trim().substring(0, 4) == "4665" || 
										    datagrid3.valueMatrix(i, 2).Trim().substring(0, 4) == "4667" || 
										    datagrid3.valueMatrix(i, 2).Trim().substring(0, 4) == "4668" ) {	// 예수금계정이면
											if (datagrid3.valueMatrix(i, 5).Trim() == "") {
												btn_tab_04.dispatch("onclick");
												show_message("전사전표구분은 필수입력사항입니다.");
												model.setFocus("datagrid3");
												datagrid3.row= i;	datagrid3.col= 5;	datagrid3.editCell();
												return;
											}
											if (datagrid3.valueMatrix(i, 6).Trim().length < 17) {
												btn_tab_04.dispatch("onclick");
												show_message("전사전표번호[17자리]는 필수입력사항입니다.");
												model.setFocus("datagrid3");
												datagrid3.row= i;	datagrid3.col= 6;	datagrid3.editCell();
												return;
											}
										}
									}
								}
							}
							
						if (reg_clsf.value == "1") {
							if (stmt_slip_no.value != "") {
								show_message("계산서전표가 발행된 자료는 수정할 수 없습니다.");
								return;	
							}
						}
						else if (reg_clsf.value == "2") {
							if (rcpm_slip_no.value != "") {
//								alert(rcpm_slip_no2.value);
								if (rcpm_slip_no2.value != "") {
									show_message("입금전표가 발행된 자료는 수정할 수 없습니다.");
									return;	
								}
							}
							else {
								if (var_grid_sum1 == 0 && var_grid_sum2 == 0 && var_grid_sum3 == 0 && Number(rcpm_amt.value) == 0 ) {
									if (stmt_slip_no.value != "") {
										show_message("계산서전표가 발행된 자료는 수정할 수 없습니다.");
										return;	
									}
								}
							}
						}
						else if (reg_clsf.value == "3") {
							if (rcpm_slip_no.value != "") {
								if (rcpm_slip_no2.value != "") {
									show_message("입금전표가 발행된 자료는 수정할 수 없습니다.");
									return;	
								}
							}
							else {
								if (var_grid_sum1 == 0 && var_grid_sum2 == 0 && var_grid_sum3 == 0) {
									if (stmt_slip_no.value != "") {
										show_message("계산서전표가 발행된 자료는 수정할 수 없습니다.");
										return;	
									}
								}
							}
						}
						
						if (gvar_delete_check == "false") {
							if (show_message("수정하시겠습니까?","수정 확인",MB_YESNO) != IDYES) { return; }
						}

						model.setValue("/root/reqData/multiUpDate/cmpy_cd", model.getValue("/root/initData/session/cmpy_cd"));
						model.setValue("/root/reqData/multiUpDate/mode", "U");
						model.setValue("/root/reqData/multiUpDate/reg_clsf", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/reg_clsf"));
						gvar_reg_clsf = model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/reg_clsf");
						model.setValue("/root/reqData/multiUpDate/prof_type_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/prof_type_cd"));
						model.setValue("/root/reqData/multiUpDate/slip_clsf_cd", tax_stmt_no.value.substring(0, 2));
						model.setValue("/root/reqData/multiUpDate/slip_occr_dt", tax_stmt_no.value.substring(2, 10));
						model.setValue("/root/reqData/multiUpDate/slip_seq", tax_stmt_no.value.substring(10, 14));
						model.setValue("/root/reqData/multiUpDate/make_dt", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/make_dt"));
						model.setValue("/root/reqData/multiUpDate/erplace_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/erplace_cd"));
						model.setValue("/root/reqData/multiUpDate/dlco_clsf_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_clsf_cd"));
						model.setValue("/root/reqData/multiUpDate/dlco_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_cd"));

						if (model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_clsf_cd") == "93") {
							model.setValue("/root/reqData/multiUpDate/deal_clsf", "3");						
							model.setValue("/root/reqData/multiUpDate/presi_nm", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/presi_nm"));
						}
						else if (model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_clsf_cd") == "94") {
							model.setValue("/root/reqData/multiUpDate/deal_clsf", "4");						
							model.setValue("/root/reqData/multiUpDate/presi_nm", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_nm"));
						}
						else {
							model.setValue("/root/reqData/multiUpDate/deal_clsf", "4");						
							model.setValue("/root/reqData/multiUpDate/presi_nm", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/presi_nm"));
						}

						model.setValue("/root/reqData/multiUpDate/unit", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/unit"));
						model.setValue("/root/reqData/multiUpDate/qunt", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/qunt"));
						model.setValue("/root/reqData/multiUpDate/code_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/mang_clsf_cd"));

						model.setValue("/root/reqData/multiUpDate/ern", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/ern"));
						
//						if (model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_clsf_cd") == "" &&
//							model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_cd") == "") {
//							model.setValue("/root/reqData/multiUpDate/dlco_nm", model.getValue("/root/resData/resform/boks_dlco_nm"));
							model.setValue("/root/reqData/multiUpDate/boks_dlco_nm", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/boks_dlco_nm"));
//						}
//						else {
							model.setValue("/root/reqData/multiUpDate/dlco_nm", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dlco_nm"));
//						}
						
						model.setValue("/root/reqData/multiUpDate/addr", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/addr"));
						model.setValue("/root/reqData/multiUpDate/bizcond", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/bizcond"));
						model.setValue("/root/reqData/multiUpDate/item", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/presi_item"));
						model.setValue("/root/reqData/multiUpDate/evnt_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/evnt_cd"));
						model.setValue("/root/reqData/multiUpDate/suply_amt", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/suply_amt"));
						model.setValue("/root/reqData/multiUpDate/vat_amt", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/vat_amt"));
						model.setValue("/root/reqData/multiUpDate/tax_stmt_aprv_yn", gvar_tax_stmt_aprv_yn);
						model.setValue("/root/reqData/multiUpDate/rcpt_nosh", "0");
						model.setValue("/root/reqData/multiUpDate/sg_budg_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/budg_cd"));
						model.setValue("/root/reqData/multiUpDate/ask_emp_no", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/ask_emp_no"));
						model.setValue("/root/reqData/multiUpDate/ask_dept_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/ask_dept_cd"));
						model.setValue("/root/reqData/multiUpDate/rcpm_plan_dd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/rcpm_plan_dt"));
						model.setValue("/root/reqData/multiUpDate/incmg_pers", model.getValue("/root/initData/session/emp_no"));
						model.setValue("/root/reqData/multiUpDate/incmg_pers_ipadd", "");
						model.setValue("/root/reqData/multiUpDate/sgtitem", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/item"));
						model.setValue("/root/reqData/multiUpDate/medi_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/medi_cd"));
						model.setValue("/root/reqData/multiUpDate/dtls_medi_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/dtls_medi_cd"));
						model.setValue("/root/reqData/multiUpDate/vexc_cmpy_cd", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/vexc_cmpy_cd"));
						model.setValue("/root/reqData/multiUpDate/draft_doc_no", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/draft_doc_no"));
						model.setValue("/root/reqData/multiUpDate/draft_impt_amt", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/draft_impt_amt"));
						model.setValue("/root/reqData/multiUpDate/draft_expn_amt", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/draft_expn_amt"));
						model.setValue("/root/reqData/multiUpDate/email", model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/email"));
						model.setValue("/root/reqData/multiUpDate/chnl_clsf_cd",chnl_clsf_cd.value);
		
//						alert(model.getValue("/root/resData/resform/stmt_rmtt_yn"));

//						alert(model.getValue("/root/resData/resform/stmt_rmtt_yn"));

//						if (model.getValue("/root/resData/resform/stmt_rmtt_yn") == "Y") {
//							model.setValue("/root/reqData/multiUpDate/in_igyb", "N");
//						}
//						else {
						if (Number(rcpm_amt.value) + var_grid_sum1 + var_grid_sum2 + var_grid_sum3 != 0 ) {
							model.setValue("/root/reqData/multiUpDate/in_igyb", "Y");
						}
						else {
							model.setValue("/root/reqData/multiUpDate/in_igyb", "N");
						}
//						}
						
						model.setValue("/root/reqData/multiUpDate/slip_rcpm_dt", commCurDate());
						model.setValue("/root/reqData/multiUpDate/rcpm_shet_kind", model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST4/record/rcpm_shet_kind"));
						model.setValue("/root/reqData/multiUpDate/rcpm_shet_no", model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST4/record/rcpm_shet_no"));
//						alert(model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST/record/rcpm_amt"));
//						alert(rcpm_amt.value);
						model.setValue("/root/reqData/multiUpDate/g0_rcpm_amt", rcpm_amt.value); // model.getValue("/root/resData/gridData/gridData2/dataSet/CURLIST/record/rcpm_amt"));
						model.setValue("/root/reqData/multiUpDate/multiUpdateData1",datagrid1.getUpdateData("insert"));
						model.setValue("/root/reqData/multiUpDate/multiUpdateData2",datagrid2.getUpdateData("insert"));
						model.setValue("/root/reqData/multiUpDate/multiUpdateData3",datagrid3.getUpdateData("insert"));
						
						model.setValue("/root/reqData/multiUpDate/make_upd_dt", commCurDate());
						model.setValue("/root/reqData/multiUpDate/upd_tms", Number(model.getValue("/root/resData/gridData/gridData1/dataSet/CURLIST/record/upd_tms")) + 1);
						model.setValue("/root/reqData/multiUpDate/last_upd_dd", commCurDate());
						
						model.setValue("/root/reqData/multiUpDate/rcpm_slip_no", rcpm_slip_no.value.ReplaceString("-", ""));
						model.setValue("/root/reqData/multiUpDate/exrate_diff_yn", exrate_diff_yn.value);
						model.setValue("/root/reqData/multiUpDate/etc_in_yn", etc_in_yn.value);
						model.setValue("/root/reqData/multiUpDate/stmt_rmtt_yn", stmt_rmtt_yn.value);
						
						set_refvalue("/root/reqData/multiUpDate/elec_tax_comp_cd",elec_tax_comp_cd.value);							
						set_refvalue("/root/reqData/multiUpDate/semuro_no",elec_tax_no1.value + elec_tax_no2.value + elec_tax_no3.value);
						
						model.refresh();

    					model.send("fc_acct_2122_i");
    						
						if(submit_completed()){
							reg_clsf.value = gvar_reg_clsf;
						       if (gvar_delete_check == "true") {
								model.alert("선택한 입금내역이 삭제되었습니다.");						       
						       }
						       else {
							       	model.alert("수정되었습니다.");
						       }
//							alert(model.getValue("/root/resData/MsgData/dataSet/rcpm_slip_no"));
							var var_rcpm_slip_no = model.getValue("/root/resData/MsgData/dataSet/rcpm_slip_no");
							btn_select.dispatch("onclick");
							rcpm_slip_no.value = var_rcpm_slip_no;
							rcpm_slip_no.dispatch("xforms-value-changed");
						}
						
					]]>
				</script>
			</button>
			<button id="btn_delete" class="btn02" crud="D" style="left:162px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						
						model.setValue("/root/reqData/reqform/cmpy_cd", getProperty("ss_cmpycd"));		// 회사코드
						model.setValue("/root/reqData/reqform/prof_type_cd", prof_kind.value);	// 증빙종류
						model.setValue("/root/reqData/reqform/slip_clsf_cd", slip_clsf.value);	// 전표구분
						model.setValue("/root/reqData/reqform/slip_occr_dt", tax_stmt_no.value.Trim().ReplaceString("-", "").substring(2, 10));	// 세금계산서번호 (발생일자)
						model.setValue("/root/reqData/reqform/slip_seq", tax_stmt_no.value.Trim().ReplaceString("-", "").substring(10, 14));		// 세금계산서번호 (일련번호)
						model.setValue("/root/reqData/reqform/in_igyb", "Y");	// 전표구분

						
						model.setValue("/root/reqData/reqform/incmg_pers", getProperty("ss_emp_no"));	// 변경자
						
						// 필수 입력항목 Check
						if (tax_stmt_no.value.Trim().ReplaceString("-", "").length != 14) {
							show_message("세금계산서번호는 필수입력사항입니다.");
							model.setFocus("tax_stmt_no");
							return;
						}
						
						// 전표발생일자가 존재하면서 입금일자가 없으면 삭제불가(미수금건)
						// 전표발생일자가 존재하면 삭제불가
//						if (stmt_slip_no.value.Trim() != "" && gvar_rcpm_slip_no_cnt != 0) {
//							show_message("이미 등록된 전표이므로 삭제불가.");
//							return;
//						}

						if (reg_clsf.value == "1") {
							if (stmt_slip_no.value != "") {
								show_message("계산서전표가 발행된 자료는 삭제할 수 없습니다.");
								return;	
							}
						}
//						else if (reg_clsf.value == "2") {
//							show_message("등록구분이 입력으로 선택된 상태에서는 삭제할 수 없습니다.");
//							return;	
//						}
						else if (reg_clsf.value == "2" || reg_clsf.value == "3") {
							if (rcpm_slip_no.value != "") {
								if (rcpm_slip_no2.value != "") {
									show_message("입금전표가 발행된 자료는 삭제할 수 없습니다.");
									return;	
								}
							}
							else {
								if (stmt_slip_no.value != "") {
									show_message("계산서전표가 발행된 자료는 삭제할 수 없습니다.");
									return;	
								}
							}
						}
						
						if (show_message("삭제하시겠습니까?","삭제 확인",MB_YESNO) != IDYES) { return; }
						
						if (rcpm_slip_no.value == "" || tax_stmt_no.value.Trim().ReplaceString("-", "").substring(2, 10) == rcpm_slip_no.value.substring(0, 8)) {
							model.send("fc_acct_2124_d");

							if(submit_completed()){
							       model.alert("삭제되었습니다.");
								model.reset();	// 삭제 후 초기화
							}
						}
						else {
							btnClear.dispatch("onclick");
							gvar_delete_check = "true";
							btn_update.dispatch("onclick");
							gvar_delete_check = "false";
						}



					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" style="left:216px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						draft_expn_amt.attribute("editable") = "true";
						draft_impt_amt.attribute("editable") = "true";
						control_unmark_req(draft_expn_amt);
						control_unmark_req(draft_expn_amt);	
						
						model.reset();				// 초기화
						btn_tab_01.dispatch("onclick");	// tab 초기화

						dlco_clsf_cd.disabled = false;
						dlco_cd.attribute("editable") = "true";
						dlco_cd.attribute("background-color") = DEFAULT_COLOR_NONEREQ;							
//						dlco_cd.attribute("editable") = "true";
//						dlco_cd.attribute("background-color") = "white";
						ern.attribute("editable") = "true";
						ern.attribute("background-color") = "white";
						erplace_cd.disabled = false;
						item.attribute("editable") = "true";
						item.attribute("background-color") = DEFAULT_COLOR_REQ;
						suply_amt.attribute("editable") = "true";
						suply_amt.attribute("background-color") = "white";
						vat_amt.attribute("editable") = "true";
						vat_amt.attribute("background-color") = "white";
//						prof_kind.disabled = false;
						boks_dlco_nm.attribute("editable") = "true";
						boks_dlco_nm.attribute("background-color") = "white";

						btn_update.disabled = true;
						btn_delete.disabled = true;
						btn_insert.disabled = false;
						
						gvar_reg_clsf = "";
						
						gvar_rcpm_slip_no_cnt = 0;
						
						impt_dept.attribute("editable") = "true";
						impt_emp_no.attribute("editable") = "true";
						
						budg_cd.dispatch("xforms-value-changed");
					]]>
				</script>
			</button>
			<button id="btn_print" class="btn02" crud="P" style="left:270px; top:0px; width:52px; height:21px; ">
				<caption>세금발행</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						
					      model.property("FC_ACCT_2180_srch_prof_type_cd")  = prof_kind.value;
					      model.property("FC_ACCT_2180_srch_slip_occr_dt")  = tax_stmt_no.value.substring(2,10);
					      model.property("FC_ACCT_2180_srch_slip_clsf_cd")  = tax_stmt_no.value.substring(0,2);
					      model.property("FC_ACCT_2180_srch_slip_seq_fr")  = tax_stmt_no.value.substring(10,14);
					      model.property("FC_ACCT_2180_srch_slip_seq_to")  =  tax_stmt_no.value.substring(10,14);
					      model.property("FC_ACCT_2180_popup_flag")  = "Y";
						
						// 화면호출
//						viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2180", "modal", "align:center; caption:hidden; width:650px; height:480px;");
//						viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2180");
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2180");
//						viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2180");
					]]>
				</script>
			</button>
			<button id="btn_rcpm_ptcr" class="btn02" crud="R" style="left:324px; top:0px; width:51px; height:21px; ">
				<caption>입금내역</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
//						viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2210", "modal", "align:center; caption:hidden; width:956px; height:765px;");	
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2210");	
					]]>
				</script>
			</button>
			<button id="btn_draft_doc_open" class="btn04" crud="R" style="left:377px; top:0px; width:89px; height:21px; ">
				<caption>기안문서조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (draft_doc_no.value.Trim() != "") {
							htmlwindow.open(XFORMS_EP_WEB_ADDRESS + "/nanum/flow/ihtml/sanc/xfopendoc_chosun.jsp?dept_id=" + model.getValue("/root/resData/resform/draft_dept_cd") + "&doc_num="+draft_doc_no.value,"draft_doc","height=768,width=1024,scrollbars=no,resizable=no");
						}
						else {
							model.alert("기안문서번호는 필수입력사항입니다.");				
							return;
						}
					]]>
				</script>
			</button>
			<button id="btn_draft_bal_open" class="btn04" crud="R" style="left:468px; top:0px; width:89px; height:21px; ">
				<caption>기안잔액조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (draft_doc_no.value.Trim() != "") {
							model.property("FC_ACCT_2100_draft_doc_no")  = draft_doc_no.value;
							viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2100");
						}	
						else {
							show_message("기안문서번호는 필수입력사항입니다.");				
							return;
						}
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:612px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose();		
					]]>
				</script>
			</button>
			<button id="button1" class="btn02" style="left:558px; top:0px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){
						grid = datagrid1;
					}
					if(_oth_clsf == "2"){
						grid = datagrid2;
					}
					if(_oth_clsf == "3"){
						grid = datagrid3;
					}

					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
					]]>
				</script>
			</button>
		</group>
		<caption id="caption66" class="list_cap03" style="left:454px; top:353px; width:60px; height:26px; text-align:center; ">ASP업체</caption>
		<caption id="caption68" class="list_cap03" style="left:620px; top:353px; width:85px; height:26px; text-align:center; ">전자승인번호</caption>
		<select1 id="elec_tax_comp_cd" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/elec_tax_comp_cd" class="req" navindex="18" appearance="minimal" editmode="inputsearch" itemcount="10" caption="거래처구분" style="left:520px; top:357px; width:95px; height:18px; background-color:transparent; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/fc_acct_2120_m/dataSet/ELEC_TAX_COMP_CD/record">
					<label ref="cdabrvnm_cd"/>
					<value ref="cd"/>
				</itemset>
			</choices>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
						if(combo_data_contains(dlco_clsf_cd, dlco_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(dlco_clsf_cd,"");
							return;
						}
					]]>
			</script>
		</select1>
		<input id="elec_tax_no1" ref="/root/tempData/elec_tax_no1" navindex="32" maxlength="8" style="left:711px; top:357px; width:68px; height:18px; text-align:right; "/>
		<input id="elec_tax_no2" ref="/root/tempData/elec_tax_no2" navindex="32" maxlength="8" style="left:785px; top:357px; width:68px; height:18px; text-align:right; "/>
		<input id="elec_tax_no3" ref="/root/tempData/elec_tax_no3" navindex="32" maxlength="8" style="left:859px; top:357px; width:68px; height:18px; text-align:right; "/>
		<line id="line1" style="x1:475px; y1:379px; x2:475px; y2:388px; font-weight:bold; "/>
		<caption id="caption32" style="left:561px; top:379px; width:263px; height:15px; ">세금계산서가 이미 발행된 경우에만 입력하세요</caption>
		<line id="line3" style="x1:895px; y1:379px; x2:895px; y2:388px; font-weight:bold; "/>
		<line id="line2" style="x1:841px; y1:388px; x2:896px; y2:388px; "/>
		<line id="line4" style="x1:475px; y1:388px; x2:530px; y2:388px; "/>
		<select1 id="chnl_clsf_cd" ref="/root/resData/gridData/gridData1/dataSet/CURLIST/record/chnl_clsf_cd" class="req" appearance="minimal" style="left:337px; top:101px; width:104px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/fc_acct_2120_m/dataSet/CHNL_CLSF_CD_CURLIST/record">
					<label ref="cdabrvnm_cd"/>
					<value ref="cd"/>
				</itemset>
			</choices>
		</select1>
	</xhtml:body>
</xhtml:html>
