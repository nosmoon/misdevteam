<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>예산부서별보조부조회(FC_ACCT_2490)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session/>
						<comboSet>
							<dataSet>
								<MEDI_CD>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</MEDI_CD>
								<DLCO_CLSF_CD>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</DLCO_CLSF_CD>
								<SLIP_CLSF_CD>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</SLIP_CLSF_CD>
								<MANG_CLSF_CD>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</MANG_CLSF_CD>
								<DEPT_BUDG_CD>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</DEPT_BUDG_CD>
								<DEPT_CD>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</DEPT_CD>
								<xx_srch_dlco_clsf_cd/>
								<xx_g_tag/>
							</dataSet>
						</comboSet>
						<pageInfo/>
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<!-- 검색조건 처리 -->
						<!-- formData 팝업,화면전환시 data이동시 -->
						<!-- MultiUpDate유형 사용시 처리 -->
						<fwdData>
							<emp_no/>
							<deptcd/>
						</fwdData>
						<searchData>
							<cmpy_cd/>
							<clam_dept_cd/>
							<clam_dept_nm/>
							<frbudg_cd/>
							<tobudg_cd/>
							<frfisc_dt/>
							<tofisc_dt/>
							<dlco_clsf_cd/>
							<dlco_cd/>
							<dlco_cd_nm/>
							<medi_cd/>
							<mang_clsf_cd/>
							<evnt_cd/>
							<evnt_cd_nm/>
							<clam_dept_cd1/>
							<clam_dept_cd_nm/>
							<slip_clsf_cd/>
							<dr_amt/>
							<crdt_amt/>
							<incmg_emp_no/>
							<incmg_emp_nm/>
							<drcr_clsf/>
							<drcr_clsf1/>
							<drcr_clsf2/>
							<cd/>
							<cdnm/>
							<use_dept_cd/>
							<use_dept_cd_nm/>
							<ss_emp_no/>
							<job_clsf/>
							<dept_cd/>
						</searchData>
						<reqForm>
						</reqForm>
						<multiUpdateData>
						</multiUpdateData>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<fc_acct_2492_s>
								<dataSet>
									<CURLIST>
										<record>
											<cd_nm/>
											<cd/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_2492_s>
							<dataSet>
								<CURLIST>
									<record>
										<cdnm/>
									</record>
								</CURLIST>
							</dataSet>
							<tot_dr_amt/>
							<tot_crdt_amt/>
							<frobj_dt/>
							<toobj_dt/>
							<emp_no/>
							<deptcd/>
						</resForm>
						<gridData>
							<fc_acct_2491_l>
								<dataSet>
									<CURLIST>
										<record>
											<budg_cd/>
											<budg_cd_nm/>
											<fisc_dt/>
											<slip_no/>
											<rmks/>
											<dr_amt/>
											<crdt_amt/>
											<mang_clsf_cd/>
											<mang_no/>
											<dlco_clsf_cd/>
											<dlco_cd/>
											<dlco_cd_nm/>
											<boks_dlco_cd_nm/>
											<medi_cd/>
											<dtls_medi_cd/>
											<prop_equip_cd/>
											<use_dept_cd/>
											<evnt_cd/>
											<dlco_clsf_cd_nm/>
											<obj_amt/>
											<clam_dept_cd/>
											<obj_acct_cd/>
											<incm_clsf_cd_nm/>
											<chnl_clsf_cd/>
										</record>
									</CURLIST>
									<errcode/>
									<errmsg/>
								</dataSet>
							</fc_acct_2491_l>
						</gridData>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<msg/>
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<keyData/>
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<fc_co_1101_l>
							<dataSet>
								<CURLIST1>
									<record>
										<cmpy_cd/>
										<dept_cd/>
										<dept_team_clsf/>
										<abrv_nm/>
										<offi_nm/>
										<dept_team_nm/>
										<part_nm/>
										<part_dn_nm/>
									</record>
								</CURLIST1>
							</dataSet>
						</fc_co_1101_l>
					</tempData>
				</root>
			</instance>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<script type="javascript" src="/js/fcmc_common.js"/>
			<submission id="fc_acct_2490_m" action="/fc/acct2000/2490" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/initData/comboSet/dataSet"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[

					ss_emp_no = getProperty("ss_emp_no");
					ss_emp_nm = getProperty("ss_emp_nm");
					ss_deptcd = getProperty("ss_deptcd");
					ss_deptnm = getProperty("ss_deptnm");					

					set_refvalue("/root/resData/resForm/emp_no", ss_emp_no + "    " + ss_emp_nm);
					set_refvalue("/root/resData/resForm/deptcd", ss_deptcd + "    " + ss_deptnm);
					emp_no.refresh();
					deptcd.refresh();

					set_refvalue("/root/reqData/searchData/ss_emp_no",ss_emp_no);
					//set_refvalue("/root/reqData/searchData/job_clsf","01");			//회계("01"),예산("02")
					
					set_refvalue("/root/reqData/searchData/dept_cd",ss_deptcd);
										
					model.send("fc_acct_2490_m");
					makeComboGubun("","/root/initData/comboSet/dataSet/MEDI_CD","record","cd_nm", "cd");
					makeComboGubun("","/root/initData/comboSet/dataSet/DLCO_CLSF_CD","record","cd_nm", "cd");
					makeComboGubun("","/root/initData/comboSet/dataSet/SLIP_CLSF_CD","record","cd_nm", "cd");
					makeComboGubun("","/root/initData/comboSet/dataSet/MANG_CLSF_CD","record","cd_nm", "cd");
					makeComboGubun("","/root/initData/comboSet/dataSet/DEPT_BUDG_CD","record","cd_nm", "cd");
					makeComboGubun("","/root/initData/comboSet/dataSet/DEPT_CD","record","cd_nm", "cd");

					model.setValue("/root/reqData/searchData/drcr_clsf","1 9");
					srch_drcr_clsf.refresh();					
					
					model.refresh();
				]]>
			</script>
			<submission id="fc_acct_2491_l" action="/fc/acct2000/2491" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/fc_acct_2491_l/dataSet"/>
			<submission id="fc_acct_2492_s" action="/fc/acct2000/2492" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm/fc_acct_2492_s/dataSet"/>
			<submission id="mc_co_1006_l" action="/mc/co1000/1006" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm/dataSet"/>
			<submission id="hd_com_1002" action="/hd/com/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData"/>
			<submission id="fc_co_1101" action="/fc/co1000/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/fc_co_1101_l/dataSet"/>
			<script type="javascript" ev:event="xforms-model-construct">
				<![CDATA[
					init_controls();
				]]>
			</script>
		</model>
		<script type="javascript">
			<![CDATA[
				var	_oth_clsf = "1";
				
				var gstr_popupid = '';
				var ss_emp_no;
				var ss_emp_nm;
				var ss_deptcd;
				var ss_deptnm;
				
				function init_controls(){
					set_default(datagrid1);						//datagrid			
				}
				function open_fc_acct_1180(p_where,p_mode,p_title,p_readonly) {
					var need_popup = true;
					
					//검색조건이 모두 충족하지 않으면 종료한다.
					if (p_where == "FOCUS" && (srch_dlco_clsf_cd.value.Trim() == "" || srch_dlco_cd.value.Trim() == "")) {
						srch_dlco_cd_nm.value	= "";
						return;
					}
					
					p_where = p_where.toUpperCase();
					
					if (!check_reqItem(srch_dlco_clsf_cd,"none","focus","[거래처검색]은 [거래처구분]을 선택 후 조회 할 수 있습니다.")) {return};
					
					var popid = "fc_acct_1180";
					var subid = "fc_acct_1181_l";
	
					set_popup_send_data(popid		,"mode"			,p_mode			);
					set_popup_send_data(popid		,"title"			,p_title			);
					set_popup_send_data(popid		,"readonly"		,p_readonly		);
					set_popup_send_data(popid		,"clsf_cd"			,srch_dlco_clsf_cd.value	);
					set_popup_send_data(popid		,"cd_f"			,srch_dlco_cd.value		);
					set_popup_send_data(popid		,"cd_t"			,srch_dlco_cd.value		);
					set_popup_send_data(popid		,"cd_abrv_nm"		,""				);
	
					//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
					if (p_where == "FOCUS") {
						//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
						//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
						model.removenode(get_popup_rcvs_ref(popid));
						//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
						model.makeNode(get_popup_rcvs_ref(popid));
						
						//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
						send_submission(
								"auto_" + subid
							,	get_popup_send_ref(popid)
							,	get_popup_rcvs_ref(subid) + "/dataSet"
							,	"/fc/acct1000/1181"
							,	"urlencoded-post"
							,	"application/x-www-form-urlencoded"
						);
						
						totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
				
						if (totalcnt == 1) {
							//데이터가 1건이고 focus out에서 호출한 경우
							//데이터를 설정하고 나간다.
	
	//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
	//						return;
							need_popup = false;
						}
						else if (totalcnt == 0) {
							show_message("거래처코드의 검색결과가 없습니다.");
	//						return;
							need_popup = false;						
						}
						else {
							//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
							//만약 1건 이상인 경우 popup을 호출해 달라고 하면
							//return을 지우면 됨
							//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
							//return;
							need_popup = true;
						}
					}
					
					//그외 버튼인 경우는 계속 진행
					if (need_popup) {
						open_popup(popid,"640");
					}
	
					//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
					//다시 조회 하기 쉽도록 하고
					if (get_popup_rcvs_data(popid,"clsf_cd") != "")			srch_dlco_clsf_cd.value		=	get_popup_rcvs_data(popid,"clsf_cd");
					if (get_popup_rcvs_data(popid,"cd") != "")				srch_dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
					//그외의 값은 지워지도록 한다.
					srch_dlco_cd_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
				}												
				function setEvntInfo(Evnt_cd, Evnt_cd_nm){

					if (gstr_popupid == "evnt_cd") {

						model.setValue("/root/reqData/searchData/evnt_cd", Evnt_cd);
						model.setValue("/root/reqData/searchData/evnt_cd_nm", Evnt_cd_nm);
						
						srch_evnt_cd.refresh();
						srch_evnt_cd_nm.refresh();
					}
					
					gstr_popupid = "";
				}
				function setEmp_no(emp_no, nm_korn){

					srch_incmg_emp_no.value = emp_no;
					srch_incmg_emp_nm.value = nm_korn;
				}				
				function setDept_cd(iv_dept_cd, iv_dept_nm, iv_dept_team_clsf, iv_offi_nm, iv_dept_team_nm, iv_part_nm, iv_part_dn_nm){	
					if (gstr_popupid == "clam_dept_cd") {
						model.setValue("/root/reqData/searchData/clam_dept_cd", iv_dept_cd);
						model.setValue("/root/reqData/searchData/clam_dept_nm", iv_dept_nm);
						srch_clam_dept_cd.refresh();
						srch_clam_dept_nm.refresh();
						
						srch_clam_dept_cd.dispatch("xforms-value-changed");
					}					
					else if (gstr_popupid == "clam_dept_cd1") {
						model.setValue("/root/reqData/searchData/clam_dept_cd1", iv_dept_cd);
						model.setValue("/root/reqData/searchData/clam_dept_cd_nm", iv_dept_nm);
						srch_clam_dept_cd1.refresh();
						srch_clam_dept_cd_nm.refresh();
					}
					else if (gstr_popupid == "use_dept_cd") {
						model.setValue("/root/reqData/searchData/use_dept_cd", iv_dept_cd);
						model.setValue("/root/reqData/searchData/use_dept_cd_nm", iv_dept_nm);
						srch_use_dept_cd.refresh();
						srch_use_dept_cd_nm.refresh();
					}	
					else if (gstr_popupid == "dlco_cd") {
						model.setValue("/root/reqData/searchData/dlco_cd", iv_dept_cd);
						model.setValue("/root/reqData/searchData/dlco_cd_nm", iv_dept_nm);
						srch_dlco_cd.refresh();
						srch_dlco_cd_nm.refresh();
					}					

					gstr_popupid = "";
				}
				function open_fc_acct_2470(p_where,p_mode,p_title,p_readonly) {
					var need_popup = true;										
					
					var popid = "fc_acct_2470";
					var subid = "fc_acct_2471_l";
	
					set_popup_send_data(popid		,"mode"			,p_mode			);
					set_popup_send_data(popid		,"title"			,p_title			);
					set_popup_send_data(popid		,"readonly"		,p_readonly		);
					set_popup_send_data(popid		,"slip_occr_dt"		,get_refvalue("/root/resData/gridData/fc_acct_2491_l/dataSet/CURLIST/record["+datagrid1.row+"]/slip_no").substring(0,8));
					set_popup_send_data(popid		,"slip_clsf_cd"		,get_refvalue("/root/resData/gridData/fc_acct_2491_l/dataSet/CURLIST/record["+datagrid1.row+"]/slip_no").substring(9,11));
					set_popup_send_data(popid		,"slip_seq"			,get_refvalue("/root/resData/gridData/fc_acct_2491_l/dataSet/CURLIST/record["+datagrid1.row+"]/slip_no").substring(12,15));
					set_popup_send_data(popid		,"slip_sub_seq"		,get_refvalue("/root/resData/gridData/fc_acct_2491_l/dataSet/CURLIST/record["+datagrid1.row+"]/slip_no").substring(16,17));

					//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
					if (p_where == "FOCUS") {
						//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
						//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
						model.removenode(get_popup_rcvs_ref(popid));
						//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
						model.makeNode(get_popup_rcvs_ref(popid));
						
						//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
						send_submission(
								"auto_" + subid
							,	get_popup_send_ref(popid)
							,	get_popup_rcvs_ref(subid) + "/dataSet"
							,	"/fc/acct2000/2471"
							,	"urlencoded-post"
							,	"application/x-www-form-urlencoded"
						);
						
						totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST/totalcnt");
				
						if (totalcnt == 1) {
							//데이터가 1건이고 focus out에서 호출한 경우
							//데이터를 설정하고 나간다.
	
	//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST/record");
	//						return;
							need_popup = false;
						}
						else if (totalcnt == 0) {
							show_message("검색결과가 없습니다.");
	//						return;
							need_popup = false;						
						}
						else {
							//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
							//만약 1건 이상인 경우 popup을 호출해 달라고 하면
							//return을 지우면 됨
							//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
							//return;
							need_popup = true;
						}
					}					
					if (need_popup) {
						open_popup(popid,"");
					}
				}						
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="2,34;2,39;2,40;2,49;2,69;2,78;2,80;2,104;2,105;2,112;2,113;2,118;2,118;2,132;2,134;2,157;2,158;2,366;2,393;2,408;2,409;1,936;1,927;1,926;1,459;1,449;2,755;">
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:50px; width:926px; height:21px; ">
			<button id="btn_select" class="btn02" crud="R" style="left:651px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if(model.getValue("/root/reqData/searchData/clam_dept_cd") ==""){
						show_message("부서코드는 필수입력 항목입니다.");
						return;
					}					
					if(model.getValue("/root/reqData/searchData/frbudg_cd") == "" || model.getValue("/root/reqData/searchData/frbudg_cd").length != 6){
						show_message("예산코드는 필수입력 항목입니다.");
						return;
					}
//					if(model.getValue("/root/reqData/searchData/frbudg_cd") == "" || model.getValue("/root/reqData/searchData/frbudg_cd").length != 6){
//						show_message("예산코드TO 필수입력 항목이 입력되지 않았습니다.");
//						return;
//					}
					if(model.getValue("/root/reqData/searchData/frfisc_dt") == "" || model.getValue("/root/reqData/searchData/frfisc_dt").length != 8){
						show_message("회계일자FR은 필수입력 항목입니다.");
						return;
					}
					if(model.getValue("/root/reqData/searchData/tofisc_dt") == "" || model.getValue("/root/reqData/searchData/tofisc_dt").length != 8){
						show_message("회계일자TO는 필수입력 항목입니다.");
						return;
					}					
					
					if(model.getValue("/root/reqData/searchData/frfisc_dt") > model.getValue("/root/reqData/searchData/tofisc_dt")){
						show_message("회계일자 입력 오류입니다.");
						return;
					}

					var fisc_dt_diff;
					fisc_dt_diff = get_datediff(srch_frfisc_dt.value,srch_tofisc_dt.value);												
					
					if(fisc_dt_diff > 366){
						show_message("1년이 초과하는 자료는 조회할 수 없습니다.");
						return;
					}						
					
					//model.setValue("/root/reqData/searchData/tobudg_cd",model.getValue("/root/reqData/searchData/frbudg_cd"));
					var tobudg_cd = model.getValue("/root/reqData/searchData/tobudg_cd");
					if(tobudg_cd == ""){
						model.setValue("/root/reqData/searchData/tobudg_cd",model.getValue("/root/reqData/searchData/frbudg_cd"));
					}
					
					if(model.getValue("/root/reqData/searchData/drcr_clsf") =="1 9"){
						model.setValue("/root/reqData/searchData/drcr_clsf1","1");
						model.setValue("/root/reqData/searchData/drcr_clsf2","9");
					}
					else if(model.getValue("/root/reqData/searchData/drcr_clsf") =="1"){
						model.setValue("/root/reqData/searchData/drcr_clsf1","1");
						model.setValue("/root/reqData/searchData/drcr_clsf2","");						
					}
					else if(model.getValue("/root/reqData/searchData/drcr_clsf") =="9"){
						model.setValue("/root/reqData/searchData/drcr_clsf2","9");
						model.setValue("/root/reqData/searchData/drcr_clsf1","");
					}		
				
					if (fn_cmpcMgmt(srch_clam_dept_cd.value) == false) { return; }
					
					model.send("fc_acct_2491_l");

					if(model.getValue("/root/resData/gridData/fc_acct_2491_l/dataSet/CURLIST/totalcnt") == "0"){
						show_message("검색결과가 없습니다.");
						commGroupInit(group2);
						reset_refnode("/root/resData/gridData/fc_acct_2491_l/dataSet");
						return;
					}					

					var tot_dr_amt = 0;
					var tot_crdt_amt = 0;
					
					for (i=1; i<datagrid1.rows;i++){
						tot_dr_amt = tot_dr_amt + Number(model.getValue("/root/resData/gridData/fc_acct_2491_l/dataSet/CURLIST/record["+i+"]/dr_amt"));
						tot_crdt_amt = tot_crdt_amt + Number(model.getValue("/root/resData/gridData/fc_acct_2491_l/dataSet/CURLIST/record["+i+"]/crdt_amt"));
					}
					model.setValue("/root/resData/resForm/tot_dr_amt", tot_dr_amt);
					model.setValue("/root/resData/resForm/tot_crdt_amt", tot_crdt_amt);
					model.setValue("/root/resData/resForm/frobj_dt",model.getValue("	/root/reqData/searchData/frfisc_dt"));
					model.setValue("/root/resData/resForm/toobj_dt",model.getValue("/root/reqData/searchData/tofisc_dt"));
					model.refresh();
				]]>
				</script>
			</button>
			<button id="btn_pop" class="btn02" crud="R" style="left:706px; top:0px; width:52px; height:21px; ">
				<caption>건별조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
//						if(get_refvalue("/root/resData/gridData/fc_acct_2491_l/dataSet/CURLIST/record["+datagrid1.row+"]/slip_no") !=""){
//							open_fc_acct_2470("button","s","","0");	
//						}
						var slip_no; 
						if(get_refvalue("/root/resData/gridData/fc_acct_2491_l/dataSet/CURLIST/record["+datagrid1.row+"]/slip_no") !=""){
							slip_no = get_refvalue("/root/resData/gridData/fc_acct_2491_l/dataSet/CURLIST/record["+datagrid1.row+"]/slip_no");
							model.property("FC_ACCT_2470_srch_slip_occr_dt")  = slip_no.substring(0,8);
							model.property("FC_ACCT_2470_srch_slip_clsf_cd") =  slip_no.substring(9,11);
							model.property("FC_ACCT_2470_srch_slip_seq") = slip_no.substring(12,15);
							model.property("FC_ACCT_2470_srch_slip_sub_seq") = slip_no.substring(16,17);
													
							model.property("FC_ACCT_2470_popup_flag")  = "Y";
	
//							viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2470");
//							viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2470");
							if(getProperty("ss_cmpycd") != "500"){
								viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2470");
							}else{
								viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2470_500");
							}	
						}	
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" crud="R" style="left:816px; top:0px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:871px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose();
					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" style="left:760px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						commGroupInit(group1);
						commGroupInit(group2);
						reset_refnode("/root/resData/gridData/fc_acct_2491_l/dataSet");
					]]>
				</script>
			</button>
		</group>
		<group id="group_scr" class="gro_sel" style="left:10px; top:80px; width:926px; height:76px; ">
			<caption id="caption2" class="list_cap02" style="left:0px; top:50px; width:926px; height:26px; "/>
			<caption id="caption28" class="list_cap02" style="left:0px; top:25px; width:926px; height:26px; "/>
			<caption id="caption29" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; "/>
			<caption id="caption3" class="list_cap03" style="left:420px; top:0px; width:110px; height:26px; ">사번</caption>
			<caption id="caption1" class="list_cap03" style="left:0px; top:50px; width:110px; height:26px; ">대상기간</caption>
			<caption id="caption36" class="list_cap03" style="left:420px; top:25px; width:110px; height:26px; ">소속부서</caption>
			<caption id="caption17" class="list_cap03" style="left:0px; top:25px; width:110px; height:26px; ">부서허용예산코드</caption>
			<caption id="caption30" class="list_cap03" style="left:0px; top:0px; width:110px; height:26px; ">부서코드</caption>
			<select1 id="frbudg_cd" ref="/root/reqData/searchData/frbudg_cd" class="req" navindex="2" appearance="minimal" itemcount="8" style="left:113px; top:29px; width:140px; height:18px; ">
				<choices>
					<itemset nodeset="/root/resData/resForm/fc_acct_2492_s/dataSet/CURLIST/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						model.setValue("/root/reqData/searchData/tobudg_cd","");
						model.refresh();
					]]>
				</script>
			</select1>
			<input id="srch_frfisc_dt" ref="/root/reqData/searchData/frfisc_dt" class="req" navindex="3" inputtype="date" style="left:113px; top:54px; width:100px; height:18px; "/>
			<input id="srch_tofisc_dt" ref="/root/reqData/searchData/tofisc_dt" class="req" navindex="4" inputtype="date" style="left:233px; top:54px; width:100px; height:18px; "/>
			<caption id="caption4" style="left:216px; top:56px; width:15px; height:18px; ">~</caption>
			<input id="emp_no" ref="/root/resData/resForm/emp_no" navindex="-1" editable="false" style="left:533px; top:4px; width:150px; height:18px; "/>
			<input id="deptcd" ref="/root/resData/resForm/deptcd" navindex="-1" editable="false" style="left:533px; top:29px; width:150px; height:18px; "/>
			<input id="srch_clam_dept_cd" ref="/root/reqData/searchData/clam_dept_cd" class="req" navindex="10" inputtype="button" maxlength="6" style="left:113px; top:5px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						
						var var_con_date = "";

						if (srch_frfisc_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_frfisc_dt.value.length;
							if(num_ch == 8){
								var_con_date = srch_frfisc_dt.value;
							}else if(num_ch == 6){
								var_con_date = srch_frfisc_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = srch_frfisc_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "S");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						gstr_popupid = "clam_dept_cd";
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						
						var var_con_date = "";

						if (srch_frfisc_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_frfisc_dt.value.length;
							if(num_ch == 8){
								var_con_date = srch_frfisc_dt.value;
							}else if(num_ch == 6){
								var_con_date = srch_frfisc_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = srch_frfisc_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (srch_clam_dept_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
//							model.setValue("/root/reqData/searchData/emp_no", "");
							model.setValue("/root/reqData/fwdData/dept_cd", srch_clam_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "S");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								srch_clam_dept_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
								
								//부서에 따른 예산코드 조회
								model.send("fc_acct_2492_s");
								frbudg_cd.refresh();
								makeComboGubun("","/root/resData/resForm/fc_acct_2492_s/dataSet/CURLIST","record","cd_nm", "cd");	
								
							}
							else {
								srch_clam_dept_cd.value = "";
								srch_clam_dept_nm.value = "";
							}
						}
						else {
							srch_clam_dept_cd.value = "";
							srch_clam_dept_nm.value = "";
						}	
																							
					]]>
				</script>
			</input>
			<input id="srch_clam_dept_nm" ref="/root/reqData/searchData/clam_dept_nm" navindex="-1" editable="false" style="left:218px; top:5px; width:150px; height:18px; "/>
			<select1 id="tobudg_cd" ref="/root/reqData/searchData/tobudg_cd" navindex="2" appearance="minimal" itemcount="8" style="left:275px; top:29px; width:140px; height:18px; ">
				<choices>
					<itemset nodeset="/root/resData/resForm/fc_acct_2492_s/dataSet/CURLIST/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</select1>
			<caption id="caption5" style="left:258px; top:32px; width:15px; height:15px; ">~</caption>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:163px; width:926px; height:5px; "/>
		<group id="group1" class="gro_sel" style="left:10px; top:175px; width:926px; height:126px; ">
			<caption id="caption38" class="list_cap02" style="left:0px; top:100px; width:926px; height:26px; "/>
			<caption id="caption23" class="list_cap02" style="left:0px; top:75px; width:926px; height:26px; "/>
			<caption id="caption21" class="list_cap02" style="left:0px; top:50px; width:926px; height:26px; "/>
			<caption id="caption8" class="list_cap02" style="left:0px; top:25px; width:926px; height:26px; "/>
			<caption id="caption7" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; "/>
			<caption id="caption9" class="list_cap03" style="left:0px; top:0px; width:110px; height:26px; ">대상거래처</caption>
			<caption id="caption10" class="list_cap03" style="left:458px; top:0px; width:110px; height:26px; ">대상매체</caption>
			<caption id="caption16" class="list_cap03" style="left:0px; top:25px; width:110px; height:26px; ">대상관리구분</caption>
			<caption id="caption18" class="list_cap03" style="left:458px; top:50px; width:110px; height:26px; ">전표구분</caption>
			<caption id="caption19" class="list_cap03" style="left:458px; top:25px; width:110px; height:26px; ">대상행사코드</caption>
			<caption id="caption22" class="list_cap03" style="left:0px; top:50px; width:110px; height:26px; ">대상청구부서</caption>
			<caption id="caption24" class="list_cap03" style="left:0px; top:75px; width:110px; height:26px; ">금액 FR-TO</caption>
			<caption id="caption11" class="list_cap03" style="left:458px; top:75px; width:110px; height:26px; ">입력자사번</caption>
			<caption id="caption35" class="list_cap03" style="left:0px; top:100px; width:110px; height:26px; ">사용부서</caption>
			<select1 id="srch_dlco_clsf_cd" ref="/root/reqData/searchData/dlco_clsf_cd" class="combo" navindex="5" appearance="minimal" editmode="inputsearch" itemcount="10" style="left:113px; top:4px; width:90px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/DLCO_CLSF_CD/record">
						<label ref="/cd_nm"/>
						<value ref="/cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(srch_dlco_clsf_cd, srch_dlco_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(srch_dlco_clsf_cd,"");
							return;
						}
					]]>
				</script>
			</select1>
			<select1 id="srch_medi_cd" ref="/root/reqData/searchData/medi_cd" class="combo_140" navindex="7" appearance="minimal" editmode="inputsearch" itemcount="10" style="left:571px; top:4px; width:140px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/MEDI_CD/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(srch_medi_cd, srch_medi_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(srch_medi_cd,"");
							return;
						}
					]]>
				</script>
			</select1>
			<select1 id="srch_slip_clsf_cd" ref="/root/reqData/searchData/slip_clsf_cd" class="combo_100" navindex="11" appearance="minimal" editmode="inputsearch" itemcount="10" style="left:571px; top:54px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/SLIP_CLSF_CD/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(srch_slip_clsf_cd, srch_slip_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(srch_slip_clsf_cd,"");
							return;
						}
					]]>
				</script>
			</select1>
			<select1 id="srch_mang_clsf_cd" ref="/root/reqData/searchData/mang_clsf_cd" class="combo_140" navindex="8" appearance="minimal" editmode="inputsearch" itemcount="10" style="left:113px; top:28px; width:140px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/MANG_CLSF_CD/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(srch_mang_clsf_cd, srch_mang_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(srch_mang_clsf_cd,"");
							return;
						}
					]]>
				</script>
			</select1>
			<input id="srch_dlco_cd" ref="/root/reqData/searchData/dlco_cd" class="input_100" navindex="6" inputtype="button" style="left:206px; top:4px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[						
						//if (srch_dlco_clsf_cd.value == "92") { //2012.01.12
						var orgStr = model.getValue("/root/initData/comboSet/dataSet/xx_srch_dlco_clsf_cd");
						if(instr_yn(orgStr, srch_dlco_clsf_cd.value)){

							gstr_popupid = "dlco_cd";
							
							var var_con_date = "";
	
							if (srch_frfisc_dt.value == ""){ 
								var_con_date = commCurDate(); 
							}else { 
								var num_ch = srch_frfisc_dt.value.length;
								if(num_ch == 8){
									var_con_date = srch_frfisc_dt.value;
								}else if(num_ch == 6){
									var_con_date = srch_frfisc_dt.value + "01";
								}else if(num_ch == 4){
									var_con_date = srch_frfisc_dt.value + "0101";
								}else{
									var_con_date = commCurDate(); 
								}
							}
								
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/func_nm");
							model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.setValue("/root/reqData/fwdData/select_ch", "S");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
							
						} else {
							open_fc_acct_1180("button","s","","1");	
						}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (srch_dlco_clsf_cd.value == model.getValue("/root/initData/comboSet/dataSet/xx_srch_dlco_clsf_cd")) {
							var var_con_date = "";
	
							if (srch_frfisc_dt.value == ""){ 
								var_con_date = commCurDate(); 
							}else { 
								var num_ch = srch_frfisc_dt.value.length;
								if(num_ch == 8){
									var_con_date = srch_frfisc_dt.value;
								}else if(num_ch == 6){
									var_con_date = srch_frfisc_dt.value + "01";
								}else if(num_ch == 4){
									var_con_date = srch_frfisc_dt.value + "0101";
								}else{
									var_con_date = commCurDate(); 
								}
							}
	
							if (srch_dlco_cd.value.length== 6) {
								
								model.removeNodeset("/root/reqData/fwdData");  
								model.makeNode("/root/reqData/fwdData/dept_cd");
								model.makeNode("/root/reqData/fwdData/select_ch");
								model.makeNode("/root/reqData/fwdData/use_end_dt");
	//							model.setValue("/root/reqData/searchData/emp_no", "");
								model.setValue("/root/reqData/fwdData/dept_cd", srch_dlco_cd.value);
								model.setValue("/root/reqData/fwdData/select_ch", "S");
								model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
								model.send("fc_co_1101");
	
								if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
									srch_dlco_cd_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
								}
								else {
									srch_dlco_cd.value = "";
									srch_dlco_cd_nm.value = "";
								}
							}
							else {
								srch_dlco_cd.value = "";
								srch_dlco_cd_nm.value = "";
							}	
						} else {
							open_fc_acct_1180("focus","s","","1");
						}
					]]>
				</script>
			</input>
			<input id="srch_clam_dept_cd1" ref="/root/reqData/searchData/clam_dept_cd1" class="input_100" navindex="10" inputtype="button" maxlength="6" style="left:113px; top:54px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					
						var var_con_date = "";

						gstr_popupid = "clam_dept_cd";

						if (srch_frfisc_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_frfisc_dt.value.length;
							if(num_ch == 8){
								var_con_date = srch_frfisc_dt.value;
							}else if(num_ch == 6){
								var_con_date = srch_frfisc_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = srch_frfisc_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "S");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						gstr_popupid = "clam_dept_cd1";
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
									
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						
						var var_con_date = "";

						if (srch_frfisc_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_frfisc_dt.value.length;
							if(num_ch == 8){
								var_con_date = srch_frfisc_dt.value;
							}else if(num_ch == 6){
								var_con_date = srch_frfisc_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = srch_frfisc_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (srch_clam_dept_cd1.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
//							model.setValue("/root/reqData/searchData/emp_no", "");
							model.setValue("/root/reqData/fwdData/dept_cd", srch_clam_dept_cd1.value);
							model.setValue("/root/reqData/fwdData/select_ch", "S");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								srch_clam_dept_cd_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								srch_clam_dept_cd1.value = "";
								srch_clam_dept_cd_nm.value = "";
							}
						}
						else {
							srch_clam_dept_cd1.value = "";
							srch_clam_dept_cd_nm.value = "";
						}	
															
					]]>
				</script>
			</input>
			<input id="srch_dr_amt" ref="/root/reqData/searchData/dr_amt" class="input_100" navindex="12" format="(+)#,###" style="left:113px; top:79px; width:100px; height:18px; text-align:right; "/>
			<input id="srch_crdt_amt" ref="/root/reqData/searchData/crdt_amt" class="input_100" navindex="13" format="(+)#,###" style="left:233px; top:79px; width:100px; height:18px; text-align:right; "/>
			<caption id="caption14" style="left:218px; top:79px; width:15px; height:18px; ">~</caption>
			<input id="srch_incmg_emp_no" ref="/root/reqData/searchData/incmg_emp_no" class="input_100" navindex="14" inputtype="button" maxlength="6" style="left:571px; top:79px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");					
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (srch_incmg_emp_no.value.length == 6) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/emp_no");
							model.setValue("/root/reqData/fwdData/emp_no", srch_incmg_emp_no.value);
							model.send("hd_com_1002");
							
							if (model.getValue("/root/totalcnt") != "0") {
								srch_incmg_emp_nm.value = model.getValue("/root/tempData/record/nm_korn");
							}
							else {
								srch_incmg_emp_no.value = "";
								srch_incmg_emp_nm.value = "";
							}
						}		
						else {
							srch_incmg_emp_no.value = "";
							srch_incmg_emp_nm.value = "";
						}

						model.removeNodeset("/root/totalcnt");											
					]]>
				</script>
			</input>
			<input id="srch_incmg_emp_nm" ref="/root/reqData/searchData/incmg_emp_nm" navindex="-1" editable="false" style="left:676px; top:79px; width:200px; height:18px; "/>
			<select id="srch_drcr_clsf" ref="/root/reqData/searchData/drcr_clsf" navindex="16" overflow="visible" appearance="full" cols="2" rows="1" style="left:571px; top:104px; width:160px; height:15px; border-style:none; ">
				<choices>
					<item>
						<label>차변발생분</label>
						<value>1</value>
					</item>
					<item>
						<label>대변발생분</label>
						<value>9</value>
					</item>
				</choices>
			</select>
			<input id="srch_evnt_cd" ref="/root/reqData/searchData/evnt_cd" class="input_100" navindex="9" inputtype="button" maxlength="10" style="left:571px; top:29px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cmpy_cd");
						model.makeNode("/root/reqData/fwdData/G_Tag");						
						model.makeNode("/root/reqData/fwdData/G_Caption");
						model.setValue("/root/reqData/fwdData/cmpy_cd", model.getValue("/root/reqData/searchData/cmpy_cd"));
						model.setValue("/root/reqData/fwdData/G_Tag", model.getValue("/root/initData/comboSet/dataSet/xx_g_tag"));
						model.setValue("/root/reqData/fwdData/G_Caption", "행사코드조회");
					
						gstr_popupid = "evnt_cd";
					
						window.load("../../mc/co/MC_CO_1000.xrw"
									, "modal"
									, ""
									, "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
								,"/root/reqData/fwdData"
								,"/root/reqData/fwdData"
								)	
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(model.getValue("/root/reqData/searchData/evnt_cd").length == 10){
						 	model.setValue("/root/reqData/searchData/cd",model.getValue("/root/reqData/searchData/evnt_cd"));
						 	model.setValue("/root/reqData/searchData/cdnm","");
							model.send("mc_co_1006_l");
							model.setValue("/root/reqData/searchData/evnt_cd_nm", model.getValue("/root/resData/resForm/dataSet/CURLIST/record[1]/cdnm"));
							srch_evnt_cd_nm.refresh();
						}
						else{
							model.setValue("/root/reqData/searchData/evnt_cd_nm","");
							srch_evnt_cd_nm.refresh();
						}					
					]]>
				</script>
			</input>
			<input id="srch_evnt_cd_nm" ref="/root/reqData/searchData/evnt_cd_nm" navindex="-1" editable="false" style="left:676px; top:29px; width:200px; height:18px; "/>
			<input id="srch_use_dept_cd" ref="/root/reqData/searchData/use_dept_cd" class="input_100" navindex="15" inputtype="button" maxlength="6" style="left:112px; top:104px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[		
						
						var var_con_date = "";

						if (srch_frfisc_dt.value == "") 
						       { var_con_date = commCurDate(); }
						else { var_con_date = srch_frfisc_dt.value; }
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "S");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						gstr_popupid = "use_dept_cd";
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[		
						var var_con_date = "";

						if (srch_frfisc_dt.value == "") 
						       { var_con_date = commCurDate(); }
						else { var_con_date = srch_frfisc_dt.value; }

						if (srch_use_dept_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
//							model.setValue("/root/reqData/searchData/emp_no", "");
							model.setValue("/root/reqData/fwdData/dept_cd", srch_use_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "S");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								srch_use_dept_cd_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");								
							}
							else {
								srch_use_dept_cd.value = "";
								srch_use_dept_cd_nm.value = "";
							}
						}
						else {
							srch_use_dept_cd.value = "";
							srch_use_dept_cd_nm.value = "";
						}	
							
					]]>
				</script>
			</input>
			<input id="srch_use_dept_cd_nm" ref="/root/reqData/searchData/use_dept_cd_nm" navindex="-1" editable="false" style="left:217px; top:104px; width:150px; height:18px; "/>
			<input id="srch_clam_dept_cd_nm" ref="/root/reqData/searchData/clam_dept_cd_nm" navindex="-1" editable="false" style="left:218px; top:54px; width:150px; height:18px; "/>
			<input id="srch_dlco_cd_nm" ref="/root/reqData/searchData/dlco_cd_nm" navindex="-1" editable="false" style="left:311px; top:4px; width:140px; height:18px; "/>
		</group>
		<group id="group2" class="gro_sel" style="left:10px; top:305px; width:926px; height:51px; ">
			<caption id="caption26" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; "/>
			<caption id="caption27" class="list_cap02" style="left:0px; top:25px; width:926px; height:26px; "/>
			<input id="input16" ref="/root/resData/resForm/frobj_dt" navindex="-1" editable="false" format="yyyy-mm-dd" style="left:113px; top:4px; width:100px; height:18px; text-align:center; "/>
			<input id="input17" ref="/root/resData/resForm/toobj_dt" navindex="-1" editable="false" format="yyyy-mm-dd" style="left:218px; top:4px; width:100px; height:18px; text-align:center; "/>
			<caption id="caption31" class="list_cap03" style="left:0px; top:0px; width:110px; height:26px; ">대상일자</caption>
			<caption id="caption32" class="list_cap03" style="left:458px; top:0px; width:110px; height:26px; ">차변발생합계</caption>
			<caption id="caption34" class="list_cap03" style="left:458px; top:25px; width:110px; height:26px; ">대변발생합계</caption>
			<input id="tot_dr_amt" ref="/root/resData/resForm/tot_dr_amt" navindex="-1" editable="false" format="(-)#,###" style="left:571px; top:4px; width:150px; height:18px; text-align:right; "/>
			<input id="tot_crdt_amt" ref="/root/resData/resForm/tot_crdt_amt" navindex="-1" editable="false" format="(-)#,###" style="left:571px; top:29px; width:150px; height:18px; text-align:right; "/>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/fc_acct_2491_l/dataSet/CURLIST/record" caption="예산코드^예산명^회계일자^전표번호^적요^차변금액^대변금액^관리구분^관리번호^거래처구분^거래처코드^거래처명^부거래처명^매체코드^상세매체코드^영수증구분^사용부서^행사코드^청구부서^대상계정^대상금액^소득구분" colsep="^" colwidth="100, 150, 100, 160, 200, 130, 130, 100, 120, 100, 100, 150, 150, 100, 100, 100, 100, 100,100,100,120" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:10px; top:365px; width:926px; height:335px; ">
			<col ref="budg_cd" type="output"/>
			<col ref="budg_cd_nm" type="output" style="text-align:left; "/>
			<col ref="fisc_dt" type="output" format="yyyy-mm-dd"/>
			<col ref="slip_no" type="output"/>
			<col ref="rmks" type="output" style="text-align:left; "/>
			<col ref="dr_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="crdt_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="mang_clsf_cd" style="text-align:left; "/>
			<col ref="mang_no"/>
			<col ref="dlco_clsf_cd"/>
			<col ref="dlco_cd"/>
			<col ref="dlco_cd_nm"/>
			<col ref="boks_dlco_cd_nm"/>
			<col ref="medi_cd" style="text-align:left; "/>
			<col ref="dtls_medi_cd" style="text-align:left; "/>
			<col ref="prop_equip_cd"/>
			<col ref="use_dept_cd"/>
			<col ref="evnt_cd"/>
			<col ref="clam_dept_cd_nm" style="text-align:left; "/>
			<col ref="obj_acct_cd_nm" style="text-align:left; "/>
			<col ref="obj_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="incm_clsf_cd_nm" style="text-align:left; "/>
		</datagrid>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
	</xhtml:body>
</xhtml:html>
