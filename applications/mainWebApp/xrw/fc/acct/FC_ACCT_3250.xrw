<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>일반전표등록(II)(FC_ACCT_3250))</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session/>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
							<fc_acct_3250_m>
								<dataSet>
									<CURLIST1>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURLIST1>
									<xx_ss_cmpycd/>
									<xx_ss_emp_no/>
									<xx_srch_slip_clsf_cd/>
									<xx_srch_slip_clsf_cd_1/>
									<xx_srch_slip_clsf_cd_2/>
									<xx_srch_slip_clsf_cd_3/>
									<xx_ss_emp_no_010/>
									<xx_valuematrix/>
									<CUR_INCM_CLSF_LIST>
										<record>
											<cd/>
											<cd_nm/>
										</record>
									</CUR_INCM_CLSF_LIST>
									<CURLIST3>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURLIST3>
								</dataSet>
							</fc_acct_3250_m>
							<fc_acct_2290_m>
								<dataSet>
									<NOTE_STAT_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</NOTE_STAT_CURLIST>
									<DLCO_CLSF_CD_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</DLCO_CLSF_CD_CURLIST>
									<SLIP_CLSF_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</SLIP_CLSF_CURLIST>
									<MEDI_CD_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</MEDI_CD_CURLIST>
									<FRCR_CLSF_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</FRCR_CLSF_CURLIST>
									<MANG_CLSF_CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</MANG_CLSF_CURLIST>
									<CUR_PROF_TYPE_LIST>
										<record>
											<cd_nm/>
											<cd/>
										</record>
									</CUR_PROF_TYPE_LIST>
									<CUR_ERPLACE_CD_LIST>
										<record>
											<cd_nm/>
											<cd/>
										</record>
									</CUR_ERPLACE_CD_LIST>
									<CUR_MANG_ITEM_CD_LIST>
										<record>
											<mang_item_cd/>
											<drcr_clsf/>
										</record>
									</CUR_MANG_ITEM_CD_LIST>
									<CUR_DLCO_CLSF_LIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CUR_DLCO_CLSF_LIST>
									<CUR_BUDGMANGCD_LIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CUR_BUDGMANGCD_LIST>
									<CUR_WHCO_NDSTB_CD_LIST>
										<record>
											<whco_ndstb_cd/>
											<whco_comn_cost_yn/>
										</record>
									</CUR_WHCO_NDSTB_CD_LIST>
								</dataSet>
							</fc_acct_2290_m>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
						<popupSet>
							<fc_co_8001_s>
								<dataSet>
									<CURLIST>
										<record>
											<budg_cdnm/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_co_8001_s>
						</popupSet>
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData/>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<cmpy_cd/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<slip_sub_seq/>
							<budg_cd/>
							<ern/>
							<cd/>
							<cdnm/>
							<dept_cd/>
							<clam_dept_cd/>
							<pch_cgbuseonm/>
							<incmg_emp_no/>
							<pch_irjnm/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqform/>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpDate/>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
						<fc_acct_3253_i>
							<cmpy_cd/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<slip_sub_seq/>
							<clam_dept_cd/>
							<incmg_emp_no/>
							<fisc_dt/>
							<incmg_pers/>
							<incmg_pers_ipadd/>
							<incmg_dt/>
							<multiUpdateData/>
						</fc_acct_3253_i>
						<fc_acct_3254_u>
							<cmpy_cd/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<slip_sub_seq/>
							<clam_dept_cd/>
							<incmg_emp_no/>
							<fisc_dt/>
							<incmg_pers/>
							<incmg_pers_ipadd/>
							<incmg_dt/>
							<reso_amt/>
							<reso_amt_ch/>
							<multiUpdateData/>
						</fc_acct_3254_u>
						<fc_acct_3255_d>
							<cmpy_cd/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<slip_sub_seq/>
							<incmg_pers/>
							<incmg_pers_ipadd/>
							<in_sicsgb/>
						</fc_acct_3255_d>
						<fc_acct_3257_a>
							<cmpy_cd/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<slip_sub_seq/>
							<incmg_pers/>
							<incmg_pers_ipadd/>
							<prof_type_cd/>
						</fc_acct_3257_a>
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resform>
							<dr_amt_sum/>
							<crdt_amt_sum/>
							<rmks1/>
							<slip_arow_no/>
							<!-- 예산코드           -->
							<budg_cd/>
							<!-- 예산코드명         -->
							<pch_sdysnm/>
							<!-- 사용부서           -->
							<use_dept_cd/>
							<!-- 사용부서명         -->
							<pch_buseonm/>
							<!-- 차변금액           -->
							<dr_amt/>
							<!-- 대변금액           -->
							<crdt_amt/>
							<!-- 거래처구분         -->
							<dlco_clsf_cd/>
							<!-- 거래처코드         -->
							<dlco_cd/>
							<!-- 거래처명           -->
							<dlco_nm/>
							<!-- 통합거래처코드     -->
							<intg_dlco_cd/>
							<!-- 부거래처명         -->
							<boks_dlco_nm/>
							<!-- 관리구분           -->
							<mang_clsf_cd/>
							<!-- 관리번호           -->
							<mang_no/>
							<!-- 은행코드           -->
							<mang_clsf_nm/>
							<bank_cd/>
							<!-- 은행코드명         -->
							<pch_banknm/>
							<!-- 영수증구분         -->
							<prop_equip_cd/>
							<!-- 매체코드           -->
							<prop_equip_cd_nm/>
							<medi_cd/>
							<!-- 상세매체           -->
							<dtls_medi_cd/>
							<!-- 행사코드           -->
							<evnt_cd/>
							<!-- 행사코드명         -->
							<pch_hsnm/>
							<!-- 단위               -->
							<unit/>
							<!-- 기산일자           -->
							<comp_dt/>
							<!-- 만기일자           -->
							<mtry_dt/>
							<!-- 수량               -->
							<qunt/>
							<!-- 전사전표번호구분   -->
							<occr_slip_clsf/>
							<!-- 전사전표번호       -->
							<occr_slip/>
							<!-- 상계전표번호       -->
							<setoff_slip_no/>
							<!-- 적요1              -->
							<!-- 적요2              -->
							<rmks2/>
							<!-- 대상계정           -->
							<obj_acct_cd/>
							<!-- 대상계정명         -->
							<pch_dsacctnm/>
							<!-- 대상일자           -->
							<obj_dt/>
							<!-- 대상금액           -->
							<obj_amt/>
							<!-- 어음상태           -->
							<note_stat/>
							<!-- 외화구분코드       -->
							<frcr_clsf_cd/>
							<!-- 환율               -->
							<exrate/>
							<!-- 외화금액           -->
							<frcr_amt/>
							<prof_type_cd/>
							<occr_slip_clsf_cd/>
							<occr_slip_occr_dt/>
							<occr_slip_seq/>
							<erplace_cd/>
							<make_dt/>
							<etc_in/>
							<ern/>
							<suply_amt/>
							<eenosb/>
							<vat_amt/>
							<incm_clsf_cd/>
							<email_id/>
							<remk/>
							<item/>
							<re_issu_resn_cd/>
						</resform>
						<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<gridData>
							<fc_acct_3251_l>
								<dataSet>
									<CURLIST>
										<record>
											<clam_dept_cd/>
											<pch_cgbuseonm/>
											<incmg_emp_no/>
											<pch_irjnm/>
											<incmg_dt/>
											<fisc_dt/>
											<reso_amt/>
											<reso_amt_ch/>
										</record>
									</CURLIST>
									<CURLIST1>
										<record>
											<slip_arow_no/>
											<budg_cd/>
											<pch_sdysnm/>
											<dr_amt/>
											<crdt_amt/>
											<rmks1/>
											<rmks2/>
											<drcr_clsf/>
											<dlco_clsf_cd/>
											<dlco_cd/>
											<dlco_nm/>
											<boks_dlco_nm/>
											<mang_clsf_cd/>
											<mang_no/>
											<incm_clsf_cd/>
											<medi_cd/>
											<dtls_medi_cd/>
											<evnt_cd/>
											<pch_hsnm/>
											<use_dept_cd/>
											<pch_buseonm/>
											<comp_dt/>
											<mtry_dt/>
											<bank_cd/>
											<pch_banknm/>
											<unit/>
											<qunt/>
											<obj_acct_cd/>
											<pch_dsacctnm/>
											<obj_dt/>
											<obj_amt/>
											<frcr_clsf_cd/>
											<frcr_amt/>
											<exrate/>
											<note_stat/>
											<intg_dlco_cd/>
											<prop_equip_cd/>
											<tax_stmt_no/>
											<make_dt/>
											<erplace_cd/>
											<ern/>
											<suply_amt/>
											<setoff_slip_no/>
											<occr_slip_clsf/>
											<occr_slip/>
											<mang_clsf_nm/>
											<prof_type_cd/>
											<occr_slip_clsf_cd/>
											<occr_slip_occr_dt/>
											<occr_slip_seq/>
											<etc_in/>
											<vat_amt/>
											<email_id/>
											<remk/>
											<item/>
											<re_issu_resn_cd/>
										</record>
									</CURLIST1>
									<CURLIST2>
										<record>
											<slip_arow_no/>
											<budg_cd/>
											<pch_sdysnm/>
											<dr_amt>0</dr_amt>
											<crdt_amt>0</crdt_amt>
											<rmks1/>
											<rmks2/>
											<drcr_clsf/>
											<dlco_clsf_cd/>
											<dlco_cd/>
											<dlco_nm/>
											<boks_dlco_nm/>
											<mang_clsf_cd/>
											<mang_no/>
											<incm_clsf_cd/>
											<medi_cd/>
											<dtls_medi_cd/>
											<evnt_cd/>
											<pch_hsnm/>
											<use_dept_cd/>
											<pch_buseonm/>
											<comp_dt/>
											<mtry_dt/>
											<bank_cd/>
											<pch_banknm/>
											<unit/>
											<qunt/>
											<obj_acct_cd/>
											<pch_dsacctnm/>
											<obj_dt/>
											<obj_amt/>
											<frcr_clsf_cd/>
											<frcr_amt/>
											<exrate/>
											<note_stat/>
											<intg_dlco_cd/>
											<prop_equip_cd/>
											<tax_stmt_no/>
											<make_dt/>
											<erplace_cd/>
											<ern/>
											<suply_amt/>
											<setoff_slip_no/>
											<occr_slip_clsf/>
											<occr_slip/>
											<mang_clsf_nm/>
											<prof_type_cd/>
											<occr_slip_clsf_cd/>
											<occr_slip_occr_dt/>
											<occr_slip_seq/>
											<etc_in/>
											<vat_amt/>
											<email_id/>
											<remk/>
											<item/>
											<re_issu_resn_cd/>
										</record>
									</CURLIST2>
								</dataSet>
							</fc_acct_3251_l>
							<fc_acct_3256_l>
								<dataSet>
									<slip_list>
										<record>
											<slip_occr_dt/>
											<slip_seq/>
											<slip_sub_seq/>
											<rmks1/>
											<slip_clsf_cd/>
											<slip_no/>
											<sum_dr_amt/>
											<sum_crdt_amt/>
											<clam_dept_cd/>
											<clam_dept_nm/>
											<incmg_emp_no/>
											<incmg_emp_nm/>
											<diff_amt/>
										</record>
									</slip_list>
								</dataSet>
							</fc_acct_3256_l>
							<rcpm_dtls>
								<record>
									<g1_rcpm_slip_seq/>
									<g1_rcpm_dt/>
									<g1_rcpm_amt/>
									<g1_rcpm_pers_nm/>
									<g1_deps_psbk/>
									<g1_coms/>
									<g1_frex_clsf/>
									<g1_exrate/>
									<g1_frex_amt/>
									<biz_reg_no/>
									<bank_id/>
									<acct_num/>
									<tran_date_seq/>
									<current_clsf/>
									<tran_clsfy/>
								</record>
							</rcpm_dtls>
						</gridData>
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
						<fc_acct_2291_s>
							<dataSet>
								<CUR_MANG_ITEM_CD_LIST>
									<record>
										<mang_item_cd/>
										<drcr_clsf/>
									</record>
								</CUR_MANG_ITEM_CD_LIST>
							</dataSet>
						</fc_acct_2291_s>
						<fc_acct_2292_s>
							<dataSet>
								<CUR_BUDGMANGCD_LIST>
									<record>
										<cd/>
										<cdnm/>
										<cd_abrv_nm/>
										<cdnm_cd/>
										<cdabrvnm_cd/>
									</record>
								</CUR_BUDGMANGCD_LIST>
								<CUR_DLCO_CLSF_LIST>
									<record>
										<cd/>
										<cdnm/>
										<cd_abrv_nm/>
										<cdnm_cd/>
										<cdabrvnm_cd/>
									</record>
								</CUR_DLCO_CLSF_LIST>
								<CUR_ERPLACE_CD_LIST>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</CUR_ERPLACE_CD_LIST>
							</dataSet>
						</fc_acct_2292_s>
						<fc_acct_2293_s>
							<dataSet>
								<CUR_WHCO_NDSTB_CD_LIST>
									<record>
										<whco_ndstb_cd/>
										<whco_comn_cost_yn/>
									</record>
								</CUR_WHCO_NDSTB_CD_LIST>
							</dataSet>
						</fc_acct_2293_s>
						<resform2>
							<dataSet>
								<CURLIST>
									<record>
										<budg_cdnm/>
										<cdnm/>
										<cd/>
										<totalcnt/>
									</record>
								</CURLIST>
							</dataSet>
						</resform2>
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<keyData/>
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<resForm/>
						<fc_co_1101_l>
							<dataSet>
								<CURLIST1>
									<record>
										<cmpy_cd/>
										<dept_cd/>
										<dept_team_clsf/>
										<abrv_nm/>
										<offi_nm/>
										<dept_team_nm/>
										<part_nm/>
										<part_dn_nm/>
									</record>
								</CURLIST1>
							</dataSet>
						</fc_co_1101_l>
						<fc_acct_2015_l>
							<dataSet>
								<CURLIST>
									<record>
										<cd/>
										<cdnm/>
									</record>
								</CURLIST>
							</dataSet>
						</fc_acct_2015_l>
					</tempData>
					<!-- 저장소 -->
					<tempData1>
					</tempData1>
					<tempData2>
						<tempNode/>
						<tot_dr_amt/>
						<tot_crdt_amt/>
					</tempData2>
					<src_3/>
					<src_2/>
				</root>
			</instance>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<script type="javascript" src="/js/fcmc_common.js"/>
			<submission id="fc_co_1101" action="/fc/co1000/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/fc_co_1101_l/dataSet"/>
			<submission id="hd_com_1002" action="/hd/com/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData"/>
			<submission id="fc_acct_2290_m" action="/fc/acct2000/2290" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/initData/comboSet/fc_acct_2290_m/dataSet"/>
			<submission id="fc_acct_2291_s" action="/fc/acct2000/2291" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/resData/fc_acct_2291_s/dataSet"/>
			<submission id="fc_acct_2292_s" action="/fc/acct2000/2292" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/resData/fc_acct_2292_s/dataSet"/>
			<submission id="fc_acct_2293_s" action="/fc/acct2000/2293" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/resData/fc_acct_2293_s/dataSet"/>
			<submission id="fc_co_8000_s" action="/fc/co8000/8000" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/mc_co_8000_s"/>
			<submission id="fc_co_8080_s" action="/fc/co8000/8080" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/mc_co_8080_s"/>
			<submission id="mc_co_1001_l" action="/mc/co1000/1001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/mc_co_1001_l"/>
			<submission id="mc_co_1006_l" action="/mc/co1000/1006" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/mc_co_1005_l"/>
			<submission id="fc_acct_2015_l" action="/fc/acct2000/2015" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/fc_acct_2015_l/dataSet"/>
			<submission id="fc_co_8001_s" action="/fc/co8000/8001" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/initData/popupSet/fc_co_8001_s/dataSet"/>
			<submission id="co_dlco_1005" action="/co/dlco/1005" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData1"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					init_controls();			// 컨트롤 초기화
					caption1.visible = false;
					caption12.visible = false;
					reso_amt.visible = false; 
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[			
					send_fc_acct_3250_m();	// 콤보 초기화
					send_fc_acct_2290_m();
					
					if (model.property("FC_ACCT_3250_popup_flag") == "Y" ) {

						model.setValue("/root/reqData/searchData/slip_occr_dt",model.property("FC_ACCT_3250_srch_slip_occr_dt"));
						model.setValue("/root/reqData/searchData/slip_clsf_cd",model.property("FC_ACCT_3250_srch_slip_clsf_cd"));
						model.setValue("/root/reqData/searchData/slip_seq",model.property("FC_ACCT_3250_srch_slip_seq"));
						model.setValue("/root/reqData/searchData/slip_sub_seq",model.property("FC_ACCT_3250_srch_slip_sub_seq"));
						
						model.property("FC_ACCT_3250_srch_slip_occr_dt")  = "";
						model.property("FC_ACCT_3250_srch_slip_clsf_cd") = "";
						model.property("FC_ACCT_3250_srch_slip_seq") = "";
						model.property("FC_ACCT_3250_srch_slip_sub_seq") = "";
						model.property("FC_ACCT_3250_popup_flag") = "";
						
						btn_select.dispatch("onclick");
						
						//if(datagrid3.valueMatrix(row,1) != ""){  //전표내용 검색 후 클릭시 세부사항 조회
						var row = 1;
						var col = datagrid3.col;				
						model.setValue("/root/reqData/searchData/slip_occr_dt",datagrid3.valueMatrix(row,2).ReplaceString("-", ""));
						model.setValue("/root/reqData/searchData/slip_clsf_cd",datagrid3.valueMatrix(row,6).ReplaceString("-", ""));
						model.setValue("/root/reqData/searchData/slip_seq",datagrid3.valueMatrix(row,3).ReplaceString("-", ""));
						model.setValue("/root/reqData/searchData/slip_sub_seq",datagrid3.valueMatrix(row,4).ReplaceString("-", ""));						
						model.send("fc_acct_3251_l");							
						model.makeNode("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2");
						model.copyNode("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2","/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST1");

						datagrid3.editCell(); 	
										
						fn_group3_reset();			
						//datagrid3_lst_row = rowid;	
						datagrid3_lst_row = 1;	
						model.setValue("/root/reqData/searchData/clam_dept_cd",model.getValue("/root/resData/gridData/fc_acct_3256_l/dataSet/slip_list/record[" + row + "]/clam_dept_cd"));
						model.setValue("/root/reqData/searchData/pch_cgbuseonm",model.getValue("/root/resData/gridData/fc_acct_3256_l/dataSet/slip_list/record[" + row + "]/clam_dept_nm"));
						model.setValue("/root/reqData/searchData/incmg_emp_no",model.getValue("/root/resData/gridData/fc_acct_3256_l/dataSet/slip_list/record[" + row + "]/incmg_emp_no"));
						model.setValue("/root/reqData/searchData/pch_irjnm",model.getValue("/root/resData/gridData/fc_acct_3256_l/dataSet/slip_list/record[" + row + "]/incmg_emp_nm"));

						if(datagrid2.valueMatrix(1,3) != ""){ //group3 채우기
							model.setFocus("datagrid2",true);
							datagrid2.col = 3;
							fn_GridToForm(1);
							fn_background_color_setting("1");																	
						}				
						datagrid1.addRow(false);
						datagrid1.rowStatus(datagrid1.rows - 1) = 0;
						datagrid1.row = 1;	datagrid1.col= 1;
						
						// key save
						gvar_slip_occr_dt = srch_slip_occr_dt.value.Trim().ReplaceString("-", "");		// 입력일자
						gvar_slip_clsf_cd = srch_slip_clsf_cd.value.Trim().ReplaceString("-", "");		// 전표구분
						gvar_slip_seq = srch_slip_seq.value.Trim().ReplaceString("-", "");			// 일련번호
						gvar_slip_sub_seq = srch_slip_sub_seq.value.Trim().ReplaceString("-", "");	// SUBSEQ
						
						var var_ref = datagrid1.colRef("vat_amt");
						var orgStr = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_valuematrix");
						for (i=1; i<datagrid1.rows - 1; i++) {
							if(getProperty("ss_cmpycd") != "100" && instr_yn(orgStr, datagrid1.valueMatrix(i,2))){									
								datagrid1.valueMatrix(i, var_ref) = Number(datagrid1.valueMatrix(i,4)) +Number(datagrid1.valueMatrix(i,5));
							}
						}						
							
						//}
						
					}else{ 
					//init_setting();			// 기타 초기화
					model.setValue("/root/reqData/searchData/slip_occr_dt",commCurDate());
					model.setValue("/root/reqData/searchData/clam_dept_cd",getProperty("ss_deptcd"));
					model.setValue("/root/reqData/searchData/pch_cgbuseonm",getProperty("ss_deptnm"));
					model.setValue("/root/reqData/searchData/incmg_emp_no",getProperty("ss_emp_no"));
					model.setValue("/root/reqData/searchData/pch_irjnm",getProperty("ss_emp_nm"));
					model.setValue("/root/resData/resform/use_dept_cd",getProperty("ss_deptcd"));
					model.setValue("/root/resData/resform/pch_buseonm",getProperty("ss_deptnm"));
					model.setValue("/root/reqData/searchData/slip_clsf_cd","90"); 
					model.setValue("/root/reqData/searchData/slip_sub_seq","0"); //srch_slip_sub_seq.value = "0";				// SUBSEQ		
					datagrid3.valueMatrix(1,2) = commCurDate();	// 입력일자
					datagrid3.valueMatrix(1,6) = "90";	// 유형
					datagrid2.valueMatrix(1,1) = "000001"; //행번호초기화
					datagrid2.rowStatus(1) = "0"; //1->0으로 수정 20141021
					datagrid3.rowStatus(1) = "2";					
					
					var ctrl_emp_no = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_ss_emp_no");
					//if (getProperty("ss_emp_no") == "214013" || getProperty("ss_emp_no") == "213085" || getProperty("ss_emp_no") == "213086" || getProperty("ss_emp_no") == "213013"){ //20160525 봉은정추가
					if(instr_yn(ctrl_emp_no, getProperty("ss_emp_no"))){
						clam_dept_cd.disabled = true;
						incmg_emp_no.disabled = true;						
						button6.visible = false;
						if ( getProperty("ss_cmpycd") == "326"){
							btn_slip_print.visible = false;
						}else{
							btn_slip_print.visible = true;
						}
					}else{
						clam_dept_cd.disabled = false;
						incmg_emp_no.disabled = false;
						button6.visible = true;
						btn_slip_print.visible = true;
					}

					//삭제버튼 사용불가
					/*if (getProperty("ss_emp_no") == "213013"){ //20170110 봉은정추가
						btn_delete.disabled = true;
					}else{
						btn_delete.disabled = false;
					}*/
					
					model.refresh();
					}
				]]>
			</script>
			<submission id="fc_acct_3250_m" action="/fc/acct3000/3250" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/initData/comboSet/fc_acct_3250_m/dataSet"/>
			<submission id="fc_acct_3251_l" action="/fc/acct3000/3251" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/fc_acct_3251_l/dataSet"/>
			<submission id="fc_acct_3253_i" action="/fc/acct3000/3253" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fc_acct_3253_i" resultref="/root/resData/MsgData"/>
			<submission id="fc_acct_3254_u" action="/fc/acct3000/3254" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fc_acct_3254_u" resultref="/root/resData/MsgData"/>
			<submission id="fc_acct_3255_d" action="/fc/acct3000/3255" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fc_acct_3255_d" resultref="/root/resData/MsgData"/>
			<submission id="fc_acct_3256_l" action="/fc/acct3000/3256" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/fc_acct_3256_l/dataSet"/>
			<submission id="fc_acct_3257_a" action="/fc/acct3000/3257" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fc_acct_3257_a" resultref="/root/resData/MsgData"/>
			<bind id="tot_dr_amt" ref="/root/tempData2/tot_dr_amt" calculate="sum(/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record/dr_amt)"/>
			<bind id="tot_crdt_amt" ref="/root/tempData2/tot_crdt_amt" calculate="sum(/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record/crdt_amt)"/>
			<submission id="mc_co_1002_l" action="/mc/co1000/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resform2/dataSet"/>
		</model>
		<script type="javascript">
			<![CDATA[
				var	_oth_clsf = "1";
				// key
				var gvar_slip_occr_dt = "";		// 입력일자
				var gvar_slip_clsf_cd = "";		// 전표구분
				var gvar_slip_seq = "";		// 일련번호
				var gvar_slip_sub_seq = "";	// SUBSEQ
				var budg_mang_clsf_cd = "";		
				var gvar_evnt_check_flag = "N";
				
				var lst_row = 0;
				var datagrid3_lst_row = 1;
				
				function move_cursor() {
					var current_cur = model.getFocus();
					model.setFocus(current_cur,true);
					
				}

				function init_controls() {
	
					//control의 기본 설정 적용
	
					//datagrid init
					set_default(
							datagrid1
					);
					//combo init
					set_default(
							srch_slip_clsf_cd			// 전표구분
					);
					//input init
					set_default(
							srch_slip_seq			       // 일련번호
						,	srch_slip_sub_seq			// SUBSEQ
						,	pch_cgbuseonm			// 청구부서명
						,	pch_irjnm					// 입력자사번명
						,	rmks1					// 제목
						,	dr_amt_sum				// 차변합계
						,	crdt_amt_sum				// 대변합계
						,	incmg_dt					// 입력일자
						,	reso_amt					// 결의금액
					);
					//input button init
					set_default(
							clam_dept_cd				// 청구부서
						,	incmg_emp_no				// 입력자사번
					);
					//input date init
					set_default(
							srch_slip_occr_dt			// 입력일자
						,	fisc_dt					// 회계일자
					);

					//control format 설정 적용
					set_format(
							"code"
						,	datagrid1			,"1,2,9,10,13,15,16,17,18,20,24,28,32,36,37"
						,	clam_dept_cd				// 청구부서
						,	incmg_emp_no				// 입력자사번
					);
					set_format(
							"number1_2"
						,	datagrid1			,"33"
					);
					set_format(
							"number1_4"
						,	datagrid1			,"34"
					);
					set_format(
							"number4"
						,	datagrid1			,"4,5,27,31"
						,	dr_amt_sum				// 차변합계
						,	crdt_amt_sum				// 대변합계
						,	reso_amt					// 결의금액
					);
					set_format(
							"date_1"
						,	datagrid1			,"22,23,30"
                                             ,	srch_slip_occr_dt			// 입력일자
                                             ,	fisc_dt					// 회계일자
					);
					set_format(
							"string_c"
						,	datagrid1			,"35,44"
						,	srch_slip_seq				// 일련번호
						,	srch_slip_sub_seq			// SUBSEQ
					);
					set_format(
							"string_l"
						,	datagrid1			,"3,6,7,11,12,14,19,21,25,26,29,44"
						,	srch_slip_clsf_cd			// 전표구분
						,	pch_cgbuseonm			// 청구부서명
						,	pch_irjnm					// 입력자사번명
						,	rmks1					// 제목
					);
				}
				
				var reso_amt_var;
				
				// 콤보 셋팅
				function send_fc_acct_3250_m() {
					//입력값 설정
					set_refvalue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
					
					//실행
					model.send("fc_acct_3250_m");
					makeComboGubun("", "/root/initData/comboSet/fc_acct_3250_m/dataSet/CURLIST1", "record", "cdabrvnm_cd", "cd");		
					makeComboGubun("", "/root/initData/comboSet/fc_acct_3250_m/dataSet/CUR_INCM_CLSF_LIST", "record", "cd", "cd_nm");		
					makeComboGubun("", "/root/initData/comboSet/fc_acct_3250_m/dataSet/CURLIST3", "record", "cdnm_cd", "cd");	
					model.refresh();
				}
				
				// 기타 초기화
				function init_setting() {
					srch_slip_occr_dt.value = commCurDate();	// 입력일자
					srch_slip_sub_seq.value = "0";				// SUBSEQ
					
					datagrid1.addRow(false);
					datagrid1.rowStatus(datagrid1.rows - 1) = 0;
					datagrid1.row = 1;	datagrid1.col= 1;
					
					model.setFocus("srch_slip_occr_dt");
				}
				
				// 그리드 컬럼 합계
				function fn_grid_sum_value (p_obj, p_col, t_obj) {
					if (typeof(p_obj) != DATA_TYPE_OBJECT) {
						return;
					}
					if (typeof(t_obj) != DATA_TYPE_OBJECT) {
						return;
					}
					
					var pobj = eval(p_obj);
					var pcol = eval(p_col);
					var tobj = eval(t_obj);
					
					var var_sum = 0;
					
					for (i=1;i<=pobj.rows;i++) {
						var_sum = var_sum + Number(pobj.valueMatrix(i, pcol));
					}
					
					t_obj.value = var_sum;
				}
				
				// 청구부서 popup
				function setDept_cd(iv_dept_cd, iv_dept_nm, iv_dept_team_clsf, iv_offi_nm, iv_dept_team_nm, iv_part_nm, iv_part_dn_nm){	
					model.setValue("/root/reqData/searchData/clam_dept_cd", iv_dept_cd);
					model.setValue("/root/reqData/searchData/pch_cgbuseonm", iv_dept_nm);
					
					model.setValue("/root/resData/resform/use_dept_cd", iv_dept_cd);
					model.setValue("/root/resData/resform/pch_buseonm", iv_dept_nm);
					
					clam_dept_cd.refresh();
					pch_cgbuseonm.refresh();
					
					use_dept_cd.refresh();
					pch_buseonm.refresh();
					
					model.setFocus("clam_dept_cd",true);
				}
				
				// 사용부서 popup
				function use_setDept_cd(iv_dept_cd, iv_dept_nm, iv_dept_team_clsf, iv_offi_nm, iv_dept_team_nm, iv_part_nm, iv_part_dn_nm){	
					model.setValue("/root/resData/resform/use_dept_cd", iv_dept_cd);
					model.setValue("/root/resData/resform/pch_buseonm", iv_dept_nm);
					use_dept_cd.refresh();
					pch_buseonm.refresh();
					model.setFocus("use_dept_cd",true);
				}
				
				// 입력자사번 popup
				function setEmp_no(emp_no, nm_korn){
					incmg_emp_no.value = emp_no;		// 입력자사번
					pch_irjnm.value = nm_korn;			// 입력자사번명
				}

				function init_controls_2290() {	
					//control의 기본 설정 적용
					
					//combo init
					set_default(
							dlco_clsf_cd				// 거래처구분
						,	occr_slip_clsf				// 전사전표번호구분
						,	frcr_clsf_cd				// 외화구분코드
						,	note_stat					// 어음상태
						,	medi_cd					// 매체코드
					);
					//input init
					set_default(
							slip_arow_no			       // 행번호
						,	pch_sdysnm				// 예산코드명
						,	pch_buseonm				// 사용부서명
						,	dr_amt					// 차변금액
						,	crdt_amt					// 대변금액
						,	dlco_nm					// 거래처명
						,	intg_dlco_cd				// 통합거래처코드
						,	boks_dlco_nm				// 부거래처명
						,	mang_clsf_nm				// 관리구분명
						,	mang_no					// 관리번호
						,	pch_banknm				// 은행코드명
						,	dtls_medi_cd				// 상세매체
						,	pch_hsnm					// 행사코드명
						,	unit						// 단위
						,	qunt						// 수량
						,	rmks1					// 적요1
						,	rmks2					// 적요2
						,	pch_dsacctnm				// 대상계정명
						,	obj_amt					// 대상금액
						,	exrate					// 환율
						,	frcr_amt					// 외화금액
					);
					//input button init
					set_default(
							budg_cd					// 예산코드
						,	use_dept_cd				// 사용부서
						,	dlco_cd					// 거래처코드
						,	mang_clsf_cd				// 관리구분						
						,	bank_cd					// 은행코드
						,	prop_equip_cd				// 영수증구분
						,	evnt_cd					// 행사코드
						,	occr_slip					// 전사전표번호
						,	setoff_slip_no				// 상계전표번호
						,	obj_acct_cd				// 대상계정
					);
					//input date init
					set_default(
							comp_dt					// 기산일자
						,	mtry_dt					// 만기일자
						,	obj_dt					// 대상일자
					);

					//control format 설정 적용
					set_format(
							"code"
						,	use_dept_cd				// 사용부서
						,	frcr_clsf_cd				// 외화구분코드
						,	dlco_cd					// 거래처코드
						,	intg_dlco_cd				// 통합거래처코드
						,	bank_cd					// 은행코드
						,	prop_equip_cd				// 영수증구분
						,	evnt_cd					// 행사코드
						,	budg_cd					// 예산코드
						,	obj_acct_cd				// 대상계정
					);
					set_format(
							"number1_2"
						,	frcr_amt					// 외화금액
					);
					set_format(
							"number1_4"
						,	exrate					// 환율
					);
					set_format(
							"number4"
						,	dr_amt					// 차변금액
						,	crdt_amt					// 대변금액
						,	obj_amt					// 대상금액
						,	qunt						// 수량
					);
					set_format(
							"date_1"
						,	comp_dt					// 기산일자
						,	mtry_dt					// 만기일자
						,	obj_dt					// 대상일자   
					);
					set_format(
							"string_c"
						,	slip_arow_no			       // 행번호
					);
					set_format(
							"string_l"
						,	dlco_clsf_cd				// 거래처구분
						,	mang_clsf_cd				// 관리구분
						,	medi_cd					// 매체코드
						,	occr_slip_clsf				// 전사전표번호구분
						,	note_stat					// 어음상태
						,	pch_sdysnm				// 예산코드명
						,	pch_buseonm				// 사용부서명
						,	dlco_nm					// 거래처명
						,	boks_dlco_nm				// 부거래처명
						,	mang_no					// 관리번호
						,	pch_banknm				// 은행코드명
						,	dtls_medi_cd				// 상세매체
						,	pch_hsnm					// 행사코드명
						,	unit						// 단위
						,	rmks1					// 적요1
						,	rmks2					// 적요2
						,	pch_dsacctnm				// 대상계정명
						,	occr_slip					// 전사전표번호
						,	setoff_slip_no				// 상계전표번호
					);
				}

				// 그리드의 내용을 폼에 셋팅
				function fn_GridToForm(iv_Row) {
					// 모화면의 커서를 첫컬럼으로 이동
					//datagrid2.row = iv_Row;
					//datagrid2.col = 1;
					fun_budg_cd_ch();
					// 행번호 셋팅
					set_refvalue("/root/resData/resform/slip_arow_no",datagrid2.valueMatrix(iv_Row, 1));	// 행번호
					set_refvalue("/root/resData/resform/budg_cd",datagrid2.valueMatrix(iv_Row, 3));			// 예산코드					
					set_refvalue("/root/resData/resform/pch_sdysnm",datagrid2.valueMatrix(iv_Row, 4));		// 예산코드명
					set_refvalue("/root/resData/resform/use_dept_cd",datagrid2.valueMatrix(iv_Row, 20));		// 사용부서
					set_refvalue("/root/resData/resform/pch_buseonm",datagrid2.valueMatrix(iv_Row, 21));		// 사용부서
					set_refvalue("/root/resData/resform/dr_amt",datagrid2.valueMatrix(iv_Row, 8));				// 차변금액
					set_refvalue("/root/resData/resform/crdt_amt",datagrid2.valueMatrix(iv_Row, 9));			// 대변금액
					set_refvalue("/root/resData/resform/dlco_clsf_cd",datagrid2.valueMatrix(iv_Row, 12));			// 거래처구분
					set_refvalue("/root/resData/resform/dlco_cd",datagrid2.valueMatrix(iv_Row, 5));			// 거래처코드
					set_refvalue("/root/resData/resform/dlco_nm",datagrid2.valueMatrix(iv_Row, 6));			// 거래처명
					set_refvalue("/root/resData/resform/intg_dlco_cd",datagrid2.valueMatrix(iv_Row, 36));		// 통합거래처코드
					set_refvalue("/root/resData/resform/boks_dlco_nm",datagrid2.valueMatrix(iv_Row, 7));		// 부거래처명
					set_refvalue("/root/resData/resform/mang_clsf_cd",datagrid2.valueMatrix(iv_Row, 13));		// 관리구분					
					set_refvalue("/root/resData/resform/mang_no",datagrid2.valueMatrix(iv_Row, 14));			// 관리번호
					set_refvalue("/root/resData/resform/incm_clsf_cd",datagrid2.valueMatrix(iv_Row, 15));		// 소득구분
					set_refvalue("/root/resData/resform/bank_cd",datagrid2.valueMatrix(iv_Row, 24));			// 은행코드
					set_refvalue("/root/resData/resform/pch_banknm",datagrid2.valueMatrix(iv_Row, 25));		// 은행코드명
					set_refvalue("/root/resData/resform/prop_equip_cd",datagrid2.valueMatrix(iv_Row, 37));		// 영수증구분
					set_refvalue("/root/resData/resform/medi_cd",datagrid2.valueMatrix(iv_Row, 16));			// 매체코드
					set_refvalue("/root/resData/resform/dtls_medi_cd",datagrid2.valueMatrix(iv_Row, 17));		// 상세매체코드
					set_refvalue("/root/resData/resform/evnt_cd",datagrid2.valueMatrix(iv_Row, 18));			// 행사코드
					set_refvalue("/root/resData/resform/pch_hsnm",datagrid2.valueMatrix(iv_Row, 19));			// 행사코드명
					set_refvalue("/root/resData/resform/unit",datagrid2.valueMatrix(iv_Row, 26));				// 단위
					set_refvalue("/root/resData/resform/comp_dt",datagrid2.valueMatrix(iv_Row, 22));			// 기산일자
					set_refvalue("/root/resData/resform/mtry_dt",datagrid2.valueMatrix(iv_Row, 23));			// 만기일자
					set_refvalue("/root/resData/resform/qunt",datagrid2.valueMatrix(iv_Row, 27));				// 수량
					set_refvalue("/root/resData/resform/occr_slip_clsf",datagrid2.valueMatrix(iv_Row, 44));		// 전사전표구분
					set_refvalue("/root/resData/resform/occr_slip",datagrid2.valueMatrix(iv_Row, 45));			// 전사전표번호
					set_refvalue("/root/resData/resform/setoff_slip_no",datagrid2.valueMatrix(iv_Row, 43));		// 상계전표번호
					set_refvalue("/root/resData/resform/rmks1",datagrid2.valueMatrix(iv_Row, 11));				// 적요1
					set_refvalue("/root/resData/resform/rmks2",datagrid2.valueMatrix(iv_Row, 10));				// 적요2
					set_refvalue("/root/resData/resform/obj_acct_cd",datagrid2.valueMatrix(iv_Row, 28));		// 대상계정
					set_refvalue("/root/resData/resform/pch_dsacctnm",datagrid2.valueMatrix(iv_Row, 29));		// 대상계정명
					set_refvalue("/root/resData/resform/obj_dt",datagrid2.valueMatrix(iv_Row, 30));				// 대상일자
					set_refvalue("/root/resData/resform/obj_amt",datagrid2.valueMatrix(iv_Row, 31));			// 대상금액
					set_refvalue("/root/resData/resform/note_stat",datagrid2.valueMatrix(iv_Row, 35));			// 어음상태
					set_refvalue("/root/resData/resform/frcr_clsf_cd",datagrid2.valueMatrix(iv_Row, 32));			// 외화구분코드
					set_refvalue("/root/resData/resform/exrate",datagrid2.valueMatrix(iv_Row, 34));				// 환율
					set_refvalue("/root/resData/resform/frcr_amt",datagrid2.valueMatrix(iv_Row, 33));			// 외화금액
					set_refvalue("/root/resData/resform/prof_type_cd",datagrid2.valueMatrix(iv_Row, 39).substring(0, 2));		//  39.세금계산서번호 
					set_refvalue("/root/resData/resform/occr_slip_clsf_cd",datagrid2.valueMatrix(iv_Row, 39).substring(2, 4));		//  39.세금계산서번호 
					set_refvalue("/root/resData/resform/occr_slip_occr_dt",datagrid2.valueMatrix(iv_Row, 39).substring(4, 12));	//  39.세금계산서번호 
					set_refvalue("/root/resData/resform/occr_slip_seq",datagrid2.valueMatrix(iv_Row, 39).substring(12, 20));		//  39.세금계산서번호 

					set_refvalue("/root/resData/resform/erplace_cd",datagrid2.valueMatrix(iv_Row, 41));						//  41.사업장코드
					set_refvalue("/root/resData/resform/make_dt",datagrid2.valueMatrix(iv_Row, 40));						//  40.작성일자
					set_refvalue("/root/resData/resform/etc_in",datagrid2.valueMatrix(iv_Row, 38));							//  38.잡수익
					set_refvalue("/root/resData/resform/ern",datagrid2.valueMatrix(iv_Row, 42));							//  42.공급자번호

					set_refvalue("/root/resData/resform/suply_amt",datagrid2.valueMatrix(iv_Row, 52));						//  52.공급가액
					set_refvalue("/root/resData/resform/mang_clsf_nm",datagrid2.valueMatrix(iv_Row, 53));						//  52.공급가액
					set_refvalue("/root/resData/resform/vat_amt",datagrid2.valueMatrix(iv_Row, 51));						//  51.부가세액
					set_refvalue("/root/resData/resform/email_id",datagrid2.valueMatrix(iv_Row, 54));						//  51.부가세액
					set_refvalue("/root/resData/resform/remk",datagrid2.valueMatrix(iv_Row, 55));						//  51.부가세액
					set_refvalue("/root/resData/resform/item",datagrid2.valueMatrix(iv_Row, 56));						//  51.부가세액
					set_refvalue("/root/resData/resform/re_issu_resn_cd",datagrid2.valueMatrix(iv_Row, 57));						//  51.부가세액
				}
				
				function fun_vat_budg_cd_ch(){
					model.setValue("/root/resData/resform/prof_type_cd","");
					model.setValue("/root/resData/resform/occr_slip_clsf_cd","");
					model.setValue("/root/resData/resform/occr_slip_occr_dt","");
					model.setValue("/root/resData/resform/occr_slip_seq","");
					model.setValue("/root/resData/resform/erplace_cd","");
					model.setValue("/root/resData/resform/make_dt","");
					model.setValue("/root/resData/resform/etc_in","");
					model.setValue("/root/resData/resform/ern","");
					model.setValue("/root/resData/resform/suply_amt","");
					prof_type_cd.attribute("background-color") = "white";
					occr_slip_clsf_cd.attribute("background-color") = "white";
					occr_slip_occr_dt.attribute("background-color") = "white";
					occr_slip_seq.attribute("background-color") = "white";
					erplace_cd.attribute("background-color") = "white";
					make_dt.attribute("background-color") = "white";
					ern.attribute("background-color") = "white";
					suply_amt.attribute("background-color") = "white";
					group2.disabled = true;
				}

				function fun_budg_cd_ch(){	
					var row = datagrid2.row;
					var col = datagrid2.col;					
					var ch_var = datagrid2.valueMatrix(row,3);	
					if(ch_var == "182000" || ch_var == "462000"){
						prof_type_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						occr_slip_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						occr_slip_occr_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
						occr_slip_seq.attribute("background-color") = DEFAULT_COLOR_REQ;
						erplace_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						make_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
						ern.attribute("background-color") = DEFAULT_COLOR_REQ;
						suply_amt.attribute("background-color") = DEFAULT_COLOR_REQ;
						group2.disabled = false;
					}else{ 
						model.setValue("/root/resData/resform/prof_type_cd","");
						model.setValue("/root/resData/resform/occr_slip_clsf_cd","");
						model.setValue("/root/resData/resform/occr_slip_occr_dt","");
						model.setValue("/root/resData/resform/occr_slip_seq","");
						model.setValue("/root/resData/resform/erplace_cd","");
						model.setValue("/root/resData/resform/make_dt","");
						model.setValue("/root/resData/resform/etc_in","");
						model.setValue("/root/resData/resform/ern","");
						model.setValue("/root/resData/resform/suply_amt","");
						prof_type_cd.attribute("background-color") = "white";
						occr_slip_clsf_cd.attribute("background-color") = "white";
						occr_slip_occr_dt.attribute("background-color") = "white";
						occr_slip_seq.attribute("background-color") = "white";
						erplace_cd.attribute("background-color") = "white";
						make_dt.attribute("background-color") = "white";
						ern.attribute("background-color") = "white";
						suply_amt.attribute("background-color") = "white";
						group2.disabled = true;
					}
				}
				
				function send_fc_acct_2290_m() {
					//입력값 설정
					var row = datagrid2.row;
					set_refvalue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
					set_refvalue("/root/reqData/searchData/budg_cd",datagrid2.valueMatrix(row,3));				
					//실행
					model.send("fc_acct_2290_m", false);
					//데이터 설정
					//전체항목 추가
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/NOTE_STAT_CURLIST", "record", "cdabrvnm_cd", "cd")
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/DLCO_CLSF_CD_CURLIST", "record", "cdabrvnm_cd", "cd")
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/SLIP_CLSF_CURLIST", "record", "cdabrvnm_cd", "cd")
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/SLIP_CLSF_CURLIST", "record", "cdabrvnm_cd", "cd")
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/FRCR_CLSF_CURLIST", "record", "cdabrvnm_cd", "cd")
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/MANG_CLSF_CURLIST", "record", "cdabrvnm_cd", "cd")	
				}
				
				var gstr_popupid = "";
				// 팝업
				
				function setEvntInfo(Evnt_cd, Evnt_cd_nm, Etc1, Etc2, Etc3, Etc4, Etc5, Etc6){
					// 행사코드 팝업
					if (gstr_popupid == "evnt_cd") {
						evnt_cd.value = Evnt_cd;
						pch_hsnm.value = Evnt_cd_nm;
					}
					// 예산코드 팝업
					if (gstr_popupid == "budg_cd") {
						budg_cd.value = Evnt_cd;
						pch_sdysnm.value = Evnt_cd_nm;
					}
					// 대상계정 팝업
					if (gstr_popupid == "obj_acct_cd") {
						obj_acct_cd.value = Evnt_cd;
						pch_dsacctnm.value = Evnt_cd_nm;
					}
					if (gstr_popupid == "dtls_medi_cd") {
						dtls_medi_cd.value =  Evnt_cd;						
					}
					if (gstr_popupid == "eenosb") {
						datagrid2.valueMatrix(datagrid2.row,9) = Etc1;
						bank_cd.value =Etc2;
						mang_clsf_cd.value = Evnt_cd_nm;	
						mang_no.value = Evnt_cd;
						mtry_dt.value =Etc3;						
						note_stat.value =Etc4;		
						datagrid2.valueMatrix(datagrid2.row,5) =Etc5;
						datagrid2.valueMatrix(datagrid2.row,6) =Etc6;
					}
				}
				
				function open_fc_acct_1180(p_where,p_mode,p_title,p_readonly,p_to) {
					var col = datagrid2.col;
					var row = datagrid2.row;
					
					var need_popup = true;
					var rcvs_flag = false;
	
					var popid = "fc_acct_1180";
					var subid = "fc_acct_1181_l";
					
					
					p_where = p_where.toUpperCase();
					
					//검색조건이 모두 충족하지 않으면 종료한다.
					if (gstr_popupid == "ern") { // 공급자번호
						if (p_where == "FOCUS" && (ern.value.Trim() == "")) {
							return rcvs_flag;
						}				
					}else{
						if (p_where == "FOCUS" && (dlco_clsf_cd.value.Trim() == "" || dlco_cd.value.Trim() == "")) {
							dlco_nm.value	= "";
							intg_dlco_cd.value = "";
							reset_refnode(get_popup_rcvs_ref(popid));
							return rcvs_flag;
						}
					}
					
					////버튼클릭으로 이벤트가 발생하기 전에
					////value-changed 이벤트가 먼저 발생한 경우
					////input button의 내부 버튼이 클릭됐는지 여부를 확인한다.
					//if (check_dup_input_event()) {					
					//	return rcvs_flag;
					//}
					set_popup_send_data(popid		,"mode"			,p_mode			);
					set_popup_send_data(popid		,"title"			,p_title			);
					if (gstr_popupid == "ern") { // 공급자번호
						set_popup_send_data(popid		,"clsf_cd"			,"93"	);
						set_popup_send_data(popid		,"cd_f"			,ern.value		);
						set_popup_send_data(popid		,"cd_t"			,ern.value		);
	//					set_popup_send_data(popid		,"cd_abrv_nm"		,ern.value		);
					}else if (gstr_popupid == "dtls_medi_cd") { // 사원
						set_popup_send_data(popid		,"clsf_cd"			,"91"	);
						set_popup_send_data(popid		,"cd_f"			,dtls_medi_cd.value		);
						set_popup_send_data(popid		,"cd_t"			,dtls_medi_cd.value		);
	//					set_popup_send_data(popid		,"cd_abrv_nm"		,ern.value		);
					}else{
						set_popup_send_data(popid		,"readonly"		,p_readonly		);
						set_popup_send_data(popid		,"clsf_cd"			,dlco_clsf_cd.value	);
						set_popup_send_data(popid		,"cd_f"			,dlco_cd.value		);
						set_popup_send_data(popid		,"cd_t"			,dlco_cd.value		);
						//set_popup_send_data(popid		,"cd_abrv_nm"		,dlco_cd.value		);
						set_popup_send_data(popid		,"cd_abrv_nm"		,""				);
					}

					//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
					if (p_where == "FOCUS") {
						//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
						//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
						model.removenode(get_popup_rcvs_ref(popid));
						//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
						model.makeNode(get_popup_rcvs_ref(popid));
						
						//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
						send_submission(
								"auto_" + subid
							,	get_popup_send_ref(popid)
							,	get_popup_rcvs_ref(subid) + "/dataSet"
							,	"/fc/acct1000/1181"
							,	"urlencoded-post"
							,	"application/x-www-form-urlencoded"
						);
						
						totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
						if (totalcnt == 1) {
							//데이터가 1건이고 focus out에서 호출한 경우
							//데이터를 설정하고 나간다.
	
							//model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							//return;
							need_popup = false;
							rcvs_flag = true;
						}
						else if (totalcnt == 0) {
							//show_message("거래처코드의 검색결과가 없습니다.");
							//return;
							need_popup = false;	
							rcvs_flag = false;
						}
						else {
							//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
							//만약 1건 이상인 경우 popup을 호출해 달라고 하면
							//return을 지우면 됨
							//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
							//return;
							need_popup = true;
						}
					}
					
					//버튼클릭으로 이벤트가 발생하기 전에
					//value-changed 이벤트가 먼저 발생한 경우
					//input button의 내부 버튼이 클릭됐는지 여부를 확인한다.
					if (check_dup_input_event()) {			
						return rcvs_flag;
					}
					
					//그외 버튼인 경우는 계속 진행
					if (need_popup) {
						rcvs_flag = open_popup(popid,"640");
					}
					
					if (gstr_popupid == "ern") { // 공급자번호

	//					if (get_popp_rcvs_data(popid,"clsf_cd") != "")			recp_pers_clsf.value		=	get_popup_rcvs_data(popid,"clsf_cd");
						if (get_popup_rcvs_data(popid,"cd") == "104-81-24695") {
							//ern.value = "";
							datagrid2.valueMatrix(row,42) = "";
						}
						else {
							if (get_popup_rcvs_data(popid,"cd") != "")				//ern.value		=	get_popup_rcvs_data(popid,"cd");
																					datagrid2.valueMatrix(row,42) = get_popup_rcvs_data(popid,"cd");
							if (get_popup_rcvs_data(popid,"cd") == "") {
								//boks_dlco_nm.value = "";
								datagrid2.valueMatrix(row,7) = "";
							}
							else {
								if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		//boks_dlco_nm.value		=	get_popup_rcvs_data(popid,"cd_abrv_nm");
																						datagrid2.valueMatrix(row,7) = get_popup_rcvs_data(popid,"cd_abrv_nm");
							}
						}
						//그외의 값은 지워지도록 한다.
						//if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
						//pay_bank_cd_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					}else if (gstr_popupid == "dtls_medi_cd") { // 공급자번호

						if (get_popup_rcvs_data(popid,"cd") != "")				//dtls_medi_cd.value		=	get_popup_rcvs_data(popid,"cd");
																				datagrid2.valueMatrix(row,17) = get_popup_rcvs_data(popid,"cd");
							/*
							if (get_popup_rcvs_data(popid,"cd") == "") {
								boks_dlco_nm.value = "";
							}
							else {
								if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		boks_dlco_nm.value		=	get_popup_rcvs_data(popid,"cd_abrv_nm");
							}*/
						
						//그외의 값은 지워지도록 한다.
						//if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
						//pay_bank_cd_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					}else{
						//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
						//다시 조회 하기 쉽도록 하고
						//if (get_popup_rcvs_data(popid,"clsf_cd") != "")			dlco_clsf_cd.value		=	get_popup_rcvs_data(popid,"clsf_cd");
						if (get_popup_rcvs_data(popid,"clsf_cd") != "")			datagrid2.valueMatrix(row,12) = get_popup_rcvs_data(popid,"clsf_cd");
						if (get_popup_rcvs_data(popid,"cd") != "")				datagrid2.valueMatrix(row,5)  =	get_popup_rcvs_data(popid,"cd");
						//if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
						//if (get_popup_rcvs_data(popid,"intg_cd") != "")			intg_dlco_cd.value		=	get_popup_rcvs_data(popid,"intg_cd");
						//그외의 값은 지워지도록 한다.
						//dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
						//dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
						//intg_dlco_cd.value		=	get_popup_rcvs_data(popid,"intg_cd");
						//alert(get_popup_rcvs_data(popid,"cd"));
						//datagrid2.valueMatrix(row,5)	=	get_popup_rcvs_data(popid,"cd");
						datagrid2.valueMatrix(row,6)	=	get_popup_rcvs_data(popid,"cd_abrv_nm");
						datagrid2.valueMatrix(row,36)	=	get_popup_rcvs_data(popid,"intg_cd");
						datagrid2.valueMatrix(row,54)	=	get_popup_rcvs_data(popid,"email");
						
						//datagrid2.refresh();
						reset_popup_send_data(popid);	
					}
						
					return rcvs_flag;
				}
				// 예산별관리항목별로 필수색 셋팅
				function fn_background_color_setting(rv_drcr_clsf) {
					var var_drcr_clsf = "";			// 차대구분
					var row = datagrid2.row;
					var col = datagrid2.col;
					
					//20180816 봉은정추가
					var drcr_clsf =""; 
					if ( datagrid2.valueMatrix(row,8) == 0 ){
						drcr_clsf = "9";
					}else{
						drcr_clsf = "1";
					}
					
					// 모든 컨트롤의 backcolor를 기본색으로 설정  
					use_dept_cd.attribute("background-color") = DEFAULT_COLOR_REQ;     	// 사용부서    
					boks_dlco_nm.attribute("background-color") = "white";    				// 부거래처명  
					mang_clsf_cd.attribute("background-color") = "white";    				// 관리구분    
					mang_no.attribute("background-color") = "white";         				// 관리번호    
					bank_cd.attribute("background-color") = "white";         				// 은행코드    
					prop_equip_cd.attribute("background-color") = "white";   				// 영수증구분  
					medi_cd.attribute("background-color") = "white";         				// 매체코드    
					dtls_medi_cd.attribute("background-color") = "white";    				// 상세매체    
					evnt_cd.attribute("background-color") = "white";         				// 행사코드    
					unit.attribute("background-color") = "white";            					// 단위        
					comp_dt.attribute("background-color") = "white";         				// 기산일자    
					mtry_dt.attribute("background-color") = "white";         					// 만기일자    
					qunt.attribute("background-color") = "white";            					// 수량        
					occr_slip_clsf.attribute("background-color") = "white";  				// 전사전표구분
					occr_slip.attribute("background-color") = "white";       				// 전사전표번호
					setoff_slip_no.attribute("background-color") = "white";  				// 상계전표번호
					rmks2.attribute("background-color") = "white";           				// 적요2       
					obj_acct_cd.attribute("background-color") = "white";     				// 대상계정    
					obj_dt.attribute("background-color") = "white";          					// 대상일자    
					obj_amt.attribute("background-color") = "white";         				// 대상금액    
					note_stat.attribute("background-color") = "white";       				// 어음상태    
					frcr_clsf_cd.attribute("background-color") = "white";    				// 외화구분코드
					exrate.attribute("background-color") = "white";          					// 환율        
					frcr_amt.attribute("background-color") = "white";        					// 외화금액    
					
					// 예산별관리항목(화면 색상을 지정하기 위함)

					//입력값 설정
					set_refvalue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
					set_refvalue("/root/reqData/searchData/budg_cd", datagrid2.valueMatrix(row,3));
					//실행
					if (gvar_evnt_check_flag != "N") {
						model.copyNode( "/root/resData/fc_acct_2291_s/dataSet/CUR_MANG_ITEM_CD_LIST", "/root/initData/comboSet/fc_acct_2290_m/dataSet/CUR_MANG_ITEM_CD_LIST");
					}
					else{			;
						model.send("fc_acct_2291_s");
					}
					//var_drcr_clsf = rv_drcr_clsf;	// 차대구분	
					var_drcr_clsf = drcr_clsf; //20180816 봉은정추가
					if ((datagrid2.valueMatrix(row,3) == "182000" && datagrid2.valueMatrix(row,9) != 0) || (datagrid2.valueMatrix(row,3) == "462000" && datagrid2.valueMatrix(row,8) != 0)){									
						fun_vat_budg_cd_ch();
					}
					
					// 각 CONTROL 색상 지정
					for (var i = 1; i <= Number(model.getValue("/root/resData/fc_acct_2291_s/dataSet/CUR_MANG_ITEM_CD_LIST/totalcnt")); i++) {
						if (model.getValue("/root/resData/fc_acct_2291_s/dataSet/CUR_MANG_ITEM_CD_LIST/record[" + i + "]/drcr_clsf") == ""
						|| model.getValue("/root/resData/fc_acct_2291_s/dataSet/CUR_MANG_ITEM_CD_LIST/record[" + i + "]/drcr_clsf") == var_drcr_clsf ) {
							switch (model.getValue("/root/resData/fc_acct_2291_s/dataSet/CUR_MANG_ITEM_CD_LIST/record[" + i + "]/mang_item_cd")) {
								//case "02" :	// 주거래처
									//dlco_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									//dlco_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									//break;
								case "03" :  	// 매체
									medi_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "04" :  	// 부거래처명
									boks_dlco_nm.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "05" :  	// 관리구분
									mang_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "06" :  	// 관리번호
									mang_no.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "09" :  	// 지급은행
									bank_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;									
								case "12" :  	// 대상계정코드
									if ((datagrid2.valueMatrix(row,3) == "182000" && datagrid2.valueMatrix(row,9) != 0) || (datagrid2.valueMatrix(row,3) == "462000" && datagrid2.valueMatrix(row,8) != 0)){									
										obj_acct_cd.attribute("background-color") = "white"; 
									}else{
										obj_acct_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									}
									break;
								case "13" :  	// 단위
									unit.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "17" :  	// 기산일
									if (datagrid2.valueMatrix(row,3) == "050100" && datagrid2.valueMatrix(row,8) == 0){
										comp_dt.attribute("background-color") = "white";      
									}else{
										comp_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
									}
									break;
								case "18" :  	// 만기일
									mtry_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "19" :  	// 대상일자									
									obj_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "20" :  	// 대상금액
									if ((datagrid2.valueMatrix(row,3) == "182000" && datagrid2.valueMatrix(row,9) != 0)|| (datagrid2.valueMatrix(row,3) == "462000" && datagrid2.valueMatrix(row,8) != 0)){
										obj_amt.attribute("background-color") = "white"; 
									}else{
										obj_amt.attribute("background-color") = DEFAULT_COLOR_REQ;
									}
									break;
								case "31" :  	// 수량
									qunt.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "34" :  	// 상세매체코드
									dtls_medi_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "35" : 	// 행사코드
									evnt_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								case "36" : 	// 영수증구분
									prop_equip_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									break;
								default :
							}
							
						}
						
					}
					
				}
				// 예산코드에 따른 거래처구분, 관리구분 콤보 셋팅
				function fn_dlco_mang_clsf_setting() {
	
					var var_dlco_clsf_cd = "";		// 거래처구분
					var var_dlco_cd = "";			// 거래처코드
					var var_dlco_nm = "";			// 거래처명
					var var_intg_dlco_cd = "";		// 통합거래처코드
					var var_mang_clsf_cd = "";		// 관리구분코드
					var row = datagrid2.row;
					var budg_cd = datagrid2.valueMatrix(row,3);
	
					// 거래처구분 combo list 채움
					var_dlco_clsf_cd = datagrid2.valueMatrix(row,12);		// 거래처구분
					var_dlco_cd = datagrid2.valueMatrix(row,5);				// 거래처코드
					var_dlco_nm = datagrid2.valueMatrix(row,6);				// 거래처명
					var_intg_dlco_cd = datagrid2.valueMatrix(row,36);		// 통합거래처코드
					
					// 관리구분 combo list 채움
					var_mang_clsf_cd = datagrid2.valueMatrix(row,13);		// 관리구분코드
					
					//입력값 설정
					set_refvalue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
					set_refvalue("/root/reqData/searchData/budg_cd", budg_cd);

					//실행
					if (gvar_evnt_check_flag != "N") {
						model.copyNode( "/root/resData/fc_acct_2292_s/dataSet/CUR_DLCO_CLSF_LIST", "/root/initData/comboSet/fc_acct_2290_m/dataSet/CUR_DLCO_CLSF_LIST");
						model.copyNode( "/root/resData/fc_acct_2292_s/dataSet/CUR_BUDGMANGCD_LIST", "/root/initData/comboSet/fc_acct_2290_m/dataSet/CUR_BUDGMANGCD_LIST");
					}
					else{							
						model.send("fc_acct_2292_s");
					}					
					
					model.removeNodeset("/root/initData/comboSet/fc_acct_2290_m/dataSet/DLCO_CLSF_CD_CURLIST/record");
					model.removeNodeset("/root/initData/comboSet/fc_acct_2290_m/dataSet/MANG_CLSF_CURLIST/record");
					model.copyNode("/root/initData/comboSet/fc_acct_2290_m/dataSet/DLCO_CLSF_CD_CURLIST", "/root/resData/fc_acct_2292_s/dataSet/CUR_DLCO_CLSF_LIST");
					model.copyNode("/root/initData/comboSet/fc_acct_2290_m/dataSet/MANG_CLSF_CURLIST", "/root/resData/fc_acct_2292_s/dataSet/CUR_BUDGMANGCD_LIST");
					
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/DLCO_CLSF_CD_CURLIST", "record", "cdabrvnm_cd", "cd")
					makeComboGubun("", "/root/initData/comboSet/fc_acct_2290_m/dataSet/MANG_CLSF_CURLIST", "record", "cdabrvnm_cd", "cd")
					
					mang_clsf_cd.value = var_mang_clsf_cd;

					budg_mang_clsf_cd = get_refvalue("/root/resData/fc_acct_2292_s/dataSet/CUR_BUDGMANGCD_LIST/record/cd");

					model.refresh();
				}
				var btnclickchk = "";
				
				
				function open_fc_co_8010(p_where,p_mode,p_title,p_readonly,p_to,p_job_clsf,p_cd_clsf) {
					var need_popup = true;
					var rcvs_flag = false;
					
					//검색조건이 모두 충족하지 않으면 종료한다.
					if (p_where == "FOCUS" && medi_cd.value.Trim() == "") {
						pch_mcnm.value	= "";
						return rcvs_flag;
					}
					
					p_where = p_where.toUpperCase();
					
					var popid = "fc_co_8010";
					var subid = "fc_co_8010_l";
	
					set_popup_send_data(popid		,"mode"			,p_mode			);
					set_popup_send_data(popid		,"title"			,p_title			);
					set_popup_send_data(popid		,"readonly"		,p_readonly		);
					set_popup_send_data(popid		,"job_clsf"			,p_job_clsf		);
					set_popup_send_data(popid		,"cd_clsf"			,p_cd_clsf			);
					set_popup_send_data(popid		,"cd"				,medi_cd.value		);
					set_popup_send_data(popid		,"cd_abrv_nm"		,""				);
					
					model.removenode(get_popup_rcvs_ref(popid));
					model.makeNode(get_popup_rcvs_ref(popid));
					
					//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
					if (p_where == "FOCUS") {
						
						//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
						send_submission(
								"auto_" + subid
							,	get_popup_send_ref(popid)
							,	get_popup_rcvs_ref(subid) + "/dataSet"
							,	"/fc/co8000/8011"
							,	"urlencoded-post"
							,	"application/x-www-form-urlencoded"
						);
						
						totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
				
						if (totalcnt == 1) {
							//데이터가 1건이고 focus out에서 호출한 경우
							//데이터를 설정하고 나간다.
	
							model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							need_popup = false;
							rcvs_flag = true;
						}
						else if (totalcnt == 0) {
							need_popup = false;	
							rcvs_flag = false;					
						}
						else {
							//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
							//만약 1건 이상인 경우 popup을 호출해 달라고 하면
							//return을 지우면 됨
							//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
							//return;
							need_popup = true;
						}
					}
					
					//그외 버튼인 경우는 계속 진행
					if (need_popup) {
						rcvs_flag = open_popup(popid,"640");
					}
	
					set_refvalue("/root/tempData/medi_ch", get_popup_rcvs_data(popid,"mang_cd_2"));
					
					reset_popup_send_data(popid);
					
					return rcvs_flag;
				}

				function fn_FormToGrid(row_id, iv_X) {
					var var_suply_amt = 0;
					     
					//alert(row_id);
					// 차대구분
					if (Number(datagrid2.valueMatrix(row_id, 8).Trim()) != 0) {
						datagrid2.valueMatrix(row_id, 2)  = "1";     
					}
					else {
						datagrid2.valueMatrix(row_id, 2)  = "9";             		// 대변
					}
					datagrid2.rowStatus(row_id) = "1";
					
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/boks_dlco_nm", model.getValue("/root/resData/resform/boks_dlco_nm"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/mang_clsf_cd", model.getValue("/root/resData/resform/mang_clsf_cd"));		
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/mang_clsf_nm", model.getValue("/root/resData/resform/mang_clsf_nm"));		
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/mang_no", model.getValue("/root/resData/resform/mang_no"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/incm_clsf_cd", model.getValue("/root/resData/resform/incm_clsf_cd"));
					var budg_cd = datagrid2.valueMatrix(row_id, 3);					
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/medi_cd", model.getValue("/root/resData/resform/medi_cd"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/dtls_medi_cd", model.getValue("/root/resData/resform/dtls_medi_cd"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/evnt_cd", model.getValue("/root/resData/resform/evnt_cd"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/pch_hsnm", model.getValue("/root/resData/resform/pch_hsnm"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/use_dept_cd", model.getValue("/root/resData/resform/use_dept_cd"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/pch_buseonm", model.getValue("/root/resData/resform/pch_buseonm"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/comp_dt", model.getValue("/root/resData/resform/comp_dt"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/mtry_dt", model.getValue("/root/resData/resform/mtry_dt"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/bank_cd", model.getValue("/root/resData/resform/bank_cd"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/pch_banknm", model.getValue("/root/resData/resform/pch_banknm"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/unit", model.getValue("/root/resData/resform/unit"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/qunt", model.getValue("/root/resData/resform/qunt"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/obj_acct_cd", model.getValue("/root/resData/resform/obj_acct_cd"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/pch_dsacctnm", model.getValue("/root/resData/resform/pch_dsacctnm"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/obj_dt", model.getValue("/root/resData/resform/obj_dt"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/obj_amt", model.getValue("/root/resData/resform/obj_amt"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/frcr_clsf_cd", model.getValue("/root/resData/resform/frcr_clsf_cd"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/frcr_amt", model.getValue("/root/resData/resform/frcr_amt"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/exrate", model.getValue("/root/resData/resform/exrate"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/note_stat", model.getValue("/root/resData/resform/note_stat"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/prop_equip_cd", model.getValue("/root/resData/resform/prop_equip_cd"));

					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/etc_in", model.getValue("/root/resData/resform/etc_in"));
					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/tax_stmt_no", prof_type_cd.value.substring(0, 2) + occr_slip_clsf_cd.value + occr_slip_occr_dt.value.ReplaceString("-", "") + occr_slip_seq.value);
					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/make_dt", model.getValue("/root/resData/resform/make_dt"));
					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/erplace_cd", model.getValue("/root/resData/resform/erplace_cd"));
					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/ern", model.getValue("/root/resData/resform/ern"));

					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/setoff_slip_no", model.getValue("/root/resData/resform/setoff_slip_no"));
					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/occr_slip_clsf", model.getValue("/root/resData/resform/occr_slip_clsf"));
					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/occr_slip", model.getValue("/root/resData/resform/occr_slip"));
					
					if( budg_cd == "182000" || budg_cd == "462000"){
						// 52.공급가액						
						//var vat_ = Number(datagrid2.valueMatrix(row_id,8))+Number(datagrid2.valueMatrix(row_id,9));
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/etc_in", model.getValue("/root/resData/resform/etc_in"));
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/tax_stmt_no", prof_type_cd.value.substring(0, 2) + occr_slip_clsf_cd.value + occr_slip_occr_dt.value.ReplaceString("-", "") + occr_slip_seq.value);
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/make_dt", model.getValue("/root/resData/resform/make_dt"));
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/erplace_cd", model.getValue("/root/resData/resform/erplace_cd"));
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/ern", model.getValue("/root/resData/resform/ern"));						
						//makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/vat_amt",vat_);
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/vat_amt",model.getValue("/root/resData/resform/vat_amt"));
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/suply_amt", model.getValue("/root/resData/resform/suply_amt"));
																				
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/setoff_slip_no", model.getValue("/root/resData/resform/setoff_slip_no"));
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/occr_slip_clsf", model.getValue("/root/resData/resform/occr_slip_clsf"));
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/occr_slip", model.getValue("/root/resData/resform/occr_slip"));						
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/email_id", model.getValue("/root/resData/resform/email_id"));
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/remk", model.getValue("/root/resData/resform/remk"));
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/item", model.getValue("/root/resData/resform/item"));
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/re_issu_resn_cd", model.getValue("/root/resData/resform/re_issu_resn_cd"));
					}	
					
					// HEAD 필수 CHECK
					if (budg_cd.Trim().ReplaceString("-", "").length != 6) {
						show_message("예산코드는 필수입력사항입니다.");
						model.setFocus("budg_cd");
						return false;
					}
					var dr_amt = datagrid2.valueMatrix(row_id,8);
					if (dr_amt == "") {
						datagrid2.valueMatrix(row_id,8)= "0";
					}
					var crdt_amt = datagrid2.valueMatrix(row_id,9);
					if (crdt_amt == "") {
						datagrid2.valueMatrix(row_id,9)= "0";
					}
					if (Number(dr_amt.Trim()) != 0 && Number(crdt_amt.Trim()) != 0) {
						show_message("차변금액과 대변금액은 동시에 입력될 수 없습니다.");
						//model.setFocus("dr_amt");
						return false;
					}
					
					// BACKGROUND COLOR로 CHECK				
					if (boks_dlco_nm.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(boks_dlco_nm,"trim","focus","부거래처명은 필수입력항목입니다.")) { return false; }     
					}					
					if (mang_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(mang_clsf_cd,"trim","focus","관리구분은 필수입력항목입니다.")) { return false; }     
					}										
					if (prop_equip_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(prop_equip_cd,"trim","focus","영수증구분은 필수입력항목입니다.")) { return false; }     
					}
					if (dtls_medi_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(dtls_medi_cd,"trim","focus","상세매체는 필수입력항목입니다.")) { return false; }     
					}
					
					// 유가증권 or 보험
					if (budg_cd.Trim().substring(0, 4) == "1713" || budg_cd.Trim() == "022100") {
						if (budg_cd.Trim() == "022100") {	// 유가증권
							if (mang_clsf_cd.value.Trim().substring(0, 1) != "2") {
								show_message("예산코드가 유가증권(022100)이면 관리구분(증권구분)코드의 첫번째 자리수가 '2'가 되어야 합니다.");
								model.setFocus("mang_clsf_cd");
								return false;
							}
						}
						else {	// 보험
							if (mang_clsf_cd.value.Trim().substring(0, 4) != "5100"
							&& mang_clsf_cd.value.Trim().substring(0, 4) != "5200"
							&& mang_clsf_cd.value.Trim().substring(0, 4) != "5400" ) {
								show_message("예산코드가 보험(1713으로 시작)이면 관리구분(보험구분)코드는 '5100', '5200', '5400'중에 하나가 되어야 합니다.");
								model.setFocus("mang_clsf_cd");
								return false;
							}
						}						
					}
					if (mang_no.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (budg_cd.Trim() == "022100") {	// 유가증권
							if (!check_reqItem(mang_no,"trim","focus","관리번호(증권번호)는 필수입력항목입니다.")) { return false; }     
							if (mang_no.value.Trim().length != 8) {
								show_message("관리번호(증권번호)는 형식이 일치하지 않습니다.(8자리)");
								model.setFocus("mang_no");
								return false;
							}
						}
						else {
							if (!check_reqItem(mang_no,"trim","focus","관리번호는 필수입력항목입니다.")) { return false; }     
						}
					}
					
					// 예산코드가 예수금(대체,기타)이면서 차변금액이 입력된 경우 전사전표번호 필수 입력
					if (budg_cd.Trim() == "463100" || budg_cd.Trim() == "456100"
					|| budg_cd.Trim() == "466500" || budg_cd.Trim() == "466700"
					|| budg_cd.Trim() == "466800" ) {
						if (Number(dr_amt.Trim()) != 0) {
							if (!check_reqItem(occr_slip_clsf,"trim","focus","전사전표구분은 필수입력항목입니다.")) { return false; }     
							if (occr_slip.value.Trim().ReplaceString("-", "").length < 17 ) {
								show_message("전사전표번호는 필수입력항목입니다.");
								model.setFocus("occr_slip");
								return false;
							}
						}
					}
					if (setoff_slip_no.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (setoff_slip_no.value.Trim().ReplaceString("-", "").length != 20) {
							show_message("상계전표번호는 필수입력항목입니다.");
							model.setFocus("setoff_slip_no");
							return false;
						}
					}
					if (medi_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {						
						if (!check_reqItem(medi_cd,"trim","focus","매체코드는 필수입력항목입니다.")) { return false; }     
					}
					if (dtls_medi_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(dtls_medi_cd,"trim","focus","상세매체코드는 필수입력항목입니다.")) { return false; }     
					}
					if (evnt_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(evnt_cd,"trim","focus","행사코드는 필수입력항목입니다.")) { return false; }     
					}
					if (comp_dt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (comp_dt.value.Trim().ReplaceString("-", "").length != 8) {
							show_message("기산일자는 필수입력항목입니다.");
							model.setFocus("comp_dt");
							return false;
						}
					}
					if (mtry_dt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (mtry_dt.value.Trim().ReplaceString("-", "").length != 8) {
							show_message("만기일자 필수입력항목입니다.");
							model.setFocus("mtry_dt");
							return false;
						}
					}
					if (unit.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(unit,"trim","focus","단위는 필수입력항목입니다.")) { return false; }     
					}
					if (qunt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (Number(qunt.value.Trim()) == 0) {
							show_message("수량은 필수입력항목입니다.");
							model.setFocus("qunt");
							return false;
						}
					}
					if (rmks2.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(rmks2,"trim","focus","적요2는 필수입력항목입니다.")) { return false; }     
					}
					if (obj_acct_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(obj_acct_cd,"trim","focus","대상계정코드는 필수입력항목입니다.")) { return false; }     
					}
					if (obj_dt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (obj_dt.value.Trim().ReplaceString("-", "").length != 8) {
							show_message("대상일자는 필수입력항목입니다.");
							model.setFocus("obj_dt");
							return false;
						}
					}
					if (obj_amt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (Number(obj_amt.value.Trim()) == 0) {
							show_message("대상금액은 필수입력항목입니다.");
							model.setFocus("obj_amt");
							return false;
						}
					}
					if (note_stat.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(note_stat,"trim","focus","어음상태는 필수입력항목입니다.")) { return false; }     
					}
					if (frcr_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(frcr_clsf_cd,"trim","focus","외화구분코드는 필수입력항목입니다.")) { return false; }     
					}
					if (exrate.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (Number(exrate.value.Trim()) == 0) {
							show_message("환율은 필수입력항목입니다.");
							model.setFocus("exrate");
							return false;
						}
					}
					if (frcr_amt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (Number(frcr_amt.value.Trim()) == 0) {
							show_message("외화금액은 필수입력항목입니다.");
							model.setFocus("frcr_amt");
							return false;
						}
					}
					
					
//					세금계산서  추가 -------------------------------------------------------------------------------start
					//if(getProperty("ss_cmpycd") == "332"){
						
						if (prof_type_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							
							if (!check_reqItem(prof_type_cd,"trim","focus","세금계산서유형은 필수입력항목입니다.")) { return false; }     
							
						}
											
						if (occr_slip_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (occr_slip_clsf_cd.value == "") {
								model.alert("세금계산서구분은 필수입력항목입니다.");
								model.setFocus("prof_type_cd");
								return;
							}
						}
	
						if (occr_slip_occr_dt.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (!check_reqItem(occr_slip_occr_dt,"trim","focus","세금계산서 발생일자는 필수입력항목입니다.")) { return false; }     
						}
	
						if (make_dt.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (!check_reqItem(make_dt,"trim","focus","작성일자는 필수입력항목입니다.")) { return false; }     
							
							/*if (make_dt.value.ReplaceString("-", "").substring(0, 6) != parentWindow.srch_slip_occr_dt.value.ReplaceString("-", "").substring(0, 6)) {
								model.alert("예산년월과 작성일자의 월이 상이합니다.");
								model.setFocus("make_dt");
								return;
							}*/
						}
	
						if (erplace_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (!check_reqItem(erplace_cd,"trim","focus","사업장코드는 필수입력항목입니다.")) { return false; }     
						}
						
						if (ern.attribute("background-color") == DEFAULT_COLOR_REQ) {
							//if (ern.value.length!= 12) {
							if (ern.value == "") {
								model.alert("공급자번호는 필수입력항목입니다.");
								model.setFocus("ern");
								return;
							}
						}
						
						if (suply_amt.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (!check_reqItem(suply_amt,"trim","focus","과표는 필수입력항목입니다.")) { return false; }     
						}
						// 세금계산서 임시순번 채번
						/*if (occr_slip_seq.value == "" && prof_type_cd.value != "") {
							
							var_occr_slip_seq = "";
	
							for (i=1;i< datagrid2.Rows-1;i++) {
	
								if (datagrid2.valueMatrix(i, 39).ReplaceString("-", "").substring(0, 12) == prof_type_cd.value.substring(0, 2) + occr_slip_clsf_cd.value + occr_slip_occr_dt.value.ReplaceString("-", "") &&
								    datagrid2.valueMatrix(i, 39).ReplaceString("-", "").substring(12, 16) > var_occr_slip_seq) {
								    	var_occr_slip_seq = datagrid2.valueMatrix(i, 39).ReplaceString("-", "").substring(12, 16);
								}
							}
							
							if (Number(var_occr_slip_seq) >= 0) {
								occr_slip_seq.value = Number(var_occr_slip_seq) + 1;
								occr_slip_seq.value = occr_slip_seq.value.GetZeroString(4);
							}
							else {
								occr_slip_seq.value = "0001";
							}
						}	*/
					//}		
					return true;
				}

				function fn_FormToGrid_just(row_id, iv_X) {							
					var budg_cd = datagrid2.valueMatrix(row_id, 3);
					
					if (Number(datagrid2.valueMatrix(row_id, 8).Trim()) != 0) {
						datagrid2.valueMatrix(row_id, 2)  = "1";     
					}else {
						datagrid2.valueMatrix(row_id, 2)  = "9";             		// 대변
					}
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/boks_dlco_nm", model.getValue("/root/resData/resform/boks_dlco_nm"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/mang_clsf_cd", model.getValue("/root/resData/resform/mang_clsf_cd"));		
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/mang_clsf_nm", model.getValue("/root/resData/resform/mang_clsf_nm"));		
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/mang_no", model.getValue("/root/resData/resform/mang_no"));		
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/medi_cd", model.getValue("/root/resData/resform/medi_cd"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/dtls_medi_cd", model.getValue("/root/resData/resform/dtls_medi_cd"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/evnt_cd", model.getValue("/root/resData/resform/evnt_cd"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/pch_hsnm", model.getValue("/root/resData/resform/pch_hsnm"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/use_dept_cd", model.getValue("/root/resData/resform/use_dept_cd"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/pch_buseonm", model.getValue("/root/resData/resform/pch_buseonm"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/comp_dt", model.getValue("/root/resData/resform/comp_dt"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/mtry_dt", model.getValue("/root/resData/resform/mtry_dt"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/bank_cd", model.getValue("/root/resData/resform/bank_cd"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/pch_banknm", model.getValue("/root/resData/resform/pch_banknm"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/unit", model.getValue("/root/resData/resform/unit"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/qunt", model.getValue("/root/resData/resform/qunt"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/obj_acct_cd", model.getValue("/root/resData/resform/obj_acct_cd"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/pch_dsacctnm", model.getValue("/root/resData/resform/pch_dsacctnm"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/obj_dt", model.getValue("/root/resData/resform/obj_dt"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/obj_amt", model.getValue("/root/resData/resform/obj_amt"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/frcr_clsf_cd", model.getValue("/root/resData/resform/frcr_clsf_cd"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/frcr_amt", model.getValue("/root/resData/resform/frcr_amt"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/exrate", model.getValue("/root/resData/resform/exrate"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/note_stat", model.getValue("/root/resData/resform/note_stat"));
					model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/prop_equip_cd", model.getValue("/root/resData/resform/prop_equip_cd"));
					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/etc_in", model.getValue("/root/resData/resform/etc_in"));
					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/tax_stmt_no", prof_type_cd.value.substring(0, 2) + occr_slip_clsf_cd.value + occr_slip_occr_dt.value.ReplaceString("-", "") + occr_slip_seq.value);
					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/make_dt", model.getValue("/root/resData/resform/make_dt"));
					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/erplace_cd", model.getValue("/root/resData/resform/erplace_cd"));
					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/ern", model.getValue("/root/resData/resform/ern"));
					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/setoff_slip_no", model.getValue("/root/resData/resform/setoff_slip_no"));
					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/occr_slip_clsf", model.getValue("/root/resData/resform/occr_slip_clsf"));
					makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/occr_slip", model.getValue("/root/resData/resform/occr_slip"));
					
					if( budg_cd == "182000" || budg_cd == "462000"){
						//var vat_ = Number(datagrid2.valueMatrix(row_id,8))+Number(datagrid2.valueMatrix(row_id,9));
						model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/etc_in", model.getValue("/root/resData/resform/etc_in"));
						model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/tax_stmt_no", prof_type_cd.value.substring(0, 2) + occr_slip_clsf_cd.value + occr_slip_occr_dt.value.ReplaceString("-", "") + occr_slip_seq.value);
						model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/make_dt", model.getValue("/root/resData/resform/make_dt"));
						model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/erplace_cd", model.getValue("/root/resData/resform/erplace_cd"));
						model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/ern", model.getValue("/root/resData/resform/ern"));
						//makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/vat_amt",vat_);
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/vat_amt",model.getValue("/root/resData/resform/vat_amt"));
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/suply_amt", model.getValue("/root/resData/resform/suply_amt"));
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/email_id", model.getValue("/root/resData/resform/email_id"));
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/remk", model.getValue("/root/resData/resform/remk"));
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/item", model.getValue("/root/resData/resform/item"));
						makeNodeValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+row_id+"]/re_issu_resn_cd", model.getValue("/root/resData/resform/re_issu_resn_cd"));
					}
					return true;					
				}
				
				function fn_group3_reset() {
					set_refvalue("/root/resData/resform/slip_arow_no","");	// 행번호
					set_refvalue("/root/resData/resform/budg_cd","");			// 예산코드					
					set_refvalue("/root/resData/resform/pch_sdysnm","");		// 예산코드명
					//set_refvalue("/root/resData/resform/use_dept_cd",model.getValue("/root/reqData/searchData/clam_dept_cd"));		// 사용부서
					set_refvalue("/root/resData/resform/use_dept_cd","");		// 사용부서 20170906 봉은정 수정
					set_refvalue("/root/resData/resform/pch_buseonm",model.getValue("/root/reqData/searchData/pch_cgbuseonm"));		// 사용부서
					set_refvalue("/root/resData/resform/dr_amt","");				// 차변금액
					set_refvalue("/root/resData/resform/crdt_amt","");			// 대변금액
					set_refvalue("/root/resData/resform/dlco_clsf_cd","");			// 거래처구분
					set_refvalue("/root/resData/resform/dlco_cd","");			// 거래처코드
					set_refvalue("/root/resData/resform/dlco_nm","");			// 거래처명
					set_refvalue("/root/resData/resform/intg_dlco_cd","");		// 통합거래처코드
					set_refvalue("/root/resData/resform/boks_dlco_nm","");		// 부거래처명
					set_refvalue("/root/resData/resform/mang_clsf_cd","");		// 관리구분
					set_refvalue("/root/resData/resform/mang_clsf_nm","");		// 관리구분명
					set_refvalue("/root/resData/resform/mang_no","");			// 관리번호
					set_refvalue("/root/resData/resform/incm_clsf_cd","");			// 소득구분
					set_refvalue("/root/resData/resform/bank_cd","");			// 은행코드
					set_refvalue("/root/resData/resform/pch_banknm","");		// 은행코드명
					set_refvalue("/root/resData/resform/prop_equip_cd","");		// 영수증구분
					set_refvalue("/root/resData/resform/medi_cd","");			// 매체코드
					set_refvalue("/root/resData/resform/dtls_medi_cd","");		// 상세매체코드
					set_refvalue("/root/resData/resform/evnt_cd","");			// 행사코드
					set_refvalue("/root/resData/resform/pch_hsnm","");			// 행사코드명
					set_refvalue("/root/resData/resform/unit","");				// 단위
					set_refvalue("/root/resData/resform/comp_dt","");			// 기산일자
					set_refvalue("/root/resData/resform/mtry_dt","");			// 만기일자
					set_refvalue("/root/resData/resform/qunt","");				// 수량
					set_refvalue("/root/resData/resform/occr_slip_clsf","");		// 전사전표구분
					set_refvalue("/root/resData/resform/occr_slip","");			// 전사전표번호
					set_refvalue("/root/resData/resform/setoff_slip_no","");		// 상계전표번호
					set_refvalue("/root/resData/resform/rmks1","");				// 적요1
					set_refvalue("/root/resData/resform/rmks2","");				// 적요2
					set_refvalue("/root/resData/resform/obj_acct_cd","");		// 대상계정
					set_refvalue("/root/resData/resform/pch_dsacctnm","");		// 대상계정명
					set_refvalue("/root/resData/resform/obj_dt","");				// 대상일자
					set_refvalue("/root/resData/resform/obj_amt","");			// 대상금액
					set_refvalue("/root/resData/resform/note_stat","");			// 어음상태
					set_refvalue("/root/resData/resform/frcr_clsf_cd","");			// 외화구분코드
					set_refvalue("/root/resData/resform/exrate","");				// 환율
					set_refvalue("/root/resData/resform/frcr_amt","");			// 외화금액

					set_refvalue("/root/resData/resform/prof_type_cd","");		//  39.세금계산서번호 
					set_refvalue("/root/resData/resform/occr_slip_clsf_cd","");		//  39.세금계산서번호 
					set_refvalue("/root/resData/resform/occr_slip_occr_dt","");	//  39.세금계산서번호 
					set_refvalue("/root/resData/resform/occr_slip_seq","");		//  39.세금계산서번호 

					set_refvalue("/root/resData/resform/erplace_cd","");						//  41.사업장코드
					set_refvalue("/root/resData/resform/make_dt","");						//  40.작성일자
					set_refvalue("/root/resData/resform/etc_in","");							//  38.잡수익
					set_refvalue("/root/resData/resform/ern","");							//  42.공급자번호

					set_refvalue("/root/resData/resform/suply_amt","");						//  52.공급가액
					set_refvalue("/root/resData/resform/vat_amt","");						//  53.부가세
					set_refvalue("/root/resData/resform/email_id","");						//  54.e-mail
					set_refvalue("/root/resData/resform/remk","");						//  55.remk
					set_refvalue("/root/resData/resform/item","");						//  56.item
					set_refvalue("/root/resData/resform/re_issu_resn_cd","");						//  57.
					model.refresh();
				}
				
				function CheckResident_number(resident_number1, resident_number2)
					{
						if( resident_number1.length != 6 )	return false;
						if( resident_number2.length != 7 )	return false;
						
						blnResident_number = false;
						// 잘못된 생년월일을 검사합니다.
						//b_Year = (resident_number2.charAt(0) <= "2") ? "19" : "20";
						if (resident_number2.charAt(0) < "3" ) {
							b_Year = "19";
						} else if (resident_number2.charAt(0) > "2" && resident_number2.charAt(0) < "5" ) {
							b_Year = "20";
						} else if (resident_number2.charAt(0) > "4" && resident_number2.charAt(0) < "7" ) {
							b_Year = "19";
						} else {
							b_Year = "20";
						}
							
						/* 2000년도부터 성구별 번호가 바뀌였슴으로 구별수가 2보다 작다면
						1900년도 생이되고 2보다 크다면 2000년도 이상생이 됩니다. 
						단 1800년도 생은 계산에서 제외합니다.*/
					
						b_Year += resident_number1.substr(0, 2);
						// 주민번호의 앞에서 2자리를 이어서 4자리의 생년을 저장합니다.
						b_Month = resident_number1.substr(2, 2) - 1;
						// 달을 구합니다. 1을 뺀것은 자바스크립트에서는 1월을 0으로 표기하기 때문입니다.
						b_Date = resident_number1.substr(4, 2);
						b_sum = new Date(b_Year, b_Month, b_Date);
						if ( b_sum.getYear() % 100 != resident_number1.substr(0, 2) || b_sum.getMonth() != b_Month || b_sum.getDate() != b_Date) {
						return blnResident_number;
						// 생년월일의 타당성을 검사하여 거짓이 있을시 에러메세지를 나타냄
						}
					
						total = 0;
						temp = new Array(13);
						for(i=1; i<=6; i++) temp[i] = resident_number1.charAt(i-1);
						for(i=7; i<=13; i++) temp[i] = resident_number2.charAt(i-7);
						for(i=1; i<=12; i++) {
						k = i + 1;
						if(k >= 10) k = k % 10 + 2;
						/* 각 수와 곱할 수를 뽑아냅니다. 곱수가 만일 10보다 크거나 같다면
						계산식에 의해 2로 다시 시작하게 됩니다. */
						total = total + (temp[i] * k);
						// 각 자리수와 계산수를 곱한값을 변수 total에 누적합산시킵니다.
						}
					
						last_num = (11- (total % 11)) % 10;
						// 마지막 계산식을 변수 last_num에 대입합니다.
						if(last_num == temp[13]) blnResident_number = true;
						// laster_num이 주민번호의마지막수와 같은면 참을 틀리면 거짓을 반환합니다.
						else blnResident_number = false;
						//탈북자 주민번호는 뒷자리가 5,6으로 시작되는데 이 경우에는 유효성검사에 상관없이
						//처리되도록 임시처리함
						if(resident_number2.charAt(0) == "5" || resident_number2.charAt(0) == "6") blnResident_number = true;
						return blnResident_number;
					}
					
					function CheckBusiness_Number(businessNo){
						if (businessNo.length == 10) {
						
							a  	= businessNo.charAt(0);
							b  	= businessNo.charAt(1);
							c  	= businessNo.charAt(2);
							d  	= businessNo.charAt(3);
							e  	= businessNo.charAt(4);
							f  	= businessNo.charAt(5);
							g  	= businessNo.charAt(6);
							h  	= businessNo.charAt(7);
							i  	= businessNo.charAt(8);
							Osub 	= businessNo.charAt(9);
							
							suma = a*1 + b*3 + c*7 + d*1 + e*3 + f*7 + g*1 + h*3;
							sumb = (i*5) %10;
							sumc = parseInt((i*5) / 10,10);
							sumd = sumb + sumc;	
							sume = suma + sumd;
							sumf = a + b + c + d + e + f + g + h + i
							k = sume % 10;
							Modvalue = 10 - k;
							LastVal = Modvalue % 10;
							
							if (sumf == 0) {
								return false;
							}
							
						} else {
							return false;
						}	
					
					  	if ( Osub == LastVal ) {
							return true;
						} else {
							return false;
						}
					}		
					
					function open_fc_acct_1180_(p_where,p_mode,p_title,p_readonly) {
					var need_popup = true;					

					//검색조건이 모두 충족하지 않으면 종료한다.
					if (gstr_popupid == "dlco_cd") { 		// 거래처
						if (p_where == "FOCUS" && (srch_dlco_clsf_cd.value.Trim() == "" || srch_dlco_cd.value.Trim() == "")) {
							srch_dlco_cdnm.value	= "";
							return;
						}
					}
					p_where = p_where.toUpperCase();				
					
					var popid = "fc_acct_1180";
					var subid = "fc_acct_1181_l";
					var row = datagrid2.row;
	
					var ern_biz = datagrid2.valueMatrix(row,5).replace(/-/ig, "");	
					
					if(isNumber(ern_biz)){
						set_popup_send_data(popid		,"cd_f"			,datagrid2.valueMatrix(row,5) );
						set_popup_send_data(popid		,"cd_t"			,datagrid2.valueMatrix(row,5) );						
						set_popup_send_data(popid		,"cd_abrv_nm"	,"");					
					}else{
						set_popup_send_data(popid		,"cd_f"			,"" );
						set_popup_send_data(popid		,"cd_t"			,"" );						
						set_popup_send_data(popid		,"cd_abrv_nm"	,datagrid2.valueMatrix(row,5) );											
					}
	
					set_popup_send_data(popid		,"mode"			,p_mode		);
					set_popup_send_data(popid		,"title"			,p_title		);
					set_popup_send_data(popid		,"readonly"		,p_readonly	);
					//set_popup_send_data(popid		,"clsf_cd"			,srch_dlco_clsf_cd.value	);

					//set_popup_send_data(popid		,"cd_abrv_nm"	,datagrid2.valueMatrix(row,5) );
					//isNumber
					
	
					//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
					if (p_where == "FOCUS") {
						//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
						//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
						model.removenode(get_popup_rcvs_ref(popid));
						//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
						model.makeNode(get_popup_rcvs_ref(popid));
						
						//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
						send_submission(
								"auto_" + subid
							,	get_popup_send_ref(popid)
							,	get_popup_rcvs_ref(subid) + "/dataSet"
							,	"/fc/acct1000/1181"
							,	"urlencoded-post"
							,	"application/x-www-form-urlencoded"
						);
						
						totalcnt = get_refvalue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
				
						if (totalcnt == 1) {
							//데이터가 1건이고 focus out에서 호출한 경우
							//데이터를 설정하고 나간다.
	
							model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							need_popup = false;
						}
						else {
							//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
							//만약 1건 이상인 경우 popup을 호출해 달라고 하면
							//return을 지우면 됨
							//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
							//return;
							need_popup = true;
						}
					}
					
					//그외 버튼인 경우는 계속 진행
					if (need_popup) {
						open_popup(popid,"640");
					}
	
					//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
					//다시 조회 하기 쉽도록 하고
					if (get_popup_rcvs_data(popid,"clsf_cd") != "")			datagrid2.valueMatrix(row, 12)	=	get_popup_rcvs_data(popid,"clsf_cd");
					if (get_popup_rcvs_data(popid,"cd") != "")				datagrid2.valueMatrix(row, 5)	=	get_popup_rcvs_data(popid,"cd");
					//그외의 값은 지워지도록 한다.					
					datagrid2.valueMatrix(row, 6) = get_popup_rcvs_data(popid,"cd_abrv_nm");
					datagrid2.valueMatrix(row, 54) = get_popup_rcvs_data(popid,"email");
					datagrid2.valueMatrix(row,36) =	get_popup_rcvs_data(popid,"intg_cd");
					var srch_dlco_cd = datagrid2.valueMatrix(row, 5);	
					if (srch_dlco_cd.length == 10) {
						if (commCheckBrnoVal(srch_dlco_cd.ReplaceString("-", "")) == false) { srch_dlco_cd.value = ""; }
					}

					if (srch_dlco_cd.length == 0) {
						datagrid2.valueMatrix(row,6) = "";
					}	
				}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="980" pageheight="815" guideline="1,10;2,10;1,876;1,879;1,932;1,935;2,24;2,39;2,40;2,124;2,128;2,50;2,134;2,575;2,259;" style="font-family:굴림; ">
		<group id="group3" class="gro_sel" style="left:1.02%; top:550px; width:99%; height:155px; ">
			<caption id="caption28" class="list_cap02" style="left:0.00%; top:0px; width:98.51%; height:26px; text-align:center; "/>
			<input id="fisc_dt" ref="/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST/record/fisc_dt" class="req" navindex="9" visibility="hidden" autonext="false" inputtype="date" style="left:35.64%; top:130px; width:4.79%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("use_dept_cd",true);
						}
					]]>
				</script>
			</input>
			<caption id="caption13" class="list_cap03" visibility="hidden" style="left:32.02%; top:126px; width:3.72%; height:26px; text-align:center; ">회계일자</caption>
			<caption id="caption16" class="list_cap03" style="left:0.00%; top:0px; width:8.51%; height:26px; text-align:center; ">사용부서</caption>
			<input id="use_dept_cd" ref="/root/resData/resform/use_dept_cd" accesskey="f2" class="req" navindex="10" autonext="false" inputtype="button" maxlength="6" style="left:9.04%; top:4px; width:6.91%; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						var row_3 = datagrid3.row;
						
						var var_con_date = "";
						var var_date_ch = datagrid3.valueMatrix(row_3,1);
						if (var_date_ch == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = var_date_ch;
							if(num_ch == 8){
								var_con_date = var_date_ch;
							}else if(num_ch == 6){
								var_con_date = var_date_ch + "01";
							}else if(num_ch == 4){
								var_con_date = var_date_ch + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "use_setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "I");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						
						if (getProperty("ss_cmpycd") == "326"){
							if(erplace_cd.attribute("background-color") == DEFAULT_COLOR_REQ){
								if (erplace_cd.value == "02" && use_dept_cd.value != "800000") {								
									show_message("[사용부서 혹은 사업장코드 확인요]");
									return;
								}
							}
						}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var row_3 = datagrid3.row;
						var var_con_date = "";	
						var var_date_ch = datagrid3.valueMatrix(row_3,1);
						if (var_date_ch == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = var_date_ch;
							if(num_ch == 8){
								var_con_date = var_date_ch;
							}else if(num_ch == 6){
								var_con_date = var_date_ch + "01";
							}else if(num_ch == 4){
								var_con_date = var_date_ch + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (use_dept_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
							model.setValue("/root/reqData/fwdData/dept_cd", use_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "I");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								pch_buseonm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								use_dept_cd.value = "";
								pch_buseonm.value = "";
							}
						}
						else {
							use_dept_cd.value = "";
							pch_buseonm.value = "";
						}	
						
						if (getProperty("ss_cmpycd") == "326"){
							if(erplace_cd.attribute("background-color") == DEFAULT_COLOR_REQ){
								if (erplace_cd.value == "02" && use_dept_cd.value != "800000") {								
									show_message("[사용부서 혹은 사업장코드 확인요]");
									return;
								}
							}
						}						
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){		
							model.setValue("/root/tempData2/tempNode"	,"x");	
							if(boks_dlco_nm.attribute("background-color") == DEFAULT_COLOR_REQ){	
								model.setFocus("boks_dlco_nm",true);					
							}else{
								boks_dlco_nm.dispatch("oncursor");
							}
						}
					]]>
				</script>
				<script type="javascript" ev:event="onaccesskey">
					<![CDATA[
					if(model.getFocus() == "use_dept_cd"){
						use_dept_cd.dispatch("onbuttonclick");
						return;
					}
					]]>
				</script>
			</input>
			<input id="pch_buseonm" ref="/root/resData/resform/pch_buseonm" editable="false" inputtype="input" style="left:16.28%; top:4px; width:11.38%; height:18px; "/>
			<caption id="caption54" class="list_cap02" style="left:69.68%; top:50px; width:28.83%; height:26px; text-align:center; "/>
			<caption id="caption35" class="list_cap02" style="left:35.11%; top:25px; width:63.40%; height:26px; text-align:center; "/>
			<caption id="caption27" class="list_cap03" visibility="hidden" style="left:49.68%; top:125px; width:3.72%; height:26px; text-align:center; ">거래처구분</caption>
			<caption id="caption31" class="list_cap02" style="left:7.98%; top:25px; width:23.94%; height:26px; text-align:center; "/>
			<caption id="caption32" class="list_cap03" style="left:28.09%; top:25px; width:8.51%; height:26px; text-align:center; ">관리번호</caption>
			<caption id="caption34" class="list_cap03" style="left:0.00%; top:25px; width:8.51%; height:26px; text-align:center; ">관리구분</caption>
			<caption id="caption36" class="list_cap03" style="left:69.57%; top:25px; width:8.51%; height:26px; text-align:center; ">상세매체</caption>
			<caption id="caption42" class="list_cap03" style="left:48.94%; top:25px; width:8.51%; height:26px; text-align:center; ">매체코드</caption>
			<caption id="caption43" class="list_cap02" style="left:0.00%; top:50px; width:72.34%; height:26px; text-align:center; "/>
			<caption id="caption44" class="list_cap03" visibility="visible" style="left:28.09%; top:50px; width:8.51%; height:26px; text-align:center; ">영수증구분</caption>
			<caption id="caption47" class="list_cap03" visibility="hidden" style="left:57.66%; top:128px; width:4.26%; height:26px; text-align:center; ">적요1</caption>
			<caption id="caption51" class="list_cap03" style="left:69.57%; top:50px; width:8.51%; height:26px; text-align:center; ">기산/만기일</caption>
			<caption id="caption61" class="list_cap02" style="left:0.00%; top:75px; width:98.51%; height:26px; text-align:center; "/>
			<caption id="caption65" class="list_cap03" style="left:69.57%; top:75px; width:8.51%; height:26px; text-align:center; ">외화구분코드</caption>
			<select1 id="dlco_clsf_cd" ref="/root/resData/resform/dlco_clsf_cd" visibility="hidden" appearance="minimal" editmode="inputsearch" style="left:53.40%; top:130px; width:2.13%; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2290_m/dataSet/DLCO_CLSF_CD_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(dlco_clsf_cd, dlco_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(dlco_clsf_cd,"");
							return;
						}
						dlco_cd.value = "";		// 거래처코드
						dlco_nm.value = "";		// 거래처명
						intg_dlco_cd.value = "";	// 공통거래처코드
					]]>
				</script>
			</select1>
			<input id="dlco_cd" ref="/root/resData/resform/dlco_cd" visibility="hidden" inputtype="button" style="left:55.53%; top:130px; width:2.13%; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					gstr_popupid = "";
					
					if (open_fc_acct_1180("button","s","","0")) {
						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					}
					else {
						//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					gstr_popupid = "";
					
					if (open_fc_acct_1180("focus","s","","0")) {
						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					}
					else {
						//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
			</input>
			<input id="mang_no" ref="/root/resData/resform/mang_no" navindex="14" inputtype="input" style="left:37.02%; top:29px; width:11.38%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(medi_cd.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("medi_cd",true);
						}else{
							medi_cd.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
						if(model.getValue("/root/tempData2/tempNode") == "x"){
							model.setValue("/root/tempData2/tempNode","");
							if(mang_no.attribute("background-color") != DEFAULT_COLOR_REQ){
								model.setValue("/root/tempData2/tempNode","x");
								model.setFocus("medi_cd",true);	
								medi_cd.dispatch("oncursor");
							}
						}
					]]>
				</script>
			</input>
			<input id="prop_equip_cd" ref="/root/resData/resform/prop_equip_cd" accesskey="f2" navindex="18" visibility="visible" autonext="false" inputtype="button" maxlength="4" style="left:37.02%; top:54px; width:11.38%; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
								
						var cd   =  "";
						var cdnm =  "";
							
						var resultRef1 = "/root/resData/resform/prop_equip_cd";
						var resultRef2 = "/root/resData/resform/prop_equip_cd_nm";
						
						showCommonCodePopup1("00", "12", cd, cdnm, "N", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
						model.setFocus("prop_equip_cd",true);
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(prop_equip_cd.value.length == 4 ){
							model.removeNodeset("/root/reqData/fwdData");  
							model.removeNodeset("/root/tempData/dataSet");  
							model.makeNode("/root/reqData/fwdData/job_clsf");
							model.makeNode("/root/reqData/fwdData/cd_clsf");
							model.makeNode("/root/reqData/fwdData/cd");
							model.setValue("/root/reqData/fwdData/job_clsf", "00");
							model.setValue("/root/reqData/fwdData/cd_clsf", "12");
							model.setValue("/root/reqData/fwdData/cd", prop_equip_cd.value);

							model.send("fc_co_8000_s");
							
							if (Number(model.getValue("/root/tempData/dataSet/CURLIST1/totalcnt")) != 1) {
								prop_equip_cd.value = "";
							}
						}
						else { prop_equip_cd.value = ""; }
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(unit.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("unit",true);
						}else{
							unit.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="onaccesskey">
					<![CDATA[
					if(model.getFocus() =="prop_equip_cd"){
							prop_equip_cd.dispatch("onbuttonclick");
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(prop_equip_cd.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("unit",true);		
							unit.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</input>
			<input id="comp_dt" ref="/root/resData/resform/comp_dt" navindex="21" autonext="false" inputtype="date" style="left:78.51%; top:54px; width:9.04%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(mtry_dt.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("mtry_dt",true);
						}else{
							mtry_dt.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(comp_dt.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("mtry_dt",true);	
							mtry_dt.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</input>
			<input id="mtry_dt" ref="/root/resData/resform/mtry_dt" navindex="22" autonext="false" inputtype="date" appearance="input" style="left:88.83%; top:54px; width:9.04%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(occr_slip_clsf.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("occr_slip_clsf",true);
						}else{
							occr_slip_clsf.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(occr_slip_clsf.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("occr_slip_clsf",true);
							occr_slip_clsf.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</input>
			<caption id="caption50" class="list_cap03" style="left:36.49%; top:75px; width:8.51%; height:26px; text-align:center; ">상계전표번호</caption>
			<caption id="caption52" class="list_cap02" style="left:0.00%; top:100px; width:98.51%; height:26px; text-align:center; "/>
			<input id="input29" visibility="hidden" inputtype="date" style="left:76.28%; top:130px; width:3.19%; height:18px; "/>
			<caption id="caption53" class="list_cap03" visibility="hidden" style="left:67.23%; top:127px; width:4.26%; height:26px; text-align:center; ">적요2</caption>
			<input id="rmks2" ref="/root/resData/resform/rmks2" visibility="hidden" style="left:72.02%; top:131px; width:4.26%; height:18px; "/>
			<input id="bank_cd" ref="/root/resData/resform/bank_cd" accesskey="f2" navindex="12" autonext="false" inputtype="button" maxlength="6" style="left:57.87%; top:4px; width:6.91%; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[		
						var cd   =  "";
						var cdnm =  "";
							
						var resultRef1 = "/root/resData/resform/bank_cd";
						var resultRef2 = "/root/resData/resform/pch_banknm";
						
						showCommonCodePopup1("02", "71", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
						model.setFocus("bank_cd",true);
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(bank_cd.value.length == 6 ){
							model.removeNodeset("/root/reqData/fwdData");  
							model.removeNodeset("/root/tempData/dataSet");  
							model.makeNode("/root/reqData/fwdData/job_clsf");
							model.makeNode("/root/reqData/fwdData/cd_clsf");
							model.makeNode("/root/reqData/fwdData/cd");
							model.setValue("/root/reqData/fwdData/job_clsf", "02");
							model.setValue("/root/reqData/fwdData/cd_clsf", "71");
							model.setValue("/root/reqData/fwdData/cd", bank_cd.value);

							model.send("fc_co_8000_s");
							
							if (Number(model.getValue("/root/tempData/dataSet/CURLIST1/totalcnt")) == 1
							&& bank_cd.value == model.getValue("/root/tempData/dataSet/CURLIST1/record/cd")) {
								pch_banknm.value = model.getValue("/root/tempData/dataSet/CURLIST1/record/cd_abrv_nm");
							}
							else {
								bank_cd.value = "";
								pch_banknm.value = "";
							}
						}
						else {
							bank_cd.value = "";
							pch_banknm.value = "";
						}
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setValue("/root/tempData2/tempNode"	,"x");	
							if(mang_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ){	
								model.setFocus("mang_clsf_cd",true);
							}else{
								mang_clsf_cd.dispatch("oncursor");
							}
									
						}
					]]>
				</script>
				<script type="javascript" ev:event="onaccesskey">
					<![CDATA[
						if(model.getFocus() =="bank_cd"){
								bank_cd.dispatch("onbuttonclick");
						}	
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
						if(model.getValue("/root/tempData2/tempNode") == "x"){
							model.setValue("/root/tempData2/tempNode","");
							if(bank_cd.attribute("background-color") != DEFAULT_COLOR_REQ){
								model.setValue("/root/tempData2/tempNode","x");
								model.setFocus("mang_clsf_cd",true);
								mang_clsf_cd.dispatch("oncursor");
							}
						}
					]]>
				</script>
			</input>
			<select1 id="medi_cd" ref="/root/resData/resform/medi_cd" accesskey="f2" navindex="15" appearance="minimal" editmode="search" itemcount="10" autonext="false" style="left:57.87%; top:29px; width:11.28%; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2290_m/dataSet/MEDI_CD_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(dtls_medi_cd.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("dtls_medi_cd",true);
						}else{
							dtls_medi_cd.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
						if(model.getValue("/root/tempData2/tempNode") == "x"){
							model.setValue("/root/tempData2/tempNode","");
							model.setValue("/root/resData/resform/medi_cd","");
							if(medi_cd.attribute("background-color") != DEFAULT_COLOR_REQ){
								model.setValue("/root/tempData2/tempNode","x");
								model.setFocus("dtls_medi_cd",true);
								dtls_medi_cd.dispatch("oncursor");
							}
						}
					]]>
				</script>
			</select1>
			<input id="setoff_slip_no" ref="/root/resData/resform/setoff_slip_no" accesskey="f2" navindex="25" autonext="false" editable="true" inputtype="button" maxlength="24" style="left:45.32%; top:79px; width:17.98%; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						if (setoff_slip_no.attribute("editable") == "false" && setoff_slip_no.attribute("background-color") == DEFAULT_COLOR_DISABLE) { return; }
						
						model.property("FC_ACCT_2040_srchdept_cd")  = clam_dept_cd.value;
						model.property("FC_ACCT_2040_srchdept_nm") = pch_cgbuseonm.value;
						model.property("FC_ACCT_2040_srchoccr_acct_cd") = budg_cd.value.substring(0, 4);
	
						viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2040");
	
						setoff_slip_no.value = model.property("FC_ACCT_2040_slip_no");
						
						model.property("FC_ACCT_2040_slip_no") = "";		
						model.setFocus("setoff_slip_no",true);
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(frcr_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("frcr_clsf_cd",true);
						}else{
							frcr_clsf_cd.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="onaccesskey">
					<![CDATA[
					if(model.getFocus() =="setoff_slip_no"){
						setoff_slip_no.dispatch("onbuttonclick");
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(setoff_slip_no.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("frcr_clsf_cd",true);
							frcr_clsf_cd.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</input>
			<select1 id="frcr_clsf_cd" ref="/root/resData/resform/frcr_clsf_cd" navindex="26" appearance="minimal" editmode="search" style="left:78.51%; top:79px; width:6.91%; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2290_m/dataSet/FRCR_CLSF_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(frcr_clsf_cd, frcr_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(frcr_clsf_cd,"");
							return;
						}
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(exrate.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("exrate",true);
						}else{
							exrate.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(frcr_clsf_cd.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("exrate",true);	
							exrate.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</select1>
			<input id="exrate" ref="/root/resData/resform/exrate" navindex="27" style="left:91.81%; top:79px; width:6.06%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(obj_acct_cd.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("obj_acct_cd",true);
						}else{
							obj_acct_cd.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(exrate.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("obj_acct_cd",true);	
							obj_acct_cd.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</input>
			<input id="pch_banknm" ref="/root/resData/resform/pch_banknm" editable="false" inputtype="input" style="left:65.21%; top:4px; width:11.38%; height:18px; "/>
			<input id="intg_dlco_cd" ref="/root/resData/resform/intg_dlco_cd" visibility="hidden" editable="false" inputtype="input" style="left:91.17%; top:130px; width:6.91%; height:18px; "/>
			<input id="dlco_nm" ref="/root/resData/resform/dlco_nm" visibility="hidden" editable="false" inputtype="input" style="left:86.38%; top:130px; width:4.68%; height:18px; "/>
			<input id="input1" ref="/root/resData/resform/rmks1" visibility="hidden" editable="false" style="left:62.45%; top:132px; width:4.26%; height:18px; "/>
			<input id="dtls_medi_cd" ref="/root/resData/resform/dtls_medi_cd" accesskey="f2" navindex="16" autonext="false" inputtype="button" maxlength="10" style="left:78.51%; top:29px; width:9.04%; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						
						model.makeNode("/root/reqData/fwdData/cmpy_cd");
						model.makeNode("/root/reqData/fwdData/G_Tag");
						model.makeNode("/root/reqData/fwdData/G_Caption");
						model.makeNode("/root/reqData/fwdData/G_Codenu");
						model.makeNode("/root/reqData/fwdData/G_BRCode");
						
						model.setValue("/root/reqData/fwdData/cmpy_cd", model.getValue("/root/initData/session/cmpy_cd"));
						model.setValue("/root/reqData/fwdData/G_Tag", "3");
						model.setValue("/root/reqData/fwdData/G_Caption", "상세매체코드조회");
						model.setValue("/root/reqData/fwdData/G_Codenu", medi_cd.value.substring(0, 3));					
						model.setValue("/root/reqData/fwdData/G_BRCode", "");

						gstr_popupid = "dtls_medi_cd";
						window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData")

						model.setFocus("dtls_medi_cd",true);
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var medi_cd = model.getValue("/root/resData/resform/medi_cd");
						if (medi_cd != "") {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/cd");
							model.makeNode("/root/reqData/fwdData/medi_cd");
							model.setValue("/root/reqData/fwdData/cd", model.getValue("/root/resData/resform/dtls_medi_cd"));
							model.setValue("/root/reqData/fwdData/medi_cd",medi_cd);
							model.send("fc_acct_2015_l");

							if (model.getValue("/root/tempData/fc_acct_2015_l/dataSet/CURLIST/record/cd") != "") {
								
							}
							else {
								model.setValue("/root/resData/resform/dtls_medi_cd","");
							}
						}else{
							model.setValue("/root/resData/resform/dtls_medi_cd","");
						}
						model.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(evnt_cd.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("evnt_cd",true);
						}else{
							evnt_cd.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="onaccesskey">
					<![CDATA[
					if(model.getFocus() =="dtls_medi_cd"){
							dtls_medi_cd.dispatch("onbuttonclick");
					}	
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[				
					if(model.getValue("/root/tempData2/tempNode") == "x"){
							model.setValue("/root/tempData2/tempNode","");
							if(dtls_medi_cd.attribute("background-color") != DEFAULT_COLOR_REQ){
								model.setValue("/root/tempData2/tempNode","x");
								model.setFocus("evnt_cd",true);		
								evnt_cd.dispatch("oncursor");
							}
						}
					]]>
				</script>
			</input>
			<caption id="caption72" style="left:87.55%; top:55px; width:1.60%; height:20px; ">~</caption>
			<caption id="caption73" class="list_cap03" style="left:86.06%; top:75px; width:5.43%; height:26px; text-align:center; ">환율</caption>
			<input id="mang_clsf_cd" ref="/root/resData/resform/mang_clsf_cd" accesskey="f2" navindex="13" autonext="false" inputtype="button" style="left:9.04%; top:29px; width:6.91%; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[								
						var cd   =  "";
						var cdnm =  "";
							
						var resultRef1 = "/root/resData/resform/mang_clsf_cd";
						var resultRef2 = "/root/resData/resform/mang_clsf_nm";

						showCommonCodePopup1("02", "68", cd, cdnm, "Y", resultRef1, resultRef2, "", "", budg_mang_clsf_cd, "", "", "", "", "", "", "", "", "");
						model.setFocus("mang_clsf_cd",true);
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
							var row = datagrid2.row;
							if (datagrid2.valueMatrix(row,3) == ""){
								alert("예산코드를 입력해주세요."); return;
							}
							var mang_clsf_cd = model.getValue("/root/resData/resform/mang_clsf_cd");
							model.removeNodeset("/root/reqData/fwdData");  
							model.removeNodeset("/root/tempData/dataSet");  							
							model.makeNode("/root/reqData/fwdData/job_clsf");
							model.makeNode("/root/reqData/fwdData/cd_clsf");
							model.makeNode("/root/reqData/fwdData/cd");
							model.makeNode("/root/reqData/fwdData/mang_cd_3");						
							model.setValue("/root/reqData/fwdData/job_clsf", "02");
							model.setValue("/root/reqData/fwdData/cd_clsf", "68");
							model.setValue("/root/reqData/fwdData/cd", mang_clsf_cd);							
							model.setValue("/root/reqData/fwdData/mang_cd_3", budg_mang_clsf_cd);
							
							model.send("fc_co_8080_s");
							
							if (Number(model.getValue("/root/tempData/dataSet/CURLIST1/totalcnt")) == 1
							&& mang_clsf_cd == model.getValue("/root/tempData/dataSet/CURLIST1/record/cd")) {
								model.setValue("/root/resData/resform/mang_clsf_nm",model.getValue("/root/tempData/dataSet/CURLIST1/record/cd_abrv_nm"));
							}
							else {
								var cd   =  mang_clsf_cd;
								var cdnm =  "";
								var resultRef1 = "/root/resData/resform/mang_clsf_cd";
								var resultRef2 = "/root/resData/resform/mang_clsf_nm";
								
								showCommonCodePopup1("02", "68", cd, cdnm, "Y", resultRef1, resultRef2, "", "", budg_mang_clsf_cd, "", "", "", "", "", "", "", "", "");								
							}
							model.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setValue("/root/tempData2/tempNode"	,"x");	
							if(mang_no.attribute("background-color") == DEFAULT_COLOR_REQ){	
								model.setFocus("mang_no",true);
							}else{
								mang_no.dispatch("oncursor");
							}
						}
					]]>
				</script>
				<script type="javascript" ev:event="onaccesskey">
					<![CDATA[
					if(model.getFocus() =="mang_clsf_cd"){
							mang_clsf_cd.dispatch("onbuttonclick");
					}	
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
							model.setValue("/root/tempData2/tempNode","");
							if(mang_clsf_cd.attribute("background-color") != DEFAULT_COLOR_REQ){
								model.setValue("/root/tempData2/tempNode","x");
								model.setFocus("mang_no",true);
								mang_no.dispatch("oncursor");
							}
						}
					]]>
				</script>
			</input>
			<input id="mang_clsf_nm" ref="/root/resData/resform/mang_clsf_nm" editable="false" inputtype="input" style="left:16.28%; top:29px; width:11.38%; height:18px; "/>
			<input id="boks_dlco_nm" ref="/root/resData/resform/boks_dlco_nm" navindex="11" inputtype="input" style="left:36.91%; top:4px; width:11.38%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setValue("/root/tempData2/tempNode"	,"x");	
							if(bank_cd.attribute("background-color") == DEFAULT_COLOR_REQ){	
								model.setFocus("bank_cd",true);
							}else{
								bank_cd.dispatch("oncursor");
							}
						}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[		
						if(model.getValue("/root/tempData2/tempNode") == "x"){
							model.setValue("/root/tempData2/tempNode","");
							if(boks_dlco_nm.attribute("background-color") != DEFAULT_COLOR_REQ){								
								model.setValue("/root/tempData2/tempNode","x");
								model.setFocus("bank_cd",true);
								bank_cd.dispatch("oncursor");
							}
						}
					]]>
				</script>
			</input>
			<caption id="caption30" class="list_cap03" style="left:28.09%; top:0px; width:8.51%; height:26px; text-align:center; ">부거래처명</caption>
			<caption id="caption60" class="list_cap03" style="left:59.26%; top:50px; width:4.26%; height:26px; text-align:center; ">수량</caption>
			<input id="qunt" ref="/root/resData/resform/qunt" navindex="20" style="left:63.83%; top:54px; width:5.32%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(comp_dt.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("comp_dt",true);
						}else{
							comp_dt.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(qunt.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("comp_dt",true);		
							comp_dt.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</input>
			<caption id="caption39" class="list_cap03" style="left:48.94%; top:0px; width:8.51%; height:26px; text-align:center; ">은행코드</caption>
			<input id="pch_hsnm" ref="/root/resData/resform/pch_hsnm" editable="false" inputtype="input" style="left:16.28%; top:54px; width:11.38%; height:18px; "/>
			<input id="unit" ref="/root/resData/resform/unit" navindex="19" maxlength="10" style="left:53.51%; top:54px; width:5.32%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(qunt.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("qunt",true);
						}else{
							qunt.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(unit.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("qunt",true);
							qunt.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</input>
			<input id="evnt_cd" ref="/root/resData/resform/evnt_cd" accesskey="f2" navindex="17" autonext="false" inputtype="button" style="left:9.04%; top:54px; width:6.91%; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[				
						gstr_popupid = "evnt_cd";				
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cmpy_cd");
						model.makeNode("/root/reqData/fwdData/G_Tag");
						model.makeNode("/root/reqData/fwdData/G_Caption");
						model.makeNode("/root/reqData/fwdData/G_Codenu");
						model.makeNode("/root/reqData/fwdData/G_BRCode");
						model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
						model.setValue("/root/reqData/fwdData/G_Tag", "16");
						model.setValue("/root/reqData/fwdData/G_Caption", "행사코드조회");
						model.setValue("/root/reqData/fwdData/G_Codenu", "");	
						model.setValue("/root/reqData/fwdData/G_BRCode", "");
						window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						model.setFocus("evnt_cd",true);
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (evnt_cd.value.Trim().length == 6 || evnt_cd.value.Trim().length == 10) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.removeNodeset("/root/tempData/dataSet");  
							model.makeNode("/root/reqData/fwdData/cmpy_cd");
							model.makeNode("/root/reqData/fwdData/cd");
							model.makeNode("/root/reqData/fwdData/cdnm");
							model.makeNode("/root/reqData/fwdData/from_cd");
							model.makeNode("/root/reqData/fwdData/to_cd");
							model.makeNode("/root/reqData/fwdData/bgn_dt");
							model.makeNode("/root/reqData/fwdData/last_dt");
							model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
							model.setValue("/root/reqData/fwdData/cd", evnt_cd.value);
							model.setValue("/root/reqData/fwdData/cdnm", "");
							model.setValue("/root/reqData/fwdData/from_cd", "00" + "0000");
							model.setValue("/root/reqData/fwdData/to_cd", "00" + "9999");
							model.setValue("/root/reqData/fwdData/bgn_dt", "00000000");
							model.setValue("/root/reqData/fwdData/last_dt", "99999999");
							model.send("mc_co_1006_l");
							
							if (Number(model.getValue("/root/tempData/dataSet/CURLIST/totalcnt")) == 1
							&& evnt_cd.value == model.getValue("/root/tempData/dataSet/CURLIST/record/cd")) {
								pch_hsnm.value = model.getValue("/root/tempData/dataSet/CURLIST/record/cdnm");
							}
							else {
								evnt_cd.value = "";
								pch_hsnm.value = "";
							}
						}
						else {
							evnt_cd.value = "";
							pch_hsnm.value = "";
						}
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(prop_equip_cd.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("prop_equip_cd",true);
						}else{
							prop_equip_cd.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="onaccesskey">
					<![CDATA[
					if(model.getFocus() =="evnt_cd"){
							evnt_cd.dispatch("onbuttonclick");
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(evnt_cd.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("prop_equip_cd",true);	
							prop_equip_cd.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</input>
			<caption id="caption69" class="list_cap03" style="left:48.94%; top:50px; width:4.26%; height:26px; text-align:center; ">단위</caption>
			<caption id="caption38" class="list_cap03" style="left:0.00%; top:50px; width:8.51%; height:26px; text-align:center; ">행사코드</caption>
			<select1 id="occr_slip_clsf" ref="/root/resData/resform/occr_slip_clsf" navindex="23" appearance="minimal" editmode="inputsearch" itemcount="10" style="left:9.04%; top:79px; width:9.57%; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2290_m/dataSet/SLIP_CLSF_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(occr_slip_clsf, occr_slip_clsf.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(occr_slip_clsf,"");
							return;
						}
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(occr_slip.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("occr_slip",true);
						}else{
							occr_slip.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(occr_slip_clsf.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("occr_slip",true);
							occr_slip.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</select1>
			<caption id="caption56" class="list_cap03" style="left:0.00%; top:75px; width:8.51%; height:26px; text-align:center; ">전사전표번호</caption>
			<input id="occr_slip" ref="/root/resData/resform/occr_slip" accesskey="f2" navindex="24" autonext="false" inputtype="button" style="left:18.83%; top:79px; width:17.34%; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[					
						if (occr_slip.attribute("editable") == "false" && occr_slip.attribute("background-color") == DEFAULT_COLOR_DISABLE) { return; }
					
						model.property("FC_ACCT_2500_popup_clsf")  = "Y";
						model.property("FC_ACCT_2500_srch_occr_slip_clsf")  = occr_slip_clsf.value;
					
						viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2500");
						
						occr_slip_clsf.value = model.property("FC_ACCT_2500_srch_occr_slip_clsf");
						occr_slip.value = model.property("FC_ACCT_2500_occr_slip");
						
						model.property("FC_ACCT_2500_occr_slip") = "";
						model.property("FC_ACCT_2500_srch_occr_slip_clsf") = "";
						model.setFocus("occr_slip",true);
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(setoff_slip_no.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("setoff_slip_no",true);
						}else{
							setoff_slip_no.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="onaccesskey">
					<![CDATA[
					if(model.getFocus() =="occr_slip"){
							occr_slip.dispatch("onbuttonclick");
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(occr_slip.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("setoff_slip_no",true);
							setoff_slip_no.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</input>
			<input id="pch_dsacctnm" ref="/root/resData/resform/pch_dsacctnm" editable="false" inputtype="input" style="left:16.28%; top:104px; width:11.38%; height:18px; "/>
			<caption id="caption55" class="list_cap03" style="left:28.09%; top:100px; width:8.51%; height:26px; text-align:center; ">대상일자</caption>
			<input id="obj_dt" ref="/root/resData/resform/obj_dt" navindex="29" autonext="false" inputtype="date" style="left:37.02%; top:104px; width:9.57%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(obj_amt.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("obj_amt",true);
						}else{
							obj_amt.dispatch("oncursor");
						}
					}					
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(obj_dt.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("obj_amt",true);	
							obj_amt.dispatch("oncursor");
						}
					}					
					]]>
				</script>
			</input>
			<input id="obj_amt" ref="/root/resData/resform/obj_amt" navindex="30" inputtype="input" format="(-)#,###" style="left:55.64%; top:104px; width:9.26%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(note_stat.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("note_stat",true);
						}else{
							note_stat.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(obj_amt.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("note_stat",true);
							note_stat.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="onkeyup">
					<![CDATA[
					if(event.keycode == "107"){
						obj_amt.selBegin = 0;
						obj_amt.value = obj_amt.currentText + "000";
						obj_amt.selEnd = 30;
					}					
					]]>
				</script>
			</input>
			<caption id="caption46" class="list_cap03" style="left:46.81%; top:100px; width:8.51%; height:26px; text-align:center; ">대상금액</caption>
			<caption id="caption68" class="list_cap03" style="left:0.00%; top:100px; width:8.51%; height:26px; text-align:center; ">대상계정</caption>
			<input id="obj_acct_cd" ref="/root/resData/resform/obj_acct_cd" accesskey="f2" navindex="28" autonext="false" inputtype="button" maxlength="6" style="left:9.04%; top:104px; width:6.91%; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[					
						gstr_popupid = "obj_acct_cd";
					
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cmpy_cd");
						model.makeNode("/root/reqData/fwdData/G_Tag");
						model.makeNode("/root/reqData/fwdData/G_Caption");
						model.makeNode("/root/reqData/fwdData/G_Codenu");
						model.makeNode("/root/reqData/fwdData/G_BRCode");
						model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
						model.setValue("/root/reqData/fwdData/G_Tag", "1");
						model.setValue("/root/reqData/fwdData/G_Caption", "예산코드조회");
						model.setValue("/root/reqData/fwdData/G_Codenu", "");	
						model.setValue("/root/reqData/fwdData/G_BRCode", "");
						window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");		
						model.setFocus("obj_acct_cd",true);
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[				
						// 팝업 시작
						if (obj_acct_cd.value.Trim().length == 6) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.removeNodeset("/root/tempData/dataSet");  
							model.makeNode("/root/reqData/fwdData/cmpy_cd");
							model.makeNode("/root/reqData/fwdData/cd");
							model.makeNode("/root/reqData/fwdData/cdnm");
							model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
							model.setValue("/root/reqData/fwdData/cd", obj_acct_cd.value);
							model.setValue("/root/reqData/fwdData/cdnm", "");
							model.send("mc_co_1001_l");
		
							if (Number(model.getValue("/root/tempData/dataSet/CURLIST/totalcnt")) == 1
							&& obj_acct_cd.value == model.getValue("/root/tempData/dataSet/CURLIST/record/cd")) {
								pch_dsacctnm.value = model.getValue("/root/tempData/dataSet/CURLIST/record/cdnm");
							}
							else {
								obj_acct_cd.value = "";
								pch_dsacctnm.value = "";
							}
						}
						else {
							obj_acct_cd.value = "";
							pch_dsacctnm.value = "";
						}
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(obj_dt.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("obj_dt",true);
						}else{
							obj_dt.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="onaccesskey">
					<![CDATA[
					if(model.getFocus() =="obj_acct_cd"){
						obj_acct_cd.dispatch("onbuttonclick");
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(obj_acct_cd.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("obj_dt",true);
							obj_dt.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</input>
			<caption id="caption62" class="list_cap03" style="left:83.62%; top:100px; width:6.60%; height:26px; text-align:center; ">외화금액</caption>
			<input id="frcr_amt" ref="/root/resData/resform/frcr_amt" navindex="31" style="left:90.53%; top:104px; width:7.34%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(prof_type_cd.attribute("background-color") == "white"){									
							model.setFocus("button2",true);		
							button2.attribute("border-style") ="dotted";
						}else{
							model.setFocus("prof_type_cd",true);
						}
					}			
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(prof_type_cd.attribute("background-color") == "white"){					
							model.setFocus("button2",true);			
							button2.attribute("border-style") ="dotted";
						}else{
							model.setValue("/root/tempData2/tempNode","x");		
							model.setFocus("prof_type_cd",true);
							prof_type_cd.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="onkeyup">
					<![CDATA[
					if(event.keycode == "107"){
						frcr_amt.selBegin = 0;
						frcr_amt.value = frcr_amt.currentText + "000";
						frcr_amt.selEnd = 30;
					}	
					]]>
				</script>
			</input>
			<caption id="caption14" class="list_cap03" style="left:77.98%; top:0px; width:8.51%; height:26px; text-align:center; ">소득구분</caption>
			<select1 id="incm_clsf_cd" ref="/root/resData/resform/incm_clsf_cd" navindex="13" appearance="minimal" editmode="inputsearch" style="left:86.91%; top:4px; width:10.85%; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_3250_m/dataSet/CUR_INCM_CLSF_LIST/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(incm_clsf_cd, incm_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(incm_clsf_cd,"");
							return;
						}
						if (incm_clsf_cd.value == "9011") {
							show_message("일용근로소득은 사용할 수 없습니다.");
							incm_clsf_cd.value = "";
							return;
						}
					
						if (incm_clsf_cd.value == "" || incm_clsf_cd.value == "9001" || incm_clsf_cd.value == "9011" ||
  						    incm_clsf_cd.value == "9003" || incm_clsf_cd.value == "9004" || incm_clsf_cd.value == "90041" ||
  						    incm_clsf_cd.value == "90042" || incm_clsf_cd.value == "9005" || incm_clsf_cd.value == "9010") {
  						    	// 
  						}
  						else {
  							show_message("정확한 데이터를 입력하십시오.");
  							incm_clsf_cd.value = "";
  							model.setFocus("incm_clsf_cd");
//  							return;
  						}

						if ( incm_clsf_cd.value == "9001" || incm_clsf_cd.value == "9005" || incm_clsf_cd.value == "9004" ) {
							//debugger;
							//tax_dirinput.disabled = false;
						}else{
							//tax_dirinput.disabled = true;
						}
  						// 소득구분에 따른 필수항목 set 하기위해 예산코드 CHANGE 강제 invoke
  						//budg_cd.dispatch("xforms-value-changed");
  						
  						// 소득구분을 선택하면 원천징수액을 0으로 만든다(기본 세율로 재계산) 2000.01.10. 백승민
						//with_tax.value = "0";
						//fnWithTaxSetting();		
					]]>
				</script>
			</select1>
			<caption id="caption57" class="list_cap03" style="left:65.85%; top:100px; width:6.60%; height:26px; text-align:center; ">어음상태</caption>
			<select1 id="note_stat" ref="/root/resData/resform/note_stat" appearance="minimal" editmode="inputsearch" style="left:72.87%; top:104px; width:10.11%; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2290_m/dataSet/NOTE_STAT_CURLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(note_stat, note_stat.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(note_stat,"");
							return;
						}
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(frcr_amt.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("frcr_amt",true);
						}else{
							frcr_amt.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(note_stat.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("frcr_amt",true);
							frcr_amt.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</select1>
		</group>
		<group id="group_scr" class="gro_sel" style="left:1.06%; top:49px; width:97.57%; height:87px; ">
			<caption id="caption9" class="list_cap02" style="left:52.55%; top:0px; width:47.45%; height:26px; text-align:center; "/>
			<caption id="caption3" class="list_cap02" style="left:10.83%; top:0px; width:38.89%; height:26px; text-align:center; "/>
			<input id="srch_slip_occr_dt" ref="/root/reqData/searchData/slip_occr_dt" class="req" navindex="2" autonext="false" inputtype="date" style="left:14.95%; top:4px; width:9.75%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setFocus("srch_slip_clsf_cd",true);
					}
					]]>
				</script>
			</input>
			<caption id="caption5" class="list_cap02" visibility="hidden" style="left:0.00%; top:25px; width:49.73%; height:51px; text-align:center; "/>
			<caption id="caption7" class="list_cap02" visibility="hidden" style="left:64.68%; top:50px; width:34.56%; height:26px; text-align:center; "/>
			<caption id="caption8" class="list_cap03" style="left:49.62%; top:0px; width:7.80%; height:26px; text-align:center; ">청구부서</caption>
			<caption id="caption10" class="list_cap03" style="left:75.30%; top:0px; width:7.80%; height:26px; text-align:center; ">입력자사번</caption>
			<caption id="caption11" class="list_cap02" visibility="hidden" style="left:64.68%; top:25px; width:34.56%; height:26px; text-align:center; "/>
			<input id="rmks1" ref="/root/resData/resform/rmks1" class="req" visibility="hidden" inputtype="input" style="left:65.11%; top:54px; width:33.69%; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						for(var i=1; i<datagrid1.rows-1;i++){
							set_refvalue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST1/record["+i+"]/rmks1",rmks1.value);
						}
						datagrid1.refresh();					
					]]>
				</script>
			</input>
			<output id="srch_slip_seq" ref="/root/reqData/searchData/slip_seq" class="req" navindex="4" visibility="visible" appearance="output" maxlength="3" style="left:39.44%; top:4px; width:3.25%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setFocus("clam_dept_cd",true);
					}
					]]>
				</script>
			</output>
			<caption id="caption4" class="list_cap03" visibility="hidden" style="left:48.54%; top:50px; width:16.25%; height:26px; text-align:center; ">제목</caption>
			<caption id="caption6" style="left:16.25%; top:26px; width:17.33%; height:18px; font-size:8pt; color:#ff00ff; text-align:center; ">(입력일자-전표구분)</caption>
			<select1 id="srch_slip_clsf_cd" ref="/root/reqData/searchData/slip_clsf_cd" class="req" navindex="3" appearance="minimal" editmode="inputsearch" style="left:25.03%; top:4px; width:14.08%; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_3250_m/dataSet/CURLIST1/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(srch_slip_clsf_cd, srch_slip_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(srch_slip_clsf_cd,"");
							return;
						}
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[			
					if(event.keycode == "13"){
						model.setFocus("srch_slip_seq",true);
					}
					]]>
				</script>
			</select1>
			<input id="clam_dept_cd" ref="/root/reqData/searchData/clam_dept_cd" accesskey="f2" class="req" navindex="5" autonext="false" inputtype="button" maxlength="6" style="left:57.64%; top:4px; width:9.75%; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[						
						var var_con_date = "";

						if (srch_slip_occr_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_slip_occr_dt.value.length;
							if(num_ch == 8){
								var_con_date = srch_slip_occr_dt.value;
							}else if(num_ch == 6){
								var_con_date = srch_slip_occr_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = srch_slip_occr_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "I");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[					
						var var_con_date = "";

						if (srch_slip_occr_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = srch_slip_occr_dt.value.length;
							if(num_ch == 8){
								var_con_date = srch_slip_occr_dt.value;
							}else if(num_ch == 6){
								var_con_date = srch_slip_occr_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = srch_slip_occr_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (clam_dept_cd.value.length== 6) {							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
							model.setValue("/root/reqData/fwdData/dept_cd", clam_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "I");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								pch_cgbuseonm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
								model.setValue("/root/resData/resform/use_dept_cd",model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd"));
								model.setValue("/root/resData/resform/pch_buseonm",model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm"));
							}
							else {
								clam_dept_cd.value = "";
								pch_cgbuseonm.value = "";
								model.setValue("/root/resData/resform/use_dept_cd","");
								model.setValue("/root/resData/resform/pch_buseonm","");							
							}
						}
						else {
							clam_dept_cd.value = "";
							pch_cgbuseonm.value = "";
							model.setValue("/root/resData/resform/use_dept_cd","");
							model.setValue("/root/resData/resform/pch_buseonm","");							
						}	
						model.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setFocus("incmg_emp_no",true);
					}
					]]>
				</script>
				<script type="javascript" ev:event="onaccesskey">
					<![CDATA[
						if(model.getFocus() =="clam_dept_cd"){
							clam_dept_cd.dispatch("onbuttonclick");
							model.setFocus("pch_cgbuseonm",true);
						}	
					]]>
				</script>
			</input>
			<input id="incmg_emp_no" ref="/root/reqData/searchData/incmg_emp_no" accesskey="f2" class="req" navindex="6" autonext="false" inputtype="button" maxlength="6" style="left:83.42%; top:4px; width:9.75%; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (incmg_emp_no.value.length == 6) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/emp_no");
							model.setValue("/root/reqData/fwdData/emp_no", incmg_emp_no.value);
							model.send("hd_com_1002");
							
							if (model.getValue("/root/tempData/record/emp_no") != "") {
								pch_irjnm.value = model.getValue("/root/tempData/record/nm_korn");
							}
							else {
								incmg_emp_no.value = "";
								pch_irjnm.value = "";
							}
						}		
						else {
							incmg_emp_no.value = "";
							pch_irjnm.value = "";
						}
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setFocus("datagrid3",true);
						datagrid3.col = 5;
						datagrid3.editCell();
					}
					]]>
				</script>
				<script type="javascript" ev:event="onaccesskey">
					<![CDATA[
						if(model.getFocus() =="incmg_emp_no"){
							incmg_emp_no.dispatch("onbuttonclick");
						}	
					]]>
				</script>
			</input>
			<input id="srch_slip_sub_seq" ref="/root/reqData/searchData/slip_sub_seq" visibility="hidden" maxlength="1" style="left:43.01%; top:4px; width:1.63%; height:18px; "/>
			<input id="pch_cgbuseonm" ref="/root/reqData/searchData/pch_cgbuseonm" editable="false" style="left:67.61%; top:4px; width:7.15%; height:18px; "/>
			<input id="pch_irjnm" ref="/root/reqData/searchData/pch_irjnm" editable="false" style="left:93.50%; top:4px; width:5.09%; height:18px; "/>
			<input id="incmg_dt" ref="/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST/record/incmg_dt" visibility="hidden" editable="false" style="left:0.00%; top:25px; width:9.75%; height:18px; "/>
			<caption id="caption1" class="list_cap03" style="left:0.00%; top:50px; width:16.25%; height:26px; text-align:center; ">결의금액</caption>
			<caption id="caption12" class="list_cap02" visibility="hidden" style="left:16.14%; top:50px; width:33.59%; height:26px; text-align:center; "/>
			<input id="reso_amt" ref="/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST/record/reso_amt" inputtype="input" caption="결의금액" style="left:16.58%; top:54px; width:20.26%; height:18px; "/>
			<caption id="caption2" class="list_cap03" style="left:0.00%; top:0px; width:14.52%; height:26px; text-align:center; ">전표번호</caption>
			<input id="input2" ref="/root/src_3" style="left:0.00%; top:30px; width:10.83%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						button8.dispatch("onclick");
					}
					]]>
				</script>
			</input>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST1/record" visibility="hidden" caption="행번호^예산코드^예산코드명^차변금액^대변금액^적요1^적요2^차대구분^거래처구분^거래처코드^거래처명^부거래처명^관리구분^관리번호^소득구분^매체코드^상세매체^행사코드^행사명^사용부서^사용부서명^기산일^만기일^은행코드^은행명^단위^수량^대상코드^대상명^대상일자^대상금액^외화구분^외화금액^환율^어음상태^통합거래처^고정자산^잡수익^세금계산서^작성일자^사업장코드^공급자번호^상계전표^전사전표구분^전사전표번호^setoff_slip_occr_dt^setoff_slip_clsf_cd^setoff_slip_seq^setoff_slip_sub_seq^setoff_slip_arow_no^caption1^caption2" colsep="#" colwidth="50, 50, 150, 80, 80, 200, 200, 50, 80, 100, 150, 150, 100, 100, 100, 100, 100, 100, 100, 50, 100, 100, 100, 100, 100, 100, 30, 50, 100, 100, 80, 100, 80, 50, 50, 70, 50, 100, 150, 100, 100, 100, 150, 100, 150, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:1.06%; top:278px; width:97.89%; height:75px; ">
			<!-- 1.행번호          -->
			<col ref="slip_arow_no"/>
			<!-- 2.예산코드        -->
			<col ref="budg_cd"/>
			<!-- 3.예산코드명      -->
			<col ref="pch_sdysnm"/>
			<!-- 4.차변금액        -->
			<col ref="dr_amt"/>
			<!-- 5.대변금액        -->
			<col ref="crdt_amt"/>
			<!-- 6.적요1           -->
			<col ref="rmks1"/>
			<!-- 7.적요2           -->
			<col ref="rmks2" style="left:630px; top:20px; width:200px; height:20px; "/>
			<!-- 8.차대구분        -->
			<col ref="drcr_clsf"/>
			<!-- 9.거래처구분코드  -->
			<col ref="dlco_clsf_cd"/>
			<!-- 10.거래처코드     -->
			<col ref="dlco_cd"/>
			<!-- 11.거래처명       -->
			<col ref="dlco_nm"/>
			<!-- 12.부거래처명     -->
			<col ref="boks_dlco_nm"/>
			<!-- 13.관리구분코드   -->
			<col ref="mang_clsf_cd"/>
			<!-- 14.관리번호       -->
			<col ref="mang_no"/>
			<!-- 15.소득구분코드   -->
			<col ref="incm_clsf_cd"/>
			<!-- 16.매체코드       -->
			<col ref="medi_cd"/>
			<!-- 17.상세매체코드   -->
			<col ref="dtls_medi_cd"/>
			<!-- 18.행사코드       -->
			<col ref="evnt_cd"/>
			<!-- 19.행사코드명     -->
			<col ref="pch_hsnm"/>
			<!-- 20.사용부서코드   -->
			<col ref="use_dept_cd"/>
			<!-- 21.사용부서코드명 -->
			<col ref="pch_buseonm"/>
			<!-- 22.기산일자       -->
			<col ref="comp_dt"/>
			<!-- 23.만기일자       -->
			<col ref="mtry_dt"/>
			<!-- 24.은행코드       -->
			<col ref="bank_cd"/>
			<!-- 25.은행코드명     -->
			<col ref="pch_banknm"/>
			<!-- 26.단위           -->
			<col ref="unit"/>
			<!-- 27.수량           -->
			<col ref="qunt"/>
			<!-- 28.대상계정코드   -->
			<col ref="obj_acct_cd"/>
			<!-- 29.대상계정코드명 -->
			<col ref="pch_dsacctnm"/>
			<!-- 30.대상일자       -->
			<col ref="obj_dt"/>
			<!-- 31.대상금액       -->
			<col ref="obj_amt"/>
			<!-- 32.외화구분코드   -->
			<col ref="frcr_clsf_cd"/>
			<!-- 33.외화금액       -->
			<col ref="frcr_amt"/>
			<!-- 34.환율           -->
			<col ref="exrate"/>
			<!-- 35.어음상태       -->
			<col ref="note_stat"/>
			<!-- 36.통합거래처코드 -->
			<col ref="intg_dlco_cd"/>
			<!-- 37.고정자산코드   -->
			<col ref="prop_equip_cd"/>
			<!-- 38.잡수익 -->
			<col ref="etc_in"/>
			<!-- 39.세금계산서번호 -->
			<col ref="tax_stmt_no" format="99-99-99999999-9999"/>
			<!-- 40.작성일자 -->
			<col ref="make_dt"/>
			<!-- 41.사업장코드 -->
			<col ref="erplace_cd"/>
			<!-- 42.공급자번호 -->
			<col ref="ern"/>
			<!-- 43.상계전표번호   -->
			<col ref="setoff_slip_no"/>
			<!-- 44.전사전표구분   -->
			<col ref="occr_slip_clsf"/>
			<!-- 45.전사전표번호   -->
			<col ref="occr_slip"/>
			<!-- 46.setoff_slip_occr_dt   -->
			<col ref="setoff_slip_occr_dt" visibility="hidden"/>
			<!-- 47.setoff_slip_clsf_cd   -->
			<col ref="setoff_slip_clsf_cd" visibility="hidden"/>
			<!-- 48.setoff_slip_seq   -->
			<col ref="setoff_slip_seq" visibility="hidden"/>
			<!-- 49.setoff_slip_sub_seq   -->
			<col ref="setoff_slip_sub_seq" visibility="hidden"/>
			<!-- 50.setoff_slip_arow_no   -->
			<col ref="setoff_slip_arow_no" visibility="hidden"/>
			<col ref="vat_amt" visibility="hidden"/>
			<col ref="suply_amt" visibility="hidden"/>
			<col ref="email_id" visibility="hidden"/>
			<col ref="remk" visibility="hidden"/>
			<col ref="item" visibility="hidden"/>
			<col ref="re_issu_resn_cd" visibility="hidden"/>
		</datagrid>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record" dragmode="false" dropmode="false" allowbigselection="false" allowselection="false" caption="행번호^차대구분^예산코드^예산코드명^거래처코드^거래처명^부거래처명^차변금액^대변금액^적요2^적요1^부거래처명^관리구분^관리번호^소득구분^매체코드^상세매체^행사코드^행사명^사용부서^사용부서명^기산일^만기일^은행코드^은행명^단위^수량^대상코드^대상명^대상일자^대상금액^외화구분^외화금액^환율^어음상태^통합거래처^고정자산^잡수익^세금계산서^작성일자^사업장코드^공급자번호^상계전표^전사전표구분^전사전표번호^setoff_slip_occr_dt^setoff_slip_clsf_cd^setoff_slip_seq^setoff_slip_sub_seq^setoff_slip_arow_no" colsep="#" colwidth="50, 67, 95, 110, 130, 130, 100, 80, 80, 107, 200, 150, 100, 100, 100, 100, 100, 100, 100, 50, 100, 100, 100, 100, 100, 100, 30, 50, 100, 100, 80, 100, 80, 50, 50, 70, 50, 100, 150, 100, 100, 100, 150, 100, 150, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="byrestricrow" rowheader="update" rowsep="|" navindex="8" accesskey="f2" style="left:1.06%; top:275px; width:97.89%; height:270px; text-align:center; ">
			<!-- 1.행번호          -->
			<col class="req" ref="slip_arow_no" maxlength="6"/>
			<!-- 2.차대구분        -->
			<col ref="drcr_clsf" type="input" visibility="hidden"/>
			<!-- 3.예산코드        -->
			<col class="req" autonext="false" ref="budg_cd" type="inputbutton" style="border-style:sunken; "/>
			<!-- 4.예산코드명      -->
			<col class="req" ref="pch_sdysnm" type="output" style="text-align:left; "/>
			<!-- 5.거래처코드     -->
			<col autonext="false" ref="dlco_cd" type="inputbutton" style="left:370px; top:20px; width:100px; height:20px; border-style:sunken; "/>
			<!-- 6.거래처명       -->
			<col ref="dlco_nm" style="left:470px; top:20px; width:100px; height:20px; "/>
			<!-- 7.부거래처명     -->
			<col ref="boks_dlco_nm" visibility="hidden"/>
			<!-- 8.차변금액        -->
			<col class="req" ref="dr_amt" type="input" format="(-)#,###" style="text-align:right; "/>
			<!-- 9.대변금액        -->
			<col class="req" ref="crdt_amt" type="input" format="(-)#,###" style="text-align:right; "/>
			<!-- 10.적요2           -->
			<col ref="rmks2" type="input" style="text-align:left; "/>
			<!-- 11.적요1           -->
			<col ref="rmks1" visibility="hidden"/>
			<!-- 12.거래처구분코드  -->
			<col ref="dlco_clsf_cd" visibility="hidden"/>
			<!-- 13.관리구분코드   -->
			<col ref="mang_clsf_cd" visibility="hidden"/>
			<!-- 14.관리번호       -->
			<col ref="mang_no" visibility="hidden"/>
			<!-- 15.소득구분코드   -->
			<col ref="incm_clsf_cd" visibility="hidden"/>
			<!-- 16.매체코드       -->
			<col ref="medi_cd" visibility="hidden"/>
			<!-- 17.상세매체코드   -->
			<col ref="dtls_medi_cd" visibility="hidden"/>
			<!-- 18.행사코드       -->
			<col ref="evnt_cd" visibility="hidden"/>
			<!-- 19.행사코드명     -->
			<col ref="pch_hsnm" visibility="hidden"/>
			<!-- 20.사용부서코드   -->
			<col ref="use_dept_cd" visibility="hidden"/>
			<!-- 21.사용부서코드명 -->
			<col ref="pch_buseonm" visibility="hidden"/>
			<!-- 22.기산일자       -->
			<col ref="comp_dt" visibility="hidden"/>
			<!-- 23.만기일자       -->
			<col ref="mtry_dt" visibility="hidden"/>
			<!-- 24.은행코드       -->
			<col ref="bank_cd" visibility="hidden"/>
			<!-- 25.은행코드명     -->
			<col ref="pch_banknm" visibility="hidden"/>
			<!-- 26.단위           -->
			<col ref="unit" visibility="hidden"/>
			<!-- 27.수량           -->
			<col ref="qunt" visibility="hidden"/>
			<!-- 28.대상계정코드   -->
			<col ref="obj_acct_cd" visibility="hidden"/>
			<!-- 29.대상계정코드명 -->
			<col ref="pch_dsacctnm" visibility="hidden"/>
			<!-- 30.대상일자       -->
			<col ref="obj_dt" visibility="hidden"/>
			<!-- 31.대상금액       -->
			<col ref="obj_amt" visibility="hidden"/>
			<!-- 32.외화구분코드   -->
			<col ref="frcr_clsf_cd" visibility="hidden"/>
			<!-- 33.외화금액       -->
			<col ref="frcr_amt" visibility="hidden"/>
			<!-- 34.환율           -->
			<col ref="exrate" visibility="hidden"/>
			<!-- 35.어음상태       -->
			<col ref="note_stat" visibility="hidden"/>
			<!-- 36.통합거래처코드 -->
			<col ref="intg_dlco_cd" visibility="hidden"/>
			<!-- 37.고정자산코드   -->
			<col editmode="inputsearch" ref="prop_equip_cd" type="inputbutton" visibility="hidden"/>
			<!-- 38.잡수익 -->
			<col ref="etc_in" visibility="hidden"/>
			<!-- 39.세금계산서번호 -->
			<col ref="tax_stmt_no" visibility="hidden" format="99-99-99999999-9999"/>
			<!-- 40.작성일자 -->
			<col ref="make_dt" visibility="hidden"/>
			<!-- 41.사업장코드 -->
			<col ref="erplace_cd" visibility="hidden"/>
			<!-- 42.공급자번호 -->
			<col ref="ern" visibility="hidden"/>
			<!-- 43.상계전표번호   -->
			<col ref="setoff_slip_no" visibility="hidden"/>
			<!-- 44.전사전표구분   -->
			<col ref="occr_slip_clsf" visibility="hidden"/>
			<!-- 45.전사전표번호   -->
			<col ref="occr_slip" visibility="hidden"/>
			<!-- 46.setoff_slip_occr_dt   -->
			<col ref="setoff_slip_occr_dt" visibility="hidden"/>
			<!-- 47.setoff_slip_clsf_cd   -->
			<col ref="setoff_slip_clsf_cd" visibility="hidden"/>
			<!-- 48.setoff_slip_seq   -->
			<col ref="setoff_slip_seq" visibility="hidden"/>
			<!-- 49.setoff_slip_sub_seq   -->
			<col ref="setoff_slip_sub_seq" visibility="hidden"/>
			<!-- 50.setoff_slip_arow_no   -->
			<col ref="setoff_slip_arow_no" visibility="hidden"/>
			<!-- 51   -->
			<col ref="vat_amt" visibility="hidden"/>
			<!-- 52   -->
			<col ref="suply_amt" visibility="hidden"/>
			<!-- 53   -->
			<col ref="mang_clsf_nm" visibility="hidden"/>
			<!-- 54   -->
			<col ref="email_id" visibility="hidden"/>
			<!-- 55   -->
			<col ref="remk" visibility="hidden"/>
			<!-- 56   -->
			<col ref="item" visibility="hidden"/>
			<!-- 57   -->
			<col ref="re_issu_resn_cd" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var col = datagrid2.col;
					var row = datagrid2.row;
					
					if(col == 3){  //예산코드 
						var budg_cd = datagrid2.valueMatrix(datagrid2.row,3);
						
						if(budg_cd == ""){
							datagrid2.valueMatrix(datagrid2.row,4) = ""; return;
						}
						
						if(isNumber(budg_cd)){
							model.setValue("/root/reqData/searchData/cd", datagrid2.valueMatrix(datagrid2.row,3));							
							model.setValue("/root/reqData/searchData/cdnm", "");
						}else{
							model.setValue("/root/reqData/searchData/cd", "");							
							model.setValue("/root/reqData/searchData/cdnm", datagrid2.valueMatrix(datagrid2.row,3));							
						}
						model.setValue("/root/reqData/searchData/dept_cd", clam_dept_cd.value);

						model.send("mc_co_1002_l");
						if (Number(model.getValue("/root/resData/resform2/dataSet/CURLIST/totalcnt")) == 1) {
							datagrid2.valueMatrix(row,3) =  model.getValue("/root/resData/resform2/dataSet/CURLIST/record/cd");
							datagrid2.valueMatrix(row,4) =  model.getValue("/root/resData/resform2/dataSet/CURLIST/record/cdnm");						
						}else if (Number(model.getValue("/root/resData/resform2/dataSet/CURLIST/totalcnt")) > 1) {												
							gstr_popupid = "budg_cd";					
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/cmpy_cd");
							model.makeNode("/root/reqData/fwdData/cd");
							model.makeNode("/root/reqData/fwdData/cdnm");
							model.makeNode("/root/reqData/fwdData/G_Tag");
							model.makeNode("/root/reqData/fwdData/G_Caption");
							model.makeNode("/root/reqData/fwdData/G_Codenu");
							model.makeNode("/root/reqData/fwdData/G_BRCode");
							model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
							model.setValue("/root/reqData/fwdData/G_Tag", "1");
							model.setValue("/root/reqData/fwdData/G_Caption", "예산코드조회");
							model.setValue("/root/reqData/fwdData/G_Codenu", "");	
							model.setValue("/root/reqData/fwdData/G_BRCode", "");
							
							var budg = datagrid2.valueMatrix(datagrid2.row,3);
							if(isNumber(budg)){
								model.setValue("/root/reqData/fwdData/cd",budg);
								model.setValue("/root/reqData/fwdData/cdnm","");
							}else{
								model.setValue("/root/reqData/fwdData/cd","");
								model.setValue("/root/reqData/fwdData/cdnm",budg);
							}
							window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");		
							
							datagrid2.valueMatrix(row,3)=model.getValue("/root/resData/resform/budg_cd");
							datagrid2.valueMatrix(row,4)=model.getValue("/root/resData/resform/pch_sdysnm");
						}
						else {
							datagrid2.valueMatrix(row,3) = "";
							datagrid2.valueMatrix(row,4) = "";
							
							datagrid2.col=3;
							datagrid2.editCell();
							return;
						}

						datagrid2.rowStatus(row) = "1";
						// 팝업 끝
						set_refvalue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
						set_refvalue("/root/reqData/searchData/budg_cd", datagrid2.valueMatrix(row, 3));
						//실행
						
						//예산별관리항목별로 필수색 셋팅
						fn_background_color_setting("1");
						fn_dlco_mang_clsf_setting();
						fun_budg_cd_ch();	
						
						model.setFocus("datagrid2",true);
						datagrid2.col=3;						
					}
					
					if (col == 5){  //거래처코드
						var ern = datagrid2.valueMatrix(row,5);
						var ern_arr = new Array();
						
						if(ern == ""){
							datagrid2.valueMatrix(datagrid2.row,6) = ""; return;
						}

						if (ern.indexOf("-") > 0){
							ern_arr = ern.split("-");
						} else {
							ern_arr[0] = ern.substring(0,6);
							ern_arr[1] = ern.substring(6,13);
						}
						var b_corp_clsf_1 = false;
						var b_corp_clsf_2 = false;

						if (CheckResident_number(ern_arr[0], ern_arr[1])){
							b_corp_clsf_1 = true;
							if (ern.indexOf("-") < 0){
								datagrid2.valueMatrix(row,5) = ern_arr[0] + "-" + ern_arr[1];
							}
						} else {
							b_corp_clsf_1 = false;
						}
						var ern_biz = ern.replace(/-/ig, "");
						if (CheckBusiness_Number(ern_biz)){
							if (ern.indexOf("-") < 0){
								datagrid2.valueMatrix(row,5) = ern.substring(0,3) + "-" + ern.substring(3,5) + "-" + ern.substring(5,12);
							}
							b_corp_clsf_2 = true;
						} else {
							b_corp_clsf_2 = false;
						}
						
						gstr_popupid = "";	
							
						open_fc_acct_1180_("focus","S","","0");

						datagrid2.rowStatus(row) = "1";
					
						model.setFocus("datagrid2",true);
						datagrid2.col=5;
						if(datagrid2.valueMatrix(row,3) == "182000" || datagrid2.valueMatrix(row,3) == "462000"){
							model.setValue("/root/resData/resform/ern",datagrid2.valueMatrix(row,5));
							model.setValue("/root/resData/resform/email_id",datagrid2.valueMatrix(row,54));
						}
					}

					if (col == 8){		
						var budg_cd = datagrid2.valueMatrix(row,3);						
						setoff_slip_no.attribute("background-color") = "white";
						setoff_slip_no.attribute("editable") == "false";													
					}
					if(col == 9){				
						if (Number(datagrid2.valueMatrix(row,9).Trim()) == 0) { return; }  //if (Number(crdt_amt.value.Trim()) == 0) { return; } 
						var budg_cd = datagrid2.valueMatrix(row,3);
						// 예산별관리항목별로 필수색 셋팅
						fn_background_color_setting("9");						
						setoff_slip_no.attribute("background-color") = "white";						
						model.refresh();	
					}	
				]]>
			</script>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					//그리드 스크롤바 클릭, 더블클릭 방지 소스
					if (-1 != event.target.lastIndexOf("scroll.thumb")) {
						return;
					}
					
					if (datagrid2.mouseRow < 1) {
						return;
					}
					
					var grid = eval(event.currentTarget);
					
					var rowid = datagrid2.row;
					var colid = datagrid2.col;
					
					if (rowid < grid.fixedRows || colid < grid.fixedCols) {
						return;
					}					
					if(colid == 3){
						datagrid2.col = 3;
						datagrid2.editCell();
						return;
						}
					if(colid == 5){
						datagrid2.col = 5;
						datagrid2.editCell();
						return;
					}

				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					var row = datagrid2.row;
					var col = datagrid2.col;
					if(event.keycode == "27"){
						return;
					}
					if(event.keycode == "13"){						
						if(col == 3){		
							var budg_cd = datagrid2.valueMatrix(datagrid2.row,3);
							if(budg_cd == "011400"){
								model.makeNode("/root/reqData/fwdData/acct_mang_no_ref");	
								model.setValue("/root/reqData/fwdData/acct_mang_no_ref", "/root/resData/gridData/rcpm_dtls/record/g1_deps_psbk");											
								model.makeNode("/root/reqData/fwdData/tran_amt_ref");	
								model.setValue("/root/reqData/fwdData/tran_amt_ref", "/root/resData/gridData/rcpm_dtls/record/g1_rcpm_amt");
								model.makeNode("/root/reqData/fwdData/tran_content_ref");	
								model.setValue("/root/reqData/fwdData/tran_content_ref", "/root/resData/gridData/rcpm_dtls/record/g1_rcpm_pers_nm");		
								model.makeNode("/root/reqData/fwdData/acct_tonghwa_ref");	
								model.setValue("/root/reqData/fwdData/acct_tonghwa_ref", "/root/resData/gridData/rcpm_dtls/record/g1_frex_clsf");								
								model.makeNode("/root/reqData/fwdData/frex_amt_ref");
								model.setValue("/root/reqData/fwdData/frex_amt_ref", "/root/resData/gridData/rcpm_dtls/record/g1_frex_amt");		
								model.makeNode("/root/reqData/fwdData/tran_clsfy_ref");
								model.setValue("/root/reqData/fwdData/tran_clsfy_ref", "/root/resData/gridData/rcpm_dtls/record/tran_clsfy");		
								/*if( getProperty("ss_cmpycd") == "326") { //조선경제아이요청 2015.02.13
								loadRcpmDtlsPop("H1"
												,""
												,"/root/resData/gridData/rcpm_dtls/record/biz_reg_no"
												,"/root/resData/gridData/rcpm_dtls/record/bank_id"
												,"/root/resData/gridData/rcpm_dtls/record/acct_num"
												,"/root/resData/gridData/rcpm_dtls/record/g1_rcpm_dt"
												,"/root/resData/gridData/rcpm_dtls/record/tran_date_seq"
												,"/root/resData/gridData/rcpm_dtls/record/current_clsf"
											   ,"/root/reqData/fwdData"); 
									
								model.setValue("/root/resData/resform/comp_dt",model.getValue("/root/resData/gridData/rcpm_dtls/record/g1_rcpm_dt"));
								model.setValue("/root/resData/resform/boks_dlco_nm",model.getValue("/root/resData/gridData/rcpm_dtls/record/g1_rcpm_pers_nm"));
								model.setValue("/root/resData/resform/mang_clsf_cd",model.getValue("/root/resData/gridData/rcpm_dtls/record/g1_deps_psbk"));			
								var frcr_clsf_cd = model.getValue("/root/resData/gridData/rcpm_dtls/record/g1_frex_clsf");
								if(frcr_clsf_cd == "KRW"){									
								}else{									
									model.setValue("/root/resData/resform/frcr_clsf_cd",frcr_clsf_cd);
									model.setValue("/root/resData/resform/frcr_amt",model.getValue("/root/resData/gridData/rcpm_dtls/record/g1_frex_amt"));
								}
								var tran_clsfy = model.getValue("/root/resData/gridData/rcpm_dtls/record/tran_clsfy");																
								if(tran_clsfy == "1"){
									datagrid2.valueMatrix(datagrid2.row,8) = model.getValue("/root/resData/gridData/rcpm_dtls/record/g1_rcpm_amt");
								}else{
									datagrid2.valueMatrix(datagrid2.row,9) = model.getValue("/root/resData/gridData/rcpm_dtls/record/g1_rcpm_amt");
								}								
								model.setValue("/root/resData/gridData/rcpm_dtls/record/g1_rcpm_slip_seq","");
								model.setValue("/root/resData/gridData/rcpm_dtls/record/g1_rcpm_dt","");
								model.setValue("/root/resData/gridData/rcpm_dtls/record/g1_rcpm_amt","");
								model.setValue("/root/resData/gridData/rcpm_dtls/record/g1_rcpm_pers_nm","");
								model.setValue("/root/resData/gridData/rcpm_dtls/record/g1_deps_psbk","");
								model.setValue("/root/resData/gridData/rcpm_dtls/record/g1_coms","");
								model.setValue("/root/resData/gridData/rcpm_dtls/record/g1_frex_clsf","");
								model.setValue("/root/resData/gridData/rcpm_dtls/record/g1_exrate","");
								model.setValue("/root/resData/gridData/rcpm_dtls/record/g1_frex_amt","");
								model.setValue("/root/resData/gridData/rcpm_dtls/record/biz_reg_no","");
								model.setValue("/root/resData/gridData/rcpm_dtls/record/bank_id","");
								model.setValue("/root/resData/gridData/rcpm_dtls/record/acct_num","");
								model.setValue("/root/resData/gridData/rcpm_dtls/record/tran_date_seq","");
								model.setValue("/root/resData/gridData/rcpm_dtls/record/current_clsf","");
								model.setValue("/root/resData/gridData/rcpm_dtls/record/tran_clsfy","");
								}*/
								model.refresh();
								model.setFocus("datagrid2",true);
								
							}
							
							if(datagrid2.valueMatrix(row,4) == ""){
								datagrid2.col = 3;
								datagrid2.editCell();
							}else{								
								if(row < 2) {
								}else{
									datagrid2.valueMatrix(row,12) = datagrid2.valueMatrix(row-1,12);	
									datagrid2.valueMatrix(row,5) = datagrid2.valueMatrix(row-1,5);	
									datagrid2.valueMatrix(row,6) = datagrid2.valueMatrix(row-1,6);	
									if(budg_cd == "462000" || budg_cd == "182000"){
										datagrid2.valueMatrix(row,54) = datagrid2.valueMatrix(row-1,54);
									}
								}
								datagrid2.col = 5;
								datagrid2.editCell();	
							}
						}else if(col == 5){							
							datagrid2.col = 8;
							datagrid2.editCell();
						}else if(col == 8){
							if(datagrid2.valueMatrix(row,3) == "462000"){
								if(datagrid2.valueMatrix(row,8) != 0 ){
									fun_vat_budg_cd_ch();
									obj_acct_cd.attribute("background-color") = "white";
									obj_amt.attribute("background-color") = "white";
								}else{
									fun_budg_cd_ch();
								}
							}
							
							gstr_popupid = "eenosb";	
							if(datagrid2.valueMatrix(row,3) == "050100" && datagrid2.valueMatrix(row,8) == 0){
								window.load("../../fc/func/FC_FUNC_1470.xrw", "modal", "", "align:center; width:665; height:580; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");		
								model.setFocus("datagrid2",true);
								fn_background_color_setting("9");						
								comp_dt.attribute("background-color") = "white";		
							}else if(datagrid2.valueMatrix(row,3) == "050100" && datagrid2.valueMatrix(row,8) != 0) {
								comp_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
							}
							datagrid2.col = 9;
							datagrid2.editCell();
							var dr_amt = model.getValue("/root/tempData2/tot_dr_amt");													
							var crdt_amt = model.getValue("/root/tempData2/tot_crdt_amt");	
							datagrid3.valueMatrix(datagrid3.row,9) = dr_amt;
							datagrid3.valueMatrix(datagrid3.row,11) = dr_amt - crdt_amt;
						}else if(col == 9){							
							if(datagrid2.valueMatrix(row,3) == "182000"){
								if(datagrid2.valueMatrix(row,9) != 0){
									fun_vat_budg_cd_ch();
									obj_acct_cd.attribute("background-color") = "white";
									obj_amt.attribute("background-color") = "white";
								}else{
									fun_budg_cd_ch();
								}
							}
							fn_background_color_setting("1");  //20180824 봉은정추가
							datagrid2.col = 10;
							datagrid2.editCell();			
							var dr_amt = model.getValue("/root/tempData2/tot_dr_amt");
							var crdt_amt = model.getValue("/root/tempData2/tot_crdt_amt");								
							datagrid3.valueMatrix(datagrid3.row,10) = crdt_amt;
							datagrid3.valueMatrix(datagrid3.row,11) = dr_amt - crdt_amt;
						}else if(col == 10){							
							model.setFocus("use_dept_cd",true);
						}							
					}	
				
				]]>
			</script>
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					var col = datagrid2.col;
					var row = datagrid2.row;
					if(col ==3){
						gstr_popupid = "budg_cd";					
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cmpy_cd");
						model.makeNode("/root/reqData/fwdData/G_Tag");
						model.makeNode("/root/reqData/fwdData/G_Caption");
						model.makeNode("/root/reqData/fwdData/G_Codenu");
						model.makeNode("/root/reqData/fwdData/G_BRCode");
						model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
						model.setValue("/root/reqData/fwdData/G_Tag", "1");
						model.setValue("/root/reqData/fwdData/G_Caption", "예산코드조회");
						model.setValue("/root/reqData/fwdData/G_Codenu", "");	
						model.setValue("/root/reqData/fwdData/G_BRCode", "");
						window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");		
						
						datagrid2.valueMatrix(row,3)=model.getValue("/root/resData/resform/budg_cd");
						datagrid2.valueMatrix(row,4)=model.getValue("/root/resData/resform/pch_sdysnm");
						//입력값 설정
						set_refvalue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
						set_refvalue("/root/reqData/searchData/budg_cd", datagrid2.valueMatrix(row,3));
						//실행
						model.send("fc_acct_2293_s");						
						// 전사공통비여부가 "1" 이면 사용부서 "999999"
						use_dept_cd.attribute("editable") = "true";
						use_dept_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
					
						if (model.getValue("/root/resData/fc_acct_2293_s/dataSet/CUR_WHCO_NDSTB_CD_LIST/record[1]/whco_comn_cost_yn") == "Y") {
							use_dept_cd.attribute("editable") = "false";
							use_dept_cd.value = "999999";
							pch_buseonm.value = "공통부서";
						}
						// 예산별관리항목별로 필수색 셋팅
						fn_background_color_setting("1");

						// 예산코드에 따른 거래처구분, 관리구분 콤보 셋팅
						fn_dlco_mang_clsf_setting();

						fun_budg_cd_ch();						
						
						model.setFocus("datagrid2",true);
						datagrid2.col = 3;
						datagrid2.editCell();							
					}
					if( col == 5){
						gstr_popupid = "";						
						if (open_fc_acct_1180("button","s","","0")) {
							if(datagrid2.valueMatrix(row,3) == "182000" || datagrid2.valueMatrix(row,3) == "462000"){
							model.setValue("/root/resData/resform/ern",datagrid2.valueMatrix(row,5));
							model.setValue("/root/resData/resform/email_id",datagrid2.valueMatrix(row,54));
							}
						}
						else {
							//팝업에서 취소 버튼을 누른 경우		
							if(datagrid2.valueMatrix(row,3) == "182000" || datagrid2.valueMatrix(row,3) == "462000"){
							model.setValue("/root/resData/resform/ern","");
							model.setValue("/root/resData/resform/email_id","");
							}
						}
						model.refresh();
						model.setFocus("datagrid2",true);
						datagrid2.col=5;
						datagrid2.editCell();

					}
				]]>
			</script>
			<script type="javascript" ev:event="onaccesskey">
				<![CDATA[
					if(model.getFocus() == "datagrid2.input"){
						model.setFocus("datagrid2",true);
						datagrid2.dispatch("onbuttonclick");
					}
				]]>
			</script>
			<script type="javascript" ev:event="onkeyup">
				<![CDATA[
				var col = datagrid2.col;	
				if(col == 8 || col == 9 ){
					if(event.keycode == "107"){		
					   datagrid2.endEditCell();
					   datagrid2.valueMatrix(datagrid2.row, col) = datagrid2.valueMatrix(datagrid2.row, col) + "000";
					   datagrid2.editCell();
					}						
				}
				]]>
			</script>
			<script type="javascript" ev:event="onrowchanged">
				<![CDATA[
					var cur_row = datagrid2.row;
					if(lst_row != 0){		
						if (fn_FormToGrid(lst_row, "I") == false) {
							datagrid2.row = lst_row;
							return;
						}	
						fn_group3_reset();
					}

					if(datagrid2.valueMatrix(cur_row,3) != ""){
						fn_GridToForm(cur_row);
						fn_background_color_setting("1");	
					}
					lst_row = datagrid2.row;					
					
					datagrid2.col = 3;
					datagrid2.editCell(); 	
					
					var row1 = datagrid3.row;
					datagrid3.valueMatrix(row1,9) = model.getValue("/root/tempData2/tot_dr_amt");
					datagrid3.valueMatrix(row1,10) = model.getValue("/root/tempData2/tot_crdt_amt");
					datagrid3.valueMatrix(row1,11) = model.getValue("/root/tempData2/tot_dr_amt") - model.getValue("/root/tempData2/tot_crdt_amt");
					]]>
			</script>
		</datagrid>
		<group id="group1" class="gro_sel" visibility="hidden" style="left:1.06%; top:715px; width:97.89%; height:26px; ">
			<caption id="caption18" class="list_cap03" style="left:308px; top:0px; width:120px; height:26px; text-align:center; ">차변합계</caption>
			<caption id="caption19" class="list_cap02" style="left:427px; top:0px; width:190px; height:26px; text-align:center; "/>
			<caption id="caption24" class="list_cap03" style="left:616px; top:0px; width:120px; height:26px; text-align:center; ">대변합계</caption>
			<caption id="caption25" class="list_cap02" style="left:735px; top:0px; width:191px; height:26px; text-align:center; "/>
			<input id="dr_amt_sum" ref="/root/resData/resform/dr_amt_sum" editable="false" style="left:431px; top:4px; width:155px; height:18px; "/>
			<input id="crdt_amt_sum" ref="/root/resData/resform/crdt_amt_sum" editable="false" style="left:739px; top:4px; width:155px; height:18px; "/>
		</group>
		<group id="group_tit" class="gro_tit" style="left:0.00%; top:0px; width:100.00%; height:39px; ">
			<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:0.53%; top:10px; width:99.00%; height:29px; "/>
		</group>
		<button id="btn_insrt" class="btn02" navindex="32" visibility="hidden" crud="R" style="left:93.45%; top:633px; width:5.50%; height:21px; ">
			<caption>행입력</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[							
						var row = datagrid2.row;
						if (fn_FormToGrid(row, "I") == false) {
							return;
						}	
						fn_group3_reset();
					]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
						var row = datagrid2.row;
						if(event.keycode == "13"){
							if (fn_FormToGrid(row, "I") == false) {
								return;
							}else{		
								fn_group3_reset();
								model.setFocus("button2",true);	
								button2.attribute("border-style") ="dotted";
							}
						}
						button2.attribute("border-style") ="none";
				]]>
			</script>
		</button>
		<group id="grp_buttons" class="gro_sel" style="left:16.07%; top:14px; width:76.11%; height:21px; ">
			<button id="btn_select" class="btn02" navindex="42" crud="R" style="left:24.17%; top:0px; width:7.22%; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[	
						if(model.property("FC_ACCT_3250_srch_slip_seq") == ""){
							model.setValue("/root/reqData/searchData/slip_seq","");
							model.setValue("/root/reqData/searchData/slip_sub_seq","");
						}
						model.send("fc_acct_3256_l");
						model.removeNodeset("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST1");						
						model.removeNodeset("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2");	
						model.refresh();	
						if (model.getValue("/root/resData/gridData/fc_acct_3256_l/dataSet/slip_list/totalcnt") == 0) {
							show_message("검색결과가 없습니다.");
							return;
						}
					]]>
				</script>
			</button>
			<button id="button1" class="btn02" navindex="43" crud="C" style="left:31.67%; top:0px; width:7.22%; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var row_2 = datagrid2.row;

						if(datagrid2.valueMatrix(row_2,3) == ""){
							datagrid2.deleteRow(row_2);
							lst_row = lst_row-1;
						} else{
							if (fn_FormToGrid(datagrid2.row, "I") == false) {	
							return;
							}	
						}
						
						var row_id = datagrid3.row;
						for(var i=1; i<datagrid2.rows;i++){  //적요1 등록
							model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+i+"]/rmks1",datagrid3.valueMatrix(row_id,5));						
						}
						
						var _clsf_cd = datagrid3.valueMatrix(row_id,6);
						if (_clsf_cd == "62"){  //원고료입력방지
							show_message("해당 유형("+_clsf_cd+")의 전표는 입력할 수 없습니다."); return;
						}
						
						if(datagrid3.valueMatrix(row_id,2).Trim() == ""){
							alert("회계일자를 입력해주세요."); return;
						}
						model.makeNode("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST1");  //행추가후 사라져서 넣음 20140905
						model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST/record/fisc_dt",datagrid3.valueMatrix(row_id,2));  //회계일자 동일하게 셋팅						
						model.copyNode("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST1","/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2");	

						srch_slip_clsf_cd.value = datagrid3.valueMatrix(row_id,6); //전표구분코드
						if (!check_reqItem(srch_slip_clsf_cd,"trim","focus","전표구분코드는 필수입력항목입니다.")) { return; }     
						// 백승민, 박지원
						//if(getProperty("ss_cmpycd") == "100" || getProperty("ss_cmpycd") == "332"){ //2012.01.11
						var orgStr1 = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_ss_cmpycd");
						if(instr_yn(orgStr1, getProperty("ss_cmpycd"))){						
							//if ( getProperty("ss_emp_no") == "194030" || getProperty("ss_emp_no") == "194082"  || getProperty("ss_emp_no") == "210006" || getProperty("ss_emp_no") == "it0000" || getProperty("ss_emp_no") == "196024" ) { //2012.01.11
							var orgStr2 = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_ss_emp_no");
							if(instr_yn(orgStr2, getProperty("ss_emp_no"))){
								
							}else{
								//if (srch_slip_clsf_cd.value == "54" && getProperty("ss_emp_no") == "202036") { //2012.01.11
								var orgStr3 = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_srch_slip_clsf_cd_1");
								var orgStr4 = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_ss_emp_no_010");
								if(instr_yn(orgStr3, srch_slip_clsf_cd.value) && instr_yn(orgStr4, getProperty("ss_emp_no")) ) {
									
								}
								//if (srch_slip_clsf_cd.value != "90" && srch_slip_clsf_cd.value != "95") {  //2012.01.11					
								var orgStr5 = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_srch_slip_clsf_cd_2");
								var orgStr6 = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_srch_slip_clsf_cd_3");																
								/*if(! instr_yn(orgStr5, srch_slip_clsf_cd.value) && ! instr_yn(orgStr6, srch_slip_clsf_cd.value)){
									show_message("수정할 수 없는 전표구분코드 입니다.('90,'95'만 입력)");
									model.setFocus("srch_slip_clsf_cd");
									return;								
								}*/
							}
						}
						//srch_slip_seq.value = datagrid3.valueMatrix(row_id, 3);
						var srch_slip_seq_ = datagrid3.valueMatrix(row_id, 3);
						//if (srch_slip_seq.value.Trim() != "") {
						if (srch_slip_seq_.Trim() != "") {
							show_message("일련번호를 지워주세요.");
							//model.setFocus("srch_slip_seq");
							return;
						}
						
						if (!check_reqItem(clam_dept_cd,"trim","focus","청구부서는 필수입력항목입니다.")) { return; }     
						if (!check_reqItem(incmg_emp_no,"trim","focus","입력자사번은 필수입력항목입니다.")) { return; }     
						
						fn_grid_sum_value(datagrid1, 4, dr_amt_sum);	// 차변합계
						fn_grid_sum_value(datagrid1, 5, crdt_amt_sum);	// 대변합계
						
						//if (Number(dr_amt_sum.value) != Number(crdt_amt_sum.value)) {
						if (model.getValue("/root/tempData2/tot_dr_amt") != model.getValue("/root/tempData2/tot_crdt_amt")){
							show_message("차대변 금액이 일치하지 않습니다.");
							return;	
						}
						if(model1.alert("등록하시겠습니까?", "알림", 4)  == 7){	return; }
						
						for (i=1; i<datagrid1.rows; i++) {
							datagrid1.rowStatus(i) = "3";
						}
						
						model.setValue("/root/reqData/fc_acct_3253_i/cmpy_cd", getProperty("ss_cmpycd"));
						model.setValue("/root/reqData/fc_acct_3253_i/slip_occr_dt", datagrid3.valueMatrix(row_id,2));
						model.setValue("/root/reqData/fc_acct_3253_i/slip_clsf_cd", datagrid3.valueMatrix(row_id,6));
						model.setValue("/root/reqData/fc_acct_3253_i/slip_seq", datagrid3.valueMatrix(row_id,3));
						model.setValue("/root/reqData/fc_acct_3253_i/slip_sub_seq", "0");
						model.setValue("/root/reqData/fc_acct_3253_i/clam_dept_cd", clam_dept_cd.value);
						model.setValue("/root/reqData/fc_acct_3253_i/incmg_emp_no", incmg_emp_no.value);
						model.setValue("/root/reqData/fc_acct_3253_i/fisc_dt", fisc_dt.value);
						model.setValue("/root/reqData/fc_acct_3253_i/incmg_pers", getProperty("ss_emp_no"));
						model.setValue("/root/reqData/fc_acct_3253_i/incmg_pers_ipadd", "");
						model.setValue("/root/reqData/fc_acct_3253_i/incmg_dt", datagrid3.valueMatrix(row_id,2));
					
						for (i=1; i<datagrid1.rows - 1; i++) {
							datagrid1.valueMatrix(i, 46) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(0, 8);
							datagrid1.valueMatrix(i, 47) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(8, 10);
							datagrid1.valueMatrix(i, 48) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(10, 13);
							datagrid1.valueMatrix(i, 49) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(13, 14);
							datagrid1.valueMatrix(i, 50) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(14, 20);
							if((datagrid1.valueMatrix(i,28) == "320500") && (datagrid1.valueMatrix(i,13) == "")) {
								show_message("선급제세(부가세) 계정의 대상계정이 건설중인자산일 경우 관리구분을 반드시 입력하여야 합니다.");
								return;	
							}							
						}	
						
						model.setValue("/root/reqData/fc_acct_3253_i/multiUpdateData",datagrid1.getUpdateData("insert"));
						
						model.refresh();
						
    					model.send("fc_acct_3253_i");
    						
						if(submit_completed()){
							var row = datagrid3.row;
    						srch_slip_seq.value = model.getValue("/root/resData/dataSet/slip_seq");
						    show_message("저장되었습니다.");
							model.send("fc_acct_3256_l");
							model.removeNodeset("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST1");						
							model.removeNodeset("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2");	
							fn_group3_reset();
							model.refresh();
						}
					]]>
				</script>
			</button>
			<button id="btn_update" class="btn02" navindex="44" crud="U" style="left:39.17%; top:0px; width:7.22%; height:21px; ">
				<caption>수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[						
						if (fn_FormToGrid(datagrid2.row, "I") == false) {
							return;
						}	
						// KEY 변경시 작업불가
						if (gvar_slip_occr_dt != srch_slip_occr_dt.value.Trim().ReplaceString("-", "")
						|| gvar_slip_clsf_cd != srch_slip_clsf_cd.value.Trim().ReplaceString("-", "")
						|| gvar_slip_seq != srch_slip_seq.value.Trim().ReplaceString("-", "")
						|| gvar_slip_sub_seq != srch_slip_sub_seq.value.Trim().ReplaceString("-", "")	) {
							show_message("키가 변경되어서 수정할 수 없는 자료입니다. 다시 조회해 주십시오.");
							model.setFocus("btn_select");
							return;
						}
						
						//if(getProperty("ss_cmpycd") == "100" || getProperty("ss_cmpycd") == "332"){ //2012.01.11
						var orgStr1 = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_ss_cmpycd");
						if(instr_yn(orgStr1, getProperty("ss_cmpycd"))){	
							// 백승민, 박지원
							//if (getProperty("ss_emp_no") == "194030" || getProperty("ss_emp_no") == "194082" || getProperty("ss_emp_no") == "210006" || getProperty("ss_emp_no") == "it0000" || getProperty("ss_emp_no") == "196024" ) { //2012.01.11
							var orgStr2 = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_ss_emp_no");							
							if(instr_yn(orgStr2, getProperty("ss_emp_no"))){							
								// 
							}
							else {
								//if (srch_slip_clsf_cd.value != "90" && srch_slip_clsf_cd.value != "95") { //2012.01.11
								var orgStr3 = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_srch_slip_clsf_cd_2");
								var orgStr4 = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_srch_slip_clsf_cd_3");
								if(! instr_yn(orgStr3, srch_slip_clsf_cd.value) && ! instr_yn(orgStr4, srch_slip_clsf_cd.value)){
									show_message("수정할 수 없는 전표구분코드 입니다.('90,'95'만 입력)");
									model.setFocus("srch_slip_clsf_cd");
									return;								
								}
							}
						}
						
						if (!check_reqItem(srch_slip_clsf_cd,"trim","focus","전표구분코드는 필수입력항목입니다.")) { return; }     
						if (!check_reqItem(clam_dept_cd,"trim","focus","청구부서는 필수입력항목입니다.")) { return; }     
						if (!check_reqItem(incmg_emp_no,"trim","focus","입력자사번은 필수입력항목입니다.")) { return; }     
						
						fn_grid_sum_value(datagrid1, 4, dr_amt_sum);		// 차변합계
						fn_grid_sum_value(datagrid1, 5, crdt_amt_sum);	// 대변합계
		
						//if (Number(dr_amt_sum.value) != Number(crdt_amt_sum.value)) {
						if (model.getValue("/root/tempData2/tot_dr_amt") != model.getValue("/root/tempData2/tot_crdt_amt")){
							show_message("차대변 금액이 일치하지 않습니다.");
							return;	
						}
						
						if(model1.alert("수정하시겠습니까?", "알림", 4)  == 7){	return; }
						
						var row_id = datagrid3.row;
						for(var i=1; i<datagrid2.rows;i++){  //적요1 등록
							model.setValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2/record["+i+"]/rmks1",datagrid3.valueMatrix(row_id,5));
						}
						
						model.copyNode("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST1","/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2");	
						srch_slip_clsf_cd.value = datagrid3.valueMatrix(row_id,6);
						
						var row = datagrid3.row;
						datagrid3.rowStatus(row) = "3";
						
						for (i=1; i<datagrid1.rows ; i++) {
							datagrid1.rowStatus(i) = "3";
						}
						
						model.setValue("/root/reqData/fc_acct_3254_u/cmpy_cd", getProperty("ss_cmpycd"));
						model.setValue("/root/reqData/fc_acct_3254_u/slip_occr_dt", srch_slip_occr_dt.value);
						model.setValue("/root/reqData/fc_acct_3254_u/slip_clsf_cd", srch_slip_clsf_cd.value);
						model.setValue("/root/reqData/fc_acct_3254_u/slip_seq", srch_slip_seq.value);
						model.setValue("/root/reqData/fc_acct_3254_u/slip_sub_seq", srch_slip_sub_seq.value);
						model.setValue("/root/reqData/fc_acct_3254_u/clam_dept_cd", clam_dept_cd.value);
						model.setValue("/root/reqData/fc_acct_3254_u/incmg_emp_no", incmg_emp_no.value);
						//model.setValue("/root/reqData/fc_acct_3254_u/fisc_dt", fisc_dt.value);
						model.setValue("/root/reqData/fc_acct_3254_u/fisc_dt",datagrid3.valueMatrix(row_id,2));  //회계일자 동일하게 셋팅
						model.setValue("/root/reqData/fc_acct_3254_u/incmg_pers", getProperty("ss_emp_no"));
						model.setValue("/root/reqData/fc_acct_3254_u/incmg_pers_ipadd", "");
						//model.setValue("/root/reqData/fc_acct_3254_u/incmg_dt", incmg_dt.value); 
						model.setValue("/root/reqData/fc_acct_3254_u/incmg_dt", datagrid3.valueMatrix(row_id,2));
						model.setValue("/root/reqData/fc_acct_3254_u/reso_amt", reso_amt.value);
						model.setValue("/root/reqData/fc_acct_3254_u/reso_amt_ch", reso_amt_var);
						
						for (i=1; i<datagrid1.rows - 1; i++) {
							datagrid1.valueMatrix(i, 46) = datagrid2.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(0, 8);
							datagrid1.valueMatrix(i, 47) = datagrid2.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(8, 10);
							datagrid1.valueMatrix(i, 48) = datagrid2.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(10, 13);
							datagrid1.valueMatrix(i, 49) = datagrid2.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(13, 14);
							datagrid1.valueMatrix(i, 50) = datagrid2.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(14, 20);
							if((datagrid2.valueMatrix(i,28) == "320500") && (datagrid2.valueMatrix(i,13) == "")) {
								show_message("선급제세(부가세) 계정의 대상계정이 건설중인자산일 경우 관리구분을 반드시 입력하여야 합니다.");
								return;	
							}
						}	
						
						for (i=1; i<datagrid1.rows; i++) {
							if( datagrid1.valueMatrix(i,2) == "182000" || datagrid1.valueMatrix(i,2) == "462000"){
							}else{
								datagrid1.valueMatrix(i,39) = "";
							}
						}
						
						model.setValue("/root/reqData/fc_acct_3254_u/multiUpdateData",datagrid1.getUpdateData("insert"));
						
						model.refresh();
						
    					model.send("fc_acct_3254_u");
    						
						if(submit_completed()){
						    show_message("수정되었습니다.");
							var row = datagrid3.row;					
							model.setValue("/root/reqData/searchData/slip_occr_dt",datagrid3.valueMatrix(row,2).ReplaceString("-", ""));
							model.setValue("/root/reqData/searchData/slip_clsf_cd",datagrid3.valueMatrix(row,6).ReplaceString("-", ""));
							model.setValue("/root/reqData/searchData/slip_seq",datagrid3.valueMatrix(row,3).ReplaceString("-", ""));
							model.setValue("/root/reqData/searchData/slip_sub_seq",datagrid3.valueMatrix(row,4).ReplaceString("-", ""));						
							model.send("fc_acct_3251_l");							
							model.makeNode("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2");
							model.copyNode("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2","/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST1");
							fn_group3_reset();
							if(datagrid2.valueMatrix(1,3) != ""){ //group3 채우기
								model.setFocus("datagrid2",true);
								datagrid2.col = 3;
								fn_GridToForm(1);
								fn_background_color_setting("1");																	
							}	
							model.refresh();
							lst_row=1;
						}
					]]>
				</script>
			</button>
			<button id="btn_delete" class="btn02" navindex="45" crud="D" style="left:46.67%; top:0px; width:7.22%; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						// KEY 변경시 작업불가
						if (gvar_slip_occr_dt != srch_slip_occr_dt.value.Trim().ReplaceString("-", "")
						|| gvar_slip_clsf_cd != srch_slip_clsf_cd.value.Trim().ReplaceString("-", "")
						|| gvar_slip_seq != srch_slip_seq.value.Trim().ReplaceString("-", "")
						|| gvar_slip_sub_seq != srch_slip_sub_seq.value.Trim().ReplaceString("-", "")	) {
							show_message("키가 변경되어서 삭제할 수 없는 자료입니다. 다시 조회해 주십시오.");
							model.setFocus("btn_select");
							return;
						}
						var _clsf_cd = srch_slip_clsf_cd.value; 
						if (_clsf_cd == "61" || _clsf_cd == "62"){
							show_message("해당 전표는 삭제할 수 없습니다.");
							model.setFocus("srch_slip_clsf_cd");
							return;
						}
						
						if (srch_slip_occr_dt.value.ReplaceString("-", "").length != 8){
							show_message("전표번호[입력일자]는 잘못된 형식입니다.");
							model.setFocus("srch_slip_occr_dt");
							return;
						}

						if (srch_slip_clsf_cd.value.ReplaceString("-", "").length != 2){
							show_message("전표번호[전표구분]는 필수입력항목입니다.");
							model.setFocus("srch_slip_clsf_cd");
							return;
						}
						
						if (srch_slip_seq.value.ReplaceString("-", "").length != 3){
							show_message("전표번호[순번]는 필수입력항목입니다.");
							model.setFocus("srch_slip_seq");
							return;
						}
						
						if (srch_slip_sub_seq.value.ReplaceString("-", "").length != 1){
							show_message("전표번호[SUBSEQ]는 필수입력항목입니다.");
							model.setFocus("srch_slip_sub_seq");
							return;
						}

						// 김경훈, 박지원
						//if(getProperty("ss_cmpycd") == "100" || getProperty("ss_cmpycd") == "332"){ //2012.01.11
						var orgStr1 = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_ss_cmpycd");
						if(instr_yn(orgStr1, getProperty("ss_cmpycd"))){	
							//if (getProperty("ss_emp_no") == "194030" || getProperty("ss_emp_no") == "194082" || getProperty("ss_emp_no") == "210006" || getProperty("ss_emp_no") == "196024" ){ //2012.01.11
							var orgStr2 = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_ss_emp_no");							
							if(instr_yn(orgStr2, getProperty("ss_emp_no"))){									
								// 
							}
							else {
								//if (srch_slip_clsf_cd.value != "90" && srch_slip_clsf_cd.value != "95") { //2012.01.11
								var orgStr3 = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_srch_slip_clsf_cd_2");
								var orgStr4 = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_srch_slip_clsf_cd_3");
								if(! instr_yn(orgStr3, srch_slip_clsf_cd.value) && ! instr_yn(orgStr4, srch_slip_clsf_cd.value)){	
									show_message("삭제할 수 없는 전표구분코드 입니다.('90,'95'만 입력)");
									model.setFocus("srch_slip_clsf_cd");
									return;								
								}
							}
						}

						if(model1.alert("삭제하시겠습니까?", "알림", 4)  == 7){	return; }

						model.setValue("/root/reqData/fc_acct_3255_d/cmpy_cd", getProperty("ss_cmpycd"));
						model.setValue("/root/reqData/fc_acct_3255_d/slip_occr_dt", srch_slip_occr_dt.value);
						model.setValue("/root/reqData/fc_acct_3255_d/slip_clsf_cd", srch_slip_clsf_cd.value);
						model.setValue("/root/reqData/fc_acct_3255_d/slip_seq", srch_slip_seq.value);
						model.setValue("/root/reqData/fc_acct_3255_d/slip_sub_seq", srch_slip_sub_seq.value);
						model.setValue("/root/reqData/fc_acct_3255_d/incmg_pers", getProperty("ss_emp_no"));
						model.setValue("/root/reqData/fc_acct_3255_d/incmg_pers_ipadd", "");
						model.setValue("/root/reqData/fc_acct_3255_d/in_sicsgb", "C");
						
						for (i=1; i<datagrid1.rows - 1; i++) {
							datagrid1.valueMatrix(i, 46) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(0, 8);
							datagrid1.valueMatrix(i, 47) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(8, 10);
							datagrid1.valueMatrix(i, 48) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(10, 13);
							datagrid1.valueMatrix(i, 49) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(13, 14);
							datagrid1.valueMatrix(i, 50) = datagrid1.valueMatrix(i, 43).Trim().ReplaceString("-", "").substring(14, 20);
						}
												
    						model.send("fc_acct_3255_d");
    						
						if(submit_completed()){
    						//model.reset();
							show_message("삭제되었습니다.");
							//btn_select.dispatch("onclick");
							model.send("fc_acct_3256_l");
							model.removeNodeset("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST1");						
							model.removeNodeset("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2");						
							fn_group3_reset();
							model.refresh();		
							datagrid3_lst_row = 1;
						}
					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" navindex="46" style="left:54.17%; top:0px; width:7.22%; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[		
						model.reset();
						send_fc_acct_3250_m();	// 콤보 초기화				
						
						model.setValue("/root/reqData/searchData/slip_occr_dt",commCurDate()); 					
						model.setValue("/root/reqData/searchData/slip_sub_seq","0"); //srch_slip_sub_seq.value = "0";				// SUBSEQ		
						datagrid2.valueMatrix(1,1) = "000001"; //행번호초기화
						datagrid2.rowStatus(1) = "0"; //1->0으로수정 20141021
						datagrid3.rowStatus(1) = "1";
						model.refresh();
						model.setFocus("srch_slip_occr_dt");
						lst_row = 0;
						datagrid3_lst_row = 1;
					]]>
				</script>
			</button>
			<button id="btn_copy" class="btn02" navindex="47" crud="R" style="left:61.67%; top:0px; width:7.08%; height:21px; ">
				<caption>복사</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						// KEY 변경시 작업불가
						if (gvar_slip_occr_dt != srch_slip_occr_dt.value.Trim().ReplaceString("-", "")
						|| gvar_slip_clsf_cd != srch_slip_clsf_cd.value.Trim().ReplaceString("-", "")
						|| gvar_slip_seq != srch_slip_seq.value.Trim().ReplaceString("-", "")	) {
							show_message("복사할 수 없는 자료입니다.");
							return;
						}
						var row = datagrid3.row;
						var rows = datagrid3.rows;
						datagrid3.addRow(true,true); 
						datagrid3.valueMatrix(rows,2) = commCurDate(); //입력일자
						datagrid3.valueMatrix(rows,5) = datagrid3.valueMatrix(row,5); //적요1
						datagrid3.valueMatrix(rows,6) = datagrid3.valueMatrix(row,6); //유형
						datagrid3.valueMatrix(rows,3) = "";
						datagrid3.valueMatrix(rows,1) = "";
						datagrid3.rowStatus(rows+1) = "2"; 
							
						datagrid2.clearStatus();		
									
						for (i=1; i<datagrid1.rows - 1; i++) {
							datagrid2.rowStatus(i) = "2";
						}						
						srch_slip_clsf_cd.value = "";
						srch_slip_seq.value = "";
						srch_slip_sub_seq.value = "";	
						prof_type_cd.value="";
						occr_slip_clsf_cd.value ="";
						occr_slip_occr_dt.value = "";
						occr_slip_seq.value = "";
						erplace_cd.value = "";
						make_dt.value="";
						etc_in.value="";
						suply_amt.value="";
						vat_amt.value ="";
						ern.value="";
						
						var row_2 = datagrid2.rows;							
						for(var i = 1 ; i < row_2 ; i++){
							datagrid2.valueMatrix(i,38) = "";  //  38.잡수익
							datagrid2.valueMatrix(i,39) = "";  //  39.세금계산서번호
							datagrid2.valueMatrix(i,40) = "";  //  40.작성일자	
							datagrid2.valueMatrix(i,41) = "";  //  41.사업장코드
							datagrid2.valueMatrix(i,42) = "";  //  41.공급자번호
							datagrid2.valueMatrix(i,51) = "";  //  51.부가세액
							datagrid2.valueMatrix(i,52) = "";  //  52.공급가액
							datagrid2.valueMatrix(i,53) = "";  //  53.mang_clsf_nm
						}
						datagrid3.row = datagrid3.row;
						show_message("복사가 정상적으로 실행되었습니다.");				
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" navindex="50" crud="R" style="left:84.58%; top:0px; width:7.22%; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" navindex="51" style="left:92.08%; top:0px; width:7.22%; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[		
						model.close();
					]]>
				</script>
			</button>
			<button id="btn_update_slip" class="btn02" navindex="48" crud="R" style="left:69.31%; top:0px; width:7.08%; height:21px; ">
				<caption>수정전표</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						// KEY 변경시 작업불가
						if (gvar_slip_occr_dt != srch_slip_occr_dt.value.Trim().ReplaceString("-", "")
						|| gvar_slip_clsf_cd != srch_slip_clsf_cd.value.Trim().ReplaceString("-", "")
						|| gvar_slip_seq != srch_slip_seq.value.Trim().ReplaceString("-", "")	) {
							show_message("수정전표 처리 할 수 없는 자료입니다.");
							return;
						}
						
						srch_slip_seq.value = "";
						
						for (i=1;i<datagrid2.rows;i++) {
							datagrid2.valueMatrix(i, 8) = Number(datagrid2.valueMatrix(i, 8)) * -1;
							datagrid2.valueMatrix(i, 9) = Number(datagrid2.valueMatrix(i, 9)) * -1;
						}

						datagrid2.clearStatus();
						
						for (i=1; i<datagrid2.rows; i++) {
							datagrid2.rowStatus(i) = "3";
						}
						
						show_message("수정전표가 정상적으로 실행되었습니다.");
					]]>
				</script>
			</button>
			<button id="btn_slip_print" class="btn02" navindex="49" visibility="hidden" crud="P" style="left:76.94%; top:0px; width:7.08%; height:21px; ">
				<caption>전표발행</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var row = datagrid3.row;
						
						// 글로벌변수 셋팅
						model.property("FC_ACCT_2260_slip_occr_dt")  = datagrid3.valueMatrix(row,2); //srch_slip_occr_dt.value;			// 발생일자
						model.property("FC_ACCT_2260_slip_clsf_cd")  = datagrid3.valueMatrix(row,6); //srch_slip_clsf_cd.value;			// 전표구분
						model.property("FC_ACCT_2260_slip_seqfr") = datagrid3.valueMatrix(row,3); //srch_slip_seq.value;			// 일련번호 from
						model.property("FC_ACCT_2260_slip_seqto") = datagrid3.valueMatrix(row,3); //srch_slip_seq.value;			// 일련번호 to
						model.property("FC_ACCT_2260_slip_radio1") = "";			// 출력구분
						model.property("FC_ACCT_2260_popup_flag") ="Y";
						
						// 화면호출
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2260");	
					]]>
				</script>
			</button>
			<button id="button6" class="btn02" navindex="42" visibility="hidden" crud="R" style="left:16.67%; top:0px; width:7.22%; height:21px; ">
				<caption>전표검색</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[	
						window.load("../../fc/acct/FC_ACCT_2610.xrw", "modal", "", "align:center; width:685; height:725; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");		
						if (model.property("FC_ACCT_3250_popup_flag") == "Y" ) {
						model.setValue("/root/reqData/searchData/slip_occr_dt",model.property("FC_ACCT_3250_srch_slip_occr_dt"));
						model.setValue("/root/reqData/searchData/slip_clsf_cd",model.property("FC_ACCT_3250_srch_slip_clsf_cd"));
						model.setValue("/root/reqData/searchData/slip_seq",model.property("FC_ACCT_3250_srch_slip_seq"));
						model.setValue("/root/reqData/searchData/slip_sub_seq",model.property("FC_ACCT_3250_srch_slip_sub_seq"));
						model.setValue("/root/reqData/searchData/clam_dept_cd","");
						model.setValue("/root/reqData/searchData/pch_cgbuseonm","");
						model.setValue("/root/reqData/searchData/incmg_emp_no","");
						model.setValue("/root/reqData/searchData/pch_irjnm","");
						model.refresh();
						//model.property("FC_ACCT_3250_srch_slip_occr_dt")  = "";
						//model.property("FC_ACCT_3250_srch_slip_clsf_cd") = "";
						//model.property("FC_ACCT_3250_srch_slip_seq") = "";
						//model.property("FC_ACCT_3250_srch_slip_sub_seq") = "";
						//model.property("FC_ACCT_3250_popup_flag") = "";					
						btn_select.dispatch("onclick");
						model.property("FC_ACCT_3250_srch_slip_occr_dt")  = "";
						model.property("FC_ACCT_3250_srch_slip_clsf_cd") = "";
						model.property("FC_ACCT_3250_srch_slip_seq") = "";
						model.property("FC_ACCT_3250_srch_slip_sub_seq") = "";
						model.property("FC_ACCT_3250_popup_flag") = "";		
						}
					
					]]>
				</script>
			</button>
		</group>
		<group id="group2" disabled="true" style="left:0.95%; top:680px; width:97.99%; height:130px; ">
			<caption id="caption40" class="list_cap02" style="left:0.22%; top:69px; width:99.78%; height:26px; text-align:center; "/>
			<caption id="caption74" class="list_cap02" style="left:0.00%; top:44px; width:66.88%; height:26px; text-align:center; "/>
			<caption id="caption75" class="list_cap02" style="left:66.45%; top:19px; width:33.55%; height:26px; text-align:center; "/>
			<caption id="subtitle" class="tit02" style="left:0.00%; top:0px; width:56.53%; height:20px; ">세금계산서</caption>
			<caption id="caption76" class="list_cap02" style="left:9.60%; top:19px; width:57.82%; height:26px; text-align:center; "/>
			<input id="occr_slip_occr_dt" ref="/root/resData/resform/occr_slip_occr_dt" navindex="35" format="yyyy-mm-dd" style="left:28.59%; top:23px; width:9.71%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(make_dt.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("make_dt",true);
						}else{
							make_dt.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(occr_slip_seq.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("occr_slip_seq",true);
							occr_slip_seq.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</input>
			<caption id="caption77" class="list_cap03" style="left:46.71%; top:44px; width:6.58%; height:26px; text-align:center; ">잡수익</caption>
			<caption id="caption78" class="list_cap03" style="left:64.51%; top:19px; width:9.71%; height:26px; text-align:center; ">사업장코드</caption>
			<select1 id="prof_type_cd" ref="/root/resData/resform/prof_type_cd" navindex="33" appearance="minimal" editmode="inputsearch" style="left:10.25%; top:23px; width:14.02%; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2290_m/dataSet/CUR_PROF_TYPE_LIST/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
						var prof_type_cd = model.getValue("/root/resData/resform/prof_type_cd");
						if (prof_type_cd != "") {
							if(occr_slip_seq.value != ""){
							}else{
								var row = datagrid3.row;
								model.setValue("/root/resData/resform/occr_slip_clsf_cd",datagrid3.valueMatrix(row,6));
								model.setValue("/root/resData/resform/occr_slip_occr_dt",datagrid3.valueMatrix(row,2));
								model.setValue("/root/resData/resform/occr_slip_seq","");
								model.setValue("/root/resData/resform/suply_amt",model.getValue("/root/resData/resform/obj_amt"));
								model.setValue("/root/resData/resform/make_dt",datagrid3.valueMatrix(row,2));
								
															
								if (getProperty("ss_cmpycd") == "326"){
									if (use_dept_cd.value == "800000"){
										model.setValue("/root/resData/resform/erplace_cd","02");
										erplace_cd.dispatch("xforms-value-changed");
									}
								}
								
								var erplace_cd_ = model.getValue("/root/resData/resform/erplace_cd");
								if (erplace_cd_ == "") {
									model.setValue("/root/resData/resform/erplace_cd","01");
									erplace_cd.dispatch("xforms-value-changed");
								}
								var dlco_clsf_cd = datagrid2.valueMatrix(datagrid2.row,12);
								var dlco_cd = datagrid2.valueMatrix(datagrid2.row,5);							
								model.setValue("/root/resData/resform/ern",dlco_cd);
								
								var sum = 0;
								var suply_amt = 0;
								var num = "";
								
								if(Number(datagrid2.valueMatrix(datagrid2.row,8)) == 0){
									num = 9;
								}else if (Number(datagrid2.valueMatrix(datagrid2.row,9)) == 0){
									num = 8;
								}	
								sum = Math.round(Number(datagrid2.valueMatrix(datagrid2.row,num))*1.1)*10;
								suply_amt = sum-datagrid2.valueMatrix(datagrid2.row,num);
								
								var vat_ = Number(datagrid2.valueMatrix(datagrid2.row,8))+Number(datagrid2.valueMatrix(datagrid2.row,9));
								//if (vat_ == 0 ){
								//	suply_amt = 
								//	vat_ = suply_amt*0.1;
								//}
								model.setValue("/root/resData/resform/suply_amt",suply_amt);
								model.setValue("/root/resData/resform/obj_amt",suply_amt);							
								model.setValue("/root/resData/resform/vat_amt",vat_);
								model.setValue("/root/resData/resform/email_id",datagrid2.valueMatrix(datagrid2.row,54));
								
								if (datagrid2.row == 1){
									model.setValue("/root/resData/resform/obj_acct_cd","");
									model.setValue("/root/resData/resform/pch_dsacctnm","");
								}else{
									model.setValue("/root/resData/resform/obj_acct_cd",datagrid2.valueMatrix(datagrid2.row-1,3));
									model.setValue("/root/resData/resform/pch_dsacctnm",datagrid2.valueMatrix(datagrid2.row-1,4));
								}
								model.refresh();
							}
						}
						else {
							model.setValue("/root/resData/resform/occr_slip_clsf_cd","");
							model.setValue("/root/resData/resform/occr_slip_occr_dt","");
							model.setValue("/root/resData/resform/occr_slip_seq","");							
							model.setValue("/root/resData/resform/erplace_cd","");
							model.setValue("/root/resData/resform/ern","");
							model.setValue("/root/resData/resform/make_dt","");
							model.setValue("/root/resData/resform/etc_in","");
						}	
						model.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(prof_type_cd, prof_type_cd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(prof_type_cd,"");
						return;
					}
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(occr_slip_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("occr_slip_clsf_cd",true);
						}else{
							occr_slip_clsf_cd.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(prof_type_cd.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("occr_slip_clsf_cd",true);
							occr_slip_clsf_cd.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</select1>
			<caption id="caption79" class="list_cap02" style="left:66.45%; top:44px; width:33.55%; height:26px; text-align:center; "/>
			<caption id="caption80" class="list_cap03" style="left:46.71%; top:19px; width:6.58%; height:26px; text-align:center; ">작성일자</caption>
			<caption id="caption81" class="list_cap03" style="left:0.00%; top:19px; width:9.71%; height:26px; text-align:center; ">세금계산서</caption>
			<input id="make_dt" ref="/root/resData/resform/make_dt" navindex="37" autonext="false" inputtype="date" style="left:53.94%; top:23px; width:9.71%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(erplace_cd.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("erplace_cd",true);
						}else{
							erplace_cd.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(make_dt.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("erplace_cd",true);
							erplace_cd.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</input>
			<select1 id="erplace_cd" ref="/root/resData/resform/erplace_cd" navindex="38" appearance="minimal" editmode="inputsearch" style="left:74.76%; top:23px; width:14.02%; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2290_m/dataSet/CUR_ERPLACE_CD_LIST/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(erplace_cd, erplace_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(erplace_cd,"");
							return;
						}
						if (getProperty("ss_cmpycd") == "326"){
							if (erplace_cd.value == "02" && use_dept_cd.value != "800000") {								
								show_message("[사용부서 혹은 사업장코드 확인요]");
								return;
							}
						}
						
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(suply_amt.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("suply_amt",true);
						}else{
							suply_amt.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(erplace_cd.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("suply_amt",true);
							suply_amt.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</select1>
			<input id="ern" ref="/root/resData/resform/ern" accesskey="f2" navindex="41" autonext="false" inputtype="button" style="left:74.65%; top:48px; width:14.02%; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						gstr_popupid = "ern";
						open_fc_acct_1180("button","s");	
						model.setFocus("ern",true);									
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						gstr_popupid = "ern";
						open_fc_acct_1180("focus","s");					
					]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setValue("/root/tempData2/tempNode"	,"x");	
							if(ern.attribute("background-color") == DEFAULT_COLOR_REQ){	
								model.setFocus("email",true);
							}else{
								ern.dispatch("oncursor");
							}
						}
					]]>
				</script>
				<script type="javascript" ev:event="onaccesskey">
					<![CDATA[
					if(model.getFocus() =="ern"){
						ern.dispatch("onbuttonclick");
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[				
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						model.setFocus("ern",true);
					}
					]]>
				</script>
			</input>
			<input id="occr_slip_clsf_cd" ref="/root/resData/resform/occr_slip_clsf_cd" navindex="34" style="left:25.03%; top:23px; width:3.24%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(occr_slip_occr_dt.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("occr_slip_occr_dt",true);
						}else{
							occr_slip_occr_dt.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(occr_slip_clsf_cd.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("occr_slip_occr_dt",true);
							occr_slip_occr_dt.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</input>
			<caption id="caption82" class="list_cap03" style="left:64.51%; top:44px; width:9.71%; height:26px; text-align:center; ">공급자번호</caption>
			<input id="etc_in" ref="/root/resData/resform/etc_in" navindex="40" format="(-)#,###" style="left:53.94%; top:48px; width:9.39%; height:18px; text-align:right; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(ern.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("ern",true);
						}else{
							ern.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(etc_in.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("ern",true);
							ern.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="onkeyup">
					<![CDATA[
					if(event.keycode == "107"){
						etc_in.selBegin = 0;
						etc_in.value = etc_in.currentText + "000";
						etc_in.selEnd = 30;
					}
					]]>
				</script>
			</input>
			<output id="occr_slip_seq" ref="/root/resData/resform/occr_slip_seq" navindex="36" style="left:38.62%; top:23px; width:3.24%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(make_dt.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("make_dt",true);
						}else{
							make_dt.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(occr_slip_seq.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("make_dt",true);
							make_dt.dispatch("oncursor");
						}
					}
					]]>
				</script>
			</output>
			<input id="suply_amt" ref="/root/resData/resform/suply_amt" navindex="39" inputtype="input" format="(-)#,###" style="left:10.14%; top:48px; width:11.00%; height:18px; text-align:right; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(vat_amt.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("vat_amt",true);
						}else{
							vat_amt.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(vat_amt.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("vat_amt",true);
							vat_amt.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="onkeyup">
					<![CDATA[
					if(event.keycode == "107"){
						vat_amt.selBegin = 0;
						vat_amt.value = suply_amt.currentText + "000";
						vat_amt.selEnd = 30;
					}	
					]]>
				</script>
			</input>
			<caption id="suplyamt" class="list_cap03" style="left:0.00%; top:44px; width:9.71%; height:26px; text-align:center; ">과표</caption>
			<input id="vat_amt" ref="/root/resData/resform/vat_amt" navindex="39" inputtype="input" format="(-)#,###" style="left:34.52%; top:48px; width:11.00%; height:18px; text-align:right; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
					if(event.keycode == "13"){
						model.setValue("/root/tempData2/tempNode"	,"x");	
						if(etc_in.attribute("background-color") == DEFAULT_COLOR_REQ){	
							model.setFocus("etc_in",true);
						}else{
							etc_in.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
					if(model.getValue("/root/tempData2/tempNode") == "x"){
						model.setValue("/root/tempData2/tempNode","");
						if(etc_in.attribute("background-color") != DEFAULT_COLOR_REQ){
							model.setValue("/root/tempData2/tempNode","x");
							model.setFocus("etc_in",true);
							etc_in.dispatch("oncursor");
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="onkeyup">
					<![CDATA[
					if(event.keycode == "107"){
						suply_amt.selBegin = 0;
						suply_amt.value = suply_amt.currentText + "000";
						suply_amt.selEnd = 30;
					}	
					]]>
				</script>
			</input>
			<caption id="caption15" class="list_cap03" style="left:24.38%; top:44px; width:9.71%; height:26px; text-align:center; ">부가세</caption>
			<caption id="caption64" class="list_cap03" style="left:0.00%; top:69px; width:9.71%; height:26px; text-align:center; ">E-MAIL</caption>
			<input id="email" ref="/root/resData/resform/email_id" navindex="25" style="left:10.14%; top:73px; width:13.59%; height:18px; text-align:left; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setValue("/root/tempData2/tempNode"	,"x");	
							//if(item.attribute("background-color") == DEFAULT_COLOR_REQ){	
								model.setFocus("item",true);
							//}else{
							//	item.dispatch("oncursor");
							//}
						}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
						/*if(model.getValue("/root/tempData2/tempNode") == "x"){
							model.setValue("/root/tempData2/tempNode","");
							if(item.attribute("background-color") != DEFAULT_COLOR_REQ){
								model.setValue("/root/tempData2/tempNode","x");
								model.setFocus("item",true);
								item.dispatch("oncursor");
							}
						}*/
					]]>
				</script>
			</input>
			<caption id="caption41" class="list_cap03" style="left:24.38%; top:69px; width:9.71%; height:26px; text-align:center; ">품목</caption>
			<input id="item" ref="/root/resData/resform/item" style="left:34.52%; top:73px; width:28.59%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setValue("/root/tempData2/tempNode"	,"x");	
							//if(remk.attribute("background-color") == DEFAULT_COLOR_REQ){	
								model.setFocus("remk",true);
							//}else{
							//	remk.dispatch("oncursor");
							//}
						}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
						/*if(model.getValue("/root/tempData2/tempNode") == "x"){
							model.setValue("/root/tempData2/tempNode","");
							if(remk.attribute("background-color") != DEFAULT_COLOR_REQ){
								model.setValue("/root/tempData2/tempNode","x");
								model.setFocus("remk",true);
								remk.dispatch("oncursor");
							}
						}*/
					]]>
				</script>
			</input>
			<caption id="caption45" class="list_cap03" style="left:64.51%; top:69px; width:9.71%; height:26px; text-align:center; ">비고</caption>
			<input id="remk" ref="/root/resData/resform/remk" style="left:74.65%; top:73px; width:24.92%; height:18px; ">
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setValue("/root/tempData2/tempNode"	,"x");	
							//if(remk.attribute("background-color") == DEFAULT_COLOR_REQ){	
								model.setFocus("re_issu_resn_cd",true);
							//}else{
							//	remk.dispatch("oncursor");
							//}
						}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
						//if(model.getValue("/root/tempData2/tempNode") == "x"){
						//	model.setValue("/root/tempData2/tempNode","");
						//	model.setFocus("remk",true);
						//}					
					]]>
				</script>
			</input>
			<caption id="caption48" class="list_cap02" style="left:0.00%; top:94px; width:100%; height:26px; text-align:center; "/>
			<caption id="caption49" class="list_cap03" style="left:0.00%; top:94px; width:9.71%; height:26px; text-align:center; ">수정사유</caption>
			<select1 id="re_issu_resn_cd" ref="/root/resData/resform/re_issu_resn_cd" navindex="12" appearance="minimal" style="left:10.14%; top:97px; width:14.56%; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_3250_m/dataSet/CURLIST3/record">
						<label ref="cdnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var resn_cd = model.getValue("/root/resData/resform/re_issu_resn_cd");
						var make_dt = model.getValue("/root/resData/resform/make_dt");
						//model.makeNode("/root/resData2/resForm/remk");
						//model.makeNode("/root/resData2/resForm/make_dt2");
						//model.setValue("/root/resData2/resForm/make_dt2",getCurrentDate());
						//(-)세금계산서 작성일자 초기값 세팅 
						if(resn_cd == "01"){//기재사항의 착오/정정 ==> 작성일:당초 세금계산서 작성일
							//inp_make_dt21.visible = false;
							//cap_make_dt21.visible = false;
							model.setValue("/root/resData/resform/remk","");
							model.refresh();
						}
					    else if(resn_cd == "02"){//공급가액 변동 ==> 작성일:변동 사유 발생일,비고:당초 세금계산서 교부일
							//inp_make_dt21.visible = true;
							//cap_make_dt21.visible = true;
							//model.setValue("/root/resData2/resForm/remk",make_dt);
							//model.setValue("/root/resData2/resForm/make_dt2",make_dt);
							//model.refresh();
							//model.setValue("/root/resData2/resForm/make_dt",getCurrentDate());
							model.setValue("/root/resData/resform/remk",make_dt);
							model.refresh();
						}
						else if(resn_cd == "03"){//환입 ==> 작성일:환입된날,비고:당초 세금계산서 작성일
							//inp_make_dt21.visible = true;
							//cap_make_dt21.visible = true;
							//model.setValue("/root/resData2/resForm/remk",make_dt);
							//model.setValue("/root/resData2/resForm/make_dt2",make_dt);
							//model.refresh();
							model.setValue("/root/resData/resform/remk",make_dt);
							model.refresh();
						}
						else if(resn_cd == "04"){//계약의 해제 ==> 작성일:계약해제일,비고:계약해제일
							//inp_make_dt21.visible = true;
							//cap_make_dt21.visible = true;
							//model.setValue("/root/resData2/resForm/remk",make_dt);
							//model.setValue("/root/resData2/resForm/make_dt2",make_dt);
							//model.refresh();
							model.setValue("/root/resData/resform/remk",make_dt);
							model.refresh();
						}
						else if(resn_cd == "05"){//내국신용장사후개설 ==> 작성일:당초 세금계산서 작성일,비고:내국신용장개설일
							//inp_make_dt21.visible = false;
							//cap_make_dt21.visible = false;
							model.setValue("/root/resData/resform/remk","");
							model.refresh();
						}else{
							model.setValue("/root/resData/resform/remk","");
							model.refresh();
						}
						
						]]>
				</script>
				<script type="javascript" ev:event="onkeypress">
					<![CDATA[
						if(event.keycode == "13"){
							model.setFocus("button2",true);			
							button2.attribute("border-style") ="dotted";
						}
					]]>
				</script>
				<script type="javascript" ev:event="oncursor">
					<![CDATA[
						if(model.getValue("/root/tempData2/tempNode") == "x"){
							model.setValue("/root/tempData2/tempNode","");
							model.setFocus("remk",true);
						}	
					]]>
				</script>
			</select1>
		</group>
		<group id="group4" class="gro_sel" visibility="hidden" style="left:88.27%; top:705px; width:2.11%; height:20px; ">
			<caption id="caption29" class="list_cap02" style="left:89px; top:0px; width:440px; height:26px; text-align:center; "/>
			<caption id="caption17" class="list_cap02" style="left:89px; top:50px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption20" class="list_cap03" style="left:0px; top:0px; width:90px; height:26px; text-align:center; ">행번호</caption>
			<caption id="caption21" class="list_cap03" style="left:0px; top:25px; width:90px; height:26px; text-align:center; ">예산코드</caption>
			<caption id="caption22" class="list_cap02" style="left:89px; top:25px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption23" class="list_cap03" style="left:299px; top:25px; width:90px; height:26px; text-align:center; ">차변금액</caption>
			<caption id="caption26" class="list_cap02" style="left:388px; top:25px; width:141px; height:26px; text-align:center; "/>
			<input id="dr_amt" ref="/root/resData/resform/dr_amt" class="req" navindex="52" inputtype="input" style="left:393px; top:29px; width:130px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[						
						setoff_slip_no.attribute("background-color") = "white";
						setoff_slip_no.attribute("editable") == "false";													
					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
						if (dr_amt.value.Trim().length == 0) {
							dr_amt.value = "0";
						}
					
						if (dr_amt.value.Trim() != "0") {
							if (budg_cd.value == "463100"
							|| budg_cd.value == "456100"
							|| budg_cd.value == "466500"
							|| budg_cd.value == "466700"
							|| budg_cd.value == "466800") {
								occr_slip_clsf.attribute("background-color") = DEFAULT_COLOR_REQ;
								occr_slip.attribute("background-color") = DEFAULT_COLOR_REQ;
							}	
						}	
					]]>
				</script>
			</input>
			<caption id="caption33" class="list_cap03" style="left:299px; top:50px; width:90px; height:26px; text-align:center; ">대변금액</caption>
			<caption id="caption37" class="list_cap02" style="left:388px; top:50px; width:141px; height:26px; text-align:center; "/>
			<caption id="use_dept_label" class="list_cap03" style="left:0px; top:50px; width:90px; height:26px; text-align:center; ">사용부서</caption>
			<input id="crdt_amt" ref="/root/resData/resform/crdt_amt" class="req" navindex="53" inputtype="input" style="left:393px; top:54px; width:130px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (Number(crdt_amt.value.Trim()) == 0) { return; }

						// 예산별관리항목별로 필수색 셋팅
						fn_background_color_setting("9");
						
						setoff_slip_no.attribute("background-color") = "white";
						// 예산코드에 따른 거래처구분, 관리구분 콤보 셋팅
						fn_dlco_mang_clsf_setting();
						
						model.refresh();
					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
						if (crdt_amt.value.Trim().length == 0) {
							crdt_amt.value = "0";
						}
					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[
					
					]]>
				</script>
			</input>
			<button id="slip_arow_no_up" class="btn_up" style="left:163px; top:1px; width:20px; height:12px; ">
				<caption/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (datagrid2.row <= 1) { return; }
						
						datagrid2.row = datagrid2.row - 1;
						datagrid2.col = 1;
						
						fn_GridToForm(datagrid2.row);
						mang_clsf_cd.dispatch("xforms-value-changed");
						// 예산별관리항목별로 필수색 셋팅
						fn_background_color_setting("9");
					]]>
				</script>
			</button>
			<button id="slip_arow_no_down" class="btn_down" appearance="button" style="left:163px; top:14px; width:20px; height:10px; ">
				<caption/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (datagrid2.row >= datagrid2.rows) { return; }
					
						datagrid2.row = datagrid2.row + 1;
						datagrid2.col = 1;
						fn_GridToForm(datagrid2.row);
						
						mang_clsf_cd.dispatch("xforms-value-changed");
						
						// 예산별관리항목별로 필수색 셋팅
						fn_background_color_setting("9");
					]]>
				</script>
			</button>
			<input id="slip_arow_no" ref="/root/resData/resform/slip_arow_no" class="req" style="left:95px; top:4px; width:65px; height:18px; "/>
			<input id="budg_cd" ref="/root/resData/resform/budg_cd" class="req" inputtype="button" maxlength="6" style="left:95px; top:29px; width:65px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					
						gstr_popupid = "budg_cd";
					
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cmpy_cd");
						model.makeNode("/root/reqData/fwdData/G_Tag");
						model.makeNode("/root/reqData/fwdData/G_Caption");
						model.makeNode("/root/reqData/fwdData/G_Codenu");
						model.makeNode("/root/reqData/fwdData/G_BRCode");
						model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
						model.setValue("/root/reqData/fwdData/G_Tag", "1");
						model.setValue("/root/reqData/fwdData/G_Caption", "예산코드조회");
						model.setValue("/root/reqData/fwdData/G_Codenu", "");	
						model.setValue("/root/reqData/fwdData/G_BRCode", "");
						window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");		

						//입력값 설정
						set_refvalue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
						set_refvalue("/root/reqData/searchData/budg_cd", budg_cd.value);
						//실행
						model.send("fc_acct_2293_s");
						
						// 전사공통비여부가 "1" 이면 사용부서 "999999"
						use_dept_cd.attribute("editable") = "true";
						use_dept_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						if (model.getValue("/root/resData/fc_acct_2293_s/dataSet/CUR_WHCO_NDSTB_CD_LIST/record[1]/whco_comn_cost_yn") == "Y") {
							use_dept_cd.attribute("editable") = "false";
							use_dept_cd.attribute("background-color") = DEFAULT_COLOR_DISABLE;
							use_dept_cd.value = "999999";
							pch_buseonm.value = "공통부서";
						}


						// 예산별관리항목별로 필수색 셋팅
						fn_background_color_setting("1");

						// 예산코드에 따른 거래처구분, 관리구분 콤보 셋팅
						fn_dlco_mang_clsf_setting();

						fun_budg_cd_ch();
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					
						// 팝업 시작
						if (gvar_evnt_check_flag == "N") {
							if (budg_cd.value.Trim().length == 6) {
								model.removeNodeset("/root/reqData/fwdData");  
								model.removeNodeset("/root/tempData/dataSet");  
								model.makeNode("/root/reqData/fwdData/cmpy_cd");
								model.makeNode("/root/reqData/fwdData/cd");
								model.makeNode("/root/reqData/fwdData/cdnm");
								model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
								model.setValue("/root/reqData/fwdData/cd", budg_cd.value);
								model.setValue("/root/reqData/fwdData/cdnm", "");
								model.send("mc_co_1001_l");
			
								if (Number(model.getValue("/root/tempData/dataSet/CURLIST/totalcnt")) == 1
								&& budg_cd.value == model.getValue("/root/tempData/dataSet/CURLIST/record/cd")) {
									pch_sdysnm.value = model.getValue("/root/tempData/dataSet/CURLIST/record/cdnm");
								}
								else {
									budg_cd.value = "";
									pch_sdysnm.value = "";
								}
							}
							else {
								budg_cd.value = "";
								pch_sdysnm.value = "";
							}
						}
						
						// 팝업 끝

						if (budg_cd.value.Trim() != "" && budg_cd.value.Trim().length < 6) { return; }
						
						//입력값 설정
						set_refvalue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
						set_refvalue("/root/reqData/searchData/budg_cd", budg_cd.value);
						//실행
						
						if (gvar_evnt_check_flag != "N") {
							model.copyNode( "/root/resData/fc_acct_2293_s/dataSet/CUR_WHCO_NDSTB_CD_LIST", "/root/initData/comboSet/fc_acct_2290_m/dataSet/CUR_WHCO_NDSTB_CD_LIST");
						}
						else{							
							model.send("fc_acct_2293_s");
						}
						
						// 전사공통비여부가 "1" 이면 사용부서 "999999"
						use_dept_cd.attribute("editable") = "true";
						use_dept_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						if (model.getValue("/root/resData/fc_acct_2293_s/dataSet/CUR_WHCO_NDSTB_CD_LIST/record[1]/whco_comn_cost_yn") == "Y") {
							use_dept_cd.attribute("editable") = "false";
							use_dept_cd.attribute("background-color") = DEFAULT_COLOR_DISABLE;							
							use_dept_cd.value = "999999";
							pch_buseonm.value = "공통부서";
						}
																	
						// 예산별관리항목별로 필수색 셋팅
						fn_background_color_setting("1");
					
						// 예산코드에 따른 거래처구분, 관리구분 콤보 셋팅
						fn_dlco_mang_clsf_setting();		
						
						fun_budg_cd_ch();
					]]>
				</script>
			</input>
			<input id="input6" ref="/root/resData/resform/use_dept_cd" class="req" inputtype="button" maxlength="6" style="left:95px; top:54px; width:65px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						
						var var_con_date = "";
						var var_date_ch = parentWindow.srch_slip_occr_dt.value.ReplaceString("-", "");

						if (var_date_ch == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = var_date_ch;
							if(num_ch == 8){
								var_con_date = var_date_ch;
							}else if(num_ch == 6){
								var_con_date = var_date_ch + "01";
							}else if(num_ch == 4){
								var_con_date = var_date_ch + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "I");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						
						var var_con_date = "";
						var var_date_ch = parentWindow.srch_slip_occr_dt.value.ReplaceString("-", "");

						if (var_date_ch == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = var_date_ch;
							if(num_ch == 8){
								var_con_date = var_date_ch;
							}else if(num_ch == 6){
								var_con_date = var_date_ch + "01";
							}else if(num_ch == 4){
								var_con_date = var_date_ch + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (use_dept_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
							model.setValue("/root/reqData/fwdData/dept_cd", use_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "I");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								pch_buseonm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								use_dept_cd.value = "";
								pch_buseonm.value = "";
							}
						}
						else {
							use_dept_cd.value = "";
							pch_buseonm.value = "";
						}	
						
					]]>
				</script>
			</input>
			<input id="input7" ref="/root/resData/resform/pch_buseonm" editable="false" inputtype="input" style="left:163px; top:54px; width:132px; height:18px; "/>
			<input id="pch_sdysnm" ref="/root/resData/resform/pch_sdysnm" editable="false" inputtype="input" style="left:163px; top:29px; width:132px; height:18px; "/>
		</group>
		<datagrid id="datagrid3" nodeset="/root/resData/gridData/fc_acct_3256_l/dataSet/slip_list/record" caption="전표번호^회계일자^일련번호^SUB^적요1^유형^전표번호^상태^차변합계^대변합계^차액^입력자^적요2^부거래처명^관리구분^관리번호^소득구분^매체코드^상세매체^행사코드^행사명^사용부서^사용부서명^기산일^만기일^은행코드^은행명^단위^수량^대상코드^대상명^대상일자^대상금액^외화구분^외화금액^환율^어음상태^통합거래처^고정자산^잡수익^세금계산서^작성일자^사업장코드^공급자번호^상계전표^전사전표구분^전사전표번호^setoff_slip_occr_dt^setoff_slip_clsf_cd^setoff_slip_seq^setoff_slip_sub_seq^setoff_slip_arow_no" colsep="#" colwidth="114, 84, 22, 14, 212, 120, 18, 50, 95, 95, 55, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" navindex="7" style="left:1.06%; top:101px; width:97.89%; height:150px; text-align:center; ">
			<!-- 1.일          -->
			<col ref="slip_no" type="output" format="99999999-99-999-9"/>
			<col autonext="false" ref="slip_occr_dt" type="input" format="yyyy-mm-dd"/>
			<!-- 2.행번호        -->
			<col ref="slip_seq" type="output" visibility="hidden"/>
			<col ref="slip_sub_seq" visibility="hidden"/>
			<!-- 3.품의내역        -->
			<col ref="rmks1" type="input" style="text-align:left; "/>
			<!-- 4.유형      -->
			<col editmode="search" itemcount="10" ref="slip_clsf_cd" type="combo" style="text-align:left; border-style:sunken; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_3250_m/dataSet/CURLIST1/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</col>
			<!-- 5.전표번호     -->
			<col ref="slip_no" type="output" visibility="hidden" format="99999999-99-999-9"/>
			<!-- 6.상태       -->
			<col ref="slip_aprv_yn" type="output"/>
			<!-- 7.대변합계       -->
			<col ref="sum_dr_amt" format="(-)#,###" style="text-align:right; "/>
			<!-- 8.차변합계       -->
			<col ref="sum_crdt_amt" format="(-)#,###" style="text-align:right; "/>
			<!-- 9.차액        -->
			<col ref="diff_amt" format="(-)#,###" style="text-align:right; "/>
			<!-- 9.작업자        -->
			<col ref="incmg_emp_nm" type="output" style="text-align:center; "/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[				
					var row = datagrid3.row;
					if (-1 != event.target.lastIndexOf("scroll.thumb")) {
						return;
					}
					
					if (datagrid3.mouseRow < 1) {
						return;
					}
						
					var grid = eval(event.currentTarget);
					var rowid = grid.row;
					var colid = grid.col;
					
					if (rowid < grid.fixedRows || colid < grid.fixedCols) {
						return;
					}	
					
					if(datagrid3.valueMatrix(row,1) != ""){  //전표내용 검색 후 클릭시 세부사항 조회
						var col = datagrid3.col;				
						model.setValue("/root/reqData/searchData/slip_occr_dt",datagrid3.valueMatrix(row,2).ReplaceString("-", ""));
						model.setValue("/root/reqData/searchData/slip_clsf_cd",datagrid3.valueMatrix(row,6).ReplaceString("-", ""));
						model.setValue("/root/reqData/searchData/slip_seq",datagrid3.valueMatrix(row,3).ReplaceString("-", ""));
						model.setValue("/root/reqData/searchData/slip_sub_seq",datagrid3.valueMatrix(row,4).ReplaceString("-", ""));						
						model.send("fc_acct_3251_l");							
						model.makeNode("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2");
						model.copyNode("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2","/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST1");

						datagrid3.editCell(); 	
										
						fn_group3_reset();			
						datagrid3_lst_row = rowid;				
						model.setValue("/root/reqData/searchData/clam_dept_cd",model.getValue("/root/resData/gridData/fc_acct_3256_l/dataSet/slip_list/record[" + row + "]/clam_dept_cd"));
						model.setValue("/root/reqData/searchData/pch_cgbuseonm",model.getValue("/root/resData/gridData/fc_acct_3256_l/dataSet/slip_list/record[" + row + "]/clam_dept_nm"));
						model.setValue("/root/reqData/searchData/incmg_emp_no",model.getValue("/root/resData/gridData/fc_acct_3256_l/dataSet/slip_list/record[" + row + "]/incmg_emp_no"));
						model.setValue("/root/reqData/searchData/pch_irjnm",model.getValue("/root/resData/gridData/fc_acct_3256_l/dataSet/slip_list/record[" + row + "]/incmg_emp_nm"));

						if(datagrid2.valueMatrix(1,3) != ""){ //group3 채우기
							model.setFocus("datagrid2",true);
							datagrid2.col = 3;
							fn_GridToForm(1);
							fn_background_color_setting("1");																	
						}				
						datagrid1.addRow(false);
						datagrid1.rowStatus(datagrid1.rows - 1) = 0;
						datagrid1.row = 1;	datagrid1.col= 1;
						
						// key save
						gvar_slip_occr_dt = srch_slip_occr_dt.value.Trim().ReplaceString("-", "");		// 입력일자
						gvar_slip_clsf_cd = srch_slip_clsf_cd.value.Trim().ReplaceString("-", "");		// 전표구분
						gvar_slip_seq = srch_slip_seq.value.Trim().ReplaceString("-", "");			// 일련번호
						gvar_slip_sub_seq = srch_slip_sub_seq.value.Trim().ReplaceString("-", "");	// SUBSEQ
						
						var var_ref = datagrid1.colRef("vat_amt");
						var orgStr = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_valuematrix");
						for (i=1; i<datagrid1.rows - 1; i++) {
							if(getProperty("ss_cmpycd") != "100" && instr_yn(orgStr, datagrid1.valueMatrix(i,2))){									
								datagrid1.valueMatrix(i, var_ref) = Number(datagrid1.valueMatrix(i,4)) +Number(datagrid1.valueMatrix(i,5));
							}
						}						
						
					}
					
				]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					var row = datagrid3.row;
					var col = datagrid3.col;
					if(event.keycode == "13"){
						if(col == 2){
							datagrid3.col = 5;
							datagrid3.editCell();
						}else if(col == 5){
							datagrid3.col = 6;
							datagrid3.editCell();
						}else if(col == 6){
							model.setFocus("datagrid2",true);
							datagrid2.col = 3;
							datagrid2.editCell();
						}					
					}
				]]>
			</script>
			<script type="javascript" ev:event="onrowchanged">
				<![CDATA[		
					var grid = eval(event.currentTarget);
					var rowid = grid.row;
					var colid = grid.col;
					
					lst_row = 1;
					//맨마지막에 행추가하여 새로운 전표 입력
					if(datagrid3.valueMatrix(datagrid3_lst_row,1) == "" && datagrid3.valueMatrix(rowid,1) != ""){
						if(model1.alert("현재 입력중인 전표의 내용은 사라집니다. 그래도 진행하시겠습니까?", "알림", 4)  == 7){	
							datagrid3.row = datagrid3_lst_row;
							return; 
						}				
					}
					//for(var i = 1 ; i < datagrid2.rows ; i++){
					//	if (datagrid2.rowStatus(i) != 0 ){
					//		if(model1.alert("현재 입력중인 전표의 내용은 사라집니다. 그래도 진행하시겠습니까?", "알림", 4)  == 7){	
					//			datagrid3.row = datagrid3_lst_row;
					//			return; 
					//		}	
					//	}
					//}
					
					if(datagrid3.valueMatrix(rowid,1) == ""){								
						datagrid3.row = datagrid3.rows;
						return;
					}
				
					var col = datagrid3.col;
					var row = datagrid3.row;					
					model.setValue("/root/reqData/searchData/slip_occr_dt",datagrid3.valueMatrix(row,2).ReplaceString("-", ""));
					model.setValue("/root/reqData/searchData/slip_clsf_cd",datagrid3.valueMatrix(row,6).ReplaceString("-", ""));
					model.setValue("/root/reqData/searchData/slip_seq",datagrid3.valueMatrix(row,3).ReplaceString("-", ""));
					model.setValue("/root/reqData/searchData/slip_sub_seq",datagrid3.valueMatrix(row,4).ReplaceString("-", ""));						
					model.send("fc_acct_3251_l");							
					model.makeNode("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2");
					model.copyNode("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2","/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST1");

					datagrid3.editCell(); 	
									
					fn_group3_reset();			
					datagrid3_lst_row = rowid;
					if (model.getValue("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST/totalcnt") == 0) {
						show_message("검색결과가 없습니다.");
						return;
					}else {						
						model.setValue("/root/reqData/searchData/clam_dept_cd",model.getValue("/root/resData/gridData/fc_acct_3256_l/dataSet/slip_list/record[" + row + "]/clam_dept_cd"));
						model.setValue("/root/reqData/searchData/pch_cgbuseonm",model.getValue("/root/resData/gridData/fc_acct_3256_l/dataSet/slip_list/record[" + row + "]/clam_dept_nm"));
						model.setValue("/root/reqData/searchData/incmg_emp_no",model.getValue("/root/resData/gridData/fc_acct_3256_l/dataSet/slip_list/record[" + row + "]/incmg_emp_no"));
						model.setValue("/root/reqData/searchData/pch_irjnm",model.getValue("/root/resData/gridData/fc_acct_3256_l/dataSet/slip_list/record[" + row + "]/incmg_emp_nm"));

						if(datagrid2.valueMatrix(1,3) != ""){ //group3 채우기
							model.setFocus("datagrid2",true);
							datagrid2.col = 3;
							fn_GridToForm(1);
							fn_background_color_setting("1");																	
						}				
						datagrid1.addRow(false);
						datagrid1.rowStatus(datagrid1.rows - 1) = 0;
						datagrid1.row = 1;	datagrid1.col= 1;
						
						// key save
						gvar_slip_occr_dt = srch_slip_occr_dt.value.Trim().ReplaceString("-", "");		// 입력일자
						gvar_slip_clsf_cd = srch_slip_clsf_cd.value.Trim().ReplaceString("-", "");		// 전표구분
						gvar_slip_seq = srch_slip_seq.value.Trim().ReplaceString("-", "");			// 일련번호
						gvar_slip_sub_seq = srch_slip_sub_seq.value.Trim().ReplaceString("-", "");	// SUBSEQ
						
						var var_ref = datagrid1.colRef("vat_amt");
						var orgStr = model.getValue("/root/initData/comboSet/fc_acct_3250_m/dataSet/xx_valuematrix");
						for (i=1; i<datagrid1.rows - 1; i++) {
							if(getProperty("ss_cmpycd") != "100" && instr_yn(orgStr, datagrid1.valueMatrix(i,2))){									
								datagrid1.valueMatrix(i, var_ref) = Number(datagrid1.valueMatrix(i,4)) +Number(datagrid1.valueMatrix(i,5));
							}
						}
					
					}				
				]]>
			</script>
		</datagrid>
		<button id="button4" class="btn_grid03" crud="R" style="left:87.21%; top:81px; width:5.71%; height:17px; text-align:center; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[						
						var row = datagrid3.row;
						datagrid3.addRow(true,true);	
						datagrid3.rowStatus(row+1) = "2";
						datagrid3.valueMatrix(datagrid3.rows-1,2) = model.getValue("/root/reqData/searchData/slip_occr_dt");
						datagrid3.valueMatrix(datagrid3.rows-1,6) = model.getValue("/root/reqData/searchData/slip_clsf_cd");
						model.removeNodeset("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST1");						
						model.removeNodeset("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2");						
						fn_group3_reset();
						model.refresh();
						srch_slip_seq.value= "";  //20160706 봉은정추가
						datagrid3_lst_row =datagrid3.rows-1;
						datagrid2.addRow();
						datagrid2.valueMatrix(1,1) = "000001"; //행번호초기화
						datagrid2.rowStatus(1) = "1";	
						lst_row = 1;
						]]>
			</script>
		</button>
		<button id="button5" class="btn_grid03" crud="R" style="left:93.13%; top:81px; width:5.71%; height:17px; text-align:center; ">
			<caption>행삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[					
						var row = datagrid3.row;
						if(model1.alert("행삭제 하시겠습니까?", "알림", 4)  == 7){	return; }

						if(row != datagrid3.rows){
							datagrid3.deleteRow(row);
						}else{
							datagrid3.removeRow();
						}
						]]>
			</script>
		</button>
		<button id="button2" class="btn_grid03" crud="R" style="left:87.21%; top:255px; width:5.71%; height:17px; text-align:center; ">
			<caption>행추가</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[		
						if(lst_row != 0){		
							if (fn_FormToGrid(lst_row, "I") == false) {								
								datagrid2.row = lst_row;
								return;
							}	
						}
						fn_group3_reset();

						var rows = datagrid2.row; //datagrid2.rows;
						//alert(rows);
					    //datagrid2.addRow(true,true); //행추가	
						datagrid2.insertRow(datagrid2.row,"below",true,true);
						datagrid2.valueMatrix(rows+1,8) = datagrid2.valueMatrix(rows,8).ReplaceString(",","");
						datagrid2.valueMatrix(rows+1,9) = datagrid2.valueMatrix(rows,9).ReplaceString(",","");
						datagrid2.rowStatus(rows+1) = "1";						
						//datagrid2.valueMatrix(rows+1,1) = String(rows).GetZeroString(6);							
						datagrid2.valueMatrix(rows+1,8) = "0";	
						datagrid2.valueMatrix(rows+1,9) = "0";	
						datagrid2.valueMatrix(rows+1,10) = datagrid2.valueMatrix(rows,10);
						model.setValue("/root/resData/resform/use_dept_cd",clam_dept_cd.value);
						model.setValue("/root/resData/resform/pch_buseonm",pch_cgbuseonm.value);

						model.refresh();
						
						model.setFocus("datagrid2",true);
						lst_row = datagrid2.row;
						
						datagrid2.col = 3;
						datagrid2.editCell();						
					]]>
			</script>
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if(event.keycode == "13"){
						button2.dispatch("onclick");	
						model.setFocus("datagrid2",true);
						datagrid2.col = 3;
						datagrid2.editCell();
					}
					button2.attribute("border-style") ="none";
				]]>
			</script>
		</button>
		<button id="button3" class="btn_grid03" crud="R" style="left:93.13%; top:255px; width:5.71%; height:17px; text-align:center; ">
			<caption>행삭제</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[							
						var row = datagrid2.row;
						//if(row < 2){
						//	alert("첫 행은 삭제할 수 없습니다."); return;
						//}
						if(model1.alert("행삭제 하시겠습니까?", "알림", 4)  == 7){	return; }
						if(row != datagrid2.rows){
							datagrid2.deleteRow(row);
						}else{
							datagrid2.removeRow();
						}
						datagrid2.row = datagrid2.rows;
						lst_row = lst_row-1;
						if(datagrid2.valueMatrix(lst_row,3) != ""){
							if(lst_row == "0"){
								fn_GridToForm(lst_row+1);
								fn_background_color_setting("1");	
							}else{
							fn_GridToForm(lst_row);
							fn_background_color_setting("1");	
							}
							
						}
						datagrid2.refresh();
						]]>
			</script>
		</button>
		<output id="output5" bind="tot_dr_amt" ref="/root/tempData2/tot_dr_amt" visibility="hidden" format="(-)###,###,###,##0" style="left:56.03%; top:253px; width:8.77%; height:18px; font-size:8pt; font-weight:bold; color:#0000ff; text-align:right; background-color:transparent; border-color:transparent; border-style:none; "/>
		<output id="output9" bind="tot_crdt_amt" ref="/root/tempData2/tot_crdt_amt" visibility="hidden" format="(-)###,###,###,##0" style="left:64.69%; top:253px; width:8.77%; height:18px; font-size:8pt; font-weight:bold; color:#0000ff; text-align:right; background-color:transparent; border-color:transparent; border-style:none; "/>
		<button id="button7" class="btn04" navindex="42" crud="R" style="left:11.10%; top:678px; width:9.51%; height:21px; ">
			<caption>증빙유형수정</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[	
						if(occr_slip_occr_dt.value != "" && occr_slip_clsf_cd.value != "" && occr_slip_seq.value != ""){							
							if(model1.alert("증빙유형을 "+prof_type_cd.label+" 으로 수정하시겠습니까?", "알림", 4)  == 7){
								return; 
							}else{		
								model.setValue("/root/reqData/fc_acct_3257_a/cmpy_cd", getProperty("ss_cmpycd"));
								model.setValue("/root/reqData/fc_acct_3257_a/slip_occr_dt", occr_slip_occr_dt.value);
								model.setValue("/root/reqData/fc_acct_3257_a/slip_clsf_cd", occr_slip_clsf_cd.value);
								model.setValue("/root/reqData/fc_acct_3257_a/slip_seq", occr_slip_seq.value);
								model.setValue("/root/reqData/fc_acct_3257_a/incmg_pers", getProperty("ss_emp_no"));
								model.setValue("/root/reqData/fc_acct_3257_a/incmg_pers_ipadd", "");
								model.setValue("/root/reqData/fc_acct_3257_a/prof_type_cd", prof_type_cd.value);
							
								model.send("fc_acct_3257_a");
								if(submit_completed()){
								show_message("증빙유형이 수정되었습니다.");
								}
							}	
						}
					]]>
			</script>
		</button>
		<button id="button8" class="btn_grid02" crud="R" style="left:11.84%; top:80px; width:5.81%; height:17px; text-align:center; ">
			<caption>찾기</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[		
					var startrow = datagrid3.row+1;
					if(startrow <= 0)
						startrow = 1;
					var src_row = datagrid3.findRow(input2.currentText, parseInt(startrow), 5, false, false);
					if(src_row<0){
						var src_row = datagrid3.findRow(input2.currentText,1, 5, false, false);
						if(src_row<0){
							alert("검색결과가 없습니다."); 
							return;
						}
					}
					datagrid3.row = src_row;
					datagrid3.topRow = src_row;
				]]>
			</script>
		</button>
		<input id="input3" ref="/root/src_2" style="left:1.06%; top:255px; width:10.57%; height:18px; ">
			<script type="javascript" ev:event="onkeypress">
				<![CDATA[
					if(event.keycode == "13"){
						button9.dispatch("onclick");
					}
				]]>
			</script>
		</input>
		<button id="button9" class="btn_grid02" crud="R" style="left:11.84%; top:255px; width:5.81%; height:17px; text-align:center; ">
			<caption>찾기</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[					
					var startrow = datagrid2.row+1;
					if(startrow <= 0){
						startrow = 1;
					}
					for(var i = 1; i<11;i++){
						var src_row = datagrid2.findRow(input3.currentText, parseInt(startrow), i, false, false);
						if(src_row > 0 ){
							datagrid2.row = src_row;
							datagrid2.topRow = src_row;
							return;
						}else{
							datagrid2.row = 1;
						}
					}
					//datagrid2.row = src_row;
					//datagrid2.topRow = src_row;
				]]>
			</script>
		</button>
		<datagrid id="datagrid4" nodeset="/root/resData/gridData/fc_acct_3251_l/dataSet/datagrid4/record" visibility="hidden" caption="행번호^차대구분^예산코드^예산코드명^거래처코드^거래처명^부거래처명^차변금액^대변금액^적요2^적요1^거래처구분코드^관리구분^관리번호^소득구분^매체코드^상세매체^행사코드^행사명^사용부서^사용부서명^기산일^만기일^은행코드^은행명^단위^수량^대상코드^대상명^대상일자^대상금액^외화구분^외화금액^환율^어음상태^통합거래처^영수증구분^잡수익^세금계산서^작성일자^사업장코드^공급자번호^상계전표^전사전표구분^전사전표번호^상계전표발생일자^상계전표구분코드^상계전표일련번호^상계전표SUB SEQ^상계전표행번호^부가세^과표^관리구분코드명^E_MAIL^비고^품목^수정사유" colsep="#" colwidth="50, 67, 95, 110, 130, 130, 100, 80, 80, 107, 200, 150, 100, 100, 100, 100, 100, 100, 100, 83, 100, 100, 100, 100, 100, 100, 67, 93, 100, 100, 80, 100, 80, 88, 87, 98, 98, 100, 150, 100, 100, 100, 150, 100, 150, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" style="left:1.06%; top:415px; width:82.45%; height:80px; text-align:center; ">
			<col ref="slip_arow_no"/>
			<col ref="drcr_clsf"/>
			<col ref="budg_cd"/>
			<col ref="pch_sdysnm"/>
			<col ref="dlco_cd"/>
			<col ref="dlco_nm"/>
			<col ref="boks_dlco_nm"/>
			<col ref="dr_amt"/>
			<col ref="crdt_amt"/>
			<col ref="rmks2"/>
			<col ref="rmks1"/>
			<col ref="dlco_clsf_cd"/>
			<col ref="mang_clsf_cd"/>
			<col ref="mang_no"/>
			<col ref="incm_clsf_cd"/>
			<col ref="medi_cd"/>
			<col ref="dtls_medi_cd"/>
			<col ref="evnt_cd"/>
			<col ref="pch_hsnm"/>
			<col ref="use_dept_cd"/>
			<col ref="pch_buseonm"/>
			<col ref="comp_dt"/>
			<col ref="mtry_dt"/>
			<col ref="bank_cd"/>
			<col ref="pch_banknm"/>
			<col ref="unit"/>
			<col ref="qunt"/>
			<col ref="obj_acct_cd"/>
			<col ref="pch_dsacctnm"/>
			<col ref="obj_dt"/>
			<col ref="obj_amt"/>
			<col ref="frcr_clsf_cd"/>
			<col ref="frcr_amt"/>
			<col ref="exrate"/>
			<col ref="note_stat"/>
			<col ref="intg_dlco_cd"/>
			<col ref="prop_equip_cd"/>
			<col ref="etc_in"/>
			<col ref="tax_stmt_no" format="99-99-99999999-9999"/>
			<col ref="make_dt"/>
			<col ref="erplace_cd"/>
			<col ref="ern"/>
			<col ref="setoff_slip_no"/>
			<col ref="occr_slip_clsf"/>
			<col ref="occr_slip"/>
			<col ref="setoff_slip_occr_dt"/>
			<col ref="setoff_slip_clsf_cd"/>
			<col ref="setoff_slip_seq"/>
			<col ref="setoff_slip_sub_seq"/>
			<col ref="setoff_slip_arow_no"/>
			<col ref="vat_amt"/>
			<col ref="suply_amt"/>
			<col ref="mang_clsf_nm"/>
			<col ref="email_id"/>
			<col ref="remk"/>
			<col ref="item"/>
			<col ref="re_issu_resn_cd"/>
		</datagrid>
		<button id="button10" style="left:19.56%; top:253px; width:9.94%; height:19px; text-align:center; background-color:#dce5ec; border-color:#000000; border-style:solid; ">
			<caption>업로드양식받기</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						var filename = window.fileDialog("save", ",", false, "업로드양식", "xls", "Excel File(*.xls)|*.xls");
						if(filename!=""){
						datagrid4.saveExcel(filename, "sheetname: ");			
					}
					]]>
			</script>
		</button>
		<button id="button11" style="left:29.70%; top:253px; width:5.50%; height:19px; text-align:center; background-color:#dce5ec; border-color:#000000; border-style:solid; ">
			<caption>업로드</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						var row_id;
						var headName;
						var filename = window.fileDialog("open", ",", false, "", "xls*", "Excel File(*.xls*)|*.xls*");
						if( filename!="" )
						{
							model.removeNodeset("/root/resData/gridData/fc_acct_3251_l/dataSet/datagrid4");
							datagrid4.loadExcel(filename, 1, true); 
							datagrid4.deleteitem(1);									
						}
						model.copyNode("/root/resData/gridData/fc_acct_3251_l/dataSet/CURLIST2"	, "/root/resData/gridData/fc_acct_3251_l/dataSet/datagrid4");
						model.refresh();
						for( row_id=datagrid2.fixedRows;row_id<datagrid2.rows; row_id++ )
						{
							datagrid2.rowStatus(row_id) = "1";

							var dr_amt = datagrid2.valueMatrix(row_id,8);
							if (dr_amt == "") {
								datagrid2.valueMatrix(row_id,8)= "0";
							}
							var crdt_amt = datagrid2.valueMatrix(row_id,9);
							if (crdt_amt == "") {
								datagrid2.valueMatrix(row_id,9)= "0";
							}
							if (Number(datagrid2.valueMatrix(row_id, 8).Trim()) != 0) {
								datagrid2.valueMatrix(row_id, 2)  = "1";
							}
							else {
								datagrid2.valueMatrix(row_id, 2)  = "9";
							}
						}
					]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
