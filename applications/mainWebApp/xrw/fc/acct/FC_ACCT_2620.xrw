<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>시점별조직계층등록</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<comboSet>
							<dlco_cd>
								<item>
									<label/>
									<value/>
								</item>
							</dlco_cd>
							<dlco_clsf_cd>
								<item>
									<label/>
									<value/>
								</item>
							</dlco_clsf_cd>
							<slip_clsf_cd>
								<item>
									<label/>
									<value/>
								</item>
							</slip_clsf_cd>
						</comboSet>
						<gridSet>
							<dataSet>
								<CURLIST>
									<record>
										<fisc_dt/>
										<slip_no/>
										<rmks/>
										<dr_amt/>
										<crdt_amt/>
										<mang_clsf_cd_nm/>
										<mang_no/>
										<dlco_clsf_cd_nm/>
										<dlco_cd/>
										<dlco_nm/>
										<boks_dlco_nm/>
										<medi_cd_nm/>
										<dtls_medi_cd_nm/>
										<evnt_cd_nm/>
										<clam_dept_cd_nm/>
										<insd_acct_cd/>
										<obj_acct_cd_nm/>
										<obj_amt/>
										<budg_cd/>
										<clas_nm/>
										<cfs_seq/>
										<clos_clsf/>
										<chk_yn/>
										<conn_grp/>
										<conn_seq/>
									</record>
								</CURLIST>
							</dataSet>
						</gridSet>
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<searchData>
							<cmpy_cd/>
							<fr_dt/>
							<to_dt/>
							<conn_cmpy_cd1/>
							<fr_budg_cd1/>
							<to_budg_cd1/>
							<slip_clsf_cd1/>
							<budg_clsf_cd1>00</budg_clsf_cd1>
							<conn_clsf_cd1>00</conn_clsf_cd1>
							<conn_cmpy_cd2/>
							<fr_budg_cd2/>
							<to_budg_cd2/>
							<slip_clsf_cd2/>
							<budg_clsf_cd2>00</budg_clsf_cd2>
							<conn_clsf_cd2>00</conn_clsf_cd2>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqForm>
							<fc_acct_2614_l>
								<cmpy_cd/>
								<slip_no/>
							</fc_acct_2614_l>
						</reqForm>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<!-- MultiUpDate유형 사용시 처리 -->
						<cnfmData>
							<cmpy_cd/>
							<slip_list/>
						</cnfmData>
						<connData>
							<cmpy_cd/>
							<fr_fisc_dt/>
							<to_fisc_dt/>
							<conn_cmpy_cd1/>
							<data_list1/>
							<conn_cmpy_cd2/>
							<data_list2/>
						</connData>
						<checkAll1/>
						<checkAll2/>
						<fwdData/>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<fc_acct_2614_l>
								<record>
									<fisc_dt/>
									<slip_no/>
									<rmks/>
									<dr_amt/>
									<crdt_amt/>
									<mang_clsf_cd_nm/>
									<mang_no/>
									<dlco_clsf_cd_nm/>
									<dlco_cd/>
									<dlco_nm/>
									<boks_dlco_nm/>
									<medi_cd_nm/>
									<dtls_medi_cd_nm/>
									<evnt_cd_nm/>
									<clam_dept_cd_nm/>
									<insd_acct_cd/>
									<obj_acct_cd_nm/>
									<obj_amt/>
									<budg_cd/>
									<clas_nm/>
									<cfsobj_seq/>
									<clos_clsf/>
									<chk_yn/>
								</record>
							</fc_acct_2614_l>
						</resForm>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<msg/>
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<inamt1/>
						<outamt1/>
						<inamt2/>
						<outamt2/>
						<chk_inamt1/>
						<chk_outamt1/>
						<chk_inamt2/>
						<chk_outamt2/>
						<con_inamt/>
						<con_outamt/>
						<chk_con_inamt/>
						<chk_con_outamt/>
						<totcnt/>
						<gridData1>
							<dataSet>
								<CURLIST>
									<record>
										<fisc_dt/>
										<slip_no/>
										<rmks/>
										<dr_amt/>
										<crdt_amt/>
										<mang_clsf_cd_nm/>
										<mang_no/>
										<dlco_clsf_cd_nm/>
										<dlco_cd/>
										<dlco_nm/>
										<boks_dlco_nm/>
										<medi_cd_nm/>
										<dtls_medi_cd_nm/>
										<evnt_cd_nm/>
										<clam_dept_cd_nm/>
										<insd_acct_cd/>
										<obj_acct_cd_nm/>
										<obj_amt/>
										<budg_cd/>
										<clas_nm/>
										<cfs_seq/>
										<clos_clsf/>
										<chk_yn/>
										<conn_grp/>
										<conn_seq/>
									</record>
								</CURLIST>
							</dataSet>
						</gridData1>
						<gridData2>
							<dataSet>
								<CURLIST>
									<record>
										<fisc_dt/>
										<slip_no/>
										<rmks/>
										<dr_amt/>
										<crdt_amt/>
										<mang_clsf_cd_nm/>
										<mang_no/>
										<dlco_clsf_cd_nm/>
										<dlco_cd/>
										<dlco_nm/>
										<boks_dlco_nm/>
										<medi_cd_nm/>
										<dtls_medi_cd_nm/>
										<evnt_cd_nm/>
										<clam_dept_cd_nm/>
										<insd_acct_cd/>
										<obj_acct_cd_nm/>
										<obj_amt/>
										<budg_cd/>
										<clas_nm/>
										<cfs_seq/>
										<clos_clsf/>
										<chk_yn/>
										<conn_grp/>
										<conn_seq/>
									</record>
								</CURLIST>
							</dataSet>
						</gridData2>
					</resData>
					<tempData/>
				</root>
			</instance>
			<script type="javascript">
				<![CDATA[

				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				
					set_refvalue("/root/reqData/searchData/cmpy_cd", getProperty("ss_cmpycd"));
					model.send("fc_acct_2620_m");
					
					//초기값설정
					set_refvalue("/root/reqData/searchData/fr_dt",commCurDate());
					set_refvalue("/root/reqData/searchData/to_dt",commCurDate());
					set_refvalue("/root/reqData/searchData/dlco_clsf_cd1", "00");
					set_refvalue("/root/reqData/searchData/cnfm_clsf_cd1", "00");
					set_refvalue("/root/reqData/searchData/dlco_clsf_cd2", "00");
					set_refvalue("/root/reqData/searchData/cnfm_clsf_cd2", "00");
					
					combo3.select(2);	//미연결 기본설정
					combo7.select(2);;	//미연결 기본설정
					

					fn_init_amtdata();

					model.refresh();

				]]>
			</script>
			<submission id="fc_acct_2613_u" action="/fc/acct2000/2613" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="fc_acct_2614_l" action="/fc/acct2000/2614" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm/fc_acct_2614_l" resultref="/root/tempData"/>
			<submission id="fc_acct_2620_m" action="/fc/acct2000/2620" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/cmpy_cd" resultref="/root/tempData"/>
			<submission id="fc_acct_2621_l" action="/fc/acct2000/2621" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<bind id="bind_inamt1" ref="/root/resData/inamt1" calculate="sum(/root/resData/gridData1/dataSet/CURLIST/record/crdt_amt)"/>
			<bind id="bind_outamt1" ref="/root/resData/outamt1" calculate="sum(/root/resData/gridData1/dataSet/CURLIST/record/dr_amt)"/>
			<bind id="bind_inamt2" ref="/root/resData/inamt2" calculate="sum(/root/resData/gridData2/dataSet/CURLIST/record/crdt_amt)"/>
			<bind id="bind_outamt2" ref="/root/resData/outamt2" calculate="sum(/root/resData/gridData2/dataSet/CURLIST/record/dr_amt)"/>
			<submission id="fc_acct_2622_u" action="/fc/acct2000/2622" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/connData" resultref="/root/tempData"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/fcmc_common.js"/>
		<script type="javascript" src="/js/ad_common.js"/>
		<script type="javascript">
			<![CDATA[
			
			function fn_recalc_diff() {
					/*
					con_inamt.value = Number(inamt1.value) - Number(inamt2.value);
					con_outamt.value = Number(outamt1.value) - Number(outamt2.value);
					chk_con_inamt.value = Number(chk_inamt1.value) - Number(chk_inamt2.value);
					chk_con_outamt.value = Number(chk_outamt1.value) - Number(chk_outamt2.value);
					*/
					/*
					con_inamt.value = Number(get_refvalue("/root/resData/inamt1")) - Number(get_refvalue("/root/resData/inamt2"));
					con_outamt.value = Number(get_refvalue("/root/resData/outamt1")) - Number(get_refvalue("/root/resData/outamt2"));
					chk_con_inamt.value = Number(get_refvalue("/root/resData/chk_inamt1")) - Number(get_refvalue("/root/resData/chk_inamt2"));
					chk_con_outamt.value = Number(get_refvalue("/root/resData/chk_outamt1")) - Number(get_refvalue("/root/resData/chk_outamt2"));
					*/
					/*
					set_refvalue("/root/resData/con_inamt", Number(get_refvalue("/root/resData/inamt1")) - Number(get_refvalue("/root/resData/inamt2")));
					set_refvalue("/root/resData/con_outamt", Number(get_refvalue("/root/resData/outamt1")) - Number(get_refvalue("/root/resData/outamt2")));
					set_refvalue("/root/resData/chk_con_inamt", Number(get_refvalue("/root/resData/chk_inamt1")) - Number(get_refvalue("/root/resData/chk_inamt2")));
					set_refvalue("/root/resData/chk_con_outamt", Number(get_refvalue("/root/resData/chk_outamt1")) - Number(get_refvalue("/root/resData/chk_outamt2")));
					*/
					
					set_refvalue("/root/resData/con_inamt", Number(get_refvalue("/root/resData/inamt1")) - Number(get_refvalue("/root/resData/outamt2")));
					set_refvalue("/root/resData/con_outamt", Number(get_refvalue("/root/resData/outamt1")) - Number(get_refvalue("/root/resData/inamt2")));
					set_refvalue("/root/resData/chk_con_inamt", Number(get_refvalue("/root/resData/chk_inamt1")) - Number(get_refvalue("/root/resData/chk_outamt2")));
					set_refvalue("/root/resData/chk_con_outamt", Number(get_refvalue("/root/resData/chk_outamt1")) - Number(get_refvalue("/root/resData/chk_inamt2")));
					
					model.refresh();
			}
			
			function fn_init_amtdata() {				
				set_refvalue("/root/resData/inamt1", "0");
				set_refvalue("/root/resData/outamt1", "0");
				set_refvalue("/root/resData/inamt2", "0");
				set_refvalue("/root/resData/outamt2", "0");
				set_refvalue("/root/resData/chk_inamt1", "0");
				set_refvalue("/root/resData/chk_outamt1", "0");
				set_refvalue("/root/resData/chk_inamt2", "0");
				set_refvalue("/root/resData/chk_outamt2", "0");
				set_refvalue("/root/resData/con_inamt", "0");
				set_refvalue("/root/resData/con_outamt", "0");
				set_refvalue("/root/resData/chk_con_inamt", "0");
				set_refvalue("/root/resData/chk_con_outamt", "0");
			}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="768" guideline="2,760;1,936;1,936;1,935;2,762;" style="font-family:굴림; text-align:left; background-image:../../images/bg_946.gif; ">
		<caption id="caption29" class="list_cap02" style="left:465px; top:689px; width:471px; height:26px; text-align:center; "/>
		<caption id="caption33" class="list_cap02" style="left:465px; top:714px; width:471px; height:26px; text-align:center; "/>
		<caption id="caption27" class="list_cap02" style="left:465px; top:655px; width:471px; height:26px; text-align:center; "/>
		<caption id="caption22" class="list_cap02" style="left:10px; top:385px; width:925px; height:26px; text-align:center; "/>
		<caption id="caption8" class="list_cap02" style="left:10px; top:40px; width:276px; height:26px; text-align:center; "/>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group_btnA" class="gro_btn" style="left:10px; top:40px; width:925px; height:25px; ">
			<button id="button4" class="btn02" style="left:856px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
				 	viewer("mainFrame").window.javaScript.closeMDIWindow(model.getValue("/root/initData/pageInfo/pageID"));
					]]>
				</script>
			</button>
			<button id="button6" class="btn02" visibility="visible" style="left:631px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if(combo1.value == "" || combo5.value == "") {
						alert("연결대상 회사를 각각 선택해 주세요");
						return;
					}

					if(combo1.value == combo5.value) {
						alert("연결대상 회사는 같을 수 없습니다.");
						return;
					}

					model.removeNodeset("/root/resData/gridData1/dataSet/");
					model.removeNodeset("/root/resData/gridData2/dataSet/");

					model.copyNode("/root/resData/gridData1/dataSet", "/root/initData/gridSet/dataSet");
					model.copyNode("/root/resData/gridData2/dataSet", "/root/initData/gridSet/dataSet");
					fn_init_amtdata();

					datagrid1.refresh();
					datagrid2.refresh();
					
					set_refvalue("/root/reqData/searchData/cmpy_cd",getProperty("ss_cmpycd"));
					model.send("fc_acct_2621_l");

					if(get_refvalue("/root/tempData/gridData1/CURLIST/totalcnt1") == 0 && get_refvalue("/root/tempData/gridData2/CURLIST/totalcnt2") == 0)
					{
							show_message("검색결과가 없습니다.");
							fn_init_amtdata();

							model.refresh();
							return false;
					}

					
					model.copyNode("/root/resData/gridData1/dataSet/CURLIST", "/root/tempData/gridData1/CURLIST");	//지배회사 조회결과(화면상단)
					model.copyNode("/root/resData/gridData2/dataSet/CURLIST", "/root/tempData/gridData2/CURLIST");	//종속회사 조회결과(화면하단)

					//지배회사 금액설정					
					set_refvalue("/root/resData/inamt1",   get_refvalue("/root/tempData/gridData1/CURLIST/inamt1"));
					set_refvalue("/root/resData/outamt1", get_refvalue("/root/tempData/gridData1/CURLIST/outamt1"));
					set_refvalue("/root/resData/chk_inamt1",   get_refvalue("/root/tempData/gridData1/CURLIST/chk_inamt1"));
					set_refvalue("/root/resData/chk_outamt1", get_refvalue("/root/tempData/gridData1/CURLIST/chk_outamt1"));
					//종속회사 금액설정
					set_refvalue("/root/resData/inamt2",   get_refvalue("/root/tempData/gridData2/CURLIST/inamt2"));
					set_refvalue("/root/resData/outamt2", get_refvalue("/root/tempData/gridData2/CURLIST/outamt2"));
					set_refvalue("/root/resData/chk_inamt2",   get_refvalue("/root/tempData/gridData2/CURLIST/chk_inamt2"));
					set_refvalue("/root/resData/chk_outamt2", get_refvalue("/root/tempData/gridData2/CURLIST/chk_outamt2"));
					fn_recalc_diff();
					
					model.removeNode("/root/tempData/CURLIST");
					model.refresh();

					]]>
				</script>
			</button>
			<button id="button7" class="btn02" disabled="true" style="left:800px; top:0px; width:52px; height:21px; ">
				<caption>마감</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" style="left:744px; top:0px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[					
					var grid = null;

					grid = datagrid1;
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname:내부거래연결확정;rowhiddenextend:false");
					}
					]]>
				</script>
			</button>
			<button id="button1" class="btn02" visibility="visible" style="left:688px; top:0px; width:52px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var data_list1 = "";
						var data_list2 = "";
						var str_val     = "";
						var conn_grp  = "";
						var chkcnt    = 0;

						if(datagrid1.rows<=1 && datagrid2.rows<=1) return;
						
						if(combo1.value == "" || combo5.value == "") {
							alert("연결대상 회사를 각각 선택해 주세요");
							return;
						}
	
						if(combo1.value == combo5.value) {
							alert("연결대상 회사는 같을 수 없습니다.");
							return;
						}
						
						if(datagrid1.rows>1000 || datagrid2.rows>1000) {
							alert("내부거래 대상 연결은 한번에 1,000건 이하 만 가능합니다.");
							return;
						}
						
						
						//연결내용 설정(datagrid1)
						chkcnt = 0;
						for(var i=1; i<datagrid1.rows; i++) {														
							//if(datagrid1.valueMatrix(i,1) == "Y") {
								str_val = "";
								
								//연결그룹
								if(datagrid1.valueMatrix(i,2)=="") {
									conn_grp = "000";
								} else {
									conn_grp = datagrid1.valueMatrix(i,2);
								}
								
								str_val = datagrid1.valueMatrix(i,5) + ":" +	//회계년월
									     datagrid1.valueMatrix(i,22) + ":" +  //확정seq
									     datagrid1.valueMatrix(i,23) + ":" +  //마감여부
									     datagrid1.valueMatrix(i,1) + ":" + 	//chk_yn
									     conn_grp + ":" +				//연결그룹
									     datagrid1.valueMatrix(i,24) + ":" +  //연결seq
									     datagrid1.valueMatrix(i,6) + ":" +	//전표번호
									     datagrid1.valueMatrix(i,8) + ":" +	//차변
									     datagrid1.valueMatrix(i,9);		//대변
									     
								data_list1 = data_list1 + str_val + "#";
								chkcnt++;
							//}							
						}						
						data_list1 = data_list1.substring(0, data_list1.length - 1);
						
						
						//연결내용 설정(datagrid2)
						chkcnt = 0;
						for(var i=1; i<datagrid2.rows; i++) {														
							//if(datagrid2.valueMatrix(i,1) == "Y") {
								str_val = "";
								
								//연결그룹
								if(datagrid2.valueMatrix(i,2)=="") {
									conn_grp = "000";
								} else {
									conn_grp = datagrid2.valueMatrix(i,2);
								}
								
								str_val = datagrid2.valueMatrix(i,5) + ":" +	//회계년월
									     datagrid2.valueMatrix(i,22) + ":" +  //확정seq
									     datagrid2.valueMatrix(i,23) + ":" +  //마감여부
									     datagrid2.valueMatrix(i,1) + ":" + 	//chk_yn
									     conn_grp + ":" +				//연결그룹
									     datagrid2.valueMatrix(i,24) + ":" +  //연결seq
									     datagrid2.valueMatrix(i,6) + ":" +	//전표번호
									     datagrid2.valueMatrix(i,8) + ":" +	//차변
									     datagrid2.valueMatrix(i,9);		//대변
									     
								data_list2 = data_list2 + str_val + "#";
								chkcnt++;
							//}							
						}						
						data_list2 = data_list2.substring(0, data_list2.length - 1);
						
						
						set_refvalue("/root/reqData/connData/cmpy_cd",getProperty("ss_cmpycd"));	//회사코드
						set_refvalue("/root/reqData/connData/fr_fisc_dt", get_refvalue("/root/reqData/searchData/fr_dt"));	//회계일자(시작)
						set_refvalue("/root/reqData/connData/to_fisc_dt", get_refvalue("/root/reqData/searchData/to_dt"));	//회계일자(종료)
						set_refvalue("/root/reqData/connData/conn_cmpy_cd1", get_refvalue("/root/reqData/searchData/conn_cmpy_cd1"));		//연결회사(지배)
						set_refvalue("/root/reqData/connData/data_list1", data_list1);	//연결정보1(지배)
						set_refvalue("/root/reqData/connData/conn_cmpy_cd2", get_refvalue("/root/reqData/searchData/conn_cmpy_cd2"));		//연결회사(종속)
						set_refvalue("/root/reqData/connData/data_list2", data_list2);	//연결정보2(종속)

						model.send("fc_acct_2622_u");
						
						button6.dispatch("onclick");

					]]>
				</script>
			</button>
		</group>
		<caption id="caption4" class="list_cap02" style="left:11px; top:70px; width:925px; height:26px; text-align:center; "/>
		<caption id="caption2" class="list_cap03" style="left:10px; top:70px; width:70px; height:26px; text-align:center; ">연결회사</caption>
		<select1 id="combo1" ref="/root/reqData/searchData/conn_cmpy_cd1" class="req" appearance="minimal" style="left:85px; top:74px; width:125px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/dlco_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="caption1" class="list_cap03" style="left:10px; top:40px; width:70px; height:26px; text-align:center; ">대상기간</caption>
		<caption id="caption3" class="list_cap03" style="left:217px; top:70px; width:70px; height:26px; text-align:center; ">대상계정</caption>
		<caption id="caption6" class="list_cap03" style="left:631px; top:70px; width:70px; height:26px; text-align:center; ">연결여부</caption>
		<input id="input21" ref="/root/reqData/searchData/to_dt" class="req" navindex="3" inputtype="date" format="yyyy-mm-dd" style="left:194px; top:44px; width:90px; height:18px; "/>
		<caption id="caption34" style="left:177px; top:45px; width:15px; height:17px; text-align:center; ">~</caption>
		<input id="input6" ref="/root/reqData/searchData/fr_dt" class="req" navindex="2" inputtype="date" format="yyyy-mm-dd" style="left:85px; top:44px; width:90px; height:18px; "/>
		<input id="fr_budg_cd" ref="/root/reqData/searchData/fr_budg_cd1" navindex="4" format="999999" style="left:293px; top:74px; width:65px; height:18px; "/>
		<input id="to_budg_cd" ref="/root/reqData/searchData/to_budg_cd1" navindex="5" format="999999" style="left:376px; top:74px; width:65px; height:18px; "/>
		<caption id="caption7" style="left:359px; top:77px; width:15px; height:15px; text-align:center; ">~</caption>
		<select1 id="combo3" ref="/root/reqData/searchData/conn_clsf_cd1" appearance="minimal" style="left:707px; top:74px; width:70px; height:18px; ">
			<choices>
				<item>
					<label>전체</label>
					<value>00</value>
				</item>
				<item>
					<label>연결</label>
					<value>10</value>
				</item>
				<item>
					<label>미연결</label>
					<value>20</value>
				</item>
				<item>
					<label>마감</label>
					<value>30</value>
				</item>
			</choices>
		</select1>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData1/dataSet/CURLIST/record" caption="연결^연결그룹^예산코드^예산명^회계일자^전표번호^적요^차변금액^대변금액^관리구분^관리번호^거래처구분^거래처코드^거래처명^부거래처명^매체코드^상세매체코드^행사코드^청구부서^대상계정^대상금액^확정여부^^" colsep="#" colwidth="38, 59, 59, 114, 80, 150, 200, 95, 95, 100, 100, 100, 100, 125, 100, 100, 100, 100, 108, 110, 108, 0, 0, 0" extendlastcol="scroll" frozencols="6" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:10px; top:105px; width:926px; height:200px; ">
			<col checkvalue="Y,N" ref="chk_yn" type="checkbox"/>
			<col ref="conn_grp" type="output" style="left:58px; top:20px; width:59px; height:20px; "/>
			<col ref="budg_cd" type="output"/>
			<col ref="budg_nm" type="output"/>
			<col ref="fisc_dt" type="output" format="yyyy-mm"/>
			<col ref="slip_no" type="output"/>
			<col ref="rmks" type="output"/>
			<col ref="dr_amt" type="input" format="(-)#,###" style="text-align:right; background-color:#e0e0e0; "/>
			<col ref="crdt_amt" type="input" format="(-)#,###" style="text-align:right; background-color:#e0e0e0; "/>
			<col ref="mang_clsf_cd_nm" type="output"/>
			<col ref="mang_no" type="output"/>
			<col ref="dlco_clsf_cd_nm" type="output" style="text-align:left; "/>
			<col ref="dlco_cd" type="output"/>
			<col ref="dlco_nm" type="output" style="text-align:left; "/>
			<col ref="boks_dlco_nm" type="output" style="text-align:left; "/>
			<col ref="medi_cd_nm" type="output" style="text-align:left; "/>
			<col ref="dtls_medi_cd_nm" type="output" style="text-align:left; "/>
			<col ref="evnt_cd_nm" type="output"/>
			<col ref="clam_dept_cd_nm" type="output"/>
			<col ref="obj_acct_cd_nm" type="output"/>
			<col ref="obj_amt" type="output" format="(-)#,###" style="text-align:right; "/>
			<col ref="cfs_seq" type="output" format="(-)#,###" style="text-align:right; "/>
			<col ref="clos_clsf" type="output" visibility="hidden"/>
			<col ref="conn_seq" type="output" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var row = datagrid1.row;
				var col  = datagrid1.col;
				var rows = datagrid1.rows;

				//금액 편집 시 차액계산
				if(col == 8 || col == 9) {
					fn_recalc_diff();
				}
				
				//선택시 수입,비용 금액계산(datagrid1)
				if(col == 1) {
					var dr_amt = 0;
					var crdt_amt = 0;
					
					for(var i=1; i<rows; i++) {

						if(datagrid1.valueMatrix(i,1) == "Y" ) {
							dr_amt = Number(dr_amt) + Number(datagrid1.valueMatrix(i, 8 ));		//차변,비용
							crdt_amt = Number(crdt_amt) + Number(datagrid1.valueMatrix(i, 9 ));		//대변,수입
						}
					}
					
					//chk_inamt1.value   = dr_amt;
					//chk_outamt1.value = crdt_amt;
					chk_outamt1.value   = dr_amt;	//차변
					chk_inamt1.value = crdt_amt;	//대변
					
					fn_recalc_diff();
				}
				]]>
			</script>
		</datagrid>
		<caption id="caption9" class="list_cap03" style="left:448px; top:70px; width:70px; height:26px; text-align:center; ">전표구분</caption>
		<select1 id="combo4" ref="/root/reqData/searchData/slip_clsf_cd1" appearance="minimal" style="left:524px; top:74px; width:100px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/slip_clsf_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="caption10" class="list_cap03" style="left:783px; top:70px; width:70px; height:26px; text-align:center; ">계정구분</caption>
		<caption id="caption11" class="list_cap02" style="left:465px; top:315px; width:471px; height:26px; text-align:center; "/>
		<output id="outamt1" bind="bind_outamt1" format="(-)#,###" style="left:775px; top:319px; width:155px; height:18px; text-align:right; vertical-align:middle; "/>
		<output id="inamt1" bind="bind_inamt1" format="(-)#,###" style="left:540px; top:319px; width:155px; height:18px; text-align:right; vertical-align:middle; "/>
		<select id="checkAll1" ref="/root/reqData/checkAll1" overflow="visible" appearance="full" style="left:10px; top:315px; width:70px; height:20px; border-style:none; ">
			<choices>
				<item>
					<label>전체선택</label>
					<value>1</value>
				</item>
			</choices>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						var rows = datagrid1.rows;

						if(model.getValue("/root/reqData/checkAll1") == "1"){
							for(var i=1; i < rows; i++){
								datagrid1.valueMatrix(i,1) = "Y";
							}
						}else{
							for(var i=1; i < rows; i++){
								datagrid1.valueMatrix(i,1) = "N";
							}							
						}
						
						//금액 재계산(datagrid1)
						var dr_amt = 0;
						var crdt_amt = 0;
						
						for(var i=1; i<datagrid1.rows; i++) {	
							if(datagrid1.valueMatrix(i,1) == "Y" ) {
								dr_amt = Number(dr_amt) + Number(datagrid1.valueMatrix(i, 8 ));		//차변,비용
								crdt_amt = Number(crdt_amt) + Number(datagrid1.valueMatrix(i, 9 ));		//대변,수입
							}
						}						
						//chk_inamt1.value   = dr_amt;
						//chk_outamt1.value = crdt_amt;						
						chk_outamt1.value   = dr_amt;	//차변
						chk_inamt1.value = crdt_amt;	//대변
						
						fn_recalc_diff();

						datagrid1.refresh();
					]]>
			</script>
		</select>
		<caption id="caption14" class="list_cap02" style="left:465px; top:340px; width:471px; height:26px; text-align:center; "/>
		<output id="chk_outamt1" ref="/root/resData/chk_outamt1" format="(-)#,###" style="left:775px; top:344px; width:155px; height:18px; text-align:right; vertical-align:middle; "/>
		<caption id="caption15" class="list_cap03" style="left:700px; top:340px; width:71px; height:26px; text-align:center; ">비용(선택)</caption>
		<caption id="caption16" class="list_cap03" style="left:465px; top:340px; width:70px; height:26px; text-align:center; ">수입(선택)</caption>
		<output id="chk_inamt1" ref="/root/resData/chk_inamt1" format="(-)#,###" style="left:540px; top:344px; width:155px; height:18px; text-align:right; vertical-align:middle; "/>
		<caption id="caption20" class="list_cap03" style="left:700px; top:315px; width:71px; height:26px; text-align:center; ">비용(확정)</caption>
		<select1 id="combo2" ref="/root/reqData/searchData/budg_clsf_cd1" appearance="minimal" style="left:859px; top:74px; width:70px; height:18px; ">
			<choices>
				<item>
					<label>전체</label>
					<value>00</value>
				</item>
				<item>
					<label>비용</label>
					<value>20</value>
				</item>
				<item>
					<label>수입</label>
					<value>10</value>
				</item>
			</choices>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				if(combo2.focusindex==0) {
					combo6.select(0);
				} else {
					combo6.select(3-combo2.focusindex);
				}
				]]>
			</script>
		</select1>
		<select id="checkAll2" ref="/root/reqData/checkAll2" overflow="visible" appearance="full" style="left:10px; top:630px; width:70px; height:20px; border-style:none; ">
			<choices>
				<item>
					<label>전체선택</label>
					<value>1</value>
				</item>
			</choices>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						var rows = datagrid2.rows;

						if(model.getValue("/root/reqData/checkAll2") == "1"){
							for(var i=1; i < rows; i++){
								datagrid2.valueMatrix(i,1) = "Y";
							}
						}else{
							for(var i=1; i < rows; i++){
								datagrid2.valueMatrix(i,1) = "N";
							}							
						}
						
						//금액 재계산(datagrid2)
						var dr_amt = 0;
						var crdt_amt = 0;
						
						for(var i=1; i<datagrid2.rows; i++) {	
							if(datagrid2.valueMatrix(i,1) == "Y" ) {
								dr_amt = Number(dr_amt) + Number(datagrid2.valueMatrix(i, 8 ));		//차변,비용
								crdt_amt = Number(crdt_amt) + Number(datagrid2.valueMatrix(i, 9 ));		//대변,수입
							}
						}						
						//chk_inamt2.value   = dr_amt;
						//chk_outamt2.value = crdt_amt;
						chk_outamt2.value   = dr_amt;	//차변
						chk_inamt2.value = crdt_amt;	//대변
						
						fn_recalc_diff();

						datagrid2.refresh();
					]]>
			</script>
		</select>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData2/dataSet/CURLIST/record" caption="연결^연결그룹^예산코드^예산명^회계일자^전표번호^적요^차변금액^대변금액^관리구분^관리번호^거래처구분^거래처코드^거래처명^부거래처명^매체코드^상세매체코드^행사코드^청구부서^대상계정^대상금액^확정여부^^" colsep="#" colwidth="38, 59, 59, 114, 80, 150, 200, 95, 95, 100, 100, 100, 100, 125, 100, 100, 100, 100, 108, 110, 108, 0, 0, 0" extendlastcol="scroll" frozencols="6" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:10px; top:420px; width:926px; height:200px; ">
			<col checkvalue="Y,N" ref="chk_yn" type="checkbox"/>
			<col ref="conn_grp" type="output" style="left:58px; top:20px; width:59px; height:20px; "/>
			<col ref="budg_cd" type="output"/>
			<col ref="budg_nm" type="output"/>
			<col ref="fisc_dt" type="output" format="yyyy-mm"/>
			<col ref="slip_no" type="output"/>
			<col ref="rmks" type="output"/>
			<col ref="dr_amt" type="input" format="(-)#,###" style="text-align:right; background-color:#e0e0e0; "/>
			<col ref="crdt_amt" type="input" format="(-)#,###" style="text-align:right; background-color:#e0e0e0; "/>
			<col ref="mang_clsf_cd_nm" type="output"/>
			<col ref="mang_no" type="output"/>
			<col ref="dlco_clsf_cd_nm" type="output" style="text-align:left; "/>
			<col ref="dlco_cd" type="output"/>
			<col ref="dlco_nm" type="output" style="text-align:left; "/>
			<col ref="boks_dlco_nm" type="output" style="text-align:left; "/>
			<col ref="medi_cd_nm" type="output" style="text-align:left; "/>
			<col ref="dtls_medi_cd_nm" type="output" style="text-align:left; "/>
			<col ref="evnt_cd_nm" type="output"/>
			<col ref="clam_dept_cd_nm" type="output"/>
			<col ref="obj_acct_cd_nm" type="output"/>
			<col ref="obj_amt" type="output" format="(-)#,###" style="text-align:right; "/>
			<col ref="cfs_seq" type="output" format="(-)#,###" style="text-align:right; "/>
			<col ref="clos_clsf" type="output" visibility="hidden"/>
			<col ref="conn_seq" type="output" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var row = datagrid2.row;
				var col  = datagrid2.col;

				//금액 편집 시 차액계산
				if(col == 8 || col == 9) {
					fn_recalc_diff();
				}

				
				//선택시 수입,비용 금액계산(datagrid2)
				if(col == 1) {
					var dr_amt = 0;
					var crdt_amt = 0;
					
					for(var i=1; i<datagrid2.rows; i++) {

						if(datagrid2.valueMatrix(i,1) == "Y" ) {
							dr_amt = Number(dr_amt) + Number(datagrid2.valueMatrix(i, 8 ));		//차변,비용
							crdt_amt = Number(crdt_amt) + Number(datagrid2.valueMatrix(i, 9 ));		//대변,수입
						}
					}
					
					//chk_inamt2.value   = dr_amt;
					//chk_outamt2.value = crdt_amt;
					chk_outamt2.value   = dr_amt;	//차변
					chk_inamt2.value = crdt_amt;	//대변
					
					fn_recalc_diff();
				}
				]]>
			</script>
		</datagrid>
		<input id="input1" ref="/root/reqData/searchData/to_budg_cd2" navindex="5" format="999999" style="left:375px; top:389px; width:65px; height:18px; "/>
		<input id="input2" ref="/root/reqData/searchData/fr_budg_cd2" navindex="4" format="999999" style="left:292px; top:389px; width:65px; height:18px; "/>
		<caption id="caption17" class="list_cap03" style="left:782px; top:385px; width:70px; height:26px; text-align:center; ">계정구분</caption>
		<select1 id="combo5" ref="/root/reqData/searchData/conn_cmpy_cd2" class="req" appearance="minimal" style="left:84px; top:389px; width:125px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/dlco_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="caption18" class="list_cap03" style="left:9px; top:385px; width:70px; height:26px; text-align:center; ">연결회사</caption>
		<select1 id="combo6" ref="/root/reqData/searchData/budg_clsf_cd2" appearance="minimal" style="left:858px; top:389px; width:70px; height:18px; ">
			<choices>
				<item>
					<label>전체</label>
					<value>00</value>
				</item>
				<item>
					<label>비용</label>
					<value>20</value>
				</item>
				<item>
					<label>수입</label>
					<value>10</value>
				</item>
			</choices>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				if(combo6.focusindex==0) {
					combo2.select(0);
				} else {
					combo2.select(3-combo6.focusindex);
				}
				]]>
			</script>
		</select1>
		<caption id="caption19" class="list_cap03" style="left:216px; top:385px; width:70px; height:26px; text-align:center; ">대상계정</caption>
		<select1 id="combo7" ref="/root/reqData/searchData/conn_clsf_cd2" appearance="minimal" style="left:706px; top:389px; width:70px; height:18px; ">
			<choices>
				<item>
					<label>전체</label>
					<value>00</value>
				</item>
				<item>
					<label>연결</label>
					<value>10</value>
				</item>
				<item>
					<label>미연결</label>
					<value>20</value>
				</item>
				<item>
					<label>마감</label>
					<value>30</value>
				</item>
			</choices>
		</select1>
		<select1 id="combo8" ref="/root/reqData/searchData/slip_clsf_cd2" appearance="minimal" style="left:523px; top:389px; width:100px; height:18px; ">
			<choices>
				<itemset nodeset="/root/initData/comboSet/slip_clsf_cd/item">
					<label ref="label"/>
					<value ref="value"/>
				</itemset>
			</choices>
		</select1>
		<caption id="caption36" class="list_cap03" style="left:630px; top:385px; width:70px; height:26px; text-align:center; ">연결여부</caption>
		<caption id="caption37" style="left:358px; top:392px; width:15px; height:15px; text-align:center; ">~</caption>
		<caption id="caption38" class="list_cap03" style="left:447px; top:385px; width:70px; height:26px; text-align:center; ">전표구분</caption>
		<output id="chk_inamt2" ref="/root/resData/chk_inamt2" format="(-)#,###" style="left:775px; top:659px; width:155px; height:18px; text-align:right; vertical-align:middle; "/>
		<caption id="caption24" class="list_cap02" style="left:465px; top:630px; width:471px; height:26px; text-align:center; "/>
		<output id="outamt2" bind="bind_outamt2" format="(-)#,###" style="left:540px; top:634px; width:155px; height:18px; text-align:right; vertical-align:middle; "/>
		<output id="chk_outamt2" ref="/root/resData/chk_outamt2" format="(-)#,###" style="left:540px; top:659px; width:155px; height:18px; text-align:right; vertical-align:middle; "/>
		<output id="inamt2" bind="bind_inamt2" format="(-)#,###" style="left:775px; top:634px; width:155px; height:18px; text-align:right; vertical-align:middle; "/>
		<output id="con_inamt" ref="/root/resData/con_inamt" format="(-)#,###" style="left:539px; top:693px; width:155px; height:18px; text-align:right; vertical-align:middle; "/>
		<output id="chk_con_inamt" ref="/root/resData/chk_con_inamt" format="(-)#,###" style="left:539px; top:718px; width:155px; height:18px; text-align:right; vertical-align:middle; "/>
		<output id="con_outamt" ref="/root/resData/con_outamt" format="(-)#,###" style="left:774px; top:693px; width:155px; height:18px; text-align:right; vertical-align:middle; "/>
		<output id="chk_con_outamt" ref="/root/resData/chk_con_outamt" format="(-)#,###" style="left:774px; top:718px; width:155px; height:18px; text-align:right; vertical-align:middle; "/>
		<caption id="caption12" class="list_cap03" style="left:465px; top:315px; width:70px; height:26px; text-align:center; ">수입(확정)</caption>
		<caption id="caption35" visibility="visible" style="left:405px; top:689px; width:61px; height:51px; text-align:center; ">차액:</caption>
		<caption id="caption41" class="list_cap03" style="left:465px; top:630px; width:71px; height:26px; text-align:center; ">비용(확정)</caption>
		<caption id="caption42" class="list_cap03" style="left:700px; top:630px; width:70px; height:26px; text-align:center; ">수입(확정)</caption>
		<caption id="caption43" class="list_cap03" style="left:465px; top:655px; width:71px; height:26px; text-align:center; ">비용(선택)</caption>
		<caption id="caption44" class="list_cap03" style="left:700px; top:655px; width:70px; height:26px; text-align:center; ">수입(선택)</caption>
		<caption id="caption45" class="list_cap03" style="left:700px; top:689px; width:71px; height:26px; text-align:center; ">비용(확정)</caption>
		<caption id="caption46" class="list_cap03" style="left:465px; top:689px; width:70px; height:26px; text-align:center; ">수입(확정)</caption>
		<caption id="caption47" class="list_cap03" style="left:700px; top:714px; width:71px; height:26px; text-align:center; ">비용(선택)</caption>
		<caption id="caption48" class="list_cap03" style="left:465px; top:714px; width:70px; height:26px; text-align:center; ">수입(선택)</caption>
	</xhtml:body>
</xhtml:html>
