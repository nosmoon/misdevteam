<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>계정코드등록(FC_ACCT_1040)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session/>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
							<dataSet>
								<CURLIST1>
									<record>
										<cd/>
										<cdnm/>
										<cd_abrv_nm/>
										<cdnm_cd/>
										<cdabrvnm_cd/>
									</record>
								</CURLIST1>
								<CURLIST2>
									<record>
										<cd/>
										<cdnm/>
										<cd_abrv_nm/>
										<cdnm_cd/>
										<cdabrvnm_cd/>
									</record>
								</CURLIST2>
							</dataSet>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData/>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<cmpy_cd/>
							<acct_cd/>
							<use_dt/>
							<insd_acct_cd/>
							<kind/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqForm>
							<insd_acct_cd/>
							<use_dt/>
							<cmpy_cd/>
							<proc_cmpy_cd/>
							<proc_cmpy_cd1/>
						</reqForm>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpDate>
							<multiUpdateData/>
							<cmpy_cd/>
							<proc_cmpy_cd/>
							<kind/>
							<insd_acct_cd/>
							<acct_subj_nm/>
							<acct_cd/>
							<acct_abrv_nm/>
							<acct_nm_styl/>
							<drcr_occr_clsf/>
							<drcr_bal_clsf/>
							<tbs_exne/>
							<balsht_exne/>
							<pfls_stat_exne/>
							<acct_levl/>
							<setoff_yn/>
							<vip_aset_debt_exne/>
							<use_yn/>
							<use_dt/>
							<wste_dt/>
						</multiUpDate>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resForm>
							<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
							<fc_acct_1046_l>
								<dataSet>
									<CURLIST>
										<record>
											<insd_acct_cd/>
											<acct_cd/>
											<acct_subj_nm/>
											<acct_abrv_nm/>
											<slip_incmg_exne/>
											<drcr_occr_clsf/>
											<drcr_bal_clsf/>
											<tbs_exne/>
											<balsht_exne/>
											<pfls_stat_exne/>
											<setoff_yn/>
											<supr_acct_cd/>
											<vip_aset_debt_exne/>
											<acct_levl/>
											<use_yn/>
											<use_dt/>
											<wste_dt/>
											<incmg_dt_tm/>
											<incmg_pers/>
											<incmg_pers_ipadd/>
											<acct_nm_styl/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_1046_l>
						</resForm>
						<resForm2>
							<fc_acct_1041_l>
								<dataSet>
									<CURLIST>
										<record>
											<acct_cd/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_1041_l>
						</resForm2>
						<resForm4>
							<fc_co_8030_s>
								<dataSet>
									<CURLIST>
										<record>
											<acct_subj_nm/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_co_8030_s>
						</resForm4>
						<resForm5>
							<fc_co_8040_s>
								<dataSet>
									<CURLIST>
										<record>
											<acct_subj_nm/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_co_8040_s>
						</resForm5>
						<gridData>
							<fc_acct_1047_l>
								<dataSet>
									<CURLIST>
										<record>
											<chk1/>
											<chk2/>
											<mang_item_cd/>
											<cdnm/>
											<drcr_clsf/>
											<mand_reg_yn/>
											<bal_mang_clsf/>
											<prty_rank/>
											<prty_rank2/>
											<mang_item_nm/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_1047_l>
						</gridData>
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<gridData2>
							<fc_acct_1043_l>
								<dataSet>
									<CURLIST>
										<record>
											<mang_item_cd/>
											<mang_item_cdnm/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_1043_l>
						</gridData2>
						<gridData3>
							<fc_acct_1049_l>
								<dataSet>
									<CURLIST>
										<record>
											<chk/>
											<acct_cd/>
											<acct_subj_nm/>
											<insd_acct_cd/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_1049_l>
						</gridData3>
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<keyData/>
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<test>
							<cmpy_cd>100</cmpy_cd>
						</test>
					</tempData>
					<!-- 저장소 -->
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					init_controls();
												
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					send_fc_acct_1040_m();
					set_column_visibility();

					ss_cmpy_cd = getProperty("ss_cmpycd");

					srch_cmpy_cd.value = ss_cmpy_cd;
					
					if(ss_cmpy_cd != "100"){
						srch_cmpy_cd.disabled = true;
						srch_cmpy_cd.value = ss_cmpy_cd;
						//btn_insert.disabled = true;
						btn_copy.disabled = true;
						group4.visible = false;
					}
										
					set_refvalue("/root/reqData/searchData/use_dt",commCurDate());
					srch_use_dt.refresh();					
//					get_popup_data();					
					if (model.property("FC_ACCT_1040_popup_flag") == "Y" ) {

						srch_acct_cd.value = model.property("FC_ACCT_1040_srch_acct_cd");
						srch_acct_subj_nm.value = model.property("FC_ACCT_1040_srch_acct_subj_nm");
						
						model.property("FC_ACCT_1040_srch_acct_cd")  = "";
						model.property("FC_ACCT_1040_srch_acct_subj_nm") = "";
						model.property("FC_ACCT_1040_popup_flag") = "";
						
						srch_acct_cd.dispatch("xforms-value-changed");
						btn_select.dispatch("onclick");
					}			

					datagrid1.addStatus(1,"insert");
									
					for (i=1; i<10; i++){
						datagrid1.addRow(false);
					}
					
//					btn_update.disabled = true;
//					btn_delete.disabled = true;					
				]]>
			</script>
			<submission id="fc_acct_1040_m" action="/fc/acct1000/1040" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/initData/comboSet/dataSet"/>
			<submission id="fc_acct_1041_l" action="/fc/acct1000/1041" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm2/fc_acct_1041_l/dataSet"/>
			<submission id="fc_acct_1043_l" action="/fc/acct1000/1043" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData2/fc_acct_1043_l/dataSet"/>
			<submission id="fc_acct_1044_d" action="/fc/acct1000/1044" mediatype="application/x-www-form-urlenoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="fc_acct_1045_i" action="/fc/acct1000/1045" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="fc_acct_1046_l" action="/fc/acct1000/1046" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm/fc_acct_1046_l/dataSet"/>
			<submission id="fc_acct_1047_l" action="/fc/acct1000/1047" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/fc_acct_1047_l/dataSet"/>
			<submission id="fc_acct_1048_u" action="/fc/acct1000/1048" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="fc_acct_1049_l" action="/fc/acct1000/1049" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData3/fc_acct_1049_l/dataSet"/>
			<submission id="fc_co_8030_s" action="/fc/co8000/8030" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm4/fc_co_8030_s/dataSet"/>
			<submission id="fc_co_8040_s" action="/fc/co8000/8040" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm5/fc_co_8040_s/dataSet"/>
			<bind id="bind1" ref="/root/resData/gridData/fc_acct_1047_l/dataSet/CURLIST/record/mang_item_cd" readonly="if(../chk1 = 'R', true(), false())"/>
			<submission id="fc_acct_1042_a" action="/fc/acct1000/1042" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate" resultref="/root/resData/MsgData/dataSet"/>
		</model>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/fcmc_common.js"/>
		<script type="javascript">
			<![CDATA[
				var	_oth_clsf = "1";
				var gacct_cd;
				var guse_dt;
				var getRow;
				var getCol;
				var gmang_item_cd;
				var gmang_item_cdnm;				
				var ss_cmpy_cd;
				var SW_del;
				var gkind;

				var popid = "fc_acct_1040";
				var is_popup = false;
				//자동으로 폼 로드시 검색을 시작한다.
				var is_autosearch = false;
				//검색의 결과가 1건이라면 결과값을 자동 반환한다.
				var is_autoclose = false;
				//윈도우의 원래 위치 저장
				var leftpx = 0;
				var toppx = 0;
				//자동검색시 검색을 종료하고 조건값을 삭제 할지 여부
				var g_is_autoreset = false;		
								
				function set_column_visibility() {
					//모든 컬럼을 감춘다.
					hide_all_columns(datagrid1);
					//공통항목을 보여준다.
					show_columns(datagrid1, "3,4,5,6,7,8,9,10");
					//모든 컬럼을 감춘다.
					hide_all_columns(datagrid2);
					//공통항목을 보여준다.
					show_all_columns(datagrid2);
					//모든 컬럼을 감춘다.
					hide_all_columns(datagrid3);
					//공통항목을 보여준다.
					show_columns(datagrid3, "1,2,3,4");
				}
				function init_controls(){
					set_default(
						datagrid1
					,	datagrid2
					,	datagrid3
					);					//datagrid
					set_default(
						srch_acct_cd
					,	srch_acct_subj_nm
					,	acct_cd
					,	acct_subj_nm
					,	acct_abrv_nm
					,	acct_nm_styl
					,	insd_acct_cd
					,	supr_acct_cd
					,	supr_acct_cd_nm
					,	acct_levl	
					,	chg_pers	
					,	chg_dt_tm
					);	//input
					set_default(
						srch_use_dt
					,	use_dt
					,	wste_dt);			//input date
					set_default(
						drcr_bal_clsf
					,	slip_incmg_exne
					,	drcr_occr_clsf
					,	pfls_stat_exne
					,	tbs_exne,setoff_yn
					, 	vip_aset_debt_exne
					, 	use_yn);			//combo	
					set_format(
						"code"
					,	datagrid1			,"3"
					,	datagrid2			,"1"
					,	datagrid3			,"2,4"
					);
					set_format(
						"string_l"
					,	datagrid1			,"4,5,6,7,8,9,10"
					,	datagrid2			,"2"
					,	datagrid3			,"3"
					,	srch_acct_cd									//외부계정코드
					,	acct_cd										//외부계정코드
					,	supr_acct_cd									//상위계정코드					
					, 	srch_acct_subj_nm								//계정과목명(외부계정)
					,	acct_subj_nm									//계정과목명(내부계정)
					,	acct_abrv_nm									//계정약어명
					,	acct_nm_styl									//계정명(양식용)
					,	supr_acct_cd_nm								//상위계정코드명
					,	drcr_bal_clsf
					,	slip_incmg_exne
					,	drcr_occr_clsf
					,	pfls_stat_exne					
					,	tbs_exne
					,	balsht_exne
					,	acct_levl
					,	setoff_yn
					,	vip_aset_debt_exne
					,	use_yn
					,	chg_pers
					);
					set_format(
						"date_1"
					,	srch_use_dt								//사용일자
					,	use_dt
					,	wste_dt
					,	chg_dt_tm
					);
				}
				function send_fc_acct_1040_m(){
					model.send("fc_acct_1040_m");
					makeComboGubun("","/root/initData/comboSet/dataSet/CURLIST1","record","cdabrvnm_cd", "cd");
					makeComboGubun("","/root/initData/comboSet/dataSet/CURLIST2","record","cdabrvnm_cd", "cd");					
				}
				function send_fc_acct_1046_l(){
					datagrid3.gridToInstance();
					var var_insd_acct_cd = get_refvalue("/root/resData/gridData3/fc_acct_1049_l/dataSet/CURLIST/record["+datagrid3.row+"]/insd_acct_cd");
					set_refvalue("/root/reqData/searchData/insd_acct_cd",var_insd_acct_cd);
				
					model.send("fc_acct_1046_l");
					
//					insd_acct_cd.attribute("editable") = "false";
//					use_dt.attribute("editable") = "false";
//					use_dt.disabled = true;
					
					supr_acct_cd.dispatch("xforms-value-changed");
					
					model.send("fc_acct_1047_l");
					for (i=0; i<10; i++){
						datagrid1.addRow(false);
					}
					datagrid1.refresh();
					
//					btn_insert.disabled = true;
//					btn_update.disabled = false;
//					btn_delete.disabled = false;
					
					gacct_cd = get_refvalue("/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/insd_acct_cd");
					guse_dt = get_refvalue("/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/use_dt");
				}				
				function send_fc_acct_1049_l(){
					if (!prepare_fc_acct_1049_l()) {
						return false;
					}
					model.send("fc_acct_1049_l");
					
					totalcnt = model.getValue("/root/resData/gridData3/fc_acct_1049_l/dataSet/CURLIST/totalcnt");
					if (totalcnt == 0) {
						reset_model(true);
						show_message("검색결과가 없습니다.");
						return false;
					}

					datagrid3.refresh();
					datagrid3.row = 1;
					datagrid3.col = 2;

					send_fc_acct_1046_l();
					
				}
				function prepare_fc_acct_1049_l(){
					if(!check_search_values("s")) {
						return false;
					}					
					return true;
				}
				function check_search_values(p_siud) {
					//필수항목체크(검색)
					if(!commReqCheck(group_scr)) {
						return false;
					}
					
					switch (p_siud.toUpperCase()) {
						case "S":
							//조회시
							break;
						case "I":
							//입력시
							break;
						case "U":
							//수정시
							break;
						case "D":
							//삭제시
							break;
						default:
							show_message("key 값 확인을 위한 구분자가 지정되지 않았습니다.");
							break;
					}
				
					return true;
				}
				function reset_model(p_save) {
					var temp_srch_cmpy_cd = srch_cmpy_cd.value;
					var temp_srch_acct_cd = srch_acct_cd.value;
					var temp_srch_acct_subj_nm = srch_acct_subj_nm.value; 
					var temp_srch_use_dt = srch_use_dt.value;
					
					model.reset();
					
					if (p_save) {
						srch_cmpy_cd.value =  temp_srch_cmpy_cd;
						srch_acct_cd.value = temp_srch_acct_cd;
						srch_acct_subj_nm.value = temp_srch_acct_subj_nm;
						srch_use_dt.value = temp_srch_use_dt;
					}
					
						insd_acct_cd.attribute("editable") = "true";
						use_dt.attribute("editable") = "true";
						
//						btn_insert.disabled = false;
//						btn_update.disabled = true
//						btn_delete.disabled = true;				
				}
				function send_fc_acct_1045_i() {
					//조건에 문제가 없다면 처리
//					if(gacct_cd == insd_acct_cd.value && guse_dt == use_dt){
//						show_message("key 값이 변경되어 저장할 수 없습니다.");
//					}
									
					if (!prepare_fc_acct_1045_i()) {
						return false;
					}
					
					if (show_message("저장하시겠습니까?","저장 확인",MB_YESNO) != IDYES) {
						return false;
					}
					var i;
					var cnt = 0;
	
					for (i=1; i<datagrid1.rows; i++){
						var mang_item_cd  = get_refvalue("/root/resData/gridData/fc_acct_1047_l/dataSet/CURLIST/record["+i+"]/mang_item_cd");
			
						if (mang_item_cd == ""){
							datagrid1.rowStatus(i) =0;
						}
						else {
							if(datagrid1.rowStatus(i) == "3" || datagrid1.rowStatus(i) == "2" || datagrid1.rowStatus(i) == "1"){
								cnt = cnt+1;
							}
						}
					}				

					set_refvalue("/root/reqData/multiUpDate/cmpy_cd",ss_cmpy_cd);
					set_refvalue("/root/reqData/multiUpDate/insd_acct_cd",insd_acct_cd.value);
					set_refvalue("/root/reqData/multiUpDate/acct_cd",acct_cd.value);
					set_refvalue("/root/reqData/multiUpDate/acct_subj_nm",acct_subj_nm.value);
					set_refvalue("/root/reqData/multiUpDate/acct_abrv_nm",acct_abrv_nm.value);
					set_refvalue("/root/reqData/multiUpDate/slip_incmg_exne",slip_incmg_exne.value);				
					set_refvalue("/root/reqData/multiUpDate/drcr_occr_clsf",drcr_occr_clsf.value);
					set_refvalue("/root/reqData/multiUpDate/drcr_bal_clsf",drcr_bal_clsf.value);
					set_refvalue("/root/reqData/multiUpDate/tbs_exne",tbs_exne.value);
					set_refvalue("/root/reqData/multiUpDate/balsht_exne",balsht_exne.value);
					set_refvalue("/root/reqData/multiUpDate/pfls_stat_exne",pfls_stat_exne.value);
					set_refvalue("/root/reqData/multiUpDate/setoff_yn",setoff_yn.value);
					set_refvalue("/root/reqData/multiUpDate/supr_acct_cd",supr_acct_cd.value);
					set_refvalue("/root/reqData/multiUpDate/vip_aset_debt_exne",vip_aset_debt_exne.value);
					set_refvalue("/root/reqData/multiUpDate/acct_levl",acct_levl.value);
					set_refvalue("/root/reqData/multiUpDate/use_yn",use_yn.value);
					set_refvalue("/root/reqData/multiUpDate/use_dt",use_dt.value);
					set_refvalue("/root/reqData/multiUpDate/wste_dt",wste_dt.value);
					set_refvalue("/root/reqData/multiUpDate/acct_nm_styl",acct_nm_styl.value);				
					
					set_refvalue("/root/reqData/multiUpDate/multiUpdateData",datagrid1.getUpdateData());
					
					model.send("fc_acct_1045_i");
					if(submit_completed()){
						show_message("저장되었습니다.");
					}
					
				}
				function prepare_fc_acct_1045_i() {			
					//필수항목체크
					//if (!check_reqItem(acct_cd,"trim","focus","외부계정코드는 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(insd_acct_cd,"trim","focus","내부계정코드는 필수입력항목입니다.")) {return false;}
					if (!check_reqItem(acct_subj_nm,"trim","focus","계정과목명은 필수입력항목입니다.")) {return false;}
					if(slip_incmg_exne.value ==""){
						show_message("전표입력유무는 필수입력항목입니다.");
						return false;
					}
					if(drcr_occr_clsf.value ==""){
						show_message("차대발생구분은 필수입력항목입니다.");
						return false;
					}
					if(drcr_bal_clsf.value ==""){
						show_message("차대잔액구분은 필수입력항목입니다.");
						return false;
					}				
	
					if (!check_reqItem(use_dt,"trim","focus","사용일자는 필수입력항목입니다.")) {return false;}
					
					if(acct_cd.value.length == 4 && slip_incmg_exne.value =="N"){
						show_message("전표입력유무 오류입니다. 정확한 데이타를 입력하십시오.");
						return false;
					}
					if(insd_acct_cd.value.substring(0,1) != "4" && balsht_exne.value == "N"){
						show_message("대차대조표유무 오류입니다. 정확한 데이타를 입력하십시오.");
						return false;
					}
					if(insd_acct_cd.value.substring(0,1) != "4" && pfls_stat_exne.value == "Y"){
						show_message("손익계산서유무 오류입니다. 정확한 데이타를 입력하십시오.");
						return false;
					}				
					if(insd_acct_cd.value.substring(0,1) == "4" && pfls_stat_exne.value == "N"){
						show_message("손익계산서유무 오류입니다. 정확한 데이타를 입력하십시오.");
						return false;
					}
					if(insd_acct_cd.value.substring(0,1) == "4" && balsht_exne.value == "Y"){
						show_message("대차대조표유무 오류입니다. 정확한 데이타를 입력하십시오.");
						return false;
					}
					if(balsht_exne.value == "Y" && pfls_stat_exne.value == "Y"){
						show_message("대차대조표(손익계산서)유무 오류입니다. 정확한 데이타를 입력하십시오.");
						return false;
					}				

					//SP에서 처리
//					if(wste_dt.value == ""){
//						if(gflag == "i"){
//`							wste_dt.value = "29991231";
//						}		
//					}
					if( wste_dt.value != ""){
						if(use_dt.value.ToDate() > wste_dt.value.ToDate()) {
							
							show_message("시작일자는 폐기일자를 초과할 수 없습니다.");
						}
					}
					return true;
				}		
				function send_fc_acct_1048_u(){
					if (!prepare_fc_acct_1045_i()) {
						return false;
					}
					var cnt =0;
					var i;
					SW_del = "";
					
					for(i=1; i<datagrid1.rows;i++){
						if(datagrid1.rowStatus(i) == "4"){
							cnt = cnt+1;
						}
					}
					if(cnt > 0){
						SW_del = "Y";
					}
					if(SW_del == "Y"){
						if (show_message("계정별 관리항목을 삭제하시겠습니까? \n(계정별 관리항목을 삭제하면 조회한 계정코드에 해당하는 \n예산코드 관리항목도 자동적으로 모두 삭제됩니다.)","수정 확인",MB_YESNO) != IDYES) {
							return false;
						}
					}

					for (i=1; i<datagrid1.rows; i++){
						var mang_item_cd  = get_refvalue("/root/resData/gridData/fc_acct_1047_l/dataSet/CURLIST/record["+i+"]/mang_item_cd");
			
						if (mang_item_cd == ""){
							datagrid1.rowStatus(i) =0;
						}
						else {
							if(datagrid1.rowStatus(i) == "4" || datagrid1.rowStatus(i) == "3" || datagrid1.rowStatus(i) == "2" || datagrid1.rowStatus(i) == "1"){
								cnt = cnt+1;
							}
						}
					}				
					
					set_refvalue("/root/reqData/multiUpDate/cmpy_cd",ss_cmpy_cd);
					set_refvalue("/root/reqData/multiUpDate/insd_acct_cd",insd_acct_cd.value);
					set_refvalue("/root/reqData/multiUpDate/acct_cd",acct_cd.value);
					set_refvalue("/root/reqData/multiUpDate/acct_subj_nm",acct_subj_nm.value);
					set_refvalue("/root/reqData/multiUpDate/acct_abrv_nm",acct_abrv_nm.value);
					set_refvalue("/root/reqData/multiUpDate/slip_incmg_exne",slip_incmg_exne.value);				
					set_refvalue("/root/reqData/multiUpDate/drcr_occr_clsf",drcr_occr_clsf.value);
					set_refvalue("/root/reqData/multiUpDate/drcr_bal_clsf",drcr_bal_clsf.value);
					set_refvalue("/root/reqData/multiUpDate/tbs_exne",tbs_exne.value);
					set_refvalue("/root/reqData/multiUpDate/balsht_exne",balsht_exne.value);
					set_refvalue("/root/reqData/multiUpDate/pfls_stat_exne",pfls_stat_exne.value);
					set_refvalue("/root/reqData/multiUpDate/setoff_yn",setoff_yn.value);
					set_refvalue("/root/reqData/multiUpDate/supr_acct_cd",supr_acct_cd.value);
					set_refvalue("/root/reqData/multiUpDate/vip_aset_debt_exne",vip_aset_debt_exne.value);
					set_refvalue("/root/reqData/multiUpDate/acct_levl",acct_levl.value);
					set_refvalue("/root/reqData/multiUpDate/use_yn",use_yn.value);
					set_refvalue("/root/reqData/multiUpDate/use_dt",use_dt.value);
					set_refvalue("/root/reqData/multiUpDate/wste_dt",wste_dt.value);
					set_refvalue("/root/reqData/multiUpDate/acct_nm_styl",acct_nm_styl.value);				
					
					set_refvalue("/root/reqData/multiUpDate/multiUpdateData",datagrid1.getUpdateData());					

					model.send("fc_acct_1048_u");
					
					return check_submit_completed("수정되었습니다.","");
				}
				function get_popup_data() {
					var mode = "";
					var title = "";
					var readonly = "0";
					value_list = get_popup_send_property(popid);
					//현재 폼이 팝업용으로 열린 경우 처리
					//일반 폼으로도 사용하고 팝업용으로도 사용하는 폼의 경우
					//구분이 필요한데 opener로 판별 할 수 없기 때문에
					//폼 로딩시 특정 이름의 프로퍼티가 있는지 확인해서 처리 하는 시점에서
					//is_popup을 true로 설정해서 사용하도록 한다.
					is_popup = false;
					is_autosearch = false;
					is_autoclose = false;
					
					if (value_list != "") {
						is_popup = true;
	
						set_popup_min(!is_popup);
						set_popup_max(!is_popup);
						set_popup_close(!is_popup);
						
						save_value_list("/root/reqData/searchData",value_list);
						
						mode	=	model.getValue("/root/reqData/searchData/mode").Trim().toUpperCase();
						title		=	model.getValue("/root/reqData/searchData/title").Trim();
						readonly	=	model.getValue("/root/reqData/searchData/readonly").Trim();
						datafilter	=	model.getValue("/root/reqData/searchData/datafilter").Trim();
						
						//필터 문자가 전달된 경우 해당 datagrid의 nodeset에 추가
						if (datafilter != "") {
							//datagrid1.nodeset = datagrid1.nodeset + datafilter;
						}
	
						//여기서부터는 현재 폼에서만 필요한 코드
						
						//읽기모드의 설정은 폼 단위 개별 설정이고
						//상황에 따라 호출하는 폼에서 넘긴 데이터를 수정하지 못하도록 설정하기 위한 옵션
						if (readonly == "0") {
							//읽기모드가 "0" 인 경우 처리
							//읽기모드가 "0" 이면 읽기 전용으로 설정할 컨트롤이 없다고 가정하자.
						}
						else if (readonly == "1") {
							//읽기모드가 "1" 인 경우 처리
						}
						else if (readonly == "2") {
							//읽기모드가 "2" 인 경우 처리
						}
						else if (readonly == "3") {
							//읽기모드가 "2" 인 경우 처리
						}
						//여기까지가 현재 폼에서만 필요한 코드
	
						if (mode.indexOf("S") >= 0) {
							is_autosearch = true;
						}
						if (mode.indexOf("C") >= 0) {
							is_autoclose = true;
	//						leftpx = window.left;
	//						toppx = window.top;
	//						window.left = -2000;
	//						window.top = -2000;
						}
						//Reset
						//자동검색인 경우에 한해서 검색후 조회용 값을 삭제할지 여부
						if (mode.indexOf("R") >= 0) {
							g_is_autoreset = true;
						}
					}
					else {
						//팝업 모드가 아닌 경우
						
						//닫기버튼을 비활성화시킨다.
					}
					
					//그냥 팝업만 띄워달란다 -_- 바꾼다.
					g_is_autosearch = false;
					set_refvalue(srch_acct_cd,get_refvalue("/root/reqData/searchData/acct_cd").Trim());
					set_refvalue(srch_acct_subj_nm,get_refvalue("/root/reqData/searchData/acct_subj_nm").Trim());
					btn_select.dispatch("onclick");
				}												
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="2,10;2,30;2,40;2,50;" style="font-family:굴림; ">
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/fc_acct_1047_l/dataSet/CURLIST/record" caption="선택^삭제^코드^관리항목명^차대구분^필수여부^잔액관리^순위T^순위D^출력명" colsep="#" colwidth="59, 41, 71, 97, 60, 60, 60, 60, 60, 96" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:310px; top:429px; width:627px; height:242px; ">
			<col ref="chk1"/>
			<col ref="chk2" type="checkbox"/>
			<col ref="mang_item_cd" type="inputbutton"/>
			<col ref="cdnm"/>
			<col ref="drcr_clsf" type="combo">
				<choices>
					<item>
						<label>1 차변</label>
						<value>1</value>
					</item>
					<item>
						<label>9 대변</label>
						<value>9</value>
					</item>
					<item>
						<label>양변</label>
						<value/>
					</item>
				</choices>
			</col>
			<col ref="mand_reg_yn" type="combo">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>1 필수</label>
						<value>1</value>
					</item>
					<item>
						<label>2 선택</label>
						<value>2</value>
					</item>
				</choices>
			</col>
			<col ref="bal_mang_clsf" type="combo">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>1 잔액</label>
						<value>1</value>
					</item>
					<item>
						<label>2 항목</label>
						<value>2</value>
					</item>
				</choices>
			</col>
			<col ref="prty_rank" type="combo">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>1</label>
						<value>1</value>
					</item>
					<item>
						<label>2</label>
						<value>2</value>
					</item>
					<item>
						<label>3</label>
						<value>3</value>
					</item>
					<item>
						<label>4</label>
						<value>4</value>
					</item>
					<item>
						<label>5</label>
						<value>5</value>
					</item>
					<item>
						<label>6</label>
						<value>6</value>
					</item>
					<item>
						<label>7</label>
						<value>7</value>
					</item>
				</choices>
			</col>
			<col ref="prty_rank2" type="combo">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>1</label>
						<value>1</value>
					</item>
					<item>
						<label>2</label>
						<value>2</value>
					</item>
					<item>
						<label>3</label>
						<value>3</value>
					</item>
					<item>
						<label>4</label>
						<value>4</value>
					</item>
					<item>
						<label>5</label>
						<value>5</value>
					</item>
					<item>
						<label>6</label>
						<value>6</value>
					</item>
					<item>
						<label>7</label>
						<value>7</value>
					</item>
				</choices>
			</col>
			<col ref="mang_item_nm" type="input"/>
			<script type="javascript" ev:event="onbuttonclick">
				<![CDATA[
					getRow = datagrid1.row;
					getCol = datagrid1.col;		
					if (!check_reqItem(srch_cmpy_cd,"trim","focus","회사코드는 필수입력 항목입니다.")) { return false; }
													
					if (getCol== 3) {
						model.send("fc_acct_1043_l");
						datagrid2.refresh();
						group2.visible= true;						
					}					
				]]>
			</script>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					_oth_clsf = "1";
					var cnt = 0;			
					if(datagrid1.mouseCol == 0){
						if(datagrid1.rowStatus(datagrid1.mouseRow) == "4"){
							datagrid1.removeStatus(datagrid1.mouseRow, "delete");
						}
						else if(datagrid1.rowStatus(datagrid1.mouseRow) == "0"){
							datagrid1.addStatus(datagrid1.mouseRow, "delete");
						}
					}
				]]>
			</script>
		</datagrid>
		<group id="group_scr" class="gro_sel" style="left:10px; top:50px; width:926px; height:26px; ">
			<caption id="caption11" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption8" class="list_cap03" style="left:235px; top:0px; width:120px; height:26px; text-align:center; ">외부계정코드</caption>
			<caption id="caption10" class="list_cap03" style="left:690px; top:0px; width:120px; height:26px; text-align:center; ">기준일자</caption>
			<button id="btn_up" class="btn_up" crud="R" style="left:649px; top:4px; width:20px; height:19px; ">
				<caption/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[											
						gkind = "2";
						set_refvalue("/root/reqData/searchData/kind",gkind);
						model.send("fc_acct_1041_l");
						if (get_refvalue("/root/resData/resForm2/fc_acct_1041_l/dataSet/CURLIST/record/acct_cd") == "") {
							return;
						}			
						set_refvalue(srch_acct_cd,get_refvalue("/root/resData/resForm2/fc_acct_1041_l/dataSet/CURLIST/record/acct_cd"));
						srch_acct_cd.refresh();
						srch_acct_cd.dispatch("xforms-value-changed");
						btn_select.dispatch("onclick");							
					]]>
				</script>
			</button>
			<button id="btn_down" class="btn_down" appearance="button" crud="R" style="left:669px; top:4px; width:20px; height:19px; ">
				<caption/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						gkind = "1";
						set_refvalue("/root/reqData/searchData/kind",gkind);
						model.send("fc_acct_1041_l");
						if (get_refvalue("/root/resData/resForm2/fc_acct_1041_l/dataSet/CURLIST/record/acct_cd") == "") {
							return;
						}			
						set_refvalue(srch_acct_cd,get_refvalue("/root/resData/resForm2/fc_acct_1041_l/dataSet/CURLIST/record/acct_cd"));
						srch_acct_cd.refresh();
						srch_acct_cd.dispatch("xforms-value-changed");
						btn_select.dispatch("onclick");					
					]]>
				</script>
			</button>
			<input id="srch_acct_cd" ref="/root/reqData/searchData/acct_cd" navindex="2" maxlength="4" caption="외부계정코드" style="left:360px; top:4px; width:100px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(get_refvalue("/root/reqData/searchData/acct_cd").length == 4){
						 	set_refvalue("/root/reqData/searchData/cd",get_refvalue("/root/reqData/searchData/acct_cd"));
						 	set_refvalue(srch_acct_subj_nm,"");
							model.send("fc_co_8030_s");
							set_refvalue(srch_acct_subj_nm, get_refvalue("/root/resData/resForm4/fc_co_8030_s/dataSet/CURLIST/record/acct_subj_nm"));
							srch_acct_subj_nm.refresh();
						}

						else{
							set_refvalue(srch_acct_subj_nm,"");
							srch_acct_subj_nm.refresh();
						}										
					]]>
				</script>
			</input>
			<input id="srch_acct_subj_nm" ref="/root/resData/resForm4/fc_co_8030_s/dataSet/CURLIST/record/acct_subj_nm" editable="false" style="left:463px; top:4px; width:185px; height:18px; "/>
			<input id="srch_use_dt" ref="/root/reqData/searchData/use_dt" class="req" navindex="3" inputtype="date" caption="기준일자" style="left:815px; top:4px; width:100px; height:18px; "/>
			<caption id="caption1" class="list_cap03" style="left:0px; top:0px; width:120px; height:26px; text-align:center; ">회사코드</caption>
			<select1 id="srch_cmpy_cd" ref="/root/reqData/searchData/cmpy_cd" class="req" navindex="1" appearance="minimal" editmode="inputsearch" itemcount="8" caption="회사코드" style="left:125px; top:4px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/CURLIST1/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(srch_cmpy_cd, srch_cmpy_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(srch_cmpy_cd,"");
							return;
						}					
					]]>
				</script>
			</select1>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:83px; width:926px; height:5px; "/>
		<group id="group1" class="gro_sel" style="left:310px; top:100px; width:626px; height:327px; ">
			<caption id="caption45" class="list_cap03" style="left:0px; top:250px; width:120px; height:26px; text-align:center; ">마감통제유무</caption>
			<caption id="caption2" class="list_cap03" style="left:0px; top:75px; width:120px; height:26px; text-align:center; ">계정약어명</caption>
			<caption id="caption3" class="list_cap03" style="left:0px; top:0px; width:120px; height:26px; text-align:center; ">외부계정코드</caption>
			<caption id="caption5" class="list_cap02" style="left:119px; top:0px; width:507px; height:26px; text-align:center; "/>
			<caption id="caption6" class="list_cap03" style="left:0px; top:50px; width:120px; height:26px; text-align:center; ">계정과목명</caption>
			<caption id="caption7" class="list_cap02" style="left:119px; top:50px; width:507px; height:26px; text-align:center; "/>
			<caption id="caption12" class="list_cap03" style="left:0px; top:25px; width:120px; height:26px; text-align:center; ">내부계정코드</caption>
			<caption id="caption18" class="list_cap03" style="left:0px; top:175px; width:120px; height:26px; text-align:center; ">차대발생구분</caption>
			<caption id="caption13" class="list_cap02" style="left:119px; top:25px; width:507px; height:26px; text-align:center; "/>
			<caption id="caption19" class="list_cap02" style="left:119px; top:175px; width:507px; height:26px; text-align:center; "/>
			<caption id="caption16" class="list_cap02" style="left:119px; top:75px; width:507px; height:26px; text-align:center; "/>
			<caption id="caption17" class="list_cap03" style="left:0px; top:100px; width:120px; height:26px; text-align:center; ">계정명(양식용)</caption>
			<caption id="caption20" class="list_cap02" style="left:119px; top:100px; width:507px; height:26px; text-align:center; "/>
			<caption id="caption21" class="list_cap03" style="left:0px; top:150px; width:120px; height:26px; text-align:center; ">차대잔액구분</caption>
			<caption id="caption22" class="list_cap02" style="left:119px; top:150px; width:507px; height:26px; text-align:center; "/>
			<caption id="caption23" class="list_cap03" style="left:0px; top:300px; width:120px; height:26px; text-align:center; ">수정일자</caption>
			<caption id="caption25" class="list_cap03" style="left:0px; top:225px; width:120px; height:26px; text-align:center; ">계정레벨</caption>
			<caption id="caption28" class="list_cap02" style="left:119px; top:300px; width:507px; height:26px; text-align:center; "/>
			<caption id="caption30" class="list_cap02" style="left:119px; top:225px; width:507px; height:26px; text-align:center; "/>
			<caption id="caption32" class="list_cap03" style="left:0px; top:125px; width:120px; height:26px; text-align:center; ">상위계정코드</caption>
			<caption id="caption33" class="list_cap02" style="left:119px; top:125px; width:507px; height:26px; text-align:center; "/>
			<caption id="caption36" class="list_cap03" style="left:0px; top:275px; width:120px; height:26px; text-align:center; ">시작일자</caption>
			<caption id="caption37" class="list_cap02" style="left:119px; top:275px; width:507px; height:26px; text-align:center; "/>
			<caption id="caption40" class="list_cap03" style="left:0px; top:200px; width:120px; height:26px; text-align:center; ">시산표유무</caption>
			<caption id="caption41" class="list_cap02" style="left:119px; top:200px; width:507px; height:26px; text-align:center; "/>
			<caption id="caption46" class="list_cap02" style="left:119px; top:250px; width:507px; height:26px; text-align:center; "/>
			<caption id="caption31" class="list_cap03" style="left:316px; top:150px; width:120px; height:26px; text-align:center; ">전표입력유무</caption>
			<caption id="caption43" class="list_cap03" style="left:316px; top:275px; width:120px; height:26px; text-align:center; ">폐기일자</caption>
			<caption id="caption35" class="list_cap03" style="left:316px; top:300px; width:120px; height:26px; text-align:center; ">수정자</caption>
			<caption id="caption24" class="list_cap03" style="left:316px; top:175px; width:120px; height:26px; text-align:center; ">손익계산서유무</caption>
			<caption id="caption14" class="list_cap03" style="left:316px; top:200px; width:120px; height:26px; text-align:center; ">대차대조표유무</caption>
			<caption id="caption26" class="list_cap03" style="left:316px; top:250px; width:120px; height:26px; text-align:center; ">사용여부</caption>
			<caption id="caption38" class="list_cap03" style="left:316px; top:225px; width:120px; height:26px; text-align:center; ">상계구분</caption>
			<input id="acct_subj_nm" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/acct_subj_nm" class="req" navindex="5" maxlength="40" style="left:125px; top:54px; width:300px; height:18px; "/>
			<input id="acct_abrv_nm" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/acct_abrv_nm" navindex="6" style="left:125px; top:79px; width:175px; height:18px; "/>
			<input id="acct_nm_styl" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/acct_nm_styl" navindex="7" style="left:125px; top:104px; width:300px; height:18px; "/>
			<input id="supr_acct_cd" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/supr_acct_cd" navindex="9" maxlength="9" style="left:125px; top:129px; width:100px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(get_refvalue("/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/supr_acct_cd").length == 9){
						 	set_refvalue("/root/reqData/searchData/cd",get_refvalue("/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/supr_acct_cd"));
						 	set_refvalue(supr_acct_cd_nm,"");
							model.send("fc_co_8040_s");
							set_refvalue(supr_acct_cd_nm, get_refvalue("/root/resData/resForm5/fc_co_8040_s/dataSet/CURLIST/record/acct_subj_nm"));
							supr_acct_cd_nm.refresh();
						}

						else{
							set_refvalue(supr_acct_cd_nm,"");
							supr_acct_cd_nm.refresh();
						}					
					]]>
				</script>
			</input>
			<input id="supr_acct_cd_nm" ref="/root/resData/resForm5/fc_co_8040_s/dataSet/CURLIST/record/acct_subj_nm" editable="false" style="left:230px; top:129px; width:195px; height:18px; "/>
			<select1 id="drcr_bal_clsf" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/drcr_bal_clsf" class="req" navindex="10" appearance="minimal" style="left:125px; top:154px; width:100px; height:18px; ">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>1 차변</label>
						<value>1</value>
					</item>
					<item>
						<label>9 대변</label>
						<value>9</value>
					</item>
				</choices>
			</select1>
			<select1 id="slip_incmg_exne" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/slip_incmg_exne" class="req" navindex="11" appearance="minimal" style="left:441px; top:154px; width:100px; height:18px; ">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>Y</label>
						<value>Y</value>
					</item>
					<item>
						<label>N</label>
						<value>N</value>
					</item>
				</choices>
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[
						if(get_refvalue(acct_cd).length == 4){
							slip_incmg_exne.value = "Y";
						}
						else{
							slip_incmg_exne.value = "N";
						}								
					]]>
				</script>
			</select1>
			<select1 id="drcr_occr_clsf" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/drcr_occr_clsf" class="req" navindex="12" appearance="minimal" style="left:125px; top:180px; width:100px; height:18px; ">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>1 차변</label>
						<value>1</value>
					</item>
					<item>
						<label>2 대변</label>
						<value>2</value>
					</item>
					<item>
						<label>3 양변</label>
						<value>3</value>
					</item>
				</choices>
			</select1>
			<select1 id="pfls_stat_exne" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/pfls_stat_exne" navindex="13" appearance="minimal" style="left:441px; top:180px; width:100px; height:18px; ">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>Y</label>
						<value>Y</value>
					</item>
					<item>
						<label>N</label>
						<value>N</value>
					</item>
				</choices>
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[
						if(get_refvalue(insd_acct_cd).substring(0,1) == "4"){
							pfls_stat_exne.value = "Y";
						}
						else{
							pfls_stat_exne.value = "N";
						}						
					]]>
				</script>
			</select1>
			<select1 id="tbs_exne" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/tbs_exne" navindex="14" appearance="minimal" style="left:125px; top:204px; width:100px; height:18px; ">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>Y</label>
						<value>Y</value>
					</item>
					<item>
						<label>N</label>
						<value>N</value>
					</item>
				</choices>
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[
						tbs_exne.value = "Y";		
					]]>
				</script>
			</select1>
			<select1 id="balsht_exne" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/balsht_exne" navindex="15" appearance="minimal" style="left:441px; top:204px; width:100px; height:18px; ">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>Y</label>
						<value>Y</value>
					</item>
					<item>
						<label>N</label>
						<value>N</value>
					</item>
				</choices>
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[
						if(get_refvalue(insd_acct_cd).substring(0,1) == "1" || get_refvalue(insd_acct_cd).substring(0,1) == "2" || get_refvalue(insd_acct_cd).substring(0,1) == "3"){
							balsht_exne.value = "Y";
						}
						else{
							balsht_exne.value = "N";
						}						
					]]>
				</script>
			</select1>
			<input id="acct_levl" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/acct_levl" navindex="16" style="left:125px; top:230px; width:60px; height:18px; "/>
			<select1 id="setoff_yn" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/setoff_yn" navindex="17" appearance="minimal" style="left:441px; top:230px; width:100px; height:18px; ">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>1 차변</label>
						<value>1</value>
					</item>
					<item>
						<label>9 대변</label>
						<value>9</value>
					</item>
				</choices>
			</select1>
			<select1 id="use_yn" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/use_yn" navindex="19" appearance="minimal" style="left:441px; top:255px; width:100px; height:18px; ">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>Y</label>
						<value>Y</value>
					</item>
					<item>
						<label>N</label>
						<value>N</value>
					</item>
				</choices>
			</select1>
			<input id="use_dt" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/use_dt" class="req" navindex="20" inputtype="date" style="left:125px; top:279px; width:100px; height:18px; "/>
			<input id="wste_dt" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/wste_dt" navindex="21" inputtype="date" style="left:441px; top:279px; width:100px; height:18px; ">
				<script type="javascript" ev:event="DOMFocusIn">
					<![CDATA[
//						sef_refvalue("/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/wste_dt","29991231");
						wste_dt.value = "29991231";
					]]>
				</script>
			</input>
			<select1 id="vip_aset_debt_exne" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/vip_aset_debt_exne" navindex="18" appearance="minimal" style="left:125px; top:254px; width:100px; height:18px; ">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>Y</label>
						<value>Y</value>
					</item>
					<item>
						<label>N</label>
						<value>N</value>
					</item>
				</choices>
			</select1>
			<input id="chg_pers" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/incmg_pers" editable="false" style="left:441px; top:304px; width:100px; height:18px; "/>
			<input id="chg_dt_tm" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/incmg_dt_tm" editable="false" style="left:125px; top:304px; width:100px; height:18px; "/>
			<input id="insd_acct_cd" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/insd_acct_cd" class="req" navindex="4" maxlength="9" style="left:125px; top:29px; width:100px; height:18px; "/>
			<input id="acct_cd" ref="/root/resData/resForm/fc_acct_1046_l/dataSet/CURLIST/record/acct_cd" navindex="8" maxlength="4" style="left:125px; top:4px; width:100px; height:18px; "/>
		</group>
		<group id="group2" visibility="hidden" style="left:500px; top:460px; width:355px; height:197px; ">
			<button id="btnClose1" class="btn02" style="left:270px; top:170px; width:52px; height:21px; ">
				<caption>닫기</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						group2.visible = false;		
					]]>
				</script>
			</button>
			<datagrid id="datagrid2" nodeset="/root/resData/gridData2/fc_acct_1043_l/dataSet/CURLIST/record" caption="관리항목코드^관리항목명" colsep="^" colwidth="100, 200" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:5px; top:5px; width:322px; height:160px; ">
				<col ref="mang_item_cd"/>
				<col ref="mang_item_cdnm"/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						gmang_item_cd = get_refvalue("/root/resData/gridData2/fc_acct_1043_l/dataSet/CURLIST/record["+datagrid2.row+"]/mang_item_cd");
						gmang_item_cdnm = get_refvalue("/root/resData/gridData2/fc_acct_1043_l/dataSet/CURLIST/record["+datagrid2.row+"]/mang_item_cdnm");
						
						group2.visible = false;
						
						set_refvalue("/root/resData/gridData/fc_acct_1047_l/dataSet/CURLIST/record["+getRow+"]/mang_item_cd",gmang_item_cd);
						set_refvalue("/root/resData/gridData/fc_acct_1047_l/dataSet/CURLIST/record["+getRow+"]/cdnm",gmang_item_cdnm);
						datagrid2.refresh();
					]]>
				</script>
			</datagrid>
		</group>
		<datagrid id="datagrid3" nodeset="/root/resData/gridData3/fc_acct_1049_l/dataSet/CURLIST/record" caption="선택^외부계정코드^계정과목명^내부계정코드" colsep="#" colwidth="36, 76, 166, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:10px; top:101px; width:290px; height:604px; ">
			<col checkvalue="1,0" ref="chk" type="checkbox"/>
			<col ref="acct_cd" visibility="visible"/>
			<col ref="acct_subj_nm"/>
			<col ref="insd_acct_cd"/>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					//그리드 스크롤바 클릭, 더블클릭 방지 소스
					if (-1 != event.target.lastIndexOf("scroll.thumb")) {
						return;
					}
					
					if (datagrid3.mouseRow < 1) {
						return;
					}
					
					if (datagrid3.mouseCol < 1) {
						return;
					}

					if(event.ptarget.elementName != "xforms:col"){
						return; 
					}

				     var grid = eval(event.currentTarget);
   				     var rowid = grid.row;
				     var colid = grid.col;
				     
				     if (rowid < grid.fixedRows || colid < grid.fixedCols) {
				      return;
				     }
				     
					if ((datagrid3.mouseCol > 0) && (datagrid3.mouseCol < datagrid3.cols) && (datagrid3.mouseRow >= datagrid3.fixedRows))  {
						send_fc_acct_1046_l();
					}
				]]>
			</script>
			<script type="javascript" ev:event="onkeyup">
				<![CDATA[
					send_fc_acct_1046_l();
				]]>
			</script>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				_oth_clsf = "3";
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var i = datagrid3.row;
					if(datagrid3.valueMatrix(i,1)== "1"){
						datagrid3.rowStatus(i) = "1";
					}
					else{
						datagrid3.rowStatus(i) = "0";
					}
				]]>
			</script>
		</datagrid>
		<group id="group3" class="gro_sel" style="left:10px; top:731px; width:926px; height:25px; ">
			<button id="btnReset" class="btn02" style="left:220px; top:3px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.reset();
						
						insd_acct_cd.attribute("editable") = "true";
						use_dt.attribute("editable") = "true";
						use_dt.disabled = false;

						gacct_cd = "";
						gacct_date = "";
						
//						btn_insert.disabled = false;
//						btn_update.disabled = true;
//						btn_delete.disabled = true;		

						for (i=1; i<datagrid1.rows; i++){
							datagrid1.rowStatus(i) = "1";
						}
					]]>
				</script>
			</button>
			<button id="btn_copy" class="btn02" style="left:275px; top:3px; width:52px; height:21px; ">
				<caption>복사</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(gacct_cd != insd_acct_cd.value || guse_dt != use_dt.value){
							show_message("key값이 변경되어 복사할 수 없습니다.");
							return false;
						}
						insd_acct_cd.value ="";
						insd_acct_cd.attribute("editable") = "true";
						use_dt.attribute("editable") = "true";
						use_dt.disabled = false;
						
						for(var i =1; i<datagrid1.rows; i++){
							if(get_refvalue("/root/resData/gridData/fc_acct_1047_l/dataSet/CURLIST/record["+i+"]/chk1") == "R"){
								datagrid1.rowStatus(i) = "1";
							}
						}
						
//						btn_insert.disabled = false;
//						btn_update.disabled = true;
//						btn_delete.disabled = true;
						
					]]>
				</script>
			</button>
			<button id="btn_delete" class="btn02" crud="D" style="left:165px; top:3px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (show_message("해당 계정코드가 완전히 삭제됩니다. 그래도 삭제하시겠습니까? \n(계정코드별 관리항목삭제는 수정버튼을 이용하세요)","삭제 확인",MB_YESNO) != IDYES) {
							return false;
						}

						set_refvalue("/root/reqData/reqForm/insd_acct_cd",insd_acct_cd.value);						
						set_refvalue("/root/reqData/reqForm/use_dt",use_dt.value);
						set_refvalue("/root/reqData/reqForm/cmpy_cd",srch_cmpy_cd.value);
						
//						send_submission(
//								"auto_"+ eval("fc_acct_1044_d").attribute("id")
//							,	eval("fc_acct_1044_d").attribute("ref")
//							,	eval("fc_acct_1044_d").attribute("resultref")
//							,	eval("fc_acct_1044_d").attribute("action")
//							,	eval("fc_acct_1044_d").attribute("method")
//							,	eval("fc_acct_1044_d").attribute("media-type")
//						);

						send_submission(
								eval("fc_acct_1044_d").attribute("id")
							,	eval("fc_acct_1044_d").attribute("ref")
							,	eval("fc_acct_1044_d").attribute("resultref")
							,	eval("fc_acct_1044_d").attribute("action")
							,	eval("fc_acct_1044_d").attribute("method")
							,	eval("fc_acct_1044_d").attribute("media-type")
						);

						if(submit_completed()){
							show_message("삭제되었습니다.");
							btn_select.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="btn_update" class="btn02" crud="U" style="left:110px; top:3px; width:52px; height:21px; ">
				<caption>수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (send_fc_acct_1048_u()){ 
//							btn_select.dispatch("onclick");
							send_fc_acct_1046_l();
						}
					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" crud="C" style="left:55px; top:3px; width:52px; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (send_fc_acct_1045_i()){ 
							btn_select.dispatch("onclick");
						}
					]]>
				</script>
			</button>
			<button id="btn_select" class="btn02" crud="R" style="left:0px; top:3px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_fc_acct_1049_l();
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" crud="R" style="left:330px; top:3px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					if(_oth_clsf == "3"){			
						grid = datagrid3;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}	
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:385px; top:3px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose();					
					]]>
				</script>
			</button>
		</group>
		<group id="group4" class="gro_sel" style="left:310px; top:679px; width:622px; height:26px; ">
			<caption id="caption27" class="list_cap02" style="left:119px; top:0px; width:503px; height:26px; text-align:center; "/>
			<caption id="caption53" class="list_cap03" style="left:0px; top:0px; width:120px; height:26px; text-align:center; ">회사복사(건별)</caption>
			<button id="btn_cmpy_cd_copy" class="btn02" crud="C" style="left:235px; top:4px; width:52px; height:21px; ">
				<caption>건별복사</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(srch_cmpy_cd.value ==""){
							show_message("회사코드는 필수입력항목입니다.");
							model.setFocus("srch_cmpy_cd");
							return false;
						}					
						if(proc_cmpy_cd.value ==""){
							show_message("건별 회사코드는 필수입력항목입니다.");
							model.setFocus("proc_cmpy_cd");
							return false;
						}
						set_refvalue("/root/reqData/multiUpDate/cmpy_cd",srch_cmpy_cd.value);
						set_refvalue("/root/reqData/multiUpDate/proc_cmpy_cd",proc_cmpy_cd.value);
						set_refvalue("/root/reqData/multiUpDate/kind","1");						
						set_refvalue("/root/reqData/multiUpDate/multiUpdateData", datagrid3.getUpdateData());

						model.send("fc_acct_1042_a");
						
						return check_submit_completed("복사되었습니다.","");
						
					]]>
				</script>
			</button>
			<select1 id="proc_cmpy_cd" ref="/root/reqData/reqForm/proc_cmpy_cd" class="req" navindex="22" appearance="minimal" editmode="inputsearch" itemcount="8" style="left:125px; top:4px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/CURLIST2/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(proc_cmpy_cd, proc_cmpy_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(proc_cmpy_cd,"");
							return;
						}
					]]>
				</script>
			</select1>
			<caption id="caption4" class="list_cap03" style="left:295px; top:0px; width:120px; height:26px; text-align:center; ">회사복사(일괄)</caption>
			<button id="btn_copy_all" class="btn02" crud="C" style="left:530px; top:4px; width:52px; height:21px; ">
				<caption>일괄복사</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(srch_cmpy_cd.value ==""){
							show_message("회사코드는 필수입력항목입니다.");
							model.setFocus("srch_cmpy_cd");
							return false;
						}					
						if(proc_cmpy_cd1.value ==""){
							show_message("일괄 회사코드는 필수입력항목입니다.");
							model.setFocus("proc_cmpy_cd1");
							return false;
						}
						set_refvalue("/root/reqData/multiUpDate/cmpy_cd",srch_cmpy_cd.value);
						set_refvalue("/root/reqData/multiUpDate/proc_cmpy_cd",proc_cmpy_cd1.value);
						set_refvalue("/root/reqData/multiUpDate/kind","2");						

						model.send("fc_acct_1042_a");
						
						return check_submit_completed("복사되었습니다.","");
						
					]]>
				</script>
			</button>
			<select1 id="proc_cmpy_cd1" ref="/root/reqData/reqForm/proc_cmpy_cd1" class="req" navindex="22" appearance="minimal" editmode="inputsearch" itemcount="8" style="left:420px; top:4px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/CURLIST2/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(proc_cmpy_cd1, proc_cmpy_cd1.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(proc_cmpy_cd1,"");
							return;
						}
					]]>
				</script>
			</select1>
		</group>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
	</xhtml:body>
</xhtml:html>
