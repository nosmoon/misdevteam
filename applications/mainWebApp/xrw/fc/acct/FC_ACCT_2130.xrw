<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>수입결의 환불처리 등록(FC_ACCT_2130)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session>
							<cmpy_cd/>
						</session>
						<!-- 서버의 세션 정보를 담당한다 -->
						<comboSet>
							<!-- 선택계열의 정보를 담당 -->
							<fc_acct_2130_m>
								<dataSet>
									<CURSLIP_CLSF>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURSLIP_CLSF>
									<CURMEDI_CD>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURMEDI_CD>
									<CURPROF_CD>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURPROF_CD>
									<CURERPALCED_CD>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURERPALCED_CD>
									<CURDLCO_CLSF_CD>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURDLCO_CLSF_CD>
									<xx_slip_clsf_cd/>
									<xx_prof_type_cd_010/>
									<xx_prof_type_cd_020/>
									<xx_prof_type_cd_030/>
									<xx_prof_type_cd_040/>
									<xx_prof_type_cd_050/>
									<xx_prof_type_cd_060/>
									<xx_budg_cd_010/>
									<xx_budg_cd_020/>
									<xx_budg_cd_030/>
									<xx_budg_cd_004/>
									<xx_budg_cd_050/>
								</dataSet>
							</fc_acct_2130_m>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 화면상의 입/출력 데이터등의 기본적인 데이터를 담당 -->
						<searchData>
							<cmpy_cd/>
							<slip_clsf_cd/>
							<slip_occr_dt/>
							<slip_seq/>
							<tax_stmt_no/>
							<slip_no/>
							<emp_no/>
							<dept_cd/>
							<budg_cd/>
							<cd/>
							<cdnm/>
							<fc_acct_2135_s>
								<uid/>
								<slip_clsf_cd/>
								<dlco_cd/>
								<ask_dept_cd/>
								<budg_cd/>
							</fc_acct_2135_s>
						</searchData>
						<!-- 정보별로 group화 한다. -->
						<fwdData/>
						<reqForm>
							<prof_type_cd/>
							<slip_clsf_cd/>
							<slip_occr_dt/>
							<slip_seq/>
							<make_dt/>
							<erplace_cd/>
							<dlco_clsf_cd/>
							<dlco_cd/>
							<deal_clsf/>
							<ern/>
							<dlco_nm/>
							<presi_nm/>
							<addr/>
							<bizcond/>
							<item/>
							<evnt_cd/>
							<suply_amt/>
							<vat_amt/>
							<tax_stmt_aprv_yn/>
							<make_upd_dt/>
							<upd_tms/>
							<last_upd_dt/>
							<rcpt_nosh/>
							<budg_cd/>
							<ask_emp_no/>
							<ask_dept_cd/>
							<rcpm_plan_dt/>
							<item2/>
							<slip_rcpm_dt/>
							<rcpm_sub_seq/>
							<budg_cd2/>
							<rcpm_amt/>
							<rcpm_dt/>
							<deps_psbk/>
							<coms/>
							<rcpm_pers_nm/>
							<gtieeno/>
							<gtibankcd/>
							<medi_cd/>
						</reqForm>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resForm>
							<prof_type_cd/>
							<slip_clsf_cd/>
							<make_dt/>
							<erplace_cd/>
							<dlco_clsf_cd/>
							<dlco_cd/>
							<ern/>
							<dlco_nm/>
							<presi_nm/>
							<addr/>
							<bizcond/>
							<item/>
							<suply_amt/>
							<vat_amt/>
							<budg_cd/>
							<budg_nm/>
							<ask_emp_no/>
							<ask_emp_nm/>
							<ask_dept_cd/>
							<ask_dept_nm/>
							<item2/>
							<medi_cd/>
							<medi_nm/>
							<evnt_cd/>
							<evnt_nm/>
							<fc_acct_2131_l>
								<dataSet>
									<CURLIST>
										<record>
											<cmpy_cd/>
											<prof_type_cd/>
											<slip_clsf_cd/>
											<slip_occr_dt/>
											<slip_seq/>
											<occr_slip_occr_dt/>
											<occr_slip_clsf_cd/>
											<occr_slip_seq/>
											<occr_slip_sub_seq/>
											<occr_slip_arow_no/>
											<make_dt/>
											<erplace_cd/>
											<dlco_clsf_cd/>
											<dlco_cd/>
											<deal_clsf/>
											<ern/>
											<dlco_nm/>
											<presi_nm/>
											<addr/>
											<bizcond/>
											<item/>
											<suply_amt/>
											<vat_amt/>
											<tax_stmt_aprv_yn/>
											<upd_tms/>
											<rcpt_nosh/>
											<budg_cd/>
											<budg_nm/>
											<ask_emp_no/>
											<ask_emp_nm/>
											<ask_dept_cd/>
											<ask_dept_nm/>
											<rcpm_plan_dt/>
											<item2/>
											<medi_cd/>
											<medi_nm/>
											<remk/>
											<slip_no/>
											<evnt_cd/>
											<evnt_nm/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_2131_l>
							<fc_acct_2132_i>
								<dataSet>
									<CURLIST>
										<record>
											<tax_stmt_no/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_2132_i>
							<slip_no/>
							<ern_nm/>
						</resForm>
						<gridData>
							<fc_acct_2135_s>
								<dataSet>
									<CURLIST>
										<record>
											<rcpm_no/>
											<rcpm_slip_no/>
											<slip_no/>
											<occr_slip_no/>
											<rcpm_amt/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_2135_s>
						</gridData>
						<formData/>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<tempData>
							<prev_prof_type_cd/>
						</tempData>
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<resForm2>
							<dataSet>
								<CURLIST>
									<record>
										<budg_cdnm/>
										<cdnm/>
										<cd/>
									</record>
								</CURLIST>
							</dataSet>
						</resForm2>
						<MsgData/>
					</resData>
					<tempData>
						<fc_co_1101_l>
							<dataSet>
								<CURLIST1>
									<record>
										<cmpy_cd/>
										<dept_cd/>
										<dept_team_clsf/>
										<abrv_nm/>
										<offi_nm/>
										<dept_team_nm/>
										<part_nm/>
										<part_dn_nm/>
									</record>
								</CURLIST1>
							</dataSet>
						</fc_co_1101_l>
					</tempData>
				</root>
			</instance>
			<submission id="fc_acct_2130_m" action="/fc/acct2000/2130" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/comboSet/fc_acct_2130_m/dataSet"/>
			<submission id="fc_acct_2131_l" action="/fc/acct2000/2131" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm/fc_acct_2131_l/dataSet"/>
			<submission id="fc_acct_2134_d" action="/fc/acct2000/2134" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="fc_acct_2132_i" action="/fc/acct2000/2132" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/resForm/fc_acct_2132_i/dataSet"/>
			<submission id="fc_acct_2133_u" action="/fc/acct2000/2133" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="hd_com_1002" action="/hd/com/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/tempData"/>
			<submission id="mc_co_1002_l" action="/mc/co1000/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm2/dataSet"/>
			<submission id="fc_co_1101" action="/fc/co1000/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/fc_co_1101_l/dataSet"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					set_column_visibility();
					init_controls();
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					model.send("fc_acct_2130_m");
					
					//slip_clsf_cd.value = "30"; //2012.01.10
					slip_clsf_cd.value= model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_slip_clsf_cd");
					
					set_refvalue("/root/initData/session/cmpy_cd", getProperty("ss_cmpycd"));
					
					makeComboGubun("","/root/initData/comboSet/fc_acct_2130_m/dataSet/CURSLIP_CLSF","record","cdabrvnm_cd", "cd");
					makeComboGubun("","/root/initData/comboSet/fc_acct_2130_m/dataSet/CURMEDI_CD","record","cdabrvnm_cd", "cd");
					makeComboGubun("","/root/initData/comboSet/fc_acct_2130_m/dataSet/CURPROF_CD","record","cdabrvnm_cd", "cd");
					makeComboGubun("","/root/initData/comboSet/fc_acct_2130_m/dataSet/CURERPALCED_CD","record","cdabrvnm_cd", "cd");
					makeComboGubun("","/root/initData/comboSet/fc_acct_2130_m/dataSet/CURDLCO_CLSF_CD","record","cdabrvnm_cd", "cd");					
					slip_clsf_cd.refresh();
					medi_cd.refresh();
					prof_type_cd.refresh();
					erplace_cd.refresh();
					dlco_clsf_cd.refresh();

					make_dt.value = commCurDate();
					
//    W_GUNHAN = GF_GetGunHanChk(Cmndll.W_Sabeon, "01")
//    If W_GUNHAN = "0" Or W_GUNHAN = "G" Then
//        If W_GUNHAN = "0" Then
//        MsgBox "권한조회시 error가 발생하였습니다.전산실로문의하세요", vbCritical, Cmndll.GF_GetMessage(1, 201)
//        ElseIf W_GUNHAN = "G" Then
//            MsgBox "해당 사번에 대한 개인별권한이 등록되지 않았습니다" + Chr(13) + _
//                   "등록후 작업하세요", vbCritical, Cmndll.GF_GetMessage(1, 201)
//        End If
//        sscmdExit_Click
//    End If
//    If Cmndll.W_Etc2 <> "00" Then
//        mskHJPSGGSSNO.Text = Format(Cmndll.W_Etc2, "##-########-####")
//        sSelGb = "1"
//        sscmdSelect_Click
//    End If
					ask_emp_no.value = getProperty("ss_emp_no");
					ask_emp_nm.value = getProperty("ss_emp_nm");
					ask_dept_cd.value = getProperty("ss_deptcd").substring(0,4) + "00";
					ask_dept_nm.value = getProperty("ss_deptnm");
					
					btn_update.disabled = true;
					btn_delete.disabled = true;
				]]>
			</script>
			<submission id="fc_acct_2135_s" action="/fc/acct2000/2135" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/fc_acct_2135_s" resultref="/root/resData/gridData/fc_acct_2135_s/dataSet"/>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/fcmc_common.js"/>
		<script type="javascript">
			<![CDATA[
				var gstr_popupid = "";
				var gssst;
				var upcnt;

				function set_column_visibility() {
					//모든 컬럼을 감춘다.
					hide_all_columns(datagrid1);
					//공통 컬럼을 보여준다.
					show_all_columns(datagrid1);
				}

				function init_controls(){
					set_default(
						datagrid1
					);					//datagrid
					set_default(
					//	srch_tax_stmt_no
						srch_slip_no
					,	budg_nm
					,	ask_dept_nm
					,	ask_emp_nm
					, 	medi_nm
					, 	evnt_nm
					,	dlco_nm
					,	ern
					,	ern_nm
					,	item
					,	item2
					,	presi_nm
					,	bizcond
					,	addr
					,	suply_amt
					,	vat_amt
					);	//input
					set_default(
						budg_cd
					,	ask_dept_cd
					,	ask_emp_no
					,	ask_emp_nm					
					,	evnt_cd
					,	dlco_cd
					);	//input button
					set_default(
						make_dt
					);	//input date
					set_default(	
						medi_cd
					,	dlco_clsf_cd
					,	prof_type_cd
					,	slip_clsf_cd
					,	erplace_cd
					);	//combo										
					set_format(
						"string_l"
					,	budg_nm
					,	ask_dept_nm
					,	ask_emp_nm
					,	medi_cd
					,	medi_nm
					,	evnt_nm
					,	dlco_clsf_cd
					,	dlco_cd
					,	dlco_nm
					,	prof_type_cd
					,	ern
					,	ern_nm
					,	item
					,	item2
					,	slip_clsf_cd
					,	erplace_cd
					,	presi_nm
					,	bizcond
					,	addr
					);
					set_format(
						"string_c"
					//	srch_tax_stmt_no
					,	srch_slip_no
					);					
					set_format(
						"code"
					,	budg_cd
					,	ask_dept_cd
					,	ask_emp_no
					,	evnt_cd
					);
					set_format(
						"date_1"
					,	make_dt
					)
					set_format(
						"number4"
					,	suply_amt
					,	vat_amt
					)
				}

				function send_fc_acct_2134_d() {
					//조건에 문제가 없다면 처리
					if (!prepare_acct_2134_d()) {
						return false;
					}
					set_refvalue("/root/reqData/reqForm/prof_type_cd",prof_type_cd.value);	//증빙유형코드
					set_refvalue("/root/reqData/reqForm/slip_clsf_cd", get_refvalue("/root/reqData/searchData/slip_clsf_cd"));	//전표구분코드
					set_refvalue("/root/reqData/reqForm/slip_occr_dt", get_refvalue("/root/reqData/searchData/slip_occr_dt"));	//발생일자
					set_refvalue("/root/reqData/reqForm/slip_seq", get_refvalue("/root/reqData/searchData/slip_seq"));	//일련번호
					
					if(srch_tax_stmt_no.value.length != 14){
						show_message("세금계산서 16자리 정확한 데이타를 입력하십시오.");
					}
					if(srch_slip_no.value != ""){
						show_message("전표가 이미 생성되었으므로 삭제불가.");
					}					
					if (show_message("삭제하시겠습니까?","삭제 확인",MB_YESNO) != IDYES) {
						return false;
					}
					
					//실행
					model.send("fc_acct_2134_d");
					
					if(submit_completed()){						
						show_message("삭제되었습니다.");
						btn_select.dispatch("onclick");
					}
//					return check_submit_completed("삭제되었습니다.","");
				}	

				function prepare_acct_2134_d() {
					
//					if (!check_key_values("d")) {
//						return false;
//					}
					
//					if(!check_search_values()) {
//						return false;
//					}
					
//					if(!check_input_values()) {
//						return false;
//					}
					
					return true;
				}

				function send_fc_acct_2132_i() {
					//조건에 문제가 없다면 처리
					if (!prepare_acct_2132_i()) {
						return false;
					}
		
//					if(prof_type_cd.value != "33" && prof_type_cd.value != "36" &&  prof_type_cd.value != "37" &&  prof_type_cd.value != "38" && prof_type_cd.value != "39"){  //2012.01.10
					var orgStr = model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_prof_type_cd_010");				
					if(! instr_yn(orgStr, prof_type_cd.value)){
						if(dlco_clsf_cd.value == ""){
							show_message("거래처구분코드는 필수입력항목입니다.");
							return false;
						}
						if(dlco_cd.value == ""){
							show_message("거래처코드는 필수입력항목입니다.");
							return false;
						}
					}
					if(suply_amt.value == ""){
						show_message("공급가액은 필수입력항목입니다.");
						return false;
					}								
					
//					if(prof_type_cd.value != "36" && prof_type_cd.value != "37" &&  prof_type_cd.value != "38" && prof_type_cd.value != "39"){ //2012.01.10
					var orgStr2 = model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_prof_type_cd_020");					
					if(! instr_yn(orgStr2, prof_type_cd.value)){						
						if(dlco_clsf_cd.value == "93"){
							if(presi_nm.value == ""){
								show_message("공통거래처 등록화면에서 대표자명을 수정하시오.");
								return false;
							}
							if(bizcond.value == ""){
								show_message("공통거래처 등록화면에서 업태를 수정하시오.");
								return false;
							}
							if(item.value == ""){
								show_message("공통거래처 등록화면에서 종목을 수정하시오.");
								return false;
							}
							if(addr.value == ""){
								show_message("공통거래처 등록화면에서 주소를 수정하시오.");
								return false;
							}
						}
						else{
							if(addr.value == ""){
								show_message("공통거래처 등록화면에서 주소를 수정하시오.");
								return false;
							}
						}
					}				
					if(prof_type_cd.value.substring(0,1) != "3"){
						show_message("증빙종류 선택 오류 \n 선택가능한 증빙종류는 (31~39)까지 입니다.");
						return false;
					}
					
					//if (budg_cd.value.substring(0, 2) >= "61" && budg_cd.value.substring(0, 2) <= "69") { //2012.01.10
					if (budg_cd.value.substring(0, 2) >= model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_budg_cd_040") 
					 && budg_cd.value.substring(0, 2) <= model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_budg_cd_050")) {	
						
						show_message("비용예산코드 불가:경리부 문의요3");
						budg_cd.value = "";
						budg_nm.value = "";
						return;
					}
					
					if(dlco_clsf_cd.value =="93"){
						//if(prof_type_cd.value != "31" && prof_type_cd.value != "34" &&  prof_type_cd.value != "36" && prof_type_cd.value != "39"){ //2012.01.10
						var orgStr3 = model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_prof_type_cd_030");
						if(! instr_yn(orgStr3, prof_type_cd.value)){
							show_message("증빙종류 선택 오류 \n 거래처구분(93)이면서 증빙종류는 (31,34,36,39) 입니다.");
						}
					}
					if(dlco_clsf_cd.value =="94"){
						//if(prof_type_cd.value != "32" && prof_type_cd.value != "35" &&  prof_type_cd.value != "36" && prof_type_cd.value != "38" && prof_type_cd.value != "39"){ //2012.01.10
						var orgStr4 = model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_prof_type_cd_040");
						if(! instr_yn(orgStr4, prof_type_cd.value)){
							show_message("증빙종류 선택 오류 \n 거래처구분(94)이면서 증빙종류는 (32,35,36,38,39) 입니다.");
						}
					}
					if(vat_amt.value != 0){
						//if(prof_type_cd.value != "31" && prof_type_cd.value != "32" &&  prof_type_cd.value != "39"){ //2012.01.10
						var orgStr5 = model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_prof_type_cd_050");
						if(! instr_yn(orgStr5, prof_type_cd.value)){
							show_message("증빙종류 선택 오류 \n 부가세 금액이 있으면 증빙종류는 (31,32,39)만 선택가능.");
						}
					}

					var SGTOTAMT;
					
					SGTOTAMT = 0;
					SGTOTAMT = Number(suply_amt.value) + Number(vat_amt.value);
					
					if(evnt_cd.value != ""){
						set_refvalue("/root/reqData/reqForm/evnt_cd",evnt_cd.value); //행사코드
					}
					else{
						set_refvalue("/root/reqData/reqForm/evnt_cd"," ");
					}
					set_refvalue("/root/reqData/reqForm/prof_type_cd",prof_type_cd.value);	//증빙유형코드
					set_refvalue("/root/reqData/reqForm/slip_clsf_cd",slip_clsf_cd.value);	//전표구분코드
					set_refvalue("/root/reqData/reqForm/slip_occr_dt",commCurDate());		//발생일자
					set_refvalue("/root/reqData/reqForm/ask_dept_cd",ask_dept_cd.value);	//의뢰부서코드
					set_refvalue("/root/reqData/reqForm/ask_emp_no",ask_emp_no.value);	//의뢰사번
					set_refvalue("/root/reqData/reqForm/make_dt",make_dt.value);			//작성일자
					set_refvalue("/root/reqData/reqForm/erplace_cd",erplace_cd.value);		//사업장코드
					set_refvalue("/root/reqData/reqForm/dlco_clsf_cd",dlco_clsf_cd.value);	//거래처구분코드

					if(dlco_clsf_cd.value == "93"){
						set_refvalue("/root/reqData/reqForm/deal_clsf","3");				//거래구분
					}
					else if(dlco_clsf_cd.value == "94"){
						set_refvalue("/root/reqData/reqForm/deal_clsf","4");				//거래구분
					}
					else{
						set_refvalue("/root/reqData/reqForm/deal_clsf"," ");				//거래구분
					}
					
					set_refvalue("/root/reqData/reqForm/medi_cd",medi_cd.value);			//매체코드
					set_refvalue("/root/reqData/reqForm/dlco_cd",dlco_cd.value);			//거래처코드
					
					if(dlco_cd.value == "" && dlco_clsf_cd.value == ""){
						set_refvalue("/root/reqData/reqForm/dlco_nm",dlco_nm.value);		//거래처명
					}
					else{
						set_refvalue("/root/reqData/reqForm/dlco_nm",ern_nm.value);		//거래처명
					}

					if(dlco_clsf_cd.value == "94"){
						set_refvalue("/root/reqData/reqForm/presi_nm",ern_nm.value);		//거래처명(대표자명)
					}
					else{
						set_refvalue("/root/reqData/reqForm/presi_nm",presi_nm.value);	//대표자명	
					}
					set_refvalue("/root/reqData/reqForm/ern",ern.value);					//사업자등록번호
					set_refvalue("/root/reqData/reqForm/bizcond",bizcond.value);			//업태
					set_refvalue("/root/reqData/reqForm/item",item.value);				//종목
					
					//if(prof_type_cd.value == "36" || prof_type_cd.value == "37" || prof_type_cd.value == "38"  || prof_type_cd.value == "39" ){ //2012.01.10 수정
					var orgStr2 = model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_prof_type_cd_020");
					if(instr_yn(orgStr2, prof_type_cd.value)){
						set_refvalue("/root/reqData/reqForm/addr"," ");					//주소
					}
					else{
						set_refvalue("/root/reqData/reqForm/addr",addr.value);			//주소
					}

					set_refvalue("/root/reqData/reqForm/suply_amt",suply_amt.value);		//공급가액
					set_refvalue("/root/reqData/reqForm/vat_amt",vat_amt.value);			//부가세액
					set_refvalue("/root/reqData/reqForm/rcpt_nosh","0");					//영수증매수
					set_refvalue("/root/reqData/reqForm/budg_cd",budg_cd.value);			//예산코드
					set_refvalue("/root/reqData/reqForm/tax_stmt_aprv_yn","1");			//세금계산서상태
					set_refvalue("/root/reqData/reqForm/item2",item2.value);				//품목(환불사유)
					
					set_refvalue("/root/reqData/reqForm/rcpm_sub_seq","01");			//subseq(기타입금내역)
					set_refvalue("/root/reqData/reqForm/budg_cd2","001100");				//계정코드(현금)
					set_refvalue("/root/reqData/reqForm/rcpm_amt",SGTOTAMT);			//subseq(기타입금내역)
					set_refvalue("/root/reqData/reqForm/rcpm_dt"," ");					//예금입금일자
					set_refvalue("/root/reqData/reqForm/deps_psbk"," ");				//예금통장
					set_refvalue("/root/reqData/reqForm/coms","0");					//수수료
					set_refvalue("/root/reqData/reqForm/rcpm_pers_nm"," ");				//입금자명
					set_refvalue("/root/reqData/reqForm/gtieeno"," ");					//어음번호
					set_refvalue("/root/reqData/reqForm/gtibankcd"," ");					//금융기관
					
					set_refvalue("/root/reqData/reqForm/slip_rcpm_dt", commCurDate());	//입금일자
					set_refvalue("/root/reqData/reqForm/rcpm_plan_dt", " ");				//입금예정일

					if (show_message("저장하시겠습니까?","저장 확인",MB_YESNO) != IDYES) {
						return false;
					}
					//실행
					model.send("fc_acct_2132_i");
					
					set_refvalue("/root/reqData/searchData/tax_stmt_no",get_refvalue("/root/resData/resForm/fc_acct_2132_i/dataSet/CURLIST/record/tax_stmt_no"));
					model.refresh();
										
					return check_submit_completed("저장되었습니다.","");
				}	

				function prepare_acct_2132_i() {
					
//					if (!check_key_values("i")) {
//						return false;
//					}					
					
//					if(!check_search_values()) {
//						return false;
//					}
					
					if(!check_input_values()) {
						return false;
					}
					
					return true;
				}

				function send_fc_acct_2133_u() {
					//조건에 문제가 없다면 처리
					if (!prepare_acct_2133_u()) {
						return false;
					}
					//if(prof_type_cd.value != "33" && prof_type_cd.value != "36" &&  prof_type_cd.value != "38" && prof_type_cd.value != "39"){ //2012.01.10
					var orgStr6 = model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_prof_type_cd_060");
					if(! instr_yn(orgStr6, prof_type_cd.value)){
						if(dlco_clsf_cd.value == ""){
							show_message("거래처구분코드는 필수입력항목입니다.");
							return false;
						}
						if(dlco_cd.value == ""){
							show_message("거래처코드는 필수입력항목입니다.");
							return false;
						}
					}
					if(suply_amt.value == ""){
						show_message("공급가액은 필수입력항목입니다.");
						return false;
					}
					//if(prof_type_cd.value != "33" && prof_type_cd.value != "36" &&  prof_type_cd.value != "38" && prof_type_cd.value != "39"){ //2012.01.10
					var orgStr6 = model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_prof_type_cd_060");
					if(! instr_yn(orgStr6, prof_type_cd.value)){
						if(dlco_clsf_cd.value == "93"){
							if(presi_nm.value == ""){
								show_message("공통거래처 등록화면에서 대표자명을 수정하시오.");
								return false;
							}
							if(bizcond.value == ""){
								show_message("공통거래처 등록화면에서 업태를 수정하시오.");
								return false;
							}
							if(item.value == ""){
								show_message("공통거래처 등록화면에서 종목을 수정하시오.");
								return false;
							}
							if(addr.value == ""){
								show_message("공통거래처 등록화면에서 주소를 수정하시오.");
								return false;
							}
						}
						else{
							if(addr.value == ""){
								show_message("공통거래처 등록화면에서 주소를 수정하시오.");
								return false;
							}
						}
					}
					
					var SGTOTAMT;
					
					SGTOTAMT = 0;
					SGTOTAMT = Number(suply_amt.value) + Number(vat_amt.value);			//공급가액
					
					if(evnt_cd.value != ""){
						set_refvalue("/root/reqData/reqForm/evnt_cd",evnt_cd.value);		 //행사코드
					}
					else{
						set_refvalue("/root/reqData/reqForm/evnt_cd"," ");
					}
										
					set_refvalue("/root/reqData/reqForm/prof_type_cd",prof_type_cd.value);	//증빙유형코드
					set_refvalue("/root/reqData/reqForm/slip_clsf_cd", get_refvalue("/root/reqData/searchData/slip_clsf_cd"));	//전표구분코드
					set_refvalue("/root/reqData/reqForm/slip_occr_dt", get_refvalue("/root/reqData/searchData/slip_occr_dt"));	//발생일자
					set_refvalue("/root/reqData/reqForm/slip_seq", get_refvalue("/root/reqData/searchData/slip_seq"));		//일련번호
					set_refvalue("/root/reqData/reqForm/ask_dept_cd",ask_dept_cd.value);	//의뢰부서코드
					set_refvalue("/root/reqData/reqForm/ask_emp_no",ask_emp_no.value);	//의뢰사번
					set_refvalue("/root/reqData/reqForm/make_dt",make_dt.value);			//작성일자
					set_refvalue("/root/reqData/reqForm/erplace_cd",erplace_cd.value);		//사업장코드
					set_refvalue("/root/reqData/reqForm/dlco_clsf_cd",dlco_clsf_cd.value);	//거래처구분코드

					if(dlco_clsf_cd.value == "93"){
						set_refvalue("/root/reqData/reqForm/deal_clsf","3");				//거래구분
						set_refvalue("/root/reqData/reqForm/presi_nm",presi_nm.value);	//대표자명
					}
					else if(dlco_clsf_cd.value == "94"){
						set_refvalue("/root/reqData/reqForm/deal_clsf","4");				//거래구분
						set_refvalue("/root/reqData/reqForm/dlco_nm",ern_nm.value);		//거래처명
					}
					else{
						set_refvalue("/root/reqData/reqForm/deal_clsf","4");				//거래구분						
						set_refvalue("/root/reqData/reqForm/presi_nm",presi_nm.value);	//대표자명
					}
					
					set_refvalue("/root/reqData/reqForm/dlco_cd",dlco_cd.value);			//거래처코드				
					set_refvalue("/root/reqData/reqForm/dlco_nm",dlco_nm.value);			//거래처명
					set_refvalue("/root/reqData/reqForm/ern",ern.value);					//사업자등록번호
					set_refvalue("/root/reqData/reqForm/bizcond",bizcond.value);			//업태
					set_refvalue("/root/reqData/reqForm/item",item.value);				//종목
					set_refvalue("/root/reqData/reqForm/addr",addr.value);				//주소
					set_refvalue("/root/reqData/reqForm/suply_amt",suply_amt.value);		//공급가액
					set_refvalue("/root/reqData/reqForm/vat_amt",vat_amt.value);			//부가세액
					set_refvalue("/root/reqData/reqForm/rcpt_nosh","0");					//영수증매수
					set_refvalue("/root/reqData/reqForm/budg_cd",budg_cd.value);			//예산코드

					set_refvalue("/root/reqData/reqForm/medi_cd",medi_cd.value);			//매체코드
					
					if(gssst == ""){
						set_refvalue("/root/reqData/reqForm/tax_stmt_aprv_yn"," ");		//세금계산서상태
					}
					else{
						set_refvalue("/root/reqData/reqForm/tax_stmt_aprv_yn",gssst);		//세금계산서상태
					}
					set_refvalue("/root/reqData/reqForm/make_upd_dt",commCurDate());	//작성수정일자
					set_refvalue("/root/reqData/reqForm/upd_tms",Number(upcnt)+1);		//수정횟수
					set_refvalue("/root/reqData/reqForm/last_upd_dt",commCurDate());		//최종수정일자					
					
					set_refvalue("/root/reqData/reqForm/item2",item2.value);				//품목(환불사유)																		
					
					set_refvalue("/root/reqData/reqForm/rcpm_sub_seq","01");			//subseq(기타입금내역)
					set_refvalue("/root/reqData/reqForm/budg_cd2","001100");				//계정코드(현금)
					set_refvalue("/root/reqData/reqForm/rcpm_amt",SGTOTAMT);			//subseq(기타입금내역)
					set_refvalue("/root/reqData/reqForm/rcpm_dt"," ");					//예금입금일자
					set_refvalue("/root/reqData/reqForm/deps_psbk"," ");				//예금통장
					set_refvalue("/root/reqData/reqForm/coms","0");					//수수료
					set_refvalue("/root/reqData/reqForm/rcpm_pers_nm"," ");				//입금자명
					set_refvalue("/root/reqData/reqForm/gtieeno"," ");					//어음번호
					set_refvalue("/root/reqData/reqForm/gtibankcd"," ");					//금융기관
					
					set_refvalue("/root/reqData/reqForm/slip_rcpm_dt", commCurDate());	//입금일자			
					set_refvalue("/root/reqData/reqForm/rcpm_plan_dt", " ");				//입금예정일					
					
					if (show_message("수정하시겠습니까?","수정 확인",MB_YESNO) != IDYES) {
						return false;
					}					
					//실행
					model.send("fc_acct_2133_u");
					
					return check_submit_completed("수정되었습니다.","");
				}	

				function prepare_acct_2133_u() {
					
//					if (!check_key_values("u")) {
//						return false;
//					}
					
					if(!check_search_values()) {
						return false;
					}
					
					if(!check_input_values()) {
						return false;
					}
					
					
					return true;
				}
																
				function check_key_values(p_iud) {
					var key_flag = false;
					var key_msg = "";
					//키값 변경 체크
					var prev_prof_type_cd	=	get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/prof_type_cd");
					var prev_slip_clsf_cd		=	get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/slip_clsf_cd");
					var prev_slip_occr_dt		=	get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/slip_occr_dt");
					var prev_slip_seq		=	get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/slip_seq");
//					alert(prev_prof_type_cd +"-'"+prev_slip_clsf_cd+"-'"+prev_slip_occr_dt+"-'"+prev_slip_seq);
//					alert(get_refvalue("/root/resData/tempData/prev_prof_type_cd") +"-'"+get_refvalue("/root/reqData/searchData/slip_clsf_cd")
//					+"-'"+ get_refvalue("/root/reqData/searchData/slip_occr_dt") +"-'"+get_refvalue("/root/reqData/searchData/slip_seq"));
					
					if (	prev_prof_type_cd == get_refvalue("/root/resData/tempData/prev_prof_type_cd")
						&&   prev_slip_clsf_cd	==	get_refvalue("/root/reqData/searchData/slip_clsf_cd")
						&&	prev_slip_occr_dt	==	get_refvalue("/root/reqData/searchData/slip_occr_dt")
						&&	prev_slip_seq		==	get_refvalue("/root/reqData/searchData/slip_seq")
					) {
						//키값이 변경되지 않은 경우
						key_flag = true;
					}
					else {
						//키값이 변경 된 경우
						key_flag = false;
					}
					
					switch (p_iud.toUpperCase()) {
						case "I":
							//입력인 경우 키값이 변경되지 않은 경우
							//입력할 필요가 없는 데이터이므로
							//key_flag를 반전시킨다.
							key_flag = !key_flag;
							key_msg = "조회된 key 값과 입력할 key 값이 같습니다.";
							break;
						case "U":
							if (!check_reqItem("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/cmpy_cd","trim","none","조회되지 않은 데이터입니다. 조회 후 수정하세요.")) {return false;}
							key_msg = "Key 값이 변경되었습니다. 조회 후 수정하세요.";
							break;
						case "D":
							if (!check_reqItem("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/cmpy_cd","trim","none","조회되지 않은 데이터입니다. 조회 후 삭제하세요.")) {return false;}
							key_msg = "Key 값이 변경되었습니다. 조회 후 삭제하세요.";
							break;
						default:
							show_message("key 값 확인을 위한 구분자가 지정되지 않았습니다.");
							break;
					}
	//				if (!key_flag) show_message(key_msg);
					if (!key_flag) check_reqItem("","none","none",key_msg);			
					return key_flag;
				}				
				function check_search_values() {
					//필수항목체크(검색)
					return commReqCheck(group_scr);
				}
				function check_input_values() {
					//필수항목체크(내용)
					if (!commReqCheck(group1)) {
						return false;
					}

					if (!commReqCheck(group2)) {
						return false;
					}
					//필수항목체크(grid);
					if(!commGridReqCheck("datagrid1")) {
						return false;
					}		

					//선택적필수항목체크
//					if (input6.value != "") {
//						if (!check_reqItem(input15,"trim","focus","취소유무가 있을 경우 취소일자는 필수입력항목입니다.")) {return false;}
//						if (!check_reqItem(input2,"trim","focus","취소유무가 있을 경우 취소사유는 필수입력항목입니다.")) {return false;}
//					}
//					if (input8.value != "") {
//						if (!check_reqItem(combo5,"trim","focus","신고여부가 있을경우 신고분기는 필수입력항목입니다.")) {return false;}
//					}
					//유효성체크
//					if (!check_reqItem(medi_nm,"trim",medi_cd,"매체코드를 다시 조회하세요.")) {return false;}
//					if (!check_reqItem(dlco_nm,"trim",dlco_cd,"거래처코드를 다시 조회하세요.")) {return false;}
//					if (!check_reqItem(ask_dept_nm,"trim",ask_dept_cd,"사용부서코드를 다시 조회하세요.")) {return false;}
					
					return true;
				}
				
				function open_fc_acct_1180(p_where,p_mode,p_title,p_readonly,p_to) {
					var need_popup = true;
					var rcvs_flag = false;
					
					p_where = p_where.toUpperCase();
					
					if (!check_reqItem(dlco_clsf_cd,"none","focus","[거래처검색]은 [거래처구분]을 선택 후 조회 할 수 있습니다.")) {return rcvs_flag};
					
					//검색조건이 모두 충족하지 않으면 종료한다.
					if (p_where == "FOCUS" && (dlco_clsf_cd.value.Trim() == "" || dlco_cd.value.Trim() == "")) {
						dlco_nm.value	= "";
						return rcvs_flag;
					}
					
					var popid = "fc_acct_1180";
					var subid = "fc_acct_1181_l";
	
					set_popup_send_data(popid		,"mode"			,p_mode			);
					set_popup_send_data(popid		,"title"			,p_title			);
					set_popup_send_data(popid		,"readonly"		,p_readonly		);
					set_popup_send_data(popid		,"clsf_cd"			,dlco_clsf_cd.value	);
					set_popup_send_data(popid		,"cd_f"			,dlco_cd.value		);
					set_popup_send_data(popid		,"cd_t"			,dlco_cd.value		);
	//				set_popup_send_data(popid		,"cd_abrv_nm"		,dlco_cd.value		);
					set_popup_send_data(popid		,"cd_abrv_nm"		,""				);
	
					//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
					if (p_where == "FOCUS") {
						//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
						//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
						model.removenode(get_popup_rcvs_ref(popid));
						//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
						model.makeNode(get_popup_rcvs_ref(popid));
						
						//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
						send_submission(
								"auto_" + subid
							,	get_popup_send_ref(popid)
							,	get_popup_rcvs_ref(subid) + "/dataSet"
							,	"/fc/acct1000/1181"
							,	"urlencoded-post"
							,	"application/x-www-form-urlencoded"
						);
						
						totalcnt = get_refvalue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
				
						if (totalcnt == 1) {
							//데이터가 1건이고 focus out에서 호출한 경우
							//데이터를 설정하고 나간다.
	
	//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
	//						return;
							need_popup = false;
							rcvs_flag = true;
						}
						else if (totalcnt == 0) {
	//						show_message("거래처코드의 검색결과가 없습니다.");
	//						return;
							need_popup = false;	
							rcvs_flag = false;
						}
						else {
							//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
							//만약 1건 이상인 경우 popup을 호출해 달라고 하면
							//return을 지우면 됨
							//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
							//return;
							need_popup = true;
						}
					}
					
					//그외 버튼인 경우는 계속 진행
					if (need_popup) {
						rcvs_flag = open_popup(popid,"640");
					}
	
					//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
					//다시 조회 하기 쉽도록 하고
					if (get_popup_rcvs_data(popid,"clsf_cd") != "")			dlco_clsf_cd.value		=	get_popup_rcvs_data(popid,"clsf_cd");
//					if (get_popup_rcvs_data(popid,"cd") != "")				dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
//					
//					if (get_popup_rcvs_data(popid,"cd") != "")				ern.value				=	get_popup_rcvs_data(popid,"cd");
//					if (get_popup_rcvs_data(popid,"cdnm") != "")			ern_nm.value			=	get_popup_rcvs_data(popid,"cdnm");
//					if (get_popup_rcvs_data(popid,"presi_nm") != "")			presi_nm.value			=	get_popup_rcvs_data(popid,"presi_nm");
//					if (get_popup_rcvs_data(popid,"bizcond") != "")			bizcond.value			=	get_popup_rcvs_data(popid,"bizcond");
//					if (get_popup_rcvs_data(popid,"item") != "")			item.value				=	get_popup_rcvs_data(popid,"item");
//					var addr_var = "";
//					if (get_popup_rcvs_data(popid,"addr1") != "")			addr_var			=	addr_var + get_popup_rcvs_data(popid,"addr1");
//					if (get_popup_rcvs_data(popid,"addr2") != "")			addr_var			=	addr_var + get_popup_rcvs_data(popid,"addr2");
//					if (get_popup_rcvs_data(popid,"addr3") != "")			addr_var			=	addr_var + get_popup_rcvs_data(popid,"addr3");
//					if (get_popup_rcvs_data(popid,"addr4") != "")			addr_var			=	addr_var + get_popup_rcvs_data(popid,"addr4");
//					set_refvalue(addr,addr_var);
					
					//그외의 값은 지워지도록 한다.
					//dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
					
					ern.value				=	get_popup_rcvs_data(popid,"cd");
					ern_nm.value			=	get_popup_rcvs_data(popid,"cdnm");
					presi_nm.value			=	get_popup_rcvs_data(popid,"presi_nm");
					bizcond.value			=	get_popup_rcvs_data(popid,"bizcond");
					item.value				=	get_popup_rcvs_data(popid,"item");
					
					var addr_var = "";
					if (get_popup_rcvs_data(popid,"addr1") != "")			addr_var			=	addr_var + get_popup_rcvs_data(popid,"addr1");
					if (get_popup_rcvs_data(popid,"addr2") != "")			addr_var			=	addr_var + get_popup_rcvs_data(popid,"addr2");
					if (get_popup_rcvs_data(popid,"addr3") != "")			addr_var			=	addr_var + get_popup_rcvs_data(popid,"addr3");
					if (get_popup_rcvs_data(popid,"addr4") != "")			addr_var			=	addr_var + get_popup_rcvs_data(popid,"addr4");
					set_refvalue(addr,addr_var);					
					
					return rcvs_flag;
				}

				function setEmp_no(emp_no, nm_korn){

					set_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/ask_emp_no", emp_no);
					set_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/ask_emp_nm", nm_korn);

					ask_emp_no.refresh();
					ask_emp_nm.refresh();

				}									

				function setDept_cd(iv_dept_cd, iv_dept_nm, iv_dept_team_clsf, iv_offi_nm, iv_dept_team_nm, iv_part_nm, iv_part_dn_nm){	
					model.setValue("/root/resData/resForm/ask_dept_cd", iv_dept_cd);
					model.setValue("/root/resData/resForm/ask_dept_nm", iv_dept_nm);
					ask_dept_cd.refresh();
					ask_dept_nm.refresh();
					
					fun_grid();
				}				

				// pop-up
				function setEvntInfo(Evnt_cd, Evnt_nm){
					
					if (gstr_popupid == "evnt_cd") {		// 행사코드
						evnt_cd.value = Evnt_cd;
						evnt_nm.value = Evnt_nm;
					}

					if (gstr_popupid == "budg_cd") {		// 예산코드
						budg_cd.value = Evnt_cd;
						budg_nm.value = Evnt_nm;						
					}					
				}		
				
				function fun_grid(){
					if(budg_cd.value != "" && ask_dept_cd.value != "" && dlco_cd.value != ""){
						var ref_var = "/root/reqData/searchData/fc_acct_2135_s/";
						set_refvalue(ref_var + "uid", getProperty("ss_uid"));
						set_refvalue(ref_var + "dlco_cd", dlco_cd.value);
						set_refvalue(ref_var + "ask_dept_cd", ask_dept_cd.value);
						set_refvalue(ref_var + "budg_cd", budg_cd.value);
						
						model.send("fc_acct_2135_s");
					}else{
						datagrid_data_clear(datagrid1);
					}
				}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="1,10;2,8;1,873;1,878;1,893;1,898;1,913;1,918;1,933;1,936;2,29;2,39;2,40;2,51;2,75;2,75;2,87;2,100;2,668;2,704;2,687;2,668;" style="font-family:굴림; ">
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group_scr" class="gro_sel" style="left:10px; top:50px; width:926px; height:25px; ">
			<caption id="caption2" class="list_cap03" style="left:0px; top:0px; width:120px; height:25px; text-align:center; ">세금계산서번호</caption>
			<caption id="caption3" class="list_cap02" style="left:119px; top:0px; width:161px; height:25px; text-align:center; "/>
			<caption id="caption82" class="list_cap03" style="left:279px; top:0px; width:120px; height:25px; text-align:center; ">계산서전표번호</caption>
			<caption id="caption83" class="list_cap02" style="left:398px; top:0px; width:161px; height:25px; text-align:center; "/>
			<input id="srch_tax_stmt_no" ref="/root/reqData/searchData/tax_stmt_no" format="99-99999999-9999" style="left:125px; top:3px; width:150px; height:18px; "/>
			<input id="srch_slip_no" ref="/root/resData/resForm/slip_no" style="left:404px; top:3px; width:150px; height:18px; "/>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:83px; width:926px; height:5px; "/>
		<group id="group1" style="left:10px; top:100px; width:926px; height:180px; ">
			<caption id="caption19" class="list_cap03" style="left:0px; top:144px; width:120px; height:25px; text-align:center; ">매체코드</caption>
			<caption id="caption18" class="list_cap03" style="left:425px; top:15px; width:120px; height:25px; text-align:center; ">행사코드</caption>
			<caption id="caption29" class="list_cap03" style="left:425px; top:58px; width:120px; height:25px; text-align:center; ">거래처코드</caption>
			<caption id="caption17" class="list_cap02" style="left:119px; top:144px; width:271px; height:25px; text-align:center; "/>
			<caption id="caption28" class="list_cap03" style="left:425px; top:101px; width:120px; height:25px; text-align:center; ">부거래처명</caption>
			<caption id="caption16" class="list_cap02" style="left:544px; top:15px; width:266px; height:25px; text-align:center; "/>
			<caption id="caption27" class="list_cap03" style="left:0px; top:58px; width:120px; height:25px; text-align:center; ">수입부서</caption>
			<caption id="caption26" class="list_cap02" style="left:119px; top:58px; width:271px; height:25px; text-align:center; "/>
			<caption id="caption25" class="list_cap02" style="left:544px; top:58px; width:266px; height:25px; text-align:center; "/>
			<caption id="caption24" class="list_cap02" style="left:544px; top:101px; width:266px; height:25px; text-align:center; "/>
			<caption id="caption23" class="list_cap03" style="left:0px; top:15px; width:120px; height:25px; text-align:center; ">예산코드</caption>
			<caption id="caption20" class="list_cap02" style="left:119px; top:15px; width:271px; height:25px; text-align:center; "/>
			<caption id="caption31" class="list_cap03" style="left:0px; top:101px; width:120px; height:25px; text-align:center; ">수입사번</caption>
			<caption id="caption30" class="list_cap02" style="left:119px; top:101px; width:271px; height:25px; text-align:center; "/>
			<input id="budg_cd" ref="/root/resData/resForm/budg_cd" class="req" inputtype="button" caption="예산코드" style="left:124px; top:18px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[

 					//alert(parentWindow.clam_dept_cd.value);
						if(ask_dept_cd.value == "") { show_message("수입부서 선택후 예산코드를 조회하세요"); return ; }
						
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cmpy_cd");
						model.makeNode("/root/reqData/fwdData/G_Tag");
						model.makeNode("/root/reqData/fwdData/G_Caption");
						model.makeNode("/root/reqData/fwdData/G_Codenu");
						model.makeNode("/root/reqData/fwdData/G_BRCode");
						model.makeNode("/root/reqData/fwdData/clas_cd1");

//						set_refvalue("/root/reqData/fwdData/cmpy_cd", get_refvalue("/root/reqData/searchData/cmpy_cd"));
						set_refvalue("/root/reqData/fwdData/cmpy_cd", get_refvalue("/root/initData/session/cmpy_cd"));
						set_refvalue("/root/reqData/fwdData/G_Tag", "21");
						set_refvalue("/root/reqData/fwdData/G_Caption", "부서별예산코드조회");
						set_refvalue("/root/reqData/fwdData/G_Codenu", ask_dept_cd.value);					
						set_refvalue("/root/reqData/fwdData/G_BRCode", "");
						set_refvalue("/root/reqData/fwdData/clas_cd1", "10");

//G_Ymgbcd : job_clsf
//G_Cdgb : cd_clsf

						gstr_popupid = "budg_cd";
					
						window.load("../../mc/co/MC_CO_1000.xrw"
									, "modal"
									, ""
									, "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
								,"/root/reqData/fwdData"
								,"/root/reqData/fwdData"
								)		
						
						budg_cd.dispatch("xforms-value-changed");	

						//if (budg_cd.value.substring(0, 2) >= "61" && budg_cd.value.substring(0, 2) <= "69") { //2012.01.10 
						if (budg_cd.value.substring(0, 2) >= model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_budg_cd_040") 
					          && budg_cd.value.substring(0, 2) <= model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_budg_cd_050")) {		
							show_message("비용예산코드 불가:경리부 문의요2");
							budg_cd.value = "";
							budg_nm.value = "";
							return;
						}
						

						//if (trim(budg_cd.value) == "803504" || trim(budg_cd.value) == "803508" ||
						//    trim(budg_cd.value) == "803501" || trim(budg_cd.value) == "803518" ||  
						//    trim(budg_cd.value) == "803505" || trim(budg_cd.value) == "803529" ||  
					      //     trim(budg_cd.value) == "803530" || trim(budg_cd.value) == "803527" ||  
						//    trim(budg_cd.value) == "803531" || trim(budg_cd.value) == "803532"  ) { //2012.01.10
						var orgStr = model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_budg_cd_010");								
						if(instr_yn(orgStr, trim(budg_cd.value))){								
							       show_message ("개별수입결의등록 에서만 가능한 예산입니다...");
							       budg_cd.value = "";
							       budg_nm.value = "";
						       }
						
						//if ( budg_cd.value.substring(0, 4) != model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_budg_cd_020") 20180730 봉은정수정
						if ( instr_yn( budg_cd.value.substring(0, 4) , model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_budg_cd_020"))
						   && budg_cd.value.substring(0, 4) != model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_budg_cd_030")
						   && budg_cd.value.substring(0, 4) != "" ) {
							       show_message ("이 화면에서 등록이 불가능한 예산입니다...");
							       budg_cd.value = "";
							       budg_nm.value = "";
							       return;
						 }
						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
 
						//if (trim(budg_cd.value) == "803504" || trim(budg_cd.value) == "803508" ||
						//    trim(budg_cd.value) == "803501" || trim(budg_cd.value) == "803518" ||  
						//    trim(budg_cd.value) == "803505" || trim(budg_cd.value) == "803529" ||  
						//    trim(budg_cd.value) == "803530" || trim(budg_cd.value) == "803527" || 
						//    trim(budg_cd.value) == "803531" || trim(budg_cd.value) == "803532"  ) { //2012.01.10
						var orgStr = model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_budg_cd_010");							
						if(instr_yn(orgStr, trim(budg_cd.value))){		
							       show_message("개별수입결의등록 에서만 가능한 예산입니다...");
							       budg_cd.value = "";
							       budg_nm.value = "";
							       return;
						       }

						//if (  budg_cd.value.substring(0, 4) != model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_budg_cd_020") 20180730 봉은정수정
						if ( instr_yn( budg_cd.value.substring(0, 4) , model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_budg_cd_020"))
						   && budg_cd.value.substring(0, 4)  != model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_budg_cd_030")
						   && budg_cd.value.substring(0, 4)  != "" ) {
							       show_message ("이 화면에서 등록이 불가능한 예산입니다...");
							       budg_cd.value = "";
							       budg_nm.value = "";
							       return;
						       }
						
						if (budg_cd.value.substring(0, 2) >= model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_budg_cd_040") 
						  && budg_cd.value.substring(0, 2) <= model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_budg_cd_050")) {
							show_message("비용예산코드 불가:경리부 문의요2");
							budg_cd.value = "";
							budg_nm.value = "";
							return;
						}						       
						/**
							예산코드 값이 변경될 때 예산코드가 6자리이면 실행됨
						*/

						if(get_refvalue("/root/resData/resForm/budg_cd").length == 6 ){
							set_refvalue("/root/reqData/searchData/budg_cd", get_refvalue("/root/resData/resForm/budg_cd")); // 검색조건에 셋팅
							set_refvalue("/root/reqData/searchData/cd", get_refvalue("/root/resData/resForm/budg_cd"));
							set_refvalue("/root/reqData/searchData/cdnm", "");
							set_refvalue("/root/reqData/searchData/dept_cd", ask_dept_cd.value);
	
							model.send("mc_co_1002_l");
							
							if (get_refvalue("/root/resData/resForm2/dataSet/CURLIST/totalcnt") == "0") {
								show_message("사용할 수 없는 예산코드입니다.");
								budg_cd.value = "";
								budg_nm.value = "";
								model.setFocus("budg_cd");
								return;
							}
						
							set_refvalue("/root/resData/resForm/budg_nm", get_refvalue("/root/resData/resForm2/dataSet/CURLIST/record/cdnm"));
							budg_nm.refresh();
						} else {
							budg_cd.value = "";
							budg_nm.value= "";
						}
						
						fun_grid();

					]]>
				</script>
				<script type="javascript" ev:event="onkeyup">
					<![CDATA[
//						set_refvalue("/root/resData/resForm/budg_nm", "");
//						budg_nm.refresh();
					]]>
				</script>
			</input>
			<input id="budg_nm" ref="/root/resData/resForm/budg_nm" editable="false" appearance="input" style="left:230px; top:18px; width:155px; height:18px; border-style:none; "/>
			<input id="ask_emp_no" ref="/root/resData/resForm/ask_emp_no" class="req" inputtype="button" caption="수입사번" style="left:124px; top:104px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						if(ask_emp_no.attribute("editable") != "false"){
							model.removenode("/root/reqData/fwdData/func_nm");  
							model.makeNode("/root/reqData/fwdData/func_nm");
							set_refvalue("/root/reqData/fwdData/func_nm", "setEmp_no");
							window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						}	
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (ask_emp_no.value.length== 6) {
							set_refvalue("/root/reqData/searchData/emp_no", ask_emp_no.value); // 검색조건에 셋팅
							set_refvalue("/root/reqData/searchData/dept_cd", ""); // 검색조건에 셋팅

							model.send("hd_com_1002");
							ask_emp_nm.value = get_refvalue("/root/tempData/record/nm_korn");
						}		
						else {
							ask_emp_no.value   = "";
							ask_emp_nm.value = "";
						}
						]]>
				</script>
			</input>
			<input id="ask_emp_nm" ref="/root/resData/resForm/ask_emp_nm" editable="false" appearance="input" style="left:230px; top:104px; width:155px; height:18px; border-style:none; "/>
			<select1 id="medi_cd" ref="/root/resData/resForm/medi_cd" appearance="minimal" editmode="inputsearch" style="left:124px; top:147px; width:120px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2130_m/dataSet/CURMEDI_CD/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(medi_cd, medi_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(medi_cd,"");
							return;
						}
					]]>
				</script>
			</select1>
			<input id="medi_nm" ref="/root/resData/resForm/medi_nm" visibility="hidden" editable="false" appearance="input" style="left:250px; top:147px; width:135px; height:18px; border-style:none; "/>
			<input id="evnt_cd" ref="/root/resData/resForm/evnt_cd" inputtype="button" style="left:549px; top:18px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					
						model.removeNodeset("/root/reqData/fwdData");  
						
						model.makeNode("/root/reqData/fwdData/cmpy_cd");
						model.makeNode("/root/reqData/fwdData/G_Tag");
						model.makeNode("/root/reqData/fwdData/G_Caption");
						model.makeNode("/root/reqData/fwdData/G_Codenu");
						model.makeNode("/root/reqData/fwdData/G_BRCode");
						
						set_refvalue("/root/reqData/fwdData/cmpy_cd", get_refvalue("/root/initData/session/cmpy_cd"));
						set_refvalue("/root/reqData/fwdData/G_Tag", "16");
						set_refvalue("/root/reqData/fwdData/G_Caption", "행사코드조회");
						set_refvalue("/root/reqData/fwdData/G_Codenu", "");					
						set_refvalue("/root/reqData/fwdData/G_BRCode", "");
						
						gstr_popupid = "evnt_cd";

						window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (evnt_cd.value == "") {
							evnt_nm.value = "";
						}
					]]>
				</script>
			</input>
			<input id="evnt_nm" ref="/root/resData/resForm/evnt_nm" editable="false" appearance="input" style="left:655px; top:18px; width:150px; height:18px; border-style:none; "/>
			<select1 id="dlco_clsf_cd" ref="/root/resData/resForm/dlco_clsf_cd" class="req" appearance="minimal" editmode="inputsearch" caption="거래처코드" style="left:549px; top:61px; width:120px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2130_m/dataSet/CURDLCO_CLSF_CD/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(dlco_clsf_cd, dlco_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(dlco_clsf_cd,"");
							return;
						}					
					]]>
				</script>
			</select1>
			<input id="dlco_cd" ref="/root/resData/resForm/dlco_cd" class="req" inputtype="button" caption="거래처코드" style="left:674px; top:61px; width:131px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						if (dlco_cd.attribute("editable") != "false") {
							gstr_popupid = "dlco_cd";
							open_fc_acct_1180("button","s");	
						}
						fun_grid();
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						gstr_popupid = "dlco_cd";
						open_fc_acct_1180("focus","s");		
						
						fun_grid();
					]]>
				</script>
			</input>
			<input id="dlco_nm" ref="/root/resData/resForm/dlco_nm" class="req" caption="부거래처명" style="left:549px; top:104px; width:160px; height:18px; "/>
			<input id="ask_dept_cd" ref="/root/resData/resForm/ask_dept_cd" class="req" inputtype="button" maxlength="6" caption="수입부서" style="left:124px; top:61px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[					
						if (ask_dept_cd.attribute("editable") != "false") { 			
							var var_con_date = "";

							if (make_dt.value == ""){ 
								var_con_date = commCurDate(); 
							}else { 
								var num_ch = make_dt.value.length;
								if(num_ch == 8){
									var_con_date = make_dt.value;
								}else if(num_ch == 6){
									var_con_date = make_dt.value + "01";
								}else if(num_ch == 4){
									var_con_date = make_dt.value + "0101";
								}else{
									var_con_date = commCurDate(); 
								}
							}
								
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/func_nm");
							model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.setValue("/root/reqData/fwdData/select_ch", "I");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
						}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					
						var var_con_date = "";

						if (make_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = make_dt.value.length;
							if(num_ch == 8){
								var_con_date = make_dt.value;
							}else if(num_ch == 6){
								var_con_date = make_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = make_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (ask_dept_cd.value.length== 6) {
							
							if (ask_dept_cd.value.value == "999999" && strwhco_comn_cost_yn != "Y") {
								if (strwhco_ndstb_cd == "") {
									show_message("사용부서필수, 해당지출건은 전사배부비가 아닙니다.");
								}
							}
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
//							model.setValue("/root/reqData/fwdData/emp_no", "");
							model.setValue("/root/reqData/fwdData/dept_cd", ask_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "I");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								ask_dept_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								ask_dept_cd.value = "";
								ask_dept_nm.value = "";
							}
						}
						else {
							ask_dept_cd.value = "";
							ask_dept_nm.value = "";
						}	
						
						fun_grid();
					
					]]>
				</script>
			</input>
			<input id="ask_dept_nm" ref="/root/resData/resForm/ask_dept_nm" editable="false" appearance="input" style="left:230px; top:61px; width:155px; height:18px; border-style:none; "/>
		</group>
		<group id="group2" style="left:10px; top:279px; width:926px; height:246px; ">
			<caption id="caption1" class="list_cap03" style="left:424px; top:116px; width:120px; height:25px; text-align:center; ">대표자/업태</caption>
			<caption id="caption4" class="list_cap03" style="left:0px; top:159px; width:120px; height:25px; text-align:center; ">종     목</caption>
			<caption id="caption5" class="list_cap03" style="left:424px; top:159px; width:120px; height:25px; text-align:center; ">주     소</caption>
			<caption id="caption6" class="list_cap02" style="left:543px; top:116px; width:271px; height:25px; text-align:center; "/>
			<caption id="caption7" class="list_cap03" style="left:0px; top:202px; width:120px; height:25px; text-align:center; ">환불사유</caption>
			<caption id="caption8" class="list_cap02" style="left:119px; top:159px; width:271px; height:25px; text-align:center; "/>
			<caption id="caption9" class="list_cap03" style="left:0px; top:73px; width:120px; height:25px; text-align:center; ">작성일자</caption>
			<caption id="caption10" class="list_cap02" style="left:119px; top:73px; width:271px; height:25px; text-align:center; "/>
			<caption id="caption11" class="list_cap03" style="left:424px; top:202px; width:120px; height:25px; text-align:center; ">공급/부가세액</caption>
			<caption id="caption12" class="list_cap02" style="left:543px; top:159px; width:271px; height:25px; text-align:center; "/>
			<caption id="caption32" class="list_cap02" style="left:119px; top:202px; width:271px; height:25px; text-align:center; "/>
			<caption id="caption33" class="list_cap03" style="left:0px; top:30px; width:120px; height:25px; text-align:center; ">증빙종류</caption>
			<caption id="caption34" class="list_cap02" style="left:543px; top:202px; width:271px; height:25px; text-align:center; "/>
			<caption id="caption36" class="list_cap02" style="left:119px; top:30px; width:271px; height:25px; text-align:center; "/>
			<caption id="caption37" class="list_cap03" style="left:0px; top:116px; width:120px; height:25px; text-align:center; ">사업자번호</caption>
			<caption id="caption38" class="list_cap02" style="left:119px; top:116px; width:271px; height:25px; text-align:center; "/>
			<input id="make_dt" ref="/root/resData/resForm/make_dt" class="req" inputtype="date" caption="작성일자" style="left:124px; top:76px; width:100px; height:18px; "/>
			<input id="ern_nm" ref="/root/resData/resForm/ern_nm" editable="false" appearance="input" style="left:243px; top:119px; width:140px; height:18px; border-style:none; "/>
			<input id="presi_nm" ref="/root/resData/resForm/presi_nm" editable="false" appearance="input" style="left:548px; top:119px; width:115px; height:18px; border-style:none; "/>
			<input id="ern" ref="/root/resData/resForm/ern" style="left:124px; top:119px; width:115px; height:18px; "/>
			<caption id="subtitle" class="sub_title" style="left:5px; top:6px; width:140px; height:20px; ">세금계산서 사항</caption>
			<caption id="caption13" class="list_cap02" style="left:543px; top:73px; width:271px; height:25px; text-align:center; "/>
			<caption id="caption35" class="list_cap03" style="left:424px; top:30px; width:120px; height:25px; text-align:center; ">전표구분</caption>
			<caption id="caption39" class="list_cap02" style="left:543px; top:30px; width:271px; height:25px; text-align:center; "/>
			<caption id="caption40" class="list_cap03" style="left:424px; top:73px; width:120px; height:25px; text-align:center; ">사업장코드</caption>
			<select1 id="slip_clsf_cd" ref="/root/resData/resForm/slip_clsf_cd" class="req" disabled="true" appearance="minimal" editmode="inputsearch" caption="전표구분" style="left:548px; top:33px; width:140px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2130_m/dataSet/CURSLIP_CLSF/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(slip_clsf_cd, slip_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(slip_clsf_cd,"");
							return;
						}
					]]>
				</script>
			</select1>
			<select1 id="erplace_cd" ref="/root/resData/resForm/erplace_cd" class="req" appearance="minimal" editmode="inputsearch" caption="사업장코드" style="left:548px; top:76px; width:140px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2130_m/dataSet/CURERPALCED_CD/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(erplace_cd, erplace_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(erplace_cd,"");
							return;
						}
					]]>
				</script>
			</select1>
			<select1 id="prof_type_cd" ref="/root/resData/resForm/prof_type_cd" class="req" appearance="minimal" editmode="inputsearch" caption="증빙종류" style="left:124px; top:33px; width:160px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2130_m/dataSet/CURPROF_CD/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(prof_type_cd, prof_type_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(prof_type_cd,"");
							return;
						}
					]]>
				</script>
			</select1>
			<input id="bizcond" ref="/root/resData/resForm/bizcond" editable="false" appearance="input" style="left:667px; top:119px; width:140px; height:18px; border-style:none; "/>
			<input id="item" ref="/root/resData/resForm/item" editable="false" appearance="input" style="left:124px; top:163px; width:259px; height:18px; border-style:none; "/>
			<input id="addr" ref="/root/resData/resForm/addr" editable="false" appearance="input" style="left:548px; top:163px; width:259px; height:18px; border-style:none; "/>
			<input id="item2" ref="/root/resData/resForm/item2" class="req" style="left:124px; top:206px; width:259px; height:18px; "/>
			<input id="suply_amt" ref="/root/resData/resForm/suply_amt" class="req" format="(-)#,###" caption="공급" style="left:548px; top:206px; width:125px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						//if(prof_type_cd.value == "31" || prof_type_cd.value == "32" || prof_type_cd.value == "39"){ //2012.01.10
						var orgStr = model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_prof_type_cd_050");
					
						if(instr_yn(orgStr, prof_type_cd.value)){
							vat_amt.value = Number(suply_amt.value) * 0.1;
							vat_amt.attribute("editable") = "true";
						}
						else{
							vat_amt.value = "";
							vat_amt.attribute("editable") = "true";
						}
					]]>
				</script>
			</input>
			<input id="vat_amt" ref="/root/resData/resForm/vat_amt" format="(-)#,###" caption="부가세액" style="left:677px; top:206px; width:130px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var amt1, amt2;
						//if(prof_type_cd.value == "31" || prof_type_cd.value == "32" || prof_type_cd.value == "39"){ //2012.01.10
						var orgStr = model.getValue("/root/initData/comboSet/fc_acct_2130_m/dataSet/xx_prof_type_cd_050");					
						if(instr_yn(orgStr, prof_type_cd.value)){						
							amt1 = Number(suply_amt.value) * 0.098;
							amt2 = Number(suply_amt.value) * 0.102;							
							
							if(vat_amt.value == ""){
								vat_amt.value = "0";
							}
							if(Number(suply_amt.value) > 0){
								if(Number(vat_amt.value) > amt2 || Number(vat_amt.value) < amt1){
									show_message("부가세 금액을 다시 입력하십시요.");
//									model.setFocus(vat_amt);
								}								
							}
							else{
								if(Number(vat_amt.value) < amt2 || Number(vat_amt.value) > amt1){
									show_message("부가세 금액을 다시 입력하십시요.");
//									model.setFocus(vat_amt);
								}																
							}							
						}
						else{
							vat_amt.value = "";
						}
					]]>
				</script>
			</input>
		</group>
		<group id="group3" style="left:10px; top:524px; width:926px; height:146px; ">
			<caption id="caption53" class="sub_title" style="left:5px; top:6px; width:140px; height:20px; ">입금 사항</caption>
			<datagrid id="datagrid1" nodeset="/root/resData/gridData/fc_acct_2135_s/dataSet/CURLIST/record" caption="입금번호^입금전표번호^세금계산서번호^계산서전표번호^입금금액" colsep="^" colwidth="150, 150, 150, 150, 150" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:0px; top:30px; width:815px; height:114px; ">
				<col ref="rcpm_no" format="99999999-99-9999"/>
				<col ref="rcpm_slip_no" format="99999999-99-999"/>
				<col ref="slip_no" format="99-99999999-9999"/>
				<col ref="occr_slip_no" format="99999999-99-999"/>
				<col ref="rcpm_amt" format="(-)#,###"/>
			</datagrid>
		</group>
		<group id="group4" style="left:10px; top:735px; width:926px; height:21px; ">
			<button id="btn_update" class="btn02" crud="U" style="left:110px; top:0px; width:52px; height:21px; ">
				<caption>수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (send_fc_acct_2133_u()) btn_select.dispatch("onclick");				
					]]>
				</script>
			</button>
			<button id="btn_delete" class="btn02" crud="D" style="left:165px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (send_fc_acct_2134_d()) btn_select.dispatch("onclick");	
					]]>
				</script>
			</button>
			<button id="btn_select" class="btn02" crud="R" style="left:0px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var var_tax_stmt_no = "" , var_slip_clsf_cd ="", var_slip_occr_dt ="",var_slip_seq ="";
					var_tax_stmt_no = get_refvalue("/root/reqData/searchData/tax_stmt_no") ;
					var_slip_clsf_cd = var_tax_stmt_no.substr(0,2);
					var_slip_occr_dt = var_tax_stmt_no.substr(2,8);
					var_slip_seq = var_tax_stmt_no.substr(10,4);

					if(trim(var_tax_stmt_no) == "" ) {
						show_message("세금계산서번호는 필수입니다");
						return false;
					} 
					if(srch_tax_stmt_no.value.substring(0,2) != "30"){
						show_message("세금계산서번호는 처음 두자리를 다시 입력하세요.(30번 가능)");
						return false;						
					}
					
					set_refvalue("/root/reqData/searchData/slip_clsf_cd",var_slip_clsf_cd);
					set_refvalue("/root/reqData/searchData/slip_occr_dt",var_slip_occr_dt);
					set_refvalue("/root/reqData/searchData/slip_seq",var_slip_seq);
					model.send("fc_acct_2131_l");

					if(submit_completed()){
						if(get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/totalcnt") == 0){
							show_message("검색결과가 없습니다.");
							var tax_stmt_no = srch_tax_stmt_no.value
							var slip_no = srch_slip_no.value;
							model.reset();
							srch_tax_stmt_no.value = tax_stmt_no;
							srch_slip_no.value = slip_no;
							return false;
						}
						set_refvalue(ern_nm,get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/dlco_nm"));
						if(get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/slip_no") != "- -"){
							set_refvalue(srch_slip_no,get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/slip_no"));
						}
						gssst = get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/tax_stmt_aprv_yn");
						upcnt = get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/upd_tms");
						
						ask_dept_cd.attribute("editable") = "false";
						ask_emp_no.attribute("editable") = "false";
						prof_type_cd.disabled = true;
						slip_clsf_cd.disabled = true;
								
						if(srch_slip_no.value != ""){
							btn_update.disabled = true;
							btn_delete.disabled = true;
						}
						else{
							btn_update.disabled = false;
							btn_insert.disabled = true;
							btn_delete.disabled = false;
						}
						//세금계산서 상태가 '2'이면 수정, 삭제 불가
						if(get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/tax_stmt_aprv_yn") == "2"){
							erplace_cd.attribute("editable") = "false";
							ern.attribute("editable") = "false";
							item2.attribute("editable") = "false";
							suply_amt.attribute("editable") = "false";
							vat_amt.attribute("editable") = "false";
							dlco_clsf_cd.disabled = true;
							dlco_cd.attribute("editable") = "false";
							
							btn_update.disabled = true;
							btn_insert.disabled = true;
							btn_delete.disabled = true;
						}
						
						set_refvalue("/root/resData/tempData/prev_prof_type_cd",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/prof_type_cd")); 
						set_refvalue("/root/resData/resForm/prof_type_cd",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/prof_type_cd")); 						
						set_refvalue("/root/resData/resForm/slip_clsf_cd",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/slip_clsf_cd"));
						set_refvalue("/root/resData/resForm/make_dt",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/make_dt"));
						set_refvalue("/root/resData/resForm/erplace_cd",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/erplace_cd"));
						set_refvalue("/root/resData/resForm/ern",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/ern"));
						set_refvalue("/root/resData/resForm/presi_nm",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/presi_nm"));
						set_refvalue("/root/resData/resForm/bizcond",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/bizcond"));
						set_refvalue("/root/resData/resForm/item",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/item"));						
						set_refvalue("/root/resData/resForm/addr",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/addr"));
						set_refvalue("/root/resData/resForm/item2",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/item2"));
						set_refvalue("/root/resData/resForm/suply_amt",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/suply_amt"));
						set_refvalue("/root/resData/resForm/vat_amt",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/vat_amt"));
						set_refvalue("/root/resData/resForm/budg_cd",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/budg_cd"));
						set_refvalue("/root/resData/resForm/budg_nm",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/budg_nm"));
						set_refvalue("/root/resData/resForm/ask_dept_cd",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/ask_dept_cd"));
						set_refvalue("/root/resData/resForm/ask_dept_nm",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/ask_dept_nm"));
						set_refvalue("/root/resData/resForm/ask_emp_no",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/ask_emp_no"));
						set_refvalue("/root/resData/resForm/ask_emp_nm",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/ask_emp_nm"));
						set_refvalue("/root/resData/resForm/medi_cd",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/medi_cd"));
						set_refvalue("/root/resData/resForm/medi_nm",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/medi_nm"));
						set_refvalue("/root/resData/resForm/evnt_cd",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/evnt_cd"));
						set_refvalue("/root/resData/resForm/evnt_nm",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/evnt_nm"));
						set_refvalue("/root/resData/resForm/dlco_clsf_cd",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/dlco_clsf_cd"));
						set_refvalue("/root/resData/resForm/dlco_cd",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/dlco_cd"));
						set_refvalue("/root/resData/resForm/dlco_nm",get_refvalue("/root/resData/resForm/fc_acct_2131_l/dataSet/CURLIST/record/dlco_nm"));
					}
					
					fun_grid();
				]]>
				</script>
			</button>
			<button id="btn_tax" class="btn02" crud="R" style="left:275px; top:0px; width:52px; height:21px; ">
				<caption>세금발행</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[

					      model.property("FC_ACCT_2180_srch_prof_type_cd")  = prof_type_cd.value;
					      model.property("FC_ACCT_2180_srch_slip_occr_dt")  = srch_tax_stmt_no.value.substring(2,10);
					      model.property("FC_ACCT_2180_srch_slip_clsf_cd")  = srch_tax_stmt_no.value.substring(0,2);
					      model.property("FC_ACCT_2180_srch_slip_seq_fr")  = srch_tax_stmt_no.value.substring(10,14);
					      model.property("FC_ACCT_2180_srch_slip_seq_to")  =  srch_tax_stmt_no.value.substring(10,14);
					      model.property("FC_ACCT_2180_popup_flag")  = "Y";
						
						// 화면호출
//						viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2180", "modal", "align:center; caption:hidden; width:650px; height:480px;");
//						viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2180");
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2180");
//						viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2180");

					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" crud="C" style="left:55px; top:0px; width:52px; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (send_fc_acct_2132_i()) btn_select.dispatch("onclick");				
					]]>
				</script>
			</button>
			<button id="btn_close" class="btn02" style="left:330px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose();
					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" style="left:220px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.reset();
						ask_dept_cd.attribute("editable") = "true";
						ask_emp_no.attribute("editable") = "true";
						prof_type_cd.disabled = false;
						slip_clsf_cd.disabled = false;
						vat_amt.attribute("editable") = "true";
						
						btn_insert.disabled = false;
						btn_update.disabled = true;
						btn_delete.disabled = true;
					]]>
				</script>
			</button>
		</group>
	</xhtml:body>
</xhtml:html>
