<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>건별상계준비처리(FC_ACCT_4020)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session>
						</session>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
							<fc_acct_4020_m>
								<dataSet>
									<CURLIST4>
										<record>
											<acct_cd/>
											<acct_abrv_nm/>
										</record>
									</CURLIST4>
									<CURLIST3>
										<record>
											<acct_cd/>
											<acct_abrv_nm/>
										</record>
									</CURLIST3>
									<CURLIST2>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURLIST2>
									<CURLIST1>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURLIST1>
									<xx_t_acct_cd/>
									<xx_extnc_acct_cd/>
									<xx_occr_acct_cd1/>
									<xx_occr_acct_cd2/>
									<xx_slip_clsf_cd/>
								</dataSet>
							</fc_acct_4020_m>
							<fc_acct_4027_m>
								<dataSet>
									<CURLIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_4027_m>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData>
							<mang_clsf_cd/>
							<fisc_dt/>
						</fwdData>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<fc_acct_4021_l>
								<occr_acct_cd1/>
								<occr_acct_cd2/>
								<dlco_clsf_cd/>
								<dlco_cd/>
								<extnc_acct_cd/>
								<slip_clsf_cd/>
								<slip_occr_dt/>
								<slip_seq/>
								<slip_sub_seq/>
								<mode/>
								<fr_fisc_dt/>
								<to_fisc_dt/>
							</fc_acct_4021_l>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqform/>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpDate>
							<fc_acct_4023_i>
								<extnc_acct_cd/>
								<setoff_reserv_exne>Y</setoff_reserv_exne>
								<setoff_reserv_dt/>
								<multiUpdateData/>
							</fc_acct_4023_i>
							<fc_acct_4028_i>
								<setoff_acct_cd/>
								<mang_clsf_cd/>
								<in_sicsgb>S</in_sicsgb>
								<fisc_dt/>
								<rmks1/>
								<multiUpdateData/>
							</fc_acct_4028_i>
							<fc_acct_4022_d>
								<multiUpdateData/>
								<extnc_acct_cd/>
								<setoff_exne/>
								<setoff_dt/>
							</fc_acct_4022_d>
							<fc_acct_4029_d>
								<multiUpdateData/>
								<adjm_occr_dt/>
								<adjm_slip_clsf/>
								<adjm_seq/>
								<adjm_sub_seq>0</adjm_sub_seq>
								<in_sicsgb>C</in_sicsgb>
							</fc_acct_4029_d>
						</multiUpDate>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resForm>
							<fc_acct_4028_i>
								<dataSet>
									<CURLIST>
										<record>
											<adjm_slip_occr_dt/>
											<adjm_slip_clsf_cd/>
											<adjm_slip_seq/>
											<adjm_slip_sub_seq/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_4028_i>
						</resForm>
						<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<gridData>
							<fc_acct_4021_l>
								<dataSet>
									<CURLIST1>
										<record>
											<acct_cd/>
											<slip_occr_dt/>
											<slip_clsf_cd/>
											<slip_seq/>
											<slip_sub_seq/>
											<slip_arow_no/>
											<occr_acct_cd/>
											<acctynm/>
											<rmks1/>
											<rmks2/>
											<extnc_acct_cd/>
											<occr_amt/>
											<adjm_amt/>
										</record>
									</CURLIST1>
								</dataSet>
							</fc_acct_4021_l>
						</gridData>
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<keyData/>
						<select>0</select>
						<dlco_cdnm/>
						<all_select/>
						<sh_amt/>
						<checkbox>1 2</checkbox>
						<t_acct_cd/>
						<cntamt/>
						<all_occr_amt/>
					</tempData>
					<!-- 저장소 -->
				</root>
			</instance>
			<submission id="fc_acct_4020_m" action="/fc/acct4000/4020" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/comboSet/fc_acct_4020_m/dataSet"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
				//컨트롤 초기화
				init_controls();
				//그리드 설정
				set_column_visibility();
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					ch_select();
				]]>
			</script>
			<submission id="fc_acct_4027_m" action="/fc/acct4000/4027" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/fc_acct_4021_l/extnc_acct_cd" resultref="/root/initData/comboSet/fc_acct_4027_m/dataSet"/>
			<submission id="fc_acct_4021_l" action="/fc/acct4000/4021" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData/fc_acct_4021_l" resultref="/root/resData/gridData/fc_acct_4021_l/dataSet"/>
			<submission id="fc_acct_4023_i" action="/fc/acct4000/4023" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate/fc_acct_4023_i" resultref="/root/resData/MsgData"/>
			<submission id="fc_acct_4028_i" action="/fc/acct4000/4028" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate/fc_acct_4028_i" resultref="/root/resData/resForm/fc_acct_4028_i/dataSet"/>
			<submission id="fc_acct_4022_d" action="/fc/acct4000/4022" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate/fc_acct_4022_d" resultref="/root/resData/MsgData"/>
			<submission id="fc_acct_4029_d" action="/fc/acct4000/4029" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpDate/fc_acct_4029_d" resultref="/root/resData/MsgData"/>
		</model>
		<script type="javascript" src="../../../js/TFCommon.js"/>
		<script type="javascript" src="../../../js/CIISComm.js"/>
		<script type="javascript" src="../../../js/fcmc_common.js"/>
		<script type="javascript">
			<![CDATA[
			var	_oth_clsf = "1";
			
			//-------------------------------------------------------------------------------
			//	컨트롤의 기본 설정 적용 및 컨트롤 별 포맷 적용
			//-------------------------------------------------------------------------------
			function init_controls() {
				//control의 기본 설정 적용
								
				//datagrid init
				set_default(datagrid1);
				
				datagrid1.attribute("explorerbar") = "";
		
				//combo init
				set_default(t_acct_cd, dlco_clsf_cd, extnc_acct_cd, mang_clsf_cd);
				
				//input init
				set_default(sh_amt, dlco_cdnm, all_occr_amt, slip_clsf_cd, slip_seq, slip_sub_seq, cntamt);
				//input button init
				set_default();
				
				//input date init
				set_default(fr_fisc_dt, to_fisc_dt, fisc_dt, slip_occr_dt);

				//control format 설정 적용
				
				//코드
				set_format(
						"code"						//코드포맷,중간정렬,중간정렬
					,	datagrid1			,"2,3"
					,	dlco_clsf_cd
					,	dlco_cd
					,	dlco_cdnm
					,	slip_clsf_cd
					,	slip_seq
					,	slip_sub_seq
				);
				
				//금액
				set_format(
						"number5"						//숫자포맷,오른쪽정렬,중간정렬,(#,###)
					,	datagrid1			,"5,6"
					,	sh_amt
					,	all_occr_amt
					,	cntamt
				);
				
				//날짜
				set_format(
						"date_1"						//날짜포맷,중간정렬,중간정렬,yyyy-mm-dd
					,	fr_fisc_dt
					,	to_fisc_dt
					,	fisc_dt
					,	slip_occr_dt
				);
				
				//문자열(왼쪽)
				set_format(
						"string_l"						//문자열,왼쪽정렬,중간정렬
					,	datagrid1			,"4,7,8,9"
					,	t_acct_cd
					,	extnc_acct_cd
					,	mang_clsf_cd
				);
				
				datagrid1.removeRow();
				
				//콤보생성
				model.send("fc_acct_4020_m");
				
				makeComboGubun("", "/root/initData/comboSet/fc_acct_4020_m/dataSet/CURLIST1", "record", "cdabrvnm_cd", "cd");
				makeComboGubun("", "/root/initData/comboSet/fc_acct_4020_m/dataSet/CURLIST2", "record", "cdabrvnm_cd", "cd");
				
				//makeComboGubun("", "/root/initData/comboSet/fc_acct_4020_m/dataSet/CURLIST3", "record", "acct_abrv_nm", "acct_cd");
				makeComboGubun("", "/root/initData/comboSet/fc_acct_4020_m/dataSet/CURLIST4", "record", "acct_abrv_nm", "acct_cd");
				
				model.setValue("/root/reqData/searchData/fc_acct_4021_l/occr_acct_cd1", model.getValue("/root/initData/comboSet/fc_acct_4020_m/dataSet/xx_occr_acct_cd1"));
				model.setValue("/root/reqData/searchData/fc_acct_4021_l/occr_acct_cd2", model.getValue("/root/initData/comboSet/fc_acct_4020_m/dataSet/xx_occr_acct_cd2"));
			
			}
			
			function set_column_visibility() {
				//모든 컬럼을 감춘다.
				hide_all_columns(datagrid1);
				//공통항목을 보여준다.
				show_columns(datagrid1,"1,2,3,4,5,6,7,8,9");
			}
			
			function ch_select(){
				var t_ch = select.value;
				if(t_ch != "2"){
					if(t_ch == "0"){		//상계준비
						btn_insert1.disabled = "false";
						btn_insert2.disabled = "true";
						btn_delete2.disabled = "true";
						control_mark_req(extnc_acct_cd);
						control_unmark_req(fisc_dt);
						control_unmark_req(slip_occr_dt);
						control_unmark_req(slip_clsf_cd);
						control_unmark_req(slip_seq);
						control_unmark_req(slip_sub_seq);
					}else{			//준비완료
						btn_insert1.disabled = "true";
						btn_insert2.disabled = "false";
						btn_delete2.disabled = "true";
						//control_mark_req(extnc_acct_cd);
						control_unmark_req(extnc_acct_cd);
						control_mark_req(fisc_dt);
						control_unmark_req(slip_occr_dt);
						control_unmark_req(slip_clsf_cd);
						control_unmark_req(slip_seq);
						control_unmark_req(slip_sub_seq);

						if(extnc_acct_cd.value ==""){
							extnc_acct_cd.value = extnc_acct_cd_ch;
						}

					}
					control_mark_req(dlco_clsf_cd);
					control_mark_req(dlco_cd);
//					control_unmark_req(extnc_acct_cd);
					//if(t_acct_cd.value == "40"){ //2012.01.12
					var orgStr = model.getValue("/root/initData/comboSet/fc_acct_4020_m/dataSet/xx_t_acct_cd");
					//if(t_acct_cd.value == orgStr){		
								
					if(instr_yn(orgStr,t_acct_cd.value)){		
						control_mark_req(fr_fisc_dt);
						control_mark_req(to_fisc_dt);
					}else{
						control_unmark_req(fr_fisc_dt);
						control_unmark_req(to_fisc_dt);
					}
				}else{						//상계취소
					btn_insert1.disabled = "true";
					btn_insert2.disabled = "true";
					btn_delete2.disabled = "false";
					
					control_unmark_req(fr_fisc_dt);
					control_unmark_req(to_fisc_dt);
					control_unmark_req(dlco_clsf_cd);
					control_unmark_req(dlco_cd);				
					control_unmark_req(extnc_acct_cd);
					control_unmark_req(fisc_dt);

					control_mark_req(slip_occr_dt);
					control_mark_req(slip_clsf_cd);
					control_mark_req(slip_seq);
//					control_mark_req(slip_sub_seq);
				}
			}
			
			function send_fc_acct_4021_l(){		
				var t_ch = select.value;
				if(t_ch != "2" && checkbox.value == ""){
					show_message("발생계정은(는) 필수입력항목입니다.");
					return false;
				}
				
				//필수항목체크(검색)
				if(t_ch != "2"){
					if(!checkref(dlco_clsf_cd)){
						return false;
					}
					if(!checkref(dlco_cd)){
						return false;
					}
					if(t_ch == "1"){
						if(!checkref(extnc_acct_cd)){
							return false;
						}
					}
				}
//				if(!commReqCheck(group_scr)) {
//					return false;
//				}
				
				if(t_ch == "0"){
					//if(t_acct_cd.value == "40"){ //2012.01.12
					var orgStr = model.getValue("/root/initData/comboSet/fc_acct_4020_m/dataSet/xx_t_acct_cd");
					//if(instr_yn(orgStr,t_acct_cd.value)){
					if(instr_yn(orgStr,t_acct_cd.value)){	
						extnc_acct_cd.value = "";
					}
				}
				if(t_ch == "0"){
					if(fr_fisc_dt.value == "" && to_fisc_dt.value == ""){
						root.reqData.searchData.fc_acct_4021_l.mode.value = "0";
					}else{
						root.reqData.searchData.fc_acct_4021_l.mode.value = "1";
						root.reqData.searchData.fc_acct_4021_l.slip_clsf_cd.value = t_acct_cd.value;
					}
				}else if(t_ch == "1"){
					if(fr_fisc_dt.value == "" && to_fisc_dt.value == ""){
						root.reqData.searchData.fc_acct_4021_l.mode.value = "2";
					}else{
						root.reqData.searchData.fc_acct_4021_l.mode.value = "3";
						root.reqData.searchData.fc_acct_4021_l.slip_clsf_cd.value = t_acct_cd.value;
					}
				}else if(t_ch == "2"){
					root.reqData.searchData.fc_acct_4021_l.mode.value = "4";
				}
				
				//체크박스리셋
				check_reset();
				
				model.send("fc_acct_4021_l");
				if(root.resData.gridData.fc_acct_4021_l.dataSet.CURLIST1.totalcnt.value==0){
					show_message("검색결과가 없습니다.");
					return false;
				}
				var all_amt = 0;
				for(i = datagrid1.fixedRows ; i <= datagrid1.rows ; i++){
					all_amt = all_amt + Number(model1.getValue("/root/resData/gridData/fc_acct_4021_l/dataSet/CURLIST1/record["+i+"]/occr_amt"));
				}
				set_refvalue(cntamt,all_amt);
			}
			
			function check_reset(){
				var col = datagrid1.fixedCols;
				var rows = datagrid1.rows;
				for( i = datagrid1.fixedRows ; i <= rows ; i++){
					datagrid1.valueMatrix(i,col) = "false";
				}
				srch_all_select.value = "";
			}
			
			//상계계정 값
			var extnc_acct_cd_ch;
			
			function combo_ch(){
				if(extnc_acct_cd.value != ""){
					extnc_acct_cd_ch = extnc_acct_cd.value;
				}
				model.send("fc_acct_4027_m");
				
				makeComboGubun("", "/root/initData/comboSet/fc_acct_4027_m/dataSet/CURLIST", "record", "cdabrvnm_cd", "cd")
			}
			
			function open_fc_acct_1180(p_where,p_mode,p_title,p_readonly) {
				var need_popup = true;
				
				//검색조건이 모두 충족하지 않으면 종료한다.
				if (p_where == "FOCUS" && (dlco_clsf_cd.value.Trim() == "" || dlco_cd.value.Trim() == "")) {
					dlco_cdnm.value	= "";
					return;
				}
				
				p_where = p_where.toUpperCase();
				
				var popid = "fc_acct_1180";
				var subid = "fc_acct_1181_l";

				set_popup_send_data(popid		,"mode"			,p_mode			);
				set_popup_send_data(popid		,"title"			,p_title			);
				set_popup_send_data(popid		,"readonly"		,p_readonly		);
				set_popup_send_data(popid		,"clsf_cd"			,dlco_clsf_cd.value	);
				set_popup_send_data(popid		,"cd_f"			,dlco_cd.value		);
				set_popup_send_data(popid		,"cd_t"			,dlco_cd.value		);
//				set_popup_send_data(popid		,"cd_abrv_nm"		,""		);

				//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
				if (p_where == "FOCUS") {
					//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
					//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
					model.removenode(get_popup_rcvs_ref(popid));
					//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
					model.makeNode(get_popup_rcvs_ref(popid));
					
					//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
					send_submission(
							"auto_" + subid
						,	get_popup_send_ref(popid)
						,	get_popup_rcvs_ref(subid) + "/dataSet"
						,	"/fc/acct1000/1181"
						,	"urlencoded-post"
						,	"application/x-www-form-urlencoded"
					);
					
					totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
			
					if (totalcnt == 1) {
						//데이터가 1건이고 focus out에서 호출한 경우
						//데이터를 설정하고 나간다.

//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
						model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
//						return;
						need_popup = false;
					}
					else if (totalcnt == 0) {
						show_message("[거래처코드]의 검색결과가 없습니다.");
//						return;
						need_popup = false;						
					}
					else {
						//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
						//만약 1건 이상인 경우 popup을 호출해 달라고 하면
						//return을 지우면 됨
						//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
						//return;
						need_popup = true;
					}
				}
				
				//그외 버튼인 경우는 계속 진행
				if (need_popup) {
					open_popup(popid,"640");
				}

				//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
				//다시 조회 하기 쉽도록 하고
				if (get_popup_rcvs_data(popid,"clsf_cd") != "")			dlco_clsf_cd.value		=	get_popup_rcvs_data(popid,"clsf_cd");
				if (get_popup_rcvs_data(popid,"cd") != "")				dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
				//그외의 값은 지워지도록 한다.
				dlco_cdnm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
			}
			
			function ch_value(row,col){
				if(datagrid1.valueMatrix(row,col) == "true"){
					datagrid1.rowStatus(row) = 1;
				}else if(datagrid1.valueMatrix(row,col) == "false"){
					datagrid1.rowStatus(row) = 0;
				}
			}
			
			function unmark_4023(){
				//control_unmark_req(extnc_acct_cd);
				control_unmark_req(mang_clsf_cd);
				control_mark_req(dlco_clsf_cd);
				control_mark_req(dlco_cd);
			}
			
			function send_fc_acct_4023_i(){
				control_mark_req(extnc_acct_cd);
				//if(extnc_acct_cd.value == "0114"){ //2012.01.12
				var orgStr = model.getValue("/root/initData/comboSet/fc_acct_4020_m/dataSet/xx_extnc_acct_cd");
				//if(instr_yn(orgStr,extnc_acct_cd.value)){
				if(instr_yn(orgStr,extnc_acct_cd.value)){	
					control_mark_req(mang_clsf_cd);
				}
				control_unmark_req(dlco_clsf_cd);
				control_unmark_req(dlco_cd);
				
				//필수항목체크(검색)
				if(!commReqCheck(group_scr)) {
					unmark_4023();
					return false;
				}
				
				//변경사항 체크
				if(!datagrid_data_check("datagrid1")){
					show_message("대상이 없습니다.");
					unmark_4023();
					return true;
				}
								
				root.reqData.multiUpDate.fc_acct_4023_i.multiUpdateData.value = datagrid1.getUpdateData();
				root.reqData.multiUpDate.fc_acct_4023_i.extnc_acct_cd.value = extnc_acct_cd.value;
				root.reqData.multiUpDate.fc_acct_4023_i.setoff_reserv_dt.value = commCurDate();
				unmark_4023();
				model.send("fc_acct_4023_i");
				return check_submit_completed("상계준비되었습니다.","");			
			}
			
			function unmark_4028(){
				control_unmark_req(extnc_acct_cd);
				control_unmark_req(mang_clsf_cd);
				control_unmark_req(fisc_dt);
			}
			
			function send_fc_acct_4028_i(){
				//control_mark_req(extnc_acct_cd);
				control_mark_req(fisc_dt);
				//if(extnc_acct_cd.value == "0114"){ //2012.01.12
				var orgStr = model.getValue("/root/initData/comboSet/fc_acct_4020_m/dataSet/xx_extnc_acct_cd");
				if(instr_yn(orgStr,extnc_acct_cd.value)){
					control_mark_req(mang_clsf_cd);
				}
				
				//필수항목체크(검색)
				if(!commReqCheck(group_scr)) {
					unmark_4028();
					return false;
				}
				
				//변경사항 체크
				if(!datagrid_data_check("datagrid1")){
					show_message("대상이 없습니다.");
					unmark_4028();
					return false;
				}
				
				root.reqData.multiUpDate.fc_acct_4028_i.multiUpdateData.value = datagrid1.getUpdateData();
				root.reqData.multiUpDate.fc_acct_4028_i.fisc_dt.value = fisc_dt.value;
				root.reqData.multiUpDate.fc_acct_4028_i.setoff_acct_cd.value = extnc_acct_cd.value;
				root.reqData.multiUpDate.fc_acct_4028_i.mang_clsf_cd.value = mang_clsf_cd.value;
				var rows = datagrid1.rows;
				var rmaks;
				var amt1;
				var amt2;
				
				var orgStr = model.getValue("/root/initData/comboSet/fc_acct_4020_m/dataSet/xx_slip_clsf_cd");
				//if(model.getValue("/root/resData/gridData/fc_acct_4021_l/dataSet/CURLIST1/record/slip_clsf_cd") != "41"){ //2012.01.12
				//if(model.getValue("/root/resData/gridData/fc_acct_4021_l/dataSet/CURLIST1/record/slip_clsf_cd") != orgStr){
				if(! instr_yn(orgStr,model.getValue("/root/resData/gridData/fc_acct_4021_l/dataSet/CURLIST1/record/slip_clsf_cd"))){	
					rmaks = model.getValue("/root/resData/gridData/fc_acct_4021_l/dataSet/CURLIST1/record/rmks1");
				}else{
					rmaks = model.getValue("/root/resData/gridData/fc_acct_4021_l/dataSet/CURLIST1/record/rmks2");
				}
				for( i = datagrid1.fixedRows ; i <= rows ; i++ ){
					amt2 = model.getValue("/root/resData/gridData/fc_acct_4021_l/dataSet/CURLIST1/record["+i+"]/accr_amt");
					if(amt2 > amt1 ){
						amt1 = amt2;
						//if(model.getValue("/root/resData/gridData/fc_acct_4021_l/dataSet/CURLIST1/record["+i+"]/slip_clsf_cd") != "41"){ //2012.01.12
						//if(model.getValue("/root/resData/gridData/fc_acct_4021_l/dataSet/CURLIST1/record["+i+"]/slip_clsf_cd") != orgStr){ 
						if(! instr_yn(orgStr,model.getValue("/root/resData/gridData/fc_acct_4021_l/dataSet/CURLIST1/record["+i+"]/slip_clsf_cd"))){	
							rmaks = model.getValue("/root/resData/gridData/fc_acct_4021_l/dataSet/CURLIST1/record["+i+"]/rmks1");
						}else{
							rmaks = model.getValue("/root/resData/gridData/fc_acct_4021_l/dataSet/CURLIST1/record["+i+"]/rmks2");
						}
					}
				}
				var rmaks_length = rmaks.length;
				if((datagrid1.rows-datagrid1.fixedRows) == 1){
					if(rmaks_length >= 31){
						rmaks = rmaks + " 현금지불";
					}
				}else{
					if(rmaks_length >= 28){
						rmaks = rmaks + " 외 현금지불";
					}
				}
				root.reqData.multiUpDate.fc_acct_4028_i.rmks1.value = rmaks;
				
				if (show_message("개별상계준비-처리하시겠습니까?","처리 확인",MB_YESNO) != IDYES) {
					return false;
				}
				unmark_4028();
//				alert("1");
				model.send("fc_acct_4028_i");
//				alert("2");
				
				if(submit_completed()){
				
					show_message("개별상계준비-처리되었습니다.");
				
					
				
					slip_occr_dt.value = model.getValue("/root/resData/resForm/fc_acct_4028_i/dataSet/CURLIST/record/adjm_slip_occr_dt");
					slip_clsf_cd.value = model.getValue("/root/resData/resForm/fc_acct_4028_i/dataSet/CURLIST/record/adjm_slip_clsf_cd");
					slip_seq.value = model.getValue("/root/resData/resForm/fc_acct_4028_i/dataSet/CURLIST/record/adjm_slip_seq");
					slip_sub_seq.value = model.getValue("/root/resData/resForm/fc_acct_4028_i/dataSet/CURLIST/record/adjm_slip_sub_seq");
				}
				
//				return check_submit_completed("개별상계준비-처리되었습니다.","");
								
			}
			
			function send_fc_acct_4022_d(){
				if(!datagrid_data_check("datagrid1")){
					show_message("대상이 없습니다.");
					return false;
				}
				if (show_message("건별상계준비-상계준비취소하시겠습니까?","취소 확인",MB_YESNO) != IDYES) {
					return false;
				}
				root.reqData.multiUpDate.fc_acct_4022_d.multiUpdateData.value = datagrid1.getUpdateData();
				model.send("fc_acct_4022_d");
				return check_submit_completed("상계준비취소되었습니다.","");			
			}
			
			function send_acct_4029_d(){
				if(!datagrid_data_check("datagrid1")){
					show_message("대상이 없습니다.");
					return false;
				}
				if(slip_occr_dt.value == ""){
					show_message("[발생일자]은(는) 필수입력항목입니다.");
					model.setFocus("slip_occr_dt");
					return false;
				}
				if(slip_occr_dt.value == ""){
					show_message("[전표구분]은(는) 필수입력항목입니다.");
					model.setFocus("slip_clsf_cd");
					return false;
				}
				if(slip_occr_dt.value == ""){
					show_message("[일련번호]은(는) 필수입력항목입니다.");
					model.setFocus("slip_seq");
					return false;
				}
				if (show_message("건별상계준비-상계완료취소하시겠습니까?","취소 확인",MB_YESNO) != IDYES) {
					return false;
				}
				
				var ref_4029 = "/root/reqData/multiUpDate/fc_acct_4029_d/";
				
				set_refvalue(ref_4029 + "multiUpdateData", datagrid1.getUpdateData());
				set_refvalue(ref_4029 + "adjm_occr_dt", slip_occr_dt.value);
				set_refvalue(ref_4029 + "adjm_slip_clsf", slip_clsf_cd.value);
				set_refvalue(ref_4029 + "adjm_seq", slip_seq.value);
				
				model.send("fc_acct_4029_d");
				return check_submit_completed("상계완료취소되었습니다.","");	
				
			}
						
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="1,10;2,10;1,873;1,878;1,934;1,936;2,30;2,39;2,40;2,50;2,705;2,688;2,195;2,186;2,185;2,174;2,170;2,631;" style="font-family:굴림; ">
		<group id="group_scr" class="gro_sel" style="left:10px; top:50px; width:926px; height:126px; ">
			<caption id="caption18" class="list_cap02" style="left:0px; top:100px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption1" class="list_cap02" style="left:440px; top:100px; width:120px; height:26px; text-align:center; "/>
			<caption id="caption16" class="list_cap02" style="left:0px; top:75px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption7" class="list_cap02" style="left:0px; top:50px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption11" class="list_cap02" style="left:0px; top:25px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption9" class="list_cap02" style="left:px; top:0px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption4" class="list_cap02" style="left:0px; top:0px; width:175px; height:126px; text-align:center; "/>
			<caption id="caption8" class="list_cap03" style="left:174px; top:0px; width:120px; height:26px; text-align:center; ">발생계정</caption>
			<caption id="caption10" class="list_cap03" style="left:174px; top:25px; width:120px; height:26px; text-align:center; ">전표구분</caption>
			<select1 id="select" ref="/root/tempData/select" appearance="full" vcellspacing="10" overflow="visible" style="left:53px; top:23px; width:70px; height:85px; border-style:none; ">
				<choices>
					<item>
						<label>상계준비</label>
						<value>0</value>
					</item>
					<item>
						<label>준비완료</label>
						<value>1</value>
					</item>
					<item>
						<label>상계취소</label>
						<value>2</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						ch_select();
					]]>
				</script>
			</select1>
			<select1 id="t_acct_cd" ref="/root/tempData/t_acct_cd" appearance="minimal" editmode="inputsearch" style="left:297px; top:29px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_4020_m/dataSet/CURLIST1/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(t_acct_cd, t_acct_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(t_acct_cd,"");
							return;
						}					
						ch_select();
					]]>
				</script>
			</select1>
			<caption id="caption3" class="list_cap03" style="left:559px; top:0px; width:120px; height:26px; text-align:center; ">회계일자</caption>
			<caption id="caption2" class="list_cap03" style="left:559px; top:25px; width:120px; height:26px; text-align:center; ">상한금액</caption>
			<input id="fr_fisc_dt" ref="/root/reqData/searchData/fc_acct_4021_l/fr_fisc_dt" inputtype="date" maxlength="8" caption="회계일자" style="left:682px; top:4px; width:100px; height:18px; "/>
			<caption id="caption14" class="list_cap03" style="left:174px; top:50px; width:120px; height:26px; text-align:center; ">거래처코드</caption>
			<caption id="caption15" class="list_cap03" style="left:174px; top:75px; width:120px; height:26px; text-align:center; ">상계계정</caption>
			<caption id="caption17" class="list_cap03" style="left:174px; top:100px; width:120px; height:26px; text-align:center; ">관리구분</caption>
			<caption id="caption19" class="list_cap03" style="left:559px; top:75px; width:120px; height:26px; text-align:center; ">상계계정액</caption>
			<caption id="caption21" class="list_cap03" style="left:559px; top:100px; width:120px; height:26px; text-align:center; ">상계전표번호</caption>
			<select id="checkbox" ref="/root/tempData/checkbox" overflow="visible" appearance="full" cellspacing="30" cols="2" caption="발생계정" style="left:297px; top:4px; width:184px; height:18px; border-style:none; ">
				<choices>
					<item>
						<label>외상매입금</label>
						<value>1</value>
					</item>
					<item>
						<label>미지급금</label>
						<value>2</value>
					</item>
				</choices>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if(checkbox.value.indexOf("1") >= 0){
						root.reqData.searchData.fc_acct_4021_l.occr_acct_cd1.value = model.getValue("/root/initData/comboSet/fc_acct_4020_m/dataSet/xx_occr_acct_cd1");
					}else{
						root.reqData.searchData.fc_acct_4021_l.occr_acct_cd1.value = "";
					}
					
					if(checkbox.value.indexOf("2") >= 0){
						root.reqData.searchData.fc_acct_4021_l.occr_acct_cd2.value = model.getValue("/root/initData/comboSet/fc_acct_4020_m/dataSet/xx_occr_acct_cd2");
					}else{
						root.reqData.searchData.fc_acct_4021_l.occr_acct_cd2.value = "";
					}
					]]>
				</script>
			</select>
			<select1 id="dlco_clsf_cd" ref="/root/reqData/searchData/fc_acct_4021_l/dlco_clsf_cd" class="req" appearance="minimal" editmode="inputsearch" caption="거래처구분" style="left:297px; top:54px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_4020_m/dataSet/CURLIST2/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(dlco_clsf_cd, dlco_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(dlco_clsf_cd,"");
							return;
						}
					]]>
				</script>
			</select1>
			<input id="dlco_cd" ref="/root/reqData/searchData/fc_acct_4021_l/dlco_cd" class="req" inputtype="button" caption="거래처코드" style="left:400px; top:54px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					if (open_fc_acct_1180("button","s","","1")) {
						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					}
					else {
						//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if (open_fc_acct_1180("focus","s","","1")) {
						//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
					}
					else {
						//팝업에서 취소 버튼을 누른 경우
					}
					]]>
				</script>
			</input>
			<input id="dlco_cdnm" ref="/root/tempData/dlco_cdnm" editable="false" appearance="input" style="left:503px; top:54px; width:130px; height:18px; text-align:left; border-style:none; "/>
			<select1 id="extnc_acct_cd" ref="/root/reqData/searchData/fc_acct_4021_l/extnc_acct_cd" appearance="minimal" caption="상계계정" style="left:297px; top:79px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_4020_m/dataSet/CURLIST4/record">
						<label ref="acct_abrv_nm"/>
						<value ref="acct_cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					combo_ch();
					]]>
				</script>
			</select1>
			<select1 id="mang_clsf_cd" ref="/root/reqData/fwdData/mang_clsf_cd" appearance="minimal" editmode="inputsearch" caption="관리구분" style="left:297px; top:104px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_4027_m/dataSet/CURLIST/record">
						<label ref="/cdabrvnm_cd"/>
						<value ref="/cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(mang_clsf_cd, mang_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(mang_clsf_cd,"");
							return;
						}
					]]>
				</script>
			</select1>
			<caption id="caption5" class="list_cap03" style="left:440px; top:75px; width:120px; height:26px; text-align:center; ">회계일자</caption>
			<input id="fisc_dt" ref="/root/reqData/fwdData/fisc_dt" inputtype="date" maxlength="8" caption="회계일자" style="left:444px; top:104px; width:100px; height:18px; "/>
			<caption id="caption24" style="left:783px; top:4px; width:15px; height:18px; ">~</caption>
			<input id="to_fisc_dt" ref="/root/reqData/searchData/fc_acct_4021_l/to_fisc_dt" inputtype="date" maxlength="8" caption="회계일자" style="left:798px; top:4px; width:100px; height:18px; "/>
			<input id="all_occr_amt" ref="/root/tempData/all_occr_amt" editable="false" appearance="input" style="left:682px; top:79px; width:130px; height:18px; border-style:none; "/>
			<input id="sh_amt" ref="/root/tempData/sh_amt" appearance="input" style="left:682px; top:29px; width:130px; height:18px; background-color:transparent; border-style:none; "/>
			<input id="slip_occr_dt" ref="/root/reqData/searchData/fc_acct_4021_l/slip_occr_dt" inputtype="date" maxlength="8" caption="상계전표번호" style="left:682px; top:104px; width:100px; height:18px; "/>
			<input id="slip_clsf_cd" ref="/root/reqData/searchData/fc_acct_4021_l/slip_clsf_cd" maxlength="2" caption="상계전표번호" appearance="input" style="left:787px; top:104px; width:35px; height:18px; background-color:transparent; border-style:none; "/>
			<input id="slip_seq" ref="/root/reqData/searchData/fc_acct_4021_l/slip_seq" maxlength="3" caption="상계전표번호" appearance="input" style="left:825px; top:104px; width:35px; height:18px; background-color:transparent; border-style:none; "/>
			<input id="slip_sub_seq" ref="/root/reqData/searchData/fc_acct_4021_l/slip_sub_seq" maxlength="1" caption="상계전표번호" appearance="input" style="left:865px; top:104px; width:15px; height:18px; background-color:transparent; border-style:none; "/>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:180px; width:926px; height:5px; "/>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/fc_acct_4021_l/dataSet/CURLIST1/record" caption="선택^전표번호^계정코드^계정과목명^금액^상계금액^소득구분^적요1^적요2^발생일자^전표구분코드^일련번호^SUB SEQ^행번호" colsep="^" colwidth="28, 160, 62, 140, 95, 91, 63, 139, 175, 100, 100, 100, 100, 100" extendlastcol="scroll" frozencols="2" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:10px; top:217px; width:926px; height:507px; ">
			<col type="checkbox"/>
			<col ref="acct_cd"/>
			<col ref="occr_acct_cd"/>
			<col ref="acctynm"/>
			<col ref="occr_amt"/>
			<col ref="adjm_amt" type="input"/>
			<col ref="incm_clsf_cd" type="input"/>
			<col ref="rmks1"/>
			<col ref="rmks2"/>
			<col ref="slip_occr_dt"/>
			<col ref="slip_clsf_cd"/>
			<col ref="slip_seq"/>
			<col ref="slip_sub_seq"/>
			<col ref="slip_arow_no"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
				var col = datagrid1.col;
				var row = datagrid1.row;
				
//				if(datagrid1.fixedCols = col){
					ch_value(row,1);
//				}
				]]>
			</script>
		</datagrid>
		<group id="group1" class="gro_sel" style="left:0px; top:189px; width:934px; height:26px; ">
			<caption id="caption27" class="list_cap03" style="left:682px; top:0px; width:110px; height:26px; text-align:center; ">합계금액</caption>
			<caption id="caption28" class="list_cap02" style="left:791px; top:0px; width:143px; height:26px; text-align:center; "/>
			<input id="cntamt" ref="/root/tempData/cntamt" editable="false" appearance="input" style="left:796px; top:4px; width:130px; height:18px; border-style:none; "/>
			<select id="srch_all_select" ref="/root/tempData/all_select" overflow="visible" appearance="full" style="left:12px; top:4px; width:72px; height:18px; color:#0000ff; border-style:none; ">
				<choices>
					<item>
						<label>전체선택</label>
						<value>1</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					var all_select;
					var i = datagrid1.fixedRows;
					var rows = datagrid1.rows;
					
					all_select = srch_all_select.value;
					
//					alert(all_select);
					if(all_select == "1"){
						for(i;i<=rows;i++){
							datagrid1.valueMatrix(i,1) = "true";
							ch_value(i,1);
						}
					}else if(all_select != "1"){
						for(i;i<=rows;i++){
							datagrid1.valueMatrix(i,1) = "false";
							ch_value(i,1);
						}
					}
					]]>
				</script>
			</select>
		</group>
		<group id="group_tit" class="gro_tit" style="left:0px; top:0px; width:946px; height:39px; ">
			<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		</group>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:734px; width:926px; height:21px; ">
			<button id="btn_pop2" class="btn02" style="left:445px; top:0px; width:52px; height:21px; ">
				<caption>배서준비</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var slip_no = dlco_clsf_cd.value + dlco_cd.value;
						if(slip_no != ""){
							model.property("FC_FUNC_1060_popup_flag")  = "Y";
							// 화면호출
//							viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FCFfUNC_1060", "modal", "align:center; caption:hidden; width:946px; height:728px;");
							viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_FUNC_1060");
						}					
					]]>
				</script>
			</button>
			<button id="btn_pop3" class="btn02" style="left:500px; top:0px; width:52px; height:21px; ">
				<caption>지급발행</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var slip_no = dlco_clsf_cd.value + dlco_cd.value;
						if(slip_no != ""){
							model.property("FC_FUNC_4010_popup_flag")  = "Y";
							// 화면호출
//							viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_FUNC_4010", "modal", "align:center; caption:hidden; width:946px; height:728px;");
							viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_FUNC_4010");
						}					
					]]>
				</script>
			</button>
			<button id="btn_pop1" class="btn02" style="left:390px; top:0px; width:52px; height:21px; ">
				<caption>배서</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var slip_no = dlco_clsf_cd.value + dlco_cd.value;
						if(slip_no != ""){
							model.property("FC_FUNC_1070_popup_flag")  = "Y";
							// 화면호출
//							viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_FUNC_1070", "modal", "align:center; caption:hidden; width:946px; height:728px;");
							viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_FUNC_1070");							
						}
					]]>
				</script>
			</button>
			<button id="btn_reset" class="btn02" style="left:335px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.reset();
					]]>
				</script>
			</button>
			<button id="btn_delete2" class="btn04" style="left:250px; top:0px; width:80px; height:21px; ">
				<caption>상계완료취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if(send_acct_4029_d()){
						model.reset();
						set_refvalue(select,"1");
					}
					]]>
				</script>
			</button>
			<button id="btn_insert2" class="btn02" style="left:195px; top:0px; width:52px; height:21px; ">
				<caption>현금처리</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_fc_acct_4028_i();



					]]>
				</script>
			</button>
			<button id="button7" class="btn02" style="left:610px; top:0px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
					]]>
				</script>
			</button>
			<button id="btn_close" class="btn02" style="left:665px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose();
					]]>
				</script>
			</button>
			<button id="btn_delete1" class="btn04" style="left:110px; top:0px; width:80px; height:21px; ">
				<caption>상계준비취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_fc_acct_4022_d();
					]]>
				</script>
			</button>
			<button id="btn_insert1" class="btn02" style="left:55px; top:0px; width:52px; height:21px; ">
				<caption>상계준비</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_fc_acct_4023_i();
					]]>
				</script>
			</button>
			<button id="btn_select" class="btn02" style="left:0px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_fc_acct_4021_l();
					]]>
				</script>
			</button>
			<button id="button12" class="btn02" style="left:555px; top:0px; width:52px; height:21px; ">
				<caption>전표발행</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						// 글로벌변수 셋팅
//						model.property("FC_ACCT_2260_slip_occr_dt")  = datagrid1.valueMatrix(datagrid1.row, 2).substring(0, 8);			// 발생일자
//						model.property("FC_ACCT_2260_slip_clsf_cd")  = datagrid1.valueMatrix(datagrid1.row, 2).substring(9, 11);			// 전표구분
//						model.property("FC_ACCT_2260_slip_seqfr") = datagrid1.valueMatrix(datagrid1.row, 2).substring(12, 15);			// 일련번호 from
//						model.property("FC_ACCT_2260_slip_seqto") = datagrid1.valueMatrix(datagrid1.row, 2).substring(12, 15);			// 일련번호 to
						
						model.property("FC_ACCT_2260_slip_occr_dt")  = slip_occr_dt.value		// 발생일자
						model.property("FC_ACCT_2260_slip_clsf_cd")  = slip_clsf_cd.value;		// 전표구분
						model.property("FC_ACCT_2260_slip_seqfr") = slip_seq.value;			// 일련번호 from
						model.property("FC_ACCT_2260_slip_seqto") = slip_seq.value;			// 일련번호 to												
						model.property("FC_ACCT_2260_slip_radio1") = "";			// 출력구분
						model.property("FC_ACCT_2260_popup_flag") ="Y";
						
						// 화면호출
//						viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2260", "modal", "align:center; caption:hidden; width:650px; height:480px;");
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2260");
					]]>
				</script>
			</button>
		</group>
	</xhtml:body>
</xhtml:html>
