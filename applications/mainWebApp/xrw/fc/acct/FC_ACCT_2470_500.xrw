<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet type="text/css" href="../../../css/style_sheet.css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>전표건별조회(FC_ACCT_2470)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session/>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
							<dataSet>
								<SLIP_CLSF_CD1>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</SLIP_CLSF_CD1>
								<SLIP_CLSF_CD2>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</SLIP_CLSF_CD2>
							</dataSet>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<slip_sub_seq/>
						</fwdData>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<kind/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<slip_sub_seq/>
							<fisc_occr_dt/>
							<fisc_clsf_cd/>
							<fisc_seq/>
							<fisc_sub_seq/>
							<rmks1/>
							<slip_occr_dt1/>
							<slip_clsf_cd1/>
							<slip_seq1/>
							<slip_sub_seq1/>
							<slip_arow_no/>
							<title/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqform/>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpdate>
							<multiUpdateData/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<slip_sub_seq/>
							<rmks1/>
							<pch_x>U</pch_x>
						</multiUpdate>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resform>
							<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
							<dataSet>
								<CURLIST>
									<record>
										<acct_cd/>
										<acct_nm/>
										<dlco_clsf_cd/>
										<dlco_cd/>
										<dlco_nm/>
										<boks_dlco_nm/>
										<medi_cd/>
										<medi_nm/>
										<mang_no/>
										<mang_clsf_cd/>
										<mang_clsf_nm/>
										<bank_cd/>
										<bank_nm/>
										<comp_dt/>
										<mtry_dt/>
										<unit/>
										<qunt/>
										<use_dept_cd/>
										<use_dept_nm/>
										<obj_acct_cd/>
										<obj_acct_nm/>
										<obj_amt/>
										<note_stat/>
										<note_stat_nm/>
										<frcr_clsf_cd/>
										<exrate/>
										<frcr_amt/>
										<obj_dt/>
										<dtls_medi_cd/>
										<evnt_cd/>
										<prop_equip_cd/>
										<incmg_dt/>
										<intg_dlco_cd/>
										<dtls_medi_nm/>
										<evnt_nm/>
										<dtls_medi_cdnm/>
									</record>
								</CURLIST>
							</dataSet>
							<budg_yymm/>
							<clam_dept_cd/>
							<clam_dept_nm/>
							<chrg_emp_no/>
							<chrg_emp_nm/>
							<dept_nm/>
							<fisc_dt/>
							<incmg_dt/>
							<tot_dr_amt/>
							<tot_crdt_amt/>
							<chnl_clsf_cd/>
						</resform>
						<gridData>
							<fc_acct_2471_l>
								<dataSet>
									<CURLIST>
										<record>
											<x/>
											<slip_arow_no/>
											<budg_cd/>
											<budg_nm/>
											<dr_amt/>
											<crdt_amt/>
											<rmks1/>
											<rmks2/>
											<boks_dlco_nm/>
											<use_dept_cd/>
											<prop_equip_cd/>
											<medi_cd/>
											<medi_nm/>
											<dtls_medi_cd/>
											<budg_yymm/>
											<clam_dept_cd/>
											<clam_dept_nm/>
											<chrg_emp_no/>
											<chrg_emp_nm/>
											<dept_nm/>
											<fisc_dt/>
											<incmg_dt/>
											<slip_occr_dt/>
											<slip_clsf_cd/>
											<slip_seq/>
											<slip_sub_seq/>
											<fisc_seq/>
											<chnl_clsf_cd/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_2471_l>
						</gridData>
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<keyData/>
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
					</tempData>
					<!-- 저장소 -->
				</root>
			</instance>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					
					send_fc_acct_2470_m();
					if (model.property("FC_ACCT_2470_popup_flag") == "Y" ) {

						srch_slip_occr_dt.value = model.property("FC_ACCT_2470_srch_slip_occr_dt");
						srch_slip_clsf_cd.value = model.property("FC_ACCT_2470_srch_slip_clsf_cd");
						srch_slip_seq.value = model.property("FC_ACCT_2470_srch_slip_seq");
						srch_slip_sub_seq.value = model.property("FC_ACCT_2470_srch_slip_sub_seq");
						
						model.property("FC_ACCT_2470_srch_slip_occr_dt")  = "";
						model.property("FC_ACCT_2470_srch_slip_clsf_cd") = "";
						model.property("FC_ACCT_2470_srch_slip_seq") = "";
						model.property("FC_ACCT_2470_srch_slip_sub_seq") = "";
						model.property("FC_ACCT_2470_popup_flag") = "";
						
						btn_select.dispatch("onclick");
					}
					else{
						get_popup_data();
						srch_slip_sub_seq.value = "0";
					}
					
					srch_fisc_sub_seq.value = "0";					
					model.refresh();
				]]>
			</script>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<script type="javascript" src="/js/fcmc_common.js"/>
			<submission id="fc_acct_2470_m" action="/fc/acct2000/2470" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/comboSet/dataSet"/>
			<submission id="fc_acct_2471_l" action="/fc/acct2000/2471" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/fc_acct_2471_l/dataSet"/>
			<submission id="fc_acct_2472_u" action="/fc/acct2000/2472" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiUpdate" resultref="/root/resData/MsgData/dataSet"/>
			<submission id="fc_acct_2473_s" action="/fc/acct2000/2473" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resform/dataSet"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					init_controls();
				]]>
			</script>
		</model>
		<script type="javascript">
			<![CDATA[
				var	_oth_clsf = "1";
				
				var popid = "fc_acct_2470";
				var is_popup = false;
				//자동으로 폼 로드시 검색을 시작한다.
				var is_autosearch = false;
				//검색의 결과가 1건이라면 결과값을 자동 반환한다.
				var is_autoclose = false;
				//윈도우의 원래 위치 저장
				var leftpx = 0;
				var toppx = 0;
				//자동검색시 검색을 종료하고 조건값을 삭제 할지 여부
				var g_is_autoreset = false;				
				
				function init_controls(){
					set_default(datagrid1);							//datagrid
				}						
				function send_fc_acct_2470_m(){
					if(model.getValue("/root/reqData/fwdData/G_Tag") == "1"){
						model.send("fc_acct_2470_m");
						makeComboGubun("","/root/initData/comboSet/dataSet/SLIP_CLSF_CD1","record","cd_nm", "cd");
						makeComboGubun("","/root/initData/comboSet/dataSet/SLIP_CLSF_CD2","record","cd_nm", "cd");						
						
						model.setValue("/root/reqData/searchData/slip_occr_dt", model.getValue("/root/reqData/fwdData/slip_occr_dt"));
						model.setValue("/root/reqData/searchData/slip_clsf_cd", model.getValue("/root/reqData/fwdData/slip_clsf_cd"));
						model.setValue("/root/reqData/searchData/slip_seq", model.getValue("/root/reqData/fwdData/slip_seq"));
						model.setValue("/root/reqData/searchData/slip_sub_seq", model.getValue("/root/reqData/fwdData/slip_sub_seq"));
						model.setValue("/root/reqData/searchData/kind","1");
						group_scr.refresh();

						btn_select.dispatch("onclick");
						datagrid1.refresh();
					}
					model.setValue("/root/reqData/searchData/kind","1");
					srch_kind.refresh();
					srch_kind.dispatch("onclick");
					model.send("fc_acct_2470_m");
					makeComboGubun("","/root/initData/comboSet/dataSet/SLIP_CLSF_CD1","record","cd_nm", "cd");
					makeComboGubun("","/root/initData/comboSet/dataSet/SLIP_CLSF_CD2","record","cd_nm", "cd");
				}		
				function send_fc_acct_2471_l(){
					var slip_occr_dt;
					var slip_clsf_cd
					var slip_seq;
					var slip_sub_seq;
					var tot_dr = 0;
					var tot_crdt = 0;
					
					//현업전표 조회
					if(model.getValue("/root/reqData/searchData/kind") == "1"){
						if(model.getValue("/root/reqData/searchData/slip_occr_dt") == "" || model.getValue("/root/reqData/searchData/slip_occr_dt").length != 8){
							show_message("발생일자 필수입력 항목이 입력되지 않았습니다.");
							model.setFocus("srch_slip_occr_dt");
							return;
						}
						if(model.getValue("/root/reqData/searchData/slip_clsf_cd") == "" || model.getValue("/root/reqData/searchData/slip_clsf_cd").length != 2){
							show_message("전표구분코드 필수입력 항목이 입력되지 않았습니다.");
							model.setFocus("srch_slip_clsf_cd");
							return;
						}
						if(model.getValue("/root/reqData/searchData/slip_seq") == "" || model.getValue("/root/reqData/searchData/slip_seq").length != 3){
							show_message("일련번호 필수입력 항목이 입력되지 않았습니다.");
							model.setFocus("srch_slip_seq");
							return;
						}
						if(model.getValue("/root/reqData/searchData/slip_seq") == "" || model.getValue("/root/reqData/searchData/slip_seq").length != 3){
							show_message("일련번호 필수입력 항목이 입력되지 않았습니다.");
							model.setFocus("srch_slip_seq");
							return;
						}
						if(model.getValue("/root/reqData/searchData/slip_sub_seq") == "" || model.getValue("/root/reqData/searchData/slip_sub_seq").length != 1){
							show_message("SUBSEQ 필수입력 항목이 입력되지 않았습니다.");
							model.setFocus("srch_slip_sub_seq");
							return;
						}
						
						slip_occr_dt = model.getValue("/root/reqData/searchData/slip_occr_dt");
						slip_clsf_cd = model.getValue("/root/reqData/searchData/slip_clsf_cd");
						slip_seq = model.getValue("/root/reqData/searchData/slip_seq");
						slip_sub_seq = model.getValue("/root/reqData/searchData/slip_sub_seq");
						
					}
					else if(model.getValue("/root/reqData/searchData/kind") == "2"){
						if(model.getValue("/root/reqData/searchData/fisc_occr_dt") == "" || model.getValue("/root/reqData/searchData/fisc_occr_dt").length != 8){
							show_message("발생일자 필수입력 항목이 입력되지 않았습니다.");
							model.setFocus("srch_fisc_occr_dt");
							return;
						}
						if(model.getValue("/root/reqData/searchData/fisc_clsf_cd") == "" || model.getValue("/root/reqData/searchData/fisc_clsf_cd").length != 2){
							show_message("전표구분코드 필수입력 항목이 입력되지 않았습니다.");
							model.setFocus("srch_fisc_clsf_cd");
							return;
						}
						if(model.getValue("/root/reqData/searchData/fisc_seq") == "" || model.getValue("/root/reqData/searchData/fisc_seq").length != 3){
							show_message("일련번호 필수입력 항목이 입력되지 않았습니다.");
							model.setFocus("srch_fisc_seq");
							return;
						}
						if(model.getValue("/root/reqData/searchData/fisc_seq") == "" || model.getValue("/root/reqData/searchData/fisc_seq").length != 3){
							show_message("일련번호 필수입력 항목이 입력되지 않았습니다.");
							model.setFocus("srch_fisc_seq");
							return;
						}
						if(model.getValue("/root/reqData/searchData/fisc_sub_seq") == "" || model.getValue("/root/reqData/searchData/fisc_sub_seq").length != 1){
							show_message("SUBSEQ 필수입력 항목이 입력되지 않았습니다.");
							model.setFocus("srch_fisc_sub_seq");
							return;
						}

						slip_occr_dt = model.getValue("/root/reqData/searchData/fisc_occr_dt");
						slip_clsf_cd = model.getValue("/root/reqData/searchData/fisc_clsf_cd");
						slip_seq = model.getValue("/root/reqData/searchData/fisc_seq");
						slip_sub_seq = model.getValue("/root/reqData/searchData/fisc_sub_seq");
					}
					if(slip_sub_seq == ""){
						slip_sub_seq = "0";
					}
					model.setValue("/root/reqData/searchData/slip_occr_dt1",slip_occr_dt);
					model.setValue("/root/reqData/searchData/slip_clsf_cd1",slip_clsf_cd);
					model.setValue("/root/reqData/searchData/slip_seq1",slip_seq);
					model.setValue("/root/reqData/searchData/slip_sub_seq1",slip_sub_seq);
					
					model.send("fc_acct_2471_l");
				
					if(model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/totalcnt") == "0"){
						
						if(model.getValue("/root/reqData/searchData/kind") == "2"){
							model.setValue("/root/reqData/searchData/slip_occr_dt", "");
							model.setValue("/root/reqData/searchData/slip_clsf_cd", "");
							model.setValue("/root/reqData/searchData/slip_seq", "");
							model.setValue("/root/reqData/searchData/slip_sub_seq", "");
						}
						else if(model.getValue("/root/reqData/searchData/kind") == "1"){
							model.setValue("/root/reqData/searchData/fisc_occr_dt", "");
							model.setValue("/root/reqData/searchData/fisc_clsf_cd", "");
							model.setValue("/root/reqData/searchData/fisc_seq", "");
							model.setValue("/root/reqData/searchData/fisc_sub_seq", "");
						}
						
						model.setValue("/root/reqData/searchData/rmks1", "");
						model.setValue("/root/resData/resform/budg_yymm", "");
						model.setValue("/root/resData/resform/clam_dept_cd", "");
						model.setValue("/root/resData/resform/clam_dept_nm", "");
						model.setValue("/root/resData/resform/chrg_emp_no", "");
						model.setValue("/root/resData/resform/chrg_emp_nm", "");
						model.setValue("/root/resData/resform/dept_nm", "");
						model.setValue("/root/resData/resform/chnl_clsf_cd", "");
						
						datagrid1.refresh();
						model.setValue("/root/resData/resform/fisc_dt","");
						model.setValue("/root/resData/resform/incmg_dt","");
						model.setValue("/root/resData/resform/tot_dr_amt","");
						model.setValue("/root/resData/resform/tot_crdt_amt","");
						
						group_scr.refresh();

						commGroupInit(group2);
						group2.refresh();						
						group3.refresh();
						return;
					}			
					for(i=1; i <datagrid1.rows;i++){
						tot_dr = tot_dr + Number(model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+i+"]/dr_amt"));
						tot_crdt = tot_crdt + Number(model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+i+"]/crdt_amt"));
					}						
											
					model.setValue("/root/resData/resform/fisc_dt",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/fisc_dt"));
					model.setValue("/root/resData/resform/incmg_dt",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/incmg_dt"));
					model.setValue("/root/resData/resform/tot_dr_amt",tot_dr);
					model.setValue("/root/resData/resform/tot_crdt_amt",tot_crdt);
					group3.refresh();
					
					model.setValue("/root/resData/resform/budg_yymm",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/budg_yymm"));
					model.setValue("/root/resData/resform/clam_dept_cd",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/clam_dept_cd"));
					model.setValue("/root/resData/resform/clam_dept_nm",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/clam_dept_nm"));
					model.setValue("/root/resData/resform/chrg_emp_no",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/chrg_emp_no"));
					model.setValue("/root/resData/resform/chrg_emp_nm",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/chrg_emp_nm"));
					model.setValue("/root/resData/resform/dept_nm",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/dept_nm"));
					model.setValue("/root/reqData/searchData/rmks1",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/rmks1"));
					model.setValue("/root/resData/resform/chnl_clsf_cd",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/chnl_clsf_cd"));
					
					
					if(model.getValue("/root/reqData/searchData/kind") == "2"){
						model.setValue("/root/reqData/searchData/slip_occr_dt",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/slip_occr_dt"));
						model.setValue("/root/reqData/searchData/slip_clsf_cd",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/slip_clsf_cd"));
						model.setValue("/root/reqData/searchData/slip_seq",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/slip_seq"));
						model.setValue("/root/reqData/searchData/slip_sub_seq",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/slip_sub_seq"));
					}
					else if(model.getValue("/root/reqData/searchData/kind") == "1"){
						model.setValue("/root/reqData/searchData/fisc_occr_dt",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/incmg_dt"));
						model.setValue("/root/reqData/searchData/fisc_clsf_cd",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/slip_clsf_cd"));
						model.setValue("/root/reqData/searchData/fisc_seq",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/fisc_seq"));
						model.setValue("/root/reqData/searchData/fisc_sub_seq",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record[1]/slip_sub_seq"));
					}
					group_scr.refresh();
					// Group2 초기화.
					commGroupInit(group2);
					group2.refresh();
				}
				function send_fc_acct_2472_u(){
					//Null 체크
//						 Cmndll.GF_NullCheck Me
					var cnt = 0;
					model.setValue("/root/reqData/multiUpdate/multiUpdateData", datagrid1.getUpdateData());
					model.setValue("/root/reqData/multiUpdate/slip_occr_dt", model.getValue("/root/reqData/searchData/slip_occr_dt"));
					model.setValue("/root/reqData/multiUpdate/slip_clsf_cd", model.getValue("/root/reqData/searchData/slip_clsf_cd"));
					model.setValue("/root/reqData/multiUpdate/slip_seq", model.getValue("/root/reqData/searchData/slip_seq"));
					model.setValue("/root/reqData/multiUpdate/slip_sub_seq", model.getValue("/root/reqData/searchData/slip_sub_seq"));
					model.setValue("/root/reqData/multiUpdate/rmks1", model.getValue("/root/reqData/searchData/rmks1"));												
					
					for(i=1; i<datagrid1.rows;i++){
						if(datagrid1.rowStatus(i) == "2" ){
							cnt = cnt+1;
						}
					}
					if(cnt == 0){
						show_message("처리할 자료가 없습니다.");
						return;
					}

					if(show_message("수정하시겠습니까?", "수정 확인", 4)  == 7){									
						return;
					}	
					
					datagrid1.gridToInstance();

					model.send("fc_acct_2472_u");		
					
					show_message("수정되었습니다.");
					datagrid1.refresh();			
					btn_select.dispatch("onclick");
					datagrid1.refresh();								
				}
				function detailList(){
					var i = datagrid1.row;
					var slip_arow_no = model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+i+"]/slip_arow_no");

					model.setValue("/root/reqData/searchData/slip_arow_no",slip_arow_no);
					
					commGroupInit(group2);
					model.send("fc_acct_2473_s");
					
					group2.refresh();										
				}
			function get_popup_data() {
				var mode = "";
				var title = "";
				var readonly = "0";
				value_list = get_popup_send_property(popid);
				//현재 폼이 팝업용으로 열린 경우 처리
				//일반 폼으로도 사용하고 팝업용으로도 사용하는 폼의 경우
				//구분이 필요한데 opener로 판별 할 수 없기 때문에
				//폼 로딩시 특정 이름의 프로퍼티가 있는지 확인해서 처리 하는 시점에서
				//is_popup을 true로 설정해서 사용하도록 한다.
				is_popup = false;
				is_autosearch = false;
				is_autoclose = false;
				
				if (value_list != "") {
					is_popup = true;

					set_popup_min(!is_popup);
					set_popup_max(!is_popup);
					set_popup_close(!is_popup);
					
					save_value_list("/root/reqData/searchData",value_list);
					
					mode	=	model.getValue("/root/reqData/searchData/mode").Trim().toUpperCase();
					title		=	model.getValue("/root/reqData/searchData/title").Trim();
					readonly	=	model.getValue("/root/reqData/searchData/readonly").Trim();
					datafilter	=	model.getValue("/root/reqData/searchData/datafilter").Trim();
					
					//필터 문자가 전달된 경우 해당 datagrid의 nodeset에 추가
					if (datafilter != "") {
						//datagrid1.nodeset = datagrid1.nodeset + datafilter;
					}

					//여기서부터는 현재 폼에서만 필요한 코드
					
					//읽기모드의 설정은 폼 단위 개별 설정이고
					//상황에 따라 호출하는 폼에서 넘긴 데이터를 수정하지 못하도록 설정하기 위한 옵션
					if (readonly == "0") {
						//읽기모드가 "0" 인 경우 처리
						//읽기모드가 "0" 이면 읽기 전용으로 설정할 컨트롤이 없다고 가정하자.
					}
					else if (readonly == "1") {
						//읽기모드가 "1" 인 경우 처리
					}
					else if (readonly == "2") {
						//읽기모드가 "2" 인 경우 처리
					}
					else if (readonly == "3") {
						//읽기모드가 "2" 인 경우 처리
					}
					//여기까지가 현재 폼에서만 필요한 코드

					if (mode.indexOf("S") >= 0) {
						is_autosearch = true;
					}
					if (mode.indexOf("C") >= 0) {
						is_autoclose = true;
//						leftpx = window.left;
//						toppx = window.top;
//						window.left = -2000;
//						window.top = -2000;
					}
					//Reset
					//자동검색인 경우에 한해서 검색후 조회용 값을 삭제할지 여부
					if (mode.indexOf("R") >= 0) {
						g_is_autoreset = true;
					}

					//그냥 팝업만 띄워달란다 -_- 바꾼다.
					g_is_autosearch = false;
					set_refvalue(srch_slip_occr_dt,get_refvalue("/root/reqData/searchData/slip_occr_dt").Trim());
					set_refvalue(srch_slip_clsf_cd,get_refvalue("/root/reqData/searchData/slip_clsf_cd").Trim());
					set_refvalue(srch_slip_seq,get_refvalue("/root/reqData/searchData/slip_seq").Trim());
					set_refvalue(srch_slip_sub_seq,get_refvalue("/root/reqData/searchData/slip_sub_seq").Trim());
					
					btn_select.dispatch("onclick");

				}
				else {
					//팝업 모드가 아닌 경우
					
					//닫기버튼을 비활성화시킨다.
				}
				

			}				
						
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="2,34;2,39;2,40;2,50;2,70;2,78;2,80;2,104;2,105;2,112;2,113;2,117;2,118;2,132;2,133;2,157;2,158;2,366;2,377;2,376;2,393;2,408;2,409;1,936;1,927;1,926;1,459;1,449;2,718;1,716;">
		<group id="group_line" class="gro_line" style="left:10px; top:160px; width:926px; height:5px; "/>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:733px; width:926px; height:21px; ">
			<button id="btnReset" class="btn02" style="left:165px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.reset();		
					]]>
				</script>
			</button>
			<button id="btn_update" class="btn02" crud="U" style="left:55px; top:0px; width:52px; height:21px; ">
				<caption>수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_fc_acct_2472_u();
					]]>
				</script>
			</button>
			<button id="btn_select" class="btn02" crud="R" style="left:0px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_fc_acct_2471_l();
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" crud="R" style="left:220px; top:0px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
					]]>
				</script>
			</button>
			<button id="btn_print_slip" class="btn02" style="left:110px; top:0px; width:52px; height:21px; ">
				<caption>전표발행</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						// 글로벌변수 셋팅
						model.property("FC_ACCT_2260_slip_occr_dt")  = srch_slip_occr_dt.value		// 발생일자
						model.property("FC_ACCT_2260_slip_clsf_cd")  = srch_slip_clsf_cd.value		// 전표구분
						model.property("FC_ACCT_2260_slip_seqfr") = srch_slip_seq.value;			// 일련번호 from
						model.property("FC_ACCT_2260_slip_seqto") = srch_slip_seq.value			// 일련번호 to
						model.property("FC_ACCT_2260_slip_radio1") = "";						// 출력구분
						model.property("FC_ACCT_2260_popup_flag") =	"Y";
						
						// 화면호출
//						viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2260", "modal", "align:center; caption:hidden; width:650px; height:480px;");
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2260");	
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:275px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose();
					]]>
				</script>
			</button>
		</group>
		<group id="group_scr" class="gro_sel" style="left:10px; top:50px; width:926px; height:101px; ">
			<caption id="caption2" class="list_cap02" style="left:168px; top:75px; width:758px; height:26px; "/>
			<caption id="caption17" class="list_cap02" style="left:168px; top:50px; width:758px; height:26px; "/>
			<caption id="caption3" class="list_cap02_100_2" style="left:0px; top:0px; width:100px; height:101px; "/>
			<caption id="caption18" class="list_cap02" style="left:168px; top:0px; width:758px; height:26px; "/>
			<caption id="caption4" class="list_cap03_100_2" style="left:0px; top:48px; width:100px; height:49px; "/>
			<caption id="caption1" class="list_cap03_110" style="left:59px; top:0px; width:110px; height:26px; ">전표번호</caption>
			<caption id="caption5" class="list_cap03" style="left:59px; top:25px; width:110px; height:26px; ">분개전표번호</caption>
			<caption id="caption6" class="list_cap02" style="left:168px; top:25px; width:758px; height:26px; "/>
			<caption id="caption7" class="list_cap03" style="left:467px; top:75px; width:110px; height:26px; ">담당자</caption>
			<caption id="caption9" class="list_cap03" style="left:467px; top:25px; width:110px; height:26px; ">예산년월</caption>
			<caption id="caption14" class="list_cap03" style="left:467px; top:50px; width:110px; height:26px; ">청구부서</caption>
			<caption id="caption20" class="list_cap03" style="left:59px; top:75px; width:110px; height:26px; ">제목</caption>
			<caption id="caption16" class="list_cap03" style="left:59px; top:50px; width:110px; height:26px; ">채널구분</caption>
			<caption id="caption22" style="left:470px; top:4px; width:218px; height:18px; font-weight:bold; ">(발생일자-전표구분-일련번호-SUB)</caption>
			<input id="srch_rmks1" ref="/root/reqData/searchData/rmks1" class="input_250" navindex="10" style="left:174px; top:79px; width:250px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						for(i=1; i<datagrid1.rows; i++){
							model.setValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+i+"]/rmks1",model.getValue("/root/reqData/searchData/rmks1"));
							datagrid1.addStatus(i,"update");
						}
						datagrid1.refresh();
						
					]]>
				</script>
			</input>
			<input id="srch_slip_occr_dt" ref="/root/reqData/searchData/slip_occr_dt" class="req" navindex="2" inputtype="date" maxlength="8" format="yyyy-mm-dd" style="left:174px; top:4px; width:100px; height:18px; "/>
			<select1 id="srch_slip_clsf_cd" ref="/root/reqData/searchData/slip_clsf_cd" class="req" navindex="3" appearance="minimal" editmode="inputsearch" itemcount="8" style="left:279px; top:4px; width:120px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/SLIP_CLSF_CD1/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
//						var var_check_flag = "false";
//					
//						for (i=1;i<=Number(model.getValue("/root/initData/comboSet/dataSet/SLIP_CLSF_CD2/totalcnt"));i++) {
//							if (model.getValue("/root/initData/comboSet/dataSet/SLIP_CLSF_CD2/record[" + i + "]/cd") == model.getValue("/root/reqData/searchData/slip_clsf_cd")) {
//								var_check_flag = "true";
//							}
//						}
//
//						if (var_check_flag = "false") {
//							model.setValue("/root/reqData/searchData/slip_clsf_cd", "");
//						} 
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(srch_slip_clsf_cd, srch_slip_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(srch_slip_clsf_cd,"");
							return;
						}
					]]>
				</script>
			</select1>
			<input id="srch_fisc_occr_dt" ref="/root/reqData/searchData/fisc_occr_dt" class="req" navindex="6" inputtype="date" maxlength="8" format="yyyy-mm-dd" style="left:174px; top:29px; width:100px; height:18px; "/>
			<select1 id="srch_fisc_clsf_cd" ref="/root/reqData/searchData/fisc_clsf_cd" class="req" navindex="7" appearance="minimal" editmode="inputsearch" itemcount="8" style="left:279px; top:29px; width:120px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/SLIP_CLSF_CD2/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(srch_fisc_clsf_cd, srch_fisc_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(srch_fisc_clsf_cd,"");
							return;
						}
					]]>
				</script>
			</select1>
			<input id="srch_fisc_seq" ref="/root/reqData/searchData/fisc_seq" class="req" navindex="8" maxlength="3" style="left:405px; top:29px; width:40px; height:18px; "/>
			<input id="srch_slip_sub_seq" ref="/root/reqData/searchData/slip_sub_seq" class="req" navindex="5" maxlength="1" style="left:450px; top:4px; width:12px; height:18px; text-align:center; "/>
			<input id="srch_fisc_sub_seq" ref="/root/reqData/searchData/fisc_sub_seq" class="req" navindex="9" maxlength="1" style="left:450px; top:29px; width:12px; height:18px; text-align:center; "/>
			<input id="budg_yymm" ref="/root/resData/resform/budg_yymm" editable="false" style="left:582px; top:29px; width:80px; height:18px; "/>
			<input id="clam_dept_cd" ref="/root/resData/resform/clam_dept_cd" editable="false" style="left:582px; top:54px; width:80px; height:18px; "/>
			<input id="clam_dept_nm" ref="/root/resData/resform/clam_dept_nm" editable="false" style="left:667px; top:54px; width:100px; height:18px; "/>
			<input id="chrg_emp_no" ref="/root/resData/resform/chrg_emp_no" editable="false" style="left:582px; top:79px; width:80px; height:18px; "/>
			<input id="chrg_emp_nm" ref="/root/resData/resform/chrg_emp_nm" editable="false" style="left:667px; top:79px; width:100px; height:18px; "/>
			<input id="dept_nm" ref="/root/resData/resform/dept_nm" editable="false" style="left:772px; top:79px; width:100px; height:18px; "/>
			<input id="srch_slip_seq" ref="/root/reqData/searchData/slip_seq" class="req" navindex="4" maxlength="3" style="left:405px; top:4px; width:40px; height:18px; "/>
			<select1 id="srch_kind" ref="/root/reqData/searchData/kind" navindex="1" appearance="full" cols="1" rows="2" overflow="visible" style="left:5px; top:33px; width:50px; height:35px; border-style:none; ">
				<choices>
					<item>
						<label>현업</label>
						<value>1</value>
					</item>
					<item>
						<label>분개</label>
						<value>2</value>
					</item>
				</choices>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if(model.getValue("/root/reqData/searchData/kind")	 =="1"){							
							srch_slip_occr_dt.attribute("editable") = "true";
							srch_slip_clsf_cd.disabled = false;
							srch_slip_seq.attribute("editable") = "true";
							srch_slip_sub_seq.attribute("editable") = "true";

							srch_fisc_occr_dt.attribute("editable") = "false";
							srch_fisc_clsf_cd.disabled = true;
							srch_fisc_seq.attribute("editable") = "false";
							srch_fisc_sub_seq.attribute("editable") = "false";

						}
						
						if(model.getValue("/root/reqData/searchData/kind")	 =="2"){
							srch_slip_occr_dt.attribute("editable") = "false";
							srch_slip_clsf_cd.disabled = true;
							srch_slip_seq.attribute("editable") = "false";
							srch_slip_sub_seq.attribute("editable") = "false";

							srch_fisc_occr_dt.attribute("editable") = "true";
							srch_fisc_clsf_cd.disabled = false;
							srch_fisc_seq.attribute("editable") = "true";
							srch_fisc_sub_seq.attribute("editable") = "true";
						}						
					]]>
				</script>
			</select1>
			<input id="chnl_clsf_cd" ref="/root/resData/resform/chnl_clsf_cd" editable="false" style="left:174px; top:54px; width:100px; height:18px; "/>
		</group>
		<caption id="subtitle" class="tit02" style="left:10px; top:170px; width:926px; height:20px; ">전표내역</caption>
		<group id="group2" class="gro_tab1" style="left:10px; top:525px; width:926px; height:176px; ">
			<caption id="caption28" class="list_cap02" style="left:108px; top:25px; width:818px; height:26px; "/>
			<caption id="caption59" class="list_cap02" style="left:108px; top:125px; width:818px; height:26px; "/>
			<caption id="caption47" class="list_cap02" style="left:108px; top:75px; width:818px; height:26px; "/>
			<caption id="caption67" class="list_cap02" style="left:108px; top:150px; width:818px; height:26px; "/>
			<caption id="caption43" class="list_cap02" style="left:108px; top:50px; width:818px; height:26px; "/>
			<caption id="caption32" class="list_cap02" style="left:108px; top:0px; width:818px; height:26px; "/>
			<caption id="caption53" class="list_cap02" style="left:108px; top:100px; width:818px; height:26px; "/>
			<caption id="caption31" class="list_cap03_110" style="left:0px; top:0px; width:110px; height:26px; ">계정코드</caption>
			<caption id="caption33" class="list_cap03_110" style="left:307px; top:0px; width:110px; height:26px; ">거래처코드</caption>
			<caption id="caption27" class="list_cap03" style="left:0px; top:25px; width:110px; height:26px; ">행사코드</caption>
			<caption id="caption34" class="list_cap03" style="left:307px; top:25px; width:110px; height:26px; ">부거래처명</caption>
			<caption id="caption35" class="list_cap03" style="left:615px; top:25px; width:110px; height:26px; ">매체코드</caption>
			<caption id="caption38" class="list_cap03" style="left:307px; top:50px; width:110px; height:26px; ">관리구분</caption>
			<caption id="caption39" class="list_cap03" style="left:615px; top:50px; width:110px; height:26px; ">상세매체</caption>
			<caption id="caption42" class="list_cap03" style="left:0px; top:50px; width:110px; height:26px; ">관리번호</caption>
			<caption id="caption46" class="list_cap03" style="left:0px; top:75px; width:110px; height:26px; ">기산/만기일</caption>
			<caption id="caption48" class="list_cap03" style="left:307px; top:75px; width:110px; height:26px; ">은행코드</caption>
			<caption id="caption49" class="list_cap03" style="left:615px; top:75px; width:110px; height:26px; ">단위/수량</caption>
			<caption id="caption52" class="list_cap03" style="left:0px; top:100px; width:110px; height:26px; ">영수증구분</caption>
			<caption id="caption54" class="list_cap03" style="left:307px; top:100px; width:110px; height:26px; ">사용부서</caption>
			<caption id="caption55" class="list_cap03" style="left:615px; top:100px; width:110px; height:26px; ">대상계정</caption>
			<caption id="caption58" class="list_cap03" style="left:0px; top:125px; width:110px; height:26px; ">대상일자</caption>
			<caption id="caption60" class="list_cap03" style="left:307px; top:125px; width:110px; height:26px; ">대상금액</caption>
			<caption id="caption61" class="list_cap03" style="left:615px; top:125px; width:110px; height:26px; ">어음상태</caption>
			<caption id="caption62" class="list_cap03" style="left:307px; top:150px; width:110px; height:26px; ">환율</caption>
			<caption id="caption63" class="list_cap03" style="left:615px; top:150px; width:110px; height:26px; ">외화금액</caption>
			<caption id="caption66" class="list_cap03" style="left:0px; top:150px; width:110px; height:26px; ">외화구분</caption>
			<input id="note_stat" ref="/root/resData/resform/dataSet/CURLIST/record/note_stat" editable="false" style="left:730px; top:129px; width:60px; height:18px; "/>
			<input id="acct_cd" ref="/root/resData/resform/dataSet/CURLIST/record/acct_cd" editable="false" style="left:114px; top:4px; width:40px; height:18px; "/>
			<input id="acct_nm" ref="/root/resData/resform/dataSet/CURLIST/record/acct_nm" editable="false" style="left:159px; top:4px; width:145px; height:18px; "/>
			<input id="mang_no" ref="/root/resData/resform/dataSet/CURLIST/record/mang_no" editable="false" style="left:114px; top:54px; width:150px; height:18px; "/>
			<input id="comp_dt" ref="/root/resData/resform/dataSet/CURLIST/record/comp_dt" editable="false" style="left:114px; top:79px; width:92px; height:18px; text-align:center; "/>
			<input id="mtry_dt" ref="/root/resData/resform/dataSet/CURLIST/record/mtry_dt" editable="false" style="left:212px; top:79px; width:92px; height:18px; text-align:center; "/>
			<input id="prop_equip_cd" ref="/root/resData/resform/dataSet/CURLIST/record/prop_equip_cd" editable="false" style="left:114px; top:104px; width:45px; height:18px; "/>
			<input id="obj_dt" ref="/root/resData/resform/dataSet/CURLIST/record/obj_dt" editable="false" style="left:114px; top:129px; width:80px; height:18px; "/>
			<input id="frcr_clsf_cd" ref="/root/resData/resform/dataSet/CURLIST/record/frcr_clsf_cd" editable="false" style="left:114px; top:154px; width:20px; height:18px; "/>
			<input id="dlco_clsf_cd" ref="/root/resData/resform/dataSet/CURLIST/record/dlco_clsf_cd" editable="false" style="left:422px; top:4px; width:40px; height:18px; "/>
			<input id="dlco_cd" ref="/root/resData/resform/dataSet/CURLIST/record/dlco_cd" editable="false" style="left:467px; top:4px; width:80px; height:18px; "/>
			<input id="dlco_nm" ref="/root/resData/resform/dataSet/CURLIST/record/dlco_nm" editable="false" style="left:552px; top:4px; width:140px; height:18px; "/>
			<input id="intg_dlco_cd" ref="/root/resData/resform/dataSet/CURLIST/record/intg_dlco_cd" editable="false" style="left:697px; top:4px; width:80px; height:18px; "/>
			<input id="boks_dlco_nm" ref="/root/resData/resform/dataSet/CURLIST/record/boks_dlco_nm" editable="false" style="left:422px; top:29px; width:190px; height:18px; "/>
			<input id="mang_clsf_cd" ref="/root/resData/resform/dataSet/CURLIST/record/mang_clsf_cd" editable="false" style="left:422px; top:54px; width:80px; height:18px; "/>
			<input id="mang_clsf_nm" ref="/root/resData/resform/dataSet/CURLIST/record/mang_clsf_nm" editable="false" style="left:507px; top:54px; width:105px; height:18px; "/>
			<input id="bank_cd" ref="/root/resData/resform/dataSet/CURLIST/record/bank_cd" editable="false" style="left:422px; top:79px; width:80px; height:18px; "/>
			<input id="bank_nm" ref="/root/resData/resform/dataSet/CURLIST/record/bank_nm" editable="false" style="left:507px; top:79px; width:105px; height:18px; "/>
			<input id="use_dept_cd" ref="/root/resData/resform/dataSet/CURLIST/record/use_dept_cd" editable="false" style="left:422px; top:104px; width:80px; height:18px; "/>
			<input id="use_dept_nm" ref="/root/resData/resform/dataSet/CURLIST/record/use_dept_nm" editable="false" style="left:507px; top:104px; width:105px; height:18px; "/>
			<input id="obj_amt" ref="/root/resData/resform/dataSet/CURLIST/record/obj_amt" editable="false" format="(-)#,###" style="left:422px; top:129px; width:100px; height:18px; text-align:right; "/>
			<input id="exrate" ref="/root/resData/resform/dataSet/CURLIST/record/exrate" editable="false" format="(-)#,##0.0000" style="left:422px; top:154px; width:80px; height:18px; text-align:right; "/>
			<input id="medi_cd" ref="/root/resData/resform/dataSet/CURLIST/record/medi_cd" editable="false" style="left:730px; top:29px; width:60px; height:18px; "/>
			<input id="medi_nm" ref="/root/resData/resform/dataSet/CURLIST/record/medi_nm" editable="false" style="left:795px; top:29px; width:127px; height:18px; "/>
			<input id="dtls_medi_cd" ref="/root/resData/resform/dataSet/CURLIST/record/dtls_medi_cd" editable="false" style="left:730px; top:54px; width:70px; height:18px; "/>
			<input id="unit" ref="/root/resData/resform/dataSet/CURLIST/record/unit" editable="false" style="left:730px; top:79px; width:60px; height:18px; "/>
			<input id="qunt" ref="/root/resData/resform/dataSet/CURLIST/record/qunt" editable="false" format="(-)#,###" style="left:795px; top:79px; width:127px; height:18px; text-align:right; "/>
			<input id="obj_acct_cd" ref="/root/resData/resform/dataSet/CURLIST/record/obj_acct_cd" editable="false" style="left:730px; top:104px; width:60px; height:18px; "/>
			<input id="obj_acct_nm" ref="/root/resData/resform/dataSet/CURLIST/record/obj_acct_nm" editable="false" style="left:795px; top:104px; width:127px; height:18px; "/>
			<input id="note_stat_nm" ref="/root/resData/resform/dataSet/CURLIST/record/note_stat_nm" editable="false" style="left:795px; top:129px; width:127px; height:18px; "/>
			<input id="frcr_amt" ref="/root/resData/resform/dataSet/CURLIST/record/frcr_amt" editable="false" format="(-)#,##0.00" style="left:730px; top:154px; width:100px; height:18px; text-align:right; "/>
			<input id="evnt_cd" ref="/root/resData/resform/dataSet/CURLIST/record/evnt_cd" editable="false" style="left:114px; top:29px; width:70px; height:18px; "/>
			<input id="dtls_medi_nm" ref="/root/resData/resform/dataSet/CURLIST/record/dtls_medi_nm" editable="false" style="left:805px; top:54px; width:117px; height:18px; "/>
			<input id="evnt_nm" ref="/root/resData/resform/dataSet/CURLIST/record/evnt_nm" editable="false" style="left:189px; top:29px; width:115px; height:18px; "/>
		</group>
		<caption id="caption23" class="tit02" style="left:10px; top:495px; width:926px; height:20px; ">세부내역</caption>
		<group id="group3" class="gro_tab1" style="left:11px; top:460px; width:926px; height:26px; ">
			<caption id="caption11" class="list_cap02" style="left:0px; top:0px; width:925px; height:26px; "/>
			<caption id="caption10" class="list_cap03_110" style="left:464px; top:0px; width:110px; height:26px; ">차변금액</caption>
			<caption id="caption24" class="list_cap03_110" style="left:695px; top:0px; width:110px; height:26px; ">대변금액</caption>
			<caption id="caption25" class="list_cap03_110" style="left:0px; top:0px; width:110px; height:26px; ">회계일자</caption>
			<caption id="caption29" class="list_cap03_110" style="left:232px; top:0px; width:110px; height:26px; ">입력일자</caption>
			<input id="fisc_dt" ref="/root/resData/resform/fisc_dt" editable="false" format="yyyy-mm-dd" style="left:114px; top:4px; width:100px; height:18px; "/>
			<input id="incmg_dt" ref="/root/resData/resform/incmg_dt" editable="false" format="yyyy-mm-dd" style="left:346px; top:4px; width:100px; height:18px; "/>
			<input id="tot_dr_amt" ref="/root/resData/resform/tot_dr_amt" editable="false" format="(-)#,###" style="left:578px; top:4px; width:100px; height:18px; text-align:right; "/>
			<input id="tot_crdt_amt" ref="/root/resData/resform/tot_crdt_amt" editable="false" format="(-)#,###" style="left:811px; top:4px; width:100px; height:18px; text-align:right; "/>
		</group>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record" caption="X^행번^예산코드^예산코드명^차변금액^대변금액^적요1^적요2^부거래처명^사용부서코드^영수증구분^매체코드^매체코드명^상세매체코드^상세매체코드명" colsep="#" colwidth="40, 57, 94, 160, 130, 130, 200, 250, 200, 100, 100, 100, 150, 100, 192" extendlastcol="scroll" frozencols="4" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:10px; top:192px; width:926px; height:258px; ">
			<col ref="x" visibility="hidden"/>
			<col ref="slip_arow_no" type="output"/>
			<col ref="budg_cd" type="output"/>
			<col ref="budg_nm" type="output" style="text-align:left; "/>
			<col ref="dr_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="crdt_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="rmks1" style="text-align:left; "/>
			<col ref="rmks2" type="input" style="text-align:left; "/>
			<col ref="boks_dlco_nm" type="input" style="text-align:left; "/>
			<col ref="use_dept_cd" type="input"/>
			<col ref="prop_equip_cd" type="input"/>
			<col ref="medi_cd"/>
			<col ref="medi_nm"/>
			<col ref="dtls_medi_cd"/>
			<col ref="dtls_medi_cdnm"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
//					if (datagrid1.mouseRow < 1) {
//						return;
//					}
//					
//					if (datagrid1.mouseCol < 1) {
//						return;
//					}
//
//				     if(event.ptarget.elementName != "xforms:col"){
//				      return; 
//				     }     
//				
//						if(datagrid1.mouseRow > 0 && datagrid1.mouseCol > 0 && datagrid1.mouseRow <= datagrid1.rows) {
//							detailList();
//						}
					]]>
			</script>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
				
					//그리드 스크롤바 클릭, 더블클릭 방지 소스
					if (-1 != event.target.lastIndexOf("scroll.thumb")) {
						return;
					}
					
					if (datagrid1.mouseRow < 1) {
						return;
					}
					
					if (datagrid1.mouseCol < 1) {
						return;
					}

					if(event.ptarget.elementName != "xforms:col"){
						return; 
					}

					
					var grid = eval(event.currentTarget);
					var rowid = grid.row;
					var colid = grid.col;
					
					if (rowid < grid.fixedRows || colid < grid.fixedCols) {
						return;
					}
				
//					if ((datagrid1.mouseCol > 0) && (datagrid1.mouseCol < datagrid1.cols) && (datagrid1.mouseRow >= datagrid1.fixedRows))  {
				
						if(datagrid1.mouseRow > 0 && datagrid1.mouseCol > 0 && datagrid1.mouseRow <= datagrid1.rows) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/cmpy_cd");
							model.makeNode("/root/reqData/fwdData/G_Tag");
							model.makeNode("/root/reqData/fwdData/G_Caption");
							model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
							model.setValue("/root/reqData/fwdData/G_Tag", "1");
							model.setValue("/root/reqData/fwdData/G_Caption", "전표내역수정");
							model.makeNode("/root/reqData/fwdData/slip_arow_no");
							model.makeNode("/root/reqData/fwdData/budg_cd");
							model.makeNode("/root/reqData/fwdData/budg_nm");
							model.makeNode("/root/reqData/fwdData/dr_amt");
							model.makeNode("/root/reqData/fwdData/crdt_amt");
							model.makeNode("/root/reqData/fwdData/use_dept_cd");
							model.makeNode("/root/reqData/fwdData/use_dept_nm");
							model.makeNode("/root/reqData/fwdData/boks_dlco_nm");
							model.makeNode("/root/reqData/fwdData/prop_equip_cd");
							model.makeNode("/root/reqData/fwdData/rmks2");
							model.makeNode("/root/reqData/fwdData/medi_cd");
							model.makeNode("/root/reqData/fwdData/medi_nm");
							model.makeNode("/root/reqData/fwdData/dtls_medi_cd");
							model.makeNode("/root/reqData/fwdData/dtls_medi_cdnm");
							model.setValue("/root/reqData/fwdData/slip_arow_no",model.property("cmpy_cd"));
							model.setValue("/root/reqData/fwdData/slip_arow_no",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+datagrid1.row+"]/slip_arow_no"));
							model.setValue("/root/reqData/fwdData/budg_cd",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+datagrid1.row+"]/budg_cd"));
							model.setValue("/root/reqData/fwdData/budg_nm",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+datagrid1.row+"]/budg_nm"));
							model.setValue("/root/reqData/fwdData/dr_amt",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+datagrid1.row+"]/dr_amt"));
							model.setValue("/root/reqData/fwdData/crdt_amt",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+datagrid1.row+"]/crdt_amt"));
							model.setValue("/root/reqData/fwdData/use_dept_cd",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+datagrid1.row+"]/use_dept_cd"));
							model.setValue("/root/reqData/fwdData/use_dept_nm",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+datagrid1.row+"]/use_dept_nm"));
							model.setValue("/root/reqData/fwdData/boks_dlco_nm",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+datagrid1.row+"]/boks_dlco_nm"));
							model.setValue("/root/reqData/fwdData/prop_equip_cd",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+datagrid1.row+"]/prop_equip_cd"));
							model.setValue("/root/reqData/fwdData/rmks2",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+datagrid1.row+"]/rmks2"));
							model.setValue("/root/reqData/fwdData/medi_cd",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+datagrid1.row+"]/medi_cd"));
							model.setValue("/root/reqData/fwdData/medi_nm",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+datagrid1.row+"]/medi_nm"));
							model.setValue("/root/reqData/fwdData/dtls_medi_cd",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+datagrid1.row+"]/dtls_medi_cd"));
							model.setValue("/root/reqData/fwdData/dtls_medi_cdnm",model.getValue("/root/resData/gridData/fc_acct_2471_l/dataSet/CURLIST/record["+datagrid1.row+"]/dtls_medi_cdnm"));
							
							window.load("../../fc/acct/FC_ACCT_2479.xrw"
										, "modal"
										, ""
										, "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
									,"/root/reqData/fwdData"
									,"/root/reqData/fwdData"
							)
						}
//					}
					]]>
			</script>
			<!--
			<script type="javascript" ev:event="onkeyup">
				<![CDATA[
//					alert(event.keycode);
					if (event.keycode == "38" || event.keycode == "40") {
						if(datagrid1.Row > 0 && datagrid1.Col > 0 && datagrid1.Row <= datagrid1.rows) {
							detailList();
						}
					}
				]]>
			</script>
			-->
			<!--
			<script type="javascript" ev:event="onaftermovecolumn">
				<![CDATA[
					if(datagrid1.mouseRow > 0 && datagrid1.mouseCol > 0 && datagrid1.mouseRow <= datagrid1.rows) {
						detailList();
					}				
				]]>
			</script>
			-->
			<script type="javascript" ev:event="onrowchanged">
				<![CDATA[
					if(datagrid1.mouseRow > 0 && datagrid1.mouseCol > 0 && datagrid1.mouseRow <= datagrid1.rows) {
						detailList();
					}
					datagrid1.dispatch("onmouseup");
				]]>
			</script>
			<script type="javascript" ev:event="ondragleave">
				<![CDATA[
				
				]]>
			</script>
		</datagrid>
	</xhtml:body>
</xhtml:html>
