<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>예산별보조부조회(FC_ACCT_2480)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<session/>
						<!-- 서버의 세션 정보를 담당한다 -->
						<dataSet>
							<SLIPCLSFCDLIST>
								<record>
									<cccodeval/>
									<cccdnm/>
									<cccdynm/>
								</record>
							</SLIPCLSFCDLIST>
							<MEDICDLIST>
								<record>
									<cccodeval/>
									<cccdnm/>
									<cccdynm/>
								</record>
							</MEDICDLIST>
							<MANGCLSFCDLIST>
								<record>
									<cccodeval/>
									<cccdnm/>
									<cccdynm/>
								</record>
							</MANGCLSFCDLIST>
							<xx_dlco_clsf_cd/>
							<xx_g_tag/>
							<xx_g_tag2/>
							<INCMCLSFCDLIST>
								<record>
									<cccodeval/>
									<cccdnm/>
									<cccdynm/>
								</record>
							</INCMCLSFCDLIST>
						</dataSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<!-- 검색조건 처리 -->
						<!-- formData 팝업,화면전환시 data이동시 -->
						<!-- MultiUpDate유형 사용시 처리 -->
						<formData>
							<frbudg_cd/>
							<tobudg_cd/>
							<frfisc_dt/>
							<tofisc_dt/>
							<dlco_clsf_cd/>
							<dlco_cd/>
							<medi_cd/>
							<mang_clsf_cd/>
							<to_mang_clsf_cd/>
							<evnt_cd/>
							<clam_dept_cd/>
							<to_clam_dept_cd/>
							<use_dept_cd/>
							<to_use_dept_cd/>
							<slip_clsf_cd/>
							<dr_amt/>
							<crdt_amt/>
							<incmg_emp_no/>
							<drcr_clsf1>1</drcr_clsf1>
							<drcr_clsf2>9</drcr_clsf2>
							<dtls_medi_cd/>
							<dtls_medi_cd_nm/>
							<remk/>
							<incm_clsf_cd/>
							<slip_aprv_yn>2</slip_aprv_yn>
							<prop_equip_cd/>
						</formData>
						<searchDetail/>
						<fwdData/>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<dataSet>
							<CURLIST>
								<record>
									<budg_cd/>
									<!--예산코드                -->
									<budg_cd_nm/>
									<!--예산코드명              -->
									<fisc_dt/>
									<!--회계일자                -->
									<slip_no/>
									<!--전표번호	            -->
									<slip_occr_dt/>
									<!--전표발생일자            -->
									<slip_clsf_cd/>
									<!--전표구분코드            -->
									<slip_seq/>
									<!--전표일련번호            -->
									<slip_sub_seq/>
									<!--SUBSEQ                  -->
									<slip_arow_no/>
									<!--행번호                  -->
									<rmks1/>
									<!--적요1                   -->
									<rmks2/>
									<!--적요2                   -->
									<dr_amt/>
									<!--차변금액                -->
									<crdt_amt/>
									<!--대변금액                -->
									<mang_clsf_cd/>
									<!--관리구분코드            -->
									<mang_clsf_cd_nm/>
									<!--관리구분코드명          -->
									<mang_no/>
									<!--관리번호                -->
									<dlco_clsf_cd/>
									<!--거래처구분코드          -->
									<dlco_clsf_cd_nm/>
									<!--거래처구분코드명        -->
									<dlco_cd/>
									<!--거래처코드              -->
									<dlco_nm/>
									<!--거래처명                -->
									<boks_dlco_nm/>
									<!--부거래처명              -->
									<medi_cd/>
									<!--매체코드                -->
									<medi_cd_nm/>
									<!--매체코드명              -->
									<dtls_medi_cd/>
									<dtls_medi_cdnm/>
									<prop_equip_cd/>
									<!--고정자산코드            -->
									<use_dept_cd/>
									<!--사용부서코드            -->
									<evnt_cd/>
									<!--행사코드                -->
									<evnt_cd_nm/>
									<!--행사코드명              -->
									<obj_amt/>
									<!--대상금액                -->
									<clam_dept_cd_nm/>
									<!--청구부서명(인사부서코드)-->
									<obj_acct_cd_nm/>
									<!--대상계정코드명			-->
									<incm_clsf_cd_nm/>
								</record>
								<totalcnt/>
							</CURLIST>
							<errCode/>
							<errMsg/>
							<dr_amt_sum/>
							<crdt_amt_sum/>
						</dataSet>
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
					</resData>
					<resData1>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<frbudg_cd_nm/>
						<tobudg_cd_nm/>
						<clam_dept_cd_nm/>
						<incmg_emp_no_nm/>
						<dlco_cd_nm/>
						<evnt_cd_nm/>
						<to_clam_dept_cd_nm/>
						<use_dept_cd_nm/>
						<to_use_dept_cd_nm/>
						<prop_equip_cd_nm/>
					</resData1>
					<tempData>
						<fc_co_1101_l>
							<dataSet>
								<CURLIST1>
									<record>
										<cmpy_cd/>
										<dept_cd/>
										<dept_team_clsf/>
										<abrv_nm/>
										<offi_nm/>
										<dept_team_nm/>
										<part_nm/>
										<part_dn_nm/>
									</record>
								</CURLIST1>
							</dataSet>
						</fc_co_1101_l>
						<fc_acct_2015_l>
							<dataSet>
								<CURLIST>
									<record>
										<cd/>
										<cdnm/>
									</record>
								</CURLIST>
							</dataSet>
						</fc_acct_2015_l>
					</tempData>
					<src_3/>
				</root>
			</instance>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<script type="javascript" src="/js/fcmc_common.js"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					
					set_default(
						datagrid1
					);
					datagrid1.selectionMode = "listbox";
					model1.send("fc_acct_2480_m");
					makeComboGubun("","/root/initData/dataSet/MEDICDLIST","record","cccdynm", "cccodeval");
					makeComboGubun("","/root/initData/dataSet/SLIPCLSFCDLIST","record","cccdynm", "cccodeval");
					makeComboGubun("","/root/initData/dataSet/MANGCLSFCDLIST","record","cccdynm", "cccodeval");
					
					model1.setValue("/root/reqData/formData/frfisc_dt", commCurDate());
					model1.setValue("/root/reqData/formData/tofisc_dt", commCurDate());
					model1.refresh();
				]]>
			</script>
			<submission id="fc_acct_2480_m" action="/fc/acct2000/2480" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/dataSet"/>
			<submission id="fc_acct_2481_l" action="/fc/acct2000/2481" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/formData" resultref="/root/resData/dataSet"/>
			<submission id="fc_co_1101" action="/fc/co1000/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/fc_co_1101_l/dataSet"/>
			<submission id="hd_com_1002" action="/hd/com/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData"/>
			<submission id="fc_acct_2015_l" action="/fc/acct2000/2015" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/fc_acct_2015_l/dataSet"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[	
				]]>
			</script>
			<submission id="fc_co_8000_s" action="/fc/co8000/8000" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/mc_co_8000_s"/>
			<submission id="fc_acct_2482_l" action="/fc/acct2000/2482" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/formData" resultref="/root/msgData"/>
		</model>
		<script type="javascript">
			<![CDATA[
				var	_oth_clsf = "1";
			
				var gstr_popupid = "";
				
				// 대상청구부서
				function setDept_cd(iv_dept_cd, iv_dept_nm, iv_dept_team_clsf, iv_offi_nm, iv_dept_team_nm, iv_part_nm, iv_part_dn_nm){	
					if (gstr_popupid == "clam_dept_cd") {
						model1.setValue("/root/reqData/formData/clam_dept_cd", iv_dept_cd);
						model1.setValue("/root/resData1/clam_dept_cd_nm", iv_dept_nm);
						clam_dept_cd.refresh();
						clam_dept_cd_nm.refresh();
					}
					if (gstr_popupid == "to_clam_dept_cd") {
						model1.setValue("/root/reqData/formData/to_clam_dept_cd", iv_dept_cd);
						model1.setValue("/root/resData1/to_clam_dept_cd_nm", iv_dept_nm);
						to_clam_dept_cd.refresh();
						to_clam_dept_cd_nm.refresh();
					}
					if (gstr_popupid == "use_dept_cd") {
						model1.setValue("/root/reqData/formData/use_dept_cd", iv_dept_cd);
						model1.setValue("/root/resData1/use_dept_cd_nm", iv_dept_nm);
						use_dept_cd.refresh();
						use_dept_cd_nm.refresh();
					}
					if (gstr_popupid == "to_use_dept_cd") {
						model1.setValue("/root/reqData/formData/to_use_dept_cd", iv_dept_cd);
						model1.setValue("/root/resData1/to_use_dept_cd_nm", iv_dept_nm);
						to_use_dept_cd.refresh();
						to_use_dept_cd_nm.refresh();
					}
					
					if (gstr_popupid == "dlco_cd") {
						model.setValue("/root/reqData/formData/dlco_cd", iv_dept_cd);
						model.setValue("/root/resData1/dlco_cd_nm", iv_dept_nm);
						dlco_cd.refresh();
						dlco_cd_nm.refresh();
					}
					
					gstr_popupid = "";
				}
				
				function setEvntInfo(Evnt_cd, Evnt_cd_nm){

					//대상행사코드
					
					if (gstr_popupid == "evnt_cd") {	
					model1.setValue("/root/reqData/formData/evnt_cd", Evnt_cd);
					model1.setValue("/root/resData1/evnt_cd_nm", Evnt_cd_nm);
					
					evnt_cd.refresh();
					evnt_cd_nm.refresh();
					}
				
					// 예산코드FR
					if (gstr_popupid == "frbudg_cd") {

						model1.setValue("/root/reqData/formData/frbudg_cd", Evnt_cd);
						model1.setValue("/root/resData1/frbudg_cd_nm", Evnt_cd_nm);
						
						frbudg_cd.refresh();
						frbudg_cd_nm.refresh();
					}
					
					// 예산코드TO
					if (gstr_popupid == "tobudg_cd") {

						model1.setValue("/root/reqData/formData/tobudg_cd", Evnt_cd);
						model1.setValue("/root/resData1/tobudg_cd_nm", Evnt_cd_nm);
						
						tobudg_cd.refresh();
						tobudg_cd_nm.refresh();
					}					
				}
				
				// 입력자명
				function setEmp_no(emp_no, nm_korn){

					model1.setValue("/root/reqData/formData/incmg_emp_no", emp_no);
					model1.setValue("/root/resData1/incmg_emp_no_nm", nm_korn);

					incmg_emp_no.refresh();
					incmg_emp_no_nm.refresh();

				}
				
				function open_fc_acct_1180(p_where,p_mode,p_title,p_readonly,p_to) {
					var need_popup = true;
					var rcvs_flag = false;
					
					p_where = p_where.toUpperCase();
					
					if (!check_reqItem(dlco_clsf_cd,"none","focus","[거래처검색]은 [거래처구분]을 선택 후 조회 할 수 있습니다.")) {return rcvs_flag};
					
					//검색조건이 모두 충족하지 않으면 종료한다.
					if (p_where == "FOCUS" && (dlco_clsf_cd.value.Trim() == "" || dlco_cd.value.Trim() == "")) {
						dlco_cd_nm.value	= "";
						return rcvs_flag;
					}										
					
					var popid = "fc_acct_1180";
					var subid = "fc_acct_1181_l";
	
					set_popup_send_data(popid		,"mode"			,p_mode			);
					set_popup_send_data(popid		,"title"			,p_title			);
					set_popup_send_data(popid		,"readonly"		,p_readonly		);
					set_popup_send_data(popid		,"clsf_cd"			,dlco_clsf_cd.value	);
					set_popup_send_data(popid		,"cd_f"			,dlco_cd.value	);
					set_popup_send_data(popid		,"cd_t"			,dlco_cd.value	);
//					set_popup_send_data(popid		,"cd_abrv_nm"		,dlco_cd.value	);
					set_popup_send_data(popid		,"cd_abrv_nm"		,""				);
	
					//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
					if (p_where == "FOCUS") {
						//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
						//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
						model.removenode(get_popup_rcvs_ref(popid));
						//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
						model.makeNode(get_popup_rcvs_ref(popid));
						
						//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
						send_submission(
								"auto_" + subid
							,	get_popup_send_ref(popid)
							,	get_popup_rcvs_ref(subid) + "/dataSet"
							,	"/fc/acct1000/1181"
							,	"urlencoded-post"
							,	"application/x-www-form-urlencoded"
						);
						
						totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
				
						if (totalcnt == 1) {
							//데이터가 1건이고 focus out에서 호출한 경우
							//데이터를 설정하고 나간다.
	
	//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
	//						return;
							need_popup = false;
							rcvs_flag = true;
						}
						else if (totalcnt == 0) {
	//						show_message("거래처코드의 검색결과가 없습니다.");
	//						return;
							need_popup = false;
							rcvs_flag = false;
						}
						else {
							//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
							//만약 1건 이상인 경우 popup을 호출해 달라고 하면
							//return을 지우면 됨
							//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
							//return;
							need_popup = true;
						}
					}									
					
					//그외 버튼인 경우는 계속 진행
					if (need_popup) {
						open_popup(popid,"640");
					}
	
					//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
					//다시 조회 하기 쉽도록 하고
					if (get_popup_rcvs_data(popid,"clsf_cd") != "")			dlco_clsf_cd.value		=	get_popup_rcvs_data(popid,"clsf_cd");
//					if (get_popup_rcvs_data(popid,"cd") != "")				dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
					//그외의 값은 지워지도록 한다.
					dlco_cd.value				=	get_popup_rcvs_data(popid,"cd");
					dlco_cd_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					
					return rcvs_flag;
				}
				
				function fn_dlco_check() {

					if (dlco_cd.value.ReplaceString("-", "").length == 10) {
						if (commCheckBrnoVal(dlco_cd.value.ReplaceString("-", "")) == false) { dlco_cd.value = ""; }
					}

					if (dlco_cd.value.length == 0) {
						dlco_cd_nm.value = "";
					}
				}		
				
				function open_fc_acct_2470 (p_where,p_mode,p_title,p_readonly) {
					var need_popup = true;										
					
					var popid = "fc_acct_2470";
					var subid = "fc_acct_2471_l";
	
					set_popup_send_data(popid		,"mode"			,p_mode			);
					set_popup_send_data(popid		,"title"			,p_title			);
					set_popup_send_data(popid		,"readonly"		,p_readonly		);
					set_popup_send_data(popid		,"slip_occr_dt"		,get_refvalue("/root/resData/dataSet/CURLIST/record["+datagrid1.row+"]/slip_occr_dt"));
					set_popup_send_data(popid		,"slip_clsf_cd"		,get_refvalue("/root/resData/dataSet/CURLIST/record["+datagrid1.row+"]/slip_clsf_cd"));
					set_popup_send_data(popid		,"slip_seq"			,get_refvalue("/root/resData/dataSet/CURLIST/record["+datagrid1.row+"]/slip_seq"));
					set_popup_send_data(popid		,"slip_sub_seq"		,get_refvalue("/root/resData/dataSet/CURLIST/record["+datagrid1.row+"]/slip_sub_seq"));

					//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
					if (p_where == "FOCUS") {
						//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
						//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
						model1.removenode(get_popup_rcvs_ref(popid));
						//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
						model1.makeNode(get_popup_rcvs_ref(popid));
						
						//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
						send_submission(
								"auto_" + subid
							,	get_popup_send_ref(popid)
							,	get_popup_rcvs_ref(subid) + "/dataSet"
							,	"/fc/acct2000/2471"
							,	"urlencoded-post"
							,	"application/x-www-form-urlencoded"
						);
						
						totalcnt = model1.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST/totalcnt");
				
						if (totalcnt == 1) {
							//데이터가 1건이고 focus out에서 호출한 경우
							//데이터를 설정하고 나간다.
	
	//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST/record");
	//						return;
							need_popup = false;
						}
						else if (totalcnt == 0) {
							show_message("검색결과가 없습니다.");
	//						return;
							need_popup = false;						
						}
						else {
							//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
							//만약 1건 이상인 경우 popup을 호출해 달라고 하면
							//return을 지우면 됨
							//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
							//return;
							need_popup = true;
						}
					}
										
					if (need_popup) {
						open_popup(popid,"");
					}
				}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="2,34;2,39;2,40;2,49;2,70;2,78;2,80;2,104;2,105;2,112;2,113;2,117;2,118;2,132;2,133;2,378;2,375;2,393;2,408;2,409;1,936;1,927;1,926;1,459;1,449;2,755;">
		<group id="group_scr" class="gro_sel" style="left:10px; top:80px; width:926px; height:51px; ">
			<caption id="caption4" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; "/>
			<caption id="caption2" class="list_cap02" style="left:0px; top:25px; width:926px; height:26px; "/>
			<caption id="caption3" class="list_cap03" style="left:0px; top:0px; width:110px; height:26px; ">예산코드 FR</caption>
			<caption id="caption1" class="list_cap03" style="left:0px; top:25px; width:110px; height:26px; ">대상기간</caption>
			<input id="frfisc_dt" ref="/root/reqData/formData/frfisc_dt" class="req" navindex="5" inputtype="date" validateformat="true" style="left:113px; top:29px; width:100px; height:18px; "/>
			<input id="tofisc_dt" ref="/root/reqData/formData/tofisc_dt" class="req" navindex="6" inputtype="date" validateformat="true" style="left:231px; top:29px; width:100px; height:18px; "/>
			<input id="frbudg_cd_nm" ref="/root/resData1/frbudg_cd_nm" editable="false" style="left:217px; top:4px; width:180px; height:18px; "/>
			<input id="frbudg_cd" ref="/root/reqData/formData/frbudg_cd" class="req_100" navindex="3" inputtype="button" style="left:113px; top:4px; width:81px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						//alert(event.button);
						model1.removeNodeset("/root/reqData/fwdData");
						model1.makeNode("/root/reqData/fwdData/cmpy_cd");
						model1.makeNode("/root/reqData/fwdData/G_Tag");
						model1.makeNode("/root/reqData/fwdData/G_Caption");
						model1.makeNode("/root/reqData/fwdData/G_Codenu");
						model1.makeNode("/root/reqData/fwdData/G_BRCode");
						model1.makeNode("/root/reqData/fwdData/cd");
						model1.makeNode("/root/reqData/fwdData/cdnm");	
						model1.makeNode("/root/reqData/fwdData/G_Event");	
																	
						model1.setValue("/root/reqData/fwdData/cmpy_cd", model1.getValue("/root/reqData/searchData/cmpy_cd"));
						model1.setValue("/root/reqData/fwdData/G_Tag", model.getValue("/root/initData/dataSet/xx_g_tag2"));
						model1.setValue("/root/reqData/fwdData/G_Caption", "예산코드조회");
						model1.setValue("/root/reqData/fwdData/G_Codenu", "");
						model1.setValue("/root/reqData/fwdData/G_BRCode", "");
						model1.setValue("/root/reqData/fwdData/cd",model1.getValue("/root/reqData/formData/frbudg_cd"));
						model1.setValue("/root/reqData/fwdData/cdnm",model1.getValue("/root/resData1/frbudg_cd_nm"));	

						
						gstr_popupid = "frbudg_cd";
					
						window.load("../../mc/co/MC_CO_1000.xrw"
									, "modal"
									, ""
									, "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
								,"/root/reqData/fwdData"
								,"/root/reqData/fwdData"
								)			
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						//alert(event.button);
						if (frbudg_cd.value.Trim().length == 6) {
//							alert(event.button);
							if (event.button == "0" || event.button == "1") {
							//	alert(event.target);
							model1.removeNodeset("/root/reqData/fwdData");
							model1.makeNode("/root/reqData/fwdData/cmpy_cd");
							model1.makeNode("/root/reqData/fwdData/G_Tag");
							model1.makeNode("/root/reqData/fwdData/G_Caption");
							model1.makeNode("/root/reqData/fwdData/G_Codenu");
							model1.makeNode("/root/reqData/fwdData/G_BRCode");
							model1.makeNode("/root/reqData/fwdData/cd");
							model1.makeNode("/root/reqData/fwdData/cdnm");	
							model1.makeNode("/root/reqData/fwdData/G_Event");	
												
							model1.setValue("/root/reqData/fwdData/cmpy_cd", model1.getValue("/root/reqData/searchData/cmpy_cd"));
							model1.setValue("/root/reqData/fwdData/G_Tag", model.getValue("/root/initData/dataSet/xx_g_tag2"));
							model1.setValue("/root/reqData/fwdData/G_Caption", "예산코드조회");
							model1.setValue("/root/reqData/fwdData/G_Codenu", "");
							model1.setValue("/root/reqData/fwdData/G_BRCode", "");
							model1.setValue("/root/reqData/fwdData/cd",model1.getValue("/root/reqData/formData/frbudg_cd"));
							model1.setValue("/root/reqData/fwdData/cdnm", ""); //model1.getValue("/root/resData1/frbudg_cd_nm"));	
							
							model1.setValue("/root/reqData/fwdData/G_Event","focus");	
							
							gstr_popupid = "frbudg_cd";
	
							window.load("../../mc/co/MC_CO_1000.xrw"
										, "modal"
										, ""
										, "left:-2000;top:-2000; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
									,"/root/reqData/fwdData"
									,"/root/reqData/fwdData"
									)
							}else{
								frbudg_cd.dispatch("onbuttonclick" , "", true, true);
							}
						}
						else {
							frbudg_cd.value = "";
							frbudg_cd_nm.value = "";
						}
					
					]]>
				</script>
			</input>
			<caption id="caption36" class="list_cap03" style="left:403px; top:0px; width:110px; height:26px; ">예산코드 TO</caption>
			<input id="tobudg_cd_nm" ref="/root/resData1/tobudg_cd_nm" editable="false" style="left:621px; top:4px; width:180px; height:18px; "/>
			<input id="tobudg_cd" ref="/root/reqData/formData/tobudg_cd" class="req_100" navindex="4" inputtype="button" style="left:516px; top:4px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						
						model1.removeNodeset("/root/reqData/fwdData");  
						model1.makeNode("/root/reqData/fwdData/cmpy_cd");
						model1.makeNode("/root/reqData/fwdData/G_Tag");
						model1.makeNode("/root/reqData/fwdData/G_Caption");
						model1.makeNode("/root/reqData/fwdData/G_Codenu");
						model1.makeNode("/root/reqData/fwdData/G_BRCode");
						model1.makeNode("/root/reqData/fwdData/cd");
						model1.makeNode("/root/reqData/fwdData/cdnm");	
						model1.makeNode("/root/reqData/fwdData/G_Event");	
																		
						model1.setValue("/root/reqData/fwdData/cmpy_cd", model1.getValue("/root/reqData/searchData/cmpy_cd"));
						model1.setValue("/root/reqData/fwdData/G_Tag", model.getValue("/root/initData/dataSet/xx_g_tag2"));
						model1.setValue("/root/reqData/fwdData/G_Caption", "예산코드조회");
						model1.setValue("/root/reqData/fwdData/G_Codenu", "");					
						model1.setValue("/root/reqData/fwdData/G_BRCode","");
						model1.setValue("/root/reqData/fwdData/cd",model1.getValue("/root/reqData/formData/tobudg_cd"));
						model1.setValue("/root/reqData/fwdData/cdnm",model1.getValue("/root/resData1/tobudg_cd_nm"));	
						
						gstr_popupid = "tobudg_cd";
					
						window.load("../../mc/co/MC_CO_1000.xrw"
									, "modal"
									, ""
									, "left:100; top:100; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
								,"/root/reqData/fwdData"
								,"/root/reqData/fwdData"
								)			
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						//alert(event.button);
						if (tobudg_cd.value.Trim().length == 6) {
//							alert(event.button);
							if (event.button == "0" || event.button == "1") {
								//	alert(event.target);
								model1.removeNodeset("/root/reqData/fwdData");
								model1.makeNode("/root/reqData/fwdData/cmpy_cd");
								model1.makeNode("/root/reqData/fwdData/G_Tag");
								model1.makeNode("/root/reqData/fwdData/G_Caption");
								model1.makeNode("/root/reqData/fwdData/G_Codenu");
								model1.makeNode("/root/reqData/fwdData/G_BRCode");
								model1.makeNode("/root/reqData/fwdData/cd");
								model1.makeNode("/root/reqData/fwdData/cdnm");	
								model1.makeNode("/root/reqData/fwdData/G_Event");	
													
								model1.setValue("/root/reqData/fwdData/cmpy_cd", model1.getValue("/root/reqData/searchData/cmpy_cd"));
								model1.setValue("/root/reqData/fwdData/G_Tag", "1");
								model1.setValue("/root/reqData/fwdData/G_Caption", "예산코드조회");
								model1.setValue("/root/reqData/fwdData/G_Codenu", "");
								model1.setValue("/root/reqData/fwdData/G_BRCode", "");
								model1.setValue("/root/reqData/fwdData/cd",model1.getValue("/root/reqData/formData/tobudg_cd"));
								model1.setValue("/root/reqData/fwdData/cdnm", ""); //model1.getValue("/root/resData1/tobudg_cd_nm"));	
								
								model1.setValue("/root/reqData/fwdData/G_Event","focus");	
								
								gstr_popupid = "tobudg_cd";
		
								window.load("../../mc/co/MC_CO_1000.xrw"
											, "modal"
											, ""
											, "left:-2000;top:-2000; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
										,"/root/reqData/fwdData"
										,"/root/reqData/fwdData"
										)
								}else{
									tobudg_cd.dispatch("onbuttonclick" , "", true, true);	
								}
								
						}
						else {
							tobudg_cd.value = "";
							tobudg_cd_nm.value = "";
						}
					]]>
				</script>
			</input>
			<caption id="caption6" style="left:217px; top:29px; width:12px; height:18px; font-weight:bold; ">~</caption>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:140px; width:926px; height:5px; "/>
		<switch id="switch1" style="left:10px; top:340px; width:926px; height:415px; ">
			<case id="case1" scroll="none"/>
			<case id="case2" scroll="none" selected="true" style="left:0px; top:0px; width:100.00%; height:100.00%; ">
				<datagrid id="datagrid1" nodeset="/root/resData/dataSet/CURLIST/record" caption="예산코드^예산명^회계일자^전표번호^적요^차변금액^대변금액^관리구분^관리번호^거래처구분^거래처코드^거래처명^부거래처명^매체코드^상세매체코드^영수증구분^사용부서^행사코드^청구부서^대상계정^대상금액^소득구분" colsep="^" colwidth="60, 81, 65, 187, 267, 89, 86, 61, 62, 70, 73, 64, 76, 70, 140, 100, 100, 100, 100, 100, 100, 120" explorerbar="sort" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" style="left:0px; top:77px; width:926px; height:325px; ">
					<col ref="budg_cd" type="output"/>
					<col ref="budg_cd_nm" type="output" style="text-align:left; "/>
					<col ref="fisc_dt" type="output" format="yyyy-mm-dd"/>
					<col ref="slip_no" type="output"/>
					<col ref="rmks1" style="text-align:left; "/>
					<col ref="dr_amt" format="(-)#,###" style="text-align:right; "/>
					<col ref="crdt_amt" format="(-)#,###" style="text-align:right; "/>
					<col ref="mang_clsf_cd_nm" style="left:864px; top:20px; width:70px; height:20px; text-align:left; "/>
					<col ref="mang_no"/>
					<col ref="dlco_clsf_cd_nm" style="text-align:left; "/>
					<col ref="dlco_cd"/>
					<col ref="dlco_nm" style="text-align:left; "/>
					<col ref="boks_dlco_nm" style="text-align:left; "/>
					<col ref="medi_cd_nm"/>
					<col ref="dtls_medi_cdnm"/>
					<col ref="prop_equip_cd" style="text-align:left; "/>
					<!--고정자산코드            -->
					<col ref="use_dept_cd"/>
					<!--사용부서코드            -->
					<col ref="evnt_cd"/>
					<!--행사코드                -->
					<col ref="clam_dept_cd_nm" style="text-align:left; "/>
					<!--청구부서명(인사부서코드)-->
					<col ref="obj_acct_cd_nm" style="text-align:left; "/>
					<!--대상계정코드명  		  -->
					<col ref="obj_amt" format="(-)#,###" style="text-align:right; "/>
					<col ref="incm_clsf_cd_nm" style="text-align:left; "/>
					<!--대상금액                -->
					<script type="javascript" ev:event="oncopy">
						<![CDATA[
						// datagrid 에 선택된 셀을 얻어온다							
						var selected = datagrid1.selectedCells;
						var excelData = "";
						var miniCol = selected.item(0).col;
						var miniRow = selected.item(0).row;
						var maxCol = selected.item(0).col;
						var maxRow = selected.item(0).row;
						
						var cell;
						// col의 최대 최소 값을 구한다				
						for(var i=0; i<selected.length; i++)
						{
							cell = selected.item(i);
							
							// 최대 col 겁색
							if( cell.col > maxCol )
								maxCol = cell.col;
							
							// 최소 col 겁색
							if (cell.col < miniCol )
								miniCol = cell.col;
							
							// 최대 row 검색
							if( cell.row > maxRow )
								maxRow = cell.row;
							
							// 최소 row 검색
							if (cell.row < miniRow )
								miniRow = cell.row;
						}
								
						// cell Data 를 클립보드에 excel 형태로 집어넣음
						for(var k=miniRow; k<=maxRow; k++)
						{
							for(var j=miniCol; j<=maxCol; j++)
							{
								var data = datagrid1.valueMatrix(k,j);
								excelData += data;
								if( j != maxCol)
									excelData += "\t";
							}
			
							if( k != maxRow)
								excelData += "\n";
						}
						
						//  클립보드 데이터 변경
						window.clipBoardData = excelData;

						]]>
					</script>
				</datagrid>
				<group id="group2" class="gro_sel" style="left:0px; top:0px; width:926px; height:51px; ">
					<caption id="caption5" class="list_cap02" style="left:0px; top:25px; width:926px; height:26px; "/>
					<caption id="caption26" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; "/>
					<input id="input16" ref="/root/reqData/formData/frfisc_dt" class="input_100" editable="false" inputtype="date" style="left:115px; top:3px; width:170px; height:18px; "/>
					<input id="input17" ref="/root/reqData/formData/tofisc_dt" class="input_100" editable="false" inputtype="date" style="left:220px; top:3px; width:100px; height:18px; "/>
					<caption id="caption31" class="list_cap03" style="left:0px; top:0px; width:110px; height:26px; ">대상일자</caption>
					<caption id="caption32" class="list_cap03" style="left:458px; top:0px; width:110px; height:26px; ">차변발생합계</caption>
					<input id="input22" ref="/root/resData/dataSet/dr_amt_sum" class="input_150" editable="false" format="(-)#,###" align="right" style="left:571px; top:4px; width:150px; height:18px; text-align:right; "/>
					<caption id="caption34" class="list_cap03" style="left:458px; top:25px; width:110px; height:26px; ">대변발생합계</caption>
					<input id="input24" ref="/root/resData/dataSet/crdt_amt_sum" class="input_150" editable="false" format="(-)#,###" align="right" style="left:571px; top:29px; width:150px; height:18px; text-align:right; "/>
				</group>
				<button id="button8" class="btn_grid02" crud="R" style="left:102px; top:55px; width:55px; height:17px; ">
					<caption>찾기</caption>
					<script type="javascript" ev:event="onclick">
						<![CDATA[		
					model.setFocus("datagrid1",true);					
					var startrow = datagrid1.row+1;					
					if(startrow <= 0){
						startrow = 1;
					}
					for(var i = 1; i<17;i++){
						var src_row = datagrid1.findRow(input2.currentText, parseInt(startrow), i, false, false);						
						if(src_row > 0 ){
							datagrid1.row = src_row;
							datagrid1.topRow = src_row;
							return;
							
						}else{
							datagrid1.row = 1;
						}
					}
				]]>
					</script>
				</button>
				<input id="input2" ref="/root/src_3" style="left:0px; top:55px; width:100px; height:18px; ">
					<script type="javascript" ev:event="onkeypress">
						<![CDATA[					
					if(event.keycode == "13"){
						button8.dispatch("onclick");
					}
					model.setFocus("input2",false);
					]]>
					</script>
				</input>
			</case>
		</switch>
		<group id="group1" class="gro_sel" style="left:11px; top:155px; width:926px; height:180px; ">
			<caption id="caption17" class="list_cap02" style="left:0px; top:100px; width:926px; height:26px; "/>
			<caption id="caption15" class="list_cap02" style="left:0px; top:125px; width:926px; height:26px; "/>
			<caption id="caption21" class="list_cap02" style="left:0px; top:50px; width:926px; height:26px; "/>
			<caption id="caption8" class="list_cap02" style="left:0px; top:25px; width:926px; height:26px; "/>
			<caption id="caption13" class="list_cap02" style="left:0px; top:150px; width:926px; height:26px; "/>
			<caption id="caption7" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; "/>
			<caption id="caption9" class="list_cap03" style="left:0px; top:0px; width:110px; height:26px; ">대상거래처</caption>
			<input id="dlco_clsf_cd" ref="/root/reqData/formData/dlco_clsf_cd" class="input_50" navindex="7" style="left:113px; top:4px; width:50px; height:18px; "/>
			<select1 id="combo1" ref="/root/reqData/formData/mang_clsf_cd" class="combo_140" navindex="10" appearance="minimal" editmode="inputsearch" itemcount="8" style="left:113px; top:29px; width:140px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/dataSet/MANGCLSFCDLIST/record">
						<label ref="cccdynm"/>
						<value ref="cccodeval"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(combo1, combo1.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(combo1,"");
							return;
						}
					]]>
				</script>
			</select1>
			<select1 id="combo2" ref="/root/reqData/formData/slip_clsf_cd" class="combo_100" navindex="21" appearance="minimal" editmode="inputsearch" itemcount="8" style="left:113px; top:154px; width:100px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/dataSet/SLIPCLSFCDLIST/record">
						<label ref="cccdynm"/>
						<value ref="cccodeval"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(combo2, combo2.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(combo2,"");
							return;
						}					
					]]>
				</script>
			</select1>
			<caption id="caption10" class="list_cap03" style="left:458px; top:0px; width:110px; height:26px; ">대상매체</caption>
			<caption id="caption16" class="list_cap03" style="left:0px; top:25px; width:110px; height:26px; ">대상관리구분</caption>
			<select id="checkbox1" ref="/root/reqData/formData/drcr_clsf1" overflow="visible" appearance="full" cols="2" rows="1" style="left:250px; top:155px; width:91px; height:15px; border-style:none; ">
				<choices>
					<item>
						<label>차변발생분</label>
						<value>1</value>
					</item>
				</choices>
			</select>
			<caption id="caption18" class="list_cap03" style="left:0px; top:150px; width:110px; height:26px; ">전표구분</caption>
			<select1 id="medi_cd" ref="/root/reqData/formData/medi_cd" class="combo_140" navindex="9" appearance="minimal" editmode="inputsearch" itemcount="8" style="left:571px; top:4px; width:140px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/dataSet/MEDICDLIST/record">
						<label ref="cccdynm"/>
						<value ref="cccodeval"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(medi_cd, medi_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(medi_cd,"");
							return;
						}else{
							dtls_medi_cd.value = "";
						}
					]]>
				</script>
			</select1>
			<input id="dlco_cd" ref="/root/reqData/formData/dlco_cd" class="input_100" navindex="8" inputtype="button" style="left:186px; top:4px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					
					//if (dlco_clsf_cd.value =="92") { //2012.01.12
					var orgStr = model.getValue("/root/initData/dataSet/xx_dlco_clsf_cd");
					if(instr_yn(orgStr, dlco_clsf_cd.value)){
						var var_con_date = "";

						gstr_popupid = "dlco_cd";

						if (frfisc_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = frfisc_dt.value.length;
							if(num_ch == 8){
								var_con_date = frfisc_dt.value;
							}else if(num_ch == 6){
								var_con_date = frfisc_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = frfisc_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "S");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					} else {
						gstr_popupid = "dlco_cd";
						if (open_fc_acct_1180("button","s","","1")) {
							//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
							fn_dlco_check();
						}
						else {
							//팝업에서 취소 버튼을 누른 경우
						}
					}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					
					//if (dlco_clsf_cd.value == "92") { //2012.01.12
					var orgStr = model.getValue("/root/initData/dataSet/xx_dlco_clsf_cd");
					if(instr_yn(orgStr, dlco_clsf_cd.value)){	
						var var_con_date = "";

						if (frfisc_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = frfisc_dt.value.length;
							if(num_ch == 8){
								var_con_date = frfisc_dt.value;
							}else if(num_ch == 6){
								var_con_date = frfisc_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = frfisc_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (dlco_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
//							model.setValue("/root/reqData/searchData/emp_no", "");
							model.setValue("/root/reqData/fwdData/dept_cd", dlco_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "S");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								dlco_cd_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								dlco_cd.value = "";
								dlco_cd_nm.value = "";
							}
						}
						else {
							dlco_cd.value = "";
							dlco_cd_nm.value = "";
						}	
					} else {
						gstr_popupid = "dlco_cd";
						if (open_fc_acct_1180("focus","s","","1")) {
							//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
							fn_dlco_check();
						}
						else {
							//팝업에서 취소 버튼을 누른 경우
						}
					}
					]]>
				</script>
			</input>
			<caption id="caption14" style="left:168px; top:3px; width:12px; height:18px; font-weight:bold; ">~</caption>
			<input id="dlco_cd_nm" ref="/root/resData1/dlco_cd_nm" class="input_150" editable="false" style="left:291px; top:4px; width:150px; height:18px; "/>
			<caption id="caption19" class="list_cap03" style="left:458px; top:25px; width:110px; height:26px; ">대상행사코드</caption>
			<input id="evnt_cd_nm" ref="/root/resData1/evnt_cd_nm" class="input_150" editable="false" style="left:677px; top:29px; width:150px; height:18px; "/>
			<input id="evnt_cd" ref="/root/reqData/formData/evnt_cd" class="input_100" navindex="12" inputtype="button" style="left:571px; top:29px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[model1.removeNodeset("/root/reqData/fwdData");  
						model1.makeNode("/root/reqData/fwdData/cmpy_cd");
						model1.makeNode("/root/reqData/fwdData/G_Tag");						
						model1.makeNode("/root/reqData/fwdData/G_Caption");
						model1.makeNode("/root/reqData/fwdData/cd");
						model1.makeNode("/root/reqData/fwdData/cdnm");
						model1.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
						model1.setValue("/root/reqData/fwdData/G_Tag", model.getValue("/root/initData/dataSet/xx_g_tag"));
						model1.setValue("/root/reqData/fwdData/G_Caption", "행사코드조회");
						model1.setValue("/root/reqData/fwdData/cd",model1.getValue("/root/reqData/formData/evnt_cd"));
						model1.setValue("/root/reqData/fwdData/cdnm",model1.getValue("/root/resData1/dlco_cd_nm"));						
					
						gstr_popupid = "evnt_cd";
					
						window.load("../../mc/co/MC_CO_1000.xrw"
									, "modal"
									, ""
									, "left:100; top:100; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:visible;"
								,"/root/reqData/fwdData"
								,"/root/reqData/fwdData"
								)						
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(model1.getValue("/root/reqData/searchData/evnt_cd").length == 10){
						 	model1.setValue("/root/reqData/searchData/cd",model1.getValue("/root/reqData/searchData/evnt_cd"));
						 	model1.setValue("/root/reqData/formData/evnt_cd","");
							model1.send("mc_co_1006_l");
							model1.setValue("/root/reqData/searchData/evnt_cd_nm", model1.getValue("/root/resData/resform/dataSet/CURLIST/record[1]/cdnm"));
							evnt_cd_nm.refresh();
						}
						else{
							model1.setValue("/root/resData1/evnt_cd_nm","");
							evnt_cd_nm.refresh();
						}					
					]]>
				</script>
			</input>
			<caption id="caption22" class="list_cap03" style="left:0px; top:50px; width:110px; height:26px; ">대상청구부서</caption>
			<input id="clam_dept_cd" ref="/root/reqData/formData/clam_dept_cd" class="input_100" navindex="13" inputtype="button" maxlength="6" style="left:113px; top:54px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						
						var var_con_date = "";

						gstr_popupid = "clam_dept_cd";

						if (frfisc_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = frfisc_dt.value.length;
							if(num_ch == 8){
								var_con_date = frfisc_dt.value;
							}else if(num_ch == 6){
								var_con_date = frfisc_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = frfisc_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "S");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var var_con_date = "";

						if (frfisc_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = frfisc_dt.value.length;
							if(num_ch == 8){
								var_con_date = frfisc_dt.value;
							}else if(num_ch == 6){
								var_con_date = frfisc_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = frfisc_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (clam_dept_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
//							model.setValue("/root/reqData/searchData/emp_no", "");
							model.setValue("/root/reqData/fwdData/dept_cd", clam_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "S");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								clam_dept_cd_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								clam_dept_cd.value = "";
								clam_dept_cd_nm.value = "";
							}
						}
						else {
							clam_dept_cd.value = "";
							clam_dept_cd_nm.value = "";
						}	
					]]>
				</script>
			</input>
			<caption id="caption23" class="list_cap02" style="left:0px; top:75px; width:926px; height:26px; "/>
			<caption id="caption24" class="list_cap03" style="left:0px; top:100px; width:110px; height:26px; ">금액 FR-TO</caption>
			<input id="clam_dept_cd_nm" ref="/root/resData1/clam_dept_cd_nm" class="input_150" editable="false" style="left:219px; top:54px; width:150px; height:18px; "/>
			<input id="incmg_emp_no" ref="/root/reqData/formData/incmg_emp_no" class="input_100" navindex="19" inputtype="button" style="left:571px; top:104px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model1.removeNodeset("/root/reqData/fwdData");  
						model1.makeNode("/root/reqData/fwdData/func_nm");
						model1.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (incmg_emp_no.value.length == 6) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/emp_no");
							model.setValue("/root/reqData/fwdData/emp_no", incmg_emp_no.value);
							model.send("hd_com_1002");
							
							if (model.getValue("/root/totalcnt") != "0") {								
								incmg_emp_no_nm.value = model.getValue("/root/tempData/record/nm_korn");
							}
							else {
								incmg_emp_no.value = "";
								incmg_emp_no_nm.value = "";
							}
						}		
						else {
							incmg_emp_no.value = "";
							incmg_emp_no_nm.value = "";
						}

						model.removeNodeset("/root/totalcnt");					
					]]>
				</script>
			</input>
			<input id="incmg_emp_no_nm" ref="/root/resData1/incmg_emp_no_nm" class="input_150" editable="false" style="left:677px; top:104px; width:150px; height:18px; "/>
			<caption id="caption11" class="list_cap03" style="left:458px; top:100px; width:110px; height:26px; ">입력자사번</caption>
			<input id="input14" ref="/root/reqData/formData/dr_amt" class="input_100" navindex="17" format="(-)#,###" style="left:112px; top:104px; width:100px; height:18px; "/>
			<input id="input15" ref="/root/reqData/formData/crdt_amt" class="input_100" navindex="18" format="(-)#,###" style="left:216px; top:104px; width:100px; height:18px; "/>
			<select id="checkbox2" ref="/root/reqData/formData/drcr_clsf2" overflow="visible" appearance="full" cols="2" rows="1" style="left:345px; top:155px; width:100px; height:15px; border-style:none; ">
				<choices>
					<item>
						<label>대변발생분</label>
						<value>9</value>
					</item>
				</choices>
			</select>
			<input id="dtls_medi_cd" ref="/root/reqData/formData/dtls_medi_cd" inputtype="button" maxlength="10" style="left:717px; top:4px; width:90px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						if(getProperty("ss_cmpycd") == "100"){
							
							if (medi_cd.value == "110") {
					
								var cd   =  "";
								var cdnm =  "";
															
								var resultRef1 = "/root/reqData/formData/dtls_medi_cd";
								var resultRef2 = "/root/reqData/formData/dtls_medi_cd_nm";							
	
								showCommonCodePopup1("03", "30", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
		
								model.refresh();
							} else if (medi_cd.value == "610") {
						
								var cd   =  "";
								var cdnm =  "";
															
								var resultRef1 = "/root/reqData/formData/dtls_medi_cd";
								var resultRef2 = "/root/reqData/formData/dtls_medi_cd_nm";							
	
								showCommonCodePopup1("06", "077", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
		
								model.refresh();
							}
							else if (medi_cd.value != "") {
								
								model.removeNodeset("/root/reqData/fwdData");  
								
								model.makeNode("/root/reqData/fwdData/cmpy_cd");
								model.makeNode("/root/reqData/fwdData/G_Tag");
								model.makeNode("/root/reqData/fwdData/G_Caption");
								model.makeNode("/root/reqData/fwdData/G_Codenu");
								model.makeNode("/root/reqData/fwdData/G_BRCode");
								
								model.setValue("/root/reqData/fwdData/cmpy_cd", getProperty("ss_cmpycd"));
								model.setValue("/root/reqData/fwdData/G_Tag", "3");
								model.setValue("/root/reqData/fwdData/G_Caption", "상세매체코드조회");
								model.setValue("/root/reqData/fwdData/G_Codenu", medi_cd.value.substring(0, 3));					
								model.setValue("/root/reqData/fwdData/G_BRCode", "");
		
								gstr_popupid = "dtls_medi_cd";
								window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData")
							}
							
						}else if(getProperty("ss_cmpycd") == "500"){							
							/*2012.01.20*/
							//model.setValue("/root/reqData/fwdData/job_clsf", "00"); //필수항목
							//model.setValue("/root/reqData/fwdData/cd_clsf", "01"); //필수항목
							model.makeNode("/root/reqData/fwdData/cd");
							model.setValue("/root/reqData/fwdData/cd",  medi_cd.value);
							//model.setValue("/root/reqData/fwdData/cdnm", medi_cd_nm.value);

							//model.setValue("/root/reqData/fwdData/resultRef1", "/root/resData/resform/dtls_medi_cd");
							//model.setValue("/root/reqData/fwdData/resultRef2", "/root/resData/resform/dtls_medi_cd_nm");	
							
							if(instance1.selectSingleNode("/root/reqData/fwdData/resultRef1") == null){
								model.makeNode("/root/reqData/fwdData/resultRef1");
							}
							model.setValue("/root/reqData/fwdData/resultRef1", "/root/reqData/formData/dtls_medi_cd");									
									
							window.load(
								 "/xrw/co/cocd/CO_COCD_1400.xrw"
								,"modal"
								,""
								,"caption:hidden;align:center;width:455px; height:425px;"
								,"/root/reqData/fwdData"
								,"/root/reqData/searchData"
							);		
							
						}else if(getProperty("ss_cmpycd") == "207"){							
							
							gstr_popupid = "dtls_medi_cd";
							open_fc_acct_1180("button","s");	
							
						}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if (medi_cd.value != "") {
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cd");
						model.makeNode("/root/reqData/fwdData/medi_cd");
						model.setValue("/root/reqData/fwdData/cd", dtls_medi_cd.value);
						model.setValue("/root/reqData/fwdData/medi_cd",medi_cd.value);
						model.send("fc_acct_2015_l");

						if (model.getValue("/root/tempData/fc_acct_2015_l/dataSet/CURLIST/record/cd") != "") {
							
						}
						else {
							dtls_medi_cd.value = "";
						}
					}else{
						dtls_medi_cd.value = "";
					}

					]]>
				</script>
			</input>
			<select1 id="combo3" ref="/root/reqData/formData/to_mang_clsf_cd" class="combo_140" navindex="11" appearance="minimal" editmode="inputsearch" itemcount="8" style="left:278px; top:29px; width:140px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/dataSet/MANGCLSFCDLIST/record">
						<label ref="cccdynm"/>
						<value ref="cccodeval"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(combo1, combo1.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(combo1,"");
							return;
						}
					]]>
				</script>
			</select1>
			<caption id="caption12" style="left:260px; top:30px; width:15px; height:20px; ">~</caption>
			<input id="to_clam_dept_cd_nm" ref="/root/resData1/to_clam_dept_cd_nm" class="input_150" editable="false" style="left:677px; top:55px; width:150px; height:18px; "/>
			<input id="to_clam_dept_cd" ref="/root/reqData/formData/to_clam_dept_cd" class="input_100" navindex="14" inputtype="button" maxlength="6" style="left:571px; top:55px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						
						var var_con_date = "";

						gstr_popupid = "to_clam_dept_cd";

						if (frfisc_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = frfisc_dt.value.length;
							if(num_ch == 8){
								var_con_date = frfisc_dt.value;
							}else if(num_ch == 6){
								var_con_date = frfisc_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = frfisc_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "S");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var var_con_date = "";

						if (frfisc_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = frfisc_dt.value.length;
							if(num_ch == 8){
								var_con_date = frfisc_dt.value;
							}else if(num_ch == 6){
								var_con_date = frfisc_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = frfisc_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (to_clam_dept_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
//							model.setValue("/root/reqData/searchData/emp_no", "");
							model.setValue("/root/reqData/fwdData/dept_cd", to_clam_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "S");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								to_clam_dept_cd_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								to_clam_dept_cd.value = "";
								to_clam_dept_cd_nm.value = "";
							}
						}
						else {
							to_clam_dept_cd.value = "";
							to_clam_dept_cd_nm.value = "";
						}	
					]]>
				</script>
			</input>
			<caption id="caption20" style="left:460px; top:55px; width:15px; height:20px; ">~</caption>
			<caption id="caption25" style="left:460px; top:80px; width:15px; height:20px; ">~</caption>
			<caption id="caption27" class="list_cap03" style="left:0px; top:75px; width:110px; height:26px; ">대상사용부서</caption>
			<input id="use_dept_cd_nm" ref="/root/resData1/use_dept_cd_nm" class="input_150" editable="false" style="left:219px; top:79px; width:150px; height:18px; "/>
			<input id="to_use_dept_cd_nm" ref="/root/resData1/to_use_dept_cd_nm" class="input_150" editable="false" style="left:677px; top:80px; width:150px; height:18px; "/>
			<input id="to_use_dept_cd" ref="/root/reqData/formData/to_use_dept_cd" class="input_100" navindex="16" inputtype="button" maxlength="6" style="left:571px; top:80px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						
						var var_con_date = "";

						gstr_popupid = "to_use_dept_cd";

						if (frfisc_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = frfisc_dt.value.length;
							if(num_ch == 8){
								var_con_date = frfisc_dt.value;
							}else if(num_ch == 6){
								var_con_date = frfisc_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = frfisc_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "S");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var var_con_date = "";

						if (frfisc_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = frfisc_dt.value.length;
							if(num_ch == 8){
								var_con_date = frfisc_dt.value;
							}else if(num_ch == 6){
								var_con_date = frfisc_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = frfisc_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (to_use_dept_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
//							model.setValue("/root/reqData/searchData/emp_no", "");
							model.setValue("/root/reqData/fwdData/dept_cd", to_use_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "S");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								to_use_dept_cd_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								to_use_dept_cd.value = "";
								to_use_dept_cd_nm.value = "";
							}
						}
						else {
							to_use_dept_cd.value = "";
							to_use_dept_cd_nm.value = "";
						}	
					]]>
				</script>
			</input>
			<input id="use_dept_cd" ref="/root/reqData/formData/use_dept_cd" class="input_100" navindex="15" inputtype="button" maxlength="6" style="left:113px; top:79px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						
						var var_con_date = "";

						gstr_popupid = "use_dept_cd";

						if (frfisc_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = frfisc_dt.value.length;
							if(num_ch == 8){
								var_con_date = frfisc_dt.value;
							}else if(num_ch == 6){
								var_con_date = frfisc_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = frfisc_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}
							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "S");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var var_con_date = "";

						if (frfisc_dt.value == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = frfisc_dt.value.length;
							if(num_ch == 8){
								var_con_date = frfisc_dt.value;
							}else if(num_ch == 6){
								var_con_date = frfisc_dt.value + "01";
							}else if(num_ch == 4){
								var_con_date = frfisc_dt.value + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (use_dept_cd.value.length== 6) {
							
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/dept_cd");
							model.makeNode("/root/reqData/fwdData/select_ch");
							model.makeNode("/root/reqData/fwdData/use_end_dt");
//							model.setValue("/root/reqData/searchData/emp_no", "");
							model.setValue("/root/reqData/fwdData/dept_cd", use_dept_cd.value);
							model.setValue("/root/reqData/fwdData/select_ch", "S");
							model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								use_dept_cd_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								use_dept_cd.value = "";
								use_dept_cd_nm.value = "";
							}
						}
						else {
							use_dept_cd.value = "";
							use_dept_cd_nm.value = "";
						}	
					]]>
				</script>
			</input>
			<input id="input7" ref="/root/reqData/formData/remk" class="input_500" navindex="20" imemode="hangul" style="left:112px; top:129px; width:336px; height:18px; "/>
			<caption id="caption28" class="list_cap03" style="left:0px; top:125px; width:110px; height:26px; ">적요</caption>
			<caption id="caption29" class="list_cap03" style="left:458px; top:150px; width:110px; height:26px; ">소득구분</caption>
			<select1 id="combo4" ref="/root/reqData/formData/incm_clsf_cd" class="combo_140" navindex="21" appearance="minimal" editmode="inputsearch" itemcount="8" style="left:572px; top:154px; width:98px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/dataSet/INCMCLSFCDLIST/record">
						<label ref="cccdynm"/>
						<value ref="cccodeval"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(combo2, combo2.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(combo2,"");
							return;
						}					
					]]>
				</script>
			</select1>
			<select1 id="radio1" ref="/root/reqData/formData/slip_aprv_yn" navindex="0" appearance="full" cellspacing="5" cols="3" rows="1" vcellspacing="8" overflow="visible" style="left:570px; top:126px; width:155px; height:20px; border-style:none; ">
				<choices>
					<item>
						<label>미승인</label>
						<value>1</value>
					</item>
					<item>
						<label>승인</label>
						<value>2</value>
					</item>
					<item>
						<label>ALL</label>
						<value>ALL</value>
					</item>
				</choices>
			</select1>
			<caption id="caption30" class="list_cap03" style="left:458px; top:125px; width:110px; height:26px; ">승인여부</caption>
			<input id="prop_equip_cd" ref="/root/reqData/formData/prop_equip_cd" navindex="11" inputtype="button" maxlength="4" style="left:830px; top:154px; width:65px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
								
						var cd   =  "";
						var cdnm =  "";
							
						//var resultRef1 = "/root/resData/resform/prop_equip_cd";
						//var resultRef2 = "/root/resData/resform/prop_equip_cd_nm";
						
						var resultRef1 = "/root/reqData/formData/prop_equip_cd";
						var resultRef2 = "/root/resData1/prop_equip_cd_nm";
						
						showCommonCodePopup1("00", "12", cd, cdnm, "N", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(prop_equip_cd.value.length == 4 ){
							model.removeNodeset("/root/reqData/fwdData");  
							model.removeNodeset("/root/tempData/dataSet");  
							model.makeNode("/root/reqData/fwdData/job_clsf");
							model.makeNode("/root/reqData/fwdData/cd_clsf");
							model.makeNode("/root/reqData/fwdData/cd");
							model.setValue("/root/reqData/fwdData/job_clsf", "00");
							model.setValue("/root/reqData/fwdData/cd_clsf", "12");
							model.setValue("/root/reqData/fwdData/cd", prop_equip_cd.value);

							model.send("fc_co_8000_s");
							
							if (Number(model.getValue("/root/tempData/dataSet/CURLIST1/totalcnt")) != 1) {
								prop_equip_cd.value = "";
							}
						}
						else { prop_equip_cd.value = ""; }
					]]>
				</script>
			</input>
			<caption id="caption33" class="list_cap03" style="left:715px; top:150px; width:110px; height:26px; ">영수증구분</caption>
		</group>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:50px; width:926px; height:21px; ">
			<button id="btn_select" class="btn02" navindex="17" crud="R" style="left:706px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if((frbudg_cd.value=="") || (tobudg_cd.value=="")) {
							show_message("예산코드는 필수입력항목입니다.");
							return false;
						}
						if((frfisc_dt.value=="") || (tofisc_dt.value=="")) {
							show_message("대상기간은 필수입력항목입니다.");
							return false;
						}
						
						var date_diff;
						date_diff = get_datediff(frfisc_dt.value,tofisc_dt.value);

						if(date_diff > 366){
							show_message("1년이 초과하는 자료는 조회할 수 없습니다.");
							return;
						}
						
						//datagrid1.removeRow(true);
						//alert("ffff");
						model1.send("fc_acct_2481_l",true);
						
						totalcnt = model.getValue("/root/resData/dataSet/CURLIST/totalcnt");
						if (totalcnt == 0) {
	//						model.reset();
							show_message("검색결과가 없습니다.");
						}
						datagrid1.refresh();
					]]>
				</script>
			</button>
			<button id="btn_pop" class="btn02" crud="R" style="left:761px; top:0px; width:52px; height:21px; ">
				<caption>건별조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
//						if(get_refvalue("/root/resData/dataSet/CURLIST/record["+datagrid1.row+"]/slip_no") !=""){
//							open_fc_acct_2470("button","s","","0",false);	
//						}

						var slip_no; 
						if(get_refvalue("/root/resData/dataSet/CURLIST/record["+datagrid1.row+"]/slip_no") !=""){
							slip_no = get_refvalue("/root/resData/dataSet/CURLIST/record["+datagrid1.row+"]/slip_no")
							model.property("FC_ACCT_2470_srch_slip_occr_dt")  = slip_no.substring(0,8);
							model.property("FC_ACCT_2470_srch_slip_clsf_cd") =  slip_no.substring(9,11);
							model.property("FC_ACCT_2470_srch_slip_seq") = slip_no.substring(12,15);
							model.property("FC_ACCT_2470_srch_slip_sub_seq") = slip_no.substring(16,17);
													
							model.property("FC_ACCT_2470_popup_flag")  = "Y";
	
//							viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2470");
							viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2470");
						}	
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" crud="R" style="left:816px; top:0px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="DOMActivate">
					<![CDATA[
					//var grid = null;
					
					//if(_oth_clsf == "1"){			
					//	grid = datagrid1;
					//}
					
					//var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					//if(filename!=""){
					//	grid.saveExcel(filename, "sheetname: ");
					//}
					//progressBarStart();
					//model1.send("fc_acct_2482_l");
					//progressBarEnd();
					//model.alert("다운로드가 완료되었습니다.");
					//return;
					

					var cnt = parseInt(datagrid1.rows)-1;

					if(cnt==""){
					
						progressBarStart();
						model1.send("fc_acct_2482_l");
						progressBarEnd();
						model.alert("다운로드가 완료되었습니다.");
						return;
					
					}else{					
					
						if (cnt > 49999){//50000건 이상일경우 
							progressBarStart();
							model1.send("fc_acct_2482_l");
							//window.load("http://ciis.chosun.com/tn/rpt/1650","html","","","/root/reqData/searchData","/root/msgData");
							progressBarEnd();
							model.alert("다운로드가 완료되었습니다.");
							return;
						}else{
							var filePath = window.fileDialog("save", "", false, "", "xls", "Excel Files(*.xls)|*.xls");						
							if(filePath != "") {
								datagrid1.saveExcel(filePath);
							window.exec(filePath);
							}
						}
					}
					
					
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:871px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					formClose();
					]]>
				</script>
			</button>
		</group>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
	</xhtml:body>
</xhtml:html>
