<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>송금지불승인(FC_ACCT_2900)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
							<fc_acct_2340_m>
								<dataSet>
									<CURLIST1>
										<record>
											<cd_nm/>
											<cd/>
										</record>
									</CURLIST1>
									<CURLIST2>
										<record>
											<cd_nm/>
											<cd/>
										</record>
									</CURLIST2>
									<CURLIST3>
										<record>
											<budg_cd/>
											<budg_abrv_nm/>
										</record>
									</CURLIST3>
									<CURLIST4>
										<record>
											<cd/>
											<cd_abrv_nm/>
										</record>
									</CURLIST4>
									<xx_slip_occr_clsf/>
									<xx_srch_slip_clsf_cd_61/>
									<xx_budg_cd1_010/>
								</dataSet>
							</fc_acct_2340_m>
							<!--2012.01.11 수정
							<CURLIST>
								<record>
									<cd_nm/>
									<cd/>
								</record>
								<record>
									<cd_nm>001100 현금</cd_nm>
									<cd>001100</cd>
								</record>
								<record>
									<cd_nm>011400 보통예금</cd_nm>
									<cd>011400</cd>
								</record>
								<record>
									<cd_nm>017500 기업자유예금</cd_nm>
									<cd>017500</cd>
								</record>
							</CURLIST>
							-->
						</comboSet>
					</initData>
					<reqData>
						<searchData>
							<cmpy_cd/>
							<slip_occr_clsf/>
							<rmtt_dd/>
							<calc_amt_sum/>
							<slip_no/>
							<incmg_dt/>
							<aprv_slip_no/>
							<incmg_emp_no/>
							<incmg_emp_nm/>
							<aprv_yn/>
							<acct_rmtt_dt/>
							<aprv_slip_occr_dt/>
							<aprv_slip_clsf/>
							<aprv_slip_occr_seqo/>
							<aprv_slip_occr_sub_seq/>
						</searchData>
						<detail>
							<cmpy_cd/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
						</detail>
						<multiupdateData>
							<multiUpDate/>
							<fisc_dt/>
							<incmg_emp_no/>
							<use_dept_cd/>
							<incmg_dt/>
							<budg_cd1/>
							<mang_clsf_cd1/>
						</multiupdateData>
						<reqForm>
							<chk1/>
							<aprv_slip_occr_dt/>
							<aprv_slip_clsf_cd/>
							<aprv_slip_seq/>
							<aprv_slip_sub_seq/>
							<incmg_emp_no/>
						</reqForm>
					</reqData>
					<resData>
						<errcode/>
						<errmsg/>
						<totalcnt/>
						<resForm>
							<fc_acct_2902_u>
								<dataSet>
									<CURLIST>
										<record>
											<slip_occr_dt/>
											<slip_clsf_cd/>
											<slip_seq/>
											<slip_sub_seq/>
											<slip_no/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_2902_u>
							<fc_acct_2907_i>
								<dataSet>
									<CURLIST>
										<record>
											<aprv_slip_occr_dt/>
											<aprv_slip_clsf/>
											<aprv_slip_occr_seqo/>
											<aprv_slip_occr_sub_seq/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_2907_i>
							<fc_acct_2904_l>
								<dataSet>
									<CURLIST>
										<record>
											<aprv_slip_occr_dt/>
											<aprv_slip_clsf/>
											<aprv_slip_occr_seqo/>
											<aprv_slip_occr_sub_seq/>
											<aprv_slip_no/>
											<aprv_slip_no1/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_2904_l>
						</resForm>
						<gridData>
							<fc_acct_2900_l>
								<dataSet>
									<RMTT_PAY_LIST>
										<record>
											<check1/>
											<slip_no/>
											<slip_occr_dt/>
											<slip_clsf_cd/>
											<slip_seq/>
											<slip_sub_seq/>
											<clam_dept/>
											<ptcr/>
											<amt/>
											<src_tax/>
											<calc_amt/>
											<rmtt_cnt/>
											<cmpy_cd/>
										</record>
									</RMTT_PAY_LIST>
								</dataSet>
							</fc_acct_2900_l>
							<fc_acct_2901_l>
								<dataSet>
									<SRC_TAX_LIST>
										<record>
											<check1/>
											<dlco_nm/>
											<dlco_cd/>
											<atic_fee/>
											<incm_clsf_nm/>
											<incm_tax/>
											<res_tax/>
											<cal_pay_amt/>
										</record>
									</SRC_TAX_LIST>
								</dataSet>
							</fc_acct_2901_l>
							<fc_acct_2906_l>
								<dataSet>
									<CURLIST>
										<record>
											<chk/>
											<budg_cd/>
											<budg_nm/>
											<rmks2/>
											<cnt/>
											<dr_amt/>
											<clam_dept_cd/>
											<mang_clsf_cd/>
											<boks_dlco_nm/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_2906_l>
						</gridData>
						<MsgData/>
					</resData>
					<tempData>
						<calc_amt/>
						<slip_no/>
					</tempData>
				</root>
			</instance>
			<submission id="fc_acct_2900_l" action="/fc/acct2000/2900" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/fc_acct_2900_l/dataSet"/>
			<submission id="fc_acct_2901_l" action="/fc/acct2000/2901" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/detail" resultref="/root/resData/gridData/fc_acct_2901_l/dataSet"/>
			<submission id="fc_acct_2902_u" action="/fc/acct2000/2902" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiupdateData" resultref="/root/resData/resForm/fc_acct_2902_u/dataSet"/>
			<submission id="fc_acct_2903_d" action="/fc/acct2000/2903" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiupdateData" resultref="/root/resData/MsgData"/>
			<submission id="fc_acct_2904_l" action="/fc/acct2000/2904" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/resForm/fc_acct_2904_l/dataSet"/>
			<submission id="fc_acct_2905_l" action="/fc/acct2000/2905" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/fc_acct_2906_l/dataSet"/>
			<submission id="fc_acct_2906_l" action="/fc/acct2000/2906" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/fc_acct_2906_l/dataSet"/>
			<submission id="fc_acct_2907_i" action="/fc/acct2000/2907" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/multiupdateData" resultref="/root/resData/resForm/fc_acct_2907_i/dataSet"/>
			<submission id="fc_acct_2908_d" action="/fc/acct2000/2908" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/reqForm" resultref="/root/resData/MsgData"/>
			<submission id="hd_com_1002" action="/hd/com/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData"/>
			<submission id="fc_acct_2340_m" action="/fc/acct2000/2340" mediatype="application/x-www-form-urlencoded" method="post" resultref="/root/initData/comboSet/fc_acct_2340_m/dataSet"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					init_controls();
					set_column_visibility();
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[				
					set_refvalue("/root/reqData/searchData/rmtt_dd",commCurDate());
					set_refvalue("/root/reqData/searchData/incmg_dt",commCurDate());
					set_refvalue("/root/reqData/searchData/incmg_emp_no",getProperty("ss_emp_no"));
					set_refvalue("/root/reqData/searchData/incmg_emp_nm",getProperty("ss_emp_nm"));

					send_fc_acct_2340_m();

					if(getProperty("ss_cmpycd") == "100"){ 	//조선일보의 경우 상대예산 콤보 현금으로 고정
						//budg_cd1.value = "001100"; //2011.01.11
						budg_cd1.select(0);
						budg_cd1.disabled = true;
						mang_clsf_cd1.value = "";
						mang_clsf_cd1.disabled = true;						
					}
										
					srch_rmtt_dd.dispatch("xforms-value-changed");
					srch_aprv_slip_no.disabled = true;
					group_scr.refresh();
				]]>
			</script>
		</model>
		<script type="javascript" src="/js/TFCommon.js"/>
		<script type="javascript" src="/js/CIISComm.js"/>
		<script type="javascript" src="/js/fcmc_common.js"/>
		<script type="javascript">
			<![CDATA[
				var	_oth_clsf = "1";
				
				function set_column_visibility() {
					//모든 컬럼을 감춘다.
					hide_all_columns(datagrid1);
					hide_all_columns(datagrid2);					
					//공통 컬럼을 보여준다.
					show_columns(datagrid1,"1,2,3,4,5,6,7,8");	
					show_columns(datagrid2,"1,2,3,4,5,6");
				}
				function init_controls() {
					set_default(
						datagrid1
					,	datagrid2
					);					//datagrid
					set_default(
						srch_calc_amt_sum
					,	srch_slip_no
					,	incmg_emp_no
					,	incmg_emp_nm
					,	aprv_yn
					);			//input
					set_default(
						srch_rmtt_dd
					,	srch_incmg_dt
					);			//input date
					set_default(
//						srch_slip_clsf_cd
						srch_aprv_slip_no
					,	budg_cd1
					,	mang_clsf_cd1					
					);			//combo	

					set_format(
						"string_l"
					,	datagrid1			,"3,4"
					,	datagrid2			,"3,9"
					,	srch_slip_clsf_cd
					,	srch_slip_no
					,	srch_aprv_slip_no
					,	incmg_emp_nm
					,	budg_cd1
					,	mang_clsf_cd1
					);
					set_format(
						"string_c"
					,	datagrid1			,"1,2"
					,	datagrid2			,"1,2,7,8"
					,	incmg_emp_no
					,	aprv_yn					
					);
					set_format(
						"number4"
					,	datagrid1			,"5,6,7,8"
					,	datagrid2			,"5,6"					
					,	srch_calc_amt_sum
					);
					set_format(
						"date_1"
					,	datagrid2			,"4"
					,	srch_rmtt_dd
					,	srch_incmg_dt
					);			
				}
				function send_fc_acct_2340_m(){
					model.send("fc_acct_2340_m");
					makeComboGubun("","/root/initData/comboSet/fc_acct_2340_m/dataSet/CURLIST2","record","cd_nm", "cd");
					makeComboGubun("","/root/initData/comboSet/fc_acct_2340_m/dataSet/CURLIST3","record","budg_abrv_nm", "budg_cd");
					makeComboGubun("","/root/initData/comboSet/fc_acct_2340_m/dataSet/CURLIST4","record","cd_abrv_nm", "cd");
				}									
				/**
				 * @function   :  cfDetailView
				 * @access : public
				 * @desc   : 두개의 노드를 비교해서 같은 엘리먼트가 있으면 값을 복사한다.
				 * @sig    : datagridID, f_set
				 * @param  : f_set  - 복사될 곳의 위치
				 * @param  : datagridID  - 선택한 행의 그리드ID
				 * @return : 없음. 
				 */ 
				function setEmp_no(emp_no, nm_korn){
					incmg_emp_no.value = emp_no;
					incmg_emp_nm.value = nm_korn;
				}				 
				function cfDetailView(datagridID,f_set) {
				
					if( typeof datagridID == 'string' ) datagridID = document.controls(datagridID);
					var f_get = datagridID.attribute("nodeset")+"["+(datagridID.row-datagridID.fixedRows+1)+"]";
				
					var node = instance1.selectSingleNode(f_get);
					if(node != null){
						var nodeChild = node.childNodes;
						var node_detail = instance1.selectSingleNode(f_set);
						var nodeChild_detail = node_detail.childNodes;
						var tag = "";
						var tag_detail = "";
						var get_value = "";
						var lower_tag = "";
						for(var i = 0; i < nodeChild.length; i ++) {
							tag = nodeChild.item(i).tagname;
							get_value = get_refvalue(f_get+ "/"+ tag);
							for(var y = 0 ; y < nodeChild_detail.length; y ++ ) {			
								tag_detail = nodeChild_detail.item(y).tagname;
								if(tag == tag_detail) { 
									set_refvalue(f_set+ "/"+ tag_detail, get_value);
								}
							}
						}
						model.refresh();
					}									
				}
				//내역조회
				function send_fc_acct_2905_l(){
					if(srch_aprv_slip_no.value == ""){
						show_message("송금일자는 필수입력항목입니다.");
						return false;
					}
					set_refvalue("/root/reqData/searchData/aprv_slip_occr_dt",srch_aprv_slip_no.value.substring(0,8));
					set_refvalue("/root/reqData/searchData/aprv_slip_clsf",srch_aprv_slip_no.value.substring(8,10));
					set_refvalue("/root/reqData/searchData/aprv_slip_occr_seqo",srch_aprv_slip_no.value.substring(10,13));
					set_refvalue("/root/reqData/searchData/aprv_slip_occr_sub_seq",srch_aprv_slip_no.value.substring(13,14));
					
					model.send("fc_acct_2905_l");

					var totalcnt = get_refvalue("/root/resData/gridData/fc_acct_2906_l/dataSet/CURLIST/totalcnt");
					
					if(totalcnt == 0){
						reset_refnode("/root/resData/gridData/fc_acct_2906_l/dataSet");
						show_message("검색결과가 없습니다.");
						return false;
					}

					aprv_yn.value= "지불 승인";
					aprv_yn.attribute("background-color") = "#ff99cc";
					
					btn_insert.disabled = true;
					btn_delete.disabled = false;

					check_all.value = "0";
					check_all.visible = false;

				}
				//대상조회
				function send_fc_acct_2906_l(){
					if(srch_incmg_dt.value == ""){
						show_message("입력일자는 필수입력항목입니다.");
						return false;
					}
					reset_refnode("/root/resData/gridData/fc_acct_2906_l/dataSet");
					datagrid2.refresh();
					
					model.send("fc_acct_2906_l");

					var totalcnt = get_refvalue("/root/resData/gridData/fc_acct_2906_l/dataSet/CURLIST/totalcnt");
					
					if(totalcnt == 0){
						reset_refnode("/root/resData/gridData/fc_acct_2906_l/dataSet");
						show_message("검색결과가 없습니다.");
						return false;
					}

					aprv_yn.value= "지불 미승인";
					aprv_yn.attribute("background-color") = "#ffffff";
					
					btn_insert.disabled = false;
					btn_delete.disabled = true;

					check_all.value = "1";
					check_all.visible = true;
				}
				
				//승인 61제외
				function send_fc_acct_2902_u(){
					var i =0, var_check_row = 0;
					for (i=1; i<datagrid1.rows; i++) {
			 		     	if (datagrid1.rowStatus(i) != 0) {
							var_check_row = var_check_row + 1;
					       }
					}

				      if (var_check_row == 0) {
						show_message("승인할 자료를 선택후  승인버튼을 누르세요.");
				   		return;       
				      }
				
					for(i=1;i<datagrid1.rows;i++){
						if(datagrid1.rowStatus(i) != 0) {
							if(datagrid1.valueMatrix(i,datagrid1.colRef("slip_clsf_cd")) =='91') {
							show_message(" 전표발생구분이 지불인 경우 승인 저장할 수 없습니다.");
							return;
							} 
						}
					}	
					
					if(get_refvalue("/root/reqData/searchData/rmtt_dd")==''){
						show_message("송금지불승인일 경우 송금일자는 필수입력항목입니다.");
						return;
					}
																
					if(datagrid1.rows == 0){
						show_message("송금지불승인 저장할 대상이 없습니다.");
						return;
					}

					if (budg_cd1.value == ""){
						show_message("예산코드는 필수입력 항목입니다.") 
						model.setFocus("budg_cd1");
						return false;
					}									

					set_refvalue("/root/reqData/multiupdateData/multiUpDate", datagrid1.getUpdateData());						
					set_refvalue("/root/reqData/multiupdateData/fisc_dt", get_refvalue("/root/reqData/searchData/rmtt_dd"));

					if (show_message("승인하시겠습니까?","승인 확인",MB_YESNO) != IDYES) {
						return false;
					}

					model.send("fc_acct_2902_u");
				
					if(submit_completed()){
						show_message("승인되었습니다.");
						srch_slip_no.value = get_refvalue("/root/resData/resForm/fc_acct_2902_u/dataSet/CURLIST/record[1]/slip_no");
						btn_select.dispatch("onclick");
						datagrid1.refresh();
					}									
				}
				
				//승인 61
				function send_fc_acct_2907_i(){
					if (srch_slip_clsf_cd.value == ""){
						show_message("전표발생구분은 필수입력 항목입니다.") 
						model.setFocus("srch_slip_clsf_cd");
						return false;
					}
					if (budg_cd1.value == ""){
						show_message("예산코드는 필수입력 항목입니다.") 
						model.setFocus("budg_cd1");
						return false;
					}					
					if (!check_reqItem(srch_rmtt_dd,"trim","focus","송금일자는 필수입력 항목입니다.")) { return false; }
					if (!check_reqItem(incmg_emp_no,"trim","focus","입력자는 필수입력 항목입니다.")) { return false; }

					var i =0, var_check_row = 0;
					for (i=1; i<datagrid2.rows; i++) {
			 		     	if (datagrid2.rowStatus(i) != 0) {
							var_check_row = var_check_row + 1;
					       }
					}

				       if (var_check_row == 0) {
						show_message("승인할 자료를 선택후  승인버튼을 누르세요.");
				   		return;       
				       }
					if(datagrid2.rows == 0){
						show_message("송금지불승인 저장할 대상이 없습니다.");
						return;
					}				       
					set_refvalue("/root/reqData/multiupdateData/incmg_dt",srch_incmg_dt.value);
					set_refvalue("/root/reqData/multiupdateData/fisc_dt",srch_rmtt_dd.value);
					set_refvalue("/root/reqData/multiupdateData/incmg_emp_no", incmg_emp_no.value);
					set_refvalue("/root/reqData/multiupdateData/multiUpDate", datagrid2.getUpdateData());

					if (show_message("승인하시겠습니까?","승인 확인",MB_YESNO) != IDYES) {
						return false;
					}

					model.send("fc_acct_2907_i");
				
					if(submit_completed()){
						show_message("승인되었습니다.");
						srch_aprv_slip_no.value = get_refvalue("/root/resData/resForm/fc_acct_2907_i/dataSet/CURLIST/record[1]/slip_no");
						btn_select.dispatch("onclick");
						srch_rmtt_dd.dispatch("xforms-value-changed");
						datagrid2.refresh();
					}				
				}				
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="1,10;2,10;1,876;1,880;1,914;1,936;2,28;2,39;2,40;2,65;2,705;2,687;2,705;1,495;" style="font-family:굴림; ">
		<datagrid id="datagrid2" nodeset="/root/resData/gridData/fc_acct_2906_l/dataSet/CURLIST/record" caption="선택^예산코드^지불내용^입력일자^건수^금액^부서^관리구분^거래처명" colsep="#" colwidth="50, 100, 150, 100, 120, 120, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:13px; top:170px; width:923px; height:535px; ">
			<col checkvalue="1,0" ref="chk" type="checkbox"/>
			<col ref="budg_cd"/>
			<col ref="budg_nm"/>
			<col ref="rmks2" format="yyyy-mm-dd"/>
			<col ref="cnt"/>
			<col ref="dr_amt"/>
			<col ref="clam_dept_cd"/>
			<col ref="mang_clsf_cd"/>
			<col ref="boks_dlco_nm"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[				
			       		if (get_refvalue("/root/resData/gridData/fc_acct_2906_l/dataSet/CURLIST/record["+datagrid2.row+"]/chk") == "1") {
						datagrid2.addStatus(datagrid2.row, "update");
				        }
				        else {
						datagrid2.removeStatus(datagrid2.row, "update");
				        }

					datagrid2.refresh();
				]]>
			</script>
		</datagrid>
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record" caption="선택^전표번호^청구부서^내역^금액^원천세^차인지급액^송금건수^caption1^caption2^caption3^caption4^caption5" colsep="#" colwidth="50, 125, 100, 257, 90, 90, 90, 90, 10, 10, 10, 10, 10" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:13px; top:170px; width:923px; height:535px; ">
			<col checkvalue="1,0" ref="check1" type="checkbox"/>
			<col ref="slip_no"/>
			<col ref="clam_dept"/>
			<col ref="ptcr"/>
			<col ref="amt" format="(-)#,###"/>
			<col ref="src_tax" format="(-)#,###"/>
			<col ref="calc_amt" format="(-)#,###"/>
			<col ref="rmtt_cnt" format="(-)#,###" style="text-align:right; "/>
			<col ref="slip_occr_dt" visibility="hidden"/>
			<col ref="slip_clsf_cd" visibility="hidden"/>
			<col ref="slip_seq" visibility="hidden"/>
			<col ref="slip_sub_seq" visibility="hidden"/>
			<col ref="cmpy_cd" visibility="hidden"/>
			<script type="javascript" ev:event="onmouseup">
				<![CDATA[
				//alert(datagrid2.selectedRows);
//				var calc_amt_sum = 0 ,calc_amt = 0;
//				cfDetailView(datagrid1, "/root/tempData");	
//
//				calc_amt_sum  = Number(get_refvalue("/root/reqData/searchData/calc_amt_sum"));
//				calc_amt = Number(get_refvalue("/root/tempData/calc_amt"));
//				for(var i=0; i<datagrid1.selectedRows; i++)
//				{
//					var row = datagrid1.selectedRow(i);
//					if(datagrid1.rowStatus(row)==0){
//						datagrid1.addStatus(row,"update");
//						calc_amt_sum = calc_amt_sum + calc_amt;
//					}else{
//						datagrid1.removeStatus(row,"update");
//						calc_amt_sum = calc_amt_sum - calc_amt;
//					}
//					//datagrid2.addStatus(row, "update");
//					//datagrid2.rowHidden(row) = true;
//				}
//				set_refvalue("/root/reqData/searchData/calc_amt_sum",calc_amt_sum);
//				if(get_refvalue("/root/tempData/slip_no") == "91") {
//					set_refvalue("/root/reqData/searchData/slip_no",get_refvalue("/root/tempData/slip_no"));
//				}
//				srch_calc_amt_sum.refresh();
				]]>
			</script>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					//그리드 스크롤바 클릭, 더블클릭 방지 소스
					if (-1 != event.target.lastIndexOf("scroll.thumb")) {
						return;
					}
					
					if (datagrid1.mouseRow < 1) {
						return;
					}
					
					var grid = eval(event.currentTarget);
					var rowid = grid.row;
					var colid = grid.col;
					
					if (rowid < grid.fixedRows || colid < grid.fixedCols) {
						return;
					}				
					cfDetailView(datagrid1, "/root/reqData/detail");
					if(get_refvalue("/root/reqData/detail/cmpy_cd") != ""){
						//alert(get_refvalue("/root/reqData/detail/slip_occr_dt"));
						//model.send("fc_acct_2901_l"	,true);	
						//datagrid2.refresh();
						//model.toggle("case2");
						window.load("/xrw/fc/acct/fc_acct_2901.xrw", "mdi", "",  "left:100; top:100; width:850; height:500; sysmenu:visible; min:visible; max:true; resize:true; caption:visible;","/root/reqData/detail","/root/reqData/detail");
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var tot_amt;
						
						if(srch_calc_amt_sum.value.Trim().length == 0){
							tot_amt = 0;
						}
						else{
							tot_amt = Number(srch_calc_amt_sum.value);
						}
						var calc_amt1 = get_refvalue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record["+datagrid1.row+"]/calc_amt");
						
				       		if (get_refvalue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record["+datagrid1.row+"]/check1") == "1") {
							datagrid1.addStatus(datagrid1.row, "update");
							tot_amt  = tot_amt + Number(calc_amt1);
					        }
					        else {
							datagrid1.removeStatus(datagrid1.row, "update");
							tot_amt  = tot_amt - Number(calc_amt1);
					        }
						 srch_calc_amt_sum.value = tot_amt;

						if(srch_slip_clsf_cd.value == model.getValue("/root/initData/comboSet/fc_acct_2340_m/dataSet/xx_slip_occr_clsf")) {
							if(get_refvalue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record["+datagrid1.row+"]/check1") == "1"){
								set_refvalue("/root/reqData/searchData/slip_no",get_refvalue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record["+datagrid1.row+"]/slip_no"));
							}
							else{
								set_refvalue("/root/reqData/searchData/slip_no","");
							}
						}
						
						srch_calc_amt_sum.refresh();						 
						 datagrid1.refresh();				
				]]>
			</script>
		</datagrid>
		<group id="group_tit" class="gro_tit" style="left:0px; top:0px; width:946px; height:39px; ">
			<import id="iv_Title" src="/common/xrw/iv_TitleBar.xrw" style="left:10px; top:10px; width:926px; height:29px; "/>
		</group>
		<group id="group_scr" class="gro_sel" style="left:10px; top:54px; width:926px; height:73px; ">
			<caption id="caption4" class="list_cap02" style="left:0px; top:48px; width:926px; height:25px; text-align:center; "/>
			<caption id="caption5" class="list_cap02" style="left:0px; top:0px; width:926px; height:25px; text-align:center; "/>
			<caption id="caption9" class="list_cap02" style="left:0px; top:24px; width:926px; height:25px; text-align:center; "/>
			<caption id="caption2" class="list_cap03" style="left:0px; top:24px; width:120px; height:25px; text-align:center; ">송금일자</caption>
			<caption id="caption3" class="list_cap03" style="left:0px; top:0px; width:120px; height:25px; text-align:center; ">전표발생구분</caption>
			<caption id="caption32" class="list_cap03" style="left:274px; top:24px; width:120px; height:25px; text-align:center; ">지불합계</caption>
			<input id="srch_rmtt_dd" ref="/root/reqData/searchData/rmtt_dd" class="req" navindex="2" inputtype="date" maxlength="8" format="yyyy-mm-dd" style="left:125px; top:28px; width:100px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						//if(srch_slip_clsf_cd.value == "61"){ //2012.01.12
						var orgStr = model.getValue("/root/initData/comboSet/fc_acct_2340_m/dataSet/xx_srch_slip_clsf_cd_61");
						if(instr_yn(orgStr, srch_slip_clsf_cd.value)){
							if(srch_rmtt_dd.value.length== 8){
								set_refvalue("/root/reqData/searchData/acct_rmtt_dt",srch_rmtt_dd.value);
								model.send("fc_acct_2904_l");
								makeComboGubun("","/root/resData/resForm/fc_acct_2904_l/dataSet/CURLIST","record","aprv_slip_no1", "aprv_slip_no");						
								srch_aprv_slip_no.value ="";
								srch_aprv_slip_no.refresh();
							}
						}
					]]>
				</script>
			</input>
			<caption id="caption8" class="list_cap03" style="left:555px; top:24px; width:120px; height:25px; text-align:center; ">지불전표</caption>
			<input id="srch_calc_amt_sum" ref="/root/reqData/searchData/calc_amt_sum" navindex="-1" editable="false" format="(-)#,###" style="left:398px; top:28px; width:150px; height:18px; "/>
			<input id="srch_slip_no" ref="/root/reqData/searchData/slip_no" navindex="3" format="########-##-###-#" style="left:680px; top:28px; width:150px; height:18px; "/>
			<select1 id="srch_slip_clsf_cd" ref="/root/reqData/searchData/slip_occr_clsf" navindex="1" appearance="minimal" style="left:125px; top:3px; width:140px; height:18px; ">
				<!--2012.01.11 수정
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>61 지출결의</label>
						<value>61</value>
					</item>
					<item>
						<label>62 원고료지출</label>
						<value>62</value>
					</item>
					<item>
						<label>63 판매지출</label>
						<value>63</value>
					</item>
					<item>
						<label>91 지불</label>
						<value>91</value>
					</item>
				</choices>
				-->
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2340_m/dataSet/CURLIST4/record">
						<label ref="cd_abrv_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						//if(srch_slip_clsf_cd.value != "61"){ //2012.01.12
						var orgStr  = model.getValue("/root/initData/comboSet/fc_acct_2340_m/dataSet/xx_srch_slip_clsf_cd_61");
						if(! instr_yn(orgStr, srch_slip_clsf_cd.value)){
							srch_aprv_slip_no.value = "";
							srch_aprv_slip_no.disabled = true;
						}
						else{
							if(srch_rmtt_dd.value.length== 8){
								set_refvalue("/root/reqData/searchData/acct_rmtt_dt",srch_rmtt_dd.value);
								model.send("fc_acct_2904_l");
								makeComboGubun("","/root/resData/resForm/fc_acct_2904_l/dataSet/CURLIST","record","aprv_slip_no1", "aprv_slip_no");						
								srch_aprv_slip_no.value ="";
								srch_aprv_slip_no.refresh();
							}
							srch_aprv_slip_no.disabled = false;							
						}
					]]>
				</script>
			</select1>
			<caption id="caption1" class="list_cap03" style="left:0px; top:48px; width:120px; height:25px; text-align:center; ">입력일자</caption>
			<caption id="caption6" class="list_cap03" style="left:274px; top:48px; width:120px; height:25px; text-align:center; ">승인전표번호</caption>
			<caption id="caption7" class="list_cap03" style="left:555px; top:48px; width:120px; height:25px; text-align:center; ">입력자</caption>
			<input id="incmg_emp_nm" ref="/root/reqData/searchData/incmg_emp_nm" navindex="-1" editable="false" style="left:762px; top:52px; width:150px; height:18px; "/>
			<input id="incmg_emp_no" ref="/root/reqData/searchData/incmg_emp_no" navindex="6" inputtype="button" maxlength="6" style="left:680px; top:52px; width:80px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
						window.load("/xrw/hd/com/HD_COM_1000.xrw","mdichild", "hd_com_1000", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[					
						if (incmg_emp_no.value.length == 6) {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/emp_no");
							model.setValue("/root/reqData/fwdData/emp_no", incmg_emp_no.value);
							model.send("hd_com_1002");
							
							if (model.getValue("/root/tempData/record/emp_no") != "") {
								incmg_emp_nm.value = model.getValue("/root/tempData/record/nm_korn");
							}
							else {
								incmg_emp_no.value = "";
								incmg_emp_nm.value = "";
							}
						}		
						else {
							incmg_emp_no.value = "";
							incmg_emp_nm.value = "";
						}									
					]]>
				</script>
			</input>
			<caption id="caption10" style="left:230px; top:55px; width:30px; height:15px; ">까지</caption>
			<select1 id="srch_aprv_slip_no" ref="/root/reqData/searchData/aprv_slip_no" navindex="5" appearance="minimal" style="left:398px; top:52px; width:150px; height:18px; ">
				<choices>
					<itemset nodeset="/root/resData/resForm/fc_acct_2904_l/dataSet/CURLIST/record">
						<label ref="aprv_slip_no1"/>
						<value ref="aprv_slip_no"/>
					</itemset>
				</choices>
			</select1>
			<input id="srch_incmg_dt" ref="/root/reqData/searchData/incmg_dt" class="req" navindex="4" inputtype="date" format="yyyy-mm-dd" style="left:125px; top:52px; width:100px; height:18px; "/>
			<input id="aprv_yn" ref="/root/reqData/searchData/aprv_yn" navindex="-1" editable="false" style="left:812px; top:3px; width:100px; height:18px; "/>
			<caption id="caption11" class="list_cap03" style="left:274px; top:0px; width:120px; height:25px; text-align:center; ">상대예산</caption>
			<caption id="caption12" class="list_cap03" style="left:555px; top:0px; width:120px; height:25px; text-align:center; ">관리구분</caption>
			<select1 id="budg_cd1" ref="/root/reqData/multiupdateData/budg_cd1" class="req" appearance="minimal" style="left:398px; top:3px; width:150px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2340_m/dataSet/CURLIST3/record">
						<label ref="budg_abrv_nm"/>
						<value ref="budg_cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						//if(budg_cd1.value == "001100"){ //2012.01.12
						var orgStr = model.getValue("/root/initData/comboSet/fc_acct_2340_m/dataSet/xx_budg_cd1_010");
						if(instr_yn(orgStr, budg_cd1.value)){
							mang_clsf_cd1.value = "";
							mang_clsf_cd1.disabled = true;
						}
						else{
							mang_clsf_cd1.disabled = false;
						}
					]]>
				</script>
			</select1>
			<select1 id="mang_clsf_cd1" ref="/root/reqData/multiupdateData/mang_clsf_cd1" appearance="minimal" editmode="inputsearch" style="left:680px; top:3px; width:125px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2340_m/dataSet/CURLIST2/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(mang_clsf_cd1, mang_clsf_cd1.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(mang_clsf_cd1,"");
							return;
						}					
					]]>
				</script>
			</select1>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:135px; width:926px; height:5px; "/>
		<select id="check_all" ref="/root/reqData/reqForm/chk1" navindex="-1" overflow="visible" appearance="full" style="left:15px; top:145px; width:100px; height:20px; border-style:none; ">
			<choices>
				<item>
					<label>전체선택</label>
					<value>1</value>
				</item>
			</choices>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
				
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var calc_amt1;
					var tot_amt;
					if(get_refvalue("/root/reqData/reqForm/chk1") == "1"){
						//if(srch_slip_clsf_cd.value == "61"){ //2012.01.12
						var orgStr1 = model.getValue("/root/initData/comboSet/fc_acct_2340_m/dataSet/xx_srch_slip_clsf_cd_61");
						if(instr_yn(orgStr1, srch_slip_clsf_cd.value)){
							for(var i=1; i<datagrid2.rows;i++){
								if(get_refvalue("/root/resData/gridData/fc_acct_2906_l/dataSet/CURLIST/record["+i+"]/dr_amt") != 0)
								{
									set_refvalue("/root/resData/gridData/fc_acct_2906_l/dataSet/CURLIST/record["+i+"]/chk","1");
									datagrid2.addStatus(i, "update");
								}
								else{
									set_refvalue("/root/resData/gridData/fc_acct_2906_l/dataSet/CURLIST/record["+i+"]/chk","0");
									datagrid2.removeStatus(i, "update");
									datagrid2.isReadOnly(i,1) = true;
								}
							}
							datagrid2.refresh();
						}
						else{
							tot_amt  = 0;
							for(var i=1; i<datagrid1.rows;i++){
								set_refvalue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record["+i+"]/check1","1");
								datagrid1.addStatus(i, "update");								
								calc_amt1 = model.getValue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record["+i+"]/calc_amt");
								tot_amt  = tot_amt + Number(calc_amt1);
							}
		 					srch_calc_amt_sum.value = tot_amt;
							datagrid1.refresh();
						}
					}
					else{
						//if(srch_slip_clsf_cd.value == "61"){ //2012.01.12
						var orgStr2 = model.getValue("/root/initData/comboSet/fc_acct_2340_m/dataSet/xx_srch_slip_clsf_cd_61");
						if(instr_yn(orgStr2, srch_slip_clsf_cd.value)){
							for(var i=1; i<datagrid2.rows;i++){
								if(get_refvalue("/root/resData/gridData/fc_acct_2906_l/dataSet/CURLIST/record["+i+"]/dr_amt") != 0)
								{								
									set_refvalue("/root/resData/gridData/fc_acct_2906_l/dataSet/CURLIST/record["+i+"]/chk","0");
									datagrid2.clearStatus();
									datagrid2.isReadOnly(i,1) = false;
								}
								else{
									set_refvalue("/root/resData/gridData/fc_acct_2906_l/dataSet/CURLIST/record["+i+"]/chk","0");
									datagrid2.clearStatus();
									datagrid2.isReadOnly(i,1) = true;
								}
							}
							datagrid2.refresh();
						}
						else{
							for(i=1; i<datagrid1.rows;i++){
								set_refvalue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record["+i+"]/check1","0");
								datagrid1.clearStatus();
							}
							srch_calc_amt_sum.value = 0;
							datagrid1.refresh();
						}
					}				
				]]>
			</script>
		</select>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:735px; width:926px; height:21px; ">
			<button id="btn_delete" class="btn02" crud="D" style="left:111px; top:0px; width:52px; height:21px; ">
				<caption>승인취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//if(srch_slip_clsf_cd.value == "61"){ //2012.01.12
						var orgStr = model.getValue("/root/initData/comboSet/fc_acct_2340_m/dataSet/xx_srch_slip_clsf_cd_61");
						if(instr_yn(orgStr, srch_slip_clsf_cd.value)){
							if(srch_aprv_slip_no.value == ""){
								show_message("처리할 자료가 없습니다.");
								return false;
							}
							if (!check_reqItem(srch_rmtt_dd,"trim","focus","송금일자는 필수입력 항목입니다.")) { return false; }
							if (!check_reqItem(incmg_emp_no,"trim","focus","입력자는 필수입력 항목입니다.")) { return false; }							
							
							set_refvalue("/root/reqData/reqForm/aprv_slip_occr_dt", srch_aprv_slip_no.value.substring(0,8));
							set_refvalue("/root/reqData/reqForm/aprv_slip_clsf_cd",srch_aprv_slip_no.value.substring(8,10));
							set_refvalue("/root/reqData/reqForm/aprv_slip_seq",srch_aprv_slip_no.value.substring(10,13));
							set_refvalue("/root/reqData/reqForm/aprv_slip_sub_seq",srch_aprv_slip_no.value.substring(13,14));
							set_refvalue("/root/reqData/reqForm/incmg_emp_no", incmg_emp_no.value);

							if (show_message("승인취소하시겠습니까?","취소 확인",MB_YESNO) != IDYES) {
								return false;
							}

							model.send("fc_acct_2908_d");
							
							if(submit_completed()){
								show_message("승인취소되었습니다.");
								srch_rmtt_dd.dispatch("xforms-value-changed");
								btn_select.dispatch("onclick");								
							}
						}
						else{
	 					       var i =0, var_check_row = 0;
						       for (i=1; i<datagrid1.rows; i++) {
						      		if (datagrid1.rowStatus(i) != 0) {
									var_check_row = var_check_row + 1;
							       }
						       }
						       if (var_check_row == 0) {
								show_message("승인취소할 자료를 선택후 승인취소 버튼을 누르세요.");
						     		return;
						       }
 						       if (var_check_row > 1) {
								show_message("승인취소시에는 1건만 선택하세요!");
						     		return;
						       }

							for(i=1;i<datagrid1.rows;i++){
								if(datagrid1.rowStatus(i) != 0) {
									if(datagrid1.valueMatrix(i,datagrid1.colRef("slip_clsf_cd")) !='91') {
										show_message(" 전표발생구분이 지불이 아닌 경우 승인취소할 수 없습니다.");
										return;
									}
								}
							}
							
							if(datagrid1.rows == 0){
								show_message("처리할 자료가 없습니다.");
								return;
							}
							
							if (show_message("승인취소하시겠습니까?","취소 확인",MB_YESNO) != IDYES) {
								return false;
							}
	
							set_refvalue("/root/reqData/multiupdateData/multiUpDate", datagrid1.getUpdateData());						
							model.send("fc_acct_2903_d");
							
							if(submit_completed()){
								show_message("승인취소되었습니다.");
								btn_select.dispatch("onclick");
								datagrid1.refresh();
							}
						}

					]]>
				</script>
			</button>
			<button id="btn_select" class="btn02" crud="R" style="left:1px; top:0px; width:52px; height:21px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						aprv_yn.value = "";
						aprv_yn.attribute("background-color") = "#ffffff";

						if(srch_slip_clsf_cd.value == ""){
							show_message("전표발생구분은 필수입력항목입니다.");
							return;
						}
						//if(srch_slip_clsf_cd.value == "61"){ //2012.01.12
						var orgStr1 = model.getValue("/root/initData/comboSet/fc_acct_2340_m/dataSet/xx_srch_slip_clsf_cd_61");
						if(instr_yn(orgStr1, srch_slip_clsf_cd.value)){
							datagrid1.visible = false;
							datagrid2.visible = true;
							
							//내역조회
							if(srch_aprv_slip_no.value != ""){
								send_fc_acct_2905_l();
							}
							//대상조회
							else{
								send_fc_acct_2906_l();
							}
							check_all.dispatch("xforms-value-changed");
						}
						else{
							datagrid1.visible = true;
							datagrid2.visible = false;
							
							set_refvalue("/root/reqData/searchData/cmpy_cd",get_refvalue("/root/initData/session/cmpy_cd"));
							set_refvalue("/root/reqData/searchData/calc_amt_sum",0);
	//						set_refvalue("/root/reqData/searchData/slip_no","");
							var slip_occr_clsf = get_refvalue("/root/reqData/searchData/slip_occr_clsf");
							if(slip_occr_clsf == ""){
								show_message("전표발생구분은 필수입력항목입니다.");
								return;
							}
	
							var rmtt_dd = get_refvalue("/root/reqData/searchData/rmtt_dd");
							if(rmtt_dd == ""){
								show_message("송금일자는 필수입력항목입니다.");
								return;
							}
	
							model.send("fc_acct_2900_l",true);
							
							//if(slip_occr_clsf== "91") { //2012.01.12
							var orgStr2 = model.getValue("/root/initData/comboSet/fc_acct_2340_m/dataSet/xx_slip_occr_clsf");
							if(instr_yn(orgStr2, slip_occr_clsf)){
								btn_insert.disabled = true; 
								btn_delete.disabled = false;
								
								srch_slip_no.value ="";
								check_all.visible = false;
							 }
							else { 
								btn_insert.disabled = false; 
								btn_delete.disabled = true; 
								check_all.visible = true;
							}
							
							if(get_refvalue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/totalcnt") == 0)
							{
								show_message("검색결과가 없습니다.");
								return false;
							}
							//datagrid1.refresh();
							//model.toggle("case1");
						}
					]]>
				</script>
			</button>
			<button id="button8" class="btn02" style="left:516px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose();
					]]>
				</script>
			</button>
			<button id="btn_print1" class="btn02" style="left:331px; top:0px; width:52px; height:21px; ">
				<caption>명세서</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//if(srch_slip_clsf_cd.value != "61"){ //2012.01.12
						var orgStr = model.getValue("/root/initData/comboSet/fc_acct_2340_m/dataSet/xx_srch_slip_clsf_cd_61");
						if(! instr_yn(orgStr, srch_slip_clsf_cd.value)){
							model.property("FC_ACCT_2940_slip_occr_dt")  = get_refvalue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record["+datagrid1.row+"]/slip_occr_dt");		
							model.property("FC_ACCT_2940_slip_clsf_cd")  = get_refvalue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record["+datagrid1.row+"]/slip_clsf_cd");
							model.property("FC_ACCT_2940_slip_seq") = get_refvalue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record["+datagrid1.row+"]/slip_seq");
							model.property("FC_ACCT_2940_popup_flag")  = "Y";
							// 화면호출
	//						viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2940", "modal", "align:center; caption:hidden; width:650px; height:480px;");
							viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2940");
						}
					]]>
				</script>
			</button>
			<button id="btn_select1" class="btn02" style="left:221px; top:0px; width:52px; height:21px; ">
				<caption>건별조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//if(srch_slip_clsf_cd.value != "61"){					
						var orgStr = model.getValue("/root/initData/comboSet/fc_acct_2340_m/dataSet/xx_srch_slip_clsf_cd_61");
						if(! instr_yn(orgStr, srch_slip_clsf_cd.value)){
							var slip_no; 
							if(get_refvalue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record["+datagrid1.row+"]/slip_no") !=""){	
								slip_no = get_refvalue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record["+datagrid1.row+"]/slip_no");
								model.property("FC_ACCT_2470_srch_slip_occr_dt")  = slip_no.substring(0,8);
								model.property("FC_ACCT_2470_srch_slip_clsf_cd") =  slip_no.substring(9,11);
								model.property("FC_ACCT_2470_srch_slip_seq") = slip_no.substring(12,15);
								model.property("FC_ACCT_2470_srch_slip_sub_seq") = slip_no.substring(16,17);
														
								model.property("FC_ACCT_2470_popup_flag")  = "Y";
		
	//							viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2470");
	//							viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2470");
								if(getProperty("ss_cmpycd")=="500"){
								viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2470_500");
								}else{
									viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2470");
								}
							}
						}
					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" style="left:166px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.reset();		
					]]>
				</script>
			</button>
			<button id="btn_print2" class="btn04" style="left:386px; top:0px; width:69px; height:21px; ">
				<caption>송금의뢰서</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//if(srch_slip_clsf_cd.value == "61"){ //2012.01.12
						var orgStr = model.getValue("/root/initData/comboSet/fc_acct_2340_m/dataSet/xx_srch_slip_clsf_cd_61");
						if(instr_yn(orgStr, srch_slip_clsf_cd.value)){
							if(srch_aprv_slip_no.value != ""){
								model.property("FC_ACCT_2910_slip_occr_dt")  = srch_aprv_slip_no.value.substring(0,8);			// 발생일자
								model.property("FC_ACCT_2910_slip_clsf_cd")  = srch_aprv_slip_no.value.substring(8,10);			// 전표구분
								model.property("FC_ACCT_2910_slip_occr_seqo") = srch_aprv_slip_no.value.substring(10,13);		// 일련번호
							}
							else{
								model.property("FC_ACCT_2910_slip_occr_dt")  = "";
								model.property("FC_ACCT_2910_slip_clsf_cd")  = "";
								model.property("FC_ACCT_2910_slip_occr_seqo") = "";
							}
							model.property("FC_ACCT_2910_popup_flag")  = "Y";
							model.property("FC_ACCT_2910_kind") = orgStr;								
							// 화면호출
//							viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2910", "modal", "align:center; caption:hidden; width:650px; height:480px;");
							viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2910");	
							
						}
						else{
							model.property("FC_ACCT_2910_slip_occr_dt")  = get_refvalue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record["+datagrid1.row+"]/slip_occr_dt");		
							model.property("FC_ACCT_2910_slip_clsf_cd")  = get_refvalue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record["+datagrid1.row+"]/slip_clsf_cd");
							model.property("FC_ACCT_2910_slip_occr_seqo") = get_refvalue("/root/resData/gridData/fc_acct_2900_l/dataSet/RMTT_PAY_LIST/record["+datagrid1.row+"]/slip_seq");
							model.property("FC_ACCT_2910_popup_flag")  = "Y";
							// 화면호출
	//						viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2910", "modal", "align:center; caption:hidden; width:650px; height:480px;");
							viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2910");	
						}
					]]>
				</script>
			</button>
			<button id="btn_print" class="btn02" style="left:276px; top:0px; width:52px; height:21px; ">
				<caption>전표발행</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//if(srch_slip_clsf_cd.value == "61"){ //2012.01.12
						var orgStr = model.getValue("/root/initData/comboSet/fc_acct_2340_m/dataSet/xx_srch_slip_clsf_cd_61");
						if(instr_yn(orgStr, srch_slip_clsf_cd.value)){
							if(srch_aprv_slip_no.value != ""){
								model.property("FC_ACCT_2260_slip_occr_dt")  = srch_aprv_slip_no.value.substring(0,8);			// 발생일자
								model.property("FC_ACCT_2260_slip_clsf_cd")  = srch_aprv_slip_no.value.substring(8,10);			// 전표구분
								model.property("FC_ACCT_2260_slip_seqfr") = srch_aprv_slip_no.value.substring(10,13);			// 일련번호 from
								model.property("FC_ACCT_2260_slip_seqto") = srch_aprv_slip_no.value.substring(10,13);			// 일련번호 to
							}
							else{
								model.property("FC_ACCT_2260_slip_occr_dt")  = "";		// 발생일자
								model.property("FC_ACCT_2260_slip_clsf_cd")  = "";		// 전표구분
								model.property("FC_ACCT_2260_slip_seqfr") = "";		// 일련번호 from
								model.property("FC_ACCT_2260_slip_seqto") = "";		// 일련번호 to								
							}
							
							model.property("FC_ACCT_2260_slip_radio1") = "";			// 출력구분
							model.property("FC_ACCT_2260_popup_flag") = "Y";														
						}
						else{
							// 글로벌변수 셋팅
							model.property("FC_ACCT_2260_slip_occr_dt")  = datagrid1.valueMatrix(datagrid1.row, 2).substring(0, 8);			// 발생일자
							model.property("FC_ACCT_2260_slip_clsf_cd")  = datagrid1.valueMatrix(datagrid1.row, 2).substring(9, 11);			// 전표구분
							model.property("FC_ACCT_2260_slip_seqfr") = datagrid1.valueMatrix(datagrid1.row, 2).substring(12, 15);			// 일련번호 from
							model.property("FC_ACCT_2260_slip_seqto") = datagrid1.valueMatrix(datagrid1.row, 2).substring(12, 15);			// 일련번호 to
							model.property("FC_ACCT_2260_slip_radio1") = "";			// 출력구분
							model.property("FC_ACCT_2260_popup_flag") = "Y";
						}

						// 화면호출
//						viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2260", "modal", "align:center; caption:hidden; width:650px; height:480px;");						
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2260");
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" style="left:461px; top:0px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" crud="U" style="left:56px; top:0px; width:52px; height:21px; ">
				<caption>승인</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//if(srch_slip_clsf_cd.value == "61"){ //2012.01.12
						var orgStr = model.getValue("/root/initData/comboSet/fc_acct_2340_m/dataSet/xx_srch_slip_clsf_cd_61");
						if(instr_yn(orgStr, srch_slip_clsf_cd.value)){
							send_fc_acct_2907_i();
						}
						else{
							send_fc_acct_2902_u();
						}											
					]]>
				</script>
			</button>
		</group>
	</xhtml:body>
</xhtml:html>
