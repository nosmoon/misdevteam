<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>공통지출결의내역등록</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session>
							<incmg_pers_ipadd>255.255.255.0</incmg_pers_ipadd>
							<incmg_pers>관리자</incmg_pers>
							<cmpy_cd>100</cmpy_cd>
							<use_dept_cd>123456</use_dept_cd>
						</session>
						<comboSet>
							<fc_acct_2080_m>
								<dataSet>
									<CUR_INCM_CLSF_LIST>
										<record>
											<cd_nm/>
											<cd/>
										</record>
									</CUR_INCM_CLSF_LIST>
									<CUR_ERPLACE_CD_LIST>
										<record>
											<cd_nm/>
											<cd/>
										</record>
									</CUR_ERPLACE_CD_LIST>
									<CUR_PROF_TYPE_LIST>
										<record>
											<cd_nm/>
											<cd/>
										</record>
									</CUR_PROF_TYPE_LIST>
									<CUR_SLIP_CLSF_LIST>
										<record>
											<cd_nm/>
											<cd/>
										</record>
									</CUR_SLIP_CLSF_LIST>
									<CUR_DLCO_CLSF_LIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
										</record>
									</CUR_DLCO_CLSF_LIST>
									<CUR_WHCO_NDSTB_CD_LIST>
										<record>
											<whco_ndstb_cd/>
											<whco_comn_cost_yn/>
										</record>
									</CUR_WHCO_NDSTB_CD_LIST>
									<CUR_MANG_ITEM_CD_LIST>
										<record>
											<mang_item_cd/>
											<drcr_clsf/>
										</record>
									</CUR_MANG_ITEM_CD_LIST>
									<CUR_BUDGMANGCD_LIST>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
										</record>
									</CUR_BUDGMANGCD_LIST>
								</dataSet>
							</fc_acct_2080_m>
						</comboSet>
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
						<fc_acct_2081_s>
							<dataSet>
								<CURLIST>
									<record>
										<outval1/>
									</record>
								</CURLIST>
							</dataSet>
						</fc_acct_2081_s>
						<fc_acct_2082_s>
							<dataSet>
								<CURLIST>
									<record>
										<dlco_abrv_nm/>
										<dlco_no/>
										<dlco_nm/>
										<presi_nm/>
										<bizcond/>
										<item/>
										<zip_1/>
										<zip_2/>
										<jujuso1/>
										<jujuso2/>
										<jujuso3/>
										<jujuso4/>
									</record>
								</CURLIST>
								<dlco_abrv_nm/>
								<dlco_no/>
								<dlco_nm/>
								<presi_nm/>
								<bizcond/>
								<item/>
								<zip_1/>
								<zip_2/>
								<jujuso1/>
								<jujuso2/>
								<jujuso3/>
								<jujuso4/>
							</dataSet>
						</fc_acct_2082_s>
						<fc_acct_2083_s>
							<dataSet>
								<CUR_MANG_CLSF_CD_LIST>
									<record>
										<cd/>
										<cdnm/>
										<cd_abrv_nm/>
									</record>
								</CUR_MANG_CLSF_CD_LIST>
							</dataSet>
						</fc_acct_2083_s>
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData>
							<slip_aprv_yn/>
							<expn_clsf/>
							<rn1/>
							<slip_sub_seq/>
							<slip_arow_no/>
							<budg_cd/>
							<drcr_clsf/>
							<dr_amt/>
							<crdt_amt/>
							<dlco_clsf_cd/>
							<dlco_cd/>
							<dlco_nm/>
							<boks_dlco_nm/>
							<mang_clsf_cd/>
							<mang_no/>
							<incm_clsf_cd/>
							<medi_cd/>
							<dtls_medi_cd/>
							<use_dept_cd/>
							<comp_dt/>
							<mtry_dt/>
							<unit/>
							<qunt/>
							<tax_stmt_no/>
							<setoff_slip_occr_dt/>
							<setoff_slip_clsf_cd/>
							<setoff_slip_seq/>
							<setoff_slip_sub_seq/>
							<setoff_slip_arow_no/>
							<etc_in/>
							<rmks2/>
							<make_dt/>
							<erplace_cd/>
							<ern/>
							<suply_amt/>
							<vat_amt/>
							<budg_cd_nm/>
							<use_dept_cd_nm/>
							<medi_cd_nm/>
							<int_rate/>
							<pay_bank_cd/>
							<pay_bank_cd_nm/>
							<purc_amt/>
							<corp_tax_amt/>
							<issu_dt/>
							<insr_nm/>
							<intg_dlco_cd/>
							<prop_equip_cd/>
							<adpay_adjm_flag/>
							<bank_clsf/>
							<acct_no/>
							<deps_pers_nm/>
							<occr_slip_clsf/>
							<occr_slip/>
							<note_stat/>
							<vat_amt2/>
							<with_tax/>
							<incm_tax/>
							<res_tax/>
							<etc_in/>
							<setoff_no/>
							<confirm_flag/>
							<draft_doc_no/>
							<draft_expn_amt/>
							<recp_pers_clsf/>
							<recp_pers/>
							<rn/>
							<draft_dept_cd/>
						</fwdData>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<search>
							<cmpy_cd/>
							<budg_cd>
							</budg_cd>
							<incm_clsf_cd/>
							<prop_equip_cd/>
							<dept_cd/>
							<job_clsf/>
							<cd_clsf/>
							<cd/>
							<dlco_clsf_cd/>
							<dlco_no/>
							<cdnm/>
							<select_ch/>
							<use_end_dt/>
						</search>
						<reqform/>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpDate/>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
						<search1>
							<cmpy_cd/>
							<input_val_1/>
							<input_val_2/>
						</search1>
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resform>
							<slip_arow_no/>
							<rece_exp_aplc_yn/>
							<budg_cd/>
							<budg_cd_nm/>
							<suply_amt/>
							<use_dept_cd/>
							<use_dept_cd_nm/>
							<vat_amt/>
							<dlco_clsf_cd/>
							<dlco_cd/>
							<dlco_nm/>
							<intg_dlco_cd/>
							<boks_dlco_nm/>
							<prop_equip_cd/>
							<mang_clsf_cd/>
							<mang_no/>
							<incm_clsf_cd/>
							<with_tax/>
							<incm_tax/>
							<res_tax/>
							<setoff_slip_no/>
							<complete_flag/>
							<bank_clsf/>
							<acct_cd/>
							<peps_pers_nm/>
							<medi_cd/>
							<medi_cd_nm/>
							<dtls_medi_cd/>
							<comp_dt/>
							<mtry_dt/>
							<unit/>
							<qunt/>
							<rmks2/>
							<recp_pers_clsf/>
							<recp_pers/>
							<recp_pers_nm/>
							<draft_doc_no/>
							<draft_expn_amt/>
							<prof_type_cd/>
							<occr_slip_clsf_cd/>
							<occr_slip_occr_dt/>
							<occr_slip_seq/>
							<erplace_cd/>
							<make_dt/>
							<etc_in/>
							<ern/>
							<purc_amt/>
							<corp_tax_amt/>
							<issu_dt/>
							<int_rate/>
							<pay_bank_cd/>
							<pay_bank_cd_nm/>
							<insr_nm/>
							<occr_slip_clsf/>
							<occr_slip/>
							<dtls_medi_cd_nm/>
							<prop_equip_cd_nm/>
							<draft_dept_cd/>
							<semu_cmpy_cd/>
							<semu_occr_dt/>
							<semu_seq/>
							<semu_semuro_no/>
							<semu_send_pers_email/>
							<semuro_yn/>
							<prop_equip_cd_nm/>
						</resform>
						<resform2>
							<dataSet>
								<CURLIST>
									<record>
										<budg_cdnm/>
										<cdnm/>
										<cd/>
									</record>
								</CURLIST>
							</dataSet>
						</resform2>
						<resform3>
							<fc_acct_2013_s>
								<dataSet>
									<CURLIST>
										<record>
											<clsf_yn/>
											<draft_expn_amt/>
											<draft_impt_amt/>
											<dr_amt/>
											<crdt_amt/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_acct_2013_s>
						</resform3>
						<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<gridData/>
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
						<resform3>
							<suplyamt>과표</suplyamt>
						</resform3>
						<fc_acct_2016_s>
							<dataSet>
								<CURLIST>
									<record>
										<cd/>
										<cd_abrv_nm/>
										<mang_cd_5/>
										<mang_cd_6/>
										<mang_cd_7/>
										<mang_cd_8/>
									</record>
								</CURLIST>
							</dataSet>
						</fc_acct_2016_s>
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<keyData/>
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<fc_co_1101_l>
							<dataSet>
								<CURLIST1>
									<record>
										<cmpy_cd/>
										<dept_cd/>
										<dept_team_clsf/>
										<abrv_nm/>
										<offi_nm/>
										<dept_team_nm/>
										<part_nm/>
										<part_dn_nm/>
									</record>
								</CURLIST1>
							</dataSet>
						</fc_co_1101_l>
						<fc_acct_2015_l>
							<dataSet>
								<CURLIST>
									<record>
										<cd/>
										<cdnm/>
									</record>
								</CURLIST>
							</dataSet>
						</fc_acct_2015_l>
						<medi_ch/>
						<tax_dirinput/>
						<elec_tax_no1/>
						<elec_tax_no2/>
						<elec_tax_no3/>
						<paper_yn/>
					</tempData>
					<!-- 저장소 -->
				</root>
			</instance>
			<script type="javascript" src="/js/CIISComm.js"/>
			<script type="javascript" src="/js/TFCommon.js"/>
			<script type="javascript" src="/js/fcmc_common.js"/>
			<submission id="fc_acct_2080_m" action="/fc/acct2000/2080" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/search" resultref="/root/initData/comboSet/fc_acct_2080_m/dataSet"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				
					var parentWindow = window.parent;
					var childBody = parentWindow.body;
					
					model.setValue("/root/initData/session/cmpy_cd", getProperty("ss_cmpycd"))
					var cmpy_cd = model.getValue("/root/initData/session/cmpy_cd");
					model.setValue("/root/reqData/search/cmpy_cd",cmpy_cd);

					if(model.getValue("/root/reqData/fwdData/slip_aprv_yn") == "승인") {
						btn_insert.disabled = true;
						btn_update.disabled = true;
						btn_append.disabled = true;
						btn_delete.disabled = true;
					}

					fn_GridToForm(parentWindow.datagrid1.row);
					

					if (model.getValue("/root/reqData/search/budg_cd") == "" && parentWindow.expn_clsf.value == "2") {

						model.send("fc_acct_2080_m");
						makeComboGubun("", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_INCM_CLSF_LIST", "record", "cd_nm", "cd");
						makeComboGubun("", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_PROF_TYPE_LIST", "record", "cd_nm", "cd");
						makeComboGubun("", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_ERPLACE_CD_LIST", "record", "cd_nm", "cd");
						makeComboGubun("", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_DLCO_CLSF_LIST", "record", "cd_abrv_nm", "cd");
						makeComboGubun("", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_SLIP_CLSF_LIST", "record", "cd_nm", "cd")	;

						//2009-06-18(고종수) : 선급지출인 경우 콤보추가
						combo_data_add(dlco_clsf_cd,"91 사원", "91");
						combo_data_add(dlco_clsf_cd,"92 부서", "92");						
						dlco_clsf_cd.refresh();
					}
					else {
						if (model.getValue("/root/reqData/search/budg_cd") != "") {
							gvar_evnt_check_flag = "Y";
							budg_cd.dispatch("xforms-value-changed");
							gvar_evnt_check_flag = "N";
						}
						else {
							model.send("fc_acct_2080_m");
							makeComboGubun("", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_INCM_CLSF_LIST", "record", "cd_nm", "cd");
							makeComboGubun("", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_PROF_TYPE_LIST", "record", "cd_nm", "cd");
							makeComboGubun("", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_ERPLACE_CD_LIST", "record", "cd_nm", "cd");
							makeComboGubun("", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_DLCO_CLSF_LIST", "record", "cd_abrv_nm", "cd");
							makeComboGubun("", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_SLIP_CLSF_LIST", "record", "cd_nm", "cd")	;	
						}
					}

					
					// 선급정리 일때만 지출번호 입력가능
					if(model.getValue("/root/reqData/fwdData/expn_clsf") != "3") {
						setoff_slip_no.attribute("editable") = "false";
						complete_flag.attribute("editable") = "false";
						setoff_slip_no.attribute("background-color") = DEFAULT_COLOR_DISABLE;
						complete_flag.attribute("background-color") = DEFAULT_COLOR_DISABLE;
					}
					
					// 세무로 셋팅
					if(prof_type_cd.value != ""){
						if (model.getValue("/root/resData/resform/semu_semuro_no") != " " && model.getValue("/root/resData/resform/semu_semuro_no") != "" ) {
							if(model.getValue("/root/resData/resform/semu_semuro_no").length == 24){
								semuro_yn.value = "N";
								semuro_yn.disabled = true;							
								elec_tax_no1.value = model.getValue("/root/resData/resform/semu_semuro_no").substring(0, 8);
								elec_tax_no2.value = model.getValue("/root/resData/resform/semu_semuro_no").substring(8, 16);
								elec_tax_no3.value = model.getValue("/root/resData/resform/semu_semuro_no").substring(16, 24);
							}else{
								semuro_yn.value = "Y";
								semuro_yn.disabled = false;	
								elec_tax_no1.disabled = true;
								elec_tax_no2.disabled = true;	
								elec_tax_no3.disabled = true;														
							}
							paper_yn.value = "N";
						}
						else {
							semuro_yn.value = "N";
							semuro_yn.disabled = true;
							paper_yn.value = "Y";
							elec_tax_no1.disabled = true;
							elec_tax_no2.disabled = true;	
							elec_tax_no3.disabled = true;							
						}
					}else{
							semuro_yn.value = "N";
							semuro_yn.disabled = true;
							paper_yn.value = "N";
							elec_tax_no1.disabled = false;
							elec_tax_no2.disabled = false;	
							elec_tax_no3.disabled = false;	
					}
					
					//조선is하드코딩
					//medi_cd.value = "010";
					//medi_cd_nm.value = "사용자";
					model.setValue("/root/resData/resform/medi_cd","010");
					model.setValue("/root/resData/resform/dtls_medi_cd","사용자");
					
					model.copyNode("/root/resData/fc_acct_2016_s/dataSet", "/root/reqData/fwdData/fc_acct_2016_s/dataSet");
					model.removenode("/root/reqData/fwdData/fc_acct_2016_s/dataSet");
					
					model.setValue("/root/resData/resform/medi_cd", model.getValue("/root/reqData/fwdData/medi_cd")); //2012.01.13
					model.setValue("/root/resData/resform/medi_cd_nm", model.getValue("/root/reqData/fwdData/medi_cd_nm")); //2012.01.13
					model.setValue("/root/resData/resform/dtls_medi_cd", model.getValue("/root/reqData/fwdData/dtls_medi_cd")); //2012.01.13
					model.setValue("/root/resData/resform/dtls_medi_cd_nm", model.getValue("/root/reqData/fwdData/dtls_medi_cd_nm")); //2012.01.13
					model.refresh(); //2012.01.13
										
				]]>
			</script>
			<submission id="fc_acct_2081_s" action="/fc/acct2000/2081" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/search1" resultref="/root/initData/fc_acct_2081_s/dataSet"/>
			<submission id="fc_co_1101" action="/fc/co1000/1101" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/search" resultref="/root/tempData/fc_co_1101_l/dataSet"/>
			<submission id="fc_co_8000_s" action="/fc/co8000/8000" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/search" resultref="/root/resData/resform2/dataSet"/>
			<submission id="fc_acct_2082_s" action="/fc/acct2000/2082" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/search" resultref="/root/initData/fc_acct_2082_s/dataSet"/>
			<submission id="fc_acct_2083_s" action="/fc/acct2000/2083" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/search" resultref="/root/initData/fc_acct_2083_s/dataSet"/>
			<submission id="mc_co_1002_l" action="/mc/co1000/1002" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/search" resultref="/root/resData/resform2/dataSet"/>
			<submission id="fc_acct_2013_s" action="/fc/acct2000/2013" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/resData/resform" resultref="/root/resData/resform3/fc_acct_2013_s/dataSet"/>
			<submission id="fc_acct_2015_l" action="/fc/acct2000/2015" mediatype="application/x-www-form-urlencoded" method="post" ref="/root/reqData/fwdData" resultref="/root/tempData/fc_acct_2015_l/dataSet"/>
		</model>
		<script type="javascript">
			<![CDATA[
				// 부모창의 그리드 컴럼을 처음으로 셋팅
				var parentWindow = window.parent;
				var childBody = parentWindow.body;
				
				var strwhco_ndstb_cd;
				var strwhco_comn_cost_yn;
				var strdrcr_clsf;
					
				var gstr_popupid = "";
				
				var gvar_evnt_check_flag = "N";
				
				function setEmp_no(emp_no, nm_korn){
						model1.setValue("/root/resData/resform/dtls_medi_cd", emp_no);
						model1.setValue("/root/resData/resform/dtls_medi_cd_nm", nm_korn);
						input19.refresh();
						input1.refresh();
					}
					
				function rcvs_from_fc_co_9010() {
					draft_doc_no.value = arguments[0][0];
				}
				
				// pop-up setting

//				function setDept_cd(iv_dept_cd, iv_dept_nm){
//
//					use_dept_cd.value = iv_dept_cd;
//					use_dept_cd_nm.value = iv_dept_nm;
//
//				}
				function setDept_cd(iv_dept_cd, iv_dept_nm, iv_dept_team_clsf, iv_offi_nm, iv_dept_team_nm, iv_part_nm, iv_part_dn_nm){	
					model.setValue("/root/resData/resform/use_dept_cd", iv_dept_cd);
					model.setValue("/root/resData/resform/use_dept_cd_nm", iv_dept_nm);
					use_dept_cd.refresh();
					use_dept_cd_nm.refresh();
				}

				function setSemuro(iv_cmpy_cd, iv_occr_dt, iv_seq, iv_semuro_no, iv_tax_stmt_clsf, iv_rmsg_pers_semuro_id, iv_send_pers_id, iv_send_pers_eps_no, iv_send_pers_presi_flnm, iv_send_pers_firmnm, iv_send_pers_addr, iv_send_pers_bizcond, iv_send_pers_indt, iv_send_pers_email, iv_issu_dt, iv_tot_suply_amt, iv_tot_amt, iv_tot_tax_amt, iv_cash, iv_note, iv_chqe, iv_trust_unrcp_amt, iv_rcpt_clam_yn, iv_stat_clsf) {

//					alert(iv_cmpy_cd + "-" + iv_occr_dt + "-" + iv_seq + "-" + iv_semuro_no + "-" + iv_tax_stmt_clsf + "-" + iv_rmsg_pers_semuro_id + "-" + iv_send_pers_id + "-" + iv_send_pers_eps_no + "-" + iv_send_pers_presi_flnm + "-" + iv_send_pers_firmnm + "-" + iv_send_pers_addr + "-" + iv_send_pers_bizcond + "-" + iv_send_pers_indt + "-" + iv_send_pers_email + "-" + iv_issu_dt + "-" + iv_tot_suply_amt + "-" + iv_tot_amt + "-" + iv_tot_tax_amt + "-" + iv_cash + "-" + iv_note + "-" + iv_chqe + "-" + iv_trust_unrcp_amt + "-" + iv_rcpt_clam_yn + "-" + iv_stat_clsf);
					
					model.setValue("/root/resData/resform/semu_cmpy_cd", iv_cmpy_cd);		// 회사코드
					model.setValue("/root/resData/resform/semu_occr_dt", iv_occr_dt);			// 발생일자
					model.setValue("/root/resData/resform/semu_seq", iv_seq);				// 일련번호
					model.setValue("/root/resData/resform/semu_semuro_no", iv_semuro_no);	// 세무로번호

					ern.value = iv_send_pers_eps_no;		// 발송자사업자번호
					model.setValue("/root/resData/resform/semu_send_pers_email", iv_send_pers_email);		// 발송자EMAIL
					make_dt.value = iv_issu_dt;			// 발행일자
					suply_amt.value = iv_tot_suply_amt;		       // 총공급가액
					vat_amt.value = iv_tot_tax_amt;			// 총세액

					// 세금계산서구분
					if (iv_tax_stmt_clsf == "01") {		// 세금계산서
						prof_type_cd.value = "11"; 
						prop_equip_cd.value = "8900";
					}
					else if (iv_tax_stmt_clsf == "02") { 	// 영세
						prof_type_cd.value = "15"; 
						prop_equip_cd.value = "";
					}
					else if (iv_tax_stmt_clsf == "03") { 	// 면세(계산서)
						prof_type_cd.value = "14";
						prop_equip_cd.value = "8950"; 
					}
					else { 
						prof_type_cd.value = ""; 
						prop_equip_cd.value = "";
					}
					
					prop_equip_cd.dispatch("xforms-value-changed");
					
					prof_type_cd.dispatch("xforms-select");
					
					if (model.getValue("/root/resData/resform/semu_semuro_no") != "") {
						semuro_yn.value = "Y";
						semuro_yn.disabled = false;
						elec_tax_no1.attribute("background-color") = "white";
						elec_tax_no2.attribute("background-color") = "white";
						elec_tax_no3.attribute("background-color") = "white";						
						elec_tax_no1.disabled = true;
						elec_tax_no2.disabled = true;
						elec_tax_no3.disabled = true;
					}
					else {
						semuro_yn.value = "N";
						semuro_yn.disabled = true;
						/*
						elec_tax_no1.disabled = false;
						elec_tax_no2.disabled = false;	
						elec_tax_no3.disabled = false
						elec_tax_no1.attribute("background-color") = DEFAULT_COLOR_REQ;
						elec_tax_no2.attribute("background-color") = DEFAULT_COLOR_REQ;
						elec_tax_no3.attribute("background-color") = DEFAULT_COLOR_REQ;					
						*/
					}
				}

				function setEvntInfo(Evnt_cd, Evnt_cd_nm){
					// 예산코드
					if (gstr_popupid == "budg_cd") {

						budg_cd.value = Evnt_cd;
						budg_cd_nm.value = Evnt_cd_nm;
						
					}
					
//					// 영수증구분
//					if (gstr_popupid == "prop_equip_cd") {
//
//						model.setValue("/root/resData/resform/prop_equip_cd", Evnt_cd);
//						
//						prop_equip_cd.refresh();
//					}
//					
//					// 매체코드조회
//					if (gstr_popupid == "medi_cd") {
//
//						model.setValue("/root/resData/resform/medi_cd", Evnt_cd);
//						model.setValue("/root/resData/resform/medi_cd_nm", Evnt_cd_nm);
//						
//						medi_cd.refresh();
//						medi_cd_nm.refresh();
//					}
					
					// 상세매체코드조회
					if (gstr_popupid == "dtls_medi_cd") {

						dtls_medi_cd.value =  Evnt_cd;
						
					}

				}	
				
				function fnWithTaxSetting() {
					var var_with_tax, var_incm_tax, var_res_tax, var_suply_amt, var_amt, var_qunt;
					
					// 소득구분에 따른 원천징수액, 소득세, 주민세 계산
					if (Number(with_tax.value) == 0) { // 원천징수
						var_with_tax = 0;
					}
					else {
						var_with_tax = Number(with_tax.value);
					}
					
					if (Number(suply_amt.value) == 0) { // 과표
						var_suply_amt = 0;
					}
					else {
						var_suply_amt = Number(suply_amt.value);
					}
					
					if (Number(qunt.value) == 0) { // 수량
						var_qunt = 0;
					}
					else {
						var_qunt = Number(qunt.value);
					}
					
					switch (incm_clsf_cd.value.substring(0, 5)) {	// 소득구분
						case "9010" :
							break;
						case "9001" :
							// 9001은 원천징수액 반드시 입력
							if(tax_dirinput.value == "1"){
								var_incm_tax = Number(incm_tax.value);
								
								var_res_tax = var_incm_tax * 0.1 / 10;
								var_res_tax = var_res_tax.GetRound(-1, -1) * 10;	// 주민세=소득세*0.1, 원단위 버림
								
								if(var_res_tax != res_tax.value){
									alert("주민세 입력이 잘못되었습니다. 다시 확인해주세요.");	
									return false;
								}
								
							}else{							
							var_incm_tax = var_with_tax / 1.1 / 10;
//							alert(var_incm_tax);
							var_incm_tax = var_incm_tax.GetRound(-1, -1) * 10; // 소득세=원천징수/1.1, 원단위 버림
//							alert(var_incm_tax);
							var_res_tax = var_with_tax - var_incm_tax;
//							alert(var_res_tax);
							}
							break;
						case "9003" :
							// 9003은 원천징수액 입력하지 않으며, 과표로 계산
//							var_incm_tax = var_suply_amt * 0.03 / 10;
							var_incm_tax = var_suply_amt * select_amt("9003","mang_cd_5") / 10;
							var_incm_tax = var_incm_tax.GetRound(-1, -1) * 10; 	// 소득세=과표*0.03, 원단위 버림
							var_res_tax = var_incm_tax * 0.1 / 10;
							var_res_tax = var_res_tax.GetRound(-1, -1) * 10;	// 주민세=소득세*0.1, 원단위 버림
							var_with_tax = var_incm_tax + var_res_tax;			// 원천징수=소득세+주민세
							break;
						case "9004" :
							if(tax_dirinput.value == "1"){
								
								var_incm_tax = Number(incm_tax.value);
								
								var_res_tax = var_incm_tax * 0.1 / 10;
								var_res_tax = var_res_tax.GetRound(-1, -1) * 10;	// 주민세=소득세*0.1, 원단위 버림
								
								if(var_res_tax != res_tax.value){
									alert("주민세 입력이 잘못되었습니다. 다시 확인해주세요.");	
									return false;
								}
								
								var_with_tax = var_incm_tax + var_res_tax;			// 원천징수=소득세+주민세
							}else{							
								var ch_num = (1*10 - (select_amt("9004","mang_cd_6")*10))/10;
	//							if (var_suply_amt * 0.2 <= 50000) { var_suply_amt = 0; }
								if (var_suply_amt * ch_num <= select_amt("9004","mang_cd_8")) { var_suply_amt = 0; }
								// 9004는 원천징수액 입력하지 않으며, 과표로 계산
	//							var_incm_tax = var_suply_amt * 0.2 * 0.2 / 10;
								var_incm_tax = var_suply_amt * ch_num * select_amt("9004","mang_cd_5") / 10;
								var_incm_tax = var_incm_tax.GetRound(-1, -1) * 10; 	// 소득세=과표*0.25*0.2, 원단위 버림
								var_res_tax = var_incm_tax * 0.1 / 10;
								var_res_tax = var_res_tax.GetRound(-1, -1) * 10;	// 주민세=소득세*0.1, 원단위 버림
								var_with_tax = var_incm_tax + var_res_tax;			// 원천징수=소득세+주민세
							}
							break;
						case "90041" :
//							if (var_suply_amt <= 50000) { var_suply_amt = 0; }
							if (var_suply_amt <= select_amt("90041","mang_cd_8")) { var_suply_amt = 0; }
							// 9004는 원천징수액 입력하지 않으며, 과표로 계산
//							var_incm_tax = var_suply_amt * 0.2 / 10;
							var_incm_tax = var_suply_amt * select_amt("90041","mang_cd_5") / 10;
							var_incm_tax = var_incm_tax.GetRound(-1, -1) * 10; 	// 소득세=과표*0.2, 원단위 버림
							var_res_tax = var_incm_tax * 0.1 / 10;
							var_res_tax = var_res_tax.GetRound(-1, -1) * 10;	// 주민세=소득세*0.1, 원단위 버림
							var_with_tax = var_incm_tax + var_res_tax;			// 원천징수=소득세+주민세
							break;
						case "90042" :
//							if (var_suply_amt * 0.2 <= 50000) { var_suply_amt = 0; }
							if (var_suply_amt * (select_amt("90042","mang_cd_5") / 0.2) <= select_amt("90042","mang_cd_8")) { var_suply_amt = 0; }
							// 9004는 원천징수액 입력하지 않으며, 과표로 계산
							// 2004.5.21 w_gwapyo * 0.25 를 w_gwapyo * 0.2 로
//							var_incm_tax = var_suply_amt * 0.2 * 0.2 / 10;
							var_incm_tax = var_suply_amt * select_amt("90042","mang_cd_5") / 10;
							var_incm_tax = var_incm_tax.GetRound(-1, -1) * 10; 	// 소득세=과표*0.25*0.2, 원단위 버림(김경훈)
							var_res_tax = var_incm_tax * 0.1 / 10;
							var_res_tax = var_res_tax.GetRound(-1, -1) * 10;	// 주민세=소득세*0.1, 원단위 버림
							var_with_tax = var_incm_tax + var_res_tax;			// 원천징수=소득세+주민세
							break;
						case "9005" :
							// 9005는 원천징수액을 입력할수도 있고, 하지 않을수도 있다.
							if(tax_dirinput.value == "1"){
								var_incm_tax = Number(incm_tax.value);
								
								var_res_tax = var_incm_tax * 0.1 / 10;
								var_res_tax = var_res_tax.GetRound(-1, -1) * 10;	// 주민세=소득세*0.1, 원단위 버림
								
								if(var_res_tax != res_tax.value){
									alert("주민세 입력이 잘못되었습니다. 다시 확인해주세요.");	
									return false;
								}
								
								var_with_tax = var_incm_tax + var_res_tax;			// 원천징수=소득세+주민세
								
							}else{
							
								if (var_with_tax != 0) {	// 원천징수액 입력시
									//var req_result = model.alert("원천징수세액을 기준으로 소득세,주민세를 다시 계산하시겠습니까?","원천징수세액계산",4);
									//alert(req_result);
									//if(req_result == 6) {
										var_incm_tax = var_with_tax / 1.1 / 10;
										var_incm_tax = var_incm_tax.GetRound(-1, -1) * 10; 	// 소득세=원천징수/1.1, 원단위 버림
										var_res_tax = var_with_tax - var_incm_tax;
									//}
								}
								else {
	//								var_incm_tax = var_suply_amt * 0.2 / 10;
									var req_result = model.alert("원천징수세액이 0입니다. 다시 계산하시겠습니까?","원천징수세액계산",4);
									//alert(req_result);
									if(req_result == 6) {
										var_incm_tax = var_suply_amt * select_amt("9005","mang_cd_5")  / 10;
										var_incm_tax = var_incm_tax.GetRound(-1, -1) * 10; 	// 소득세=과표*0.2, 원단위 버림
										var_res_tax = var_incm_tax * 0.1 / 10;
										var_res_tax = var_res_tax.GetRound(-1, -1) * 10;	// 주민세=소득세*0.1, 원단위 버림
										var_with_tax = var_incm_tax + var_res_tax;			// 원천징수=소득세+주민세
									}else{
										var_incm_tax = 0;
										var_res_tax = 0;
										var_with_tax = 0;
									}
								}
							}
							break;
						case "9011" :
							// 9011는 원천징수액 입력하지 않으며, 과표,수량으로 계산
							if (var_qunt == 0) {
								var_with_tax = 0;
								var_incm_tax = 0;
								var_res_tax = 0;								
							}
							else {
								var_amt = var_suply_amt / var_qunt;
								var_amt = var_amt.GetRound(-1, -1);		// 임시금액=과표/수량
								var_amt = var_amt - 80000;			// 임시금액-= 50000
//								var_amt = var_amt * 0.45 * 0.08;
								var_amt = var_amt * select_amt("9011","mang_cd_6") * select_amt("9011","mang_cd_5");
								var_amt = var_amt.GetRound(-1, -1);		// 임시금액=임시금액*0.55*0.1   2004.7.8(정병수씨) 0.55=>0.45 2005.2.3(정병수씨) 0.09==>0.08
								var_amt = var_amt * var_qunt / 10;
								var_amt = var_amt.GetRound(-1, -1) * 10;	// 소득세=임시금액*수량, 원단위 버림
//								if (var_incm_tax < 1000) {		// 개별소득세가 1000원미만이면 비과세
								if (var_incm_tax < select_amt("9011","mang_cd_7")) {		// 개별소득세가 1000원미만이면 비과세
									var_with_tax = 0;
									var_incm_tax = 0;
									var_res_tax = 0;
								}
								else {
									var_res_tax = var_incm_tax * 0.1 / 10;		// 주민세=소득세*0.1, 원단위 버림
									var_res_tax = var_res_tax.GetRound(-1, -1) * 10;
									var_with_tax = var_incm_tax + var_res_tax;		// 총원천징수=소득세+주민세
								}
							}
							break;
						default :
							var_with_tax = 0;
							var_incm_tax = 0;
							var_res_tax = 0;
					}
					
					// 소득세가 1000원미만이면 비과세
					if (var_incm_tax > 0 && var_incm_tax < 1000 && incm_clsf_cd.value.substring(0, 5) != "9010") {
						var_with_tax = 0;
						var_incm_tax = 0;
						var_res_tax = 0;
					}
					
					with_tax.value = var_with_tax;		// 원천징수
					incm_tax.value = var_incm_tax;		// 소득세
					res_tax.value = var_res_tax;		// 주민세
					
					if (incm_clsf_cd.value.substring(0, 4) == "9010") {
						fn9010WithTaxSetting();
					}
				}
				
				function fn9010WithTaxSetting() {
					var var_with_tax, var_incm_tax, var_res_tax, var_suply_amt, var_amt, var_qunt;
					var var_occr_slip_seq;
					
					if (Number(suply_amt.value) == 0) { // 과표
						var_suply_amt = 0;
					}
					else {
						var_suply_amt = Number(suply_amt.value);
					}
					
					model.setValue("/root/reqData/search1/cmpy_cd", model.getValue("/root/initData/session/cmpy_cd"));					
					model.setValue("/root/reqData/search1/input_val_1", dlco_cd.value);					
					model.setValue("/root/reqData/search1/input_val_2", "");
					
					model.send("fc_acct_2081_s");
					
					model.refresh();
					
					if (model.getValue("/root/initData/fc_acct_2081_s/dataSet/CURLIST/record[1]/outval1") == "US") {
						var_incm_tax = var_suply_amt * 0.1 / 10;
						var_incm_tax = var_incm_tax.GetRound(-1, -1) * 10;
						var_res_tax = var_incm_tax * 0.1 / 10;
						var_res_tax = var_res_tax * 10;
						var_with_tax = var_incm_tax + var_res_tax;
					}
					else {
						var_with_tax = var_suply_amt * 0.1 / 10;
						var_with_tax = var_with_tax.GetRound(-1, -1) * 10;
						var_incm_tax = var_with_tax * 10 / 11 / 10;
						var_incm_tax = var_incm_tax * 10;
						var_res_tax = var_with_tax - var_incm_tax;
					}
					
					if (var_incm_tax < 1000) {	// 소득세가 1000원미만이면 비과세
						var_with_tax = 0;
						var_incm_tax = 0;
						var_res_tax = 0;
					}
					
					with_tax.value = var_with_tax;		// 원천징수
					incm_tax.value = var_incm_tax;		// 소득세
					res_tax.value = var_res_tax;		// 주민세
					
				}
				
				function fnParentSetting(iv_row, iv_x) {
					
					var var_i, var_suply_amt, var_vat_amt, var_vat_amt2;
					var var_vat_seq;
					var var_occr_slip_seq;
					var req_result;
					
					if (trim(suply_amt.value) == "") { suply_amt.value = 0; }
					if (trim(vat_amt.value) == "") { vat_amt.value = 0; }
					if (trim(with_tax.value) == "") { with_tax.value = 0; }
					if (trim(incm_tax.value) == "") { incm_tax.value = 0; }
					if (trim(res_tax.value) == "") { res_tax.value = 0; }
					if (trim(etc_in.value) == "") { etc_in.value = 0; }
					if (trim(qunt.value) == "") { qunt.value = 0; }
					if (trim(purc_amt.value) == "") { purc_amt.value = 0; }
					if (trim(int_rate.value) == "") { int_rate.value = 0; }
					if (trim(corp_tax_amt.value) == "") { corp_tax_amt.value = 0; }
					if (trim(draft_expn_amt.value) == "") { draft_expn_amt.value = 0; }

					// 선급금 관련 계정은 부가세를 입력 할 수 없다.
					if (budg_cd.value.substring(0, 3) == "160") {
						vat_amt.value = "0";
						prof_type_cd.value = "";
						occr_slip_clsf_cd.value = "";
						occr_slip_occr_dt.value = "";
						occr_slip_seq.value = "";
						erplace_cd.value = "";
						make_dt.value = "";
						ern.value = "";
					}
					
					// 증빙코드가 "8900" or "8950" 일때만 계산서 사항을 입력할 수 있다.
					if (prop_equip_cd.value != "8900" && prop_equip_cd.value != "8950") {
						
						if (prof_type_cd.value!= "") {
							model.alert("영수증구분이 세금계산서(8900), 계산서(8950)인 경우에만 세금계산서 사항을 입력할 수 있습니다.");
							model.setFocus("prof_type_cd");
							return;
						}
						
						vat_amt.value = "0";
						prof_type_cd.value = "";
						occr_slip_clsf_cd.value = "";
						occr_slip_occr_dt.value = "";
						occr_slip_seq.value = "";
						erplace_cd.value = "";
						make_dt.value = "";
						ern.value = "";
						elec_tax_no1.value = "";
						elec_tax_no2.value = "";
						elec_tax_no3.value = "";
					}
					
					// HEAD 필수 CHECK
					if (budg_cd.value.length != 6) {
						model.alert("예산코드는 필수입력항목입니다.");
						model.setFocus("budg_cd");
						return;
					}
					
					if (use_dept_cd.value.length != 6) {
						model.alert("사용부서는 필수입력항목입니다.");
						model.setFocus("use_dept_cd");
						return;
					}
					
					if (strwhco_comn_cost_yn == "Y") {
						if (use_dept_cd.value != "999999") {
							model.alert("사용부서:999999, 해당지출건은 전사배부비 입니다.");
							model.setFocus("use_dept_cd");
							return;
						}
					}
					
					if (use_dept_cd.value == "999999" && strwhco_comn_cost_yn != "Y") {
						if (strwhco_ndstb_cd == "") {
							model.alert("사용부서필수, 해당지출건은 전사배부비가 아닙니다.");
							model.setFocus("use_dept_cd");
							return;
						}
					}
					
					if (Number(suply_amt.value) == 0) {
						model.alert("과표는 필수입력항목입니다.");
						model.setFocus("suply_amt");
						return;
					}
					
					// BACKGROUND COLOR로 CHECK
					if (vat_amt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (Number(vat_amt.value) == 0) {
							model.alert("부가세는 필수입력항목입니다.");
							model.setFocus("vat_amt");
							return;
						}
					}
					
					// 부가세는 반드시 공급가액 * 0.089 <= 부가세 <= 공급가액 * 0.102 (19991126 박지원)
					if (Number(vat_amt.value) == 0) {
						var_vat_amt2 = 0;
					}
					else {
						var_vat_amt2 = Number(vat_amt.value);
					}
					
					// +금액인 경우 부가세금액 check
					if (var_vat_amt2 > 0) {
						if (Number(vat_amt.value) < (Number(suply_amt.value) * 0.09).GetRound(-1, -1) || Number(vat_amt.value) > Number(Number(suply_amt.value) * 0.102)) {
							req_result = model.alert("부가세가 정확하지 않습니다. 그래도 입력하시겠습니까?" + (Number(suply_amt.value) * 0.09).GetRound(-1, -1) + ":" + Number(Number(suply_amt.value) * 0.102),"부가세체크",4);
							//model.alert("부가세를 정확히 입력해 주십시오:" + (Number(suply_amt.value) * 0.09).GetRound(-1, -1) + ":" + Number(Number(suply_amt.value) * 0.102));
							if(req_result != 6){
								model.setFocus("vat_amt");
								return;
							}
						}
					}

					// -금액인 경우 부가세금액 check(2000/03/15추가)
					if (var_vat_amt2 < 0) {
						if (Number(vat_amt.value) > Number(suply_amt.value) * 0.098 || Number(vat_amt.value) < Number(suply_amt.value) * 0.102) {
							req_result = model.alert("부가세가 정확하지 않습니다. 그래도 입력하시겠습니까?" + (Number(suply_amt.value) * 0.098).GetRound(-1, -1) + ":" + Number(Number(suply_amt.value) * 0.102),"부가세체크",4);							
							//model.alert("부가세를 정확히 입력해 주십시오.");
							if(req_result != 6){
								model.setFocus("vat_amt");
								return;
							}
						}
					}					
					
					if (dlco_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(dlco_clsf_cd,"trim","focus","거래처구분은 필수입력항목입니다.")) { return false; }     
					}

					if (dlco_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(dlco_cd,"trim","focus","거래처코드는 필수입력항목입니다.")) { return false; }     
					}
					
					if ((dlco_cd.value != "") && (dlco_nm.value == "")){
						model.alert("거래처는 거래처조회를 통해 정확히 입력해 주십시오.");
						model.setFocus("dlco_cd");
						return false;
					}

					if ((recp_pers.value != "") && (recp_pers_nm.value == "")){
						model.alert("수령자는 조회버튼을 통해 정확히 입력해 주십시오.");
						model.setFocus("recp_pers");
						return false;
					}
					
					
					if (dlco_clsf_cd.value.substring(0, 3) == "94" && dlco_clsf_cd.value != "") {
						if ((dlco_cd.value.substring(7, 1) == "5" || dlco_cd.value.substring(7, 1) == "6") && dlco_cd.value.substring(6, 1) == "-") {
							// 고객의 외국인 등록번호 체크
							if (CheckFgnRegVal(dlco_cd.value.ReplaceString("-", "")) == false) { return; }
						}
						else if (dlco_clsf_cd.value.length == 14 && dlco_clsf_cd.value.substring(6, 1) == "-") {
							// 고객의 주민등록번호 체크
							if (commCheckRrnoVal(dlco_cd.value.ReplaceString("-", "")) == false) { return; }
						}
					}

					if (prop_equip_cd.value == "8984") {
						if (dlco_clsf_cd.value.substring(0, 2) != "93" && dlco_clsf_cd.value.substring(0, 2) != "94") {
							model.alert("해당 영수증 구분은 93, 94 거래처만 가능");
							model.setFocus("dlco_clsf_cd");
							return;
						}
						
						if (acct_cd.value == "") {
							model.alert("해당 영수증 구분은 계좌가 있는 거래처만 가능");
							model.setFocus("dlco_clsf_cd");
							return;
						}
					}
					
					if (boks_dlco_nm.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(boks_dlco_nm,"trim","focus","부거래처는 필수입력항목입니다.")) { return false; }     
					}

					if (mang_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(mang_clsf_cd,"trim","focus","관리구분은 필수입력항목입니다.")) { return false; }     
					}
					
					if (prop_equip_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						var_suply_amt = Number(suply_amt.value);
						var_vat_amt = Number(vat_amt.value);
						
						if (var_vat_amt != 0) {
							if (prop_equip_cd.value.substring(0, 4) != "8900") {
								model.alert("영수증구분, 부가세 존재시 8900만 가능");
								model.setFocus("prop_equip_cd");
								return;
							}
						}
						else {
							if (prof_type_cd.value != "") {
								if (prof_type_cd.value.substring(0, 2) == "15") {
									if (prop_equip_cd.value.substring(0, 4) != "8900") {
										model.alert("영수증구분, 8900만 가능");
										model.setFocus("prop_equip_cd");
										return;
									}
								}
								else {
									if (prop_equip_cd.value.substring(0, 4) != "8950") {
										model.alert("영수증구분, 8950만 가능");
										model.setFocus("prop_equip_cd");
										return;
									}
								}
							}
						}
						
						if (incm_clsf_cd.value != "") {
							prop_equip_cd.value = "8976";
						}
						else {
							// 과표가 만원 이하일때
							if (var_suply_amt <= 30000) {
								if (budg_cd.value.substring(0, 4) == "6775" ||
								    budg_cd.value.substring(0, 4) == "7733" ||
								    budg_cd.value.substring(0, 4) == "6731" ||
								    budg_cd.value.substring(0, 4) == "7696" ||
								    budg_cd.value.substring(0, 4) == "7711" ||
								    budg_cd.value.substring(0, 4) == "6462" ||
								    budg_cd.value.substring(0, 4) == "7770" ||
								    budg_cd.value.substring(0, 4) == "6904" ||
								    budg_cd.value.substring(0, 4) == "7722" ||
								    budg_cd.value.substring(0, 4) == "7685" ||
								    budg_cd.value.substring(0, 4) == "6720") {
									if (prop_equip_cd.value != "8930" &&
									    prop_equip_cd.value != "8931" &&
									    prop_equip_cd.value != "8950" &&
									    prop_equip_cd.value != "8900" &&
									    prop_equip_cd.value != "8960" &&
									    prop_equip_cd.value != "8925" &&
									    prop_equip_cd.value < "8970" &&
									    prop_equip_cd.value > "8985") {
										model.alert("과표가 3만원보다 작거나 같습니다. 영수증구분을 정확히 입력해 주십시오.");
										model.setFocus("prop_equip_cd");
										return;						    
									}
								}
								else {
									if (prop_equip_cd.value == "") {
										prop_equip_cd.value = "8920";
									}
									else {
										if (prop_equip_cd.value != "8930" &&
										    prop_equip_cd.value != "8931" &&
										    prop_equip_cd.value != "8950" &&
										    prop_equip_cd.value != "8900" &&
										    prop_equip_cd.value != "8925" &&
										    prop_equip_cd.value != "8920") {
											model.alert("과표가 3만원보다 작거나 같습니다. 영수증구분을 정확히 입력해 주십시오.");
											model.setFocus("prop_equip_cd");
											return;						    
										}
									}
								}
							}
							else { // 과표가 10만원 이상일때
								if (budg_cd.value.substring(0, 4) == "6775" ||
								    budg_cd.value.substring(0, 4) == "7733" ||
								    budg_cd.value.substring(0, 4) == "6731" ||
								    budg_cd.value.substring(0, 4) == "7696" ||
								    budg_cd.value.substring(0, 4) == "7711" ||
								    budg_cd.value.substring(0, 4) == "6462" ||
								    budg_cd.value.substring(0, 4) == "7770" ||
								    budg_cd.value.substring(0, 4) == "6904" ||
								    budg_cd.value.substring(0, 4) == "7722" ||
								    budg_cd.value.substring(0, 4) == "7685" ||
								    budg_cd.value.substring(0, 4) == "6720") {
									if (prop_equip_cd.value != "8930" &&
									    prop_equip_cd.value != "8931" &&
									    prop_equip_cd.value != "8950" &&
									    prop_equip_cd.value != "8900" &&
									    prop_equip_cd.value != "8960" &&
									    prop_equip_cd.value != "8925" &&
									    prop_equip_cd.value < "8970" &&
									    prop_equip_cd.value > "8985") {
										model.alert("과표가 3만원보다 큰 금액입니다. 영수증구분을 정확히 입력해 주십시오.");
										model.setFocus("prop_equip_cd");
										return;						    
									}
								}
								else {
									if (prop_equip_cd.value == "" || prop_equip_cd.value == "8920") {
										model.alert("과표가 3만원보다 큰 금액입니다. 영수증구분을 정확히 입력해 주십시오.");
										model.setFocus("prop_equip_cd");
										return;						    
									}
								}
							}
						}
					}
					
					// 증빙코드가 "8900" or "8950" 일때만 계산서 사항을 입력할 수 있다.(영수증구분 변경가능하니까 다시체크)
					if (prop_equip_cd.value != "8900" && prop_equip_cd.value != "8950") {
						if (prof_type_cd.value != "") {
							model.alert("영수증구분이 세금계산서(8900), 계산서(8950)인 경우에만 세금계산서 사항을 입력할 수 있습니다.");
							model.setFocus("prof_type_cd");
							return;	
						}
					}
					
					// 매체코드가 '10','20','60'은 입력 불가: 20000110 이정일씨 협의
					// 410추가 전산화의뢰(20110503:김태훈) 노상현수정
					/*
					if (medi_cd.value == "100" || medi_cd.value == "200" || medi_cd.value == "600" || medi_cd.value == "410") {
						model.alert("입력가능한 매체코드가 아닙니다");
						model.setFocus("medi_cd");
						return;	
					}
					*/
					//상세매체 코드 체크
					if(get_refvalue("/root/tempData/medi_ch") == "Y") {
						if(dtls_medi_cd.value == ""){
							show_message("[상세매체코드]은(는) 필수입력항목입니다.");
							return false;
						}
					}
					if (dtls_medi_cd.attribute("background-color") == DEFAULT_COLOR_REQ ) {
						if (dtls_medi_cd.value.Trim() == "") {
							model.alert("상세매체코드는 필수입력사항입니다.");
							model.setFocus("dtls_medi_cd");
							return;
						}
					}
					
					// 유가증권 or 보험
					if (budg_cd.value.substring(0, 4) == "1713" || budg_cd.value == "201800") {
						if (budg_cd.value == "201800") {	// 유가증권
							if (mang_clsf_cd.value.substring(0, 1) != "2") {
								model.alert("관리구분(증권구분) 입력 오류");
								model.setFocus("mang_clsf_cd");
								return;
							}
						}
						else {	//  보험
							if (mang_clsf_cd.value.substring(0, 4) != "5100" && mang_clsf_cd.value.substring(0, 4) != "5400") {
								model.alert("관리구분(보험구분;5100,5400) 입력오류");
								model.setFocus("mang_clsf_cd");
								return;
							}
						}
					}
					
					if (mang_no.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (budg_cd.value == "201800") {	// 유가증권
							if (mang_no.value.length != 8) {
								model.alert("관리번호(증권번호) 입력 오류");
								model.setFocus("mang_no");
								return;
							}
						}
						else {	//  보험
							if (!check_reqItem(mang_no,"trim","focus","관리번호는 필수입력항목입니다.")) { return false; }     
						}
					}
					
					if (incm_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(incm_clsf_cd,"trim","focus","소득구분은 필수입력항목입니다.")) { return false; }     
					}

					if (with_tax.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(with_tax,"trim","focus","원천징수는 필수입력항목입니다.")) { return false; }     
					}
					
					if (etc_in.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(etc_in,"trim","focus","잡수익은 필수입력항목입니다.")) { return false; }     
					}

					if (setoff_slip_no.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (setoff_slip_no.value.length != 20) {
							model.alert("선급지출번호는 필수입력항목입니다.");
							model.setFocus("setoff_slip_no");
							return;
						}
					}

					if (medi_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(medi_cd,"trim","focus","매체코드는 필수입력항목입니다.")) { return false; }     
					}
					
					if (dtls_medi_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (medi_cd.value > 200 && medi_cd.value < 500) {
							if (!check_reqItem(dtls_medi_cd,"trim","focus","상세매체코드는 필수입력항목입니다.")) { return false; }     
						}
					}

					if (comp_dt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(comp_dt,"trim","focus","기산일자는 필수입력항목입니다.")) { return false; }     
					}

					if (mtry_dt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(mtry_dt,"trim","focus","만기일자는 필수입력항목입니다.")) { return false; }     
					}

					if (unit.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(unit,"trim","focus","단위는 필수입력항목입니다.")) { return false; }     
					}

					if (qunt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (Number(qunt.value) == 0) {
							model.alert("수량은 필수입력항목입니다.");
							model.setFocus("qunt");
							return;
						}
					}
					
					if (prof_type_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						
						if (!check_reqItem(prof_type_cd,"trim","focus","세금계산서유형은 필수입력항목입니다.")) { return false; }     
						
						var_vat_amt = Number(vat_amt.value);
						
						if (var_vat_amt != 0) {
							if (prof_type_cd.value.substring(0, 2) != "11" &&
							    prof_type_cd.value.substring(0, 2) != "12" &&
							    prof_type_cd.value.substring(0, 2) != "13" &&
							    prof_type_cd.value.substring(0, 2) != "14") {
								model.alert("증빙유형 11,12,13,14만 가능합니다.");
								model.setFocus("prof_type_cd");
								return;
							}
						}
						else {
							if (prof_type_cd.value.substring(0, 2) != "15" &&
							    prof_type_cd.value.substring(0, 2) != "16") {
								model.alert("증빙유형은 15, 16만 가능합니다.");
								model.setFocus("prof_type_cd");
								return;
							}
						}
					}
					
//					alert(occr_slip_clsf_cd.attribute("background-color"));
					
					if (occr_slip_clsf_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (occr_slip_clsf_cd.value == "") {
							model.alert("세금계산서구분은 필수입력항목입니다.");
							model.setFocus("prof_type_cd");
							return;
						}
					}

					if (occr_slip_occr_dt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(occr_slip_occr_dt,"trim","focus","세금계산서 발생일자는 필수입력항목입니다.")) { return false; }     
					}

					if (make_dt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(make_dt,"trim","focus","작성일자는 필수입력항목입니다.")) { return false; }     
						
						if (make_dt.value.ReplaceString("-", "").substring(0, 6) != parentWindow.budg_yymm.value.ReplaceString("-", "")) {
							model.alert("예산년월과 작성일자의 월이 상이합니다.");
							model.setFocus("make_dt");
							return;
						}
					}

					if (erplace_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(erplace_cd,"trim","focus","사업장코드는 필수입력항목입니다.")) { return false; }     
					}
					//debugger;	
					
					if (prop_equip_cd.value == "8900") {
					if( model.getValue("/root/tempData/paper_yn") != "Y") {
						if(semuro_yn.value != "Y"){
							if (elec_tax_no1.attribute("background-color") == DEFAULT_COLOR_REQ) {
								if (!check_reqItem(elec_tax_no1,"trim","focus","전자세금계산서 승인번호는 필수입력항목입니다.")) { return false; }     
							}					
							if (elec_tax_no2.attribute("background-color") == DEFAULT_COLOR_REQ) {
								if (!check_reqItem(elec_tax_no2,"trim","focus","전자세금계산서 승인번호는 필수입력항목입니다.")) { return false; }     
							}					
							if (elec_tax_no3.attribute("background-color") == DEFAULT_COLOR_REQ) {
								if (!check_reqItem(elec_tax_no3,"trim","focus","전자세금계산서 승인번호는 필수입력항목입니다.")) { return false; }     
							}

							model.setValue("/root/resData/resform/semu_semuro_no",elec_tax_no1.value + elec_tax_no2.value + elec_tax_no3.value );
						}
					}
					}
					/*	
					}else{
						if(model.getValue("/root/resData/resform/semu_semuro_no") == ""){
							
						}
					*/
					
					
					
					if (ern.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (ern.value.length!= 12) {
							model.alert("공급자번호는 필수입력항목입니다.");
							model.setFocus("ern");
							return;
						}
					}
					
					if (purc_amt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (Number(purc_amt.value) == 0) {
							model.alert("매입금액은 필수입력항목입니다.");
							model.setFocus("purc_amt");
							return;
						}
					}

					if (corp_tax_amt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (Number(suply_amt.value) != Number(corp_tax_amt.value)) {
							if (Number(corp_tax_amt.value) == 0) {
								if (budg_cd.value != "201800") {
									model.alert("법인세는 필수입력항목입니다.");
									model.setFocus("corp_tax_amt");
									return;
								}else{
									 if (Number(purc_amt.value) != Number(suply_amt.value)){
										model.alert("법인세는 필수입력항목입니다.");
										model.setFocus("corp_tax_amt");
										return;
									 }
								}
							}
						}
					}
					
					if (issu_dt.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(issu_dt,"trim","focus","매입일은 필수입력항목입니다.")) { return false; }     
					}
					
					if (int_rate.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (Number(int_rate.value) == 0) {
							model.alert("약정이율은 필수입력항목입니다.");
							model.setFocus("int_rate");
							return;
						}
					}
					
					if (pay_bank_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (pay_bank_cd.value.length!= 6) {
							model.alert("지급은행은 필수입력항목입니다.");
							model.setFocus("pay_bank_cd");
							return;
						}
					}
					
					if (insr_nm.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(insr_nm,"trim","focus","보험명은 필수입력항목입니다.")) { return false; }     
					}

					if (occr_slip_clsf.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(occr_slip_clsf,"trim","focus","전사잔액전표구분은 필수입력항목입니다.")) { return false; }     
					}
					
					if (occr_slip.attribute("background-color") == DEFAULT_COLOR_REQ) {
						if (!check_reqItem(occr_slip,"trim","focus","전사잔액전표번호는 필수입력항목입니다.")) { return false; }     
					}		


					var var_temp_ern = "";

					// 계산서 사항 입력시 사업자로 거래처,부거래처 SET
					if (prof_type_cd.value != "") {
						if (ern.value.length== 14) {
							var_temp_ern = "94";
						}
						else {
							var_temp_ern = "93";
						}
						
//						alert(ern.value);
						
						model.setValue("/root/reqData/search/dlco_clsf_cd", var_temp_ern);
						model.setValue("/root/reqData/search/dlco_no", ern.value);
						
						model.send("fc_acct_2082_s");

						if(submit_completed()){
							// 
						}
						else {
							viewer("mainFrame").window.javaScript.onLoadExPopupPage("CO_DLCO_1000");
							return false;
						}
						
					}

					
					// 세금계산서 임시순번 채번
					if (occr_slip_seq.value == "" && prof_type_cd.value != "") {
						
						var_occr_slip_seq = "";

						for (i=1;i< childBody.datagrid1.Rows-1;i++) {

							if (childBody.datagrid1.valueMatrix(i, 25).ReplaceString("-", "").substring(0, 12) == prof_type_cd.value.substring(0, 2) + occr_slip_clsf_cd.value + occr_slip_occr_dt.value.ReplaceString("-", "") &&
							    childBody.datagrid1.valueMatrix(i, 25).ReplaceString("-", "").substring(12, 16) > var_occr_slip_seq) {
							    	var_occr_slip_seq = childBody.datagrid1.valueMatrix(i, 25).ReplaceString("-", "").substring(12, 16);
							}
						}
						
						if (Number(var_occr_slip_seq) >= 0) {
							occr_slip_seq.value = Number(var_occr_slip_seq) + 1;
							occr_slip_seq.value = occr_slip_seq.value.GetZeroString(4);
						}
						else {
							occr_slip_seq.value = "0001";
						}
					}	

					if (iv_x == "I") {
						childBody.datagrid1.insertRow(childBody.datagrid1.rows - 1);

						childBody.datagrid1.row = childBody.datagrid1.rows - 2;
						childBody.datagrid1.col = 1;

						srchslip_arow_no.value = childBody.datagrid1.rows - 2;
						srchslip_arow_no.value = srchslip_arow_no.value.GetZeroString(6);
						
						iv_row = childBody.datagrid1.rows - 2;
						
						childBody.datagrid1.rowStatus(iv_row) = 3;

					}
					
					if (iv_x == "A") {
						childBody.datagrid1.insertRow(childBody.datagrid1.row);

						childBody.datagrid1.row = childBody.datagrid1.row;
						childBody.datagrid1.col = 1;
						srchslip_arow_no.value = childBody.datagrid1.row;
						srchslip_arow_no.value = srchslip_arow_no.value.GetZeroString(6);
						
						iv_row = childBody.datagrid1.row;
						childBody.datagrid1.rowStatus(iv_row) = 3;
					}
					
					if (iv_x == "U") {
						childBody.datagrid1.rowStatus(iv_row) = 3;
					}


											
					childBody.datagrid2.valueMatrix(iv_row, 1) = prof_type_cd.value.substring(0, 2) + occr_slip_clsf_cd.value + occr_slip_occr_dt.value.ReplaceString("-", "") + occr_slip_seq.value;

					childBody.datagrid1.valueMatrix(iv_row, 66) = iv_x;
					
					if (iv_x == "I") {
						childBody.datagrid1.valueMatrix(iv_row, 59) = "0";
						childBody.datagrid1.valueMatrix(iv_row, 60) = "";
					}
					
//					alert(Number(purc_amt.value));
				
//					alert(iv_row);
//					alert(use_dept_cd.value);
				
					childBody.datagrid1.valueMatrix(iv_row, 1) = budg_cd.value;
					childBody.datagrid1.valueMatrix(iv_row, 2) = budg_cd_nm.value;
					childBody.datagrid1.valueMatrix(iv_row, 3) = use_dept_cd.value;
					childBody.datagrid1.valueMatrix(iv_row, 4) = Number(suply_amt.value);
					childBody.datagrid1.valueMatrix(iv_row, 5) = Number(vat_amt.value);
					childBody.datagrid1.valueMatrix(iv_row, 6) = rmks2.value;
					childBody.datagrid1.valueMatrix(iv_row, 7) = dlco_clsf_cd.value;
					childBody.datagrid1.valueMatrix(iv_row, 8) = dlco_cd.value;
					childBody.datagrid1.valueMatrix(iv_row, 9) = dlco_nm.value;
					childBody.datagrid1.valueMatrix(iv_row, 10) = boks_dlco_nm.value;
					childBody.datagrid1.valueMatrix(iv_row, 11) = mang_clsf_cd.value.substring(0, 8);
					childBody.datagrid1.valueMatrix(iv_row, 12) = mang_no.value;
					childBody.datagrid1.valueMatrix(iv_row, 13) = incm_clsf_cd.value.substring(0, 5);
					childBody.datagrid1.valueMatrix(iv_row, 14) = Number(with_tax.value);
					childBody.datagrid1.valueMatrix(iv_row, 15) = Number(incm_tax.value);
					childBody.datagrid1.valueMatrix(iv_row, 16) = Number(res_tax.value);
					childBody.datagrid1.valueMatrix(iv_row, 17) = Number(etc_in.value);
					childBody.datagrid1.valueMatrix(iv_row, 18) = setoff_slip_no.value;
					childBody.datagrid1.valueMatrix(iv_row, 19) = medi_cd.value;
					childBody.datagrid1.valueMatrix(iv_row, 20) = dtls_medi_cd.value;
					childBody.datagrid1.valueMatrix(iv_row, 21) = comp_dt.value;
					childBody.datagrid1.valueMatrix(iv_row, 22) = mtry_dt.value;
					childBody.datagrid1.valueMatrix(iv_row, 23) = unit.value;
					childBody.datagrid1.valueMatrix(iv_row, 24) = Number(qunt.value);
					childBody.datagrid1.valueMatrix(iv_row, 25) = prof_type_cd.value.substring(0, 2) + occr_slip_clsf_cd.value + occr_slip_occr_dt.value.ReplaceString("-", "") + occr_slip_seq.value;
					childBody.datagrid1.valueMatrix(iv_row, 26) = make_dt.value;
					childBody.datagrid1.valueMatrix(iv_row, 27) = erplace_cd.value.substring(0, 2);
					childBody.datagrid1.valueMatrix(iv_row, 28) = ern.value;
					childBody.datagrid1.valueMatrix(iv_row, 29) = use_dept_cd_nm.value;
					childBody.datagrid1.valueMatrix(iv_row, 30) = medi_cd_nm.value;
					childBody.datagrid1.valueMatrix(iv_row, 31) = complete_flag.value;
					
					for(var i=1; i<childBody.datagrid1.rows-1; i++){
						if(setoff_slip_no.value != "" && setoff_slip_no.value == childBody.datagrid1.valueMatrix(i,18)){
							childBody.datagrid1.valueMatrix(i, 31) = complete_flag.value;
						}
					}
					
					childBody.datagrid1.valueMatrix(iv_row, 32) = Number(purc_amt.value);
					childBody.datagrid1.valueMatrix(iv_row, 33) = Number(int_rate.value);
					childBody.datagrid1.valueMatrix(iv_row, 34) = pay_bank_cd.value;
					childBody.datagrid1.valueMatrix(iv_row, 35) = insr_nm.value;
					childBody.datagrid1.valueMatrix(iv_row, 36) = pay_bank_cd_nm.value;
					childBody.datagrid1.valueMatrix(iv_row, 37) = intg_dlco_cd.value;
					childBody.datagrid1.valueMatrix(iv_row, 38) = prop_equip_cd.value;
					childBody.datagrid1.valueMatrix(iv_row, 39) = Number(corp_tax_amt.value);
					childBody.datagrid1.valueMatrix(iv_row, 40) = issu_dt.value;
					childBody.datagrid1.valueMatrix(iv_row, 41) = bank_clsf.value;
					childBody.datagrid1.valueMatrix(iv_row, 42) = acct_cd.value;
					childBody.datagrid1.valueMatrix(iv_row, 43) = peps_pers_nm.value;
					childBody.datagrid1.valueMatrix(iv_row, 44) = occr_slip_clsf.value;
					childBody.datagrid1.valueMatrix(iv_row, 45) = occr_slip.value;
					childBody.datagrid1.valueMatrix(iv_row, 47) = draft_doc_no.value;
					childBody.datagrid1.valueMatrix(iv_row, 48) = draft_expn_amt.value;
					childBody.datagrid1.valueMatrix(iv_row, 49) = recp_pers_clsf.value;
					childBody.datagrid1.valueMatrix(iv_row, 50) = recp_pers.value + "^" + recp_pers_nm.value;
					childBody.datagrid1.valueMatrix(iv_row, 58) = Number(suply_amt.value);
					
//					alert(rece_exp_aplc_yn.value);
					
					// 접대비 신청여부
					if (rece_exp_aplc_yn.value == "1") {
						childBody.datagrid1.valueMatrix(iv_row, 46) = "1";
					}
					else {
						childBody.datagrid1.valueMatrix(iv_row, 46) = "0";
					}
					
					childBody.datagrid1.valueMatrix(iv_row, 47) = draft_doc_no.value;
					childBody.datagrid1.valueMatrix(iv_row, 48) = Number(draft_expn_amt.value);
					childBody.datagrid1.valueMatrix(iv_row, 49) = recp_pers_clsf.value;
					childBody.datagrid1.valueMatrix(iv_row, 50) = recp_pers.value;
					
					// 기안문서부서
					childBody.datagrid1.valueMatrix(iv_row, 68) = model.getValue("/root/resData/resform/draft_dept_cd");
					
//					alert(model.getValue("/root/resData/resform/semu_occr_dt"));
					
					//===================세무로정보=====================================
					childBody.datagrid1.valueMatrix(iv_row, 69) = model.getValue("/root/resData/resform/semu_cmpy_cd");
					childBody.datagrid1.valueMatrix(iv_row, 70) = model.getValue("/root/resData/resform/semu_occr_dt");
					childBody.datagrid1.valueMatrix(iv_row, 71) = model.getValue("/root/resData/resform/semu_seq");
					childBody.datagrid1.valueMatrix(iv_row, 72) = model.getValue("/root/resData/resform/semu_semuro_no");
					childBody.datagrid1.valueMatrix(iv_row, 73) = model.getValue("/root/resData/resform/semu_send_pers_email");
					//==================================================================
					childBody.datagrid1.valueMatrix(iv_row, 76) = recp_pers.value;
					childBody.datagrid1.valueMatrix(iv_row, 77) = recp_pers_nm.value;					
					

					// 계산서 사항 입력시 사업자로 거래처,부거래처 SET
					if (prof_type_cd.value != "") {
						if (ern.value.length== 14) {
							childBody.datagrid1.valueMatrix(iv_row, 7) = "94";
						}
						else {
							childBody.datagrid1.valueMatrix(iv_row, 7) = "93";
						}
						
//						alert(ern.value);
						
						model.setValue("/root/reqData/search/dlco_clsf_cd", childBody.datagrid1.valueMatrix(iv_row, 7));
						model.setValue("/root/reqData/search/dlco_no", ern.value);
						
						model.send("fc_acct_2082_s");

						if(submit_completed()){
							
//							alert(model.getValue("/root/initData/fc_acct_2082_s/dataSet/dlco_abrv_nm"));
							
							childBody.datagrid1.valueMatrix(iv_row, 8) = ern.value;
							childBody.datagrid1.valueMatrix(iv_row, 9) = model.getValue("/root/initData/fc_acct_2082_s/dataSet/dlco_abrv_nm");
							childBody.datagrid1.valueMatrix(iv_row, 10) = model.getValue("/root/initData/fc_acct_2082_s/dataSet/dlco_abrv_nm");
							childBody.datagrid1.valueMatrix(iv_row, 37) = model.getValue("/root/initData/fc_acct_2082_s/dataSet/dlco_no");
							
							// 화면에
							boks_dlco_nm.value = model.getValue("/root/initData/fc_acct_2082_s/dataSet/dlco_abrv_nm");
							
							dlco_clsf_cd.value = model.getValue("/root/reqData/search/dlco_clsf_cd");
							
							if (dlco_clsf_cd.label != "") {
								dlco_cd.value = ern.value;           		// 거래처코드   
								dlco_nm.value = model.getValue("/root/initData/fc_acct_2082_s/dataSet/dlco_abrv_nm");        // 거래처명     
								intg_dlco_cd.value = model.getValue("/root/initData/fc_acct_2082_s/dataSet/dlco_no"); 		// 통합거래처코드
							}
						}
						else {
							if (ern.value.length!= 12) {
								model.alert("공급자번호는 필수입력항목입니다.");
								model.setFocus("ern");
								return;
							}
						}
						
					}

				}
				
				// 외국인등록번호 체크			
				function CheckFgnRegVal(val) {
	
					var varSumx = 0;
					var varY, varI;
					var varOdd = Number(val.substring(7, 1)) * 10 + Number(val.substring(8, 1));
					
					if ((varOdd % 2) != 0 ) {
						alert("잘못된 외국인등록번호입니다. 다시 확인해 주십시오");
						return false;
					}
	
					if (val.substring(11, 1) != "6" && val.substring(11, 1) != "7" && val.substring(11, 1) != "8" && val.substring(11, 1) != "9") {
						alert("잘못된 외국인등록번호입니다. 다시 확인해 주십시오");
						return false;
					}
	
					if (val.length != 13) {
						alert("잘못된 외국인등록번호입니다. 다시 확인해 주십시오");
						return false;
					}
					else {
						
						for (i=0;i<12;i++) {
							if (i < 9) {
								varSumx = varSumx + Number(val.substring(i, 1)) * (i + 1);
							}
							else {
								varSumx = varSumx + Number(val.substring(i, 1)) * (i - 7);
							}
						}
						
						varY = 11 - (varSumx % 11);
						
						if (varY > 9) {
							varY = varY - 10;
						}
						
						varY = varY + 2;
						
						if (varY > 9) {
							varY = varY - 10;
						}
						
						if (varY.toString.substring(0, 1) == val.substring(12, 1)) {
							return true;
						}
						else {
							alert("잘못된 외국인등록번호입니다. 다시 확인해 주십시오");
							return false;
						}
					}
				}
				
				function fn_GridToForm(iv_Row) {

					childBody.datagrid1.row = iv_Row;
					childBody.datagrid1.col = 1;

					model.setValue("/root/resData/resform/slip_arow_no", String(childBody.datagrid1.row).GetZeroString(6));

					// 46.접대비신청여부
					if (childBody.datagrid1.valueMatrix(iv_Row, 46) == "1") {
						model.setValue("/root/resData/resform/rece_exp_aplc_yn", "1"); 
					}
					else {
						model.setValue("/root/resData/resform/rece_exp_aplc_yn", "");
					}
					
					model.setValue("/root/resData/resform/budg_cd", childBody.datagrid1.valueMatrix(iv_Row, 1));  		// 1.예산코드
					model.setValue("/root/reqData/search/budg_cd", model.getValue("/root/resData/resform/budg_cd")); 	// 검색조건에 셋팅
					
					if (model.getValue("/root/reqData/search/budg_cd") == "" && parentWindow.expn_clsf.value == "2") {
						model.setValue("/root/resData/resform/budg_cd", "160600");
						dlco_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						dlco_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
					}
					
					model.setValue("/root/resData/resform/budg_cd_nm", childBody.datagrid1.valueMatrix(iv_Row, 2));		// 2.예산코드명 
					model.setValue("/root/resData/resform/suply_amt", childBody.datagrid1.valueMatrix(iv_Row, 4));          	// 4.과표 
					model.setValue("/root/resData/resform/use_dept_cd", childBody.datagrid1.valueMatrix(iv_Row, 3));        	// 3.사용부서코드
					model.setValue("/root/resData/resform/use_dept_cd_nm", childBody.datagrid1.valueMatrix(iv_Row, 29)); 	// 29.부서명 
					model.setValue("/root/resData/resform/vat_amt", childBody.datagrid1.valueMatrix(iv_Row, 5));               	// 5.세액
					model.setValue("/root/resData/resform/dlco_clsf_cd", childBody.datagrid1.valueMatrix(iv_Row, 7));      	// 7.거래처구분 
					
//					if (childBody.datagrid1.valueMatrix(iv_Row, 7) != "") {
						model.setValue("/root/resData/resform/dlco_cd", childBody.datagrid1.valueMatrix(iv_Row, 8));              // 8.거래처코드 
						model.setValue("/root/resData/resform/dlco_nm", childBody.datagrid1.valueMatrix(iv_Row, 9));              // 9.거래처명 
						model.setValue("/root/resData/resform/intg_dlco_cd", childBody.datagrid1.valueMatrix(iv_Row, 37));         // 37.통합거래처 
//					}
					
					model.setValue("/root/resData/resform/boks_dlco_nm", childBody.datagrid1.valueMatrix(iv_Row, 10));           // 10.부거래처명 
					model.setValue("/root/resData/resform/prop_equip_cd", childBody.datagrid1.valueMatrix(iv_Row, 38));          // 38.영수증구분 					
					model.setValue("/root/resData/resform/prop_equip_cd_nm", childBody.datagrid1.valueMatrix(iv_Row, 75));          // 75.영수증구분명 					
					model.setValue("/root/resData/resform/mang_clsf_cd", childBody.datagrid1.valueMatrix(iv_Row, 11));           // 11.관리구분 
					model.setValue("/root/resData/resform/mang_no", childBody.datagrid1.valueMatrix(iv_Row, 12));                // 12.관리번호 
					model.setValue("/root/resData/resform/incm_clsf_cd", childBody.datagrid1.valueMatrix(iv_Row, 13));           // 13.소득구분 
					model.setValue("/root/resData/resform/with_tax", childBody.datagrid1.valueMatrix(iv_Row, 14));               // 14.원천정수 
					model.setValue("/root/resData/resform/incm_tax", childBody.datagrid1.valueMatrix(iv_Row, 15));               // 15.소득세 
					model.setValue("/root/resData/resform/res_tax", childBody.datagrid1.valueMatrix(iv_Row, 16));                // 16.주민세 

					if (childBody.datagrid1.valueMatrix(iv_Row, 18) == "" && parentWindow.expn_clsf.value == "3") {
						if (childBody.datagrid1.valueMatrix(iv_Row, 1) == "") {
							model.setValue("/root/resData/resform/setoff_slip_no", parentWindow.adpay_expn_no.value);   // 18.선급지출번호
						}
						else {
							model.setValue("/root/resData/resform/setoff_slip_no", childBody.datagrid1.valueMatrix(iv_Row, 18));   // 18.선급지출번호
						}
					}
					else {
						model.setValue("/root/resData/resform/setoff_slip_no", childBody.datagrid1.valueMatrix(iv_Row, 18));         // 18.선급지출번호
					}
					
					model.setValue("/root/resData/resform/complete_flag", childBody.datagrid1.valueMatrix(iv_Row, 31));           // 31.완료여부
					model.setValue("/root/resData/resform/bank_clsf", childBody.datagrid1.valueMatrix(iv_Row, 41));               // 41.은행구분
					model.setValue("/root/resData/resform/acct_cd", childBody.datagrid1.valueMatrix(iv_Row, 42));                 // 42.계좌번호 			
					model.setValue("/root/resData/resform/peps_pers_nm", childBody.datagrid1.valueMatrix(iv_Row, 43));            // 43.예금주명	
				
											
					//model.setValue("/root/resData/resform/medi_cd", childBody.datagrid1.valueMatrix(iv_Row, 19));                 // 19.매체코드 
					//model.setValue("/root/resData/resform/medi_cd_nm", childBody.datagrid1.valueMatrix(iv_Row, 30));              // 30.매체명 
					//model.setValue("/root/resData/resform/dtls_medi_cd", childBody.datagrid1.valueMatrix(iv_Row, 20));            // 20.상세매체코드 	
					
					if(childBody.datagrid1.valueMatrix(iv_Row, 19) == "" ){
						model.setValue("/root/resData/resform/medi_cd", parentWindow.medi_cd.value); //2012.01.13
						model.setValue("/root/resData/resform/medi_cd_nm", parentWindow.medi_cd_nm.value); //2012.01.13
					}else{
						model.setValue("/root/resData/resform/medi_cd", childBody.datagrid1.valueMatrix(iv_Row, 19));                 // 19.매체코드 
						model.setValue("/root/resData/resform/medi_cd_nm", childBody.datagrid1.valueMatrix(iv_Row, 30));              // 30.매체명 
					}
					
					if(childBody.datagrid1.valueMatrix(iv_Row, 20) == "" ){
						model.setValue("/root/resData/resform/dtls_medi_cd", parentWindow.dtls_medi_cd.value); //2012.01.13
						model.setValue("/root/resData/resform/dtls_medi_cd_nm", parentWindow.dtls_medi_cd_nm.value); //2012.01.13
					}else{
						model.setValue("/root/resData/resform/dtls_medi_cd", childBody.datagrid1.valueMatrix(iv_Row, 20));            // 20.상세매체코드
						model.setValue("/root/resData/resform/dtls_medi_cd_nm", childBody.datagrid1.valueMatrix(iv_Row, 78));            // 78상세매체명
					}
					
					
					
					
					
														
					model.setValue("/root/resData/resform/comp_dt", childBody.datagrid1.valueMatrix(iv_Row, 21));                 // 21.기산일 
					model.setValue("/root/resData/resform/mtry_dt", childBody.datagrid1.valueMatrix(iv_Row, 22));                 // 22.만기일 
					model.setValue("/root/resData/resform/unit", childBody.datagrid1.valueMatrix(iv_Row, 23));                    // 23.단위 
					model.setValue("/root/resData/resform/qunt", childBody.datagrid1.valueMatrix(iv_Row, 24));                    // 24.수량 
					model.setValue("/root/resData/resform/rmks2", childBody.datagrid1.valueMatrix(iv_Row, 6));                   // 6.적요2 

					if (childBody.datagrid1.valueMatrix(iv_Row, 1) == "") {
						model.setValue("/root/resData/resform/draft_doc_no", parentWindow.draft_doc_no.value);            // 47.기안문서번호
						model.setValue("/root/resData/resform/draft_expn_amt", parentWindow.draft_expn_amt.value);          // 48.기안지출금액

						if ( parentWindow.draft_expn_amt.attribute("editable") == "false"){
							draft_expn_amt.attribute("editable") = "false";
							control_unmark_req1(draft_expn_amt);						
						}
						else{							
							draft_expn_amt.attribute("editable") = "true";
							control_unmark_req(draft_expn_amt);													
						}
					}
					else {
						model.setValue("/root/resData/resform/draft_doc_no", childBody.datagrid1.valueMatrix(iv_Row, 47));            // 47.기안문서번호
						model.setValue("/root/resData/resform/draft_expn_amt", childBody.datagrid1.valueMatrix(iv_Row, 48));          // 48.기안지출금액

						if ( parentWindow.draft_expn_amt.attribute("editable") == "false"){
							draft_expn_amt.attribute("editable") = "false";
							control_unmark_req1(draft_expn_amt);						
						}
						else{							
							draft_expn_amt.attribute("editable") = "true";
							control_unmark_req(draft_expn_amt);													
						}						
					}
					
					model.setValue("/root/resData/resform/prof_type_cd",        childBody.datagrid1.valueMatrix(iv_Row, 25).substring(0, 2)   );    // 25.세금계산서번호 
					model.setValue("/root/resData/resform/occr_slip_clsf_cd",   childBody.datagrid1.valueMatrix(iv_Row, 25).substring(2, 4)   );    // 25.세금계산서번호 
					model.setValue("/root/resData/resform/occr_slip_occr_dt",   childBody.datagrid1.valueMatrix(iv_Row, 25).substring(4, 12)  );    // 25.세금계산서번호 
					model.setValue("/root/resData/resform/occr_slip_seq",       childBody.datagrid1.valueMatrix(iv_Row, 25).substring(12, 20) );    // 25.세금계산서번호 
					model.setValue("/root/resData/resform/erplace_cd",          childBody.datagrid1.valueMatrix(iv_Row, 27)                   );    // 27.사업장코드 
					model.setValue("/root/resData/resform/make_dt",             childBody.datagrid1.valueMatrix(iv_Row, 26)                   );    // 26.작성일자 
					model.setValue("/root/resData/resform/etc_in",              childBody.datagrid1.valueMatrix(iv_Row, 17)                   );    // 17.잡수익
					model.setValue("/root/resData/resform/ern",                 childBody.datagrid1.valueMatrix(iv_Row, 28)                   );    // 28.공급자번호 
					model.setValue("/root/resData/resform/purc_amt",            childBody.datagrid1.valueMatrix(iv_Row, 32)                   );    // 32.매입금액 
					model.setValue("/root/resData/resform/corp_tax_amt",        childBody.datagrid1.valueMatrix(iv_Row, 39)                   );    // 39.법인세
					model.setValue("/root/resData/resform/issu_dt",             childBody.datagrid1.valueMatrix(iv_Row, 40)                   );    // 40.매입일 
					model.setValue("/root/resData/resform/int_rate",            childBody.datagrid1.valueMatrix(iv_Row, 33)                   );    // 33.약정이율 
					model.setValue("/root/resData/resform/pay_bank_cd",         childBody.datagrid1.valueMatrix(iv_Row, 34)                   );    // 34.지급은행코드 
					model.setValue("/root/resData/resform/pay_bank_cd_nm",      childBody.datagrid1.valueMatrix(iv_Row, 36)                   );    // 36.지급은행명 
					model.setValue("/root/resData/resform/insr_nm",             childBody.datagrid1.valueMatrix(iv_Row, 35)                   );    // 35.보험명 
					model.setValue("/root/resData/resform/occr_slip_clsf",      childBody.datagrid1.valueMatrix(iv_Row, 44)                   );    // 44.구분
					model.setValue("/root/resData/resform/occr_slip",           childBody.datagrid1.valueMatrix(iv_Row, 45)                   );    // 45.전사전표번호
					
					// 기안문서부서
					if (childBody.datagrid1.valueMatrix(iv_Row, 68).Trim() == "") {
						model.setValue("/root/resData/resform/draft_dept_cd", model.getValue("/root/reqData/fwdData/draft_dept_cd"));
					}
					else {
						model.setValue("/root/resData/resform/draft_dept_cd", childBody.datagrid1.valueMatrix(iv_Row, 68));
					}
					
					//===================세무로정보=====================================
					model.setValue("/root/resData/resform/semu_cmpy_cd", childBody.datagrid1.valueMatrix(iv_Row, 69));
					model.setValue("/root/resData/resform/semu_occr_dt", childBody.datagrid1.valueMatrix(iv_Row, 70));
					model.setValue("/root/resData/resform/semu_seq", childBody.datagrid1.valueMatrix(iv_Row, 71));
					model.setValue("/root/resData/resform/semu_semuro_no", childBody.datagrid1.valueMatrix(iv_Row, 72));
					model.setValue("/root/resData/resform/semu_send_pers_email", childBody.datagrid1.valueMatrix(iv_Row, 73));
					/*
					if (model.getValue("/root/resData/resform/semu_semuro_no") != "") {
						semuro_yn.value = "Y";
					}
					*/
					//==================================================================
					elec_tax_no1.value = "";
					elec_tax_no2.value = "";
					elec_tax_no3.value = "";
							
					// 세무로 셋팅
					if(prof_type_cd.value != ""){
						if (model.getValue("/root/resData/resform/semu_semuro_no") != "") {
							if(model.getValue("/root/resData/resform/semu_semuro_no").length == 24){
								semuro_yn.value = "N";
								semuro_yn.disabled = true;							
								elec_tax_no1.value = model.getValue("/root/resData/resform/semu_semuro_no").substring(0, 8);
								elec_tax_no2.value = model.getValue("/root/resData/resform/semu_semuro_no").substring(8, 16);
								elec_tax_no3.value = model.getValue("/root/resData/resform/semu_semuro_no").substring(16, 24);
							}else{
								semuro_yn.value = "Y";
								semuro_yn.disabled = false;							
							}
							paper_yn.value = "";
						}
						else {
							semuro_yn.value = "N";
							semuro_yn.disabled = true;
							paper_yn.value = "Y";
							elec_tax_no1.disabled = true;
							elec_tax_no2.disabled = true;	
							elec_tax_no3.disabled = true;							
						}
					}else{
							semuro_yn.value = "N";
							semuro_yn.disabled = true;
							paper_yn.value = "N";
							elec_tax_no1.disabled = false;
							elec_tax_no2.disabled = false;	
							elec_tax_no3.disabled = false;													
					}					
					
					if (childBody.datagrid1.valueMatrix(iv_Row, 1) == "") {
						model.setValue("/root/resData/resform/recp_pers_clsf",         parentWindow.recp_pers_clsf.value);                  // 49.수령자구분
						model.setValue("/root/resData/resform/recp_pers",               parentWindow.recp_pers.value);    	 	         // 76.수령자코드1
						model.setValue("/root/resData/resform/recp_pers_nm",         parentWindow.recp_pers_nm.value);                    // 77.수령자1
					}
					else {
						model.setValue("/root/resData/resform/recp_pers_clsf",         childBody.datagrid1.valueMatrix(iv_Row, 49));		// 49.수령자구분
						model.setValue("/root/resData/resform/recp_pers",                childBody.datagrid1.valueMatrix(iv_Row, 76));		// 76.수령자코드1
						model.setValue("/root/resData/resform/recp_pers_nm",          childBody.datagrid1.valueMatrix(iv_Row, 77));		// 77.수령자1
					}
					
					model.refresh();

//					childBody.datagrid1.row = iv_Row;
//					childBody.datagrid1.col = 1;
//
//					srchslip_arow_no.value = String(childBody.datagrid1.row).GetZeroString(6);
//
//					if (childBody.datagrid1.valueMatrix(iv_Row, 46) == "1") { // 46.접대비신청여부
//						rece_exp_aplc_yn.value = "1";
//					}
//					else {
//						rece_exp_aplc_yn.value = "";
//					}
//					
//					budg_cd.value = childBody.datagrid1.valueMatrix(iv_Row, 1);  // 1.예산코드
//
//					model.setValue("/root/reqData/search/budg_cd", budg_cd.value); // 검색조건에 셋팅
//					
//					
//					if (model.getValue("/root/reqData/search/budg_cd") == "" && 
//					    parentWindow.expn_clsf.value == "2") {
//						budg_cd.value = "160600";
//						dlco_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
//						dlco_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
//					}
//					
//					budg_cd_nm.value = childBody.datagrid1.valueMatrix(iv_Row, 2); // 2.예산코드명 
//					
//					suply_amt.value = childBody.datagrid1.valueMatrix(iv_Row, 4);              // 4.과표 
//					use_dept_cd.value = childBody.datagrid1.valueMatrix(iv_Row, 3);            // 3.사용부서코드
//					use_dept_cd_nm.value = childBody.datagrid1.valueMatrix(iv_Row, 29);         // 29.부서명 
//					vat_amt.value = childBody.datagrid1.valueMatrix(iv_Row, 5);                // 5.세액
//					dlco_clsf_cd.value = childBody.datagrid1.valueMatrix(iv_Row, 7);           // 7.거래처구분 
//					if (childBody.datagrid1.valueMatrix(iv_Row, 7) != "") {
//						dlco_cd.value = childBody.datagrid1.valueMatrix(iv_Row, 8);              // 8.거래처코드 
//						dlco_nm.value = childBody.datagrid1.valueMatrix(iv_Row, 9);              // 9.거래처명 
//						intg_dlco_cd.value = childBody.datagrid1.valueMatrix(iv_Row, 37);         // 37.통합거래처 
//					}
//					boks_dlco_nm.value = childBody.datagrid1.valueMatrix(iv_Row, 10);           // 10.부거래처명 
//					prop_equip_cd.value = childBody.datagrid1.valueMatrix(iv_Row, 38);          // 38.영수증구분 					
//					prop_equip_cd_nm.value = childBody.datagrid1.valueMatrix(iv_Row, 75);          // 75.영수증구분명 					
//					
//					mang_clsf_cd.value = childBody.datagrid1.valueMatrix(iv_Row, 11);           // 11.관리구분 
//					mang_no.value = childBody.datagrid1.valueMatrix(iv_Row, 12);                // 12.관리번호 
//					incm_clsf_cd.value = childBody.datagrid1.valueMatrix(iv_Row, 13);           // 13.소득구분 
//					with_tax.value = childBody.datagrid1.valueMatrix(iv_Row, 14);               // 14.원천정수 
//					incm_tax.value = childBody.datagrid1.valueMatrix(iv_Row, 15);               // 15.소득세 
//					res_tax.value = childBody.datagrid1.valueMatrix(iv_Row, 16);                // 16.주민세 
//					setoff_slip_no.value = childBody.datagrid1.valueMatrix(iv_Row, 18);         // 18.선급지출번호
//					
//					if (childBody.datagrid1.valueMatrix(iv_Row, 18) == "" && parentWindow.expn_clsf.value == "3") {
//						if (childBody.datagrid1.valueMatrix(iv_Row, 1) == "") {
//							setoff_slip_no.value = parentWindow.adpay_expn_no.value;   // 18.선급지출번호
//						}
//						else {
//							setoff_slip_no.value = childBody.datagrid1.valueMatrix(iv_Row, 18);   // 18.선급지출번호
//						}
//					}
//					
//					complete_flag.value = childBody.datagrid1.valueMatrix(iv_Row, 31);           // 31.완료여부
//					bank_clsf.value = childBody.datagrid1.valueMatrix(iv_Row, 41);               // 41.은행구분
//					acct_cd.value = childBody.datagrid1.valueMatrix(iv_Row, 42);                 // 42.계좌번호 			
//					peps_pers_nm.value = childBody.datagrid1.valueMatrix(iv_Row, 43);            // 43.예금주명							
//					medi_cd.value = childBody.datagrid1.valueMatrix(iv_Row, 19);                 // 19.매체코드 
//					medi_cd_nm.value = childBody.datagrid1.valueMatrix(iv_Row, 30);              // 30.매체명 
//					dtls_medi_cd.value = childBody.datagrid1.valueMatrix(iv_Row, 20);            // 20.상세매체코드 										
//					comp_dt.value = childBody.datagrid1.valueMatrix(iv_Row, 21);                 // 21.기산일 
//					mtry_dt.value = childBody.datagrid1.valueMatrix(iv_Row, 22);                 // 22.만기일 
//					unit.value = childBody.datagrid1.valueMatrix(iv_Row, 23);                    // 23.단위 
//					qunt.value = childBody.datagrid1.valueMatrix(iv_Row, 24);                    // 24.수량 
//					rmks2.value = childBody.datagrid1.valueMatrix(iv_Row, 6);                   // 6.적요2 
//
//					if (childBody.datagrid1.valueMatrix(iv_Row, 1) == "") {
//						draft_doc_no.value = parentWindow.draft_doc_no.value;            // 47.기안문서번호
//						draft_expn_amt.value = parentWindow.draft_expn_amt.value;          // 48.기안지출금액
//						
//						
//						if ( parentWindow.draft_expn_amt.attribute("editable") == "false"){
//							draft_expn_amt.attribute("editable") = "false";
//							control_unmark_req1(draft_expn_amt);						
//						}
//						else{							
//							draft_expn_amt.attribute("editable") = "true";
//							control_unmark_req(draft_expn_amt);													
//						}
//					}
//					else {
//						draft_doc_no.value = childBody.datagrid1.valueMatrix(iv_Row, 47);            // 47.기안문서번호
//						draft_expn_amt.value = childBody.datagrid1.valueMatrix(iv_Row, 48);          // 48.기안지출금액
//
//						if ( parentWindow.draft_expn_amt.attribute("editable") == "false"){
//							draft_expn_amt.attribute("editable") = "false";
//							control_unmark_req1(draft_expn_amt);						
//						}
//						else{							
//							draft_expn_amt.attribute("editable") = "true";
//							control_unmark_req(draft_expn_amt);													
//						}						
//					}
//					
//					prof_type_cd.value = childBody.datagrid1.valueMatrix(iv_Row, 25).substring(0, 2); 					// 25.세금계산서번호 
//					occr_slip_clsf_cd.value = childBody.datagrid1.valueMatrix(iv_Row, 25).substring(2, 4); 			// 25.세금계산서번호 
//					occr_slip_occr_dt.value = childBody.datagrid1.valueMatrix(iv_Row, 25).substring(4, 12); 		// 25.세금계산서번호 
//					occr_slip_seq.value = childBody.datagrid1.valueMatrix(iv_Row, 25).substring(12, 20); 				// 25.세금계산서번호 
//					
//					erplace_cd.value = childBody.datagrid1.valueMatrix(iv_Row, 27);              // 27.사업장코드 
//					make_dt.value = childBody.datagrid1.valueMatrix(iv_Row, 26);                 // 26.작성일자 
//					etc_in.value = childBody.datagrid1.valueMatrix(iv_Row, 17);                  // 17.잡수익
//					ern.value = childBody.datagrid1.valueMatrix(iv_Row, 28);                     // 28.공급자번호 
//					purc_amt.value = childBody.datagrid1.valueMatrix(iv_Row, 32);                // 32.매입금액 
//					corp_tax_amt.value = childBody.datagrid1.valueMatrix(iv_Row, 39);            // 39.법인세
//					issu_dt.value = childBody.datagrid1.valueMatrix(iv_Row, 40);                 // 40.매입일 
//					int_rate.value = childBody.datagrid1.valueMatrix(iv_Row, 33);                // 33.약정이율 
//					pay_bank_cd.value = childBody.datagrid1.valueMatrix(iv_Row, 34);             // 34.지급은행코드 
//					pay_bank_cd_nm.value = childBody.datagrid1.valueMatrix(iv_Row, 36);          // 36.지급은행명 
//					insr_nm.value = childBody.datagrid1.valueMatrix(iv_Row, 35);                 // 35.보험명 
//					occr_slip_clsf.value = childBody.datagrid1.valueMatrix(iv_Row, 44);          // 44.구분
//					occr_slip.value = childBody.datagrid1.valueMatrix(iv_Row, 45);               // 45.전사전표번호
//					
//					// 기안문서부서
//					if (childBody.datagrid1.valueMatrix(iv_Row, 68).Trim() == "") {
//						model.setValue("/root/resData/resform/draft_dept_cd", model.getValue("/root/reqData/fwdData/draft_dept_cd"));
//					}
//					else {
//						model.setValue("/root/resData/resform/draft_dept_cd", childBody.datagrid1.valueMatrix(iv_Row, 68));
//					}
//					
//					//===================세무로정보=====================================
//					model.setValue("/root/resData/resform/semu_cmpy_cd", childBody.datagrid1.valueMatrix(iv_Row, 69));
//					model.setValue("/root/resData/resform/semu_occr_dt", childBody.datagrid1.valueMatrix(iv_Row, 70));
//					model.setValue("/root/resData/resform/semu_seq", childBody.datagrid1.valueMatrix(iv_Row, 71));
//					model.setValue("/root/resData/resform/semu_semuro_no", childBody.datagrid1.valueMatrix(iv_Row, 72));
//					model.setValue("/root/resData/resform/semu_send_pers_email", childBody.datagrid1.valueMatrix(iv_Row, 73));
//					
//					if (model.getValue("/root/resData/resform/semu_semuro_no") != "") {
//						semuro_yn.value = "Y";
//					}
//					//==================================================================
//					
//					if (childBody.datagrid1.valueMatrix(iv_Row, 1) == "") {
//						recp_pers_clsf.value = parentWindow.recp_pers_clsf.value;     // 49.수령자구분
//						recp_pers.value = parentWindow.recp_pers.value;    	 	     // 76.수령자코드1
//						recp_pers_nm.value =  parentWindow.recp_pers_nm.value;    // 77.수령자1
//					}
//					else {
//						recp_pers_clsf.value = childBody.datagrid1.valueMatrix(iv_Row, 49);          // 49.수령자구분
//						recp_pers.value = childBody.datagrid1.valueMatrix(iv_Row, 76);          	 // 76.수령자코드1
//						recp_pers_nm.value = childBody.datagrid1.valueMatrix(iv_Row, 77);          // 77.수령자1
//					}
				}
				
			function open_fc_acct_1180(p_where,p_mode) {
				var need_popup = true;
				var rcvs_flag = false;

				//버튼클릭으로 이벤트가 발생하기 전에
				//value-changed 이벤트가 먼저 발생한 경우
				//input button의 내부 버튼이 클릭됐는지 여부를 확인한다.
				if (check_dup_input_event()) {					
					return rcvs_flag;
				}
				
				//검색조건이 모두 충족하지 않으면 종료한다.
				if (gstr_popupid == "dlco_cd") { 		// 거래처
					if (p_where == "FOCUS" && (dlco_clsf_cd.value.Trim() == "" || dlco_cd.value.Trim() == "")) {
						dlco_nm.value	= "";
						return rcvs_flag;
					}
				}
				else if (gstr_popupid == "recp_pers") { // 수령자
					if (p_where == "FOCUS" && (recp_pers_clsf.value.Trim() == "" || recp_pers.value.Trim() == "")) {
						dlco_nm.value	= "";
						return rcvs_flag;
					}
				}
				else if (gstr_popupid == "pay_bank_cd") { // 지급은행
					if (p_where == "FOCUS" && (pay_bank_cd.value.Trim() == "")) {
						dlco_nm.value	= "";
						return rcvs_flag;
					}				
				}
				else if (gstr_popupid == "ern") { // 공급자번호
					if (p_where == "FOCUS" && (ern.value.Trim() == "")) {
						return rcvs_flag;
					}				
				}
				else if (gstr_popupid == "dtls_medi_cd") { // 공급자번호
					if (p_where == "FOCUS" && (dtls_medi_cd.value.Trim() == "")) {
						return rcvs_flag;
					}				
				}
				
				p_where = p_where.toUpperCase();
				
				var popid = "fc_acct_1180";
				var subid = "fc_acct_1181_l";

				set_popup_send_data(popid  ,"mode"	  ,p_mode);
				set_popup_send_data(popid  ,"title"   ,""    );
//				set_popup_send_data(popid  ,"readonly"  ,"1"    );

				if (gstr_popupid == "dlco_cd") { 		// 거래처
					set_popup_send_data(popid		,"clsf_cd"		,dlco_clsf_cd.value	);
					set_popup_send_data(popid		,"cd_f"			,dlco_cd.value		);
					set_popup_send_data(popid		,"cd_t"			,dlco_cd.value		);
//					set_popup_send_data(popid		,"cd_abrv_nm"		,dlco_cd.value		);
				}
				else if (gstr_popupid == "recp_pers") { // 수령자
					set_popup_send_data(popid		,"clsf_cd"		,recp_pers_clsf.value	);
					set_popup_send_data(popid		,"cd_f"			,recp_pers.value		);
					set_popup_send_data(popid		,"cd_t"			,recp_pers.value		);
//					set_popup_send_data(popid		,"cd_abrv_nm"		,recp_pers.value		);
				}
				else if (gstr_popupid == "pay_bank_cd") { // 지급은행
					set_popup_send_data(popid		,"clsf_cd"		,"95"	);
					set_popup_send_data(popid		,"cd_f"			,pay_bank_cd.value		);
					set_popup_send_data(popid		,"cd_t"			,pay_bank_cd.value		);
//					set_popup_send_data(popid		,"cd_abrv_nm"		,pay_bank_cd.value		);
				}
				else if (gstr_popupid == "ern") { // 공급자번호
					set_popup_send_data(popid		,"clsf_cd"			,"93"	);
					set_popup_send_data(popid		,"cd_f"			,ern.value		);
					set_popup_send_data(popid		,"cd_t"			,ern.value		);
//					set_popup_send_data(popid		,"cd_abrv_nm"		,ern.value		);
				}
				else if (gstr_popupid == "dtls_medi_cd") { // 공급자번호
					set_popup_send_data(popid		,"clsf_cd"			,"91"	);
					set_popup_send_data(popid		,"cd_f"			,dtls_medi_cd.value		);
					set_popup_send_data(popid		,"cd_t"			,dtls_medi_cd.value		);
//					set_popup_send_data(popid		,"cd_abrv_nm"		,ern.value		);
				}
				


				//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
				if (p_where == "FOCUS") {
					//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
					//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
					model.removenode(get_popup_rcvs_ref(popid));
					//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
					model.makeNode(get_popup_rcvs_ref(popid));
					
//					alert(get_popup_send_ref(popid));
					
					//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
					send_submission(
							"auto_" + subid
						,	get_popup_send_ref(popid)
						,	get_popup_rcvs_ref(subid) + "/dataSet"
						,	"/fc/acct1000/1181"
						,	"urlencoded-post"
						,	"application/x-www-form-urlencoded"
					);
					
					totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
			
//					alert(totalcnt);
			
					if (totalcnt == 1) {
						//데이터가 1건이고 focus out에서 호출한 경우
						//데이터를 설정하고 나간다.

//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
						model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
//						return;
						need_popup = false;
						rcvs_flag  = false;
					}
					else if (totalcnt == 0) {
//						show_message("[거래처코드]의 검색결과가 없습니다.");
//						return;
						need_popup = true;		
						 rcvs_flag = false;				
					}
					else {
						//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
						//만약 1건 이상인 경우 popup을 호출해 달라고 하면
						//return을 지우면 됨
						//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
						//return;
						need_popup = true;
					}
				}
				
				//그외 버튼인 경우는 계속 진행
				if (need_popup) {
					 rcvs_flag = open_popup(popid,"640");
				}

				//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
				//다시 조회 하기 쉽도록 하고
				if (gstr_popupid == "dlco_cd") { 		// 거래처
					if (get_popup_rcvs_data(popid,"clsf_cd") != "")			dlco_clsf_cd.value		=	get_popup_rcvs_data(popid,"clsf_cd");
					if (get_popup_rcvs_data(popid,"cd") != "")				dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
					//그외의 값은 지워지도록 한다.
					//if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					intg_dlco_cd.value		=	get_popup_rcvs_data(popid,"intg_cd");
				}
				else if (gstr_popupid == "recp_pers") { // 수령자
					if (get_popup_rcvs_data(popid,"clsf_cd") != "")			recp_pers_clsf.value		=	get_popup_rcvs_data(popid,"clsf_cd");
					if (get_popup_rcvs_data(popid,"cd") != "")				recp_pers.value		=	get_popup_rcvs_data(popid,"cd");
					//그외의 값은 지워지도록 한다.
					//if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					recp_pers_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
				}
				else if (gstr_popupid == "pay_bank_cd") { // 지급은행
//					if (get_popup_rcvs_data(popid,"clsf_cd") != "")			recp_pers_clsf.value		=	get_popup_rcvs_data(popid,"clsf_cd");
					if (get_popup_rcvs_data(popid,"cd") != "")				pay_bank_cd.value		=	get_popup_rcvs_data(popid,"cd");
					//그외의 값은 지워지도록 한다.
					//if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					pay_bank_cd_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
				}
				else if (gstr_popupid == "dtls_medi_cd") { // 지급은행
//					if (get_popup_rcvs_data(popid,"clsf_cd") != "")			recp_pers_clsf.value		=	get_popup_rcvs_data(popid,"clsf_cd");
					if (get_popup_rcvs_data(popid,"cd") != "")				dtls_medi_cd.value		=	get_popup_rcvs_data(popid,"cd");
					//그외의 값은 지워지도록 한다.
					//if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					dtls_medi_cd_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
				}
				else if (gstr_popupid == "ern") { // 공급자번호
//					if (get_popp_rcvs_data(popid,"clsf_cd") != "")			recp_pers_clsf.value		=	get_popup_rcvs_data(popid,"clsf_cd");
					var cmpy_cd = model.getValue("/root/initData/session/cmpy_cd");
					

					if ((get_popup_rcvs_data(popid,"cd") == "104-81-24695") && (cmpy_cd == "100")) {
						ern.value = "";
					}					
					else {
						if (get_popup_rcvs_data(popid,"cd") != "")				ern.value		=	get_popup_rcvs_data(popid,"cd");
						if (get_popup_rcvs_data(popid,"cd") == "") {
							boks_dlco_nm.value = "";
						}
						else {
							if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		boks_dlco_nm.value		=	get_popup_rcvs_data(popid,"cd_abrv_nm");
						}
					}
					//그외의 값은 지워지도록 한다.
					//if (get_popup_rcvs_data(popid,"cd_abrv_nm") != "")		dlco_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
					//pay_bank_cd_nm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
				}
				return rcvs_flag;
			}
			
				// yunyun
				var btnclickchk = "";
				function onevent()
				{
					var evCtarg = event.currenttarget;
					var evTarg = event.target;
					if(evCtarg != evTarg) return;
					if(event.name != "DOMFocusOut" && event.name != "onbuttonclick" && event.name != "DOMFocusIn" &&event.name != "xforms-value-changed" && event.name != "onmousedown" && event.name != "onmouseup") return;
					
					var pID = event.pTarget.elementname;
					if (pID != "xforms:button" && pID != "xforms:input") return;
					
					var obj = document.all(evCtarg);
					
					if(obj.elementName == "xforms:input" && (evCtarg == "suply_amt" || evCtarg =="crdt_amt"  || evCtarg == "recp_pers" || evCtarg == "dlco_cd"
						|| evCtarg == "boks_dlco_nm"
						|| evCtarg == "mang_no"
						|| evCtarg == "with_tax"
						|| evCtarg == "setoff_slip_no"
						|| evCtarg == "complete_flag"
						|| evCtarg == "dtls_medi_cd"
						|| evCtarg == "unit"
						|| evCtarg == "qunt"
						|| evCtarg == "rmks2"
						|| evCtarg == "recp_pers"
						|| evCtarg == "draft_doc_no"
						|| evCtarg == "draft_expn_amt"
						|| evCtarg == "occr_slip_seq"
						|| evCtarg == "etc_in"
						|| evCtarg == "ern"
						|| evCtarg == "purc_amt"
						|| evCtarg == "corp_tax_amt"
						|| evCtarg == "int_rate"
						|| evCtarg == "pay_bank_cd"
						|| evCtarg == "insr_nm"
						|| evCtarg == "occr_slip"))
					{
						model.addLog(event.name + " --> " + evCtarg);
						
						//onmousedown -> DOMFocusIn -> onmouseup -> xforms-value-changed -> DOMFocusOut 
						if(event.name == "onmousedown" )
						{
							body.attribute("inputClkChk") = "true";
						}
						if(event.name == "DOMFocusIn" )
						{
							body.attribute("inputClkChk") = "true";
						}
						if(event.name == "xforms-value-changed")
						{
							if( btnclickchk != "" )
							{
								body.attribute("value-changed-chk") = "true";
							}
						}
						if(event.name == "DOMFocusOut")
						{
							if(body.attribute("inputClkChk") == "true")
							{
								if(btnclickchk != "" && body.attribute("value-changed-chk") == "true")
								{
									document.all(btnclickchk).dispatch("onmouseup");
								}
							}
						}
					}
					
					if(obj.elementName == "xforms:button" && (evCtarg =="btn_insert" || evCtarg == "btn_update" || evCtarg == "btn_append"))
					{
						model.addLog(event.name + " --> " + evCtarg);
						
						//onmousedown -> DOMFocusIn -> onmouseup -> DOMFocusOut 
						if(event.name == "onmousedown" )
						{
							btnclickchk = evCtarg;
						}
						if(event.name == "onmouseup" )
						{
							btnclickchk = "";
						}
					}


				}
				
				function open_fc_co_8010(p_where,p_mode,p_title,p_readonly,p_to,p_job_clsf,p_cd_clsf) {
					var need_popup = true;
					var rcvs_flag = false;
					
					//검색조건이 모두 충족하지 않으면 종료한다.
					if (p_where == "FOCUS" && medi_cd.value.Trim() == "") {
						pch_mcnm.value	= "";
						return rcvs_flag;
					}
					
					p_where = p_where.toUpperCase();
					
					var popid = "fc_co_8010";
					var subid = "fc_co_8010_l";
	
					set_popup_send_data(popid		,"mode"			,p_mode			);
					set_popup_send_data(popid		,"title"			,p_title			);
					set_popup_send_data(popid		,"readonly"		,p_readonly		);
					set_popup_send_data(popid		,"job_clsf"			,p_job_clsf		);
					set_popup_send_data(popid		,"cd_clsf"			,p_cd_clsf			);
					set_popup_send_data(popid		,"cd"				,medi_cd.value		);
					set_popup_send_data(popid		,"cd_abrv_nm"		,""				);
					
					model.removenode(get_popup_rcvs_ref(popid));
					model.makeNode(get_popup_rcvs_ref(popid));
					
					//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
					if (p_where == "FOCUS") {
						
						//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
						send_submission(
								"auto_" + subid
							,	get_popup_send_ref(popid)
							,	get_popup_rcvs_ref(subid) + "/dataSet"
							,	"/fc/co8000/8011"
							,	"urlencoded-post"
							,	"application/x-www-form-urlencoded"
						);
						
						totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
				
						if (totalcnt == 1) {
							//데이터가 1건이고 focus out에서 호출한 경우
							//데이터를 설정하고 나간다.
	
	//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
							model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
	//						return;
							need_popup = false;
							rcvs_flag = true;
						}
						else if (totalcnt == 0) {
	//						return;
							need_popup = false;	
							rcvs_flag = false;					
						}
						else {
							//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
							//만약 1건 이상인 경우 popup을 호출해 달라고 하면
							//return을 지우면 됨
							//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
							//return;
							need_popup = true;
						}
					}
					
					//그외 버튼인 경우는 계속 진행
					if (need_popup) {
						rcvs_flag = open_popup(popid,"640");
					}
	
					set_refvalue("/root/tempData/medi_ch", get_popup_rcvs_data(popid,"mang_cd_2"));
					
					reset_popup_send_data(popid);
					
					return rcvs_flag;
				}
				
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="550" pageheight="748" guideline="1,9;2,11;1,873;1,878;1,933;1,936;2,31;2,41;2,41;2,44;1,543;" style="font-family:굴림; ">
		<group id="group1" class="gro_sel" style="left:10px; top:122px; width:533px; height:594px; ">
			<caption id="caption10" class="list_cap02" style="left:148px; top:399px; width:381px; height:26px; text-align:center; "/>
			<select id="paper_yn" ref="/root/tempData/paper_yn" navindex="2" overflow="visible" appearance="full" cellspacing="15" style="left:489px; top:404px; width:17px; height:16px; border-style:none; ">
				<choices>
					<item>
						<label/>
						<value>Y</value>
					</item>
				</choices>
				<!--
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						//debugger;
						//alert("@"+paper_yn.attribute("checked"));
						//alert("@"+model1.getValue("/root/tempData/paper_yn"));
						if (model1.getValue("/root/tempData/paper_yn") == "N") {
							elec_tax_no1.disabled = false;
							elec_tax_no2.disabled = false;	
							elec_tax_no3.disabled = false
							elec_tax_no1.attribute("background-color") = DEFAULT_COLOR_REQ;
							elec_tax_no2.attribute("background-color") = DEFAULT_COLOR_REQ;
							elec_tax_no3.attribute("background-color") = DEFAULT_COLOR_REQ;
						}
						else {
							elec_tax_no1.value = "";
							elec_tax_no2.value = "";
							elec_tax_no3.value = "";
							model.setValue("/root/resData/resform/semu_cmpy_cd", "");
							model.setValue("/root/resData/resform/semu_occr_dt", "");
							model.setValue("/root/resData/resform/semu_seq", "");
							model.setValue("/root/resData/resform/semu_semuro_no", "");
							model.setValue("/root/resData/resform/semu_send_pers_email", "");
							semuro_yn.value = "N";
							semuro_yn.disabled = true;	
							elec_tax_no1.attribute("background-color") = "white";
							elec_tax_no2.attribute("background-color") = "white";
							elec_tax_no3.attribute("background-color") = "white";
							elec_tax_no1.disabled = true;
							elec_tax_no2.disabled = true;	
							elec_tax_no3.disabled = true;							
						}		
					]]>
				</script>
				-->
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
							elec_tax_no1.value = "";
							elec_tax_no2.value = "";
							elec_tax_no3.value = "";
							model.setValue("/root/resData/resform/semu_cmpy_cd", "");
							model.setValue("/root/resData/resform/semu_occr_dt", "");
							model.setValue("/root/resData/resform/semu_seq", "");
							model.setValue("/root/resData/resform/semu_semuro_no", "");
							model.setValue("/root/resData/resform/semu_send_pers_email", "");
							semuro_yn.value = "N";
							semuro_yn.disabled = true;	
							elec_tax_no1.attribute("background-color") = "white";
							elec_tax_no2.attribute("background-color") = "white";
							elec_tax_no3.attribute("background-color") = "white";
							elec_tax_no1.disabled = true;
							elec_tax_no2.disabled = true;	
							elec_tax_no3.disabled = true;
							paper_yn.value = "Y";					
					]]>
				</script>
				<script type="javascript" ev:event="xforms-deselect">
					<![CDATA[
							elec_tax_no1.disabled = false;
							elec_tax_no2.disabled = false;	
							elec_tax_no3.disabled = false
							elec_tax_no1.attribute("background-color") = DEFAULT_COLOR_REQ;
							elec_tax_no2.attribute("background-color") = DEFAULT_COLOR_REQ;
							elec_tax_no3.attribute("background-color") = DEFAULT_COLOR_REQ;
							paper_yn.value = "N";
					]]>
				</script>
			</select>
			<caption id="caption35" class="list_cap02" style="left:89px; top:100px; width:211px; height:26px; text-align:center; "/>
			<select id="tax_dirinput" ref="/root/tempData/tax_dirinput" disabled="true" navindex="2" visibility="visible" overflow="visible" appearance="full" cellspacing="15" cols="2" style="left:205px; top:105px; width:65px; height:14px; border-style:none; ">
				<choices>
					<item>
						<label>직접입력</label>
						<value>1</value>
					</item>
				</choices>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						//debugger;
						if(tax_dirinput.value == "1"){ 
							incm_tax.attribute("editable") = "true";
							//res_tax.attribute("editable") = "true";
							incm_tax.attribute("background-color") = "white";
							//res_tax.attribute("background-color") = "white";
							
							with_tax.value = "0";
							with_tax.attribute("editable") = "false";
							with_tax.attribute("background-color") = DEFAULT_COLOR_DISABLE;
							
						}else{
							incm_tax.value = "0";
							res_tax.value = "0";
							incm_tax.attribute("editable") = "false";
							//res_tax.attribute("editable") = "false";
							incm_tax.attribute("background-color") = DEFAULT_COLOR_DISABLE;
							//res_tax.attribute("background-color") = DEFAULT_COLOR_DISABLE;
							
							with_tax.attribute("editable") = "true";
							with_tax.attribute("background-color") = "white";
						}						
					]]>
				</script>
			</select>
			<caption id="caption3" class="list_cap02" style="left:89px; top:324px; width:440px; height:26px; text-align:center; "/>
			<select id="semuro_yn" ref="/root/resData/resform/rece_exp_aplc_yn" disabled="true" navindex="2" overflow="visible" appearance="full" cellspacing="15" cols="2" style="left:392px; top:329px; width:17px; height:16px; border-style:none; ">
				<choices>
					<item>
						<label/>
						<value>Y</value>
					</item>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if (semuro_yn.value == "Y") {
							semuro_yn.disabled = false;
						}
						else {
							model.setValue("/root/resData/resform/semu_cmpy_cd", "");
							model.setValue("/root/resData/resform/semu_occr_dt", "");
							model.setValue("/root/resData/resform/semu_seq", "");
							model.setValue("/root/resData/resform/semu_semuro_no", "");
							model.setValue("/root/resData/resform/semu_send_pers_email", "");
							semuro_yn.disabled = true;
						}		
					]]>
				</script>
			</select>
			<caption id="caption14" class="list_cap03" style="left:0px; top:0px; width:90px; height:26px; text-align:center; ">거래처</caption>
			<caption id="caption15" class="list_cap02" style="left:89px; top:0px; width:440px; height:26px; text-align:center; "/>
			<caption id="caption16" class="list_cap03" style="left:0px; top:25px; width:90px; height:26px; text-align:center; ">부거래처명</caption>
			<caption id="caption17" class="list_cap02" style="left:89px; top:25px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption20" class="list_cap03" style="left:299px; top:25px; width:90px; height:26px; text-align:center; ">영수증구분</caption>
			<caption id="caption21" class="list_cap02" style="left:388px; top:25px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption22" class="list_cap03" style="left:299px; top:50px; width:90px; height:26px; text-align:center; ">관리번호</caption>
			<caption id="caption23" class="list_cap02" style="left:388px; top:50px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption24" class="list_cap03" style="left:0px; top:50px; width:90px; height:26px; text-align:center; ">관리구분</caption>
			<caption id="caption25" class="list_cap02" style="left:89px; top:50px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption26" class="list_cap03" style="left:299px; top:100px; width:90px; height:26px; text-align:center; ">주민세</caption>
			<caption id="caption27" class="list_cap02" style="left:388px; top:100px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption30" class="list_cap03" style="left:0px; top:125px; width:90px; height:26px; text-align:center; ">선급번호</caption>
			<caption id="caption31" class="list_cap03" style="left:0px; top:75px; width:90px; height:26px; text-align:center; ">소득구분</caption>
			<caption id="caption32" class="list_cap02" style="left:89px; top:125px; width:440px; height:26px; text-align:center; "/>
			<caption id="caption33" class="list_cap02" style="left:89px; top:75px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption34" class="list_cap03" style="left:0px; top:100px; width:90px; height:26px; text-align:center; ">소득세</caption>
			<caption id="caption36" class="list_cap03" style="left:299px; top:75px; width:90px; height:26px; text-align:center; ">원천징수세</caption>
			<caption id="caption37" class="list_cap02" style="left:388px; top:75px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption38" class="list_cap03" style="left:0px; top:349px; width:90px; height:26px; text-align:center; ">사업장코드</caption>
			<caption id="caption39" class="list_cap03" style="left:299px; top:175px; width:90px; height:26px; text-align:center; ">만기일</caption>
			<caption id="caption40" class="list_cap03" style="left:0px; top:225px; width:90px; height:26px; text-align:center; ">적요</caption>
			<caption id="caption41" class="list_cap02" style="left:388px; top:175px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption42" class="list_cap02" style="left:89px; top:349px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption44" class="list_cap02" style="left:89px; top:225px; width:440px; height:26px; text-align:center; "/>
			<caption id="caption46" class="list_cap03" style="left:0px; top:324px; width:90px; height:26px; text-align:center; ">세금계산서</caption>
			<caption id="caption56" class="list_cap03" style="left:0px; top:175px; width:90px; height:26px; text-align:center; ">사용자 사원</caption>
			<caption id="caption51" class="list_cap03" style="left:0px; top:150px; width:90px; height:26px; text-align:center; ">사용자</caption>
			<caption id="caption54" class="list_cap02" style="left:89px; top:150px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption57" class="list_cap03" style="left:299px; top:349px; width:90px; height:26px; text-align:center; ">작성일자</caption>
			<caption id="caption58" class="list_cap02" style="left:89px; top:175px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption59" class="list_cap02" style="left:388px; top:349px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption60" class="list_cap03" style="left:299px; top:150px; width:90px; height:26px; text-align:center; ">기산일</caption>
			<caption id="caption61" class="list_cap02" style="left:388px; top:150px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption62" class="list_cap03" style="left:299px; top:374px; width:90px; height:26px; text-align:center; ">공급자번호</caption>
			<caption id="caption63" class="list_cap02" style="left:388px; top:374px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption64" class="list_cap02" style="left:89px; top:447px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption65" class="list_cap03" style="left:0px; top:374px; width:90px; height:26px; text-align:center; ">잡수익</caption>
			<caption id="caption66" class="list_cap03" style="left:0px; top:471px; width:90px; height:26px; text-align:center; ">매입일</caption>
			<caption id="caption67" class="list_cap02" style="left:388px; top:448px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption70" class="list_cap02" style="left:89px; top:546px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption71" class="list_cap02" style="left:89px; top:374px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption72" class="list_cap03" style="left:299px; top:447px; width:90px; height:26px; text-align:center; ">법인세</caption>
			<caption id="caption73" class="list_cap02" style="left:299px; top:522px; width:230px; height:50px; text-align:center; "/>
			<caption id="caption74" class="list_cap02" style="left:89px; top:472px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption76" class="list_cap02" style="left:388px; top:448px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption78" class="list_cap03" style="left:0px; top:496px; width:90px; height:26px; text-align:center; ">지급은행</caption>
			<caption id="caption80" class="list_cap02" style="left:89px; top:497px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption82" class="list_cap03" style="left:0px; top:446px; width:90px; height:26px; text-align:center; ">매입금액</caption>
			<caption id="caption83" class="list_cap03" style="left:299px; top:472px; width:90px; height:26px; text-align:center; ">약정이율</caption>
			<caption id="caption84" class="list_cap03" style="left:0px; top:545px; width:90px; height:26px; text-align:center; ">보험명</caption>
			<caption id="subtitle" class="tit02" style="left:5px; top:305px; width:524px; height:20px; ">세금계산서</caption>
			<caption id="caption8" class="tit02" style="left:5px; top:428px; width:524px; height:20px; ">유가증권</caption>
			<caption id="caption9" class="tit02" style="left:5px; top:525px; width:290px; height:20px; ">보험료</caption>
			<select1 id="dlco_clsf_cd" ref="/root/resData/resform/dlco_clsf_cd" navindex="7" appearance="minimal" editmode="inputsearch" style="left:95px; top:4px; width:90px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_DLCO_CLSF_LIST/record">
						<label ref="cd_abrv_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(dlco_clsf_cd, dlco_clsf_cd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(dlco_clsf_cd,"");
						return;
					}
					]]>
				</script>
			</select1>
			<input id="dlco_cd" ref="/root/resData/resform/dlco_cd" navindex="8" inputtype="button" style="left:188px; top:4px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						gstr_popupid = "dlco_cd";
						open_fc_acct_1180("button","s");	
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						gstr_popupid = "dlco_cd";
						open_fc_acct_1180("focus","s");		
					]]>
				</script>
			</input>
			<input id="dlco_nm" ref="/root/resData/resform/dlco_nm" editable="false" style="left:291px; top:4px; width:163px; height:18px; "/>
			<input id="intg_dlco_cd" ref="/root/resData/resform/intg_dlco_cd" editable="false" style="left:458px; top:4px; width:65px; height:18px; "/>
			<input id="mang_no" ref="/root/resData/resform/mang_no" navindex="12" inputtype="input" maxlength="15" style="left:393px; top:54px; width:130px; height:18px; "/>
			<input id="with_tax" ref="/root/resData/resform/with_tax" navindex="14" inputtype="input" format="(-)#,###" style="left:393px; top:79px; width:130px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						fnWithTaxSetting();
					]]>
				</script>
			</input>
			<input id="boks_dlco_nm" ref="/root/resData/resform/boks_dlco_nm" navindex="9" inputtype="input" maxlength="30" style="left:95px; top:29px; width:200px; height:18px; "/>
			<select1 id="mang_clsf_cd" ref="/root/resData/resform/mang_clsf_cd" navindex="11" appearance="minimal" editmode="inputsearch" style="left:95px; top:54px; width:200px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/fc_acct_2083_s/dataSet/CUR_MANG_CLSF_CD_LIST/record">
						<label ref="cd_abrv_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(mang_clsf_cd, mang_clsf_cd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(mang_clsf_cd,"");
						return;
					}
					]]>
				</script>
			</select1>
			<select1 id="incm_clsf_cd" ref="/root/resData/resform/incm_clsf_cd" navindex="13" appearance="minimal" editmode="inputsearch" style="left:95px; top:79px; width:200px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_INCM_CLSF_LIST/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(incm_clsf_cd, incm_clsf_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(incm_clsf_cd,"");
							return;
						}
						if (incm_clsf_cd.value == "9011") {
							show_message("일용근로소득은 사용할 수 없습니다.");
							incm_clsf_cd.value = "";
							return;
						}
					
						if (incm_clsf_cd.value == "" || incm_clsf_cd.value == "9001" || incm_clsf_cd.value == "9011" ||
  						    incm_clsf_cd.value == "9003" || incm_clsf_cd.value == "9004" || incm_clsf_cd.value == "90041" ||
  						    incm_clsf_cd.value == "90042" || incm_clsf_cd.value == "9005" || incm_clsf_cd.value == "9010") {
  						    	// 
  						}
  						else {
  							show_message("정확한 데이터를 입력하십시오.");
  							incm_clsf_cd.value = "";
  							model.setFocus("incm_clsf_cd");
//  							return;
  						}

						if ( incm_clsf_cd.value == "9001" || incm_clsf_cd.value == "9005" || incm_clsf_cd.value == "9004" ) {
							//debugger;
							tax_dirinput.disabled = false;
						}else{
							tax_dirinput.disabled = true;
						}
  						// 소득구분에 따른 필수항목 set 하기위해 예산코드 CHANGE 강제 invoke
  						budg_cd.dispatch("xforms-value-changed");
  						
  						// 소득구분을 선택하면 원천징수액을 0으로 만든다(기본 세율로 재계산) 2000.01.10. 백승민
						with_tax.value = "0";
						fnWithTaxSetting();		
					]]>
				</script>
			</select1>
			<select1 id="erplace_cd" ref="/root/resData/resform/erplace_cd" navindex="30" appearance="minimal" editmode="inputsearch" style="left:95px; top:353px; width:130px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_ERPLACE_CD_LIST/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(combo_data_contains(erplace_cd, erplace_cd.value) == -1){
							show_message("정확한 값을 선택해 주세요.");
							set_refvalue(erplace_cd,"");
							return;
						}
/*					
						if (erplace_cd.value == "02" && use_dept_cd.value != "215096" || 
						    erplace_cd.value == "03" && use_dept_cd.value != "215097" || 
						    erplace_cd.value == "04" && use_dept_cd.value != "215098" || 
						    erplace_cd.value == "05" && use_dept_cd.value != "317020" ||
						    ((erplace_cd.value == "01" || erplace_cd.value == "06") &&
						       (use_dept_cd.value == "215096" || 
						        use_dept_cd.value == "215097" || 
						        use_dept_cd.value == "215098" || 
						        use_dept_cd.value == "317020"))) {
  							show_message("[사용부서 혹은 사업장코드 확인요]");
  							return;
						}
						
						if(erplace_cd.value != "01"){
							prof_type_cd.value = "11";
						}
*/						
						var var_vat_amt = 0;
						
						var_vat_amt = Number(vat_amt.value);
/*						
						if (prof_type_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (budg_cd.value == "8950") {
								prof_type_cd.value = "16";
							}
							else {
								if (medi_cd.value == "410" || medi_cd.value == "420" ||
								    medi_cd.value == "710" || parentWindow.clam_dept_cd.value.substring(0, 4) == "48") {
									prof_type_cd.value = "14";
								}
								else {
									if (erplace_cd.value != "01") {
										if (prop_equip_cd.value == "8900" || (medi_cd.value == "810" && budg_cd.value >= "655601" && budg_cd.value <= "655606")) {
											prof_type_cd.value = "11";											
										}
										else {
											prof_type_cd.value = "16";											
										}
									}
									else {
										if (var_vat_amt == 0) {
											prof_type_cd.value = "15";	
										}
										else {
											prof_type_cd.value = "11";	
										}
									}
								}
							}

							if (budg_cd.value == "304301" || budg_cd.value == "304302" ||
							    budg_cd.value == "652101" || budg_cd.value == "652103") {
								prof_type_cd.value = "13";	
							}
							else if (budg_cd.value == "771100" || budg_cd.value == "773300" || budg_cd.value == "829300") {
								prof_type_cd.value = "14";	
							}
	
							// 부가세가없을때는 매입계산서로
							if (budg_cd.value == "829300" && Number(vat_amt.value) == 0) {
								prof_type_cd.value = "16";									
							}
							
							if (budg_cd.value == "771100" && Number(vat_amt.value) == 0) {
								prof_type_cd.value = "16";									
							}
						}
*/						

					]]>
				</script>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
					
					]]>
				</script>
			</select1>
			<input id="incm_tax" ref="/root/resData/resform/incm_tax" editable="false" format="(-)#,###" style="left:95px; top:104px; width:100px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var var_incm_tax;
						var var_res_tax;
						var var_with_tax;
						
						var_incm_tax = 	Number(incm_tax.value);
						var_incm_tax = var_incm_tax / 10;
						var_incm_tax = var_incm_tax.GetRound(-1, -1) * 10; 	// 소득세=과표*0.03, 원단위 버림
						
						incm_tax.value = var_incm_tax; //소득세
						
						var_res_tax = var_incm_tax * 0.1 / 10;
						var_res_tax = var_res_tax.GetRound(-1, -1) * 10;	// 주민세=소득세*0.1, 원단위 버림
						
						res_tax.value = var_res_tax; //주민세
						
						var_with_tax = var_incm_tax + var_res_tax;			// 원천징수=소득세+주민세
						
						with_tax.value = var_with_tax; //원천징수세
					]]>
				</script>
			</input>
			<input id="res_tax" ref="/root/resData/resform/res_tax" editable="false" format="(-)#,###" style="left:393px; top:104px; width:130px; height:18px; text-align:right; "/>
			<input id="setoff_slip_no" ref="/root/resData/resform/setoff_slip_no" navindex="15" inputtype="button" format="99999999-99-999-9-999999" style="left:95px; top:129px; width:150px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					
					if (setoff_slip_no.attribute("editable") == "false") { return; }
					
					model.property("FC_ACCT_2040_srchdept_cd")  = parentWindow.clam_dept_cd.value;
					model.property("FC_ACCT_2040_srchdept_nm") = parentWindow.clam_dept_cd_nm.value;

					viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2040");

					setoff_slip_no.value = model.property("FC_ACCT_2040_slip_no");
					
					model.property("FC_ACCT_2040_slip_no") = "";
					
//					window.load("./FC_ACCT_2040.xrw"
//								, "modal"
//								, ""
//								, "align:center; width:958; height:760; sysmenu:visible; min:visible; max:true; resize:true; caption:visible;")				
						
					]]>
				</script>
			</input>
			<input id="bank_clsf" ref="/root/resData/resform/bank_clsf" editable="false" appearance="output" style="left:302px; top:129px; width:20px; height:18px; "/>
			<input id="acct_cd" ref="/root/resData/resform/acct_cd" editable="false" appearance="output" style="left:325px; top:129px; width:130px; height:18px; "/>
			<input id="peps_pers_nm" ref="/root/resData/resform/peps_pers_nm" editable="false" appearance="output" style="left:458px; top:129px; width:65px; height:18px; "/>
			<input id="medi_cd" ref="/root/resData/resform/medi_cd" navindex="16" editable="false" inputtype="button" maxlength="3" style="left:95px; top:154px; width:65px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
//						model.removeNodeset("/root/reqData/fwdData");  
//						model.makeNode("/root/reqData/fwdData/cmpy_cd");
//						model.makeNode("/root/reqData/fwdData/G_Tag");
//						model.makeNode("/root/reqData/fwdData/G_Caption");
//						model.makeNode("/root/reqData/fwdData/G_Codenu");
//						model.makeNode("/root/reqData/fwdData/G_BRCode");
//						model.makeNode("/root/reqData/fwdData/G_Ymgbcd");
//						model.makeNode("/root/reqData/fwdData/G_Cdgb");
//						model.makeNode("/root/reqData/fwdData/G_FullnameYB");
//
//						model.setValue("/root/reqData/fwdData/cmpy_cd", model.getValue("/root/reqData/search/cmpy_cd"));
//						model.setValue("/root/reqData/fwdData/G_Tag", "0");
//						model.setValue("/root/reqData/fwdData/G_Ymgbcd", "00");
//						model.setValue("/root/reqData/fwdData/G_Cdgb", "01");
//						model.setValue("/root/reqData/fwdData/G_Caption", "매체코드조회");
//						model.setValue("/root/reqData/fwdData/G_FullnameYB", "N");
//
//						gstr_popupid = "medi_cd";
//					
//						window.load("../../mc/co/MC_CO_1000.xrw"
//									, "modal"
//									, ""
//									, "left:100; top:100; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:visible;"
//								,"/root/reqData/fwdData"
//								,"/root/reqData/fwdData"
//								)	
								
						var cd   =  "";		// model.getValue("/root/resData/resform/medi_cd");
						var cdnm =  "";		// model.getValue("/root/resData/resform/medi_cd_nm");	
							
						var resultRef1 = "/root/resData/resform/medi_cd";
						var resultRef2 = "/root/resData/resform/medi_cd_nm";
						
						var ch_mede_cd = medi_cd.value;
						
						showCommonCodePopup1("00", "01", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
						
						if(ch_mede_cd != medi_cd.value){
							dtls_medi_cd.value = "";
							dtls_medi_cd_nm.value = "";
						}

						model.refresh();
						
						if(medi_cd.value != ""){
							if (open_fc_co_8010("focus","s","매체코드조회","1","","00","01")) {
								//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
							}
							else {
								//팝업에서 취소 버튼을 누른 경우
							}
						}
						
						if (get_refvalue("/root/tempData/medi_ch") == "Y") {
							dtls_medi_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						}
						else {
							dtls_medi_cd.attribute("background-color") = "white";
						}
											
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					
						// ==>> 이부분은 광고쪽의 매체코드의 관리항목으로 관리하게 될때 없어지면서 다른 로직이 들어와야 함
					       // 코드를 직접입력할때도 체크해야 함
						/*
						if (medi_cd.value == "100" || medi_cd.value == "200" || medi_cd.value == "600") {
							model.alert("입력가능한 매체코드가 아닙니다.");
							medi_cd.value = "";
							medi_cd_nm.value = "";
							return;
						}
						*/
					

						if(medi_cd.value.length == 3 ){

							model.setValue("/root/reqData/search/job_clsf", "00");
							model.setValue("/root/reqData/search/cd_clsf", "01");
							model.setValue("/root/reqData/search/cd", medi_cd.value);

							model.send("fc_co_8000_s");
							
							if (model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cd").Trim() != "") {
								medi_cd_nm.value = model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cdnm");
								dtls_medi_cd.value = "";
								dtls_medi_cd_nm.value = "";
							}
							else
							{
								medi_cd.value = "";
								medi_cd_nm.value = "";
							}	
							
						}
						else {
							medi_cd.value = "";
							medi_cd_nm.value = "";
						}
						if(medi_cd.value != ""){
							if (open_fc_co_8010("focus","s","매체코드조회","1","","00","01")) {
								//팝업에서 확인 버튼을 누른 경우(혹은 데이터를 더블클릭 한 경우)
							}
							else {
								//팝업에서 취소 버튼을 누른 경우
							}
						}
//						if (medi_cd.value == "110" || medi_cd.value == "210") {
						if (get_refvalue("/root/tempData/medi_ch") == "Y") {
							dtls_medi_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						}
						else {
							dtls_medi_cd.attribute("background-color") = "white";
						}
						
						
						
					]]>
				</script>
			</input>
			<input id="medi_cd_nm" ref="/root/resData/resform/medi_cd_nm" editable="false" style="left:163px; top:154px; width:132px; height:18px; "/>
			<input id="prop_equip_cd" ref="/root/resData/resform/prop_equip_cd" navindex="10" inputtype="button" maxlength="4" style="left:393px; top:29px; width:50px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
								
						var cd   =  "";	//model.getValue("/root/resData/resform/prop_equip_cd");
						var cdnm =  "";	//model.getValue("/root/resData/resform/prop_equip_cd_nm");	
							
						var resultRef1 = "/root/resData/resform/prop_equip_cd";
						var resultRef2 = "/root/resData/resform/prop_equip_cd_nm";
						
						showCommonCodePopup1("00", "12", cd, cdnm, "N", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");

						prop_equip_cd.dispatch("xforms-value-changed");

						model.refresh();			
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					
					
						if(prop_equip_cd.value.length == 4 ){

							model.setValue("/root/reqData/search/job_clsf", "00");
							model.setValue("/root/reqData/search/cd_clsf", "12");
							model.setValue("/root/reqData/search/cd", prop_equip_cd.value);

							model.send("fc_co_8000_s");
							
							if (model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cd").Trim() != "") {
 								prop_equip_cd_nm.value = model.getValue("/root/resData/resform2/dataSet/CURLIST1/record/cdnm");
							}
							else
							{
								prop_equip_cd.value = "";
								prop_equip_cd_nm.value = "";
							}	
							
						}
						else {
							prop_equip_cd.value = "";
							prop_equip_cd_nm.value = "";
						}
						
						if (prop_equip_cd.value == "8950" && Number(vat_amt.value) != 0) {
							show_message("부가세금액이 존재해서 영수증구분에 계산서(8950)은 입력할 수 없습니다.");
							prop_equip_cd.value = "";
						}
					
						if (prop_equip_cd.value.Trim() != "") {
							if (model.getValue("/root/resData/resform/prop_equip_cd_nm").Trim() == "") {
//								prop_equip_cd.value = "";
							}
						}
					
						// 영수증구분에 따른 필수항목 set 하기위해 예산코드 CHANGE 강제 invoke
						budg_cd.dispatch("xforms-value-changed");
					
						// 영수증코드가 8925 일 경우 관리 구분 중 신용카드만 COMBO ADDITEM
						if (prop_equip_cd.value == "8925") {
							model.setValue("/root/reqData/search/budg_cd", "prop_equip_cd");
							model.setValue("/root/reqData/search/cd", "");
	
							model.send("fc_acct_2083_s");

							mang_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							
							model.refresh();
						}
						
						model.refresh();
					
						var var_vat_amt3 = 0;
						
						var_vat_amt3 = Number(vat_amt.value);
						
						if (var_vat_amt3 != 0 ||
						   prop_equip_cd.value== "8900" ||
						   prop_equip_cd.value == "8950" ) {
							prof_type_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							occr_slip_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							occr_slip_occr_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
							occr_slip_seq.attribute("background-color") = DEFAULT_COLOR_REQ;
							erplace_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							make_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
							ern.attribute("background-color") = DEFAULT_COLOR_REQ;
							if(prop_equip_cd.value== "8900"){
								elec_tax_no1.attribute("background-color") = DEFAULT_COLOR_REQ;
								elec_tax_no2.attribute("background-color") = DEFAULT_COLOR_REQ;
								elec_tax_no3.attribute("background-color") = DEFAULT_COLOR_REQ;								
							}else{
								elec_tax_no1.attribute("background-color") = "white";
								elec_tax_no2.attribute("background-color") = "white";
								elec_tax_no3.attribute("background-color") = "white";									
							}
						}
						else {
							prof_type_cd.attribute("background-color") = "white";
							occr_slip_clsf_cd.attribute("background-color") = "white";
							occr_slip_occr_dt.attribute("background-color") = "white";
							occr_slip_seq.attribute("background-color") = "white";
							erplace_cd.attribute("background-color") = "white";
							make_dt.attribute("background-color") = "white";
							ern.attribute("background-color") = "white";
							elec_tax_no1.attribute("background-color") = "white";
							elec_tax_no2.attribute("background-color") = "white";
							elec_tax_no3.attribute("background-color") = "white";							
						}
						
						// 영수증코드가 8925 일 경우 관리 구분 중 신용카드만 COMBO ADDITEM
						if (prop_equip_cd.value == "8925") {

							model.setValue("/root/reqData/search/budg_cd", "prop_equip_cd");
							model.setValue("/root/reqData/search/cd", "");
	
							model.send("fc_acct_2083_s");

							mang_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							
							model.refresh();
						}
						
						// 세금계산서유형
						if (prof_type_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (prop_equip_cd.value == "8950") {
								prof_type_cd.value = "16";
							}
							else {
								if (medi_cd.value == "410" || medi_cd.value == "420" || medi_cd.value == "710" || parentWindow.clam_dept_cd.value.substring(0, 2) == "48") {
									prof_type_cd.value = "14";
								}
								else {
									if (erplace_cd.value != "01") {
										if (prop_equip_cd.value == "8900" || (medi_cd.value == "810" && budg_cd.value >= "655601" && budg_cd.value <= "655606")) {
											prof_type_cd.value = "11";											
										}
										else {
											prof_type_cd.value = "16";											
										}
									}
									else {
										if (var_vat_amt3 == 0) {
											prof_type_cd.value = "15";	
										}
										else {
											prof_type_cd.value = "11";	
										}
									}
								}
							}

							if (budg_cd.value == "304301" || budg_cd.value == "304302" ||
							    budg_cd.value == "652101" || budg_cd.value == "652103") {
								prof_type_cd.value = "13";	
							}
							else if (budg_cd.value == "771100" || budg_cd.value == "773300" || budg_cd.value == "829300") {
								prof_type_cd.value = "14";	
							}
	
							// 부가세가없을때는 매입계산서로
							if (budg_cd.value == "829300" && Number(vat_amt.value) == 0) {
								prof_type_cd.value = "16";									
							}
							
							if (budg_cd.value == "771100" && Number(vat_amt.value) == 0) {
								prof_type_cd.value = "16";									
							}

						}
						
						prof_type_cd.dispatch("xforms-select");
						

						


					]]>
				</script>
				<script type="javascript" ev:event="DOMFocusOut">
					<![CDATA[
						
//						if (prop_equip_cd.value.Trim() != "") {
//							if (model.getValue("/root/resData/resform/prop_equip_cd_nm").Trim() == "") {
//								prop_equip_cd.value = "";
//							}
//						}
//						
//						// 영수증구분에 따른 필수항목 set 하기위해 예산코드 CHANGE 강제 invoke
//						budg_cd.dispatch("xforms-value-changed");
//					
//						// 영수증코드가 8925 일 경우 관리 구분 중 신용카드만 COMBO ADDITEM
//						if (prop_equip_cd.value == "8925") {
//							model.setValue("/root/reqData/search/budg_cd", "prop_equip_cd");
//							model.setValue("/root/reqData/search/cd", "");
//	
//							model.send("fc_acct_2083_s");
//
//							mang_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
//							
//							model.refresh();
//						}

					]]>
				</script>
			</input>
			<input id="dtls_medi_cd" ref="/root/resData/resform/dtls_medi_cd" navindex="17" inputtype="button" style="left:95px; top:180px; width:90px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						if (medi_cd.value != "") {
								/*2012.01.13*/
								/*makeFwdDataNodes();
								
								model.setValue("/root/reqData/fwdData/job_clsf", "00"); //필수항목
								model.setValue("/root/reqData/fwdData/cd_clsf", "01"); //필수항목
								model.setValue("/root/reqData/fwdData/cd",  medi_cd.value);
								model.setValue("/root/reqData/fwdData/cdnm", medi_cd_nm.value);
	
								model.setValue("/root/reqData/fwdData/resultRef1", "/root/resData/resform/dtls_medi_cd");
								model.setValue("/root/reqData/fwdData/resultRef2", "/root/resData/resform/dtls_medi_cd_nm");	
		
								
								window.load("/xrw/co/cocd/CO_COCD_1400.xrw"
											, "modal"
											, ""
											, "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
										,"/root/reqData/fwdData"
										,"/root/reqData/searchData"
										)	*/
						
						gstr_popupid = "dtls_medi_cd";
						open_fc_acct_1180("button","s");
						//model.removeNodeset("/root/reqData/fwdData");  
						//model.makeNode("/root/reqData/fwdData/func_nm");
						//model.setValue("/root/reqData/fwdData/func_nm", "setEmp_no");
						//window.load("/xrw/hd/com/HD_COM_1000.xrw","modal", "hd_com_1000", "align:center; caption:hidden;width:460px; height:400px;", "/root/reqData/fwdData", "/root/reqData/searchData");
						}					
									
/* 
						if (medi_cd.value == "110") {
					
//							var cd   =  model.getValue("/root/resData/resform/dtls_medi_cd");
//							var cdnm =  model.getValue("/root/resData/resform/dtls_medi_cd_nm");	

							var cd   =  "";
							var cdnm =  "";	
														
							var resultRef1 = "/root/resData/resform/dtls_medi_cd";
							var resultRef2 = "/root/resData/resform/dtls_medi_cd_nm";							
							
							showCommonCodePopup1("03", "30", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
	
							model.refresh();
						} else if (medi_cd.value == "510") {
							
							var cd   =  "";
							var cdnm =  "";	
														
							var resultRef1 = "/root/resData/resform/dtls_medi_cd";
							var resultRef2 = "/root/resData/resform/dtls_medi_cd_nm";							
							
							showCommonCodePopup1("03", "69", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
	
							model.refresh();							
							
						} else if (medi_cd.value == "610") {
					
							var cd   =  "";
							var cdnm =  "";
														
							var resultRef1 = "/root/resData/resform/dtls_medi_cd";
							var resultRef2 = "/root/resData/resform/dtls_medi_cd_nm";							

							showCommonCodePopup1("06", "077", cd, cdnm, "Y", resultRef1, resultRef2, "", "", "", "", "", "", "", "", "", "", "", "");
	
							model.refresh();
						} else if (medi_cd.value != "") {
							model.removeNodeset("/root/reqData/fwdData");  
							model.makeNode("/root/reqData/fwdData/cmpy_cd");
							model.makeNode("/root/reqData/fwdData/G_Tag");
							model.makeNode("/root/reqData/fwdData/G_Caption");
							model.makeNode("/root/reqData/fwdData/G_Codenu");
							model.makeNode("/root/reqData/fwdData/G_BRCode");
							model.setValue("/root/reqData/fwdData/cmpy_cd", model.getValue("/root/reqData/search/cmpy_cd"));
							model.setValue("/root/reqData/fwdData/G_Tag", "3");
							model.setValue("/root/reqData/fwdData/G_Caption", "상세매체코드조회");
							model.setValue("/root/reqData/fwdData/G_Codenu", medi_cd.value.substring(0, 3));					
							model.setValue("/root/reqData/fwdData/G_BRCode", "");
	
							gstr_popupid = "dtls_medi_cd";
						
							window.load("../../mc/co/MC_CO_1000.xrw"
										, "modal"
										, ""
										, "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;"
									,"/root/reqData/fwdData"
									,"/root/reqData/fwdData"
									)				
						}
*/
								
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if (medi_cd.value != "") {
						/*model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cd");
						model.makeNode("/root/reqData/fwdData/medi_cd");
						model.setValue("/root/reqData/fwdData/cd", dtls_medi_cd.value);
						model.setValue("/root/reqData/fwdData/medi_cd",medi_cd.value);
						model.send("fc_acct_2015_l");

						if (model.getValue("/root/tempData/fc_acct_2015_l/dataSet/CURLIST/record/cd") != "") {
							dtls_medi_cd_nm.value = model.getValue("/root/tempData/fc_acct_2015_l/dataSet/CURLIST/record/cdnm")
						}
						else {
							dtls_medi_cd.value = "";
						}*/
						
						gstr_popupid = "dtls_medi_cd";
						open_fc_acct_1180("focus","s");
					}else{
						dtls_medi_cd.value = "";
					}
					]]>
				</script>
			</input>
			<input id="mtry_dt" ref="/root/resData/resform/mtry_dt" navindex="19" inputtype="date" style="left:393px; top:179px; width:90px; height:18px; "/>
			<input id="make_dt" ref="/root/resData/resform/make_dt" navindex="31" inputtype="date" style="left:393px; top:353px; width:90px; height:18px; "/>
			<input id="issu_dt" ref="/root/resData/resform/issu_dt" navindex="36" inputtype="date" style="left:95px; top:476px; width:90px; height:18px; "/>
			<input id="comp_dt" ref="/root/resData/resform/comp_dt" navindex="18" inputtype="date" style="left:395px; top:155px; width:90px; height:18px; "/>
			<input id="rmks2" ref="/root/resData/resform/rmks2" class="req" navindex="22" maxlength="100" style="left:95px; top:229px; width:428px; height:18px; "/>
			<caption id="caption19" class="list_cap03" style="left:0px; top:200px; width:90px; height:26px; text-align:center; ">단위</caption>
			<caption id="caption28" class="list_cap02" style="left:89px; top:200px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption45" class="list_cap03" style="left:299px; top:200px; width:90px; height:26px; text-align:center; ">수량</caption>
			<caption id="caption47" class="list_cap02" style="left:388px; top:200px; width:141px; height:26px; text-align:center; "/>
			<select1 id="prof_type_cd" ref="/root/resData/resform/prof_type_cd" navindex="27" appearance="minimal" editmode="inputsearch" style="left:95px; top:328px; width:130px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_PROF_TYPE_LIST/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					]]>
				</script>
				<script type="javascript" ev:event="xforms-select">
					<![CDATA[
						if (prof_type_cd.value != "") {
							occr_slip_clsf_cd.value = "60";
							occr_slip_occr_dt.value = commCurDate();
							occr_slip_seq.value = "";
							if (erplace_cd.value == "") {
								erplace_cd.value = "01";
								erplace_cd.dispatch("xforms-value-changed");
							}
							if ((dlco_clsf_cd.value == "93" || dlco_clsf_cd.value == "94") && dlco_cd.value != "") {
								ern.value = dlco_cd.value;
							}
						}
						else {
							occr_slip_clsf_cd.value = "";
							occr_slip_occr_dt.value = "";
							occr_slip_seq.value = "";
							erplace_cd.value = "";
							ern.value = "";
							make_dt.value = "";
							etc_in.value = "";
						}			
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(prof_type_cd, prof_type_cd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(prof_type_cd,"");
						return;
					}
					]]>
				</script>
			</select1>
			<input id="occr_slip_clsf_cd" ref="/root/resData/resform/occr_slip_clsf_cd" editable="false" style="left:228px; top:328px; width:30px; height:18px; "/>
			<input id="occr_slip_occr_dt" ref="/root/resData/resform/occr_slip_occr_dt" navindex="28" editable="false" format="yyyy-mm-dd" style="left:261px; top:328px; width:90px; height:18px; "/>
			<input id="occr_slip_seq" ref="/root/resData/resform/occr_slip_seq" navindex="29" style="left:354px; top:328px; width:30px; height:18px; "/>
			<input id="etc_in" ref="/root/resData/resform/etc_in" navindex="32" format="(-)#,###" style="left:95px; top:378px; width:130px; height:18px; text-align:right; "/>
			<input id="purc_amt" ref="/root/resData/resform/purc_amt" navindex="34" format="(-)#,###" style="left:95px; top:451px; width:130px; height:18px; text-align:right; "/>
			<input id="corp_tax_amt" ref="/root/resData/resform/corp_tax_amt" navindex="35" format="(-)#,###" style="left:393px; top:451px; width:130px; height:18px; text-align:right; "/>
			<input id="input29" inputtype="date" style="left:95px; top:254px; width:100px; height:18px; "/>
			<caption id="caption43" class="list_cap03" style="left:0px; top:250px; width:90px; height:26px; text-align:center; ">수령자</caption>
			<caption id="caption48" class="list_cap03" style="left:299px; top:275px; width:90px; height:26px; text-align:center; ">기안지출금액</caption>
			<caption id="caption49" class="list_cap02" style="left:89px; top:250px; width:440px; height:26px; text-align:center; "/>
			<caption id="caption50" class="list_cap02" style="left:388px; top:275px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption53" class="list_cap02" style="left:89px; top:275px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption55" class="list_cap03" style="left:0px; top:275px; width:90px; height:26px; text-align:center; ">기안문서번호</caption>
			<input id="recp_pers" ref="/root/resData/resform/recp_pers" navindex="24" inputtype="button" style="left:188px; top:254px; width:100px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						gstr_popupid = "recp_pers";
						open_fc_acct_1180("button","s");		
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						gstr_popupid = "recp_pers";
						open_fc_acct_1180("focus","s");		
					]]>
				</script>
			</input>
			<input id="draft_doc_no" ref="/root/resData/resform/draft_doc_no" navindex="25" editable="false" inputtype="button" style="left:95px; top:279px; width:130px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
// 기안문서조회는 무조건 가능하게 함. 2009-11-01 노상현 (이기춘팀장 요청)
//						if (draft_doc_no.value != "") { return; }
//						set_refvalue(draft_doc_no,"");
					
//						model.alert("POP-UP 을 연결하지 않았습니다.");		



						set_refvalue("/root/resData/resform/draft_dept_cd","");
						set_refvalue("/root/reqData/fwdData/url",XFORMS_EP_WEB_ADDRESS + "/nanum/flow/ihtml/ecab/ecab_list_chosun_f.jsp?deptid=" + ((getProperty("ss_cmpycd") == "100") ? getProperty("ss_deptcd") : getProperty("ss_cmpycd") + "_" + getProperty("ss_deptcd")));
						//set_refvalue("/root/reqData/fwdData/url",XFORMS_EP_WEB_ADDRESS + "/nanum/flow/ihtml/ecab/test_f.jsp?deptid=361100l");
						window.load("/xrw/fc/co/FC_CO_9010.xrw","modal","FC_CO_9010","width:790; height:728; sysmenu:visible; min:hidden; max:hidden; resize:false; caption:visible; align:center;","/root/reqData/fwdData","/root/reqData/fwdData");
						
						if (draft_doc_no.value != "") {
						
							var var_draft_doc_no = draft_doc_no.value.split("^");
	//						alert(var_draft_doc_no[0]);
							draft_doc_no.value = var_draft_doc_no[0];
							model.setValue("/root/resData/resform/draft_dept_cd", var_draft_doc_no[1]);
							
							model.send("fc_acct_2013_s");
							
							if(get_refvalue("/root/resData/resform3/fc_acct_2013_s/dataSet/CURLIST/record/clsf_yn") == "Y"){
								draft_expn_amt.value = get_refvalue("/root/resData/resform3/fc_acct_2013_s/dataSet/CURLIST/record/draft_expn_amt");
								draft_expn_amt.attribute("editable") = "false";
								control_unmark_req1(draft_expn_amt);
							}
							else{
								draft_expn_amt.value = "";
								draft_expn_amt.attribute("editable") = "true";
								control_unmark_req(draft_expn_amt);
							}						
						}
//						window.load(XFORMS_EP_WEB_ADDRESS + "/nanum/flow/ihtml/ecab/ecab_list_chosun_f.jsp?deptid=361100", "modal", "", "align:center; width:1024; height:768; caption:visible;");
					]]>
				</script>
			</input>
			<input id="draft_expn_amt" ref="/root/resData/resform/draft_expn_amt" navindex="26" format="(-)#,###" style="left:393px; top:279px; width:130px; height:18px; text-align:right; "/>
			<input id="qunt" ref="/root/resData/resform/qunt" navindex="21" format="(-)#,###" style="left:393px; top:204px; width:65px; height:18px; text-align:right; "/>
			<input id="ern" ref="/root/resData/resform/ern" navindex="33" inputtype="button" style="left:393px; top:378px; width:130px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						gstr_popupid = "ern";
						open_fc_acct_1180("button","s");		
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						gstr_popupid = "ern";
						open_fc_acct_1180("focus","s");		
					]]>
				</script>
			</input>
			<input id="unit" ref="/root/resData/resform/unit" navindex="20" maxlength="10" style="left:95px; top:204px; width:65px; height:18px; "/>
			<select1 id="recp_pers_clsf" ref="/root/resData/resform/recp_pers_clsf" navindex="23" appearance="minimal" style="left:95px; top:254px; width:90px; height:18px; ">
				<choices>
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>93 사업자</label>
						<value>93</value>
					</item>
					<item>
						<label>94 개인</label>
						<value>94</value>
					</item>
					<item>
						<label>91 사원</label>
						<value>91</value>
					</item>
				</choices>
			</select1>
			<input id="recp_pers_nm" ref="/root/resData/resform/recp_pers_nm" editable="false" style="left:291px; top:254px; width:163px; height:18px; "/>
			<input id="int_rate" ref="/root/resData/resform/int_rate" navindex="37" format="(-)#,###" style="left:393px; top:476px; width:65px; height:18px; text-align:right; "/>
			<input id="pay_bank_cd" ref="/root/resData/resform/pay_bank_cd" navindex="38" inputtype="button" style="left:95px; top:501px; width:65px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						gstr_popupid = "pay_bank_cd";
						open_fc_acct_1180("button","s");		
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						gstr_popupid = "pay_bank_cd";
						open_fc_acct_1180("focus","s");		
					]]>
				</script>
			</input>
			<input id="pay_bank_cd_nm" ref="/root/resData/resform/pay_bank_cd_nm" editable="false" style="left:163px; top:501px; width:132px; height:18px; "/>
			<input id="insr_nm" ref="/root/resData/resform/insr_nm" navindex="39" style="left:95px; top:550px; width:200px; height:18px; "/>
			<select1 id="occr_slip_clsf" ref="/root/resData/resform/occr_slip_clsf" navindex="40" appearance="minimal" editmode="inputsearch" itemcount="10" style="left:304px; top:527px; width:181px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_SLIP_CLSF_LIST/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(occr_slip_clsf, occr_slip_clsf.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(occr_slip_clsf,"");
						return;
					}
					]]>
				</script>
			</select1>
			<input id="occr_slip" ref="/root/resData/resform/occr_slip" navindex="41" inputtype="button" style="left:304px; top:550px; width:181px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						if(trim(budg_cd.value) == ""){
							show_message("먼저 예산코드를 선택해 주세요.(예산코드:456100 ~ 468899)");
							return;
						}
						
						if((budg_cd.value >= '456100') && (budg_cd.value <= '468899')){
							model.property("FC_ACCT_2500_popup_clsf")  = "Y";
							model.property("FC_ACCT_2500_srch_occr_slip_clsf")  = occr_slip_clsf.value;
							model.property("FC_ACCT_2500_srch_budg_cd") = budg_cd.value;
							model.property("FC_ACCT_2500_srch_budg_nm") = budg_cd_nm.value;
							
							viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2500");
							
	//						alert(model.property("FC_ACCT_2500_srch_occr_slip_clsf"));
							
							occr_slip_clsf.value = model.property("FC_ACCT_2500_srch_occr_slip_clsf");
							occr_slip.value = model.property("FC_ACCT_2500_occr_slip");
							
							model.property("FC_ACCT_2500_occr_slip") = "";
							model.property("FC_ACCT_2500_srch_occr_slip_clsf") = "";
						}else{
							show_message("예수금조회가 가능한 예산코드가 아닙니다.(예산코드:456100 ~ 468899)");
							return;
						}
					]]>
				</script>
			</input>
			<caption id="caption18" class="list_cap03" style="left:299px; top:497px; width:230px; height:26px; text-align:center; ">전사잔액전표</caption>
			<caption id="caption52" class="list_cap02" style="left:269px; top:125px; width:30px; height:26px; text-align:center; ">계좌</caption>
			<input id="complete_flag" ref="/root/resData/resform/complete_flag" appearance="output" style="left:249px; top:129px; width:16px; height:18px; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						if(complete_flag.value == "Y" || complete_flag.value == "y"){
							set_refvalue("/root/resData/resform/complete_flag","Y");
						}
						else{
							set_refvalue("/root/resData/resform/complete_flag","");
						}
						complete_flag.refresh();					
					]]>
				</script>
			</input>
			<button id="button1" class="btn05" style="left:413px; top:327px; width:114px; height:21px; ">
				<caption>스마트빌 세금계산서</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setSemuro");
//						window.load("/xrw/co/semuro/CO_SEMURO_1000.xrw","modal", "co_semuro_1400", "align:center; width:645; height:475; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
						window.load("/xrw/co/smtb/CO_SMTB_1100.xrw","modal", "co_smtb_1100", "align:center; width:645; height:475; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");	
					]]>
				</script>
			</button>
			<input id="prop_equip_cd_nm" ref="/root/resData/resform/prop_equip_cd_nm" editable="false" style="left:447px; top:29px; width:76px; height:18px; "/>
			<caption id="caption68" class="list_cap03" style="left:0px; top:399px; width:154px; height:26px; text-align:center; ">전자세금계산서 승인번호</caption>
			<input id="elec_tax_no1" ref="/root/tempData/elec_tax_no1" navindex="32" maxlength="8" style="left:157px; top:403px; width:68px; height:18px; text-align:right; "/>
			<input id="elec_tax_no2" ref="/root/tempData/elec_tax_no2" navindex="32" maxlength="8" style="left:230px; top:403px; width:68px; height:18px; text-align:right; "/>
			<input id="elec_tax_no3" ref="/root/tempData/elec_tax_no3" navindex="32" maxlength="8" style="left:305px; top:403px; width:68px; height:18px; text-align:right; "/>
			<caption id="caption69" class="list_cap03" style="left:388px; top:399px; width:97px; height:26px; text-align:center; ">종이세금계산서</caption>
			<input id="dtls_medi_cd_nm" ref="/root/resData/resform/dtls_medi_cd_nm" editable="false" style="left:190px; top:180px; width:105px; height:18px; "/>
		</group>
		<group id="group_tit" class="gro_tit" style="left:0px; top:0px; width:545px; height:39px; ">
			<caption id="caption1" class="tit01" style="left:10px; top:6px; width:351px; height:27px; ">공통지출결의내역등록</caption>
			<img id="img4" src="/images/ta_img_03.gif" style="left:525px; top:10px; width:15px; height:15px; background-stretch:stretch; ">
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						window.close();		
					]]>
				</script>
			</img>
		</group>
		<group id="group_scr" class="gro_sel" style="left:10px; top:45px; width:529px; height:76px; ">
			<caption id="caption29" class="list_cap02" style="left:89px; top:0px; width:440px; height:26px; text-align:center; "/>
			<caption id="caption13" class="list_cap02" style="left:89px; top:50px; width:211px; height:26px; text-align:center; "/>
			<caption id="caption2" class="list_cap03" style="left:0px; top:0px; width:90px; height:26px; text-align:center; ">행번호</caption>
			<caption id="caption4" class="list_cap03" style="left:0px; top:25px; width:90px; height:26px; text-align:center; ">예산코드</caption>
			<caption id="caption5" class="list_cap02" style="left:89px; top:25px; width:211px; height:26px; text-align:center; "/>
			<caption id="suplyamt" class="list_cap03" style="left:299px; top:25px; width:90px; height:26px; text-align:center; ">과표</caption>
			<caption id="caption11" class="list_cap02" style="left:388px; top:25px; width:141px; height:26px; text-align:center; "/>
			<input id="suply_amt" ref="/root/resData/resform/suply_amt" class="req" navindex="5" inputtype="input" format="(-)#,###" style="left:393px; top:29px; width:130px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
//Private Sub txtHJPgwapyo_Change()
//    w_txthjpgwapyo_change_flag = True
//End Sub
//
//Private Sub txtHJPgwapyo_GotFocus()
//    Cmndll.GF_NumberDisplay txtHJPgwapyo
//    w_txthjpgwapyo_change_flag = False
//End Sub
//
//Private Sub txtHJPgwapyo_KeyPress(KeyAscii As Integer)
//    Cmndll.GF_Key_Check txtHJPgwapyo, KeyAscii
//End Sub
//
//Private Sub txtHJPgwapyo_LostFocus()
//    Cmndll.GF_NumericDisplay txtHJPgwapyo
//    If w_txthjpgwapyo_change_flag = True Then
//        Call S_WCJS_Compute
//        
//        If Left(Trim(txtHJPYSCD.Text), 4) = "6226" Then  '2005.4.12
//           Call S_GYBHRYO_Compute
//        Else
//           txtGYBHRYO.Text = ""
//        End If
//        
//        If Left(Trim(cboHJPSDGBCD.Text), 4) = "9011" Then  '2005.5.10
//           Call S_GYBHRYO_Compute
//        Else
//           txtGYBHRYO.Text = ""
//        End If
//    End If
//End Sub		
					]]>
				</script>
			</input>
			<caption id="caption6" class="list_cap03" style="left:299px; top:50px; width:90px; height:26px; text-align:center; ">부가세</caption>
			<caption id="caption7" class="list_cap02" style="left:388px; top:50px; width:141px; height:26px; text-align:center; "/>
			<caption id="caption12" class="list_cap03" style="left:0px; top:50px; width:90px; height:26px; text-align:center; ">사용부서</caption>
			<input id="vat_amt" ref="/root/resData/resform/vat_amt" navindex="6" inputtype="input" format="(-)#,###" style="left:393px; top:54px; width:130px; height:18px; text-align:right; ">
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var var_vat_amt = 0;
						
						var_vat_amt = Number(vat_amt.value);
						
						if (var_vat_amt != 0 || prop_equip_cd.value == "8900" || prop_equip_cd.value == "8950") {
							prof_type_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							occr_slip_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							occr_slip_occr_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
							occr_slip_seq.attribute("background-color") = DEFAULT_COLOR_REQ;
							erplace_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							make_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
							ern.attribute("background-color") = DEFAULT_COLOR_REQ;
						}
						else {
							prof_type_cd.attribute("background-color") = "white";
							occr_slip_clsf_cd.attribute("background-color") = "white";
							occr_slip_occr_dt.attribute("background-color") = "white";
							occr_slip_seq.attribute("background-color") = "white";
							erplace_cd.attribute("background-color") = "white";
							make_dt.attribute("background-color") = "white";
							ern.attribute("background-color") = "white";
						}
						
						// 세금계산서유형 
						if (prof_type_cd.attribute("background-color") == DEFAULT_COLOR_REQ) {
							if (prop_equip_cd.value == "8950") {
								prof_type_cd.value = "16";
							}
							else {
								if (medi_cd.value == "410" || medi_cd.value == "420" || medi_cd.value == "710" || parentWindow.clam_dept_cd.value.substring(0, 2) == "48") {
									prof_type_cd.value = "14";
								}
								else {
									if (erplace_cd.value != "01") {
										if (prop_equip_cd.value == "8900" || (medi_cd.value == "810" && budg_cd.value >= "655601" && budg_cd.value <= "655606")) {
											prof_type_cd.value = "11";											
										}
										else {
											prof_type_cd.value = "16";											
										}
									}
									else {
										if (var_vat_amt == 0) {
											prof_type_cd.value = "15";	
										}
										else {
											prof_type_cd.value = "11";	
										}
									}
								}
							}

							if (budg_cd.value == "304301" || budg_cd.value == "304302" ||
							    budg_cd.value == "652101" || budg_cd.value == "652103") {
								prof_type_cd.value = "13";	
							}
							else if (budg_cd.value == "771100" || budg_cd.value == "773300" || budg_cd.value == "829300") {
								prof_type_cd.value = "14";	
							}
	
							// 부가세가없을때는 매입계산서로
							if (budg_cd.value == "829300" && Number(vat_amt.value) == 0) {
								prof_type_cd.value = "16";									
							}
							
							if (budg_cd.value == "771100" && Number(vat_amt.value) == 0) {
								prof_type_cd.value = "16";									
							}

						}
						
						prof_type_cd.dispatch("xforms-select");
						
						    
					]]>
				</script>
			</input>
			<select id="rece_exp_aplc_yn" ref="/root/resData/resform/rece_exp_aplc_yn" navindex="2" overflow="visible" appearance="full" cellspacing="15" cols="2" style="left:188px; top:5px; width:117px; height:16px; border-style:none; ">
				<choices>
					<item>
						<label>접대비 신청 여부</label>
						<value>1</value>
					</item>
				</choices>
			</select>
			<button id="slip_arow_no_up" class="btn_up" style="left:163px; top:1px; width:20px; height:12px; ">
				<caption/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
			
						if (childBody.datagrid1.row <= 1) { return; }
						
						childBody.datagrid1.row = childBody.datagrid1.row - 1;
						childBody.datagrid1.col = 1;
						
						fn_GridToForm(childBody.datagrid1.row);
						
//						if (incm_clsf_cd.value != "") {
//							incm_clsf_cd.dispatch("xforms-value-changed");
//						}
//						else {
//							if (budg_cd.value == "") { budg_cd.dispatch("xforms-value-changed"); }
//						}
					
					]]>
				</script>
			</button>
			<button id="slip_arow_no_down" class="btn_down" style="left:163px; top:14px; width:20px; height:10px; ">
				<caption/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (childBody.datagrid1.row >= childBody.datagrid1.rows - 1) { return; }
						
						childBody.datagrid1.row = childBody.datagrid1.row + 1;
						childBody.datagrid1.col = 1;
						
//						alert(childBody.datagrid1.row);
						
						fn_GridToForm(childBody.datagrid1.row);
						
//						if (incm_clsf_cd.value != "") {
//							incm_clsf_cd.dispatch("xforms-value-changed");
//						}
//						else {
//							if (budg_cd.value == "") { budg_cd.dispatch("xforms-value-changed"); }
//						}
						
					]]>
				</script>
			</button>
			<input id="srchslip_arow_no" ref="/root/resData/resform/slip_arow_no" class="req" navindex="1" maxlength="6" style="left:95px; top:4px; width:65px; height:18px; "/>
			<input id="budg_cd" ref="/root/resData/resform/budg_cd" class="req" navindex="3" inputtype="button" maxlength="6" style="left:95px; top:29px; width:65px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/cmpy_cd");
						model.makeNode("/root/reqData/fwdData/G_Tag");
						model.makeNode("/root/reqData/fwdData/G_Caption");
						model.makeNode("/root/reqData/fwdData/G_Codenu");
						model.makeNode("/root/reqData/fwdData/G_BRCode");
						model.setValue("/root/reqData/fwdData/cmpy_cd", model.getValue("/root/reqData/searchData/cmpy_cd"));
						model.setValue("/root/reqData/fwdData/G_Tag", "2");
						model.setValue("/root/reqData/fwdData/G_Caption", "부서별예산코드조회");
						model.setValue("/root/reqData/fwdData/G_Codenu", parentWindow.clam_dept_cd.value);					
						model.setValue("/root/reqData/fwdData/G_BRCode", "");
						gstr_popupid = "budg_cd";
						window.load("../../mc/co/MC_CO_1000.xrw", "modal", "", "align:center; width:460; height:420; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData")		
						budg_cd.dispatch("xforms-value-changed");	
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[

						if (gvar_evnt_check_flag == "N") {
							if(budg_cd.value.Trim().length == 6){
								model.setValue("/root/reqData/search/budg_cd", model.getValue("/root/resData/resform/budg_cd"));
								model.setValue("/root/reqData/search/cd", model.getValue("/root/resData/resform/budg_cd"));
								model.setValue("/root/reqData/search/cdnm", "");
								model.setValue("/root/reqData/search/dept_cd", parentWindow.clam_dept_cd.value);
		
								model.send("mc_co_1002_l");
								
								if (Number(model.getValue("/root/resData/resform2/dataSet/CURLIST/totalcnt")) != 0) {
									budg_cd_nm.value = model.getValue("/root/resData/resform2/dataSet/CURLIST/record/cdnm");
								}
								else {
									budg_cd.value = "";
									budg_cd_nm.value = "";
								}
							}
							else {
								budg_cd.value = "";
								budg_cd_nm.value = "";
							}
						}
						
						// 유가증권 계정 과표 -> 액면가, 이외 과표
						if (model.getValue("/root/resData/resform/budg_cd") == "201800") { // 국공채
							suplyamt.value = "액면가";
						}
						else {
							suplyamt.value = "과표";
						}

						// 선급금만 가능
						if (parentWindow.expn_clsf.value == "2" && model.getValue("/root/resData/resform/budg_cd").substring(0, 3) != "160" && model.getValue("/root/resData/resform/budg_cd") != "") {
							model.alert("[선급금만 가능]");
							model.setValue("/root/resData/resform/budg_cd", "");
							model.setValue("/root/resData/resform/budg_cd_nm", "");
						}
						
						// 선급금 불가능
						if (parentWindow.expn_clsf.value != "2" && model.getValue("/root/resData/resform/budg_cd").substring(0, 3) == "160") {
							model.alert("[선급금 불가능]");
							model.setValue("/root/resData/resform/budg_cd", "");
						}

						var strdlco_clsf_cd;		// 거래처구분
						var strdlco_cd;			// 거래처코드
						var strdlco_nm;			// 거래처명
						var strintg_dlco_cd;		// 통합거래처코드
						var strbank_clsf;		// 은행구분
						var stracct_cd;			// 계좌번호
						var strpeps_pers_nm;	// 예금주명

						var strmang_clsf_cd;		// 관리구분
						var strmang_no;		// 관리번호
    
						strdlco_clsf_cd = model.getValue("/root/resData/resform/dlco_clsf_cd");
						strdlco_cd = model.getValue("/root/resData/resform/dlco_cd");
						strdlco_nm = model.getValue("/root/resData/resform/dlco_nm");
						strintg_dlco_cd = model.getValue("/root/resData/resform/intg_dlco_cd");
						strbank_clsf = model.getValue("/root/resData/resform/bank_clsf");
						stracct_cd = model.getValue("/root/resData/resform/acct_cd");
						strpeps_pers_nm = model.getValue("/root/resData/resform/peps_pers_nm");
						
						strmang_clsf_cd = model.getValue("/root/resData/resform/mang_clsf_cd");	// 관리구분
						strmang_no = model.getValue("/root/resData/resform/mang_no");			// 관리번호

						model.setValue("/root/reqData/search/budg_cd", model.getValue("/root/resData/resform/budg_cd")); // 검색조건에 셋팅
						model.setValue("/root/reqData/search/incm_clsf_cd", model.getValue("/root/resData/resform/incm_clsf_cd")); // 검색조건에 셋팅
						model.setValue("/root/reqData/search/prop_equip_cd", model.getValue("/root/resData/resform/prop_equip_cd")); // 검색조건에 셋팅
						model.send("fc_acct_2080_m");
						makeComboGubun("", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_INCM_CLSF_LIST", "record", "cd_nm", "cd");
						makeComboGubun("", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_PROF_TYPE_LIST", "record", "cd_nm", "cd");
						makeComboGubun("", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_ERPLACE_CD_LIST", "record", "cd_nm", "cd");
						makeComboGubun("", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_DLCO_CLSF_LIST", "record", "cd_abrv_nm", "cd");
						makeComboGubun("", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_SLIP_CLSF_LIST", "record", "cd_nm", "cd");
						

						strwhco_ndstb_cd = model.getValue("/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_WHCO_NDSTB_CD_LIST/record/whco_ndstb_cd");
						strwhco_comn_cost_yn = model.getValue("/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_WHCO_NDSTB_CD_LIST/record/whco_comn_cost_yn");

						//전사공통비여부가 "1" 이면 사용부서 "999999"
						use_dept_cd.attribute("editable") = "true";
						use_dept_cd.attribute("background-color") = "white";

						if (strwhco_comn_cost_yn == "Y") {
							use_dept_cd.attribute("editable") = "false";
							use_dept_cd.attribute("background-color") = DEFAULT_COLOR_DISABLE;
							model.setValue("/root/resData/resform/use_dept_cd", "999999");
							model.setValue("/root/resData/resform/use_dept_cd_nm", "공통부서");
						}
						
						// 색초기화
						dlco_clsf_cd.attribute("background-color") = "white";
						purc_amt.attribute("background-color") = "white";
						corp_tax_amt.attribute("background-color") = "white";
						issu_dt.attribute("background-color") = "white";
						int_rate.attribute("background-color") = "white";
						pay_bank_cd.attribute("background-color") = "white";
      						insr_nm.attribute("background-color") = "white";
						occr_slip_clsf.attribute("background-color") = "white";
						occr_slip.attribute("background-color") = "white";
						mang_clsf_cd.attribute("background-color") = "white";
						dlco_cd.attribute("background-color") = "white";
						medi_cd.attribute("background-color") = "white";
						boks_dlco_nm.attribute("background-color") = "white";
						mang_clsf_cd.attribute("background-color") = "white";
						mang_no.attribute("background-color") = "white";
						unit.attribute("background-color")  = "white";
						comp_dt.attribute("background-color") = "white";
						mtry_dt.attribute("background-color") = "white";
						qunt.attribute("background-color") = "white";
						dtls_medi_cd.attribute("background-color")  = "white";
						prop_equip_cd.attribute("background-color") = "white";
						qunt.attribute("background-color") = "white";
						incm_clsf_cd.attribute("background-color") = "white";

//						if (medi_cd.value == "110" || medi_cd.value == "210") {
						if (get_refvalue("/root/tempData/medi_ch") == "Y") {
							dtls_medi_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						}
						else {
							dtls_medi_cd.attribute("background-color") = "white";
						}

						//적요2를 필수여부와 관계없이 노란색
						rmks2.attribute("background-color") = DEFAULT_COLOR_REQ;
						    
						//mask는 따로
						comp_dt.attribute("background-color") = "white";
						mtry_dt.attribute("background-color") = "white";
						occr_slip_occr_dt.attribute("background-color") = "white";
						make_dt.attribute("background-color") = "white";

						//행번호,예산코드,사용부서,과표는 필수로 설정
						srchslip_arow_no.attribute("background-color") = DEFAULT_COLOR_REQ;
						budg_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						use_dept_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						suply_amt.attribute("background-color") = DEFAULT_COLOR_REQ;
						
						// 선급금 정리시 선급지출번호는 필수(선급금계정의)
						if (parentWindow.expn_clsf.value == "3") {
						        setoff_slip_no.attribute("background-color") = DEFAULT_COLOR_REQ;
						}
						else {
						        setoff_slip_no.attribute("background-color") = DEFAULT_COLOR_DISABLE;
						}

						// 유가증권 계정은 유가증권사항 필수
						if (model.getValue("/root/resData/resform/budg_cd") == "201800") { // 국공채
							purc_amt.attribute("background-color") = DEFAULT_COLOR_REQ;
							corp_tax_amt.attribute("background-color") = DEFAULT_COLOR_REQ;
							issu_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
							int_rate.attribute("background-color") = DEFAULT_COLOR_REQ;
							pay_bank_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							
						}

						//    '보험료 계정(선급보험료)은 보험사항 필수
						if (model.getValue("/root/resData/resform/budg_cd").substring(0, 4) == "1713") { //선급비용)보험료
        							insr_nm.attribute("background-color") = DEFAULT_COLOR_REQ;
						}
    
						//    '예수금계정은 전사잔액 전표 번호 필수 2001/11/29
						if (model.getValue("/root/resData/resform/budg_cd").substring(0, 4) == "4631" ||
							model.getValue("/root/resData/resform/budg_cd").substring(0, 4) == "4561" ||
							model.getValue("/root/resData/resform/budg_cd").substring(0, 4) == "4665" ||
							model.getValue("/root/resData/resform/budg_cd").substring(0, 4) == "4667" ||
							model.getValue("/root/resData/resform/budg_cd").substring(0, 4) == "4668"		) { //예수금대체
							occr_slip_clsf.attribute("background-color") = DEFAULT_COLOR_REQ;
							occr_slip.attribute("background-color") = DEFAULT_COLOR_REQ;
						}

						//부가세가 들어오면 세금계산서사항 필수
						if (Number(model.getValue("/root/resData/resform/vat_amt")) != 0  ||
							model.getValue("/root/resData/resform/budg_cd").substring(0, 4) == "8900" ||
							model.getValue("/root/resData/resform/budg_cd").substring(0, 4) == "8950" 	) {
							prof_type_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							occr_slip_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							occr_slip_occr_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
							occr_slip_seq.attribute("background-color") = DEFAULT_COLOR_REQ;
							erplace_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							make_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
							ern.attribute("background-color") = DEFAULT_COLOR_REQ;
						
						}
						else {
							prof_type_cd.attribute("background-color") = "white";
							occr_slip_clsf_cd.attribute("background-color") = "white";
							occr_slip_occr_dt.attribute("background-color") = "white";
							occr_slip_seq.attribute("background-color") = "white";
							erplace_cd.attribute("background-color") = "white";
							make_dt.attribute("background-color") = "white";
							ern.attribute("background-color") = "white";
						}
						

						// 차대구분을 넣어줌
						if (parentWindow.expn_clsf.value == "3" && model.getValue("/root/resData/resform/budg_cd").substring(0, 3) == "160") {
							strdrcr_clsf = "9"
						}
						else {
							strdrcr_clsf = "1"
						}
						
						// 각 CONTROL 색상 지정
						for (i = 1; i <= Number(model.getValue("/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_MANG_ITEM_CD_LIST/totalcnt")); i++) {
							if (model.getValue("/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_MANG_ITEM_CD_LIST/record[" + i + "]/drcr_clsf") == "" ||
							    model.getValue("/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_MANG_ITEM_CD_LIST/record[" + i + "]/drcr_clsf") == strdrcr_clsf ) {
								switch (model.getValue("/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_MANG_ITEM_CD_LIST/record[" + i + "]/mang_item_cd")) {
									case "02" :	// 주거래처
							                    dlco_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    dlco_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
							                case "03" :  //매체
							                    medi_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
							                case "04" :  //부거래처명
							                	boks_dlco_nm.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
							                case "05" :  //관리구분
							                    mang_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
							                case "06" :  //관리번호
							                	mang_no.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
							                case "13" :  //단위
										unit.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
							                case "17" :  //기산일
							                	comp_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
							                case "18" :  //만기일
										mtry_dt.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
							                case "31" :  //수량
										qunt.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
							                case "34" :  //상세매체코드
										dtls_medi_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
							                case "36" : //영수증구분
										prop_equip_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							                    break;
									default :
								} 
 							       }
						}

						if (	model.getValue("/root/resData/resform/incm_clsf_cd") == "9010"  ||
							model.getValue("/root/resData/resform/incm_clsf_cd") == "9005"  ||
							model.getValue("/root/resData/resform/incm_clsf_cd") == "9011"  ||
							model.getValue("/root/resData/resform/incm_clsf_cd") == "9003"  ||
							model.getValue("/root/resData/resform/incm_clsf_cd") == "9004"  ||
							model.getValue("/root/resData/resform/incm_clsf_cd") == "90041" ||
							model.getValue("/root/resData/resform/incm_clsf_cd") == "90042" 	) {
							dlco_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							dlco_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						}
						else   {
							if   (model.getValue("/root/resData/resform/prop_equip_cd") == "8931" || model.getValue("/root/resData/resform/prop_equip_cd") == "8984") {
								dlco_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
								dlco_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
							}
							else {
								if (model.getValue("/root/resData/resform/incm_clsf_cd") == "9001") {
									dlco_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
									dlco_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
								}
								else {
									// 
								}
							}
						}

						model.setValue("/root/resData/resform/dlco_clsf_cd", strdlco_clsf_cd);
						
						if (dlco_clsf_cd.label != "") {
							model.setValue("/root/resData/resform/dlco_clsf_cd", strdlco_clsf_cd);		// 거래처구분   
							model.setValue("/root/resData/resform/dlco_cd", strdlco_cd);             		// 거래처코드   
							model.setValue("/root/resData/resform/dlco_nm", strdlco_nm);             		// 거래처명     
							model.setValue("/root/resData/resform/intg_dlco_cd", strintg_dlco_cd);   	// 통합거래처코?
							model.setValue("/root/resData/resform/bank_clsf", strbank_clsf);         		// 은행구분     
							model.setValue("/root/resData/resform/acct_cd", stracct_cd);             		// 계좌번호     
							model.setValue("/root/resData/resform/peps_pers_nm", strpeps_pers_nm);    // 예금주명     
						}
						else {
							model.setValue("/root/resData/resform/dlco_clsf_cd", "");			// 거래처구분   
							model.setValue("/root/resData/resform/dlco_cd", "");             			// 거래처코드   
							model.setValue("/root/resData/resform/dlco_nm", "");             		// 거래처명     
							model.setValue("/root/resData/resform/intg_dlco_cd", "");   			// 통합거래처코?
							model.setValue("/root/resData/resform/bank_clsf", "");         			// 은행구분     
							model.setValue("/root/resData/resform/acct_cd", "");             			// 계좌번호     
							model.setValue("/root/resData/resform/peps_pers_nm", "");			// 예금주명     
						}
    
						// 소득구분 9011은 수량 필수
						if (model.getValue("/root/resData/resform/incm_clsf_cd") == "9011") {
							qunt.attribute("background-color") = DEFAULT_COLOR_REQ;
						}
						
						// 관리구분 9011은 소득구분 필수
						if (model.getValue("/root/resData/resform/mang_clsf_cd") == "9011") {
							incm_clsf_cd.attribute("background-color") = DEFAULT_COLOR_REQ;
						}


						
						// 관리구분 가져오기
						strmang_clsf_cd = model.getValue("/root/resData/resform/mang_clsf_cd");		// 관리구분							
						strmang_no = model.getValue("/root/resData/resform/mang_no");		// 관리번호


						model.setValue("/root/reqData/search/budg_cd", budg_cd.value);
						model.setValue("/root/reqData/search/cd", "");

						if (gvar_evnt_check_flag == "Y") {
							model.copyNode( "/root/initData/fc_acct_2083_s/dataSet/CUR_MANG_CLSF_CD_LIST", "/root/initData/comboSet/fc_acct_2080_m/dataSet/CUR_BUDGMANGCD_LIST" );
						}
						else {
							model.send("fc_acct_2083_s");
						}

						model.setValue("/root/resData/resform/mang_clsf_cd", strmang_clsf_cd);			// 관리구분							
						model.setValue("/root/resData/resform/mang_no", strmang_no);				// 관리번호

						if (gvar_evnt_check_flag == "Y") {
							// 
						}
						else {
							medi_cd.dispatch("xforms-value-changed");
						}

						model.refresh();	

					]]>
				</script>
				<script type="javascript" ev:event="onkeyup">
					<![CDATA[
//						model.setValue("/root/resData/resform/budg_cd_nm", "");
//						budg_cd_nm.refresh();
					]]>
				</script>
			</input>
			<input id="budg_cd_nm" ref="/root/resData/resform/budg_cd_nm" editable="false" style="left:163px; top:29px; width:132px; height:18px; "/>
			<input id="use_dept_cd" ref="/root/resData/resform/use_dept_cd" class="req" navindex="4" inputtype="button" maxlength="6" style="left:95px; top:54px; width:65px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						
						if (use_dept_cd.attribute("editable") == "false") { return; }
						
						var var_con_date = "";
						
						var var_ch_dat = parentWindow.budg_yymm.value.ReplaceString("-", "");
						
						if (var_ch_dat == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = var_ch_dat.length
							if(num_ch == 8){
								var_con_date = var_ch_dat;
							}else if(num_ch == 6){
								var_con_date = var_ch_dat + "01";
							}else if(num_ch == 4){
								var_con_date = var_ch_dat + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

							
						model.removeNodeset("/root/reqData/fwdData");  
						model.makeNode("/root/reqData/fwdData/func_nm");
						model.setValue("/root/reqData/fwdData/func_nm", "setDept_cd");
						model.makeNode("/root/reqData/fwdData/select_ch");
						model.setValue("/root/reqData/fwdData/select_ch", "I");
						model.makeNode("/root/reqData/fwdData/use_end_dt");
						model.setValue("/root/reqData/fwdData/use_end_dt", var_con_date);
						window.load("/xrw/fc/co/FC_CO_1100.xrw","mdichild", "fc_co_1100", "align:center; caption:hidden;", "/root/reqData/fwdData", "/root/reqData/fwdData");
					
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						
						var var_con_date = "";
						
						var var_ch_dat = parentWindow.budg_yymm.value.ReplaceString("-", "");

						if (var_ch_dat == ""){ 
							var_con_date = commCurDate(); 
						}else { 
							var num_ch = var_ch_dat.length
							if(num_ch == 8){
								var_con_date = var_ch_dat;
							}else if(num_ch == 6){
								var_con_date = var_ch_dat + "01";
							}else if(num_ch == 4){
								var_con_date = var_ch_dat + "0101";
							}else{
								var_con_date = commCurDate(); 
							}
						}

						if (use_dept_cd.value.length== 6) {
							
							if (use_dept_cd.value.value == "999999" && strwhco_comn_cost_yn != "Y") {
								if (strwhco_ndstb_cd == "") {
									model.alert("사용부서필수, 해당지출건은 전사배부비가 아닙니다.");
								}
							}
							
							//model.setValue("/root/reqData/search/emp_no", "");
							model.setValue("/root/reqData/search/dept_cd", use_dept_cd.value);
							model.setValue("/root/reqData/search/select_ch", "I");
							model.setValue("/root/reqData/search/use_end_dt", var_con_date);
							model.send("fc_co_1101");

							if (model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/dept_cd") != "") {
								use_dept_cd_nm.value = model.getValue("/root/tempData/fc_co_1101_l/dataSet/CURLIST1/record/abrv_nm");
							}
							else {
								use_dept_cd.value = "";
								use_dept_cd_nm.value = "";
							}
						}
						else {
							use_dept_cd.value = "";
							use_dept_cd_nm.value = "";
						}	
						
					]]>
				</script>
			</input>
			<input id="use_dept_cd_nm" ref="/root/resData/resform/use_dept_cd_nm" editable="false" style="left:163px; top:54px; width:132px; height:18px; "/>
		</group>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:717px; width:529px; height:21px; ">
			<button id="btn_draft_doc_open" class="btn04" style="left:216px; top:0px; width:88px; height:21px; ">
				<caption>기안문서조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (draft_doc_no.value.Trim() != "") {
//							window.load(XFORMS_EP_WEB_ADDRESS + "/nanum/flow/ihtml/sanc/xfopendoc_chosun.jsp?dept_id=test_dept2&doc_num=연습부서-2009-51", "modal", "", "align:center; width:1024; height:768; caption:visible;");			
//							return;
							htmlwindow.open(XFORMS_EP_WEB_ADDRESS + "/nanum/flow/ihtml/sanc/xfopendoc_chosun.jsp?dept_id=" + model.getValue("/root/resData/resform/draft_dept_cd") + "&doc_num="+draft_doc_no.value,"draft_doc","height=768,width=1024,scrollbars=no,resizable=no");
						}
						else {
							model.alert("기안문서번호는 필수입력사항입니다.");				
							return;
						}
					]]>
				</script>
			</button>
			<button id="btn_append" class="btn02" style="left:108px; top:0px; width:52px; height:21px; ">
				<caption>행삽입</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
//						model.reset();		
					
						fnWithTaxSetting();
						
						fnParentSetting(childBody.datagrid1.row, "A");
						
						model.setFocus("srchslip_arow_no");
					]]>
				</script>
			</button>
			<button id="btn_delete" class="btn02" style="left:162px; top:0px; width:52px; height:21px; ">
				<caption>행삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[

						if (childBody.datagrid1.valueMatrix(childBody.datagrid1.row, 1) != "") {
							childBody.datagrid1.deleteRow(childBody.datagrid1.row);
							fn_GridToForm(childBody.datagrid1.row);
							model.setFocus("srchslip_arow_no");
						}

					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:396px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						window.close();		
//						formClose();		
					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" style="left:0px; top:0px; width:52px; height:21px; ">
				<caption>행입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[

						fnWithTaxSetting();

//						childBody.datagrid1.insertRow(childBody.datagrid1.row);
////						childBody.datagrid2.insertRow(childBody.datagrid1.row);
//
//						alert(childBody.datagrid1.rows);
//
//						childBody.datagrid1.row = childBody.datagrid1.rows - 1;
//						childBody.datagrid1.Col = 1;
//						srchslip_arow_no.value = childBody.datagrid1.Rows - 1;
//						srchslip_arow_no.value = srchslip_arow_no.value.GetZeroString(6);
//						
//						alert(childBody.datagrid1.row);
						
						fnParentSetting(childBody.datagrid1.row, "I");
						
						model.setFocus("srchslip_arow_no");
												
					]]>
				</script>
			</button>
			<button id="btn_update" class="btn02" style="left:54px; top:0px; width:52px; height:21px; ">
				<caption>행수정</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						fnWithTaxSetting();
						//debugger;
						if (fnParentSetting(childBody.datagrid1.row, "U")){;		
							model.setFocus("srchslip_arow_no");
						}
					]]>
				</script>
			</button>
			<button id="btn_draft_bal_open" class="btn04" style="left:306px; top:0px; width:88px; height:21px; ">
				<caption>기안잔액조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (draft_doc_no.value.Trim() != "") {
							
							model.property("FC_ACCT_2100_draft_doc_no")  = draft_doc_no.value;
		
							viewer("mainFrame").window.javaScript.onLoadExPopupPage("FC_ACCT_2100");

//							window.load("./FC_ACCT_2100.xrw"
//										, "modal"
//										, ""
//										, "align:center; width:958; height:760; sysmenu:visible; min:visible; max:true; resize:true; caption:hidden;")			
						}
						else {
							model.alert("기안문서번호는 필수입력사항입니다.");				
							return;
						}
					]]>
				</script>
			</button>
		</group>
	</xhtml:body>
</xhtml:html>
