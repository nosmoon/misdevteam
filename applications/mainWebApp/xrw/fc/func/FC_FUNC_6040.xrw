<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>정기예금해약등록(FC_FUNC_6040)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터 -->
						<session/>
						<!-- 서버의 세션 정보 -->
						<comboSet>
							<!-- 선택계열(콤보박스,체크박스,리스트박스,라디오버튼)의 정보 -->
							<fc_func_6040_m>
								<dataSet>
									<xx_deps_isav_stat_cd/>
									<xx_budg_cd_010/>
									<CURLIST1>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURLIST1>
									<CURLIST2>
										<record>
											<cd/>
											<cdnm/>
											<cd_abrv_nm/>
											<cdnm_cd/>
											<cdabrvnm_cd/>
										</record>
									</CURLIST2>
									<XX_BUDG_CD_LIST>
										<record>
											<budg_abrv_nm/>
											<budg_cd/>
										</record>
									</XX_BUDG_CD_LIST>
								</dataSet>
							</fc_func_6040_m>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo/>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영시 사용(화면ID등) -->
					</initData>
					<reqData>
						<!-- 서버에 전달하고자 하는 데이터 (submit시 처리) -->
						<fwdData>
						</fwdData>
						<!-- popup등의 페이지전환시 데이타 입출력에 사용 -->
						<searchData>
							<mtry_dt_fr/>
							<mtry_dt_to/>
							<flag>A</flag>
							<deps_isav_clsf_cd/>
							<deps_isav_no/>
						</searchData>
						<!-- 검색조건 처리 -->
						<reqform>
							<deps_isav_clsf_cd/>
							<deps_isav_no/>
							<recp_dt/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<upintsuigamt/>
							<uptotintamt/>
							<cost_gain_stot/>
							<rcpay_amt_stot/>
						</reqform>
						<!-- 입력처리 formData 복수사용시 하위노드로 1,2,3으로 정의-->
						<multiUpDate>
							<multiUpdateData/>
						</multiUpDate>
						<!-- Grid의 MultiUpDate유형 사용시 처리 -->
					</reqData>
					<resData>
						<!-- 서버로부터 전달 받은 데이터 (submit의 결과) -->
						<resform>
							<fc_func_6041_l>
								<dataSet>
									<CURLIST>
										<record>
											<deps_isav_nm/>
											<compnm/>
											<mtry_dt/>
											<tot_pymt_amt/>
											<hy_cctr_dt/>
											<hy_frex_cd/>
											<hy_exrate/>
											<hy_frex_amt/>
											<hy_impt_amt/>
											<hy_tot_int_amt/>
											<hy_corp_tax_amt/>
											<hy_def_tax_amt/>
											<hy_patr_budg_cd/>
											<hy_deps_clsf_cd/>
											<hy_rmks/>
											<cancel_frex_cd/>
											<cancel_exrate/>
											<cancel_frex_amt/>
											<cancel_won_pfls_amt/>
											<payment_frex_cd/>
											<payment_exrate/>
											<payment_frex_amt/>
											<payment_won_pfls_amt/>
											<deps_isav_clsf_cd/>
											<deps_isav_no/>
											<cost_gain_stot/>
											<rcpay_amt_stot/>
											<ijajanamt/>
											<prelae_pay_clsf_cd/>
											<comp_dt/>
											<dlco_clsf_cd/>
											<dlco_cd/>
											<rmks/>
											<jpno/>
											<deps_isav_stat_cdnm/>
											<hy_yejpno/>
											<hy_unrcp_precpt_bal/>
											<int_rate/>
											<deps_isav_stat_cd/>
											<cctr_dt/>
											<slip_occr_dt/>
											<slip_clsf_cd/>
											<slip_seq/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_func_6041_l>
							<fc_func_6042_l>
								<dataSet>
									<CURLIST>
										<record>
											<cost_gain_stot/>
											<rcpay_amt_stot/>
											<ijajanamt/>
											<prelae_pay_clsf_cd/>
											<deps_isav_nm/>
											<tot_pymt_amt/>
											<comp_dt/>
											<mtry_dt/>
											<dlco_clsf_cd/>
											<dlco_cd/>
											<compnm/>
											<rmks/>
											<jpno/>
											<deps_isav_stat_cdnm/>
											<hy_cctr_dt/>
											<hy_impt_amt/>
											<hy_corp_tax_amt/>
											<hy_patr_budg_cd/>
											<hy_deps_clsf_cd/>
											<hy_rmks/>
											<hy_yejpno/>
											<hy_tot_int_amt/>
											<hy_unrcp_precpt_bal/>
											<int_rate/>
											<hy_def_tax_amt/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_func_6042_l>
						</resform>
						<!-- (submit의 결과) formData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<gridData>
						</gridData>
						<!-- (submit의 결과) gridData 복수사용시 하위노드로 1,2,3으로 정의 -->
						<MsgData/>
						<!-- (submit의 결과) 전달 받은 MsgData -->
					</resData>
					<tempData>
						<!-- 데이터를 가공할 임시저장소 -->
						<!-- 해당화면의 키값등의 데이터의 저장소 -->
						<keyData/>
						<hyjpno/>
						<frexcd/>
						<frexamt/>
						<hyimptamt/>
						<hyunrcpprecptbal/>
					</tempData>
				</root>
			</instance>
			<script type="javascript" src="../../../js/TFCommon.js"/>
			<script type="javascript" src="../../../js/CIISComm.js"/>
			<script type="javascript" src="../../../js/fcmc_common.js"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					set_default(datagrid1);
				]]>
			</script>
			<submission id="fc_func_6040_m" action="/fc/func6000/6040" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" resultref="/root/initData/comboSet/fc_func_6040_m/dataSet"/>
			<submission id="fc_func_6041_l" action="/fc/func6000/6041" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/resData/resform/fc_func_6041_l/dataSet"/>
			<submission id="fc_func_6042_l" action="/fc/func6000/6042" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/resData/resform/fc_func_6042_l/dataSet"/>
			<submission id="fc_func_6043_i" action="/fc/func6000/6043" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/multiUpDate" resultref="/root/resData/MsgData"/>
			<submission id="fc_func_6044_d" action="/fc/func6000/6044" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/reqform" resultref="/root/resData/MsgData"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
				
					send_fc_func_6040_m();
					// /root/initData/comboSet/fc_func_6040_m/dataSet/XX_BUDG_CD_LIST
					//alert(model1.getValue("/root/initData/comboSet/fc_func_6040_m/dataSet/xx_deps_isav_stat_cd"));
					//alert(model1.getValue("/root/initData/comboSet/fc_func_6040_m/dataSet/xx_budg_cd_010"));
											
					makeComboGubun("","/root/initData/comboSet/fc_func_6040_m/dataSet/XX_BUDG_CD_LIST","record","budg_abrv_nm", "budg_cd");
					model.refresh();
				]]>
			</script>
		</model>
		<xhtml:style id="style1">
			<![CDATA[]]>
		</xhtml:style>
		<script type="javascript">
			<![CDATA[
				var	_oth_clsf = "1";
				
				function send_fc_func_6040_m(){
					model1.send("fc_func_6040_m");
					makeComboGubun("","/root/initData/comboSet/fc_func_6040_m/dataSet/CURLIST2","record","cdabrvnm_cd", "cd");
				}
				function send_fc_func_6041_l(){
					if (!commReqCheck(group_scr)) {return false;}
					if(mtry_dt_fr.value>mtry_dt_to.value){
						show_message("시작일자는 종료일자를 초과할 수 없습니다.");
						return false;
					}
					model1.send("fc_func_6041_l");
					totalcnt = model.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/totalcnt");
					if (totalcnt == 0) {
						reset_model(true);
						show_message("검색결과가 없습니다.");
						return false;
					}
					for(i=1;i<datagrid1.rows;i++){
						var patrbudgcd = model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+i+"]/hy_patr_budg_cd");
						//if(patrbudgcd == "001100"){
						if(patrbudgcd == model1.getValue("/root/initData/comboSet/fc_func_6040_m/dataSet/xx_budg_cd_010")){
							datagrid1.isReadOnly(i, 13) = true;
						}else{
							datagrid1.isReadOnly(i, 13) = false;
						}
//						alert(model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+i+"]/deps_isav_stat_cd"));
						//if(model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+i+"]/deps_isav_stat_cd") != "1"){
						if(model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+i+"]/deps_isav_stat_cd") != model1.getValue("/root/initData/comboSet/fc_func_6040_m/dataSet/xx_deps_isav_stat_cd")){
							datagrid1.isReadOnly(i, 1,i,14) = true;
							datagrid1.rowstyle(i, "data", "background-color") = DEFAULT_DATAGRID_BG_COLOR_DISABLE;
						}else{
							datagrid1.isReadOnly(i, 1,i,14) = false;
							datagrid1.rowstyle(i, "data", "background-color") = "white";
						}
					}
				}
				function send_fc_func_6042_l(grow){
					hyjpno.value				=	model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+grow+"]/hy_yejpno");
					frexcd.value				=	model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+grow+"]/hy_frex_cd");
					frexamt.value				=	model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+grow+"]/hy_frex_amt");
					hyimptamt.value			=	model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+grow+"]/hy_tot_int_amt");
					hyunrcpprecptbal.value		=	model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+grow+"]/hy_unrcp_precpt_bal");
					group7.refresh();
					model1.setValue("/root/reqData/searchData/deps_isav_clsf_cd",model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+grow+"]/deps_isav_clsf_cd"));
					model1.setValue("/root/reqData/searchData/deps_isav_no",model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+grow+"]/deps_isav_no"));
					model1.send("fc_func_6042_l");
				}
				function send_fc_func_6043_i(){
					if(mtry_dt_fr.value==""&&mtry_dt_to.value==""&&model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/totalcnt")==""){
						show_message("처리할 수 없는 자료입니다. [선 조회후 작업가능]");
						return false;
					}
					if(!commGridReqCheck("datagrid1")) {
						return false;
					}					
					//alert(datagrid1.getUpdateData());
					model.setValue("/root/reqData/multiUpDate/multiUpdateData", datagrid1.getUpdateData());
					model1.send("fc_func_6043_i");
					return check_submit_completed("저장되었습니다.","");
				}
				function changedvalue(grow){
					var patrbudgcd = model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+grow+"]/hy_patr_budg_cd");
					//if(patrbudgcd == "001100"){
					if(patrbudgcd == model1.getValue("/root/initData/comboSet/fc_func_6040_m/dataSet/xx_budg_cd_010")){
						datagrid1.isReadOnly(grow, 13) = true;
					}else{
						datagrid1.isReadOnly(grow, 13) = false;
					}
				}
				function reset_model(p_save) {
					var temp_mtry_dt_fr = mtry_dt_fr.value;
					var temp_mtry_dt_to = mtry_dt_to.value;
					var temp_flag = flag.value;
					
					model.reset();
				
					if (p_save) {
						mtry_dt_fr.value = temp_mtry_dt_fr;
						mtry_dt_to.value = temp_mtry_dt_to;
						flag.value = temp_flag;
					}
				}
				function send_fc_func_6064_d(){
					if(mtry_dt_fr.value==""&&mtry_dt_to.value==""&&model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/totalcnt")==""){
						show_message("처리할 수 없는 자료입니다. [선 조회후 작업가능]");
						return false;
					}
					if(model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+datagrid1.row+"]/hy_cctr_dt")==""){
						show_message("해약일 은(는) 필수입력항목입니다.");
						return false;
					}
					model1.setValue("/root/reqData/reqform/deps_isav_clsf_cd",model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+datagrid1.row+"]/deps_isav_clsf_cd"));
					model1.setValue("/root/reqData/reqform/deps_isav_no",model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+datagrid1.row+"]/deps_isav_no"));
					model1.setValue("/root/reqData/reqform/recp_dt",model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+datagrid1.row+"]/hy_cctr_dt"));
					model1.setValue("/root/reqData/reqform/slip_occr_dt",model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+datagrid1.row+"]/slip_occr_dt"));
					model1.setValue("/root/reqData/reqform/slip_clsf_cd",model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+datagrid1.row+"]/slip_clsf_cd"));
					model1.setValue("/root/reqData/reqform/slip_seq",model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+datagrid1.row+"]/slip_seq"));
					model1.setValue("/root/reqData/reqform/upintsuigamt",-model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+datagrid1.row+"]/hy_tot_int_amt"));
					model1.setValue("/root/reqData/reqform/uptotintamt",eval(hyunrcpprecptbal.value)-eval(model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+datagrid1.row+"]/hy_tot_int_amt")));
					model1.setValue("/root/reqData/reqform/cost_gain_stot",cost_gain_stot.value);
					model1.setValue("/root/reqData/reqform/rcpay_amt_stot",rcpay_amt_stot.value);
					
					if (show_message("삭제하시겠습니까?","삭제 확인",MB_YESNO) != IDYES) {
					return false;
					}
					model.send("fc_func_6044_d");
					return check_submit_completed("삭제되었습니다.","");
				}
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="2,51;1,936;1,10;2,5;2,734;2,90;2,104;2,721;">
		<group id="group_scr" class="gro_sel" style="left:10px; top:49px; width:926px; height:27px; ">
			<caption id="caption2" class="list_cap03" style="left:0px; top:0px; width:100px; height:26px; text-align:center; ">만기일</caption>
			<caption id="caption3" class="list_cap02" style="left:99px; top:0px; width:822px; height:26px; text-align:center; "/>
			<caption id="caption4" autoresize="true" style="left:191px; top:7px; width:12px; height:20px; ">~</caption>
			<input id="mtry_dt_fr" ref="/root/reqData/searchData/mtry_dt_fr" class="req" inputtype="date" caption="만기시작일" style="left:102px; top:5px; width:85px; height:18px; "/>
			<input id="mtry_dt_to" ref="/root/reqData/searchData/mtry_dt_to" class="req" inputtype="date" caption="만기종료일" style="left:206px; top:5px; width:85px; height:18px; "/>
			<select1 id="flag" ref="/root/reqData/searchData/flag" appearance="full" cols="3" overflow="visible" style="left:315px; top:5px; width:160px; height:18px; border-style:none; ">
				<choices>
					<item>
						<label>전체</label>
						<value>A</value>
					</item>
					<item>
						<label>미해약</label>
						<value>1</value>
					</item>
					<item>
						<label>해약</label>
						<value>2</value>
					</item>
				</choices>
			</select1>
			<caption id="caption29" style="left:640px; top:4px; width:280px; height:20px; font-weight:bold; ">수입금액=총불입액+(수입이자-법인세-소득세)</caption>
		</group>
		<group id="group1" class="gro_line" style="left:10px; top:81px; width:926px; height:5px; "/>
		<datagrid id="datagrid1" nodeset="/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record" caption="예적금명^거래처명^만기일자^총불입액^해약일^외환코드^해약환율^외화금액^수입금액^수입이자^법인세^법인지방소득세^상대예산^예금구분코드^적요^해약_외환코드^해약_환율^해약_외화금액^해약_원화손익금액^불입_외환코드^불입_환율^불입_외화금액^불입_원화손익금액^예적금구분코드^예적금번호^비용수익합계^수불금액합계^비용수익합계-수불금액합계^선후급구분코드^기산일자^거래처구분코드^거래처코드^적요^전표번호(예적금불입)^예적금상태코드^해약전표번호^미수선수잔액^이율^예적금상태코드^수령일^SLIP_OCCR_DT^SLIP_CLSF_CD^SLIP_SEQ" colsep="#" colwidth="100, 100, 100, 100, 100, 90, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:8px; top:90px; width:928px; height:244px; ">
			<col ref="deps_isav_nm" style="left:0px; top:20px; width:100px; height:20px; "/>
			<col ref="compnm"/>
			<col ref="mtry_dt" format="yyyy-mm-dd"/>
			<col ref="tot_pymt_amt" format="(-)#,###" style="text-align:right; "/>
			<col class="req" ref="hy_cctr_dt" type="inputdate" caption="해약일"/>
			<col ref="hy_frex_cd"/>
			<col ref="hy_exrate" type="input"/>
			<col ref="hy_frex_amt" format="(-)#,###" style="text-align:right; "/>
			<col class="req" ref="hy_impt_amt" type="input" format="(-)#,###" caption="수입금액" style="text-align:right; "/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
						
						hyimptamt.value = model1.getValue("/root/resData/resform/fc_func_6041_l/dataSet/CURLIST/record["+datagrid1.row+"]/hy_tot_int_amt");
					]]>
			</script>
			<col class="req" ref="hy_tot_int_amt" type="input" format="(-)#,###" caption="수입이자" style="text-align:right; "/>
			<col class="req" ref="hy_corp_tax_amt" type="input" format="(-)#,###" caption="법인세" style="text-align:right; "/>
			<col class="req" ref="hy_def_tax_amt" type="input" format="(-)#,###" caption="법인지방소득세" style="text-align:right; "/>
			<col class="req" ref="hy_patr_budg_cd" type="combo" caption="상대예산" style="text-align:center; ">
				<choices>
					<!--
					<item>
						<label/>
						<value/>
					</item>
					<item>
						<label>001100 현금</label>
						<value>001100</value>
					</item>
					<item>
						<label>011400 보통예금</label>
						<value>011400</value>
					</item>
					-->
					<itemset nodeset="/root/initData/comboSet/fc_func_6040_m/dataSet/XX_BUDG_CD_LIST/record">
						<label ref="budg_abrv_nm"/>
						<value ref="budg_cd"/>
					</itemset>
				</choices>
			</col>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					changedvalue(datagrid1.row);
				]]>
			</script>
			<col editmode="inputsearch" ref="hy_deps_clsf_cd" type="combo" caption="예금구분코드" style="left:1210px; top:20px; width:100px; height:20px; text-align:left; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/fc_func_6040_m/dataSet/CURLIST2/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</col>
			<col ref="hy_rmks" type="input"/>
			<col ref="cancel_frex_cd" visibility="hidden"/>
			<col ref="cancel_exrate" visibility="hidden"/>
			<col ref="cancel_frex_amt" visibility="hidden"/>
			<col ref="cancel_won_pfls_amt" visibility="hidden"/>
			<col ref="payment_frex_cd" visibility="hidden"/>
			<col ref="payment_exrate" visibility="hidden"/>
			<col ref="payment_frex_amt" visibility="hidden"/>
			<col ref="payment_won_pfls_amt" visibility="hidden"/>
			<col ref="deps_isav_clsf_cd" visibility="hidden"/>
			<col ref="deps_isav_no" visibility="hidden"/>
			<col ref="cost_gain_stot" visibility="hidden"/>
			<col ref="rcpay_amt_stot" visibility="hidden"/>
			<col ref="ijajanamt" visibility="hidden"/>
			<col ref="prelae_pay_clsf_cd" visibility="hidden"/>
			<col ref="comp_dt" visibility="hidden"/>
			<col ref="dlco_clsf_cd" visibility="hidden"/>
			<col ref="dlco_cd" visibility="hidden"/>
			<col ref="rmks" visibility="hidden"/>
			<col ref="jpno" visibility="hidden"/>
			<col ref="deps_isav_stat_cdnm" visibility="hidden"/>
			<col ref="hy_yejpno" visibility="hidden"/>
			<col ref="hy_unrcp_precpt_bal" visibility="hidden"/>
			<col ref="int_rate" visibility="hidden"/>
			<col ref="deps_isav_stat_cd" visibility="hidden"/>
			<col ref="cctr_dt" visibility="hidden"/>
			<col ref="slip_occr_dt" visibility="hidden"/>
			<col ref="slip_clsf_cd" visibility="hidden"/>
			<col ref="slip_seq" visibility="hidden"/>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[					
					var i = datagrid1.row;
				
					var ch_colref = datagrid1.colRef("hy_deps_clsf_cd");
					if(datagrid1.col == ch_colref){
						var ch_var = datagrid1.valueMatrix(i,ch_colref);
						if(grid_combo_data_contains(ch_var,"/root/initData/comboSet/fc_func_6040_m/dataSet/CURLIST2/record","cd") == -1){
							show_message("정확한 값을 선택해 주세요.");
							datagrid1.valueMatrix(i,ch_colref) = "";
							return;
						}
					}
				]]>
			</script>
			<script type="javascript" ev:event="ondblclick">
				<![CDATA[
					//그리드 스크롤바 클릭, 더블클릭 방지 소스
					if (-1 != event.target.lastIndexOf("scroll.thumb")) {
						return;
					}
					
					if (datagrid1.mouseRow < 1) {
						return;
					}
					
					var grid = eval(event.currentTarget);
					var rowid = grid.row;
					var colid = grid.col;
					
					if (rowid < grid.fixedRows || colid < grid.fixedCols) {
						return;
					}

					send_fc_func_6042_l(datagrid1.row);
				]]>
			</script>
		</datagrid>
		<group id="group3" class="gro_tab" style="left:10px; top:530px; width:926px; height:25px; ">
			<caption id="caption5" class="sub_title" style="left:10px; top:0px; width:222px; height:20px; ">예금관련</caption>
			<caption id="caption6" class="tabline" style="left:0px; top:22px; width:925px; height:1px; "/>
		</group>
		<group id="group5" class="gro_tab" style="left:10px; top:554px; width:926px; height:160px; ">
			<caption id="caption37" class="list_cap02" style="left:99px; top:100px; width:824px; height:26px; "/>
			<caption id="caption36" class="list_cap02" style="left:99px; top:75px; width:824px; height:26px; "/>
			<caption id="caption35" class="list_cap02" style="left:99px; top:50px; width:824px; height:26px; "/>
			<caption id="caption34" class="list_cap02" style="left:99px; top:25px; width:824px; height:26px; "/>
			<caption id="caption33" class="list_cap02" style="left:99px; top:0px; width:824px; height:26px; "/>
			<caption id="caption12" class="list_cap03" style="left:0px; top:0px; width:100px; height:26px; ">예금명</caption>
			<input id="deps_isav_nm" ref="/root/resData/resform/fc_func_6042_l/dataSet/CURLIST/record/deps_isav_nm" navindex="-1" editable="false" style="left:105px; top:3px; width:245px; height:18px; "/>
			<caption id="caption7" class="list_cap03" style="left:0px; top:25px; width:100px; height:26px; ">예금금액</caption>
			<input id="tot_pymt_amt" ref="/root/resData/resform/fc_func_6042_l/dataSet/CURLIST/record/tot_pymt_amt" navindex="-1" editable="false" format="(-)#,###" style="left:105px; top:29px; width:136px; height:18px; text-align:right; "/>
			<input id="comp_dt" ref="/root/resData/resform/fc_func_6042_l/dataSet/CURLIST/record/comp_dt" navindex="-1" editable="false" format="yyyy-mm-dd" style="left:105px; top:54px; width:76px; height:18px; "/>
			<caption id="caption8" class="list_cap03" style="left:0px; top:50px; width:100px; height:26px; ">기산일</caption>
			<caption id="caption9" class="list_cap03" style="left:0px; top:75px; width:100px; height:26px; ">전표번호</caption>
			<input id="jpno" ref="/root/resData/resform/fc_func_6042_l/dataSet/CURLIST/record/jpno" navindex="-1" editable="false" format="99999999-99-999" style="left:105px; top:79px; width:125px; height:18px; "/>
			<caption id="caption10" class="list_cap03" style="left:0px; top:100px; width:100px; height:26px; ">적요</caption>
			<input id="rmks" ref="/root/resData/resform/fc_func_6042_l/dataSet/CURLIST/record/rmks" navindex="-1" editable="false" style="left:105px; top:104px; width:781px; height:18px; "/>
			<caption id="caption11" class="list_cap03" style="left:456px; top:0px; width:100px; height:26px; ">거래처</caption>
			<input id="dlco_clsf_cd" ref="/root/resData/resform/fc_func_6042_l/dataSet/CURLIST/record/dlco_clsf_cd" navindex="-1" editable="false" style="left:561px; top:3px; width:99px; height:18px; "/>
			<input id="int_rate" ref="/root/resData/resform/fc_func_6042_l/dataSet/CURLIST/record/int_rate" navindex="-1" editable="false" format="(-)#,###.##" style="left:561px; top:29px; width:49px; height:18px; text-align:right; "/>
			<caption id="caption13" class="list_cap03" style="left:456px; top:25px; width:100px; height:26px; ">이율</caption>
			<caption id="caption14" class="list_cap03" style="left:456px; top:50px; width:100px; height:26px; ">만기일</caption>
			<input id="mtry_dt" ref="/root/resData/resform/fc_func_6042_l/dataSet/CURLIST/record/mtry_dt" navindex="-1" editable="false" format="yyyy-mm-dd" style="left:561px; top:54px; width:76px; height:18px; "/>
			<caption id="caption15" class="list_cap03" style="left:456px; top:75px; width:100px; height:26px; ">현재상태</caption>
			<input id="deps_isav_stat_cdnm" ref="/root/resData/resform/fc_func_6042_l/dataSet/CURLIST/record/deps_isav_stat_cdnm" navindex="-1" editable="false" style="left:561px; top:79px; width:180px; height:18px; "/>
			<input id="dlco_cd" ref="/root/resData/resform/fc_func_6042_l/dataSet/CURLIST/record/dlco_cd" navindex="-1" editable="false" style="left:666px; top:3px; width:84px; height:18px; "/>
			<input id="compnm" ref="/root/resData/resform/fc_func_6042_l/dataSet/CURLIST/record/compnm" navindex="-1" editable="false" style="left:756px; top:3px; width:154px; height:18px; "/>
		</group>
		<group id="group2" class="gro_tab" style="left:10px; top:435px; width:926px; height:25px; ">
			<caption id="caption16" class="sub_title" style="left:10px; top:0px; width:222px; height:20px; ">발생이자</caption>
			<caption id="caption17" class="tabline" style="left:0px; top:22px; width:925px; height:1px; "/>
		</group>
		<group id="group4" class="gro_tab" style="left:10px; top:464px; width:926px; height:54px; ">
			<caption id="caption32" class="list_cap02" style="left:99px; top:26px; width:824px; height:26px; "/>
			<caption id="caption31" class="list_cap02" style="left:99px; top:1px; width:824px; height:26px; "/>
			<caption id="caption18" class="list_cap03" style="left:0px; top:1px; width:100px; height:26px; ">이자발생</caption>
			<input id="cost_gain_stot" ref="/root/resData/resform/fc_func_6042_l/dataSet/CURLIST/record/cost_gain_stot" navindex="-1" editable="false" format="(-)#,###" style="left:105px; top:6px; width:136px; height:18px; text-align:right; "/>
			<caption id="caption19" class="list_cap03" style="left:0px; top:26px; width:100px; height:26px; ">이자잔액</caption>
			<input id="ijajanamt" ref="/root/resData/resform/fc_func_6042_l/dataSet/CURLIST/record/ijajanamt" navindex="-1" editable="false" format="(-)#,###" style="left:105px; top:30px; width:136px; height:18px; text-align:right; "/>
			<caption id="caption23" class="list_cap03" style="left:456px; top:1px; width:100px; height:26px; ">이자수입</caption>
			<input id="rcpay_amt_stot" ref="/root/resData/resform/fc_func_6042_l/dataSet/CURLIST/record/rcpay_amt_stot" navindex="-1" editable="false" format="(-)#,###" style="left:561px; top:5px; width:99px; height:18px; text-align:right; "/>
			<input id="prelae_pay_clsf_cd" ref="/root/resData/resform/fc_func_6042_l/dataSet/CURLIST/record/prelae_pay_clsf_cd" navindex="-1" editable="false" style="left:561px; top:30px; width:99px; height:18px; "/>
			<caption id="caption24" class="list_cap03" style="left:456px; top:26px; width:100px; height:26px; ">선후급</caption>
		</group>
		<group id="group6" class="gro_tab" style="left:10px; top:341px; width:926px; height:25px; ">
			<caption id="caption20" class="sub_title" style="left:10px; top:0px; width:222px; height:20px; ">전표번호 외</caption>
			<caption id="caption21" class="tabline" style="left:0px; top:22px; width:925px; height:1px; "/>
		</group>
		<group id="group7" class="gro_tab" style="left:10px; top:365px; width:926px; height:59px; ">
			<caption id="caption1" class="list_cap02" style="left:100px; top:31px; width:824px; height:26px; "/>
			<caption id="caption113" class="list_cap02" style="left:100px; top:6px; width:824px; height:26px; "/>
			<caption id="caption22" class="list_cap03" style="left:1px; top:6px; width:100px; height:26px; ">전표번호</caption>
			<input id="hyjpno" ref="/root/tempData/hyjpno" navindex="-1" editable="false" format="99999999-99-999" style="left:105px; top:10px; width:161px; height:18px; "/>
			<caption id="caption25" class="list_cap03" style="left:1px; top:31px; width:100px; height:26px; ">총이자</caption>
			<input id="hyimptamt" ref="/root/tempData/hyimptamt" navindex="-1" editable="false" format="(-)#,###" style="left:105px; top:35px; width:161px; height:18px; text-align:right; "/>
			<caption id="caption26" class="list_cap03" style="left:385px; top:6px; width:100px; height:26px; ">외화금액</caption>
			<caption id="caption27" class="list_cap03" style="left:385px; top:31px; width:100px; height:26px; ">미수선수</caption>
			<input id="frexamt" ref="/root/tempData/frexamt" navindex="-1" editable="false" format="(-)#,###" style="left:490px; top:10px; width:135px; height:18px; text-align:right; "/>
			<input id="hyunrcpprecptbal" ref="/root/tempData/hyunrcpprecptbal" navindex="-1" editable="false" format="(-)#,###" style="left:490px; top:35px; width:135px; height:18px; text-align:right; "/>
			<caption id="caption28" class="list_cap03" style="left:655px; top:6px; width:100px; height:26px; ">기타세</caption>
			<input id="input25" navindex="-1" editable="false" format="(-)#,###" style="left:760px; top:10px; width:135px; height:18px; text-align:right; "/>
			<caption id="caption30" class="list_cap03" style="left:269px; top:6px; width:70px; height:26px; ">외환코드</caption>
			<input id="frexcd" ref="/root/tempData/frexcd" navindex="-1" editable="false" style="left:345px; top:10px; width:30px; height:18px; "/>
		</group>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:734px; width:926px; height:21px; ">
			<button id="btnReset" class="btn02" navindex="45" style="left:165px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
//						for(var i=1;i<datagrid1.rows;i++){
//							if(datagrid1.rowStatus(i)=="2"){
//								show_message("수정중인 자료가 있습니다.");
//								return false;
//							}
//						}
						model.reset();
					
					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" navindex="42" crud="C" style="left:55px; top:0px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if (send_fc_func_6043_i()) btn_select.dispatch("onclick");
					]]>
				</script>
			</button>
			<button id="btn_delete" class="btn02" navindex="44" crud="D" style="left:110px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					if (send_fc_func_6064_d()) btn_select.dispatch("onclick");
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" navindex="47" style="left:330px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose();		
					]]>
				</script>
			</button>
			<button id="btn_select" class="btn02" navindex="41" crud="R" style="left:0px; top:0px; ">
				<caption>조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_fc_func_6041_l();
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" navindex="46" crud="R" style="left:275px; top:0px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
					]]>
				</script>
			</button>
			<button id="btn_print" class="btn02" style="left:220px; top:0px; width:52px; height:21px; ">
				<caption>전표출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var ch_no = get_refvalue(hyjpno);
					if(ch_no == ""){
						show_message("전표번호가 없습니다.");
						return false;
					}
					// 글로벌변수 셋팅
					if(ch_no.length == 13){
						model.property("FC_ACCT_2260_slip_occr_dt")  = ch_no.substring(0, 8);			// 발생일자
						model.property("FC_ACCT_2260_slip_clsf_cd")  = ch_no.substring(8, 10);			// 전표구분
						model.property("FC_ACCT_2260_slip_seqfr") = ch_no.substring(10, 13);			// 일련번호 from
						model.property("FC_ACCT_2260_slip_seqto") = ch_no.substring(10, 13);			// 일련번호 to
						model.property("FC_ACCT_2260_slip_radio1") = "";			// 출력구분
						model.property("FC_ACCT_2260_popup_flag")  = "Y";
					}else{
						model.property("FC_ACCT_2260_slip_occr_dt")  = ch_no.substring(0, 8);			// 발생일자
						model.property("FC_ACCT_2260_slip_clsf_cd")  = ch_no.substring(9, 11);			// 전표구분
						model.property("FC_ACCT_2260_slip_seqfr") = ch_no.substring(12, 15);			// 일련번호 from
						model.property("FC_ACCT_2260_slip_seqto") = ch_no.substring(12, 15);			// 일련번호 to
						model.property("FC_ACCT_2260_slip_radio1") = "";			// 출력구분
						model.property("FC_ACCT_2260_popup_flag")  = "Y";
					}
					
					// 화면호출
					//viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2260", "modal", "align:center; caption:hidden; width:650px; height:480px;");
					viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2260");
					]]>
				</script>
			</button>
		</group>
	</xhtml:body>
</xhtml:html>
