<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:my="http://www.comsquare.co.kr/example" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>받을어음추심등록(FC_FUNC_1050)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<session>
						</session>
						<comboSet>
							<dataSet>
								<xx_now_note_stat_cd/>
								<xx_note_clsf_cd/>
								<xx_stat_cd/>
								<xx_mang_cd_4/>
								<DEPS_CLSF_CD2>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</DEPS_CLSF_CD2>
								<DEPS_CLSF_CD1>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</DEPS_CLSF_CD1>
								<FREX_CD>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</FREX_CD>
								<CURDLCO_CLSF_CD>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</CURDLCO_CLSF_CD>
							</dataSet>
						</comboSet>
						<pageInfo/>
					</initData>
					<reqData>
						<fwdData/>
						<search>
							<stat_dt/>
							<!--<now_note_stat_cd>02</now_note_stat_cd>-->
							<now_note_stat_cd/>
							<mtry_dt/>
							<dlco_clsf_cd/>
							<dlco_cd/>
							<note_clsf_cd/>
							<stat_cd/>
							<pch_sql/>
							<radio1>0</radio1>
							<kind/>
						</search>
						<reqform>
							<stat_dt/>
							<stat_cd/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<pch_count/>
						</reqform>
						<multiUpdate>
							<cmpy_cd/>
							<stat_dt/>
							<dlco_clsf_cd/>
							<dlco_cd/>
							<pch_compnm/>
							<rmks1/>
							<deps_clsf_cd/>
							<frex_cd/>
							<exrate/>
							<deps_dt/>
							<deps_dt1/>
							<hjphwamt/>
							<tran_amt/>
							<multiUpdateData/>
							<biz_reg_no/>
							<bank_id/>
							<acct_num/>
							<tran_date/>
							<tran_date_seq/>
							<current_clsf/>
						</multiUpdate>
					</reqData>
					<resData>
						<gridData>
							<fc_func_1051_l>
								<dataSet>
									<CURLIST>
										<record>
											<note_clsf_cd_nm/>
											<note_no/>
											<mtry_dt/>
											<note_amt/>
											<frex_amt/>
											<note_amt2/>
											<coms/>
											<eeik_amt/>
											<slip_no/>
											<issu_pers_nm/>
											<compnm/>
											<note_clehous_cd_nm/>
											<now_note_stat_cd_nm/>
											<compnm2/>
											<comp_dt/>
											<bank_cd/>
											<note_seq/>
											<note_clsf_cd/>
											<now_note_stat_cd/>
											<note_clehous_cd/>
											<dlco_clsf_cd/>
											<dlco_cd/>
											<dlco_clsf_cd1/>
											<dlco_cd1/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_func_1051_l>
							<fc_func_1052_l>
								<dataSet>
									<CURLIST>
										<record>
											<note_clsf_cd_nm/>
											<note_no/>
											<mtry_dt/>
											<note_amt/>
											<frex_amt/>
											<rcpay_amt/>
											<coms/>
											<eeik_amt/>
											<slipno/>
											<issu_pers_nm/>
											<compnm2/>
											<note_clehous_cd_nm/>
											<now_note_stat_cd_nm/>
											<bank_nm/>
											<dlco_clsf_cd/>
											<dlco_cd/>
											<note_clehous_cd/>
											<now_note_stat_cd/>
											<compnm/>
											<note_clsf_cd/>
											<dlco_clsf_cd1/>
											<dlco_cd1/>
											<slip_occr_dt/>
											<slip_clsf_cd/>
											<slip_seq/>
											<slip_sub_seq/>
											<slip_arow_no/>
											<frex_cd/>
											<exrate/>
											<bank_cd/>
											<note_seq/>
											<biz_reg_no/>
											<bank_id/>
											<acct_num/>
											<tran_date_seq/>
											<current_clsf/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_func_1052_l>
							<fc_func_1053_i>
								<dataSet>
									<CURLIST>
										<record>
											<slip_occr_dt/>
											<slip_clsf_cd/>
											<slip_seq/>
											<slip_no/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_func_1053_i>
						</gridData>
						<msg/>
						<resform>
							<totalsum/>
							<selectAll/>
							<jpno/>
							<noteamttot/>
							<acct_mang_no/>
							<biz_reg_no/>
							<bank_id/>
							<acct_num/>
							<tran_date/>
							<tran_date_seq/>
							<current_clsf/>
							<tran_amt1/>
						</resform>
					</resData>
				</root>
			</instance>
			<script type="javascript" src="../../../js/TFCommon.js"/>
			<script type="javascript" src="../../../js/CIISComm.js"/>
			<script type="javascript" src="../../../js/fcmc_common.js"/>
			<submission id="fc_func_1050_m" action="/fc/func1000/1050" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/search" resultref="/root/initData/comboSet/dataSet"/>
			<submission id="fc_func_1051_l" action="/fc/func1000/1051" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/search" resultref="/root/resData/gridData/fc_func_1051_l/dataSet"/>
			<submission id="fc_func_1052_l" action="/fc/func1000/1052" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/search" resultref="/root/resData/gridData/fc_func_1052_l/dataSet"/>
			<submission id="fc_func_1053_i" action="/fc/func1000/1053" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/multiUpdate" resultref="/root/resData/gridData/fc_func_1053_i/dataSet"/>
			<submission id="fc_func_1054_d" action="/fc/func1000/1054" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/reqform" resultref="/root/resData/msg"/>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					set_default(datagrid1,datagrid2);
				]]>
			</script>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					model1.send("fc_func_1050_m");
					makeComboGubun("", "/root/initData/comboSet/dataSet/DEPS_CLSF_CD2", "record", "cd_nm", "cd");
					makeComboGubun("", "/root/initData/comboSet/dataSet/DEPS_CLSF_CD1", "record", "cd_nm", "cd");
					makeComboGubun("", "/root/initData/comboSet/dataSet/FREX_CD", "record", "cd_nm", "cd");
					makeComboGubun("", "/root/initData/comboSet/dataSet/CURDLCO_CLSF_CD", "record", "cd_nm", "cd");					
					srch_dlco_clsf_cd.select(1);
					//alert(model1.getValue("/root/initData/comboSet/dataSet/xx_now_note_stat_cd")); //02
					//alert(model1.getValue("/root/initData/comboSet/dataSet/xx_note_clsf_cd"));  //1051
					//alert(model1.getValue("/root/initData/comboSet/dataSet/xx_stat_cd"));	//05
					//alert(model1.getValue("/root/initData/comboSet/dataSet/xx_mang_cd_4"));	//H1
					model1.setValue("/root/reqData/search/now_note_stat_cd",model1.getValue("/root/initData/comboSet/dataSet/xx_now_note_stat_cd"));
					model1.refresh();
				]]>
			</script>
		</model>
		<script type="javascript">
			<![CDATA[
				var	_oth_clsf = "1";
				
				function nullCheck() {
					if (model.getValue("/root/reqData/search/stat_dt") == "") {
						show_message("추심일  필수 입력 항목입니다.");
						return false;
						model.setFocus("stat_dt");
					} 
					if(model.getValue("/root/reqData/search/mtry_dt") == "") {
						show_message("만기일은 필수 입력 항목입니다.");
						return false;
						model.setFocus("mtry_dt");
					}
					
					if(model.getValue("/root/reqData/search/dlco_cd") != ""){
						if(model.getValue("/root/reqData/search/dlco_cd") == ""){
							show_message("거래처코드 입력시 거래처구분은 필수 입력 항목입니다.");
							return false;
							model.setFocus("dlco_cd");
						}
					}
						return true;
				 }
					
				function nullCheck2() {
					if (model.getValue("/root/reqData/search/stat_dt") == "") {
						show_message("추심일은  필수 입력 항목입니다.");
						return false;
						model.setFocus("stat_dt");
					}else if(model.getValue("/root/reqData/search/dlco_cd") != ""){
						if(model.getValue("/root/reqData/search/dlco_clsf_cd") == ""){
							show_message("거래초 코드 입력 시 거래처구분은 필수 입력 항목입니다.");
							return false;
							model.setFocus("dlco_cd");
						}
					}
						return true;
				 }
				 function nullCheck3() {
					if (model.getValue("/root/reqData/search/stat_dt") == "") {
						show_message("추심일은  필수 입력 항목입니다.");
						return false;
						model.setFocus("stat_dt");
					}else if(model.getValue("/root/reqData/search/dlco_clsf_cd") == "") {
						show_message("거래처구분은 필수 입력 항목입니다.");
						return false;
						model.setFocus("dlco_clsf_cd");
					}else if(model.getValue("/root/reqData/search/dlco_cd") == "") {
						show_message("거래처코드는 필수 입력 항목입니다.");
						return false;
						model.setFocus("dlco_cd");
					}else if(model.getValue("/root/reqData/multiUpdate/deps_clsf_cd") == "") {
						show_message("예금구분은 필수 입력 항목입니다.");
						return false;
						model.setFocus("deps_clsf_cd");
					}
					if(radio1.value=="1"){
						if (model.getValue("/root/reqData/multiUpdate/frex_cd") == "") {
							show_message("외화입력시 외환코드  필수 입력 항목입니다.");
							return false;
							model.setFocus("frex_cd");
						}else if(model.getValue("/root/reqData/multiUpdate/exrate") == "") {
							show_message("외화입력시 환율은 필수 입력 항목입니다.");
							return false;
							model.setFocus("exrate");
						}else if(model.getValue("/root/reqData/multiUpdate/hjphwamt") == "") {
							show_message("외화입력시 외화입금은 필수 입력 항목입니다.");
							return false;
							model.setFocus("hjphwamt");
						}
					}
						return true;
				 }
				 function nullCheck4() {
					if (model.getValue("/root/reqData/search/stat_dt") == "") {
						show_message("추심일은  필수 입력 항목입니다.");
						return false;
						model.setFocus("stat_dt");
					}
						return true;
				 }
				 function send_fc_func_1051_l(){
					datagrid1.visible=true;
					datagrid2.visible=false;
					button1.disabled = false;
					
					noteamttot.value = "";
					//model1.setValue("/root/reqData/search/stat_cd","05"); 
					model1.setValue("/root/reqData/search/stat_cd",model1.getValue("/root/initData/comboSet/dataSet/xx_stat_cd"));
					if(radio1.value=="0"){
						model1.setValue("/root/reqData/search/note_clsf_cd"," ");
					}else{
						//model1.setValue("/root/reqData/search/note_clsf_cd","1051"); 
						model1.setValue("/root/reqData/search/note_clsf_cd",model1.getValue("/root/initData/comboSet/dataSet/xx_note_clsf_cd"));
					}
					model1.refresh();
					if(nullCheck()){
						model1.send("fc_func_1051_l");
						if(model1.getValue("/root/resData/gridData/fc_func_1051_l/dataSet/CURLIST/totalcnt") == 0){
							reset_refnode("/root/resData/gridData/fc_func_1051_l/dataSet");
							rmks1.value= "";
							datagrid1.refresh();
							commGroupInit(group4);							
							show_message("검색결과가 없습니다.");
							return false;
						}
						for(var i=1;i<datagrid1.rows;i++){
							if(radio1.value=="0"){
								datagrid1.isReadOnly(i, 5,i,7) = true;
							}else{
								datagrid1.isReadOnly(i, 5,i,7) = false;
							}
						}
					}
					selectAll.dispatch("xforms-select");
					selectAll.value = "1";
					selectAll.visible = true;
										
					var urowcnt = 0;
					var chuamt =0;
					for(var i = 1;i<datagrid1.rows;i++){
						if(datagrid1.rowStatus(i)=="2"){
							urowcnt = urowcnt + 1;
							chuamt = Number(chuamt) + Number(get_refvalue("/root/resData/gridData/fc_func_1051_l/dataSet/CURLIST/record["+i+"]/note_amt"));
						}
					}
					if(urowcnt > 0){
						if(radio1.value == 0){
							rmks1.value = "받을어음 "+urowcnt+"건 추심입금";
							noteamttot.value = chuamt;
						}else{
							rmks1.value = "받을어음 "+urowcnt+"건 외화 추심입금";
							noteamttot.value = chuamt;
						}
					}else{
						rmks1.value = "";
						noteamttot.value = "";
					}
				 }
				 function send_fc_func_1052_l(){
					datagrid2.visible=true;
					datagrid1.visible=false;
					button1.disabled = true;
					
					//model1.setValue("/root/reqData/search/stat_cd","05"); 
					model1.setValue("/root/reqData/search/stat_cd",model1.getValue("/root/initData/comboSet/dataSet/xx_stat_cd")); 
					if(radio1.value=="0"){
						//model1.setValue("/root/reqData/search/pch_sql","AND NOTE_CLSF_CD <> '1051'"); 
						model1.setValue("/root/reqData/search/pch_sql","AND NOTE_CLSF_CD <> '"+model1.getValue("/root/initData/comboSet/dataSet/xx_note_clsf_cd")+"'"); 
					}else{
						//model1.setValue("/root/reqData/search/pch_sql","AND NOTE_CLSF_CD = '1051'");
						model1.setValue("/root/reqData/search/pch_sql","AND NOTE_CLSF_CD = '"+model1.getValue("/root/initData/comboSet/dataSet/xx_note_clsf_cd")+"'");
					}
					model1.refresh();
					if(nullCheck2()){
						model1.send("fc_func_1052_l");
						if(model1.getValue("/root/resData/gridData/fc_func_1052_l/dataSet/CURLIST/totalcnt") == 0){
							show_message("검색결과가 없습니다.");
							reset_refnode("/root/resData/gridData/fc_func_1052_l/dataSet");							
							datagrid2.refresh();
							commGroupInit(group4);									
							return false;
						}
					}
					set_refvalue("/root/resData/resform/biz_reg_no",get_refvalue("/root/resData/gridData/fc_func_1052_l/dataSet/CURLIST/record[1]/biz_reg_no"));
					set_refvalue("/root/resData/resform/bank_id",get_refvalue("/root/resData/gridData/fc_func_1052_l/dataSet/CURLIST/record[1]/bank_id"));
					set_refvalue("/root/resData/resform/acct_num",get_refvalue("/root/resData/gridData/fc_func_1052_l/dataSet/CURLIST/record[1]/acct_num"));
					set_refvalue("/root/resData/resform/tran_date_seq",get_refvalue("/root/resData/gridData/fc_func_1052_l/dataSet/CURLIST/record[1]/tran_date_seq"));
					set_refvalue("/root/resData/resform/current_clsf",get_refvalue("/root/resData/gridData/fc_func_1052_l/dataSet/CURLIST/record[1]/current_clsf"));

					group4.refresh();
					selectAll.dispatch("xforms-deselect");
					selectAll.value ="";
					selectAll.visible = false;					
				}
				function send_fc_func_1053_i(){
					//datagrid2.visible=true;
					//datagrid1.visible=false;
					if(nullCheck3()){
						var ccnt = 0;
						for(var i=1;i<datagrid1.rows;i++){
							if(datagrid1.rowStatus(i)=="2"){
								ccnt = ccnt + 1;
							}
						}
						if(ccnt == 0){
							show_message("처리할 자료가 없습니다");
							return false;
						}
						if(tran_amt.value !=""){
							if(tran_amt1.value != noteamttot.value){
								show_message("입력할 수 없는 자료입니다.(예금액과 추심액 상이)");
								return false;
							}
						}
							
						if(radio1.value == 0){
							set_refvalue("/root/reqData/multiUpdate/frex_cd","");
							set_refvalue("/root/reqData/multiUpdate/exrate","0");
							set_refvalue("/root/reqData/multiUpdate/hjphwamt","0");
						}
						if(srch_stat_dt.value != ""){
							set_refvalue("/root/reqData/multiUpdate/stat_dt",srch_stat_dt.value);
						}else{
							set_refvalue("/root/reqData/multiUpdate/stat_dt",deps_dt.value);
						}
						for(var i=1;i<datagrid1.rows;i++){	
							if(datagrid1.rowStatus(i)=="2"){
								//if(model1.getValue("/root/resData/gridData/fc_func_1051_l/dataSet/CURLIST/record["+i+"]/now_note_stat_cd")!="02"){
								if(model1.getValue("/root/resData/gridData/fc_func_1051_l/dataSet/CURLIST/record["+i+"]/now_note_stat_cd")!=model1.getValue("/root/initData/comboSet/dataSet/xx_now_note_stat_cd")){
									show_message("입력할 수 없는 자료입니다.");
									return false;
								}
								//2009-08-31 주석처리							
//								if(model1.getValue("/root/resData/gridData/fc_func_1051_l/dataSet/CURLIST/record["+i+"]/compnm2") != pch_compnm.value){
//									show_message("입력할 수 없는 자료입니다. [추심은행상이]");
//									return false;
//								}
							}
						}
						//noteamttot.value = "";
						var chuamt = 0;
//						for(var i = 1;i<datagrid1.rows;i++){
//							if(datagrid1.rowStatus(i)=="2"){
//								chuamt = Number(chuamt) + Number(get_refvalue("/root/resData/gridData/fc_func_1051_l/dataSet/CURLIST/record["+i+"]/note_amt"));
//							}
//						}

						if (show_message("저장하시겠습니까?","저장 확인",MB_YESNO) != IDYES) {
							return false;
						}
						
						model1.setValue("/root/reqData/multiUpdate/stat_dt",srch_stat_dt.value);
						model1.setValue("/root/reqData/multiUpdate/dlco_clsf_cd",srch_dlco_clsf_cd.value);
						model1.setValue("/root/reqData/multiUpdate/dlco_cd",srch_dlco_cd.value);
						model1.setValue("/root/reqData/multiUpdate/multiUpdateData",datagrid1.getUpdateData());
						model1.setValue("/root/reqData/multiUpdate/biz_reg_no", biz_reg_no.value);
						model1.setValue("/root/reqData/multiUpdate/bank_id", bank_id.value);
						model1.setValue("/root/reqData/multiUpdate/acct_num", acct_num.value);
						model1.setValue("/root/reqData/multiUpdate/tran_date", tran_date.value);
						model1.setValue("/root/reqData/multiUpdate/tran_date_seq", tran_date_seq.value);
						model1.setValue("/root/reqData/multiUpdate/current_clsf","D");
						
//						model1.send("fc_func_1052_l");
//						for(var i=0;i<datagrid2.row;i++){
//							var no1 = model1.getValue("/root/resData/gridData/fc_func_1053_i/dataSet/CURLIST/record["+i+"]/slip_no");
//							var no2 = model1.getValue("/root/resData/gridData/fc_func_1052_l/dataSet/CURLIST/record/slip_no");
//							
//							if(no1==no2){
//								  datagrid2.rowstyle(i, "data", "background-color") = "#FFF000";
//
//							}
//						}						
						model1.send("fc_func_1053_i");
						return check_submit_completed("저장되었습니다.","");
						noteamttot.value = chuamt;
					}
				}

				
				function send_fc_func_1054_d(){
					if(srch_stat_dt.value==""){
						show_message("추심일 은(는) 필수 입력 항목입니다.");
						return false;
					}
					if(datagrid2.row=="-1"){
						show_message("처리할 자료가 없습니다");
						return false;
					}
					if (show_message("삭제하시겠습니까?","삭제 확인",MB_YESNO) != IDYES) {
						return false;
					}
						 var stat_dt = model1.getValue("/root/reqData/search/stat_dt");
						 var slip_occr_dt = model1.getValue("/root/resData/gridData/fc_func_1052_l/dataSet/CURLIST/record["+datagrid2.row+"]/slip_occr_dt");
						 var slip_clsf_cd = model1.getValue("/root/resData/gridData/fc_func_1052_l/dataSet/CURLIST/record["+datagrid2.row+"]/slip_clsf_cd");
						 var slip_seq = model1.getValue("/root/resData/gridData/fc_func_1052_l/dataSet/CURLIST/record["+datagrid2.row+"]/slip_seq");

						model1.setValue("/root/reqData/reqform/stat_dt",stat_dt);
						//model1.setValue("/root/reqData/reqform/stat_cd","05"); 
						model1.setValue("/root/reqData/reqform/stat_cd",model1.getValue("/root/initData/comboSet/dataSet/xx_stat_cd")); 
						model1.setValue("/root/reqData/reqform/slip_occr_dt",slip_occr_dt);
						model1.setValue("/root/reqData/reqform/slip_clsf_cd",slip_clsf_cd);
						model1.setValue("/root/reqData/reqform/slip_seq",slip_seq);
						model1.setValue("/root/reqData/reqform/pch_count",datagrid2.rows-1);
						model1.refresh();

						model1.send("fc_func_1054_d");
						return check_submit_completed("삭제되었습니다.","");
				}
				function open_fc_acct_1180(p_where,p_mode,p_title,p_readonly) {
				var need_popup = true;
				
				//검색조건이 모두 충족하지 않으면 종료한다.
				if (p_where == "FOCUS" && (srch_dlco_clsf_cd.value.Trim() == "" || srch_dlco_cd.value.Trim() == "")) {
					dlco_nm.value	= "";
					return;
				}
				
				p_where = p_where.toUpperCase();
				
				var popid = "fc_acct_1180";
				var subid = "fc_acct_1181_l";

				set_popup_send_data(popid		,"mode"			,p_mode			);
				set_popup_send_data(popid		,"title"			,p_title			);
				set_popup_send_data(popid		,"readonly"		,p_readonly		);
				set_popup_send_data(popid		,"clsf_cd"			,srch_dlco_clsf_cd.value	);
				set_popup_send_data(popid		,"cd_f"			,srch_dlco_cd.value		);
				set_popup_send_data(popid		,"cd_t"			,srch_dlco_cd.value		);
//				set_popup_send_data(popid		,"cd_abrv_nm"		,srch_dlco_cd.value		);

				//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
				if (p_where == "FOCUS") {
					//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
					//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
					model.removenode(get_popup_rcvs_ref(popid));
					//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
					model.makeNode(get_popup_rcvs_ref(popid));
					
					//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
					send_submission(
							"auto_" + subid
						,	get_popup_send_ref(popid)
						,	get_popup_rcvs_ref(subid) + "/dataSet"
						,	"/fc/acct1000/1181"
						,	"urlencoded-post"
						,	"application/x-www-form-urlencoded"
					);
					
					totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
			
					if (totalcnt == 1) {
						//데이터가 1건이고 focus out에서 호출한 경우
						//데이터를 설정하고 나간다.

//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
						model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
//						return;
						need_popup = false;
					}
					else if (totalcnt == 0) {
						show_message("[거래처코드]의 검색결과가 없습니다.");
//						return;
						need_popup = false;						
					}
					else {
						//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
						//만약 1건 이상인 경우 popup을 호출해 달라고 하면
						//return을 지우면 됨
						//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
						//return;
						need_popup = true;
					}
				}
				
				//그외 버튼인 경우는 계속 진행
				if (need_popup) {
					open_popup(popid,"640");
				}

				//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
				//다시 조회 하기 쉽도록 하고
				if (get_popup_rcvs_data(popid,"clsf_cd") != "")			srch_dlco_clsf_cd.value		=	get_popup_rcvs_data(popid,"clsf_cd");
				if (get_popup_rcvs_data(popid,"cd") != "")				srch_dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
				//그외의 값은 지워지도록 한다.
				pch_compnm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
			}
	
	 			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="2,34;2,39;2,40;2,49;2,70;2,78;2,80;2,104;2,105;2,112;2,113;2,117;2,119;2,132;2,133;2,157;2,158;2,367;2,377;2,375;2,393;2,408;2,409;1,936;1,927;1,926;1,459;1,448;2,754;1,452;">
		<group id="group2" class="gro_sel" style="left:10px; top:185px; width:926px; height:540px; ">
			<datagrid id="datagrid2" nodeset="/root/resData/gridData/fc_func_1052_l/dataSet/CURLIST/record" caption="어음구분^어음번호^만기일^어음금액^통화금액^입금액^수수료^처분이익^전표번호^발행자^거래처^어음교환소^어음상태^추심은행^기산일^bank_cd^note_seq^note_clsf_cd" colsep="#" colwidth="100, 100, 100, 120, 120, 120, 100, 100, 142, 150, 150, 100, 100, 150, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="seq" rowsep="|" navindex="13" style="left:0px; top:30px; width:916px; height:505px; ">
				<col ref="note_clsf_cd_nm"/>
				<col ref="note_no"/>
				<col ref="mtry_dt" format="yyyy-mm-dd"/>
				<col ref="note_amt" format="(-)#,###" style="text-align:right; "/>
				<col ref="frex_amt" format="(-)#,###" style="text-align:right; "/>
				<col ref="rcpay_amt" format="(-)#,###" style="text-align:right; "/>
				<col ref="coms" format="(-)#,###" style="text-align:right; "/>
				<col ref="eeik_amt" format="(-)#,###" style="text-align:right; "/>
				<col ref="slipno" format="99999999-99-999"/>
				<col ref="issu_pers_nm" style="text-align:left; "/>
				<col ref="compnm2" style="text-align:left; "/>
				<col ref="note_clehous_cd_nm"/>
				<col ref="now_note_stat_cd_nm"/>
				<col ref="bank_nm" style="text-align:left; "/>
				<col ref="dlco_clsf_cd" format="yyyy-mm-dd"/>
				<col ref="dlco_cd" visibility="hidden"/>
				<col ref="note_clehous_cd" visibility="hidden"/>
				<col ref="now_note_stat_cd" visibility="hidden"/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						_oth_clsf = "2";
						
						jpno.value = get_refvalue("/root/resData/gridData/fc_func_1052_l/dataSet/CURLIST/record["+datagrid2.row+"]/slipno");
					]]>
				</script>
			</datagrid>
			<datagrid id="datagrid1" nodeset="/root/resData/gridData/fc_func_1051_l/dataSet/CURLIST/record" caption="어음구분^어음번호^만기일^어음금액^통화금액^입금액^수수료^처분이익^전표번호^발행자^거래처^어음교환소^어음상태^추심은행^기산일^bank_cd^note_seq^note_clsf_cd^now_note_stat_cd" colsep="#" colwidth="100, 100, 100, 120, 120, 120, 100, 100, 140, 150, 150, 100, 100, 150, 100, 100, 100, 100, 100" extendlastcol="scroll" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:0px; top:30px; width:917px; height:505px; ">
				<col ref="note_clsf_cd_nm"/>
				<col ref="note_no"/>
				<col ref="mtry_dt" format="yyyy-mm-dd"/>
				<col ref="note_amt" format="(-)#,###" style="text-align:right; "/>
				<col ref="frex_amt" type="input" format="(-)#,###" style="text-align:right; "/>
				<col ref="note_amt2" type="input" format="(-)#,###" style="text-align:right; "/>
				<col ref="coms" type="input" format="(-)#,###" style="text-align:right; "/>
				<col ref="eeik_amt" format="(-)#,###" style="text-align:right; "/>
				<col ref="slip_no" format="99999999-99-999"/>
				<col ref="issu_pers_nm" style="text-align:left; "/>
				<col ref="compnm" style="text-align:left; "/>
				<col ref="note_clehous_cd_nm"/>
				<col ref="now_note_stat_cd_nm"/>
				<col ref="compnm2" style="text-align:left; "/>
				<col ref="comp_dt" format="yyyy-mm-dd"/>
				<col ref="bank_cd" visibility="hidden"/>
				<col ref="note_seq" visibility="hidden"/>
				<col ref="note_clsf_cd" visibility="hidden"/>
				<col ref="now_note_stat_cd" visibility="hidden"/>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						_oth_clsf = "1";
						
						if(datagrid1.col == "0"){
							if(datagrid1.rowStatus(datagrid1.row)==0){
								datagrid1.addStatus(datagrid1.row,"update");
							
							}else{
								datagrid1.removeStatus(datagrid1.row,"update");	
							}
						}
						var urowcnt = 0;
						var chuamt = 0;						
						for(var i = 1;i<datagrid1.rows;i++){
							if(datagrid1.rowStatus(i)=="2"){
								urowcnt = urowcnt + 1;
								chuamt = Number(chuamt) + Number(get_refvalue("/root/resData/gridData/fc_func_1051_l/dataSet/CURLIST/record["+i+"]/note_amt"));
							}
						}
						if(urowcnt == datagrid1.rows-1){
							selectAll.value = "1";
						}else{
							selectAll.value = "";
						}
						if(urowcnt > 0){
							if(radio1.value == 0){
								rmks1.value = "받을어음 "+urowcnt+"건 추심입금";
								noteamttot.value = chuamt;
							}else{
								rmks1.value = "받을어음 "+urowcnt+"건 외화 추심입금";
								noteamttot.value = chuamt;
							}
						}else{
							rmks1.value = "";
							noteamttot.value = "";
						}
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						var W_SONIG = 0;
						if(datagrid1.colRef("note_amt2")==6 ||datagrid1.colRef("coms")==7){
							W_SONIG = Number(W_SONIG) + Number(get_refvalue("/root/resData/gridData/fc_func_1051_l/dataSet/CURLIST/record["+datagrid1.row+"]/note_amt2"));
							if(get_refvalue("/root/resData/gridData/fc_func_1051_l/dataSet/CURLIST/record["+datagrid1.row+"]/coms") != ""){
								W_SONIG = Number(W_SONIG) + Number(get_refvalue("/root/resData/gridData/fc_func_1051_l/dataSet/CURLIST/record["+datagrid1.row+"]/coms"));
							}
							if(get_refvalue("/root/resData/gridData/fc_func_1051_l/dataSet/CURLIST/record["+datagrid1.row+"]/note_amt") != ""){
								W_SONIG = Number(W_SONIG) - Number(get_refvalue("/root/resData/gridData/fc_func_1051_l/dataSet/CURLIST/record["+datagrid1.row+"]/note_amt"));
							}
							set_refvalue("/root/resData/gridData/fc_func_1051_l/dataSet/CURLIST/record["+datagrid1.row+"]/eeik_amt",W_SONIG);
						}
					]]>
				</script>
			</datagrid>
			<caption id="caption23" class="list_cap02" style="left:380px; top:1px; width:538px; height:26px; text-align:center; "/>
			<caption id="caption1" class="list_cap03" style="left:379px; top:1px; width:110px; height:26px; text-align:center; ">예금액</caption>
			<caption id="caption22" class="list_cap03" style="left:649px; top:1px; width:110px; height:26px; text-align:center; ">추심액</caption>
			<input id="noteamttot" ref="/root/resData/resform/noteamttot" navindex="-1" editable="false" format="(-)#,###" style="left:763px; top:4px; width:152px; height:18px; text-align:right; "/>
			<button id="button1" class="btn04" navindex="15" crud="R" style="left:113px; top:4px; width:85px; height:21px; ">
				<caption>통장입금내역</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var acct_mang_no = model.getValue("/root/reqData/multiUpdate/deps_clsf_cd");

						model.makeNode("/root/reqData/fwdData/acct_mang_no_ref");	
						model.setValue("/root/reqData/fwdData/acct_mang_no_ref", "/root/reqData/multiUpdate/deps_clsf_cd");

	  					model.makeNode("/root/reqData/fwdData/tran_amt_ref1");		  					
	  					model.setValue("/root/reqData/fwdData/tran_amt_ref1", "/root/resData/resform/tran_amt1");

	  					model.makeNode("/root/reqData/fwdData/tran_amt_ref");	
	  					model.setValue("/root/reqData/fwdData/tran_amt_ref", "/root/reqData/multiUpdate/tran_amt");
	  						  					
	  					model.makeNode("/root/reqData/fwdData/acct_tonghwa_ref");	
	  					model.setValue("/root/reqData/fwdData/acct_tonghwa_ref", "/root/reqData/multiUpdate/frex_cd");
	  					
	  					model.makeNode("/root/reqData/fwdData/frex_amt_ref");	
	  					model.setValue("/root/reqData/fwdData/frex_amt_ref", "/root/reqData/multiUpdate/hjphwamt");
	  					
	  					model.property("FC_FUNC_1050_deps_clsf_cd") = deps_clsf_cd.value;
	  					
	  					//loadRcpmDtlsPop_fc("H1"
						loadRcpmDtlsPop_fc( model1.getValue("/root/initData/comboSet/dataSet/xx_mang_cd_4")
						                , deps_clsf_cd.value
						                ,"/root/resData/resform/biz_reg_no"
						                ,"/root/resData/resform/bank_id"
						                ,"/root/resData/resform/acct_num"
						                ,"/root/resData/resform/tran_date"
						                ,"/root/resData/resform/tran_date_seq"
						                ,"/root/resData/resform/current_clsf"
									   ,"/root/reqData/fwdData");
						tran_amt1.refresh();
						group3.refresh();
						group4.refresh();

					]]>
				</script>
			</button>
			<input id="tran_amt1" ref="/root/resData/resform/tran_amt1" navindex="-1" editable="false" format="(-)#,###" style="left:493px; top:4px; width:152px; height:18px; text-align:right; "/>
			<group id="group4" visibility="hidden" style="left:185px; top:5px; width:390px; height:20px; ">
				<input id="acct_num" ref="/root/resData/resform/acct_num" editable="false" style="left:115px; top:2px; width:50px; height:18px; "/>
				<input id="tran_date_seq" ref="/root/resData/resform/tran_date_seq" editable="false" style="left:170px; top:2px; width:50px; height:18px; "/>
				<input id="current_clsf" ref="/root/resData/resform/current_clsf" editable="false" style="left:225px; top:2px; width:50px; height:18px; "/>
				<input id="biz_reg_no" ref="/root/resData/resform/biz_reg_no" editable="false" style="left:5px; top:2px; width:50px; height:18px; "/>
				<input id="bank_id" ref="/root/resData/resform/bank_id" editable="false" style="left:60px; top:2px; width:50px; height:18px; "/>
				<input id="tran_amt" ref="/root/reqData/multiUpdate/tran_amt" editable="false" style="left:279px; top:2px; width:50px; height:18px; "/>
				<input id="tran_date" ref="/root/resData/resform/tran_date" editable="false" format="yyyy-mm-dd" style="left:334px; top:2px; width:50px; height:18px; "/>
			</group>
		</group>
		<group id="group_tit" class="gro_tit" style="left:0px; top:0px; width:946px; height:39px; ">
			<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		</group>
		<group id="group_scr" class="gro_sel" style="left:10px; top:50px; width:926px; height:69px; ">
			<caption id="caption13" class="list_cap02" style="left:0px; top:25px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption9" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; text-align:center; "/>
			<input id="input10" style="left:118px; top:29px; width:54px; height:20px; "/>
			<caption id="caption2" style="left:188px; top:32px; width:20px; height:15px; ">/</caption>
			<caption id="caption12" class="list_cap03" style="left:0px; top:25px; width:110px; height:26px; text-align:center; ">추심은행</caption>
			<caption id="caption8" class="list_cap03" style="left:0px; top:0px; width:110px; height:26px; text-align:center; ">추 심 일</caption>
			<caption id="caption4" class="list_cap03" style="left:252px; top:0px; width:110px; height:26px; text-align:center; ">만 기 일</caption>
			<caption id="caption3" class="list_cap03" style="left:592px; top:25px; width:110px; height:26px; text-align:center; ">전표번호</caption>
			<select1 id="radio1" ref="/root/reqData/search/radio1" navindex="3" appearance="full" cols="2" overflow="visible" style="left:500px; top:5px; width:140px; height:15px; border-style:none; ">
				<choices>
					<item>
						<label>원  화</label>
						<value>0</value>
					</item>
					<item>
						<label>외화</label>
						<value>1</value>
					</item>
				</choices>
			</select1>
			<select1 id="srch_dlco_clsf_cd" ref="/root/reqData/search/dlco_clsf_cd" class="req_140" navindex="4" appearance="minimal" editmode="inputsearch" style="left:115px; top:29px; width:140px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/CURDLCO_CLSF_CD/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(srch_dlco_clsf_cd, srch_dlco_clsf_cd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(srch_dlco_clsf_cd,"");
						return;
					}
					]]>
				</script>
			</select1>
			<input id="srch_stat_dt" ref="/root/reqData/search/stat_dt" class="req_120" navindex="1" inputtype="date" style="left:115px; top:4px; width:120px; height:18px; "/>
			<input id="stch_mtry_dt" ref="/root/reqData/search/mtry_dt" class="req_120" navindex="2" inputtype="date" style="left:365px; top:4px; width:100px; height:18px; "/>
			<input id="jpno" ref="/root/resData/resform/jpno" navindex="-1" editable="false" format="99999999-99-999" appearance="input" style="left:705px; top:29px; width:195px; height:18px; "/>
			<input id="pch_compnm" ref="/root/reqData/multiUpdate/pch_compnm" navindex="-1" editable="false" appearance="input" style="left:393px; top:29px; width:155px; height:18px; "/>
			<input id="srch_dlco_cd" ref="/root/reqData/search/dlco_cd" class="req_120" navindex="5" inputtype="button" style="left:262px; top:29px; width:120px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
					open_fc_acct_1180("button","s","","1");				
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					open_fc_acct_1180("focus","s","","1");
					]]>
				</script>
			</input>
			<select id="kind" ref="/root/reqData/search/kind" overflow="visible" appearance="full" style="left:660px; top:5px; width:100px; height:18px; color:#0000ff; border-style:none; ">
				<choices>
					<item>
						<label>표지어음만</label>
						<value>1</value>
					</item>
				</choices>
			</select>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:106px; width:926px; height:5px; "/>
		<select id="selectAll" ref="/root/resData/resform/selectAll" navindex="12" overflow="visible" appearance="full" style="left:11px; top:192px; width:85px; height:15px; border-style:none; ">
			<choices>
				<item>
					<label>전체선택</label>
					<value>1</value>
				</item>
			</choices>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
					var chuamt =0;
					for(var i=0;i<datagrid1.rows;i++){
						datagrid1.addStatus(i, "update");
						chuamt = Number(chuamt) + Number(get_refvalue("/root/resData/gridData/fc_func_1051_l/dataSet/CURLIST/record["+i+"]/note_amt"));
					}
					if(i-1 >0){
						if(radio1.value == "0"){
							rmks1.value = "받을어음 "+(i-1)+"건 추심입금";
							noteamttot.value = chuamt;
						}else{
							rmks1.value = "받을어음 "+(i-1)+"건 외화 추심입금";
							noteamttot.value = chuamt;
						}
					}

					jpno.value = "";
				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[
					datagrid1.clearStatus();
					rmks1.value = "";
					noteamttot.value = "";
				]]>
			</script>
		</select>
		<group id="group1" class="gro_line" style="left:10px; top:173px; width:926px; height:5px; "/>
		<group id="group3" class="gro_sel" style="left:10px; top:115px; width:926px; height:55px; ">
			<caption id="caption21" class="list_cap02" style="left:0px; top:25px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption15" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption10" class="list_cap03" style="left:254px; top:0px; width:108px; height:26px; text-align:center; ">예 금 일</caption>
			<caption id="caption14" class="list_cap03" style="left:0px; top:0px; width:110px; height:26px; text-align:center; ">예금구분</caption>
			<caption id="caption19" class="list_cap03" style="left:254px; top:25px; width:108px; height:26px; text-align:center; ">적    요</caption>
			<input id="rmks1" ref="/root/reqData/multiUpdate/rmks1" navindex="11" style="left:365px; top:30px; width:551px; height:18px; "/>
			<caption id="caption16" class="list_cap03" style="left:474px; top:0px; width:108px; height:26px; text-align:center; ">외화코드</caption>
			<caption id="caption17" class="list_cap03" style="left:718px; top:0px; width:108px; height:26px; text-align:center; ">적용환율</caption>
			<caption id="caption20" class="list_cap03" style="left:0px; top:25px; width:110px; height:26px; text-align:center; ">외화입금</caption>
			<input id="hjphwamt" ref="/root/reqData/multiUpdate/hjphwamt" navindex="10" style="left:115px; top:30px; width:135px; height:18px; text-align:right; "/>
			<input id="exrate" ref="/root/reqData/multiUpdate/exrate" navindex="9" style="left:828px; top:4px; width:88px; height:18px; text-align:right; "/>
			<select1 id="deps_clsf_cd" ref="/root/reqData/multiUpdate/deps_clsf_cd" class="req" navindex="6" appearance="minimal" editmode="inputsearch" itemcount="10" style="left:115px; top:5px; width:135px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/DEPS_CLSF_CD1/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(deps_clsf_cd, deps_clsf_cd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(deps_clsf_cd,"");
						return;
					}
					]]>
				</script>
			</select1>
			<input id="deps_dt" ref="/root/reqData/multiUpdate/deps_dt" class="input_100" navindex="7" inputtype="date" style="left:365px; top:4px; width:100px; height:18px; "/>
			<select1 id="frex_cd" ref="/root/reqData/multiUpdate/frex_cd" navindex="8" appearance="minimal" editmode="inputsearch" itemcount="10" style="left:585px; top:4px; width:125px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/FREX_CD/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(frex_cd, frex_cd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(frex_cd,"");
						return;
					}
					]]>
				</script>
			</select1>
		</group>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:734px; width:926px; height:21px; ">
			<button id="btn_insert" class="btn02" navindex="16" crud="C" style="left:109px; top:0px; width:52px; height:21px; ">
				<caption>저장</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (send_fc_func_1053_i()){
							 set_refvalue("/root/resData/resform/jpno",get_refvalue("/root/resData/gridData/fc_func_1053_i/dataSet/CURLIST/record/slip_no"));
						 	jpno.refresh();
							btn_select_ptcr.dispatch("onclick");							
						}
					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" navindex="18" style="left:220px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.reset();		
					]]>
				</script>
			</button>
			<button id="btn_select_obj" class="btn02" navindex="14" crud="R" style="left:0px; top:0px; width:52px; height:21px; ">
				<caption>대상조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_fc_func_1051_l();
					]]>
				</script>
			</button>
			<button id="btn_print_slip" class="btn02" navindex="20" crud="P" style="left:330px; top:0px; width:52px; height:21px; ">
				<caption>전표출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						var ch_no = get_refvalue(jpno);
						if(ch_no == ""){
							show_message("전표번호가 없습니다.");
							return false;
						}
						// 글로벌변수 셋팅
						if(ch_no.length == 13){
						model.property("FC_ACCT_2260_slip_occr_dt")  = ch_no.substring(0, 8);			// 발생일자
						model.property("FC_ACCT_2260_slip_clsf_cd")  = ch_no.substring(8, 10);			// 전표구분
						model.property("FC_ACCT_2260_slip_seqfr") = ch_no.substring(10, 13);			// 일련번호 from
						model.property("FC_ACCT_2260_slip_seqto") = ch_no.substring(10, 13);			// 일련번호 to
						model.property("FC_ACCT_2260_slip_radio1") = "";			// 출력구분
						model.property("FC_ACCT_2260_popup_flag")  = "Y";
					}else{
						model.property("FC_ACCT_2260_slip_occr_dt")  = ch_no.substring(0, 8);			// 발생일자
						model.property("FC_ACCT_2260_slip_clsf_cd")  = ch_no.substring(9, 11);			// 전표구분
						model.property("FC_ACCT_2260_slip_seqfr") = ch_no.substring(12, 15);			// 일련번호 from
						model.property("FC_ACCT_2260_slip_seqto") = ch_no.substring(12, 15);			// 일련번호 to
						model.property("FC_ACCT_2260_slip_radio1") = "";			// 출력구분
						model.property("FC_ACCT_2260_popup_flag")  = "Y";
					}
						
						// 화면호출
						//viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2260", "modal", "align:center; caption:hidden; width:650px; height:480px;");
						viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2260");	
					]]>
				</script>
			</button>
			<button id="btn_select_ptcr" class="btn02" navindex="15" crud="R" style="left:55px; top:0px; width:52px; height:21px; ">
				<caption>내역조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						send_fc_func_1052_l();
					]]>
				</script>
			</button>
			<button id="btn_print" class="btn02" navindex="19" crud="P" style="left:276px; top:0px; width:52px; height:21px; ">
				<caption>출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var ch_no = get_refvalue(jpno);
					
					// 글로벌변수 셋팅
					model.property("FC_FUNC_1220_radio1")  				= 		"17";									// 요청일
					model.property("FC_FUNC_1220_stat_dt_17")  			= 		get_refvalue(srch_stat_dt);					// 요청일	
					if(ch_no.length == 13){
						model.property("FC_FUNC_1220_slip_occr_dt_17")  		= 		ch_no.substring(0, 8);					// 발생일자
						model.property("FC_FUNC_1220_slip_clsf_cd_17")  		= 		ch_no.substring(8, 10);					// 전표구분
						model.property("FC_FUNC_1220_slip_seq_17") 			= 		ch_no.substring(10, 13);					// 일련번호
					}else{
						model.property("FC_FUNC_1220_slip_occr_dt_17")  		= 		ch_no.substring(0, 8);					// 발생일자
						model.property("FC_FUNC_1220_slip_clsf_cd_17")  		= 		ch_no.substring(9, 11);					// 전표구분
						model.property("FC_FUNC_1220_slip_seq_17") 			= 		ch_no.substring(12, 15);					// 일련번호
					}
					model.property("FC_FUNC_1220_popup_flag")  			= 		"Y";
					
					// 화면호출
					viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_FUNC_1220");	
					]]>
				</script>
			</button>
			<button id="btn_delete" class="btn02" navindex="17" crud="D" style="left:164px; top:0px; width:52px; height:21px; ">
				<caption>삭제</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						if (send_fc_func_1054_d()){
							jpno.value = "";
							btn_select_obj.dispatch("onclick");
						}
							
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" navindex="21" crud="R" style="left:385px; top:0px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					if(_oth_clsf == "2"){			
						grid = datagrid2;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" navindex="22" style="left:441px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose(); 
					]]>
				</script>
			</button>
		</group>
	</xhtml:body>
</xhtml:html>
