<?xml version="1.0" encoding="EUC-KR"?>
<?xml-stylesheet href="../../../css/style_sheet.css" type="text/css" ?>
<xhtml:html xmlns:ex="http://www.comsquare.co.kr/xforms/excel" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:my="http://www.comsquare.co.kr/example" xmlns:ms="urn:schemas-microsoft-com:xslt" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/2002/01/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cs="http://www.comsquare.co.kr/xforms">
	<xhtml:head>
		<xhtml:title>교환및구매카드입금등록(FC_FUNC_1460)</xhtml:title>
		<model id="model1">
			<instance id="instance1">
				<root xmlns="">
					<initData>
						<!-- 화면 로딩시의 초기 데이터를 담당 -->
						<!-- 서버의 세션 정보를 담당한다 -->
						<session>
							<!--<cmpy_cd>100</cmpy_cd> 세션에서 처리하므로 주석함-->
							<cmpy_cd/>
						</session>
						<comboSet>
							<!-- 선택계열의 정보를 담당 -->
							<dataSet>
								<xx_dlco_clsf_cd/>
								<xx_now_note_stat_cd_020/>
								<xx_mang_cd_4/>
								<XX_CD>
									<record>
										<cd_nm/>
										<cd/>
									</record>
								</XX_CD>
								<DLCOCLSFCDLIST>
									<record>
										<cd/>
										<cdnm/>
										<cd_abrv_nm/>
										<cdnm_cd/>
										<cdabrvnm_cd/>
									</record>
								</DLCOCLSFCDLIST>
								<DEPSCLSFLIST>
									<record>
										<cd/>
										<cdnm/>
										<cd_abrv_nm/>
										<cdnm_cd/>
										<cdabrvnm_cd/>
									</record>
								</DEPSCLSFLIST>
								<CHNL_CLSF_LIST>
									<record>
										<cd/>
										<cdnm/>
										<cd_abrv_nm/>
										<cdnm_cd/>
										<cdabrvnm_cd/>
									</record>
								</CHNL_CLSF_LIST>
							</dataSet>
						</comboSet>
						<!-- 콤보리스트와 같은 선택게열의 데이터는 <item>을 반복함으로써 list를 구성한다. -->
						<pageInfo>
							<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
						</pageInfo>
						<!-- 해당 화면의 필요한 기타 정보들을 추가운영 할 수 있다 -->
					</initData>
					<reqData>
						<!-- 전달하고자 하는 데이터를 담당 ( submit 함수에서 처리) -->
						<!-- 검색조건 처리 -->
						<fwdData/>
						<reqform>
							<multiUpdateData/>
							<stat_cd/>
							<stat_dt/>
							<!--<dlco_clsf_cd>95</dlco_clsf_cd>-->
							<dlco_clsf_cd/>
							<dlco_cd/>
							<deps_clsf_cd/>
							<rmks1/>
							<slip_no/>
							<dlco_cdnm/>
							<slip_occr_dt/>
							<slip_clsf_cd/>
							<slip_seq/>
							<place/>
							<tran_amt/>
							<biz_reg_no/>
							<bank_id/>
							<acct_num/>
							<tran_date/>
							<save_tran_amt/>
							<tran_date_seq/>
							<current_clsf/>
							<frex_cd/>
							<hjphwamt/>
							<chnl_clsf/>
						</reqform>
						<!-- formData 팝업,화면전환시 data이동시 -->
						<!-- MultiUpDate유형 사용시 처리 -->
						<searchData>
							<cmpy_cd/>
							<chkpjee/>
							<mtry_dt/>
							<chkplace/>
							<place/>
							<note_no/>
							<note_seq/>
						</searchData>
					</reqData>
					<resData>
						<!-- 전달 받은 데이터를 담당 ( submit의 결과가 담김) -->
						<resform>
							<acct_mang_no/>
							<biz_reg_no/>
							<bank_id/>
							<acct_num/>
							<tran_date_seq/>
							<current_clsf/>
							<tran_amt1/>
							<tran_date/>
							<selectAll/>
							<total_note_amt/>
							<total_corp_tax/>
							<total_rcpay_amt/>
							<total_etc_prft/>
							<fc_func_1463_i>
								<dataSet>
									<CURLIST>
										<record>
											<slip_occr_dt/>
											<slip_clsf_cd/>
											<slip_seq/>
											<slip_no/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_func_1463_i>
						</resform>
						<!-- 전달 받은 formData를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 데이터를 가공할 임시저장소 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorCode를 담당 ( submit의 결과가 담김) -->
						<!-- 전달 받은 errorMsg를 담당 ( submit의 결과가 담김) -->
						<resform1>
							<biz_reg_no/>
							<bank_id/>
							<acct_num/>
							<tran_date/>
							<tran_date_seq/>
							<tran_amt/>
						</resform1>
						<gridData>
							<!-- 전달 받은 grid데이터를 담당 ( submit의 결과가 담김) -->
							<!-- datagrid2 -->
							<!-- datagrid3 -->
							<fc_func_1462_l>
								<dataSet>
									<CURLIST>
										<record>
											<note_clsf_cdnm/>
											<note_full_no/>
											<note_amt/>
											<sale_dscn_amt/>
											<bank_cd_nm/>
											<rcpm_acct_nm2/>
											<rcpay_amt/>
											<corp_tax/>
											<etc_prft/>
											<slip_no/>
											<mtry_dt/>
											<issu_pers_nm/>
											<dlco_clsf_cd/>
											<dlco_cd/>
											<dlco_cdnm/>
											<pay_plac_cdnm/>
											<now_note_stat_cdnm/>
											<comp_dt/>
											<sale_aprv_no/>
											<coms/>
											<note_clsf_cd/>
											<note_no/>
											<bank_cd/>
											<note_seq/>
											<slip_occr_dt/>
											<slip_clsf_cd/>
											<slip_seq/>
											<biz_reg_no/>
											<bank_id/>
											<acct_num/>
											<tran_date_seq/>
											<current_clsf/>
											<corp_local_tax/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_func_1462_l>
							<fc_func_1462_l_2>
								<dataSet>
									<CURLIST>
										<record>
											<note_clsf_cdnm/>
											<note_full_no/>
											<note_amt/>
											<sale_dscn_amt/>
											<bank_cd_nm/>
											<rcpm_acct_nm2/>
											<rcpay_amt/>
											<corp_tax/>
											<etc_prft/>
											<slip_no/>
											<mtry_dt/>
											<issu_pers_nm/>
											<dlco_clsf_cd/>
											<dlco_cd/>
											<dlco_cdnm/>
											<pay_plac_cdnm/>
											<now_note_stat_cdnm/>
											<comp_dt/>
											<sale_aprv_no/>
											<coms/>
											<note_clsf_cd/>
											<note_no/>
											<bank_cd/>
											<note_seq/>
											<dlco_clsf_cd1/>
											<dlco_cd/>
											<deps_clsf_cd/>
											<slip_occr_dt/>
											<slip_clsf_cd/>
											<slip_seq/>
										</record>
									</CURLIST>
								</dataSet>
							</fc_func_1462_l_2>
						</gridData>
						<MsgData/>
					</resData>
					<tempData>
						<errcode/>
						<errmsg/>
					</tempData>
					<tempData2>
						<total_note_amt/>
						<total_corp_tax/>
						<total_rcpay_amt/>
						<total_etc_prft/>
					</tempData2>
				</root>
			</instance>
			<script type="javascript" src="../../../js/CIISComm.js"/>
			<script type="javascript" src="../../../js/TFCommon.js"/>
			<script type="javascript" src="../../../js/fcmc_common.js"/>
			<submission id="fc_func_1080_m" action="/fc/func1000/1080" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData" resultref="/root/initData/comboSet/dataSet"/>
			<submission id="fc_func_1461_l" action="/fc/func1000/1461" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/searchData" resultref="/root/resData/gridData/fc_func_1462_l/dataSet"/>
			<submission id="fc_func_1462_l" action="/fc/func1000/1462" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/reqform" resultref="/root/resData/gridData/fc_func_1462_l/dataSet"/>
			<submission id="fc_func_1463_i" action="/fc/func1000/1463" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/reqform" resultref="/root/resData/resform/fc_func_1463_i/dataSet"/>
			<submission id="fc_func_1464_d" action="/fc/func1000/1464" mediatype="application/x-www-form-urlencoded" method="urlencoded-post" ref="/root/reqData/reqform" resultref="/root/resData/MsgData"/>
			<script type="javascript" ev:event="xforms-ready">
				<![CDATA[
					var cmpy_cd = getProperty("ss_cmpycd");
					model1.setValue("/root/reqData/searchData/cmpy_cd",cmpy_cd);
					model1.setValue("/root/reqData/reqform/stat_dt", commCurDate());
					model1.setValue("/root/reqData/searchData/mtry_dt", commCurDate());
					model1.send("fc_func_1080_m");
					makeComboGubun("", "/root/initData/comboSet/dataSet/DLCOCLSFCDLIST", "record", "cdabrvnm_cd", "cd");
					makeComboGubun("", "/root/initData/comboSet/dataSet/DEPSCLSFLIST", "record", "cdabrvnm_cd", "cd");
					makeComboGubun("", "/root/initData/comboSet/dataSet/XX_CD", "record", "cd_nm", "cd");
					model1.setValue("/root/reqData/reqform/dlco_clsf_cd",model1.getValue("/root/initData/comboSet/dataSet/xx_dlco_clsf_cd"));
					//dlco_clsf_cd.value ="95";
					dlco_clsf_cd.value =model1.getValue("/root/initData/comboSet/dataSet/xx_dlco_clsf_cd");
					
					//alert(model1.getValue("/root/initData/comboSet/dataSet/xx_mang_cd_4"));
					//alert(dlco_clsf_cd.value);
					dlco_clsf_cd.disabled = true;										

					if(get_refvalue("/root/initData/comboSet/dataSet/mtry_cnt") > 0){
						show_message("만기도래된 구매카드가 존재합니다.");
					}
					datagrid2.removeRow();
					//datagrid2.visible = false;
					
					if (cmpy_cd == "500") {
						caption14.visible = true;
						chnl_clsf_cd.visible = true;
					}else{
						caption14.visible = false;
						chnl_clsf_cd.visible = false;
					}
					
					model1.refresh();
				]]>
			</script>
			<script type="javascript" ev:event="xforms-model-construct-done">
				<![CDATA[
					set_default(datagrid1);
					set_default(datagrid2);
				]]>
			</script>
		</model>
		<script type="javascript">
			<![CDATA[
				var	_oth_clsf = "1";
				
				function open_fc_acct_1180(p_where,p_mode,p_title,p_readonly) {
				var need_popup = true;
				
				//검색조건이 모두 충족하지 않으면 종료한다.
				if (p_where == "FOCUS" && (dlco_clsf_cd.value.Trim() == "" || dlco_cd.value.Trim() == "")) {
					dlco_nm.value	= "";
					return;
				}
				
				p_where = p_where.toUpperCase();
				
				var popid = "fc_acct_1180";
				var subid = "fc_acct_1181_l";

				set_popup_send_data(popid		,"mode"			,p_mode			);
				set_popup_send_data(popid		,"title"			,p_title			);
				set_popup_send_data(popid		,"readonly"		,p_readonly		);
				set_popup_send_data(popid		,"clsf_cd"			,dlco_clsf_cd.value	);
				set_popup_send_data(popid		,"cd_f"			,dlco_cd.value		);
				set_popup_send_data(popid		,"cd_t"			,dlco_cd.value		);
				set_popup_send_data(popid		,"cd_abrv_nm"		,dlco_cd.value		);

				//포커스에서 호출 한 경우 직접 서블릿을 실행시켜서 데이터를 확인한다.
				if (p_where == "FOCUS") {
					//포커스로 검색이 시작되는 경우 무조껀 검색 결과에 해당하는 노드를 삭제하고 시작한다.
					//버튼의 경우는 검색결과가 "" 이면 지우도록 설정되어있음
					model.removenode(get_popup_rcvs_ref(popid));
					//인스턴스 구조가 없으면 copynode 동작이 되지 않으므로 기본 구조는 만들어준다.
					model.makeNode(get_popup_rcvs_ref(popid));
					
					//받는위치 분리를 위해서 receive 위치를 popid가 아닌 subid 기준으로 설정
					send_submission(
							"auto_" + subid
						,	get_popup_send_ref(popid)
						,	get_popup_rcvs_ref(subid) + "/dataSet"
						,	"/fc/acct1000/1181"
						,	"urlencoded-post"
						,	"application/x-www-form-urlencoded"
					);
					
					totalcnt = model.getValue(get_popup_rcvs_ref(subid) + "/dataSet" + "/CURLIST1/totalcnt");
			
					if (totalcnt == 1) {
						//데이터가 1건이고 focus out에서 호출한 경우
						//데이터를 설정하고 나간다.

//						model.duplicate(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
						model.copyNode(get_popup_rcvs_ref(popid) , get_popup_rcvs_ref(subid) + "/dataSet/CURLIST1/record");
//						return;
						need_popup = false;
					}
					else if (totalcnt == 0) {
						show_message("[거래처코드]의 검색결과가 없습니다.");
//						return;
						need_popup = false;						
					}
					else {
						//포커스에서 호출 한 경우 1건이 아니면 무조건 종료
						//만약 1건 이상인 경우 popup을 호출해 달라고 하면
						//return을 지우면 됨
						//show_message("[거래처코드]의 검색결과가 2건 이상입니다.");
						//return;
						need_popup = true;
					}
				}
				
				//그외 버튼인 경우는 계속 진행
				if (need_popup) {
					open_popup(popid,"640");
				}

				//반드시 입력되어야 하는 필수 항목의 경우 검색결과가 공백이 아닌 경우만 반영해서
				//다시 조회 하기 쉽도록 하고
				if (get_popup_rcvs_data(popid,"clsf_cd") != "")			dlco_clsf_cd.value		=	get_popup_rcvs_data(popid,"clsf_cd");
				if (get_popup_rcvs_data(popid,"cd") != "")				dlco_cd.value			=	get_popup_rcvs_data(popid,"cd");
				//그외의 값은 지워지도록 한다.
				dlco_cdnm.value			=	get_popup_rcvs_data(popid,"cd_abrv_nm");
			}	
			
			]]>
		</script>
	</xhtml:head>
	<xhtml:body class="main" pagewidth="946" pageheight="765" guideline="2,34;2,39;2,40;2,49;2,69;2,78;2,80;2,105;2,105;2,112;2,113;2,117;2,118;2,132;2,133;2,157;2,158;1,935;1,927;1,926;2,755;">
		<datagrid id="datagrid1" nodeset="/root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record" autoresize="false" caption="어음구분^어음번호^어음금액^입금일자^수수료^매출할인금액^교환은행^입금계좌^수입금액^법인세^법인지방소득세^잡이익^전표번호^만기일^발행자^거래처구분^거래처코드^거래처명^지급지^어음상태^기산일^매출승인번호^note_clsf_cd^note_no^bank_cd^note_seq" colsep="#" colwidth="103, 135, 99, 86, 70, 89, 103, 88, 84, 84, 100, 126, 100, 136, 100, 100, 187, 100, 100, 100, 150, 100, 100, 100, 100, 100" extendlastcol="scroll" frozencols="3" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:10px; top:218px; width:926px; height:216px; ">
			<col ref="note_clsf_cdnm" style="text-align:left; "/>
			<col ref="note_full_no" format="99999999-999999-9"/>
			<col ref="note_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="deps_dt" type="input" format="yyyy-mm-dd"/>
			<col ref="coms" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="sale_dscn_amt" format="(-)#,###" style="left:330px; top:20px; width:100px; height:20px; text-align:right; "/>
			<col ref="bank_cd_nm"/>
			<col ref="rcpm_acct_nm2"/>
			<col ref="rcpay_amt" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="corp_tax" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="corp_local_tax" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="etc_prft" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="slip_no" format="99999999-99-999"/>
			<col ref="mtry_dt" format="yyyy-mm-dd"/>
			<col ref="issu_pers_nm" style="text-align:left; "/>
			<col ref="dlco_clsf_cd"/>
			<col ref="dlco_cd"/>
			<col ref="dlco_cdnm" style="left:757px; top:20px; width:188px; height:20px; text-align:left; "/>
			<col ref="pay_plac_cdnm"/>
			<col ref="now_note_stat_cdnm"/>
			<col ref="comp_dt" format="yyyy-mm-dd"/>
			<col ref="sale_aprv_no" style="left:1514px; top:20px; width:100px; height:20px; "/>
			<col ref="note_clsf_cd" visibility="hidden"/>
			<col ref="note_no" visibility="hidden"/>
			<col ref="bank_cd" visibility="hidden"/>
			<col ref="note_seq" visibility="hidden"/>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
					_oth_clsf = "1";
					
					if(datagrid1.valueMatrix(1,1) == ""){
						return;
					}

					if(datagrid1.col == "0"){					
						if(datagrid1.rowStatus(datagrid1.row) == "0"){
							datagrid1.addStatus(datagrid1.row,"update");
						}else{
							datagrid1.removeStatus(datagrid1.row,"update");
						}
					}

					if(datagrid1.row > 0){
						var var_slip_no  = get_refvalue("/root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+datagrid1.row+"]/slip_no");
						if(var_slip_no != ""){
							set_refvalue("/root/reqData/reqform/slip_no",var_slip_no);
						}
					}
					
					var scount = 0;
					var rv_total_rcpay_amt=0;
					var rv_total_corp_tax=0;
					var rv_total_etc_prft=0;
					var rv_total_note_amt=0;
											
					for(var i=0;i<datagrid1.rows;i++){
						if(datagrid1.rowStatus(i)!="0"){
							if(datagrid1.valueMatrix(i,1) !=""){
								scount++;
								rv_total_note_amt = Number(rv_total_note_amt) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/note_amt")); 
								rv_total_rcpay_amt = Number(rv_total_rcpay_amt) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/rcpay_amt"));
								rv_total_corp_tax = Number(rv_total_corp_tax) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/corp_tax"));
								rv_total_etc_prft = Number(rv_total_etc_prft) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/etc_prft"));
							}
						}
					}
					if(scount == datagrid1.rows-1){
						selectAll.value = "1";
					}else{
						selectAll.value = "";
					}
					if (scount > 0) {
						rmks1.value = "받을어음 " + scount + "건 교환입금";
						set_refvalue("/root/resData/resform/total_note_amt",rv_total_note_amt);
						set_refvalue("/root/resData/resform/total_rcpay_amt",rv_total_rcpay_amt);
						set_refvalue("/root/resData/resform/total_corp_tax",rv_total_corp_tax);
						set_refvalue("/root/resData/resform/total_etc_prft",rv_total_etc_prft);
						group2.refresh();

					}else{
						set_refvalue("/root/reqData/reqform/rmks1","");
						set_refvalue("/root/resData/resform/total_note_amt","");
						set_refvalue("/root/resData/resform/total_rcpay_amt","");
						set_refvalue("/root/resData/resform/total_corp_tax","");
						set_refvalue("/root/resData/resform/total_etc_prft","");
						group2.refresh();
					}
				]]>
			</script>
			<script type="javascript" ev:event="xforms-value-changed">
				<![CDATA[
					var i = datagrid1.row;
					if(datagrid1.col == 8 || datagrid1.col == 9 || datagrid1.col == 10){
						var scount = 0;
						var rv_total_rcpay_amt=0;
						var rv_total_corp_tax=0;
						var rv_total_etc_prft=0;
						var rv_total_note_amt=0;
												
						for(var i=0;i<datagrid1.rows;i++){
							if(datagrid1.rowStatus(i)!="0"){
								if(datagrid1.valueMatrix(i,1) !=""){
									scount++;
									rv_total_note_amt = Number(rv_total_note_amt) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/note_amt")); 
									rv_total_rcpay_amt = Number(rv_total_rcpay_amt) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/rcpay_amt"));
									rv_total_corp_tax = Number(rv_total_corp_tax) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/corp_tax"));
									rv_total_etc_prft = Number(rv_total_etc_prft) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/etc_prft"));
								}
							}
						}
						if(scount == datagrid1.rows-1){
							selectAll.value = "1";
						}else{
							selectAll.value = "";
						}					
						if (scount > 0) {
							rmks1.value = "받을어음 " + scount + "건 교환입금";
							set_refvalue("/root/resData/resform/total_note_amt",rv_total_note_amt);
							set_refvalue("/root/resData/resform/total_rcpay_amt",rv_total_rcpay_amt);
							set_refvalue("/root/resData/resform/total_corp_tax",rv_total_corp_tax);
							set_refvalue("/root/resData/resform/total_etc_prft",rv_total_etc_prft);
							group2.refresh();
	
						}else{
							set_refvalue("/root/reqData/reqform/rmks1","");
							set_refvalue("/root/resData/resform/total_note_amt","");
							set_refvalue("/root/resData/resform/total_rcpay_amt","");
							set_refvalue("/root/resData/resform/total_corp_tax","");
							set_refvalue("/root/resData/resform/total_etc_prft","");
							group2.refresh();
						}							
					}					
				]]>
			</script>
		</datagrid>
		<datagrid id="datagrid2" nodeset="/root/resData/gridData/fc_func_1462_l_2/dataSet/CURLIST/record" autoresize="false" caption="어음구분^어음번호^어음금액^입금일자^수수료^매출할인금액^교환은행^입금계좌^수입금액^법인세^법인지방소득세^잡이익^전표번호^만기일^발행자^거래처구분^거래처코드^거래처명^지급지^어음상태^기산일^매출승인번호^note_clsf_cd^note_no^bank_cd^note_seq^dlco_clsf_cd1^dlco_cd1^deps_clsf_cd" colsep="#" colwidth="103, 135, 99, 86, 71, 90, 101, 88, 84, 84, 100, 126, 100, 136, 100, 100, 187, 100, 100, 100, 150, 100, 100, 100, 100, 100, 100, 100, 100" extendlastcol="scroll" frozencols="3" mergecellsfixedrows="bycolrec" rowheader="update" rowsep="|" style="left:10px; top:471px; width:926px; height:239px; ">
			<col ref="note_clsf_cdnm" style="text-align:left; "/>
			<col ref="note_full_no" format="99999999-999999-9"/>
			<col ref="note_amt" format="(-)#,###" style="text-align:right; "/>
			<col ref="deps_dt" type="input" format="yyyy-mm-dd"/>
			<col ref="coms" type="input"/>
			<col ref="sale_dscn_amt" format="(-)#,###" style="left:330px; top:20px; width:100px; height:20px; text-align:right; "/>
			<col ref="bank_cd_nm"/>
			<col ref="rcpm_acct_nm2"/>
			<col ref="rcpay_amt" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="corp_tax" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="corp_local_tax" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="etc_prft" type="input" format="(-)#,###" style="text-align:right; "/>
			<col ref="slip_no" format="99999999-99-999"/>
			<col ref="mtry_dt" format="yyyy-mm-dd"/>
			<col ref="issu_pers_nm" style="text-align:left; "/>
			<col ref="dlco_clsf_cd"/>
			<col ref="dlco_cd"/>
			<col ref="dlco_cdnm" style="left:757px; top:20px; width:188px; height:20px; text-align:left; "/>
			<col ref="pay_plac_cdnm"/>
			<col ref="now_note_stat_cdnm"/>
			<col ref="comp_dt" format="yyyy-mm-dd"/>
			<col ref="sale_aprv_no" style="left:1514px; top:20px; width:100px; height:20px; "/>
			<col ref="note_clsf_cd" visibility="hidden"/>
			<col ref="note_no" visibility="hidden"/>
			<col ref="bank_cd" visibility="hidden"/>
			<col ref="note_seq" visibility="hidden"/>
			<col ref="dlco_clsf_cd1"/>
			<col ref="dlco_cd1"/>
			<col ref="deps_clsf_cd"/>
		</datagrid>
		<caption id="caption23" class="list_cap02" style="left:695px; top:191px; width:241px; height:26px; text-align:center; "/>
		<import id="iv_Title" src="../../../common/xrw/iv_TitleBar.xrw" style="left:10px; top:5px; width:926px; height:29px; "/>
		<group id="group_scr" class="gro_sel" visibility="visible" style="left:10px; top:51px; width:926px; height:67px; ">
			<caption id="caption1" class="list_cap02" style="left:0px; top:33px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption5" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption32" class="list_cap03" style="left:376px; top:0px; width:120px; height:26px; text-align:center; ">전표번호</caption>
			<caption id="caption6" class="list_cap03" style="left:0px; top:33px; width:120px; height:26px; text-align:center; ">만기일</caption>
			<input id="mtry_dt" ref="/root/reqData/searchData/mtry_dt" class="req" navindex="1" inputtype="date" style="left:123px; top:37px; width:100px; height:18px; "/>
			<input id="slip_no" ref="/root/reqData/reqform/slip_no" editable="false" format="99999999-99-999" appearance="input" style="left:501px; top:4px; width:120px; height:18px; text-align:center; "/>
			<select id="checkbox2" ref="/root/reqData/searchData/chkpjee" navindex="2" overflow="visible" appearance="full" style="left:228px; top:38px; width:82px; height:18px; color:#0000ff; border-style:none; ">
				<choices>
					<item>
						<label>표지어음만</label>
						<value>1</value>
					</item>
				</choices>
			</select>
			<select1 id="dlco_clsf_cd" ref="/root/reqData/reqform/dlco_clsf_cd" class="req" navindex="5" appearance="minimal" caption="은행구분" style="left:499px; top:37px; width:100px; height:18px; ">
				<choices>
					<!--
					<item>
						<label>95 은행</label>
						<value>95</value>
					</item>
					-->
					<itemset nodeset="/root/initData/comboSet/dataSet/XX_CD/record">
						<label ref="cd_nm"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</select1>
			<caption id="caption2" class="list_cap03" style="left:376px; top:33px; width:120px; height:26px; text-align:center; ">교환은행</caption>
			<input id="dlco_cd" ref="/root/reqData/reqform/dlco_cd" class="req" navindex="6" inputtype="button" style="left:604px; top:37px; width:120px; height:18px; ">
				<script type="javascript" ev:event="onbuttonclick">
					<![CDATA[
						open_fc_acct_1180("button","s","","1");				
					]]>
				</script>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
						open_fc_acct_1180("focus","s","","1");
					]]>
				</script>
			</input>
			<input id="dlco_cdnm" ref="/root/reqData/reqform/dlco_cdnm" editable="false" appearance="input" style="left:728px; top:37px; width:175px; height:18px; "/>
			<caption id="caption3" class="list_cap03" style="left:0px; top:0px; width:120px; height:26px; text-align:center; ">교환일</caption>
			<input id="stat_dt" ref="/root/reqData/reqform/stat_dt" class="req" navindex="4" inputtype="date" style="left:123px; top:4px; width:100px; height:18px; "/>
			<select id="srch_place" ref="/root/reqData/searchData/chkplace" navindex="3" overflow="visible" appearance="full" style="left:315px; top:38px; width:45px; height:18px; color:#0000ff; border-style:none; ">
				<choices>
					<item>
						<label>지방</label>
						<value>2</value>
					</item>
				</choices>
			</select>
			<caption id="caption14" class="list_cap03" visibility="hidden" style="left:630px; top:0px; width:120px; height:26px; text-align:center; ">채널구분</caption>
			<select1 id="chnl_clsf_cd" ref="/root/reqData/reqform/chnl_clsf" class="req" visibility="hidden" appearance="minimal" style="left:755px; top:4px; width:104px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/CHNL_CLSF_LIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
			</select1>
		</group>
		<group id="group_line" class="gro_line" style="left:10px; top:122px; width:923px; height:5px; "/>
		<group id="group2" class="gro_sel" style="left:10px; top:136px; width:926px; height:51px; ">
			<caption id="caption25" class="list_cap02" style="left:0px; top:25px; width:926px; height:26px; text-align:center; "/>
			<input id="rmks1" ref="/root/reqData/reqform/rmks1" navindex="8" style="left:123px; top:30px; width:315px; height:18px; "/>
			<caption id="caption18" class="list_cap02" style="left:0px; top:0px; width:926px; height:26px; text-align:center; "/>
			<caption id="caption7" class="list_cap03" style="left:0px; top:25px; width:120px; height:26px; text-align:center; ">적요</caption>
			<caption id="caption17" class="list_cap03" style="left:0px; top:0px; width:120px; height:26px; text-align:center; ">예금구분</caption>
			<input id="total_note_amt" ref="/root/resData/resform/total_note_amt" editable="false" format="(-)#,###" appearance="input" style="left:537px; top:4px; width:140px; height:18px; text-align:right; "/>
			<input id="total_rcpay_amt" ref="/root/resData/resform/total_rcpay_amt" editable="false" format="(-)#,###" appearance="input" style="left:537px; top:29px; width:140px; height:18px; text-align:right; "/>
			<caption id="caption20" class="list_cap03" style="left:444px; top:0px; width:90px; height:26px; text-align:center; ">교환액</caption>
			<caption id="caption28" class="list_cap03" style="left:444px; top:25px; width:90px; height:26px; text-align:center; ">수입금액</caption>
			<input id="total_corp_tax" ref="/root/resData/resform/total_corp_tax" editable="false" format="(-)#,###" appearance="input" style="left:777px; top:4px; width:140px; height:18px; text-align:right; "/>
			<input id="total_etc_prft" ref="/root/resData/resform/total_etc_prft" editable="false" format="(-)#,###" appearance="input" style="left:777px; top:29px; width:140px; height:18px; text-align:right; "/>
			<caption id="caption31" class="list_cap03" style="left:684px; top:25px; width:90px; height:26px; text-align:center; ">잡이익</caption>
			<caption id="caption8" class="list_cap03" style="left:684px; top:0px; width:90px; height:26px; text-align:center; ">법인세</caption>
			<select1 id="deps_clsf_cd" ref="/root/reqData/reqform/deps_clsf_cd" class="req" navindex="7" appearance="minimal" editmode="inputsearch" itemcount="8" style="left:123px; top:4px; width:200px; height:18px; ">
				<choices>
					<itemset nodeset="/root/initData/comboSet/dataSet/DEPSCLSFLIST/record">
						<label ref="cdabrvnm_cd"/>
						<value ref="cd"/>
					</itemset>
				</choices>
				<script type="javascript" ev:event="xforms-value-changed">
					<![CDATA[
					if(combo_data_contains(deps_clsf_cd, deps_clsf_cd.value) == -1){
						show_message("정확한 값을 선택해 주세요.");
						set_refvalue(deps_clsf_cd,"");
						return;
					}
					]]>
				</script>
			</select1>
		</group>
		<group id="grp_buttons" class="gro_sel" style="left:10px; top:727px; width:740px; height:21px; text-align:left; ">
			<button id="btn_print_slip" class="btn02" crud="P" style="left:340px; top:0px; width:52px; height:21px; ">
				<caption>전표출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var ch_no = get_refvalue(slip_no);
					if(ch_no == ""){
						show_message("전표번호가 없습니다.");
						return false;
					}
					// 글로벌변수 셋팅
					if(ch_no.length == 13){
						model.property("FC_ACCT_2260_slip_occr_dt")  = ch_no.substring(0, 8);			// 발생일자
						model.property("FC_ACCT_2260_slip_clsf_cd")  = ch_no.substring(8, 10);			// 전표구분
						model.property("FC_ACCT_2260_slip_seqfr") = ch_no.substring(10, 13);			// 일련번호 from
						model.property("FC_ACCT_2260_slip_seqto") = ch_no.substring(10, 13);			// 일련번호 to
						model.property("FC_ACCT_2260_slip_radio1") = "";			// 출력구분
						model.property("FC_ACCT_2260_popup_flag")  = "Y";
					}else{
						model.property("FC_ACCT_2260_slip_occr_dt")  = ch_no.substring(0, 8);			// 발생일자
						model.property("FC_ACCT_2260_slip_clsf_cd")  = ch_no.substring(9, 11);			// 전표구분
						model.property("FC_ACCT_2260_slip_seqfr") = ch_no.substring(12, 15);			// 일련번호 from
						model.property("FC_ACCT_2260_slip_seqto") = ch_no.substring(12, 15);			// 일련번호 to
						model.property("FC_ACCT_2260_slip_radio1") = "";			// 출력구분
						model.property("FC_ACCT_2260_popup_flag")  = "Y";
					}
					
					// 화면호출
					//viewer("mainFrame").window.javaScript.onLoadPopupPageEx("FC_ACCT_2260", "modal", "align:center; caption:hidden; width:650px; height:480px;");
					viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_ACCT_2260");	
					]]>
				</script>
			</button>
			<button id="btn_delete" class="btn02" crud="D" style="left:175px; top:0px; width:52px; height:21px; ">
				<caption>취소</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					
							if(model1.getValue("/root/reqData/reqform/slip_no") == ""){
								show_message("삭제할 대상이 없습니다.");
								return;
							}
							if (show_message("삭제하시겠습니까?","삭제 확인",MB_YESNO) != IDYES) {
								return false;
							}							
							set_refvalue("/root/reqData/reqform/slip_occr_dt",slip_no.value.substring(0,8));
							set_refvalue("/root/reqData/reqform/slip_clsf_cd",slip_no.value.substring(8,10));
							set_refvalue("/root/reqData/reqform/slip_seq",slip_no.value.substring(10,13));							

							model1.send("fc_func_1464_d");							

							if(submit_completed()){							
								show_message("삭제되었습니다.");

								btn_select_ptcr.dispatch("onclick");
								if(datagrid1.rows == 1){
									model1.reset();
								}								
							}
							
							model1.refresh();
					]]>
				</script>
			</button>
			<button id="btnReset" class="btn02" style="left:230px; top:0px; width:52px; height:21px; ">
				<caption>초기화</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						model1.reset();	
					]]>
				</script>
			</button>
			<button id="btn_print" class="btn02" crud="P" style="left:285px; top:0px; width:52px; height:21px; ">
				<caption>출력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var ch_no = get_refvalue(slip_no);
					
					// 글로벌변수 셋팅
					model.property("FC_FUNC_1220_radio1")  				= 		"18";									// 구분
					model.property("FC_FUNC_1220_stat_dt_18")  			= 		get_refvalue(stat_dt);					// 요청일	
					if(ch_no.length == 13){
						model.property("FC_FUNC_1220_slip_occr_dt_18")  		= 		ch_no.substring(0, 8);					// 발생일자
						model.property("FC_FUNC_1220_slip_clsf_cd_18")  		= 		ch_no.substring(8, 10);					// 전표구분
						model.property("FC_FUNC_1220_slip_seq_18") 			= 		ch_no.substring(10, 13);					// 일련번호
					}else{
						model.property("FC_FUNC_1220_slip_occr_dt_18")  		= 		ch_no.substring(0, 8);					// 발생일자
						model.property("FC_FUNC_1220_slip_clsf_cd_18")  		= 		ch_no.substring(9, 11);					// 전표구분
						model.property("FC_FUNC_1220_slip_seq_18") 			= 		ch_no.substring(12, 15);					// 일련번호
					}
					model.property("FC_FUNC_1220_popup_flag")  			= 		"Y";
					
					// 화면호출
					viewer("mainFrame").window.javaScript.onLoadExMDIPage("FC_FUNC_1220");	
					]]>
				</script>
			</button>
			<button id="btn_help" class="btn02" crud="R" style="left:395px; top:0px; width:52px; height:21px; ">
				<caption>엑셀</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
					var grid = null;
					
					if(_oth_clsf == "1"){			
						grid = datagrid1;
					}
					
					var filename = window.fileDialog("save", ",", false, "", "xls", "Excel File(*.xls)|*.xls");
					if(filename!=""){
						grid.saveExcel(filename, "sheetname: ");
					}
					]]>
				</script>
			</button>
			<button id="btnClose" class="btn02" style="left:450px; top:0px; width:52px; height:21px; ">
				<caption>종료</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						formClose();
					]]>
				</script>
			</button>
			<button id="btn_select_obj" class="btn02" crud="R" style="left:10px; top:0px; width:52px; height:21px; ">
				<caption>대상조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						button1.disabled = false;
						btn_insert.disabled = false;
						btn_delete.disabled = true;	
						
						datagrid1.rebuildStyle()
						
						datagrid_data_clear(datagrid2);
						commGroupInit(group1);

						if (model1.getValue("/root/reqData/searchData/mtry_dt") == "") {
							show_message(" 만기일은  필수 입력 항목입니다.");
							model1.setFocus("mtry_dt");
							return false;

						}
						if(srch_place.value == "2"){
							set_refvalue("/root/reqData/searchData/place","2");
						}
						else{
							set_refvalue("/root/reqData/searchData/place","1");
						}
						
						model1.send( "fc_func_1461_l");
						var totalcnt = get_refvalue("/root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/totalcnt");

						if (totalcnt == 0) {
							show_message("검색결과가 없습니다.");
							reset_refnode("/root/resData/gridData/fc_func_1462_l/dataSet");
							datagrid1.refresh();							
							return false;
						}else{
						}							

						selectAll.dispatch("xforms-select");
						selectAll.value = "1";
						selectAll.visible = true;
//						slip_no.value = "";
						
						var scount = 0;
						var rv_total_rcpay_amt=0;
						var rv_total_corp_tax=0;
						var rv_total_etc_prft=0;
						var rv_total_note_amt=0;
												
						for(var i=1;i<datagrid1.rows;i++){
							if(datagrid1.rowStatus(i)!=0){
								if(datagrid1.valueMatrix(i,1) !=""){
									scount++;
									rv_total_note_amt = Number(rv_total_note_amt) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/note_amt")); 
									rv_total_rcpay_amt = Number(rv_total_rcpay_amt) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/rcpay_amt"));
									rv_total_corp_tax = Number(rv_total_corp_tax) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/corp_tax"));
									rv_total_etc_prft = Number(rv_total_etc_prft) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/etc_prft"));
								}
							}
						}
	
						if (scount > 0) {
							rmks1.value = "받을어음 " + scount + "건 교환입금";
							set_refvalue("/root/resData/resform/total_note_amt",rv_total_note_amt);
							set_refvalue("/root/resData/resform/total_rcpay_amt",rv_total_rcpay_amt);
							set_refvalue("/root/resData/resform/total_corp_tax",rv_total_corp_tax);
							set_refvalue("/root/resData/resform/total_etc_prft",rv_total_etc_prft);
							group2.refresh();
						}else{
							set_refvalue("/root/reqData/reqform/rmks1","");
							set_refvalue("/root/resData/resform/total_note_amt","");
							set_refvalue("/root/resData/resform/total_rcpay_amt","");
							set_refvalue("/root/resData/resform/total_corp_tax","");
							set_refvalue("/root/resData/resform/total_etc_prft","");
							group2.refresh();
						}																		

						model1.refresh();					
					]]>
				</script>
			</button>
			<button id="btn_select_ptcr" class="btn02" crud="R" style="left:65px; top:0px; width:52px; height:21px; ">
				<caption>내역조회</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
						button1.disabled = true;
						btn_insert.disabled = true;
						btn_delete.disabled = false;	
						selectAll.dispatch("xforms-deselect");
						selectAll.value ="";
						selectAll.visible = false;			
												
						datagrid1.rebuildStyle()			

						if (model1.getValue("/root/reqData/reqform/stat_dt") == "") {
							show_message("교환일은  필수 입력 항목입니다.");
							return false;
							model1.setFocus("stat_dt");
						}

						model1.send("fc_func_1462_l");
						totalcnt = model.getValue("/root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/totalcnt");
						if (totalcnt == 0) {
							show_message("검색결과가 없습니다.");
							reset_refnode("/root/resData/gridData/fc_func_1462_l/dataSet");
							datagrid1.refresh();
							return false;
						}else{
							for(var i=1; i<datagrid1.rows; i++){
							     datagrid1.isReadOnly(i,4,i,4) = true;								
							     datagrid1.isReadOnly(i,8,i,10) = true;
							}
							var var_slip_no = get_refvalue("/root/resData/gridData/dataSet/CURLIST/record["+ eval(i-1) +"]/slip_no");
							set_refvalue("/root/reqData/reqform/slip_no",var_slip_no);
						}
						
						set_refvalue("/root/resData/resform/biz_reg_no",get_refvalue("/root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record[1]/biz_reg_no"));
						set_refvalue("/root/resData/resform/bank_id",get_refvalue("/root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record[1]/bank_id"));
						set_refvalue("/root/resData/resform/acct_num",get_refvalue("/root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record[1]/acct_num"));
						set_refvalue("/root/resData/resform/tran_date_seq",get_refvalue("/root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record[1]/tran_date_seq"));
						set_refvalue("/root/resData/resform/current_clsf",get_refvalue("/root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record[1]/current_clsf"));						
						group4.refresh();
						
					]]>
				</script>
			</button>
			<button id="btn_insert" class="btn02" crud="C" style="left:120px; top:0px; width:52px; height:21px; ">
				<caption>입력</caption>
				<script type="javascript" ev:event="onclick">
					<![CDATA[
								
						if(datagrid2.rows == 0){
							show_message("입력할 대상이 없습니다.");
							return false;
						}

//						if(tran_amt1.value != total_note_amt.value){
//							show_message("입력할 수 없는 자료입니다.(예금액과 교환액 상이)");
//							return false;
//						}
						
						var rv_total_rcpay_amt=0;
						var rv_total_corp_tax=0;
						var rv_total_etc_prft=0;
						var rv_total_note_amt=0;

						var cnt = 0;
						
						for(var i=0; i<datagrid2.rows; i++)
						{

							if(datagrid2.rowStatus(i)==1){
								if (datagrid2.valueMatrix(i,1) == ""){
									datagrid2.rowStatus(i) = "0";
								}
							}
							
							if(datagrid2.rowStatus(i) == "3" || datagrid2.rowStatus(i) == "2" || datagrid2.rowStatus(i) == "1"){
								cnt = cnt+1;
							}							
														
//							if(datagrid1.rowStatus(i)!=0){
//								if (datagrid1.valueMatrix(i,3) != ""){
//									rv_total_note_amt = Number(rv_total_note_amt) + get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/note_amt"); 
//								}
//								if (datagrid1.valueMatrix(i,3) != ""){								
////									rv_total_rcpay_amt = Number(rv_total_rcpay_amt) + Number(datagrid1.valueMatrix(i,4));
//									rv_total_rcpay_amt = Number(rv_total_rcpay_amt) + get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/rcpay_amt");									
//								}
//								if (datagrid1.valueMatrix(i,3) != ""){
////									rv_total_corp_tax = Number(rv_total_corp_tax) + get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/rcpay_amt");
//									rv_total_corp_tax = Number(rv_total_corp_tax) + get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/corp_tax");									
//								}
//								if (datagrid1.valueMatrix(i,3) != ""){								
////									rv_total_etc_prft = Number(rv_total_etc_prft) + get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/corp_tax");
//									rv_total_etc_prft = Number(rv_total_etc_prft) + get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/etc_prft");
//								}
//							}
							//datagrid2.addStatus(row, "update");
							//datagrid2.rowHidden(row) = true;
						}

						if(cnt == 0){
							show_message("입력할 대상이 없습니다.");
							for(var i=1; i<datagrid2.rows; i++){
								if (datagrid2.valueMatrix(i,1) == ""){
									datagrid2.rowStatus(i) = "1";
								}							
							}
							return false;
						}

						if (model.getValue("/root/reqData/reqform/stat_dt") == "") {
							show_message("교환일은 필수 입력 항목입니다.");
							model.setFocus("stat_dt");
							return false;
						}
						if ( getProperty("ss_cmpycd") =="500"){  //20180724 봉은정추가
							if (model.getValue("/root/reqData/reqform/chnl_clsf") == "") {
								show_message("채널구분은 필수 입력 항목입니다.");
								model.setFocus("chnl_clsf_cd");
								return false;
							}
						}
							
						model1.setValue("/root/reqData/reqform/biz_reg_no",save_biz_reg_no.value);
						model1.setValue("/root/reqData/reqform/bank_id",save_bank_id.value);
						model1.setValue("/root/reqData/reqform/acct_num",save_acct_num.value);
						model1.setValue("/root/reqData/reqform/tran_date",save_tran_date.value);						
						model1.setValue("/root/reqData/reqform/tran_date_seq",save_tran_date_seq.value);
						model1.setValue("/root/reqData/reqform/save_tran_amt",save_tran_amt.value);						
						model1.setValue("/root/reqData/reqform/current_clsf","D");

						datagrid2.colsort(8) = "asc";
						datagrid2.colsort(9) = "desc";
						datagrid2.sort(1,1, datagrid2.rows-1, datagrid2.cols-1) = "usersort";
						
						model1.setValue("/root/reqData/reqform/multiUpdateData", datagrid2.getUpdateData());																								
						
						if(srch_place.value == "2"){
							set_refvalue("/root/reqData/reqform/place","2");
						}
						else{
							set_refvalue("/root/reqData/reqform/place","1");
						}							
						
						if (show_message("저장하시겠습니까?","저장 확인",MB_YESNO) != IDYES) {
							return false;
						}

						model1.send("fc_func_1463_i");

						if(submit_completed()){							
							show_message("저장되었습니다.");
							var var_slip_no = get_refvalue("/root/resData/resform/fc_func_1463_i/dataSet/CURLIST/record/slip_no");
//							if(var_slip_no != ""){
//								set_refvalue("/root/reqData/reqform/slip_no",var_slip_no);
//								slip_no.refresh();
//							}							
							btn_select_ptcr.dispatch("onclick");
						}	
					]]>
				</script>
			</button>
		</group>
		<caption id="caption4" class="list_cap03" style="left:694px; top:191px; width:90px; height:26px; text-align:center; ">예금액</caption>
		<select id="selectAll" ref="/root/resData/resform/selectAll" overflow="visible" appearance="full" style="left:13px; top:197px; width:100px; height:18px; border-style:none; ">
			<choices>
				<item>
					<label>전체선택</label>
					<value>1</value>
				</item>
			</choices>
			<script type="javascript" ev:event="xforms-select">
				<![CDATA[
					var cnt = 0;
					var rv_total_note_amt =0;
					var rv_total_rcpay_amt =0;
					var rv_total_corp_tax =0;
					var rv_total_etc_prft =0;
					
					for(var i=0;i<datagrid1.rows;i++){
						if(datagrid1.valueMatrix(i,1) != ""){
							datagrid1.addStatus(i, "update");
							if (datagrid1.valueMatrix(i,3) != ""){							
								rv_total_note_amt = Number(rv_total_note_amt) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/note_amt"));    
								rv_total_rcpay_amt = Number(rv_total_rcpay_amt) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/rcpay_amt"));
								rv_total_corp_tax = Number(rv_total_corp_tax) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/corp_tax"));
								rv_total_etc_prft = Number(rv_total_etc_prft) + Number(get_refvalue(" /root/resData/gridData/fc_func_1462_l/dataSet/CURLIST/record["+i+"]/etc_prft"));
							}
							cnt = cnt + 1;
						}
					}
					if(datagrid1.rows > 1){
						rmks1.value = "받을어음 " + (cnt-1)+ "건 교환입금";					
						set_refvalue("/root/resData/resform/total_note_amt",rv_total_note_amt);
						set_refvalue("/root/resData/resform/total_rcpay_amt",rv_total_rcpay_amt);
						set_refvalue("/root/resData/resform/total_corp_tax",rv_total_corp_tax);
						set_refvalue("/root/resData/resform/total_etc_prft",rv_total_etc_prft);
						group2.refresh();						
					}
					
					slip_no.value = "";												
				]]>
			</script>
			<script type="javascript" ev:event="xforms-deselect">
				<![CDATA[
					for(i=0;i<datagrid1.rows;i++){
						if(datagrid1.valueMatrix(i,1) != ""){
							datagrid1.rowStatus(i) = "0";
						}
					}					
					set_refvalue("/root/reqData/reqform/rmks1","");
					set_refvalue("/root/resData/resform/total_note_amt","");
					set_refvalue("/root/resData/resform/total_rcpay_amt","");
					set_refvalue("/root/resData/resform/total_corp_tax","");
					set_refvalue("/root/resData/resform/total_etc_prft","");
					group2.refresh();
				]]>
			</script>
		</select>
		<group id="group4" visibility="hidden" style="left:290px; top:195px; width:390px; height:20px; ">
			<input id="acct_num" ref="/root/resData/resform/acct_num" editable="false" style="left:115px; top:2px; width:50px; height:18px; "/>
			<input id="tran_date_seq" ref="/root/resData/resform/tran_date_seq" editable="false" style="left:170px; top:2px; width:50px; height:18px; "/>
			<input id="current_clsf" ref="/root/resData/resform/current_clsf" editable="false" style="left:225px; top:2px; width:50px; height:18px; "/>
			<input id="biz_reg_no" ref="/root/resData/resform/biz_reg_no" editable="false" style="left:5px; top:2px; width:50px; height:18px; "/>
			<input id="bank_id" ref="/root/resData/resform/bank_id" editable="false" style="left:60px; top:2px; width:50px; height:18px; "/>
			<input id="tran_date" ref="/root/resData/resform/tran_date" editable="false" format="yyyy-mm-dd" style="left:334px; top:2px; width:50px; height:18px; "/>
			<input id="tran_amt" ref="/root/reqData/reqform/tran_amt" editable="false" style="left:279px; top:2px; width:50px; height:18px; "/>
		</group>
		<input id="tran_amt1" ref="/root/resData/resform/tran_amt1" navindex="-1" editable="false" format="(-)#,###" style="left:787px; top:195px; width:140px; height:18px; text-align:right; "/>
		<button id="button1" class="btn04" navindex="15" crud="R" style="left:135px; top:195px; width:85px; height:21px; ">
			<caption>통장입금내역</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						var acct_mang_no = model.getValue("/root/reqData/reqform/deps_clsf_cd");

						model.makeNode("/root/reqData/fwdData/acct_mang_no_ref");	
						model.setValue("/root/reqData/fwdData/acct_mang_no_ref", "/root/reqData/reqform/deps_clsf_cd");

	  					model.makeNode("/root/reqData/fwdData/tran_amt_ref1");		  					
	  					model.setValue("/root/reqData/fwdData/tran_amt_ref1", "/root/resData/resform/tran_amt1");

	  					model.makeNode("/root/reqData/fwdData/tran_amt_ref");	
	  					model.setValue("/root/reqData/fwdData/tran_amt_ref", "/root/reqData/reqform/tran_amt");
	  						  					
	  					model.makeNode("/root/reqData/fwdData/acct_tonghwa_ref");	
	  					model.setValue("/root/reqData/fwdData/acct_tonghwa_ref", "/root/reqData/reqform/frex_cd");
	  					
	  					model.makeNode("/root/reqData/fwdData/frex_amt_ref");	
	  					model.setValue("/root/reqData/fwdData/frex_amt_ref", "/root/reqData/reqform/hjphwamt");
	  					
	  					model.property("FC_FUNC_1050_deps_clsf_cd") = deps_clsf_cd.value;
	  					
						//loadRcpmDtlsPop_fc("H1"
						loadRcpmDtlsPop_fc(model1.getValue("/root/initData/comboSet/dataSet/xx_mang_cd_4")
						                , deps_clsf_cd.value
						                ,"/root/resData/resform/biz_reg_no"
						                ,"/root/resData/resform/bank_id"
						                ,"/root/resData/resform/acct_num"
						                ,"/root/resData/resform/tran_date"
						                ,"/root/resData/resform/tran_date_seq"
						                ,"/root/resData/resform/current_clsf"
									   ,"/root/reqData/fwdData");
						tran_amt1.refresh();
						group2.refresh();
						group4.refresh();

					]]>
			</script>
		</button>
		<group id="group1" visibility="hidden" style="left:290px; top:195px; width:390px; height:20px; ">
			<input id="save_tran_date" ref="/root/resData/resform1/tran_date" editable="false" format="yyyy-mm-dd" style="left:334px; top:2px; width:50px; height:18px; "/>
			<input id="save_tran_amt" ref="/root/resData/resform1/tran_amt" editable="false" style="left:279px; top:2px; width:50px; height:18px; "/>
			<input id="save_tran_date_seq" ref="/root/resData/resform1/tran_date_seq" editable="false" style="left:170px; top:2px; width:50px; height:18px; "/>
			<input id="save_acct_num" ref="/root/resData/resform1/acct_num" editable="false" style="left:115px; top:2px; width:50px; height:18px; "/>
			<input id="save_bank_id" ref="/root/resData/resform1/bank_id" editable="false" style="left:60px; top:2px; width:50px; height:18px; "/>
			<input id="save_biz_reg_no" ref="/root/resData/resform1/biz_reg_no" editable="false" style="left:5px; top:2px; width:50px; height:18px; "/>
		</group>
		<button id="button2" class="btn02" visibility="hidden" style="left:72px; top:443px; width:54px; height:21px; unloadmark:hidden; ">
			<caption>보기/닫기</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
						if(datagrid2.visible == true){
							datagrid2.visible = false;
							
						}
						else{
							datagrid2.visible = true;
						}
					]]>
			</script>
		</button>
		<button id="button_insert2" class="btn02" crud="C" style="left:14px; top:443px; width:52px; height:21px; unloadmark:visible; ">
			<caption>임시저장</caption>
			<script type="javascript" ev:event="onclick">
				<![CDATA[
//						if(tran_amt1.value != ""){
//							if(Number(tran_amt1.value) != Number(total_rcpay_amt.value)){
//								show_message("수입금액과 예금액 상이");
//								return false;
//							}
//						}

					
						for(var i=1; i<datagrid1.rows; i++){
							if(datagrid1.rowStatus(i) == "2"){	
								if( datagrid1.valueMatrix(i,7) == "" || datagrid1.valueMatrix(i,8) == "" ){
									if(trim(dlco_clsf_cd.value) == "" || trim(deps_clsf_cd.value) == ""){							
										show_message("교환은행,입금계좌는 필수 입력사항입니다.");
										return false;
									}
								}
								if( (Number(datagrid1.valueMatrix(i,9)) + Number(datagrid1.valueMatrix(i,10))+ Number(datagrid1.valueMatrix(i,11))) != Number(datagrid1.valueMatrix(i,3)) ){
									show_message("(수입금액 + 법인세 + 법인지방소득세)금액이 어음금액과 상이");
									datagrid1.rowStyle(i,"data", "background-color") = "#FFF000";
									return false;
								}
							}
						}
						var cnt = 0;
						for(var i=1; i<datagrid1.rows; i++){
							if(datagrid1.rowStatus(i) == "2"){
								cnt = cnt+1;
								datagrid2.addRow();								
								for(var j=1; j<datagrid1.cols; j++){
									if(j !=7 || j != 8){
										datagrid2.valueMatrix(datagrid2.rows-1,j) = datagrid1.valueMatrix(i,j);
									}									
								}
								if(datagrid1.valueMatrix(i,7) == ""){
									datagrid2.valueMatrix(datagrid2.rows-1,7) = dlco_cdnm.value;
									datagrid2.valueMatrix(datagrid2.rows-1,8) = deps_clsf_cd.label;
									datagrid2.valueMatrix(datagrid2.rows-1,27) = dlco_clsf_cd.value;
									datagrid2.valueMatrix(datagrid2.rows-1,28) = dlco_cd.value;
									datagrid2.valueMatrix(datagrid2.rows-1,29) = deps_clsf_cd.value;
								}
								else{
									datagrid2.valueMatrix(datagrid2.rows-1,7) = datagrid1.valueMatrix(i,7);
									datagrid2.valueMatrix(datagrid2.rows-1,8) = datagrid1.valueMatrix(i,8);
									//datagrid2.valueMatrix(datagrid2.rows-1,25) = "95"; 
									datagrid2.valueMatrix(datagrid2.rows-1,27) = model1.getValue("/root/initData/comboSet/dataSet/xx_dlco_clsf_cd");
									datagrid2.valueMatrix(datagrid2.rows-1,28) = datagrid1.valueMatrix(i,24);
									datagrid2.valueMatrix(datagrid2.rows-1,29) = datagrid1.valueMatrix(i,8).substring(0,4);
								}
							}
						}
						datagrid2.refresh();
						if(cnt !=0){
							if(save_biz_reg_no.value ==""){
								save_biz_reg_no.value = biz_reg_no.value;
								save_bank_id.value = bank_id.value;
								save_acct_num.value = acct_num.value;
								save_tran_date.value = tran_date.value;
								save_tran_date_seq.value = tran_date_seq.value;
								save_tran_amt.value = tran_amt.value;
							}
							else{
								save_biz_reg_no.value = save_biz_reg_no.value + "#" + biz_reg_no.value;
								save_bank_id.value = save_bank_id.value + "#" + bank_id.value;
								save_acct_num.value = save_acct_num.value + "#" + acct_num.value;
								save_tran_date.value = save_tran_date.value + "#" + tran_date.value;
								save_tran_date_seq.value = save_tran_date_seq.value + "#" + tran_date_seq.value;
								save_tran_amt.value = save_tran_amt.value + "#" + tran_amt.value;
							}
						}
						
						for(var i=datagrid1.rows; i >= 1; i--){
							if(datagrid1.rowStatus(i) == "2"){
								datagrid1.deleteRow(i, false);
							}
						}
						datagrid1.refresh();						
					]]>
			</script>
		</button>
	</xhtml:body>
</xhtml:html>
