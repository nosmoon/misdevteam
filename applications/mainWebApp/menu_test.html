<!doctype html>
<html ng-app="app">
  <head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">   
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-touch.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-animate.js"></script>
    <script src="/js/v-accordion.js"></script>
    <!--script src="http://lukaszwatroba.github.io/v-accordion/demo/app.js"></script-->
    <link href="/css/v-accordion.css" rel="stylesheet" />
    <!-- dynamic tab -->
    <!-- link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic"-->
    <link rel="stylesheet" href="https://cdn.gitcdn.link/cdn/angular/bower-material/v1.1.5/angular-material.css">
    <link rel="stylesheet" href="https://material.angularjs.org/1.1.5/docs.css">    
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-route.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-aria.min.js"></script>    
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-messages.min.js"></script>
    <script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-114/svg-assets-cache.js"></script>
    <script src="https://cdn.gitcdn.link/cdn/angular/bower-material/v1.1.5/angular-material.js"></script>
    <!-- dynamic tab -->
	<style>
	body {
	    font-family: "Lato", sans-serif;
	    margin:0;
	}
	
	.topnav {
		overflow: hidden;
		background-color: #333;
		position: fixed; 
		top: 0; 
		width: 100%;
		left: 0; 
		height: 50px;
		z-index: 1;
	}
	
	.topnav a {
	  float: left;
	  display: block;
	  color: #f2f2f2;
	  text-align: center;
	  padding: 14px 16px 16px 14px;
	  text-decoration: none;
	  font-size: 15px;
	}
	
	.topnav a:hover {
	  background-color: #ddd;
	  color: black;
	}
	
	.topnav a.active {
	    background-color: #4CAF50;
	    color: white;
	}

	.sidenav {
	    height: 94.6%;
	    width: 250px;
	    position: fixed;
	    z-index: 1;
	    top: 50px;
	    left: 0;
	    background-color: #111;
	    overflow-x: hidden;
	    transition: 0.5s;
	    padding-top: 10px;
	}
	
	.sidenav a {
	    padding: 8px 8px 8px 32px;
	    text-decoration: none;
	    font-size: 10px;
	    color: #818181;
	    display: block;
	    transition: 0.3s;
	}
	
	.sidenav a:hover {
	    color: #f1f1f1;
	}
	
	.sidenav .closebtn {
	    position: absolute;
	    top: 0;
	    right: 25px;
	    font-size: 36px;
	    margin-left: 80px;
	}
	
	#main {
	    transition: margin-left .5s;
	    padding: 50px 0px 0px 0px;
	    margin-left: 250px;
	    margin-top:0px;
	}
	
	#myTopmenu {
	    transition: margin-left .5s;
	}
		
	@media screen and (max-height: 450px) {
	  .sidenav {padding-top: 15px;}
	  .sidenav a {font-size: 18px;}
	}
	
	
	.container {
	    top: 10px;
	    left: 10px;
	    font-size: 36px;	
	    display: inline-block;
	    cursor: pointer;
	    pading:0px 0px 0px 0px;
	}
	
	.bar1, .bar2, .bar3 {
	    width: 35px;
	    height: 5px;
	    background-color: #f1f1f1;
	    margin: 6px 0;
	    transition: 0.4s;
	}

	.change .bar1 {
	    width: 35px;
	    height: 5px;
	    background-color: #ddd;
	    margin: 6px 0;
	    transition: 0.4s;
	}	
	.change .bar2 {
	    width: 35px;
	    height: 5px;
	    background-color: #ddd;
	    margin: 6px 0;
	    transition: 0.4s;
	}
	.change .bar3 {
	    width: 35px;
	    height: 5px;
	    background-color: #ddd;
	    margin: 6px 0;
	    transition: 0.4s;
	}	
  md-tabs:not(.md-no-tab-content):not(.md-dynamic-height) {
    min-height: 93%; }
  md-tabs[md-border-bottom]:not(.md-dynamic-height) md-tabs-content-wrapper {
    top: 0px; }    
	</style>	
  </head>
  <body>
<div ng-controller="MainCtrl">
	<div id="myTopmenu" class="topnav">
		<a style="padding-top: 5px; padding-bottom:2px;">
			<div id="btn_colOpn" class="container" onclick="myFunction(this)">
				<div class="bar1"></div>
				<div class="bar2"></div>
				<div class="bar3"></div>
			</div>		
		</a>	
		<!-- span style="font-size:30px;cursor:pointer" onclick="openNav()">&#9776; </span-->	
		<a>   chosun media logo             </a>	
		<a ng-repeat="x in MainMenu" ng-click="top_menu_click(x.menu_id)">{{x.menu_nm}}</a>
		<a>홈></a>
		<a>시스템문의></a>
		<a>로그아웃></a>
	</div>	  
	<div id="mySidenav" class="sidenav">
		<!-- a href="javascript:void(10)" class="closebtn" onclick="closeNav()">&times;</a-->	
		<v-accordion class="vAccordion--default">
		
		  <v-pane ng-repeat="item in LeftMenu" expanded="item.isExpanded">
		    <v-pane-header ng-click="left_menu_click(item.menu_nm,item.exec_url)">
		      {{ ::item.menu_nm }}
		    </v-pane-header>
		
		    <v-pane-content>
		      <!-- accordions can be nested :) -->
		      <v-accordion ng-if="item.details">
		        <v-pane ng-repeat="detail in item.details" ng-disabled="detail.isDisabled">
		          <v-pane-header ng-click="left_menu_click(detail.menu_nm,detail.exec_url)">
		            {{ ::detail.menu_nm }}
		          </v-pane-header>
		          <v-pane-content >
					<!--{{ ::detail.exec_url }}-->
				      <!-- accordions can be nested :) -->
				      <v-accordion ng-if="detail.subdetails">
				        <v-pane ng-repeat="subdetail in detail.subdetails" ng-disabled="subdetail.isDisabled">
				          <v-pane-header ng-click="left_menu_click(subdetail.menu_nm,subdetail.exec_url)">
				            {{ ::subdetail.menu_nm }}
				          </v-pane-header>
				          <v-pane-content>
				              <!--{{ ::subdetail.exec_url }}-->
						      <!-- accordions can be nested :) -->
						      <v-accordion ng-if="subdetail.enddetails">
						        <v-pane ng-repeat="enddetail in subdetail.enddetails" ng-disabled="enddetail.isDisabled">
						          <v-pane-header ng-click="left_menu_click(enddetail.menu_nm,enddetail.exec_url)">
						            {{ ::enddetail.menu_nm }}
						          </v-pane-header>
						          <v-pane-content>
									<!--{{ ::enddetail.exec_url }}-->
						          </v-pane-content>
						        </v-pane>
						      </v-accordion>		
				          </v-pane-content>
				        </v-pane>
				      </v-accordion>
		          </v-pane-content>
		        </v-pane>
		      </v-accordion>
		    </v-pane-content>
		  </v-pane>
		
		</v-accordion>	
		<!--  a ng-repeat="y in LeftMenu" href="#left">{{y.menu_nm}}</a-->
	</div>
	
	<div id="main">
		<md-content class="md-padding" style="padding:0px;height:100%">
		  <md-tabs md-selected="selectedIndex" md-border-bottom="" md-autoselect="" md-swipe-content="" md-align-tabs="bottom">
		    <md-tab ng-repeat="tab in tabs" ng-disabled="tab.disabled" label="{{tab.title}}">
		      <div class="demo-tab tab{{$index%4}}" style="height:100%">
		        <div style="height:93.7%">
					<iframe style="border: 0px currentColor; border-image: none; width:100%; height:100%" ng-src="{{tab.content}}"></iframe>		        
		        </div>
		        <md-button class="md-primary md-raised" ng-click="removeTab( tab )" >Remove Tab</md-button>
		      </div>
		    </md-tab>
		  </md-tabs>
		</md-content>	
	</div>
</div>


    <script>
	function myFunction(x) {
		if("container" == x.className){
			closeNav();
		    x.classList.toggle("change");
	    }else{
	    	openNav();
		    x.classList.toggle("change");	    
	    }
	}
	    
	function openNav() {
	    document.getElementById("mySidenav").style.width = "250px";
	    document.getElementById("main").style.marginLeft = "250px";
	    //document.getElementById("myTopmenu").style.marginLeft = "250px";
	}
	
	function closeNav() {
	    document.getElementById("mySidenav").style.width = "0px";
	    document.getElementById("main").style.marginLeft= "15px";
	    //document.getElementById("myTopmenu").style.marginLeft= "80px";
	} 
	
	//window.onresize = function(event){
		//alert(window.innerHeight);
	//};
		
	var app = angular.module('app', ['vAccordion', 'ngAnimate', 'ngMaterial', 'ngMessages', 'material.svgAssetsCache']);
	//서버 통신간 한글깨짐 방지
	app.config(function ($httpProvider,$httpParamSerializerJQLikeProvider){
		$httpProvider.defaults.transformRequest.unshift($httpParamSerializerJQLikeProvider.$get());
	});	

	app.controller('MainCtrl', ['$scope', '$http', function ($scope, $http) {
		$scope.MainMenu = [];
		$scope.LeftMenu = [];
						
		var acct_cd = "";
		var cmpy_cd = "";
		var mainID = "";
		//상단 메뉴조회		
		var dataObject = 
		{
			cmpy_cd : '',
			acct_cd : ''
		};	
		//좌측메뉴 초기값 조회
		var dataObject2 = 
		{
			cmpy_cd : '',
			mainID: 'FF',
			acct_cd : ''
		};	
		//메인 높이값
		//alert(window.innerHeight);
		//var inHeight = "93.7";//window.innerHeight - 98;
		//$scope.myHeight = "93.7%";
		
		var inHeight2 = window.innerHeight - 50;
		//alert(inHeight2);		
		document.getElementById("main").style.height= inHeight2 + "px";
		
		//상단 메뉴 서버호출
		$http({
			method: 'POST',
			url: '/co/mng/1000',
			params: ''
		})
		   .success(function(data) { 
		     $scope.MainMenu = data.root.resData.recode;

			//좌측메뉴 서버호출
			
			$http({
				method: 'POST',
				url: '/co/mng/1010',
				params: dataObject2
			})
			   .success(function(data2) {
			     //$scope.LeftMenu = data2; //.root.leftData.items;
			     $scope.LeftMenu = data2.root.leftData.items;
			});			     
		});
		//동적탭선언 => 첫화면 오픈시 탭이 없어야함
		var tabs = [],
					selected = null,
					previous = null;					
		$scope.tabs = tabs;
		//$scope.selectedIndex = 0;
		$scope.$watch('selectedIndex', function(current, old){
		  previous = selected;
		  selected = tabs[current];
		  //$scope.myHeight = inHeight + 'px';
		});		
					
		//조회		
		$scope.top_menu_click = function(menu_id) {	
			//좌측메뉴 초기값 조회
			dataObject2 = 
			{
				cmpy_cd : '',
				mainID: menu_id,
				acct_cd : ''
			};	
			//좌측메뉴 서버호출
			$http({
				method: 'POST',
				url: '/co/mng/1010',
				params: dataObject2
			})
			   .success(function(data3) {
			     //if("container" == btn_colOpn.className){
			     //	myFunction(btn_colOpn);
			     //}
			     $scope.LeftMenu = data3.root.leftData.items;
			});							
		};
		
		//화면호출
		$scope.left_menu_click = function(menu_nm,url) {
			//if("container" == btn_colOpn.className){
			//	myFunction(btn_colOpn);
			//}					
			if(url != ""){
				//alert(url);
				$scope.pageUrl = "/html/ad/bas/AD_BAS_3300.html";
				//동적탭
				//addTab(menu_nm,url);
				addTab(menu_nm,$scope.pageUrl);
			}
		};
		
		//탭추가
		function addTab(title, view) {
			//alert(screen.availHeight);
			view = view || title + " Content View";	
			//alert($scope.tabs);	
			if($scope.tabs == ""){
				tabs     = [ { title: title, content: view }],
									selected = null,
									previous = null;
				$scope.tabs = tabs;
				$scope.selectedIndex = 0;		
			}else{
				tabs.push({ title: title, content: view, disabled: false});
			}
			//$scope.myHeight = inHeight + 'px';			
		};
		//탭삭제
		$scope.removeTab = function (tab) {
		  var index = tabs.indexOf(tab);
		  tabs.splice(index, 1);
		};	
		
		//window resize event
		window.onresize = function(event){
			//alert("11:"+window.innerHeight);
			$scope.myHeight = inHeight + '%';
		};		
	}]); 
 
    </script>
  </body>
</html>