<HTML>
<HEAD>
<STYLE>
	td{ font-size:9pt };
</STYLE>
<META http-equiv = "Content-Type" content = "text/html;charset=KSC5601" />
<TITLE>파일 업로드</TITLE>
<SCRIPT>
	/**
	 * 제한 사이즈 초과시 에러 메시지 출력
	 */
	function overSize( limitSize )
	{
		var message = "허용 업로드 사이즈는 " + limitSize + "입니다.";

		alert( message );
	}

	/**
	 * 플래쉬 파일 리스트에 추가된 파일을 전송
	 */
	function fileUpload()
	{
		var movie = window.document.upload;
		var totalSize = movie.GetVariable("totalSize");

		// 업로드된 파일이 있을 경우 실행
		if( totalSize > 0 )
		{
			movie.SetVariable( "fileUpload", "" );

			// 전송 버튼 비활성화
			//form.send_button.disabled = true;
		}
		else
		{
			// 업로드 완료 후 처리 메쏘드 실행
			send();
		}
	}

	/**
	 * 파일 업로드 완료 후 처리 메쏘드
	 */
	function send()
	{
		//location.href = "/jsp/upload/FileInfoView.jsp";
		
		parent.ifrm_filelist.document.location.reload(); 
	}

	/**
	 * 허용하지 않은 형식의 파일일 경우 에러 메시지 출력
	 */
	function fileTypeError( notAllowFileType )
	{
		alert("확장자가 " + notAllowFileType + "인 파일들은 업로드 할수 없습니다.");
	}

	/**
	 * 플래쉬 버전이 8 미만일 경우 에러 메시지 출력
	 */
	function versionError()
	{
		alert("플래쉬 버전을 확인하여 주십시오.( 버전 8 이상만 가능합니다. )\n이미 설치하신 경우는 브라우저를 전부 닫고 다시 시작하여 주십시오.");
	}

	/**
	 * http 에러 발생시 출력 메시지
	 */
	function httpError()
	{
		alert("네트워크 에러가 발생하였습니다. 잠시후 다시 시도하여 주십시오.");
	}

	/**
	 * 파일 입출력 에러 발생시 출력 메시지
	 * ( 주로 업로드 하려는 파일을 다른 프로그램에서 사용중일 경우 발생 )
	 */
	function ioError()
	{
		alert("입출력 에러가 발생하였습니다.\n( 다른 프로그램에서 이 파일을 사용하고 있는지 확인하신 후 다시 시도하여 주십시오. )");
	}
</SCRIPT>
</HEAD>
<BODY bgcolor = "#ffffff">
<FORM name = "form">
<TABLE>
<TR>
	<TD>
	<!-- 파일 업로드 플래쉬 영역 -->
		<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0" width="380" height="120" id="upload" align="middle">
			<param name="allowScriptAccess" value="sameDomain" />
			<param name="movie" value="upload.swf" />
			<param name="quality" value="high" />
			<param name="bgcolor" value="#ffffff" />
			<embed src="upload.swf" quality="high" bgcolor="#ffffff" width="380" height="120" name="upload" align="middle" allowScriptAccess="sameDomain" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" />
		</object>
	</TD>
</TR>
<TR height = "25">
		<td bgcolor="#EBE9DC" class="title" align="right">
			<input type="image" id="send_button" src="/html/comm_img/bu_send01.gif" width="36" height="19" align="absmiddle" onclick="fileUpload();window.event.returnValue=false;" border="0">
			<!--INPUT type = "button" id = "send_button" onClick = "return fileUpload()" value = "전송"-->
		</td>	
</TR>
</TABLE>
</FORM>
</BODY>
</HTML>